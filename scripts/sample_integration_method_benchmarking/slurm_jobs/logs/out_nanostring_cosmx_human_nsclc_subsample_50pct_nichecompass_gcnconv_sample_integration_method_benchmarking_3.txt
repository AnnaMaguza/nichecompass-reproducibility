Run timestamp: 02092023_200431_3.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '4096', '--node_batch_size_list', 'None', '--seeds', '5', '--run_index', '6', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 863288
Number of validation edges: 95920
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9277; val_auprc_score: 0.9739; val_best_acc_score: 0.8903; val_best_f1_score: 0.9301; train_kl_reg_loss: 20129.3194; train_edge_recon_loss: 1554930.8318; train_cat_covariates_contrastive_loss: 646553.4239; train_gene_expr_recon_loss: 3535404.7192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5757018.2867; train_optim_loss: 5757018.2867; val_kl_reg_loss: 24564.3408; val_edge_recon_loss: 1412437.5938; val_cat_covariates_contrastive_loss: 629030.1458; val_gene_expr_recon_loss: 3181542.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5247575.0000; val_optim_loss: 5247575.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9587; val_auprc_score: 0.9844; val_best_acc_score: 0.9257; val_best_f1_score: 0.9526; train_kl_reg_loss: 20553.7700; train_edge_recon_loss: 1361493.2275; train_cat_covariates_contrastive_loss: 632393.8557; train_gene_expr_recon_loss: 3113113.4384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5127554.2844; train_optim_loss: 5127554.2844; val_kl_reg_loss: 17369.5120; val_edge_recon_loss: 1349918.2344; val_cat_covariates_contrastive_loss: 633298.4714; val_gene_expr_recon_loss: 3064911.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5065497.3750; val_optim_loss: 5065497.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9651; val_auprc_score: 0.9866; val_best_acc_score: 0.9345; val_best_f1_score: 0.9580; train_kl_reg_loss: 15537.2655; train_edge_recon_loss: 1335568.4325; train_cat_covariates_contrastive_loss: 633978.0053; train_gene_expr_recon_loss: 3024213.9514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5009297.6374; train_optim_loss: 5009297.6374; val_kl_reg_loss: 13711.5314; val_edge_recon_loss: 1341537.7552; val_cat_covariates_contrastive_loss: 633449.8516; val_gene_expr_recon_loss: 2993323.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4982022.3750; val_optim_loss: 4982022.3750
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9671; val_auprc_score: 0.9868; val_best_acc_score: 0.9385; val_best_f1_score: 0.9606; train_kl_reg_loss: 13158.8387; train_edge_recon_loss: 1324861.4491; train_cat_covariates_contrastive_loss: 633873.9730; train_gene_expr_recon_loss: 2968944.6137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4940838.8957; train_optim_loss: 4940838.8957; val_kl_reg_loss: 12335.0241; val_edge_recon_loss: 1332326.5208; val_cat_covariates_contrastive_loss: 633410.8151; val_gene_expr_recon_loss: 2949998.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4928070.5000; val_optim_loss: 4928070.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9679; val_auprc_score: 0.9871; val_best_acc_score: 0.9409; val_best_f1_score: 0.9620; train_kl_reg_loss: 12271.2437; train_edge_recon_loss: 1324064.1706; train_cat_covariates_contrastive_loss: 633500.3152; train_gene_expr_recon_loss: 2925626.4194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895462.1398; train_optim_loss: 4895462.1398; val_kl_reg_loss: 11911.2979; val_edge_recon_loss: 1325067.5365; val_cat_covariates_contrastive_loss: 632790.8854; val_gene_expr_recon_loss: 2915412.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4885181.8333; val_optim_loss: 4885181.8333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9698; val_auprc_score: 0.9881; val_best_acc_score: 0.9445; val_best_f1_score: 0.9642; train_kl_reg_loss: 11904.8366; train_edge_recon_loss: 1320499.9100; train_cat_covariates_contrastive_loss: 633245.1940; train_gene_expr_recon_loss: 2890663.8709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4856313.8294; train_optim_loss: 4856313.8294; val_kl_reg_loss: 11637.9004; val_edge_recon_loss: 1323575.5990; val_cat_covariates_contrastive_loss: 632421.8203; val_gene_expr_recon_loss: 2880408.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848044.1458; val_optim_loss: 4848044.1458
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9719; val_auprc_score: 0.9884; val_best_acc_score: 0.9466; val_best_f1_score: 0.9656; train_kl_reg_loss: 11746.2949; train_edge_recon_loss: 1319562.3797; train_cat_covariates_contrastive_loss: 633122.9259; train_gene_expr_recon_loss: 2862201.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826633.4692; train_optim_loss: 4826633.4692; val_kl_reg_loss: 11583.6331; val_edge_recon_loss: 1331608.8698; val_cat_covariates_contrastive_loss: 632862.7552; val_gene_expr_recon_loss: 2854133.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4830189.2083; val_optim_loss: 4830189.2083
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9732; val_auprc_score: 0.9893; val_best_acc_score: 0.9475; val_best_f1_score: 0.9661; train_kl_reg_loss: 11718.9534; train_edge_recon_loss: 1318920.1979; train_cat_covariates_contrastive_loss: 633016.1727; train_gene_expr_recon_loss: 2837937.6102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801592.9289; train_optim_loss: 4801592.9289; val_kl_reg_loss: 11481.8272; val_edge_recon_loss: 1321364.4531; val_cat_covariates_contrastive_loss: 632762.6120; val_gene_expr_recon_loss: 2831363.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4796971.9792; val_optim_loss: 4796971.9792
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9737; val_auprc_score: 0.9892; val_best_acc_score: 0.9479; val_best_f1_score: 0.9664; train_kl_reg_loss: 11739.2212; train_edge_recon_loss: 1315513.8608; train_cat_covariates_contrastive_loss: 632809.6306; train_gene_expr_recon_loss: 2814804.3780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4774867.0900; train_optim_loss: 4774867.0900; val_kl_reg_loss: 11779.4464; val_edge_recon_loss: 1324351.7344; val_cat_covariates_contrastive_loss: 632494.1875; val_gene_expr_recon_loss: 2809364.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4777989.7083; val_optim_loss: 4777989.7083
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9726; val_auprc_score: 0.9889; val_best_acc_score: 0.9496; val_best_f1_score: 0.9675; train_kl_reg_loss: 11788.4053; train_edge_recon_loss: 1315220.6451; train_cat_covariates_contrastive_loss: 632854.6736; train_gene_expr_recon_loss: 2795890.8081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4755754.5308; train_optim_loss: 4755754.5308; val_kl_reg_loss: 11844.1393; val_edge_recon_loss: 1318724.8490; val_cat_covariates_contrastive_loss: 631834.7318; val_gene_expr_recon_loss: 2793424.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4755828.1250; val_optim_loss: 4755828.1250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9726; val_auprc_score: 0.9889; val_best_acc_score: 0.9483; val_best_f1_score: 0.9667; train_kl_reg_loss: 11865.8777; train_edge_recon_loss: 1316932.3004; train_cat_covariates_contrastive_loss: 632658.5755; train_gene_expr_recon_loss: 2778217.6303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739674.4052; train_optim_loss: 4739674.4052; val_kl_reg_loss: 11878.6477; val_edge_recon_loss: 1323048.9479; val_cat_covariates_contrastive_loss: 632202.2604; val_gene_expr_recon_loss: 2778121.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745251.1875; val_optim_loss: 4745251.1875
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9737; val_auprc_score: 0.9891; val_best_acc_score: 0.9496; val_best_f1_score: 0.9675; train_kl_reg_loss: 11990.1487; train_edge_recon_loss: 1312355.5521; train_cat_covariates_contrastive_loss: 632721.2402; train_gene_expr_recon_loss: 2761011.8957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4718078.8365; train_optim_loss: 4718078.8365; val_kl_reg_loss: 11897.2805; val_edge_recon_loss: 1314687.7083; val_cat_covariates_contrastive_loss: 632340.0911; val_gene_expr_recon_loss: 2753970.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712895.3125; val_optim_loss: 4712895.3125
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9747; val_auprc_score: 0.9896; val_best_acc_score: 0.9503; val_best_f1_score: 0.9679; train_kl_reg_loss: 12136.7056; train_edge_recon_loss: 1315175.7962; train_cat_covariates_contrastive_loss: 632580.6659; train_gene_expr_recon_loss: 2747564.8270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4707457.9882; train_optim_loss: 4707457.9882; val_kl_reg_loss: 12225.4996; val_edge_recon_loss: 1325392.9792; val_cat_covariates_contrastive_loss: 631931.2370; val_gene_expr_recon_loss: 2748042.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4717591.9167; val_optim_loss: 4717591.9167
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9739; val_auprc_score: 0.9893; val_best_acc_score: 0.9501; val_best_f1_score: 0.9679; train_kl_reg_loss: 12208.5543; train_edge_recon_loss: 1316515.8246; train_cat_covariates_contrastive_loss: 632545.1517; train_gene_expr_recon_loss: 2733655.7595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4694925.2891; train_optim_loss: 4694925.2891; val_kl_reg_loss: 11903.8031; val_edge_recon_loss: 1316510.6875; val_cat_covariates_contrastive_loss: 632739.2656; val_gene_expr_recon_loss: 2734020.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4695174.1458; val_optim_loss: 4695174.1458
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9745; val_auprc_score: 0.9894; val_best_acc_score: 0.9519; val_best_f1_score: 0.9689; train_kl_reg_loss: 12347.0795; train_edge_recon_loss: 1311960.2210; train_cat_covariates_contrastive_loss: 632520.5095; train_gene_expr_recon_loss: 2721755.2014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4678583.0024; train_optim_loss: 4678583.0024; val_kl_reg_loss: 12416.2924; val_edge_recon_loss: 1322828.4167; val_cat_covariates_contrastive_loss: 632059.1771; val_gene_expr_recon_loss: 2725510.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4692814.4583; val_optim_loss: 4692814.4583
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9755; val_auprc_score: 0.9899; val_best_acc_score: 0.9524; val_best_f1_score: 0.9693; train_kl_reg_loss: 12451.8112; train_edge_recon_loss: 1315957.5847; train_cat_covariates_contrastive_loss: 632497.2331; train_gene_expr_recon_loss: 2710893.9455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4671800.5782; train_optim_loss: 4671800.5782; val_kl_reg_loss: 12250.7321; val_edge_recon_loss: 1318399.7292; val_cat_covariates_contrastive_loss: 632657.7760; val_gene_expr_recon_loss: 2713192.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676501.1250; val_optim_loss: 4676501.1250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9747; val_auprc_score: 0.9895; val_best_acc_score: 0.9529; val_best_f1_score: 0.9696; train_kl_reg_loss: 12540.9180; train_edge_recon_loss: 1314686.0758; train_cat_covariates_contrastive_loss: 632395.3350; train_gene_expr_recon_loss: 2701393.1493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4661015.4882; train_optim_loss: 4661015.4882; val_kl_reg_loss: 12495.9500; val_edge_recon_loss: 1313781.8281; val_cat_covariates_contrastive_loss: 631734.5286; val_gene_expr_recon_loss: 2705913.1146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4663925.3542; val_optim_loss: 4663925.3542
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9763; val_auprc_score: 0.9902; val_best_acc_score: 0.9542; val_best_f1_score: 0.9704; train_kl_reg_loss: 12661.1661; train_edge_recon_loss: 1314634.9846; train_cat_covariates_contrastive_loss: 632355.8252; train_gene_expr_recon_loss: 2691824.7073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4651476.6943; train_optim_loss: 4651476.6943; val_kl_reg_loss: 12511.6401; val_edge_recon_loss: 1311363.1562; val_cat_covariates_contrastive_loss: 632247.6719; val_gene_expr_recon_loss: 2697999.5104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4654121.9583; val_optim_loss: 4654121.9583
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9758; val_auprc_score: 0.9901; val_best_acc_score: 0.9523; val_best_f1_score: 0.9692; train_kl_reg_loss: 12702.8579; train_edge_recon_loss: 1313145.6600; train_cat_covariates_contrastive_loss: 632275.8898; train_gene_expr_recon_loss: 2684817.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4642942.0142; train_optim_loss: 4642942.0142; val_kl_reg_loss: 12457.2412; val_edge_recon_loss: 1310969.7708; val_cat_covariates_contrastive_loss: 632595.5182; val_gene_expr_recon_loss: 2689807.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4645829.5000; val_optim_loss: 4645829.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9745; val_auprc_score: 0.9893; val_best_acc_score: 0.9519; val_best_f1_score: 0.9688; train_kl_reg_loss: 12763.2895; train_edge_recon_loss: 1311197.3051; train_cat_covariates_contrastive_loss: 632342.4858; train_gene_expr_recon_loss: 2676255.9716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4632559.0403; train_optim_loss: 4632559.0403; val_kl_reg_loss: 12983.0057; val_edge_recon_loss: 1327859.8385; val_cat_covariates_contrastive_loss: 631496.4948; val_gene_expr_recon_loss: 2687291.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4659630.3958; val_optim_loss: 4659630.3958
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9766; val_auprc_score: 0.9902; val_best_acc_score: 0.9551; val_best_f1_score: 0.9710; train_kl_reg_loss: 12886.0401; train_edge_recon_loss: 1313074.9141; train_cat_covariates_contrastive_loss: 632188.5086; train_gene_expr_recon_loss: 2670783.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4628932.6161; train_optim_loss: 4628932.6161; val_kl_reg_loss: 12824.8868; val_edge_recon_loss: 1321111.0677; val_cat_covariates_contrastive_loss: 632000.5625; val_gene_expr_recon_loss: 2676359.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4642296.0625; val_optim_loss: 4642296.0625
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9750; val_auprc_score: 0.9896; val_best_acc_score: 0.9526; val_best_f1_score: 0.9694; train_kl_reg_loss: 12934.1313; train_edge_recon_loss: 1313630.5148; train_cat_covariates_contrastive_loss: 632271.2992; train_gene_expr_recon_loss: 2664941.9502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4623777.8744; train_optim_loss: 4623777.8744; val_kl_reg_loss: 12683.1012; val_edge_recon_loss: 1321286.3073; val_cat_covariates_contrastive_loss: 631811.7188; val_gene_expr_recon_loss: 2678572.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4644353.8958; val_optim_loss: 4644353.8958
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9762; val_auprc_score: 0.9900; val_best_acc_score: 0.9543; val_best_f1_score: 0.9705; train_kl_reg_loss: 12959.9329; train_edge_recon_loss: 1314106.6700; train_cat_covariates_contrastive_loss: 632268.4772; train_gene_expr_recon_loss: 2659984.8637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4619319.9408; train_optim_loss: 4619319.9408; val_kl_reg_loss: 12875.3399; val_edge_recon_loss: 1320777.6302; val_cat_covariates_contrastive_loss: 632022.2396; val_gene_expr_recon_loss: 2671034.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4636709.6667; val_optim_loss: 4636709.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9757; val_auprc_score: 0.9896; val_best_acc_score: 0.9539; val_best_f1_score: 0.9701; train_kl_reg_loss: 13061.5235; train_edge_recon_loss: 1312802.4917; train_cat_covariates_contrastive_loss: 632275.0675; train_gene_expr_recon_loss: 2654013.8697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4612152.9408; train_optim_loss: 4612152.9408; val_kl_reg_loss: 12924.4211; val_edge_recon_loss: 1321258.9062; val_cat_covariates_contrastive_loss: 632064.7943; val_gene_expr_recon_loss: 2669600.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4635849.0625; val_optim_loss: 4635849.0625
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9779; val_auprc_score: 0.9907; val_best_acc_score: 0.9562; val_best_f1_score: 0.9717; train_kl_reg_loss: 13071.1426; train_edge_recon_loss: 1311759.2109; train_cat_covariates_contrastive_loss: 632053.7746; train_gene_expr_recon_loss: 2650451.7073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4607335.8318; train_optim_loss: 4607335.8318; val_kl_reg_loss: 12566.8386; val_edge_recon_loss: 1313177.8490; val_cat_covariates_contrastive_loss: 632663.9010; val_gene_expr_recon_loss: 2664117.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4622525.8542; val_optim_loss: 4622525.8542
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9778; val_auprc_score: 0.9905; val_best_acc_score: 0.9569; val_best_f1_score: 0.9721; train_kl_reg_loss: 13124.7909; train_edge_recon_loss: 1310744.4449; train_cat_covariates_contrastive_loss: 632100.8421; train_gene_expr_recon_loss: 2645265.6363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601235.7014; train_optim_loss: 4601235.7014; val_kl_reg_loss: 12958.4237; val_edge_recon_loss: 1316785.9792; val_cat_covariates_contrastive_loss: 632025.7448; val_gene_expr_recon_loss: 2660327.3229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4622097.4375; val_optim_loss: 4622097.4375
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9764; val_auprc_score: 0.9898; val_best_acc_score: 0.9555; val_best_f1_score: 0.9712; train_kl_reg_loss: 13170.5199; train_edge_recon_loss: 1307907.1836; train_cat_covariates_contrastive_loss: 632093.0809; train_gene_expr_recon_loss: 2642611.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4595781.9242; train_optim_loss: 4595781.9242; val_kl_reg_loss: 13377.9869; val_edge_recon_loss: 1317912.0573; val_cat_covariates_contrastive_loss: 631418.1979; val_gene_expr_recon_loss: 2658391.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4621099.2292; val_optim_loss: 4621099.2292
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9770; val_auprc_score: 0.9900; val_best_acc_score: 0.9576; val_best_f1_score: 0.9726; train_kl_reg_loss: 13202.8928; train_edge_recon_loss: 1313418.0746; train_cat_covariates_contrastive_loss: 632099.8957; train_gene_expr_recon_loss: 2638829.2026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4597550.0592; train_optim_loss: 4597550.0592; val_kl_reg_loss: 13191.2119; val_edge_recon_loss: 1323980.1094; val_cat_covariates_contrastive_loss: 632063.6354; val_gene_expr_recon_loss: 2653783.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4623018.7917; val_optim_loss: 4623018.7917
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9774; val_auprc_score: 0.9903; val_best_acc_score: 0.9578; val_best_f1_score: 0.9726; train_kl_reg_loss: 13283.5944; train_edge_recon_loss: 1314713.5314; train_cat_covariates_contrastive_loss: 632047.3273; train_gene_expr_recon_loss: 2635931.2713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4595975.7417; train_optim_loss: 4595975.7417; val_kl_reg_loss: 13459.7153; val_edge_recon_loss: 1321537.4740; val_cat_covariates_contrastive_loss: 631253.4245; val_gene_expr_recon_loss: 2650168.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4616419.0625; val_optim_loss: 4616419.0625
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9790; val_auprc_score: 0.9912; val_best_acc_score: 0.9581; val_best_f1_score: 0.9729; train_kl_reg_loss: 13306.6199; train_edge_recon_loss: 1313056.4218; train_cat_covariates_contrastive_loss: 632032.4772; train_gene_expr_recon_loss: 2633049.6659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4591445.1611; train_optim_loss: 4591445.1611; val_kl_reg_loss: 13490.6660; val_edge_recon_loss: 1309051.6302; val_cat_covariates_contrastive_loss: 631748.9036; val_gene_expr_recon_loss: 2652076.6354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4606367.9167; val_optim_loss: 4606367.9167
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9791; val_auprc_score: 0.9912; val_best_acc_score: 0.9577; val_best_f1_score: 0.9727; train_kl_reg_loss: 13342.6533; train_edge_recon_loss: 1313587.9775; train_cat_covariates_contrastive_loss: 632083.6591; train_gene_expr_recon_loss: 2630603.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4589617.8934; train_optim_loss: 4589617.8934; val_kl_reg_loss: 13476.8988; val_edge_recon_loss: 1316291.7188; val_cat_covariates_contrastive_loss: 631685.6380; val_gene_expr_recon_loss: 2647030.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4608484.6458; val_optim_loss: 4608484.6458
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9783; val_auprc_score: 0.9906; val_best_acc_score: 0.9583; val_best_f1_score: 0.9730; train_kl_reg_loss: 13391.4761; train_edge_recon_loss: 1310444.1842; train_cat_covariates_contrastive_loss: 631903.0847; train_gene_expr_recon_loss: 2628606.6505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4584345.4100; train_optim_loss: 4584345.4100; val_kl_reg_loss: 13323.9867; val_edge_recon_loss: 1320986.2656; val_cat_covariates_contrastive_loss: 631878.9375; val_gene_expr_recon_loss: 2644902.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4611091.6250; val_optim_loss: 4611091.6250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9795; val_auprc_score: 0.9912; val_best_acc_score: 0.9595; val_best_f1_score: 0.9738; train_kl_reg_loss: 13349.1735; train_edge_recon_loss: 1311222.8045; train_cat_covariates_contrastive_loss: 631929.9896; train_gene_expr_recon_loss: 2625589.9289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4582091.9100; train_optim_loss: 4582091.9100; val_kl_reg_loss: 13093.1435; val_edge_recon_loss: 1312257.1354; val_cat_covariates_contrastive_loss: 632278.1849; val_gene_expr_recon_loss: 2641812.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4599441.3542; val_optim_loss: 4599441.3542
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9779; val_auprc_score: 0.9906; val_best_acc_score: 0.9584; val_best_f1_score: 0.9731; train_kl_reg_loss: 13413.5342; train_edge_recon_loss: 1308649.1836; train_cat_covariates_contrastive_loss: 632004.2725; train_gene_expr_recon_loss: 2622235.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4576302.4147; train_optim_loss: 4576302.4147; val_kl_reg_loss: 13152.2609; val_edge_recon_loss: 1311190.5729; val_cat_covariates_contrastive_loss: 631674.9583; val_gene_expr_recon_loss: 2642286.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4598304.6042; val_optim_loss: 4598304.6042
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9789; val_auprc_score: 0.9908; val_best_acc_score: 0.9591; val_best_f1_score: 0.9735; train_kl_reg_loss: 13436.2944; train_edge_recon_loss: 1308816.5462; train_cat_covariates_contrastive_loss: 632015.0886; train_gene_expr_recon_loss: 2621440.8009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4575708.7393; train_optim_loss: 4575708.7393; val_kl_reg_loss: 13333.1723; val_edge_recon_loss: 1326677.6406; val_cat_covariates_contrastive_loss: 631807.3880; val_gene_expr_recon_loss: 2642489.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4614307.7708; val_optim_loss: 4614307.7708
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9794; val_auprc_score: 0.9912; val_best_acc_score: 0.9587; val_best_f1_score: 0.9732; train_kl_reg_loss: 13481.0730; train_edge_recon_loss: 1312581.4763; train_cat_covariates_contrastive_loss: 631870.6653; train_gene_expr_recon_loss: 2620195.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4578129.1540; train_optim_loss: 4578129.1540; val_kl_reg_loss: 13253.5095; val_edge_recon_loss: 1315618.5052; val_cat_covariates_contrastive_loss: 631946.3281; val_gene_expr_recon_loss: 2639605.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4600423.6458; val_optim_loss: 4600423.6458
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9796; val_auprc_score: 0.9911; val_best_acc_score: 0.9594; val_best_f1_score: 0.9737; train_kl_reg_loss: 13473.9087; train_edge_recon_loss: 1311739.9556; train_cat_covariates_contrastive_loss: 631879.6771; train_gene_expr_recon_loss: 2616996.0604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4574089.5948; train_optim_loss: 4574089.5948; val_kl_reg_loss: 13527.8665; val_edge_recon_loss: 1322760.3698; val_cat_covariates_contrastive_loss: 631696.8464; val_gene_expr_recon_loss: 2640737.2396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4608722.3750; val_optim_loss: 4608722.3750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9803; val_auprc_score: 0.9917; val_best_acc_score: 0.9590; val_best_f1_score: 0.9734; train_kl_reg_loss: 13505.2625; train_edge_recon_loss: 1308845.4982; train_cat_covariates_contrastive_loss: 631797.2056; train_gene_expr_recon_loss: 2616805.9467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4570953.9076; train_optim_loss: 4570953.9076; val_kl_reg_loss: 13097.5084; val_edge_recon_loss: 1315451.6302; val_cat_covariates_contrastive_loss: 632232.1927; val_gene_expr_recon_loss: 2638530.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4599311.5417; val_optim_loss: 4599311.5417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9806; val_auprc_score: 0.9916; val_best_acc_score: 0.9612; val_best_f1_score: 0.9748; train_kl_reg_loss: 13472.9566; train_edge_recon_loss: 1305789.6588; train_cat_covariates_contrastive_loss: 631874.3632; train_gene_expr_recon_loss: 2607036.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558173.0592; train_optim_loss: 4558173.0592; val_kl_reg_loss: 13243.3469; val_edge_recon_loss: 1307410.5573; val_cat_covariates_contrastive_loss: 631905.3359; val_gene_expr_recon_loss: 2632514.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4585073.3542; val_optim_loss: 4585073.3542
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9802; val_auprc_score: 0.9913; val_best_acc_score: 0.9611; val_best_f1_score: 0.9748; train_kl_reg_loss: 13429.9383; train_edge_recon_loss: 1310040.1333; train_cat_covariates_contrastive_loss: 631895.6508; train_gene_expr_recon_loss: 2606397.2393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561762.9431; train_optim_loss: 4561762.9431; val_kl_reg_loss: 13261.4582; val_edge_recon_loss: 1305688.6719; val_cat_covariates_contrastive_loss: 632063.8880; val_gene_expr_recon_loss: 2631373.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582387.4375; val_optim_loss: 4582387.4375
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9801; val_auprc_score: 0.9911; val_best_acc_score: 0.9610; val_best_f1_score: 0.9748; train_kl_reg_loss: 13472.6706; train_edge_recon_loss: 1308759.4082; train_cat_covariates_contrastive_loss: 631966.5509; train_gene_expr_recon_loss: 2606677.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560876.5948; train_optim_loss: 4560876.5948; val_kl_reg_loss: 13388.2173; val_edge_recon_loss: 1320502.8073; val_cat_covariates_contrastive_loss: 631406.2109; val_gene_expr_recon_loss: 2629443.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4594741.0000; val_optim_loss: 4594741.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9809; val_auprc_score: 0.9919; val_best_acc_score: 0.9618; val_best_f1_score: 0.9752; train_kl_reg_loss: 13470.0061; train_edge_recon_loss: 1310226.9520; train_cat_covariates_contrastive_loss: 631876.2986; train_gene_expr_recon_loss: 2605458.6102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561031.8791; train_optim_loss: 4561031.8791; val_kl_reg_loss: 13391.4124; val_edge_recon_loss: 1308063.8177; val_cat_covariates_contrastive_loss: 631623.8698; val_gene_expr_recon_loss: 2628371.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4581450.6875; val_optim_loss: 4581450.6875
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9802; val_auprc_score: 0.9914; val_best_acc_score: 0.9615; val_best_f1_score: 0.9751; train_kl_reg_loss: 13471.7708; train_edge_recon_loss: 1304860.9864; train_cat_covariates_contrastive_loss: 631906.3670; train_gene_expr_recon_loss: 2604383.8827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4554623.0190; train_optim_loss: 4554623.0190; val_kl_reg_loss: 13384.6608; val_edge_recon_loss: 1306499.3542; val_cat_covariates_contrastive_loss: 631358.4401; val_gene_expr_recon_loss: 2632615.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4583857.7917; val_optim_loss: 4583857.7917
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9809; val_auprc_score: 0.9917; val_best_acc_score: 0.9618; val_best_f1_score: 0.9753; train_kl_reg_loss: 13444.8111; train_edge_recon_loss: 1310410.2701; train_cat_covariates_contrastive_loss: 631994.9822; train_gene_expr_recon_loss: 2605370.7832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561220.8744; train_optim_loss: 4561220.8744; val_kl_reg_loss: 13293.2767; val_edge_recon_loss: 1303631.9010; val_cat_covariates_contrastive_loss: 631930.6172; val_gene_expr_recon_loss: 2625272.2396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574128.0208; val_optim_loss: 4574128.0208
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9792; val_auprc_score: 0.9908; val_best_acc_score: 0.9607; val_best_f1_score: 0.9746; train_kl_reg_loss: 13470.3643; train_edge_recon_loss: 1306171.8774; train_cat_covariates_contrastive_loss: 631933.2568; train_gene_expr_recon_loss: 2605081.2713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4556656.7417; train_optim_loss: 4556656.7417; val_kl_reg_loss: 13371.8018; val_edge_recon_loss: 1308070.7083; val_cat_covariates_contrastive_loss: 631420.6771; val_gene_expr_recon_loss: 2627388.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4580251.1458; val_optim_loss: 4580251.1458
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9800; val_auprc_score: 0.9911; val_best_acc_score: 0.9609; val_best_f1_score: 0.9746; train_kl_reg_loss: 13474.1019; train_edge_recon_loss: 1308277.6090; train_cat_covariates_contrastive_loss: 631926.6899; train_gene_expr_recon_loss: 2606469.8637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560148.2607; train_optim_loss: 4560148.2607; val_kl_reg_loss: 13333.3300; val_edge_recon_loss: 1315780.7865; val_cat_covariates_contrastive_loss: 631859.0521; val_gene_expr_recon_loss: 2631230.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4592203.8750; val_optim_loss: 4592203.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9807; val_auprc_score: 0.9915; val_best_acc_score: 0.9612; val_best_f1_score: 0.9748; train_kl_reg_loss: 13462.6057; train_edge_recon_loss: 1309245.6540; train_cat_covariates_contrastive_loss: 631929.4239; train_gene_expr_recon_loss: 2604667.5332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4559305.2014; train_optim_loss: 4559305.2014; val_kl_reg_loss: 13315.6959; val_edge_recon_loss: 1320391.6250; val_cat_covariates_contrastive_loss: 631937.7188; val_gene_expr_recon_loss: 2628143.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4593788.1667; val_optim_loss: 4593788.1667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9820; val_auprc_score: 0.9922; val_best_acc_score: 0.9622; val_best_f1_score: 0.9754; train_kl_reg_loss: 13491.8158; train_edge_recon_loss: 1309892.5012; train_cat_covariates_contrastive_loss: 631910.7944; train_gene_expr_recon_loss: 2603484.5569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558779.6801; train_optim_loss: 4558779.6801; val_kl_reg_loss: 13310.6552; val_edge_recon_loss: 1322862.8281; val_cat_covariates_contrastive_loss: 631731.0052; val_gene_expr_recon_loss: 2627987.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4595892.4375; val_optim_loss: 4595892.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9805; val_auprc_score: 0.9915; val_best_acc_score: 0.9620; val_best_f1_score: 0.9754; train_kl_reg_loss: 13471.6953; train_edge_recon_loss: 1309998.7784; train_cat_covariates_contrastive_loss: 631817.8670; train_gene_expr_recon_loss: 2603501.8886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558790.2393; train_optim_loss: 4558790.2393; val_kl_reg_loss: 13273.5920; val_edge_recon_loss: 1309641.9271; val_cat_covariates_contrastive_loss: 631490.1536; val_gene_expr_recon_loss: 2628507.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582913.1875; val_optim_loss: 4582913.1875
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9796; val_auprc_score: 0.9911; val_best_acc_score: 0.9615; val_best_f1_score: 0.9750; train_kl_reg_loss: 13439.5450; train_edge_recon_loss: 1305664.6274; train_cat_covariates_contrastive_loss: 631925.6019; train_gene_expr_recon_loss: 2602116.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4553146.1351; train_optim_loss: 4553146.1351; val_kl_reg_loss: 13340.7455; val_edge_recon_loss: 1317996.5625; val_cat_covariates_contrastive_loss: 631577.9531; val_gene_expr_recon_loss: 2627869.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4590784.3542; val_optim_loss: 4590784.3542
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9805; val_auprc_score: 0.9915; val_best_acc_score: 0.9614; val_best_f1_score: 0.9750; train_kl_reg_loss: 13464.6008; train_edge_recon_loss: 1308726.1457; train_cat_covariates_contrastive_loss: 631822.2284; train_gene_expr_recon_loss: 2602956.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4556969.7749; train_optim_loss: 4556969.7749; val_kl_reg_loss: 13296.7739; val_edge_recon_loss: 1315087.2188; val_cat_covariates_contrastive_loss: 631681.0078; val_gene_expr_recon_loss: 2625002.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4585067.9583; val_optim_loss: 4585067.9583
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9809; val_auprc_score: 0.9917; val_best_acc_score: 0.9614; val_best_f1_score: 0.9750; train_kl_reg_loss: 13433.9089; train_edge_recon_loss: 1307596.2429; train_cat_covariates_contrastive_loss: 631875.3039; train_gene_expr_recon_loss: 2602678.7784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4555584.2370; train_optim_loss: 4555584.2370; val_kl_reg_loss: 13262.2392; val_edge_recon_loss: 1311396.2448; val_cat_covariates_contrastive_loss: 632012.0417; val_gene_expr_recon_loss: 2627850.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4584520.9583; val_optim_loss: 4584520.9583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 250 min 7 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9422
val AUPRC score: 0.9671
val best accuracy score: 0.9493
val best F1 score: 0.9669
val target rna MSE score: 1.1652
val source rna MSE score: 0.1133
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0795
Duration of model training in run 6: 4 hours, 11 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
