Run timestamp: 02092023_192940_4.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '4096', '--node_batch_size_list', 'None', '--seeds', '4', '--run_index', '5', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1721208
Number of validation edges: 191245
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9645; val_auprc_score: 0.9874; val_best_acc_score: 0.9271; val_best_f1_score: 0.9532; train_kl_reg_loss: 25219.1614; train_edge_recon_loss: 1468004.9947; train_cat_covariates_contrastive_loss: 644122.8814; train_gene_expr_recon_loss: 3193004.2043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5330351.2363; train_optim_loss: 5330351.2363; val_kl_reg_loss: 20362.5865; val_edge_recon_loss: 1355124.6277; val_cat_covariates_contrastive_loss: 636696.2806; val_gene_expr_recon_loss: 2920213.0053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4932396.4787; val_optim_loss: 4932396.4787
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9779; val_auprc_score: 0.9919; val_best_acc_score: 0.9468; val_best_f1_score: 0.9657; train_kl_reg_loss: 16137.5433; train_edge_recon_loss: 1329401.6710; train_cat_covariates_contrastive_loss: 638448.9751; train_gene_expr_recon_loss: 2866057.3462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850045.5487; train_optim_loss: 4850045.5487; val_kl_reg_loss: 13642.6994; val_edge_recon_loss: 1320659.5745; val_cat_covariates_contrastive_loss: 637346.4082; val_gene_expr_recon_loss: 2812274.8085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4783923.5106; val_optim_loss: 4783923.5106
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9790; val_auprc_score: 0.9921; val_best_acc_score: 0.9496; val_best_f1_score: 0.9674; train_kl_reg_loss: 13274.9127; train_edge_recon_loss: 1316047.0986; train_cat_covariates_contrastive_loss: 637354.4296; train_gene_expr_recon_loss: 2780562.3414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747238.7660; train_optim_loss: 4747238.7660; val_kl_reg_loss: 12655.7752; val_edge_recon_loss: 1320915.1277; val_cat_covariates_contrastive_loss: 636412.0186; val_gene_expr_recon_loss: 2743579.6755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4713562.6170; val_optim_loss: 4713562.6170
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9786; val_auprc_score: 0.9919; val_best_acc_score: 0.9505; val_best_f1_score: 0.9680; train_kl_reg_loss: 12822.5551; train_edge_recon_loss: 1313735.9917; train_cat_covariates_contrastive_loss: 636329.0527; train_gene_expr_recon_loss: 2721777.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4684665.1259; train_optim_loss: 4684665.1259; val_kl_reg_loss: 12680.8708; val_edge_recon_loss: 1325916.4628; val_cat_covariates_contrastive_loss: 635221.0186; val_gene_expr_recon_loss: 2690220.4574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4664038.8191; val_optim_loss: 4664038.8191
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9802; val_auprc_score: 0.9925; val_best_acc_score: 0.9543; val_best_f1_score: 0.9705; train_kl_reg_loss: 12803.3297; train_edge_recon_loss: 1310236.0511; train_cat_covariates_contrastive_loss: 635612.1315; train_gene_expr_recon_loss: 2677764.0362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4636415.5534; train_optim_loss: 4636415.5534; val_kl_reg_loss: 12614.0568; val_edge_recon_loss: 1312836.2394; val_cat_covariates_contrastive_loss: 635311.0452; val_gene_expr_recon_loss: 2656087.6702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4616849.0638; val_optim_loss: 4616849.0638
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9807; val_auprc_score: 0.9925; val_best_acc_score: 0.9556; val_best_f1_score: 0.9712; train_kl_reg_loss: 12926.3961; train_edge_recon_loss: 1310312.5413; train_cat_covariates_contrastive_loss: 635257.1664; train_gene_expr_recon_loss: 2643126.3005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601622.3979; train_optim_loss: 4601622.3979; val_kl_reg_loss: 13096.5345; val_edge_recon_loss: 1317623.9894; val_cat_covariates_contrastive_loss: 634428.9707; val_gene_expr_recon_loss: 2621938.7553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4587088.2553; val_optim_loss: 4587088.2553
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9822; val_auprc_score: 0.9931; val_best_acc_score: 0.9573; val_best_f1_score: 0.9723; train_kl_reg_loss: 13183.9412; train_edge_recon_loss: 1310413.9088; train_cat_covariates_contrastive_loss: 634991.3539; train_gene_expr_recon_loss: 2615006.5350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4573595.7435; train_optim_loss: 4573595.7435; val_kl_reg_loss: 13028.2329; val_edge_recon_loss: 1314620.0984; val_cat_covariates_contrastive_loss: 635181.7447; val_gene_expr_recon_loss: 2603361.8989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4566191.9787; val_optim_loss: 4566191.9787
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9820; val_auprc_score: 0.9931; val_best_acc_score: 0.9573; val_best_f1_score: 0.9723; train_kl_reg_loss: 13366.5294; train_edge_recon_loss: 1307440.5837; train_cat_covariates_contrastive_loss: 634868.7662; train_gene_expr_recon_loss: 2593764.8587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4549440.7304; train_optim_loss: 4549440.7304; val_kl_reg_loss: 13267.9668; val_edge_recon_loss: 1309942.5053; val_cat_covariates_contrastive_loss: 634659.0372; val_gene_expr_recon_loss: 2582022.3564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4539891.8617; val_optim_loss: 4539891.8617
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9826; val_auprc_score: 0.9931; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 13552.0858; train_edge_recon_loss: 1306141.8150; train_cat_covariates_contrastive_loss: 634570.6444; train_gene_expr_recon_loss: 2575949.0137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4530213.5641; train_optim_loss: 4530213.5641; val_kl_reg_loss: 13706.9844; val_edge_recon_loss: 1310056.6197; val_cat_covariates_contrastive_loss: 634471.5306; val_gene_expr_recon_loss: 2565164.2234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4523399.3617; val_optim_loss: 4523399.3617
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9817; val_auprc_score: 0.9928; val_best_acc_score: 0.9587; val_best_f1_score: 0.9732; train_kl_reg_loss: 13719.2888; train_edge_recon_loss: 1308996.9157; train_cat_covariates_contrastive_loss: 634476.6532; train_gene_expr_recon_loss: 2561457.7684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4518650.6318; train_optim_loss: 4518650.6318; val_kl_reg_loss: 13589.9155; val_edge_recon_loss: 1309502.5000; val_cat_covariates_contrastive_loss: 633925.9628; val_gene_expr_recon_loss: 2552810.5798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4509828.9574; val_optim_loss: 4509828.9574
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9814; val_auprc_score: 0.9926; val_best_acc_score: 0.9597; val_best_f1_score: 0.9738; train_kl_reg_loss: 13831.0953; train_edge_recon_loss: 1306755.3637; train_cat_covariates_contrastive_loss: 634251.5895; train_gene_expr_recon_loss: 2550156.0196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4504994.0713; train_optim_loss: 4504994.0713; val_kl_reg_loss: 13830.5185; val_edge_recon_loss: 1314723.2872; val_cat_covariates_contrastive_loss: 633336.5040; val_gene_expr_recon_loss: 2543616.5319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4505506.8191; val_optim_loss: 4505506.8191
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9819; val_auprc_score: 0.9929; val_best_acc_score: 0.9597; val_best_f1_score: 0.9738; train_kl_reg_loss: 13939.1931; train_edge_recon_loss: 1304891.5873; train_cat_covariates_contrastive_loss: 634171.7224; train_gene_expr_recon_loss: 2541146.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4494149.2850; train_optim_loss: 4494149.2850; val_kl_reg_loss: 13824.0064; val_edge_recon_loss: 1315560.8245; val_cat_covariates_contrastive_loss: 633576.0346; val_gene_expr_recon_loss: 2535394.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4498355.5319; val_optim_loss: 4498355.5319
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9829; val_auprc_score: 0.9934; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 14007.6657; train_edge_recon_loss: 1302859.9831; train_cat_covariates_contrastive_loss: 634034.3322; train_gene_expr_recon_loss: 2532088.0766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4482990.0416; train_optim_loss: 4482990.0416; val_kl_reg_loss: 14009.3619; val_edge_recon_loss: 1306522.4654; val_cat_covariates_contrastive_loss: 634000.5585; val_gene_expr_recon_loss: 2528405.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4482937.8723; val_optim_loss: 4482937.8723
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9823; val_auprc_score: 0.9930; val_best_acc_score: 0.9606; val_best_f1_score: 0.9744; train_kl_reg_loss: 14097.1688; train_edge_recon_loss: 1303540.8414; train_cat_covariates_contrastive_loss: 633908.9991; train_gene_expr_recon_loss: 2525748.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4477295.1876; train_optim_loss: 4477295.1876; val_kl_reg_loss: 13920.3479; val_edge_recon_loss: 1315932.2207; val_cat_covariates_contrastive_loss: 633542.7620; val_gene_expr_recon_loss: 2523136.2713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4486531.6064; val_optim_loss: 4486531.6064
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9825; val_auprc_score: 0.9930; val_best_acc_score: 0.9617; val_best_f1_score: 0.9751; train_kl_reg_loss: 14175.9548; train_edge_recon_loss: 1305906.9415; train_cat_covariates_contrastive_loss: 633967.8463; train_gene_expr_recon_loss: 2520128.3106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474179.0701; train_optim_loss: 4474179.0701; val_kl_reg_loss: 14735.6050; val_edge_recon_loss: 1311056.5931; val_cat_covariates_contrastive_loss: 632840.0731; val_gene_expr_recon_loss: 2516395.1383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4475027.3936; val_optim_loss: 4475027.3936
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9832; val_auprc_score: 0.9934; val_best_acc_score: 0.9613; val_best_f1_score: 0.9749; train_kl_reg_loss: 14246.0916; train_edge_recon_loss: 1305078.3314; train_cat_covariates_contrastive_loss: 633803.4676; train_gene_expr_recon_loss: 2515413.9614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4468541.8337; train_optim_loss: 4468541.8337; val_kl_reg_loss: 14080.4505; val_edge_recon_loss: 1302932.8431; val_cat_covariates_contrastive_loss: 633856.5213; val_gene_expr_recon_loss: 2513409.5638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4464279.3830; val_optim_loss: 4464279.3830
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9827; val_auprc_score: 0.9932; val_best_acc_score: 0.9608; val_best_f1_score: 0.9745; train_kl_reg_loss: 14288.7523; train_edge_recon_loss: 1304860.2640; train_cat_covariates_contrastive_loss: 633830.9378; train_gene_expr_recon_loss: 2510135.7815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4463115.7352; train_optim_loss: 4463115.7352; val_kl_reg_loss: 14020.7204; val_edge_recon_loss: 1313123.7660; val_cat_covariates_contrastive_loss: 633747.0745; val_gene_expr_recon_loss: 2509278.9894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4470170.5532; val_optim_loss: 4470170.5532
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9831; val_auprc_score: 0.9932; val_best_acc_score: 0.9623; val_best_f1_score: 0.9755; train_kl_reg_loss: 14308.1639; train_edge_recon_loss: 1303189.2242; train_cat_covariates_contrastive_loss: 633727.0092; train_gene_expr_recon_loss: 2506565.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4457790.2138; train_optim_loss: 4457790.2138; val_kl_reg_loss: 14190.7479; val_edge_recon_loss: 1314628.0186; val_cat_covariates_contrastive_loss: 633423.6104; val_gene_expr_recon_loss: 2507509.3564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4469751.7234; val_optim_loss: 4469751.7234
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9829; val_auprc_score: 0.9932; val_best_acc_score: 0.9620; val_best_f1_score: 0.9753; train_kl_reg_loss: 14359.6078; train_edge_recon_loss: 1304136.1799; train_cat_covariates_contrastive_loss: 633559.5537; train_gene_expr_recon_loss: 2503664.1063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4455719.4477; train_optim_loss: 4455719.4477; val_kl_reg_loss: 14244.5587; val_edge_recon_loss: 1313640.5133; val_cat_covariates_contrastive_loss: 633524.6995; val_gene_expr_recon_loss: 2501548.6223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4462958.3617; val_optim_loss: 4462958.3617
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9832; val_auprc_score: 0.9934; val_best_acc_score: 0.9623; val_best_f1_score: 0.9755; train_kl_reg_loss: 14430.9815; train_edge_recon_loss: 1304477.1704; train_cat_covariates_contrastive_loss: 633607.0448; train_gene_expr_recon_loss: 2500481.1948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4452996.4014; train_optim_loss: 4452996.4014; val_kl_reg_loss: 14439.1845; val_edge_recon_loss: 1307665.5452; val_cat_covariates_contrastive_loss: 633455.0266; val_gene_expr_recon_loss: 2502164.8830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4457724.6596; val_optim_loss: 4457724.6596
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9834; val_auprc_score: 0.9934; val_best_acc_score: 0.9627; val_best_f1_score: 0.9758; train_kl_reg_loss: 14464.4332; train_edge_recon_loss: 1301929.8759; train_cat_covariates_contrastive_loss: 633566.5123; train_gene_expr_recon_loss: 2498492.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4448453.7720; train_optim_loss: 4448453.7720; val_kl_reg_loss: 14143.3168; val_edge_recon_loss: 1308100.6516; val_cat_covariates_contrastive_loss: 633632.3644; val_gene_expr_recon_loss: 2499085.0585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4454961.4149; val_optim_loss: 4454961.4149
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9835; val_auprc_score: 0.9934; val_best_acc_score: 0.9631; val_best_f1_score: 0.9760; train_kl_reg_loss: 14519.9475; train_edge_recon_loss: 1305657.4676; train_cat_covariates_contrastive_loss: 633446.4077; train_gene_expr_recon_loss: 2494733.6027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4448357.4240; train_optim_loss: 4448357.4240; val_kl_reg_loss: 14216.9182; val_edge_recon_loss: 1309642.7739; val_cat_covariates_contrastive_loss: 633707.9641; val_gene_expr_recon_loss: 2496966.2394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4454533.8830; val_optim_loss: 4454533.8830
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9827; val_auprc_score: 0.9933; val_best_acc_score: 0.9633; val_best_f1_score: 0.9762; train_kl_reg_loss: 14515.0255; train_edge_recon_loss: 1302135.6930; train_cat_covariates_contrastive_loss: 633388.1876; train_gene_expr_recon_loss: 2493509.1449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4443548.0416; train_optim_loss: 4443548.0416; val_kl_reg_loss: 14303.5022; val_edge_recon_loss: 1305728.7739; val_cat_covariates_contrastive_loss: 632925.0399; val_gene_expr_recon_loss: 2493549.3032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4446506.5745; val_optim_loss: 4446506.5745
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9842; val_auprc_score: 0.9938; val_best_acc_score: 0.9629; val_best_f1_score: 0.9760; train_kl_reg_loss: 14531.8255; train_edge_recon_loss: 1301659.3177; train_cat_covariates_contrastive_loss: 633413.4664; train_gene_expr_recon_loss: 2491766.5137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4441371.1211; train_optim_loss: 4441371.1211; val_kl_reg_loss: 14121.7010; val_edge_recon_loss: 1306673.1835; val_cat_covariates_contrastive_loss: 634168.1011; val_gene_expr_recon_loss: 2492510.6011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4447473.5957; val_optim_loss: 4447473.5957
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9829; val_auprc_score: 0.9932; val_best_acc_score: 0.9640; val_best_f1_score: 0.9767; train_kl_reg_loss: 14532.8994; train_edge_recon_loss: 1303386.2776; train_cat_covariates_contrastive_loss: 633450.1246; train_gene_expr_recon_loss: 2489455.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4440824.7981; train_optim_loss: 4440824.7981; val_kl_reg_loss: 14335.6204; val_edge_recon_loss: 1308376.4867; val_cat_covariates_contrastive_loss: 633284.0585; val_gene_expr_recon_loss: 2492006.0638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4448002.1915; val_optim_loss: 4448002.1915
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9835; val_auprc_score: 0.9935; val_best_acc_score: 0.9639; val_best_f1_score: 0.9766; train_kl_reg_loss: 14586.2971; train_edge_recon_loss: 1303473.9519; train_cat_covariates_contrastive_loss: 633213.2836; train_gene_expr_recon_loss: 2487795.4679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4439069.0095; train_optim_loss: 4439069.0095; val_kl_reg_loss: 14501.5288; val_edge_recon_loss: 1304674.2686; val_cat_covariates_contrastive_loss: 633072.7234; val_gene_expr_recon_loss: 2490022.9574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4442271.4574; val_optim_loss: 4442271.4574
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9831; val_auprc_score: 0.9933; val_best_acc_score: 0.9650; val_best_f1_score: 0.9773; train_kl_reg_loss: 14543.2965; train_edge_recon_loss: 1301282.5638; train_cat_covariates_contrastive_loss: 633409.8242; train_gene_expr_recon_loss: 2487158.8913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4436394.5796; train_optim_loss: 4436394.5796; val_kl_reg_loss: 14479.0850; val_edge_recon_loss: 1303382.7580; val_cat_covariates_contrastive_loss: 633081.8178; val_gene_expr_recon_loss: 2489714.8351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440658.5000; val_optim_loss: 4440658.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9835; val_auprc_score: 0.9934; val_best_acc_score: 0.9651; val_best_f1_score: 0.9773; train_kl_reg_loss: 14638.2740; train_edge_recon_loss: 1303147.4952; train_cat_covariates_contrastive_loss: 633253.7003; train_gene_expr_recon_loss: 2485995.2732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4437034.7363; train_optim_loss: 4437034.7363; val_kl_reg_loss: 14486.5224; val_edge_recon_loss: 1306488.5479; val_cat_covariates_contrastive_loss: 633006.7819; val_gene_expr_recon_loss: 2487838.9096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4441820.7979; val_optim_loss: 4441820.7979
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9652; val_best_f1_score: 0.9774; train_kl_reg_loss: 14629.1610; train_edge_recon_loss: 1303030.7708; train_cat_covariates_contrastive_loss: 633235.8354; train_gene_expr_recon_loss: 2483721.2162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4434616.9905; train_optim_loss: 4434616.9905; val_kl_reg_loss: 14605.9088; val_edge_recon_loss: 1301150.3218; val_cat_covariates_contrastive_loss: 633055.4016; val_gene_expr_recon_loss: 2484702.1649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4433513.7766; val_optim_loss: 4433513.7766
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9836; val_auprc_score: 0.9932; val_best_acc_score: 0.9649; val_best_f1_score: 0.9772; train_kl_reg_loss: 14619.3354; train_edge_recon_loss: 1300855.6345; train_cat_covariates_contrastive_loss: 633199.5534; train_gene_expr_recon_loss: 2484060.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4432734.9062; train_optim_loss: 4432734.9062; val_kl_reg_loss: 14681.0263; val_edge_recon_loss: 1307015.1064; val_cat_covariates_contrastive_loss: 633046.1543; val_gene_expr_recon_loss: 2486351.0160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4441093.3191; val_optim_loss: 4441093.3191
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9835; val_auprc_score: 0.9934; val_best_acc_score: 0.9649; val_best_f1_score: 0.9773; train_kl_reg_loss: 14637.8575; train_edge_recon_loss: 1301241.0080; train_cat_covariates_contrastive_loss: 633178.3685; train_gene_expr_recon_loss: 2483907.6740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4432964.9097; train_optim_loss: 4432964.9097; val_kl_reg_loss: 14689.6273; val_edge_recon_loss: 1308565.2420; val_cat_covariates_contrastive_loss: 632750.6263; val_gene_expr_recon_loss: 2486292.2447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4442297.7234; val_optim_loss: 4442297.7234
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9841; val_auprc_score: 0.9936; val_best_acc_score: 0.9654; val_best_f1_score: 0.9775; train_kl_reg_loss: 14641.6299; train_edge_recon_loss: 1302589.0439; train_cat_covariates_contrastive_loss: 633201.7120; train_gene_expr_recon_loss: 2481476.2589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4431908.6544; train_optim_loss: 4431908.6544; val_kl_reg_loss: 14348.1447; val_edge_recon_loss: 1310920.8644; val_cat_covariates_contrastive_loss: 633503.7207; val_gene_expr_recon_loss: 2483840.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4442613.4149; val_optim_loss: 4442613.4149
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9839; val_auprc_score: 0.9935; val_best_acc_score: 0.9650; val_best_f1_score: 0.9773; train_kl_reg_loss: 14653.5504; train_edge_recon_loss: 1301194.5368; train_cat_covariates_contrastive_loss: 633153.9112; train_gene_expr_recon_loss: 2480756.3961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4429758.3836; train_optim_loss: 4429758.3836; val_kl_reg_loss: 14488.9960; val_edge_recon_loss: 1310029.8191; val_cat_covariates_contrastive_loss: 632922.7527; val_gene_expr_recon_loss: 2482973.3883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440414.9362; val_optim_loss: 4440414.9362

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9834; val_auprc_score: 0.9932; val_best_acc_score: 0.9652; val_best_f1_score: 0.9775; train_kl_reg_loss: 14572.0028; train_edge_recon_loss: 1300863.9338; train_cat_covariates_contrastive_loss: 633191.2444; train_gene_expr_recon_loss: 2471971.0760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4420598.2577; train_optim_loss: 4420598.2577; val_kl_reg_loss: 14464.2433; val_edge_recon_loss: 1311362.3005; val_cat_covariates_contrastive_loss: 633073.3497; val_gene_expr_recon_loss: 2478822.3085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4437722.2340; val_optim_loss: 4437722.2340
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9834; val_auprc_score: 0.9933; val_best_acc_score: 0.9662; val_best_f1_score: 0.9781; train_kl_reg_loss: 14591.9632; train_edge_recon_loss: 1298954.3913; train_cat_covariates_contrastive_loss: 633143.2264; train_gene_expr_recon_loss: 2471316.3599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418005.9442; train_optim_loss: 4418005.9442; val_kl_reg_loss: 14424.5717; val_edge_recon_loss: 1307005.5532; val_cat_covariates_contrastive_loss: 633091.7580; val_gene_expr_recon_loss: 2476826.5426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4431348.3511; val_optim_loss: 4431348.3511
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9837; val_auprc_score: 0.9934; val_best_acc_score: 0.9662; val_best_f1_score: 0.9780; train_kl_reg_loss: 14566.5391; train_edge_recon_loss: 1299913.3928; train_cat_covariates_contrastive_loss: 633134.4899; train_gene_expr_recon_loss: 2470782.8076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418397.2292; train_optim_loss: 4418397.2292; val_kl_reg_loss: 14540.7197; val_edge_recon_loss: 1310823.7261; val_cat_covariates_contrastive_loss: 633092.0691; val_gene_expr_recon_loss: 2478025.7128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4436482.1809; val_optim_loss: 4436482.1809
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9840; val_auprc_score: 0.9935; val_best_acc_score: 0.9666; val_best_f1_score: 0.9783; train_kl_reg_loss: 14560.5160; train_edge_recon_loss: 1299829.5998; train_cat_covariates_contrastive_loss: 633178.9339; train_gene_expr_recon_loss: 2470839.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418408.8800; train_optim_loss: 4418408.8800; val_kl_reg_loss: 14446.3716; val_edge_recon_loss: 1304164.7926; val_cat_covariates_contrastive_loss: 633037.8590; val_gene_expr_recon_loss: 2474470.5532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4426119.5851; val_optim_loss: 4426119.5851
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9838; val_auprc_score: 0.9934; val_best_acc_score: 0.9661; val_best_f1_score: 0.9780; train_kl_reg_loss: 14560.0513; train_edge_recon_loss: 1300968.8985; train_cat_covariates_contrastive_loss: 633146.5540; train_gene_expr_recon_loss: 2469854.1663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418529.6805; train_optim_loss: 4418529.6805; val_kl_reg_loss: 14402.7501; val_edge_recon_loss: 1307006.5000; val_cat_covariates_contrastive_loss: 633057.7194; val_gene_expr_recon_loss: 2476057.4415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4430524.4149; val_optim_loss: 4430524.4149
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9841; val_auprc_score: 0.9936; val_best_acc_score: 0.9669; val_best_f1_score: 0.9786; train_kl_reg_loss: 14555.9163; train_edge_recon_loss: 1300141.5036; train_cat_covariates_contrastive_loss: 633144.9886; train_gene_expr_recon_loss: 2469294.5398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4417136.9489; train_optim_loss: 4417136.9489; val_kl_reg_loss: 14393.6604; val_edge_recon_loss: 1295489.7473; val_cat_covariates_contrastive_loss: 632979.4947; val_gene_expr_recon_loss: 2474817.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4417680.3511; val_optim_loss: 4417680.3511
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9844; val_auprc_score: 0.9937; val_best_acc_score: 0.9668; val_best_f1_score: 0.9784; train_kl_reg_loss: 14569.8668; train_edge_recon_loss: 1300651.0347; train_cat_covariates_contrastive_loss: 633135.8112; train_gene_expr_recon_loss: 2468839.5683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4417196.2720; train_optim_loss: 4417196.2720; val_kl_reg_loss: 14431.9254; val_edge_recon_loss: 1306618.0559; val_cat_covariates_contrastive_loss: 633138.7287; val_gene_expr_recon_loss: 2475831.1117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4430019.8298; val_optim_loss: 4430019.8298
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9844; val_auprc_score: 0.9937; val_best_acc_score: 0.9664; val_best_f1_score: 0.9782; train_kl_reg_loss: 14565.6326; train_edge_recon_loss: 1300080.7752; train_cat_covariates_contrastive_loss: 633097.8391; train_gene_expr_recon_loss: 2469291.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4417035.8610; train_optim_loss: 4417035.8610; val_kl_reg_loss: 14301.0281; val_edge_recon_loss: 1310385.5160; val_cat_covariates_contrastive_loss: 633255.0226; val_gene_expr_recon_loss: 2472020.8032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4429962.3830; val_optim_loss: 4429962.3830
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9660; val_best_f1_score: 0.9779; train_kl_reg_loss: 14538.9989; train_edge_recon_loss: 1299957.5751; train_cat_covariates_contrastive_loss: 633146.9347; train_gene_expr_recon_loss: 2468618.9192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4416262.4311; train_optim_loss: 4416262.4311; val_kl_reg_loss: 14464.4654; val_edge_recon_loss: 1312240.8032; val_cat_covariates_contrastive_loss: 633084.5652; val_gene_expr_recon_loss: 2473315.7021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4433105.5745; val_optim_loss: 4433105.5745
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9846; val_auprc_score: 0.9938; val_best_acc_score: 0.9665; val_best_f1_score: 0.9782; train_kl_reg_loss: 14543.6464; train_edge_recon_loss: 1301370.9077; train_cat_covariates_contrastive_loss: 633041.1666; train_gene_expr_recon_loss: 2469509.9495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418465.6746; train_optim_loss: 4418465.6746; val_kl_reg_loss: 14263.9382; val_edge_recon_loss: 1311433.3245; val_cat_covariates_contrastive_loss: 633100.0239; val_gene_expr_recon_loss: 2474917.1011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4433714.3936; val_optim_loss: 4433714.3936

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9841; val_auprc_score: 0.9936; val_best_acc_score: 0.9660; val_best_f1_score: 0.9779; train_kl_reg_loss: 14498.0674; train_edge_recon_loss: 1300950.0365; train_cat_covariates_contrastive_loss: 633125.7303; train_gene_expr_recon_loss: 2467706.2239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4416280.0546; train_optim_loss: 4416280.0546; val_kl_reg_loss: 14332.8131; val_edge_recon_loss: 1303615.8005; val_cat_covariates_contrastive_loss: 632889.4854; val_gene_expr_recon_loss: 2474499.0213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4425337.1064; val_optim_loss: 4425337.1064
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9842; val_auprc_score: 0.9936; val_best_acc_score: 0.9669; val_best_f1_score: 0.9785; train_kl_reg_loss: 14497.7445; train_edge_recon_loss: 1297290.0407; train_cat_covariates_contrastive_loss: 633171.6741; train_gene_expr_recon_loss: 2468103.3325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4413062.7922; train_optim_loss: 4413062.7922; val_kl_reg_loss: 14340.1717; val_edge_recon_loss: 1305151.4016; val_cat_covariates_contrastive_loss: 633386.2420; val_gene_expr_recon_loss: 2474199.2074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427077.0213; val_optim_loss: 4427077.0213
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9845; val_auprc_score: 0.9937; val_best_acc_score: 0.9667; val_best_f1_score: 0.9784; train_kl_reg_loss: 14511.6098; train_edge_recon_loss: 1300869.1054; train_cat_covariates_contrastive_loss: 633144.1026; train_gene_expr_recon_loss: 2466715.5778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4415240.4014; train_optim_loss: 4415240.4014; val_kl_reg_loss: 14352.7465; val_edge_recon_loss: 1308415.3298; val_cat_covariates_contrastive_loss: 633156.7088; val_gene_expr_recon_loss: 2474148.6596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4430073.3936; val_optim_loss: 4430073.3936
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9844; val_auprc_score: 0.9936; val_best_acc_score: 0.9669; val_best_f1_score: 0.9786; train_kl_reg_loss: 14522.6964; train_edge_recon_loss: 1298243.1951; train_cat_covariates_contrastive_loss: 633116.2568; train_gene_expr_recon_loss: 2466986.1490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4412868.2957; train_optim_loss: 4412868.2957; val_kl_reg_loss: 14351.7648; val_edge_recon_loss: 1300469.4947; val_cat_covariates_contrastive_loss: 633100.2566; val_gene_expr_recon_loss: 2472590.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4420512.0106; val_optim_loss: 4420512.0106

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 546 min 41 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9496
val AUPRC score: 0.9735
val best accuracy score: 0.9531
val best F1 score: 0.9693
val target rna MSE score: 1.1180
val source rna MSE score: 0.1194
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.1120
Duration of model training in run 5: 9 hours, 8 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
