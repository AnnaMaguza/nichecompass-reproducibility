First script finished. Launching follow up script.
Run timestamp: 01062023_193521.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9560; val_auprc_score: 0.9910; val_best_acc_score: 0.9372; val_best_f1_score: 0.9635; train_kl_reg_loss: 155.2465; train_edge_recon_loss: 101539.7662; train_gene_expr_recon_loss: 120697.7054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222392.7176; train_optim_loss: 222392.7176; val_kl_reg_loss: 170.5086; val_edge_recon_loss: 98011.2070; val_gene_expr_recon_loss: 112011.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210193.0547; val_optim_loss: 210193.0547
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9078; val_auprc_score: 0.9779; val_best_acc_score: 0.9110; val_best_f1_score: 0.9487; train_kl_reg_loss: 1011.7888; train_edge_recon_loss: 90729.3527; train_gene_expr_recon_loss: 110827.2902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202568.4319; train_optim_loss: 202568.4319; val_kl_reg_loss: 2731.9771; val_edge_recon_loss: 84535.7109; val_gene_expr_recon_loss: 109040.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196307.7578; val_optim_loss: 196307.7578
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9260; val_auprc_score: 0.9839; val_best_acc_score: 0.9195; val_best_f1_score: 0.9538; train_kl_reg_loss: 3297.7751; train_edge_recon_loss: 80738.2199; train_gene_expr_recon_loss: 108527.2299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192563.2266; train_optim_loss: 192563.2266; val_kl_reg_loss: 2871.6426; val_edge_recon_loss: 80011.9570; val_gene_expr_recon_loss: 107740.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190623.7266; val_optim_loss: 190623.7266
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9385; val_auprc_score: 0.9862; val_best_acc_score: 0.9287; val_best_f1_score: 0.9590; train_kl_reg_loss: 2404.4133; train_edge_recon_loss: 80612.0943; train_gene_expr_recon_loss: 107183.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190200.1462; train_optim_loss: 190200.1462; val_kl_reg_loss: 2086.1167; val_edge_recon_loss: 80793.8242; val_gene_expr_recon_loss: 106803.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189683.8906; val_optim_loss: 189683.8906
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9507; val_auprc_score: 0.9885; val_best_acc_score: 0.9319; val_best_f1_score: 0.9608; train_kl_reg_loss: 2251.0816; train_edge_recon_loss: 78759.8661; train_gene_expr_recon_loss: 106089.4481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187100.3951; train_optim_loss: 187100.3951; val_kl_reg_loss: 2235.9380; val_edge_recon_loss: 80221.0391; val_gene_expr_recon_loss: 105964.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188421.1797; val_optim_loss: 188421.1797
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9582; val_auprc_score: 0.9908; val_best_acc_score: 0.9406; val_best_f1_score: 0.9656; train_kl_reg_loss: 2217.0487; train_edge_recon_loss: 78327.1763; train_gene_expr_recon_loss: 105290.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185834.5725; train_optim_loss: 185834.5725; val_kl_reg_loss: 2117.1680; val_edge_recon_loss: 78975.6367; val_gene_expr_recon_loss: 104627.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185719.8828; val_optim_loss: 185719.8828
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9647; val_auprc_score: 0.9923; val_best_acc_score: 0.9464; val_best_f1_score: 0.9689; train_kl_reg_loss: 2187.8518; train_edge_recon_loss: 78353.2316; train_gene_expr_recon_loss: 104675.1083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185216.1897; train_optim_loss: 185216.1897; val_kl_reg_loss: 2118.1182; val_edge_recon_loss: 79683.2656; val_gene_expr_recon_loss: 104391.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186193.2734; val_optim_loss: 186193.2734
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9704; val_auprc_score: 0.9935; val_best_acc_score: 0.9512; val_best_f1_score: 0.9716; train_kl_reg_loss: 2154.1527; train_edge_recon_loss: 77464.4269; train_gene_expr_recon_loss: 104053.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183672.1652; train_optim_loss: 183672.1652; val_kl_reg_loss: 2033.0804; val_edge_recon_loss: 79119.2891; val_gene_expr_recon_loss: 103824.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184976.4844; val_optim_loss: 184976.4844
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9713; val_auprc_score: 0.9935; val_best_acc_score: 0.9544; val_best_f1_score: 0.9735; train_kl_reg_loss: 2124.5132; train_edge_recon_loss: 78061.8783; train_gene_expr_recon_loss: 103453.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183639.4107; train_optim_loss: 183639.4107; val_kl_reg_loss: 2106.0767; val_edge_recon_loss: 77976.0117; val_gene_expr_recon_loss: 102409.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182491.3828; val_optim_loss: 182491.3828
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9756; val_auprc_score: 0.9946; val_best_acc_score: 0.9581; val_best_f1_score: 0.9758; train_kl_reg_loss: 2162.9892; train_edge_recon_loss: 77461.2026; train_gene_expr_recon_loss: 102987.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182611.7701; train_optim_loss: 182611.7701; val_kl_reg_loss: 2047.2789; val_edge_recon_loss: 77496.5742; val_gene_expr_recon_loss: 102516.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182059.8672; val_optim_loss: 182059.8672
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9782; val_auprc_score: 0.9952; val_best_acc_score: 0.9615; val_best_f1_score: 0.9777; train_kl_reg_loss: 2117.7533; train_edge_recon_loss: 77013.5938; train_gene_expr_recon_loss: 102550.5017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181681.8493; train_optim_loss: 181681.8493; val_kl_reg_loss: 2081.9491; val_edge_recon_loss: 76701.0898; val_gene_expr_recon_loss: 102441.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181224.3203; val_optim_loss: 181224.3203
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9743; val_auprc_score: 0.9943; val_best_acc_score: 0.9603; val_best_f1_score: 0.9770; train_kl_reg_loss: 2124.7409; train_edge_recon_loss: 76990.7109; train_gene_expr_recon_loss: 102011.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181126.5123; train_optim_loss: 181126.5123; val_kl_reg_loss: 2065.2670; val_edge_recon_loss: 76754.6914; val_gene_expr_recon_loss: 101365.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180185.9375; val_optim_loss: 180185.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9745; val_auprc_score: 0.9940; val_best_acc_score: 0.9625; val_best_f1_score: 0.9781; train_kl_reg_loss: 2086.1113; train_edge_recon_loss: 75872.4074; train_gene_expr_recon_loss: 101750.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179708.9609; train_optim_loss: 179708.9609; val_kl_reg_loss: 2030.3600; val_edge_recon_loss: 78234.5117; val_gene_expr_recon_loss: 101460.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181725.6406; val_optim_loss: 181725.6406
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9792; val_auprc_score: 0.9950; val_best_acc_score: 0.9644; val_best_f1_score: 0.9792; train_kl_reg_loss: 2092.7227; train_edge_recon_loss: 77704.6903; train_gene_expr_recon_loss: 101325.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181123.3839; train_optim_loss: 181123.3839; val_kl_reg_loss: 1998.7401; val_edge_recon_loss: 79015.4531; val_gene_expr_recon_loss: 100341.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181355.5000; val_optim_loss: 181355.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9785; val_auprc_score: 0.9941; val_best_acc_score: 0.9659; val_best_f1_score: 0.9803; train_kl_reg_loss: 2080.9055; train_edge_recon_loss: 76785.2059; train_gene_expr_recon_loss: 101033.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179900.0547; train_optim_loss: 179900.0547; val_kl_reg_loss: 1997.4808; val_edge_recon_loss: 74284.5234; val_gene_expr_recon_loss: 100023.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176305.0156; val_optim_loss: 176305.0156
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9808; val_auprc_score: 0.9956; val_best_acc_score: 0.9670; val_best_f1_score: 0.9807; train_kl_reg_loss: 2060.8264; train_edge_recon_loss: 76547.9537; train_gene_expr_recon_loss: 100618.0569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179226.8382; train_optim_loss: 179226.8382; val_kl_reg_loss: 1988.9790; val_edge_recon_loss: 78056.3281; val_gene_expr_recon_loss: 100267.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180312.6562; val_optim_loss: 180312.6562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9810; val_auprc_score: 0.9956; val_best_acc_score: 0.9668; val_best_f1_score: 0.9808; train_kl_reg_loss: 2055.4553; train_edge_recon_loss: 77229.5519; train_gene_expr_recon_loss: 100373.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179658.2757; train_optim_loss: 179658.2757; val_kl_reg_loss: 1992.9348; val_edge_recon_loss: 76448.5586; val_gene_expr_recon_loss: 100563.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179005.0391; val_optim_loss: 179005.0391
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9833; val_auprc_score: 0.9963; val_best_acc_score: 0.9665; val_best_f1_score: 0.9805; train_kl_reg_loss: 2038.3823; train_edge_recon_loss: 76832.3560; train_gene_expr_recon_loss: 100098.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178969.5391; train_optim_loss: 178969.5391; val_kl_reg_loss: 1957.1912; val_edge_recon_loss: 77340.9141; val_gene_expr_recon_loss: 99737.6992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179035.8125; val_optim_loss: 179035.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9828; val_auprc_score: 0.9958; val_best_acc_score: 0.9691; val_best_f1_score: 0.9821; train_kl_reg_loss: 2026.7130; train_edge_recon_loss: 76656.6596; train_gene_expr_recon_loss: 99991.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178675.2612; train_optim_loss: 178675.2612; val_kl_reg_loss: 1984.3339; val_edge_recon_loss: 74794.0273; val_gene_expr_recon_loss: 99500.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176278.5469; val_optim_loss: 176278.5469
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9820; val_auprc_score: 0.9954; val_best_acc_score: 0.9652; val_best_f1_score: 0.9797; train_kl_reg_loss: 2037.2994; train_edge_recon_loss: 76768.0262; train_gene_expr_recon_loss: 99844.2902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178649.6150; train_optim_loss: 178649.6150; val_kl_reg_loss: 1981.8164; val_edge_recon_loss: 77910.4531; val_gene_expr_recon_loss: 99506.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179398.9844; val_optim_loss: 179398.9844
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9819; val_auprc_score: 0.9960; val_best_acc_score: 0.9660; val_best_f1_score: 0.9802; train_kl_reg_loss: 2033.6185; train_edge_recon_loss: 76102.0686; train_gene_expr_recon_loss: 99897.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178033.6484; train_optim_loss: 178033.6484; val_kl_reg_loss: 1975.1429; val_edge_recon_loss: 78519.5469; val_gene_expr_recon_loss: 100024.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180519.1328; val_optim_loss: 180519.1328
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9825; val_auprc_score: 0.9959; val_best_acc_score: 0.9684; val_best_f1_score: 0.9816; train_kl_reg_loss: 2021.8176; train_edge_recon_loss: 77261.1228; train_gene_expr_recon_loss: 99822.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179105.2891; train_optim_loss: 179105.2891; val_kl_reg_loss: 1965.8973; val_edge_recon_loss: 78089.9219; val_gene_expr_recon_loss: 99961.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180017.4219; val_optim_loss: 180017.4219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9832; val_auprc_score: 0.9962; val_best_acc_score: 0.9677; val_best_f1_score: 0.9813; train_kl_reg_loss: 2023.8625; train_edge_recon_loss: 76876.8337; train_gene_expr_recon_loss: 99886.0257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178786.7221; train_optim_loss: 178786.7221; val_kl_reg_loss: 1970.1475; val_edge_recon_loss: 75977.8750; val_gene_expr_recon_loss: 100000.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177948.7891; val_optim_loss: 177948.7891
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9818; val_auprc_score: 0.9956; val_best_acc_score: 0.9664; val_best_f1_score: 0.9804; train_kl_reg_loss: 2024.0179; train_edge_recon_loss: 76145.1869; train_gene_expr_recon_loss: 99840.9213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178010.1283; train_optim_loss: 178010.1283; val_kl_reg_loss: 1969.2216; val_edge_recon_loss: 77044.9961; val_gene_expr_recon_loss: 99529.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178543.9062; val_optim_loss: 178543.9062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9839; val_auprc_score: 0.9960; val_best_acc_score: 0.9680; val_best_f1_score: 0.9813; train_kl_reg_loss: 2025.1605; train_edge_recon_loss: 77187.5262; train_gene_expr_recon_loss: 99937.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179150.2589; train_optim_loss: 179150.2589; val_kl_reg_loss: 1972.5112; val_edge_recon_loss: 77816.3359; val_gene_expr_recon_loss: 100354.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180143.7578; val_optim_loss: 180143.7578

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 0 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9800
Val AUPRC score: 0.9940
Val best accuracy score: 0.9668
Val best F1 score: 0.9807
Val gene expr MSE score: 1.1208
Duration of model training in run 1: 0 hours, 2 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9692; val_auprc_score: 0.9936; val_best_acc_score: 0.9424; val_best_f1_score: 0.9668; train_kl_reg_loss: 161.8979; train_edge_recon_loss: 101276.1869; train_gene_expr_recon_loss: 122280.0179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223718.1027; train_optim_loss: 223718.1027; val_kl_reg_loss: 138.6302; val_edge_recon_loss: 102113.8867; val_gene_expr_recon_loss: 112166.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214418.8906; val_optim_loss: 214418.8906
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9031; val_auprc_score: 0.9788; val_best_acc_score: 0.9091; val_best_f1_score: 0.9485; train_kl_reg_loss: 502.0602; train_edge_recon_loss: 93824.4213; train_gene_expr_recon_loss: 111425.1256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205751.6083; train_optim_loss: 205751.6083; val_kl_reg_loss: 1609.6336; val_edge_recon_loss: 82090.3359; val_gene_expr_recon_loss: 109454.0508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193154.0234; val_optim_loss: 193154.0234
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9199; val_auprc_score: 0.9825; val_best_acc_score: 0.9164; val_best_f1_score: 0.9524; train_kl_reg_loss: 2925.6993; train_edge_recon_loss: 81514.0647; train_gene_expr_recon_loss: 108866.5073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193306.2723; train_optim_loss: 193306.2723; val_kl_reg_loss: 3155.0293; val_edge_recon_loss: 79103.1797; val_gene_expr_recon_loss: 107634.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189892.8906; val_optim_loss: 189892.8906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9347; val_auprc_score: 0.9854; val_best_acc_score: 0.9214; val_best_f1_score: 0.9547; train_kl_reg_loss: 2640.5069; train_edge_recon_loss: 79829.8287; train_gene_expr_recon_loss: 107122.9671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189593.3002; train_optim_loss: 189593.3002; val_kl_reg_loss: 2093.1189; val_edge_recon_loss: 82305.6367; val_gene_expr_recon_loss: 106324.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190723.3203; val_optim_loss: 190723.3203
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9464; val_auprc_score: 0.9886; val_best_acc_score: 0.9294; val_best_f1_score: 0.9596; train_kl_reg_loss: 2176.4860; train_edge_recon_loss: 79393.0485; train_gene_expr_recon_loss: 105968.0223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187537.5547; train_optim_loss: 187537.5547; val_kl_reg_loss: 2216.1078; val_edge_recon_loss: 78984.3750; val_gene_expr_recon_loss: 105158.8789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186359.3594; val_optim_loss: 186359.3594
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9565; val_auprc_score: 0.9897; val_best_acc_score: 0.9405; val_best_f1_score: 0.9654; train_kl_reg_loss: 2241.7192; train_edge_recon_loss: 78523.9922; train_gene_expr_recon_loss: 104932.1217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185697.8326; train_optim_loss: 185697.8326; val_kl_reg_loss: 2110.5398; val_edge_recon_loss: 79627.8594; val_gene_expr_recon_loss: 104033.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185771.5156; val_optim_loss: 185771.5156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9661; val_auprc_score: 0.9924; val_best_acc_score: 0.9463; val_best_f1_score: 0.9687; train_kl_reg_loss: 2150.3834; train_edge_recon_loss: 78162.4771; train_gene_expr_recon_loss: 104139.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184452.7388; train_optim_loss: 184452.7388; val_kl_reg_loss: 2119.9471; val_edge_recon_loss: 79147.9258; val_gene_expr_recon_loss: 102848.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184116.0703; val_optim_loss: 184116.0703
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9666; val_auprc_score: 0.9913; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 2169.0387; train_edge_recon_loss: 77459.1546; train_gene_expr_recon_loss: 103246.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182874.2701; train_optim_loss: 182874.2701; val_kl_reg_loss: 2094.7864; val_edge_recon_loss: 78835.2031; val_gene_expr_recon_loss: 102390.1602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183320.1484; val_optim_loss: 183320.1484
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9724; val_auprc_score: 0.9934; val_best_acc_score: 0.9557; val_best_f1_score: 0.9744; train_kl_reg_loss: 2155.4357; train_edge_recon_loss: 76909.1189; train_gene_expr_recon_loss: 102677.7556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181742.3092; train_optim_loss: 181742.3092; val_kl_reg_loss: 2085.7480; val_edge_recon_loss: 76019.5742; val_gene_expr_recon_loss: 102498.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180603.3906; val_optim_loss: 180603.3906
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9731; val_auprc_score: 0.9933; val_best_acc_score: 0.9557; val_best_f1_score: 0.9742; train_kl_reg_loss: 2132.9084; train_edge_recon_loss: 77193.2773; train_gene_expr_recon_loss: 102175.5530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181501.7355; train_optim_loss: 181501.7355; val_kl_reg_loss: 2061.9017; val_edge_recon_loss: 81155.2344; val_gene_expr_recon_loss: 101432.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184649.6562; val_optim_loss: 184649.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9738; val_auprc_score: 0.9939; val_best_acc_score: 0.9585; val_best_f1_score: 0.9761; train_kl_reg_loss: 2123.7490; train_edge_recon_loss: 78381.9241; train_gene_expr_recon_loss: 101653.4849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182159.1574; train_optim_loss: 182159.1574; val_kl_reg_loss: 2058.7847; val_edge_recon_loss: 75695.1133; val_gene_expr_recon_loss: 101180.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178934.0156; val_optim_loss: 178934.0156
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9779; val_auprc_score: 0.9946; val_best_acc_score: 0.9609; val_best_f1_score: 0.9774; train_kl_reg_loss: 2112.2746; train_edge_recon_loss: 77663.5826; train_gene_expr_recon_loss: 101240.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181016.0737; train_optim_loss: 181016.0737; val_kl_reg_loss: 2019.4130; val_edge_recon_loss: 74765.5859; val_gene_expr_recon_loss: 101173.5430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177958.5391; val_optim_loss: 177958.5391
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9772; val_auprc_score: 0.9947; val_best_acc_score: 0.9581; val_best_f1_score: 0.9756; train_kl_reg_loss: 2095.8298; train_edge_recon_loss: 76653.6088; train_gene_expr_recon_loss: 100896.7573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179646.1931; train_optim_loss: 179646.1931; val_kl_reg_loss: 2077.1224; val_edge_recon_loss: 80807.4297; val_gene_expr_recon_loss: 100665.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183549.9922; val_optim_loss: 183549.9922
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9791; val_auprc_score: 0.9955; val_best_acc_score: 0.9626; val_best_f1_score: 0.9783; train_kl_reg_loss: 2074.6867; train_edge_recon_loss: 77242.2595; train_gene_expr_recon_loss: 100655.8661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179972.8125; train_optim_loss: 179972.8125; val_kl_reg_loss: 2026.4985; val_edge_recon_loss: 76685.0977; val_gene_expr_recon_loss: 98997.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177708.7656; val_optim_loss: 177708.7656
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9836; val_auprc_score: 0.9968; val_best_acc_score: 0.9639; val_best_f1_score: 0.9791; train_kl_reg_loss: 2054.7776; train_edge_recon_loss: 77457.5731; train_gene_expr_recon_loss: 100216.4113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179728.7623; train_optim_loss: 179728.7623; val_kl_reg_loss: 2003.4417; val_edge_recon_loss: 76054.8477; val_gene_expr_recon_loss: 99455.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177514.1094; val_optim_loss: 177514.1094
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9795; val_auprc_score: 0.9956; val_best_acc_score: 0.9624; val_best_f1_score: 0.9782; train_kl_reg_loss: 2044.9080; train_edge_recon_loss: 76639.6233; train_gene_expr_recon_loss: 99912.6138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178597.1451; train_optim_loss: 178597.1451; val_kl_reg_loss: 1990.6145; val_edge_recon_loss: 77875.3125; val_gene_expr_recon_loss: 99494.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179360.2656; val_optim_loss: 179360.2656
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9832; val_auprc_score: 0.9952; val_best_acc_score: 0.9668; val_best_f1_score: 0.9805; train_kl_reg_loss: 2038.9881; train_edge_recon_loss: 76743.1953; train_gene_expr_recon_loss: 99617.4475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178399.6317; train_optim_loss: 178399.6317; val_kl_reg_loss: 1956.6808; val_edge_recon_loss: 80780.5859; val_gene_expr_recon_loss: 98638.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181375.5703; val_optim_loss: 181375.5703
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9814; val_auprc_score: 0.9959; val_best_acc_score: 0.9634; val_best_f1_score: 0.9787; train_kl_reg_loss: 2020.0849; train_edge_recon_loss: 77142.7188; train_gene_expr_recon_loss: 99440.8795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178603.6842; train_optim_loss: 178603.6842; val_kl_reg_loss: 1974.3484; val_edge_recon_loss: 78341.7344; val_gene_expr_recon_loss: 98622.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178938.7031; val_optim_loss: 178938.7031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9820; val_auprc_score: 0.9957; val_best_acc_score: 0.9664; val_best_f1_score: 0.9805; train_kl_reg_loss: 2024.2890; train_edge_recon_loss: 75761.0441; train_gene_expr_recon_loss: 99257.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177042.9051; train_optim_loss: 177042.9051; val_kl_reg_loss: 1974.7004; val_edge_recon_loss: 76627.0664; val_gene_expr_recon_loss: 99427.7461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178029.5156; val_optim_loss: 178029.5156
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9838; val_auprc_score: 0.9962; val_best_acc_score: 0.9651; val_best_f1_score: 0.9797; train_kl_reg_loss: 2026.7693; train_edge_recon_loss: 77299.9420; train_gene_expr_recon_loss: 99210.0413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178536.7522; train_optim_loss: 178536.7522; val_kl_reg_loss: 1968.0045; val_edge_recon_loss: 76979.7969; val_gene_expr_recon_loss: 98647.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177595.3828; val_optim_loss: 177595.3828
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9805; val_auprc_score: 0.9952; val_best_acc_score: 0.9667; val_best_f1_score: 0.9807; train_kl_reg_loss: 2015.8171; train_edge_recon_loss: 76623.7137; train_gene_expr_recon_loss: 99141.4905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177781.0223; train_optim_loss: 177781.0223; val_kl_reg_loss: 1960.0901; val_edge_recon_loss: 76317.3555; val_gene_expr_recon_loss: 98676.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176953.5469; val_optim_loss: 176953.5469
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9773; val_auprc_score: 0.9942; val_best_acc_score: 0.9635; val_best_f1_score: 0.9789; train_kl_reg_loss: 2010.0863; train_edge_recon_loss: 76450.0156; train_gene_expr_recon_loss: 99093.3951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177553.4989; train_optim_loss: 177553.4989; val_kl_reg_loss: 1966.6077; val_edge_recon_loss: 78033.2305; val_gene_expr_recon_loss: 98827.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178827.1719; val_optim_loss: 178827.1719
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9820; val_auprc_score: 0.9950; val_best_acc_score: 0.9653; val_best_f1_score: 0.9799; train_kl_reg_loss: 2014.6414; train_edge_recon_loss: 77006.1150; train_gene_expr_recon_loss: 98973.1116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177993.8672; train_optim_loss: 177993.8672; val_kl_reg_loss: 1971.1952; val_edge_recon_loss: 77816.4727; val_gene_expr_recon_loss: 98644.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178432.3047; val_optim_loss: 178432.3047
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9827; val_auprc_score: 0.9958; val_best_acc_score: 0.9688; val_best_f1_score: 0.9818; train_kl_reg_loss: 2022.8775; train_edge_recon_loss: 76816.6685; train_gene_expr_recon_loss: 99077.4542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177917.0000; train_optim_loss: 177917.0000; val_kl_reg_loss: 1962.0583; val_edge_recon_loss: 77946.4727; val_gene_expr_recon_loss: 98673.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178581.9688; val_optim_loss: 178581.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9804; val_auprc_score: 0.9957; val_best_acc_score: 0.9655; val_best_f1_score: 0.9800; train_kl_reg_loss: 2012.6825; train_edge_recon_loss: 76182.9397; train_gene_expr_recon_loss: 99036.3175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177231.9397; train_optim_loss: 177231.9397; val_kl_reg_loss: 1961.6671; val_edge_recon_loss: 76749.9336; val_gene_expr_recon_loss: 98604.3242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177315.9219; val_optim_loss: 177315.9219
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9854; val_auprc_score: 0.9962; val_best_acc_score: 0.9685; val_best_f1_score: 0.9817; train_kl_reg_loss: 2013.4426; train_edge_recon_loss: 76546.0876; train_gene_expr_recon_loss: 99034.7528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177594.2812; train_optim_loss: 177594.2812; val_kl_reg_loss: 1958.5305; val_edge_recon_loss: 76011.3750; val_gene_expr_recon_loss: 98321.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176291.7031; val_optim_loss: 176291.7031
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9825; val_auprc_score: 0.9953; val_best_acc_score: 0.9653; val_best_f1_score: 0.9797; train_kl_reg_loss: 2012.0592; train_edge_recon_loss: 77138.3828; train_gene_expr_recon_loss: 99045.7533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178196.1942; train_optim_loss: 178196.1942; val_kl_reg_loss: 1960.8095; val_edge_recon_loss: 80033.3164; val_gene_expr_recon_loss: 98288.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180282.2734; val_optim_loss: 180282.2734
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9819; val_auprc_score: 0.9955; val_best_acc_score: 0.9663; val_best_f1_score: 0.9804; train_kl_reg_loss: 2012.7897; train_edge_recon_loss: 76651.9023; train_gene_expr_recon_loss: 98990.9503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177655.6429; train_optim_loss: 177655.6429; val_kl_reg_loss: 1952.9772; val_edge_recon_loss: 76374.6289; val_gene_expr_recon_loss: 98515.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176842.8125; val_optim_loss: 176842.8125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9830; val_auprc_score: 0.9966; val_best_acc_score: 0.9651; val_best_f1_score: 0.9798; train_kl_reg_loss: 2012.7007; train_edge_recon_loss: 77258.8382; train_gene_expr_recon_loss: 99008.8242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178280.3616; train_optim_loss: 178280.3616; val_kl_reg_loss: 1961.3009; val_edge_recon_loss: 76687.8594; val_gene_expr_recon_loss: 99315.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177964.4531; val_optim_loss: 177964.4531

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9805; val_auprc_score: 0.9954; val_best_acc_score: 0.9659; val_best_f1_score: 0.9801; train_kl_reg_loss: 2011.8322; train_edge_recon_loss: 76817.7930; train_gene_expr_recon_loss: 99058.1205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177887.7467; train_optim_loss: 177887.7467; val_kl_reg_loss: 1949.0253; val_edge_recon_loss: 78695.7539; val_gene_expr_recon_loss: 98094.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178739.5469; val_optim_loss: 178739.5469
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9805; val_auprc_score: 0.9952; val_best_acc_score: 0.9665; val_best_f1_score: 0.9806; train_kl_reg_loss: 2010.9816; train_edge_recon_loss: 76176.0831; train_gene_expr_recon_loss: 99070.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177257.6585; train_optim_loss: 177257.6585; val_kl_reg_loss: 1956.4831; val_edge_recon_loss: 76147.4844; val_gene_expr_recon_loss: 98165.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176269.3828; val_optim_loss: 176269.3828
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9821; val_auprc_score: 0.9955; val_best_acc_score: 0.9665; val_best_f1_score: 0.9805; train_kl_reg_loss: 2011.6433; train_edge_recon_loss: 76974.5022; train_gene_expr_recon_loss: 99014.6964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178000.8426; train_optim_loss: 178000.8426; val_kl_reg_loss: 1958.6365; val_edge_recon_loss: 77849.4219; val_gene_expr_recon_loss: 98701.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178509.4531; val_optim_loss: 178509.4531
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9805; val_auprc_score: 0.9953; val_best_acc_score: 0.9677; val_best_f1_score: 0.9812; train_kl_reg_loss: 2012.2089; train_edge_recon_loss: 77591.9135; train_gene_expr_recon_loss: 99158.9526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178763.0725; train_optim_loss: 178763.0725; val_kl_reg_loss: 1962.8163; val_edge_recon_loss: 76678.2852; val_gene_expr_recon_loss: 98764.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177405.9219; val_optim_loss: 177405.9219
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9804; val_auprc_score: 0.9953; val_best_acc_score: 0.9664; val_best_f1_score: 0.9805; train_kl_reg_loss: 2011.6070; train_edge_recon_loss: 76377.2980; train_gene_expr_recon_loss: 99022.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177411.3058; train_optim_loss: 177411.3058; val_kl_reg_loss: 1964.3378; val_edge_recon_loss: 75430.6445; val_gene_expr_recon_loss: 98692.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176087.1562; val_optim_loss: 176087.1562
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9819; val_auprc_score: 0.9962; val_best_acc_score: 0.9661; val_best_f1_score: 0.9803; train_kl_reg_loss: 2012.3075; train_edge_recon_loss: 76679.3951; train_gene_expr_recon_loss: 99045.9129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177737.6172; train_optim_loss: 177737.6172; val_kl_reg_loss: 1962.9294; val_edge_recon_loss: 76650.5742; val_gene_expr_recon_loss: 98813.5352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177427.0312; val_optim_loss: 177427.0312
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9810; val_auprc_score: 0.9946; val_best_acc_score: 0.9661; val_best_f1_score: 0.9803; train_kl_reg_loss: 2011.5157; train_edge_recon_loss: 77010.5787; train_gene_expr_recon_loss: 98997.8705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178019.9654; train_optim_loss: 178019.9654; val_kl_reg_loss: 1954.4360; val_edge_recon_loss: 76675.1719; val_gene_expr_recon_loss: 98248.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176877.7578; val_optim_loss: 176877.7578
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9801; val_auprc_score: 0.9954; val_best_acc_score: 0.9634; val_best_f1_score: 0.9787; train_kl_reg_loss: 2010.7969; train_edge_recon_loss: 77164.7612; train_gene_expr_recon_loss: 99017.6244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178193.1808; train_optim_loss: 178193.1808; val_kl_reg_loss: 1959.3093; val_edge_recon_loss: 79587.8672; val_gene_expr_recon_loss: 98358.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179905.5547; val_optim_loss: 179905.5547

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9841; val_auprc_score: 0.9968; val_best_acc_score: 0.9667; val_best_f1_score: 0.9806; train_kl_reg_loss: 2011.5926; train_edge_recon_loss: 76093.2835; train_gene_expr_recon_loss: 98957.6574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177062.5324; train_optim_loss: 177062.5324; val_kl_reg_loss: 1957.0153; val_edge_recon_loss: 78390.2500; val_gene_expr_recon_loss: 98630.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178977.2891; val_optim_loss: 178977.2891
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9803; val_auprc_score: 0.9953; val_best_acc_score: 0.9653; val_best_f1_score: 0.9798; train_kl_reg_loss: 2012.0056; train_edge_recon_loss: 77331.0123; train_gene_expr_recon_loss: 99037.5173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178380.5324; train_optim_loss: 178380.5324; val_kl_reg_loss: 1958.5311; val_edge_recon_loss: 77327.4727; val_gene_expr_recon_loss: 98543.8320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177829.8359; val_optim_loss: 177829.8359
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9803; val_auprc_score: 0.9955; val_best_acc_score: 0.9643; val_best_f1_score: 0.9793; train_kl_reg_loss: 2011.8237; train_edge_recon_loss: 76702.3717; train_gene_expr_recon_loss: 99084.1920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177798.3895; train_optim_loss: 177798.3895; val_kl_reg_loss: 1958.9987; val_edge_recon_loss: 77189.6133; val_gene_expr_recon_loss: 98544.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177693.1250; val_optim_loss: 177693.1250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 20 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9835
Val AUPRC score: 0.9965
Val best accuracy score: 0.9676
Val best F1 score: 0.9812
Val gene expr MSE score: 1.0851
Duration of model training in run 2: 0 hours, 3 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9411; val_auprc_score: 0.9879; val_best_acc_score: 0.9272; val_best_f1_score: 0.9583; train_kl_reg_loss: 1324.2337; train_edge_recon_loss: 91210.2499; train_gene_expr_recon_loss: 113499.9801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206034.4629; train_optim_loss: 206034.4629; val_kl_reg_loss: 2321.7637; val_edge_recon_loss: 79551.4466; val_gene_expr_recon_loss: 106574.7370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188447.9453; val_optim_loss: 188447.9453
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9765; val_auprc_score: 0.9951; val_best_acc_score: 0.9569; val_best_f1_score: 0.9750; train_kl_reg_loss: 2130.4224; train_edge_recon_loss: 79354.9093; train_gene_expr_recon_loss: 106144.0246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187629.3564; train_optim_loss: 187629.3564; val_kl_reg_loss: 2069.2793; val_edge_recon_loss: 78392.0547; val_gene_expr_recon_loss: 104779.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185240.9115; val_optim_loss: 185240.9115
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9839; val_auprc_score: 0.9965; val_best_acc_score: 0.9691; val_best_f1_score: 0.9822; train_kl_reg_loss: 2100.8495; train_edge_recon_loss: 77706.4975; train_gene_expr_recon_loss: 103811.4664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183618.8140; train_optim_loss: 183618.8140; val_kl_reg_loss: 2025.1738; val_edge_recon_loss: 75054.1133; val_gene_expr_recon_loss: 102339.6823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179418.9714; val_optim_loss: 179418.9714
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9850; val_auprc_score: 0.9966; val_best_acc_score: 0.9721; val_best_f1_score: 0.9838; train_kl_reg_loss: 2067.5441; train_edge_recon_loss: 77276.5429; train_gene_expr_recon_loss: 102509.7907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181853.8785; train_optim_loss: 181853.8785; val_kl_reg_loss: 2004.8595; val_edge_recon_loss: 75611.5365; val_gene_expr_recon_loss: 101267.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178884.0234; val_optim_loss: 178884.0234
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9863; val_auprc_score: 0.9967; val_best_acc_score: 0.9749; val_best_f1_score: 0.9854; train_kl_reg_loss: 2020.8613; train_edge_recon_loss: 77016.5237; train_gene_expr_recon_loss: 101405.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180442.4879; train_optim_loss: 180442.4879; val_kl_reg_loss: 1928.3381; val_edge_recon_loss: 77425.5208; val_gene_expr_recon_loss: 100490.4310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179844.2917; val_optim_loss: 179844.2917
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9886; val_auprc_score: 0.9971; val_best_acc_score: 0.9756; val_best_f1_score: 0.9858; train_kl_reg_loss: 2002.3281; train_edge_recon_loss: 76993.6766; train_gene_expr_recon_loss: 100433.0883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179429.0938; train_optim_loss: 179429.0938; val_kl_reg_loss: 1953.1720; val_edge_recon_loss: 77088.7083; val_gene_expr_recon_loss: 100093.9896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179135.8672; val_optim_loss: 179135.8672
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9901; val_auprc_score: 0.9976; val_best_acc_score: 0.9790; val_best_f1_score: 0.9878; train_kl_reg_loss: 1980.8444; train_edge_recon_loss: 75817.9148; train_gene_expr_recon_loss: 99831.8152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177630.5731; train_optim_loss: 177630.5731; val_kl_reg_loss: 1932.4386; val_edge_recon_loss: 75860.9935; val_gene_expr_recon_loss: 98847.5534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176640.9844; val_optim_loss: 176640.9844
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9913; val_auprc_score: 0.9975; val_best_acc_score: 0.9794; val_best_f1_score: 0.9879; train_kl_reg_loss: 1974.4345; train_edge_recon_loss: 76578.9208; train_gene_expr_recon_loss: 99190.7838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177744.1386; train_optim_loss: 177744.1386; val_kl_reg_loss: 1939.3601; val_edge_recon_loss: 77219.9388; val_gene_expr_recon_loss: 98561.4089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177720.7083; val_optim_loss: 177720.7083
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9913; val_auprc_score: 0.9980; val_best_acc_score: 0.9803; val_best_f1_score: 0.9886; train_kl_reg_loss: 1964.2039; train_edge_recon_loss: 76355.8098; train_gene_expr_recon_loss: 98597.3339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176917.3470; train_optim_loss: 176917.3470; val_kl_reg_loss: 1898.9176; val_edge_recon_loss: 75618.4688; val_gene_expr_recon_loss: 98461.5495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175978.9375; val_optim_loss: 175978.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9922; val_auprc_score: 0.9982; val_best_acc_score: 0.9811; val_best_f1_score: 0.9889; train_kl_reg_loss: 1969.0398; train_edge_recon_loss: 76591.0228; train_gene_expr_recon_loss: 98164.1713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176724.2338; train_optim_loss: 176724.2338; val_kl_reg_loss: 1907.9030; val_edge_recon_loss: 77128.1315; val_gene_expr_recon_loss: 97627.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176663.6719; val_optim_loss: 176663.6719
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9911; val_auprc_score: 0.9976; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1956.7887; train_edge_recon_loss: 76278.0029; train_gene_expr_recon_loss: 97676.8968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175911.6890; train_optim_loss: 175911.6890; val_kl_reg_loss: 1956.4550; val_edge_recon_loss: 75689.1185; val_gene_expr_recon_loss: 96875.5951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174521.1693; val_optim_loss: 174521.1693
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9922; val_auprc_score: 0.9979; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 1959.7896; train_edge_recon_loss: 76312.7988; train_gene_expr_recon_loss: 97272.6722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175545.2606; train_optim_loss: 175545.2606; val_kl_reg_loss: 1928.8950; val_edge_recon_loss: 76436.0872; val_gene_expr_recon_loss: 96661.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175026.9271; val_optim_loss: 175026.9271
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9931; val_auprc_score: 0.9985; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1954.5916; train_edge_recon_loss: 76013.6720; train_gene_expr_recon_loss: 96803.6434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174771.9074; train_optim_loss: 174771.9074; val_kl_reg_loss: 1951.7202; val_edge_recon_loss: 76779.4544; val_gene_expr_recon_loss: 96115.8451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174847.0234; val_optim_loss: 174847.0234
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9933; val_auprc_score: 0.9985; val_best_acc_score: 0.9835; val_best_f1_score: 0.9903; train_kl_reg_loss: 1958.0759; train_edge_recon_loss: 76006.9055; train_gene_expr_recon_loss: 96510.9449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174475.9266; train_optim_loss: 174475.9266; val_kl_reg_loss: 1907.2663; val_edge_recon_loss: 77126.4401; val_gene_expr_recon_loss: 96192.1341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175225.8411; val_optim_loss: 175225.8411

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9934; val_auprc_score: 0.9985; val_best_acc_score: 0.9846; val_best_f1_score: 0.9910; train_kl_reg_loss: 1954.9989; train_edge_recon_loss: 76304.1216; train_gene_expr_recon_loss: 96264.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174523.9558; train_optim_loss: 174523.9558; val_kl_reg_loss: 1921.3222; val_edge_recon_loss: 75855.5729; val_gene_expr_recon_loss: 95163.7552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172940.6510; val_optim_loss: 172940.6510
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9935; val_auprc_score: 0.9982; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1953.4356; train_edge_recon_loss: 75702.9864; train_gene_expr_recon_loss: 96172.1117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173828.5327; train_optim_loss: 173828.5327; val_kl_reg_loss: 1909.5936; val_edge_recon_loss: 75654.6419; val_gene_expr_recon_loss: 95839.5013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173403.7370; val_optim_loss: 173403.7370
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9928; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1950.4381; train_edge_recon_loss: 76046.3436; train_gene_expr_recon_loss: 96217.6505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174214.4313; train_optim_loss: 174214.4313; val_kl_reg_loss: 1919.2667; val_edge_recon_loss: 76666.9232; val_gene_expr_recon_loss: 95172.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173758.8594; val_optim_loss: 173758.8594
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9919; val_auprc_score: 0.9975; val_best_acc_score: 0.9825; val_best_f1_score: 0.9898; train_kl_reg_loss: 1950.3025; train_edge_recon_loss: 76563.3131; train_gene_expr_recon_loss: 96087.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174601.0029; train_optim_loss: 174601.0029; val_kl_reg_loss: 1922.0076; val_edge_recon_loss: 75816.3359; val_gene_expr_recon_loss: 95612.5260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173350.8698; val_optim_loss: 173350.8698

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9927; val_auprc_score: 0.9982; val_best_acc_score: 0.9834; val_best_f1_score: 0.9904; train_kl_reg_loss: 1954.3570; train_edge_recon_loss: 76098.9721; train_gene_expr_recon_loss: 96081.6397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174134.9667; train_optim_loss: 174134.9667; val_kl_reg_loss: 1915.5177; val_edge_recon_loss: 74913.7161; val_gene_expr_recon_loss: 95763.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172592.9062; val_optim_loss: 172592.9062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9921; val_auprc_score: 0.9980; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 1950.1094; train_edge_recon_loss: 76411.0057; train_gene_expr_recon_loss: 96011.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174372.7102; train_optim_loss: 174372.7102; val_kl_reg_loss: 1917.0038; val_edge_recon_loss: 75576.3932; val_gene_expr_recon_loss: 96015.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173509.1042; val_optim_loss: 173509.1042
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9937; val_auprc_score: 0.9984; val_best_acc_score: 0.9838; val_best_f1_score: 0.9905; train_kl_reg_loss: 1952.6377; train_edge_recon_loss: 76202.4770; train_gene_expr_recon_loss: 96002.0475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174157.1630; train_optim_loss: 174157.1630; val_kl_reg_loss: 1919.7008; val_edge_recon_loss: 77598.0964; val_gene_expr_recon_loss: 95159.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174677.5833; val_optim_loss: 174677.5833
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9932; val_auprc_score: 0.9978; val_best_acc_score: 0.9840; val_best_f1_score: 0.9906; train_kl_reg_loss: 1953.0692; train_edge_recon_loss: 76185.6554; train_gene_expr_recon_loss: 95996.3782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174135.1026; train_optim_loss: 174135.1026; val_kl_reg_loss: 1920.6088; val_edge_recon_loss: 77443.9310; val_gene_expr_recon_loss: 95703.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175068.1146; val_optim_loss: 175068.1146

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9927; val_auprc_score: 0.9978; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 1952.0907; train_edge_recon_loss: 76219.0946; train_gene_expr_recon_loss: 95965.4559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174136.6409; train_optim_loss: 174136.6409; val_kl_reg_loss: 1916.9402; val_edge_recon_loss: 75029.8958; val_gene_expr_recon_loss: 95626.8372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172573.6745; val_optim_loss: 172573.6745
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9916; val_auprc_score: 0.9977; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1951.6044; train_edge_recon_loss: 76117.9791; train_gene_expr_recon_loss: 95970.5752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174040.1571; train_optim_loss: 174040.1571; val_kl_reg_loss: 1914.4900; val_edge_recon_loss: 77772.7331; val_gene_expr_recon_loss: 95860.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175547.3411; val_optim_loss: 175547.3411
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9840; val_best_f1_score: 0.9907; train_kl_reg_loss: 1951.2812; train_edge_recon_loss: 75956.0531; train_gene_expr_recon_loss: 95964.4746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173871.8072; train_optim_loss: 173871.8072; val_kl_reg_loss: 1915.4776; val_edge_recon_loss: 75858.7448; val_gene_expr_recon_loss: 95202.8490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172977.0703; val_optim_loss: 172977.0703
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9917; val_auprc_score: 0.9980; val_best_acc_score: 0.9840; val_best_f1_score: 0.9907; train_kl_reg_loss: 1951.2021; train_edge_recon_loss: 75742.3636; train_gene_expr_recon_loss: 95999.1750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173692.7409; train_optim_loss: 173692.7409; val_kl_reg_loss: 1915.4492; val_edge_recon_loss: 76094.4661; val_gene_expr_recon_loss: 95540.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173550.0156; val_optim_loss: 173550.0156

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9931; val_auprc_score: 0.9980; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1951.1886; train_edge_recon_loss: 76076.7706; train_gene_expr_recon_loss: 95998.4642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174026.4233; train_optim_loss: 174026.4233; val_kl_reg_loss: 1919.1934; val_edge_recon_loss: 76693.1940; val_gene_expr_recon_loss: 95257.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173870.0182; val_optim_loss: 173870.0182
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9919; val_auprc_score: 0.9976; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1950.6054; train_edge_recon_loss: 76379.0283; train_gene_expr_recon_loss: 96141.3589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174470.9935; train_optim_loss: 174470.9935; val_kl_reg_loss: 1914.5827; val_edge_recon_loss: 76370.5013; val_gene_expr_recon_loss: 95309.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173594.9714; val_optim_loss: 173594.9714
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9925; val_auprc_score: 0.9981; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1951.3468; train_edge_recon_loss: 76394.9418; train_gene_expr_recon_loss: 96080.2193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174426.5097; train_optim_loss: 174426.5097; val_kl_reg_loss: 1917.8705; val_edge_recon_loss: 75946.5156; val_gene_expr_recon_loss: 96477.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174341.7943; val_optim_loss: 174341.7943

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 47 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9914
Val AUPRC score: 0.9977
Val best accuracy score: 0.9841
Val best F1 score: 0.9907
Val gene expr MSE score: 0.9570
Duration of model training in run 3: 0 hours, 5 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9470; val_auprc_score: 0.9892; val_best_acc_score: 0.9318; val_best_f1_score: 0.9609; train_kl_reg_loss: 1403.4235; train_edge_recon_loss: 90617.2255; train_gene_expr_recon_loss: 113161.4384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205182.0858; train_optim_loss: 205182.0858; val_kl_reg_loss: 2299.6128; val_edge_recon_loss: 79763.1979; val_gene_expr_recon_loss: 107622.7240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189685.5312; val_optim_loss: 189685.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9761; val_auprc_score: 0.9948; val_best_acc_score: 0.9605; val_best_f1_score: 0.9771; train_kl_reg_loss: 2163.4041; train_edge_recon_loss: 78325.6091; train_gene_expr_recon_loss: 105902.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186391.6648; train_optim_loss: 186391.6648; val_kl_reg_loss: 2097.3374; val_edge_recon_loss: 77602.4974; val_gene_expr_recon_loss: 104069.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183769.1328; val_optim_loss: 183769.1328
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9809; val_auprc_score: 0.9955; val_best_acc_score: 0.9675; val_best_f1_score: 0.9810; train_kl_reg_loss: 2134.4452; train_edge_recon_loss: 77666.3243; train_gene_expr_recon_loss: 103630.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183431.4216; train_optim_loss: 183431.4216; val_kl_reg_loss: 2093.2502; val_edge_recon_loss: 78552.4466; val_gene_expr_recon_loss: 102008.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182654.4036; val_optim_loss: 182654.4036
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9830; val_auprc_score: 0.9959; val_best_acc_score: 0.9698; val_best_f1_score: 0.9824; train_kl_reg_loss: 2095.7539; train_edge_recon_loss: 76678.3757; train_gene_expr_recon_loss: 102147.3069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180921.4369; train_optim_loss: 180921.4369; val_kl_reg_loss: 2024.6993; val_edge_recon_loss: 76115.5924; val_gene_expr_recon_loss: 100876.7357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179017.0208; val_optim_loss: 179017.0208
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9858; val_auprc_score: 0.9971; val_best_acc_score: 0.9712; val_best_f1_score: 0.9832; train_kl_reg_loss: 2061.8835; train_edge_recon_loss: 77249.0744; train_gene_expr_recon_loss: 101069.8541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180380.8110; train_optim_loss: 180380.8110; val_kl_reg_loss: 2004.3330; val_edge_recon_loss: 75852.2617; val_gene_expr_recon_loss: 100920.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178777.1276; val_optim_loss: 178777.1276
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9871; val_auprc_score: 0.9967; val_best_acc_score: 0.9751; val_best_f1_score: 0.9855; train_kl_reg_loss: 2021.0619; train_edge_recon_loss: 76719.5003; train_gene_expr_recon_loss: 100253.5380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178994.0999; train_optim_loss: 178994.0999; val_kl_reg_loss: 1949.5749; val_edge_recon_loss: 77831.5573; val_gene_expr_recon_loss: 100258.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180039.4609; val_optim_loss: 180039.4609
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9903; val_auprc_score: 0.9978; val_best_acc_score: 0.9773; val_best_f1_score: 0.9867; train_kl_reg_loss: 1996.6757; train_edge_recon_loss: 76484.7211; train_gene_expr_recon_loss: 99566.2720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178047.6695; train_optim_loss: 178047.6695; val_kl_reg_loss: 1957.6511; val_edge_recon_loss: 76699.4831; val_gene_expr_recon_loss: 99393.9193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178051.0547; val_optim_loss: 178051.0547
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9889; val_auprc_score: 0.9969; val_best_acc_score: 0.9776; val_best_f1_score: 0.9869; train_kl_reg_loss: 1993.6526; train_edge_recon_loss: 76859.7058; train_gene_expr_recon_loss: 98977.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177831.1675; train_optim_loss: 177831.1675; val_kl_reg_loss: 1917.7646; val_edge_recon_loss: 76616.6693; val_gene_expr_recon_loss: 98659.7995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177194.2318; val_optim_loss: 177194.2318
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9912; val_auprc_score: 0.9982; val_best_acc_score: 0.9780; val_best_f1_score: 0.9872; train_kl_reg_loss: 1979.7508; train_edge_recon_loss: 76763.3948; train_gene_expr_recon_loss: 98349.0032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177092.1501; train_optim_loss: 177092.1501; val_kl_reg_loss: 1976.3500; val_edge_recon_loss: 76972.3021; val_gene_expr_recon_loss: 97628.7005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176577.3542; val_optim_loss: 176577.3542
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9913; val_auprc_score: 0.9981; val_best_acc_score: 0.9803; val_best_f1_score: 0.9885; train_kl_reg_loss: 1975.1429; train_edge_recon_loss: 76020.6697; train_gene_expr_recon_loss: 97988.2050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175984.0165; train_optim_loss: 175984.0165; val_kl_reg_loss: 1899.6909; val_edge_recon_loss: 76931.0977; val_gene_expr_recon_loss: 97634.2995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176465.0859; val_optim_loss: 176465.0859
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9920; val_auprc_score: 0.9982; val_best_acc_score: 0.9812; val_best_f1_score: 0.9891; train_kl_reg_loss: 1970.1474; train_edge_recon_loss: 76163.6787; train_gene_expr_recon_loss: 97393.3796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175527.2064; train_optim_loss: 175527.2064; val_kl_reg_loss: 1939.9495; val_edge_recon_loss: 75245.8281; val_gene_expr_recon_loss: 97409.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174594.7865; val_optim_loss: 174594.7865
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9925; val_auprc_score: 0.9984; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1960.6316; train_edge_recon_loss: 75659.3784; train_gene_expr_recon_loss: 96968.1108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174588.1206; train_optim_loss: 174588.1206; val_kl_reg_loss: 1987.7075; val_edge_recon_loss: 76719.4245; val_gene_expr_recon_loss: 96205.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174912.8255; val_optim_loss: 174912.8255
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9917; val_auprc_score: 0.9980; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 1975.4723; train_edge_recon_loss: 76422.4095; train_gene_expr_recon_loss: 96614.6617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175012.5436; train_optim_loss: 175012.5436; val_kl_reg_loss: 1960.2767; val_edge_recon_loss: 77409.6667; val_gene_expr_recon_loss: 95842.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175212.8385; val_optim_loss: 175212.8385
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 1972.0669; train_edge_recon_loss: 76493.6514; train_gene_expr_recon_loss: 96314.6517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174780.3712; train_optim_loss: 174780.3712; val_kl_reg_loss: 1925.2551; val_edge_recon_loss: 77733.2669; val_gene_expr_recon_loss: 95766.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175425.1354; val_optim_loss: 175425.1354

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9918; val_auprc_score: 0.9981; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1966.2452; train_edge_recon_loss: 76593.6919; train_gene_expr_recon_loss: 95827.2964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174387.2347; train_optim_loss: 174387.2347; val_kl_reg_loss: 1934.7942; val_edge_recon_loss: 77480.4570; val_gene_expr_recon_loss: 94730.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174145.8958; val_optim_loss: 174145.8958
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9923; val_auprc_score: 0.9978; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1966.7843; train_edge_recon_loss: 76253.7964; train_gene_expr_recon_loss: 95852.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174073.3532; train_optim_loss: 174073.3532; val_kl_reg_loss: 1928.1616; val_edge_recon_loss: 75722.8411; val_gene_expr_recon_loss: 95173.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172824.6953; val_optim_loss: 172824.6953
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9929; val_auprc_score: 0.9984; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1961.3777; train_edge_recon_loss: 75574.6156; train_gene_expr_recon_loss: 95810.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173346.5876; train_optim_loss: 173346.5876; val_kl_reg_loss: 1929.4761; val_edge_recon_loss: 77512.4479; val_gene_expr_recon_loss: 96112.7227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175554.6458; val_optim_loss: 175554.6458
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9985; val_best_acc_score: 0.9833; val_best_f1_score: 0.9902; train_kl_reg_loss: 1961.4661; train_edge_recon_loss: 75243.7998; train_gene_expr_recon_loss: 95805.5995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173010.8653; train_optim_loss: 173010.8653; val_kl_reg_loss: 1931.2785; val_edge_recon_loss: 76319.1810; val_gene_expr_recon_loss: 95717.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173968.1250; val_optim_loss: 173968.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9924; val_auprc_score: 0.9979; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1962.5916; train_edge_recon_loss: 76182.9671; train_gene_expr_recon_loss: 95787.0248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173932.5828; train_optim_loss: 173932.5828; val_kl_reg_loss: 1926.8011; val_edge_recon_loss: 76395.0990; val_gene_expr_recon_loss: 95793.8724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174115.7734; val_optim_loss: 174115.7734

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9910; val_auprc_score: 0.9975; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1958.3521; train_edge_recon_loss: 75861.5556; train_gene_expr_recon_loss: 95663.9947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173483.9018; train_optim_loss: 173483.9018; val_kl_reg_loss: 1923.3478; val_edge_recon_loss: 77054.3880; val_gene_expr_recon_loss: 95154.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174131.8698; val_optim_loss: 174131.8698
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9920; val_auprc_score: 0.9977; val_best_acc_score: 0.9826; val_best_f1_score: 0.9898; train_kl_reg_loss: 1957.1299; train_edge_recon_loss: 75821.6085; train_gene_expr_recon_loss: 95680.3013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173459.0374; train_optim_loss: 173459.0374; val_kl_reg_loss: 1924.8319; val_edge_recon_loss: 77093.4388; val_gene_expr_recon_loss: 94874.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173892.7161; val_optim_loss: 173892.7161
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9930; val_auprc_score: 0.9979; val_best_acc_score: 0.9827; val_best_f1_score: 0.9899; train_kl_reg_loss: 1960.5799; train_edge_recon_loss: 76212.6349; train_gene_expr_recon_loss: 95626.0111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173799.2261; train_optim_loss: 173799.2261; val_kl_reg_loss: 1925.9977; val_edge_recon_loss: 76307.4427; val_gene_expr_recon_loss: 95162.2214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173395.6589; val_optim_loss: 173395.6589

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 15 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9941
Val AUPRC score: 0.9988
Val best accuracy score: 0.9841
Val best F1 score: 0.9907
Val gene expr MSE score: 1.0127
Duration of model training in run 4: 0 hours, 4 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9815; val_auprc_score: 0.9960; val_best_acc_score: 0.9660; val_best_f1_score: 0.9803; train_kl_reg_loss: 1762.7399; train_edge_recon_loss: 83615.0571; train_gene_expr_recon_loss: 108909.7567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194287.5539; train_optim_loss: 194287.5539; val_kl_reg_loss: 2085.0433; val_edge_recon_loss: 76719.4640; val_gene_expr_recon_loss: 104601.1558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183405.6641; val_optim_loss: 183405.6641
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9887; val_auprc_score: 0.9974; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 2034.3514; train_edge_recon_loss: 77063.0172; train_gene_expr_recon_loss: 102377.0975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181474.4659; train_optim_loss: 181474.4659; val_kl_reg_loss: 1936.9106; val_edge_recon_loss: 76839.1228; val_gene_expr_recon_loss: 101868.6836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180644.7170; val_optim_loss: 180644.7170
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9917; val_auprc_score: 0.9981; val_best_acc_score: 0.9800; val_best_f1_score: 0.9884; train_kl_reg_loss: 1975.4258; train_edge_recon_loss: 76701.5234; train_gene_expr_recon_loss: 100179.0280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178855.9778; train_optim_loss: 178855.9778; val_kl_reg_loss: 1941.9528; val_edge_recon_loss: 76845.1076; val_gene_expr_recon_loss: 100507.0360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179294.0964; val_optim_loss: 179294.0964
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9909; val_auprc_score: 0.9978; val_best_acc_score: 0.9816; val_best_f1_score: 0.9892; train_kl_reg_loss: 1953.9043; train_edge_recon_loss: 76523.0071; train_gene_expr_recon_loss: 98843.0328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177319.9443; train_optim_loss: 177319.9443; val_kl_reg_loss: 1916.7314; val_edge_recon_loss: 76830.9900; val_gene_expr_recon_loss: 99493.5065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178241.2266; val_optim_loss: 178241.2266
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1950.3982; train_edge_recon_loss: 76351.7886; train_gene_expr_recon_loss: 97839.3973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176141.5836; train_optim_loss: 176141.5836; val_kl_reg_loss: 1952.4410; val_edge_recon_loss: 74527.5460; val_gene_expr_recon_loss: 98029.4201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174509.4071; val_optim_loss: 174509.4071
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9922; val_auprc_score: 0.9977; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1950.8323; train_edge_recon_loss: 76418.9460; train_gene_expr_recon_loss: 96907.4763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175277.2542; train_optim_loss: 175277.2542; val_kl_reg_loss: 1961.5639; val_edge_recon_loss: 77804.4227; val_gene_expr_recon_loss: 97318.9036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177084.8915; val_optim_loss: 177084.8915
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9942; val_auprc_score: 0.9984; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 1955.6007; train_edge_recon_loss: 76085.3780; train_gene_expr_recon_loss: 96106.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174147.4188; train_optim_loss: 174147.4188; val_kl_reg_loss: 1972.6003; val_edge_recon_loss: 77431.9054; val_gene_expr_recon_loss: 96431.5864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175836.0938; val_optim_loss: 175836.0938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9985; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1963.0869; train_edge_recon_loss: 76157.9780; train_gene_expr_recon_loss: 95453.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173574.0942; train_optim_loss: 173574.0942; val_kl_reg_loss: 1962.0722; val_edge_recon_loss: 75200.2561; val_gene_expr_recon_loss: 95887.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173049.3516; val_optim_loss: 173049.3516
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9938; val_auprc_score: 0.9982; val_best_acc_score: 0.9874; val_best_f1_score: 0.9927; train_kl_reg_loss: 1965.3512; train_edge_recon_loss: 75849.9931; train_gene_expr_recon_loss: 94870.5843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172685.9285; train_optim_loss: 172685.9285; val_kl_reg_loss: 1932.2682; val_edge_recon_loss: 74608.6107; val_gene_expr_recon_loss: 95390.1141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171930.9931; val_optim_loss: 171930.9931
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9949; val_auprc_score: 0.9989; val_best_acc_score: 0.9879; val_best_f1_score: 0.9930; train_kl_reg_loss: 1973.0194; train_edge_recon_loss: 76349.3046; train_gene_expr_recon_loss: 94282.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172604.8568; train_optim_loss: 172604.8568; val_kl_reg_loss: 1953.6396; val_edge_recon_loss: 75615.1115; val_gene_expr_recon_loss: 95173.3420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172742.0911; val_optim_loss: 172742.0911
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9946; val_auprc_score: 0.9985; val_best_acc_score: 0.9881; val_best_f1_score: 0.9930; train_kl_reg_loss: 1978.8890; train_edge_recon_loss: 76122.4104; train_gene_expr_recon_loss: 93811.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171912.6019; train_optim_loss: 171912.6019; val_kl_reg_loss: 1956.7788; val_edge_recon_loss: 76076.9865; val_gene_expr_recon_loss: 94373.8008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172407.5686; val_optim_loss: 172407.5686
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9949; val_auprc_score: 0.9986; val_best_acc_score: 0.9881; val_best_f1_score: 0.9931; train_kl_reg_loss: 1988.4812; train_edge_recon_loss: 75919.0616; train_gene_expr_recon_loss: 93483.6385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171391.1813; train_optim_loss: 171391.1813; val_kl_reg_loss: 1971.9639; val_edge_recon_loss: 74622.1927; val_gene_expr_recon_loss: 93986.2487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170580.4054; val_optim_loss: 170580.4054
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9946; val_auprc_score: 0.9985; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 1993.6190; train_edge_recon_loss: 76084.0032; train_gene_expr_recon_loss: 93081.9117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171159.5343; train_optim_loss: 171159.5343; val_kl_reg_loss: 1978.7676; val_edge_recon_loss: 75070.1597; val_gene_expr_recon_loss: 93581.6897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170630.6172; val_optim_loss: 170630.6172
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9952; val_auprc_score: 0.9986; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 2001.9606; train_edge_recon_loss: 76437.7098; train_gene_expr_recon_loss: 92778.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171218.5726; train_optim_loss: 171218.5726; val_kl_reg_loss: 1969.9104; val_edge_recon_loss: 75922.6602; val_gene_expr_recon_loss: 93287.2183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171179.7873; val_optim_loss: 171179.7873
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9952; val_auprc_score: 0.9985; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 2001.0001; train_edge_recon_loss: 75884.3890; train_gene_expr_recon_loss: 92502.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170387.9943; train_optim_loss: 170387.9943; val_kl_reg_loss: 1957.6656; val_edge_recon_loss: 77095.0942; val_gene_expr_recon_loss: 93314.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172366.9340; val_optim_loss: 172366.9340

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9951; val_auprc_score: 0.9989; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 2004.1299; train_edge_recon_loss: 75594.9784; train_gene_expr_recon_loss: 92101.6941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169700.8023; train_optim_loss: 169700.8023; val_kl_reg_loss: 1980.9710; val_edge_recon_loss: 74840.9401; val_gene_expr_recon_loss: 92894.4996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169716.4106; val_optim_loss: 169716.4106
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9983; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 2006.7481; train_edge_recon_loss: 75503.4997; train_gene_expr_recon_loss: 92026.4088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169536.6564; train_optim_loss: 169536.6564; val_kl_reg_loss: 1986.1897; val_edge_recon_loss: 76327.8251; val_gene_expr_recon_loss: 92838.1949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171152.2127; val_optim_loss: 171152.2127
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9988; val_best_acc_score: 0.9893; val_best_f1_score: 0.9938; train_kl_reg_loss: 2004.0060; train_edge_recon_loss: 76059.8142; train_gene_expr_recon_loss: 91991.5924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170055.4128; train_optim_loss: 170055.4128; val_kl_reg_loss: 1973.0524; val_edge_recon_loss: 76222.0117; val_gene_expr_recon_loss: 92910.3168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171105.3837; val_optim_loss: 171105.3837
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9962; val_auprc_score: 0.9991; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 2001.5710; train_edge_recon_loss: 75589.8887; train_gene_expr_recon_loss: 91961.3663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169552.8257; train_optim_loss: 169552.8257; val_kl_reg_loss: 1976.3886; val_edge_recon_loss: 75648.9753; val_gene_expr_recon_loss: 92773.4970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170398.8611; val_optim_loss: 170398.8611

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9988; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 2001.7557; train_edge_recon_loss: 75985.4579; train_gene_expr_recon_loss: 91888.0727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169875.2865; train_optim_loss: 169875.2865; val_kl_reg_loss: 1980.9956; val_edge_recon_loss: 76897.9262; val_gene_expr_recon_loss: 92917.8902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171796.8099; val_optim_loss: 171796.8099
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9989; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 2002.4023; train_edge_recon_loss: 75559.3358; train_gene_expr_recon_loss: 91789.4126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169351.1511; train_optim_loss: 169351.1511; val_kl_reg_loss: 1981.1592; val_edge_recon_loss: 77061.0247; val_gene_expr_recon_loss: 92642.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171684.3420; val_optim_loss: 171684.3420
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9949; val_auprc_score: 0.9987; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 2003.9599; train_edge_recon_loss: 76125.2278; train_gene_expr_recon_loss: 91870.5123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169999.6999; train_optim_loss: 169999.6999; val_kl_reg_loss: 1981.4794; val_edge_recon_loss: 76511.7344; val_gene_expr_recon_loss: 92806.2648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171299.4757; val_optim_loss: 171299.4757

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 48 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9951
Val AUPRC score: 0.9983
Val best accuracy score: 0.9880
Val best F1 score: 0.9930
Val gene expr MSE score: 0.9228
Duration of model training in run 5: 0 hours, 9 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9830; val_auprc_score: 0.9960; val_best_acc_score: 0.9665; val_best_f1_score: 0.9806; train_kl_reg_loss: 1805.1702; train_edge_recon_loss: 83256.6179; train_gene_expr_recon_loss: 108558.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193620.2620; train_optim_loss: 193620.2620; val_kl_reg_loss: 2104.5465; val_edge_recon_loss: 77699.3346; val_gene_expr_recon_loss: 104946.0608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184749.9427; val_optim_loss: 184749.9427
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9873; val_auprc_score: 0.9968; val_best_acc_score: 0.9762; val_best_f1_score: 0.9861; train_kl_reg_loss: 2053.1771; train_edge_recon_loss: 77591.4987; train_gene_expr_recon_loss: 102190.9298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181835.6061; train_optim_loss: 181835.6061; val_kl_reg_loss: 2026.2555; val_edge_recon_loss: 75770.4449; val_gene_expr_recon_loss: 101659.5378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179456.2413; val_optim_loss: 179456.2413
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9916; val_auprc_score: 0.9980; val_best_acc_score: 0.9804; val_best_f1_score: 0.9885; train_kl_reg_loss: 1981.6471; train_edge_recon_loss: 77140.4203; train_gene_expr_recon_loss: 100108.8468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179230.9145; train_optim_loss: 179230.9145; val_kl_reg_loss: 1914.2785; val_edge_recon_loss: 77425.8611; val_gene_expr_recon_loss: 99680.1549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179020.2925; val_optim_loss: 179020.2925
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9921; val_auprc_score: 0.9981; val_best_acc_score: 0.9814; val_best_f1_score: 0.9892; train_kl_reg_loss: 1962.3566; train_edge_recon_loss: 76688.6218; train_gene_expr_recon_loss: 98655.7632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177306.7413; train_optim_loss: 177306.7413; val_kl_reg_loss: 1938.9793; val_edge_recon_loss: 76668.4935; val_gene_expr_recon_loss: 98865.7465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177473.2205; val_optim_loss: 177473.2205
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9980; val_best_acc_score: 0.9839; val_best_f1_score: 0.9905; train_kl_reg_loss: 1958.0344; train_edge_recon_loss: 76600.0645; train_gene_expr_recon_loss: 97603.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176161.7573; train_optim_loss: 176161.7573; val_kl_reg_loss: 1940.2161; val_edge_recon_loss: 77081.5807; val_gene_expr_recon_loss: 97633.0408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176654.8385; val_optim_loss: 176654.8385
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9931; val_auprc_score: 0.9980; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 1951.8230; train_edge_recon_loss: 76108.1606; train_gene_expr_recon_loss: 96802.5888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174862.5720; train_optim_loss: 174862.5720; val_kl_reg_loss: 1914.5733; val_edge_recon_loss: 75369.9470; val_gene_expr_recon_loss: 96670.7040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173955.2231; val_optim_loss: 173955.2231
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9934; val_auprc_score: 0.9984; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 1957.5924; train_edge_recon_loss: 76200.3160; train_gene_expr_recon_loss: 96020.3143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174178.2222; train_optim_loss: 174178.2222; val_kl_reg_loss: 1927.6233; val_edge_recon_loss: 75520.8859; val_gene_expr_recon_loss: 96555.5460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174004.0547; val_optim_loss: 174004.0547
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9930; val_auprc_score: 0.9982; val_best_acc_score: 0.9862; val_best_f1_score: 0.9919; train_kl_reg_loss: 1961.1619; train_edge_recon_loss: 76520.3757; train_gene_expr_recon_loss: 95314.8048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173796.3422; train_optim_loss: 173796.3422; val_kl_reg_loss: 1937.8401; val_edge_recon_loss: 75833.0651; val_gene_expr_recon_loss: 95575.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173346.2708; val_optim_loss: 173346.2708
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9943; val_auprc_score: 0.9981; val_best_acc_score: 0.9872; val_best_f1_score: 0.9925; train_kl_reg_loss: 1967.0629; train_edge_recon_loss: 76112.3676; train_gene_expr_recon_loss: 94780.6234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172860.0547; train_optim_loss: 172860.0547; val_kl_reg_loss: 1943.7461; val_edge_recon_loss: 76250.0864; val_gene_expr_recon_loss: 95134.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173328.5165; val_optim_loss: 173328.5165
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9985; val_best_acc_score: 0.9874; val_best_f1_score: 0.9927; train_kl_reg_loss: 1969.3549; train_edge_recon_loss: 76148.7095; train_gene_expr_recon_loss: 94190.8729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172308.9373; train_optim_loss: 172308.9373; val_kl_reg_loss: 1977.1248; val_edge_recon_loss: 75815.9410; val_gene_expr_recon_loss: 94782.4987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172575.5642; val_optim_loss: 172575.5642
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9937; val_auprc_score: 0.9980; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1977.5644; train_edge_recon_loss: 75953.6224; train_gene_expr_recon_loss: 93857.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171788.7529; train_optim_loss: 171788.7529; val_kl_reg_loss: 1950.5765; val_edge_recon_loss: 75993.8793; val_gene_expr_recon_loss: 94214.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172158.6146; val_optim_loss: 172158.6146
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9947; val_auprc_score: 0.9984; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1981.0220; train_edge_recon_loss: 75895.3613; train_gene_expr_recon_loss: 93405.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171281.6654; train_optim_loss: 171281.6654; val_kl_reg_loss: 1957.0970; val_edge_recon_loss: 74900.3715; val_gene_expr_recon_loss: 93839.2205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170696.6884; val_optim_loss: 170696.6884
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9951; val_auprc_score: 0.9989; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1985.6412; train_edge_recon_loss: 75472.7480; train_gene_expr_recon_loss: 93010.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170469.0155; train_optim_loss: 170469.0155; val_kl_reg_loss: 1995.0962; val_edge_recon_loss: 75670.5299; val_gene_expr_recon_loss: 93553.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171218.8064; val_optim_loss: 171218.8064
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9952; val_auprc_score: 0.9988; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1993.9241; train_edge_recon_loss: 75885.0894; train_gene_expr_recon_loss: 92742.5279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170621.5413; train_optim_loss: 170621.5413; val_kl_reg_loss: 1964.2217; val_edge_recon_loss: 75163.5078; val_gene_expr_recon_loss: 93278.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170406.5885; val_optim_loss: 170406.5885
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9947; val_auprc_score: 0.9984; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 2001.4951; train_edge_recon_loss: 75869.8298; train_gene_expr_recon_loss: 92445.6777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170317.0024; train_optim_loss: 170317.0024; val_kl_reg_loss: 1998.9012; val_edge_recon_loss: 75400.1875; val_gene_expr_recon_loss: 92856.7990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170255.8872; val_optim_loss: 170255.8872
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9954; val_auprc_score: 0.9989; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 2002.0848; train_edge_recon_loss: 75650.2395; train_gene_expr_recon_loss: 92140.1185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169792.4419; train_optim_loss: 169792.4419; val_kl_reg_loss: 1978.1791; val_edge_recon_loss: 76619.2431; val_gene_expr_recon_loss: 92750.6419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171348.0642; val_optim_loss: 171348.0642
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9949; val_auprc_score: 0.9987; val_best_acc_score: 0.9897; val_best_f1_score: 0.9940; train_kl_reg_loss: 2005.9379; train_edge_recon_loss: 75533.5562; train_gene_expr_recon_loss: 91957.1101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169496.6030; train_optim_loss: 169496.6030; val_kl_reg_loss: 1971.2018; val_edge_recon_loss: 74967.9744; val_gene_expr_recon_loss: 92304.8442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169244.0191; val_optim_loss: 169244.0191
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9959; val_auprc_score: 0.9990; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 2016.1252; train_edge_recon_loss: 75791.6857; train_gene_expr_recon_loss: 91708.5856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169516.3971; train_optim_loss: 169516.3971; val_kl_reg_loss: 1987.1927; val_edge_recon_loss: 77088.8720; val_gene_expr_recon_loss: 92120.8863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171196.9514; val_optim_loss: 171196.9514
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9989; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 2021.0474; train_edge_recon_loss: 75724.4270; train_gene_expr_recon_loss: 91577.3222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169322.7963; train_optim_loss: 169322.7963; val_kl_reg_loss: 2007.0242; val_edge_recon_loss: 76067.0720; val_gene_expr_recon_loss: 91941.1697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170015.2648; val_optim_loss: 170015.2648
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9990; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 2022.6098; train_edge_recon_loss: 75986.6101; train_gene_expr_recon_loss: 91315.1726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169324.3922; train_optim_loss: 169324.3922; val_kl_reg_loss: 1988.2782; val_edge_recon_loss: 75809.6784; val_gene_expr_recon_loss: 92040.9210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169838.8776; val_optim_loss: 169838.8776

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9990; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 2025.2728; train_edge_recon_loss: 76072.3146; train_gene_expr_recon_loss: 90973.5473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169071.1356; train_optim_loss: 169071.1356; val_kl_reg_loss: 1994.4177; val_edge_recon_loss: 74342.1276; val_gene_expr_recon_loss: 91747.8411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168084.3872; val_optim_loss: 168084.3872
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9942; val_auprc_score: 0.9984; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 2025.2031; train_edge_recon_loss: 75781.7903; train_gene_expr_recon_loss: 90966.9384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168773.9314; train_optim_loss: 168773.9314; val_kl_reg_loss: 2003.0558; val_edge_recon_loss: 75798.4800; val_gene_expr_recon_loss: 91748.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169549.9201; val_optim_loss: 169549.9201
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9961; val_auprc_score: 0.9990; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 2019.9669; train_edge_recon_loss: 75679.1921; train_gene_expr_recon_loss: 90927.2479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168626.4062; train_optim_loss: 168626.4062; val_kl_reg_loss: 1993.8316; val_edge_recon_loss: 76578.2426; val_gene_expr_recon_loss: 91557.8793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170129.9514; val_optim_loss: 170129.9514
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9959; val_auprc_score: 0.9988; val_best_acc_score: 0.9896; val_best_f1_score: 0.9939; train_kl_reg_loss: 2022.1063; train_edge_recon_loss: 75880.5678; train_gene_expr_recon_loss: 90903.6038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168806.2776; train_optim_loss: 168806.2776; val_kl_reg_loss: 2002.6961; val_edge_recon_loss: 75630.8672; val_gene_expr_recon_loss: 91802.6888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169436.2543; val_optim_loss: 169436.2543

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9952; val_auprc_score: 0.9988; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 2020.0471; train_edge_recon_loss: 75875.9934; train_gene_expr_recon_loss: 90850.1075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168746.1483; train_optim_loss: 168746.1483; val_kl_reg_loss: 2002.5641; val_edge_recon_loss: 75974.6172; val_gene_expr_recon_loss: 91527.5829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169504.7630; val_optim_loss: 169504.7630
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9958; val_auprc_score: 0.9991; val_best_acc_score: 0.9896; val_best_f1_score: 0.9939; train_kl_reg_loss: 2019.9812; train_edge_recon_loss: 75860.8452; train_gene_expr_recon_loss: 90894.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168775.2220; train_optim_loss: 168775.2220; val_kl_reg_loss: 1998.7149; val_edge_recon_loss: 75099.7732; val_gene_expr_recon_loss: 91642.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168740.8906; val_optim_loss: 168740.8906
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9991; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 2018.1749; train_edge_recon_loss: 75849.6370; train_gene_expr_recon_loss: 90810.0658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168677.8776; train_optim_loss: 168677.8776; val_kl_reg_loss: 2000.2977; val_edge_recon_loss: 74889.5035; val_gene_expr_recon_loss: 91697.2977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168587.0998; val_optim_loss: 168587.0998

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 47 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9991
Val best accuracy score: 0.9901
Val best F1 score: 0.9942
Val gene expr MSE score: 0.9296
Duration of model training in run 6: 0 hours, 12 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9899; val_auprc_score: 0.9977; val_best_acc_score: 0.9780; val_best_f1_score: 0.9872; train_kl_reg_loss: 1897.8419; train_edge_recon_loss: 79688.3326; train_gene_expr_recon_loss: 105978.5860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187564.7604; train_optim_loss: 187564.7604; val_kl_reg_loss: 1915.9380; val_edge_recon_loss: 76368.7237; val_gene_expr_recon_loss: 101209.8077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179494.4684; val_optim_loss: 179494.4684
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9924; val_auprc_score: 0.9980; val_best_acc_score: 0.9826; val_best_f1_score: 0.9899; train_kl_reg_loss: 1949.8448; train_edge_recon_loss: 76514.5125; train_gene_expr_recon_loss: 99859.3700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178323.7267; train_optim_loss: 178323.7267; val_kl_reg_loss: 1942.6683; val_edge_recon_loss: 76739.2855; val_gene_expr_recon_loss: 98197.9069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176879.8614; val_optim_loss: 176879.8614
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9941; val_auprc_score: 0.9987; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1941.7769; train_edge_recon_loss: 76234.9899; train_gene_expr_recon_loss: 97541.8704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175718.6371; train_optim_loss: 175718.6371; val_kl_reg_loss: 1925.2025; val_edge_recon_loss: 75211.4583; val_gene_expr_recon_loss: 96449.2640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173585.9255; val_optim_loss: 173585.9255
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9940; val_auprc_score: 0.9981; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1955.9692; train_edge_recon_loss: 76653.6235; train_gene_expr_recon_loss: 96011.9495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174621.5426; train_optim_loss: 174621.5426; val_kl_reg_loss: 1933.0929; val_edge_recon_loss: 77807.9304; val_gene_expr_recon_loss: 94631.6469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174372.6702; val_optim_loss: 174372.6702
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9988; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1962.2489; train_edge_recon_loss: 76013.5411; train_gene_expr_recon_loss: 94900.3532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172876.1433; train_optim_loss: 172876.1433; val_kl_reg_loss: 1959.6752; val_edge_recon_loss: 75732.6897; val_gene_expr_recon_loss: 94150.7214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171843.0834; val_optim_loss: 171843.0834
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9939; val_auprc_score: 0.9985; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 1969.3320; train_edge_recon_loss: 75828.3855; train_gene_expr_recon_loss: 94051.6608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171849.3787; train_optim_loss: 171849.3787; val_kl_reg_loss: 1954.0759; val_edge_recon_loss: 77023.0283; val_gene_expr_recon_loss: 93162.7906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172139.8946; val_optim_loss: 172139.8946
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9950; val_auprc_score: 0.9987; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1986.3336; train_edge_recon_loss: 76231.7979; train_gene_expr_recon_loss: 93412.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171630.6825; train_optim_loss: 171630.6825; val_kl_reg_loss: 1952.3770; val_edge_recon_loss: 75613.4735; val_gene_expr_recon_loss: 93097.4207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170663.2699; val_optim_loss: 170663.2699
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9960; val_auprc_score: 0.9990; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1993.5395; train_edge_recon_loss: 75785.4242; train_gene_expr_recon_loss: 92973.3995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170752.3638; train_optim_loss: 170752.3638; val_kl_reg_loss: 1985.0347; val_edge_recon_loss: 75508.7381; val_gene_expr_recon_loss: 92422.3886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169916.1609; val_optim_loss: 169916.1609
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9988; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1998.3293; train_edge_recon_loss: 76193.5341; train_gene_expr_recon_loss: 92500.8687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170692.7313; train_optim_loss: 170692.7313; val_kl_reg_loss: 1985.5966; val_edge_recon_loss: 74888.8511; val_gene_expr_recon_loss: 92541.1037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169415.5495; val_optim_loss: 169415.5495
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9950; val_auprc_score: 0.9981; val_best_acc_score: 0.9897; val_best_f1_score: 0.9940; train_kl_reg_loss: 2007.9804; train_edge_recon_loss: 75713.9410; train_gene_expr_recon_loss: 92163.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169885.8795; train_optim_loss: 169885.8795; val_kl_reg_loss: 1983.2451; val_edge_recon_loss: 76063.3885; val_gene_expr_recon_loss: 91904.2580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169950.8910; val_optim_loss: 169950.8910
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9955; val_auprc_score: 0.9988; val_best_acc_score: 0.9897; val_best_f1_score: 0.9940; train_kl_reg_loss: 2016.4984; train_edge_recon_loss: 75449.6795; train_gene_expr_recon_loss: 91891.8389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169358.0165; train_optim_loss: 169358.0165; val_kl_reg_loss: 2006.6046; val_edge_recon_loss: 76192.7158; val_gene_expr_recon_loss: 91653.2124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169852.5342; val_optim_loss: 169852.5342
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9989; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 2023.4012; train_edge_recon_loss: 75755.0658; train_gene_expr_recon_loss: 91652.1755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169430.6425; train_optim_loss: 169430.6425; val_kl_reg_loss: 2026.0819; val_edge_recon_loss: 75356.4058; val_gene_expr_recon_loss: 91236.3630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168618.8507; val_optim_loss: 168618.8507
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9959; val_auprc_score: 0.9989; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 2033.5025; train_edge_recon_loss: 75962.9458; train_gene_expr_recon_loss: 91461.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169458.3787; train_optim_loss: 169458.3787; val_kl_reg_loss: 1998.8048; val_edge_recon_loss: 75153.6688; val_gene_expr_recon_loss: 90970.2242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168122.6988; val_optim_loss: 168122.6988
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9955; val_auprc_score: 0.9986; val_best_acc_score: 0.9905; val_best_f1_score: 0.9944; train_kl_reg_loss: 2036.9996; train_edge_recon_loss: 75552.9933; train_gene_expr_recon_loss: 91328.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168918.2616; train_optim_loss: 168918.2616; val_kl_reg_loss: 2009.4594; val_edge_recon_loss: 76018.2306; val_gene_expr_recon_loss: 91479.1449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169506.8348; val_optim_loss: 169506.8348
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9960; val_auprc_score: 0.9989; val_best_acc_score: 0.9910; val_best_f1_score: 0.9947; train_kl_reg_loss: 2043.3948; train_edge_recon_loss: 75640.6992; train_gene_expr_recon_loss: 91030.6634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168714.7574; train_optim_loss: 168714.7574; val_kl_reg_loss: 2076.2302; val_edge_recon_loss: 74725.1937; val_gene_expr_recon_loss: 90796.0226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167597.4468; val_optim_loss: 167597.4468
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9988; val_best_acc_score: 0.9917; val_best_f1_score: 0.9951; train_kl_reg_loss: 2049.7201; train_edge_recon_loss: 75662.8213; train_gene_expr_recon_loss: 90956.5329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168669.0738; train_optim_loss: 168669.0738; val_kl_reg_loss: 2036.8727; val_edge_recon_loss: 75885.2985; val_gene_expr_recon_loss: 90992.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168914.3318; val_optim_loss: 168914.3318
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9964; val_auprc_score: 0.9987; val_best_acc_score: 0.9915; val_best_f1_score: 0.9950; train_kl_reg_loss: 2054.6206; train_edge_recon_loss: 76011.1583; train_gene_expr_recon_loss: 90876.1869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168941.9655; train_optim_loss: 168941.9655; val_kl_reg_loss: 2061.3540; val_edge_recon_loss: 76305.8610; val_gene_expr_recon_loss: 91113.2748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169480.4917; val_optim_loss: 169480.4917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9963; val_auprc_score: 0.9989; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 2058.9256; train_edge_recon_loss: 75497.2464; train_gene_expr_recon_loss: 90779.6732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168335.8451; train_optim_loss: 168335.8451; val_kl_reg_loss: 2029.0361; val_edge_recon_loss: 75110.7312; val_gene_expr_recon_loss: 90904.8705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168044.6390; val_optim_loss: 168044.6390

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9990; val_best_acc_score: 0.9916; val_best_f1_score: 0.9951; train_kl_reg_loss: 2060.2391; train_edge_recon_loss: 75524.5202; train_gene_expr_recon_loss: 90392.8393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167977.5985; train_optim_loss: 167977.5985; val_kl_reg_loss: 2047.4402; val_edge_recon_loss: 76137.1978; val_gene_expr_recon_loss: 90612.2455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168796.8833; val_optim_loss: 168796.8833
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9990; val_best_acc_score: 0.9916; val_best_f1_score: 0.9951; train_kl_reg_loss: 2062.5877; train_edge_recon_loss: 75920.7978; train_gene_expr_recon_loss: 90217.3862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168200.7714; train_optim_loss: 168200.7714; val_kl_reg_loss: 2046.0002; val_edge_recon_loss: 75236.8306; val_gene_expr_recon_loss: 90355.6910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167638.5216; val_optim_loss: 167638.5216
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9966; val_auprc_score: 0.9988; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 2054.1604; train_edge_recon_loss: 75418.7309; train_gene_expr_recon_loss: 90326.2567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167799.1483; train_optim_loss: 167799.1483; val_kl_reg_loss: 2032.2429; val_edge_recon_loss: 75926.5775; val_gene_expr_recon_loss: 90223.9099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168182.7294; val_optim_loss: 168182.7294

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 31 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9953
Val AUPRC score: 0.9988
Val best accuracy score: 0.9912
Val best F1 score: 0.9949
Val gene expr MSE score: 0.9387
Duration of model training in run 7: 0 hours, 22 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9902; val_auprc_score: 0.9977; val_best_acc_score: 0.9770; val_best_f1_score: 0.9866; train_kl_reg_loss: 1910.6310; train_edge_recon_loss: 79767.2649; train_gene_expr_recon_loss: 105339.7662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187017.6617; train_optim_loss: 187017.6617; val_kl_reg_loss: 1981.7484; val_edge_recon_loss: 75988.9172; val_gene_expr_recon_loss: 101029.4463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179000.1130; val_optim_loss: 179000.1130
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9904; val_auprc_score: 0.9975; val_best_acc_score: 0.9816; val_best_f1_score: 0.9893; train_kl_reg_loss: 1952.9024; train_edge_recon_loss: 76623.4623; train_gene_expr_recon_loss: 99679.2954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178255.6598; train_optim_loss: 178255.6598; val_kl_reg_loss: 1979.6137; val_edge_recon_loss: 76741.1591; val_gene_expr_recon_loss: 98342.8150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177063.5891; val_optim_loss: 177063.5891
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9926; val_auprc_score: 0.9979; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1949.3582; train_edge_recon_loss: 76246.9741; train_gene_expr_recon_loss: 97345.3693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175541.7017; train_optim_loss: 175541.7017; val_kl_reg_loss: 1928.3052; val_edge_recon_loss: 76521.7472; val_gene_expr_recon_loss: 96588.8418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175038.8939; val_optim_loss: 175038.8939
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9987; val_best_acc_score: 0.9871; val_best_f1_score: 0.9925; train_kl_reg_loss: 1950.5397; train_edge_recon_loss: 76026.3181; train_gene_expr_recon_loss: 95776.4429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173753.3011; train_optim_loss: 173753.3011; val_kl_reg_loss: 1928.3627; val_edge_recon_loss: 74852.3657; val_gene_expr_recon_loss: 94538.8246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171319.5529; val_optim_loss: 171319.5529
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9939; val_auprc_score: 0.9985; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1964.5050; train_edge_recon_loss: 76040.0096; train_gene_expr_recon_loss: 94753.9598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172758.4739; train_optim_loss: 172758.4739; val_kl_reg_loss: 1967.0933; val_edge_recon_loss: 75142.6567; val_gene_expr_recon_loss: 94022.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171132.2051; val_optim_loss: 171132.2051
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9984; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 1974.3132; train_edge_recon_loss: 76257.2814; train_gene_expr_recon_loss: 93814.6574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172046.2519; train_optim_loss: 172046.2519; val_kl_reg_loss: 1917.3869; val_edge_recon_loss: 75665.2296; val_gene_expr_recon_loss: 92792.8067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170375.4235; val_optim_loss: 170375.4235
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9945; val_auprc_score: 0.9984; val_best_acc_score: 0.9895; val_best_f1_score: 0.9939; train_kl_reg_loss: 1982.0434; train_edge_recon_loss: 75819.2051; train_gene_expr_recon_loss: 93285.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171086.3893; train_optim_loss: 171086.3893; val_kl_reg_loss: 1959.6644; val_edge_recon_loss: 75200.4958; val_gene_expr_recon_loss: 92532.2520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169692.4099; val_optim_loss: 169692.4099
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9956; val_auprc_score: 0.9990; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1988.9866; train_edge_recon_loss: 75671.4141; train_gene_expr_recon_loss: 92730.7320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170391.1328; train_optim_loss: 170391.1328; val_kl_reg_loss: 2006.1723; val_edge_recon_loss: 74701.0713; val_gene_expr_recon_loss: 92128.2084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168835.4518; val_optim_loss: 168835.4518
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9960; val_auprc_score: 0.9990; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 1997.3586; train_edge_recon_loss: 75475.5225; train_gene_expr_recon_loss: 92453.6202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169926.5015; train_optim_loss: 169926.5015; val_kl_reg_loss: 1951.7687; val_edge_recon_loss: 75154.5401; val_gene_expr_recon_loss: 91891.0901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168997.3996; val_optim_loss: 168997.3996
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9981; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 2008.1641; train_edge_recon_loss: 75885.6902; train_gene_expr_recon_loss: 92142.5448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170036.3988; train_optim_loss: 170036.3988; val_kl_reg_loss: 1963.2029; val_edge_recon_loss: 74971.2954; val_gene_expr_recon_loss: 91814.7487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168749.2487; val_optim_loss: 168749.2487
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9963; val_auprc_score: 0.9990; val_best_acc_score: 0.9900; val_best_f1_score: 0.9941; train_kl_reg_loss: 2013.4743; train_edge_recon_loss: 75499.8646; train_gene_expr_recon_loss: 91896.2887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169409.6273; train_optim_loss: 169409.6273; val_kl_reg_loss: 2020.0798; val_edge_recon_loss: 76499.7665; val_gene_expr_recon_loss: 91068.6313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169588.4777; val_optim_loss: 169588.4777
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9960; val_auprc_score: 0.9989; val_best_acc_score: 0.9906; val_best_f1_score: 0.9945; train_kl_reg_loss: 2022.6811; train_edge_recon_loss: 75809.8101; train_gene_expr_recon_loss: 91604.1954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169436.6867; train_optim_loss: 169436.6867; val_kl_reg_loss: 2005.1124; val_edge_recon_loss: 75863.0833; val_gene_expr_recon_loss: 91844.7691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169712.9658; val_optim_loss: 169712.9658
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9953; val_auprc_score: 0.9983; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 2026.1429; train_edge_recon_loss: 75921.7544; train_gene_expr_recon_loss: 91439.2476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169387.1450; train_optim_loss: 169387.1450; val_kl_reg_loss: 2007.3336; val_edge_recon_loss: 77327.0221; val_gene_expr_recon_loss: 91943.7342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171278.0904; val_optim_loss: 171278.0904

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9960; val_auprc_score: 0.9990; val_best_acc_score: 0.9910; val_best_f1_score: 0.9947; train_kl_reg_loss: 2028.9908; train_edge_recon_loss: 75615.8921; train_gene_expr_recon_loss: 90945.8653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168590.7481; train_optim_loss: 168590.7481; val_kl_reg_loss: 2000.8099; val_edge_recon_loss: 75767.3753; val_gene_expr_recon_loss: 90768.0243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168536.2098; val_optim_loss: 168536.2098
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9962; val_auprc_score: 0.9988; val_best_acc_score: 0.9915; val_best_f1_score: 0.9950; train_kl_reg_loss: 2029.2667; train_edge_recon_loss: 75891.8896; train_gene_expr_recon_loss: 90883.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168804.1865; train_optim_loss: 168804.1865; val_kl_reg_loss: 2002.2198; val_edge_recon_loss: 76359.1469; val_gene_expr_recon_loss: 90748.1192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169109.4870; val_optim_loss: 169109.4870
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9956; val_auprc_score: 0.9982; val_best_acc_score: 0.9909; val_best_f1_score: 0.9947; train_kl_reg_loss: 2023.0972; train_edge_recon_loss: 75315.7555; train_gene_expr_recon_loss: 90886.1935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168225.0465; train_optim_loss: 168225.0465; val_kl_reg_loss: 2006.8472; val_edge_recon_loss: 75305.9267; val_gene_expr_recon_loss: 90710.7164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168023.4900; val_optim_loss: 168023.4900
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9962; val_auprc_score: 0.9989; val_best_acc_score: 0.9903; val_best_f1_score: 0.9943; train_kl_reg_loss: 2019.6599; train_edge_recon_loss: 75617.7742; train_gene_expr_recon_loss: 90741.8579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168379.2917; train_optim_loss: 168379.2917; val_kl_reg_loss: 2000.5132; val_edge_recon_loss: 76759.7340; val_gene_expr_recon_loss: 90892.0241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169652.2713; val_optim_loss: 169652.2713
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9961; val_auprc_score: 0.9989; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2021.1846; train_edge_recon_loss: 75528.8810; train_gene_expr_recon_loss: 90796.9807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168347.0462; train_optim_loss: 168347.0462; val_kl_reg_loss: 1992.8346; val_edge_recon_loss: 75063.1912; val_gene_expr_recon_loss: 90831.1012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167887.1263; val_optim_loss: 167887.1263
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9991; val_best_acc_score: 0.9912; val_best_f1_score: 0.9949; train_kl_reg_loss: 2022.6728; train_edge_recon_loss: 75855.8942; train_gene_expr_recon_loss: 90836.8816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168715.4486; train_optim_loss: 168715.4486; val_kl_reg_loss: 2004.5157; val_edge_recon_loss: 74343.6218; val_gene_expr_recon_loss: 90100.5509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166448.6885; val_optim_loss: 166448.6885
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9953; val_auprc_score: 0.9986; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2023.6725; train_edge_recon_loss: 75669.9537; train_gene_expr_recon_loss: 90730.1857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168423.8120; train_optim_loss: 168423.8120; val_kl_reg_loss: 2003.1804; val_edge_recon_loss: 75285.9690; val_gene_expr_recon_loss: 90640.7992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167929.9498; val_optim_loss: 167929.9498
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9954; val_auprc_score: 0.9986; val_best_acc_score: 0.9914; val_best_f1_score: 0.9950; train_kl_reg_loss: 2022.9633; train_edge_recon_loss: 75759.2764; train_gene_expr_recon_loss: 90663.3802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168445.6197; train_optim_loss: 168445.6197; val_kl_reg_loss: 2004.7164; val_edge_recon_loss: 72899.7898; val_gene_expr_recon_loss: 90216.7809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165121.2884; val_optim_loss: 165121.2884
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9965; val_auprc_score: 0.9988; val_best_acc_score: 0.9915; val_best_f1_score: 0.9950; train_kl_reg_loss: 2023.1205; train_edge_recon_loss: 75540.2957; train_gene_expr_recon_loss: 90750.2538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168313.6703; train_optim_loss: 168313.6703; val_kl_reg_loss: 1997.9606; val_edge_recon_loss: 74384.4117; val_gene_expr_recon_loss: 90649.8655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167032.2360; val_optim_loss: 167032.2360
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9955; val_auprc_score: 0.9982; val_best_acc_score: 0.9910; val_best_f1_score: 0.9948; train_kl_reg_loss: 2023.2409; train_edge_recon_loss: 75289.8051; train_gene_expr_recon_loss: 90642.6803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167955.7258; train_optim_loss: 167955.7258; val_kl_reg_loss: 2006.3993; val_edge_recon_loss: 75516.3998; val_gene_expr_recon_loss: 90298.3474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167821.1473; val_optim_loss: 167821.1473
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9954; val_auprc_score: 0.9987; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2026.3598; train_edge_recon_loss: 75764.1515; train_gene_expr_recon_loss: 90633.6120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168424.1233; train_optim_loss: 168424.1233; val_kl_reg_loss: 2004.3779; val_edge_recon_loss: 75806.3923; val_gene_expr_recon_loss: 90426.6104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168237.3820; val_optim_loss: 168237.3820

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9966; val_auprc_score: 0.9990; val_best_acc_score: 0.9916; val_best_f1_score: 0.9951; train_kl_reg_loss: 2023.2655; train_edge_recon_loss: 75439.2947; train_gene_expr_recon_loss: 90602.9829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168065.5426; train_optim_loss: 168065.5426; val_kl_reg_loss: 2003.3846; val_edge_recon_loss: 76755.8562; val_gene_expr_recon_loss: 90549.0524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169308.2916; val_optim_loss: 169308.2916
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9960; val_auprc_score: 0.9988; val_best_acc_score: 0.9909; val_best_f1_score: 0.9947; train_kl_reg_loss: 2024.6317; train_edge_recon_loss: 75930.8020; train_gene_expr_recon_loss: 90634.5564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168589.9900; train_optim_loss: 168589.9900; val_kl_reg_loss: 2007.9997; val_edge_recon_loss: 75146.0198; val_gene_expr_recon_loss: 90444.5379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167598.5568; val_optim_loss: 167598.5568
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9952; val_auprc_score: 0.9982; val_best_acc_score: 0.9908; val_best_f1_score: 0.9946; train_kl_reg_loss: 2026.5390; train_edge_recon_loss: 75643.1245; train_gene_expr_recon_loss: 90583.9989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168253.6624; train_optim_loss: 168253.6624; val_kl_reg_loss: 2008.5963; val_edge_recon_loss: 75872.2078; val_gene_expr_recon_loss: 90431.8404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168312.6449; val_optim_loss: 168312.6449

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 50 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9961
Val AUPRC score: 0.9985
Val best accuracy score: 0.9912
Val best F1 score: 0.9949
Val gene expr MSE score: 0.9226
Duration of model training in run 8: 0 hours, 29 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9894; val_auprc_score: 0.9973; val_best_acc_score: 0.9806; val_best_f1_score: 0.9887; train_kl_reg_loss: 1883.8759; train_edge_recon_loss: 79359.6073; train_gene_expr_recon_loss: 105555.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186798.7973; train_optim_loss: 186798.7973; val_kl_reg_loss: 1922.5825; val_edge_recon_loss: 76145.5277; val_gene_expr_recon_loss: 100819.8936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178888.0051; val_optim_loss: 178888.0051
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9921; val_auprc_score: 0.9980; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1939.3904; train_edge_recon_loss: 76858.5783; train_gene_expr_recon_loss: 99509.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178307.5172; train_optim_loss: 178307.5172; val_kl_reg_loss: 1974.9545; val_edge_recon_loss: 76709.7220; val_gene_expr_recon_loss: 97728.5113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176413.1870; val_optim_loss: 176413.1870
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9940; val_auprc_score: 0.9984; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 1938.0266; train_edge_recon_loss: 76364.8622; train_gene_expr_recon_loss: 97134.4746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175437.3633; train_optim_loss: 175437.3633; val_kl_reg_loss: 1952.8113; val_edge_recon_loss: 75217.0743; val_gene_expr_recon_loss: 95818.6127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172988.4968; val_optim_loss: 172988.4968
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9949; val_auprc_score: 0.9988; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 1951.8504; train_edge_recon_loss: 76182.9349; train_gene_expr_recon_loss: 95619.3938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173754.1787; train_optim_loss: 173754.1787; val_kl_reg_loss: 1916.9883; val_edge_recon_loss: 75921.9140; val_gene_expr_recon_loss: 94555.2810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172394.1827; val_optim_loss: 172394.1827
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9946; val_auprc_score: 0.9985; val_best_acc_score: 0.9891; val_best_f1_score: 0.9937; train_kl_reg_loss: 1964.7824; train_edge_recon_loss: 76102.0563; train_gene_expr_recon_loss: 94604.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172671.7051; train_optim_loss: 172671.7051; val_kl_reg_loss: 1973.1244; val_edge_recon_loss: 75124.2396; val_gene_expr_recon_loss: 93718.5936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170815.9572; val_optim_loss: 170815.9572
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9954; val_auprc_score: 0.9989; val_best_acc_score: 0.9894; val_best_f1_score: 0.9938; train_kl_reg_loss: 1977.4581; train_edge_recon_loss: 75785.2936; train_gene_expr_recon_loss: 93859.0210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171621.7729; train_optim_loss: 171621.7729; val_kl_reg_loss: 1952.3692; val_edge_recon_loss: 75878.9599; val_gene_expr_recon_loss: 93107.0566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170938.3866; val_optim_loss: 170938.3866
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9948; val_auprc_score: 0.9982; val_best_acc_score: 0.9901; val_best_f1_score: 0.9942; train_kl_reg_loss: 1989.7663; train_edge_recon_loss: 75887.4505; train_gene_expr_recon_loss: 93273.7564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171150.9732; train_optim_loss: 171150.9732; val_kl_reg_loss: 1970.3435; val_edge_recon_loss: 75818.4708; val_gene_expr_recon_loss: 92629.5752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170418.3885; val_optim_loss: 170418.3885
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9961; val_auprc_score: 0.9988; val_best_acc_score: 0.9912; val_best_f1_score: 0.9949; train_kl_reg_loss: 1996.3126; train_edge_recon_loss: 75842.4111; train_gene_expr_recon_loss: 92823.7020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170662.4256; train_optim_loss: 170662.4256; val_kl_reg_loss: 1960.8851; val_edge_recon_loss: 74639.0416; val_gene_expr_recon_loss: 92365.1507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168965.0776; val_optim_loss: 168965.0776
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9958; val_auprc_score: 0.9987; val_best_acc_score: 0.9912; val_best_f1_score: 0.9948; train_kl_reg_loss: 2008.4053; train_edge_recon_loss: 76203.8046; train_gene_expr_recon_loss: 92511.4682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170723.6782; train_optim_loss: 170723.6782; val_kl_reg_loss: 2031.5028; val_edge_recon_loss: 75906.4727; val_gene_expr_recon_loss: 92082.4702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170020.4459; val_optim_loss: 170020.4459
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9984; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2013.5152; train_edge_recon_loss: 75663.0326; train_gene_expr_recon_loss: 92236.9100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169913.4580; train_optim_loss: 169913.4580; val_kl_reg_loss: 2006.3647; val_edge_recon_loss: 75595.0595; val_gene_expr_recon_loss: 91688.0704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169289.4949; val_optim_loss: 169289.4949
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9955; val_auprc_score: 0.9984; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2021.0738; train_edge_recon_loss: 75906.8124; train_gene_expr_recon_loss: 91957.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169885.2498; train_optim_loss: 169885.2498; val_kl_reg_loss: 2042.5292; val_edge_recon_loss: 75820.1847; val_gene_expr_recon_loss: 91594.4014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169457.1166; val_optim_loss: 169457.1166

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9960; val_auprc_score: 0.9990; val_best_acc_score: 0.9909; val_best_f1_score: 0.9947; train_kl_reg_loss: 2024.4295; train_edge_recon_loss: 75430.9269; train_gene_expr_recon_loss: 91464.9522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168920.3084; train_optim_loss: 168920.3084; val_kl_reg_loss: 1996.0078; val_edge_recon_loss: 75782.4564; val_gene_expr_recon_loss: 91213.0370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168991.5024; val_optim_loss: 168991.5024
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9990; val_best_acc_score: 0.9913; val_best_f1_score: 0.9949; train_kl_reg_loss: 2017.9071; train_edge_recon_loss: 75621.1278; train_gene_expr_recon_loss: 91383.5106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169022.5459; train_optim_loss: 169022.5459; val_kl_reg_loss: 2022.2251; val_edge_recon_loss: 75806.6592; val_gene_expr_recon_loss: 91169.8435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168998.7282; val_optim_loss: 168998.7282
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9948; val_auprc_score: 0.9985; val_best_acc_score: 0.9911; val_best_f1_score: 0.9948; train_kl_reg_loss: 2018.2491; train_edge_recon_loss: 75506.0204; train_gene_expr_recon_loss: 91326.0097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168850.2790; train_optim_loss: 168850.2790; val_kl_reg_loss: 1999.7560; val_edge_recon_loss: 76036.5271; val_gene_expr_recon_loss: 91096.1196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169132.4030; val_optim_loss: 169132.4030

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 13 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9949
Val AUPRC score: 0.9984
Val best accuracy score: 0.9907
Val best F1 score: 0.9946
Val gene expr MSE score: 0.9876
Duration of model training in run 9: 0 hours, 20 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9896; val_auprc_score: 0.9977; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 1902.8183; train_edge_recon_loss: 79541.6639; train_gene_expr_recon_loss: 104744.2139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186188.6965; train_optim_loss: 186188.6965; val_kl_reg_loss: 1923.6323; val_edge_recon_loss: 76593.8634; val_gene_expr_recon_loss: 100580.9231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179098.4192; val_optim_loss: 179098.4192
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9925; val_auprc_score: 0.9979; val_best_acc_score: 0.9846; val_best_f1_score: 0.9910; train_kl_reg_loss: 1939.6727; train_edge_recon_loss: 76503.3425; train_gene_expr_recon_loss: 98953.0647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177396.0802; train_optim_loss: 177396.0802; val_kl_reg_loss: 1947.7841; val_edge_recon_loss: 77185.4230; val_gene_expr_recon_loss: 97680.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176813.5695; val_optim_loss: 176813.5695
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9935; val_auprc_score: 0.9983; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1940.4508; train_edge_recon_loss: 76174.5519; train_gene_expr_recon_loss: 96737.1240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174852.1267; train_optim_loss: 174852.1267; val_kl_reg_loss: 1869.1655; val_edge_recon_loss: 75557.4584; val_gene_expr_recon_loss: 96104.9471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173531.5725; val_optim_loss: 173531.5725
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9938; val_auprc_score: 0.9979; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1952.8746; train_edge_recon_loss: 76148.9232; train_gene_expr_recon_loss: 95274.9534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173376.7510; train_optim_loss: 173376.7510; val_kl_reg_loss: 1940.1081; val_edge_recon_loss: 76391.0498; val_gene_expr_recon_loss: 94895.6026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173226.7592; val_optim_loss: 173226.7592
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9941; val_auprc_score: 0.9979; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1962.2679; train_edge_recon_loss: 76109.9763; train_gene_expr_recon_loss: 94321.3285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172393.5724; train_optim_loss: 172393.5724; val_kl_reg_loss: 1948.7661; val_edge_recon_loss: 75767.1258; val_gene_expr_recon_loss: 94012.1615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171728.0531; val_optim_loss: 171728.0531
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9957; val_auprc_score: 0.9987; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1977.4121; train_edge_recon_loss: 75785.2683; train_gene_expr_recon_loss: 93640.3373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171403.0175; train_optim_loss: 171403.0175; val_kl_reg_loss: 1949.8967; val_edge_recon_loss: 77351.2301; val_gene_expr_recon_loss: 93429.2768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172730.4027; val_optim_loss: 172730.4027
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9949; val_auprc_score: 0.9981; val_best_acc_score: 0.9894; val_best_f1_score: 0.9938; train_kl_reg_loss: 1988.9874; train_edge_recon_loss: 75746.1321; train_gene_expr_recon_loss: 93091.1808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170826.3003; train_optim_loss: 170826.3003; val_kl_reg_loss: 1957.9494; val_edge_recon_loss: 75739.9344; val_gene_expr_recon_loss: 92841.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170539.7446; val_optim_loss: 170539.7446
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9958; val_auprc_score: 0.9989; val_best_acc_score: 0.9905; val_best_f1_score: 0.9944; train_kl_reg_loss: 1995.4163; train_edge_recon_loss: 75900.5690; train_gene_expr_recon_loss: 92682.3550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170578.3403; train_optim_loss: 170578.3403; val_kl_reg_loss: 1967.6064; val_edge_recon_loss: 75653.0171; val_gene_expr_recon_loss: 92558.6893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170179.3122; val_optim_loss: 170179.3122
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9985; val_best_acc_score: 0.9901; val_best_f1_score: 0.9942; train_kl_reg_loss: 2005.2799; train_edge_recon_loss: 75973.7988; train_gene_expr_recon_loss: 92350.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170329.2835; train_optim_loss: 170329.2835; val_kl_reg_loss: 1969.3891; val_edge_recon_loss: 76080.1020; val_gene_expr_recon_loss: 92383.5624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170433.0541; val_optim_loss: 170433.0541
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9958; val_auprc_score: 0.9986; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2010.3925; train_edge_recon_loss: 75593.8349; train_gene_expr_recon_loss: 92105.2653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169709.4928; train_optim_loss: 169709.4928; val_kl_reg_loss: 1984.5571; val_edge_recon_loss: 75494.8055; val_gene_expr_recon_loss: 92087.7532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169567.1153; val_optim_loss: 169567.1153
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9955; val_auprc_score: 0.9987; val_best_acc_score: 0.9912; val_best_f1_score: 0.9948; train_kl_reg_loss: 2018.2401; train_edge_recon_loss: 75715.5257; train_gene_expr_recon_loss: 91854.7245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169588.4903; train_optim_loss: 169588.4903; val_kl_reg_loss: 1990.3304; val_edge_recon_loss: 74894.9746; val_gene_expr_recon_loss: 92047.0873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168932.3925; val_optim_loss: 168932.3925
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9961; val_auprc_score: 0.9989; val_best_acc_score: 0.9907; val_best_f1_score: 0.9946; train_kl_reg_loss: 2025.7231; train_edge_recon_loss: 75666.9154; train_gene_expr_recon_loss: 91698.0169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169390.6554; train_optim_loss: 169390.6554; val_kl_reg_loss: 1971.0301; val_edge_recon_loss: 75581.5880; val_gene_expr_recon_loss: 91741.4386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169294.0550; val_optim_loss: 169294.0550
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9961; val_auprc_score: 0.9988; val_best_acc_score: 0.9913; val_best_f1_score: 0.9949; train_kl_reg_loss: 2028.3672; train_edge_recon_loss: 75683.5842; train_gene_expr_recon_loss: 91514.3796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169226.3310; train_optim_loss: 169226.3310; val_kl_reg_loss: 2015.4092; val_edge_recon_loss: 76024.8309; val_gene_expr_recon_loss: 91640.7596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169681.0000; val_optim_loss: 169681.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9951; val_auprc_score: 0.9983; val_best_acc_score: 0.9910; val_best_f1_score: 0.9948; train_kl_reg_loss: 2037.2414; train_edge_recon_loss: 76019.6251; train_gene_expr_recon_loss: 91394.9082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169451.7748; train_optim_loss: 169451.7748; val_kl_reg_loss: 2040.1493; val_edge_recon_loss: 75393.4832; val_gene_expr_recon_loss: 91554.0857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168987.7193; val_optim_loss: 168987.7193

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9957; val_auprc_score: 0.9987; val_best_acc_score: 0.9923; val_best_f1_score: 0.9955; train_kl_reg_loss: 2043.4573; train_edge_recon_loss: 75469.9607; train_gene_expr_recon_loss: 90947.3244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168460.7427; train_optim_loss: 168460.7427; val_kl_reg_loss: 2022.2281; val_edge_recon_loss: 76144.4045; val_gene_expr_recon_loss: 91244.3874; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169411.0199; val_optim_loss: 169411.0199
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9988; val_best_acc_score: 0.9922; val_best_f1_score: 0.9955; train_kl_reg_loss: 2037.1299; train_edge_recon_loss: 75767.3418; train_gene_expr_recon_loss: 90886.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168691.2408; train_optim_loss: 168691.2408; val_kl_reg_loss: 2015.2007; val_edge_recon_loss: 74441.7514; val_gene_expr_recon_loss: 91092.1786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167549.1309; val_optim_loss: 167549.1309
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9989; val_best_acc_score: 0.9917; val_best_f1_score: 0.9952; train_kl_reg_loss: 2032.2848; train_edge_recon_loss: 75653.2143; train_gene_expr_recon_loss: 90855.1765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168540.6749; train_optim_loss: 168540.6749; val_kl_reg_loss: 2029.2694; val_edge_recon_loss: 75044.9263; val_gene_expr_recon_loss: 91272.2771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168346.4725; val_optim_loss: 168346.4725
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9955; val_auprc_score: 0.9986; val_best_acc_score: 0.9915; val_best_f1_score: 0.9950; train_kl_reg_loss: 2033.6401; train_edge_recon_loss: 75649.0628; train_gene_expr_recon_loss: 90825.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168508.3149; train_optim_loss: 168508.3149; val_kl_reg_loss: 2011.7671; val_edge_recon_loss: 76214.2919; val_gene_expr_recon_loss: 91124.6343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169350.6926; val_optim_loss: 169350.6926
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9961; val_auprc_score: 0.9988; val_best_acc_score: 0.9920; val_best_f1_score: 0.9953; train_kl_reg_loss: 2032.9514; train_edge_recon_loss: 75584.8887; train_gene_expr_recon_loss: 90788.7687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168406.6087; train_optim_loss: 168406.6087; val_kl_reg_loss: 2008.5244; val_edge_recon_loss: 76116.8617; val_gene_expr_recon_loss: 91188.4978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169313.8823; val_optim_loss: 169313.8823

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9966; val_auprc_score: 0.9991; val_best_acc_score: 0.9916; val_best_f1_score: 0.9951; train_kl_reg_loss: 2029.6286; train_edge_recon_loss: 75551.8471; train_gene_expr_recon_loss: 90750.4641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168331.9397; train_optim_loss: 168331.9397; val_kl_reg_loss: 2017.6380; val_edge_recon_loss: 75735.9434; val_gene_expr_recon_loss: 91242.5494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168996.1315; val_optim_loss: 168996.1315
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9988; val_best_acc_score: 0.9919; val_best_f1_score: 0.9953; train_kl_reg_loss: 2033.3715; train_edge_recon_loss: 75035.1230; train_gene_expr_recon_loss: 90737.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167805.5489; train_optim_loss: 167805.5489; val_kl_reg_loss: 2018.0874; val_edge_recon_loss: 76044.0546; val_gene_expr_recon_loss: 91106.1339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169168.2761; val_optim_loss: 169168.2761
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9962; val_auprc_score: 0.9987; val_best_acc_score: 0.9918; val_best_f1_score: 0.9952; train_kl_reg_loss: 2033.8301; train_edge_recon_loss: 75804.3273; train_gene_expr_recon_loss: 90731.6658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168569.8231; train_optim_loss: 168569.8231; val_kl_reg_loss: 2015.4507; val_edge_recon_loss: 74896.4001; val_gene_expr_recon_loss: 91323.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168235.6395; val_optim_loss: 168235.6395

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 34 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9955
Val AUPRC score: 0.9986
Val best accuracy score: 0.9916
Val best F1 score: 0.9951
Val gene expr MSE score: 0.9323
Duration of model training in run 10: 0 hours, 32 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_221124.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 1132
Number of validation edges: 125
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7917; val_auprc_score: 0.9460; val_best_acc_score: 0.8366; val_best_f1_score: 0.9091; train_kl_reg_loss: 57.5488; train_edge_recon_loss: 100330.1562; train_gene_expr_recon_loss: 158707.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259094.9062; train_optim_loss: 259094.9062; val_kl_reg_loss: 62.0373; val_edge_recon_loss: 140611.3281; val_gene_expr_recon_loss: 149872.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 290546.0000; val_optim_loss: 290546.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7505; val_auprc_score: 0.9330; val_best_acc_score: 0.8767; val_best_f1_score: 0.9328; train_kl_reg_loss: 61.4398; train_edge_recon_loss: 93590.9297; train_gene_expr_recon_loss: 148633.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242285.5000; train_optim_loss: 242285.5000; val_kl_reg_loss: 84.3209; val_edge_recon_loss: 111283.5781; val_gene_expr_recon_loss: 141603.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252971.1562; val_optim_loss: 252971.1562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6257; val_auprc_score: 0.8740; val_best_acc_score: 0.8591; val_best_f1_score: 0.9225; train_kl_reg_loss: 84.7459; train_edge_recon_loss: 93872.4375; train_gene_expr_recon_loss: 140232.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234189.6875; train_optim_loss: 234189.6875; val_kl_reg_loss: 123.4320; val_edge_recon_loss: 128083.4219; val_gene_expr_recon_loss: 134662.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262869.4688; val_optim_loss: 262869.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7692; val_auprc_score: 0.9026; val_best_acc_score: 0.8487; val_best_f1_score: 0.9158; train_kl_reg_loss: 123.9683; train_edge_recon_loss: 101566.9453; train_gene_expr_recon_loss: 133096.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234787.4688; train_optim_loss: 234787.4688; val_kl_reg_loss: 174.9933; val_edge_recon_loss: 140558.0781; val_gene_expr_recon_loss: 129013.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 269746.1875; val_optim_loss: 269746.1875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7890; val_auprc_score: 0.9703; val_best_acc_score: 0.8936; val_best_f1_score: 0.9434; train_kl_reg_loss: 175.3870; train_edge_recon_loss: 105232.5234; train_gene_expr_recon_loss: 127330.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232738.4531; train_optim_loss: 232738.4531; val_kl_reg_loss: 233.7897; val_edge_recon_loss: 90363.5156; val_gene_expr_recon_loss: 124596.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215193.8594; val_optim_loss: 215193.8594
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6271; val_auprc_score: 0.9104; val_best_acc_score: 0.8811; val_best_f1_score: 0.9363; train_kl_reg_loss: 234.5940; train_edge_recon_loss: 101697.2109; train_gene_expr_recon_loss: 122844.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224776.2188; train_optim_loss: 224776.2188; val_kl_reg_loss: 287.2607; val_edge_recon_loss: 101474.9844; val_gene_expr_recon_loss: 121313.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223075.4219; val_optim_loss: 223075.4219
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7407; val_auprc_score: 0.8621; val_best_acc_score: 0.8075; val_best_f1_score: 0.8897; train_kl_reg_loss: 290.8316; train_edge_recon_loss: 106823.3828; train_gene_expr_recon_loss: 119537.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226651.7812; train_optim_loss: 226651.7812; val_kl_reg_loss: 321.7261; val_edge_recon_loss: 178033.7188; val_gene_expr_recon_loss: 118989.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 297345.0938; val_optim_loss: 297345.0938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.5806; val_auprc_score: 0.8792; val_best_acc_score: 0.8630; val_best_f1_score: 0.9259; train_kl_reg_loss: 325.2489; train_edge_recon_loss: 106693.6641; train_gene_expr_recon_loss: 117124.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224143.4375; train_optim_loss: 224143.4375; val_kl_reg_loss: 334.8724; val_edge_recon_loss: 115802.5703; val_gene_expr_recon_loss: 117368.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233505.8281; val_optim_loss: 233505.8281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7596; val_auprc_score: 0.9457; val_best_acc_score: 0.8750; val_best_f1_score: 0.9328; train_kl_reg_loss: 336.1916; train_edge_recon_loss: 102426.4297; train_gene_expr_recon_loss: 115466.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218228.8125; train_optim_loss: 218228.8125; val_kl_reg_loss: 329.5421; val_edge_recon_loss: 105385.9688; val_gene_expr_recon_loss: 117233.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222949.4688; val_optim_loss: 222949.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7539; val_auprc_score: 0.9413; val_best_acc_score: 0.9085; val_best_f1_score: 0.9506; train_kl_reg_loss: 335.1369; train_edge_recon_loss: 111165.0547; train_gene_expr_recon_loss: 115316.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226816.7500; train_optim_loss: 226816.7500; val_kl_reg_loss: 330.3621; val_edge_recon_loss: 94795.2422; val_gene_expr_recon_loss: 117100.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212225.8906; val_optim_loss: 212225.8906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8048; val_auprc_score: 0.9592; val_best_acc_score: 0.8690; val_best_f1_score: 0.9294; train_kl_reg_loss: 331.9297; train_edge_recon_loss: 98116.1484; train_gene_expr_recon_loss: 115170.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213618.4375; train_optim_loss: 213618.4375; val_kl_reg_loss: 320.7486; val_edge_recon_loss: 110005.1797; val_gene_expr_recon_loss: 116967.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227293.5469; val_optim_loss: 227293.5469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8393; val_auprc_score: 0.9676; val_best_acc_score: 0.8776; val_best_f1_score: 0.9328; train_kl_reg_loss: 325.6124; train_edge_recon_loss: 99350.7109; train_gene_expr_recon_loss: 115044.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214720.5781; train_optim_loss: 214720.5781; val_kl_reg_loss: 317.9734; val_edge_recon_loss: 118291.8516; val_gene_expr_recon_loss: 116836.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235446.1875; val_optim_loss: 235446.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7625; val_auprc_score: 0.9418; val_best_acc_score: 0.9078; val_best_f1_score: 0.9506; train_kl_reg_loss: 318.7578; train_edge_recon_loss: 104822.1953; train_gene_expr_recon_loss: 114900.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220041.5312; train_optim_loss: 220041.5312; val_kl_reg_loss: 307.2827; val_edge_recon_loss: 90045.5000; val_gene_expr_recon_loss: 116707.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207060.1562; val_optim_loss: 207060.1562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7698; val_auprc_score: 0.9177; val_best_acc_score: 0.8553; val_best_f1_score: 0.9191; train_kl_reg_loss: 312.3687; train_edge_recon_loss: 98150.5000; train_gene_expr_recon_loss: 114790.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213252.9375; train_optim_loss: 213252.9375; val_kl_reg_loss: 301.7507; val_edge_recon_loss: 140137.9375; val_gene_expr_recon_loss: 116580.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257020.5938; val_optim_loss: 257020.5938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6553; val_auprc_score: 0.8965; val_best_acc_score: 0.8639; val_best_f1_score: 0.9259; train_kl_reg_loss: 305.4029; train_edge_recon_loss: 104767.7344; train_gene_expr_recon_loss: 114656.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219729.7812; train_optim_loss: 219729.7812; val_kl_reg_loss: 299.5352; val_edge_recon_loss: 119752.1328; val_gene_expr_recon_loss: 116457.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236509.0938; val_optim_loss: 236509.0938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.6667; val_auprc_score: 0.8923; val_best_acc_score: 0.8811; val_best_f1_score: 0.9363; train_kl_reg_loss: 299.8456; train_edge_recon_loss: 100339.4609; train_gene_expr_recon_loss: 114533.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215172.9219; train_optim_loss: 215172.9219; val_kl_reg_loss: 288.4130; val_edge_recon_loss: 100134.3359; val_gene_expr_recon_loss: 116337.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216760.0938; val_optim_loss: 216760.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.5789; val_auprc_score: 0.8781; val_best_acc_score: 0.8958; val_best_f1_score: 0.9434; train_kl_reg_loss: 290.8834; train_edge_recon_loss: 94563.4531; train_gene_expr_recon_loss: 114427.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209281.6250; train_optim_loss: 209281.6250; val_kl_reg_loss: 285.9489; val_edge_recon_loss: 104675.2969; val_gene_expr_recon_loss: 116325.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221286.7812; val_optim_loss: 221286.7812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.6904; val_auprc_score: 0.9332; val_best_acc_score: 0.8759; val_best_f1_score: 0.9328; train_kl_reg_loss: 288.0444; train_edge_recon_loss: 100182.0547; train_gene_expr_recon_loss: 114391.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214861.6094; train_optim_loss: 214861.6094; val_kl_reg_loss: 291.0371; val_edge_recon_loss: 109983.8203; val_gene_expr_recon_loss: 116313.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226588.5781; val_optim_loss: 226588.5781
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.6058; val_auprc_score: 0.8464; val_best_acc_score: 0.8667; val_best_f1_score: 0.9259; train_kl_reg_loss: 288.1198; train_edge_recon_loss: 97308.5547; train_gene_expr_recon_loss: 114413.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212010.5625; train_optim_loss: 212010.5625; val_kl_reg_loss: 286.9624; val_edge_recon_loss: 132085.9219; val_gene_expr_recon_loss: 116301.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248674.8281; val_optim_loss: 248674.8281

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.6300
Val AUPRC score: 0.9647
Val best accuracy score: 0.9398
Val best F1 score: 0.9690
Val gene expr MSE score: 1.8060
Duration of model training in run 1: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 1132
Number of validation edges: 125
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6991; val_auprc_score: 0.9065; val_best_acc_score: 0.8477; val_best_f1_score: 0.9158; train_kl_reg_loss: 60.8421; train_edge_recon_loss: 103221.6484; train_gene_expr_recon_loss: 161530.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264813.4688; train_optim_loss: 264813.4688; val_kl_reg_loss: 65.0856; val_edge_recon_loss: 134564.0000; val_gene_expr_recon_loss: 150308.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284938.0000; val_optim_loss: 284938.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7389; val_auprc_score: 0.9370; val_best_acc_score: 0.9137; val_best_f1_score: 0.9542; train_kl_reg_loss: 64.6036; train_edge_recon_loss: 106767.6953; train_gene_expr_recon_loss: 151769.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258601.7500; train_optim_loss: 258601.7500; val_kl_reg_loss: 84.9341; val_edge_recon_loss: 79136.6562; val_gene_expr_recon_loss: 142345.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221567.1875; val_optim_loss: 221567.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7642; val_auprc_score: 0.9176; val_best_acc_score: 0.8851; val_best_f1_score: 0.9344; train_kl_reg_loss: 85.2095; train_edge_recon_loss: 97795.9297; train_gene_expr_recon_loss: 143275.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241156.7812; train_optim_loss: 241156.7812; val_kl_reg_loss: 125.6041; val_edge_recon_loss: 122473.0781; val_gene_expr_recon_loss: 135442.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258040.8750; val_optim_loss: 258040.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6307; val_auprc_score: 0.8801; val_best_acc_score: 0.8881; val_best_f1_score: 0.9394; train_kl_reg_loss: 127.6532; train_edge_recon_loss: 103277.9531; train_gene_expr_recon_loss: 136005.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239411.3281; train_optim_loss: 239411.3281; val_kl_reg_loss: 192.4329; val_edge_recon_loss: 100432.8047; val_gene_expr_recon_loss: 129590.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230215.7500; val_optim_loss: 230215.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7021; val_auprc_score: 0.9023; val_best_acc_score: 0.8750; val_best_f1_score: 0.9313; train_kl_reg_loss: 192.3408; train_edge_recon_loss: 98999.9062; train_gene_expr_recon_loss: 129918.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229111.1562; train_optim_loss: 229111.1562; val_kl_reg_loss: 275.0464; val_edge_recon_loss: 106125.9609; val_gene_expr_recon_loss: 124835.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231236.1094; val_optim_loss: 231236.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8258; val_auprc_score: 0.9512; val_best_acc_score: 0.8639; val_best_f1_score: 0.9254; train_kl_reg_loss: 275.0907; train_edge_recon_loss: 99930.9453; train_gene_expr_recon_loss: 125106.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225312.9062; train_optim_loss: 225312.9062; val_kl_reg_loss: 358.4170; val_edge_recon_loss: 119805.2500; val_gene_expr_recon_loss: 121208.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241372.1250; val_optim_loss: 241372.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7844; val_auprc_score: 0.9351; val_best_acc_score: 0.8881; val_best_f1_score: 0.9394; train_kl_reg_loss: 362.8251; train_edge_recon_loss: 111978.7891; train_gene_expr_recon_loss: 121434.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233775.7969; train_optim_loss: 233775.7969; val_kl_reg_loss: 366.7378; val_edge_recon_loss: 100867.0391; val_gene_expr_recon_loss: 120907.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222141.7188; val_optim_loss: 222141.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7395; val_auprc_score: 0.9076; val_best_acc_score: 0.8533; val_best_f1_score: 0.9173; train_kl_reg_loss: 366.7512; train_edge_recon_loss: 91042.8750; train_gene_expr_recon_loss: 121098.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212508.1250; train_optim_loss: 212508.1250; val_kl_reg_loss: 371.9832; val_edge_recon_loss: 133747.4375; val_gene_expr_recon_loss: 120619.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254738.6250; val_optim_loss: 254738.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 2 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
Val AUROC score: 0.7030
Val AUPRC score: 0.9141
Val best accuracy score: 0.8649
Val best F1 score: 0.9237
Val gene expr MSE score: 2.4947
Duration of model training in run 2: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 2243
Number of validation edges: 249
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7954; val_auprc_score: 0.9035; val_best_acc_score: 0.8796; val_best_f1_score: 0.9321; train_kl_reg_loss: 61.1200; train_edge_recon_loss: 98710.9297; train_gene_expr_recon_loss: 161405.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260177.9844; train_optim_loss: 260177.9844; val_kl_reg_loss: 68.9203; val_edge_recon_loss: 131736.0781; val_gene_expr_recon_loss: 145602.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 277407.1875; val_optim_loss: 277407.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8633; val_auprc_score: 0.9683; val_best_acc_score: 0.8920; val_best_f1_score: 0.9410; train_kl_reg_loss: 71.1814; train_edge_recon_loss: 114046.6562; train_gene_expr_recon_loss: 151332.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265450.0312; train_optim_loss: 265450.0312; val_kl_reg_loss: 96.0058; val_edge_recon_loss: 105208.1094; val_gene_expr_recon_loss: 137942.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243246.3750; val_optim_loss: 243246.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9229; val_auprc_score: 0.9682; val_best_acc_score: 0.8990; val_best_f1_score: 0.9425; train_kl_reg_loss: 98.8094; train_edge_recon_loss: 101319.6172; train_gene_expr_recon_loss: 142763.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244182.3125; train_optim_loss: 244182.3125; val_kl_reg_loss: 136.4630; val_edge_recon_loss: 128563.4922; val_gene_expr_recon_loss: 131426.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260126.8281; val_optim_loss: 260126.8281
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8577; val_auprc_score: 0.9741; val_best_acc_score: 0.9193; val_best_f1_score: 0.9546; train_kl_reg_loss: 141.7688; train_edge_recon_loss: 99482.7734; train_gene_expr_recon_loss: 135528.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235152.6250; train_optim_loss: 235152.6250; val_kl_reg_loss: 189.7786; val_edge_recon_loss: 100882.0938; val_gene_expr_recon_loss: 126020.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227092.3750; val_optim_loss: 227092.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7793; val_auprc_score: 0.9185; val_best_acc_score: 0.8733; val_best_f1_score: 0.9301; train_kl_reg_loss: 195.5067; train_edge_recon_loss: 100927.9375; train_gene_expr_recon_loss: 129593.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230716.7812; train_optim_loss: 230716.7812; val_kl_reg_loss: 254.1922; val_edge_recon_loss: 118610.9922; val_gene_expr_recon_loss: 121703.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240568.3594; val_optim_loss: 240568.3594
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7368; val_auprc_score: 0.9055; val_best_acc_score: 0.8771; val_best_f1_score: 0.9318; train_kl_reg_loss: 260.7185; train_edge_recon_loss: 104624.0312; train_gene_expr_recon_loss: 124911.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229795.8125; train_optim_loss: 229795.8125; val_kl_reg_loss: 309.6380; val_edge_recon_loss: 120905.3672; val_gene_expr_recon_loss: 118428.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239643.7031; val_optim_loss: 239643.7031
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7535; val_auprc_score: 0.9211; val_best_acc_score: 0.8858; val_best_f1_score: 0.9376; train_kl_reg_loss: 316.4129; train_edge_recon_loss: 105546.7656; train_gene_expr_recon_loss: 121380.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227243.6562; train_optim_loss: 227243.6562; val_kl_reg_loss: 340.0473; val_edge_recon_loss: 111245.2578; val_gene_expr_recon_loss: 116019.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227604.9219; val_optim_loss: 227604.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8201; val_auprc_score: 0.9507; val_best_acc_score: 0.8916; val_best_f1_score: 0.9412; train_kl_reg_loss: 355.4680; train_edge_recon_loss: 104397.9766; train_gene_expr_recon_loss: 118826.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223579.9062; train_optim_loss: 223579.9062; val_kl_reg_loss: 344.7887; val_edge_recon_loss: 103932.0312; val_gene_expr_recon_loss: 115816.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220093.1875; val_optim_loss: 220093.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8913; val_auprc_score: 0.9822; val_best_acc_score: 0.9046; val_best_f1_score: 0.9480; train_kl_reg_loss: 354.5161; train_edge_recon_loss: 101019.8906; train_gene_expr_recon_loss: 118576.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219950.6406; train_optim_loss: 219950.6406; val_kl_reg_loss: 343.6193; val_edge_recon_loss: 96520.7734; val_gene_expr_recon_loss: 115617.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212482.0938; val_optim_loss: 212482.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7190; val_auprc_score: 0.8875; val_best_acc_score: 0.8836; val_best_f1_score: 0.9354; train_kl_reg_loss: 353.3835; train_edge_recon_loss: 104423.3594; train_gene_expr_recon_loss: 118405.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223182.0312; train_optim_loss: 223182.0312; val_kl_reg_loss: 338.9530; val_edge_recon_loss: 118489.8281; val_gene_expr_recon_loss: 115423.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234251.9219; val_optim_loss: 234251.9219
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8069; val_auprc_score: 0.9513; val_best_acc_score: 0.8801; val_best_f1_score: 0.9336; train_kl_reg_loss: 348.5179; train_edge_recon_loss: 105421.0703; train_gene_expr_recon_loss: 118171.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223940.9062; train_optim_loss: 223940.9062; val_kl_reg_loss: 332.5453; val_edge_recon_loss: 118440.5625; val_gene_expr_recon_loss: 115232.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234005.9844; val_optim_loss: 234005.9844
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8714; val_auprc_score: 0.9801; val_best_acc_score: 0.8975; val_best_f1_score: 0.9450; train_kl_reg_loss: 343.7015; train_edge_recon_loss: 104784.1328; train_gene_expr_recon_loss: 118003.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223130.8906; train_optim_loss: 223130.8906; val_kl_reg_loss: 325.2451; val_edge_recon_loss: 96556.1562; val_gene_expr_recon_loss: 115047.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211928.7500; val_optim_loss: 211928.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8022; val_auprc_score: 0.9588; val_best_acc_score: 0.9158; val_best_f1_score: 0.9535; train_kl_reg_loss: 337.8046; train_edge_recon_loss: 109216.0703; train_gene_expr_recon_loss: 117754.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227308.8125; train_optim_loss: 227308.8125; val_kl_reg_loss: 323.1155; val_edge_recon_loss: 100921.1797; val_gene_expr_recon_loss: 114866.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216111.0000; val_optim_loss: 216111.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7811; val_auprc_score: 0.9318; val_best_acc_score: 0.8707; val_best_f1_score: 0.9283; train_kl_reg_loss: 331.7431; train_edge_recon_loss: 97232.1875; train_gene_expr_recon_loss: 117614.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215178.4688; train_optim_loss: 215178.4688; val_kl_reg_loss: 316.0754; val_edge_recon_loss: 123302.4297; val_gene_expr_recon_loss: 114691.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238309.5312; val_optim_loss: 238309.5312
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7802; val_auprc_score: 0.9333; val_best_acc_score: 0.8819; val_best_f1_score: 0.9358; train_kl_reg_loss: 325.2443; train_edge_recon_loss: 100319.3516; train_gene_expr_recon_loss: 117411.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218056.0625; train_optim_loss: 218056.0625; val_kl_reg_loss: 309.6602; val_edge_recon_loss: 108794.8750; val_gene_expr_recon_loss: 114520.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223624.9688; val_optim_loss: 223624.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7774; val_auprc_score: 0.9146; val_best_acc_score: 0.8822; val_best_f1_score: 0.9331; train_kl_reg_loss: 317.7383; train_edge_recon_loss: 109270.9062; train_gene_expr_recon_loss: 117268.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226856.9688; train_optim_loss: 226856.9688; val_kl_reg_loss: 310.0009; val_edge_recon_loss: 130056.2734; val_gene_expr_recon_loss: 114503.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244869.9688; val_optim_loss: 244869.9688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8358; val_auprc_score: 0.9519; val_best_acc_score: 0.8780; val_best_f1_score: 0.9313; train_kl_reg_loss: 315.8967; train_edge_recon_loss: 112261.9141; train_gene_expr_recon_loss: 117223.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229801.0938; train_optim_loss: 229801.0938; val_kl_reg_loss: 308.4957; val_edge_recon_loss: 125048.3828; val_gene_expr_recon_loss: 114487.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239843.9531; val_optim_loss: 239843.9531
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7941; val_auprc_score: 0.9454; val_best_acc_score: 0.8924; val_best_f1_score: 0.9412; train_kl_reg_loss: 315.5150; train_edge_recon_loss: 108964.6406; train_gene_expr_recon_loss: 117216.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226496.5312; train_optim_loss: 226496.5312; val_kl_reg_loss: 305.7955; val_edge_recon_loss: 108500.1562; val_gene_expr_recon_loss: 114470.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223276.5000; val_optim_loss: 223276.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.8147
Val AUPRC score: 0.9520
Val best accuracy score: 0.8840
Val best F1 score: 0.9354
Val gene expr MSE score: 1.7291
Duration of model training in run 3: 0 hours, 0 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 2243
Number of validation edges: 249
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7922; val_auprc_score: 0.9552; val_best_acc_score: 0.8908; val_best_f1_score: 0.9412; train_kl_reg_loss: 58.9037; train_edge_recon_loss: 99964.1719; train_gene_expr_recon_loss: 158743.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258766.4062; train_optim_loss: 258766.4062; val_kl_reg_loss: 69.7006; val_edge_recon_loss: 95918.9219; val_gene_expr_recon_loss: 154260.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250249.1562; val_optim_loss: 250249.1562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7624; val_auprc_score: 0.9374; val_best_acc_score: 0.8685; val_best_f1_score: 0.9291; train_kl_reg_loss: 70.2643; train_edge_recon_loss: 105736.6094; train_gene_expr_recon_loss: 149275.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 255082.4688; train_optim_loss: 255082.4688; val_kl_reg_loss: 97.6409; val_edge_recon_loss: 110071.1172; val_gene_expr_recon_loss: 146248.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256417.5000; val_optim_loss: 256417.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7693; val_auprc_score: 0.9453; val_best_acc_score: 0.8685; val_best_f1_score: 0.9291; train_kl_reg_loss: 97.6666; train_edge_recon_loss: 100426.5234; train_gene_expr_recon_loss: 141200.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241724.6719; train_optim_loss: 241724.6719; val_kl_reg_loss: 142.1260; val_edge_recon_loss: 110835.9141; val_gene_expr_recon_loss: 139466.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250444.0625; val_optim_loss: 250444.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7735; val_auprc_score: 0.9448; val_best_acc_score: 0.8768; val_best_f1_score: 0.9343; train_kl_reg_loss: 142.4003; train_edge_recon_loss: 104717.0156; train_gene_expr_recon_loss: 134311.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239171.0312; train_optim_loss: 239171.0312; val_kl_reg_loss: 204.0057; val_edge_recon_loss: 99277.1016; val_gene_expr_recon_loss: 133879.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233360.9375; val_optim_loss: 233360.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8298; val_auprc_score: 0.9516; val_best_acc_score: 0.8669; val_best_f1_score: 0.9271; train_kl_reg_loss: 205.4426; train_edge_recon_loss: 100025.5781; train_gene_expr_recon_loss: 128716.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228947.9844; train_optim_loss: 228947.9844; val_kl_reg_loss: 272.0377; val_edge_recon_loss: 120091.2734; val_gene_expr_recon_loss: 129484.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249847.9375; val_optim_loss: 249847.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7729; val_auprc_score: 0.9295; val_best_acc_score: 0.8789; val_best_f1_score: 0.9341; train_kl_reg_loss: 274.5007; train_edge_recon_loss: 97063.3516; train_gene_expr_recon_loss: 124395.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221733.5938; train_optim_loss: 221733.5938; val_kl_reg_loss: 327.3762; val_edge_recon_loss: 111004.8594; val_gene_expr_recon_loss: 126183.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237515.7812; val_optim_loss: 237515.7812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7389; val_auprc_score: 0.9215; val_best_acc_score: 0.8571; val_best_f1_score: 0.9222; train_kl_reg_loss: 329.8920; train_edge_recon_loss: 97820.1250; train_gene_expr_recon_loss: 121118.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219268.0781; train_optim_loss: 219268.0781; val_kl_reg_loss: 359.1034; val_edge_recon_loss: 123177.0859; val_gene_expr_recon_loss: 123730.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247266.3438; val_optim_loss: 247266.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7784; val_auprc_score: 0.9344; val_best_acc_score: 0.8678; val_best_f1_score: 0.9274; train_kl_reg_loss: 360.0987; train_edge_recon_loss: 102420.4531; train_gene_expr_recon_loss: 118627.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221408.5000; train_optim_loss: 221408.5000; val_kl_reg_loss: 356.6155; val_edge_recon_loss: 124564.8438; val_gene_expr_recon_loss: 123521.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248443.0312; val_optim_loss: 248443.0312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8271; val_auprc_score: 0.9571; val_best_acc_score: 0.8838; val_best_f1_score: 0.9379; train_kl_reg_loss: 358.9046; train_edge_recon_loss: 103771.4062; train_gene_expr_recon_loss: 118409.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222539.3125; train_optim_loss: 222539.3125; val_kl_reg_loss: 355.3582; val_edge_recon_loss: 98785.7344; val_gene_expr_recon_loss: 123317.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222458.7188; val_optim_loss: 222458.7188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7937; val_auprc_score: 0.9323; val_best_acc_score: 0.8480; val_best_f1_score: 0.9171; train_kl_reg_loss: 357.4121; train_edge_recon_loss: 98136.7969; train_gene_expr_recon_loss: 118165.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216659.3125; train_optim_loss: 216659.3125; val_kl_reg_loss: 351.0785; val_edge_recon_loss: 127492.4688; val_gene_expr_recon_loss: 123118.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250961.6562; val_optim_loss: 250961.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7443; val_auprc_score: 0.8946; val_best_acc_score: 0.8467; val_best_f1_score: 0.9151; train_kl_reg_loss: 351.6127; train_edge_recon_loss: 101934.1484; train_gene_expr_recon_loss: 118003.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220289.2812; train_optim_loss: 220289.2812; val_kl_reg_loss: 343.2192; val_edge_recon_loss: 136157.3750; val_gene_expr_recon_loss: 122923.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259424.2500; val_optim_loss: 259424.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8734; val_auprc_score: 0.9752; val_best_acc_score: 0.8703; val_best_f1_score: 0.9288; train_kl_reg_loss: 345.6136; train_edge_recon_loss: 100950.5391; train_gene_expr_recon_loss: 117833.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219129.2812; train_optim_loss: 219129.2812; val_kl_reg_loss: 334.0652; val_edge_recon_loss: 119356.0781; val_gene_expr_recon_loss: 122734.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242424.7812; val_optim_loss: 242424.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7902; val_auprc_score: 0.9490; val_best_acc_score: 0.8485; val_best_f1_score: 0.9171; train_kl_reg_loss: 337.7962; train_edge_recon_loss: 105757.4375; train_gene_expr_recon_loss: 117623.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223718.3438; train_optim_loss: 223718.3438; val_kl_reg_loss: 337.2475; val_edge_recon_loss: 129579.7266; val_gene_expr_recon_loss: 122716.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252633.0625; val_optim_loss: 252633.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7733; val_auprc_score: 0.9494; val_best_acc_score: 0.8711; val_best_f1_score: 0.9308; train_kl_reg_loss: 336.4449; train_edge_recon_loss: 95904.5703; train_gene_expr_recon_loss: 117601.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213842.6875; train_optim_loss: 213842.6875; val_kl_reg_loss: 331.2532; val_edge_recon_loss: 106183.8281; val_gene_expr_recon_loss: 122697.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229212.6562; val_optim_loss: 229212.6562
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7856; val_auprc_score: 0.9180; val_best_acc_score: 0.8214; val_best_f1_score: 0.9005; train_kl_reg_loss: 335.2283; train_edge_recon_loss: 107963.3203; train_gene_expr_recon_loss: 117573.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225871.5469; train_optim_loss: 225871.5469; val_kl_reg_loss: 337.2250; val_edge_recon_loss: 153550.7969; val_gene_expr_recon_loss: 122679.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 276567.1562; val_optim_loss: 276567.1562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.7075
Val AUPRC score: 0.8985
Val best accuracy score: 0.8571
Val best F1 score: 0.9219
Val gene expr MSE score: 2.3083
Duration of model training in run 4: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 3438
Number of validation edges: 382
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8241; val_auprc_score: 0.9379; val_best_acc_score: 0.8642; val_best_f1_score: 0.9229; train_kl_reg_loss: 46.8168; train_edge_recon_loss: 99506.3750; train_gene_expr_recon_loss: 153967.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253520.2109; train_optim_loss: 253520.2109; val_kl_reg_loss: 63.4043; val_edge_recon_loss: 139332.2344; val_gene_expr_recon_loss: 146809.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 286205.0625; val_optim_loss: 286205.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8054; val_auprc_score: 0.9348; val_best_acc_score: 0.8683; val_best_f1_score: 0.9271; train_kl_reg_loss: 78.8327; train_edge_recon_loss: 96405.6719; train_gene_expr_recon_loss: 138466.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234951.4531; train_optim_loss: 234951.4531; val_kl_reg_loss: 140.3025; val_edge_recon_loss: 118050.9531; val_gene_expr_recon_loss: 134620.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252811.5625; val_optim_loss: 252811.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7654; val_auprc_score: 0.9535; val_best_acc_score: 0.8866; val_best_f1_score: 0.9397; train_kl_reg_loss: 167.6147; train_edge_recon_loss: 104748.4258; train_gene_expr_recon_loss: 128029.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232945.7969; train_optim_loss: 232945.7969; val_kl_reg_loss: 256.9938; val_edge_recon_loss: 93449.9531; val_gene_expr_recon_loss: 126671.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220378.3438; val_optim_loss: 220378.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7587; val_auprc_score: 0.9233; val_best_acc_score: 0.8674; val_best_f1_score: 0.9283; train_kl_reg_loss: 276.4589; train_edge_recon_loss: 101834.6953; train_gene_expr_recon_loss: 120515.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222626.3750; train_optim_loss: 222626.3750; val_kl_reg_loss: 335.4688; val_edge_recon_loss: 114078.9922; val_gene_expr_recon_loss: 122140.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236555.2188; val_optim_loss: 236555.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7756; val_auprc_score: 0.9479; val_best_acc_score: 0.8736; val_best_f1_score: 0.9315; train_kl_reg_loss: 333.5427; train_edge_recon_loss: 103894.1172; train_gene_expr_recon_loss: 116899.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221127.1641; train_optim_loss: 221127.1641; val_kl_reg_loss: 331.6561; val_edge_recon_loss: 110659.5781; val_gene_expr_recon_loss: 119596.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230587.8594; val_optim_loss: 230587.8594
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7592; val_auprc_score: 0.9357; val_best_acc_score: 0.8675; val_best_f1_score: 0.9268; train_kl_reg_loss: 315.9096; train_edge_recon_loss: 99532.5352; train_gene_expr_recon_loss: 114582.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214431.1406; train_optim_loss: 214431.1406; val_kl_reg_loss: 283.6007; val_edge_recon_loss: 124609.3281; val_gene_expr_recon_loss: 118218.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243111.8594; val_optim_loss: 243111.8594

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8024; val_auprc_score: 0.9707; val_best_acc_score: 0.8972; val_best_f1_score: 0.9455; train_kl_reg_loss: 271.5097; train_edge_recon_loss: 103579.9375; train_gene_expr_recon_loss: 113033.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216885.4062; train_optim_loss: 216885.4062; val_kl_reg_loss: 274.8051; val_edge_recon_loss: 86110.2031; val_gene_expr_recon_loss: 118117.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204502.4688; val_optim_loss: 204502.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8030; val_auprc_score: 0.9573; val_best_acc_score: 0.8694; val_best_f1_score: 0.9294; train_kl_reg_loss: 264.5257; train_edge_recon_loss: 101932.7266; train_gene_expr_recon_loss: 113376.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215574.2500; train_optim_loss: 215574.2500; val_kl_reg_loss: 266.4213; val_edge_recon_loss: 111117.4062; val_gene_expr_recon_loss: 118009.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229393.5938; val_optim_loss: 229393.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8167; val_auprc_score: 0.9594; val_best_acc_score: 0.9009; val_best_f1_score: 0.9465; train_kl_reg_loss: 254.0331; train_edge_recon_loss: 99633.4844; train_gene_expr_recon_loss: 113308.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213196.5156; train_optim_loss: 213196.5156; val_kl_reg_loss: 256.4433; val_edge_recon_loss: 94555.0391; val_gene_expr_recon_loss: 117893.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212705.0312; val_optim_loss: 212705.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7323; val_auprc_score: 0.9180; val_best_acc_score: 0.8641; val_best_f1_score: 0.9257; train_kl_reg_loss: 242.4674; train_edge_recon_loss: 101770.8633; train_gene_expr_recon_loss: 112872.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214886.3047; train_optim_loss: 214886.3047; val_kl_reg_loss: 244.7790; val_edge_recon_loss: 118663.9297; val_gene_expr_recon_loss: 117775.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236684.3125; val_optim_loss: 236684.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7291; val_auprc_score: 0.9267; val_best_acc_score: 0.8716; val_best_f1_score: 0.9306; train_kl_reg_loss: 235.6331; train_edge_recon_loss: 96341.2578; train_gene_expr_recon_loss: 113218.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209795.1484; train_optim_loss: 209795.1484; val_kl_reg_loss: 241.4962; val_edge_recon_loss: 110924.0781; val_gene_expr_recon_loss: 117763.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228929.0312; val_optim_loss: 228929.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7513; val_auprc_score: 0.9232; val_best_acc_score: 0.8683; val_best_f1_score: 0.9283; train_kl_reg_loss: 234.2133; train_edge_recon_loss: 110426.3477; train_gene_expr_recon_loss: 112637.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223298.4844; train_optim_loss: 223298.4844; val_kl_reg_loss: 240.6920; val_edge_recon_loss: 116651.4141; val_gene_expr_recon_loss: 117750.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234643.0781; val_optim_loss: 234643.0781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7924; val_auprc_score: 0.9450; val_best_acc_score: 0.8924; val_best_f1_score: 0.9416; train_kl_reg_loss: 234.3213; train_edge_recon_loss: 99808.4180; train_gene_expr_recon_loss: 112990.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213032.7500; train_optim_loss: 213032.7500; val_kl_reg_loss: 240.2171; val_edge_recon_loss: 99065.4766; val_gene_expr_recon_loss: 117738.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217043.8750; val_optim_loss: 217043.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.7887
Val AUPRC score: 0.9409
Val best accuracy score: 0.8927
Val best F1 score: 0.9420
Val gene expr MSE score: 2.2030
Duration of model training in run 5: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 3438
Number of validation edges: 382
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7502; val_auprc_score: 0.9096; val_best_acc_score: 0.8894; val_best_f1_score: 0.9371; train_kl_reg_loss: 58.4247; train_edge_recon_loss: 102381.0000; train_gene_expr_recon_loss: 158732.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261171.8750; train_optim_loss: 261171.8750; val_kl_reg_loss: 81.4372; val_edge_recon_loss: 109339.1641; val_gene_expr_recon_loss: 142494.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251915.1250; val_optim_loss: 251915.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7707; val_auprc_score: 0.9231; val_best_acc_score: 0.8809; val_best_f1_score: 0.9330; train_kl_reg_loss: 102.0357; train_edge_recon_loss: 99267.0703; train_gene_expr_recon_loss: 141228.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240597.5547; train_optim_loss: 240597.5547; val_kl_reg_loss: 175.2154; val_edge_recon_loss: 113573.4766; val_gene_expr_recon_loss: 129876.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243625.4531; val_optim_loss: 243625.4531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8097; val_auprc_score: 0.9514; val_best_acc_score: 0.8631; val_best_f1_score: 0.9235; train_kl_reg_loss: 211.8248; train_edge_recon_loss: 101434.0156; train_gene_expr_recon_loss: 129054.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230700.1172; train_optim_loss: 230700.1172; val_kl_reg_loss: 321.5541; val_edge_recon_loss: 126136.6641; val_gene_expr_recon_loss: 121331.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247789.5312; val_optim_loss: 247789.5312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7593; val_auprc_score: 0.9319; val_best_acc_score: 0.8927; val_best_f1_score: 0.9420; train_kl_reg_loss: 354.7270; train_edge_recon_loss: 105048.1211; train_gene_expr_recon_loss: 121269.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226672.7344; train_optim_loss: 226672.7344; val_kl_reg_loss: 441.7141; val_edge_recon_loss: 102870.6719; val_gene_expr_recon_loss: 116748.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220060.4688; val_optim_loss: 220060.4688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7762; val_auprc_score: 0.9555; val_best_acc_score: 0.8836; val_best_f1_score: 0.9374; train_kl_reg_loss: 444.7206; train_edge_recon_loss: 102589.9102; train_gene_expr_recon_loss: 116777.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219812.1641; train_optim_loss: 219812.1641; val_kl_reg_loss: 431.8685; val_edge_recon_loss: 103028.3906; val_gene_expr_recon_loss: 114480.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217940.9375; val_optim_loss: 217940.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7815; val_auprc_score: 0.9340; val_best_acc_score: 0.8821; val_best_f1_score: 0.9363; train_kl_reg_loss: 412.5713; train_edge_recon_loss: 104787.0352; train_gene_expr_recon_loss: 115165.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220364.9531; train_optim_loss: 220364.9531; val_kl_reg_loss: 343.8797; val_edge_recon_loss: 106522.2734; val_gene_expr_recon_loss: 113167.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220033.7188; val_optim_loss: 220033.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7389; val_auprc_score: 0.9408; val_best_acc_score: 0.8758; val_best_f1_score: 0.9328; train_kl_reg_loss: 318.3172; train_edge_recon_loss: 104648.8242; train_gene_expr_recon_loss: 113228.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218195.2500; train_optim_loss: 218195.2500; val_kl_reg_loss: 253.1645; val_edge_recon_loss: 108908.6484; val_gene_expr_recon_loss: 112567.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221729.6875; val_optim_loss: 221729.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7621; val_auprc_score: 0.9423; val_best_acc_score: 0.8587; val_best_f1_score: 0.9227; train_kl_reg_loss: 235.9205; train_edge_recon_loss: 97982.1641; train_gene_expr_recon_loss: 113083.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211301.9531; train_optim_loss: 211301.9531; val_kl_reg_loss: 191.2890; val_edge_recon_loss: 122966.0547; val_gene_expr_recon_loss: 112378.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235535.7500; val_optim_loss: 235535.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7924; val_auprc_score: 0.9475; val_best_acc_score: 0.8584; val_best_f1_score: 0.9225; train_kl_reg_loss: 190.9869; train_edge_recon_loss: 101014.4023; train_gene_expr_recon_loss: 112789.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213994.5234; train_optim_loss: 213994.5234; val_kl_reg_loss: 187.6996; val_edge_recon_loss: 121450.3594; val_gene_expr_recon_loss: 112355.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233993.8125; val_optim_loss: 233993.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7204; val_auprc_score: 0.9222; val_best_acc_score: 0.8671; val_best_f1_score: 0.9283; train_kl_reg_loss: 188.8523; train_edge_recon_loss: 107606.9297; train_gene_expr_recon_loss: 113159.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220954.9688; train_optim_loss: 220954.9688; val_kl_reg_loss: 184.3874; val_edge_recon_loss: 110295.1797; val_gene_expr_recon_loss: 112313.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222793.0312; val_optim_loss: 222793.0312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7714; val_auprc_score: 0.9071; val_best_acc_score: 0.8467; val_best_f1_score: 0.9133; train_kl_reg_loss: 184.4707; train_edge_recon_loss: 102188.3555; train_gene_expr_recon_loss: 112538.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214911.3594; train_optim_loss: 214911.3594; val_kl_reg_loss: 180.9093; val_edge_recon_loss: 136588.3906; val_gene_expr_recon_loss: 112257.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249026.2969; val_optim_loss: 249026.2969

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 5.

--- MODEL EVALUATION ---
Val AUROC score: 0.7420
Val AUPRC score: 0.9468
Val best accuracy score: 0.8671
Val best F1 score: 0.9283
Val gene expr MSE score: 1.5814
Duration of model training in run 6: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 4621
Number of validation edges: 513
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7743; val_auprc_score: 0.9375; val_best_acc_score: 0.8733; val_best_f1_score: 0.9318; train_kl_reg_loss: 100.2131; train_edge_recon_loss: 99168.0609; train_gene_expr_recon_loss: 147262.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246530.8000; train_optim_loss: 246530.8000; val_kl_reg_loss: 234.2164; val_edge_recon_loss: 107592.2891; val_gene_expr_recon_loss: 126162.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233989.2812; val_optim_loss: 233989.2812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7971; val_auprc_score: 0.9556; val_best_acc_score: 0.8797; val_best_f1_score: 0.9350; train_kl_reg_loss: 385.0411; train_edge_recon_loss: 102573.5406; train_gene_expr_recon_loss: 120323.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223282.0906; train_optim_loss: 223282.0906; val_kl_reg_loss: 468.6656; val_edge_recon_loss: 105213.3672; val_gene_expr_recon_loss: 114891.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220573.4375; val_optim_loss: 220573.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7071; val_auprc_score: 0.8931; val_best_acc_score: 0.8588; val_best_f1_score: 0.9227; train_kl_reg_loss: 408.6221; train_edge_recon_loss: 99886.6844; train_gene_expr_recon_loss: 113205.6187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213500.9250; train_optim_loss: 213500.9250; val_kl_reg_loss: 266.6398; val_edge_recon_loss: 125310.5391; val_gene_expr_recon_loss: 112244.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237821.7031; val_optim_loss: 237821.7031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7237; val_auprc_score: 0.9150; val_best_acc_score: 0.8758; val_best_f1_score: 0.9324; train_kl_reg_loss: 219.9585; train_edge_recon_loss: 103012.2031; train_gene_expr_recon_loss: 110392.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213624.2500; train_optim_loss: 213624.2500; val_kl_reg_loss: 157.5804; val_edge_recon_loss: 109052.3750; val_gene_expr_recon_loss: 111597.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220807.0938; val_optim_loss: 220807.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6849; val_auprc_score: 0.9339; val_best_acc_score: 0.8929; val_best_f1_score: 0.9430; train_kl_reg_loss: 157.6559; train_edge_recon_loss: 100287.3109; train_gene_expr_recon_loss: 111453.9125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211898.8781; train_optim_loss: 211898.8781; val_kl_reg_loss: 146.0357; val_edge_recon_loss: 88425.3516; val_gene_expr_recon_loss: 110939.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199510.9531; val_optim_loss: 199510.9531
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7696; val_auprc_score: 0.9361; val_best_acc_score: 0.8779; val_best_f1_score: 0.9322; train_kl_reg_loss: 155.0201; train_edge_recon_loss: 103516.1125; train_gene_expr_recon_loss: 112379.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216050.8031; train_optim_loss: 216050.8031; val_kl_reg_loss: 154.3229; val_edge_recon_loss: 110590.9219; val_gene_expr_recon_loss: 110393.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221138.2812; val_optim_loss: 221138.2812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7338; val_auprc_score: 0.9166; val_best_acc_score: 0.8688; val_best_f1_score: 0.9284; train_kl_reg_loss: 172.9114; train_edge_recon_loss: 100212.0281; train_gene_expr_recon_loss: 111932.9078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212317.8469; train_optim_loss: 212317.8469; val_kl_reg_loss: 182.6040; val_edge_recon_loss: 110197.9453; val_gene_expr_recon_loss: 109980.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220360.6562; val_optim_loss: 220360.6562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7559; val_auprc_score: 0.9261; val_best_acc_score: 0.8908; val_best_f1_score: 0.9390; train_kl_reg_loss: 220.5366; train_edge_recon_loss: 100656.1547; train_gene_expr_recon_loss: 109975.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210851.8875; train_optim_loss: 210851.8875; val_kl_reg_loss: 250.6328; val_edge_recon_loss: 94729.7656; val_gene_expr_recon_loss: 109659.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204640.3750; val_optim_loss: 204640.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6932; val_auprc_score: 0.9067; val_best_acc_score: 0.8767; val_best_f1_score: 0.9324; train_kl_reg_loss: 276.5156; train_edge_recon_loss: 102252.0703; train_gene_expr_recon_loss: 109972.0969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212500.6875; train_optim_loss: 212500.6875; val_kl_reg_loss: 257.3274; val_edge_recon_loss: 104125.0156; val_gene_expr_recon_loss: 109616.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213998.6562; val_optim_loss: 213998.6562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6906; val_auprc_score: 0.8885; val_best_acc_score: 0.8646; val_best_f1_score: 0.9239; train_kl_reg_loss: 295.6007; train_edge_recon_loss: 99117.0375; train_gene_expr_recon_loss: 111475.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210887.7000; train_optim_loss: 210887.7000; val_kl_reg_loss: 262.3217; val_edge_recon_loss: 117067.3047; val_gene_expr_recon_loss: 109561.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226891.3125; val_optim_loss: 226891.3125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7093; val_auprc_score: 0.9030; val_best_acc_score: 0.8692; val_best_f1_score: 0.9272; train_kl_reg_loss: 293.9990; train_edge_recon_loss: 99602.5656; train_gene_expr_recon_loss: 110086.5641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209983.1281; train_optim_loss: 209983.1281; val_kl_reg_loss: 275.0029; val_edge_recon_loss: 108031.8750; val_gene_expr_recon_loss: 109500.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217807.6250; val_optim_loss: 217807.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 5.

--- MODEL EVALUATION ---
Val AUROC score: 0.7593
Val AUPRC score: 0.9232
Val best accuracy score: 0.8649
Val best F1 score: 0.9260
Val gene expr MSE score: 1.6861
Duration of model training in run 7: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 4621
Number of validation edges: 513
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8031; val_auprc_score: 0.9545; val_best_acc_score: 0.8760; val_best_f1_score: 0.9327; train_kl_reg_loss: 102.7816; train_edge_recon_loss: 100357.7391; train_gene_expr_recon_loss: 145947.0250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246407.5438; train_optim_loss: 246407.5438; val_kl_reg_loss: 225.1436; val_edge_recon_loss: 113446.5078; val_gene_expr_recon_loss: 122391.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236063.3594; val_optim_loss: 236063.3594
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7554; val_auprc_score: 0.9275; val_best_acc_score: 0.8515; val_best_f1_score: 0.9184; train_kl_reg_loss: 315.8478; train_edge_recon_loss: 106312.8797; train_gene_expr_recon_loss: 122788.6812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229417.4062; train_optim_loss: 229417.4062; val_kl_reg_loss: 311.5410; val_edge_recon_loss: 131575.6875; val_gene_expr_recon_loss: 112659.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244546.9062; val_optim_loss: 244546.9062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7131; val_auprc_score: 0.9021; val_best_acc_score: 0.8583; val_best_f1_score: 0.9218; train_kl_reg_loss: 276.0368; train_edge_recon_loss: 100270.3969; train_gene_expr_recon_loss: 117520.9172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218067.3469; train_optim_loss: 218067.3469; val_kl_reg_loss: 185.6225; val_edge_recon_loss: 131247.1406; val_gene_expr_recon_loss: 110422.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241854.9688; val_optim_loss: 241854.9688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7389; val_auprc_score: 0.9476; val_best_acc_score: 0.8983; val_best_f1_score: 0.9455; train_kl_reg_loss: 161.8135; train_edge_recon_loss: 103874.9891; train_gene_expr_recon_loss: 114562.4578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218599.2625; train_optim_loss: 218599.2625; val_kl_reg_loss: 108.5572; val_edge_recon_loss: 90349.4609; val_gene_expr_recon_loss: 109772.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200230.3750; val_optim_loss: 200230.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7091; val_auprc_score: 0.9290; val_best_acc_score: 0.8754; val_best_f1_score: 0.9327; train_kl_reg_loss: 112.5465; train_edge_recon_loss: 105380.7719; train_gene_expr_recon_loss: 113662.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219156.1781; train_optim_loss: 219156.1781; val_kl_reg_loss: 102.8930; val_edge_recon_loss: 105537.6250; val_gene_expr_recon_loss: 109394.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215034.8438; val_optim_loss: 215034.8438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7406; val_auprc_score: 0.9186; val_best_acc_score: 0.8675; val_best_f1_score: 0.9277; train_kl_reg_loss: 119.9491; train_edge_recon_loss: 104396.5703; train_gene_expr_recon_loss: 113104.4734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217620.9969; train_optim_loss: 217620.9969; val_kl_reg_loss: 128.3206; val_edge_recon_loss: 111709.1250; val_gene_expr_recon_loss: 109112.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220950.4062; val_optim_loss: 220950.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7612; val_auprc_score: 0.9389; val_best_acc_score: 0.8859; val_best_f1_score: 0.9376; train_kl_reg_loss: 157.6640; train_edge_recon_loss: 97047.0078; train_gene_expr_recon_loss: 110876.7781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208081.4531; train_optim_loss: 208081.4531; val_kl_reg_loss: 168.9707; val_edge_recon_loss: 94073.5547; val_gene_expr_recon_loss: 108601.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202844.4375; val_optim_loss: 202844.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7400; val_auprc_score: 0.9229; val_best_acc_score: 0.8623; val_best_f1_score: 0.9229; train_kl_reg_loss: 184.4768; train_edge_recon_loss: 101456.1391; train_gene_expr_recon_loss: 112294.1687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213934.7844; train_optim_loss: 213934.7844; val_kl_reg_loss: 172.3789; val_edge_recon_loss: 116836.8438; val_gene_expr_recon_loss: 108531.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225540.5938; val_optim_loss: 225540.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7777; val_auprc_score: 0.9379; val_best_acc_score: 0.8915; val_best_f1_score: 0.9393; train_kl_reg_loss: 188.6434; train_edge_recon_loss: 95987.0188; train_gene_expr_recon_loss: 112154.4516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208330.1156; train_optim_loss: 208330.1156; val_kl_reg_loss: 175.9023; val_edge_recon_loss: 101224.2188; val_gene_expr_recon_loss: 108433.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209834.0781; val_optim_loss: 209834.0781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7074; val_auprc_score: 0.9162; val_best_acc_score: 0.8752; val_best_f1_score: 0.9307; train_kl_reg_loss: 192.1796; train_edge_recon_loss: 98351.3094; train_gene_expr_recon_loss: 113437.7844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211981.2687; train_optim_loss: 211981.2687; val_kl_reg_loss: 177.8704; val_edge_recon_loss: 105585.0938; val_gene_expr_recon_loss: 108345.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214108.6250; val_optim_loss: 214108.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.7252
Val AUPRC score: 0.9061
Val best accuracy score: 0.8564
Val best F1 score: 0.9210
Val gene expr MSE score: 1.3741
Duration of model training in run 8: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 5804
Number of validation edges: 644
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7249; val_auprc_score: 0.9043; val_best_acc_score: 0.8513; val_best_f1_score: 0.9191; train_kl_reg_loss: 114.1388; train_edge_recon_loss: 103005.9961; train_gene_expr_recon_loss: 138600.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241720.1458; train_optim_loss: 241720.1458; val_kl_reg_loss: 288.5261; val_edge_recon_loss: 123492.4531; val_gene_expr_recon_loss: 124293.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248074.7344; val_optim_loss: 248074.7344
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7041; val_auprc_score: 0.9105; val_best_acc_score: 0.8799; val_best_f1_score: 0.9349; train_kl_reg_loss: 335.3459; train_edge_recon_loss: 105165.4232; train_gene_expr_recon_loss: 116177.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221678.1068; train_optim_loss: 221678.1068; val_kl_reg_loss: 294.8523; val_edge_recon_loss: 105538.9062; val_gene_expr_recon_loss: 116600.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222434.0938; val_optim_loss: 222434.0938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6652; val_auprc_score: 0.8952; val_best_acc_score: 0.8689; val_best_f1_score: 0.9281; train_kl_reg_loss: 205.5925; train_edge_recon_loss: 100967.8932; train_gene_expr_recon_loss: 112798.2865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213971.7708; train_optim_loss: 213971.7708; val_kl_reg_loss: 123.8295; val_edge_recon_loss: 116744.7422; val_gene_expr_recon_loss: 115574.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232442.7812; val_optim_loss: 232442.7812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6984; val_auprc_score: 0.8996; val_best_acc_score: 0.8798; val_best_f1_score: 0.9333; train_kl_reg_loss: 107.4281; train_edge_recon_loss: 101199.6797; train_gene_expr_recon_loss: 112143.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213450.8125; train_optim_loss: 213450.8125; val_kl_reg_loss: 110.6086; val_edge_recon_loss: 114962.0781; val_gene_expr_recon_loss: 114804.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229876.8438; val_optim_loss: 229876.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7394; val_auprc_score: 0.9233; val_best_acc_score: 0.8747; val_best_f1_score: 0.9318; train_kl_reg_loss: 120.2094; train_edge_recon_loss: 99894.3464; train_gene_expr_recon_loss: 111526.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211540.6901; train_optim_loss: 211540.6901; val_kl_reg_loss: 144.6642; val_edge_recon_loss: 108432.3750; val_gene_expr_recon_loss: 114328.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222905.3438; val_optim_loss: 222905.3438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7460; val_auprc_score: 0.9181; val_best_acc_score: 0.8818; val_best_f1_score: 0.9343; train_kl_reg_loss: 144.6516; train_edge_recon_loss: 104892.2669; train_gene_expr_recon_loss: 111258.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216294.9661; train_optim_loss: 216294.9661; val_kl_reg_loss: 156.6857; val_edge_recon_loss: 108072.8750; val_gene_expr_recon_loss: 114184.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222414.5000; val_optim_loss: 222414.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7193; val_auprc_score: 0.9156; val_best_acc_score: 0.8739; val_best_f1_score: 0.9305; train_kl_reg_loss: 183.9890; train_edge_recon_loss: 103253.1966; train_gene_expr_recon_loss: 111036.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214473.4531; train_optim_loss: 214473.4531; val_kl_reg_loss: 255.6017; val_edge_recon_loss: 110433.9297; val_gene_expr_recon_loss: 113946.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224635.6562; val_optim_loss: 224635.6562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7397; val_auprc_score: 0.9258; val_best_acc_score: 0.8555; val_best_f1_score: 0.9202; train_kl_reg_loss: 331.4656; train_edge_recon_loss: 98646.6471; train_gene_expr_recon_loss: 110626.4258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209604.5417; train_optim_loss: 209604.5417; val_kl_reg_loss: 453.5861; val_edge_recon_loss: 116469.6641; val_gene_expr_recon_loss: 113708.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230631.9688; val_optim_loss: 230631.9688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7422; val_auprc_score: 0.9380; val_best_acc_score: 0.8995; val_best_f1_score: 0.9445; train_kl_reg_loss: 553.8071; train_edge_recon_loss: 95326.8359; train_gene_expr_recon_loss: 109826.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205706.9115; train_optim_loss: 205706.9115; val_kl_reg_loss: 730.9393; val_edge_recon_loss: 88700.8359; val_gene_expr_recon_loss: 113559.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202991.0000; val_optim_loss: 202991.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7541; val_auprc_score: 0.9316; val_best_acc_score: 0.8840; val_best_f1_score: 0.9364; train_kl_reg_loss: 830.4380; train_edge_recon_loss: 91674.3646; train_gene_expr_recon_loss: 109376.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201881.1380; train_optim_loss: 201881.1380; val_kl_reg_loss: 981.5138; val_edge_recon_loss: 90824.0938; val_gene_expr_recon_loss: 113199.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205004.8125; val_optim_loss: 205004.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7426; val_auprc_score: 0.9235; val_best_acc_score: 0.8877; val_best_f1_score: 0.9375; train_kl_reg_loss: 1024.9751; train_edge_recon_loss: 95119.3490; train_gene_expr_recon_loss: 109200.7956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205345.1224; train_optim_loss: 205345.1224; val_kl_reg_loss: 1108.6604; val_edge_recon_loss: 94177.7266; val_gene_expr_recon_loss: 113153.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208440.0625; val_optim_loss: 208440.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7098; val_auprc_score: 0.9136; val_best_acc_score: 0.8763; val_best_f1_score: 0.9313; train_kl_reg_loss: 1080.8574; train_edge_recon_loss: 92124.8281; train_gene_expr_recon_loss: 109123.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202329.3281; train_optim_loss: 202329.3281; val_kl_reg_loss: 1203.6008; val_edge_recon_loss: 101723.5469; val_gene_expr_recon_loss: 112970.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215897.9062; val_optim_loss: 215897.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7579; val_auprc_score: 0.9374; val_best_acc_score: 0.8865; val_best_f1_score: 0.9369; train_kl_reg_loss: 1148.2851; train_edge_recon_loss: 93337.3451; train_gene_expr_recon_loss: 108729.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203214.9245; train_optim_loss: 203214.9245; val_kl_reg_loss: 1208.0898; val_edge_recon_loss: 96452.1953; val_gene_expr_recon_loss: 112932.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210592.9688; val_optim_loss: 210592.9688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7246; val_auprc_score: 0.9227; val_best_acc_score: 0.8935; val_best_f1_score: 0.9416; train_kl_reg_loss: 1148.7137; train_edge_recon_loss: 93319.4284; train_gene_expr_recon_loss: 108568.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203036.6849; train_optim_loss: 203036.6849; val_kl_reg_loss: 1200.1924; val_edge_recon_loss: 83334.3203; val_gene_expr_recon_loss: 112910.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197445.0000; val_optim_loss: 197445.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7333; val_auprc_score: 0.9247; val_best_acc_score: 0.8783; val_best_f1_score: 0.9327; train_kl_reg_loss: 1151.2486; train_edge_recon_loss: 96023.8646; train_gene_expr_recon_loss: 108701.4232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205876.5365; train_optim_loss: 205876.5365; val_kl_reg_loss: 1191.8442; val_edge_recon_loss: 96949.5625; val_gene_expr_recon_loss: 112882.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211023.8750; val_optim_loss: 211023.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7743; val_auprc_score: 0.9477; val_best_acc_score: 0.8972; val_best_f1_score: 0.9440; train_kl_reg_loss: 1151.6913; train_edge_recon_loss: 93766.2786; train_gene_expr_recon_loss: 108591.1693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203509.1380; train_optim_loss: 203509.1380; val_kl_reg_loss: 1207.4955; val_edge_recon_loss: 81101.2500; val_gene_expr_recon_loss: 112862.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195171.5312; val_optim_loss: 195171.5312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.6922; val_auprc_score: 0.8978; val_best_acc_score: 0.8735; val_best_f1_score: 0.9303; train_kl_reg_loss: 1145.2881; train_edge_recon_loss: 95327.7669; train_gene_expr_recon_loss: 108042.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204515.1458; train_optim_loss: 204515.1458; val_kl_reg_loss: 1225.7234; val_edge_recon_loss: 103579.2266; val_gene_expr_recon_loss: 112835.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217640.7656; val_optim_loss: 217640.7656
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7249; val_auprc_score: 0.9088; val_best_acc_score: 0.8789; val_best_f1_score: 0.9330; train_kl_reg_loss: 1175.2808; train_edge_recon_loss: 92551.8724; train_gene_expr_recon_loss: 108461.7487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202188.8984; train_optim_loss: 202188.8984; val_kl_reg_loss: 1250.8000; val_edge_recon_loss: 98319.1875; val_gene_expr_recon_loss: 112815.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212385.2500; val_optim_loss: 212385.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7209; val_auprc_score: 0.9127; val_best_acc_score: 0.8879; val_best_f1_score: 0.9385; train_kl_reg_loss: 1173.8810; train_edge_recon_loss: 91162.5208; train_gene_expr_recon_loss: 108221.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200557.4922; train_optim_loss: 200557.4922; val_kl_reg_loss: 1221.8474; val_edge_recon_loss: 90725.1484; val_gene_expr_recon_loss: 112797.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204744.9375; val_optim_loss: 204744.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7107; val_auprc_score: 0.9015; val_best_acc_score: 0.8635; val_best_f1_score: 0.9246; train_kl_reg_loss: 1176.5317; train_edge_recon_loss: 89901.9297; train_gene_expr_recon_loss: 108190.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199269.0417; train_optim_loss: 199269.0417; val_kl_reg_loss: 1234.1946; val_edge_recon_loss: 104743.9062; val_gene_expr_recon_loss: 112796.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218774.2812; val_optim_loss: 218774.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7357; val_auprc_score: 0.9140; val_best_acc_score: 0.8985; val_best_f1_score: 0.9440; train_kl_reg_loss: 1167.0571; train_edge_recon_loss: 92028.0964; train_gene_expr_recon_loss: 108677.4661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201872.6198; train_optim_loss: 201872.6198; val_kl_reg_loss: 1234.0369; val_edge_recon_loss: 85836.1719; val_gene_expr_recon_loss: 112793.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199863.5625; val_optim_loss: 199863.5625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7332; val_auprc_score: 0.9062; val_best_acc_score: 0.8813; val_best_f1_score: 0.9344; train_kl_reg_loss: 1178.8871; train_edge_recon_loss: 89987.7292; train_gene_expr_recon_loss: 108761.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199928.4115; train_optim_loss: 199928.4115; val_kl_reg_loss: 1238.9197; val_edge_recon_loss: 94415.1406; val_gene_expr_recon_loss: 112789.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208443.4531; val_optim_loss: 208443.4531

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 8 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.7591
Val AUPRC score: 0.9301
Val best accuracy score: 0.8905
Val best F1 score: 0.9395
Val gene expr MSE score: 1.5863
Duration of model training in run 9: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 471
Number of validation nodes: 52
Number of training edges: 5804
Number of validation edges: 644
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7639; val_auprc_score: 0.9260; val_best_acc_score: 0.8543; val_best_f1_score: 0.9199; train_kl_reg_loss: 98.2220; train_edge_recon_loss: 103894.5156; train_gene_expr_recon_loss: 139371.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243364.4401; train_optim_loss: 243364.4401; val_kl_reg_loss: 236.0621; val_edge_recon_loss: 125248.8047; val_gene_expr_recon_loss: 133454.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258939.7500; val_optim_loss: 258939.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7305; val_auprc_score: 0.9102; val_best_acc_score: 0.8555; val_best_f1_score: 0.9192; train_kl_reg_loss: 280.4970; train_edge_recon_loss: 101041.6875; train_gene_expr_recon_loss: 117967.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219289.2188; train_optim_loss: 219289.2188; val_kl_reg_loss: 259.4845; val_edge_recon_loss: 130142.4766; val_gene_expr_recon_loss: 124025.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254427.2500; val_optim_loss: 254427.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7266; val_auprc_score: 0.9096; val_best_acc_score: 0.8732; val_best_f1_score: 0.9303; train_kl_reg_loss: 196.7159; train_edge_recon_loss: 100469.8047; train_gene_expr_recon_loss: 112462.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213128.5443; train_optim_loss: 213128.5443; val_kl_reg_loss: 133.7711; val_edge_recon_loss: 118183.2188; val_gene_expr_recon_loss: 122348.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240665.7656; val_optim_loss: 240665.7656
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7257; val_auprc_score: 0.9114; val_best_acc_score: 0.8613; val_best_f1_score: 0.9234; train_kl_reg_loss: 112.8107; train_edge_recon_loss: 101447.8281; train_gene_expr_recon_loss: 112139.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213700.4167; train_optim_loss: 213700.4167; val_kl_reg_loss: 106.5318; val_edge_recon_loss: 123451.5859; val_gene_expr_recon_loss: 121586.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245144.8750; val_optim_loss: 245144.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6976; val_auprc_score: 0.9098; val_best_acc_score: 0.8858; val_best_f1_score: 0.9371; train_kl_reg_loss: 104.6606; train_edge_recon_loss: 102697.3451; train_gene_expr_recon_loss: 110993.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213795.3568; train_optim_loss: 213795.3568; val_kl_reg_loss: 119.7503; val_edge_recon_loss: 111020.1328; val_gene_expr_recon_loss: 121164.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232304.7812; val_optim_loss: 232304.7812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7989; val_auprc_score: 0.9312; val_best_acc_score: 0.8928; val_best_f1_score: 0.9395; train_kl_reg_loss: 118.3461; train_edge_recon_loss: 101296.2604; train_gene_expr_recon_loss: 111476.0794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212890.6823; train_optim_loss: 212890.6823; val_kl_reg_loss: 142.9156; val_edge_recon_loss: 113833.8594; val_gene_expr_recon_loss: 120752.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234729.2188; val_optim_loss: 234729.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7497; val_auprc_score: 0.9030; val_best_acc_score: 0.8950; val_best_f1_score: 0.9405; train_kl_reg_loss: 164.6538; train_edge_recon_loss: 102675.5911; train_gene_expr_recon_loss: 110200.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213041.1042; train_optim_loss: 213041.1042; val_kl_reg_loss: 248.9665; val_edge_recon_loss: 106901.8906; val_gene_expr_recon_loss: 120460.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227611.2969; val_optim_loss: 227611.2969
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7454; val_auprc_score: 0.9389; val_best_acc_score: 0.8953; val_best_f1_score: 0.9428; train_kl_reg_loss: 307.6517; train_edge_recon_loss: 93344.5130; train_gene_expr_recon_loss: 109902.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203555.1562; train_optim_loss: 203555.1562; val_kl_reg_loss: 471.6034; val_edge_recon_loss: 91435.5703; val_gene_expr_recon_loss: 120293.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212200.5000; val_optim_loss: 212200.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7735; val_auprc_score: 0.9436; val_best_acc_score: 0.9038; val_best_f1_score: 0.9475; train_kl_reg_loss: 542.6118; train_edge_recon_loss: 97234.0859; train_gene_expr_recon_loss: 109849.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207626.6875; train_optim_loss: 207626.6875; val_kl_reg_loss: 746.9113; val_edge_recon_loss: 80011.7500; val_gene_expr_recon_loss: 120047.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200806.4375; val_optim_loss: 200806.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7649; val_auprc_score: 0.9349; val_best_acc_score: 0.8981; val_best_f1_score: 0.9443; train_kl_reg_loss: 791.2453; train_edge_recon_loss: 93729.6302; train_gene_expr_recon_loss: 109593.6862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204114.5651; train_optim_loss: 204114.5651; val_kl_reg_loss: 1019.3168; val_edge_recon_loss: 84253.2109; val_gene_expr_recon_loss: 119480.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204753.3750; val_optim_loss: 204753.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7269; val_auprc_score: 0.9064; val_best_acc_score: 0.8880; val_best_f1_score: 0.9379; train_kl_reg_loss: 991.7930; train_edge_recon_loss: 92726.5885; train_gene_expr_recon_loss: 109354.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203073.2370; train_optim_loss: 203073.2370; val_kl_reg_loss: 1172.3080; val_edge_recon_loss: 97485.5859; val_gene_expr_recon_loss: 119224.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217882.3750; val_optim_loss: 217882.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7192; val_auprc_score: 0.9128; val_best_acc_score: 0.8960; val_best_f1_score: 0.9429; train_kl_reg_loss: 1105.4443; train_edge_recon_loss: 90424.7930; train_gene_expr_recon_loss: 108639.3763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200169.6146; train_optim_loss: 200169.6146; val_kl_reg_loss: 1251.0264; val_edge_recon_loss: 92901.5859; val_gene_expr_recon_loss: 119004.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213157.4688; val_optim_loss: 213157.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6749; val_auprc_score: 0.9076; val_best_acc_score: 0.8874; val_best_f1_score: 0.9388; train_kl_reg_loss: 1127.8917; train_edge_recon_loss: 95848.2826; train_gene_expr_recon_loss: 108378.9701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205355.1458; train_optim_loss: 205355.1458; val_kl_reg_loss: 1230.7686; val_edge_recon_loss: 93784.0234; val_gene_expr_recon_loss: 118983.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213998.1875; val_optim_loss: 213998.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7698; val_auprc_score: 0.9398; val_best_acc_score: 0.8861; val_best_f1_score: 0.9374; train_kl_reg_loss: 1133.4219; train_edge_recon_loss: 90030.4531; train_gene_expr_recon_loss: 108652.3112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199816.1875; train_optim_loss: 199816.1875; val_kl_reg_loss: 1239.9551; val_edge_recon_loss: 94532.6719; val_gene_expr_recon_loss: 118942.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214715.4688; val_optim_loss: 214715.4688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7287; val_auprc_score: 0.9030; val_best_acc_score: 0.8655; val_best_f1_score: 0.9249; train_kl_reg_loss: 1137.7095; train_edge_recon_loss: 91080.3385; train_gene_expr_recon_loss: 108883.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201101.3438; train_optim_loss: 201101.3438; val_kl_reg_loss: 1243.2957; val_edge_recon_loss: 112042.2266; val_gene_expr_recon_loss: 118903.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232188.5312; val_optim_loss: 232188.5312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.7370
Val AUPRC score: 0.9272
Val best accuracy score: 0.9076
Val best F1 score: 0.9496
Val gene expr MSE score: 2.3116
Duration of model training in run 10: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_221451.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8986; val_auprc_score: 0.9780; val_best_acc_score: 0.8999; val_best_f1_score: 0.9438; train_kl_reg_loss: 53.9951; train_edge_recon_loss: 101370.6094; train_gene_expr_recon_loss: 155872.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 257297.4062; train_optim_loss: 257297.4062; val_kl_reg_loss: 57.7992; val_edge_recon_loss: 107978.2422; val_gene_expr_recon_loss: 145758.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253794.5000; val_optim_loss: 253794.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9021; val_auprc_score: 0.9773; val_best_acc_score: 0.9109; val_best_f1_score: 0.9508; train_kl_reg_loss: 58.6990; train_edge_recon_loss: 105279.2188; train_gene_expr_recon_loss: 147154.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 252492.0000; train_optim_loss: 252492.0000; val_kl_reg_loss: 84.0713; val_edge_recon_loss: 98630.7422; val_gene_expr_recon_loss: 138285.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237000.6250; val_optim_loss: 237000.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8879; val_auprc_score: 0.9719; val_best_acc_score: 0.8788; val_best_f1_score: 0.9316; train_kl_reg_loss: 85.0230; train_edge_recon_loss: 98829.2656; train_gene_expr_recon_loss: 139551.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238465.5938; train_optim_loss: 238465.5938; val_kl_reg_loss: 126.9586; val_edge_recon_loss: 118497.9062; val_gene_expr_recon_loss: 131890.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250515.1250; val_optim_loss: 250515.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9006; val_auprc_score: 0.9808; val_best_acc_score: 0.8821; val_best_f1_score: 0.9332; train_kl_reg_loss: 128.0158; train_edge_recon_loss: 100460.2344; train_gene_expr_recon_loss: 133064.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233652.6875; train_optim_loss: 233652.6875; val_kl_reg_loss: 186.5755; val_edge_recon_loss: 114720.4297; val_gene_expr_recon_loss: 126561.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241468.0938; val_optim_loss: 241468.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8664; val_auprc_score: 0.9716; val_best_acc_score: 0.9010; val_best_f1_score: 0.9452; train_kl_reg_loss: 186.3244; train_edge_recon_loss: 102144.7109; train_gene_expr_recon_loss: 127654.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229985.0938; train_optim_loss: 229985.0938; val_kl_reg_loss: 253.8334; val_edge_recon_loss: 111215.1094; val_gene_expr_recon_loss: 122318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233786.9375; val_optim_loss: 233786.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9074; val_auprc_score: 0.9829; val_best_acc_score: 0.8987; val_best_f1_score: 0.9444; train_kl_reg_loss: 257.4302; train_edge_recon_loss: 101793.4531; train_gene_expr_recon_loss: 123324.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225375.8125; train_optim_loss: 225375.8125; val_kl_reg_loss: 312.6255; val_edge_recon_loss: 105633.0391; val_gene_expr_recon_loss: 119135.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225080.9844; val_optim_loss: 225080.9844
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8578; val_auprc_score: 0.9564; val_best_acc_score: 0.8767; val_best_f1_score: 0.9315; train_kl_reg_loss: 314.3831; train_edge_recon_loss: 99282.1875; train_gene_expr_recon_loss: 120098.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219695.0000; train_optim_loss: 219695.0000; val_kl_reg_loss: 343.1473; val_edge_recon_loss: 123747.0312; val_gene_expr_recon_loss: 116793.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240884.0000; val_optim_loss: 240884.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8790; val_auprc_score: 0.9751; val_best_acc_score: 0.8909; val_best_f1_score: 0.9398; train_kl_reg_loss: 344.2981; train_edge_recon_loss: 102828.6562; train_gene_expr_recon_loss: 117720.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220893.1719; train_optim_loss: 220893.1719; val_kl_reg_loss: 347.9371; val_edge_recon_loss: 109228.5000; val_gene_expr_recon_loss: 115043.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224619.7344; val_optim_loss: 224619.7344
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8410; val_auprc_score: 0.9514; val_best_acc_score: 0.8798; val_best_f1_score: 0.9318; train_kl_reg_loss: 352.0509; train_edge_recon_loss: 98427.1172; train_gene_expr_recon_loss: 115965.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214744.3594; train_optim_loss: 214744.3594; val_kl_reg_loss: 337.5524; val_edge_recon_loss: 124926.3359; val_gene_expr_recon_loss: 113722.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238986.6875; val_optim_loss: 238986.6875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8425; val_auprc_score: 0.9553; val_best_acc_score: 0.8883; val_best_f1_score: 0.9375; train_kl_reg_loss: 337.6694; train_edge_recon_loss: 98659.5312; train_gene_expr_recon_loss: 114642.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213640.0312; train_optim_loss: 213640.0312; val_kl_reg_loss: 310.4290; val_edge_recon_loss: 117522.1641; val_gene_expr_recon_loss: 112737.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230570.0938; val_optim_loss: 230570.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8877; val_auprc_score: 0.9713; val_best_acc_score: 0.8887; val_best_f1_score: 0.9367; train_kl_reg_loss: 312.3601; train_edge_recon_loss: 106606.0625; train_gene_expr_recon_loss: 113655.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220573.8125; train_optim_loss: 220573.8125; val_kl_reg_loss: 270.9908; val_edge_recon_loss: 127267.3281; val_gene_expr_recon_loss: 112015.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239553.5469; val_optim_loss: 239553.5469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8777; val_auprc_score: 0.9714; val_best_acc_score: 0.8838; val_best_f1_score: 0.9344; train_kl_reg_loss: 274.2554; train_edge_recon_loss: 100956.6328; train_gene_expr_recon_loss: 112956.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214187.7188; train_optim_loss: 214187.7188; val_kl_reg_loss: 267.7991; val_edge_recon_loss: 114879.8750; val_gene_expr_recon_loss: 111952.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227100.6406; val_optim_loss: 227100.6406
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8528; val_auprc_score: 0.9655; val_best_acc_score: 0.8870; val_best_f1_score: 0.9365; train_kl_reg_loss: 269.7450; train_edge_recon_loss: 100417.8438; train_gene_expr_recon_loss: 112903.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213591.0312; train_optim_loss: 213591.0312; val_kl_reg_loss: 265.7245; val_edge_recon_loss: 109338.5703; val_gene_expr_recon_loss: 111888.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221493.1719; val_optim_loss: 221493.1719
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8727; val_auprc_score: 0.9699; val_best_acc_score: 0.8983; val_best_f1_score: 0.9436; train_kl_reg_loss: 264.4322; train_edge_recon_loss: 101459.4844; train_gene_expr_recon_loss: 112840.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214564.7812; train_optim_loss: 214564.7812; val_kl_reg_loss: 256.2791; val_edge_recon_loss: 109200.7422; val_gene_expr_recon_loss: 111823.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221280.3438; val_optim_loss: 221280.3438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8364; val_auprc_score: 0.9472; val_best_acc_score: 0.8780; val_best_f1_score: 0.9307; train_kl_reg_loss: 258.6591; train_edge_recon_loss: 98500.0625; train_gene_expr_recon_loss: 112777.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211536.1875; train_optim_loss: 211536.1875; val_kl_reg_loss: 252.5659; val_edge_recon_loss: 128005.6562; val_gene_expr_recon_loss: 111756.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240014.8125; val_optim_loss: 240014.8125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9058; val_auprc_score: 0.9832; val_best_acc_score: 0.8937; val_best_f1_score: 0.9408; train_kl_reg_loss: 253.7374; train_edge_recon_loss: 102742.0234; train_gene_expr_recon_loss: 112723.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215718.9844; train_optim_loss: 215718.9844; val_kl_reg_loss: 245.8595; val_edge_recon_loss: 106507.7812; val_gene_expr_recon_loss: 111689.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218442.7812; val_optim_loss: 218442.7812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8682; val_auprc_score: 0.9712; val_best_acc_score: 0.8922; val_best_f1_score: 0.9400; train_kl_reg_loss: 247.4540; train_edge_recon_loss: 96950.8516; train_gene_expr_recon_loss: 112646.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209845.2188; train_optim_loss: 209845.2188; val_kl_reg_loss: 240.4340; val_edge_recon_loss: 106301.7969; val_gene_expr_recon_loss: 111621.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218163.4375; val_optim_loss: 218163.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8617; val_auprc_score: 0.9683; val_best_acc_score: 0.8877; val_best_f1_score: 0.9358; train_kl_reg_loss: 241.4092; train_edge_recon_loss: 103366.8359; train_gene_expr_recon_loss: 112590.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216198.8438; train_optim_loss: 216198.8438; val_kl_reg_loss: 235.1722; val_edge_recon_loss: 112499.8438; val_gene_expr_recon_loss: 111553.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224288.1250; val_optim_loss: 224288.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8908; val_auprc_score: 0.9765; val_best_acc_score: 0.8907; val_best_f1_score: 0.9393; train_kl_reg_loss: 236.1964; train_edge_recon_loss: 103071.1562; train_gene_expr_recon_loss: 112521.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215829.0312; train_optim_loss: 215829.0312; val_kl_reg_loss: 228.2198; val_edge_recon_loss: 113207.1797; val_gene_expr_recon_loss: 111485.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224920.6094; val_optim_loss: 224920.6094
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8530; val_auprc_score: 0.9563; val_best_acc_score: 0.8937; val_best_f1_score: 0.9391; train_kl_reg_loss: 230.0833; train_edge_recon_loss: 100099.2969; train_gene_expr_recon_loss: 112447.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212776.9844; train_optim_loss: 212776.9844; val_kl_reg_loss: 225.0751; val_edge_recon_loss: 106445.9141; val_gene_expr_recon_loss: 111417.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218088.6875; val_optim_loss: 218088.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8557; val_auprc_score: 0.9635; val_best_acc_score: 0.8806; val_best_f1_score: 0.9345; train_kl_reg_loss: 224.8110; train_edge_recon_loss: 103630.7500; train_gene_expr_recon_loss: 112386.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216242.1250; train_optim_loss: 216242.1250; val_kl_reg_loss: 220.0223; val_edge_recon_loss: 104098.7734; val_gene_expr_recon_loss: 111350.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215669.7031; val_optim_loss: 215669.7031
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8525; val_auprc_score: 0.9640; val_best_acc_score: 0.8812; val_best_f1_score: 0.9329; train_kl_reg_loss: 219.3709; train_edge_recon_loss: 102590.0312; train_gene_expr_recon_loss: 112320.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215129.6562; train_optim_loss: 215129.6562; val_kl_reg_loss: 214.7669; val_edge_recon_loss: 114834.7656; val_gene_expr_recon_loss: 111284.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226334.5000; val_optim_loss: 226334.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8828; val_auprc_score: 0.9718; val_best_acc_score: 0.8872; val_best_f1_score: 0.9355; train_kl_reg_loss: 213.9937; train_edge_recon_loss: 95561.0547; train_gene_expr_recon_loss: 112256.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208031.6562; train_optim_loss: 208031.6562; val_kl_reg_loss: 207.7118; val_edge_recon_loss: 117147.8750; val_gene_expr_recon_loss: 111219.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228575.5312; val_optim_loss: 228575.5312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8395; val_auprc_score: 0.9569; val_best_acc_score: 0.8797; val_best_f1_score: 0.9319; train_kl_reg_loss: 209.6313; train_edge_recon_loss: 100706.4844; train_gene_expr_recon_loss: 112193.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213109.4375; train_optim_loss: 213109.4375; val_kl_reg_loss: 205.1476; val_edge_recon_loss: 113967.3594; val_gene_expr_recon_loss: 111156.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225328.6250; val_optim_loss: 225328.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8504; val_auprc_score: 0.9657; val_best_acc_score: 0.8935; val_best_f1_score: 0.9406; train_kl_reg_loss: 205.3619; train_edge_recon_loss: 99910.0391; train_gene_expr_recon_loss: 112128.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212243.6875; train_optim_loss: 212243.6875; val_kl_reg_loss: 204.0903; val_edge_recon_loss: 112117.8906; val_gene_expr_recon_loss: 111149.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223471.7656; val_optim_loss: 223471.7656
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8741; val_auprc_score: 0.9709; val_best_acc_score: 0.8840; val_best_f1_score: 0.9341; train_kl_reg_loss: 204.7199; train_edge_recon_loss: 104076.9453; train_gene_expr_recon_loss: 112126.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216407.8125; train_optim_loss: 216407.8125; val_kl_reg_loss: 202.6564; val_edge_recon_loss: 114102.5625; val_gene_expr_recon_loss: 111143.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225448.6562; val_optim_loss: 225448.6562
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9053; val_auprc_score: 0.9811; val_best_acc_score: 0.8861; val_best_f1_score: 0.9348; train_kl_reg_loss: 204.2020; train_edge_recon_loss: 102523.7734; train_gene_expr_recon_loss: 112105.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214833.9062; train_optim_loss: 214833.9062; val_kl_reg_loss: 201.3676; val_edge_recon_loss: 118507.4688; val_gene_expr_recon_loss: 111137.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229845.8750; val_optim_loss: 229845.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 10 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.8477
Val AUPRC score: 0.9573
Val best accuracy score: 0.8842
Val best F1 score: 0.9351
Val gene expr MSE score: 1.6201
Duration of model training in run 1: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 5553
Number of validation edges: 617
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8692; val_auprc_score: 0.9580; val_best_acc_score: 0.9061; val_best_f1_score: 0.9455; train_kl_reg_loss: 52.1693; train_edge_recon_loss: 103319.9688; train_gene_expr_recon_loss: 154650.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258022.2656; train_optim_loss: 258022.2656; val_kl_reg_loss: 58.4686; val_edge_recon_loss: 122116.2344; val_gene_expr_recon_loss: 149856.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 272030.7500; val_optim_loss: 272030.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8755; val_auprc_score: 0.9670; val_best_acc_score: 0.9065; val_best_f1_score: 0.9460; train_kl_reg_loss: 59.4824; train_edge_recon_loss: 104696.0234; train_gene_expr_recon_loss: 145667.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 250422.7188; train_optim_loss: 250422.7188; val_kl_reg_loss: 85.4943; val_edge_recon_loss: 117318.2031; val_gene_expr_recon_loss: 142011.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259415.3125; val_optim_loss: 259415.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8969; val_auprc_score: 0.9763; val_best_acc_score: 0.9029; val_best_f1_score: 0.9447; train_kl_reg_loss: 87.4476; train_edge_recon_loss: 100228.2812; train_gene_expr_recon_loss: 137999.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238315.1250; train_optim_loss: 238315.1250; val_kl_reg_loss: 131.7121; val_edge_recon_loss: 122687.5781; val_gene_expr_recon_loss: 135410.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258230.0312; val_optim_loss: 258230.0312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8825; val_auprc_score: 0.9646; val_best_acc_score: 0.9087; val_best_f1_score: 0.9475; train_kl_reg_loss: 134.4167; train_edge_recon_loss: 100333.1953; train_gene_expr_recon_loss: 131499.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231966.8125; train_optim_loss: 231966.8125; val_kl_reg_loss: 194.5184; val_edge_recon_loss: 126355.8125; val_gene_expr_recon_loss: 130045.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256596.1406; val_optim_loss: 256596.1406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8530; val_auprc_score: 0.9628; val_best_acc_score: 0.8811; val_best_f1_score: 0.9346; train_kl_reg_loss: 198.7831; train_edge_recon_loss: 96782.3516; train_gene_expr_recon_loss: 126187.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223168.7344; train_optim_loss: 223168.7344; val_kl_reg_loss: 262.2741; val_edge_recon_loss: 117282.0312; val_gene_expr_recon_loss: 125942.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243486.5156; val_optim_loss: 243486.5156
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8718; val_auprc_score: 0.9759; val_best_acc_score: 0.9132; val_best_f1_score: 0.9527; train_kl_reg_loss: 267.5580; train_edge_recon_loss: 100775.9922; train_gene_expr_recon_loss: 122089.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223132.9844; train_optim_loss: 223132.9844; val_kl_reg_loss: 310.2992; val_edge_recon_loss: 97741.2578; val_gene_expr_recon_loss: 122965.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221017.2969; val_optim_loss: 221017.2969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8860; val_auprc_score: 0.9700; val_best_acc_score: 0.8983; val_best_f1_score: 0.9439; train_kl_reg_loss: 317.8785; train_edge_recon_loss: 97239.9297; train_gene_expr_recon_loss: 119089.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216647.6875; train_optim_loss: 216647.6875; val_kl_reg_loss: 318.2495; val_edge_recon_loss: 112094.6641; val_gene_expr_recon_loss: 120761.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233174.8125; val_optim_loss: 233174.8125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8823; val_auprc_score: 0.9717; val_best_acc_score: 0.9050; val_best_f1_score: 0.9465; train_kl_reg_loss: 328.3441; train_edge_recon_loss: 96785.7969; train_gene_expr_recon_loss: 116850.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213964.7812; train_optim_loss: 213964.7812; val_kl_reg_loss: 303.7238; val_edge_recon_loss: 119462.8984; val_gene_expr_recon_loss: 119083.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238850.1875; val_optim_loss: 238850.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8546; val_auprc_score: 0.9530; val_best_acc_score: 0.9104; val_best_f1_score: 0.9495; train_kl_reg_loss: 313.7565; train_edge_recon_loss: 99317.2734; train_gene_expr_recon_loss: 115171.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214802.5312; train_optim_loss: 214802.5312; val_kl_reg_loss: 278.1066; val_edge_recon_loss: 107350.0547; val_gene_expr_recon_loss: 117839.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225467.7812; val_optim_loss: 225467.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8822; val_auprc_score: 0.9718; val_best_acc_score: 0.9038; val_best_f1_score: 0.9449; train_kl_reg_loss: 284.5405; train_edge_recon_loss: 105330.8984; train_gene_expr_recon_loss: 113903.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219519.3125; train_optim_loss: 219519.3125; val_kl_reg_loss: 271.7756; val_edge_recon_loss: 120320.5156; val_gene_expr_recon_loss: 117734.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238327.2188; val_optim_loss: 238327.2188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8774; val_auprc_score: 0.9757; val_best_acc_score: 0.9063; val_best_f1_score: 0.9475; train_kl_reg_loss: 280.0684; train_edge_recon_loss: 103606.6484; train_gene_expr_recon_loss: 113787.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217674.2500; train_optim_loss: 217674.2500; val_kl_reg_loss: 268.3354; val_edge_recon_loss: 108024.1172; val_gene_expr_recon_loss: 117630.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225922.8594; val_optim_loss: 225922.8594
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9023; val_auprc_score: 0.9769; val_best_acc_score: 0.9076; val_best_f1_score: 0.9490; train_kl_reg_loss: 274.9756; train_edge_recon_loss: 99156.1562; train_gene_expr_recon_loss: 113699.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213130.6562; train_optim_loss: 213130.6562; val_kl_reg_loss: 260.0885; val_edge_recon_loss: 107168.4453; val_gene_expr_recon_loss: 117526.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224955.0625; val_optim_loss: 224955.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.9201
Val AUPRC score: 0.9826
Val best accuracy score: 0.9033
Val best F1 score: 0.9432
Val gene expr MSE score: 2.4045
Duration of model training in run 2: 0 hours, 0 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9370; val_auprc_score: 0.9773; val_best_acc_score: 0.9155; val_best_f1_score: 0.9492; train_kl_reg_loss: 66.8576; train_edge_recon_loss: 100734.3333; train_gene_expr_recon_loss: 144033.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244834.9844; train_optim_loss: 244834.9844; val_kl_reg_loss: 122.4491; val_edge_recon_loss: 122940.5156; val_gene_expr_recon_loss: 130225.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253288.9375; val_optim_loss: 253288.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9431; val_auprc_score: 0.9863; val_best_acc_score: 0.8967; val_best_f1_score: 0.9416; train_kl_reg_loss: 181.5602; train_edge_recon_loss: 105391.0312; train_gene_expr_recon_loss: 126694.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232266.9062; train_optim_loss: 232266.9062; val_kl_reg_loss: 276.5612; val_edge_recon_loss: 123739.6953; val_gene_expr_recon_loss: 119345.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243361.7344; val_optim_loss: 243361.7344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9335; val_auprc_score: 0.9841; val_best_acc_score: 0.9112; val_best_f1_score: 0.9485; train_kl_reg_loss: 300.5098; train_edge_recon_loss: 102501.3490; train_gene_expr_recon_loss: 118814.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221616.7656; train_optim_loss: 221616.7656; val_kl_reg_loss: 283.3034; val_edge_recon_loss: 128059.0781; val_gene_expr_recon_loss: 114844.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243187.1250; val_optim_loss: 243187.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9153; val_auprc_score: 0.9756; val_best_acc_score: 0.9200; val_best_f1_score: 0.9545; train_kl_reg_loss: 267.1364; train_edge_recon_loss: 100367.0573; train_gene_expr_recon_loss: 114558.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215192.4167; train_optim_loss: 215192.4167; val_kl_reg_loss: 211.5897; val_edge_recon_loss: 106881.5000; val_gene_expr_recon_loss: 113115.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220208.6875; val_optim_loss: 220208.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9015; val_auprc_score: 0.9800; val_best_acc_score: 0.9060; val_best_f1_score: 0.9464; train_kl_reg_loss: 196.4990; train_edge_recon_loss: 102311.5729; train_gene_expr_recon_loss: 113152.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215660.4948; train_optim_loss: 215660.4948; val_kl_reg_loss: 160.7340; val_edge_recon_loss: 105539.0703; val_gene_expr_recon_loss: 112404.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218104.2812; val_optim_loss: 218104.2812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8816; val_auprc_score: 0.9686; val_best_acc_score: 0.9010; val_best_f1_score: 0.9436; train_kl_reg_loss: 157.8455; train_edge_recon_loss: 101063.5964; train_gene_expr_recon_loss: 112954.0026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214175.4479; train_optim_loss: 214175.4479; val_kl_reg_loss: 149.0633; val_edge_recon_loss: 109669.4922; val_gene_expr_recon_loss: 111925.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221743.9531; val_optim_loss: 221743.9531
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8789; val_auprc_score: 0.9609; val_best_acc_score: 0.9069; val_best_f1_score: 0.9479; train_kl_reg_loss: 159.2053; train_edge_recon_loss: 100116.1328; train_gene_expr_recon_loss: 112279.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212554.3594; train_optim_loss: 212554.3594; val_kl_reg_loss: 177.2178; val_edge_recon_loss: 98529.7734; val_gene_expr_recon_loss: 111486.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210193.0469; val_optim_loss: 210193.0469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8482; val_auprc_score: 0.9594; val_best_acc_score: 0.9043; val_best_f1_score: 0.9460; train_kl_reg_loss: 200.4122; train_edge_recon_loss: 97626.9583; train_gene_expr_recon_loss: 111783.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209610.4375; train_optim_loss: 209610.4375; val_kl_reg_loss: 236.5666; val_edge_recon_loss: 93697.6406; val_gene_expr_recon_loss: 111079.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205014.1562; val_optim_loss: 205014.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8577; val_auprc_score: 0.9615; val_best_acc_score: 0.8791; val_best_f1_score: 0.9306; train_kl_reg_loss: 269.7425; train_edge_recon_loss: 99572.2734; train_gene_expr_recon_loss: 111707.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211549.8021; train_optim_loss: 211549.8021; val_kl_reg_loss: 328.9147; val_edge_recon_loss: 112494.3125; val_gene_expr_recon_loss: 110674.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223497.4375; val_optim_loss: 223497.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8394; val_auprc_score: 0.9631; val_best_acc_score: 0.9004; val_best_f1_score: 0.9442; train_kl_reg_loss: 384.3470; train_edge_recon_loss: 98182.6146; train_gene_expr_recon_loss: 110685.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209251.9740; train_optim_loss: 209251.9740; val_kl_reg_loss: 473.4293; val_edge_recon_loss: 89470.8359; val_gene_expr_recon_loss: 110280.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200224.9688; val_optim_loss: 200224.9688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8372; val_auprc_score: 0.9597; val_best_acc_score: 0.8871; val_best_f1_score: 0.9362; train_kl_reg_loss: 539.8183; train_edge_recon_loss: 92875.9036; train_gene_expr_recon_loss: 110854.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204270.2865; train_optim_loss: 204270.2865; val_kl_reg_loss: 671.4440; val_edge_recon_loss: 94745.7656; val_gene_expr_recon_loss: 109931.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205348.7188; val_optim_loss: 205348.7188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8839; val_auprc_score: 0.9754; val_best_acc_score: 0.9008; val_best_f1_score: 0.9446; train_kl_reg_loss: 790.3328; train_edge_recon_loss: 90173.6250; train_gene_expr_recon_loss: 110903.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201867.6042; train_optim_loss: 201867.6042; val_kl_reg_loss: 976.8977; val_edge_recon_loss: 84633.8984; val_gene_expr_recon_loss: 109574.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195185.3438; val_optim_loss: 195185.3438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8913; val_auprc_score: 0.9713; val_best_acc_score: 0.9066; val_best_f1_score: 0.9473; train_kl_reg_loss: 1125.0188; train_edge_recon_loss: 92585.9896; train_gene_expr_recon_loss: 109890.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203602.0000; train_optim_loss: 203602.0000; val_kl_reg_loss: 1341.6509; val_edge_recon_loss: 85661.7031; val_gene_expr_recon_loss: 109277.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196280.4062; val_optim_loss: 196280.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8371; val_auprc_score: 0.9475; val_best_acc_score: 0.8936; val_best_f1_score: 0.9404; train_kl_reg_loss: 1484.1316; train_edge_recon_loss: 87794.8021; train_gene_expr_recon_loss: 109325.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198604.3802; train_optim_loss: 198604.3802; val_kl_reg_loss: 1684.6919; val_edge_recon_loss: 88215.4609; val_gene_expr_recon_loss: 109058.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198958.8906; val_optim_loss: 198958.8906
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8881; val_auprc_score: 0.9724; val_best_acc_score: 0.9111; val_best_f1_score: 0.9492; train_kl_reg_loss: 1832.5356; train_edge_recon_loss: 83822.1615; train_gene_expr_recon_loss: 108726.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194381.2344; train_optim_loss: 194381.2344; val_kl_reg_loss: 1993.3427; val_edge_recon_loss: 86771.2266; val_gene_expr_recon_loss: 108879.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197644.0312; val_optim_loss: 197644.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9095; val_auprc_score: 0.9696; val_best_acc_score: 0.9151; val_best_f1_score: 0.9520; train_kl_reg_loss: 2043.0805; train_edge_recon_loss: 82409.3464; train_gene_expr_recon_loss: 108859.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193311.9167; train_optim_loss: 193311.9167; val_kl_reg_loss: 2006.7197; val_edge_recon_loss: 78423.0234; val_gene_expr_recon_loss: 108846.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189276.0312; val_optim_loss: 189276.0312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8826; val_auprc_score: 0.9748; val_best_acc_score: 0.9126; val_best_f1_score: 0.9510; train_kl_reg_loss: 2064.5736; train_edge_recon_loss: 83104.5599; train_gene_expr_recon_loss: 109198.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194367.3281; train_optim_loss: 194367.3281; val_kl_reg_loss: 2019.6980; val_edge_recon_loss: 75819.1094; val_gene_expr_recon_loss: 108798.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186637.2812; val_optim_loss: 186637.2812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8839; val_auprc_score: 0.9677; val_best_acc_score: 0.9029; val_best_f1_score: 0.9437; train_kl_reg_loss: 2069.5604; train_edge_recon_loss: 80439.3333; train_gene_expr_recon_loss: 109517.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192026.0885; train_optim_loss: 192026.0885; val_kl_reg_loss: 2016.1943; val_edge_recon_loss: 91661.3750; val_gene_expr_recon_loss: 108750.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202427.6562; val_optim_loss: 202427.6562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8892; val_auprc_score: 0.9705; val_best_acc_score: 0.9165; val_best_f1_score: 0.9525; train_kl_reg_loss: 2064.4181; train_edge_recon_loss: 83646.5599; train_gene_expr_recon_loss: 108934.6432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194645.6250; train_optim_loss: 194645.6250; val_kl_reg_loss: 2018.6553; val_edge_recon_loss: 79615.2891; val_gene_expr_recon_loss: 108702.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190336.5312; val_optim_loss: 190336.5312
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8855; val_auprc_score: 0.9722; val_best_acc_score: 0.9205; val_best_f1_score: 0.9549; train_kl_reg_loss: 2057.4208; train_edge_recon_loss: 80271.2760; train_gene_expr_recon_loss: 108750.7839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191079.4792; train_optim_loss: 191079.4792; val_kl_reg_loss: 2024.9010; val_edge_recon_loss: 79310.1094; val_gene_expr_recon_loss: 108656.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189991.6250; val_optim_loss: 189991.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8917; val_auprc_score: 0.9692; val_best_acc_score: 0.9174; val_best_f1_score: 0.9530; train_kl_reg_loss: 2067.9786; train_edge_recon_loss: 80841.3021; train_gene_expr_recon_loss: 109206.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192116.1823; train_optim_loss: 192116.1823; val_kl_reg_loss: 2015.1830; val_edge_recon_loss: 81380.0156; val_gene_expr_recon_loss: 108651.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192047.0312; val_optim_loss: 192047.0312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8698; val_auprc_score: 0.9690; val_best_acc_score: 0.9032; val_best_f1_score: 0.9450; train_kl_reg_loss: 2065.5723; train_edge_recon_loss: 85857.2865; train_gene_expr_recon_loss: 108904.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196827.7240; train_optim_loss: 196827.7240; val_kl_reg_loss: 2018.8201; val_edge_recon_loss: 88295.5234; val_gene_expr_recon_loss: 108646.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198960.8906; val_optim_loss: 198960.8906
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8875; val_auprc_score: 0.9709; val_best_acc_score: 0.9171; val_best_f1_score: 0.9533; train_kl_reg_loss: 2064.5781; train_edge_recon_loss: 81430.3698; train_gene_expr_recon_loss: 108981.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192476.6719; train_optim_loss: 192476.6719; val_kl_reg_loss: 2015.9869; val_edge_recon_loss: 76099.8047; val_gene_expr_recon_loss: 108641.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186756.8125; val_optim_loss: 186756.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.8822
Val AUPRC score: 0.9688
Val best accuracy score: 0.9107
Val best F1 score: 0.9491
Val gene expr MSE score: 1.4233
Duration of model training in run 3: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 10975
Number of validation edges: 1219
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9364; val_auprc_score: 0.9804; val_best_acc_score: 0.9225; val_best_f1_score: 0.9561; train_kl_reg_loss: 72.0509; train_edge_recon_loss: 101381.3359; train_gene_expr_recon_loss: 144685.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246139.1562; train_optim_loss: 246139.1562; val_kl_reg_loss: 132.4329; val_edge_recon_loss: 117828.0234; val_gene_expr_recon_loss: 133734.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251694.9219; val_optim_loss: 251694.9219
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9328; val_auprc_score: 0.9823; val_best_acc_score: 0.9148; val_best_f1_score: 0.9524; train_kl_reg_loss: 196.9042; train_edge_recon_loss: 98473.6354; train_gene_expr_recon_loss: 126042.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224713.2083; train_optim_loss: 224713.2083; val_kl_reg_loss: 321.1157; val_edge_recon_loss: 113557.6406; val_gene_expr_recon_loss: 121317.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235196.1875; val_optim_loss: 235196.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9068; val_auprc_score: 0.9722; val_best_acc_score: 0.9157; val_best_f1_score: 0.9522; train_kl_reg_loss: 341.1147; train_edge_recon_loss: 102353.2917; train_gene_expr_recon_loss: 117405.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220099.6406; train_optim_loss: 220099.6406; val_kl_reg_loss: 316.5638; val_edge_recon_loss: 114458.2891; val_gene_expr_recon_loss: 116209.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230984.0156; val_optim_loss: 230984.0156
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9316; val_auprc_score: 0.9820; val_best_acc_score: 0.9293; val_best_f1_score: 0.9594; train_kl_reg_loss: 288.3081; train_edge_recon_loss: 102866.6302; train_gene_expr_recon_loss: 113597.4974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216752.4323; train_optim_loss: 216752.4323; val_kl_reg_loss: 223.5258; val_edge_recon_loss: 114268.5625; val_gene_expr_recon_loss: 114418.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228910.1875; val_optim_loss: 228910.1875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9127; val_auprc_score: 0.9812; val_best_acc_score: 0.9168; val_best_f1_score: 0.9535; train_kl_reg_loss: 201.2162; train_edge_recon_loss: 97719.3125; train_gene_expr_recon_loss: 111141.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209062.3854; train_optim_loss: 209062.3854; val_kl_reg_loss: 160.5782; val_edge_recon_loss: 107880.6562; val_gene_expr_recon_loss: 113850.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221891.4844; val_optim_loss: 221891.4844
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8964; val_auprc_score: 0.9748; val_best_acc_score: 0.9079; val_best_f1_score: 0.9475; train_kl_reg_loss: 154.8241; train_edge_recon_loss: 100249.9688; train_gene_expr_recon_loss: 110981.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211385.8073; train_optim_loss: 211385.8073; val_kl_reg_loss: 145.9514; val_edge_recon_loss: 111391.3984; val_gene_expr_recon_loss: 113476.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225014.1094; val_optim_loss: 225014.1094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8877; val_auprc_score: 0.9662; val_best_acc_score: 0.9075; val_best_f1_score: 0.9469; train_kl_reg_loss: 153.3127; train_edge_recon_loss: 100780.5312; train_gene_expr_recon_loss: 110175.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211109.6354; train_optim_loss: 211109.6354; val_kl_reg_loss: 165.1386; val_edge_recon_loss: 114705.1250; val_gene_expr_recon_loss: 113060.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227930.7344; val_optim_loss: 227930.7344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8789; val_auprc_score: 0.9625; val_best_acc_score: 0.9017; val_best_f1_score: 0.9446; train_kl_reg_loss: 180.8583; train_edge_recon_loss: 100732.1484; train_gene_expr_recon_loss: 110190.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211103.3698; train_optim_loss: 211103.3698; val_kl_reg_loss: 200.5182; val_edge_recon_loss: 106787.0547; val_gene_expr_recon_loss: 112633.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219620.9062; val_optim_loss: 219620.9062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8647; val_auprc_score: 0.9596; val_best_acc_score: 0.8959; val_best_f1_score: 0.9415; train_kl_reg_loss: 224.3251; train_edge_recon_loss: 100038.8333; train_gene_expr_recon_loss: 109384.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209648.1354; train_optim_loss: 209648.1354; val_kl_reg_loss: 261.7742; val_edge_recon_loss: 101658.3828; val_gene_expr_recon_loss: 112196.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214116.2344; val_optim_loss: 214116.2344
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8655; val_auprc_score: 0.9710; val_best_acc_score: 0.8977; val_best_f1_score: 0.9426; train_kl_reg_loss: 293.8094; train_edge_recon_loss: 99242.7786; train_gene_expr_recon_loss: 108844.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208381.4115; train_optim_loss: 208381.4115; val_kl_reg_loss: 356.0439; val_edge_recon_loss: 92014.3828; val_gene_expr_recon_loss: 111759.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204129.4375; val_optim_loss: 204129.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8860; val_auprc_score: 0.9710; val_best_acc_score: 0.8901; val_best_f1_score: 0.9383; train_kl_reg_loss: 402.4825; train_edge_recon_loss: 96913.7891; train_gene_expr_recon_loss: 108440.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205756.5625; train_optim_loss: 205756.5625; val_kl_reg_loss: 501.7139; val_edge_recon_loss: 95957.8438; val_gene_expr_recon_loss: 111321.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207780.7344; val_optim_loss: 207780.7344
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8295; val_auprc_score: 0.9520; val_best_acc_score: 0.8881; val_best_f1_score: 0.9378; train_kl_reg_loss: 586.3374; train_edge_recon_loss: 98861.1406; train_gene_expr_recon_loss: 108581.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208028.9167; train_optim_loss: 208028.9167; val_kl_reg_loss: 754.1483; val_edge_recon_loss: 94112.3516; val_gene_expr_recon_loss: 110896.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205763.1875; val_optim_loss: 205763.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8543; val_auprc_score: 0.9623; val_best_acc_score: 0.8915; val_best_f1_score: 0.9399; train_kl_reg_loss: 869.0372; train_edge_recon_loss: 90988.1328; train_gene_expr_recon_loss: 107955.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199812.9323; train_optim_loss: 199812.9323; val_kl_reg_loss: 1100.3676; val_edge_recon_loss: 90685.4453; val_gene_expr_recon_loss: 110485.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202271.6250; val_optim_loss: 202271.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8842; val_auprc_score: 0.9694; val_best_acc_score: 0.9075; val_best_f1_score: 0.9471; train_kl_reg_loss: 1253.3689; train_edge_recon_loss: 90973.3568; train_gene_expr_recon_loss: 107589.8464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199816.5781; train_optim_loss: 199816.5781; val_kl_reg_loss: 1520.2905; val_edge_recon_loss: 84388.9688; val_gene_expr_recon_loss: 110166.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196075.3594; val_optim_loss: 196075.3594
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8995; val_auprc_score: 0.9778; val_best_acc_score: 0.9090; val_best_f1_score: 0.9487; train_kl_reg_loss: 1664.1077; train_edge_recon_loss: 86698.9089; train_gene_expr_recon_loss: 107605.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195968.8490; train_optim_loss: 195968.8490; val_kl_reg_loss: 1913.7697; val_edge_recon_loss: 83073.5078; val_gene_expr_recon_loss: 110050.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195037.7500; val_optim_loss: 195037.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8811; val_auprc_score: 0.9693; val_best_acc_score: 0.9089; val_best_f1_score: 0.9483; train_kl_reg_loss: 2036.6465; train_edge_recon_loss: 83167.4661; train_gene_expr_recon_loss: 106825.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192029.8698; train_optim_loss: 192029.8698; val_kl_reg_loss: 2235.4370; val_edge_recon_loss: 85032.5078; val_gene_expr_recon_loss: 109955.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197223.3125; val_optim_loss: 197223.3125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8969; val_auprc_score: 0.9649; val_best_acc_score: 0.9080; val_best_f1_score: 0.9474; train_kl_reg_loss: 2290.9465; train_edge_recon_loss: 83103.5469; train_gene_expr_recon_loss: 107313.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192708.4062; train_optim_loss: 192708.4062; val_kl_reg_loss: 2351.3970; val_edge_recon_loss: 84771.9688; val_gene_expr_recon_loss: 109671.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196794.7812; val_optim_loss: 196794.7812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8839; val_auprc_score: 0.9740; val_best_acc_score: 0.9063; val_best_f1_score: 0.9473; train_kl_reg_loss: 2386.0928; train_edge_recon_loss: 78532.6224; train_gene_expr_recon_loss: 107733.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188652.0885; train_optim_loss: 188652.0885; val_kl_reg_loss: 2390.2280; val_edge_recon_loss: 81593.4453; val_gene_expr_recon_loss: 109417.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193401.0625; val_optim_loss: 193401.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9037; val_auprc_score: 0.9766; val_best_acc_score: 0.9210; val_best_f1_score: 0.9553; train_kl_reg_loss: 2387.1973; train_edge_recon_loss: 85143.4661; train_gene_expr_recon_loss: 107305.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194836.2604; train_optim_loss: 194836.2604; val_kl_reg_loss: 2339.0405; val_edge_recon_loss: 80270.3281; val_gene_expr_recon_loss: 109233.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191843.3125; val_optim_loss: 191843.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8687; val_auprc_score: 0.9613; val_best_acc_score: 0.9107; val_best_f1_score: 0.9485; train_kl_reg_loss: 2325.7080; train_edge_recon_loss: 80910.9115; train_gene_expr_recon_loss: 106721.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189958.4271; train_optim_loss: 189958.4271; val_kl_reg_loss: 2229.6162; val_edge_recon_loss: 88448.3047; val_gene_expr_recon_loss: 109012.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199690.2812; val_optim_loss: 199690.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9261; val_auprc_score: 0.9762; val_best_acc_score: 0.9331; val_best_f1_score: 0.9621; train_kl_reg_loss: 2187.1183; train_edge_recon_loss: 77850.1536; train_gene_expr_recon_loss: 106141.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186178.3594; train_optim_loss: 186178.3594; val_kl_reg_loss: 2104.7520; val_edge_recon_loss: 74003.5547; val_gene_expr_recon_loss: 108839.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184947.9531; val_optim_loss: 184947.9531
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9097; val_auprc_score: 0.9757; val_best_acc_score: 0.9266; val_best_f1_score: 0.9585; train_kl_reg_loss: 2071.8526; train_edge_recon_loss: 77066.6406; train_gene_expr_recon_loss: 105954.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185092.6875; train_optim_loss: 185092.6875; val_kl_reg_loss: 1979.3066; val_edge_recon_loss: 80841.0391; val_gene_expr_recon_loss: 108706.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191527.0312; val_optim_loss: 191527.0312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9160; val_auprc_score: 0.9761; val_best_acc_score: 0.9288; val_best_f1_score: 0.9594; train_kl_reg_loss: 1973.3980; train_edge_recon_loss: 79151.3255; train_gene_expr_recon_loss: 106099.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187223.9219; train_optim_loss: 187223.9219; val_kl_reg_loss: 1923.1472; val_edge_recon_loss: 75681.4453; val_gene_expr_recon_loss: 108623.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186228.2812; val_optim_loss: 186228.2812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9022; val_auprc_score: 0.9718; val_best_acc_score: 0.9267; val_best_f1_score: 0.9584; train_kl_reg_loss: 1924.2232; train_edge_recon_loss: 80660.5625; train_gene_expr_recon_loss: 105593.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188178.6406; train_optim_loss: 188178.6406; val_kl_reg_loss: 1892.7242; val_edge_recon_loss: 78504.7188; val_gene_expr_recon_loss: 108477.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188874.5312; val_optim_loss: 188874.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9002; val_auprc_score: 0.9724; val_best_acc_score: 0.9273; val_best_f1_score: 0.9583; train_kl_reg_loss: 1899.6356; train_edge_recon_loss: 80473.2943; train_gene_expr_recon_loss: 105719.8958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188092.8229; train_optim_loss: 188092.8229; val_kl_reg_loss: 1891.0948; val_edge_recon_loss: 81561.5938; val_gene_expr_recon_loss: 108461.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191914.0000; val_optim_loss: 191914.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9026; val_auprc_score: 0.9687; val_best_acc_score: 0.9268; val_best_f1_score: 0.9579; train_kl_reg_loss: 1901.7015; train_edge_recon_loss: 78593.4740; train_gene_expr_recon_loss: 106509.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187004.8438; train_optim_loss: 187004.8438; val_kl_reg_loss: 1888.7632; val_edge_recon_loss: 83640.3672; val_gene_expr_recon_loss: 108444.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193973.8125; val_optim_loss: 193973.8125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9208; val_auprc_score: 0.9798; val_best_acc_score: 0.9327; val_best_f1_score: 0.9615; train_kl_reg_loss: 1899.1208; train_edge_recon_loss: 80067.2526; train_gene_expr_recon_loss: 105826.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187793.3542; train_optim_loss: 187793.3542; val_kl_reg_loss: 1888.5933; val_edge_recon_loss: 82034.6484; val_gene_expr_recon_loss: 108431.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192354.3281; val_optim_loss: 192354.3281

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 14 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9253
Val AUPRC score: 0.9840
Val best accuracy score: 0.9255
Val best F1 score: 0.9574
Val gene expr MSE score: 1.3745
Duration of model training in run 4: 0 hours, 0 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9325; val_auprc_score: 0.9797; val_best_acc_score: 0.9175; val_best_f1_score: 0.9536; train_kl_reg_loss: 165.3801; train_edge_recon_loss: 103663.5234; train_gene_expr_recon_loss: 131793.6337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235622.5365; train_optim_loss: 235622.5365; val_kl_reg_loss: 269.3110; val_edge_recon_loss: 114684.3750; val_gene_expr_recon_loss: 115793.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230747.5312; val_optim_loss: 230747.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9278; val_auprc_score: 0.9818; val_best_acc_score: 0.9213; val_best_f1_score: 0.9545; train_kl_reg_loss: 220.5788; train_edge_recon_loss: 100858.0694; train_gene_expr_recon_loss: 113872.1840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214950.8368; train_optim_loss: 214950.8368; val_kl_reg_loss: 153.3505; val_edge_recon_loss: 114907.5391; val_gene_expr_recon_loss: 112475.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227536.7812; val_optim_loss: 227536.7812
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9097; val_auprc_score: 0.9816; val_best_acc_score: 0.9100; val_best_f1_score: 0.9491; train_kl_reg_loss: 150.0985; train_edge_recon_loss: 101463.9097; train_gene_expr_recon_loss: 111879.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213493.1875; train_optim_loss: 213493.1875; val_kl_reg_loss: 158.4946; val_edge_recon_loss: 100274.0938; val_gene_expr_recon_loss: 111559.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211991.8750; val_optim_loss: 211991.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8410; val_auprc_score: 0.9543; val_best_acc_score: 0.8986; val_best_f1_score: 0.9432; train_kl_reg_loss: 200.0569; train_edge_recon_loss: 104048.2717; train_gene_expr_recon_loss: 110866.8411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215115.1684; train_optim_loss: 215115.1684; val_kl_reg_loss: 268.9727; val_edge_recon_loss: 103376.2109; val_gene_expr_recon_loss: 110717.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214363.0938; val_optim_loss: 214363.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8728; val_auprc_score: 0.9705; val_best_acc_score: 0.9013; val_best_f1_score: 0.9446; train_kl_reg_loss: 387.8880; train_edge_recon_loss: 95881.2378; train_gene_expr_recon_loss: 110017.8446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206286.9688; train_optim_loss: 206286.9688; val_kl_reg_loss: 564.7827; val_edge_recon_loss: 94405.5781; val_gene_expr_recon_loss: 110024.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204994.9375; val_optim_loss: 204994.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8612; val_auprc_score: 0.9669; val_best_acc_score: 0.8993; val_best_f1_score: 0.9441; train_kl_reg_loss: 758.4579; train_edge_recon_loss: 92878.3967; train_gene_expr_recon_loss: 109430.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203066.8785; train_optim_loss: 203066.8785; val_kl_reg_loss: 932.9988; val_edge_recon_loss: 89874.8984; val_gene_expr_recon_loss: 109470.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200278.0781; val_optim_loss: 200278.0781
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8835; val_auprc_score: 0.9715; val_best_acc_score: 0.9127; val_best_f1_score: 0.9504; train_kl_reg_loss: 1099.2978; train_edge_recon_loss: 87037.2309; train_gene_expr_recon_loss: 108996.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197132.8368; train_optim_loss: 197132.8368; val_kl_reg_loss: 1248.2610; val_edge_recon_loss: 84793.0156; val_gene_expr_recon_loss: 109229.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195270.8906; val_optim_loss: 195270.8906
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8890; val_auprc_score: 0.9688; val_best_acc_score: 0.9173; val_best_f1_score: 0.9526; train_kl_reg_loss: 1507.4438; train_edge_recon_loss: 83057.5260; train_gene_expr_recon_loss: 108931.4523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193496.4253; train_optim_loss: 193496.4253; val_kl_reg_loss: 1779.7661; val_edge_recon_loss: 81609.3047; val_gene_expr_recon_loss: 108757.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192146.7188; val_optim_loss: 192146.7188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8918; val_auprc_score: 0.9712; val_best_acc_score: 0.9262; val_best_f1_score: 0.9582; train_kl_reg_loss: 1932.7542; train_edge_recon_loss: 81551.8108; train_gene_expr_recon_loss: 108443.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191928.4792; train_optim_loss: 191928.4792; val_kl_reg_loss: 1920.0774; val_edge_recon_loss: 78480.1094; val_gene_expr_recon_loss: 108358.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188758.8281; val_optim_loss: 188758.8281
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9173; val_auprc_score: 0.9788; val_best_acc_score: 0.9273; val_best_f1_score: 0.9580; train_kl_reg_loss: 1973.5559; train_edge_recon_loss: 76201.6016; train_gene_expr_recon_loss: 108141.9679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186317.1267; train_optim_loss: 186317.1267; val_kl_reg_loss: 1878.7124; val_edge_recon_loss: 83444.9766; val_gene_expr_recon_loss: 107994.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193318.5938; val_optim_loss: 193318.5938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9049; val_auprc_score: 0.9686; val_best_acc_score: 0.9345; val_best_f1_score: 0.9628; train_kl_reg_loss: 1912.0639; train_edge_recon_loss: 82132.8455; train_gene_expr_recon_loss: 107796.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191841.8438; train_optim_loss: 191841.8438; val_kl_reg_loss: 1813.5754; val_edge_recon_loss: 76159.8281; val_gene_expr_recon_loss: 107751.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185724.5938; val_optim_loss: 185724.5938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9107; val_auprc_score: 0.9696; val_best_acc_score: 0.9351; val_best_f1_score: 0.9630; train_kl_reg_loss: 1832.2561; train_edge_recon_loss: 82751.0868; train_gene_expr_recon_loss: 107002.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191585.5694; train_optim_loss: 191585.5694; val_kl_reg_loss: 1716.1411; val_edge_recon_loss: 75659.1953; val_gene_expr_recon_loss: 107604.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184980.1875; val_optim_loss: 184980.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9137; val_auprc_score: 0.9753; val_best_acc_score: 0.9369; val_best_f1_score: 0.9637; train_kl_reg_loss: 1784.9946; train_edge_recon_loss: 79893.2352; train_gene_expr_recon_loss: 106992.7960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188671.0295; train_optim_loss: 188671.0295; val_kl_reg_loss: 1791.1396; val_edge_recon_loss: 79969.0234; val_gene_expr_recon_loss: 107240.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189000.4844; val_optim_loss: 189000.4844
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9029; val_auprc_score: 0.9707; val_best_acc_score: 0.9340; val_best_f1_score: 0.9619; train_kl_reg_loss: 1918.7648; train_edge_recon_loss: 79063.8003; train_gene_expr_recon_loss: 106990.7804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187973.3455; train_optim_loss: 187973.3455; val_kl_reg_loss: 1860.2561; val_edge_recon_loss: 82832.5703; val_gene_expr_recon_loss: 106926.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191619.0312; val_optim_loss: 191619.0312
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9242; val_auprc_score: 0.9775; val_best_acc_score: 0.9385; val_best_f1_score: 0.9647; train_kl_reg_loss: 1865.1974; train_edge_recon_loss: 79243.5955; train_gene_expr_recon_loss: 106422.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187531.2535; train_optim_loss: 187531.2535; val_kl_reg_loss: 1729.2236; val_edge_recon_loss: 80135.8125; val_gene_expr_recon_loss: 106731.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188596.0625; val_optim_loss: 188596.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9141; val_auprc_score: 0.9756; val_best_acc_score: 0.9366; val_best_f1_score: 0.9636; train_kl_reg_loss: 1795.5380; train_edge_recon_loss: 83127.8637; train_gene_expr_recon_loss: 106049.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190972.9983; train_optim_loss: 190972.9983; val_kl_reg_loss: 1731.9471; val_edge_recon_loss: 81811.5469; val_gene_expr_recon_loss: 106658.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190202.0625; val_optim_loss: 190202.0625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9234; val_auprc_score: 0.9800; val_best_acc_score: 0.9391; val_best_f1_score: 0.9652; train_kl_reg_loss: 1798.9425; train_edge_recon_loss: 85275.3142; train_gene_expr_recon_loss: 106315.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193389.6250; train_optim_loss: 193389.6250; val_kl_reg_loss: 1729.9136; val_edge_recon_loss: 74655.5547; val_gene_expr_recon_loss: 106618.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183004.4062; val_optim_loss: 183004.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9182; val_auprc_score: 0.9760; val_best_acc_score: 0.9382; val_best_f1_score: 0.9648; train_kl_reg_loss: 1796.5411; train_edge_recon_loss: 82569.3628; train_gene_expr_recon_loss: 106405.0026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190770.9080; train_optim_loss: 190770.9080; val_kl_reg_loss: 1731.0459; val_edge_recon_loss: 77953.6562; val_gene_expr_recon_loss: 106597.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186281.8125; val_optim_loss: 186281.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9281; val_auprc_score: 0.9795; val_best_acc_score: 0.9421; val_best_f1_score: 0.9668; train_kl_reg_loss: 1799.4157; train_edge_recon_loss: 76820.9800; train_gene_expr_recon_loss: 106240.7370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184861.1354; train_optim_loss: 184861.1354; val_kl_reg_loss: 1744.1663; val_edge_recon_loss: 77134.7734; val_gene_expr_recon_loss: 106572.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185451.1250; val_optim_loss: 185451.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9116; val_auprc_score: 0.9745; val_best_acc_score: 0.9395; val_best_f1_score: 0.9649; train_kl_reg_loss: 1821.2860; train_edge_recon_loss: 73774.1419; train_gene_expr_recon_loss: 105843.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181438.7500; train_optim_loss: 181438.7500; val_kl_reg_loss: 1756.2117; val_edge_recon_loss: 80088.3438; val_gene_expr_recon_loss: 106544.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188389.0469; val_optim_loss: 188389.0469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9238; val_auprc_score: 0.9755; val_best_acc_score: 0.9353; val_best_f1_score: 0.9629; train_kl_reg_loss: 1821.5133; train_edge_recon_loss: 78202.9444; train_gene_expr_recon_loss: 105916.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185941.4410; train_optim_loss: 185941.4410; val_kl_reg_loss: 1756.8145; val_edge_recon_loss: 81654.1172; val_gene_expr_recon_loss: 106541.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189952.9062; val_optim_loss: 189952.9062
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9435; val_auprc_score: 0.9836; val_best_acc_score: 0.9419; val_best_f1_score: 0.9664; train_kl_reg_loss: 1825.3465; train_edge_recon_loss: 79374.3099; train_gene_expr_recon_loss: 106414.3602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187614.0156; train_optim_loss: 187614.0156; val_kl_reg_loss: 1764.1801; val_edge_recon_loss: 79187.5625; val_gene_expr_recon_loss: 106540.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187491.7656; val_optim_loss: 187491.7656
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9246; val_auprc_score: 0.9822; val_best_acc_score: 0.9419; val_best_f1_score: 0.9668; train_kl_reg_loss: 1827.0835; train_edge_recon_loss: 76337.9835; train_gene_expr_recon_loss: 106431.4740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184596.5399; train_optim_loss: 184596.5399; val_kl_reg_loss: 1765.1945; val_edge_recon_loss: 76894.2422; val_gene_expr_recon_loss: 106536.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185196.0938; val_optim_loss: 185196.0938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 17 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9232
Val AUPRC score: 0.9803
Val best accuracy score: 0.9318
Val best F1 score: 0.9609
Val gene expr MSE score: 1.2591
Duration of model training in run 5: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 16450
Number of validation edges: 1827
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9249; val_auprc_score: 0.9794; val_best_acc_score: 0.9205; val_best_f1_score: 0.9556; train_kl_reg_loss: 161.1922; train_edge_recon_loss: 107027.3993; train_gene_expr_recon_loss: 130979.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238168.1076; train_optim_loss: 238168.1076; val_kl_reg_loss: 241.5388; val_edge_recon_loss: 107939.4062; val_gene_expr_recon_loss: 114338.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222519.0625; val_optim_loss: 222519.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9012; val_auprc_score: 0.9750; val_best_acc_score: 0.9189; val_best_f1_score: 0.9539; train_kl_reg_loss: 183.7767; train_edge_recon_loss: 95293.3672; train_gene_expr_recon_loss: 112988.4470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208465.5903; train_optim_loss: 208465.5903; val_kl_reg_loss: 128.3868; val_edge_recon_loss: 110166.8828; val_gene_expr_recon_loss: 111149.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221444.9688; val_optim_loss: 221444.9688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8852; val_auprc_score: 0.9731; val_best_acc_score: 0.9099; val_best_f1_score: 0.9490; train_kl_reg_loss: 140.3803; train_edge_recon_loss: 104080.1493; train_gene_expr_recon_loss: 111903.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216123.7934; train_optim_loss: 216123.7934; val_kl_reg_loss: 160.7014; val_edge_recon_loss: 106514.0781; val_gene_expr_recon_loss: 110249.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216924.1875; val_optim_loss: 216924.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8321; val_auprc_score: 0.9554; val_best_acc_score: 0.8924; val_best_f1_score: 0.9398; train_kl_reg_loss: 207.2714; train_edge_recon_loss: 100157.0938; train_gene_expr_recon_loss: 110749.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211113.7604; train_optim_loss: 211113.7604; val_kl_reg_loss: 281.7500; val_edge_recon_loss: 100929.6719; val_gene_expr_recon_loss: 109423.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210634.9219; val_optim_loss: 210634.9219
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8643; val_auprc_score: 0.9700; val_best_acc_score: 0.9001; val_best_f1_score: 0.9438; train_kl_reg_loss: 395.6971; train_edge_recon_loss: 95909.9071; train_gene_expr_recon_loss: 110150.4826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206456.0851; train_optim_loss: 206456.0851; val_kl_reg_loss: 548.7318; val_edge_recon_loss: 88869.7734; val_gene_expr_recon_loss: 108720.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198139.2812; val_optim_loss: 198139.2812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8613; val_auprc_score: 0.9667; val_best_acc_score: 0.8956; val_best_f1_score: 0.9402; train_kl_reg_loss: 805.6005; train_edge_recon_loss: 93816.7491; train_gene_expr_recon_loss: 108793.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203416.1233; train_optim_loss: 203416.1233; val_kl_reg_loss: 1120.3451; val_edge_recon_loss: 88742.9141; val_gene_expr_recon_loss: 108032.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197895.4219; val_optim_loss: 197895.4219
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8798; val_auprc_score: 0.9703; val_best_acc_score: 0.9030; val_best_f1_score: 0.9452; train_kl_reg_loss: 1448.0851; train_edge_recon_loss: 84824.3568; train_gene_expr_recon_loss: 108398.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194671.4080; train_optim_loss: 194671.4080; val_kl_reg_loss: 1788.1160; val_edge_recon_loss: 85430.5391; val_gene_expr_recon_loss: 107746.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194965.2812; val_optim_loss: 194965.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8854; val_auprc_score: 0.9742; val_best_acc_score: 0.9073; val_best_f1_score: 0.9479; train_kl_reg_loss: 1964.5615; train_edge_recon_loss: 83099.0130; train_gene_expr_recon_loss: 107749.1580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192812.7326; train_optim_loss: 192812.7326; val_kl_reg_loss: 1974.9821; val_edge_recon_loss: 86356.1250; val_gene_expr_recon_loss: 107250.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195581.6875; val_optim_loss: 195581.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8744; val_auprc_score: 0.9677; val_best_acc_score: 0.9121; val_best_f1_score: 0.9505; train_kl_reg_loss: 1978.7348; train_edge_recon_loss: 84218.2691; train_gene_expr_recon_loss: 107445.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193642.6736; train_optim_loss: 193642.6736; val_kl_reg_loss: 1872.4885; val_edge_recon_loss: 85956.0469; val_gene_expr_recon_loss: 106884.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194713.1875; val_optim_loss: 194713.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9204; val_auprc_score: 0.9816; val_best_acc_score: 0.9342; val_best_f1_score: 0.9626; train_kl_reg_loss: 1886.4873; train_edge_recon_loss: 79919.1267; train_gene_expr_recon_loss: 106898.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188704.3125; train_optim_loss: 188704.3125; val_kl_reg_loss: 1840.3387; val_edge_recon_loss: 74694.5000; val_gene_expr_recon_loss: 106547.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183082.3281; val_optim_loss: 183082.3281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9064; val_auprc_score: 0.9729; val_best_acc_score: 0.9316; val_best_f1_score: 0.9611; train_kl_reg_loss: 1808.2589; train_edge_recon_loss: 83592.9149; train_gene_expr_recon_loss: 106542.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191943.9531; train_optim_loss: 191943.9531; val_kl_reg_loss: 1792.1204; val_edge_recon_loss: 79151.8203; val_gene_expr_recon_loss: 106241.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187185.7812; val_optim_loss: 187185.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9126; val_auprc_score: 0.9771; val_best_acc_score: 0.9297; val_best_f1_score: 0.9598; train_kl_reg_loss: 1925.0373; train_edge_recon_loss: 82637.1866; train_gene_expr_recon_loss: 106414.1033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190976.3264; train_optim_loss: 190976.3264; val_kl_reg_loss: 2001.0857; val_edge_recon_loss: 81729.7734; val_gene_expr_recon_loss: 105971.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189701.9062; val_optim_loss: 189701.9062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8985; val_auprc_score: 0.9680; val_best_acc_score: 0.9320; val_best_f1_score: 0.9609; train_kl_reg_loss: 2022.6585; train_edge_recon_loss: 77290.9514; train_gene_expr_recon_loss: 106322.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185636.0920; train_optim_loss: 185636.0920; val_kl_reg_loss: 1987.0356; val_edge_recon_loss: 82922.2109; val_gene_expr_recon_loss: 105830.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190739.8594; val_optim_loss: 190739.8594

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9200; val_auprc_score: 0.9819; val_best_acc_score: 0.9423; val_best_f1_score: 0.9672; train_kl_reg_loss: 1994.3263; train_edge_recon_loss: 81127.9332; train_gene_expr_recon_loss: 106106.8872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189229.1493; train_optim_loss: 189229.1493; val_kl_reg_loss: 1958.9500; val_edge_recon_loss: 73532.0000; val_gene_expr_recon_loss: 105711.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181202.3750; val_optim_loss: 181202.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9210; val_auprc_score: 0.9786; val_best_acc_score: 0.9401; val_best_f1_score: 0.9654; train_kl_reg_loss: 1969.6931; train_edge_recon_loss: 83270.6250; train_gene_expr_recon_loss: 105808.5946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191048.9115; train_optim_loss: 191048.9115; val_kl_reg_loss: 1944.8516; val_edge_recon_loss: 81474.5703; val_gene_expr_recon_loss: 105670.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189089.6875; val_optim_loss: 189089.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9005; val_auprc_score: 0.9679; val_best_acc_score: 0.9374; val_best_f1_score: 0.9642; train_kl_reg_loss: 1954.3606; train_edge_recon_loss: 85845.9601; train_gene_expr_recon_loss: 106033.7934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193834.1128; train_optim_loss: 193834.1128; val_kl_reg_loss: 1930.2898; val_edge_recon_loss: 80741.5859; val_gene_expr_recon_loss: 105639.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188310.8750; val_optim_loss: 188310.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9312; val_auprc_score: 0.9804; val_best_acc_score: 0.9404; val_best_f1_score: 0.9658; train_kl_reg_loss: 1943.0589; train_edge_recon_loss: 79687.0660; train_gene_expr_recon_loss: 105685.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187315.6649; train_optim_loss: 187315.6649; val_kl_reg_loss: 1925.3868; val_edge_recon_loss: 80675.6406; val_gene_expr_recon_loss: 105602.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188203.0781; val_optim_loss: 188203.0781

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8901; val_auprc_score: 0.9659; val_best_acc_score: 0.9270; val_best_f1_score: 0.9582; train_kl_reg_loss: 1938.2993; train_edge_recon_loss: 79325.7891; train_gene_expr_recon_loss: 106369.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187633.8958; train_optim_loss: 187633.8958; val_kl_reg_loss: 1918.8157; val_edge_recon_loss: 85336.4297; val_gene_expr_recon_loss: 105598.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192853.9375; val_optim_loss: 192853.9375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8991; val_auprc_score: 0.9664; val_best_acc_score: 0.9305; val_best_f1_score: 0.9598; train_kl_reg_loss: 1931.5405; train_edge_recon_loss: 80408.0851; train_gene_expr_recon_loss: 105816.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188156.6094; train_optim_loss: 188156.6094; val_kl_reg_loss: 1913.7964; val_edge_recon_loss: 87594.2578; val_gene_expr_recon_loss: 105595.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195103.4375; val_optim_loss: 195103.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9340; val_auprc_score: 0.9846; val_best_acc_score: 0.9465; val_best_f1_score: 0.9694; train_kl_reg_loss: 1931.4874; train_edge_recon_loss: 76378.6458; train_gene_expr_recon_loss: 106342.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184652.3472; train_optim_loss: 184652.3472; val_kl_reg_loss: 1919.9449; val_edge_recon_loss: 75346.6406; val_gene_expr_recon_loss: 105593.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182859.9688; val_optim_loss: 182859.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 15 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.8989
Val AUPRC score: 0.9706
Val best accuracy score: 0.9208
Val best F1 score: 0.9546
Val gene expr MSE score: 1.3309
Duration of model training in run 6: 0 hours, 0 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9139; val_auprc_score: 0.9773; val_best_acc_score: 0.9153; val_best_f1_score: 0.9514; train_kl_reg_loss: 233.0170; train_edge_recon_loss: 102083.3626; train_gene_expr_recon_loss: 122031.1790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224347.5597; train_optim_loss: 224347.5597; val_kl_reg_loss: 125.6164; val_edge_recon_loss: 114928.6458; val_gene_expr_recon_loss: 111816.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226870.5677; val_optim_loss: 226870.5677
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8668; val_auprc_score: 0.9704; val_best_acc_score: 0.8947; val_best_f1_score: 0.9411; train_kl_reg_loss: 153.6635; train_edge_recon_loss: 102589.5966; train_gene_expr_recon_loss: 111561.4446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214304.7038; train_optim_loss: 214304.7038; val_kl_reg_loss: 277.2785; val_edge_recon_loss: 99678.5625; val_gene_expr_recon_loss: 109357.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209313.4115; val_optim_loss: 209313.4115
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8802; val_auprc_score: 0.9687; val_best_acc_score: 0.9112; val_best_f1_score: 0.9496; train_kl_reg_loss: 709.3292; train_edge_recon_loss: 92164.2433; train_gene_expr_recon_loss: 109965.8338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202839.4062; train_optim_loss: 202839.4062; val_kl_reg_loss: 1450.6851; val_edge_recon_loss: 85894.4167; val_gene_expr_recon_loss: 106875.5495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194220.6510; val_optim_loss: 194220.6510
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8875; val_auprc_score: 0.9714; val_best_acc_score: 0.9123; val_best_f1_score: 0.9507; train_kl_reg_loss: 1828.2947; train_edge_recon_loss: 83630.5064; train_gene_expr_recon_loss: 108869.6349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194328.4347; train_optim_loss: 194328.4347; val_kl_reg_loss: 1894.9269; val_edge_recon_loss: 83953.5208; val_gene_expr_recon_loss: 106016.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191864.4583; val_optim_loss: 191864.4583
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9044; val_auprc_score: 0.9690; val_best_acc_score: 0.9285; val_best_f1_score: 0.9587; train_kl_reg_loss: 1731.4905; train_edge_recon_loss: 78742.3452; train_gene_expr_recon_loss: 108021.8327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188495.6683; train_optim_loss: 188495.6683; val_kl_reg_loss: 1801.9193; val_edge_recon_loss: 86379.4922; val_gene_expr_recon_loss: 108246.7214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196428.1302; val_optim_loss: 196428.1302
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9188; val_auprc_score: 0.9762; val_best_acc_score: 0.9416; val_best_f1_score: 0.9668; train_kl_reg_loss: 1889.4914; train_edge_recon_loss: 80122.6495; train_gene_expr_recon_loss: 107497.8658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189510.0071; train_optim_loss: 189510.0071; val_kl_reg_loss: 1889.8577; val_edge_recon_loss: 77806.1953; val_gene_expr_recon_loss: 107034.2943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186730.3490; val_optim_loss: 186730.3490
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9277; val_auprc_score: 0.9776; val_best_acc_score: 0.9397; val_best_f1_score: 0.9653; train_kl_reg_loss: 1882.5764; train_edge_recon_loss: 79522.1655; train_gene_expr_recon_loss: 106793.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188198.4886; train_optim_loss: 188198.4886; val_kl_reg_loss: 1845.6369; val_edge_recon_loss: 83608.3099; val_gene_expr_recon_loss: 106128.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191582.5469; val_optim_loss: 191582.5469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9207; val_auprc_score: 0.9810; val_best_acc_score: 0.9406; val_best_f1_score: 0.9662; train_kl_reg_loss: 1869.0906; train_edge_recon_loss: 79349.7507; train_gene_expr_recon_loss: 106782.8210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188001.6619; train_optim_loss: 188001.6619; val_kl_reg_loss: 1858.1781; val_edge_recon_loss: 81029.5990; val_gene_expr_recon_loss: 103927.2448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186815.0208; val_optim_loss: 186815.0208
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9384; val_auprc_score: 0.9837; val_best_acc_score: 0.9477; val_best_f1_score: 0.9701; train_kl_reg_loss: 1845.2188; train_edge_recon_loss: 77963.4716; train_gene_expr_recon_loss: 105927.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185736.5831; train_optim_loss: 185736.5831; val_kl_reg_loss: 1887.5865; val_edge_recon_loss: 77629.8854; val_gene_expr_recon_loss: 105451.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184969.2344; val_optim_loss: 184969.2344
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9238; val_auprc_score: 0.9752; val_best_acc_score: 0.9449; val_best_f1_score: 0.9683; train_kl_reg_loss: 1882.5371; train_edge_recon_loss: 78152.9364; train_gene_expr_recon_loss: 105578.9794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185614.4538; train_optim_loss: 185614.4538; val_kl_reg_loss: 1852.2166; val_edge_recon_loss: 80440.4635; val_gene_expr_recon_loss: 103612.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185905.2448; val_optim_loss: 185905.2448
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9372; val_auprc_score: 0.9832; val_best_acc_score: 0.9474; val_best_f1_score: 0.9696; train_kl_reg_loss: 1825.3128; train_edge_recon_loss: 79434.8448; train_gene_expr_recon_loss: 105415.1261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186675.2834; train_optim_loss: 186675.2834; val_kl_reg_loss: 1843.3514; val_edge_recon_loss: 79909.0156; val_gene_expr_recon_loss: 103408.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185161.1406; val_optim_loss: 185161.1406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9391; val_auprc_score: 0.9839; val_best_acc_score: 0.9524; val_best_f1_score: 0.9727; train_kl_reg_loss: 1866.8109; train_edge_recon_loss: 79106.0408; train_gene_expr_recon_loss: 104938.9592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185911.8097; train_optim_loss: 185911.8097; val_kl_reg_loss: 1859.4479; val_edge_recon_loss: 80960.3021; val_gene_expr_recon_loss: 103668.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186488.5885; val_optim_loss: 186488.5885

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9285; val_auprc_score: 0.9785; val_best_acc_score: 0.9549; val_best_f1_score: 0.9745; train_kl_reg_loss: 1861.0150; train_edge_recon_loss: 79650.2773; train_gene_expr_recon_loss: 104492.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186003.8026; train_optim_loss: 186003.8026; val_kl_reg_loss: 1860.1976; val_edge_recon_loss: 74565.7865; val_gene_expr_recon_loss: 102079.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178505.1875; val_optim_loss: 178505.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9412; val_auprc_score: 0.9832; val_best_acc_score: 0.9561; val_best_f1_score: 0.9750; train_kl_reg_loss: 1857.0353; train_edge_recon_loss: 77421.0057; train_gene_expr_recon_loss: 104140.6009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183418.6435; train_optim_loss: 183418.6435; val_kl_reg_loss: 1845.6510; val_edge_recon_loss: 72151.0130; val_gene_expr_recon_loss: 101642.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175638.7344; val_optim_loss: 175638.7344
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9345; val_auprc_score: 0.9779; val_best_acc_score: 0.9498; val_best_f1_score: 0.9709; train_kl_reg_loss: 1847.8828; train_edge_recon_loss: 77835.2628; train_gene_expr_recon_loss: 104293.3015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183976.4474; train_optim_loss: 183976.4474; val_kl_reg_loss: 1851.3147; val_edge_recon_loss: 85391.3880; val_gene_expr_recon_loss: 103056.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190299.2552; val_optim_loss: 190299.2552
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9263; val_auprc_score: 0.9725; val_best_acc_score: 0.9578; val_best_f1_score: 0.9758; train_kl_reg_loss: 1835.1358; train_edge_recon_loss: 78494.7248; train_gene_expr_recon_loss: 104085.3338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184415.1953; train_optim_loss: 184415.1953; val_kl_reg_loss: 1848.2721; val_edge_recon_loss: 76750.2604; val_gene_expr_recon_loss: 104753.4245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183351.9583; val_optim_loss: 183351.9583
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9461; val_auprc_score: 0.9838; val_best_acc_score: 0.9584; val_best_f1_score: 0.9760; train_kl_reg_loss: 1837.2712; train_edge_recon_loss: 79291.0866; train_gene_expr_recon_loss: 104008.9233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185137.2812; train_optim_loss: 185137.2812; val_kl_reg_loss: 1837.6225; val_edge_recon_loss: 79735.0885; val_gene_expr_recon_loss: 105622.8620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187195.5729; val_optim_loss: 187195.5729

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9378; val_auprc_score: 0.9786; val_best_acc_score: 0.9535; val_best_f1_score: 0.9730; train_kl_reg_loss: 1838.4241; train_edge_recon_loss: 77623.1658; train_gene_expr_recon_loss: 104193.1204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183654.7095; train_optim_loss: 183654.7095; val_kl_reg_loss: 1856.5798; val_edge_recon_loss: 81252.5156; val_gene_expr_recon_loss: 102695.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185804.1667; val_optim_loss: 185804.1667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9409; val_auprc_score: 0.9836; val_best_acc_score: 0.9567; val_best_f1_score: 0.9752; train_kl_reg_loss: 1836.6630; train_edge_recon_loss: 77893.7200; train_gene_expr_recon_loss: 104277.2283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184007.6101; train_optim_loss: 184007.6101; val_kl_reg_loss: 1836.3916; val_edge_recon_loss: 76872.9635; val_gene_expr_recon_loss: 103391.7630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182101.1146; val_optim_loss: 182101.1146
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9234; val_auprc_score: 0.9779; val_best_acc_score: 0.9496; val_best_f1_score: 0.9710; train_kl_reg_loss: 1838.4709; train_edge_recon_loss: 79196.7063; train_gene_expr_recon_loss: 104253.7575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185288.9332; train_optim_loss: 185288.9332; val_kl_reg_loss: 1846.1480; val_edge_recon_loss: 79438.9661; val_gene_expr_recon_loss: 105560.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186845.7500; val_optim_loss: 186845.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 24 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9323
Val AUPRC score: 0.9794
Val best accuracy score: 0.9546
Val best F1 score: 0.9740
Val gene expr MSE score: 1.1738
Duration of model training in run 7: 0 hours, 0 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 21883
Number of validation edges: 2431
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8932; val_auprc_score: 0.9656; val_best_acc_score: 0.9124; val_best_f1_score: 0.9502; train_kl_reg_loss: 261.1011; train_edge_recon_loss: 103307.3043; train_gene_expr_recon_loss: 120747.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224315.8814; train_optim_loss: 224315.8814; val_kl_reg_loss: 144.5286; val_edge_recon_loss: 109541.2135; val_gene_expr_recon_loss: 111547.9661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221233.6979; val_optim_loss: 221233.6979
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8453; val_auprc_score: 0.9515; val_best_acc_score: 0.8928; val_best_f1_score: 0.9394; train_kl_reg_loss: 174.6965; train_edge_recon_loss: 100243.8612; train_gene_expr_recon_loss: 110559.1637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210977.7230; train_optim_loss: 210977.7230; val_kl_reg_loss: 288.7519; val_edge_recon_loss: 100882.4245; val_gene_expr_recon_loss: 109155.5260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210326.6979; val_optim_loss: 210326.6979
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8838; val_auprc_score: 0.9708; val_best_acc_score: 0.9088; val_best_f1_score: 0.9485; train_kl_reg_loss: 764.6485; train_edge_recon_loss: 94594.1367; train_gene_expr_recon_loss: 109186.8590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204545.6449; train_optim_loss: 204545.6449; val_kl_reg_loss: 1537.8162; val_edge_recon_loss: 82690.2396; val_gene_expr_recon_loss: 108360.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192588.3385; val_optim_loss: 192588.3385
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8961; val_auprc_score: 0.9714; val_best_acc_score: 0.9288; val_best_f1_score: 0.9595; train_kl_reg_loss: 1983.4138; train_edge_recon_loss: 83049.6740; train_gene_expr_recon_loss: 108281.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193315.0554; train_optim_loss: 193315.0554; val_kl_reg_loss: 2011.7469; val_edge_recon_loss: 76532.9062; val_gene_expr_recon_loss: 104073.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182618.6250; val_optim_loss: 182618.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9196; val_auprc_score: 0.9781; val_best_acc_score: 0.9352; val_best_f1_score: 0.9629; train_kl_reg_loss: 1928.0793; train_edge_recon_loss: 78832.6342; train_gene_expr_recon_loss: 107270.7077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188031.4212; train_optim_loss: 188031.4212; val_kl_reg_loss: 1919.8774; val_edge_recon_loss: 80800.6458; val_gene_expr_recon_loss: 104726.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187446.5677; val_optim_loss: 187446.5677
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9276; val_auprc_score: 0.9801; val_best_acc_score: 0.9418; val_best_f1_score: 0.9666; train_kl_reg_loss: 1889.3113; train_edge_recon_loss: 78459.8285; train_gene_expr_recon_loss: 106634.4680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186983.6065; train_optim_loss: 186983.6065; val_kl_reg_loss: 1819.2611; val_edge_recon_loss: 77658.3047; val_gene_expr_recon_loss: 106863.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186340.5729; val_optim_loss: 186340.5729
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9092; val_auprc_score: 0.9705; val_best_acc_score: 0.9371; val_best_f1_score: 0.9639; train_kl_reg_loss: 1869.9723; train_edge_recon_loss: 78888.0625; train_gene_expr_recon_loss: 106213.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186971.2131; train_optim_loss: 186971.2131; val_kl_reg_loss: 1853.4690; val_edge_recon_loss: 82382.0703; val_gene_expr_recon_loss: 105559.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189794.7292; val_optim_loss: 189794.7292

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9174; val_auprc_score: 0.9733; val_best_acc_score: 0.9357; val_best_f1_score: 0.9627; train_kl_reg_loss: 1866.0681; train_edge_recon_loss: 78704.7583; train_gene_expr_recon_loss: 105714.8224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186285.6506; train_optim_loss: 186285.6506; val_kl_reg_loss: 1870.7372; val_edge_recon_loss: 87291.0677; val_gene_expr_recon_loss: 104662.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193824.6667; val_optim_loss: 193824.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9333; val_auprc_score: 0.9816; val_best_acc_score: 0.9458; val_best_f1_score: 0.9690; train_kl_reg_loss: 1868.8350; train_edge_recon_loss: 78313.1282; train_gene_expr_recon_loss: 105431.9879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185613.9517; train_optim_loss: 185613.9517; val_kl_reg_loss: 1830.6170; val_edge_recon_loss: 77743.8229; val_gene_expr_recon_loss: 103209.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182783.8906; val_optim_loss: 182783.8906
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9146; val_auprc_score: 0.9730; val_best_acc_score: 0.9379; val_best_f1_score: 0.9645; train_kl_reg_loss: 1871.5396; train_edge_recon_loss: 80668.3018; train_gene_expr_recon_loss: 105346.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187886.5668; train_optim_loss: 187886.5668; val_kl_reg_loss: 1865.1853; val_edge_recon_loss: 77986.2760; val_gene_expr_recon_loss: 106142.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185994.1354; val_optim_loss: 185994.1354

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.8840
Val AUPRC score: 0.9664
Val best accuracy score: 0.9201
Val best F1 score: 0.9541
Val gene expr MSE score: 1.3353
Duration of model training in run 8: 0 hours, 0 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 27378
Number of validation edges: 3041
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8825; val_auprc_score: 0.9705; val_best_acc_score: 0.9006; val_best_f1_score: 0.9426; train_kl_reg_loss: 199.9423; train_edge_recon_loss: 100725.0501; train_gene_expr_recon_loss: 120361.6768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221286.6696; train_optim_loss: 221286.6696; val_kl_reg_loss: 149.7281; val_edge_recon_loss: 111765.5573; val_gene_expr_recon_loss: 112553.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224468.5208; val_optim_loss: 224468.5208
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8489; val_auprc_score: 0.9672; val_best_acc_score: 0.8974; val_best_f1_score: 0.9435; train_kl_reg_loss: 395.0749; train_edge_recon_loss: 98077.2159; train_gene_expr_recon_loss: 111057.9841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209530.2726; train_optim_loss: 209530.2726; val_kl_reg_loss: 854.2233; val_edge_recon_loss: 86026.5990; val_gene_expr_recon_loss: 110574.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197455.7396; val_optim_loss: 197455.7396
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8931; val_auprc_score: 0.9737; val_best_acc_score: 0.9127; val_best_f1_score: 0.9502; train_kl_reg_loss: 1565.8369; train_edge_recon_loss: 84786.6832; train_gene_expr_recon_loss: 109806.1548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196158.6748; train_optim_loss: 196158.6748; val_kl_reg_loss: 2041.8005; val_edge_recon_loss: 85914.0443; val_gene_expr_recon_loss: 109279.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197235.2708; val_optim_loss: 197235.2708
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9030; val_auprc_score: 0.9739; val_best_acc_score: 0.9274; val_best_f1_score: 0.9589; train_kl_reg_loss: 1945.1740; train_edge_recon_loss: 82090.8215; train_gene_expr_recon_loss: 108405.9725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192441.9676; train_optim_loss: 192441.9676; val_kl_reg_loss: 1795.4266; val_edge_recon_loss: 81710.2839; val_gene_expr_recon_loss: 108521.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192027.3385; val_optim_loss: 192027.3385
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9052; val_auprc_score: 0.9721; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 1849.5165; train_edge_recon_loss: 80861.5518; train_gene_expr_recon_loss: 107523.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190234.2321; train_optim_loss: 190234.2321; val_kl_reg_loss: 1813.9071; val_edge_recon_loss: 76469.7734; val_gene_expr_recon_loss: 108135.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186419.4427; val_optim_loss: 186419.4427
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9105; val_auprc_score: 0.9730; val_best_acc_score: 0.9365; val_best_f1_score: 0.9635; train_kl_reg_loss: 1821.5458; train_edge_recon_loss: 79987.0674; train_gene_expr_recon_loss: 106930.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188738.7014; train_optim_loss: 188738.7014; val_kl_reg_loss: 1843.2341; val_edge_recon_loss: 84323.4818; val_gene_expr_recon_loss: 107359.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193526.7188; val_optim_loss: 193526.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9266; val_auprc_score: 0.9769; val_best_acc_score: 0.9400; val_best_f1_score: 0.9652; train_kl_reg_loss: 1865.7050; train_edge_recon_loss: 79917.5911; train_gene_expr_recon_loss: 106570.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188353.2963; train_optim_loss: 188353.2963; val_kl_reg_loss: 1832.1486; val_edge_recon_loss: 84432.1745; val_gene_expr_recon_loss: 107382.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193646.7344; val_optim_loss: 193646.7344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9319; val_auprc_score: 0.9811; val_best_acc_score: 0.9413; val_best_f1_score: 0.9660; train_kl_reg_loss: 1833.9230; train_edge_recon_loss: 78091.0113; train_gene_expr_recon_loss: 106067.6227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185992.5567; train_optim_loss: 185992.5567; val_kl_reg_loss: 1803.6210; val_edge_recon_loss: 80179.2161; val_gene_expr_recon_loss: 106513.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188496.1146; val_optim_loss: 188496.1146

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9277; val_auprc_score: 0.9779; val_best_acc_score: 0.9405; val_best_f1_score: 0.9659; train_kl_reg_loss: 1840.2685; train_edge_recon_loss: 79129.0454; train_gene_expr_recon_loss: 105810.7595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186780.0723; train_optim_loss: 186780.0723; val_kl_reg_loss: 1809.2859; val_edge_recon_loss: 79282.3828; val_gene_expr_recon_loss: 106105.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187197.3646; val_optim_loss: 187197.3646
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9244; val_auprc_score: 0.9794; val_best_acc_score: 0.9440; val_best_f1_score: 0.9682; train_kl_reg_loss: 1841.7090; train_edge_recon_loss: 79429.8796; train_gene_expr_recon_loss: 105414.4601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186686.0469; train_optim_loss: 186686.0469; val_kl_reg_loss: 1811.0548; val_edge_recon_loss: 77417.0990; val_gene_expr_recon_loss: 105784.3724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185012.5260; val_optim_loss: 185012.5260
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9219; val_auprc_score: 0.9741; val_best_acc_score: 0.9463; val_best_f1_score: 0.9690; train_kl_reg_loss: 1834.1436; train_edge_recon_loss: 79683.9688; train_gene_expr_recon_loss: 105289.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186807.6667; train_optim_loss: 186807.6667; val_kl_reg_loss: 1808.5242; val_edge_recon_loss: 81440.5417; val_gene_expr_recon_loss: 106053.1120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189302.1771; val_optim_loss: 189302.1771
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9226; val_auprc_score: 0.9808; val_best_acc_score: 0.9447; val_best_f1_score: 0.9685; train_kl_reg_loss: 1844.3395; train_edge_recon_loss: 78680.6374; train_gene_expr_recon_loss: 105145.4647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185670.4416; train_optim_loss: 185670.4416; val_kl_reg_loss: 1811.5786; val_edge_recon_loss: 77189.2682; val_gene_expr_recon_loss: 105873.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184874.4792; val_optim_loss: 184874.4792
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9295; val_auprc_score: 0.9824; val_best_acc_score: 0.9485; val_best_f1_score: 0.9706; train_kl_reg_loss: 1843.5243; train_edge_recon_loss: 78586.0784; train_gene_expr_recon_loss: 105080.0038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185509.6065; train_optim_loss: 185509.6065; val_kl_reg_loss: 1815.2603; val_edge_recon_loss: 76729.3281; val_gene_expr_recon_loss: 106172.4896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184717.0781; val_optim_loss: 184717.0781
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9369; val_auprc_score: 0.9820; val_best_acc_score: 0.9470; val_best_f1_score: 0.9697; train_kl_reg_loss: 1842.1529; train_edge_recon_loss: 79568.8449; train_gene_expr_recon_loss: 105086.1351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186497.1343; train_optim_loss: 186497.1343; val_kl_reg_loss: 1813.2605; val_edge_recon_loss: 75653.7474; val_gene_expr_recon_loss: 105996.1146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183463.1146; val_optim_loss: 183463.1146
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9212; val_auprc_score: 0.9759; val_best_acc_score: 0.9423; val_best_f1_score: 0.9667; train_kl_reg_loss: 1841.4378; train_edge_recon_loss: 79225.4760; train_gene_expr_recon_loss: 105026.7153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186093.6302; train_optim_loss: 186093.6302; val_kl_reg_loss: 1791.1249; val_edge_recon_loss: 80077.9479; val_gene_expr_recon_loss: 105651.4479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187520.5156; val_optim_loss: 187520.5156
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9310; val_auprc_score: 0.9806; val_best_acc_score: 0.9454; val_best_f1_score: 0.9687; train_kl_reg_loss: 1825.2604; train_edge_recon_loss: 78641.3915; train_gene_expr_recon_loss: 105153.6887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185620.3414; train_optim_loss: 185620.3414; val_kl_reg_loss: 1795.6819; val_edge_recon_loss: 79818.0859; val_gene_expr_recon_loss: 105908.5365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187522.3021; val_optim_loss: 187522.3021
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9351; val_auprc_score: 0.9819; val_best_acc_score: 0.9410; val_best_f1_score: 0.9658; train_kl_reg_loss: 1830.5016; train_edge_recon_loss: 80457.5880; train_gene_expr_recon_loss: 104624.4253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186912.5150; train_optim_loss: 186912.5150; val_kl_reg_loss: 1798.7454; val_edge_recon_loss: 84201.9635; val_gene_expr_recon_loss: 105610.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191610.8802; val_optim_loss: 191610.8802

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9268; val_auprc_score: 0.9780; val_best_acc_score: 0.9443; val_best_f1_score: 0.9682; train_kl_reg_loss: 1830.8993; train_edge_recon_loss: 79399.1554; train_gene_expr_recon_loss: 104845.1259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186075.1817; train_optim_loss: 186075.1817; val_kl_reg_loss: 1803.7176; val_edge_recon_loss: 78264.6042; val_gene_expr_recon_loss: 105689.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185758.1615; val_optim_loss: 185758.1615
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9269; val_auprc_score: 0.9752; val_best_acc_score: 0.9439; val_best_f1_score: 0.9677; train_kl_reg_loss: 1834.9521; train_edge_recon_loss: 76970.6696; train_gene_expr_recon_loss: 104896.9482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183702.5689; train_optim_loss: 183702.5689; val_kl_reg_loss: 1803.9106; val_edge_recon_loss: 81025.6276; val_gene_expr_recon_loss: 105812.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188642.1146; val_optim_loss: 188642.1146
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9416; val_auprc_score: 0.9802; val_best_acc_score: 0.9465; val_best_f1_score: 0.9691; train_kl_reg_loss: 1832.3943; train_edge_recon_loss: 80195.9028; train_gene_expr_recon_loss: 104908.4913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186936.7870; train_optim_loss: 186936.7870; val_kl_reg_loss: 1799.7005; val_edge_recon_loss: 80819.7083; val_gene_expr_recon_loss: 105543.6979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188163.1094; val_optim_loss: 188163.1094

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 29 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9364
Val AUPRC score: 0.9813
Val best accuracy score: 0.9441
Val best F1 score: 0.9677
Val gene expr MSE score: 1.2299
Duration of model training in run 9: 0 hours, 0 minutes and 31 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 2363
Number of validation nodes: 263
Number of training edges: 27378
Number of validation edges: 3041
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8935; val_auprc_score: 0.9745; val_best_acc_score: 0.9093; val_best_f1_score: 0.9485; train_kl_reg_loss: 192.2176; train_edge_recon_loss: 101165.0012; train_gene_expr_recon_loss: 119442.9253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220800.1453; train_optim_loss: 220800.1453; val_kl_reg_loss: 134.1047; val_edge_recon_loss: 108730.0625; val_gene_expr_recon_loss: 110971.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219836.0312; val_optim_loss: 219836.0312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8435; val_auprc_score: 0.9630; val_best_acc_score: 0.8859; val_best_f1_score: 0.9364; train_kl_reg_loss: 327.5312; train_edge_recon_loss: 97358.5619; train_gene_expr_recon_loss: 110691.6551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208377.7494; train_optim_loss: 208377.7494; val_kl_reg_loss: 790.6919; val_edge_recon_loss: 92693.1406; val_gene_expr_recon_loss: 109286.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202769.8958; val_optim_loss: 202769.8958
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8900; val_auprc_score: 0.9719; val_best_acc_score: 0.9170; val_best_f1_score: 0.9530; train_kl_reg_loss: 1540.9718; train_edge_recon_loss: 88063.0460; train_gene_expr_recon_loss: 108873.5457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198477.5631; train_optim_loss: 198477.5631; val_kl_reg_loss: 2145.1488; val_edge_recon_loss: 80661.8984; val_gene_expr_recon_loss: 107952.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190759.0781; val_optim_loss: 190759.0781
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9095; val_auprc_score: 0.9755; val_best_acc_score: 0.9336; val_best_f1_score: 0.9621; train_kl_reg_loss: 1843.8834; train_edge_recon_loss: 81710.2428; train_gene_expr_recon_loss: 108000.6065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191554.7332; train_optim_loss: 191554.7332; val_kl_reg_loss: 1764.9830; val_edge_recon_loss: 78528.6927; val_gene_expr_recon_loss: 107255.9974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187549.6771; val_optim_loss: 187549.6771
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9065; val_auprc_score: 0.9703; val_best_acc_score: 0.9395; val_best_f1_score: 0.9652; train_kl_reg_loss: 1787.6842; train_edge_recon_loss: 81048.4453; train_gene_expr_recon_loss: 107379.3137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190215.4427; train_optim_loss: 190215.4427; val_kl_reg_loss: 1856.1886; val_edge_recon_loss: 82398.8516; val_gene_expr_recon_loss: 106209.2135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190464.2500; val_optim_loss: 190464.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9336; val_auprc_score: 0.9797; val_best_acc_score: 0.9495; val_best_f1_score: 0.9706; train_kl_reg_loss: 1844.9436; train_edge_recon_loss: 79786.2274; train_gene_expr_recon_loss: 106692.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188323.3426; train_optim_loss: 188323.3426; val_kl_reg_loss: 1841.0691; val_edge_recon_loss: 81739.1458; val_gene_expr_recon_loss: 105886.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189466.7708; val_optim_loss: 189466.7708
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9239; val_auprc_score: 0.9769; val_best_acc_score: 0.9458; val_best_f1_score: 0.9690; train_kl_reg_loss: 1801.9911; train_edge_recon_loss: 79028.6994; train_gene_expr_recon_loss: 105760.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186591.4404; train_optim_loss: 186591.4404; val_kl_reg_loss: 1793.9528; val_edge_recon_loss: 79467.0286; val_gene_expr_recon_loss: 105199.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186460.2812; val_optim_loss: 186460.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9229; val_auprc_score: 0.9751; val_best_acc_score: 0.9457; val_best_f1_score: 0.9688; train_kl_reg_loss: 1796.9791; train_edge_recon_loss: 78817.3678; train_gene_expr_recon_loss: 105567.1186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186181.4653; train_optim_loss: 186181.4653; val_kl_reg_loss: 1903.1353; val_edge_recon_loss: 80043.2266; val_gene_expr_recon_loss: 104972.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186919.3333; val_optim_loss: 186919.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9337; val_auprc_score: 0.9801; val_best_acc_score: 0.9493; val_best_f1_score: 0.9710; train_kl_reg_loss: 1820.8062; train_edge_recon_loss: 78831.9008; train_gene_expr_recon_loss: 105050.5394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185703.2442; train_optim_loss: 185703.2442; val_kl_reg_loss: 1834.3276; val_edge_recon_loss: 78921.9792; val_gene_expr_recon_loss: 104197.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184953.7240; val_optim_loss: 184953.7240
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9266; val_auprc_score: 0.9784; val_best_acc_score: 0.9504; val_best_f1_score: 0.9715; train_kl_reg_loss: 1802.0032; train_edge_recon_loss: 79635.9832; train_gene_expr_recon_loss: 104721.0373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186159.0249; train_optim_loss: 186159.0249; val_kl_reg_loss: 1799.7294; val_edge_recon_loss: 79287.2396; val_gene_expr_recon_loss: 104099.1302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185186.1042; val_optim_loss: 185186.1042
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9177; val_auprc_score: 0.9712; val_best_acc_score: 0.9456; val_best_f1_score: 0.9687; train_kl_reg_loss: 1837.6910; train_edge_recon_loss: 78878.0492; train_gene_expr_recon_loss: 104029.8741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184745.6140; train_optim_loss: 184745.6140; val_kl_reg_loss: 1843.2467; val_edge_recon_loss: 85095.6432; val_gene_expr_recon_loss: 103690.0755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190628.9635; val_optim_loss: 190628.9635
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9278; val_auprc_score: 0.9785; val_best_acc_score: 0.9469; val_best_f1_score: 0.9697; train_kl_reg_loss: 1853.6030; train_edge_recon_loss: 79684.5894; train_gene_expr_recon_loss: 104003.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185542.1562; train_optim_loss: 185542.1562; val_kl_reg_loss: 1831.8123; val_edge_recon_loss: 79703.8620; val_gene_expr_recon_loss: 103337.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184872.6875; val_optim_loss: 184872.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9177; val_auprc_score: 0.9734; val_best_acc_score: 0.9583; val_best_f1_score: 0.9763; train_kl_reg_loss: 1796.3366; train_edge_recon_loss: 77613.5917; train_gene_expr_recon_loss: 103819.6661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183229.5938; train_optim_loss: 183229.5938; val_kl_reg_loss: 1760.7674; val_edge_recon_loss: 73546.3333; val_gene_expr_recon_loss: 103236.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178544.0208; val_optim_loss: 178544.0208
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9386; val_auprc_score: 0.9817; val_best_acc_score: 0.9589; val_best_f1_score: 0.9763; train_kl_reg_loss: 1810.6372; train_edge_recon_loss: 77682.9300; train_gene_expr_recon_loss: 103535.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183029.2836; train_optim_loss: 183029.2836; val_kl_reg_loss: 1756.6794; val_edge_recon_loss: 78334.0495; val_gene_expr_recon_loss: 102741.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182832.4583; val_optim_loss: 182832.4583
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9569; val_auprc_score: 0.9903; val_best_acc_score: 0.9611; val_best_f1_score: 0.9777; train_kl_reg_loss: 1788.5781; train_edge_recon_loss: 78856.6427; train_gene_expr_recon_loss: 103090.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183735.9329; train_optim_loss: 183735.9329; val_kl_reg_loss: 1815.7435; val_edge_recon_loss: 74240.0495; val_gene_expr_recon_loss: 102505.0807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178560.8750; val_optim_loss: 178560.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9446; val_auprc_score: 0.9839; val_best_acc_score: 0.9568; val_best_f1_score: 0.9751; train_kl_reg_loss: 1787.6949; train_edge_recon_loss: 80380.7688; train_gene_expr_recon_loss: 102925.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185094.0949; train_optim_loss: 185094.0949; val_kl_reg_loss: 1780.3447; val_edge_recon_loss: 80476.5130; val_gene_expr_recon_loss: 102471.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184727.8958; val_optim_loss: 184727.8958

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9281; val_auprc_score: 0.9804; val_best_acc_score: 0.9516; val_best_f1_score: 0.9721; train_kl_reg_loss: 1790.7240; train_edge_recon_loss: 78122.2954; train_gene_expr_recon_loss: 102646.0949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182559.1128; train_optim_loss: 182559.1128; val_kl_reg_loss: 1801.4427; val_edge_recon_loss: 80604.4922; val_gene_expr_recon_loss: 102242.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184648.3594; val_optim_loss: 184648.3594
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9125; val_auprc_score: 0.9720; val_best_acc_score: 0.9535; val_best_f1_score: 0.9734; train_kl_reg_loss: 1811.1393; train_edge_recon_loss: 78834.5217; train_gene_expr_recon_loss: 102539.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183185.4664; train_optim_loss: 183185.4664; val_kl_reg_loss: 1812.4622; val_edge_recon_loss: 78095.7396; val_gene_expr_recon_loss: 102017.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181926.1875; val_optim_loss: 181926.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9307; val_auprc_score: 0.9793; val_best_acc_score: 0.9549; val_best_f1_score: 0.9743; train_kl_reg_loss: 1817.7330; train_edge_recon_loss: 78159.8822; train_gene_expr_recon_loss: 102443.5975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182421.2118; train_optim_loss: 182421.2118; val_kl_reg_loss: 1820.0614; val_edge_recon_loss: 76609.2031; val_gene_expr_recon_loss: 101910.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180339.5260; val_optim_loss: 180339.5260

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9257
Val AUPRC score: 0.9766
Val best accuracy score: 0.9501
Val best F1 score: 0.9710
Val gene expr MSE score: 1.1992
Duration of model training in run 10: 0 hours, 0 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_222107.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9107; val_auprc_score: 0.9816; val_best_acc_score: 0.9050; val_best_f1_score: 0.9456; train_kl_reg_loss: 59.1309; train_edge_recon_loss: 100515.4492; train_gene_expr_recon_loss: 148748.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 249323.3906; train_optim_loss: 249323.3906; val_kl_reg_loss: 82.7495; val_edge_recon_loss: 114900.2969; val_gene_expr_recon_loss: 138045.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253028.3594; val_optim_loss: 253028.3594
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8937; val_auprc_score: 0.9794; val_best_acc_score: 0.9021; val_best_f1_score: 0.9449; train_kl_reg_loss: 107.1043; train_edge_recon_loss: 103058.0117; train_gene_expr_recon_loss: 133914.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237079.7891; train_optim_loss: 237079.7891; val_kl_reg_loss: 182.8904; val_edge_recon_loss: 111927.6172; val_gene_expr_recon_loss: 126102.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238213.4531; val_optim_loss: 238213.4531
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9025; val_auprc_score: 0.9740; val_best_acc_score: 0.8846; val_best_f1_score: 0.9356; train_kl_reg_loss: 216.6943; train_edge_recon_loss: 100764.4922; train_gene_expr_recon_loss: 121865.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222846.7656; train_optim_loss: 222846.7656; val_kl_reg_loss: 275.6289; val_edge_recon_loss: 125123.9609; val_gene_expr_recon_loss: 118879.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244279.5781; val_optim_loss: 244279.5781
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8857; val_auprc_score: 0.9739; val_best_acc_score: 0.8931; val_best_f1_score: 0.9400; train_kl_reg_loss: 284.5105; train_edge_recon_loss: 98676.2852; train_gene_expr_recon_loss: 116228.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215188.8281; train_optim_loss: 215188.8281; val_kl_reg_loss: 267.3763; val_edge_recon_loss: 121368.0469; val_gene_expr_recon_loss: 114499.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236134.6094; val_optim_loss: 236134.6094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9091; val_auprc_score: 0.9820; val_best_acc_score: 0.8971; val_best_f1_score: 0.9408; train_kl_reg_loss: 265.6124; train_edge_recon_loss: 103437.8438; train_gene_expr_recon_loss: 113650.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217354.1562; train_optim_loss: 217354.1562; val_kl_reg_loss: 222.3414; val_edge_recon_loss: 114272.0000; val_gene_expr_recon_loss: 112033.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226528.1562; val_optim_loss: 226528.1562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9163; val_auprc_score: 0.9776; val_best_acc_score: 0.9016; val_best_f1_score: 0.9438; train_kl_reg_loss: 216.8099; train_edge_recon_loss: 100449.5234; train_gene_expr_recon_loss: 111014.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211680.5469; train_optim_loss: 211680.5469; val_kl_reg_loss: 180.0661; val_edge_recon_loss: 123039.3359; val_gene_expr_recon_loss: 110692.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233911.4688; val_optim_loss: 233911.4688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8731; val_auprc_score: 0.9671; val_best_acc_score: 0.8993; val_best_f1_score: 0.9434; train_kl_reg_loss: 179.5540; train_edge_recon_loss: 98444.8203; train_gene_expr_recon_loss: 109926.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208551.2344; train_optim_loss: 208551.2344; val_kl_reg_loss: 160.9428; val_edge_recon_loss: 109862.6250; val_gene_expr_recon_loss: 109831.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219854.9688; val_optim_loss: 219854.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8902; val_auprc_score: 0.9694; val_best_acc_score: 0.9067; val_best_f1_score: 0.9471; train_kl_reg_loss: 164.2842; train_edge_recon_loss: 99967.3086; train_gene_expr_recon_loss: 108666.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208798.4219; train_optim_loss: 208798.4219; val_kl_reg_loss: 165.5655; val_edge_recon_loss: 104073.4844; val_gene_expr_recon_loss: 109161.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213400.1406; val_optim_loss: 213400.1406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8791; val_auprc_score: 0.9730; val_best_acc_score: 0.8881; val_best_f1_score: 0.9370; train_kl_reg_loss: 177.2215; train_edge_recon_loss: 98396.8242; train_gene_expr_recon_loss: 108761.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207335.0547; train_optim_loss: 207335.0547; val_kl_reg_loss: 193.4583; val_edge_recon_loss: 107587.7109; val_gene_expr_recon_loss: 108598.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216380.0156; val_optim_loss: 216380.0156
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8312; val_auprc_score: 0.9501; val_best_acc_score: 0.8759; val_best_f1_score: 0.9306; train_kl_reg_loss: 212.1315; train_edge_recon_loss: 100624.2305; train_gene_expr_recon_loss: 107994.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208830.8125; train_optim_loss: 208830.8125; val_kl_reg_loss: 244.4834; val_edge_recon_loss: 110345.5312; val_gene_expr_recon_loss: 108118.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218708.8906; val_optim_loss: 218708.8906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8396; val_auprc_score: 0.9624; val_best_acc_score: 0.8982; val_best_f1_score: 0.9438; train_kl_reg_loss: 271.7706; train_edge_recon_loss: 96725.6328; train_gene_expr_recon_loss: 106437.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203435.0156; train_optim_loss: 203435.0156; val_kl_reg_loss: 318.5133; val_edge_recon_loss: 93278.2109; val_gene_expr_recon_loss: 107698.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201294.9688; val_optim_loss: 201294.9688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8152; val_auprc_score: 0.9572; val_best_acc_score: 0.8779; val_best_f1_score: 0.9321; train_kl_reg_loss: 358.2702; train_edge_recon_loss: 97817.6055; train_gene_expr_recon_loss: 105804.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203980.5312; train_optim_loss: 203980.5312; val_kl_reg_loss: 421.1243; val_edge_recon_loss: 103723.1406; val_gene_expr_recon_loss: 107319.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211463.8281; val_optim_loss: 211463.8281
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7981; val_auprc_score: 0.9570; val_best_acc_score: 0.8917; val_best_f1_score: 0.9401; train_kl_reg_loss: 467.1865; train_edge_recon_loss: 96556.9609; train_gene_expr_recon_loss: 106596.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203620.2500; train_optim_loss: 203620.2500; val_kl_reg_loss: 564.7115; val_edge_recon_loss: 93487.9219; val_gene_expr_recon_loss: 106981.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201034.0781; val_optim_loss: 201034.0781
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7938; val_auprc_score: 0.9494; val_best_acc_score: 0.8769; val_best_f1_score: 0.9314; train_kl_reg_loss: 641.8225; train_edge_recon_loss: 90678.8281; train_gene_expr_recon_loss: 106255.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197575.9141; train_optim_loss: 197575.9141; val_kl_reg_loss: 760.7070; val_edge_recon_loss: 100402.4531; val_gene_expr_recon_loss: 106677.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207840.5000; val_optim_loss: 207840.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7733; val_auprc_score: 0.9457; val_best_acc_score: 0.8905; val_best_f1_score: 0.9395; train_kl_reg_loss: 844.1564; train_edge_recon_loss: 89432.1055; train_gene_expr_recon_loss: 105437.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195714.2031; train_optim_loss: 195714.2031; val_kl_reg_loss: 1011.5354; val_edge_recon_loss: 92403.7656; val_gene_expr_recon_loss: 106399.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199814.5938; val_optim_loss: 199814.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7988; val_auprc_score: 0.9544; val_best_acc_score: 0.8898; val_best_f1_score: 0.9393; train_kl_reg_loss: 1137.3544; train_edge_recon_loss: 91001.4219; train_gene_expr_recon_loss: 105314.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197453.3906; train_optim_loss: 197453.3906; val_kl_reg_loss: 1299.9944; val_edge_recon_loss: 88224.3047; val_gene_expr_recon_loss: 106130.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195654.6562; val_optim_loss: 195654.6562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8072; val_auprc_score: 0.9605; val_best_acc_score: 0.8893; val_best_f1_score: 0.9393; train_kl_reg_loss: 1439.5497; train_edge_recon_loss: 90324.4727; train_gene_expr_recon_loss: 105633.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197397.3359; train_optim_loss: 197397.3359; val_kl_reg_loss: 1650.8882; val_edge_recon_loss: 87084.7812; val_gene_expr_recon_loss: 105860.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194596.0312; val_optim_loss: 194596.0312
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8071; val_auprc_score: 0.9544; val_best_acc_score: 0.8844; val_best_f1_score: 0.9361; train_kl_reg_loss: 1810.9365; train_edge_recon_loss: 84017.2852; train_gene_expr_recon_loss: 104171.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189999.3438; train_optim_loss: 189999.3438; val_kl_reg_loss: 1966.4224; val_edge_recon_loss: 90446.4141; val_gene_expr_recon_loss: 105634.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198046.8750; val_optim_loss: 198046.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8000; val_auprc_score: 0.9590; val_best_acc_score: 0.8995; val_best_f1_score: 0.9451; train_kl_reg_loss: 2112.3209; train_edge_recon_loss: 86592.2188; train_gene_expr_recon_loss: 104284.0664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192988.6016; train_optim_loss: 192988.6016; val_kl_reg_loss: 2192.5269; val_edge_recon_loss: 79355.4922; val_gene_expr_recon_loss: 105469.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187017.7344; val_optim_loss: 187017.7344
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8100; val_auprc_score: 0.9590; val_best_acc_score: 0.8869; val_best_f1_score: 0.9377; train_kl_reg_loss: 2327.3879; train_edge_recon_loss: 89683.5000; train_gene_expr_recon_loss: 104734.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196745.4531; train_optim_loss: 196745.4531; val_kl_reg_loss: 2317.8794; val_edge_recon_loss: 88626.4453; val_gene_expr_recon_loss: 105285.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196229.8125; val_optim_loss: 196229.8125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7952; val_auprc_score: 0.9510; val_best_acc_score: 0.8815; val_best_f1_score: 0.9344; train_kl_reg_loss: 2433.4434; train_edge_recon_loss: 85613.9531; train_gene_expr_recon_loss: 104349.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192397.1250; train_optim_loss: 192397.1250; val_kl_reg_loss: 2383.6738; val_edge_recon_loss: 93207.2656; val_gene_expr_recon_loss: 105156.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200747.5625; val_optim_loss: 200747.5625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8023; val_auprc_score: 0.9581; val_best_acc_score: 0.8835; val_best_f1_score: 0.9363; train_kl_reg_loss: 2461.6184; train_edge_recon_loss: 82360.2617; train_gene_expr_recon_loss: 104285.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189107.4219; train_optim_loss: 189107.4219; val_kl_reg_loss: 2390.5220; val_edge_recon_loss: 87290.2188; val_gene_expr_recon_loss: 105019.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194700.5781; val_optim_loss: 194700.5781

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8331; val_auprc_score: 0.9582; val_best_acc_score: 0.8793; val_best_f1_score: 0.9330; train_kl_reg_loss: 2452.8771; train_edge_recon_loss: 85705.2344; train_gene_expr_recon_loss: 103471.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191629.5781; train_optim_loss: 191629.5781; val_kl_reg_loss: 2363.7354; val_edge_recon_loss: 90307.6641; val_gene_expr_recon_loss: 105001.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197673.3281; val_optim_loss: 197673.3281
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8184; val_auprc_score: 0.9604; val_best_acc_score: 0.8866; val_best_f1_score: 0.9375; train_kl_reg_loss: 2440.0879; train_edge_recon_loss: 84962.0078; train_gene_expr_recon_loss: 102602.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190005.0078; train_optim_loss: 190005.0078; val_kl_reg_loss: 2383.4988; val_edge_recon_loss: 89201.7656; val_gene_expr_recon_loss: 104979.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196564.3750; val_optim_loss: 196564.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8067; val_auprc_score: 0.9570; val_best_acc_score: 0.8881; val_best_f1_score: 0.9386; train_kl_reg_loss: 2445.6957; train_edge_recon_loss: 85808.6797; train_gene_expr_recon_loss: 103652.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191907.1875; train_optim_loss: 191907.1875; val_kl_reg_loss: 2369.9766; val_edge_recon_loss: 86583.4219; val_gene_expr_recon_loss: 104958.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193912.3438; val_optim_loss: 193912.3438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 14 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.7839
Val AUPRC score: 0.9520
Val best accuracy score: 0.8884
Val best F1 score: 0.9389
Val gene expr MSE score: 1.3676
Duration of model training in run 1: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9204; val_auprc_score: 0.9809; val_best_acc_score: 0.9099; val_best_f1_score: 0.9491; train_kl_reg_loss: 51.4756; train_edge_recon_loss: 99877.8555; train_gene_expr_recon_loss: 143932.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243861.8125; train_optim_loss: 243861.8125; val_kl_reg_loss: 72.8590; val_edge_recon_loss: 114350.4297; val_gene_expr_recon_loss: 136084.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250508.1875; val_optim_loss: 250508.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9114; val_auprc_score: 0.9814; val_best_acc_score: 0.9076; val_best_f1_score: 0.9472; train_kl_reg_loss: 92.9408; train_edge_recon_loss: 102981.0703; train_gene_expr_recon_loss: 131712.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234786.5078; train_optim_loss: 234786.5078; val_kl_reg_loss: 162.3366; val_edge_recon_loss: 110594.1641; val_gene_expr_recon_loss: 125043.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235800.2500; val_optim_loss: 235800.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9171; val_auprc_score: 0.9807; val_best_acc_score: 0.8841; val_best_f1_score: 0.9352; train_kl_reg_loss: 196.5414; train_edge_recon_loss: 100394.5000; train_gene_expr_recon_loss: 121547.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222138.1328; train_optim_loss: 222138.1328; val_kl_reg_loss: 282.1638; val_edge_recon_loss: 126426.4609; val_gene_expr_recon_loss: 117988.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244696.6875; val_optim_loss: 244696.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9054; val_auprc_score: 0.9716; val_best_acc_score: 0.8877; val_best_f1_score: 0.9377; train_kl_reg_loss: 301.2384; train_edge_recon_loss: 100010.1797; train_gene_expr_recon_loss: 115091.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215402.7656; train_optim_loss: 215402.7656; val_kl_reg_loss: 327.8479; val_edge_recon_loss: 118922.2891; val_gene_expr_recon_loss: 114141.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233391.7969; val_optim_loss: 233391.7969
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9115; val_auprc_score: 0.9771; val_best_acc_score: 0.9072; val_best_f1_score: 0.9477; train_kl_reg_loss: 325.7169; train_edge_recon_loss: 104233.5391; train_gene_expr_recon_loss: 110832.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215391.8438; train_optim_loss: 215391.8438; val_kl_reg_loss: 308.5145; val_edge_recon_loss: 112027.2109; val_gene_expr_recon_loss: 112051.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224387.1562; val_optim_loss: 224387.1562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8996; val_auprc_score: 0.9786; val_best_acc_score: 0.9013; val_best_f1_score: 0.9450; train_kl_reg_loss: 298.5653; train_edge_recon_loss: 104489.3047; train_gene_expr_recon_loss: 109957.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214745.7891; train_optim_loss: 214745.7891; val_kl_reg_loss: 250.2899; val_edge_recon_loss: 109050.6172; val_gene_expr_recon_loss: 110987.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220288.5000; val_optim_loss: 220288.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9068; val_auprc_score: 0.9797; val_best_acc_score: 0.9031; val_best_f1_score: 0.9454; train_kl_reg_loss: 236.7566; train_edge_recon_loss: 100351.8750; train_gene_expr_recon_loss: 108447.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209036.4844; train_optim_loss: 209036.4844; val_kl_reg_loss: 196.2995; val_edge_recon_loss: 112106.8984; val_gene_expr_recon_loss: 110426.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222729.4062; val_optim_loss: 222729.4062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9054; val_auprc_score: 0.9799; val_best_acc_score: 0.9098; val_best_f1_score: 0.9491; train_kl_reg_loss: 189.0828; train_edge_recon_loss: 99510.9648; train_gene_expr_recon_loss: 108276.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207976.8281; train_optim_loss: 207976.8281; val_kl_reg_loss: 168.6856; val_edge_recon_loss: 102696.2734; val_gene_expr_recon_loss: 110032.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212897.0469; val_optim_loss: 212897.0469
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8691; val_auprc_score: 0.9711; val_best_acc_score: 0.9009; val_best_f1_score: 0.9458; train_kl_reg_loss: 170.1876; train_edge_recon_loss: 102455.2773; train_gene_expr_recon_loss: 107986.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210611.8828; train_optim_loss: 210611.8828; val_kl_reg_loss: 168.2367; val_edge_recon_loss: 94747.1641; val_gene_expr_recon_loss: 109677.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204592.8750; val_optim_loss: 204592.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8619; val_auprc_score: 0.9700; val_best_acc_score: 0.9046; val_best_f1_score: 0.9472; train_kl_reg_loss: 177.7640; train_edge_recon_loss: 99165.8477; train_gene_expr_recon_loss: 107753.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207096.6484; train_optim_loss: 207096.6484; val_kl_reg_loss: 196.6230; val_edge_recon_loss: 94704.1484; val_gene_expr_recon_loss: 109337.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204237.8281; val_optim_loss: 204237.8281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8782; val_auprc_score: 0.9740; val_best_acc_score: 0.9030; val_best_f1_score: 0.9461; train_kl_reg_loss: 214.7482; train_edge_recon_loss: 99439.7617; train_gene_expr_recon_loss: 107756.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207410.7344; train_optim_loss: 207410.7344; val_kl_reg_loss: 257.0757; val_edge_recon_loss: 94369.8281; val_gene_expr_recon_loss: 109004.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203631.0312; val_optim_loss: 203631.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8171; val_auprc_score: 0.9589; val_best_acc_score: 0.8891; val_best_f1_score: 0.9381; train_kl_reg_loss: 280.7955; train_edge_recon_loss: 97249.4922; train_gene_expr_recon_loss: 106538.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204068.4453; train_optim_loss: 204068.4453; val_kl_reg_loss: 360.0544; val_edge_recon_loss: 101102.3516; val_gene_expr_recon_loss: 108677.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210139.8906; val_optim_loss: 210139.8906
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8429; val_auprc_score: 0.9655; val_best_acc_score: 0.9027; val_best_f1_score: 0.9459; train_kl_reg_loss: 401.6684; train_edge_recon_loss: 97797.5117; train_gene_expr_recon_loss: 105898.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204097.9766; train_optim_loss: 204097.9766; val_kl_reg_loss: 504.0644; val_edge_recon_loss: 89653.1328; val_gene_expr_recon_loss: 108356.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198513.3281; val_optim_loss: 198513.3281
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8114; val_auprc_score: 0.9587; val_best_acc_score: 0.8896; val_best_f1_score: 0.9388; train_kl_reg_loss: 553.6874; train_edge_recon_loss: 97025.9453; train_gene_expr_recon_loss: 106137.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203717.2109; train_optim_loss: 203717.2109; val_kl_reg_loss: 691.2788; val_edge_recon_loss: 95260.7422; val_gene_expr_recon_loss: 108043.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203995.9688; val_optim_loss: 203995.9688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8189; val_auprc_score: 0.9602; val_best_acc_score: 0.9044; val_best_f1_score: 0.9468; train_kl_reg_loss: 772.1378; train_edge_recon_loss: 93013.6289; train_gene_expr_recon_loss: 106257.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200042.8516; train_optim_loss: 200042.8516; val_kl_reg_loss: 936.8265; val_edge_recon_loss: 87306.6797; val_gene_expr_recon_loss: 107759.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196003.3438; val_optim_loss: 196003.3438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8195; val_auprc_score: 0.9608; val_best_acc_score: 0.8898; val_best_f1_score: 0.9386; train_kl_reg_loss: 1010.0493; train_edge_recon_loss: 93305.4023; train_gene_expr_recon_loss: 104897.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199212.9219; train_optim_loss: 199212.9219; val_kl_reg_loss: 1172.7744; val_edge_recon_loss: 90003.6641; val_gene_expr_recon_loss: 107529.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198705.8750; val_optim_loss: 198705.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8168; val_auprc_score: 0.9604; val_best_acc_score: 0.8920; val_best_f1_score: 0.9409; train_kl_reg_loss: 1251.6429; train_edge_recon_loss: 93411.6562; train_gene_expr_recon_loss: 104925.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199589.2266; train_optim_loss: 199589.2266; val_kl_reg_loss: 1446.4863; val_edge_recon_loss: 85408.6094; val_gene_expr_recon_loss: 107320.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194175.1094; val_optim_loss: 194175.1094
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8143; val_auprc_score: 0.9557; val_best_acc_score: 0.8849; val_best_f1_score: 0.9366; train_kl_reg_loss: 1542.5233; train_edge_recon_loss: 88908.3438; train_gene_expr_recon_loss: 105794.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196245.2656; train_optim_loss: 196245.2656; val_kl_reg_loss: 1729.0985; val_edge_recon_loss: 90429.7656; val_gene_expr_recon_loss: 107022.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199181.6250; val_optim_loss: 199181.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8160; val_auprc_score: 0.9632; val_best_acc_score: 0.8911; val_best_f1_score: 0.9401; train_kl_reg_loss: 1804.5084; train_edge_recon_loss: 89047.1914; train_gene_expr_recon_loss: 105283.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196135.2969; train_optim_loss: 196135.2969; val_kl_reg_loss: 1996.4679; val_edge_recon_loss: 85195.2578; val_gene_expr_recon_loss: 106784.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193976.5469; val_optim_loss: 193976.5469
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8242; val_auprc_score: 0.9596; val_best_acc_score: 0.8958; val_best_f1_score: 0.9429; train_kl_reg_loss: 2061.7438; train_edge_recon_loss: 90675.4336; train_gene_expr_recon_loss: 105671.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198408.6875; train_optim_loss: 198408.6875; val_kl_reg_loss: 2168.6160; val_edge_recon_loss: 82704.2891; val_gene_expr_recon_loss: 106605.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191478.4844; val_optim_loss: 191478.4844
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8403; val_auprc_score: 0.9560; val_best_acc_score: 0.8727; val_best_f1_score: 0.9290; train_kl_reg_loss: 2216.2484; train_edge_recon_loss: 87993.0508; train_gene_expr_recon_loss: 104124.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194334.2422; train_optim_loss: 194334.2422; val_kl_reg_loss: 2306.9731; val_edge_recon_loss: 97355.2188; val_gene_expr_recon_loss: 106440.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206102.2812; val_optim_loss: 206102.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8565; val_auprc_score: 0.9662; val_best_acc_score: 0.8956; val_best_f1_score: 0.9410; train_kl_reg_loss: 2357.7268; train_edge_recon_loss: 84283.5586; train_gene_expr_recon_loss: 105223.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191864.9922; train_optim_loss: 191864.9922; val_kl_reg_loss: 2436.4546; val_edge_recon_loss: 82335.7188; val_gene_expr_recon_loss: 106297.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191069.3750; val_optim_loss: 191069.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8380; val_auprc_score: 0.9574; val_best_acc_score: 0.8828; val_best_f1_score: 0.9346; train_kl_reg_loss: 2471.2981; train_edge_recon_loss: 84976.7461; train_gene_expr_recon_loss: 104851.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192299.5781; train_optim_loss: 192299.5781; val_kl_reg_loss: 2467.5530; val_edge_recon_loss: 88864.8906; val_gene_expr_recon_loss: 106160.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197493.3125; val_optim_loss: 197493.3125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8608; val_auprc_score: 0.9695; val_best_acc_score: 0.8913; val_best_f1_score: 0.9392; train_kl_reg_loss: 2474.5177; train_edge_recon_loss: 83743.4688; train_gene_expr_recon_loss: 104125.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190343.1406; train_optim_loss: 190343.1406; val_kl_reg_loss: 2453.5076; val_edge_recon_loss: 82756.1250; val_gene_expr_recon_loss: 106058.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191268.2500; val_optim_loss: 191268.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8799; val_auprc_score: 0.9665; val_best_acc_score: 0.8990; val_best_f1_score: 0.9422; train_kl_reg_loss: 2509.5597; train_edge_recon_loss: 86538.5078; train_gene_expr_recon_loss: 104852.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193900.1797; train_optim_loss: 193900.1797; val_kl_reg_loss: 2534.7495; val_edge_recon_loss: 82475.2891; val_gene_expr_recon_loss: 106037.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191047.9688; val_optim_loss: 191047.9688
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8456; val_auprc_score: 0.9633; val_best_acc_score: 0.8970; val_best_f1_score: 0.9421; train_kl_reg_loss: 2545.8132; train_edge_recon_loss: 86153.8750; train_gene_expr_recon_loss: 103930.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192630.4844; train_optim_loss: 192630.4844; val_kl_reg_loss: 2524.3672; val_edge_recon_loss: 80679.3750; val_gene_expr_recon_loss: 105868.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189072.5312; val_optim_loss: 189072.5312
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8839; val_auprc_score: 0.9718; val_best_acc_score: 0.8957; val_best_f1_score: 0.9410; train_kl_reg_loss: 2513.2229; train_edge_recon_loss: 80563.3203; train_gene_expr_recon_loss: 103643.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186720.5000; train_optim_loss: 186720.5000; val_kl_reg_loss: 2507.5210; val_edge_recon_loss: 82656.8594; val_gene_expr_recon_loss: 105768.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190932.7500; val_optim_loss: 190932.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8733; val_auprc_score: 0.9662; val_best_acc_score: 0.9001; val_best_f1_score: 0.9437; train_kl_reg_loss: 2511.9053; train_edge_recon_loss: 83451.0547; train_gene_expr_recon_loss: 102976.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188939.0703; train_optim_loss: 188939.0703; val_kl_reg_loss: 2564.1479; val_edge_recon_loss: 82910.5312; val_gene_expr_recon_loss: 105667.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191142.6094; val_optim_loss: 191142.6094
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8794; val_auprc_score: 0.9710; val_best_acc_score: 0.8961; val_best_f1_score: 0.9407; train_kl_reg_loss: 2583.3260; train_edge_recon_loss: 83999.1641; train_gene_expr_recon_loss: 104156.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190738.8359; train_optim_loss: 190738.8359; val_kl_reg_loss: 2520.2827; val_edge_recon_loss: 85071.9219; val_gene_expr_recon_loss: 105535.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193127.5938; val_optim_loss: 193127.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9052; val_auprc_score: 0.9766; val_best_acc_score: 0.9047; val_best_f1_score: 0.9455; train_kl_reg_loss: 2543.8201; train_edge_recon_loss: 82948.5664; train_gene_expr_recon_loss: 104082.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189575.2344; train_optim_loss: 189575.2344; val_kl_reg_loss: 2505.4717; val_edge_recon_loss: 82106.9531; val_gene_expr_recon_loss: 105523.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190135.8125; val_optim_loss: 190135.8125
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8690; val_auprc_score: 0.9671; val_best_acc_score: 0.8988; val_best_f1_score: 0.9433; train_kl_reg_loss: 2513.8900; train_edge_recon_loss: 77982.4805; train_gene_expr_recon_loss: 102638.2148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183134.5859; train_optim_loss: 183134.5859; val_kl_reg_loss: 2500.2678; val_edge_recon_loss: 81426.3906; val_gene_expr_recon_loss: 105507.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189434.0000; val_optim_loss: 189434.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8833; val_auprc_score: 0.9687; val_best_acc_score: 0.8918; val_best_f1_score: 0.9378; train_kl_reg_loss: 2520.9424; train_edge_recon_loss: 82656.6367; train_gene_expr_recon_loss: 103631.5430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188809.1172; train_optim_loss: 188809.1172; val_kl_reg_loss: 2486.5396; val_edge_recon_loss: 92495.1719; val_gene_expr_recon_loss: 105487.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200468.8125; val_optim_loss: 200468.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 17 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.8782
Val AUPRC score: 0.9699
Val best accuracy score: 0.9058
Val best F1 score: 0.9463
Val gene expr MSE score: 1.4171
Duration of model training in run 2: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9594; val_auprc_score: 0.9910; val_best_acc_score: 0.9297; val_best_f1_score: 0.9603; train_kl_reg_loss: 113.1354; train_edge_recon_loss: 101095.0859; train_gene_expr_recon_loss: 133457.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234665.7865; train_optim_loss: 234665.7865; val_kl_reg_loss: 262.0886; val_edge_recon_loss: 114121.3203; val_gene_expr_recon_loss: 118305.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232689.3125; val_optim_loss: 232689.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9329; val_auprc_score: 0.9838; val_best_acc_score: 0.9173; val_best_f1_score: 0.9526; train_kl_reg_loss: 258.2687; train_edge_recon_loss: 100699.7839; train_gene_expr_recon_loss: 113163.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214121.7292; train_optim_loss: 214121.7292; val_kl_reg_loss: 197.7853; val_edge_recon_loss: 116721.2812; val_gene_expr_recon_loss: 111127.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228046.4375; val_optim_loss: 228046.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8878; val_auprc_score: 0.9748; val_best_acc_score: 0.9046; val_best_f1_score: 0.9452; train_kl_reg_loss: 181.3903; train_edge_recon_loss: 101719.3789; train_gene_expr_recon_loss: 108997.7057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210898.4766; train_optim_loss: 210898.4766; val_kl_reg_loss: 185.7093; val_edge_recon_loss: 103044.0234; val_gene_expr_recon_loss: 109828.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213057.9062; val_optim_loss: 213057.9062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8557; val_auprc_score: 0.9683; val_best_acc_score: 0.8915; val_best_f1_score: 0.9395; train_kl_reg_loss: 250.4555; train_edge_recon_loss: 99822.6484; train_gene_expr_recon_loss: 107613.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207686.7656; train_optim_loss: 207686.7656; val_kl_reg_loss: 395.3817; val_edge_recon_loss: 97739.8438; val_gene_expr_recon_loss: 108772.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206907.3750; val_optim_loss: 206907.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8374; val_auprc_score: 0.9620; val_best_acc_score: 0.8903; val_best_f1_score: 0.9391; train_kl_reg_loss: 592.9286; train_edge_recon_loss: 96665.9023; train_gene_expr_recon_loss: 106629.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203888.8307; train_optim_loss: 203888.8307; val_kl_reg_loss: 935.1111; val_edge_recon_loss: 92689.0469; val_gene_expr_recon_loss: 107784.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201408.8125; val_optim_loss: 201408.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8411; val_auprc_score: 0.9604; val_best_acc_score: 0.8852; val_best_f1_score: 0.9357; train_kl_reg_loss: 1253.7349; train_edge_recon_loss: 91230.7461; train_gene_expr_recon_loss: 106085.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198570.0859; train_optim_loss: 198570.0859; val_kl_reg_loss: 1643.8298; val_edge_recon_loss: 95116.2188; val_gene_expr_recon_loss: 107011.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203771.5625; val_optim_loss: 203771.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8493; val_auprc_score: 0.9604; val_best_acc_score: 0.8944; val_best_f1_score: 0.9408; train_kl_reg_loss: 1822.7716; train_edge_recon_loss: 90977.2122; train_gene_expr_recon_loss: 105531.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198331.4323; train_optim_loss: 198331.4323; val_kl_reg_loss: 2019.1971; val_edge_recon_loss: 87467.1016; val_gene_expr_recon_loss: 106476.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195963.1875; val_optim_loss: 195963.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8702; val_auprc_score: 0.9708; val_best_acc_score: 0.8976; val_best_f1_score: 0.9417; train_kl_reg_loss: 2102.6677; train_edge_recon_loss: 84730.2878; train_gene_expr_recon_loss: 104560.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191393.2292; train_optim_loss: 191393.2292; val_kl_reg_loss: 2249.2930; val_edge_recon_loss: 84857.2812; val_gene_expr_recon_loss: 106165.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193272.2812; val_optim_loss: 193272.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8888; val_auprc_score: 0.9728; val_best_acc_score: 0.8962; val_best_f1_score: 0.9412; train_kl_reg_loss: 2389.4627; train_edge_recon_loss: 81894.8659; train_gene_expr_recon_loss: 104709.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188993.9766; train_optim_loss: 188993.9766; val_kl_reg_loss: 2477.5625; val_edge_recon_loss: 87741.4531; val_gene_expr_recon_loss: 105799.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196018.0625; val_optim_loss: 196018.0625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8961; val_auprc_score: 0.9748; val_best_acc_score: 0.9062; val_best_f1_score: 0.9466; train_kl_reg_loss: 2479.3066; train_edge_recon_loss: 82485.6445; train_gene_expr_recon_loss: 104204.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189169.6198; train_optim_loss: 189169.6198; val_kl_reg_loss: 2381.7437; val_edge_recon_loss: 82477.0078; val_gene_expr_recon_loss: 105583.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190442.0469; val_optim_loss: 190442.0469
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8905; val_auprc_score: 0.9728; val_best_acc_score: 0.9141; val_best_f1_score: 0.9514; train_kl_reg_loss: 2276.5751; train_edge_recon_loss: 81331.1549; train_gene_expr_recon_loss: 104046.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187654.2188; train_optim_loss: 187654.2188; val_kl_reg_loss: 2118.8115; val_edge_recon_loss: 79803.0938; val_gene_expr_recon_loss: 105264.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187186.8438; val_optim_loss: 187186.8438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9284; val_auprc_score: 0.9791; val_best_acc_score: 0.9219; val_best_f1_score: 0.9545; train_kl_reg_loss: 2073.9308; train_edge_recon_loss: 80461.9661; train_gene_expr_recon_loss: 103743.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186279.7682; train_optim_loss: 186279.7682; val_kl_reg_loss: 2011.8173; val_edge_recon_loss: 84700.8359; val_gene_expr_recon_loss: 104952.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191664.6562; val_optim_loss: 191664.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9092; val_auprc_score: 0.9756; val_best_acc_score: 0.9201; val_best_f1_score: 0.9543; train_kl_reg_loss: 1985.4565; train_edge_recon_loss: 81435.9049; train_gene_expr_recon_loss: 103288.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186709.7396; train_optim_loss: 186709.7396; val_kl_reg_loss: 1950.0981; val_edge_recon_loss: 85079.2578; val_gene_expr_recon_loss: 104653.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191682.9688; val_optim_loss: 191682.9688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9214; val_auprc_score: 0.9780; val_best_acc_score: 0.9315; val_best_f1_score: 0.9607; train_kl_reg_loss: 1967.8452; train_edge_recon_loss: 80358.8281; train_gene_expr_recon_loss: 103093.8268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185420.5000; train_optim_loss: 185420.5000; val_kl_reg_loss: 1975.2759; val_edge_recon_loss: 80649.1797; val_gene_expr_recon_loss: 104335.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186960.2500; val_optim_loss: 186960.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9380; val_auprc_score: 0.9852; val_best_acc_score: 0.9368; val_best_f1_score: 0.9635; train_kl_reg_loss: 2007.2331; train_edge_recon_loss: 80469.4219; train_gene_expr_recon_loss: 102764.9154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185241.5677; train_optim_loss: 185241.5677; val_kl_reg_loss: 2009.1821; val_edge_recon_loss: 79195.8359; val_gene_expr_recon_loss: 104101.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185306.4688; val_optim_loss: 185306.4688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9327; val_auprc_score: 0.9820; val_best_acc_score: 0.9390; val_best_f1_score: 0.9651; train_kl_reg_loss: 2002.6435; train_edge_recon_loss: 79414.8815; train_gene_expr_recon_loss: 102784.7799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184202.3047; train_optim_loss: 184202.3047; val_kl_reg_loss: 1962.7463; val_edge_recon_loss: 78441.8828; val_gene_expr_recon_loss: 103943.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184347.8281; val_optim_loss: 184347.8281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9361; val_auprc_score: 0.9844; val_best_acc_score: 0.9371; val_best_f1_score: 0.9637; train_kl_reg_loss: 1934.8891; train_edge_recon_loss: 78424.4062; train_gene_expr_recon_loss: 102440.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182799.8151; train_optim_loss: 182799.8151; val_kl_reg_loss: 1905.7434; val_edge_recon_loss: 82806.6719; val_gene_expr_recon_loss: 103719.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188431.8906; val_optim_loss: 188431.8906
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9517; val_auprc_score: 0.9874; val_best_acc_score: 0.9494; val_best_f1_score: 0.9710; train_kl_reg_loss: 1933.2777; train_edge_recon_loss: 78706.8424; train_gene_expr_recon_loss: 102393.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183033.2474; train_optim_loss: 183033.2474; val_kl_reg_loss: 1944.9653; val_edge_recon_loss: 73422.5469; val_gene_expr_recon_loss: 103532.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178900.2656; val_optim_loss: 178900.2656
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9348; val_auprc_score: 0.9829; val_best_acc_score: 0.9425; val_best_f1_score: 0.9673; train_kl_reg_loss: 1964.3949; train_edge_recon_loss: 77993.9753; train_gene_expr_recon_loss: 101844.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181803.1380; train_optim_loss: 181803.1380; val_kl_reg_loss: 1952.7566; val_edge_recon_loss: 78539.6016; val_gene_expr_recon_loss: 103361.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183853.7812; val_optim_loss: 183853.7812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9351; val_auprc_score: 0.9811; val_best_acc_score: 0.9395; val_best_f1_score: 0.9651; train_kl_reg_loss: 1965.0848; train_edge_recon_loss: 78970.6211; train_gene_expr_recon_loss: 102166.6302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183102.3438; train_optim_loss: 183102.3438; val_kl_reg_loss: 1929.9150; val_edge_recon_loss: 82567.2344; val_gene_expr_recon_loss: 103133.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187630.5938; val_optim_loss: 187630.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9411; val_auprc_score: 0.9858; val_best_acc_score: 0.9498; val_best_f1_score: 0.9714; train_kl_reg_loss: 1946.4185; train_edge_recon_loss: 79615.7982; train_gene_expr_recon_loss: 101551.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183113.8229; train_optim_loss: 183113.8229; val_kl_reg_loss: 1933.3507; val_edge_recon_loss: 75452.8047; val_gene_expr_recon_loss: 102991.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180377.4688; val_optim_loss: 180377.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9490; val_auprc_score: 0.9889; val_best_acc_score: 0.9518; val_best_f1_score: 0.9722; train_kl_reg_loss: 1948.8987; train_edge_recon_loss: 77548.1641; train_gene_expr_recon_loss: 101225.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180722.2708; train_optim_loss: 180722.2708; val_kl_reg_loss: 1932.5300; val_edge_recon_loss: 79061.9688; val_gene_expr_recon_loss: 102953.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183947.6406; val_optim_loss: 183947.6406
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9372; val_auprc_score: 0.9840; val_best_acc_score: 0.9464; val_best_f1_score: 0.9693; train_kl_reg_loss: 1946.3580; train_edge_recon_loss: 77133.4831; train_gene_expr_recon_loss: 101459.3737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180539.2135; train_optim_loss: 180539.2135; val_kl_reg_loss: 1935.5542; val_edge_recon_loss: 76318.7969; val_gene_expr_recon_loss: 102944.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181198.7188; val_optim_loss: 181198.7188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9591; val_auprc_score: 0.9909; val_best_acc_score: 0.9531; val_best_f1_score: 0.9732; train_kl_reg_loss: 1949.6146; train_edge_recon_loss: 76984.6849; train_gene_expr_recon_loss: 101337.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180271.9714; train_optim_loss: 180271.9714; val_kl_reg_loss: 1935.2554; val_edge_recon_loss: 72792.1797; val_gene_expr_recon_loss: 102902.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177630.1875; val_optim_loss: 177630.1875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9551; val_auprc_score: 0.9893; val_best_acc_score: 0.9514; val_best_f1_score: 0.9722; train_kl_reg_loss: 1958.3290; train_edge_recon_loss: 81208.3750; train_gene_expr_recon_loss: 101448.8216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184615.5260; train_optim_loss: 184615.5260; val_kl_reg_loss: 1948.3601; val_edge_recon_loss: 76077.6172; val_gene_expr_recon_loss: 102878.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180904.5625; val_optim_loss: 180904.5625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9371; val_auprc_score: 0.9806; val_best_acc_score: 0.9444; val_best_f1_score: 0.9681; train_kl_reg_loss: 1962.3498; train_edge_recon_loss: 78445.4570; train_gene_expr_recon_loss: 101250.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181657.8880; train_optim_loss: 181657.8880; val_kl_reg_loss: 1949.2366; val_edge_recon_loss: 81605.7031; val_gene_expr_recon_loss: 102859.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186414.6562; val_optim_loss: 186414.6562
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9492; val_auprc_score: 0.9835; val_best_acc_score: 0.9540; val_best_f1_score: 0.9735; train_kl_reg_loss: 1960.7126; train_edge_recon_loss: 79268.9479; train_gene_expr_recon_loss: 101579.5755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182809.2370; train_optim_loss: 182809.2370; val_kl_reg_loss: 1948.5068; val_edge_recon_loss: 75986.8359; val_gene_expr_recon_loss: 102855.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180790.4375; val_optim_loss: 180790.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9469; val_auprc_score: 0.9823; val_best_acc_score: 0.9481; val_best_f1_score: 0.9701; train_kl_reg_loss: 1959.0665; train_edge_recon_loss: 80175.7969; train_gene_expr_recon_loss: 101107.3581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183242.2188; train_optim_loss: 183242.2188; val_kl_reg_loss: 1944.4600; val_edge_recon_loss: 78443.4297; val_gene_expr_recon_loss: 102851.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183239.5312; val_optim_loss: 183239.5312
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9539; val_auprc_score: 0.9879; val_best_acc_score: 0.9454; val_best_f1_score: 0.9683; train_kl_reg_loss: 1962.1123; train_edge_recon_loss: 79715.6784; train_gene_expr_recon_loss: 101540.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183217.9557; train_optim_loss: 183217.9557; val_kl_reg_loss: 1947.6748; val_edge_recon_loss: 82225.6562; val_gene_expr_recon_loss: 102846.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187019.5312; val_optim_loss: 187019.5312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9380; val_auprc_score: 0.9795; val_best_acc_score: 0.9470; val_best_f1_score: 0.9692; train_kl_reg_loss: 1961.1686; train_edge_recon_loss: 78468.8763; train_gene_expr_recon_loss: 101608.1654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182038.2109; train_optim_loss: 182038.2109; val_kl_reg_loss: 1941.3424; val_edge_recon_loss: 84355.5938; val_gene_expr_recon_loss: 102841.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189138.2188; val_optim_loss: 189138.2188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9382
Val AUPRC score: 0.9846
Val best accuracy score: 0.9474
Val best F1 score: 0.9698
Val gene expr MSE score: 1.2419
Duration of model training in run 3: 0 hours, 0 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9592; val_auprc_score: 0.9906; val_best_acc_score: 0.9347; val_best_f1_score: 0.9631; train_kl_reg_loss: 110.6437; train_edge_recon_loss: 100303.8138; train_gene_expr_recon_loss: 132279.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232693.7292; train_optim_loss: 232693.7292; val_kl_reg_loss: 251.5788; val_edge_recon_loss: 114722.9297; val_gene_expr_recon_loss: 116619.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231593.9062; val_optim_loss: 231593.9062
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9465; val_auprc_score: 0.9875; val_best_acc_score: 0.9268; val_best_f1_score: 0.9581; train_kl_reg_loss: 263.5659; train_edge_recon_loss: 101351.1589; train_gene_expr_recon_loss: 111596.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213211.6380; train_optim_loss: 213211.6380; val_kl_reg_loss: 189.6753; val_edge_recon_loss: 116738.3047; val_gene_expr_recon_loss: 110062.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226990.1250; val_optim_loss: 226990.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8833; val_auprc_score: 0.9741; val_best_acc_score: 0.9093; val_best_f1_score: 0.9492; train_kl_reg_loss: 158.4795; train_edge_recon_loss: 98899.5729; train_gene_expr_recon_loss: 108121.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207179.4349; train_optim_loss: 207179.4349; val_kl_reg_loss: 162.6551; val_edge_recon_loss: 97924.4688; val_gene_expr_recon_loss: 109145.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207232.1406; val_optim_loss: 207232.1406
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8575; val_auprc_score: 0.9707; val_best_acc_score: 0.8987; val_best_f1_score: 0.9440; train_kl_reg_loss: 235.8023; train_edge_recon_loss: 98115.0846; train_gene_expr_recon_loss: 107037.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205388.1536; train_optim_loss: 205388.1536; val_kl_reg_loss: 396.2276; val_edge_recon_loss: 92851.3984; val_gene_expr_recon_loss: 108239.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201486.6719; val_optim_loss: 201486.6719
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8284; val_auprc_score: 0.9634; val_best_acc_score: 0.8992; val_best_f1_score: 0.9443; train_kl_reg_loss: 609.1279; train_edge_recon_loss: 95913.5781; train_gene_expr_recon_loss: 106182.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202705.3828; train_optim_loss: 202705.3828; val_kl_reg_loss: 1014.0769; val_edge_recon_loss: 86583.2891; val_gene_expr_recon_loss: 107335.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194933.1250; val_optim_loss: 194933.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8425; val_auprc_score: 0.9607; val_best_acc_score: 0.8960; val_best_f1_score: 0.9418; train_kl_reg_loss: 1355.4019; train_edge_recon_loss: 92600.6393; train_gene_expr_recon_loss: 105414.9870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199371.0260; train_optim_loss: 199371.0260; val_kl_reg_loss: 1754.8531; val_edge_recon_loss: 91988.1094; val_gene_expr_recon_loss: 106566.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200309.6406; val_optim_loss: 200309.6406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8484; val_auprc_score: 0.9635; val_best_acc_score: 0.8974; val_best_f1_score: 0.9426; train_kl_reg_loss: 1930.4365; train_edge_recon_loss: 89053.6953; train_gene_expr_recon_loss: 105160.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196144.8464; train_optim_loss: 196144.8464; val_kl_reg_loss: 2107.0151; val_edge_recon_loss: 90088.5781; val_gene_expr_recon_loss: 106042.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198238.2500; val_optim_loss: 198238.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8701; val_auprc_score: 0.9664; val_best_acc_score: 0.9073; val_best_f1_score: 0.9482; train_kl_reg_loss: 2139.0856; train_edge_recon_loss: 87115.0365; train_gene_expr_recon_loss: 104423.1159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193677.2370; train_optim_loss: 193677.2370; val_kl_reg_loss: 2095.5073; val_edge_recon_loss: 83016.7422; val_gene_expr_recon_loss: 105721.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190833.8438; val_optim_loss: 190833.8438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8961; val_auprc_score: 0.9733; val_best_acc_score: 0.9028; val_best_f1_score: 0.9446; train_kl_reg_loss: 2142.6713; train_edge_recon_loss: 85047.4857; train_gene_expr_recon_loss: 104406.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191596.2682; train_optim_loss: 191596.2682; val_kl_reg_loss: 2157.2146; val_edge_recon_loss: 90188.0859; val_gene_expr_recon_loss: 105430.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197775.8125; val_optim_loss: 197775.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9083; val_auprc_score: 0.9766; val_best_acc_score: 0.9236; val_best_f1_score: 0.9559; train_kl_reg_loss: 2277.6528; train_edge_recon_loss: 83816.7461; train_gene_expr_recon_loss: 103812.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189906.6224; train_optim_loss: 189906.6224; val_kl_reg_loss: 2324.6741; val_edge_recon_loss: 83446.8984; val_gene_expr_recon_loss: 105116.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190887.8125; val_optim_loss: 190887.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9156; val_auprc_score: 0.9760; val_best_acc_score: 0.9242; val_best_f1_score: 0.9565; train_kl_reg_loss: 2378.7024; train_edge_recon_loss: 79270.6003; train_gene_expr_recon_loss: 103498.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185147.5781; train_optim_loss: 185147.5781; val_kl_reg_loss: 2317.0342; val_edge_recon_loss: 82834.7734; val_gene_expr_recon_loss: 104877.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190029.2500; val_optim_loss: 190029.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9151; val_auprc_score: 0.9776; val_best_acc_score: 0.9254; val_best_f1_score: 0.9573; train_kl_reg_loss: 2292.4608; train_edge_recon_loss: 81985.2422; train_gene_expr_recon_loss: 103495.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187773.5443; train_optim_loss: 187773.5443; val_kl_reg_loss: 2166.2815; val_edge_recon_loss: 82147.3672; val_gene_expr_recon_loss: 104577.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188891.0000; val_optim_loss: 188891.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9398; val_auprc_score: 0.9861; val_best_acc_score: 0.9367; val_best_f1_score: 0.9634; train_kl_reg_loss: 2144.8590; train_edge_recon_loss: 80795.1667; train_gene_expr_recon_loss: 103106.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186046.2552; train_optim_loss: 186046.2552; val_kl_reg_loss: 2052.0481; val_edge_recon_loss: 79141.9062; val_gene_expr_recon_loss: 104369.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185563.9375; val_optim_loss: 185563.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9407; val_auprc_score: 0.9834; val_best_acc_score: 0.9408; val_best_f1_score: 0.9657; train_kl_reg_loss: 2072.1294; train_edge_recon_loss: 81486.9492; train_gene_expr_recon_loss: 102827.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186386.9635; train_optim_loss: 186386.9635; val_kl_reg_loss: 2016.0571; val_edge_recon_loss: 81817.4766; val_gene_expr_recon_loss: 104116.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187949.6562; val_optim_loss: 187949.6562
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9416; val_auprc_score: 0.9852; val_best_acc_score: 0.9461; val_best_f1_score: 0.9690; train_kl_reg_loss: 2057.6417; train_edge_recon_loss: 80513.1562; train_gene_expr_recon_loss: 102540.1393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185110.9349; train_optim_loss: 185110.9349; val_kl_reg_loss: 1996.7693; val_edge_recon_loss: 75865.1797; val_gene_expr_recon_loss: 103891.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181753.8750; val_optim_loss: 181753.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9424; val_auprc_score: 0.9835; val_best_acc_score: 0.9438; val_best_f1_score: 0.9678; train_kl_reg_loss: 2018.9184; train_edge_recon_loss: 79921.2878; train_gene_expr_recon_loss: 102277.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184217.8359; train_optim_loss: 184217.8359; val_kl_reg_loss: 1933.4761; val_edge_recon_loss: 75824.5469; val_gene_expr_recon_loss: 103699.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181457.5156; val_optim_loss: 181457.5156
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9403; val_auprc_score: 0.9847; val_best_acc_score: 0.9394; val_best_f1_score: 0.9647; train_kl_reg_loss: 1973.6323; train_edge_recon_loss: 79440.8750; train_gene_expr_recon_loss: 102446.3932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183860.9010; train_optim_loss: 183860.9010; val_kl_reg_loss: 1919.8867; val_edge_recon_loss: 84186.9219; val_gene_expr_recon_loss: 103501.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189607.9375; val_optim_loss: 189607.9375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9473; val_auprc_score: 0.9873; val_best_acc_score: 0.9474; val_best_f1_score: 0.9695; train_kl_reg_loss: 1947.5076; train_edge_recon_loss: 78558.0013; train_gene_expr_recon_loss: 102105.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182611.2682; train_optim_loss: 182611.2682; val_kl_reg_loss: 1863.5907; val_edge_recon_loss: 78571.4219; val_gene_expr_recon_loss: 103295.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183730.8750; val_optim_loss: 183730.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9533; val_auprc_score: 0.9854; val_best_acc_score: 0.9502; val_best_f1_score: 0.9712; train_kl_reg_loss: 1906.9685; train_edge_recon_loss: 77249.9961; train_gene_expr_recon_loss: 101429.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180586.7448; train_optim_loss: 180586.7448; val_kl_reg_loss: 1859.3213; val_edge_recon_loss: 78755.9531; val_gene_expr_recon_loss: 103109.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183724.5938; val_optim_loss: 183724.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9453; val_auprc_score: 0.9822; val_best_acc_score: 0.9510; val_best_f1_score: 0.9718; train_kl_reg_loss: 1913.8672; train_edge_recon_loss: 77858.7253; train_gene_expr_recon_loss: 101778.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181550.6224; train_optim_loss: 181550.6224; val_kl_reg_loss: 1865.8177; val_edge_recon_loss: 74500.9688; val_gene_expr_recon_loss: 103080.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179447.4531; val_optim_loss: 179447.4531
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9529; val_auprc_score: 0.9870; val_best_acc_score: 0.9464; val_best_f1_score: 0.9691; train_kl_reg_loss: 1924.1076; train_edge_recon_loss: 77669.5247; train_gene_expr_recon_loss: 101429.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181023.3880; train_optim_loss: 181023.3880; val_kl_reg_loss: 1880.7217; val_edge_recon_loss: 76769.4531; val_gene_expr_recon_loss: 103055.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181705.2188; val_optim_loss: 181705.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9521; val_auprc_score: 0.9876; val_best_acc_score: 0.9485; val_best_f1_score: 0.9703; train_kl_reg_loss: 1932.0116; train_edge_recon_loss: 78137.9284; train_gene_expr_recon_loss: 101298.8841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181368.8255; train_optim_loss: 181368.8255; val_kl_reg_loss: 1891.1189; val_edge_recon_loss: 80979.5469; val_gene_expr_recon_loss: 103032.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185903.6406; val_optim_loss: 185903.6406
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9541; val_auprc_score: 0.9851; val_best_acc_score: 0.9556; val_best_f1_score: 0.9744; train_kl_reg_loss: 1946.1117; train_edge_recon_loss: 78388.9245; train_gene_expr_recon_loss: 101312.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181647.5938; train_optim_loss: 181647.5938; val_kl_reg_loss: 1902.6836; val_edge_recon_loss: 73824.2656; val_gene_expr_recon_loss: 103014.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178741.9219; val_optim_loss: 178741.9219
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9546; val_auprc_score: 0.9899; val_best_acc_score: 0.9531; val_best_f1_score: 0.9729; train_kl_reg_loss: 1956.8969; train_edge_recon_loss: 80913.2852; train_gene_expr_recon_loss: 101618.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184488.9505; train_optim_loss: 184488.9505; val_kl_reg_loss: 1906.1411; val_edge_recon_loss: 78230.7188; val_gene_expr_recon_loss: 102999.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183136.4688; val_optim_loss: 183136.4688
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9487; val_auprc_score: 0.9875; val_best_acc_score: 0.9515; val_best_f1_score: 0.9723; train_kl_reg_loss: 1958.4372; train_edge_recon_loss: 79321.3750; train_gene_expr_recon_loss: 101211.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182491.1797; train_optim_loss: 182491.1797; val_kl_reg_loss: 1911.8208; val_edge_recon_loss: 74330.6875; val_gene_expr_recon_loss: 102980.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179223.0625; val_optim_loss: 179223.0625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9482; val_auprc_score: 0.9885; val_best_acc_score: 0.9470; val_best_f1_score: 0.9697; train_kl_reg_loss: 1972.0343; train_edge_recon_loss: 77033.6159; train_gene_expr_recon_loss: 101650.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180655.9818; train_optim_loss: 180655.9818; val_kl_reg_loss: 1917.2214; val_edge_recon_loss: 76307.3984; val_gene_expr_recon_loss: 102965.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181189.6719; val_optim_loss: 181189.6719

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9537; val_auprc_score: 0.9888; val_best_acc_score: 0.9506; val_best_f1_score: 0.9718; train_kl_reg_loss: 1970.5644; train_edge_recon_loss: 78983.1901; train_gene_expr_recon_loss: 101430.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182384.0911; train_optim_loss: 182384.0911; val_kl_reg_loss: 1919.4473; val_edge_recon_loss: 74667.8906; val_gene_expr_recon_loss: 102963.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179550.7188; val_optim_loss: 179550.7188
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9431; val_auprc_score: 0.9860; val_best_acc_score: 0.9516; val_best_f1_score: 0.9727; train_kl_reg_loss: 1972.4742; train_edge_recon_loss: 77960.8932; train_gene_expr_recon_loss: 101657.5716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181590.9453; train_optim_loss: 181590.9453; val_kl_reg_loss: 1919.1449; val_edge_recon_loss: 71125.6562; val_gene_expr_recon_loss: 102961.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176006.2812; val_optim_loss: 176006.2812
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9395; val_auprc_score: 0.9803; val_best_acc_score: 0.9477; val_best_f1_score: 0.9702; train_kl_reg_loss: 1967.7745; train_edge_recon_loss: 77313.1419; train_gene_expr_recon_loss: 101288.2044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180569.1224; train_optim_loss: 180569.1224; val_kl_reg_loss: 1915.1545; val_edge_recon_loss: 78140.0469; val_gene_expr_recon_loss: 102959.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183015.1250; val_optim_loss: 183015.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9432; val_auprc_score: 0.9876; val_best_acc_score: 0.9497; val_best_f1_score: 0.9717; train_kl_reg_loss: 1971.0149; train_edge_recon_loss: 75770.7083; train_gene_expr_recon_loss: 101814.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179556.5833; train_optim_loss: 179556.5833; val_kl_reg_loss: 1910.1328; val_edge_recon_loss: 71316.0469; val_gene_expr_recon_loss: 102958.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176184.6250; val_optim_loss: 176184.6250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9467; val_auprc_score: 0.9848; val_best_acc_score: 0.9493; val_best_f1_score: 0.9710; train_kl_reg_loss: 1970.9809; train_edge_recon_loss: 76849.4779; train_gene_expr_recon_loss: 101357.4089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180177.8698; train_optim_loss: 180177.8698; val_kl_reg_loss: 1917.9562; val_edge_recon_loss: 78972.0859; val_gene_expr_recon_loss: 102956.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183846.4062; val_optim_loss: 183846.4062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9332; val_auprc_score: 0.9786; val_best_acc_score: 0.9485; val_best_f1_score: 0.9705; train_kl_reg_loss: 1968.6878; train_edge_recon_loss: 78200.4323; train_gene_expr_recon_loss: 101246.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181415.2083; train_optim_loss: 181415.2083; val_kl_reg_loss: 1912.8706; val_edge_recon_loss: 76504.4844; val_gene_expr_recon_loss: 102956.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181373.4688; val_optim_loss: 181373.4688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9505; val_auprc_score: 0.9881; val_best_acc_score: 0.9496; val_best_f1_score: 0.9709; train_kl_reg_loss: 1969.0629; train_edge_recon_loss: 77981.9766; train_gene_expr_recon_loss: 101554.8346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181505.8750; train_optim_loss: 181505.8750; val_kl_reg_loss: 1917.3489; val_edge_recon_loss: 78433.7109; val_gene_expr_recon_loss: 102955.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183306.9531; val_optim_loss: 183306.9531
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9370; val_auprc_score: 0.9836; val_best_acc_score: 0.9376; val_best_f1_score: 0.9644; train_kl_reg_loss: 1964.2760; train_edge_recon_loss: 78101.4284; train_gene_expr_recon_loss: 101231.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181297.3724; train_optim_loss: 181297.3724; val_kl_reg_loss: 1915.8530; val_edge_recon_loss: 83939.9922; val_gene_expr_recon_loss: 102955.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188811.5156; val_optim_loss: 188811.5156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 33 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9420
Val AUPRC score: 0.9846
Val best accuracy score: 0.9481
Val best F1 score: 0.9703
Val gene expr MSE score: 1.2732
Duration of model training in run 4: 0 hours, 0 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9378; val_auprc_score: 0.9851; val_best_acc_score: 0.9321; val_best_f1_score: 0.9607; train_kl_reg_loss: 216.6767; train_edge_recon_loss: 100797.8022; train_gene_expr_recon_loss: 120363.8418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221378.3232; train_optim_loss: 221378.3232; val_kl_reg_loss: 151.5015; val_edge_recon_loss: 101434.5938; val_gene_expr_recon_loss: 107518.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209104.1875; val_optim_loss: 209104.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8463; val_auprc_score: 0.9640; val_best_acc_score: 0.8940; val_best_f1_score: 0.9411; train_kl_reg_loss: 269.1854; train_edge_recon_loss: 100199.7241; train_gene_expr_recon_loss: 108559.2476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209028.1572; train_optim_loss: 209028.1572; val_kl_reg_loss: 593.9959; val_edge_recon_loss: 92761.5195; val_gene_expr_recon_loss: 105571.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198927.1641; val_optim_loss: 198927.1641
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8515; val_auprc_score: 0.9654; val_best_acc_score: 0.8908; val_best_f1_score: 0.9385; train_kl_reg_loss: 1347.6014; train_edge_recon_loss: 92034.8931; train_gene_expr_recon_loss: 106407.6255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199790.1201; train_optim_loss: 199790.1201; val_kl_reg_loss: 1968.7314; val_edge_recon_loss: 90213.8867; val_gene_expr_recon_loss: 104532.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196715.5547; val_optim_loss: 196715.5547
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9008; val_auprc_score: 0.9725; val_best_acc_score: 0.9178; val_best_f1_score: 0.9530; train_kl_reg_loss: 2354.1218; train_edge_recon_loss: 84718.6133; train_gene_expr_recon_loss: 105550.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192623.1602; train_optim_loss: 192623.1602; val_kl_reg_loss: 2407.2954; val_edge_recon_loss: 83439.1055; val_gene_expr_recon_loss: 103116.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188963.0703; val_optim_loss: 188963.0703
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9309; val_auprc_score: 0.9851; val_best_acc_score: 0.9300; val_best_f1_score: 0.9598; train_kl_reg_loss: 2330.2901; train_edge_recon_loss: 81702.0879; train_gene_expr_recon_loss: 105122.0757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189154.4521; train_optim_loss: 189154.4521; val_kl_reg_loss: 1976.5996; val_edge_recon_loss: 78093.4336; val_gene_expr_recon_loss: 103900.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183970.4688; val_optim_loss: 183970.4688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9260; val_auprc_score: 0.9779; val_best_acc_score: 0.9390; val_best_f1_score: 0.9648; train_kl_reg_loss: 1941.0744; train_edge_recon_loss: 79145.6362; train_gene_expr_recon_loss: 104448.0132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185534.7256; train_optim_loss: 185534.7256; val_kl_reg_loss: 1925.3849; val_edge_recon_loss: 80872.1523; val_gene_expr_recon_loss: 103152.6992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185950.2422; val_optim_loss: 185950.2422
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9431; val_auprc_score: 0.9853; val_best_acc_score: 0.9440; val_best_f1_score: 0.9675; train_kl_reg_loss: 1970.8064; train_edge_recon_loss: 79542.7275; train_gene_expr_recon_loss: 103964.3228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185477.8564; train_optim_loss: 185477.8564; val_kl_reg_loss: 1902.7043; val_edge_recon_loss: 81000.8555; val_gene_expr_recon_loss: 102204.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185108.5000; val_optim_loss: 185108.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9556; val_auprc_score: 0.9863; val_best_acc_score: 0.9529; val_best_f1_score: 0.9725; train_kl_reg_loss: 1945.1938; train_edge_recon_loss: 78987.1006; train_gene_expr_recon_loss: 103321.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184253.7539; train_optim_loss: 184253.7539; val_kl_reg_loss: 1871.7655; val_edge_recon_loss: 78412.9023; val_gene_expr_recon_loss: 101827.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182112.0547; val_optim_loss: 182112.0547
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9531; val_auprc_score: 0.9866; val_best_acc_score: 0.9554; val_best_f1_score: 0.9742; train_kl_reg_loss: 1907.2153; train_edge_recon_loss: 79286.6079; train_gene_expr_recon_loss: 102808.7007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184002.5225; train_optim_loss: 184002.5225; val_kl_reg_loss: 1889.8746; val_edge_recon_loss: 76969.0156; val_gene_expr_recon_loss: 101644.8789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180503.7656; val_optim_loss: 180503.7656
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9563; val_auprc_score: 0.9892; val_best_acc_score: 0.9535; val_best_f1_score: 0.9732; train_kl_reg_loss: 1924.5425; train_edge_recon_loss: 78441.9893; train_gene_expr_recon_loss: 102352.3213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182718.8545; train_optim_loss: 182718.8545; val_kl_reg_loss: 1886.1192; val_edge_recon_loss: 78250.9844; val_gene_expr_recon_loss: 100777.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180914.7969; val_optim_loss: 180914.7969
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9525; val_auprc_score: 0.9869; val_best_acc_score: 0.9498; val_best_f1_score: 0.9710; train_kl_reg_loss: 1899.4480; train_edge_recon_loss: 80430.2373; train_gene_expr_recon_loss: 102068.8369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184398.5215; train_optim_loss: 184398.5215; val_kl_reg_loss: 1843.9026; val_edge_recon_loss: 81847.9961; val_gene_expr_recon_loss: 100761.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184453.1484; val_optim_loss: 184453.1484
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9553; val_auprc_score: 0.9904; val_best_acc_score: 0.9560; val_best_f1_score: 0.9748; train_kl_reg_loss: 1897.2236; train_edge_recon_loss: 77004.5508; train_gene_expr_recon_loss: 102100.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181002.1572; train_optim_loss: 181002.1572; val_kl_reg_loss: 1862.5960; val_edge_recon_loss: 73575.5625; val_gene_expr_recon_loss: 99254.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174692.8906; val_optim_loss: 174692.8906
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9532; val_auprc_score: 0.9839; val_best_acc_score: 0.9569; val_best_f1_score: 0.9753; train_kl_reg_loss: 1895.8457; train_edge_recon_loss: 79213.7212; train_gene_expr_recon_loss: 101639.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182749.2051; train_optim_loss: 182749.2051; val_kl_reg_loss: 1889.2099; val_edge_recon_loss: 76949.0898; val_gene_expr_recon_loss: 99437.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178276.0312; val_optim_loss: 178276.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9584; val_auprc_score: 0.9879; val_best_acc_score: 0.9594; val_best_f1_score: 0.9765; train_kl_reg_loss: 1920.0968; train_edge_recon_loss: 79330.7534; train_gene_expr_recon_loss: 101261.8335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182512.6797; train_optim_loss: 182512.6797; val_kl_reg_loss: 1819.3772; val_edge_recon_loss: 77013.5508; val_gene_expr_recon_loss: 99082.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177915.8672; val_optim_loss: 177915.8672
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9556; val_auprc_score: 0.9904; val_best_acc_score: 0.9554; val_best_f1_score: 0.9744; train_kl_reg_loss: 1901.5747; train_edge_recon_loss: 78048.4268; train_gene_expr_recon_loss: 100999.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180949.0996; train_optim_loss: 180949.0996; val_kl_reg_loss: 1918.2863; val_edge_recon_loss: 76056.0938; val_gene_expr_recon_loss: 99282.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177257.0625; val_optim_loss: 177257.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9617; val_auprc_score: 0.9909; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 1945.8867; train_edge_recon_loss: 77981.0464; train_gene_expr_recon_loss: 100865.7261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180792.6572; train_optim_loss: 180792.6572; val_kl_reg_loss: 1907.9117; val_edge_recon_loss: 77948.0625; val_gene_expr_recon_loss: 99309.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179165.6797; val_optim_loss: 179165.6797
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9546; val_auprc_score: 0.9883; val_best_acc_score: 0.9529; val_best_f1_score: 0.9725; train_kl_reg_loss: 1933.5219; train_edge_recon_loss: 76923.2124; train_gene_expr_recon_loss: 101059.9634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179916.6973; train_optim_loss: 179916.6973; val_kl_reg_loss: 1883.5776; val_edge_recon_loss: 83561.3242; val_gene_expr_recon_loss: 98951.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184396.2656; val_optim_loss: 184396.2656
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9560; val_auprc_score: 0.9884; val_best_acc_score: 0.9541; val_best_f1_score: 0.9735; train_kl_reg_loss: 1911.9405; train_edge_recon_loss: 76471.7944; train_gene_expr_recon_loss: 100769.0479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179152.7852; train_optim_loss: 179152.7852; val_kl_reg_loss: 1867.1540; val_edge_recon_loss: 79470.4844; val_gene_expr_recon_loss: 99379.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180717.5391; val_optim_loss: 180717.5391

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 25 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9543
Val AUPRC score: 0.9872
Val best accuracy score: 0.9554
Val best F1 score: 0.9744
Val gene expr MSE score: 1.0885
Duration of model training in run 5: 0 hours, 0 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9311; val_auprc_score: 0.9839; val_best_acc_score: 0.9135; val_best_f1_score: 0.9498; train_kl_reg_loss: 190.0476; train_edge_recon_loss: 100588.8804; train_gene_expr_recon_loss: 119748.6357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220527.5635; train_optim_loss: 220527.5635; val_kl_reg_loss: 141.4667; val_edge_recon_loss: 115422.9180; val_gene_expr_recon_loss: 110085.3164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225649.6953; val_optim_loss: 225649.6953
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8501; val_auprc_score: 0.9636; val_best_acc_score: 0.8927; val_best_f1_score: 0.9405; train_kl_reg_loss: 284.7338; train_edge_recon_loss: 98132.2905; train_gene_expr_recon_loss: 107271.8833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205688.9053; train_optim_loss: 205688.9053; val_kl_reg_loss: 713.2840; val_edge_recon_loss: 93571.1953; val_gene_expr_recon_loss: 107210.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201494.5781; val_optim_loss: 201494.5781
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8622; val_auprc_score: 0.9689; val_best_acc_score: 0.8989; val_best_f1_score: 0.9433; train_kl_reg_loss: 1409.5082; train_edge_recon_loss: 90515.6714; train_gene_expr_recon_loss: 105286.7832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197211.9629; train_optim_loss: 197211.9629; val_kl_reg_loss: 1765.0704; val_edge_recon_loss: 89485.8516; val_gene_expr_recon_loss: 106507.2461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197758.1641; val_optim_loss: 197758.1641
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8958; val_auprc_score: 0.9769; val_best_acc_score: 0.9079; val_best_f1_score: 0.9483; train_kl_reg_loss: 1860.0180; train_edge_recon_loss: 86781.4736; train_gene_expr_recon_loss: 104233.1938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192874.6865; train_optim_loss: 192874.6865; val_kl_reg_loss: 2169.0837; val_edge_recon_loss: 82758.0391; val_gene_expr_recon_loss: 105721.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190648.4062; val_optim_loss: 190648.4062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9101; val_auprc_score: 0.9749; val_best_acc_score: 0.9272; val_best_f1_score: 0.9582; train_kl_reg_loss: 2338.3147; train_edge_recon_loss: 79979.9673; train_gene_expr_recon_loss: 103670.0283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185988.3105; train_optim_loss: 185988.3105; val_kl_reg_loss: 2218.0690; val_edge_recon_loss: 81005.1680; val_gene_expr_recon_loss: 104925.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188148.2578; val_optim_loss: 188148.2578
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9247; val_auprc_score: 0.9810; val_best_acc_score: 0.9304; val_best_f1_score: 0.9602; train_kl_reg_loss: 1968.5905; train_edge_recon_loss: 80323.0166; train_gene_expr_recon_loss: 103109.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185400.6611; train_optim_loss: 185400.6611; val_kl_reg_loss: 1848.5891; val_edge_recon_loss: 81752.6602; val_gene_expr_recon_loss: 104806.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188407.7969; val_optim_loss: 188407.7969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9405; val_auprc_score: 0.9824; val_best_acc_score: 0.9372; val_best_f1_score: 0.9637; train_kl_reg_loss: 1944.5386; train_edge_recon_loss: 78991.3760; train_gene_expr_recon_loss: 102461.1299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183397.0449; train_optim_loss: 183397.0449; val_kl_reg_loss: 1957.0273; val_edge_recon_loss: 83657.1445; val_gene_expr_recon_loss: 104377.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189992.1328; val_optim_loss: 189992.1328
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9451; val_auprc_score: 0.9832; val_best_acc_score: 0.9504; val_best_f1_score: 0.9717; train_kl_reg_loss: 1895.7787; train_edge_recon_loss: 80184.5449; train_gene_expr_recon_loss: 101897.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183977.6328; train_optim_loss: 183977.6328; val_kl_reg_loss: 1894.2285; val_edge_recon_loss: 74946.0312; val_gene_expr_recon_loss: 103592.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180433.1406; val_optim_loss: 180433.1406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9463; val_auprc_score: 0.9866; val_best_acc_score: 0.9520; val_best_f1_score: 0.9724; train_kl_reg_loss: 1942.6604; train_edge_recon_loss: 79410.0308; train_gene_expr_recon_loss: 101671.5654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183024.2559; train_optim_loss: 183024.2559; val_kl_reg_loss: 1906.3861; val_edge_recon_loss: 78617.0352; val_gene_expr_recon_loss: 102667.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183190.4531; val_optim_loss: 183190.4531
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9457; val_auprc_score: 0.9852; val_best_acc_score: 0.9507; val_best_f1_score: 0.9717; train_kl_reg_loss: 1902.7170; train_edge_recon_loss: 79017.6597; train_gene_expr_recon_loss: 101082.2002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182002.5762; train_optim_loss: 182002.5762; val_kl_reg_loss: 1912.5049; val_edge_recon_loss: 78013.9336; val_gene_expr_recon_loss: 103385.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183311.6953; val_optim_loss: 183311.6953
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9504; val_auprc_score: 0.9857; val_best_acc_score: 0.9542; val_best_f1_score: 0.9734; train_kl_reg_loss: 1941.0166; train_edge_recon_loss: 78777.7412; train_gene_expr_recon_loss: 100891.7471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181610.5049; train_optim_loss: 181610.5049; val_kl_reg_loss: 1936.9615; val_edge_recon_loss: 82804.6406; val_gene_expr_recon_loss: 102771.9648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187513.5703; val_optim_loss: 187513.5703

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9500; val_auprc_score: 0.9849; val_best_acc_score: 0.9538; val_best_f1_score: 0.9734; train_kl_reg_loss: 1947.9034; train_edge_recon_loss: 78509.2007; train_gene_expr_recon_loss: 100478.5254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180935.6309; train_optim_loss: 180935.6309; val_kl_reg_loss: 1922.4533; val_edge_recon_loss: 78826.9648; val_gene_expr_recon_loss: 102395.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183144.9766; val_optim_loss: 183144.9766
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9585; val_auprc_score: 0.9879; val_best_acc_score: 0.9607; val_best_f1_score: 0.9774; train_kl_reg_loss: 1921.7471; train_edge_recon_loss: 76343.7729; train_gene_expr_recon_loss: 100251.7358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178517.2568; train_optim_loss: 178517.2568; val_kl_reg_loss: 1892.6074; val_edge_recon_loss: 75702.2891; val_gene_expr_recon_loss: 102487.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180082.1328; val_optim_loss: 180082.1328
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9562; val_auprc_score: 0.9878; val_best_acc_score: 0.9554; val_best_f1_score: 0.9744; train_kl_reg_loss: 1912.1490; train_edge_recon_loss: 79054.2012; train_gene_expr_recon_loss: 100396.3218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181362.6719; train_optim_loss: 181362.6719; val_kl_reg_loss: 1894.6705; val_edge_recon_loss: 76376.9570; val_gene_expr_recon_loss: 102490.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180761.7500; val_optim_loss: 180761.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9623; val_auprc_score: 0.9914; val_best_acc_score: 0.9593; val_best_f1_score: 0.9765; train_kl_reg_loss: 1907.7020; train_edge_recon_loss: 78623.7554; train_gene_expr_recon_loss: 100198.6826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180730.1387; train_optim_loss: 180730.1387; val_kl_reg_loss: 1885.3032; val_edge_recon_loss: 79602.7305; val_gene_expr_recon_loss: 102809.7227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184297.7578; val_optim_loss: 184297.7578
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9598; val_auprc_score: 0.9879; val_best_acc_score: 0.9567; val_best_f1_score: 0.9751; train_kl_reg_loss: 1910.9528; train_edge_recon_loss: 77734.7344; train_gene_expr_recon_loss: 100148.6543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179794.3418; train_optim_loss: 179794.3418; val_kl_reg_loss: 1894.1548; val_edge_recon_loss: 78371.1367; val_gene_expr_recon_loss: 102750.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183015.8750; val_optim_loss: 183015.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9527; val_auprc_score: 0.9857; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 1913.7262; train_edge_recon_loss: 78356.5908; train_gene_expr_recon_loss: 100233.7056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180504.0225; train_optim_loss: 180504.0225; val_kl_reg_loss: 1892.5425; val_edge_recon_loss: 79857.8594; val_gene_expr_recon_loss: 102308.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184058.4297; val_optim_loss: 184058.4297
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9583; val_auprc_score: 0.9895; val_best_acc_score: 0.9566; val_best_f1_score: 0.9751; train_kl_reg_loss: 1914.0704; train_edge_recon_loss: 78488.6914; train_gene_expr_recon_loss: 100326.2358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180728.9951; train_optim_loss: 180728.9951; val_kl_reg_loss: 1891.6918; val_edge_recon_loss: 77794.8711; val_gene_expr_recon_loss: 101900.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181586.9219; val_optim_loss: 181586.9219
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9572; val_auprc_score: 0.9901; val_best_acc_score: 0.9560; val_best_f1_score: 0.9746; train_kl_reg_loss: 1908.2524; train_edge_recon_loss: 78691.5728; train_gene_expr_recon_loss: 100311.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180910.8398; train_optim_loss: 180910.8398; val_kl_reg_loss: 1895.6710; val_edge_recon_loss: 79313.3203; val_gene_expr_recon_loss: 102421.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183630.8906; val_optim_loss: 183630.8906

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 26 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9480
Val AUPRC score: 0.9841
Val best accuracy score: 0.9547
Val best F1 score: 0.9739
Val gene expr MSE score: 1.1773
Duration of model training in run 6: 0 hours, 0 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8541; val_auprc_score: 0.9660; val_best_acc_score: 0.8909; val_best_f1_score: 0.9394; train_kl_reg_loss: 363.1908; train_edge_recon_loss: 99576.5723; train_gene_expr_recon_loss: 114003.1010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213942.8634; train_optim_loss: 213942.8634; val_kl_reg_loss: 1018.5575; val_edge_recon_loss: 94816.9578; val_gene_expr_recon_loss: 106348.4937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202184.0094; val_optim_loss: 202184.0094
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9199; val_auprc_score: 0.9794; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 1733.8813; train_edge_recon_loss: 88035.7373; train_gene_expr_recon_loss: 106432.4577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196202.0770; train_optim_loss: 196202.0770; val_kl_reg_loss: 2216.2472; val_edge_recon_loss: 82494.2031; val_gene_expr_recon_loss: 104608.3922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189318.8438; val_optim_loss: 189318.8438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9436; val_auprc_score: 0.9854; val_best_acc_score: 0.9414; val_best_f1_score: 0.9663; train_kl_reg_loss: 1998.5485; train_edge_recon_loss: 78850.9773; train_gene_expr_recon_loss: 104875.4019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185724.9284; train_optim_loss: 185724.9284; val_kl_reg_loss: 1925.5610; val_edge_recon_loss: 77975.8266; val_gene_expr_recon_loss: 103501.0047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183402.3875; val_optim_loss: 183402.3875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9504; val_auprc_score: 0.9887; val_best_acc_score: 0.9540; val_best_f1_score: 0.9735; train_kl_reg_loss: 1906.3968; train_edge_recon_loss: 78938.6853; train_gene_expr_recon_loss: 103615.8755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184460.9571; train_optim_loss: 184460.9571; val_kl_reg_loss: 1850.0157; val_edge_recon_loss: 77279.2391; val_gene_expr_recon_loss: 102595.7641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181725.0187; val_optim_loss: 181725.0187
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9529; val_auprc_score: 0.9834; val_best_acc_score: 0.9579; val_best_f1_score: 0.9756; train_kl_reg_loss: 1891.3029; train_edge_recon_loss: 78033.8424; train_gene_expr_recon_loss: 102849.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182774.9644; train_optim_loss: 182774.9644; val_kl_reg_loss: 1824.2306; val_edge_recon_loss: 78152.5047; val_gene_expr_recon_loss: 101843.2984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181820.0344; val_optim_loss: 181820.0344
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9573; val_auprc_score: 0.9878; val_best_acc_score: 0.9561; val_best_f1_score: 0.9746; train_kl_reg_loss: 1864.6134; train_edge_recon_loss: 79052.1744; train_gene_expr_recon_loss: 102148.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183065.2911; train_optim_loss: 183065.2911; val_kl_reg_loss: 1856.0666; val_edge_recon_loss: 81282.6062; val_gene_expr_recon_loss: 101150.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184289.5156; val_optim_loss: 184289.5156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9479; val_auprc_score: 0.9835; val_best_acc_score: 0.9587; val_best_f1_score: 0.9763; train_kl_reg_loss: 1894.5025; train_edge_recon_loss: 79155.2803; train_gene_expr_recon_loss: 101452.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182502.3299; train_optim_loss: 182502.3299; val_kl_reg_loss: 1849.5505; val_edge_recon_loss: 76594.3125; val_gene_expr_recon_loss: 100790.4797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179234.3438; val_optim_loss: 179234.3438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9529; val_auprc_score: 0.9868; val_best_acc_score: 0.9555; val_best_f1_score: 0.9744; train_kl_reg_loss: 1873.1622; train_edge_recon_loss: 78902.9632; train_gene_expr_recon_loss: 100966.4281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181742.5534; train_optim_loss: 181742.5534; val_kl_reg_loss: 1894.8464; val_edge_recon_loss: 79145.2469; val_gene_expr_recon_loss: 99804.5531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180844.6469; val_optim_loss: 180844.6469
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9560; val_auprc_score: 0.9862; val_best_acc_score: 0.9592; val_best_f1_score: 0.9765; train_kl_reg_loss: 1881.4972; train_edge_recon_loss: 78289.8937; train_gene_expr_recon_loss: 100386.3276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180557.7184; train_optim_loss: 180557.7184; val_kl_reg_loss: 1917.1727; val_edge_recon_loss: 78640.2922; val_gene_expr_recon_loss: 99278.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179835.9125; val_optim_loss: 179835.9125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9568; val_auprc_score: 0.9875; val_best_acc_score: 0.9625; val_best_f1_score: 0.9783; train_kl_reg_loss: 1894.3704; train_edge_recon_loss: 78476.8616; train_gene_expr_recon_loss: 99994.9148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180366.1468; train_optim_loss: 180366.1468; val_kl_reg_loss: 1840.0217; val_edge_recon_loss: 79446.4484; val_gene_expr_recon_loss: 99276.2766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180562.7437; val_optim_loss: 180562.7437

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9609; val_auprc_score: 0.9892; val_best_acc_score: 0.9650; val_best_f1_score: 0.9798; train_kl_reg_loss: 1865.3339; train_edge_recon_loss: 78213.7878; train_gene_expr_recon_loss: 99555.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179634.9909; train_optim_loss: 179634.9909; val_kl_reg_loss: 1842.8216; val_edge_recon_loss: 77661.4828; val_gene_expr_recon_loss: 99199.3391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178703.6469; val_optim_loss: 178703.6469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9611; val_auprc_score: 0.9890; val_best_acc_score: 0.9641; val_best_f1_score: 0.9792; train_kl_reg_loss: 1880.1798; train_edge_recon_loss: 78543.8356; train_gene_expr_recon_loss: 99370.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179794.4004; train_optim_loss: 179794.4004; val_kl_reg_loss: 1853.5821; val_edge_recon_loss: 78327.2641; val_gene_expr_recon_loss: 98737.8656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178918.7094; val_optim_loss: 178918.7094
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9526; val_auprc_score: 0.9870; val_best_acc_score: 0.9607; val_best_f1_score: 0.9776; train_kl_reg_loss: 1879.2195; train_edge_recon_loss: 75936.0985; train_gene_expr_recon_loss: 99240.5489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177055.8659; train_optim_loss: 177055.8659; val_kl_reg_loss: 1846.9937; val_edge_recon_loss: 74267.3891; val_gene_expr_recon_loss: 99075.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175189.3875; val_optim_loss: 175189.3875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9592; val_auprc_score: 0.9869; val_best_acc_score: 0.9629; val_best_f1_score: 0.9786; train_kl_reg_loss: 1857.8749; train_edge_recon_loss: 77651.2275; train_gene_expr_recon_loss: 99233.8654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178742.9695; train_optim_loss: 178742.9695; val_kl_reg_loss: 1847.8471; val_edge_recon_loss: 78022.9328; val_gene_expr_recon_loss: 98776.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178647.4531; val_optim_loss: 178647.4531
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9608; val_auprc_score: 0.9902; val_best_acc_score: 0.9627; val_best_f1_score: 0.9786; train_kl_reg_loss: 1866.2926; train_edge_recon_loss: 77980.0710; train_gene_expr_recon_loss: 99149.9391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178996.3034; train_optim_loss: 178996.3034; val_kl_reg_loss: 1853.9793; val_edge_recon_loss: 76802.3047; val_gene_expr_recon_loss: 98617.3266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177273.6125; val_optim_loss: 177273.6125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9566; val_auprc_score: 0.9861; val_best_acc_score: 0.9648; val_best_f1_score: 0.9798; train_kl_reg_loss: 1877.4668; train_edge_recon_loss: 77164.6453; train_gene_expr_recon_loss: 99004.8581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178046.9717; train_optim_loss: 178046.9717; val_kl_reg_loss: 1852.8896; val_edge_recon_loss: 75897.5594; val_gene_expr_recon_loss: 98670.6938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176421.1437; val_optim_loss: 176421.1437

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9650; val_auprc_score: 0.9904; val_best_acc_score: 0.9680; val_best_f1_score: 0.9816; train_kl_reg_loss: 1868.5052; train_edge_recon_loss: 77793.5703; train_gene_expr_recon_loss: 98948.5480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178610.6232; train_optim_loss: 178610.6232; val_kl_reg_loss: 1847.8524; val_edge_recon_loss: 74986.0266; val_gene_expr_recon_loss: 98356.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175190.4656; val_optim_loss: 175190.4656
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9647; val_auprc_score: 0.9908; val_best_acc_score: 0.9676; val_best_f1_score: 0.9815; train_kl_reg_loss: 1869.0039; train_edge_recon_loss: 78323.6641; train_gene_expr_recon_loss: 99130.2033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179322.8717; train_optim_loss: 179322.8717; val_kl_reg_loss: 1847.0192; val_edge_recon_loss: 72590.7047; val_gene_expr_recon_loss: 98648.7141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173086.4406; val_optim_loss: 173086.4406
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9620; val_auprc_score: 0.9893; val_best_acc_score: 0.9640; val_best_f1_score: 0.9792; train_kl_reg_loss: 1871.4552; train_edge_recon_loss: 78742.1868; train_gene_expr_recon_loss: 99110.5325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179724.1755; train_optim_loss: 179724.1755; val_kl_reg_loss: 1847.4559; val_edge_recon_loss: 78841.3813; val_gene_expr_recon_loss: 98495.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179183.9781; val_optim_loss: 179183.9781
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9667; val_auprc_score: 0.9891; val_best_acc_score: 0.9682; val_best_f1_score: 0.9816; train_kl_reg_loss: 1871.1074; train_edge_recon_loss: 77701.9941; train_gene_expr_recon_loss: 99135.8596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178708.9608; train_optim_loss: 178708.9608; val_kl_reg_loss: 1849.3731; val_edge_recon_loss: 77582.6187; val_gene_expr_recon_loss: 98718.8328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178150.8281; val_optim_loss: 178150.8281
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9637; val_auprc_score: 0.9867; val_best_acc_score: 0.9691; val_best_f1_score: 0.9821; train_kl_reg_loss: 1869.5487; train_edge_recon_loss: 77416.2198; train_gene_expr_recon_loss: 98987.9758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178273.7453; train_optim_loss: 178273.7453; val_kl_reg_loss: 1850.6835; val_edge_recon_loss: 76681.7234; val_gene_expr_recon_loss: 98587.4891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177119.8969; val_optim_loss: 177119.8969

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9552; val_auprc_score: 0.9824; val_best_acc_score: 0.9641; val_best_f1_score: 0.9791; train_kl_reg_loss: 1869.4746; train_edge_recon_loss: 78676.2980; train_gene_expr_recon_loss: 99123.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179669.6730; train_optim_loss: 179669.6730; val_kl_reg_loss: 1847.7969; val_edge_recon_loss: 80267.8188; val_gene_expr_recon_loss: 98159.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180275.2406; val_optim_loss: 180275.2406
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9688; val_auprc_score: 0.9928; val_best_acc_score: 0.9689; val_best_f1_score: 0.9820; train_kl_reg_loss: 1868.0188; train_edge_recon_loss: 75192.5375; train_gene_expr_recon_loss: 98978.6003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176039.1562; train_optim_loss: 176039.1562; val_kl_reg_loss: 1846.4452; val_edge_recon_loss: 78199.4187; val_gene_expr_recon_loss: 98805.6969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178851.5594; val_optim_loss: 178851.5594
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9654; val_auprc_score: 0.9904; val_best_acc_score: 0.9650; val_best_f1_score: 0.9798; train_kl_reg_loss: 1868.4268; train_edge_recon_loss: 78702.2051; train_gene_expr_recon_loss: 99131.5387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179702.1715; train_optim_loss: 179702.1715; val_kl_reg_loss: 1847.4051; val_edge_recon_loss: 76967.7063; val_gene_expr_recon_loss: 98442.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177257.4031; val_optim_loss: 177257.4031

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 54 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9624
Val AUPRC score: 0.9886
Val best accuracy score: 0.9669
Val best F1 score: 0.9808
Val gene expr MSE score: 1.0138
Duration of model training in run 7: 0 hours, 0 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8577; val_auprc_score: 0.9689; val_best_acc_score: 0.8904; val_best_f1_score: 0.9392; train_kl_reg_loss: 329.8647; train_edge_recon_loss: 98172.2113; train_gene_expr_recon_loss: 112981.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211483.0941; train_optim_loss: 211483.0941; val_kl_reg_loss: 1109.9776; val_edge_recon_loss: 94998.9812; val_gene_expr_recon_loss: 108254.8719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204363.8312; val_optim_loss: 204363.8312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9082; val_auprc_score: 0.9748; val_best_acc_score: 0.9207; val_best_f1_score: 0.9547; train_kl_reg_loss: 1798.8408; train_edge_recon_loss: 85890.4499; train_gene_expr_recon_loss: 105545.7211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193235.0113; train_optim_loss: 193235.0113; val_kl_reg_loss: 2023.5308; val_edge_recon_loss: 84051.6562; val_gene_expr_recon_loss: 106458.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192533.2781; val_optim_loss: 192533.2781
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9369; val_auprc_score: 0.9850; val_best_acc_score: 0.9449; val_best_f1_score: 0.9684; train_kl_reg_loss: 1957.4738; train_edge_recon_loss: 80739.0716; train_gene_expr_recon_loss: 104291.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186988.1061; train_optim_loss: 186988.1061; val_kl_reg_loss: 1953.8565; val_edge_recon_loss: 78259.6766; val_gene_expr_recon_loss: 105148.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185362.4906; val_optim_loss: 185362.4906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9421; val_auprc_score: 0.9834; val_best_acc_score: 0.9475; val_best_f1_score: 0.9698; train_kl_reg_loss: 1931.7238; train_edge_recon_loss: 81011.2323; train_gene_expr_recon_loss: 103062.0285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186004.9862; train_optim_loss: 186004.9862; val_kl_reg_loss: 1948.2063; val_edge_recon_loss: 80702.6719; val_gene_expr_recon_loss: 104257.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186908.7844; val_optim_loss: 186908.7844
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9475; val_auprc_score: 0.9832; val_best_acc_score: 0.9518; val_best_f1_score: 0.9720; train_kl_reg_loss: 1886.8517; train_edge_recon_loss: 79292.4202; train_gene_expr_recon_loss: 102290.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183469.8939; train_optim_loss: 183469.8939; val_kl_reg_loss: 1881.4451; val_edge_recon_loss: 85738.6906; val_gene_expr_recon_loss: 103474.0109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191094.1500; val_optim_loss: 191094.1500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9541; val_auprc_score: 0.9883; val_best_acc_score: 0.9550; val_best_f1_score: 0.9739; train_kl_reg_loss: 1887.6845; train_edge_recon_loss: 79165.5354; train_gene_expr_recon_loss: 101559.6508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182612.8717; train_optim_loss: 182612.8717; val_kl_reg_loss: 1877.8774; val_edge_recon_loss: 78995.6984; val_gene_expr_recon_loss: 102756.5688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183630.1437; val_optim_loss: 183630.1437
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9637; val_auprc_score: 0.9904; val_best_acc_score: 0.9539; val_best_f1_score: 0.9734; train_kl_reg_loss: 1892.3002; train_edge_recon_loss: 78631.4546; train_gene_expr_recon_loss: 100870.4152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181394.1690; train_optim_loss: 181394.1690; val_kl_reg_loss: 1840.4624; val_edge_recon_loss: 81791.1922; val_gene_expr_recon_loss: 102087.2531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185718.9062; val_optim_loss: 185718.9062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9613; val_auprc_score: 0.9919; val_best_acc_score: 0.9642; val_best_f1_score: 0.9796; train_kl_reg_loss: 1880.5224; train_edge_recon_loss: 77652.0182; train_gene_expr_recon_loss: 100358.5129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179891.0534; train_optim_loss: 179891.0534; val_kl_reg_loss: 1842.0231; val_edge_recon_loss: 70206.4641; val_gene_expr_recon_loss: 102122.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174171.4844; val_optim_loss: 174171.4844
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9683; val_auprc_score: 0.9918; val_best_acc_score: 0.9645; val_best_f1_score: 0.9796; train_kl_reg_loss: 1885.1659; train_edge_recon_loss: 78589.7000; train_gene_expr_recon_loss: 99759.6268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180234.4924; train_optim_loss: 180234.4924; val_kl_reg_loss: 1864.6160; val_edge_recon_loss: 73448.4453; val_gene_expr_recon_loss: 101042.2922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176355.3563; val_optim_loss: 176355.3563
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9643; val_auprc_score: 0.9896; val_best_acc_score: 0.9627; val_best_f1_score: 0.9783; train_kl_reg_loss: 1870.4732; train_edge_recon_loss: 77992.7661; train_gene_expr_recon_loss: 99381.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179245.0498; train_optim_loss: 179245.0498; val_kl_reg_loss: 1867.2903; val_edge_recon_loss: 79524.1875; val_gene_expr_recon_loss: 101204.7922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182596.2687; val_optim_loss: 182596.2687
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9578; val_auprc_score: 0.9865; val_best_acc_score: 0.9606; val_best_f1_score: 0.9773; train_kl_reg_loss: 1878.9572; train_edge_recon_loss: 77124.9945; train_gene_expr_recon_loss: 99130.5160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178134.4655; train_optim_loss: 178134.4655; val_kl_reg_loss: 1796.6318; val_edge_recon_loss: 78548.3125; val_gene_expr_recon_loss: 100486.3484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180831.2938; val_optim_loss: 180831.2938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9681; val_auprc_score: 0.9910; val_best_acc_score: 0.9625; val_best_f1_score: 0.9782; train_kl_reg_loss: 1835.6322; train_edge_recon_loss: 78323.4896; train_gene_expr_recon_loss: 98612.9411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178772.0632; train_optim_loss: 178772.0632; val_kl_reg_loss: 1824.8340; val_edge_recon_loss: 79706.6047; val_gene_expr_recon_loss: 100367.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181898.9875; val_optim_loss: 181898.9875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9635; val_auprc_score: 0.9896; val_best_acc_score: 0.9616; val_best_f1_score: 0.9778; train_kl_reg_loss: 1857.4956; train_edge_recon_loss: 77500.8205; train_gene_expr_recon_loss: 98431.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177790.2369; train_optim_loss: 177790.2369; val_kl_reg_loss: 1861.4005; val_edge_recon_loss: 78669.3422; val_gene_expr_recon_loss: 100288.6453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180819.3875; val_optim_loss: 180819.3875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9617; val_auprc_score: 0.9886; val_best_acc_score: 0.9633; val_best_f1_score: 0.9785; train_kl_reg_loss: 1878.5696; train_edge_recon_loss: 78077.6975; train_gene_expr_recon_loss: 98356.3806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178312.6497; train_optim_loss: 178312.6497; val_kl_reg_loss: 1849.3225; val_edge_recon_loss: 81298.7406; val_gene_expr_recon_loss: 100498.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183646.5375; val_optim_loss: 183646.5375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 32 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9541
Val AUPRC score: 0.9878
Val best accuracy score: 0.9555
Val best F1 score: 0.9744
Val gene expr MSE score: 1.1187
Duration of model training in run 8: 0 hours, 0 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8467; val_auprc_score: 0.9651; val_best_acc_score: 0.9023; val_best_f1_score: 0.9455; train_kl_reg_loss: 524.9299; train_edge_recon_loss: 97926.7221; train_gene_expr_recon_loss: 111532.2158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209983.8676; train_optim_loss: 209983.8676; val_kl_reg_loss: 1404.9915; val_edge_recon_loss: 86180.0938; val_gene_expr_recon_loss: 102925.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190510.2109; val_optim_loss: 190510.2109
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9276; val_auprc_score: 0.9789; val_best_acc_score: 0.9341; val_best_f1_score: 0.9622; train_kl_reg_loss: 2018.4425; train_edge_recon_loss: 83795.1424; train_gene_expr_recon_loss: 105450.0106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191263.5955; train_optim_loss: 191263.5955; val_kl_reg_loss: 1975.8669; val_edge_recon_loss: 79042.2982; val_gene_expr_recon_loss: 101375.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182393.2865; val_optim_loss: 182393.2865
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9436; val_auprc_score: 0.9842; val_best_acc_score: 0.9474; val_best_f1_score: 0.9696; train_kl_reg_loss: 1873.5988; train_edge_recon_loss: 80021.4609; train_gene_expr_recon_loss: 103877.8393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185772.9001; train_optim_loss: 185772.9001; val_kl_reg_loss: 1842.1143; val_edge_recon_loss: 82843.3060; val_gene_expr_recon_loss: 100162.5690; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184847.9896; val_optim_loss: 184847.9896
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9482; val_auprc_score: 0.9856; val_best_acc_score: 0.9514; val_best_f1_score: 0.9720; train_kl_reg_loss: 1928.8146; train_edge_recon_loss: 79440.1938; train_gene_expr_recon_loss: 102626.3675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183995.3753; train_optim_loss: 183995.3753; val_kl_reg_loss: 1917.3330; val_edge_recon_loss: 78021.3893; val_gene_expr_recon_loss: 99384.0026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179322.7214; val_optim_loss: 179322.7214
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9424; val_auprc_score: 0.9835; val_best_acc_score: 0.9585; val_best_f1_score: 0.9764; train_kl_reg_loss: 1908.5272; train_edge_recon_loss: 79559.3607; train_gene_expr_recon_loss: 101780.0613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183247.9496; train_optim_loss: 183247.9496; val_kl_reg_loss: 1829.9118; val_edge_recon_loss: 72876.1315; val_gene_expr_recon_loss: 98503.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173209.1797; val_optim_loss: 173209.1797
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9480; val_auprc_score: 0.9842; val_best_acc_score: 0.9554; val_best_f1_score: 0.9743; train_kl_reg_loss: 1870.3689; train_edge_recon_loss: 77374.9689; train_gene_expr_recon_loss: 101019.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180265.1910; train_optim_loss: 180265.1910; val_kl_reg_loss: 1872.4226; val_edge_recon_loss: 78525.5443; val_gene_expr_recon_loss: 97892.3034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178290.2734; val_optim_loss: 178290.2734
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9479; val_auprc_score: 0.9846; val_best_acc_score: 0.9555; val_best_f1_score: 0.9745; train_kl_reg_loss: 1866.4744; train_edge_recon_loss: 78801.4748; train_gene_expr_recon_loss: 100502.0080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181169.9570; train_optim_loss: 181169.9570; val_kl_reg_loss: 1807.6014; val_edge_recon_loss: 77160.2383; val_gene_expr_recon_loss: 97088.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176056.2969; val_optim_loss: 176056.2969
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9603; val_auprc_score: 0.9906; val_best_acc_score: 0.9617; val_best_f1_score: 0.9779; train_kl_reg_loss: 1867.3886; train_edge_recon_loss: 79359.5226; train_gene_expr_recon_loss: 99798.1428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181025.0542; train_optim_loss: 181025.0542; val_kl_reg_loss: 1869.9852; val_edge_recon_loss: 76226.8984; val_gene_expr_recon_loss: 96848.2122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174945.0964; val_optim_loss: 174945.0964

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9617; val_auprc_score: 0.9888; val_best_acc_score: 0.9647; val_best_f1_score: 0.9796; train_kl_reg_loss: 1882.6591; train_edge_recon_loss: 78338.6930; train_gene_expr_recon_loss: 99396.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179618.1471; train_optim_loss: 179618.1471; val_kl_reg_loss: 1875.2226; val_edge_recon_loss: 75786.9896; val_gene_expr_recon_loss: 96276.4805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173938.6901; val_optim_loss: 173938.6901
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9625; val_auprc_score: 0.9886; val_best_acc_score: 0.9600; val_best_f1_score: 0.9769; train_kl_reg_loss: 1876.7737; train_edge_recon_loss: 78333.7546; train_gene_expr_recon_loss: 98941.2065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179151.7341; train_optim_loss: 179151.7341; val_kl_reg_loss: 1853.5947; val_edge_recon_loss: 78877.5599; val_gene_expr_recon_loss: 96793.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177524.6953; val_optim_loss: 177524.6953
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9704; val_auprc_score: 0.9912; val_best_acc_score: 0.9646; val_best_f1_score: 0.9795; train_kl_reg_loss: 1868.0787; train_edge_recon_loss: 78301.1763; train_gene_expr_recon_loss: 99076.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179245.6990; train_optim_loss: 179245.6990; val_kl_reg_loss: 1855.5985; val_edge_recon_loss: 75743.1211; val_gene_expr_recon_loss: 96591.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174190.3672; val_optim_loss: 174190.3672

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 32 sec.
Using best model state, which was in epoch 5.

--- MODEL EVALUATION ---
Val AUROC score: 0.9608
Val AUPRC score: 0.9892
Val best accuracy score: 0.9569
Val best F1 score: 0.9751
Val gene expr MSE score: 1.0741
Duration of model training in run 9: 0 hours, 0 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8646; val_auprc_score: 0.9686; val_best_acc_score: 0.9044; val_best_f1_score: 0.9468; train_kl_reg_loss: 577.7458; train_edge_recon_loss: 97782.4922; train_gene_expr_recon_loss: 111919.4124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210279.6509; train_optim_loss: 210279.6509; val_kl_reg_loss: 1597.7789; val_edge_recon_loss: 86023.0924; val_gene_expr_recon_loss: 107010.9674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194631.8411; val_optim_loss: 194631.8411
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9281; val_auprc_score: 0.9817; val_best_acc_score: 0.9358; val_best_f1_score: 0.9633; train_kl_reg_loss: 1910.0418; train_edge_recon_loss: 82462.3843; train_gene_expr_recon_loss: 105359.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189731.5015; train_optim_loss: 189731.5015; val_kl_reg_loss: 1898.7937; val_edge_recon_loss: 79377.4688; val_gene_expr_recon_loss: 105767.0091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187043.2682; val_optim_loss: 187043.2682
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9477; val_auprc_score: 0.9852; val_best_acc_score: 0.9520; val_best_f1_score: 0.9724; train_kl_reg_loss: 1926.3835; train_edge_recon_loss: 79541.9913; train_gene_expr_recon_loss: 103781.0184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185249.3927; train_optim_loss: 185249.3927; val_kl_reg_loss: 1805.3029; val_edge_recon_loss: 75462.7474; val_gene_expr_recon_loss: 104165.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181433.2552; val_optim_loss: 181433.2552
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9477; val_auprc_score: 0.9852; val_best_acc_score: 0.9533; val_best_f1_score: 0.9731; train_kl_reg_loss: 1856.0223; train_edge_recon_loss: 77085.5862; train_gene_expr_recon_loss: 102631.0310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181572.6400; train_optim_loss: 181572.6400; val_kl_reg_loss: 1807.4351; val_edge_recon_loss: 78132.0091; val_gene_expr_recon_loss: 102878.1120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182817.5625; val_optim_loss: 182817.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9561; val_auprc_score: 0.9861; val_best_acc_score: 0.9557; val_best_f1_score: 0.9744; train_kl_reg_loss: 1851.2130; train_edge_recon_loss: 79385.6433; train_gene_expr_recon_loss: 101751.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182988.1524; train_optim_loss: 182988.1524; val_kl_reg_loss: 1819.4744; val_edge_recon_loss: 78969.7135; val_gene_expr_recon_loss: 102267.0404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183056.2318; val_optim_loss: 183056.2318
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9499; val_auprc_score: 0.9855; val_best_acc_score: 0.9546; val_best_f1_score: 0.9738; train_kl_reg_loss: 1849.2272; train_edge_recon_loss: 79545.6689; train_gene_expr_recon_loss: 100981.2195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182376.1153; train_optim_loss: 182376.1153; val_kl_reg_loss: 1808.1336; val_edge_recon_loss: 79324.6094; val_gene_expr_recon_loss: 101820.9909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182953.7370; val_optim_loss: 182953.7370

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9544; val_auprc_score: 0.9873; val_best_acc_score: 0.9580; val_best_f1_score: 0.9759; train_kl_reg_loss: 1835.6309; train_edge_recon_loss: 78487.3563; train_gene_expr_recon_loss: 100311.4739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180634.4602; train_optim_loss: 180634.4602; val_kl_reg_loss: 1840.5501; val_edge_recon_loss: 74991.9531; val_gene_expr_recon_loss: 101118.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177951.4453; val_optim_loss: 177951.4453
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9557; val_auprc_score: 0.9861; val_best_acc_score: 0.9587; val_best_f1_score: 0.9761; train_kl_reg_loss: 1852.6869; train_edge_recon_loss: 78848.9233; train_gene_expr_recon_loss: 100159.3519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180860.9626; train_optim_loss: 180860.9626; val_kl_reg_loss: 1858.3280; val_edge_recon_loss: 76180.9570; val_gene_expr_recon_loss: 101058.5677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179097.8516; val_optim_loss: 179097.8516
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9662; val_auprc_score: 0.9902; val_best_acc_score: 0.9617; val_best_f1_score: 0.9778; train_kl_reg_loss: 1857.1980; train_edge_recon_loss: 79018.9298; train_gene_expr_recon_loss: 100125.8129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181001.9399; train_optim_loss: 181001.9399; val_kl_reg_loss: 1848.0907; val_edge_recon_loss: 76971.9740; val_gene_expr_recon_loss: 101072.5664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179892.6302; val_optim_loss: 179892.6302
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9510; val_auprc_score: 0.9857; val_best_acc_score: 0.9563; val_best_f1_score: 0.9749; train_kl_reg_loss: 1857.8529; train_edge_recon_loss: 78017.9310; train_gene_expr_recon_loss: 99902.9331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179778.7173; train_optim_loss: 179778.7173; val_kl_reg_loss: 1832.3756; val_edge_recon_loss: 76525.0703; val_gene_expr_recon_loss: 101388.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179746.1120; val_optim_loss: 179746.1120

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9597; val_auprc_score: 0.9889; val_best_acc_score: 0.9595; val_best_f1_score: 0.9766; train_kl_reg_loss: 1840.6709; train_edge_recon_loss: 78194.7067; train_gene_expr_recon_loss: 99757.6110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179792.9888; train_optim_loss: 179792.9888; val_kl_reg_loss: 1829.5564; val_edge_recon_loss: 77396.7083; val_gene_expr_recon_loss: 100862.7682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180089.0312; val_optim_loss: 180089.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9602; val_auprc_score: 0.9900; val_best_acc_score: 0.9548; val_best_f1_score: 0.9739; train_kl_reg_loss: 1841.8530; train_edge_recon_loss: 76847.0523; train_gene_expr_recon_loss: 99839.2815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178528.1863; train_optim_loss: 178528.1863; val_kl_reg_loss: 1835.4482; val_edge_recon_loss: 79898.1706; val_gene_expr_recon_loss: 100681.9362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182415.5547; val_optim_loss: 182415.5547
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9638; val_auprc_score: 0.9909; val_best_acc_score: 0.9623; val_best_f1_score: 0.9782; train_kl_reg_loss: 1844.3546; train_edge_recon_loss: 77566.3412; train_gene_expr_recon_loss: 99887.8822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179298.5769; train_optim_loss: 179298.5769; val_kl_reg_loss: 1833.4542; val_edge_recon_loss: 76318.7747; val_gene_expr_recon_loss: 101407.3411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179559.5677; val_optim_loss: 179559.5677

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 38 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.9548
Val AUPRC score: 0.9882
Val best accuracy score: 0.9584
Val best F1 score: 0.9763
Val gene expr MSE score: 1.1163
Duration of model training in run 10: 0 hours, 0 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_223028.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9234; val_auprc_score: 0.9815; val_best_acc_score: 0.9065; val_best_f1_score: 0.9458; train_kl_reg_loss: 66.6448; train_edge_recon_loss: 101034.1172; train_gene_expr_recon_loss: 132564.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233665.6875; train_optim_loss: 233665.6875; val_kl_reg_loss: 143.3962; val_edge_recon_loss: 111567.2266; val_gene_expr_recon_loss: 118611.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230322.5312; val_optim_loss: 230322.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9341; val_auprc_score: 0.9863; val_best_acc_score: 0.9122; val_best_f1_score: 0.9502; train_kl_reg_loss: 208.8950; train_edge_recon_loss: 99466.2285; train_gene_expr_recon_loss: 114406.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214081.6328; train_optim_loss: 214081.6328; val_kl_reg_loss: 239.0364; val_edge_recon_loss: 116316.5547; val_gene_expr_recon_loss: 108955.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225511.4844; val_optim_loss: 225511.4844
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9375; val_auprc_score: 0.9874; val_best_acc_score: 0.9205; val_best_f1_score: 0.9547; train_kl_reg_loss: 211.6884; train_edge_recon_loss: 102165.6094; train_gene_expr_recon_loss: 108094.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210472.2539; train_optim_loss: 210472.2539; val_kl_reg_loss: 150.5036; val_edge_recon_loss: 109458.6719; val_gene_expr_recon_loss: 106331.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215940.5938; val_optim_loss: 215940.5938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9233; val_auprc_score: 0.9844; val_best_acc_score: 0.9146; val_best_f1_score: 0.9515; train_kl_reg_loss: 137.9433; train_edge_recon_loss: 100524.3770; train_gene_expr_recon_loss: 105978.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206640.6523; train_optim_loss: 206640.6523; val_kl_reg_loss: 124.1749; val_edge_recon_loss: 101802.9766; val_gene_expr_recon_loss: 105546.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207473.5156; val_optim_loss: 207473.5156
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8769; val_auprc_score: 0.9710; val_best_acc_score: 0.9051; val_best_f1_score: 0.9463; train_kl_reg_loss: 149.6675; train_edge_recon_loss: 102022.4824; train_gene_expr_recon_loss: 105366.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207538.7344; train_optim_loss: 207538.7344; val_kl_reg_loss: 205.8407; val_edge_recon_loss: 96227.5703; val_gene_expr_recon_loss: 104979.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201413.3750; val_optim_loss: 201413.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8397; val_auprc_score: 0.9617; val_best_acc_score: 0.8942; val_best_f1_score: 0.9415; train_kl_reg_loss: 297.5114; train_edge_recon_loss: 98021.0957; train_gene_expr_recon_loss: 104848.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203167.5703; train_optim_loss: 203167.5703; val_kl_reg_loss: 462.3660; val_edge_recon_loss: 91855.9844; val_gene_expr_recon_loss: 104347.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196665.4688; val_optim_loss: 196665.4688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8517; val_auprc_score: 0.9609; val_best_acc_score: 0.8872; val_best_f1_score: 0.9358; train_kl_reg_loss: 653.8557; train_edge_recon_loss: 93840.5801; train_gene_expr_recon_loss: 104056.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198551.1484; train_optim_loss: 198551.1484; val_kl_reg_loss: 969.5441; val_edge_recon_loss: 95086.1016; val_gene_expr_recon_loss: 103694.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199750.0312; val_optim_loss: 199750.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8488; val_auprc_score: 0.9625; val_best_acc_score: 0.8914; val_best_f1_score: 0.9395; train_kl_reg_loss: 1284.4310; train_edge_recon_loss: 90985.8828; train_gene_expr_recon_loss: 103451.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195721.6406; train_optim_loss: 195721.6406; val_kl_reg_loss: 1746.5830; val_edge_recon_loss: 88502.5859; val_gene_expr_recon_loss: 103139.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193388.7500; val_optim_loss: 193388.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8812; val_auprc_score: 0.9744; val_best_acc_score: 0.8996; val_best_f1_score: 0.9435; train_kl_reg_loss: 2058.5941; train_edge_recon_loss: 85062.1406; train_gene_expr_recon_loss: 102909.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190030.2969; train_optim_loss: 190030.2969; val_kl_reg_loss: 2378.4636; val_edge_recon_loss: 82794.5469; val_gene_expr_recon_loss: 102698.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187871.0938; val_optim_loss: 187871.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8865; val_auprc_score: 0.9755; val_best_acc_score: 0.8937; val_best_f1_score: 0.9406; train_kl_reg_loss: 2587.7897; train_edge_recon_loss: 83101.4082; train_gene_expr_recon_loss: 102540.7676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188229.9648; train_optim_loss: 188229.9648; val_kl_reg_loss: 2722.6753; val_edge_recon_loss: 86179.5078; val_gene_expr_recon_loss: 102414.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191316.5000; val_optim_loss: 191316.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9022; val_auprc_score: 0.9764; val_best_acc_score: 0.9023; val_best_f1_score: 0.9448; train_kl_reg_loss: 2849.7621; train_edge_recon_loss: 80986.7676; train_gene_expr_recon_loss: 102297.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186133.9258; train_optim_loss: 186133.9258; val_kl_reg_loss: 2837.3140; val_edge_recon_loss: 82692.9766; val_gene_expr_recon_loss: 102141.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187672.2656; val_optim_loss: 187672.2656
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9077; val_auprc_score: 0.9794; val_best_acc_score: 0.9060; val_best_f1_score: 0.9466; train_kl_reg_loss: 2866.0631; train_edge_recon_loss: 81401.5020; train_gene_expr_recon_loss: 102003.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186270.6211; train_optim_loss: 186270.6211; val_kl_reg_loss: 2739.9736; val_edge_recon_loss: 82092.4219; val_gene_expr_recon_loss: 101842.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186674.5312; val_optim_loss: 186674.5312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9230; val_auprc_score: 0.9822; val_best_acc_score: 0.9112; val_best_f1_score: 0.9499; train_kl_reg_loss: 2769.8033; train_edge_recon_loss: 80815.0098; train_gene_expr_recon_loss: 101886.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185471.4375; train_optim_loss: 185471.4375; val_kl_reg_loss: 2666.8755; val_edge_recon_loss: 81596.3828; val_gene_expr_recon_loss: 101586.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185849.5781; val_optim_loss: 185849.5781
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9239; val_auprc_score: 0.9799; val_best_acc_score: 0.9130; val_best_f1_score: 0.9499; train_kl_reg_loss: 2655.1429; train_edge_recon_loss: 80319.6543; train_gene_expr_recon_loss: 101505.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184480.2656; train_optim_loss: 184480.2656; val_kl_reg_loss: 2515.9973; val_edge_recon_loss: 85127.0312; val_gene_expr_recon_loss: 101358.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189001.4688; val_optim_loss: 189001.4688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9348; val_auprc_score: 0.9840; val_best_acc_score: 0.9257; val_best_f1_score: 0.9574; train_kl_reg_loss: 2530.3604; train_edge_recon_loss: 78752.5293; train_gene_expr_recon_loss: 101219.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182502.4141; train_optim_loss: 182502.4141; val_kl_reg_loss: 2417.2820; val_edge_recon_loss: 79896.3281; val_gene_expr_recon_loss: 101131.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183445.4375; val_optim_loss: 183445.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9488; val_auprc_score: 0.9888; val_best_acc_score: 0.9352; val_best_f1_score: 0.9629; train_kl_reg_loss: 2424.6766; train_edge_recon_loss: 80384.8867; train_gene_expr_recon_loss: 101138.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183948.4609; train_optim_loss: 183948.4609; val_kl_reg_loss: 2303.8518; val_edge_recon_loss: 75547.1328; val_gene_expr_recon_loss: 100936.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178787.0938; val_optim_loss: 178787.0938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9427; val_auprc_score: 0.9867; val_best_acc_score: 0.9314; val_best_f1_score: 0.9603; train_kl_reg_loss: 2329.5693; train_edge_recon_loss: 79727.8301; train_gene_expr_recon_loss: 100983.6973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183041.0977; train_optim_loss: 183041.0977; val_kl_reg_loss: 2234.1917; val_edge_recon_loss: 81512.7969; val_gene_expr_recon_loss: 100749.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184496.9062; val_optim_loss: 184496.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9435; val_auprc_score: 0.9869; val_best_acc_score: 0.9382; val_best_f1_score: 0.9642; train_kl_reg_loss: 2263.7358; train_edge_recon_loss: 80716.6777; train_gene_expr_recon_loss: 100589.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183570.0586; train_optim_loss: 183570.0586; val_kl_reg_loss: 2215.4648; val_edge_recon_loss: 79940.7344; val_gene_expr_recon_loss: 100583.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182740.1562; val_optim_loss: 182740.1562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9513; val_auprc_score: 0.9897; val_best_acc_score: 0.9449; val_best_f1_score: 0.9683; train_kl_reg_loss: 2272.6166; train_edge_recon_loss: 78469.5352; train_gene_expr_recon_loss: 100420.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181162.7852; train_optim_loss: 181162.7852; val_kl_reg_loss: 2230.7729; val_edge_recon_loss: 74214.4844; val_gene_expr_recon_loss: 100403.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176848.2500; val_optim_loss: 176848.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9506; val_auprc_score: 0.9864; val_best_acc_score: 0.9439; val_best_f1_score: 0.9674; train_kl_reg_loss: 2279.1262; train_edge_recon_loss: 78755.8594; train_gene_expr_recon_loss: 100319.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181354.8789; train_optim_loss: 181354.8789; val_kl_reg_loss: 2219.9856; val_edge_recon_loss: 77463.7969; val_gene_expr_recon_loss: 100227.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179911.6875; val_optim_loss: 179911.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9529; val_auprc_score: 0.9888; val_best_acc_score: 0.9399; val_best_f1_score: 0.9650; train_kl_reg_loss: 2264.1663; train_edge_recon_loss: 77550.3105; train_gene_expr_recon_loss: 99965.6973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179780.1797; train_optim_loss: 179780.1797; val_kl_reg_loss: 2197.8486; val_edge_recon_loss: 81779.1250; val_gene_expr_recon_loss: 100045.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184022.5312; val_optim_loss: 184022.5312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9554; val_auprc_score: 0.9880; val_best_acc_score: 0.9469; val_best_f1_score: 0.9691; train_kl_reg_loss: 2235.4743; train_edge_recon_loss: 79002.0273; train_gene_expr_recon_loss: 99972.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181210.1211; train_optim_loss: 181210.1211; val_kl_reg_loss: 2164.0332; val_edge_recon_loss: 79392.6719; val_gene_expr_recon_loss: 99870.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181427.5469; val_optim_loss: 181427.5469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9580; val_auprc_score: 0.9897; val_best_acc_score: 0.9450; val_best_f1_score: 0.9677; train_kl_reg_loss: 2214.7346; train_edge_recon_loss: 79602.4043; train_gene_expr_recon_loss: 99945.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181763.0469; train_optim_loss: 181763.0469; val_kl_reg_loss: 2159.0732; val_edge_recon_loss: 83440.3828; val_gene_expr_recon_loss: 99849.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185448.8438; val_optim_loss: 185448.8438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9579; val_auprc_score: 0.9885; val_best_acc_score: 0.9446; val_best_f1_score: 0.9675; train_kl_reg_loss: 2210.2000; train_edge_recon_loss: 79334.4453; train_gene_expr_recon_loss: 99852.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181397.5781; train_optim_loss: 181397.5781; val_kl_reg_loss: 2156.7063; val_edge_recon_loss: 81475.0859; val_gene_expr_recon_loss: 99828.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183460.6875; val_optim_loss: 183460.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9593; val_auprc_score: 0.9920; val_best_acc_score: 0.9486; val_best_f1_score: 0.9708; train_kl_reg_loss: 2208.4381; train_edge_recon_loss: 78908.4082; train_gene_expr_recon_loss: 99889.4355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181006.2852; train_optim_loss: 181006.2852; val_kl_reg_loss: 2154.0137; val_edge_recon_loss: 71505.9141; val_gene_expr_recon_loss: 99809.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173469.1250; val_optim_loss: 173469.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9565; val_auprc_score: 0.9902; val_best_acc_score: 0.9412; val_best_f1_score: 0.9658; train_kl_reg_loss: 2205.9613; train_edge_recon_loss: 78465.6621; train_gene_expr_recon_loss: 99764.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180436.1953; train_optim_loss: 180436.1953; val_kl_reg_loss: 2148.7212; val_edge_recon_loss: 83455.4453; val_gene_expr_recon_loss: 99790.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185395.0625; val_optim_loss: 185395.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9627; val_auprc_score: 0.9921; val_best_acc_score: 0.9504; val_best_f1_score: 0.9710; train_kl_reg_loss: 2203.8492; train_edge_recon_loss: 79045.4961; train_gene_expr_recon_loss: 99758.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181007.8438; train_optim_loss: 181007.8438; val_kl_reg_loss: 2149.5754; val_edge_recon_loss: 77452.6953; val_gene_expr_recon_loss: 99774.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179376.4688; val_optim_loss: 179376.4688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9562; val_auprc_score: 0.9898; val_best_acc_score: 0.9460; val_best_f1_score: 0.9689; train_kl_reg_loss: 2201.2389; train_edge_recon_loss: 78232.3223; train_gene_expr_recon_loss: 99782.0332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180215.5938; train_optim_loss: 180215.5938; val_kl_reg_loss: 2145.9475; val_edge_recon_loss: 73852.1406; val_gene_expr_recon_loss: 99756.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175754.5312; val_optim_loss: 175754.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9550; val_auprc_score: 0.9894; val_best_acc_score: 0.9411; val_best_f1_score: 0.9661; train_kl_reg_loss: 2197.1659; train_edge_recon_loss: 77336.5879; train_gene_expr_recon_loss: 99686.0176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179219.7656; train_optim_loss: 179219.7656; val_kl_reg_loss: 2149.3909; val_edge_recon_loss: 80987.0000; val_gene_expr_recon_loss: 99754.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182890.9688; val_optim_loss: 182890.9688
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9601; val_auprc_score: 0.9919; val_best_acc_score: 0.9463; val_best_f1_score: 0.9688; train_kl_reg_loss: 2200.4654; train_edge_recon_loss: 77458.3340; train_gene_expr_recon_loss: 99860.5371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179519.3320; train_optim_loss: 179519.3320; val_kl_reg_loss: 2144.1714; val_edge_recon_loss: 76465.6250; val_gene_expr_recon_loss: 99752.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178362.3438; val_optim_loss: 178362.3438
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9635; val_auprc_score: 0.9898; val_best_acc_score: 0.9520; val_best_f1_score: 0.9721; train_kl_reg_loss: 2198.3300; train_edge_recon_loss: 78329.2969; train_gene_expr_recon_loss: 99836.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180364.2930; train_optim_loss: 180364.2930; val_kl_reg_loss: 2148.6533; val_edge_recon_loss: 78271.2969; val_gene_expr_recon_loss: 99750.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180170.4375; val_optim_loss: 180170.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9459
Val AUPRC score: 0.9852
Val best accuracy score: 0.9459
Val best F1 score: 0.9692
Val gene expr MSE score: 1.2344
Duration of model training in run 1: 0 hours, 0 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9268; val_auprc_score: 0.9847; val_best_acc_score: 0.9103; val_best_f1_score: 0.9479; train_kl_reg_loss: 74.4437; train_edge_recon_loss: 99964.3105; train_gene_expr_recon_loss: 132587.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232626.7305; train_optim_loss: 232626.7305; val_kl_reg_loss: 151.8102; val_edge_recon_loss: 116953.0312; val_gene_expr_recon_loss: 117133.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234238.4062; val_optim_loss: 234238.4062
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9377; val_auprc_score: 0.9865; val_best_acc_score: 0.9212; val_best_f1_score: 0.9545; train_kl_reg_loss: 214.6701; train_edge_recon_loss: 102572.0000; train_gene_expr_recon_loss: 114550.5254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217337.1992; train_optim_loss: 217337.1992; val_kl_reg_loss: 229.6475; val_edge_recon_loss: 121636.4375; val_gene_expr_recon_loss: 107799.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229665.3125; val_optim_loss: 229665.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9223; val_auprc_score: 0.9822; val_best_acc_score: 0.9217; val_best_f1_score: 0.9558; train_kl_reg_loss: 204.1216; train_edge_recon_loss: 100419.5059; train_gene_expr_recon_loss: 108400.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209023.6680; train_optim_loss: 209023.6680; val_kl_reg_loss: 145.5499; val_edge_recon_loss: 103794.2109; val_gene_expr_recon_loss: 105107.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209047.0938; val_optim_loss: 209047.0938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9028; val_auprc_score: 0.9772; val_best_acc_score: 0.9144; val_best_f1_score: 0.9512; train_kl_reg_loss: 142.1055; train_edge_recon_loss: 102000.2598; train_gene_expr_recon_loss: 106354.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208496.8203; train_optim_loss: 208496.8203; val_kl_reg_loss: 141.8490; val_edge_recon_loss: 106238.7266; val_gene_expr_recon_loss: 104249.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210629.8750; val_optim_loss: 210629.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8679; val_auprc_score: 0.9696; val_best_acc_score: 0.9006; val_best_f1_score: 0.9441; train_kl_reg_loss: 184.2703; train_edge_recon_loss: 98739.0684; train_gene_expr_recon_loss: 105745.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204669.0586; train_optim_loss: 204669.0586; val_kl_reg_loss: 261.8208; val_edge_recon_loss: 98180.1875; val_gene_expr_recon_loss: 103619.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202061.1719; val_optim_loss: 202061.1719
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8585; val_auprc_score: 0.9672; val_best_acc_score: 0.8976; val_best_f1_score: 0.9422; train_kl_reg_loss: 375.5951; train_edge_recon_loss: 97852.3105; train_gene_expr_recon_loss: 104917.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203145.6523; train_optim_loss: 203145.6523; val_kl_reg_loss: 560.3807; val_edge_recon_loss: 91992.5312; val_gene_expr_recon_loss: 102977.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195530.7188; val_optim_loss: 195530.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8409; val_auprc_score: 0.9595; val_best_acc_score: 0.8918; val_best_f1_score: 0.9390; train_kl_reg_loss: 795.6660; train_edge_recon_loss: 91870.1328; train_gene_expr_recon_loss: 104291.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196957.1953; train_optim_loss: 196957.1953; val_kl_reg_loss: 1146.0662; val_edge_recon_loss: 94289.3672; val_gene_expr_recon_loss: 102374.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197810.0312; val_optim_loss: 197810.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8562; val_auprc_score: 0.9655; val_best_acc_score: 0.8920; val_best_f1_score: 0.9398; train_kl_reg_loss: 1500.6340; train_edge_recon_loss: 88441.4141; train_gene_expr_recon_loss: 103383.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193325.3516; train_optim_loss: 193325.3516; val_kl_reg_loss: 1894.6165; val_edge_recon_loss: 88605.0469; val_gene_expr_recon_loss: 101821.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192320.7969; val_optim_loss: 192320.7969
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8703; val_auprc_score: 0.9681; val_best_acc_score: 0.8931; val_best_f1_score: 0.9393; train_kl_reg_loss: 2260.4320; train_edge_recon_loss: 85754.6289; train_gene_expr_recon_loss: 103177.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191192.5000; train_optim_loss: 191192.5000; val_kl_reg_loss: 2549.7974; val_edge_recon_loss: 90307.3281; val_gene_expr_recon_loss: 101423.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194280.6250; val_optim_loss: 194280.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8810; val_auprc_score: 0.9716; val_best_acc_score: 0.8938; val_best_f1_score: 0.9394; train_kl_reg_loss: 2805.3600; train_edge_recon_loss: 81772.6582; train_gene_expr_recon_loss: 102546.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187124.5117; train_optim_loss: 187124.5117; val_kl_reg_loss: 2870.5117; val_edge_recon_loss: 90167.4531; val_gene_expr_recon_loss: 101083.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194121.4688; val_optim_loss: 194121.4688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8865; val_auprc_score: 0.9716; val_best_acc_score: 0.8987; val_best_f1_score: 0.9428; train_kl_reg_loss: 3043.2302; train_edge_recon_loss: 82650.3555; train_gene_expr_recon_loss: 102470.3145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188163.8984; train_optim_loss: 188163.8984; val_kl_reg_loss: 2846.2207; val_edge_recon_loss: 85214.8672; val_gene_expr_recon_loss: 100700.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188761.6719; val_optim_loss: 188761.6719
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9045; val_auprc_score: 0.9798; val_best_acc_score: 0.9062; val_best_f1_score: 0.9474; train_kl_reg_loss: 2937.6469; train_edge_recon_loss: 81850.6406; train_gene_expr_recon_loss: 102081.0020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186869.2891; train_optim_loss: 186869.2891; val_kl_reg_loss: 2724.5605; val_edge_recon_loss: 78872.5000; val_gene_expr_recon_loss: 100406.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182003.4688; val_optim_loss: 182003.4688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9083; val_auprc_score: 0.9795; val_best_acc_score: 0.9126; val_best_f1_score: 0.9505; train_kl_reg_loss: 2801.1917; train_edge_recon_loss: 79771.1660; train_gene_expr_recon_loss: 101634.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184206.9883; train_optim_loss: 184206.9883; val_kl_reg_loss: 2559.4756; val_edge_recon_loss: 80100.5547; val_gene_expr_recon_loss: 100129.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182789.5156; val_optim_loss: 182789.5156
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9227; val_auprc_score: 0.9818; val_best_acc_score: 0.9177; val_best_f1_score: 0.9528; train_kl_reg_loss: 2596.2288; train_edge_recon_loss: 80837.1719; train_gene_expr_recon_loss: 101571.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185004.4180; train_optim_loss: 185004.4180; val_kl_reg_loss: 2360.2778; val_edge_recon_loss: 82437.1875; val_gene_expr_recon_loss: 99887.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184685.3125; val_optim_loss: 184685.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9232; val_auprc_score: 0.9829; val_best_acc_score: 0.9191; val_best_f1_score: 0.9541; train_kl_reg_loss: 2413.1270; train_edge_recon_loss: 80474.7227; train_gene_expr_recon_loss: 101171.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184059.5391; train_optim_loss: 184059.5391; val_kl_reg_loss: 2237.7388; val_edge_recon_loss: 81263.0391; val_gene_expr_recon_loss: 99683.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183183.9375; val_optim_loss: 183183.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9325; val_auprc_score: 0.9850; val_best_acc_score: 0.9230; val_best_f1_score: 0.9565; train_kl_reg_loss: 2334.3104; train_edge_recon_loss: 78006.9160; train_gene_expr_recon_loss: 100854.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181195.6094; train_optim_loss: 181195.6094; val_kl_reg_loss: 2234.0210; val_edge_recon_loss: 77996.8203; val_gene_expr_recon_loss: 99645.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179876.5938; val_optim_loss: 179876.5938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9209; val_auprc_score: 0.9811; val_best_acc_score: 0.9237; val_best_f1_score: 0.9571; train_kl_reg_loss: 2324.2438; train_edge_recon_loss: 80776.0391; train_gene_expr_recon_loss: 100804.3652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183904.6484; train_optim_loss: 183904.6484; val_kl_reg_loss: 2227.3506; val_edge_recon_loss: 76859.4297; val_gene_expr_recon_loss: 99608.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178694.8281; val_optim_loss: 178694.8281
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9229; val_auprc_score: 0.9823; val_best_acc_score: 0.9219; val_best_f1_score: 0.9556; train_kl_reg_loss: 2325.2910; train_edge_recon_loss: 80950.0137; train_gene_expr_recon_loss: 101005.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184280.3984; train_optim_loss: 184280.3984; val_kl_reg_loss: 2237.1772; val_edge_recon_loss: 80105.8906; val_gene_expr_recon_loss: 99581.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181925.0469; val_optim_loss: 181925.0469
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9135; val_auprc_score: 0.9769; val_best_acc_score: 0.9198; val_best_f1_score: 0.9546; train_kl_reg_loss: 2333.0542; train_edge_recon_loss: 78489.3418; train_gene_expr_recon_loss: 101031.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181853.6836; train_optim_loss: 181853.6836; val_kl_reg_loss: 2239.2700; val_edge_recon_loss: 82673.0703; val_gene_expr_recon_loss: 99551.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184464.0000; val_optim_loss: 184464.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9205; val_auprc_score: 0.9808; val_best_acc_score: 0.9147; val_best_f1_score: 0.9512; train_kl_reg_loss: 2333.7226; train_edge_recon_loss: 79535.9492; train_gene_expr_recon_loss: 100881.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182751.4570; train_optim_loss: 182751.4570; val_kl_reg_loss: 2243.2043; val_edge_recon_loss: 84333.3594; val_gene_expr_recon_loss: 99530.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186106.7969; val_optim_loss: 186106.7969

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9397; val_auprc_score: 0.9869; val_best_acc_score: 0.9297; val_best_f1_score: 0.9598; train_kl_reg_loss: 2342.0299; train_edge_recon_loss: 77310.0879; train_gene_expr_recon_loss: 100908.9902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180561.1094; train_optim_loss: 180561.1094; val_kl_reg_loss: 2243.1155; val_edge_recon_loss: 76100.6328; val_gene_expr_recon_loss: 99528.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177872.1719; val_optim_loss: 177872.1719
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9308; val_auprc_score: 0.9822; val_best_acc_score: 0.9204; val_best_f1_score: 0.9536; train_kl_reg_loss: 2340.7952; train_edge_recon_loss: 79949.3340; train_gene_expr_recon_loss: 100678.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182968.7695; train_optim_loss: 182968.7695; val_kl_reg_loss: 2244.3013; val_edge_recon_loss: 83822.8984; val_gene_expr_recon_loss: 99525.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185593.0000; val_optim_loss: 185593.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9195; val_auprc_score: 0.9788; val_best_acc_score: 0.9177; val_best_f1_score: 0.9538; train_kl_reg_loss: 2340.4675; train_edge_recon_loss: 81105.6777; train_gene_expr_recon_loss: 100775.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184221.7383; train_optim_loss: 184221.7383; val_kl_reg_loss: 2246.7607; val_edge_recon_loss: 80969.0000; val_gene_expr_recon_loss: 99522.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182738.4375; val_optim_loss: 182738.4375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9365; val_auprc_score: 0.9861; val_best_acc_score: 0.9235; val_best_f1_score: 0.9566; train_kl_reg_loss: 2343.0367; train_edge_recon_loss: 78928.7559; train_gene_expr_recon_loss: 100952.9980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182224.7891; train_optim_loss: 182224.7891; val_kl_reg_loss: 2247.5083; val_edge_recon_loss: 80251.8672; val_gene_expr_recon_loss: 99519.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182018.8438; val_optim_loss: 182018.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9200; val_auprc_score: 0.9817; val_best_acc_score: 0.9223; val_best_f1_score: 0.9549; train_kl_reg_loss: 2337.6770; train_edge_recon_loss: 81055.9863; train_gene_expr_recon_loss: 100769.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184163.0859; train_optim_loss: 184163.0859; val_kl_reg_loss: 2244.8521; val_edge_recon_loss: 82068.3984; val_gene_expr_recon_loss: 99519.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183832.3906; val_optim_loss: 183832.3906
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9235; val_auprc_score: 0.9823; val_best_acc_score: 0.9182; val_best_f1_score: 0.9527; train_kl_reg_loss: 2342.8463; train_edge_recon_loss: 80035.2617; train_gene_expr_recon_loss: 100992.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183370.7578; train_optim_loss: 183370.7578; val_kl_reg_loss: 2247.2544; val_edge_recon_loss: 83239.1641; val_gene_expr_recon_loss: 99518.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185005.2500; val_optim_loss: 185005.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9276; val_auprc_score: 0.9838; val_best_acc_score: 0.9191; val_best_f1_score: 0.9536; train_kl_reg_loss: 2337.9120; train_edge_recon_loss: 80208.1348; train_gene_expr_recon_loss: 100848.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183395.0156; train_optim_loss: 183395.0156; val_kl_reg_loss: 2246.6885; val_edge_recon_loss: 81165.1641; val_gene_expr_recon_loss: 99518.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182930.3750; val_optim_loss: 182930.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 31 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9267
Val AUPRC score: 0.9831
Val best accuracy score: 0.9204
Val best F1 score: 0.9539
Val gene expr MSE score: 1.2092
Duration of model training in run 2: 0 hours, 0 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9699; val_auprc_score: 0.9938; val_best_acc_score: 0.9431; val_best_f1_score: 0.9665; train_kl_reg_loss: 185.0175; train_edge_recon_loss: 102111.0949; train_gene_expr_recon_loss: 117912.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220208.5190; train_optim_loss: 220208.5190; val_kl_reg_loss: 133.3579; val_edge_recon_loss: 110886.2695; val_gene_expr_recon_loss: 105892.3008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216911.9297; val_optim_loss: 216911.9297
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8786; val_auprc_score: 0.9721; val_best_acc_score: 0.8918; val_best_f1_score: 0.9386; train_kl_reg_loss: 201.7899; train_edge_recon_loss: 99546.5625; train_gene_expr_recon_loss: 105775.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205523.9141; train_optim_loss: 205523.9141; val_kl_reg_loss: 436.6781; val_edge_recon_loss: 101250.7383; val_gene_expr_recon_loss: 102244.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203931.8438; val_optim_loss: 203931.8438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8971; val_auprc_score: 0.9789; val_best_acc_score: 0.9063; val_best_f1_score: 0.9469; train_kl_reg_loss: 1268.3045; train_edge_recon_loss: 90936.5061; train_gene_expr_recon_loss: 103812.2941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196017.1060; train_optim_loss: 196017.1060; val_kl_reg_loss: 2459.8085; val_edge_recon_loss: 84646.7812; val_gene_expr_recon_loss: 102348.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189455.4688; val_optim_loss: 189455.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9276; val_auprc_score: 0.9842; val_best_acc_score: 0.9178; val_best_f1_score: 0.9527; train_kl_reg_loss: 2724.1589; train_edge_recon_loss: 83692.7254; train_gene_expr_recon_loss: 102865.0965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189281.9788; train_optim_loss: 189281.9788; val_kl_reg_loss: 2597.2234; val_edge_recon_loss: 82143.1680; val_gene_expr_recon_loss: 101041.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185781.4062; val_optim_loss: 185781.4062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9520; val_auprc_score: 0.9893; val_best_acc_score: 0.9380; val_best_f1_score: 0.9640; train_kl_reg_loss: 2420.3278; train_edge_recon_loss: 80506.4208; train_gene_expr_recon_loss: 102158.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185085.1295; train_optim_loss: 185085.1295; val_kl_reg_loss: 2206.3823; val_edge_recon_loss: 85088.5078; val_gene_expr_recon_loss: 100489.3242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187784.2109; val_optim_loss: 187784.2109
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9658; val_auprc_score: 0.9923; val_best_acc_score: 0.9554; val_best_f1_score: 0.9743; train_kl_reg_loss: 2212.3376; train_edge_recon_loss: 79965.7667; train_gene_expr_recon_loss: 101582.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183760.7578; train_optim_loss: 183760.7578; val_kl_reg_loss: 2208.4338; val_edge_recon_loss: 77490.5078; val_gene_expr_recon_loss: 99596.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179295.3906; val_optim_loss: 179295.3906
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9662; val_auprc_score: 0.9900; val_best_acc_score: 0.9564; val_best_f1_score: 0.9747; train_kl_reg_loss: 2222.8285; train_edge_recon_loss: 79001.7015; train_gene_expr_recon_loss: 100757.0022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181981.5301; train_optim_loss: 181981.5301; val_kl_reg_loss: 2116.0566; val_edge_recon_loss: 80545.5781; val_gene_expr_recon_loss: 99705.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182367.2031; val_optim_loss: 182367.2031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9785; val_auprc_score: 0.9950; val_best_acc_score: 0.9663; val_best_f1_score: 0.9804; train_kl_reg_loss: 2060.6482; train_edge_recon_loss: 78980.8493; train_gene_expr_recon_loss: 100579.2617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181620.7600; train_optim_loss: 181620.7600; val_kl_reg_loss: 1999.7137; val_edge_recon_loss: 77342.2969; val_gene_expr_recon_loss: 100010.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179352.7500; val_optim_loss: 179352.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9782; val_auprc_score: 0.9949; val_best_acc_score: 0.9695; val_best_f1_score: 0.9823; train_kl_reg_loss: 2083.4966; train_edge_recon_loss: 79405.7461; train_gene_expr_recon_loss: 100307.6468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181796.8895; train_optim_loss: 181796.8895; val_kl_reg_loss: 2029.8592; val_edge_recon_loss: 76863.7383; val_gene_expr_recon_loss: 98741.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177634.8281; val_optim_loss: 177634.8281
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9760; val_auprc_score: 0.9944; val_best_acc_score: 0.9700; val_best_f1_score: 0.9827; train_kl_reg_loss: 2048.7446; train_edge_recon_loss: 78103.1613; train_gene_expr_recon_loss: 99717.2662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179869.1708; train_optim_loss: 179869.1708; val_kl_reg_loss: 2044.9823; val_edge_recon_loss: 77229.3828; val_gene_expr_recon_loss: 98762.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178036.3828; val_optim_loss: 178036.3828
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9731; val_auprc_score: 0.9923; val_best_acc_score: 0.9666; val_best_f1_score: 0.9807; train_kl_reg_loss: 2065.3633; train_edge_recon_loss: 78421.2009; train_gene_expr_recon_loss: 99231.4994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179718.0647; train_optim_loss: 179718.0647; val_kl_reg_loss: 2031.9801; val_edge_recon_loss: 78405.5117; val_gene_expr_recon_loss: 98206.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178644.0625; val_optim_loss: 178644.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9753; val_auprc_score: 0.9931; val_best_acc_score: 0.9682; val_best_f1_score: 0.9814; train_kl_reg_loss: 2021.9098; train_edge_recon_loss: 77384.5218; train_gene_expr_recon_loss: 99037.6925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178444.1217; train_optim_loss: 178444.1217; val_kl_reg_loss: 1993.2058; val_edge_recon_loss: 80400.8281; val_gene_expr_recon_loss: 98346.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180740.3750; val_optim_loss: 180740.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9727; val_auprc_score: 0.9932; val_best_acc_score: 0.9676; val_best_f1_score: 0.9812; train_kl_reg_loss: 2028.6324; train_edge_recon_loss: 77734.0954; train_gene_expr_recon_loss: 98926.3979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178689.1283; train_optim_loss: 178689.1283; val_kl_reg_loss: 1986.4056; val_edge_recon_loss: 80304.5781; val_gene_expr_recon_loss: 98070.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180361.6875; val_optim_loss: 180361.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9791; val_auprc_score: 0.9946; val_best_acc_score: 0.9703; val_best_f1_score: 0.9827; train_kl_reg_loss: 2017.8697; train_edge_recon_loss: 77485.7796; train_gene_expr_recon_loss: 98777.0396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178280.6886; train_optim_loss: 178280.6886; val_kl_reg_loss: 1971.7442; val_edge_recon_loss: 77858.5391; val_gene_expr_recon_loss: 97975.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177805.8438; val_optim_loss: 177805.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9760; val_auprc_score: 0.9926; val_best_acc_score: 0.9673; val_best_f1_score: 0.9809; train_kl_reg_loss: 2014.4104; train_edge_recon_loss: 77434.4916; train_gene_expr_recon_loss: 98940.5720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178389.4721; train_optim_loss: 178389.4721; val_kl_reg_loss: 1967.6221; val_edge_recon_loss: 82990.5586; val_gene_expr_recon_loss: 97552.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182511.1719; val_optim_loss: 182511.1719

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 32 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.9827
Val AUPRC score: 0.9965
Val best accuracy score: 0.9681
Val best F1 score: 0.9814
Val gene expr MSE score: 1.1213
Duration of model training in run 3: 0 hours, 0 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9671; val_auprc_score: 0.9923; val_best_acc_score: 0.9426; val_best_f1_score: 0.9666; train_kl_reg_loss: 145.3512; train_edge_recon_loss: 102293.2757; train_gene_expr_recon_loss: 117478.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219917.2098; train_optim_loss: 219917.2098; val_kl_reg_loss: 112.4067; val_edge_recon_loss: 110227.3477; val_gene_expr_recon_loss: 108566.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218906.0469; val_optim_loss: 218906.0469
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8997; val_auprc_score: 0.9794; val_best_acc_score: 0.9011; val_best_f1_score: 0.9443; train_kl_reg_loss: 195.0907; train_edge_recon_loss: 100458.3393; train_gene_expr_recon_loss: 106947.6763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207601.1083; train_optim_loss: 207601.1083; val_kl_reg_loss: 437.3817; val_edge_recon_loss: 91938.9883; val_gene_expr_recon_loss: 107051.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199428.2734; val_optim_loss: 199428.2734
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8923; val_auprc_score: 0.9752; val_best_acc_score: 0.9013; val_best_f1_score: 0.9443; train_kl_reg_loss: 1291.1604; train_edge_recon_loss: 90524.3153; train_gene_expr_recon_loss: 104786.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196601.6283; train_optim_loss: 196601.6283; val_kl_reg_loss: 2276.4764; val_edge_recon_loss: 86961.9883; val_gene_expr_recon_loss: 104334.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193573.1484; val_optim_loss: 193573.1484
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9291; val_auprc_score: 0.9816; val_best_acc_score: 0.9235; val_best_f1_score: 0.9566; train_kl_reg_loss: 2606.1708; train_edge_recon_loss: 83737.3577; train_gene_expr_recon_loss: 103604.5201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189948.0480; train_optim_loss: 189948.0480; val_kl_reg_loss: 2654.1268; val_edge_recon_loss: 76849.1055; val_gene_expr_recon_loss: 104989.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184492.8516; val_optim_loss: 184492.8516
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9570; val_auprc_score: 0.9907; val_best_acc_score: 0.9437; val_best_f1_score: 0.9676; train_kl_reg_loss: 2502.0940; train_edge_recon_loss: 80870.0988; train_gene_expr_recon_loss: 103123.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186495.5625; train_optim_loss: 186495.5625; val_kl_reg_loss: 2310.8877; val_edge_recon_loss: 79446.5859; val_gene_expr_recon_loss: 103426.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185184.0547; val_optim_loss: 185184.0547
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9580; val_auprc_score: 0.9907; val_best_acc_score: 0.9522; val_best_f1_score: 0.9725; train_kl_reg_loss: 2267.0791; train_edge_recon_loss: 80836.5022; train_gene_expr_recon_loss: 102197.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185301.2600; train_optim_loss: 185301.2600; val_kl_reg_loss: 2174.0864; val_edge_recon_loss: 79751.7578; val_gene_expr_recon_loss: 102854.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184780.2969; val_optim_loss: 184780.2969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9714; val_auprc_score: 0.9928; val_best_acc_score: 0.9593; val_best_f1_score: 0.9765; train_kl_reg_loss: 2227.3463; train_edge_recon_loss: 79782.6657; train_gene_expr_recon_loss: 101622.0725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183632.0826; train_optim_loss: 183632.0826; val_kl_reg_loss: 2200.8248; val_edge_recon_loss: 76462.3477; val_gene_expr_recon_loss: 103654.9492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182318.1250; val_optim_loss: 182318.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9727; val_auprc_score: 0.9926; val_best_acc_score: 0.9639; val_best_f1_score: 0.9791; train_kl_reg_loss: 2191.1458; train_edge_recon_loss: 80143.7104; train_gene_expr_recon_loss: 101213.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183548.2054; train_optim_loss: 183548.2054; val_kl_reg_loss: 2062.8209; val_edge_recon_loss: 76733.6875; val_gene_expr_recon_loss: 101277.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180073.6562; val_optim_loss: 180073.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9694; val_auprc_score: 0.9909; val_best_acc_score: 0.9626; val_best_f1_score: 0.9783; train_kl_reg_loss: 2077.9074; train_edge_recon_loss: 77124.0583; train_gene_expr_recon_loss: 100783.4978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179985.4643; train_optim_loss: 179985.4643; val_kl_reg_loss: 2039.7097; val_edge_recon_loss: 78806.5312; val_gene_expr_recon_loss: 101929.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182776.1719; val_optim_loss: 182776.1719
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9761; val_auprc_score: 0.9939; val_best_acc_score: 0.9652; val_best_f1_score: 0.9799; train_kl_reg_loss: 2086.7956; train_edge_recon_loss: 78298.5017; train_gene_expr_recon_loss: 100216.4325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180601.7310; train_optim_loss: 180601.7310; val_kl_reg_loss: 2075.8740; val_edge_recon_loss: 75919.0312; val_gene_expr_recon_loss: 101020.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179015.4609; val_optim_loss: 179015.4609
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9790; val_auprc_score: 0.9951; val_best_acc_score: 0.9662; val_best_f1_score: 0.9804; train_kl_reg_loss: 2077.0790; train_edge_recon_loss: 78624.1747; train_gene_expr_recon_loss: 99989.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180690.5100; train_optim_loss: 180690.5100; val_kl_reg_loss: 2009.0714; val_edge_recon_loss: 76711.8438; val_gene_expr_recon_loss: 101601.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180321.9766; val_optim_loss: 180321.9766
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9819; val_auprc_score: 0.9953; val_best_acc_score: 0.9695; val_best_f1_score: 0.9822; train_kl_reg_loss: 2044.4590; train_edge_recon_loss: 78322.3571; train_gene_expr_recon_loss: 99797.2679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180164.0826; train_optim_loss: 180164.0826; val_kl_reg_loss: 1956.4066; val_edge_recon_loss: 74921.9961; val_gene_expr_recon_loss: 99887.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176765.8672; val_optim_loss: 176765.8672
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9755; val_auprc_score: 0.9942; val_best_acc_score: 0.9663; val_best_f1_score: 0.9804; train_kl_reg_loss: 2011.7759; train_edge_recon_loss: 78946.5675; train_gene_expr_recon_loss: 99310.0463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180268.3873; train_optim_loss: 180268.3873; val_kl_reg_loss: 2014.7608; val_edge_recon_loss: 78549.1875; val_gene_expr_recon_loss: 99569.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180133.0234; val_optim_loss: 180133.0234
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9720; val_auprc_score: 0.9925; val_best_acc_score: 0.9664; val_best_f1_score: 0.9805; train_kl_reg_loss: 1991.6984; train_edge_recon_loss: 76804.9660; train_gene_expr_recon_loss: 99037.1395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177833.8013; train_optim_loss: 177833.8013; val_kl_reg_loss: 1909.0704; val_edge_recon_loss: 78164.9648; val_gene_expr_recon_loss: 99202.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179276.4062; val_optim_loss: 179276.4062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9781; val_auprc_score: 0.9939; val_best_acc_score: 0.9694; val_best_f1_score: 0.9823; train_kl_reg_loss: 1981.3759; train_edge_recon_loss: 78250.6741; train_gene_expr_recon_loss: 98708.5943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178940.6440; train_optim_loss: 178940.6440; val_kl_reg_loss: 1972.3190; val_edge_recon_loss: 76874.0039; val_gene_expr_recon_loss: 99557.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178404.2109; val_optim_loss: 178404.2109

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9813; val_auprc_score: 0.9932; val_best_acc_score: 0.9689; val_best_f1_score: 0.9819; train_kl_reg_loss: 2005.7856; train_edge_recon_loss: 76122.2768; train_gene_expr_recon_loss: 98620.5999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176748.6641; train_optim_loss: 176748.6641; val_kl_reg_loss: 1956.0318; val_edge_recon_loss: 79101.0391; val_gene_expr_recon_loss: 98330.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179387.4531; val_optim_loss: 179387.4531
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9790; val_auprc_score: 0.9943; val_best_acc_score: 0.9709; val_best_f1_score: 0.9832; train_kl_reg_loss: 1988.4535; train_edge_recon_loss: 77302.0865; train_gene_expr_recon_loss: 98453.8733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177744.4141; train_optim_loss: 177744.4141; val_kl_reg_loss: 1956.6676; val_edge_recon_loss: 75362.2188; val_gene_expr_recon_loss: 99655.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176974.7500; val_optim_loss: 176974.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9753; val_auprc_score: 0.9906; val_best_acc_score: 0.9696; val_best_f1_score: 0.9823; train_kl_reg_loss: 1987.0785; train_edge_recon_loss: 77968.2690; train_gene_expr_recon_loss: 98452.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178407.4654; train_optim_loss: 178407.4654; val_kl_reg_loss: 1929.2818; val_edge_recon_loss: 80025.1836; val_gene_expr_recon_loss: 98387.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180341.5391; val_optim_loss: 180341.5391

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 39 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9766
Val AUPRC score: 0.9946
Val best accuracy score: 0.9662
Val best F1 score: 0.9804
Val gene expr MSE score: 1.1990
Duration of model training in run 4: 0 hours, 0 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8773; val_auprc_score: 0.9709; val_best_acc_score: 0.8928; val_best_f1_score: 0.9395; train_kl_reg_loss: 265.7710; train_edge_recon_loss: 100084.7703; train_gene_expr_recon_loss: 109526.3629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209876.9043; train_optim_loss: 209876.9043; val_kl_reg_loss: 1129.2169; val_edge_recon_loss: 93374.9109; val_gene_expr_recon_loss: 102391.7828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196895.9125; val_optim_loss: 196895.9125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9545; val_auprc_score: 0.9886; val_best_acc_score: 0.9453; val_best_f1_score: 0.9683; train_kl_reg_loss: 2231.7600; train_edge_recon_loss: 83809.1295; train_gene_expr_recon_loss: 102047.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188088.2945; train_optim_loss: 188088.2945; val_kl_reg_loss: 2086.3469; val_edge_recon_loss: 77282.8938; val_gene_expr_recon_loss: 100302.9484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179672.1875; val_optim_loss: 179672.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9679; val_auprc_score: 0.9915; val_best_acc_score: 0.9580; val_best_f1_score: 0.9759; train_kl_reg_loss: 2121.2316; train_edge_recon_loss: 78738.9359; train_gene_expr_recon_loss: 100368.1664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181228.3332; train_optim_loss: 181228.3332; val_kl_reg_loss: 2024.2239; val_edge_recon_loss: 76529.6812; val_gene_expr_recon_loss: 98230.9594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176784.8656; val_optim_loss: 176784.8656
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9775; val_auprc_score: 0.9950; val_best_acc_score: 0.9672; val_best_f1_score: 0.9809; train_kl_reg_loss: 2039.8722; train_edge_recon_loss: 78685.4023; train_gene_expr_recon_loss: 99458.0600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180183.3344; train_optim_loss: 180183.3344; val_kl_reg_loss: 1987.1350; val_edge_recon_loss: 77549.5797; val_gene_expr_recon_loss: 98002.7328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177539.4469; val_optim_loss: 177539.4469
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9762; val_auprc_score: 0.9932; val_best_acc_score: 0.9701; val_best_f1_score: 0.9826; train_kl_reg_loss: 1990.8731; train_edge_recon_loss: 77708.5789; train_gene_expr_recon_loss: 98423.7850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178123.2371; train_optim_loss: 178123.2371; val_kl_reg_loss: 1970.2146; val_edge_recon_loss: 76683.5547; val_gene_expr_recon_loss: 96452.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175106.4937; val_optim_loss: 175106.4937
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9836; val_auprc_score: 0.9959; val_best_acc_score: 0.9723; val_best_f1_score: 0.9839; train_kl_reg_loss: 1973.3888; train_edge_recon_loss: 76566.7207; train_gene_expr_recon_loss: 97690.8936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176231.0027; train_optim_loss: 176231.0027; val_kl_reg_loss: 1927.1584; val_edge_recon_loss: 79883.5016; val_gene_expr_recon_loss: 96786.0188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178596.6781; val_optim_loss: 178596.6781
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9803; val_auprc_score: 0.9945; val_best_acc_score: 0.9716; val_best_f1_score: 0.9835; train_kl_reg_loss: 1946.4401; train_edge_recon_loss: 78352.5373; train_gene_expr_recon_loss: 97020.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177319.4703; train_optim_loss: 177319.4703; val_kl_reg_loss: 1916.6101; val_edge_recon_loss: 78476.0625; val_gene_expr_recon_loss: 95906.8062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176299.4813; val_optim_loss: 176299.4813
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9828; val_auprc_score: 0.9951; val_best_acc_score: 0.9759; val_best_f1_score: 0.9861; train_kl_reg_loss: 1942.6499; train_edge_recon_loss: 77849.5135; train_gene_expr_recon_loss: 96579.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176371.8543; train_optim_loss: 176371.8543; val_kl_reg_loss: 1933.0775; val_edge_recon_loss: 75111.0531; val_gene_expr_recon_loss: 95943.2469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172987.3813; val_optim_loss: 172987.3813
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9821; val_auprc_score: 0.9948; val_best_acc_score: 0.9748; val_best_f1_score: 0.9854; train_kl_reg_loss: 1923.8596; train_edge_recon_loss: 77915.0002; train_gene_expr_recon_loss: 96076.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175915.4988; train_optim_loss: 175915.4988; val_kl_reg_loss: 1937.2059; val_edge_recon_loss: 76447.5078; val_gene_expr_recon_loss: 94887.6938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173272.4031; val_optim_loss: 173272.4031
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9852; val_auprc_score: 0.9966; val_best_acc_score: 0.9755; val_best_f1_score: 0.9858; train_kl_reg_loss: 1923.0258; train_edge_recon_loss: 76420.5998; train_gene_expr_recon_loss: 95723.0225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174066.6500; train_optim_loss: 174066.6500; val_kl_reg_loss: 1880.9857; val_edge_recon_loss: 75804.4219; val_gene_expr_recon_loss: 95092.8266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172778.2344; val_optim_loss: 172778.2344
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9872; val_auprc_score: 0.9963; val_best_acc_score: 0.9767; val_best_f1_score: 0.9865; train_kl_reg_loss: 1907.9835; train_edge_recon_loss: 76278.6260; train_gene_expr_recon_loss: 95232.0906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173418.7004; train_optim_loss: 173418.7004; val_kl_reg_loss: 1904.7695; val_edge_recon_loss: 77834.7797; val_gene_expr_recon_loss: 94414.3391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174153.8875; val_optim_loss: 174153.8875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9826; val_auprc_score: 0.9943; val_best_acc_score: 0.9763; val_best_f1_score: 0.9862; train_kl_reg_loss: 1906.4394; train_edge_recon_loss: 76858.0068; train_gene_expr_recon_loss: 94940.7619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173705.2090; train_optim_loss: 173705.2090; val_kl_reg_loss: 1915.2314; val_edge_recon_loss: 77865.0516; val_gene_expr_recon_loss: 94572.4641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174352.7500; val_optim_loss: 174352.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9822; val_auprc_score: 0.9944; val_best_acc_score: 0.9765; val_best_f1_score: 0.9864; train_kl_reg_loss: 1918.3459; train_edge_recon_loss: 77204.1610; train_gene_expr_recon_loss: 94642.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173764.9953; train_optim_loss: 173764.9953; val_kl_reg_loss: 1896.5789; val_edge_recon_loss: 76230.7109; val_gene_expr_recon_loss: 94398.7406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172526.0312; val_optim_loss: 172526.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9812; val_auprc_score: 0.9932; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 1905.4788; train_edge_recon_loss: 77197.1100; train_gene_expr_recon_loss: 94358.9166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173461.5051; train_optim_loss: 173461.5051; val_kl_reg_loss: 1874.1536; val_edge_recon_loss: 76689.6234; val_gene_expr_recon_loss: 93198.7437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171762.5187; val_optim_loss: 171762.5187
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9852; val_auprc_score: 0.9966; val_best_acc_score: 0.9771; val_best_f1_score: 0.9868; train_kl_reg_loss: 1904.0027; train_edge_recon_loss: 77681.0412; train_gene_expr_recon_loss: 94011.8270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173596.8711; train_optim_loss: 173596.8711; val_kl_reg_loss: 1866.8014; val_edge_recon_loss: 76038.9016; val_gene_expr_recon_loss: 92756.2297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170661.9312; val_optim_loss: 170661.9312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9848; val_auprc_score: 0.9964; val_best_acc_score: 0.9768; val_best_f1_score: 0.9865; train_kl_reg_loss: 1904.0503; train_edge_recon_loss: 77680.5795; train_gene_expr_recon_loss: 93846.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173431.4910; train_optim_loss: 173431.4910; val_kl_reg_loss: 1847.8953; val_edge_recon_loss: 77087.1469; val_gene_expr_recon_loss: 92976.0422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171911.0844; val_optim_loss: 171911.0844
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9851; val_auprc_score: 0.9953; val_best_acc_score: 0.9778; val_best_f1_score: 0.9872; train_kl_reg_loss: 1914.3586; train_edge_recon_loss: 76105.5139; train_gene_expr_recon_loss: 93363.1010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171382.9734; train_optim_loss: 171382.9734; val_kl_reg_loss: 1885.4515; val_edge_recon_loss: 77238.9594; val_gene_expr_recon_loss: 92795.1313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171919.5438; val_optim_loss: 171919.5438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9840; val_auprc_score: 0.9944; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1905.6776; train_edge_recon_loss: 76510.8742; train_gene_expr_recon_loss: 93228.4445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171644.9965; train_optim_loss: 171644.9965; val_kl_reg_loss: 1906.5876; val_edge_recon_loss: 77005.0906; val_gene_expr_recon_loss: 92682.3578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171594.0375; val_optim_loss: 171594.0375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9844; val_auprc_score: 0.9950; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1917.7065; train_edge_recon_loss: 76449.6289; train_gene_expr_recon_loss: 92962.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171329.5230; train_optim_loss: 171329.5230; val_kl_reg_loss: 1884.4531; val_edge_recon_loss: 75031.5578; val_gene_expr_recon_loss: 92227.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169143.0094; val_optim_loss: 169143.0094
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9874; val_auprc_score: 0.9969; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1909.1809; train_edge_recon_loss: 76510.5355; train_gene_expr_recon_loss: 92970.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171389.7719; train_optim_loss: 171389.7719; val_kl_reg_loss: 1883.8602; val_edge_recon_loss: 75252.1766; val_gene_expr_recon_loss: 92269.3141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169405.3500; val_optim_loss: 169405.3500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9854; val_auprc_score: 0.9967; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1915.6299; train_edge_recon_loss: 76063.7740; train_gene_expr_recon_loss: 92885.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170865.0879; train_optim_loss: 170865.0879; val_kl_reg_loss: 1889.8596; val_edge_recon_loss: 76371.0719; val_gene_expr_recon_loss: 92120.2531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170381.1844; val_optim_loss: 170381.1844
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9828; val_auprc_score: 0.9946; val_best_acc_score: 0.9777; val_best_f1_score: 0.9870; train_kl_reg_loss: 1901.1492; train_edge_recon_loss: 76223.0311; train_gene_expr_recon_loss: 92920.7441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171044.9242; train_optim_loss: 171044.9242; val_kl_reg_loss: 1876.9414; val_edge_recon_loss: 77675.3234; val_gene_expr_recon_loss: 92129.5766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171681.8406; val_optim_loss: 171681.8406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9839; val_auprc_score: 0.9928; val_best_acc_score: 0.9779; val_best_f1_score: 0.9872; train_kl_reg_loss: 1902.1438; train_edge_recon_loss: 77261.6801; train_gene_expr_recon_loss: 92653.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171817.1316; train_optim_loss: 171817.1316; val_kl_reg_loss: 1874.0234; val_edge_recon_loss: 77307.6516; val_gene_expr_recon_loss: 91834.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171015.7844; val_optim_loss: 171015.7844
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9859; val_auprc_score: 0.9964; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1902.0124; train_edge_recon_loss: 75689.5158; train_gene_expr_recon_loss: 92809.5840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170401.1125; train_optim_loss: 170401.1125; val_kl_reg_loss: 1874.5066; val_edge_recon_loss: 76361.0125; val_gene_expr_recon_loss: 92147.1812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170382.7000; val_optim_loss: 170382.7000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9877; val_auprc_score: 0.9953; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 1901.9960; train_edge_recon_loss: 76200.2828; train_gene_expr_recon_loss: 92892.1715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170994.4504; train_optim_loss: 170994.4504; val_kl_reg_loss: 1874.2936; val_edge_recon_loss: 75477.1484; val_gene_expr_recon_loss: 92288.8844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169640.3250; val_optim_loss: 169640.3250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 36 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9862
Val AUPRC score: 0.9965
Val best accuracy score: 0.9801
Val best F1 score: 0.9884
Val gene expr MSE score: 0.9219
Duration of model training in run 5: 0 hours, 1 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8845; val_auprc_score: 0.9768; val_best_acc_score: 0.9053; val_best_f1_score: 0.9466; train_kl_reg_loss: 324.5692; train_edge_recon_loss: 99188.1656; train_gene_expr_recon_loss: 109427.5395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208940.2770; train_optim_loss: 208940.2770; val_kl_reg_loss: 1354.2427; val_edge_recon_loss: 85627.0156; val_gene_expr_recon_loss: 104821.8219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191803.0781; val_optim_loss: 191803.0781
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9524; val_auprc_score: 0.9883; val_best_acc_score: 0.9419; val_best_f1_score: 0.9664; train_kl_reg_loss: 2396.0282; train_edge_recon_loss: 83088.0834; train_gene_expr_recon_loss: 102612.4154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188096.5270; train_optim_loss: 188096.5270; val_kl_reg_loss: 2197.9213; val_edge_recon_loss: 80900.3813; val_gene_expr_recon_loss: 102946.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186044.6406; val_optim_loss: 186044.6406
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9708; val_auprc_score: 0.9924; val_best_acc_score: 0.9620; val_best_f1_score: 0.9781; train_kl_reg_loss: 2124.9318; train_edge_recon_loss: 79145.9227; train_gene_expr_recon_loss: 100974.8246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182245.6812; train_optim_loss: 182245.6812; val_kl_reg_loss: 2011.5162; val_edge_recon_loss: 75301.9531; val_gene_expr_recon_loss: 100743.6453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178057.1094; val_optim_loss: 178057.1094
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9790; val_auprc_score: 0.9947; val_best_acc_score: 0.9672; val_best_f1_score: 0.9810; train_kl_reg_loss: 2048.5495; train_edge_recon_loss: 78212.5215; train_gene_expr_recon_loss: 99696.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179957.8129; train_optim_loss: 179957.8129; val_kl_reg_loss: 1984.2733; val_edge_recon_loss: 77369.0484; val_gene_expr_recon_loss: 100060.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179413.6938; val_optim_loss: 179413.6938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9772; val_auprc_score: 0.9942; val_best_acc_score: 0.9700; val_best_f1_score: 0.9826; train_kl_reg_loss: 2006.7119; train_edge_recon_loss: 77415.5070; train_gene_expr_recon_loss: 99024.4725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178446.6922; train_optim_loss: 178446.6922; val_kl_reg_loss: 1978.1161; val_edge_recon_loss: 78587.5609; val_gene_expr_recon_loss: 99382.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179948.2406; val_optim_loss: 179948.2406
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9776; val_auprc_score: 0.9943; val_best_acc_score: 0.9700; val_best_f1_score: 0.9825; train_kl_reg_loss: 1989.3522; train_edge_recon_loss: 77347.1775; train_gene_expr_recon_loss: 98182.6553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177519.1848; train_optim_loss: 177519.1848; val_kl_reg_loss: 1953.6038; val_edge_recon_loss: 79786.5031; val_gene_expr_recon_loss: 98448.9312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180189.0375; val_optim_loss: 180189.0375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9791; val_auprc_score: 0.9933; val_best_acc_score: 0.9720; val_best_f1_score: 0.9837; train_kl_reg_loss: 1978.8577; train_edge_recon_loss: 77051.5916; train_gene_expr_recon_loss: 97567.1025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176597.5535; train_optim_loss: 176597.5535; val_kl_reg_loss: 1941.8180; val_edge_recon_loss: 76930.0672; val_gene_expr_recon_loss: 98479.8844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177351.7656; val_optim_loss: 177351.7656
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9793; val_auprc_score: 0.9948; val_best_acc_score: 0.9709; val_best_f1_score: 0.9831; train_kl_reg_loss: 1972.5396; train_edge_recon_loss: 78397.4180; train_gene_expr_recon_loss: 97333.7270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177703.6844; train_optim_loss: 177703.6844; val_kl_reg_loss: 1941.7242; val_edge_recon_loss: 76268.3453; val_gene_expr_recon_loss: 97877.2312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176087.2969; val_optim_loss: 176087.2969
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9809; val_auprc_score: 0.9944; val_best_acc_score: 0.9740; val_best_f1_score: 0.9849; train_kl_reg_loss: 1983.3448; train_edge_recon_loss: 76956.7408; train_gene_expr_recon_loss: 97350.3334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176290.4195; train_optim_loss: 176290.4195; val_kl_reg_loss: 1938.5053; val_edge_recon_loss: 76596.7625; val_gene_expr_recon_loss: 97890.4859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176425.7500; val_optim_loss: 176425.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9814; val_auprc_score: 0.9952; val_best_acc_score: 0.9717; val_best_f1_score: 0.9835; train_kl_reg_loss: 1964.1145; train_edge_recon_loss: 77662.5830; train_gene_expr_recon_loss: 97360.7314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176987.4277; train_optim_loss: 176987.4277; val_kl_reg_loss: 1932.0818; val_edge_recon_loss: 78735.4734; val_gene_expr_recon_loss: 97885.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178552.9875; val_optim_loss: 178552.9875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9794; val_auprc_score: 0.9937; val_best_acc_score: 0.9701; val_best_f1_score: 0.9827; train_kl_reg_loss: 1954.2484; train_edge_recon_loss: 77038.3119; train_gene_expr_recon_loss: 97068.5811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176061.1422; train_optim_loss: 176061.1422; val_kl_reg_loss: 1925.6351; val_edge_recon_loss: 79099.5984; val_gene_expr_recon_loss: 97954.6594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178979.8875; val_optim_loss: 178979.8875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9816; val_auprc_score: 0.9947; val_best_acc_score: 0.9752; val_best_f1_score: 0.9857; train_kl_reg_loss: 1958.4919; train_edge_recon_loss: 77447.1857; train_gene_expr_recon_loss: 97146.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176551.7102; train_optim_loss: 176551.7102; val_kl_reg_loss: 1927.1534; val_edge_recon_loss: 74405.5156; val_gene_expr_recon_loss: 98217.3266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174549.9937; val_optim_loss: 174549.9937
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9791; val_auprc_score: 0.9939; val_best_acc_score: 0.9722; val_best_f1_score: 0.9838; train_kl_reg_loss: 1958.9630; train_edge_recon_loss: 77469.6992; train_gene_expr_recon_loss: 97265.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176693.9937; train_optim_loss: 176693.9937; val_kl_reg_loss: 1923.4956; val_edge_recon_loss: 78447.1109; val_gene_expr_recon_loss: 97728.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178099.5562; val_optim_loss: 178099.5562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9762; val_auprc_score: 0.9920; val_best_acc_score: 0.9731; val_best_f1_score: 0.9845; train_kl_reg_loss: 1957.6165; train_edge_recon_loss: 76606.7918; train_gene_expr_recon_loss: 97169.2082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175733.6164; train_optim_loss: 175733.6164; val_kl_reg_loss: 1921.8277; val_edge_recon_loss: 75076.7750; val_gene_expr_recon_loss: 97821.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174819.9656; val_optim_loss: 174819.9656
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9810; val_auprc_score: 0.9953; val_best_acc_score: 0.9719; val_best_f1_score: 0.9837; train_kl_reg_loss: 1959.9243; train_edge_recon_loss: 77602.1969; train_gene_expr_recon_loss: 97048.2861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176610.4078; train_optim_loss: 176610.4078; val_kl_reg_loss: 1925.2979; val_edge_recon_loss: 79838.4422; val_gene_expr_recon_loss: 97704.9328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179468.6719; val_optim_loss: 179468.6719

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9765; val_auprc_score: 0.9937; val_best_acc_score: 0.9700; val_best_f1_score: 0.9827; train_kl_reg_loss: 1959.6142; train_edge_recon_loss: 76464.0051; train_gene_expr_recon_loss: 97108.7834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175532.4020; train_optim_loss: 175532.4020; val_kl_reg_loss: 1925.4226; val_edge_recon_loss: 77256.8813; val_gene_expr_recon_loss: 97667.8344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176850.1406; val_optim_loss: 176850.1406
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9781; val_auprc_score: 0.9948; val_best_acc_score: 0.9718; val_best_f1_score: 0.9837; train_kl_reg_loss: 1956.0730; train_edge_recon_loss: 76422.4639; train_gene_expr_recon_loss: 96958.5342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175337.0711; train_optim_loss: 175337.0711; val_kl_reg_loss: 1926.9296; val_edge_recon_loss: 76447.4094; val_gene_expr_recon_loss: 97868.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176242.6562; val_optim_loss: 176242.6562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9775; val_auprc_score: 0.9945; val_best_acc_score: 0.9696; val_best_f1_score: 0.9824; train_kl_reg_loss: 1960.5690; train_edge_recon_loss: 76783.7135; train_gene_expr_recon_loss: 97062.4684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175806.7520; train_optim_loss: 175806.7520; val_kl_reg_loss: 1925.2652; val_edge_recon_loss: 76549.1562; val_gene_expr_recon_loss: 98038.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176513.2656; val_optim_loss: 176513.2656

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 8 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9809
Val AUPRC score: 0.9945
Val best accuracy score: 0.9731
Val best F1 score: 0.9843
Val gene expr MSE score: 1.0177
Duration of model training in run 6: 0 hours, 1 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9565; val_auprc_score: 0.9898; val_best_acc_score: 0.9469; val_best_f1_score: 0.9695; train_kl_reg_loss: 1262.0403; train_edge_recon_loss: 91212.3749; train_gene_expr_recon_loss: 106653.5030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199127.9177; train_optim_loss: 199127.9177; val_kl_reg_loss: 2277.0365; val_edge_recon_loss: 78076.5371; val_gene_expr_recon_loss: 101557.9043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181911.4818; val_optim_loss: 181911.4818
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9730; val_auprc_score: 0.9917; val_best_acc_score: 0.9677; val_best_f1_score: 0.9814; train_kl_reg_loss: 2078.9310; train_edge_recon_loss: 78340.7158; train_gene_expr_recon_loss: 101082.4370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181502.0839; train_optim_loss: 181502.0839; val_kl_reg_loss: 1970.8266; val_edge_recon_loss: 75001.0645; val_gene_expr_recon_loss: 99094.6569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176066.5469; val_optim_loss: 176066.5469
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9796; val_auprc_score: 0.9941; val_best_acc_score: 0.9739; val_best_f1_score: 0.9848; train_kl_reg_loss: 1989.1835; train_edge_recon_loss: 77787.8345; train_gene_expr_recon_loss: 99143.1065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178920.1247; train_optim_loss: 178920.1247; val_kl_reg_loss: 1943.9431; val_edge_recon_loss: 78038.6471; val_gene_expr_recon_loss: 97449.9902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177432.5794; val_optim_loss: 177432.5794
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9833; val_auprc_score: 0.9957; val_best_acc_score: 0.9763; val_best_f1_score: 0.9863; train_kl_reg_loss: 1935.4947; train_edge_recon_loss: 77520.9969; train_gene_expr_recon_loss: 97748.2212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177204.7131; train_optim_loss: 177204.7131; val_kl_reg_loss: 1864.9851; val_edge_recon_loss: 74025.9759; val_gene_expr_recon_loss: 96339.2702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172230.2305; val_optim_loss: 172230.2305
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9844; val_auprc_score: 0.9956; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1895.4330; train_edge_recon_loss: 76608.6931; train_gene_expr_recon_loss: 96749.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175253.7176; train_optim_loss: 175253.7176; val_kl_reg_loss: 1903.3993; val_edge_recon_loss: 75848.1263; val_gene_expr_recon_loss: 95365.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173117.1602; val_optim_loss: 173117.1602
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9831; val_auprc_score: 0.9951; val_best_acc_score: 0.9788; val_best_f1_score: 0.9877; train_kl_reg_loss: 1895.2860; train_edge_recon_loss: 76997.3894; train_gene_expr_recon_loss: 95897.8885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174790.5640; train_optim_loss: 174790.5640; val_kl_reg_loss: 1884.3720; val_edge_recon_loss: 76134.9160; val_gene_expr_recon_loss: 94699.9941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172719.2799; val_optim_loss: 172719.2799
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9850; val_auprc_score: 0.9958; val_best_acc_score: 0.9787; val_best_f1_score: 0.9875; train_kl_reg_loss: 1901.2545; train_edge_recon_loss: 76914.2654; train_gene_expr_recon_loss: 95210.5756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174026.0949; train_optim_loss: 174026.0949; val_kl_reg_loss: 1852.4712; val_edge_recon_loss: 77987.1081; val_gene_expr_recon_loss: 93938.0605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173777.6419; val_optim_loss: 173777.6419

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9867; val_auprc_score: 0.9964; val_best_acc_score: 0.9787; val_best_f1_score: 0.9876; train_kl_reg_loss: 1892.3814; train_edge_recon_loss: 75971.1549; train_gene_expr_recon_loss: 94498.7455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172362.2815; train_optim_loss: 172362.2815; val_kl_reg_loss: 1867.7955; val_edge_recon_loss: 75425.9958; val_gene_expr_recon_loss: 93607.4941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170901.2839; val_optim_loss: 170901.2839
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9865; val_auprc_score: 0.9961; val_best_acc_score: 0.9795; val_best_f1_score: 0.9881; train_kl_reg_loss: 1899.4813; train_edge_recon_loss: 77256.4540; train_gene_expr_recon_loss: 94356.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173512.7537; train_optim_loss: 173512.7537; val_kl_reg_loss: 1888.2685; val_edge_recon_loss: 74879.1178; val_gene_expr_recon_loss: 93601.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170368.4128; val_optim_loss: 170368.4128
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9859; val_auprc_score: 0.9955; val_best_acc_score: 0.9786; val_best_f1_score: 0.9875; train_kl_reg_loss: 1894.6175; train_edge_recon_loss: 76116.2823; train_gene_expr_recon_loss: 94279.7116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172290.6106; train_optim_loss: 172290.6106; val_kl_reg_loss: 1846.5624; val_edge_recon_loss: 77356.4303; val_gene_expr_recon_loss: 93317.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172520.0247; val_optim_loss: 172520.0247
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9853; val_auprc_score: 0.9958; val_best_acc_score: 0.9801; val_best_f1_score: 0.9885; train_kl_reg_loss: 1884.8014; train_edge_recon_loss: 76183.4669; train_gene_expr_recon_loss: 94207.6187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172275.8860; train_optim_loss: 172275.8860; val_kl_reg_loss: 1870.2959; val_edge_recon_loss: 74627.5449; val_gene_expr_recon_loss: 93272.0924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169769.9336; val_optim_loss: 169769.9336
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9873; val_auprc_score: 0.9965; val_best_acc_score: 0.9777; val_best_f1_score: 0.9869; train_kl_reg_loss: 1890.5711; train_edge_recon_loss: 76601.3659; train_gene_expr_recon_loss: 94144.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172635.9531; train_optim_loss: 172635.9531; val_kl_reg_loss: 1864.0628; val_edge_recon_loss: 79286.1895; val_gene_expr_recon_loss: 93344.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174494.8086; val_optim_loss: 174494.8086
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9849; val_auprc_score: 0.9960; val_best_acc_score: 0.9793; val_best_f1_score: 0.9880; train_kl_reg_loss: 1878.1302; train_edge_recon_loss: 76246.5328; train_gene_expr_recon_loss: 94084.3068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172208.9693; train_optim_loss: 172208.9693; val_kl_reg_loss: 1852.7423; val_edge_recon_loss: 76536.7480; val_gene_expr_recon_loss: 93290.8275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171680.3216; val_optim_loss: 171680.3216
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9847; val_auprc_score: 0.9959; val_best_acc_score: 0.9780; val_best_f1_score: 0.9872; train_kl_reg_loss: 1894.4810; train_edge_recon_loss: 75770.5469; train_gene_expr_recon_loss: 94003.3990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171668.4271; train_optim_loss: 171668.4271; val_kl_reg_loss: 1866.2405; val_edge_recon_loss: 77210.5358; val_gene_expr_recon_loss: 93201.9245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172278.7005; val_optim_loss: 172278.7005

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9849; val_auprc_score: 0.9961; val_best_acc_score: 0.9790; val_best_f1_score: 0.9877; train_kl_reg_loss: 1887.5538; train_edge_recon_loss: 75998.3257; train_gene_expr_recon_loss: 93921.1707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171807.0515; train_optim_loss: 171807.0515; val_kl_reg_loss: 1865.7539; val_edge_recon_loss: 77147.4831; val_gene_expr_recon_loss: 93023.6315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172036.8685; val_optim_loss: 172036.8685
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9857; val_auprc_score: 0.9965; val_best_acc_score: 0.9793; val_best_f1_score: 0.9880; train_kl_reg_loss: 1887.9230; train_edge_recon_loss: 76632.9161; train_gene_expr_recon_loss: 93910.9432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172431.7823; train_optim_loss: 172431.7823; val_kl_reg_loss: 1869.3298; val_edge_recon_loss: 76713.7507; val_gene_expr_recon_loss: 93390.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171973.1432; val_optim_loss: 171973.1432
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9831; val_auprc_score: 0.9954; val_best_acc_score: 0.9790; val_best_f1_score: 0.9878; train_kl_reg_loss: 1890.2882; train_edge_recon_loss: 77463.4481; train_gene_expr_recon_loss: 93910.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173264.5914; train_optim_loss: 173264.5914; val_kl_reg_loss: 1869.7092; val_edge_recon_loss: 74922.1094; val_gene_expr_recon_loss: 93170.1999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169962.0182; val_optim_loss: 169962.0182

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 7 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9851
Val AUPRC score: 0.9948
Val best accuracy score: 0.9797
Val best F1 score: 0.9883
Val gene expr MSE score: 0.9366
Duration of model training in run 7: 0 hours, 2 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9601; val_auprc_score: 0.9891; val_best_acc_score: 0.9483; val_best_f1_score: 0.9699; train_kl_reg_loss: 1356.0901; train_edge_recon_loss: 91445.4267; train_gene_expr_recon_loss: 105012.6902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197814.2062; train_optim_loss: 197814.2062; val_kl_reg_loss: 2134.0118; val_edge_recon_loss: 82278.6647; val_gene_expr_recon_loss: 102445.8730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186858.5521; val_optim_loss: 186858.5521
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9723; val_auprc_score: 0.9941; val_best_acc_score: 0.9650; val_best_f1_score: 0.9799; train_kl_reg_loss: 2021.8126; train_edge_recon_loss: 78773.6861; train_gene_expr_recon_loss: 99880.3080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180675.8067; train_optim_loss: 180675.8067; val_kl_reg_loss: 1978.5514; val_edge_recon_loss: 74008.5697; val_gene_expr_recon_loss: 100127.8262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176114.9492; val_optim_loss: 176114.9492
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9769; val_auprc_score: 0.9932; val_best_acc_score: 0.9704; val_best_f1_score: 0.9828; train_kl_reg_loss: 1964.1359; train_edge_recon_loss: 78082.9437; train_gene_expr_recon_loss: 97959.2612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178006.3406; train_optim_loss: 178006.3406; val_kl_reg_loss: 1990.5395; val_edge_recon_loss: 77030.5618; val_gene_expr_recon_loss: 98451.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177472.7383; val_optim_loss: 177472.7383
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9784; val_auprc_score: 0.9930; val_best_acc_score: 0.9715; val_best_f1_score: 0.9834; train_kl_reg_loss: 1932.5919; train_edge_recon_loss: 77562.7279; train_gene_expr_recon_loss: 96705.3791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176200.6990; train_optim_loss: 176200.6990; val_kl_reg_loss: 1882.7911; val_edge_recon_loss: 76969.8848; val_gene_expr_recon_loss: 97333.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176186.0729; val_optim_loss: 176186.0729
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9809; val_auprc_score: 0.9950; val_best_acc_score: 0.9725; val_best_f1_score: 0.9841; train_kl_reg_loss: 1909.7003; train_edge_recon_loss: 76672.3202; train_gene_expr_recon_loss: 95738.4626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174320.4838; train_optim_loss: 174320.4838; val_kl_reg_loss: 1849.1751; val_edge_recon_loss: 77500.0853; val_gene_expr_recon_loss: 96655.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176005.0508; val_optim_loss: 176005.0508
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9818; val_auprc_score: 0.9945; val_best_acc_score: 0.9746; val_best_f1_score: 0.9852; train_kl_reg_loss: 1902.1130; train_edge_recon_loss: 77774.4926; train_gene_expr_recon_loss: 94927.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174604.0780; train_optim_loss: 174604.0780; val_kl_reg_loss: 1877.4416; val_edge_recon_loss: 76967.6725; val_gene_expr_recon_loss: 95911.8802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174756.9961; val_optim_loss: 174756.9961
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9834; val_auprc_score: 0.9948; val_best_acc_score: 0.9782; val_best_f1_score: 0.9873; train_kl_reg_loss: 1892.5873; train_edge_recon_loss: 76687.9255; train_gene_expr_recon_loss: 94298.9315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172879.4448; train_optim_loss: 172879.4448; val_kl_reg_loss: 1879.0677; val_edge_recon_loss: 77668.3040; val_gene_expr_recon_loss: 95234.3757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174781.7461; val_optim_loss: 174781.7461
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9832; val_auprc_score: 0.9945; val_best_acc_score: 0.9782; val_best_f1_score: 0.9873; train_kl_reg_loss: 1890.6426; train_edge_recon_loss: 76863.8231; train_gene_expr_recon_loss: 93716.4315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172470.8970; train_optim_loss: 172470.8970; val_kl_reg_loss: 1896.8563; val_edge_recon_loss: 75131.1615; val_gene_expr_recon_loss: 94785.7767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171813.7956; val_optim_loss: 171813.7956
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9882; val_auprc_score: 0.9975; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1886.8911; train_edge_recon_loss: 76668.2773; train_gene_expr_recon_loss: 93255.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171810.3994; train_optim_loss: 171810.3994; val_kl_reg_loss: 1867.7512; val_edge_recon_loss: 75167.3965; val_gene_expr_recon_loss: 94372.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171407.7018; val_optim_loss: 171407.7018
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9824; val_auprc_score: 0.9933; val_best_acc_score: 0.9805; val_best_f1_score: 0.9887; train_kl_reg_loss: 1898.6989; train_edge_recon_loss: 76531.1574; train_gene_expr_recon_loss: 92777.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171207.5051; train_optim_loss: 171207.5051; val_kl_reg_loss: 1876.0237; val_edge_recon_loss: 76065.8145; val_gene_expr_recon_loss: 93630.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171572.1289; val_optim_loss: 171572.1289
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9869; val_auprc_score: 0.9961; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 1895.1046; train_edge_recon_loss: 76064.9417; train_gene_expr_recon_loss: 92389.6626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170349.7085; train_optim_loss: 170349.7085; val_kl_reg_loss: 1905.9309; val_edge_recon_loss: 73723.8750; val_gene_expr_recon_loss: 93554.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169184.7930; val_optim_loss: 169184.7930
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9897; val_auprc_score: 0.9977; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 1909.7866; train_edge_recon_loss: 76339.3689; train_gene_expr_recon_loss: 92023.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170272.9001; train_optim_loss: 170272.9001; val_kl_reg_loss: 1905.8793; val_edge_recon_loss: 75590.4277; val_gene_expr_recon_loss: 93047.5247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170543.8307; val_optim_loss: 170543.8307
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9871; val_auprc_score: 0.9964; val_best_acc_score: 0.9829; val_best_f1_score: 0.9901; train_kl_reg_loss: 1902.0324; train_edge_recon_loss: 75659.3608; train_gene_expr_recon_loss: 91700.1653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169261.5571; train_optim_loss: 169261.5571; val_kl_reg_loss: 1875.9803; val_edge_recon_loss: 74576.9342; val_gene_expr_recon_loss: 92803.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169256.8737; val_optim_loss: 169256.8737
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9878; val_auprc_score: 0.9963; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 1906.8306; train_edge_recon_loss: 76633.4100; train_gene_expr_recon_loss: 91384.4832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169924.7237; train_optim_loss: 169924.7237; val_kl_reg_loss: 1894.6435; val_edge_recon_loss: 75959.5417; val_gene_expr_recon_loss: 92377.0404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170231.2253; val_optim_loss: 170231.2253

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9874; val_auprc_score: 0.9961; val_best_acc_score: 0.9828; val_best_f1_score: 0.9900; train_kl_reg_loss: 1912.3356; train_edge_recon_loss: 76373.0979; train_gene_expr_recon_loss: 90844.4310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169129.8655; train_optim_loss: 169129.8655; val_kl_reg_loss: 1902.6490; val_edge_recon_loss: 75189.3346; val_gene_expr_recon_loss: 91978.6810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169070.6654; val_optim_loss: 169070.6654
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9895; val_auprc_score: 0.9977; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1915.1499; train_edge_recon_loss: 76050.5374; train_gene_expr_recon_loss: 90724.3052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168689.9926; train_optim_loss: 168689.9926; val_kl_reg_loss: 1888.6397; val_edge_recon_loss: 76673.3672; val_gene_expr_recon_loss: 92108.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170670.4414; val_optim_loss: 170670.4414
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9885; val_auprc_score: 0.9973; val_best_acc_score: 0.9817; val_best_f1_score: 0.9894; train_kl_reg_loss: 1900.7341; train_edge_recon_loss: 76342.9068; train_gene_expr_recon_loss: 90680.1169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168923.7570; train_optim_loss: 168923.7570; val_kl_reg_loss: 1882.5929; val_edge_recon_loss: 74758.9583; val_gene_expr_recon_loss: 92030.6504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168672.2031; val_optim_loss: 168672.2031
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9890; val_auprc_score: 0.9974; val_best_acc_score: 0.9823; val_best_f1_score: 0.9897; train_kl_reg_loss: 1895.0818; train_edge_recon_loss: 75909.4135; train_gene_expr_recon_loss: 90666.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168471.3058; train_optim_loss: 168471.3058; val_kl_reg_loss: 1878.8915; val_edge_recon_loss: 75951.2773; val_gene_expr_recon_loss: 92028.2624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169858.4310; val_optim_loss: 169858.4310
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9835; val_auprc_score: 0.9946; val_best_acc_score: 0.9797; val_best_f1_score: 0.9881; train_kl_reg_loss: 1900.2696; train_edge_recon_loss: 76340.2668; train_gene_expr_recon_loss: 90636.3100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168876.8452; train_optim_loss: 168876.8452; val_kl_reg_loss: 1877.9096; val_edge_recon_loss: 79179.4681; val_gene_expr_recon_loss: 92135.3861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173192.7643; val_optim_loss: 173192.7643
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9845; val_auprc_score: 0.9957; val_best_acc_score: 0.9807; val_best_f1_score: 0.9888; train_kl_reg_loss: 1908.2729; train_edge_recon_loss: 76500.9718; train_gene_expr_recon_loss: 90604.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169013.7249; train_optim_loss: 169013.7249; val_kl_reg_loss: 1894.2992; val_edge_recon_loss: 77560.7207; val_gene_expr_recon_loss: 91966.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171421.7513; val_optim_loss: 171421.7513

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9857; val_auprc_score: 0.9956; val_best_acc_score: 0.9822; val_best_f1_score: 0.9896; train_kl_reg_loss: 1906.5516; train_edge_recon_loss: 75287.6524; train_gene_expr_recon_loss: 90537.2238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167731.4284; train_optim_loss: 167731.4284; val_kl_reg_loss: 1890.3213; val_edge_recon_loss: 76524.4896; val_gene_expr_recon_loss: 91967.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170381.8242; val_optim_loss: 170381.8242
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9887; val_auprc_score: 0.9971; val_best_acc_score: 0.9826; val_best_f1_score: 0.9898; train_kl_reg_loss: 1906.7173; train_edge_recon_loss: 76347.7121; train_gene_expr_recon_loss: 90527.0509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168781.4818; train_optim_loss: 168781.4818; val_kl_reg_loss: 1892.3672; val_edge_recon_loss: 76828.5000; val_gene_expr_recon_loss: 91894.6504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170615.5169; val_optim_loss: 170615.5169
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9882; val_auprc_score: 0.9967; val_best_acc_score: 0.9824; val_best_f1_score: 0.9897; train_kl_reg_loss: 1905.2393; train_edge_recon_loss: 76039.2940; train_gene_expr_recon_loss: 90511.0119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168455.5457; train_optim_loss: 168455.5457; val_kl_reg_loss: 1890.6499; val_edge_recon_loss: 75104.8704; val_gene_expr_recon_loss: 91822.9036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168818.4219; val_optim_loss: 168818.4219

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 54 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9839
Val AUPRC score: 0.9948
Val best accuracy score: 0.9802
Val best F1 score: 0.9885
Val gene expr MSE score: 0.9109
Duration of model training in run 8: 0 hours, 2 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9599; val_auprc_score: 0.9889; val_best_acc_score: 0.9524; val_best_f1_score: 0.9725; train_kl_reg_loss: 1443.4922; train_edge_recon_loss: 87994.9471; train_gene_expr_recon_loss: 106057.0704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195495.5105; train_optim_loss: 195495.5105; val_kl_reg_loss: 1935.3425; val_edge_recon_loss: 80905.5125; val_gene_expr_recon_loss: 102918.0906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185758.9469; val_optim_loss: 185758.9469
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9763; val_auprc_score: 0.9938; val_best_acc_score: 0.9678; val_best_f1_score: 0.9814; train_kl_reg_loss: 1957.9714; train_edge_recon_loss: 77933.3266; train_gene_expr_recon_loss: 100940.7705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180832.0686; train_optim_loss: 180832.0686; val_kl_reg_loss: 1926.4593; val_edge_recon_loss: 76894.7044; val_gene_expr_recon_loss: 98971.0948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177792.2615; val_optim_loss: 177792.2615
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9791; val_auprc_score: 0.9943; val_best_acc_score: 0.9733; val_best_f1_score: 0.9844; train_kl_reg_loss: 1925.7207; train_edge_recon_loss: 77409.1258; train_gene_expr_recon_loss: 98742.2810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178077.1283; train_optim_loss: 178077.1283; val_kl_reg_loss: 1907.7801; val_edge_recon_loss: 77653.7755; val_gene_expr_recon_loss: 96773.0516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176334.6073; val_optim_loss: 176334.6073
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9842; val_auprc_score: 0.9959; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 1893.7785; train_edge_recon_loss: 78004.9331; train_gene_expr_recon_loss: 97526.4147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177425.1261; train_optim_loss: 177425.1261; val_kl_reg_loss: 1856.5519; val_edge_recon_loss: 76264.5109; val_gene_expr_recon_loss: 95913.3036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174034.3677; val_optim_loss: 174034.3677
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9831; val_auprc_score: 0.9953; val_best_acc_score: 0.9766; val_best_f1_score: 0.9863; train_kl_reg_loss: 1873.6416; train_edge_recon_loss: 76526.9066; train_gene_expr_recon_loss: 96449.8062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174850.3542; train_optim_loss: 174850.3542; val_kl_reg_loss: 1893.8500; val_edge_recon_loss: 78954.6193; val_gene_expr_recon_loss: 95356.3464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176204.8198; val_optim_loss: 176204.8198
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9833; val_auprc_score: 0.9945; val_best_acc_score: 0.9773; val_best_f1_score: 0.9868; train_kl_reg_loss: 1878.4623; train_edge_recon_loss: 77177.7158; train_gene_expr_recon_loss: 95541.6204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174597.7988; train_optim_loss: 174597.7988; val_kl_reg_loss: 1871.1665; val_edge_recon_loss: 78147.0227; val_gene_expr_recon_loss: 94647.3901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174665.5823; val_optim_loss: 174665.5823
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9831; val_auprc_score: 0.9954; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1885.0537; train_edge_recon_loss: 76445.0694; train_gene_expr_recon_loss: 94744.7198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173074.8424; train_optim_loss: 173074.8424; val_kl_reg_loss: 1860.2606; val_edge_recon_loss: 75948.5599; val_gene_expr_recon_loss: 93734.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171543.6625; val_optim_loss: 171543.6625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9828; val_auprc_score: 0.9952; val_best_acc_score: 0.9790; val_best_f1_score: 0.9878; train_kl_reg_loss: 1889.4880; train_edge_recon_loss: 77010.4820; train_gene_expr_recon_loss: 94050.3195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172950.2897; train_optim_loss: 172950.2897; val_kl_reg_loss: 1965.9815; val_edge_recon_loss: 75928.8042; val_gene_expr_recon_loss: 92943.6115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170838.3969; val_optim_loss: 170838.3969
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9833; val_auprc_score: 0.9945; val_best_acc_score: 0.9802; val_best_f1_score: 0.9884; train_kl_reg_loss: 1888.7994; train_edge_recon_loss: 76698.0421; train_gene_expr_recon_loss: 93583.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172170.2166; train_optim_loss: 172170.2166; val_kl_reg_loss: 1844.0254; val_edge_recon_loss: 77864.7906; val_gene_expr_recon_loss: 92833.3292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172542.1479; val_optim_loss: 172542.1479
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9873; val_auprc_score: 0.9958; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 1887.2958; train_edge_recon_loss: 76413.6630; train_gene_expr_recon_loss: 93032.5389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171333.4983; train_optim_loss: 171333.4983; val_kl_reg_loss: 1880.5888; val_edge_recon_loss: 75873.1253; val_gene_expr_recon_loss: 92921.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170675.6125; val_optim_loss: 170675.6125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9861; val_auprc_score: 0.9959; val_best_acc_score: 0.9806; val_best_f1_score: 0.9887; train_kl_reg_loss: 1887.2332; train_edge_recon_loss: 76024.9266; train_gene_expr_recon_loss: 92635.2264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170547.3863; train_optim_loss: 170547.3863; val_kl_reg_loss: 1872.0528; val_edge_recon_loss: 77058.9573; val_gene_expr_recon_loss: 91628.6969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170559.7062; val_optim_loss: 170559.7062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9865; val_auprc_score: 0.9958; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1891.5735; train_edge_recon_loss: 76723.3837; train_gene_expr_recon_loss: 92288.8282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170903.7852; train_optim_loss: 170903.7852; val_kl_reg_loss: 1848.2470; val_edge_recon_loss: 75464.9073; val_gene_expr_recon_loss: 91648.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168961.4521; val_optim_loss: 168961.4521
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9849; val_auprc_score: 0.9945; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1900.3015; train_edge_recon_loss: 76103.1115; train_gene_expr_recon_loss: 91921.0953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169924.5086; train_optim_loss: 169924.5086; val_kl_reg_loss: 1859.2611; val_edge_recon_loss: 78736.5078; val_gene_expr_recon_loss: 91381.8771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171977.6458; val_optim_loss: 171977.6458
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9970; val_best_acc_score: 0.9814; val_best_f1_score: 0.9891; train_kl_reg_loss: 1903.1366; train_edge_recon_loss: 76479.2595; train_gene_expr_recon_loss: 91532.5718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169914.9679; train_optim_loss: 169914.9679; val_kl_reg_loss: 1917.5073; val_edge_recon_loss: 78645.5432; val_gene_expr_recon_loss: 91935.2385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172498.2865; val_optim_loss: 172498.2865
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9847; val_auprc_score: 0.9950; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1904.7983; train_edge_recon_loss: 76492.8522; train_gene_expr_recon_loss: 91211.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169608.9358; train_optim_loss: 169608.9358; val_kl_reg_loss: 1906.0920; val_edge_recon_loss: 76749.9854; val_gene_expr_recon_loss: 90188.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168844.6021; val_optim_loss: 168844.6021
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9850; val_auprc_score: 0.9950; val_best_acc_score: 0.9823; val_best_f1_score: 0.9897; train_kl_reg_loss: 1910.9328; train_edge_recon_loss: 76422.0233; train_gene_expr_recon_loss: 90994.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169327.2847; train_optim_loss: 169327.2847; val_kl_reg_loss: 1873.7061; val_edge_recon_loss: 75835.6703; val_gene_expr_recon_loss: 90634.0958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168343.4708; val_optim_loss: 168343.4708
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9860; val_auprc_score: 0.9951; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1913.3200; train_edge_recon_loss: 76356.7136; train_gene_expr_recon_loss: 90796.6372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169066.6712; train_optim_loss: 169066.6712; val_kl_reg_loss: 1892.4974; val_edge_recon_loss: 75648.8661; val_gene_expr_recon_loss: 90204.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167745.6458; val_optim_loss: 167745.6458
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9855; val_auprc_score: 0.9954; val_best_acc_score: 0.9829; val_best_f1_score: 0.9901; train_kl_reg_loss: 1905.6288; train_edge_recon_loss: 75845.7286; train_gene_expr_recon_loss: 90568.9400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168320.2966; train_optim_loss: 168320.2966; val_kl_reg_loss: 1853.1331; val_edge_recon_loss: 72780.7294; val_gene_expr_recon_loss: 90341.0797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164974.9438; val_optim_loss: 164974.9438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9838; val_auprc_score: 0.9944; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 1915.7022; train_edge_recon_loss: 76097.8537; train_gene_expr_recon_loss: 90267.7505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168281.3064; train_optim_loss: 168281.3064; val_kl_reg_loss: 1880.9735; val_edge_recon_loss: 75795.6479; val_gene_expr_recon_loss: 90310.5630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167987.1823; val_optim_loss: 167987.1823
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9865; val_auprc_score: 0.9949; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1917.8610; train_edge_recon_loss: 76037.3972; train_gene_expr_recon_loss: 90207.1017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168162.3596; train_optim_loss: 168162.3596; val_kl_reg_loss: 1910.0365; val_edge_recon_loss: 75442.9057; val_gene_expr_recon_loss: 89015.7271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166368.6688; val_optim_loss: 166368.6688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9868; val_auprc_score: 0.9957; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 1922.1857; train_edge_recon_loss: 76569.5174; train_gene_expr_recon_loss: 90058.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168550.5030; train_optim_loss: 168550.5030; val_kl_reg_loss: 1870.1053; val_edge_recon_loss: 76130.6901; val_gene_expr_recon_loss: 89620.1469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167620.9417; val_optim_loss: 167620.9417

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9852; val_auprc_score: 0.9947; val_best_acc_score: 0.9830; val_best_f1_score: 0.9901; train_kl_reg_loss: 1930.3145; train_edge_recon_loss: 75822.7509; train_gene_expr_recon_loss: 89517.6972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167270.7625; train_optim_loss: 167270.7625; val_kl_reg_loss: 1913.2444; val_edge_recon_loss: 74349.7036; val_gene_expr_recon_loss: 88642.1203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164905.0698; val_optim_loss: 164905.0698
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9854; val_auprc_score: 0.9948; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1924.9276; train_edge_recon_loss: 76325.6527; train_gene_expr_recon_loss: 89315.0661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167565.6460; train_optim_loss: 167565.6460; val_kl_reg_loss: 1906.7286; val_edge_recon_loss: 77506.3953; val_gene_expr_recon_loss: 88837.3974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168250.5208; val_optim_loss: 168250.5208
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9876; val_auprc_score: 0.9952; val_best_acc_score: 0.9841; val_best_f1_score: 0.9908; train_kl_reg_loss: 1922.0397; train_edge_recon_loss: 76097.1995; train_gene_expr_recon_loss: 89339.2179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167358.4586; train_optim_loss: 167358.4586; val_kl_reg_loss: 1916.7820; val_edge_recon_loss: 75581.2547; val_gene_expr_recon_loss: 88613.8599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166111.8979; val_optim_loss: 166111.8979
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9878; val_auprc_score: 0.9961; val_best_acc_score: 0.9838; val_best_f1_score: 0.9906; train_kl_reg_loss: 1925.3756; train_edge_recon_loss: 75945.7078; train_gene_expr_recon_loss: 89266.8747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167137.9585; train_optim_loss: 167137.9585; val_kl_reg_loss: 1907.3776; val_edge_recon_loss: 75010.5255; val_gene_expr_recon_loss: 88478.9089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165396.8104; val_optim_loss: 165396.8104

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9885; val_auprc_score: 0.9963; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 1922.9668; train_edge_recon_loss: 76804.2646; train_gene_expr_recon_loss: 89177.7229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167904.9549; train_optim_loss: 167904.9549; val_kl_reg_loss: 1913.3801; val_edge_recon_loss: 75815.1667; val_gene_expr_recon_loss: 88286.8849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166015.4312; val_optim_loss: 166015.4312
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9863; val_auprc_score: 0.9949; val_best_acc_score: 0.9840; val_best_f1_score: 0.9907; train_kl_reg_loss: 1924.1581; train_edge_recon_loss: 76865.6000; train_gene_expr_recon_loss: 89214.6630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168004.4213; train_optim_loss: 168004.4213; val_kl_reg_loss: 1910.9130; val_edge_recon_loss: 76039.6807; val_gene_expr_recon_loss: 89202.6047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167153.1990; val_optim_loss: 167153.1990
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9899; val_auprc_score: 0.9966; val_best_acc_score: 0.9847; val_best_f1_score: 0.9911; train_kl_reg_loss: 1923.8448; train_edge_recon_loss: 76279.2069; train_gene_expr_recon_loss: 89323.7134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167526.7650; train_optim_loss: 167526.7650; val_kl_reg_loss: 1912.2159; val_edge_recon_loss: 75426.9404; val_gene_expr_recon_loss: 89161.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166500.2687; val_optim_loss: 166500.2687

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 58 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9907
Val AUPRC score: 0.9971
Val best accuracy score: 0.9843
Val best F1 score: 0.9908
Val gene expr MSE score: 0.8836
Duration of model training in run 9: 0 hours, 5 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9669; val_auprc_score: 0.9910; val_best_acc_score: 0.9591; val_best_f1_score: 0.9764; train_kl_reg_loss: 1468.6048; train_edge_recon_loss: 88135.4366; train_gene_expr_recon_loss: 105524.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195128.0687; train_optim_loss: 195128.0687; val_kl_reg_loss: 2050.6980; val_edge_recon_loss: 78484.9823; val_gene_expr_recon_loss: 100443.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180979.2823; val_optim_loss: 180979.2823
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9819; val_auprc_score: 0.9949; val_best_acc_score: 0.9716; val_best_f1_score: 0.9835; train_kl_reg_loss: 1984.4727; train_edge_recon_loss: 77670.5506; train_gene_expr_recon_loss: 100244.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179900.0208; train_optim_loss: 179900.0208; val_kl_reg_loss: 1949.2143; val_edge_recon_loss: 77266.5448; val_gene_expr_recon_loss: 98157.7281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177373.4865; val_optim_loss: 177373.4865
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9827; val_auprc_score: 0.9954; val_best_acc_score: 0.9756; val_best_f1_score: 0.9858; train_kl_reg_loss: 1934.8730; train_edge_recon_loss: 78018.8014; train_gene_expr_recon_loss: 98232.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178185.8234; train_optim_loss: 178185.8234; val_kl_reg_loss: 1842.8981; val_edge_recon_loss: 75895.4531; val_gene_expr_recon_loss: 96351.6375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174089.9906; val_optim_loss: 174089.9906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9786; val_auprc_score: 0.9938; val_best_acc_score: 0.9761; val_best_f1_score: 0.9861; train_kl_reg_loss: 1900.8463; train_edge_recon_loss: 76658.9121; train_gene_expr_recon_loss: 96969.2705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175529.0295; train_optim_loss: 175529.0295; val_kl_reg_loss: 1858.8983; val_edge_recon_loss: 78455.1078; val_gene_expr_recon_loss: 95180.8807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175494.8875; val_optim_loss: 175494.8875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9834; val_auprc_score: 0.9942; val_best_acc_score: 0.9778; val_best_f1_score: 0.9871; train_kl_reg_loss: 1892.6351; train_edge_recon_loss: 77219.4816; train_gene_expr_recon_loss: 95982.1494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175094.2659; train_optim_loss: 175094.2659; val_kl_reg_loss: 1871.7222; val_edge_recon_loss: 75793.2292; val_gene_expr_recon_loss: 94500.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172164.9729; val_optim_loss: 172164.9729
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9855; val_auprc_score: 0.9952; val_best_acc_score: 0.9802; val_best_f1_score: 0.9884; train_kl_reg_loss: 1887.2202; train_edge_recon_loss: 77784.9629; train_gene_expr_recon_loss: 95166.2508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174838.4338; train_optim_loss: 174838.4338; val_kl_reg_loss: 1833.2132; val_edge_recon_loss: 79743.8828; val_gene_expr_recon_loss: 94238.7818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175815.8750; val_optim_loss: 175815.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9842; val_auprc_score: 0.9962; val_best_acc_score: 0.9796; val_best_f1_score: 0.9881; train_kl_reg_loss: 1888.3875; train_edge_recon_loss: 77334.7385; train_gene_expr_recon_loss: 94366.3046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173589.4314; train_optim_loss: 173589.4314; val_kl_reg_loss: 1869.6130; val_edge_recon_loss: 75654.0849; val_gene_expr_recon_loss: 93126.7516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170650.4500; val_optim_loss: 170650.4500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9835; val_auprc_score: 0.9953; val_best_acc_score: 0.9802; val_best_f1_score: 0.9885; train_kl_reg_loss: 1882.2844; train_edge_recon_loss: 76282.2482; train_gene_expr_recon_loss: 93763.5618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171928.0946; train_optim_loss: 171928.0946; val_kl_reg_loss: 1905.1513; val_edge_recon_loss: 75534.3505; val_gene_expr_recon_loss: 93136.5958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170576.1000; val_optim_loss: 170576.1000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9825; val_auprc_score: 0.9943; val_best_acc_score: 0.9801; val_best_f1_score: 0.9884; train_kl_reg_loss: 1891.0822; train_edge_recon_loss: 75869.2363; train_gene_expr_recon_loss: 93273.2764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171033.5953; train_optim_loss: 171033.5953; val_kl_reg_loss: 1881.0533; val_edge_recon_loss: 75042.2958; val_gene_expr_recon_loss: 92598.0490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169521.3979; val_optim_loss: 169521.3979
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9849; val_auprc_score: 0.9964; val_best_acc_score: 0.9812; val_best_f1_score: 0.9891; train_kl_reg_loss: 1893.3170; train_edge_recon_loss: 76213.1576; train_gene_expr_recon_loss: 92857.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170963.9167; train_optim_loss: 170963.9167; val_kl_reg_loss: 1920.3499; val_edge_recon_loss: 75537.6474; val_gene_expr_recon_loss: 91319.7557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168777.7531; val_optim_loss: 168777.7531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9895; val_auprc_score: 0.9974; val_best_acc_score: 0.9821; val_best_f1_score: 0.9896; train_kl_reg_loss: 1898.0213; train_edge_recon_loss: 76030.4305; train_gene_expr_recon_loss: 92462.9787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170391.4296; train_optim_loss: 170391.4296; val_kl_reg_loss: 1919.0168; val_edge_recon_loss: 74893.9536; val_gene_expr_recon_loss: 91949.0672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168762.0385; val_optim_loss: 168762.0385
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9875; val_auprc_score: 0.9961; val_best_acc_score: 0.9828; val_best_f1_score: 0.9900; train_kl_reg_loss: 1899.3432; train_edge_recon_loss: 76258.3837; train_gene_expr_recon_loss: 92001.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170159.5373; train_optim_loss: 170159.5373; val_kl_reg_loss: 1922.2717; val_edge_recon_loss: 74757.8156; val_gene_expr_recon_loss: 91575.9990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168256.0854; val_optim_loss: 168256.0854
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9843; val_auprc_score: 0.9947; val_best_acc_score: 0.9815; val_best_f1_score: 0.9892; train_kl_reg_loss: 1904.5926; train_edge_recon_loss: 75968.1217; train_gene_expr_recon_loss: 91689.8375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169562.5510; train_optim_loss: 169562.5510; val_kl_reg_loss: 1868.2424; val_edge_recon_loss: 77347.0443; val_gene_expr_recon_loss: 90497.9557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169713.2406; val_optim_loss: 169713.2406
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9854; val_auprc_score: 0.9949; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 1908.5162; train_edge_recon_loss: 76492.9138; train_gene_expr_recon_loss: 91485.9342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169887.3645; train_optim_loss: 169887.3645; val_kl_reg_loss: 1879.0617; val_edge_recon_loss: 77810.6974; val_gene_expr_recon_loss: 90938.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170628.5354; val_optim_loss: 170628.5354
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9859; val_auprc_score: 0.9960; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 1906.4782; train_edge_recon_loss: 76782.9005; train_gene_expr_recon_loss: 91123.2037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169812.5828; train_optim_loss: 169812.5828; val_kl_reg_loss: 1906.8492; val_edge_recon_loss: 75512.8969; val_gene_expr_recon_loss: 90748.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168168.2115; val_optim_loss: 168168.2115
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9855; val_auprc_score: 0.9952; val_best_acc_score: 0.9849; val_best_f1_score: 0.9913; train_kl_reg_loss: 1912.1522; train_edge_recon_loss: 76493.7790; train_gene_expr_recon_loss: 90914.5782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169320.5094; train_optim_loss: 169320.5094; val_kl_reg_loss: 1892.0594; val_edge_recon_loss: 74039.6083; val_gene_expr_recon_loss: 89854.0589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165785.7250; val_optim_loss: 165785.7250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9842; val_auprc_score: 0.9943; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 1923.9199; train_edge_recon_loss: 76434.5660; train_gene_expr_recon_loss: 90668.6589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169027.1449; train_optim_loss: 169027.1449; val_kl_reg_loss: 1905.8423; val_edge_recon_loss: 77169.1661; val_gene_expr_recon_loss: 89772.8661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168847.8740; val_optim_loss: 168847.8740
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9857; val_auprc_score: 0.9956; val_best_acc_score: 0.9846; val_best_f1_score: 0.9911; train_kl_reg_loss: 1915.5039; train_edge_recon_loss: 76701.9028; train_gene_expr_recon_loss: 90417.1524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169034.5586; train_optim_loss: 169034.5586; val_kl_reg_loss: 1904.3206; val_edge_recon_loss: 72878.4036; val_gene_expr_recon_loss: 89816.4828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164599.2062; val_optim_loss: 164599.2062
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9853; val_auprc_score: 0.9945; val_best_acc_score: 0.9835; val_best_f1_score: 0.9904; train_kl_reg_loss: 1920.1816; train_edge_recon_loss: 76492.7851; train_gene_expr_recon_loss: 90304.2018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168717.1684; train_optim_loss: 168717.1684; val_kl_reg_loss: 1870.5397; val_edge_recon_loss: 76837.3776; val_gene_expr_recon_loss: 90037.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168745.5219; val_optim_loss: 168745.5219
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9876; val_auprc_score: 0.9958; val_best_acc_score: 0.9834; val_best_f1_score: 0.9904; train_kl_reg_loss: 1924.1014; train_edge_recon_loss: 76455.8059; train_gene_expr_recon_loss: 90162.7149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168542.6223; train_optim_loss: 168542.6223; val_kl_reg_loss: 1927.5932; val_edge_recon_loss: 76604.2589; val_gene_expr_recon_loss: 90045.7536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168577.6052; val_optim_loss: 168577.6052
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9866; val_auprc_score: 0.9945; val_best_acc_score: 0.9836; val_best_f1_score: 0.9904; train_kl_reg_loss: 1925.0207; train_edge_recon_loss: 76210.5260; train_gene_expr_recon_loss: 89861.4705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167997.0173; train_optim_loss: 167997.0173; val_kl_reg_loss: 1899.2306; val_edge_recon_loss: 78189.7589; val_gene_expr_recon_loss: 89310.8583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169399.8469; val_optim_loss: 169399.8469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9880; val_auprc_score: 0.9968; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1933.7132; train_edge_recon_loss: 76528.2827; train_gene_expr_recon_loss: 89359.0963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167821.0917; train_optim_loss: 167821.0917; val_kl_reg_loss: 1916.7695; val_edge_recon_loss: 75777.6958; val_gene_expr_recon_loss: 88575.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166270.3635; val_optim_loss: 166270.3635
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9863; val_auprc_score: 0.9950; val_best_acc_score: 0.9846; val_best_f1_score: 0.9911; train_kl_reg_loss: 1934.2365; train_edge_recon_loss: 76001.6621; train_gene_expr_recon_loss: 89262.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167197.9370; train_optim_loss: 167197.9370; val_kl_reg_loss: 1913.5194; val_edge_recon_loss: 74144.7349; val_gene_expr_recon_loss: 88664.9432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164723.1979; val_optim_loss: 164723.1979
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9890; val_auprc_score: 0.9964; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 1933.8067; train_edge_recon_loss: 76682.6274; train_gene_expr_recon_loss: 89171.4373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167787.8724; train_optim_loss: 167787.8724; val_kl_reg_loss: 1930.3655; val_edge_recon_loss: 75874.8292; val_gene_expr_recon_loss: 89053.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166858.2802; val_optim_loss: 166858.2802

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 4 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9880
Val AUPRC score: 0.9962
Val best accuracy score: 0.9840
Val best F1 score: 0.9907
Val gene expr MSE score: 0.8808
Duration of model training in run 10: 0 hours, 4 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 01062023_225719.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '8192', '8192', '4096', '4096', '2048', '2048', '1024', '1024', '1024', '1024', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9543; val_auprc_score: 0.9901; val_best_acc_score: 0.9330; val_best_f1_score: 0.9609; train_kl_reg_loss: 139.3148; train_edge_recon_loss: 100846.3047; train_gene_expr_recon_loss: 127584.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228570.2746; train_optim_loss: 228570.2746; val_kl_reg_loss: 229.9397; val_edge_recon_loss: 119301.6953; val_gene_expr_recon_loss: 114317.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233849.0938; val_optim_loss: 233849.0938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9484; val_auprc_score: 0.9888; val_best_acc_score: 0.9377; val_best_f1_score: 0.9642; train_kl_reg_loss: 187.5539; train_edge_recon_loss: 99722.5893; train_gene_expr_recon_loss: 112165.9107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212076.0558; train_optim_loss: 212076.0558; val_kl_reg_loss: 149.2949; val_edge_recon_loss: 103919.0938; val_gene_expr_recon_loss: 110212.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214280.8438; val_optim_loss: 214280.8438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9098; val_auprc_score: 0.9805; val_best_acc_score: 0.9170; val_best_f1_score: 0.9528; train_kl_reg_loss: 249.4749; train_edge_recon_loss: 98060.8125; train_gene_expr_recon_loss: 109929.2623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208239.5536; train_optim_loss: 208239.5536; val_kl_reg_loss: 516.9605; val_edge_recon_loss: 88505.3906; val_gene_expr_recon_loss: 108798.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197820.8906; val_optim_loss: 197820.8906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8797; val_auprc_score: 0.9731; val_best_acc_score: 0.9091; val_best_f1_score: 0.9490; train_kl_reg_loss: 1163.0893; train_edge_recon_loss: 87839.1585; train_gene_expr_recon_loss: 108377.6295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197379.8772; train_optim_loss: 197379.8772; val_kl_reg_loss: 2224.8716; val_edge_recon_loss: 80623.7734; val_gene_expr_recon_loss: 107513.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190362.1250; val_optim_loss: 190362.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8976; val_auprc_score: 0.9762; val_best_acc_score: 0.9069; val_best_f1_score: 0.9468; train_kl_reg_loss: 2919.1340; train_edge_recon_loss: 83535.1250; train_gene_expr_recon_loss: 107110.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193565.0625; train_optim_loss: 193565.0625; val_kl_reg_loss: 3292.8369; val_edge_recon_loss: 86481.4766; val_gene_expr_recon_loss: 106311.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196085.7344; val_optim_loss: 196085.7344
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9094; val_auprc_score: 0.9798; val_best_acc_score: 0.9139; val_best_f1_score: 0.9508; train_kl_reg_loss: 3215.0221; train_edge_recon_loss: 81773.0681; train_gene_expr_recon_loss: 106151.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191139.1228; train_optim_loss: 191139.1228; val_kl_reg_loss: 2765.3066; val_edge_recon_loss: 81468.0625; val_gene_expr_recon_loss: 105614.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189847.7031; val_optim_loss: 189847.7031
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9197; val_auprc_score: 0.9838; val_best_acc_score: 0.9180; val_best_f1_score: 0.9538; train_kl_reg_loss: 2480.7281; train_edge_recon_loss: 81617.1752; train_gene_expr_recon_loss: 105558.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189656.6116; train_optim_loss: 189656.6116; val_kl_reg_loss: 2062.9226; val_edge_recon_loss: 79214.2656; val_gene_expr_recon_loss: 105085.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186362.2188; val_optim_loss: 186362.2188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9374; val_auprc_score: 0.9856; val_best_acc_score: 0.9260; val_best_f1_score: 0.9572; train_kl_reg_loss: 2034.4750; train_edge_recon_loss: 81737.6942; train_gene_expr_recon_loss: 104985.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188757.8103; train_optim_loss: 188757.8103; val_kl_reg_loss: 1960.6327; val_edge_recon_loss: 81606.5703; val_gene_expr_recon_loss: 104597.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188164.7500; val_optim_loss: 188164.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9483; val_auprc_score: 0.9889; val_best_acc_score: 0.9325; val_best_f1_score: 0.9612; train_kl_reg_loss: 2100.3381; train_edge_recon_loss: 80454.1016; train_gene_expr_recon_loss: 104557.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187111.5625; train_optim_loss: 187111.5625; val_kl_reg_loss: 2177.6455; val_edge_recon_loss: 79449.2500; val_gene_expr_recon_loss: 104148.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185775.6875; val_optim_loss: 185775.6875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9519; val_auprc_score: 0.9886; val_best_acc_score: 0.9331; val_best_f1_score: 0.9615; train_kl_reg_loss: 2285.8832; train_edge_recon_loss: 79062.7946; train_gene_expr_recon_loss: 104148.9710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185497.6473; train_optim_loss: 185497.6473; val_kl_reg_loss: 2242.2622; val_edge_recon_loss: 81178.5312; val_gene_expr_recon_loss: 103749.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187170.1094; val_optim_loss: 187170.1094
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9638; val_auprc_score: 0.9922; val_best_acc_score: 0.9428; val_best_f1_score: 0.9667; train_kl_reg_loss: 2267.3739; train_edge_recon_loss: 78736.4732; train_gene_expr_recon_loss: 103804.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184807.8906; train_optim_loss: 184807.8906; val_kl_reg_loss: 2155.1113; val_edge_recon_loss: 80285.7891; val_gene_expr_recon_loss: 103373.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185814.4688; val_optim_loss: 185814.4688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9655; val_auprc_score: 0.9925; val_best_acc_score: 0.9459; val_best_f1_score: 0.9686; train_kl_reg_loss: 2193.3237; train_edge_recon_loss: 79179.0815; train_gene_expr_recon_loss: 103366.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184739.2812; train_optim_loss: 184739.2812; val_kl_reg_loss: 2138.1533; val_edge_recon_loss: 78827.7266; val_gene_expr_recon_loss: 102978.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183944.2812; val_optim_loss: 183944.2812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9637; val_auprc_score: 0.9918; val_best_acc_score: 0.9429; val_best_f1_score: 0.9668; train_kl_reg_loss: 2197.3778; train_edge_recon_loss: 79220.4442; train_gene_expr_recon_loss: 102869.5056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184287.3281; train_optim_loss: 184287.3281; val_kl_reg_loss: 2156.9988; val_edge_recon_loss: 79058.8125; val_gene_expr_recon_loss: 102578.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183794.0625; val_optim_loss: 183794.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9694; val_auprc_score: 0.9936; val_best_acc_score: 0.9457; val_best_f1_score: 0.9683; train_kl_reg_loss: 2187.6564; train_edge_recon_loss: 78077.4609; train_gene_expr_recon_loss: 102611.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182876.2612; train_optim_loss: 182876.2612; val_kl_reg_loss: 2107.0347; val_edge_recon_loss: 81117.3906; val_gene_expr_recon_loss: 102212.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185436.9531; val_optim_loss: 185436.9531
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9657; val_auprc_score: 0.9924; val_best_acc_score: 0.9481; val_best_f1_score: 0.9699; train_kl_reg_loss: 2153.5943; train_edge_recon_loss: 77065.1752; train_gene_expr_recon_loss: 102336.5357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181555.3013; train_optim_loss: 181555.3013; val_kl_reg_loss: 2086.5718; val_edge_recon_loss: 78877.1016; val_gene_expr_recon_loss: 101868.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182832.3125; val_optim_loss: 182832.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9754; val_auprc_score: 0.9951; val_best_acc_score: 0.9537; val_best_f1_score: 0.9733; train_kl_reg_loss: 2122.8922; train_edge_recon_loss: 77777.4230; train_gene_expr_recon_loss: 102087.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181988.0960; train_optim_loss: 181988.0960; val_kl_reg_loss: 2037.7874; val_edge_recon_loss: 75757.3516; val_gene_expr_recon_loss: 101562.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179357.3750; val_optim_loss: 179357.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9765; val_auprc_score: 0.9953; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 2106.0251; train_edge_recon_loss: 78195.2600; train_gene_expr_recon_loss: 101722.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182023.3549; train_optim_loss: 182023.3549; val_kl_reg_loss: 2070.8523; val_edge_recon_loss: 78403.8516; val_gene_expr_recon_loss: 101271.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181746.6250; val_optim_loss: 181746.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9701; val_auprc_score: 0.9932; val_best_acc_score: 0.9541; val_best_f1_score: 0.9735; train_kl_reg_loss: 2139.1901; train_edge_recon_loss: 78364.8750; train_gene_expr_recon_loss: 101543.5558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182047.6183; train_optim_loss: 182047.6183; val_kl_reg_loss: 2082.3684; val_edge_recon_loss: 77389.7578; val_gene_expr_recon_loss: 101003.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180475.4375; val_optim_loss: 180475.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9707; val_auprc_score: 0.9922; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 2123.5915; train_edge_recon_loss: 76994.2388; train_gene_expr_recon_loss: 101065.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180183.5379; train_optim_loss: 180183.5379; val_kl_reg_loss: 2032.0200; val_edge_recon_loss: 77578.8281; val_gene_expr_recon_loss: 100737.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180348.3125; val_optim_loss: 180348.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9696; val_auprc_score: 0.9919; val_best_acc_score: 0.9553; val_best_f1_score: 0.9740; train_kl_reg_loss: 2082.9365; train_edge_recon_loss: 77943.2076; train_gene_expr_recon_loss: 100948.4810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180974.6250; train_optim_loss: 180974.6250; val_kl_reg_loss: 2037.3621; val_edge_recon_loss: 79705.0781; val_gene_expr_recon_loss: 100691.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182433.7812; val_optim_loss: 182433.7812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9708; val_auprc_score: 0.9929; val_best_acc_score: 0.9577; val_best_f1_score: 0.9756; train_kl_reg_loss: 2092.2869; train_edge_recon_loss: 77015.2712; train_gene_expr_recon_loss: 100917.5826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180025.1406; train_optim_loss: 180025.1406; val_kl_reg_loss: 2053.9490; val_edge_recon_loss: 76232.4141; val_gene_expr_recon_loss: 100661.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178948.1250; val_optim_loss: 178948.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9723; val_auprc_score: 0.9928; val_best_acc_score: 0.9572; val_best_f1_score: 0.9752; train_kl_reg_loss: 2102.8419; train_edge_recon_loss: 77130.1741; train_gene_expr_recon_loss: 100973.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180206.6562; train_optim_loss: 180206.6562; val_kl_reg_loss: 2055.4058; val_edge_recon_loss: 78637.7188; val_gene_expr_recon_loss: 100632.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181325.3750; val_optim_loss: 181325.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9724; val_auprc_score: 0.9938; val_best_acc_score: 0.9534; val_best_f1_score: 0.9730; train_kl_reg_loss: 2109.3393; train_edge_recon_loss: 76929.3906; train_gene_expr_recon_loss: 100907.5480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179946.2790; train_optim_loss: 179946.2790; val_kl_reg_loss: 2060.7397; val_edge_recon_loss: 79322.8438; val_gene_expr_recon_loss: 100602.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181986.4531; val_optim_loss: 181986.4531
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9749; val_auprc_score: 0.9942; val_best_acc_score: 0.9575; val_best_f1_score: 0.9753; train_kl_reg_loss: 2107.4659; train_edge_recon_loss: 76954.8493; train_gene_expr_recon_loss: 100829.8460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179892.1629; train_optim_loss: 179892.1629; val_kl_reg_loss: 2051.9861; val_edge_recon_loss: 77228.7344; val_gene_expr_recon_loss: 100577.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179858.2656; val_optim_loss: 179858.2656

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9710; val_auprc_score: 0.9933; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 2100.8559; train_edge_recon_loss: 77660.6272; train_gene_expr_recon_loss: 100719.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180481.4509; train_optim_loss: 180481.4509; val_kl_reg_loss: 2049.5059; val_edge_recon_loss: 77823.7109; val_gene_expr_recon_loss: 100574.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180448.0625; val_optim_loss: 180448.0625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9764; val_auprc_score: 0.9929; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 2100.2996; train_edge_recon_loss: 77330.8906; train_gene_expr_recon_loss: 100846.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180278.1295; train_optim_loss: 180278.1295; val_kl_reg_loss: 2051.9268; val_edge_recon_loss: 78043.7031; val_gene_expr_recon_loss: 100572.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180667.6562; val_optim_loss: 180667.6562
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9747; val_auprc_score: 0.9937; val_best_acc_score: 0.9560; val_best_f1_score: 0.9746; train_kl_reg_loss: 2099.9046; train_edge_recon_loss: 77742.8426; train_gene_expr_recon_loss: 100841.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180683.8504; train_optim_loss: 180683.8504; val_kl_reg_loss: 2049.6401; val_edge_recon_loss: 77381.2812; val_gene_expr_recon_loss: 100569.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180000.3438; val_optim_loss: 180000.3438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 3 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9754
Val AUPRC score: 0.9941
Val best accuracy score: 0.9565
Val best F1 score: 0.9747
Val gene expr MSE score: 1.2056
Duration of model training in run 1: 0 hours, 1 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9592; val_auprc_score: 0.9901; val_best_acc_score: 0.9357; val_best_f1_score: 0.9632; train_kl_reg_loss: 145.6022; train_edge_recon_loss: 102102.6763; train_gene_expr_recon_loss: 127971.5134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230219.7902; train_optim_loss: 230219.7902; val_kl_reg_loss: 273.5781; val_edge_recon_loss: 116713.3359; val_gene_expr_recon_loss: 114000.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230987.4062; val_optim_loss: 230987.4062
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9454; val_auprc_score: 0.9868; val_best_acc_score: 0.9324; val_best_f1_score: 0.9614; train_kl_reg_loss: 211.9065; train_edge_recon_loss: 101574.5647; train_gene_expr_recon_loss: 111883.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213670.4643; train_optim_loss: 213670.4643; val_kl_reg_loss: 136.7627; val_edge_recon_loss: 100271.6250; val_gene_expr_recon_loss: 110125.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210533.5469; val_optim_loss: 210533.5469
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9190; val_auprc_score: 0.9829; val_best_acc_score: 0.9110; val_best_f1_score: 0.9492; train_kl_reg_loss: 185.8657; train_edge_recon_loss: 101271.4621; train_gene_expr_recon_loss: 109563.7589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211021.0915; train_optim_loss: 211021.0915; val_kl_reg_loss: 341.6965; val_edge_recon_loss: 93917.4531; val_gene_expr_recon_loss: 108758.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203017.2500; val_optim_loss: 203017.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8747; val_auprc_score: 0.9689; val_best_acc_score: 0.9052; val_best_f1_score: 0.9460; train_kl_reg_loss: 742.9892; train_edge_recon_loss: 91823.4297; train_gene_expr_recon_loss: 108255.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200822.3348; train_optim_loss: 200822.3348; val_kl_reg_loss: 1547.0110; val_edge_recon_loss: 84488.7891; val_gene_expr_recon_loss: 107523.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193558.8750; val_optim_loss: 193558.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8830; val_auprc_score: 0.9740; val_best_acc_score: 0.9050; val_best_f1_score: 0.9465; train_kl_reg_loss: 2389.9504; train_edge_recon_loss: 83307.5603; train_gene_expr_recon_loss: 107151.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192849.4308; train_optim_loss: 192849.4308; val_kl_reg_loss: 3136.8999; val_edge_recon_loss: 82827.5234; val_gene_expr_recon_loss: 106276.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192241.3438; val_optim_loss: 192241.3438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8963; val_auprc_score: 0.9745; val_best_acc_score: 0.9110; val_best_f1_score: 0.9488; train_kl_reg_loss: 3274.2697; train_edge_recon_loss: 82015.4654; train_gene_expr_recon_loss: 106000.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191290.0982; train_optim_loss: 191290.0982; val_kl_reg_loss: 3019.3804; val_edge_recon_loss: 86097.9922; val_gene_expr_recon_loss: 105524.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194641.4062; val_optim_loss: 194641.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9035; val_auprc_score: 0.9782; val_best_acc_score: 0.9118; val_best_f1_score: 0.9504; train_kl_reg_loss: 2737.5758; train_edge_recon_loss: 82005.7891; train_gene_expr_recon_loss: 105386.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190130.1652; train_optim_loss: 190130.1652; val_kl_reg_loss: 2235.5332; val_edge_recon_loss: 82039.1172; val_gene_expr_recon_loss: 104971.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189245.8750; val_optim_loss: 189245.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9335; val_auprc_score: 0.9863; val_best_acc_score: 0.9234; val_best_f1_score: 0.9560; train_kl_reg_loss: 2082.7379; train_edge_recon_loss: 80473.6752; train_gene_expr_recon_loss: 104980.3739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187536.7857; train_optim_loss: 187536.7857; val_kl_reg_loss: 1894.4668; val_edge_recon_loss: 79314.5000; val_gene_expr_recon_loss: 104490.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185699.6562; val_optim_loss: 185699.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9474; val_auprc_score: 0.9864; val_best_acc_score: 0.9267; val_best_f1_score: 0.9578; train_kl_reg_loss: 2001.5182; train_edge_recon_loss: 81115.7165; train_gene_expr_recon_loss: 104420.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187538.0045; train_optim_loss: 187538.0045; val_kl_reg_loss: 2099.8105; val_edge_recon_loss: 84190.9844; val_gene_expr_recon_loss: 104032.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190323.3438; val_optim_loss: 190323.3438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9507; val_auprc_score: 0.9889; val_best_acc_score: 0.9330; val_best_f1_score: 0.9616; train_kl_reg_loss: 2237.1282; train_edge_recon_loss: 78639.7567; train_gene_expr_recon_loss: 104015.3627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184892.2522; train_optim_loss: 184892.2522; val_kl_reg_loss: 2265.6885; val_edge_recon_loss: 79382.7734; val_gene_expr_recon_loss: 103608.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185256.5312; val_optim_loss: 185256.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9535; val_auprc_score: 0.9900; val_best_acc_score: 0.9367; val_best_f1_score: 0.9636; train_kl_reg_loss: 2275.8113; train_edge_recon_loss: 78286.3013; train_gene_expr_recon_loss: 103490.4821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184052.5982; train_optim_loss: 184052.5982; val_kl_reg_loss: 2167.1826; val_edge_recon_loss: 79197.6250; val_gene_expr_recon_loss: 103215.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184580.0625; val_optim_loss: 184580.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9575; val_auprc_score: 0.9912; val_best_acc_score: 0.9416; val_best_f1_score: 0.9664; train_kl_reg_loss: 2178.5009; train_edge_recon_loss: 78545.3717; train_gene_expr_recon_loss: 103028.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183751.9576; train_optim_loss: 183751.9576; val_kl_reg_loss: 2126.5142; val_edge_recon_loss: 77917.3984; val_gene_expr_recon_loss: 102812.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182856.4531; val_optim_loss: 182856.4531
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9627; val_auprc_score: 0.9924; val_best_acc_score: 0.9457; val_best_f1_score: 0.9688; train_kl_reg_loss: 2177.3260; train_edge_recon_loss: 77006.2533; train_gene_expr_recon_loss: 102781.8795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181965.4554; train_optim_loss: 181965.4554; val_kl_reg_loss: 2112.2288; val_edge_recon_loss: 76008.0078; val_gene_expr_recon_loss: 102419.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180539.5000; val_optim_loss: 180539.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9612; val_auprc_score: 0.9913; val_best_acc_score: 0.9435; val_best_f1_score: 0.9674; train_kl_reg_loss: 2122.4543; train_edge_recon_loss: 77751.0815; train_gene_expr_recon_loss: 102332.4107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182205.9464; train_optim_loss: 182205.9464; val_kl_reg_loss: 2073.4788; val_edge_recon_loss: 80510.0469; val_gene_expr_recon_loss: 102059.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184642.8125; val_optim_loss: 184642.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9680; val_auprc_score: 0.9935; val_best_acc_score: 0.9488; val_best_f1_score: 0.9703; train_kl_reg_loss: 2127.8346; train_edge_recon_loss: 78988.0938; train_gene_expr_recon_loss: 101930.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183046.0603; train_optim_loss: 183046.0603; val_kl_reg_loss: 2097.1709; val_edge_recon_loss: 78058.3203; val_gene_expr_recon_loss: 101720.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181876.4062; val_optim_loss: 181876.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9671; val_auprc_score: 0.9929; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 2143.3698; train_edge_recon_loss: 77864.7299; train_gene_expr_recon_loss: 101764.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181772.7009; train_optim_loss: 181772.7009; val_kl_reg_loss: 2116.8098; val_edge_recon_loss: 78229.2969; val_gene_expr_recon_loss: 101404.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181750.6250; val_optim_loss: 181750.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9661; val_auprc_score: 0.9924; val_best_acc_score: 0.9467; val_best_f1_score: 0.9693; train_kl_reg_loss: 2153.6856; train_edge_recon_loss: 78948.9565; train_gene_expr_recon_loss: 101579.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182681.8415; train_optim_loss: 182681.8415; val_kl_reg_loss: 2098.1777; val_edge_recon_loss: 78191.1094; val_gene_expr_recon_loss: 101367.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181656.4375; val_optim_loss: 181656.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9723; val_auprc_score: 0.9943; val_best_acc_score: 0.9537; val_best_f1_score: 0.9732; train_kl_reg_loss: 2142.6196; train_edge_recon_loss: 77402.1484; train_gene_expr_recon_loss: 101387.8862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180932.6540; train_optim_loss: 180932.6540; val_kl_reg_loss: 2101.3481; val_edge_recon_loss: 77197.4375; val_gene_expr_recon_loss: 101335.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180634.5938; val_optim_loss: 180634.5938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9643; val_auprc_score: 0.9921; val_best_acc_score: 0.9514; val_best_f1_score: 0.9720; train_kl_reg_loss: 2136.7302; train_edge_recon_loss: 77866.0324; train_gene_expr_recon_loss: 101484.8292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181487.5938; train_optim_loss: 181487.5938; val_kl_reg_loss: 2085.2075; val_edge_recon_loss: 75243.7344; val_gene_expr_recon_loss: 101305.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178634.0156; val_optim_loss: 178634.0156
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9697; val_auprc_score: 0.9917; val_best_acc_score: 0.9501; val_best_f1_score: 0.9709; train_kl_reg_loss: 2125.2365; train_edge_recon_loss: 79004.7801; train_gene_expr_recon_loss: 101340.4866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182470.5022; train_optim_loss: 182470.5022; val_kl_reg_loss: 2085.9031; val_edge_recon_loss: 81302.0312; val_gene_expr_recon_loss: 101274.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184662.9062; val_optim_loss: 184662.9062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9672; val_auprc_score: 0.9931; val_best_acc_score: 0.9517; val_best_f1_score: 0.9723; train_kl_reg_loss: 2126.5096; train_edge_recon_loss: 78805.1239; train_gene_expr_recon_loss: 101556.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182488.5156; train_optim_loss: 182488.5156; val_kl_reg_loss: 2081.0188; val_edge_recon_loss: 75350.1562; val_gene_expr_recon_loss: 101245.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178676.3906; val_optim_loss: 178676.3906
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9714; val_auprc_score: 0.9940; val_best_acc_score: 0.9529; val_best_f1_score: 0.9728; train_kl_reg_loss: 2121.8597; train_edge_recon_loss: 76817.6071; train_gene_expr_recon_loss: 101189.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180128.7165; train_optim_loss: 180128.7165; val_kl_reg_loss: 2080.6479; val_edge_recon_loss: 75789.7031; val_gene_expr_recon_loss: 101215.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179085.3750; val_optim_loss: 179085.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9697; val_auprc_score: 0.9933; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 2121.9321; train_edge_recon_loss: 77992.2333; train_gene_expr_recon_loss: 101401.3136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181515.4821; train_optim_loss: 181515.4821; val_kl_reg_loss: 2077.7256; val_edge_recon_loss: 78006.7656; val_gene_expr_recon_loss: 101211.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181296.2344; val_optim_loss: 181296.2344
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9642; val_auprc_score: 0.9924; val_best_acc_score: 0.9477; val_best_f1_score: 0.9700; train_kl_reg_loss: 2122.9000; train_edge_recon_loss: 77839.5848; train_gene_expr_recon_loss: 101406.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181368.6384; train_optim_loss: 181368.6384; val_kl_reg_loss: 2078.7742; val_edge_recon_loss: 76700.9688; val_gene_expr_recon_loss: 101208.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179988.0781; val_optim_loss: 179988.0781
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9703; val_auprc_score: 0.9929; val_best_acc_score: 0.9521; val_best_f1_score: 0.9723; train_kl_reg_loss: 2121.3620; train_edge_recon_loss: 77986.3705; train_gene_expr_recon_loss: 101333.6194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181441.3482; train_optim_loss: 181441.3482; val_kl_reg_loss: 2076.9053; val_edge_recon_loss: 77523.0156; val_gene_expr_recon_loss: 101205.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180804.9688; val_optim_loss: 180804.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 58 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9673
Val AUPRC score: 0.9931
Val best accuracy score: 0.9484
Val best F1 score: 0.9698
Val gene expr MSE score: 1.2973
Duration of model training in run 2: 0 hours, 1 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9078; val_auprc_score: 0.9792; val_best_acc_score: 0.9125; val_best_f1_score: 0.9501; train_kl_reg_loss: 211.0981; train_edge_recon_loss: 99804.1363; train_gene_expr_recon_loss: 115982.6366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215997.8715; train_optim_loss: 215997.8715; val_kl_reg_loss: 545.5481; val_edge_recon_loss: 89663.2917; val_gene_expr_recon_loss: 107020.8177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197229.6562; val_optim_loss: 197229.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9150; val_auprc_score: 0.9815; val_best_acc_score: 0.9115; val_best_f1_score: 0.9492; train_kl_reg_loss: 2236.8586; train_edge_recon_loss: 85457.6814; train_gene_expr_recon_loss: 107287.2416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194981.7812; train_optim_loss: 194981.7812; val_kl_reg_loss: 2324.4909; val_edge_recon_loss: 84483.3698; val_gene_expr_recon_loss: 104405.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191213.1510; val_optim_loss: 191213.1510
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9522; val_auprc_score: 0.9904; val_best_acc_score: 0.9375; val_best_f1_score: 0.9640; train_kl_reg_loss: 2036.9567; train_edge_recon_loss: 81350.5749; train_gene_expr_recon_loss: 105372.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188759.7529; train_optim_loss: 188759.7529; val_kl_reg_loss: 2051.9008; val_edge_recon_loss: 79236.1771; val_gene_expr_recon_loss: 102928.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184216.8594; val_optim_loss: 184216.8594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9708; val_auprc_score: 0.9939; val_best_acc_score: 0.9507; val_best_f1_score: 0.9714; train_kl_reg_loss: 2123.0455; train_edge_recon_loss: 78072.1331; train_gene_expr_recon_loss: 104057.3898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184252.5689; train_optim_loss: 184252.5689; val_kl_reg_loss: 2080.4012; val_edge_recon_loss: 79467.6484; val_gene_expr_recon_loss: 101413.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182961.6979; val_optim_loss: 182961.6979
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9748; val_auprc_score: 0.9943; val_best_acc_score: 0.9585; val_best_f1_score: 0.9759; train_kl_reg_loss: 2097.0953; train_edge_recon_loss: 78521.9456; train_gene_expr_recon_loss: 102761.2025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183380.2425; train_optim_loss: 183380.2425; val_kl_reg_loss: 2080.6023; val_edge_recon_loss: 77827.4635; val_gene_expr_recon_loss: 100473.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180381.1250; val_optim_loss: 180381.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9815; val_auprc_score: 0.9962; val_best_acc_score: 0.9628; val_best_f1_score: 0.9784; train_kl_reg_loss: 2070.2762; train_edge_recon_loss: 77621.8527; train_gene_expr_recon_loss: 101747.2263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181439.3542; train_optim_loss: 181439.3542; val_kl_reg_loss: 2028.1438; val_edge_recon_loss: 79885.2839; val_gene_expr_recon_loss: 99632.4036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181545.8281; val_optim_loss: 181545.8281
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9818; val_auprc_score: 0.9954; val_best_acc_score: 0.9687; val_best_f1_score: 0.9818; train_kl_reg_loss: 2029.8055; train_edge_recon_loss: 77138.6820; train_gene_expr_recon_loss: 101009.5315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180178.0185; train_optim_loss: 180178.0185; val_kl_reg_loss: 2021.7321; val_edge_recon_loss: 75559.5000; val_gene_expr_recon_loss: 98989.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176570.5156; val_optim_loss: 176570.5156
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9835; val_auprc_score: 0.9963; val_best_acc_score: 0.9711; val_best_f1_score: 0.9832; train_kl_reg_loss: 2041.4287; train_edge_recon_loss: 77369.3698; train_gene_expr_recon_loss: 99977.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179387.8547; train_optim_loss: 179387.8547; val_kl_reg_loss: 2037.2583; val_edge_recon_loss: 77098.6615; val_gene_expr_recon_loss: 98592.2448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177728.1615; val_optim_loss: 177728.1615
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9868; val_auprc_score: 0.9962; val_best_acc_score: 0.9744; val_best_f1_score: 0.9851; train_kl_reg_loss: 2024.7056; train_edge_recon_loss: 77562.1207; train_gene_expr_recon_loss: 99882.3348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179469.1597; train_optim_loss: 179469.1597; val_kl_reg_loss: 2023.9825; val_edge_recon_loss: 76470.4792; val_gene_expr_recon_loss: 98042.1745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176536.6302; val_optim_loss: 176536.6302
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9861; val_auprc_score: 0.9968; val_best_acc_score: 0.9731; val_best_f1_score: 0.9843; train_kl_reg_loss: 1999.8148; train_edge_recon_loss: 75977.8409; train_gene_expr_recon_loss: 99239.7245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177217.3808; train_optim_loss: 177217.3808; val_kl_reg_loss: 2000.6357; val_edge_recon_loss: 78448.0885; val_gene_expr_recon_loss: 97470.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177919.5417; val_optim_loss: 177919.5417
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9878; val_auprc_score: 0.9975; val_best_acc_score: 0.9754; val_best_f1_score: 0.9857; train_kl_reg_loss: 2002.2613; train_edge_recon_loss: 76404.5952; train_gene_expr_recon_loss: 98933.6351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177340.4919; train_optim_loss: 177340.4919; val_kl_reg_loss: 1934.2216; val_edge_recon_loss: 76953.0156; val_gene_expr_recon_loss: 97255.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176142.4427; val_optim_loss: 176142.4427
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9830; val_auprc_score: 0.9952; val_best_acc_score: 0.9759; val_best_f1_score: 0.9860; train_kl_reg_loss: 1974.7226; train_edge_recon_loss: 76198.7471; train_gene_expr_recon_loss: 98654.2671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176827.7373; train_optim_loss: 176827.7373; val_kl_reg_loss: 1944.8698; val_edge_recon_loss: 75548.2370; val_gene_expr_recon_loss: 96795.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174288.6667; val_optim_loss: 174288.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9871; val_auprc_score: 0.9964; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1973.7099; train_edge_recon_loss: 77400.1565; train_gene_expr_recon_loss: 98418.8701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177792.7384; train_optim_loss: 177792.7384; val_kl_reg_loss: 1943.3292; val_edge_recon_loss: 77702.4661; val_gene_expr_recon_loss: 96325.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175971.7760; val_optim_loss: 175971.7760
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9868; val_auprc_score: 0.9972; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 1955.3125; train_edge_recon_loss: 76448.0437; train_gene_expr_recon_loss: 97817.4439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176220.8003; train_optim_loss: 176220.8003; val_kl_reg_loss: 1932.2854; val_edge_recon_loss: 76387.6953; val_gene_expr_recon_loss: 96178.5260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174498.5052; val_optim_loss: 174498.5052
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9885; val_auprc_score: 0.9975; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1963.2723; train_edge_recon_loss: 76964.2433; train_gene_expr_recon_loss: 97447.8773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176375.3918; train_optim_loss: 176375.3918; val_kl_reg_loss: 1931.0046; val_edge_recon_loss: 78775.4427; val_gene_expr_recon_loss: 95981.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176687.7031; val_optim_loss: 176687.7031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9883; val_auprc_score: 0.9966; val_best_acc_score: 0.9796; val_best_f1_score: 0.9882; train_kl_reg_loss: 1957.6130; train_edge_recon_loss: 76252.7668; train_gene_expr_recon_loss: 97716.5920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175926.9728; train_optim_loss: 175926.9728; val_kl_reg_loss: 1914.5516; val_edge_recon_loss: 74233.6901; val_gene_expr_recon_loss: 95526.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171674.5104; val_optim_loss: 171674.5104
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9859; val_auprc_score: 0.9962; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1941.4640; train_edge_recon_loss: 76049.3371; train_gene_expr_recon_loss: 97482.7740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175473.5752; train_optim_loss: 175473.5752; val_kl_reg_loss: 1923.3597; val_edge_recon_loss: 75140.3490; val_gene_expr_recon_loss: 95780.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172843.7812; val_optim_loss: 172843.7812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9868; val_auprc_score: 0.9971; val_best_acc_score: 0.9767; val_best_f1_score: 0.9864; train_kl_reg_loss: 1959.5072; train_edge_recon_loss: 77950.7703; train_gene_expr_recon_loss: 97354.5851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177264.8634; train_optim_loss: 177264.8634; val_kl_reg_loss: 1937.7224; val_edge_recon_loss: 78087.2292; val_gene_expr_recon_loss: 95664.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175689.3125; val_optim_loss: 175689.3125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9874; val_auprc_score: 0.9971; val_best_acc_score: 0.9773; val_best_f1_score: 0.9868; train_kl_reg_loss: 1963.5370; train_edge_recon_loss: 78177.3252; train_gene_expr_recon_loss: 97304.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177445.6024; train_optim_loss: 177445.6024; val_kl_reg_loss: 1921.1318; val_edge_recon_loss: 77299.9609; val_gene_expr_recon_loss: 95538.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174759.1146; val_optim_loss: 174759.1146

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9872; val_auprc_score: 0.9968; val_best_acc_score: 0.9768; val_best_f1_score: 0.9864; train_kl_reg_loss: 1957.0668; train_edge_recon_loss: 76667.1918; train_gene_expr_recon_loss: 97145.0799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175769.3374; train_optim_loss: 175769.3374; val_kl_reg_loss: 1925.2500; val_edge_recon_loss: 77683.1354; val_gene_expr_recon_loss: 95588.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175197.0000; val_optim_loss: 175197.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9855; val_auprc_score: 0.9965; val_best_acc_score: 0.9765; val_best_f1_score: 0.9864; train_kl_reg_loss: 1956.6470; train_edge_recon_loss: 76145.9488; train_gene_expr_recon_loss: 97192.0622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175294.6591; train_optim_loss: 175294.6591; val_kl_reg_loss: 1923.5810; val_edge_recon_loss: 76558.4531; val_gene_expr_recon_loss: 95813.9896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174296.0208; val_optim_loss: 174296.0208
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9890; val_auprc_score: 0.9969; val_best_acc_score: 0.9801; val_best_f1_score: 0.9884; train_kl_reg_loss: 1955.0127; train_edge_recon_loss: 76076.8354; train_gene_expr_recon_loss: 97255.8258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175287.6736; train_optim_loss: 175287.6736; val_kl_reg_loss: 1921.0097; val_edge_recon_loss: 74729.1380; val_gene_expr_recon_loss: 95492.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172143.0938; val_optim_loss: 172143.0938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 47 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9883
Val AUPRC score: 0.9965
Val best accuracy score: 0.9797
Val best F1 score: 0.9882
Val gene expr MSE score: 1.0145
Duration of model training in run 3: 0 hours, 1 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9057; val_auprc_score: 0.9795; val_best_acc_score: 0.9190; val_best_f1_score: 0.9540; train_kl_reg_loss: 237.2159; train_edge_recon_loss: 99164.0862; train_gene_expr_recon_loss: 115706.2960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215107.5972; train_optim_loss: 215107.5972; val_kl_reg_loss: 983.3362; val_edge_recon_loss: 84752.4089; val_gene_expr_recon_loss: 110320.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196056.5677; val_optim_loss: 196056.5677
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9353; val_auprc_score: 0.9865; val_best_acc_score: 0.9242; val_best_f1_score: 0.9564; train_kl_reg_loss: 2461.0179; train_edge_recon_loss: 83373.1209; train_gene_expr_recon_loss: 107310.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193144.3009; train_optim_loss: 193144.3009; val_kl_reg_loss: 2086.0959; val_edge_recon_loss: 82119.2839; val_gene_expr_recon_loss: 106974.6589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191180.0417; val_optim_loss: 191180.0417
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9679; val_auprc_score: 0.9923; val_best_acc_score: 0.9482; val_best_f1_score: 0.9700; train_kl_reg_loss: 2031.6986; train_edge_recon_loss: 80651.6285; train_gene_expr_recon_loss: 105611.1403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188294.4670; train_optim_loss: 188294.4670; val_kl_reg_loss: 2115.9009; val_edge_recon_loss: 78837.7891; val_gene_expr_recon_loss: 106250.4948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187204.1875; val_optim_loss: 187204.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9745; val_auprc_score: 0.9949; val_best_acc_score: 0.9565; val_best_f1_score: 0.9748; train_kl_reg_loss: 2100.3852; train_edge_recon_loss: 77914.1693; train_gene_expr_recon_loss: 104327.5223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184342.0770; train_optim_loss: 184342.0770; val_kl_reg_loss: 2056.5352; val_edge_recon_loss: 76435.8203; val_gene_expr_recon_loss: 104536.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183028.5208; val_optim_loss: 183028.5208
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9779; val_auprc_score: 0.9944; val_best_acc_score: 0.9621; val_best_f1_score: 0.9779; train_kl_reg_loss: 2081.1714; train_edge_recon_loss: 78201.4910; train_gene_expr_recon_loss: 103226.2150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183508.8773; train_optim_loss: 183508.8773; val_kl_reg_loss: 2056.3084; val_edge_recon_loss: 79050.6432; val_gene_expr_recon_loss: 103809.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184916.1354; val_optim_loss: 184916.1354
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9817; val_auprc_score: 0.9962; val_best_acc_score: 0.9642; val_best_f1_score: 0.9791; train_kl_reg_loss: 2063.9082; train_edge_recon_loss: 77520.7714; train_gene_expr_recon_loss: 102526.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182111.5677; train_optim_loss: 182111.5677; val_kl_reg_loss: 2058.3140; val_edge_recon_loss: 78244.8411; val_gene_expr_recon_loss: 103107.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183410.8854; val_optim_loss: 183410.8854
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9790; val_auprc_score: 0.9949; val_best_acc_score: 0.9683; val_best_f1_score: 0.9815; train_kl_reg_loss: 2044.0711; train_edge_recon_loss: 77338.3547; train_gene_expr_recon_loss: 101664.4823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181046.9086; train_optim_loss: 181046.9086; val_kl_reg_loss: 2019.5374; val_edge_recon_loss: 77098.6510; val_gene_expr_recon_loss: 102509.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181627.9375; val_optim_loss: 181627.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9851; val_auprc_score: 0.9968; val_best_acc_score: 0.9716; val_best_f1_score: 0.9836; train_kl_reg_loss: 2046.5921; train_edge_recon_loss: 76461.6495; train_gene_expr_recon_loss: 100864.2685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179372.5104; train_optim_loss: 179372.5104; val_kl_reg_loss: 1976.8291; val_edge_recon_loss: 77005.0234; val_gene_expr_recon_loss: 101628.6927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180610.5521; val_optim_loss: 180610.5521
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9851; val_auprc_score: 0.9961; val_best_acc_score: 0.9735; val_best_f1_score: 0.9846; train_kl_reg_loss: 2008.6842; train_edge_recon_loss: 76983.7914; train_gene_expr_recon_loss: 100336.2989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179328.7726; train_optim_loss: 179328.7726; val_kl_reg_loss: 1978.1264; val_edge_recon_loss: 76963.2448; val_gene_expr_recon_loss: 101095.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180036.4219; val_optim_loss: 180036.4219
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9846; val_auprc_score: 0.9963; val_best_acc_score: 0.9743; val_best_f1_score: 0.9851; train_kl_reg_loss: 1999.3346; train_edge_recon_loss: 76377.9294; train_gene_expr_recon_loss: 99862.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178239.7106; train_optim_loss: 178239.7106; val_kl_reg_loss: 1941.2521; val_edge_recon_loss: 74825.7448; val_gene_expr_recon_loss: 101047.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177814.4167; val_optim_loss: 177814.4167
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9873; val_auprc_score: 0.9971; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 1987.0073; train_edge_recon_loss: 77422.1328; train_gene_expr_recon_loss: 99578.3111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178987.4525; train_optim_loss: 178987.4525; val_kl_reg_loss: 1977.8181; val_edge_recon_loss: 78409.8047; val_gene_expr_recon_loss: 100666.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181054.5000; val_optim_loss: 181054.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9863; val_auprc_score: 0.9967; val_best_acc_score: 0.9765; val_best_f1_score: 0.9864; train_kl_reg_loss: 1982.1761; train_edge_recon_loss: 77837.4705; train_gene_expr_recon_loss: 99140.2497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178959.8935; train_optim_loss: 178959.8935; val_kl_reg_loss: 1956.5618; val_edge_recon_loss: 74934.2135; val_gene_expr_recon_loss: 100469.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177360.7500; val_optim_loss: 177360.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9884; val_auprc_score: 0.9967; val_best_acc_score: 0.9783; val_best_f1_score: 0.9874; train_kl_reg_loss: 1969.5005; train_edge_recon_loss: 76144.5952; train_gene_expr_recon_loss: 98999.8600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177113.9560; train_optim_loss: 177113.9560; val_kl_reg_loss: 1919.2360; val_edge_recon_loss: 76457.9219; val_gene_expr_recon_loss: 99538.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177915.6094; val_optim_loss: 177915.6094
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9967; val_best_acc_score: 0.9771; val_best_f1_score: 0.9866; train_kl_reg_loss: 1966.7499; train_edge_recon_loss: 77657.8186; train_gene_expr_recon_loss: 98495.4149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178119.9850; train_optim_loss: 178119.9850; val_kl_reg_loss: 1923.5501; val_edge_recon_loss: 76977.4974; val_gene_expr_recon_loss: 99374.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178276.0208; val_optim_loss: 178276.0208
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9870; val_auprc_score: 0.9968; val_best_acc_score: 0.9771; val_best_f1_score: 0.9867; train_kl_reg_loss: 1955.8367; train_edge_recon_loss: 76279.1392; train_gene_expr_recon_loss: 98345.5584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176580.5336; train_optim_loss: 176580.5336; val_kl_reg_loss: 1967.5436; val_edge_recon_loss: 77309.5885; val_gene_expr_recon_loss: 99538.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178815.2917; val_optim_loss: 178815.2917

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9866; val_auprc_score: 0.9957; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1978.0072; train_edge_recon_loss: 76828.2975; train_gene_expr_recon_loss: 98264.8666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177071.1719; train_optim_loss: 177071.1719; val_kl_reg_loss: 1915.1106; val_edge_recon_loss: 74852.6693; val_gene_expr_recon_loss: 99483.5573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176251.3333; val_optim_loss: 176251.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9881; val_auprc_score: 0.9974; val_best_acc_score: 0.9782; val_best_f1_score: 0.9873; train_kl_reg_loss: 1952.0051; train_edge_recon_loss: 76773.7859; train_gene_expr_recon_loss: 98080.0761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176805.8698; train_optim_loss: 176805.8698; val_kl_reg_loss: 1912.7448; val_edge_recon_loss: 76381.0964; val_gene_expr_recon_loss: 99033.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177327.2865; val_optim_loss: 177327.2865
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9864; val_auprc_score: 0.9969; val_best_acc_score: 0.9774; val_best_f1_score: 0.9869; train_kl_reg_loss: 1950.1415; train_edge_recon_loss: 76371.1629; train_gene_expr_recon_loss: 98077.5518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176398.8571; train_optim_loss: 176398.8571; val_kl_reg_loss: 1906.0828; val_edge_recon_loss: 76020.8099; val_gene_expr_recon_loss: 98937.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176864.8698; val_optim_loss: 176864.8698
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9883; val_auprc_score: 0.9971; val_best_acc_score: 0.9793; val_best_f1_score: 0.9880; train_kl_reg_loss: 1957.8927; train_edge_recon_loss: 76563.3409; train_gene_expr_recon_loss: 97884.7763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176406.0081; train_optim_loss: 176406.0081; val_kl_reg_loss: 1913.6550; val_edge_recon_loss: 75392.4583; val_gene_expr_recon_loss: 98926.9245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176233.0365; val_optim_loss: 176233.0365
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9883; val_auprc_score: 0.9965; val_best_acc_score: 0.9787; val_best_f1_score: 0.9876; train_kl_reg_loss: 1946.1938; train_edge_recon_loss: 76274.2370; train_gene_expr_recon_loss: 97982.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176202.7662; train_optim_loss: 176202.7662; val_kl_reg_loss: 1900.9645; val_edge_recon_loss: 79012.6406; val_gene_expr_recon_loss: 99137.0521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180050.6562; val_optim_loss: 180050.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9880; val_auprc_score: 0.9961; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1945.3815; train_edge_recon_loss: 75799.5758; train_gene_expr_recon_loss: 97846.3938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175591.3490; train_optim_loss: 175591.3490; val_kl_reg_loss: 1910.5971; val_edge_recon_loss: 75831.7917; val_gene_expr_recon_loss: 98974.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176716.4323; val_optim_loss: 176716.4323
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9869; val_auprc_score: 0.9972; val_best_acc_score: 0.9791; val_best_f1_score: 0.9879; train_kl_reg_loss: 1947.0915; train_edge_recon_loss: 76772.1698; train_gene_expr_recon_loss: 97702.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176421.6331; train_optim_loss: 176421.6331; val_kl_reg_loss: 1905.5173; val_edge_recon_loss: 74027.4635; val_gene_expr_recon_loss: 99030.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174963.9583; val_optim_loss: 174963.9583
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9863; val_auprc_score: 0.9965; val_best_acc_score: 0.9781; val_best_f1_score: 0.9873; train_kl_reg_loss: 1947.8212; train_edge_recon_loss: 76606.4401; train_gene_expr_recon_loss: 97703.0802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176257.3414; train_optim_loss: 176257.3414; val_kl_reg_loss: 1912.8902; val_edge_recon_loss: 76213.0234; val_gene_expr_recon_loss: 98710.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176836.2969; val_optim_loss: 176836.2969
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9897; val_auprc_score: 0.9968; val_best_acc_score: 0.9794; val_best_f1_score: 0.9880; train_kl_reg_loss: 1945.0803; train_edge_recon_loss: 76694.6930; train_gene_expr_recon_loss: 97794.3044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176434.0793; train_optim_loss: 176434.0793; val_kl_reg_loss: 1898.9589; val_edge_recon_loss: 75794.2422; val_gene_expr_recon_loss: 98577.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176270.4583; val_optim_loss: 176270.4583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9889; val_auprc_score: 0.9976; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 1934.5601; train_edge_recon_loss: 76931.0110; train_gene_expr_recon_loss: 97736.3582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176601.9300; train_optim_loss: 176601.9300; val_kl_reg_loss: 1906.2731; val_edge_recon_loss: 77460.0078; val_gene_expr_recon_loss: 98725.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178091.3385; val_optim_loss: 178091.3385

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9895; val_auprc_score: 0.9977; val_best_acc_score: 0.9794; val_best_f1_score: 0.9881; train_kl_reg_loss: 1946.0066; train_edge_recon_loss: 77194.2303; train_gene_expr_recon_loss: 97712.1976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176852.4363; train_optim_loss: 176852.4363; val_kl_reg_loss: 1907.3899; val_edge_recon_loss: 74836.2786; val_gene_expr_recon_loss: 98797.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175540.9792; val_optim_loss: 175540.9792
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9891; val_auprc_score: 0.9968; val_best_acc_score: 0.9784; val_best_f1_score: 0.9874; train_kl_reg_loss: 1944.3412; train_edge_recon_loss: 77275.3527; train_gene_expr_recon_loss: 97704.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176924.4826; train_optim_loss: 176924.4826; val_kl_reg_loss: 1905.6085; val_edge_recon_loss: 77684.5859; val_gene_expr_recon_loss: 98287.6068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177877.8021; val_optim_loss: 177877.8021
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9874; val_auprc_score: 0.9970; val_best_acc_score: 0.9791; val_best_f1_score: 0.9879; train_kl_reg_loss: 1947.0342; train_edge_recon_loss: 77300.6372; train_gene_expr_recon_loss: 97692.9198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176940.5920; train_optim_loss: 176940.5920; val_kl_reg_loss: 1911.6529; val_edge_recon_loss: 76327.3958; val_gene_expr_recon_loss: 99084.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177323.3333; val_optim_loss: 177323.3333

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 18 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9899
Val AUPRC score: 0.9979
Val best accuracy score: 0.9803
Val best F1 score: 0.9886
Val gene expr MSE score: 1.0657
Duration of model training in run 4: 0 hours, 2 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9490; val_auprc_score: 0.9886; val_best_acc_score: 0.9352; val_best_f1_score: 0.9625; train_kl_reg_loss: 1454.1982; train_edge_recon_loss: 89351.8016; train_gene_expr_recon_loss: 109441.7384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200247.7399; train_optim_loss: 200247.7399; val_kl_reg_loss: 2067.7263; val_edge_recon_loss: 81544.6267; val_gene_expr_recon_loss: 104669.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188281.9444; val_optim_loss: 188281.9444
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9827; val_auprc_score: 0.9953; val_best_acc_score: 0.9705; val_best_f1_score: 0.9828; train_kl_reg_loss: 2066.0066; train_edge_recon_loss: 78153.5748; train_gene_expr_recon_loss: 103288.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183507.8370; train_optim_loss: 183507.8370; val_kl_reg_loss: 1976.0745; val_edge_recon_loss: 76741.8290; val_gene_expr_recon_loss: 101971.9028; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180689.8073; val_optim_loss: 180689.8073
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9869; val_auprc_score: 0.9971; val_best_acc_score: 0.9743; val_best_f1_score: 0.9850; train_kl_reg_loss: 2039.1369; train_edge_recon_loss: 77407.2248; train_gene_expr_recon_loss: 101124.7991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180571.1606; train_optim_loss: 180571.1606; val_kl_reg_loss: 2050.6168; val_edge_recon_loss: 77337.6311; val_gene_expr_recon_loss: 100637.7439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180025.9948; val_optim_loss: 180025.9948
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9854; val_auprc_score: 0.9965; val_best_acc_score: 0.9763; val_best_f1_score: 0.9862; train_kl_reg_loss: 1994.7101; train_edge_recon_loss: 76769.1952; train_gene_expr_recon_loss: 99700.0292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178463.9349; train_optim_loss: 178463.9349; val_kl_reg_loss: 1958.5912; val_edge_recon_loss: 75729.8932; val_gene_expr_recon_loss: 98740.9679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176429.4514; val_optim_loss: 176429.4514
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9863; val_auprc_score: 0.9969; val_best_acc_score: 0.9768; val_best_f1_score: 0.9864; train_kl_reg_loss: 1970.6693; train_edge_recon_loss: 76823.6817; train_gene_expr_recon_loss: 98814.6264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177608.9771; train_optim_loss: 177608.9771; val_kl_reg_loss: 1992.3670; val_edge_recon_loss: 77966.7049; val_gene_expr_recon_loss: 98324.7335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178283.8021; val_optim_loss: 178283.8021
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9892; val_auprc_score: 0.9977; val_best_acc_score: 0.9774; val_best_f1_score: 0.9868; train_kl_reg_loss: 1952.5234; train_edge_recon_loss: 76475.4391; train_gene_expr_recon_loss: 97969.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176397.4128; train_optim_loss: 176397.4128; val_kl_reg_loss: 1954.5497; val_edge_recon_loss: 77327.9384; val_gene_expr_recon_loss: 97625.8585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176908.3455; val_optim_loss: 176908.3455
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9892; val_auprc_score: 0.9975; val_best_acc_score: 0.9813; val_best_f1_score: 0.9891; train_kl_reg_loss: 1941.8235; train_edge_recon_loss: 77221.4166; train_gene_expr_recon_loss: 97332.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176495.2561; train_optim_loss: 176495.2561; val_kl_reg_loss: 1978.5457; val_edge_recon_loss: 75950.7535; val_gene_expr_recon_loss: 96851.4618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174780.7604; val_optim_loss: 174780.7604
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9913; val_auprc_score: 0.9981; val_best_acc_score: 0.9817; val_best_f1_score: 0.9893; train_kl_reg_loss: 1948.3078; train_edge_recon_loss: 76370.0592; train_gene_expr_recon_loss: 96819.0264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175137.3938; train_optim_loss: 175137.3938; val_kl_reg_loss: 1983.8226; val_edge_recon_loss: 76530.8932; val_gene_expr_recon_loss: 96684.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175199.6562; val_optim_loss: 175199.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9892; val_auprc_score: 0.9972; val_best_acc_score: 0.9805; val_best_f1_score: 0.9886; train_kl_reg_loss: 1948.9965; train_edge_recon_loss: 75921.1526; train_gene_expr_recon_loss: 96141.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174011.1665; train_optim_loss: 174011.1665; val_kl_reg_loss: 1926.4522; val_edge_recon_loss: 77837.5417; val_gene_expr_recon_loss: 95965.1944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175729.1910; val_optim_loss: 175729.1910
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9876; val_auprc_score: 0.9960; val_best_acc_score: 0.9811; val_best_f1_score: 0.9890; train_kl_reg_loss: 1938.9709; train_edge_recon_loss: 76520.6046; train_gene_expr_recon_loss: 95749.7428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174209.3178; train_optim_loss: 174209.3178; val_kl_reg_loss: 1941.4683; val_edge_recon_loss: 77346.9184; val_gene_expr_recon_loss: 95413.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174701.8177; val_optim_loss: 174701.8177
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9930; val_auprc_score: 0.9986; val_best_acc_score: 0.9828; val_best_f1_score: 0.9899; train_kl_reg_loss: 1940.5619; train_edge_recon_loss: 76263.1709; train_gene_expr_recon_loss: 95296.7218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173500.4547; train_optim_loss: 173500.4547; val_kl_reg_loss: 1943.7497; val_edge_recon_loss: 76249.0061; val_gene_expr_recon_loss: 95050.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173243.6944; val_optim_loss: 173243.6944
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9916; val_auprc_score: 0.9980; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1947.0591; train_edge_recon_loss: 76716.3550; train_gene_expr_recon_loss: 94880.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173543.7743; train_optim_loss: 173543.7743; val_kl_reg_loss: 1936.0835; val_edge_recon_loss: 75260.9115; val_gene_expr_recon_loss: 94735.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171932.6684; val_optim_loss: 171932.6684
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9923; val_auprc_score: 0.9979; val_best_acc_score: 0.9844; val_best_f1_score: 0.9909; train_kl_reg_loss: 1939.3200; train_edge_recon_loss: 76276.7190; train_gene_expr_recon_loss: 94520.9189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172736.9585; train_optim_loss: 172736.9585; val_kl_reg_loss: 1897.0602; val_edge_recon_loss: 76700.0104; val_gene_expr_recon_loss: 94748.6276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173345.7014; val_optim_loss: 173345.7014
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9985; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1942.1226; train_edge_recon_loss: 76097.8549; train_gene_expr_recon_loss: 94306.5311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172346.5085; train_optim_loss: 172346.5085; val_kl_reg_loss: 1904.6897; val_edge_recon_loss: 74924.5165; val_gene_expr_recon_loss: 94246.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171075.3003; val_optim_loss: 171075.3003
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9912; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9905; train_kl_reg_loss: 1946.4517; train_edge_recon_loss: 77000.3720; train_gene_expr_recon_loss: 93896.7756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172843.5997; train_optim_loss: 172843.5997; val_kl_reg_loss: 1917.3859; val_edge_recon_loss: 77652.5208; val_gene_expr_recon_loss: 93970.2248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173540.1285; val_optim_loss: 173540.1285
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9930; val_auprc_score: 0.9980; val_best_acc_score: 0.9860; val_best_f1_score: 0.9918; train_kl_reg_loss: 1948.5037; train_edge_recon_loss: 76387.9802; train_gene_expr_recon_loss: 93740.8254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172077.3087; train_optim_loss: 172077.3087; val_kl_reg_loss: 1948.1446; val_edge_recon_loss: 77058.9861; val_gene_expr_recon_loss: 93817.4549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172824.5885; val_optim_loss: 172824.5885
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9920; val_auprc_score: 0.9977; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1956.8993; train_edge_recon_loss: 77226.0933; train_gene_expr_recon_loss: 93504.1770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172687.1691; train_optim_loss: 172687.1691; val_kl_reg_loss: 1903.3038; val_edge_recon_loss: 75351.6901; val_gene_expr_recon_loss: 93374.7240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170629.7188; val_optim_loss: 170629.7188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9919; val_auprc_score: 0.9979; val_best_acc_score: 0.9854; val_best_f1_score: 0.9915; train_kl_reg_loss: 1947.1191; train_edge_recon_loss: 75684.9026; train_gene_expr_recon_loss: 93302.0519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170934.0732; train_optim_loss: 170934.0732; val_kl_reg_loss: 1949.3414; val_edge_recon_loss: 75876.5781; val_gene_expr_recon_loss: 93090.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170916.4323; val_optim_loss: 170916.4323
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9917; val_auprc_score: 0.9979; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1955.6623; train_edge_recon_loss: 76209.1922; train_gene_expr_recon_loss: 92778.6646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170943.5188; train_optim_loss: 170943.5188; val_kl_reg_loss: 1939.1731; val_edge_recon_loss: 77434.4905; val_gene_expr_recon_loss: 93124.1076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172497.7708; val_optim_loss: 172497.7708
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9937; val_auprc_score: 0.9981; val_best_acc_score: 0.9853; val_best_f1_score: 0.9914; train_kl_reg_loss: 1958.5675; train_edge_recon_loss: 76353.3803; train_gene_expr_recon_loss: 92768.3910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171080.3392; train_optim_loss: 171080.3392; val_kl_reg_loss: 1979.0398; val_edge_recon_loss: 77995.0538; val_gene_expr_recon_loss: 92655.9644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172630.0625; val_optim_loss: 172630.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9930; val_auprc_score: 0.9976; val_best_acc_score: 0.9855; val_best_f1_score: 0.9915; train_kl_reg_loss: 1969.6994; train_edge_recon_loss: 76211.6882; train_gene_expr_recon_loss: 92458.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170639.5067; train_optim_loss: 170639.5067; val_kl_reg_loss: 1928.4302; val_edge_recon_loss: 76432.4236; val_gene_expr_recon_loss: 92546.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170907.6163; val_optim_loss: 170907.6163
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9935; val_auprc_score: 0.9986; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1955.2222; train_edge_recon_loss: 75788.5627; train_gene_expr_recon_loss: 92348.1642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170091.9492; train_optim_loss: 170091.9492; val_kl_reg_loss: 1935.2056; val_edge_recon_loss: 75873.2648; val_gene_expr_recon_loss: 92112.2830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169920.7517; val_optim_loss: 169920.7517
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9923; val_auprc_score: 0.9981; val_best_acc_score: 0.9869; val_best_f1_score: 0.9924; train_kl_reg_loss: 1956.6625; train_edge_recon_loss: 76548.1701; train_gene_expr_recon_loss: 92162.2128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170667.0449; train_optim_loss: 170667.0449; val_kl_reg_loss: 1937.6879; val_edge_recon_loss: 75406.1814; val_gene_expr_recon_loss: 92461.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169805.7691; val_optim_loss: 169805.7691
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9939; val_auprc_score: 0.9984; val_best_acc_score: 0.9860; val_best_f1_score: 0.9918; train_kl_reg_loss: 1956.8750; train_edge_recon_loss: 75708.0752; train_gene_expr_recon_loss: 92193.4039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169858.3536; train_optim_loss: 169858.3536; val_kl_reg_loss: 1928.8902; val_edge_recon_loss: 76044.5486; val_gene_expr_recon_loss: 92213.3507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170186.7899; val_optim_loss: 170186.7899
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9931; val_auprc_score: 0.9980; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 1952.3125; train_edge_recon_loss: 76284.6525; train_gene_expr_recon_loss: 92315.7175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170552.6837; train_optim_loss: 170552.6837; val_kl_reg_loss: 1929.5697; val_edge_recon_loss: 76134.5521; val_gene_expr_recon_loss: 92399.3064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170463.4236; val_optim_loss: 170463.4236
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9946; val_auprc_score: 0.9988; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1955.6399; train_edge_recon_loss: 76258.2734; train_gene_expr_recon_loss: 92246.8312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170460.7447; train_optim_loss: 170460.7447; val_kl_reg_loss: 1924.0712; val_edge_recon_loss: 75135.5148; val_gene_expr_recon_loss: 91987.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169047.4219; val_optim_loss: 169047.4219
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9943; val_auprc_score: 0.9987; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 1952.1958; train_edge_recon_loss: 75492.1814; train_gene_expr_recon_loss: 92124.7624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169569.1386; train_optim_loss: 169569.1386; val_kl_reg_loss: 1919.6494; val_edge_recon_loss: 74777.7179; val_gene_expr_recon_loss: 92470.1780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169167.5417; val_optim_loss: 169167.5417
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9910; val_auprc_score: 0.9964; val_best_acc_score: 0.9862; val_best_f1_score: 0.9920; train_kl_reg_loss: 1948.7134; train_edge_recon_loss: 75889.8455; train_gene_expr_recon_loss: 92129.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169968.4225; train_optim_loss: 169968.4225; val_kl_reg_loss: 1933.5217; val_edge_recon_loss: 75361.8741; val_gene_expr_recon_loss: 92188.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169484.0052; val_optim_loss: 169484.0052
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9930; val_auprc_score: 0.9983; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1954.5008; train_edge_recon_loss: 76455.1620; train_gene_expr_recon_loss: 92177.3769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170587.0392; train_optim_loss: 170587.0392; val_kl_reg_loss: 1929.8848; val_edge_recon_loss: 77119.1224; val_gene_expr_recon_loss: 92247.5799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171296.5903; val_optim_loss: 171296.5903

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9951; val_auprc_score: 0.9985; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1954.1049; train_edge_recon_loss: 75954.6366; train_gene_expr_recon_loss: 92104.1727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170012.9140; train_optim_loss: 170012.9140; val_kl_reg_loss: 1931.8696; val_edge_recon_loss: 74241.3880; val_gene_expr_recon_loss: 92265.0503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168438.3038; val_optim_loss: 168438.3038
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9915; val_auprc_score: 0.9974; val_best_acc_score: 0.9856; val_best_f1_score: 0.9917; train_kl_reg_loss: 1950.9572; train_edge_recon_loss: 75906.9107; train_gene_expr_recon_loss: 92047.8396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169905.7075; train_optim_loss: 169905.7075; val_kl_reg_loss: 1928.7798; val_edge_recon_loss: 74846.3255; val_gene_expr_recon_loss: 92156.5495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168931.6545; val_optim_loss: 168931.6545
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9917; val_auprc_score: 0.9974; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1953.2566; train_edge_recon_loss: 76027.7296; train_gene_expr_recon_loss: 92065.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170046.2737; train_optim_loss: 170046.2737; val_kl_reg_loss: 1928.9408; val_edge_recon_loss: 75546.8125; val_gene_expr_recon_loss: 91736.0608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169211.8142; val_optim_loss: 169211.8142
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9932; val_auprc_score: 0.9977; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1953.9910; train_edge_recon_loss: 76086.4546; train_gene_expr_recon_loss: 92019.1580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170059.6038; train_optim_loss: 170059.6038; val_kl_reg_loss: 1933.9360; val_edge_recon_loss: 74753.6519; val_gene_expr_recon_loss: 92028.1814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168715.7691; val_optim_loss: 168715.7691

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9915; val_auprc_score: 0.9971; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 1954.7217; train_edge_recon_loss: 76473.4704; train_gene_expr_recon_loss: 92126.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170554.5831; train_optim_loss: 170554.5831; val_kl_reg_loss: 1933.0195; val_edge_recon_loss: 75279.8108; val_gene_expr_recon_loss: 91995.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169208.6649; val_optim_loss: 169208.6649
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9923; val_auprc_score: 0.9976; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 1954.6537; train_edge_recon_loss: 75806.0134; train_gene_expr_recon_loss: 91958.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169718.7176; train_optim_loss: 169718.7176; val_kl_reg_loss: 1931.0088; val_edge_recon_loss: 73277.3003; val_gene_expr_recon_loss: 91973.6102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167181.9201; val_optim_loss: 167181.9201
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9978; val_best_acc_score: 0.9858; val_best_f1_score: 0.9917; train_kl_reg_loss: 1954.2979; train_edge_recon_loss: 75676.2767; train_gene_expr_recon_loss: 92165.4392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169796.0138; train_optim_loss: 169796.0138; val_kl_reg_loss: 1930.8219; val_edge_recon_loss: 76365.8125; val_gene_expr_recon_loss: 91882.4097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170179.0434; val_optim_loss: 170179.0434
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9932; val_auprc_score: 0.9974; val_best_acc_score: 0.9869; val_best_f1_score: 0.9923; train_kl_reg_loss: 1953.0250; train_edge_recon_loss: 76548.8406; train_gene_expr_recon_loss: 92091.4608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170593.3261; train_optim_loss: 170593.3261; val_kl_reg_loss: 1931.5199; val_edge_recon_loss: 75739.1224; val_gene_expr_recon_loss: 92028.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169699.6215; val_optim_loss: 169699.6215
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9925; val_auprc_score: 0.9978; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1953.2654; train_edge_recon_loss: 75551.8646; train_gene_expr_recon_loss: 91944.4317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169449.5613; train_optim_loss: 169449.5613; val_kl_reg_loss: 1931.1131; val_edge_recon_loss: 75520.1719; val_gene_expr_recon_loss: 92137.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169588.3316; val_optim_loss: 169588.3316

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9940; val_auprc_score: 0.9981; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1953.5526; train_edge_recon_loss: 76472.4337; train_gene_expr_recon_loss: 91992.7735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170418.7599; train_optim_loss: 170418.7599; val_kl_reg_loss: 1929.7581; val_edge_recon_loss: 76212.3863; val_gene_expr_recon_loss: 92238.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170380.9375; val_optim_loss: 170380.9375
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9931; val_auprc_score: 0.9979; val_best_acc_score: 0.9861; val_best_f1_score: 0.9919; train_kl_reg_loss: 1953.4128; train_edge_recon_loss: 75866.0617; train_gene_expr_recon_loss: 91906.4616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169725.9361; train_optim_loss: 169725.9361; val_kl_reg_loss: 1930.8368; val_edge_recon_loss: 76570.5530; val_gene_expr_recon_loss: 92283.2396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170784.6250; val_optim_loss: 170784.6250
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9904; val_auprc_score: 0.9975; val_best_acc_score: 0.9859; val_best_f1_score: 0.9918; train_kl_reg_loss: 1953.3204; train_edge_recon_loss: 75673.9144; train_gene_expr_recon_loss: 92026.2360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169653.4715; train_optim_loss: 169653.4715; val_kl_reg_loss: 1931.5321; val_edge_recon_loss: 76460.7760; val_gene_expr_recon_loss: 92412.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170804.9757; val_optim_loss: 170804.9757

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 31 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9925
Val AUPRC score: 0.9975
Val best accuracy score: 0.9864
Val best F1 score: 0.9920
Val gene expr MSE score: 0.9216
Duration of model training in run 5: 0 hours, 7 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9604; val_auprc_score: 0.9913; val_best_acc_score: 0.9394; val_best_f1_score: 0.9648; train_kl_reg_loss: 1378.4890; train_edge_recon_loss: 90014.7399; train_gene_expr_recon_loss: 110614.0307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202007.2599; train_optim_loss: 202007.2599; val_kl_reg_loss: 2017.2914; val_edge_recon_loss: 79010.1719; val_gene_expr_recon_loss: 106819.0347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187846.4965; val_optim_loss: 187846.4965
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9800; val_auprc_score: 0.9957; val_best_acc_score: 0.9650; val_best_f1_score: 0.9797; train_kl_reg_loss: 2065.5211; train_edge_recon_loss: 78836.2935; train_gene_expr_recon_loss: 104328.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185230.5047; train_optim_loss: 185230.5047; val_kl_reg_loss: 1998.7331; val_edge_recon_loss: 76801.1293; val_gene_expr_recon_loss: 103573.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182372.8785; val_optim_loss: 182372.8785
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9870; val_auprc_score: 0.9970; val_best_acc_score: 0.9748; val_best_f1_score: 0.9853; train_kl_reg_loss: 2042.7045; train_edge_recon_loss: 76929.9805; train_gene_expr_recon_loss: 101872.0098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180844.6948; train_optim_loss: 180844.6948; val_kl_reg_loss: 1994.3075; val_edge_recon_loss: 78528.3064; val_gene_expr_recon_loss: 102124.4045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182647.0174; val_optim_loss: 182647.0174
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9967; val_best_acc_score: 0.9758; val_best_f1_score: 0.9859; train_kl_reg_loss: 1994.4005; train_edge_recon_loss: 76745.4322; train_gene_expr_recon_loss: 100668.0676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179407.9003; train_optim_loss: 179407.9003; val_kl_reg_loss: 1911.2486; val_edge_recon_loss: 76584.8116; val_gene_expr_recon_loss: 100490.3481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178986.4149; val_optim_loss: 178986.4149
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9866; val_auprc_score: 0.9968; val_best_acc_score: 0.9768; val_best_f1_score: 0.9865; train_kl_reg_loss: 1967.1657; train_edge_recon_loss: 76950.4732; train_gene_expr_recon_loss: 99542.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178460.2156; train_optim_loss: 178460.2156; val_kl_reg_loss: 1927.0567; val_edge_recon_loss: 76551.2448; val_gene_expr_recon_loss: 99555.1189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178033.4219; val_optim_loss: 178033.4219
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9880; val_auprc_score: 0.9973; val_best_acc_score: 0.9786; val_best_f1_score: 0.9876; train_kl_reg_loss: 1960.8066; train_edge_recon_loss: 77341.9115; train_gene_expr_recon_loss: 98662.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177965.6187; train_optim_loss: 177965.6187; val_kl_reg_loss: 1992.4967; val_edge_recon_loss: 76412.6701; val_gene_expr_recon_loss: 99295.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177700.2431; val_optim_loss: 177700.2431
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9860; val_auprc_score: 0.9962; val_best_acc_score: 0.9800; val_best_f1_score: 0.9884; train_kl_reg_loss: 1944.5197; train_edge_recon_loss: 76525.5594; train_gene_expr_recon_loss: 98012.8708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176482.9490; train_optim_loss: 176482.9490; val_kl_reg_loss: 1920.7223; val_edge_recon_loss: 75402.4184; val_gene_expr_recon_loss: 98476.8064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175799.9462; val_optim_loss: 175799.9462
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9973; val_best_acc_score: 0.9819; val_best_f1_score: 0.9894; train_kl_reg_loss: 1944.4512; train_edge_recon_loss: 76351.3057; train_gene_expr_recon_loss: 97450.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175746.1930; train_optim_loss: 175746.1930; val_kl_reg_loss: 1933.2156; val_edge_recon_loss: 77274.1988; val_gene_expr_recon_loss: 98005.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177212.6233; val_optim_loss: 177212.6233
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9895; val_auprc_score: 0.9967; val_best_acc_score: 0.9834; val_best_f1_score: 0.9903; train_kl_reg_loss: 1942.6737; train_edge_recon_loss: 76761.2921; train_gene_expr_recon_loss: 96797.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175501.1448; train_optim_loss: 175501.1448; val_kl_reg_loss: 1904.8892; val_edge_recon_loss: 78271.8568; val_gene_expr_recon_loss: 97344.1840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177520.9306; val_optim_loss: 177520.9306
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9905; val_auprc_score: 0.9968; val_best_acc_score: 0.9836; val_best_f1_score: 0.9904; train_kl_reg_loss: 1938.2152; train_edge_recon_loss: 76350.8450; train_gene_expr_recon_loss: 96227.6164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174516.6764; train_optim_loss: 174516.6764; val_kl_reg_loss: 1879.5483; val_edge_recon_loss: 77386.3724; val_gene_expr_recon_loss: 96903.7760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176169.6944; val_optim_loss: 176169.6944

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9892; val_auprc_score: 0.9974; val_best_acc_score: 0.9820; val_best_f1_score: 0.9895; train_kl_reg_loss: 1929.1545; train_edge_recon_loss: 76409.9334; train_gene_expr_recon_loss: 95728.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174067.2051; train_optim_loss: 174067.2051; val_kl_reg_loss: 1917.8729; val_edge_recon_loss: 77303.8168; val_gene_expr_recon_loss: 96461.7986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175683.4913; val_optim_loss: 175683.4913
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9895; val_auprc_score: 0.9969; val_best_acc_score: 0.9831; val_best_f1_score: 0.9901; train_kl_reg_loss: 1932.9765; train_edge_recon_loss: 76081.2044; train_gene_expr_recon_loss: 95624.4043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173638.5858; train_optim_loss: 173638.5858; val_kl_reg_loss: 1900.2354; val_edge_recon_loss: 76431.3030; val_gene_expr_recon_loss: 96640.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174971.6319; val_optim_loss: 174971.6319
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9888; val_auprc_score: 0.9964; val_best_acc_score: 0.9836; val_best_f1_score: 0.9905; train_kl_reg_loss: 1931.1085; train_edge_recon_loss: 76249.1979; train_gene_expr_recon_loss: 95621.5313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173801.8376; train_optim_loss: 173801.8376; val_kl_reg_loss: 1908.0792; val_edge_recon_loss: 76547.3481; val_gene_expr_recon_loss: 96523.7326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174979.1597; val_optim_loss: 174979.1597
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9899; val_auprc_score: 0.9974; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1931.7698; train_edge_recon_loss: 75726.3102; train_gene_expr_recon_loss: 95682.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173340.1984; train_optim_loss: 173340.1984; val_kl_reg_loss: 1898.4129; val_edge_recon_loss: 75413.1953; val_gene_expr_recon_loss: 96515.6137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173827.2222; val_optim_loss: 173827.2222
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9897; val_auprc_score: 0.9971; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 1927.5803; train_edge_recon_loss: 76358.1652; train_gene_expr_recon_loss: 95487.8413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173773.5874; train_optim_loss: 173773.5874; val_kl_reg_loss: 1891.1872; val_edge_recon_loss: 75218.3238; val_gene_expr_recon_loss: 96460.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173570.1545; val_optim_loss: 173570.1545
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9909; val_auprc_score: 0.9974; val_best_acc_score: 0.9842; val_best_f1_score: 0.9908; train_kl_reg_loss: 1928.5585; train_edge_recon_loss: 75764.6071; train_gene_expr_recon_loss: 95434.2385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173127.4051; train_optim_loss: 173127.4051; val_kl_reg_loss: 1910.7055; val_edge_recon_loss: 76969.9410; val_gene_expr_recon_loss: 96011.2248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174891.8715; val_optim_loss: 174891.8715
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9906; val_auprc_score: 0.9974; val_best_acc_score: 0.9833; val_best_f1_score: 0.9903; train_kl_reg_loss: 1929.2136; train_edge_recon_loss: 76990.4675; train_gene_expr_recon_loss: 95357.3862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174277.0670; train_optim_loss: 174277.0670; val_kl_reg_loss: 1918.2115; val_edge_recon_loss: 75604.0955; val_gene_expr_recon_loss: 96561.0920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174083.3958; val_optim_loss: 174083.3958
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9924; val_auprc_score: 0.9983; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1926.8296; train_edge_recon_loss: 76136.1321; train_gene_expr_recon_loss: 95417.1810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173480.1418; train_optim_loss: 173480.1418; val_kl_reg_loss: 1905.3995; val_edge_recon_loss: 75460.3637; val_gene_expr_recon_loss: 96052.1120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173417.8733; val_optim_loss: 173417.8733
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9908; val_auprc_score: 0.9971; val_best_acc_score: 0.9845; val_best_f1_score: 0.9909; train_kl_reg_loss: 1932.4106; train_edge_recon_loss: 76205.0454; train_gene_expr_recon_loss: 95391.2348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173528.6905; train_optim_loss: 173528.6905; val_kl_reg_loss: 1901.0555; val_edge_recon_loss: 78128.1944; val_gene_expr_recon_loss: 96255.3507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176284.5955; val_optim_loss: 176284.5955
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9906; val_auprc_score: 0.9973; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1925.1341; train_edge_recon_loss: 76261.8366; train_gene_expr_recon_loss: 95361.0937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173548.0651; train_optim_loss: 173548.0651; val_kl_reg_loss: 1905.8397; val_edge_recon_loss: 78539.3247; val_gene_expr_recon_loss: 96093.9670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176539.1285; val_optim_loss: 176539.1285
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9915; val_auprc_score: 0.9978; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1926.8556; train_edge_recon_loss: 76014.7034; train_gene_expr_recon_loss: 95316.6310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173258.1911; train_optim_loss: 173258.1911; val_kl_reg_loss: 1902.8920; val_edge_recon_loss: 77145.3915; val_gene_expr_recon_loss: 95941.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174990.0174; val_optim_loss: 174990.0174

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9897; val_auprc_score: 0.9969; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 1922.7160; train_edge_recon_loss: 75852.4159; train_gene_expr_recon_loss: 95265.7427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173040.8752; train_optim_loss: 173040.8752; val_kl_reg_loss: 1897.5322; val_edge_recon_loss: 75639.4010; val_gene_expr_recon_loss: 96086.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173623.3889; val_optim_loss: 173623.3889
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9916; val_auprc_score: 0.9982; val_best_acc_score: 0.9845; val_best_f1_score: 0.9910; train_kl_reg_loss: 1923.5639; train_edge_recon_loss: 76099.2733; train_gene_expr_recon_loss: 95279.7036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173302.5411; train_optim_loss: 173302.5411; val_kl_reg_loss: 1904.2907; val_edge_recon_loss: 76087.9080; val_gene_expr_recon_loss: 95795.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173788.1597; val_optim_loss: 173788.1597
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9911; val_auprc_score: 0.9977; val_best_acc_score: 0.9857; val_best_f1_score: 0.9917; train_kl_reg_loss: 1928.8809; train_edge_recon_loss: 75892.4079; train_gene_expr_recon_loss: 95349.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173170.3101; train_optim_loss: 173170.3101; val_kl_reg_loss: 1904.1503; val_edge_recon_loss: 75698.7222; val_gene_expr_recon_loss: 96002.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173605.3455; val_optim_loss: 173605.3455

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 55 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9921
Val AUPRC score: 0.9981
Val best accuracy score: 0.9853
Val best F1 score: 0.9914
Val gene expr MSE score: 0.9883
Duration of model training in run 6: 0 hours, 4 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9819; val_auprc_score: 0.9958; val_best_acc_score: 0.9696; val_best_f1_score: 0.9823; train_kl_reg_loss: 1696.3882; train_edge_recon_loss: 84114.9193; train_gene_expr_recon_loss: 106902.1520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192713.4597; train_optim_loss: 192713.4597; val_kl_reg_loss: 2012.6767; val_edge_recon_loss: 79840.6546; val_gene_expr_recon_loss: 101984.0143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183837.3464; val_optim_loss: 183837.3464
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9865; val_auprc_score: 0.9962; val_best_acc_score: 0.9784; val_best_f1_score: 0.9875; train_kl_reg_loss: 1994.2432; train_edge_recon_loss: 77612.3468; train_gene_expr_recon_loss: 100666.0119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180272.6023; train_optim_loss: 180272.6023; val_kl_reg_loss: 1943.5994; val_edge_recon_loss: 76752.5967; val_gene_expr_recon_loss: 99248.6647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177944.8613; val_optim_loss: 177944.8613
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9972; val_best_acc_score: 0.9799; val_best_f1_score: 0.9883; train_kl_reg_loss: 1956.0844; train_edge_recon_loss: 76963.7908; train_gene_expr_recon_loss: 98837.1137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177756.9892; train_optim_loss: 177756.9892; val_kl_reg_loss: 1953.5618; val_edge_recon_loss: 74763.7131; val_gene_expr_recon_loss: 97515.9056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174233.1803; val_optim_loss: 174233.1803
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9879; val_auprc_score: 0.9961; val_best_acc_score: 0.9829; val_best_f1_score: 0.9900; train_kl_reg_loss: 1934.1004; train_edge_recon_loss: 76540.9846; train_gene_expr_recon_loss: 97348.9950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175824.0793; train_optim_loss: 175824.0793; val_kl_reg_loss: 1901.4248; val_edge_recon_loss: 77013.6208; val_gene_expr_recon_loss: 96695.3509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175610.3965; val_optim_loss: 175610.3965
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9898; val_auprc_score: 0.9969; val_best_acc_score: 0.9826; val_best_f1_score: 0.9898; train_kl_reg_loss: 1935.0779; train_edge_recon_loss: 76742.3564; train_gene_expr_recon_loss: 96236.1112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174913.5459; train_optim_loss: 174913.5459; val_kl_reg_loss: 1932.0211; val_edge_recon_loss: 75216.2186; val_gene_expr_recon_loss: 95512.7637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172661.0026; val_optim_loss: 172661.0026
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9910; val_auprc_score: 0.9970; val_best_acc_score: 0.9855; val_best_f1_score: 0.9916; train_kl_reg_loss: 1932.3273; train_edge_recon_loss: 75971.8114; train_gene_expr_recon_loss: 95324.3703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173228.5089; train_optim_loss: 173228.5089; val_kl_reg_loss: 1889.4168; val_edge_recon_loss: 76390.3737; val_gene_expr_recon_loss: 94650.0472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172929.8379; val_optim_loss: 172929.8379
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9913; val_auprc_score: 0.9971; val_best_acc_score: 0.9839; val_best_f1_score: 0.9906; train_kl_reg_loss: 1936.5017; train_edge_recon_loss: 75992.6308; train_gene_expr_recon_loss: 94474.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172403.9536; train_optim_loss: 172403.9536; val_kl_reg_loss: 1945.4152; val_edge_recon_loss: 76867.0511; val_gene_expr_recon_loss: 94125.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172938.2246; val_optim_loss: 172938.2246
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9919; val_auprc_score: 0.9980; val_best_acc_score: 0.9851; val_best_f1_score: 0.9913; train_kl_reg_loss: 1941.7364; train_edge_recon_loss: 76185.9526; train_gene_expr_recon_loss: 93900.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172028.1168; train_optim_loss: 172028.1168; val_kl_reg_loss: 1908.1811; val_edge_recon_loss: 74768.4001; val_gene_expr_recon_loss: 93657.7373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170334.3171; val_optim_loss: 170334.3171
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9922; val_auprc_score: 0.9971; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1945.2799; train_edge_recon_loss: 76385.7750; train_gene_expr_recon_loss: 93461.6220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171792.6771; train_optim_loss: 171792.6771; val_kl_reg_loss: 1916.7911; val_edge_recon_loss: 76246.7852; val_gene_expr_recon_loss: 93114.0218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171277.5990; val_optim_loss: 171277.5990
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9919; val_auprc_score: 0.9974; val_best_acc_score: 0.9874; val_best_f1_score: 0.9926; train_kl_reg_loss: 1950.6605; train_edge_recon_loss: 76385.1688; train_gene_expr_recon_loss: 93015.7025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171351.5319; train_optim_loss: 171351.5319; val_kl_reg_loss: 1927.8888; val_edge_recon_loss: 74482.2679; val_gene_expr_recon_loss: 92580.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168990.8867; val_optim_loss: 168990.8867
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9928; val_auprc_score: 0.9981; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1951.6074; train_edge_recon_loss: 75866.7568; train_gene_expr_recon_loss: 92643.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170461.6342; train_optim_loss: 170461.6342; val_kl_reg_loss: 1915.8773; val_edge_recon_loss: 77131.3576; val_gene_expr_recon_loss: 92487.2061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171534.4408; val_optim_loss: 171534.4408
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9937; val_auprc_score: 0.9981; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1962.1702; train_edge_recon_loss: 76291.1508; train_gene_expr_recon_loss: 92301.7530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170555.0735; train_optim_loss: 170555.0735; val_kl_reg_loss: 1936.0222; val_edge_recon_loss: 75892.1410; val_gene_expr_recon_loss: 91944.4551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169772.6178; val_optim_loss: 169772.6178
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9927; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1964.2539; train_edge_recon_loss: 76235.2789; train_gene_expr_recon_loss: 92008.9601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170208.4935; train_optim_loss: 170208.4935; val_kl_reg_loss: 1934.0300; val_edge_recon_loss: 74235.6951; val_gene_expr_recon_loss: 91833.6221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168003.3477; val_optim_loss: 168003.3477
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9982; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1974.8509; train_edge_recon_loss: 76289.5653; train_gene_expr_recon_loss: 91600.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169865.1134; train_optim_loss: 169865.1134; val_kl_reg_loss: 1983.2213; val_edge_recon_loss: 74578.3470; val_gene_expr_recon_loss: 91691.7347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168253.3034; val_optim_loss: 168253.3034
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9925; val_auprc_score: 0.9972; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1973.5490; train_edge_recon_loss: 76087.9963; train_gene_expr_recon_loss: 91452.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169513.7029; train_optim_loss: 169513.7029; val_kl_reg_loss: 1993.5197; val_edge_recon_loss: 76943.1292; val_gene_expr_recon_loss: 91705.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170642.2344; val_optim_loss: 170642.2344
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9927; val_auprc_score: 0.9976; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1977.7983; train_edge_recon_loss: 75827.8900; train_gene_expr_recon_loss: 91180.9893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168986.6775; train_optim_loss: 168986.6775; val_kl_reg_loss: 1989.7938; val_edge_recon_loss: 75910.5874; val_gene_expr_recon_loss: 91263.3968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169163.7773; val_optim_loss: 169163.7773

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9948; val_auprc_score: 0.9983; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1988.3942; train_edge_recon_loss: 75674.5929; train_gene_expr_recon_loss: 90773.0952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168436.0822; train_optim_loss: 168436.0822; val_kl_reg_loss: 1960.7490; val_edge_recon_loss: 75488.3250; val_gene_expr_recon_loss: 91157.5892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168606.6647; val_optim_loss: 168606.6647
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9928; val_auprc_score: 0.9976; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1981.6982; train_edge_recon_loss: 76134.7581; train_gene_expr_recon_loss: 90704.2505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168820.7064; train_optim_loss: 168820.7064; val_kl_reg_loss: 1952.2782; val_edge_recon_loss: 77595.4557; val_gene_expr_recon_loss: 90791.4105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170339.1452; val_optim_loss: 170339.1452
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9932; val_auprc_score: 0.9981; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1974.6027; train_edge_recon_loss: 75428.7232; train_gene_expr_recon_loss: 90650.0688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168053.3947; train_optim_loss: 168053.3947; val_kl_reg_loss: 1962.4719; val_edge_recon_loss: 75101.3750; val_gene_expr_recon_loss: 90531.3301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167595.1771; val_optim_loss: 167595.1771
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9940; val_auprc_score: 0.9979; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1974.4777; train_edge_recon_loss: 75232.7607; train_gene_expr_recon_loss: 90634.0575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167841.2962; train_optim_loss: 167841.2962; val_kl_reg_loss: 1954.6215; val_edge_recon_loss: 74894.9276; val_gene_expr_recon_loss: 90697.4395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167546.9896; val_optim_loss: 167546.9896
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9988; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 1977.1219; train_edge_recon_loss: 76075.2874; train_gene_expr_recon_loss: 90608.5109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168660.9199; train_optim_loss: 168660.9199; val_kl_reg_loss: 1961.2435; val_edge_recon_loss: 76491.6777; val_gene_expr_recon_loss: 90826.2347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169279.1556; val_optim_loss: 169279.1556
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9924; val_auprc_score: 0.9979; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1979.9956; train_edge_recon_loss: 76222.1637; train_gene_expr_recon_loss: 90611.6907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168813.8491; train_optim_loss: 168813.8491; val_kl_reg_loss: 1958.4413; val_edge_recon_loss: 74460.4167; val_gene_expr_recon_loss: 90645.4854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167064.3438; val_optim_loss: 167064.3438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9935; val_auprc_score: 0.9979; val_best_acc_score: 0.9884; val_best_f1_score: 0.9933; train_kl_reg_loss: 1975.5075; train_edge_recon_loss: 75894.3312; train_gene_expr_recon_loss: 90495.1860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168365.0246; train_optim_loss: 168365.0246; val_kl_reg_loss: 1959.6148; val_edge_recon_loss: 75345.5814; val_gene_expr_recon_loss: 90822.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168127.3431; val_optim_loss: 168127.3431
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9933; val_auprc_score: 0.9982; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1974.5664; train_edge_recon_loss: 75828.8913; train_gene_expr_recon_loss: 90441.7362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168245.1940; train_optim_loss: 168245.1940; val_kl_reg_loss: 1952.0732; val_edge_recon_loss: 76953.4064; val_gene_expr_recon_loss: 90590.1357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169495.6152; val_optim_loss: 169495.6152
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9938; val_auprc_score: 0.9984; val_best_acc_score: 0.9886; val_best_f1_score: 0.9934; train_kl_reg_loss: 1974.1697; train_edge_recon_loss: 76008.9107; train_gene_expr_recon_loss: 90493.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168476.5827; train_optim_loss: 168476.5827; val_kl_reg_loss: 1947.4980; val_edge_recon_loss: 73215.9434; val_gene_expr_recon_loss: 90590.9746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165754.4170; val_optim_loss: 165754.4170
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9934; val_auprc_score: 0.9981; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1975.8546; train_edge_recon_loss: 76029.0297; train_gene_expr_recon_loss: 90392.9174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168397.8020; train_optim_loss: 168397.8020; val_kl_reg_loss: 1955.8249; val_edge_recon_loss: 74530.7705; val_gene_expr_recon_loss: 90627.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167113.8724; val_optim_loss: 167113.8724
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9949; val_auprc_score: 0.9985; val_best_acc_score: 0.9886; val_best_f1_score: 0.9934; train_kl_reg_loss: 1976.7676; train_edge_recon_loss: 76169.3231; train_gene_expr_recon_loss: 90314.6525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168460.7429; train_optim_loss: 168460.7429; val_kl_reg_loss: 1953.8958; val_edge_recon_loss: 76318.3174; val_gene_expr_recon_loss: 90548.8496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168821.0618; val_optim_loss: 168821.0618
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9988; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1975.9432; train_edge_recon_loss: 75680.9928; train_gene_expr_recon_loss: 90449.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168106.3106; train_optim_loss: 168106.3106; val_kl_reg_loss: 1955.1546; val_edge_recon_loss: 73706.9548; val_gene_expr_recon_loss: 90633.2542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166295.3620; val_optim_loss: 166295.3620

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9927; val_auprc_score: 0.9974; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1974.8391; train_edge_recon_loss: 76009.4299; train_gene_expr_recon_loss: 90371.6976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168355.9663; train_optim_loss: 168355.9663; val_kl_reg_loss: 1955.7627; val_edge_recon_loss: 76435.7412; val_gene_expr_recon_loss: 90611.9593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169003.4635; val_optim_loss: 169003.4635
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9939; val_auprc_score: 0.9983; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 1975.0749; train_edge_recon_loss: 75483.0181; train_gene_expr_recon_loss: 90405.3522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167863.4455; train_optim_loss: 167863.4455; val_kl_reg_loss: 1954.0803; val_edge_recon_loss: 77350.6159; val_gene_expr_recon_loss: 90336.7197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169641.4154; val_optim_loss: 169641.4154
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9935; val_auprc_score: 0.9976; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1975.3949; train_edge_recon_loss: 76117.7019; train_gene_expr_recon_loss: 90272.1344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168365.2307; train_optim_loss: 168365.2307; val_kl_reg_loss: 1959.4349; val_edge_recon_loss: 77489.9775; val_gene_expr_recon_loss: 90647.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170096.5365; val_optim_loss: 170096.5365

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9922
Val AUPRC score: 0.9972
Val best accuracy score: 0.9879
Val best F1 score: 0.9929
Val gene expr MSE score: 0.8807
Duration of model training in run 7: 0 hours, 11 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9824; val_auprc_score: 0.9955; val_best_acc_score: 0.9699; val_best_f1_score: 0.9826; train_kl_reg_loss: 1727.3063; train_edge_recon_loss: 83447.3861; train_gene_expr_recon_loss: 106942.9239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192117.6162; train_optim_loss: 192117.6162; val_kl_reg_loss: 2006.6215; val_edge_recon_loss: 78042.0853; val_gene_expr_recon_loss: 101872.9173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181921.6224; val_optim_loss: 181921.6224
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9872; val_auprc_score: 0.9965; val_best_acc_score: 0.9787; val_best_f1_score: 0.9876; train_kl_reg_loss: 1993.0127; train_edge_recon_loss: 77306.9925; train_gene_expr_recon_loss: 100992.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180292.0441; train_optim_loss: 180292.0441; val_kl_reg_loss: 1947.7663; val_edge_recon_loss: 77243.8379; val_gene_expr_recon_loss: 99454.5850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178646.1888; val_optim_loss: 178646.1888
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9886; val_auprc_score: 0.9966; val_best_acc_score: 0.9816; val_best_f1_score: 0.9893; train_kl_reg_loss: 1947.2847; train_edge_recon_loss: 76794.5648; train_gene_expr_recon_loss: 98899.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177641.0756; train_optim_loss: 177641.0756; val_kl_reg_loss: 1889.2442; val_edge_recon_loss: 75002.3953; val_gene_expr_recon_loss: 97953.6361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174845.2767; val_optim_loss: 174845.2767
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9890; val_auprc_score: 0.9970; val_best_acc_score: 0.9819; val_best_f1_score: 0.9895; train_kl_reg_loss: 1937.4478; train_edge_recon_loss: 76950.7337; train_gene_expr_recon_loss: 97332.8395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176221.0213; train_optim_loss: 176221.0213; val_kl_reg_loss: 1924.4276; val_edge_recon_loss: 75711.4048; val_gene_expr_recon_loss: 96269.7572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173905.5892; val_optim_loss: 173905.5892
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9903; val_auprc_score: 0.9975; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1930.2411; train_edge_recon_loss: 76691.1894; train_gene_expr_recon_loss: 96314.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174935.5883; train_optim_loss: 174935.5883; val_kl_reg_loss: 1925.2395; val_edge_recon_loss: 75979.4746; val_gene_expr_recon_loss: 95589.5348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173494.2487; val_optim_loss: 173494.2487
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9975; val_best_acc_score: 0.9868; val_best_f1_score: 0.9923; train_kl_reg_loss: 1934.5967; train_edge_recon_loss: 76557.6179; train_gene_expr_recon_loss: 95426.7128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173918.9281; train_optim_loss: 173918.9281; val_kl_reg_loss: 1875.9779; val_edge_recon_loss: 77619.0938; val_gene_expr_recon_loss: 94416.6003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173911.6712; val_optim_loss: 173911.6712
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9906; val_auprc_score: 0.9975; val_best_acc_score: 0.9864; val_best_f1_score: 0.9921; train_kl_reg_loss: 1942.3221; train_edge_recon_loss: 76690.8962; train_gene_expr_recon_loss: 94672.3913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173305.6098; train_optim_loss: 173305.6098; val_kl_reg_loss: 1942.1921; val_edge_recon_loss: 73611.0120; val_gene_expr_recon_loss: 94092.7985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169646.0013; val_optim_loss: 169646.0013
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9912; val_auprc_score: 0.9978; val_best_acc_score: 0.9850; val_best_f1_score: 0.9913; train_kl_reg_loss: 1946.1345; train_edge_recon_loss: 76000.8889; train_gene_expr_recon_loss: 94089.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172036.5525; train_optim_loss: 172036.5525; val_kl_reg_loss: 1979.6977; val_edge_recon_loss: 77492.5114; val_gene_expr_recon_loss: 93919.2402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173391.4512; val_optim_loss: 173391.4512
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9914; val_auprc_score: 0.9978; val_best_acc_score: 0.9867; val_best_f1_score: 0.9923; train_kl_reg_loss: 1947.1230; train_edge_recon_loss: 76246.9864; train_gene_expr_recon_loss: 93466.6908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171660.8003; train_optim_loss: 171660.8003; val_kl_reg_loss: 1940.7114; val_edge_recon_loss: 77203.0444; val_gene_expr_recon_loss: 93020.5918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172164.3490; val_optim_loss: 172164.3490
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9927; val_auprc_score: 0.9980; val_best_acc_score: 0.9870; val_best_f1_score: 0.9924; train_kl_reg_loss: 1949.1188; train_edge_recon_loss: 76055.6489; train_gene_expr_recon_loss: 93070.3407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171075.1083; train_optim_loss: 171075.1083; val_kl_reg_loss: 1935.9893; val_edge_recon_loss: 76686.9943; val_gene_expr_recon_loss: 92659.8792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171282.8652; val_optim_loss: 171282.8652

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9919; val_auprc_score: 0.9978; val_best_acc_score: 0.9877; val_best_f1_score: 0.9929; train_kl_reg_loss: 1958.9078; train_edge_recon_loss: 75810.6222; train_gene_expr_recon_loss: 92422.2413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170191.7710; train_optim_loss: 170191.7710; val_kl_reg_loss: 1929.0279; val_edge_recon_loss: 73146.2786; val_gene_expr_recon_loss: 92046.4404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167121.7474; val_optim_loss: 167121.7474
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9925; val_auprc_score: 0.9982; val_best_acc_score: 0.9871; val_best_f1_score: 0.9924; train_kl_reg_loss: 1953.7640; train_edge_recon_loss: 75695.0654; train_gene_expr_recon_loss: 92196.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169845.6147; train_optim_loss: 169845.6147; val_kl_reg_loss: 1942.9870; val_edge_recon_loss: 74784.6025; val_gene_expr_recon_loss: 92294.5267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169022.1172; val_optim_loss: 169022.1172
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9928; val_auprc_score: 0.9979; val_best_acc_score: 0.9876; val_best_f1_score: 0.9928; train_kl_reg_loss: 1950.9511; train_edge_recon_loss: 75954.0202; train_gene_expr_recon_loss: 92250.6036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170155.5743; train_optim_loss: 170155.5743; val_kl_reg_loss: 1946.1890; val_edge_recon_loss: 76274.4284; val_gene_expr_recon_loss: 92110.9788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170331.5951; val_optim_loss: 170331.5951
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9929; val_auprc_score: 0.9981; val_best_acc_score: 0.9865; val_best_f1_score: 0.9921; train_kl_reg_loss: 1951.3520; train_edge_recon_loss: 75707.5723; train_gene_expr_recon_loss: 92209.0515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169867.9757; train_optim_loss: 169867.9757; val_kl_reg_loss: 1935.9618; val_edge_recon_loss: 77112.9170; val_gene_expr_recon_loss: 92032.6833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171081.5612; val_optim_loss: 171081.5612

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9926; val_auprc_score: 0.9975; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 1954.6640; train_edge_recon_loss: 75926.9866; train_gene_expr_recon_loss: 92179.0550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170060.7063; train_optim_loss: 170060.7063; val_kl_reg_loss: 1937.5735; val_edge_recon_loss: 74663.3844; val_gene_expr_recon_loss: 92153.8301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168754.7871; val_optim_loss: 168754.7871
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9920; val_auprc_score: 0.9980; val_best_acc_score: 0.9866; val_best_f1_score: 0.9922; train_kl_reg_loss: 1952.6304; train_edge_recon_loss: 75776.7930; train_gene_expr_recon_loss: 92045.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169774.9720; train_optim_loss: 169774.9720; val_kl_reg_loss: 1934.6461; val_edge_recon_loss: 75949.0430; val_gene_expr_recon_loss: 92287.0693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170170.7591; val_optim_loss: 170170.7591
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9925; val_auprc_score: 0.9981; val_best_acc_score: 0.9878; val_best_f1_score: 0.9929; train_kl_reg_loss: 1952.8044; train_edge_recon_loss: 75909.0871; train_gene_expr_recon_loss: 92059.3347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169921.2263; train_optim_loss: 169921.2263; val_kl_reg_loss: 1935.0496; val_edge_recon_loss: 76267.2646; val_gene_expr_recon_loss: 91364.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169566.5195; val_optim_loss: 169566.5195

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 53 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9929
Val AUPRC score: 0.9982
Val best accuracy score: 0.9875
Val best F1 score: 0.9927
Val gene expr MSE score: 0.9115
Duration of model training in run 8: 0 hours, 6 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9962; val_best_acc_score: 0.9733; val_best_f1_score: 0.9845; train_kl_reg_loss: 1746.4874; train_edge_recon_loss: 82952.3821; train_gene_expr_recon_loss: 106824.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191523.1952; train_optim_loss: 191523.1952; val_kl_reg_loss: 1898.2716; val_edge_recon_loss: 76371.2885; val_gene_expr_recon_loss: 101905.8615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180175.4208; val_optim_loss: 180175.4208
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9862; val_auprc_score: 0.9966; val_best_acc_score: 0.9797; val_best_f1_score: 0.9882; train_kl_reg_loss: 1955.1274; train_edge_recon_loss: 77128.9099; train_gene_expr_recon_loss: 101008.6811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180092.7182; train_optim_loss: 180092.7182; val_kl_reg_loss: 1952.3621; val_edge_recon_loss: 76198.3497; val_gene_expr_recon_loss: 99240.5218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177391.2344; val_optim_loss: 177391.2344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9891; val_auprc_score: 0.9974; val_best_acc_score: 0.9818; val_best_f1_score: 0.9894; train_kl_reg_loss: 1926.8834; train_edge_recon_loss: 76711.9741; train_gene_expr_recon_loss: 98804.4601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177443.3176; train_optim_loss: 177443.3176; val_kl_reg_loss: 1934.6919; val_edge_recon_loss: 77681.7329; val_gene_expr_recon_loss: 97217.5975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176834.0216; val_optim_loss: 176834.0216
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9900; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9907; train_kl_reg_loss: 1922.7212; train_edge_recon_loss: 76871.4624; train_gene_expr_recon_loss: 97265.5517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176059.7356; train_optim_loss: 176059.7356; val_kl_reg_loss: 1898.0892; val_edge_recon_loss: 76549.7202; val_gene_expr_recon_loss: 96066.0180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174513.8276; val_optim_loss: 174513.8276
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9913; val_auprc_score: 0.9978; val_best_acc_score: 0.9846; val_best_f1_score: 0.9911; train_kl_reg_loss: 1914.8799; train_edge_recon_loss: 76364.5779; train_gene_expr_recon_loss: 96100.5623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174380.0201; train_optim_loss: 174380.0201; val_kl_reg_loss: 1898.9924; val_edge_recon_loss: 75096.7702; val_gene_expr_recon_loss: 95147.6449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172143.4084; val_optim_loss: 172143.4084
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9912; val_auprc_score: 0.9974; val_best_acc_score: 0.9860; val_best_f1_score: 0.9918; train_kl_reg_loss: 1915.8845; train_edge_recon_loss: 75926.7533; train_gene_expr_recon_loss: 95147.6053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172990.2426; train_optim_loss: 172990.2426; val_kl_reg_loss: 1925.0402; val_edge_recon_loss: 76627.3314; val_gene_expr_recon_loss: 94322.1791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172874.5512; val_optim_loss: 172874.5512
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9913; val_auprc_score: 0.9973; val_best_acc_score: 0.9863; val_best_f1_score: 0.9920; train_kl_reg_loss: 1924.1379; train_edge_recon_loss: 76116.5642; train_gene_expr_recon_loss: 94413.9332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172454.6353; train_optim_loss: 172454.6353; val_kl_reg_loss: 1903.7422; val_edge_recon_loss: 75155.6762; val_gene_expr_recon_loss: 93810.3912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170869.8109; val_optim_loss: 170869.8109
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9977; val_best_acc_score: 0.9874; val_best_f1_score: 0.9926; train_kl_reg_loss: 1936.0272; train_edge_recon_loss: 75696.4254; train_gene_expr_recon_loss: 93779.3627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171411.8152; train_optim_loss: 171411.8152; val_kl_reg_loss: 1916.0261; val_edge_recon_loss: 75965.4766; val_gene_expr_recon_loss: 93029.8518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170911.3524; val_optim_loss: 170911.3524
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9913; val_auprc_score: 0.9974; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1942.7460; train_edge_recon_loss: 76119.2438; train_gene_expr_recon_loss: 93290.2460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171352.2358; train_optim_loss: 171352.2358; val_kl_reg_loss: 1965.7015; val_edge_recon_loss: 76004.7829; val_gene_expr_recon_loss: 92705.3618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170675.8464; val_optim_loss: 170675.8464
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9936; val_auprc_score: 0.9980; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1945.3819; train_edge_recon_loss: 76124.1599; train_gene_expr_recon_loss: 92844.3184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170913.8597; train_optim_loss: 170913.8597; val_kl_reg_loss: 1926.5582; val_edge_recon_loss: 75504.8766; val_gene_expr_recon_loss: 91987.5321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169418.9655; val_optim_loss: 169418.9655
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9927; val_auprc_score: 0.9970; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1951.5386; train_edge_recon_loss: 75952.8571; train_gene_expr_recon_loss: 92494.3947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170398.7907; train_optim_loss: 170398.7907; val_kl_reg_loss: 1944.4191; val_edge_recon_loss: 76523.4141; val_gene_expr_recon_loss: 91870.5695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170338.4009; val_optim_loss: 170338.4009
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9932; val_auprc_score: 0.9977; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1960.9895; train_edge_recon_loss: 75844.2456; train_gene_expr_recon_loss: 92178.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169983.6573; train_optim_loss: 169983.6573; val_kl_reg_loss: 1963.0278; val_edge_recon_loss: 76675.6484; val_gene_expr_recon_loss: 91601.5603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170240.2371; val_optim_loss: 170240.2371
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9924; val_auprc_score: 0.9977; val_best_acc_score: 0.9880; val_best_f1_score: 0.9930; train_kl_reg_loss: 1963.4506; train_edge_recon_loss: 76123.8258; train_gene_expr_recon_loss: 91870.8146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169958.0911; train_optim_loss: 169958.0911; val_kl_reg_loss: 1983.9196; val_edge_recon_loss: 75785.6088; val_gene_expr_recon_loss: 91133.7136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168903.2408; val_optim_loss: 168903.2408
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9916; val_auprc_score: 0.9977; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1967.7234; train_edge_recon_loss: 75528.0276; train_gene_expr_recon_loss: 91706.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169202.1424; train_optim_loss: 169202.1424; val_kl_reg_loss: 1997.4267; val_edge_recon_loss: 74778.9657; val_gene_expr_recon_loss: 90980.7182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167757.1126; val_optim_loss: 167757.1126
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9920; val_auprc_score: 0.9976; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1973.4235; train_edge_recon_loss: 75882.7984; train_gene_expr_recon_loss: 91440.0350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169296.2569; train_optim_loss: 169296.2569; val_kl_reg_loss: 1985.6263; val_edge_recon_loss: 77432.1172; val_gene_expr_recon_loss: 91008.5719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170426.3141; val_optim_loss: 170426.3141
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9929; val_auprc_score: 0.9975; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1976.9106; train_edge_recon_loss: 75886.9395; train_gene_expr_recon_loss: 91287.4396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169151.2895; train_optim_loss: 169151.2895; val_kl_reg_loss: 1967.3015; val_edge_recon_loss: 76231.4712; val_gene_expr_recon_loss: 91049.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169248.3594; val_optim_loss: 169248.3594
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9936; val_auprc_score: 0.9981; val_best_acc_score: 0.9893; val_best_f1_score: 0.9937; train_kl_reg_loss: 1982.6575; train_edge_recon_loss: 76210.1375; train_gene_expr_recon_loss: 91129.6217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169322.4172; train_optim_loss: 169322.4172; val_kl_reg_loss: 1959.1239; val_edge_recon_loss: 75862.7955; val_gene_expr_recon_loss: 90689.1377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168511.0566; val_optim_loss: 168511.0566

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1987.6337; train_edge_recon_loss: 76031.4684; train_gene_expr_recon_loss: 90609.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168628.7069; train_optim_loss: 168628.7069; val_kl_reg_loss: 1976.9774; val_edge_recon_loss: 75421.7707; val_gene_expr_recon_loss: 90294.0927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167692.8400; val_optim_loss: 167692.8400
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9939; val_auprc_score: 0.9983; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1985.9725; train_edge_recon_loss: 75952.1948; train_gene_expr_recon_loss: 90507.2446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168445.4117; train_optim_loss: 168445.4117; val_kl_reg_loss: 1977.0758; val_edge_recon_loss: 76317.5486; val_gene_expr_recon_loss: 90486.2971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168780.9203; val_optim_loss: 168780.9203
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9945; val_auprc_score: 0.9983; val_best_acc_score: 0.9900; val_best_f1_score: 0.9942; train_kl_reg_loss: 1985.5357; train_edge_recon_loss: 76274.1073; train_gene_expr_recon_loss: 90464.2540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168723.8974; train_optim_loss: 168723.8974; val_kl_reg_loss: 1979.5060; val_edge_recon_loss: 75804.5094; val_gene_expr_recon_loss: 90354.8508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168138.8658; val_optim_loss: 168138.8658
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9936; val_auprc_score: 0.9979; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1984.3541; train_edge_recon_loss: 76027.7646; train_gene_expr_recon_loss: 90493.9197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168506.0388; train_optim_loss: 168506.0388; val_kl_reg_loss: 1982.6822; val_edge_recon_loss: 76105.2072; val_gene_expr_recon_loss: 90168.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168256.3233; val_optim_loss: 168256.3233

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9938; val_auprc_score: 0.9979; val_best_acc_score: 0.9897; val_best_f1_score: 0.9940; train_kl_reg_loss: 1987.4717; train_edge_recon_loss: 75472.4782; train_gene_expr_recon_loss: 90388.6763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167848.6264; train_optim_loss: 167848.6264; val_kl_reg_loss: 1973.0252; val_edge_recon_loss: 76035.0638; val_gene_expr_recon_loss: 90263.0127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168271.1008; val_optim_loss: 168271.1008
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9946; val_auprc_score: 0.9982; val_best_acc_score: 0.9902; val_best_f1_score: 0.9943; train_kl_reg_loss: 1983.7669; train_edge_recon_loss: 75792.4861; train_gene_expr_recon_loss: 90401.9315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168178.1847; train_optim_loss: 168178.1847; val_kl_reg_loss: 1970.7992; val_edge_recon_loss: 74740.8062; val_gene_expr_recon_loss: 90218.9106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166930.5156; val_optim_loss: 166930.5156
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9941; val_auprc_score: 0.9981; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1981.0555; train_edge_recon_loss: 75519.3760; train_gene_expr_recon_loss: 90375.4415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167875.8729; train_optim_loss: 167875.8729; val_kl_reg_loss: 1971.0602; val_edge_recon_loss: 76749.6191; val_gene_expr_recon_loss: 90498.0423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169218.7214; val_optim_loss: 169218.7214
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9934; val_auprc_score: 0.9978; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1981.7381; train_edge_recon_loss: 76163.0616; train_gene_expr_recon_loss: 90390.8507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168535.6497; train_optim_loss: 168535.6497; val_kl_reg_loss: 1968.0125; val_edge_recon_loss: 74790.8091; val_gene_expr_recon_loss: 90126.0978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166884.9203; val_optim_loss: 166884.9203
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9920; val_auprc_score: 0.9977; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1981.5332; train_edge_recon_loss: 75229.3579; train_gene_expr_recon_loss: 90377.0197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167587.9110; train_optim_loss: 167587.9110; val_kl_reg_loss: 1970.4097; val_edge_recon_loss: 76114.5741; val_gene_expr_recon_loss: 90193.2201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168278.2020; val_optim_loss: 168278.2020
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9933; val_auprc_score: 0.9979; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1983.6609; train_edge_recon_loss: 75652.7965; train_gene_expr_recon_loss: 90391.9690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168028.4263; train_optim_loss: 168028.4263; val_kl_reg_loss: 1971.8002; val_edge_recon_loss: 75997.5453; val_gene_expr_recon_loss: 90403.8653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168373.2117; val_optim_loss: 168373.2117
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9933; val_auprc_score: 0.9978; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1981.8728; train_edge_recon_loss: 75283.2533; train_gene_expr_recon_loss: 90368.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167633.6015; train_optim_loss: 167633.6015; val_kl_reg_loss: 1966.6319; val_edge_recon_loss: 76915.2861; val_gene_expr_recon_loss: 90280.6996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169162.6169; val_optim_loss: 169162.6169

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9924; val_auprc_score: 0.9977; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1978.8363; train_edge_recon_loss: 75970.4611; train_gene_expr_recon_loss: 90393.6999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168342.9975; train_optim_loss: 168342.9975; val_kl_reg_loss: 1967.4349; val_edge_recon_loss: 74968.0789; val_gene_expr_recon_loss: 90308.2255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167243.7381; val_optim_loss: 167243.7381
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9915; val_auprc_score: 0.9968; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1979.6211; train_edge_recon_loss: 75562.3265; train_gene_expr_recon_loss: 90405.0414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167946.9898; train_optim_loss: 167946.9898; val_kl_reg_loss: 1967.8739; val_edge_recon_loss: 75092.0795; val_gene_expr_recon_loss: 90035.2589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167095.2123; val_optim_loss: 167095.2123
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9925; val_auprc_score: 0.9974; val_best_acc_score: 0.9887; val_best_f1_score: 0.9934; train_kl_reg_loss: 1979.7116; train_edge_recon_loss: 75417.2027; train_gene_expr_recon_loss: 90408.3808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167805.2953; train_optim_loss: 167805.2953; val_kl_reg_loss: 1967.9839; val_edge_recon_loss: 76405.7627; val_gene_expr_recon_loss: 90231.9413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168605.6864; val_optim_loss: 168605.6864

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9925
Val AUPRC score: 0.9976
Val best accuracy score: 0.9889
Val best F1 score: 0.9935
Val gene expr MSE score: 0.9004
Duration of model training in run 9: 0 hours, 16 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 489, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 489, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 489, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR -> self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 265201
Number of validation edges: 29466
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9834; val_auprc_score: 0.9962; val_best_acc_score: 0.9714; val_best_f1_score: 0.9833; train_kl_reg_loss: 1784.7331; train_edge_recon_loss: 82775.4344; train_gene_expr_recon_loss: 105700.1232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190260.2902; train_optim_loss: 190260.2902; val_kl_reg_loss: 1994.9551; val_edge_recon_loss: 77519.4410; val_gene_expr_recon_loss: 101943.5342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181457.9305; val_optim_loss: 181457.9305
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9847; val_auprc_score: 0.9957; val_best_acc_score: 0.9779; val_best_f1_score: 0.9871; train_kl_reg_loss: 1963.9593; train_edge_recon_loss: 76701.0983; train_gene_expr_recon_loss: 99967.8279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178632.8859; train_optim_loss: 178632.8859; val_kl_reg_loss: 1871.6954; val_edge_recon_loss: 77736.7993; val_gene_expr_recon_loss: 98892.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178500.7791; val_optim_loss: 178500.7791
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9874; val_auprc_score: 0.9963; val_best_acc_score: 0.9809; val_best_f1_score: 0.9889; train_kl_reg_loss: 1923.3887; train_edge_recon_loss: 76635.5114; train_gene_expr_recon_loss: 97854.5906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176413.4908; train_optim_loss: 176413.4908; val_kl_reg_loss: 1877.0578; val_edge_recon_loss: 75998.1740; val_gene_expr_recon_loss: 97663.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175539.1115; val_optim_loss: 175539.1115
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9895; val_auprc_score: 0.9972; val_best_acc_score: 0.9832; val_best_f1_score: 0.9902; train_kl_reg_loss: 1921.1425; train_edge_recon_loss: 76981.5888; train_gene_expr_recon_loss: 96475.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175378.2794; train_optim_loss: 175378.2794; val_kl_reg_loss: 1853.0683; val_edge_recon_loss: 77465.0628; val_gene_expr_recon_loss: 96332.6611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175650.7931; val_optim_loss: 175650.7931
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9907; val_auprc_score: 0.9968; val_best_acc_score: 0.9848; val_best_f1_score: 0.9911; train_kl_reg_loss: 1919.4351; train_edge_recon_loss: 76847.2924; train_gene_expr_recon_loss: 95431.9983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174198.7257; train_optim_loss: 174198.7257; val_kl_reg_loss: 1935.1681; val_edge_recon_loss: 76764.0339; val_gene_expr_recon_loss: 95263.2317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173962.4343; val_optim_loss: 173962.4343
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9911; val_auprc_score: 0.9973; val_best_acc_score: 0.9847; val_best_f1_score: 0.9911; train_kl_reg_loss: 1928.3860; train_edge_recon_loss: 76627.4572; train_gene_expr_recon_loss: 94612.8905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173168.7332; train_optim_loss: 173168.7332; val_kl_reg_loss: 1870.1171; val_edge_recon_loss: 76570.5488; val_gene_expr_recon_loss: 94674.3473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173115.0129; val_optim_loss: 173115.0129
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9917; val_auprc_score: 0.9978; val_best_acc_score: 0.9862; val_best_f1_score: 0.9920; train_kl_reg_loss: 1927.2630; train_edge_recon_loss: 75905.4935; train_gene_expr_recon_loss: 93923.7110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171756.4678; train_optim_loss: 171756.4678; val_kl_reg_loss: 1956.7472; val_edge_recon_loss: 75884.1948; val_gene_expr_recon_loss: 94172.8112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172013.7532; val_optim_loss: 172013.7532
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9911; val_auprc_score: 0.9970; val_best_acc_score: 0.9860; val_best_f1_score: 0.9919; train_kl_reg_loss: 1940.5371; train_edge_recon_loss: 76342.0776; train_gene_expr_recon_loss: 93428.4936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171711.1082; train_optim_loss: 171711.1082; val_kl_reg_loss: 1947.7854; val_edge_recon_loss: 75519.4793; val_gene_expr_recon_loss: 93405.1145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170872.3777; val_optim_loss: 170872.3777
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9925; val_auprc_score: 0.9976; val_best_acc_score: 0.9873; val_best_f1_score: 0.9926; train_kl_reg_loss: 1941.8450; train_edge_recon_loss: 76021.3408; train_gene_expr_recon_loss: 92946.2402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170909.4258; train_optim_loss: 170909.4258; val_kl_reg_loss: 1950.6898; val_edge_recon_loss: 74979.1716; val_gene_expr_recon_loss: 93353.8774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170283.7392; val_optim_loss: 170283.7392
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9920; val_auprc_score: 0.9974; val_best_acc_score: 0.9871; val_best_f1_score: 0.9925; train_kl_reg_loss: 1955.8053; train_edge_recon_loss: 76264.8736; train_gene_expr_recon_loss: 92529.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170750.0122; train_optim_loss: 170750.0122; val_kl_reg_loss: 1908.7975; val_edge_recon_loss: 75108.6414; val_gene_expr_recon_loss: 93086.2826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170103.7198; val_optim_loss: 170103.7198
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9923; val_auprc_score: 0.9974; val_best_acc_score: 0.9883; val_best_f1_score: 0.9932; train_kl_reg_loss: 1953.7444; train_edge_recon_loss: 75878.2889; train_gene_expr_recon_loss: 92203.2521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170035.2852; train_optim_loss: 170035.2852; val_kl_reg_loss: 1944.2768; val_edge_recon_loss: 75544.1099; val_gene_expr_recon_loss: 92563.6630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170052.0480; val_optim_loss: 170052.0480
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9925; val_auprc_score: 0.9974; val_best_acc_score: 0.9875; val_best_f1_score: 0.9927; train_kl_reg_loss: 1960.1384; train_edge_recon_loss: 75577.4303; train_gene_expr_recon_loss: 91954.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169492.0500; train_optim_loss: 169492.0500; val_kl_reg_loss: 1946.5220; val_edge_recon_loss: 78095.3486; val_gene_expr_recon_loss: 92127.8712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172169.7419; val_optim_loss: 172169.7419
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9920; val_auprc_score: 0.9975; val_best_acc_score: 0.9882; val_best_f1_score: 0.9931; train_kl_reg_loss: 1966.5330; train_edge_recon_loss: 76049.3792; train_gene_expr_recon_loss: 91650.4949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169666.4069; train_optim_loss: 169666.4069; val_kl_reg_loss: 1966.4055; val_edge_recon_loss: 76654.4704; val_gene_expr_recon_loss: 92029.3661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170650.2414; val_optim_loss: 170650.2414
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9923; val_auprc_score: 0.9978; val_best_acc_score: 0.9877; val_best_f1_score: 0.9928; train_kl_reg_loss: 1968.8323; train_edge_recon_loss: 76160.1847; train_gene_expr_recon_loss: 91434.5944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169563.6114; train_optim_loss: 169563.6114; val_kl_reg_loss: 1970.6211; val_edge_recon_loss: 76644.8863; val_gene_expr_recon_loss: 91947.4143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170562.9208; val_optim_loss: 170562.9208

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9917; val_auprc_score: 0.9973; val_best_acc_score: 0.9890; val_best_f1_score: 0.9936; train_kl_reg_loss: 1976.9320; train_edge_recon_loss: 76109.6897; train_gene_expr_recon_loss: 90900.3063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168986.9278; train_optim_loss: 168986.9278; val_kl_reg_loss: 1953.5986; val_edge_recon_loss: 76206.2947; val_gene_expr_recon_loss: 91417.3217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169577.2150; val_optim_loss: 169577.2150
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9920; val_auprc_score: 0.9973; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 1971.7051; train_edge_recon_loss: 75884.1218; train_gene_expr_recon_loss: 90834.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168690.3486; train_optim_loss: 168690.3486; val_kl_reg_loss: 1957.8269; val_edge_recon_loss: 75550.4795; val_gene_expr_recon_loss: 91253.4871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168761.7931; val_optim_loss: 168761.7931
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9930; val_auprc_score: 0.9977; val_best_acc_score: 0.9886; val_best_f1_score: 0.9933; train_kl_reg_loss: 1968.5670; train_edge_recon_loss: 75445.8888; train_gene_expr_recon_loss: 90800.3728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168214.8285; train_optim_loss: 168214.8285; val_kl_reg_loss: 1958.3671; val_edge_recon_loss: 75747.6880; val_gene_expr_recon_loss: 91129.4911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168835.5474; val_optim_loss: 168835.5474
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9922; val_auprc_score: 0.9973; val_best_acc_score: 0.9892; val_best_f1_score: 0.9937; train_kl_reg_loss: 1968.1565; train_edge_recon_loss: 75491.7430; train_gene_expr_recon_loss: 90751.7047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168211.6042; train_optim_loss: 168211.6042; val_kl_reg_loss: 1953.8710; val_edge_recon_loss: 74970.1800; val_gene_expr_recon_loss: 91210.9989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168135.0517; val_optim_loss: 168135.0517
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9915; val_auprc_score: 0.9967; val_best_acc_score: 0.9888; val_best_f1_score: 0.9934; train_kl_reg_loss: 1970.1638; train_edge_recon_loss: 75900.9269; train_gene_expr_recon_loss: 90734.8664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168605.9575; train_optim_loss: 168605.9575; val_kl_reg_loss: 1953.3815; val_edge_recon_loss: 75634.8559; val_gene_expr_recon_loss: 90923.1541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168511.3933; val_optim_loss: 168511.3933
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9976; val_best_acc_score: 0.9884; val_best_f1_score: 0.9932; train_kl_reg_loss: 1969.1496; train_edge_recon_loss: 75984.3749; train_gene_expr_recon_loss: 90702.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168656.3959; train_optim_loss: 168656.3959; val_kl_reg_loss: 1966.4734; val_edge_recon_loss: 76106.6237; val_gene_expr_recon_loss: 91419.3432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169492.4429; val_optim_loss: 169492.4429
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9917; val_auprc_score: 0.9972; val_best_acc_score: 0.9891; val_best_f1_score: 0.9937; train_kl_reg_loss: 1967.9434; train_edge_recon_loss: 75970.3377; train_gene_expr_recon_loss: 90655.7264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168594.0074; train_optim_loss: 168594.0074; val_kl_reg_loss: 1956.9037; val_edge_recon_loss: 73646.3607; val_gene_expr_recon_loss: 91288.7002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166891.9644; val_optim_loss: 166891.9644
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9907; val_auprc_score: 0.9972; val_best_acc_score: 0.9888; val_best_f1_score: 0.9934; train_kl_reg_loss: 1965.9087; train_edge_recon_loss: 75779.5583; train_gene_expr_recon_loss: 90669.8347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168415.3020; train_optim_loss: 168415.3020; val_kl_reg_loss: 1958.5751; val_edge_recon_loss: 76621.6991; val_gene_expr_recon_loss: 91101.4149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169681.6880; val_optim_loss: 169681.6880
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9930; val_auprc_score: 0.9981; val_best_acc_score: 0.9885; val_best_f1_score: 0.9933; train_kl_reg_loss: 1968.7687; train_edge_recon_loss: 75529.6732; train_gene_expr_recon_loss: 90560.6046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168059.0465; train_optim_loss: 168059.0465; val_kl_reg_loss: 1954.2259; val_edge_recon_loss: 76324.7980; val_gene_expr_recon_loss: 91220.5016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169499.5264; val_optim_loss: 169499.5264
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9931; val_auprc_score: 0.9982; val_best_acc_score: 0.9894; val_best_f1_score: 0.9938; train_kl_reg_loss: 1967.5091; train_edge_recon_loss: 75788.4165; train_gene_expr_recon_loss: 90620.0218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168375.9474; train_optim_loss: 168375.9474; val_kl_reg_loss: 1961.6869; val_edge_recon_loss: 75076.9006; val_gene_expr_recon_loss: 91148.4240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168187.0092; val_optim_loss: 168187.0092

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9932; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9936; train_kl_reg_loss: 1972.1954; train_edge_recon_loss: 75870.2744; train_gene_expr_recon_loss: 90541.0883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168383.5580; train_optim_loss: 168383.5580; val_kl_reg_loss: 1953.8534; val_edge_recon_loss: 76639.5598; val_gene_expr_recon_loss: 91339.9984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169933.4133; val_optim_loss: 169933.4133
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9936; val_auprc_score: 0.9975; val_best_acc_score: 0.9889; val_best_f1_score: 0.9935; train_kl_reg_loss: 1967.9402; train_edge_recon_loss: 75839.9421; train_gene_expr_recon_loss: 90615.3779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168423.2600; train_optim_loss: 168423.2600; val_kl_reg_loss: 1955.8930; val_edge_recon_loss: 75634.7088; val_gene_expr_recon_loss: 91075.2963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168665.8976; val_optim_loss: 168665.8976
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9951; val_auprc_score: 0.9989; val_best_acc_score: 0.9899; val_best_f1_score: 0.9941; train_kl_reg_loss: 1967.4062; train_edge_recon_loss: 75285.8307; train_gene_expr_recon_loss: 90559.3803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167812.6178; train_optim_loss: 167812.6178; val_kl_reg_loss: 1950.4751; val_edge_recon_loss: 75883.5978; val_gene_expr_recon_loss: 90765.6212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168599.6945; val_optim_loss: 168599.6945

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 0 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9929
Val AUPRC score: 0.9979
Val best accuracy score: 0.9887
Val best F1 score: 0.9934
Val gene expr MSE score: 0.9322
Duration of model training in run 10: 0 hours, 13 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
