Run timestamp: 23082023_230006_5.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', '--seeds', '3', '2', '1', '0', '--run_index', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 582989
Number of validation edges: 64776
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9402; val_auprc_score: 0.9739; val_best_acc_score: 0.9177; val_best_f1_score: 0.9469; train_kl_reg_loss: 15677.7150; train_edge_recon_loss: 1378973.9819; train_gene_expr_recon_loss: 2952592.7193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4347244.4162; train_optim_loss: 4347244.4162; val_kl_reg_loss: 12767.0210; val_edge_recon_loss: 1349554.5342; val_gene_expr_recon_loss: 2689494.4409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4051815.9941; val_optim_loss: 4051815.9941
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9553; val_auprc_score: 0.9802; val_best_acc_score: 0.9311; val_best_f1_score: 0.9553; train_kl_reg_loss: 14360.7916; train_edge_recon_loss: 1331571.2561; train_gene_expr_recon_loss: 2537343.4712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3883275.5198; train_optim_loss: 3883275.5198; val_kl_reg_loss: 15420.1849; val_edge_recon_loss: 1345826.7948; val_gene_expr_recon_loss: 2398492.0433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759739.0177; val_optim_loss: 3759739.0177
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9640; val_auprc_score: 0.9847; val_best_acc_score: 0.9368; val_best_f1_score: 0.9588; train_kl_reg_loss: 17243.2308; train_edge_recon_loss: 1327579.2522; train_gene_expr_recon_loss: 2326081.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3670903.6824; train_optim_loss: 3670903.6824; val_kl_reg_loss: 17720.3133; val_edge_recon_loss: 1329099.1661; val_gene_expr_recon_loss: 2264873.5389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3611693.0128; val_optim_loss: 3611693.0128
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9648; val_auprc_score: 0.9849; val_best_acc_score: 0.9373; val_best_f1_score: 0.9592; train_kl_reg_loss: 19484.6500; train_edge_recon_loss: 1323874.1918; train_gene_expr_recon_loss: 2230085.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3573444.3551; train_optim_loss: 3573444.3551; val_kl_reg_loss: 20391.6738; val_edge_recon_loss: 1338242.4031; val_gene_expr_recon_loss: 2192781.7515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3551415.8337; val_optim_loss: 3551415.8337
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9638; val_auprc_score: 0.9841; val_best_acc_score: 0.9364; val_best_f1_score: 0.9585; train_kl_reg_loss: 20822.6451; train_edge_recon_loss: 1323187.0647; train_gene_expr_recon_loss: 2182049.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3526058.9503; train_optim_loss: 3526058.9503; val_kl_reg_loss: 22071.9138; val_edge_recon_loss: 1347431.4213; val_gene_expr_recon_loss: 2183076.6275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3552579.9705; val_optim_loss: 3552579.9705
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9671; val_auprc_score: 0.9858; val_best_acc_score: 0.9414; val_best_f1_score: 0.9618; train_kl_reg_loss: 21648.7453; train_edge_recon_loss: 1326484.6979; train_gene_expr_recon_loss: 2149851.5094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3497984.9506; train_optim_loss: 3497984.9506; val_kl_reg_loss: 22256.9786; val_edge_recon_loss: 1337421.9562; val_gene_expr_recon_loss: 2160330.5994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3520009.5256; val_optim_loss: 3520009.5256
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9685; val_auprc_score: 0.9867; val_best_acc_score: 0.9392; val_best_f1_score: 0.9602; train_kl_reg_loss: 22644.9968; train_edge_recon_loss: 1325273.2398; train_gene_expr_recon_loss: 2134237.1477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3482155.3858; train_optim_loss: 3482155.3858; val_kl_reg_loss: 23010.3440; val_edge_recon_loss: 1348401.2977; val_gene_expr_recon_loss: 2128354.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3499765.9488; val_optim_loss: 3499765.9488
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9701; val_auprc_score: 0.9872; val_best_acc_score: 0.9439; val_best_f1_score: 0.9634; train_kl_reg_loss: 23209.0721; train_edge_recon_loss: 1323945.6882; train_gene_expr_recon_loss: 2117947.5408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3465102.2994; train_optim_loss: 3465102.2994; val_kl_reg_loss: 23998.3110; val_edge_recon_loss: 1339034.2603; val_gene_expr_recon_loss: 2124707.0758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3487739.6378; val_optim_loss: 3487739.6378
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9718; val_auprc_score: 0.9876; val_best_acc_score: 0.9455; val_best_f1_score: 0.9642; train_kl_reg_loss: 23958.0811; train_edge_recon_loss: 1325775.7984; train_gene_expr_recon_loss: 2109668.9823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3459402.8635; train_optim_loss: 3459402.8635; val_kl_reg_loss: 24543.8971; val_edge_recon_loss: 1338851.5912; val_gene_expr_recon_loss: 2112554.7879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3475950.2736; val_optim_loss: 3475950.2736
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9731; val_auprc_score: 0.9890; val_best_acc_score: 0.9458; val_best_f1_score: 0.9645; train_kl_reg_loss: 24478.5475; train_edge_recon_loss: 1326136.4480; train_gene_expr_recon_loss: 2100920.2206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3451535.2178; train_optim_loss: 3451535.2178; val_kl_reg_loss: 24761.4274; val_edge_recon_loss: 1327324.9505; val_gene_expr_recon_loss: 2100854.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3452940.9724; val_optim_loss: 3452940.9724
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9747; val_auprc_score: 0.9893; val_best_acc_score: 0.9460; val_best_f1_score: 0.9644; train_kl_reg_loss: 25028.8114; train_edge_recon_loss: 1326557.8127; train_gene_expr_recon_loss: 2094365.4268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3445952.0506; train_optim_loss: 3445952.0506; val_kl_reg_loss: 26438.6700; val_edge_recon_loss: 1344660.8095; val_gene_expr_recon_loss: 2096727.9247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3467827.4035; val_optim_loss: 3467827.4035
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9749; val_auprc_score: 0.9895; val_best_acc_score: 0.9479; val_best_f1_score: 0.9658; train_kl_reg_loss: 25356.1807; train_edge_recon_loss: 1324111.2387; train_gene_expr_recon_loss: 2088250.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3437717.4811; train_optim_loss: 3437717.4811; val_kl_reg_loss: 25729.2203; val_edge_recon_loss: 1329101.7704; val_gene_expr_recon_loss: 2105276.1127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3460107.1102; val_optim_loss: 3460107.1102
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9738; val_auprc_score: 0.9888; val_best_acc_score: 0.9443; val_best_f1_score: 0.9634; train_kl_reg_loss: 25966.0917; train_edge_recon_loss: 1323983.5664; train_gene_expr_recon_loss: 2077128.8387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3427078.4973; train_optim_loss: 3427078.4973; val_kl_reg_loss: 25817.1701; val_edge_recon_loss: 1349888.1102; val_gene_expr_recon_loss: 2083753.9094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3459459.1880; val_optim_loss: 3459459.1880
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9746; val_auprc_score: 0.9895; val_best_acc_score: 0.9459; val_best_f1_score: 0.9646; train_kl_reg_loss: 26267.0525; train_edge_recon_loss: 1322936.0734; train_gene_expr_recon_loss: 2084673.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3433876.6294; train_optim_loss: 3433876.6294; val_kl_reg_loss: 26533.4361; val_edge_recon_loss: 1327934.4070; val_gene_expr_recon_loss: 2091333.2702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3445801.1142; val_optim_loss: 3445801.1142
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9739; val_auprc_score: 0.9884; val_best_acc_score: 0.9493; val_best_f1_score: 0.9667; train_kl_reg_loss: 26686.9089; train_edge_recon_loss: 1321778.8479; train_gene_expr_recon_loss: 2070238.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3418703.9654; train_optim_loss: 3418703.9654; val_kl_reg_loss: 26197.0129; val_edge_recon_loss: 1338368.3809; val_gene_expr_recon_loss: 2145614.4321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3510179.8346; val_optim_loss: 3510179.8346
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9748; val_auprc_score: 0.9893; val_best_acc_score: 0.9487; val_best_f1_score: 0.9664; train_kl_reg_loss: 27327.7290; train_edge_recon_loss: 1324048.7615; train_gene_expr_recon_loss: 2075291.9131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3426668.4057; train_optim_loss: 3426668.4057; val_kl_reg_loss: 27652.1996; val_edge_recon_loss: 1340086.7470; val_gene_expr_recon_loss: 2081588.1393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3449327.0984; val_optim_loss: 3449327.0984
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9770; val_auprc_score: 0.9904; val_best_acc_score: 0.9485; val_best_f1_score: 0.9661; train_kl_reg_loss: 27380.0352; train_edge_recon_loss: 1321561.6366; train_gene_expr_recon_loss: 2067687.3406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3416629.0116; train_optim_loss: 3416629.0116; val_kl_reg_loss: 27510.0586; val_edge_recon_loss: 1345750.7563; val_gene_expr_recon_loss: 2090867.1934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3464128.0167; val_optim_loss: 3464128.0167
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9771; val_auprc_score: 0.9902; val_best_acc_score: 0.9498; val_best_f1_score: 0.9671; train_kl_reg_loss: 27705.4803; train_edge_recon_loss: 1323168.6946; train_gene_expr_recon_loss: 2061525.0841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3412399.2564; train_optim_loss: 3412399.2564; val_kl_reg_loss: 27517.0095; val_edge_recon_loss: 1340473.6668; val_gene_expr_recon_loss: 2078843.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3446834.3553; val_optim_loss: 3446834.3553

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9775; val_auprc_score: 0.9906; val_best_acc_score: 0.9512; val_best_f1_score: 0.9681; train_kl_reg_loss: 26465.4564; train_edge_recon_loss: 1320038.1197; train_gene_expr_recon_loss: 2012131.1620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3358634.7398; train_optim_loss: 3358634.7398; val_kl_reg_loss: 26512.5947; val_edge_recon_loss: 1328838.5187; val_gene_expr_recon_loss: 2035627.0123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3390978.1191; val_optim_loss: 3390978.1191
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9781; val_auprc_score: 0.9907; val_best_acc_score: 0.9512; val_best_f1_score: 0.9679; train_kl_reg_loss: 26293.9695; train_edge_recon_loss: 1318182.8607; train_gene_expr_recon_loss: 2003661.2119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3348138.0372; train_optim_loss: 3348138.0372; val_kl_reg_loss: 26211.4985; val_edge_recon_loss: 1343719.5143; val_gene_expr_recon_loss: 2030278.5699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3400209.5807; val_optim_loss: 3400209.5807
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9786; val_auprc_score: 0.9911; val_best_acc_score: 0.9520; val_best_f1_score: 0.9684; train_kl_reg_loss: 26078.7112; train_edge_recon_loss: 1319719.0582; train_gene_expr_recon_loss: 1998761.8342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344559.6022; train_optim_loss: 3344559.6022; val_kl_reg_loss: 26116.5542; val_edge_recon_loss: 1336658.8661; val_gene_expr_recon_loss: 2028377.5728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3391152.9970; val_optim_loss: 3391152.9970
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9788; val_auprc_score: 0.9907; val_best_acc_score: 0.9518; val_best_f1_score: 0.9683; train_kl_reg_loss: 25944.8955; train_edge_recon_loss: 1317522.8418; train_gene_expr_recon_loss: 1996335.5170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339803.2555; train_optim_loss: 3339803.2555; val_kl_reg_loss: 25934.7230; val_edge_recon_loss: 1343259.2087; val_gene_expr_recon_loss: 2022577.0192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3391770.9478; val_optim_loss: 3391770.9478
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9799; val_auprc_score: 0.9917; val_best_acc_score: 0.9521; val_best_f1_score: 0.9685; train_kl_reg_loss: 25734.9350; train_edge_recon_loss: 1319285.4769; train_gene_expr_recon_loss: 1994475.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339495.6722; train_optim_loss: 3339495.6722; val_kl_reg_loss: 25496.2655; val_edge_recon_loss: 1336792.3593; val_gene_expr_recon_loss: 2028860.8174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3391149.4331; val_optim_loss: 3391149.4331

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9784; val_auprc_score: 0.9910; val_best_acc_score: 0.9519; val_best_f1_score: 0.9684; train_kl_reg_loss: 25345.6104; train_edge_recon_loss: 1319029.0674; train_gene_expr_recon_loss: 1986592.1798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3330966.8577; train_optim_loss: 3330966.8577; val_kl_reg_loss: 25419.0081; val_edge_recon_loss: 1338110.4528; val_gene_expr_recon_loss: 2024052.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3387582.2717; val_optim_loss: 3387582.2717
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9791; val_auprc_score: 0.9913; val_best_acc_score: 0.9525; val_best_f1_score: 0.9687; train_kl_reg_loss: 25354.6296; train_edge_recon_loss: 1316897.2752; train_gene_expr_recon_loss: 1986702.0480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328953.9534; train_optim_loss: 3328953.9534; val_kl_reg_loss: 25409.5421; val_edge_recon_loss: 1335871.8912; val_gene_expr_recon_loss: 2021509.3642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3382790.8051; val_optim_loss: 3382790.8051
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9787; val_auprc_score: 0.9912; val_best_acc_score: 0.9514; val_best_f1_score: 0.9681; train_kl_reg_loss: 25399.7933; train_edge_recon_loss: 1315732.9211; train_gene_expr_recon_loss: 1986647.9533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3327780.6714; train_optim_loss: 3327780.6714; val_kl_reg_loss: 25373.7782; val_edge_recon_loss: 1335047.1727; val_gene_expr_recon_loss: 2023566.2968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3383987.2520; val_optim_loss: 3383987.2520
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9791; val_auprc_score: 0.9911; val_best_acc_score: 0.9528; val_best_f1_score: 0.9690; train_kl_reg_loss: 25350.2937; train_edge_recon_loss: 1316484.8424; train_gene_expr_recon_loss: 1987217.2854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329052.4275; train_optim_loss: 3329052.4275; val_kl_reg_loss: 25282.6827; val_edge_recon_loss: 1325683.4168; val_gene_expr_recon_loss: 2014379.6860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3365345.7785; val_optim_loss: 3365345.7785
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9791; val_auprc_score: 0.9912; val_best_acc_score: 0.9524; val_best_f1_score: 0.9687; train_kl_reg_loss: 25315.7024; train_edge_recon_loss: 1318572.8305; train_gene_expr_recon_loss: 1986294.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3330182.8356; train_optim_loss: 3330182.8356; val_kl_reg_loss: 25357.0378; val_edge_recon_loss: 1334179.1420; val_gene_expr_recon_loss: 2022010.2136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3381546.3927; val_optim_loss: 3381546.3927
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9802; val_auprc_score: 0.9919; val_best_acc_score: 0.9534; val_best_f1_score: 0.9693; train_kl_reg_loss: 25274.7465; train_edge_recon_loss: 1317360.6692; train_gene_expr_recon_loss: 1985872.5441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328507.9562; train_optim_loss: 3328507.9562; val_kl_reg_loss: 25228.7438; val_edge_recon_loss: 1320512.4072; val_gene_expr_recon_loss: 2021024.1604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366765.3110; val_optim_loss: 3366765.3110
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9804; val_auprc_score: 0.9918; val_best_acc_score: 0.9540; val_best_f1_score: 0.9697; train_kl_reg_loss: 25264.6941; train_edge_recon_loss: 1317362.7971; train_gene_expr_recon_loss: 1985763.0219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328390.5123; train_optim_loss: 3328390.5123; val_kl_reg_loss: 25348.3628; val_edge_recon_loss: 1330767.8073; val_gene_expr_recon_loss: 2020086.1885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3376202.3671; val_optim_loss: 3376202.3671
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9789; val_auprc_score: 0.9913; val_best_acc_score: 0.9521; val_best_f1_score: 0.9685; train_kl_reg_loss: 25246.6188; train_edge_recon_loss: 1317360.9291; train_gene_expr_recon_loss: 1985767.3869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328374.9327; train_optim_loss: 3328374.9327; val_kl_reg_loss: 25233.0304; val_edge_recon_loss: 1328530.3829; val_gene_expr_recon_loss: 2020746.7013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3374510.1152; val_optim_loss: 3374510.1152

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9791; val_auprc_score: 0.9911; val_best_acc_score: 0.9524; val_best_f1_score: 0.9687; train_kl_reg_loss: 25196.5808; train_edge_recon_loss: 1316476.8703; train_gene_expr_recon_loss: 1984975.9017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3326649.3506; train_optim_loss: 3326649.3506; val_kl_reg_loss: 25218.5311; val_edge_recon_loss: 1335145.1914; val_gene_expr_recon_loss: 2020502.6009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3380866.3248; val_optim_loss: 3380866.3248
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9805; val_auprc_score: 0.9919; val_best_acc_score: 0.9536; val_best_f1_score: 0.9695; train_kl_reg_loss: 25190.9745; train_edge_recon_loss: 1319444.4440; train_gene_expr_recon_loss: 1985399.3250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3330034.7466; train_optim_loss: 3330034.7466; val_kl_reg_loss: 25212.5684; val_edge_recon_loss: 1323918.4705; val_gene_expr_recon_loss: 2018284.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367415.2037; val_optim_loss: 3367415.2037
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9790; val_auprc_score: 0.9912; val_best_acc_score: 0.9518; val_best_f1_score: 0.9684; train_kl_reg_loss: 25186.4244; train_edge_recon_loss: 1313866.4162; train_gene_expr_recon_loss: 1985134.2635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3324187.1047; train_optim_loss: 3324187.1047; val_kl_reg_loss: 25216.5758; val_edge_recon_loss: 1331716.4636; val_gene_expr_recon_loss: 2018811.0418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375744.0886; val_optim_loss: 3375744.0886
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9796; val_auprc_score: 0.9916; val_best_acc_score: 0.9520; val_best_f1_score: 0.9685; train_kl_reg_loss: 25175.4664; train_edge_recon_loss: 1314264.7369; train_gene_expr_recon_loss: 1983477.5931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3322917.7961; train_optim_loss: 3322917.7961; val_kl_reg_loss: 25227.1952; val_edge_recon_loss: 1342749.9252; val_gene_expr_recon_loss: 2019382.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3387359.9301; val_optim_loss: 3387359.9301

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 388 min 12 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.9801
val AUPRC score: 0.9918
val best accuracy score: 0.9533
val best F1 score: 0.9692
val target rna MSE score: 0.9340
val source rna MSE score: 0.0932
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0702
Duration of model training in run 4: 6 hours, 32 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 582989
Number of validation edges: 64776
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9392; val_auprc_score: 0.9727; val_best_acc_score: 0.9140; val_best_f1_score: 0.9444; train_kl_reg_loss: 12705.4766; train_edge_recon_loss: 1383354.9143; train_gene_expr_recon_loss: 2969239.3659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4365299.7615; train_optim_loss: 4365299.7615; val_kl_reg_loss: 11422.6505; val_edge_recon_loss: 1359771.2172; val_gene_expr_recon_loss: 2713656.0709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4084849.9577; val_optim_loss: 4084849.9577
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9600; val_auprc_score: 0.9822; val_best_acc_score: 0.9345; val_best_f1_score: 0.9572; train_kl_reg_loss: 13437.0440; train_edge_recon_loss: 1328270.9941; train_gene_expr_recon_loss: 2539206.9208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3880914.9574; train_optim_loss: 3880914.9574; val_kl_reg_loss: 15597.0150; val_edge_recon_loss: 1347214.2463; val_gene_expr_recon_loss: 2393053.8873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3755865.1565; val_optim_loss: 3755865.1565
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9617; val_auprc_score: 0.9827; val_best_acc_score: 0.9376; val_best_f1_score: 0.9591; train_kl_reg_loss: 16868.8090; train_edge_recon_loss: 1325681.4466; train_gene_expr_recon_loss: 2319825.6542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3662375.9101; train_optim_loss: 3662375.9101; val_kl_reg_loss: 18397.9401; val_edge_recon_loss: 1351524.3962; val_gene_expr_recon_loss: 2266880.1245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3636802.4636; val_optim_loss: 3636802.4636
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9672; val_auprc_score: 0.9861; val_best_acc_score: 0.9380; val_best_f1_score: 0.9593; train_kl_reg_loss: 18801.0791; train_edge_recon_loss: 1323990.4472; train_gene_expr_recon_loss: 2225290.7397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3568082.2647; train_optim_loss: 3568082.2647; val_kl_reg_loss: 19331.1869; val_edge_recon_loss: 1350739.1919; val_gene_expr_recon_loss: 2202121.1280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572191.5049; val_optim_loss: 3572191.5049
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9673; val_auprc_score: 0.9860; val_best_acc_score: 0.9375; val_best_f1_score: 0.9590; train_kl_reg_loss: 20269.8742; train_edge_recon_loss: 1326577.6456; train_gene_expr_recon_loss: 2183445.3673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3530292.8881; train_optim_loss: 3530292.8881; val_kl_reg_loss: 20792.9621; val_edge_recon_loss: 1355570.4887; val_gene_expr_recon_loss: 2168117.6137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3544481.0610; val_optim_loss: 3544481.0610
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9674; val_auprc_score: 0.9859; val_best_acc_score: 0.9394; val_best_f1_score: 0.9603; train_kl_reg_loss: 21114.9917; train_edge_recon_loss: 1323482.7041; train_gene_expr_recon_loss: 2154105.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3498703.0379; train_optim_loss: 3498703.0379; val_kl_reg_loss: 21735.8643; val_edge_recon_loss: 1339823.0896; val_gene_expr_recon_loss: 2173301.5512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3534860.5049; val_optim_loss: 3534860.5049
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9711; val_auprc_score: 0.9875; val_best_acc_score: 0.9421; val_best_f1_score: 0.9620; train_kl_reg_loss: 21795.4408; train_edge_recon_loss: 1321680.6442; train_gene_expr_recon_loss: 2136641.4909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3480117.5742; train_optim_loss: 3480117.5742; val_kl_reg_loss: 22086.7049; val_edge_recon_loss: 1351526.0512; val_gene_expr_recon_loss: 2147967.7879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3521580.5492; val_optim_loss: 3521580.5492
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9726; val_auprc_score: 0.9887; val_best_acc_score: 0.9434; val_best_f1_score: 0.9629; train_kl_reg_loss: 22641.6780; train_edge_recon_loss: 1325464.2778; train_gene_expr_recon_loss: 2122686.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3470792.2368; train_optim_loss: 3470792.2368; val_kl_reg_loss: 22882.0342; val_edge_recon_loss: 1337280.0477; val_gene_expr_recon_loss: 2138855.2451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3499017.3228; val_optim_loss: 3499017.3228
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9719; val_auprc_score: 0.9880; val_best_acc_score: 0.9455; val_best_f1_score: 0.9642; train_kl_reg_loss: 23347.7645; train_edge_recon_loss: 1323365.3676; train_gene_expr_recon_loss: 2117261.0498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3463974.1794; train_optim_loss: 3463974.1794; val_kl_reg_loss: 23878.4436; val_edge_recon_loss: 1336430.6137; val_gene_expr_recon_loss: 2118755.6393; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3479064.7057; val_optim_loss: 3479064.7057
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9724; val_auprc_score: 0.9885; val_best_acc_score: 0.9430; val_best_f1_score: 0.9628; train_kl_reg_loss: 23720.2052; train_edge_recon_loss: 1319947.2155; train_gene_expr_recon_loss: 2102184.8137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3445852.2331; train_optim_loss: 3445852.2331; val_kl_reg_loss: 24123.0081; val_edge_recon_loss: 1331931.9887; val_gene_expr_recon_loss: 2135384.0679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3491439.0630; val_optim_loss: 3491439.0630
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9732; val_auprc_score: 0.9886; val_best_acc_score: 0.9454; val_best_f1_score: 0.9644; train_kl_reg_loss: 24157.9664; train_edge_recon_loss: 1319606.3499; train_gene_expr_recon_loss: 2100536.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3444301.1105; train_optim_loss: 3444301.1105; val_kl_reg_loss: 24632.2309; val_edge_recon_loss: 1332792.0251; val_gene_expr_recon_loss: 2117456.6629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3474880.9232; val_optim_loss: 3474880.9232
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9738; val_auprc_score: 0.9884; val_best_acc_score: 0.9482; val_best_f1_score: 0.9659; train_kl_reg_loss: 24698.7591; train_edge_recon_loss: 1325412.8971; train_gene_expr_recon_loss: 2090465.4050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3440577.0631; train_optim_loss: 3440577.0631; val_kl_reg_loss: 24503.2178; val_edge_recon_loss: 1349340.9941; val_gene_expr_recon_loss: 2104863.0910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3478707.3120; val_optim_loss: 3478707.3120
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9760; val_auprc_score: 0.9901; val_best_acc_score: 0.9471; val_best_f1_score: 0.9653; train_kl_reg_loss: 25140.7945; train_edge_recon_loss: 1323805.2705; train_gene_expr_recon_loss: 2091390.3360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3440336.4007; train_optim_loss: 3440336.4007; val_kl_reg_loss: 25344.0935; val_edge_recon_loss: 1333390.9911; val_gene_expr_recon_loss: 2101002.6398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3459737.7185; val_optim_loss: 3459737.7185
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9747; val_auprc_score: 0.9895; val_best_acc_score: 0.9466; val_best_f1_score: 0.9649; train_kl_reg_loss: 25659.7758; train_edge_recon_loss: 1322492.3371; train_gene_expr_recon_loss: 2082202.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3430354.2119; train_optim_loss: 3430354.2119; val_kl_reg_loss: 24759.8448; val_edge_recon_loss: 1336567.9779; val_gene_expr_recon_loss: 2120982.9464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3482310.7815; val_optim_loss: 3482310.7815
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9744; val_auprc_score: 0.9892; val_best_acc_score: 0.9484; val_best_f1_score: 0.9661; train_kl_reg_loss: 26128.9085; train_edge_recon_loss: 1322082.6886; train_gene_expr_recon_loss: 2083908.3179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3432119.9169; train_optim_loss: 3432119.9169; val_kl_reg_loss: 26467.6534; val_edge_recon_loss: 1348130.8179; val_gene_expr_recon_loss: 2095409.9449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3470008.4262; val_optim_loss: 3470008.4262
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9763; val_auprc_score: 0.9903; val_best_acc_score: 0.9482; val_best_f1_score: 0.9661; train_kl_reg_loss: 26661.9875; train_edge_recon_loss: 1322181.8863; train_gene_expr_recon_loss: 2074163.1589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3423007.0323; train_optim_loss: 3423007.0323; val_kl_reg_loss: 26701.1024; val_edge_recon_loss: 1327075.3059; val_gene_expr_recon_loss: 2088681.0020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3442457.4203; val_optim_loss: 3442457.4203
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9750; val_auprc_score: 0.9892; val_best_acc_score: 0.9498; val_best_f1_score: 0.9670; train_kl_reg_loss: 26699.5935; train_edge_recon_loss: 1322683.3291; train_gene_expr_recon_loss: 2076257.1399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3425640.0598; train_optim_loss: 3425640.0598; val_kl_reg_loss: 27475.3316; val_edge_recon_loss: 1347770.3125; val_gene_expr_recon_loss: 2089690.0650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3464935.7077; val_optim_loss: 3464935.7077
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9771; val_auprc_score: 0.9901; val_best_acc_score: 0.9521; val_best_f1_score: 0.9685; train_kl_reg_loss: 27598.4952; train_edge_recon_loss: 1319773.2294; train_gene_expr_recon_loss: 2067687.4681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3415059.1935; train_optim_loss: 3415059.1935; val_kl_reg_loss: 26849.7573; val_edge_recon_loss: 1342367.9085; val_gene_expr_recon_loss: 2082806.1457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3452023.8189; val_optim_loss: 3452023.8189
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9771; val_auprc_score: 0.9904; val_best_acc_score: 0.9505; val_best_f1_score: 0.9676; train_kl_reg_loss: 27584.6275; train_edge_recon_loss: 1321957.9174; train_gene_expr_recon_loss: 2073128.0940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3422670.6390; train_optim_loss: 3422670.6390; val_kl_reg_loss: 28133.4077; val_edge_recon_loss: 1335119.6927; val_gene_expr_recon_loss: 2084576.1058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3447829.2067; val_optim_loss: 3447829.2067
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9762; val_auprc_score: 0.9898; val_best_acc_score: 0.9503; val_best_f1_score: 0.9674; train_kl_reg_loss: 28002.9627; train_edge_recon_loss: 1322225.9481; train_gene_expr_recon_loss: 2064486.6249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3414715.5349; train_optim_loss: 3414715.5349; val_kl_reg_loss: 28189.4062; val_edge_recon_loss: 1335153.0888; val_gene_expr_recon_loss: 2086216.6403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3449559.1339; val_optim_loss: 3449559.1339

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9790; val_auprc_score: 0.9912; val_best_acc_score: 0.9527; val_best_f1_score: 0.9689; train_kl_reg_loss: 26591.3351; train_edge_recon_loss: 1319223.8988; train_gene_expr_recon_loss: 2013040.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3358855.7709; train_optim_loss: 3358855.7709; val_kl_reg_loss: 26854.0984; val_edge_recon_loss: 1331964.5118; val_gene_expr_recon_loss: 2045876.4429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3404695.0512; val_optim_loss: 3404695.0512
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9784; val_auprc_score: 0.9906; val_best_acc_score: 0.9533; val_best_f1_score: 0.9692; train_kl_reg_loss: 26506.3783; train_edge_recon_loss: 1318302.8775; train_gene_expr_recon_loss: 2004709.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3349518.3124; train_optim_loss: 3349518.3124; val_kl_reg_loss: 26449.4402; val_edge_recon_loss: 1336421.9577; val_gene_expr_recon_loss: 2037763.1644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3400634.5659; val_optim_loss: 3400634.5659
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9797; val_auprc_score: 0.9915; val_best_acc_score: 0.9524; val_best_f1_score: 0.9687; train_kl_reg_loss: 26429.6318; train_edge_recon_loss: 1318743.7279; train_gene_expr_recon_loss: 2000055.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345228.5836; train_optim_loss: 3345228.5836; val_kl_reg_loss: 26130.0131; val_edge_recon_loss: 1340106.9887; val_gene_expr_recon_loss: 2035705.0015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3401942.0098; val_optim_loss: 3401942.0098
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9796; val_auprc_score: 0.9913; val_best_acc_score: 0.9528; val_best_f1_score: 0.9690; train_kl_reg_loss: 26135.2705; train_edge_recon_loss: 1312992.6814; train_gene_expr_recon_loss: 1996738.9026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3335866.8596; train_optim_loss: 3335866.8596; val_kl_reg_loss: 26202.6695; val_edge_recon_loss: 1334029.9631; val_gene_expr_recon_loss: 2028770.1334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3389002.7717; val_optim_loss: 3389002.7717
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9803; val_auprc_score: 0.9919; val_best_acc_score: 0.9528; val_best_f1_score: 0.9689; train_kl_reg_loss: 25947.5619; train_edge_recon_loss: 1318612.6996; train_gene_expr_recon_loss: 1994869.4641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339429.7242; train_optim_loss: 3339429.7242; val_kl_reg_loss: 25942.6411; val_edge_recon_loss: 1325101.0595; val_gene_expr_recon_loss: 2035563.5084; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3386607.2096; val_optim_loss: 3386607.2096
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9794; val_auprc_score: 0.9913; val_best_acc_score: 0.9523; val_best_f1_score: 0.9686; train_kl_reg_loss: 25735.7917; train_edge_recon_loss: 1316698.3581; train_gene_expr_recon_loss: 1992284.9543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3334719.1070; train_optim_loss: 3334719.1070; val_kl_reg_loss: 25950.6799; val_edge_recon_loss: 1334907.6186; val_gene_expr_recon_loss: 2030796.8976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3391655.1988; val_optim_loss: 3391655.1988
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9803; val_auprc_score: 0.9919; val_best_acc_score: 0.9532; val_best_f1_score: 0.9692; train_kl_reg_loss: 25530.7021; train_edge_recon_loss: 1319926.4276; train_gene_expr_recon_loss: 1991054.9798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3336512.1100; train_optim_loss: 3336512.1100; val_kl_reg_loss: 25473.4114; val_edge_recon_loss: 1329263.5234; val_gene_expr_recon_loss: 2025605.8676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3380342.8031; val_optim_loss: 3380342.8031
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9801; val_auprc_score: 0.9916; val_best_acc_score: 0.9538; val_best_f1_score: 0.9696; train_kl_reg_loss: 25503.7448; train_edge_recon_loss: 1313718.4510; train_gene_expr_recon_loss: 1990194.1158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329416.3092; train_optim_loss: 3329416.3092; val_kl_reg_loss: 25589.3670; val_edge_recon_loss: 1332462.9564; val_gene_expr_recon_loss: 2026183.9572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384236.2736; val_optim_loss: 3384236.2736
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9803; val_auprc_score: 0.9919; val_best_acc_score: 0.9535; val_best_f1_score: 0.9693; train_kl_reg_loss: 25243.7386; train_edge_recon_loss: 1315835.8349; train_gene_expr_recon_loss: 1988267.2377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329346.8110; train_optim_loss: 3329346.8110; val_kl_reg_loss: 25182.3831; val_edge_recon_loss: 1342187.1353; val_gene_expr_recon_loss: 2027905.3095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3395274.8219; val_optim_loss: 3395274.8219
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9808; val_auprc_score: 0.9920; val_best_acc_score: 0.9552; val_best_f1_score: 0.9705; train_kl_reg_loss: 25099.4161; train_edge_recon_loss: 1315977.6302; train_gene_expr_recon_loss: 1987926.6665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329003.7125; train_optim_loss: 3329003.7125; val_kl_reg_loss: 25305.1402; val_edge_recon_loss: 1333062.1737; val_gene_expr_recon_loss: 2026002.4779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384369.7904; val_optim_loss: 3384369.7904
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9806; val_auprc_score: 0.9919; val_best_acc_score: 0.9551; val_best_f1_score: 0.9705; train_kl_reg_loss: 25078.9734; train_edge_recon_loss: 1318680.4289; train_gene_expr_recon_loss: 1985951.4095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329710.8119; train_optim_loss: 3329710.8119; val_kl_reg_loss: 25097.3470; val_edge_recon_loss: 1323058.9476; val_gene_expr_recon_loss: 2028341.1998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3376497.4980; val_optim_loss: 3376497.4980
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9807; val_auprc_score: 0.9919; val_best_acc_score: 0.9547; val_best_f1_score: 0.9703; train_kl_reg_loss: 24888.7866; train_edge_recon_loss: 1318057.1524; train_gene_expr_recon_loss: 1985340.1658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328286.1036; train_optim_loss: 3328286.1036; val_kl_reg_loss: 24968.2224; val_edge_recon_loss: 1327205.1216; val_gene_expr_recon_loss: 2025932.8302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3378106.1673; val_optim_loss: 3378106.1673
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9813; val_auprc_score: 0.9922; val_best_acc_score: 0.9545; val_best_f1_score: 0.9700; train_kl_reg_loss: 24768.2645; train_edge_recon_loss: 1315175.3382; train_gene_expr_recon_loss: 1984043.2146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3323986.8143; train_optim_loss: 3323986.8143; val_kl_reg_loss: 24676.9034; val_edge_recon_loss: 1326512.1688; val_gene_expr_recon_loss: 2026653.5989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377842.6683; val_optim_loss: 3377842.6683
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9804; val_auprc_score: 0.9916; val_best_acc_score: 0.9548; val_best_f1_score: 0.9702; train_kl_reg_loss: 24612.6818; train_edge_recon_loss: 1315809.6572; train_gene_expr_recon_loss: 1983224.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3323647.0621; train_optim_loss: 3323647.0621; val_kl_reg_loss: 24512.4463; val_edge_recon_loss: 1336358.9311; val_gene_expr_recon_loss: 2022435.1117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3383306.4921; val_optim_loss: 3383306.4921
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9814; val_auprc_score: 0.9924; val_best_acc_score: 0.9552; val_best_f1_score: 0.9705; train_kl_reg_loss: 24597.4885; train_edge_recon_loss: 1317349.8933; train_gene_expr_recon_loss: 1983194.9412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3325142.3229; train_optim_loss: 3325142.3229; val_kl_reg_loss: 24606.0789; val_edge_recon_loss: 1335650.6806; val_gene_expr_recon_loss: 2023911.2761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384168.0453; val_optim_loss: 3384168.0453

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9808; val_auprc_score: 0.9920; val_best_acc_score: 0.9548; val_best_f1_score: 0.9704; train_kl_reg_loss: 24349.6870; train_edge_recon_loss: 1311397.4369; train_gene_expr_recon_loss: 1976744.0118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3312491.1385; train_optim_loss: 3312491.1385; val_kl_reg_loss: 24426.2335; val_edge_recon_loss: 1319773.1735; val_gene_expr_recon_loss: 2022269.7815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366469.1821; val_optim_loss: 3366469.1821
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9814; val_auprc_score: 0.9921; val_best_acc_score: 0.9543; val_best_f1_score: 0.9699; train_kl_reg_loss: 24301.3362; train_edge_recon_loss: 1310486.3252; train_gene_expr_recon_loss: 1976607.0418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3311394.7028; train_optim_loss: 3311394.7028; val_kl_reg_loss: 24318.8267; val_edge_recon_loss: 1336043.9988; val_gene_expr_recon_loss: 2018027.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3378390.6565; val_optim_loss: 3378390.6565
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9812; val_auprc_score: 0.9921; val_best_acc_score: 0.9550; val_best_f1_score: 0.9703; train_kl_reg_loss: 24333.1790; train_edge_recon_loss: 1314759.7900; train_gene_expr_recon_loss: 1975858.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3314951.3266; train_optim_loss: 3314951.3266; val_kl_reg_loss: 24341.2653; val_edge_recon_loss: 1341883.8302; val_gene_expr_recon_loss: 2015950.8676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3382175.9646; val_optim_loss: 3382175.9646
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9808; val_auprc_score: 0.9920; val_best_acc_score: 0.9545; val_best_f1_score: 0.9700; train_kl_reg_loss: 24210.8229; train_edge_recon_loss: 1313210.1732; train_gene_expr_recon_loss: 1974553.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3311974.1608; train_optim_loss: 3311974.1608; val_kl_reg_loss: 24289.1978; val_edge_recon_loss: 1338609.9429; val_gene_expr_recon_loss: 2019589.6481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3382488.7825; val_optim_loss: 3382488.7825
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9813; val_auprc_score: 0.9923; val_best_acc_score: 0.9558; val_best_f1_score: 0.9709; train_kl_reg_loss: 24217.8978; train_edge_recon_loss: 1316615.9656; train_gene_expr_recon_loss: 1976047.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3316881.3965; train_optim_loss: 3316881.3965; val_kl_reg_loss: 24334.0102; val_edge_recon_loss: 1326978.8967; val_gene_expr_recon_loss: 2016883.2347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368196.1398; val_optim_loss: 3368196.1398

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9821; val_auprc_score: 0.9926; val_best_acc_score: 0.9556; val_best_f1_score: 0.9708; train_kl_reg_loss: 24227.2292; train_edge_recon_loss: 1311350.7848; train_gene_expr_recon_loss: 1974860.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3310438.5758; train_optim_loss: 3310438.5758; val_kl_reg_loss: 24291.9798; val_edge_recon_loss: 1325041.5814; val_gene_expr_recon_loss: 2019771.2692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3369104.8327; val_optim_loss: 3369104.8327
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9814; val_auprc_score: 0.9922; val_best_acc_score: 0.9552; val_best_f1_score: 0.9705; train_kl_reg_loss: 24217.1839; train_edge_recon_loss: 1316305.4422; train_gene_expr_recon_loss: 1974614.2451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3315136.8736; train_optim_loss: 3315136.8736; val_kl_reg_loss: 24295.3734; val_edge_recon_loss: 1336343.7468; val_gene_expr_recon_loss: 2019228.0822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379867.2126; val_optim_loss: 3379867.2126
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9809; val_auprc_score: 0.9920; val_best_acc_score: 0.9556; val_best_f1_score: 0.9709; train_kl_reg_loss: 24205.7265; train_edge_recon_loss: 1314531.7623; train_gene_expr_recon_loss: 1974544.8561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3313282.3454; train_optim_loss: 3313282.3454; val_kl_reg_loss: 24253.3834; val_edge_recon_loss: 1326105.2042; val_gene_expr_recon_loss: 2018016.2495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368374.8415; val_optim_loss: 3368374.8415
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9818; val_auprc_score: 0.9922; val_best_acc_score: 0.9566; val_best_f1_score: 0.9714; train_kl_reg_loss: 24207.2434; train_edge_recon_loss: 1314813.4009; train_gene_expr_recon_loss: 1975259.8613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3314280.5046; train_optim_loss: 3314280.5046; val_kl_reg_loss: 24275.6182; val_edge_recon_loss: 1334131.7362; val_gene_expr_recon_loss: 2020427.3888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3378834.7333; val_optim_loss: 3378834.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 519 min 58 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9807
val AUPRC score: 0.9921
val best accuracy score: 0.9552
val best F1 score: 0.9706
val target rna MSE score: 0.9279
val source rna MSE score: 0.0910
Val cat covariate0 mean sim diff: 0.0009
Val cat covariate1 mean sim diff: -0.0707
Duration of model training in run 3: 8 hours, 44 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 301585
Number of validation edges: 33509
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9182; val_auprc_score: 0.9628; val_best_acc_score: 0.9001; val_best_f1_score: 0.9358; train_kl_reg_loss: 15782.4844; train_edge_recon_loss: 1396576.6330; train_gene_expr_recon_loss: 3046266.2521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4458625.3692; train_optim_loss: 4458625.3692; val_kl_reg_loss: 11254.5809; val_edge_recon_loss: 1363526.8096; val_gene_expr_recon_loss: 2825828.7385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4200610.1469; val_optim_loss: 4200610.1469
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9334; val_auprc_score: 0.9698; val_best_acc_score: 0.9126; val_best_f1_score: 0.9434; train_kl_reg_loss: 12148.7711; train_edge_recon_loss: 1338372.6608; train_gene_expr_recon_loss: 2710019.7757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4060541.2108; train_optim_loss: 4060541.2108; val_kl_reg_loss: 13351.2564; val_edge_recon_loss: 1371737.0219; val_gene_expr_recon_loss: 2588381.2557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3973469.5382; val_optim_loss: 3973469.5382
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9386; val_auprc_score: 0.9727; val_best_acc_score: 0.9152; val_best_f1_score: 0.9449; train_kl_reg_loss: 14479.2523; train_edge_recon_loss: 1331765.2259; train_gene_expr_recon_loss: 2487588.7466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833833.2258; train_optim_loss: 3833833.2258; val_kl_reg_loss: 15911.7538; val_edge_recon_loss: 1364180.8874; val_gene_expr_recon_loss: 2404642.2366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3784734.8779; val_optim_loss: 3784734.8779
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9440; val_auprc_score: 0.9743; val_best_acc_score: 0.9207; val_best_f1_score: 0.9483; train_kl_reg_loss: 16412.8869; train_edge_recon_loss: 1328157.2978; train_gene_expr_recon_loss: 2335496.7229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3680066.9044; train_optim_loss: 3680066.9044; val_kl_reg_loss: 17262.1201; val_edge_recon_loss: 1358619.1431; val_gene_expr_recon_loss: 2287960.0821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663841.3416; val_optim_loss: 3663841.3416
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9477; val_auprc_score: 0.9765; val_best_acc_score: 0.9238; val_best_f1_score: 0.9504; train_kl_reg_loss: 17522.1142; train_edge_recon_loss: 1326142.5943; train_gene_expr_recon_loss: 2240868.2440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3584532.9527; train_optim_loss: 3584532.9527; val_kl_reg_loss: 18062.1024; val_edge_recon_loss: 1368139.3263; val_gene_expr_recon_loss: 2212473.3950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598674.8168; val_optim_loss: 3598674.8168
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9470; val_auprc_score: 0.9760; val_best_acc_score: 0.9223; val_best_f1_score: 0.9495; train_kl_reg_loss: 18519.3280; train_edge_recon_loss: 1325925.4869; train_gene_expr_recon_loss: 2181022.2736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3525467.0872; train_optim_loss: 3525467.0872; val_kl_reg_loss: 19348.8503; val_edge_recon_loss: 1365076.1708; val_gene_expr_recon_loss: 2177672.7366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3562097.7557; val_optim_loss: 3562097.7557
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9498; val_auprc_score: 0.9787; val_best_acc_score: 0.9202; val_best_f1_score: 0.9482; train_kl_reg_loss: 19497.3274; train_edge_recon_loss: 1325415.5547; train_gene_expr_recon_loss: 2142992.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3487905.8588; train_optim_loss: 3487905.8588; val_kl_reg_loss: 20547.6900; val_edge_recon_loss: 1355622.8273; val_gene_expr_recon_loss: 2141035.2290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3517205.7233; val_optim_loss: 3517205.7233
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9503; val_auprc_score: 0.9781; val_best_acc_score: 0.9250; val_best_f1_score: 0.9513; train_kl_reg_loss: 20184.4037; train_edge_recon_loss: 1321308.1684; train_gene_expr_recon_loss: 2117100.2178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3458592.7909; train_optim_loss: 3458592.7909; val_kl_reg_loss: 19842.4802; val_edge_recon_loss: 1358608.5802; val_gene_expr_recon_loss: 2119668.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3498119.9332; val_optim_loss: 3498119.9332
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9492; val_auprc_score: 0.9766; val_best_acc_score: 0.9258; val_best_f1_score: 0.9516; train_kl_reg_loss: 20551.8538; train_edge_recon_loss: 1325943.4920; train_gene_expr_recon_loss: 2098440.2404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3444935.5897; train_optim_loss: 3444935.5897; val_kl_reg_loss: 21515.0927; val_edge_recon_loss: 1350123.1336; val_gene_expr_recon_loss: 2107618.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3479256.3225; val_optim_loss: 3479256.3225
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9535; val_auprc_score: 0.9786; val_best_acc_score: 0.9278; val_best_f1_score: 0.9530; train_kl_reg_loss: 20783.7077; train_edge_recon_loss: 1323880.1556; train_gene_expr_recon_loss: 2079022.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3423686.2714; train_optim_loss: 3423686.2714; val_kl_reg_loss: 21363.3498; val_edge_recon_loss: 1359538.2309; val_gene_expr_recon_loss: 2092955.2681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3473856.8607; val_optim_loss: 3473856.8607
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9525; val_auprc_score: 0.9792; val_best_acc_score: 0.9249; val_best_f1_score: 0.9509; train_kl_reg_loss: 21276.1427; train_edge_recon_loss: 1320413.8333; train_gene_expr_recon_loss: 2072646.6663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3414336.6419; train_optim_loss: 3414336.6419; val_kl_reg_loss: 21373.5029; val_edge_recon_loss: 1377802.4313; val_gene_expr_recon_loss: 2085032.6613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3484208.5935; val_optim_loss: 3484208.5935
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9511; val_auprc_score: 0.9783; val_best_acc_score: 0.9270; val_best_f1_score: 0.9527; train_kl_reg_loss: 21453.1268; train_edge_recon_loss: 1323899.6141; train_gene_expr_recon_loss: 2057653.8509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3403006.5925; train_optim_loss: 3403006.5925; val_kl_reg_loss: 21727.6833; val_edge_recon_loss: 1360987.9351; val_gene_expr_recon_loss: 2073066.4618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3455782.0859; val_optim_loss: 3455782.0859
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9558; val_auprc_score: 0.9812; val_best_acc_score: 0.9291; val_best_f1_score: 0.9540; train_kl_reg_loss: 21665.3630; train_edge_recon_loss: 1318649.5448; train_gene_expr_recon_loss: 2051246.6640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3391561.5693; train_optim_loss: 3391561.5693; val_kl_reg_loss: 21572.2020; val_edge_recon_loss: 1346342.0219; val_gene_expr_recon_loss: 2068142.6756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3436056.8931; val_optim_loss: 3436056.8931
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9570; val_auprc_score: 0.9811; val_best_acc_score: 0.9296; val_best_f1_score: 0.9541; train_kl_reg_loss: 21911.9904; train_edge_recon_loss: 1318604.8212; train_gene_expr_recon_loss: 2043632.9281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3384149.7383; train_optim_loss: 3384149.7383; val_kl_reg_loss: 22091.2690; val_edge_recon_loss: 1352446.6794; val_gene_expr_recon_loss: 2070577.0744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3445115.0191; val_optim_loss: 3445115.0191
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9560; val_auprc_score: 0.9799; val_best_acc_score: 0.9332; val_best_f1_score: 0.9565; train_kl_reg_loss: 22232.8879; train_edge_recon_loss: 1324396.1148; train_gene_expr_recon_loss: 2039540.2950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3386169.2998; train_optim_loss: 3386169.2998; val_kl_reg_loss: 22797.6503; val_edge_recon_loss: 1347101.9695; val_gene_expr_recon_loss: 2055805.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3425704.6870; val_optim_loss: 3425704.6870
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9583; val_auprc_score: 0.9825; val_best_acc_score: 0.9286; val_best_f1_score: 0.9535; train_kl_reg_loss: 22482.6830; train_edge_recon_loss: 1322913.8615; train_gene_expr_recon_loss: 2035862.6796; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3381259.2209; train_optim_loss: 3381259.2209; val_kl_reg_loss: 22714.0092; val_edge_recon_loss: 1353111.5229; val_gene_expr_recon_loss: 2054960.1202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3430785.6546; val_optim_loss: 3430785.6546
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9550; val_auprc_score: 0.9798; val_best_acc_score: 0.9315; val_best_f1_score: 0.9552; train_kl_reg_loss: 22533.7988; train_edge_recon_loss: 1324841.7747; train_gene_expr_recon_loss: 2026771.6032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3374147.1745; train_optim_loss: 3374147.1745; val_kl_reg_loss: 22649.0786; val_edge_recon_loss: 1357403.8397; val_gene_expr_recon_loss: 2053242.1994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3433295.1279; val_optim_loss: 3433295.1279
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9548; val_auprc_score: 0.9798; val_best_acc_score: 0.9312; val_best_f1_score: 0.9551; train_kl_reg_loss: 22657.8248; train_edge_recon_loss: 1321336.0326; train_gene_expr_recon_loss: 2023049.4077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3367043.2665; train_optim_loss: 3367043.2665; val_kl_reg_loss: 23401.1542; val_edge_recon_loss: 1366640.4552; val_gene_expr_recon_loss: 2055336.0191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3445377.6260; val_optim_loss: 3445377.6260
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9575; val_auprc_score: 0.9815; val_best_acc_score: 0.9326; val_best_f1_score: 0.9561; train_kl_reg_loss: 22982.5428; train_edge_recon_loss: 1322066.2365; train_gene_expr_recon_loss: 2018836.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3363884.8978; train_optim_loss: 3363884.8978; val_kl_reg_loss: 23051.5572; val_edge_recon_loss: 1341616.0821; val_gene_expr_recon_loss: 2044158.5897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3408826.2424; val_optim_loss: 3408826.2424
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9608; val_auprc_score: 0.9834; val_best_acc_score: 0.9329; val_best_f1_score: 0.9563; train_kl_reg_loss: 23162.8497; train_edge_recon_loss: 1318915.7323; train_gene_expr_recon_loss: 2018926.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3361005.5626; train_optim_loss: 3361005.5626; val_kl_reg_loss: 23413.1458; val_edge_recon_loss: 1353941.3053; val_gene_expr_recon_loss: 2060537.9151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3437892.3550; val_optim_loss: 3437892.3550
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9607; val_auprc_score: 0.9834; val_best_acc_score: 0.9355; val_best_f1_score: 0.9578; train_kl_reg_loss: 23583.0584; train_edge_recon_loss: 1324880.6538; train_gene_expr_recon_loss: 2011633.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3360097.1402; train_optim_loss: 3360097.1402; val_kl_reg_loss: 23152.3505; val_edge_recon_loss: 1344161.6751; val_gene_expr_recon_loss: 2033891.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3401205.5878; val_optim_loss: 3401205.5878
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9595; val_auprc_score: 0.9817; val_best_acc_score: 0.9372; val_best_f1_score: 0.9590; train_kl_reg_loss: 23939.8777; train_edge_recon_loss: 1323085.3540; train_gene_expr_recon_loss: 2011584.9661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3358610.2002; train_optim_loss: 3358610.2002; val_kl_reg_loss: 23274.0635; val_edge_recon_loss: 1362529.0344; val_gene_expr_recon_loss: 2036964.1059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3422767.2118; val_optim_loss: 3422767.2118
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9555; val_auprc_score: 0.9800; val_best_acc_score: 0.9306; val_best_f1_score: 0.9547; train_kl_reg_loss: 23860.2754; train_edge_recon_loss: 1316574.4635; train_gene_expr_recon_loss: 2004955.8886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345390.6287; train_optim_loss: 3345390.6287; val_kl_reg_loss: 24287.4679; val_edge_recon_loss: 1365576.3387; val_gene_expr_recon_loss: 2035986.2080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3425850.0229; val_optim_loss: 3425850.0229
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9622; val_auprc_score: 0.9832; val_best_acc_score: 0.9388; val_best_f1_score: 0.9602; train_kl_reg_loss: 23983.7646; train_edge_recon_loss: 1314912.8153; train_gene_expr_recon_loss: 2002041.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3340938.3433; train_optim_loss: 3340938.3433; val_kl_reg_loss: 24798.9929; val_edge_recon_loss: 1341095.5382; val_gene_expr_recon_loss: 2035351.8426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3401246.3664; val_optim_loss: 3401246.3664
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9616; val_auprc_score: 0.9831; val_best_acc_score: 0.9356; val_best_f1_score: 0.9578; train_kl_reg_loss: 24622.3711; train_edge_recon_loss: 1318217.5843; train_gene_expr_recon_loss: 2002133.8751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344973.8316; train_optim_loss: 3344973.8316; val_kl_reg_loss: 24410.5536; val_edge_recon_loss: 1365863.7634; val_gene_expr_recon_loss: 2025699.6069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3415973.9198; val_optim_loss: 3415973.9198

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9643; val_auprc_score: 0.9845; val_best_acc_score: 0.9387; val_best_f1_score: 0.9599; train_kl_reg_loss: 23565.8939; train_edge_recon_loss: 1318281.6229; train_gene_expr_recon_loss: 1960020.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301867.9334; train_optim_loss: 3301867.9334; val_kl_reg_loss: 23522.3176; val_edge_recon_loss: 1343037.5849; val_gene_expr_recon_loss: 2000616.4742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367176.3798; val_optim_loss: 3367176.3798
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9612; val_auprc_score: 0.9830; val_best_acc_score: 0.9381; val_best_f1_score: 0.9597; train_kl_reg_loss: 23594.1679; train_edge_recon_loss: 1313025.5513; train_gene_expr_recon_loss: 1954616.4539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3291236.1775; train_optim_loss: 3291236.1775; val_kl_reg_loss: 23515.1088; val_edge_recon_loss: 1335401.0496; val_gene_expr_recon_loss: 2000074.2166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3358990.3702; val_optim_loss: 3358990.3702
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9641; val_auprc_score: 0.9838; val_best_acc_score: 0.9392; val_best_f1_score: 0.9600; train_kl_reg_loss: 23503.4006; train_edge_recon_loss: 1316319.6820; train_gene_expr_recon_loss: 1952271.6575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3292094.7405; train_optim_loss: 3292094.7405; val_kl_reg_loss: 23401.1194; val_edge_recon_loss: 1365582.3836; val_gene_expr_recon_loss: 1995875.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384859.3302; val_optim_loss: 3384859.3302
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9615; val_auprc_score: 0.9829; val_best_acc_score: 0.9375; val_best_f1_score: 0.9591; train_kl_reg_loss: 23364.5767; train_edge_recon_loss: 1316298.2845; train_gene_expr_recon_loss: 1950046.1050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3289708.9682; train_optim_loss: 3289708.9682; val_kl_reg_loss: 23192.7627; val_edge_recon_loss: 1351473.6851; val_gene_expr_recon_loss: 1994530.0821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3369196.5248; val_optim_loss: 3369196.5248
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9621; val_auprc_score: 0.9833; val_best_acc_score: 0.9394; val_best_f1_score: 0.9605; train_kl_reg_loss: 23125.5397; train_edge_recon_loss: 1312428.1577; train_gene_expr_recon_loss: 1949819.3960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3285373.0984; train_optim_loss: 3285373.0984; val_kl_reg_loss: 22856.6003; val_edge_recon_loss: 1335174.0687; val_gene_expr_recon_loss: 1992247.7901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3350278.4542; val_optim_loss: 3350278.4542
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9626; val_auprc_score: 0.9837; val_best_acc_score: 0.9380; val_best_f1_score: 0.9595; train_kl_reg_loss: 22799.7230; train_edge_recon_loss: 1317347.0822; train_gene_expr_recon_loss: 1947687.3634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3287834.1698; train_optim_loss: 3287834.1698; val_kl_reg_loss: 22824.3471; val_edge_recon_loss: 1338096.5859; val_gene_expr_recon_loss: 1994528.2252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3355449.1660; val_optim_loss: 3355449.1660
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9645; val_auprc_score: 0.9846; val_best_acc_score: 0.9386; val_best_f1_score: 0.9598; train_kl_reg_loss: 22671.7134; train_edge_recon_loss: 1319971.8777; train_gene_expr_recon_loss: 1946538.1051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3289181.6955; train_optim_loss: 3289181.6955; val_kl_reg_loss: 22565.0387; val_edge_recon_loss: 1345866.6641; val_gene_expr_recon_loss: 1991347.4179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3359779.0992; val_optim_loss: 3359779.0992
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9618; val_auprc_score: 0.9830; val_best_acc_score: 0.9372; val_best_f1_score: 0.9589; train_kl_reg_loss: 22587.1577; train_edge_recon_loss: 1315293.6763; train_gene_expr_recon_loss: 1945703.9344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3283584.7672; train_optim_loss: 3283584.7672; val_kl_reg_loss: 22674.9145; val_edge_recon_loss: 1347102.1269; val_gene_expr_recon_loss: 1993100.7328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3362877.7805; val_optim_loss: 3362877.7805
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9635; val_auprc_score: 0.9839; val_best_acc_score: 0.9391; val_best_f1_score: 0.9603; train_kl_reg_loss: 22585.9732; train_edge_recon_loss: 1313401.9048; train_gene_expr_recon_loss: 1944111.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3280099.5479; train_optim_loss: 3280099.5479; val_kl_reg_loss: 22442.3021; val_edge_recon_loss: 1344800.8950; val_gene_expr_recon_loss: 1993631.1794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3360874.3836; val_optim_loss: 3360874.3836

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9622; val_auprc_score: 0.9831; val_best_acc_score: 0.9376; val_best_f1_score: 0.9592; train_kl_reg_loss: 22329.0167; train_edge_recon_loss: 1324141.0469; train_gene_expr_recon_loss: 1938842.1959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3285312.2593; train_optim_loss: 3285312.2593; val_kl_reg_loss: 22391.5701; val_edge_recon_loss: 1352049.1622; val_gene_expr_recon_loss: 1988539.1899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3362979.9370; val_optim_loss: 3362979.9370
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9650; val_auprc_score: 0.9847; val_best_acc_score: 0.9387; val_best_f1_score: 0.9599; train_kl_reg_loss: 22336.3023; train_edge_recon_loss: 1318673.0579; train_gene_expr_recon_loss: 1939056.9976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3280066.3586; train_optim_loss: 3280066.3586; val_kl_reg_loss: 22460.8560; val_edge_recon_loss: 1347712.2085; val_gene_expr_recon_loss: 1994911.2137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3365084.2767; val_optim_loss: 3365084.2767
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9644; val_auprc_score: 0.9843; val_best_acc_score: 0.9415; val_best_f1_score: 0.9617; train_kl_reg_loss: 22377.7386; train_edge_recon_loss: 1316221.2686; train_gene_expr_recon_loss: 1938542.6950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3277141.7044; train_optim_loss: 3277141.7044; val_kl_reg_loss: 22499.3065; val_edge_recon_loss: 1335586.0949; val_gene_expr_recon_loss: 1991557.7252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3349643.1374; val_optim_loss: 3349643.1374
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9627; val_auprc_score: 0.9836; val_best_acc_score: 0.9381; val_best_f1_score: 0.9595; train_kl_reg_loss: 22367.4572; train_edge_recon_loss: 1317225.4106; train_gene_expr_recon_loss: 1937932.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3277524.9849; train_optim_loss: 3277524.9849; val_kl_reg_loss: 22381.6839; val_edge_recon_loss: 1356042.9294; val_gene_expr_recon_loss: 1991913.9380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3370338.5573; val_optim_loss: 3370338.5573
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9632; val_auprc_score: 0.9841; val_best_acc_score: 0.9389; val_best_f1_score: 0.9600; train_kl_reg_loss: 22333.2233; train_edge_recon_loss: 1318116.6358; train_gene_expr_recon_loss: 1938255.5816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278705.4406; train_optim_loss: 3278705.4406; val_kl_reg_loss: 22380.2295; val_edge_recon_loss: 1346884.2863; val_gene_expr_recon_loss: 1989464.8597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3358729.3836; val_optim_loss: 3358729.3836
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9618; val_auprc_score: 0.9831; val_best_acc_score: 0.9388; val_best_f1_score: 0.9599; train_kl_reg_loss: 22315.3274; train_edge_recon_loss: 1318698.4878; train_gene_expr_recon_loss: 1938102.2392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279116.0547; train_optim_loss: 3279116.0547; val_kl_reg_loss: 22432.7001; val_edge_recon_loss: 1358479.9313; val_gene_expr_recon_loss: 1988734.4714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3369647.1011; val_optim_loss: 3369647.1011
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9613; val_auprc_score: 0.9830; val_best_acc_score: 0.9383; val_best_f1_score: 0.9597; train_kl_reg_loss: 22361.5263; train_edge_recon_loss: 1314639.1962; train_gene_expr_recon_loss: 1937198.2945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274199.0157; train_optim_loss: 3274199.0157; val_kl_reg_loss: 22423.6763; val_edge_recon_loss: 1350339.2347; val_gene_expr_recon_loss: 1991225.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3363988.1775; val_optim_loss: 3363988.1775

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9637; val_auprc_score: 0.9843; val_best_acc_score: 0.9383; val_best_f1_score: 0.9597; train_kl_reg_loss: 22343.9002; train_edge_recon_loss: 1315288.7215; train_gene_expr_recon_loss: 1936590.3859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274223.0066; train_optim_loss: 3274223.0066; val_kl_reg_loss: 22408.5081; val_edge_recon_loss: 1349888.8984; val_gene_expr_recon_loss: 1989089.1956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3361386.5878; val_optim_loss: 3361386.5878
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9642; val_auprc_score: 0.9845; val_best_acc_score: 0.9392; val_best_f1_score: 0.9602; train_kl_reg_loss: 22345.5745; train_edge_recon_loss: 1318764.6778; train_gene_expr_recon_loss: 1937492.1285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278602.3796; train_optim_loss: 3278602.3796; val_kl_reg_loss: 22396.8355; val_edge_recon_loss: 1343414.9580; val_gene_expr_recon_loss: 1985442.7481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3351254.5363; val_optim_loss: 3351254.5363
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9630; val_auprc_score: 0.9834; val_best_acc_score: 0.9390; val_best_f1_score: 0.9601; train_kl_reg_loss: 22333.0587; train_edge_recon_loss: 1310826.5266; train_gene_expr_recon_loss: 1936399.4408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269559.0274; train_optim_loss: 3269559.0274; val_kl_reg_loss: 22369.5496; val_edge_recon_loss: 1354975.6317; val_gene_expr_recon_loss: 1990301.0324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367646.2080; val_optim_loss: 3367646.2080
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9656; val_auprc_score: 0.9851; val_best_acc_score: 0.9415; val_best_f1_score: 0.9618; train_kl_reg_loss: 22325.6218; train_edge_recon_loss: 1313788.2967; train_gene_expr_recon_loss: 1938595.7775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274709.6976; train_optim_loss: 3274709.6976; val_kl_reg_loss: 22393.1384; val_edge_recon_loss: 1328119.9456; val_gene_expr_recon_loss: 1990985.6050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3341498.6851; val_optim_loss: 3341498.6851
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9642; val_auprc_score: 0.9839; val_best_acc_score: 0.9382; val_best_f1_score: 0.9595; train_kl_reg_loss: 22323.3446; train_edge_recon_loss: 1313006.4436; train_gene_expr_recon_loss: 1937343.6165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3272673.4065; train_optim_loss: 3272673.4065; val_kl_reg_loss: 22385.9434; val_edge_recon_loss: 1356342.7834; val_gene_expr_recon_loss: 1989264.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367993.0992; val_optim_loss: 3367993.0992
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9639; val_auprc_score: 0.9838; val_best_acc_score: 0.9407; val_best_f1_score: 0.9613; train_kl_reg_loss: 22317.0260; train_edge_recon_loss: 1316069.9767; train_gene_expr_recon_loss: 1938086.1201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3276473.1221; train_optim_loss: 3276473.1221; val_kl_reg_loss: 22384.5438; val_edge_recon_loss: 1338893.4561; val_gene_expr_recon_loss: 1987174.4933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3348452.4905; val_optim_loss: 3348452.4905
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9630; val_auprc_score: 0.9835; val_best_acc_score: 0.9387; val_best_f1_score: 0.9600; train_kl_reg_loss: 22320.9681; train_edge_recon_loss: 1320382.4285; train_gene_expr_recon_loss: 1938154.6689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3280858.0647; train_optim_loss: 3280858.0647; val_kl_reg_loss: 22367.8753; val_edge_recon_loss: 1336991.8483; val_gene_expr_recon_loss: 1987066.6345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3346426.3607; val_optim_loss: 3346426.3607
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9637; val_auprc_score: 0.9839; val_best_acc_score: 0.9391; val_best_f1_score: 0.9600; train_kl_reg_loss: 22313.8160; train_edge_recon_loss: 1317299.5603; train_gene_expr_recon_loss: 1937476.6883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3277090.0638; train_optim_loss: 3277090.0638; val_kl_reg_loss: 22379.1996; val_edge_recon_loss: 1358327.2204; val_gene_expr_recon_loss: 1986014.8063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366721.2271; val_optim_loss: 3366721.2271

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9627; val_auprc_score: 0.9837; val_best_acc_score: 0.9378; val_best_f1_score: 0.9594; train_kl_reg_loss: 22313.2617; train_edge_recon_loss: 1318208.9872; train_gene_expr_recon_loss: 1937777.2475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278299.4913; train_optim_loss: 3278299.4913; val_kl_reg_loss: 22378.1338; val_edge_recon_loss: 1343159.9742; val_gene_expr_recon_loss: 1989230.7729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354768.8855; val_optim_loss: 3354768.8855
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9643; val_auprc_score: 0.9841; val_best_acc_score: 0.9402; val_best_f1_score: 0.9608; train_kl_reg_loss: 22306.1890; train_edge_recon_loss: 1317064.7684; train_gene_expr_recon_loss: 1937639.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3277010.7578; train_optim_loss: 3277010.7578; val_kl_reg_loss: 22369.9835; val_edge_recon_loss: 1352274.7424; val_gene_expr_recon_loss: 1986545.5983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3361190.3378; val_optim_loss: 3361190.3378
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9636; val_auprc_score: 0.9843; val_best_acc_score: 0.9389; val_best_f1_score: 0.9601; train_kl_reg_loss: 22310.3592; train_edge_recon_loss: 1311750.7881; train_gene_expr_recon_loss: 1937708.1291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3271769.2731; train_optim_loss: 3271769.2731; val_kl_reg_loss: 22354.1782; val_edge_recon_loss: 1345516.3855; val_gene_expr_recon_loss: 1986305.1727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354175.7347; val_optim_loss: 3354175.7347
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9635; val_auprc_score: 0.9839; val_best_acc_score: 0.9380; val_best_f1_score: 0.9595; train_kl_reg_loss: 22309.6384; train_edge_recon_loss: 1318780.5544; train_gene_expr_recon_loss: 1936398.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3277488.1957; train_optim_loss: 3277488.1957; val_kl_reg_loss: 22345.4891; val_edge_recon_loss: 1356040.9313; val_gene_expr_recon_loss: 1989918.1069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368304.5305; val_optim_loss: 3368304.5305

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 261 min 43 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9631
val AUPRC score: 0.9840
val best accuracy score: 0.9381
val best F1 score: 0.9595
val target rna MSE score: 0.9512
val source rna MSE score: 0.1208
Val cat covariate0 mean sim diff: 0.0005
Val cat covariate1 mean sim diff: -0.0594
Duration of model training in run 2: 4 hours, 23 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 301585
Number of validation edges: 33509
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9156; val_auprc_score: 0.9627; val_best_acc_score: 0.8930; val_best_f1_score: 0.9311; train_kl_reg_loss: 15940.5384; train_edge_recon_loss: 1400379.8886; train_gene_expr_recon_loss: 3038788.2087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4455108.6359; train_optim_loss: 4455108.6359; val_kl_reg_loss: 12016.6319; val_edge_recon_loss: 1374819.7223; val_gene_expr_recon_loss: 2812722.4504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4199558.8092; val_optim_loss: 4199558.8092
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9339; val_auprc_score: 0.9718; val_best_acc_score: 0.9058; val_best_f1_score: 0.9390; train_kl_reg_loss: 12661.8054; train_edge_recon_loss: 1341138.7867; train_gene_expr_recon_loss: 2694001.5140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4047802.1092; train_optim_loss: 4047802.1092; val_kl_reg_loss: 13840.9234; val_edge_recon_loss: 1354886.2853; val_gene_expr_recon_loss: 2587371.9065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3956099.1164; val_optim_loss: 3956099.1164
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9376; val_auprc_score: 0.9719; val_best_acc_score: 0.9146; val_best_f1_score: 0.9448; train_kl_reg_loss: 14944.4199; train_edge_recon_loss: 1333894.1151; train_gene_expr_recon_loss: 2480051.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3828889.8166; train_optim_loss: 3828889.8166; val_kl_reg_loss: 16018.9156; val_edge_recon_loss: 1364694.1498; val_gene_expr_recon_loss: 2401744.4771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3782457.5439; val_optim_loss: 3782457.5439
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9349; val_auprc_score: 0.9707; val_best_acc_score: 0.9133; val_best_f1_score: 0.9440; train_kl_reg_loss: 16220.9117; train_edge_recon_loss: 1328084.7497; train_gene_expr_recon_loss: 2325850.1991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3670155.8609; train_optim_loss: 3670155.8609; val_kl_reg_loss: 17075.3124; val_edge_recon_loss: 1371088.9723; val_gene_expr_recon_loss: 2285981.3559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3674145.6279; val_optim_loss: 3674145.6279
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9437; val_auprc_score: 0.9744; val_best_acc_score: 0.9234; val_best_f1_score: 0.9503; train_kl_reg_loss: 17593.6795; train_edge_recon_loss: 1324290.2420; train_gene_expr_recon_loss: 2232699.2496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3574583.1690; train_optim_loss: 3574583.1690; val_kl_reg_loss: 19027.8294; val_edge_recon_loss: 1340753.3120; val_gene_expr_recon_loss: 2207646.7634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3567427.9008; val_optim_loss: 3567427.9008
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9462; val_auprc_score: 0.9757; val_best_acc_score: 0.9238; val_best_f1_score: 0.9503; train_kl_reg_loss: 18643.8210; train_edge_recon_loss: 1324885.8058; train_gene_expr_recon_loss: 2174715.4635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3518245.0895; train_optim_loss: 3518245.0895; val_kl_reg_loss: 19423.0910; val_edge_recon_loss: 1359373.2118; val_gene_expr_recon_loss: 2177473.0191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3556269.3206; val_optim_loss: 3556269.3206
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9486; val_auprc_score: 0.9773; val_best_acc_score: 0.9243; val_best_f1_score: 0.9508; train_kl_reg_loss: 19384.4822; train_edge_recon_loss: 1327238.2357; train_gene_expr_recon_loss: 2136910.5587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3483533.2748; train_optim_loss: 3483533.2748; val_kl_reg_loss: 19077.0822; val_edge_recon_loss: 1356090.6317; val_gene_expr_recon_loss: 2139519.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3514686.9008; val_optim_loss: 3514686.9008
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9495; val_auprc_score: 0.9774; val_best_acc_score: 0.9227; val_best_f1_score: 0.9498; train_kl_reg_loss: 19953.0392; train_edge_recon_loss: 1325839.0561; train_gene_expr_recon_loss: 2115381.6801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3461173.7801; train_optim_loss: 3461173.7801; val_kl_reg_loss: 20293.1470; val_edge_recon_loss: 1355408.3149; val_gene_expr_recon_loss: 2122143.9256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3497845.3874; val_optim_loss: 3497845.3874
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9512; val_auprc_score: 0.9775; val_best_acc_score: 0.9280; val_best_f1_score: 0.9532; train_kl_reg_loss: 20460.4506; train_edge_recon_loss: 1326764.4807; train_gene_expr_recon_loss: 2095266.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3442491.3499; train_optim_loss: 3442491.3499; val_kl_reg_loss: 21145.1949; val_edge_recon_loss: 1355777.9361; val_gene_expr_recon_loss: 2108536.0639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3485459.1908; val_optim_loss: 3485459.1908
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9490; val_auprc_score: 0.9755; val_best_acc_score: 0.9251; val_best_f1_score: 0.9512; train_kl_reg_loss: 20767.9863; train_edge_recon_loss: 1323654.6077; train_gene_expr_recon_loss: 2078949.7027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3423372.2977; train_optim_loss: 3423372.2977; val_kl_reg_loss: 20980.1692; val_edge_recon_loss: 1361528.0544; val_gene_expr_recon_loss: 2087096.6403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3469604.8550; val_optim_loss: 3469604.8550
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9522; val_auprc_score: 0.9776; val_best_acc_score: 0.9281; val_best_f1_score: 0.9532; train_kl_reg_loss: 21065.5316; train_edge_recon_loss: 1323957.7901; train_gene_expr_recon_loss: 2068175.4616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3413198.7818; train_optim_loss: 3413198.7818; val_kl_reg_loss: 21550.9717; val_edge_recon_loss: 1356372.9094; val_gene_expr_recon_loss: 2093704.0754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3471627.9408; val_optim_loss: 3471627.9408
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9496; val_auprc_score: 0.9767; val_best_acc_score: 0.9258; val_best_f1_score: 0.9515; train_kl_reg_loss: 21376.3202; train_edge_recon_loss: 1319816.4318; train_gene_expr_recon_loss: 2061072.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3402265.2178; train_optim_loss: 3402265.2178; val_kl_reg_loss: 21784.8825; val_edge_recon_loss: 1369373.1355; val_gene_expr_recon_loss: 2082613.4113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3473771.4351; val_optim_loss: 3473771.4351
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9527; val_auprc_score: 0.9785; val_best_acc_score: 0.9261; val_best_f1_score: 0.9517; train_kl_reg_loss: 21738.0323; train_edge_recon_loss: 1318915.8942; train_gene_expr_recon_loss: 2054081.6269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3394735.5496; train_optim_loss: 3394735.5496; val_kl_reg_loss: 22127.9152; val_edge_recon_loss: 1355753.0830; val_gene_expr_recon_loss: 2073588.8006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3451469.8092; val_optim_loss: 3451469.8092
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9544; val_auprc_score: 0.9797; val_best_acc_score: 0.9292; val_best_f1_score: 0.9539; train_kl_reg_loss: 22011.9267; train_edge_recon_loss: 1325346.2297; train_gene_expr_recon_loss: 2046350.5726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3393708.7286; train_optim_loss: 3393708.7286; val_kl_reg_loss: 22069.4122; val_edge_recon_loss: 1354052.3817; val_gene_expr_recon_loss: 2064442.6908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3440564.4847; val_optim_loss: 3440564.4847
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9506; val_auprc_score: 0.9776; val_best_acc_score: 0.9253; val_best_f1_score: 0.9514; train_kl_reg_loss: 22044.8941; train_edge_recon_loss: 1320388.8705; train_gene_expr_recon_loss: 2039690.6594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382124.4201; train_optim_loss: 3382124.4201; val_kl_reg_loss: 22626.9091; val_edge_recon_loss: 1372482.2786; val_gene_expr_recon_loss: 2080491.2357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3475600.4294; val_optim_loss: 3475600.4294
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9535; val_auprc_score: 0.9793; val_best_acc_score: 0.9288; val_best_f1_score: 0.9536; train_kl_reg_loss: 22205.8577; train_edge_recon_loss: 1326534.6042; train_gene_expr_recon_loss: 2033849.2774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382589.7413; train_optim_loss: 3382589.7413; val_kl_reg_loss: 22398.9660; val_edge_recon_loss: 1358461.2863; val_gene_expr_recon_loss: 2069267.2052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3450127.4618; val_optim_loss: 3450127.4618
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9557; val_auprc_score: 0.9798; val_best_acc_score: 0.9300; val_best_f1_score: 0.9543; train_kl_reg_loss: 22526.8906; train_edge_recon_loss: 1321602.7994; train_gene_expr_recon_loss: 2030265.0181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3374394.7099; train_optim_loss: 3374394.7099; val_kl_reg_loss: 22742.3733; val_edge_recon_loss: 1356579.3149; val_gene_expr_recon_loss: 2055175.7347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3434497.4485; val_optim_loss: 3434497.4485
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9545; val_auprc_score: 0.9795; val_best_acc_score: 0.9297; val_best_f1_score: 0.9541; train_kl_reg_loss: 22564.7388; train_edge_recon_loss: 1323280.4446; train_gene_expr_recon_loss: 2026717.3964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3372562.5823; train_optim_loss: 3372562.5823; val_kl_reg_loss: 23328.8210; val_edge_recon_loss: 1358189.8044; val_gene_expr_recon_loss: 2058036.0382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3439554.6679; val_optim_loss: 3439554.6679
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9572; val_auprc_score: 0.9816; val_best_acc_score: 0.9270; val_best_f1_score: 0.9522; train_kl_reg_loss: 22724.2075; train_edge_recon_loss: 1325821.1473; train_gene_expr_recon_loss: 2020207.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3368753.1872; train_optim_loss: 3368753.1872; val_kl_reg_loss: 23163.4542; val_edge_recon_loss: 1361712.1116; val_gene_expr_recon_loss: 2050573.7090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3435449.2805; val_optim_loss: 3435449.2805
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9580; val_auprc_score: 0.9819; val_best_acc_score: 0.9296; val_best_f1_score: 0.9539; train_kl_reg_loss: 22886.7658; train_edge_recon_loss: 1320658.4039; train_gene_expr_recon_loss: 2021427.1141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3364972.2810; train_optim_loss: 3364972.2810; val_kl_reg_loss: 23339.1700; val_edge_recon_loss: 1355875.8483; val_gene_expr_recon_loss: 2050591.7080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3429806.7156; val_optim_loss: 3429806.7156
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9583; val_auprc_score: 0.9814; val_best_acc_score: 0.9314; val_best_f1_score: 0.9551; train_kl_reg_loss: 23004.8346; train_edge_recon_loss: 1315566.2414; train_gene_expr_recon_loss: 2011720.0357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3350291.1175; train_optim_loss: 3350291.1175; val_kl_reg_loss: 22634.3503; val_edge_recon_loss: 1361140.9828; val_gene_expr_recon_loss: 2059751.5849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3443526.9103; val_optim_loss: 3443526.9103
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9587; val_auprc_score: 0.9819; val_best_acc_score: 0.9331; val_best_f1_score: 0.9563; train_kl_reg_loss: 23425.9598; train_edge_recon_loss: 1326315.2897; train_gene_expr_recon_loss: 2013892.8029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3363634.0532; train_optim_loss: 3363634.0532; val_kl_reg_loss: 23409.0891; val_edge_recon_loss: 1348537.3197; val_gene_expr_recon_loss: 2042968.4218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3414914.8263; val_optim_loss: 3414914.8263
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9581; val_auprc_score: 0.9824; val_best_acc_score: 0.9296; val_best_f1_score: 0.9541; train_kl_reg_loss: 23207.7954; train_edge_recon_loss: 1320245.9515; train_gene_expr_recon_loss: 2009781.5825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3353235.3304; train_optim_loss: 3353235.3304; val_kl_reg_loss: 23725.6314; val_edge_recon_loss: 1348659.2815; val_gene_expr_recon_loss: 2043617.5821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3416002.4962; val_optim_loss: 3416002.4962
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9601; val_auprc_score: 0.9832; val_best_acc_score: 0.9326; val_best_f1_score: 0.9560; train_kl_reg_loss: 23466.0689; train_edge_recon_loss: 1322186.0351; train_gene_expr_recon_loss: 2005071.7237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3350723.8274; train_optim_loss: 3350723.8274; val_kl_reg_loss: 23622.0109; val_edge_recon_loss: 1346662.5668; val_gene_expr_recon_loss: 2045492.8893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3415777.4656; val_optim_loss: 3415777.4656
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9563; val_auprc_score: 0.9813; val_best_acc_score: 0.9290; val_best_f1_score: 0.9538; train_kl_reg_loss: 23981.3813; train_edge_recon_loss: 1327216.5844; train_gene_expr_recon_loss: 2007365.2745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3358563.2426; train_optim_loss: 3358563.2426; val_kl_reg_loss: 24388.5202; val_edge_recon_loss: 1358760.0153; val_gene_expr_recon_loss: 2041760.4790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3424909.0267; val_optim_loss: 3424909.0267
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9613; val_auprc_score: 0.9831; val_best_acc_score: 0.9353; val_best_f1_score: 0.9576; train_kl_reg_loss: 23708.3143; train_edge_recon_loss: 1318259.3270; train_gene_expr_recon_loss: 1997369.8054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339337.4440; train_optim_loss: 3339337.4440; val_kl_reg_loss: 23378.2723; val_edge_recon_loss: 1347879.8607; val_gene_expr_recon_loss: 2067076.7176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3438334.8397; val_optim_loss: 3438334.8397

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9609; val_auprc_score: 0.9824; val_best_acc_score: 0.9357; val_best_f1_score: 0.9579; train_kl_reg_loss: 23024.3180; train_edge_recon_loss: 1319163.4834; train_gene_expr_recon_loss: 1964069.4982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3306257.2971; train_optim_loss: 3306257.2971; val_kl_reg_loss: 23010.9528; val_edge_recon_loss: 1349601.2977; val_gene_expr_recon_loss: 2010035.2471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3382647.5134; val_optim_loss: 3382647.5134
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9617; val_auprc_score: 0.9833; val_best_acc_score: 0.9336; val_best_f1_score: 0.9567; train_kl_reg_loss: 22893.0109; train_edge_recon_loss: 1315320.7610; train_gene_expr_recon_loss: 1955701.4257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3293915.1961; train_optim_loss: 3293915.1961; val_kl_reg_loss: 22818.9006; val_edge_recon_loss: 1351581.1565; val_gene_expr_recon_loss: 2005408.0582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379808.1221; val_optim_loss: 3379808.1221
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9613; val_auprc_score: 0.9829; val_best_acc_score: 0.9355; val_best_f1_score: 0.9579; train_kl_reg_loss: 22750.9165; train_edge_recon_loss: 1309720.4202; train_gene_expr_recon_loss: 1953076.1185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3285547.4578; train_optim_loss: 3285547.4578; val_kl_reg_loss: 22695.8700; val_edge_recon_loss: 1341162.7710; val_gene_expr_recon_loss: 2002672.7013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366531.3435; val_optim_loss: 3366531.3435
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9625; val_auprc_score: 0.9835; val_best_acc_score: 0.9362; val_best_f1_score: 0.9581; train_kl_reg_loss: 22556.2620; train_edge_recon_loss: 1315586.0291; train_gene_expr_recon_loss: 1951259.5626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3289401.8482; train_optim_loss: 3289401.8482; val_kl_reg_loss: 22587.0422; val_edge_recon_loss: 1349430.8540; val_gene_expr_recon_loss: 2002706.0277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3374723.9160; val_optim_loss: 3374723.9160
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9623; val_auprc_score: 0.9835; val_best_acc_score: 0.9357; val_best_f1_score: 0.9579; train_kl_reg_loss: 22529.8115; train_edge_recon_loss: 1315665.3017; train_gene_expr_recon_loss: 1949084.7794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3287279.8893; train_optim_loss: 3287279.8893; val_kl_reg_loss: 22362.2935; val_edge_recon_loss: 1351525.2376; val_gene_expr_recon_loss: 1998758.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3372645.5668; val_optim_loss: 3372645.5668
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9616; val_auprc_score: 0.9835; val_best_acc_score: 0.9339; val_best_f1_score: 0.9569; train_kl_reg_loss: 22432.5904; train_edge_recon_loss: 1314323.5363; train_gene_expr_recon_loss: 1947560.0450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3284316.1737; train_optim_loss: 3284316.1737; val_kl_reg_loss: 22491.9302; val_edge_recon_loss: 1347506.9656; val_gene_expr_recon_loss: 1999024.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3369022.9733; val_optim_loss: 3369022.9733
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9643; val_auprc_score: 0.9838; val_best_acc_score: 0.9389; val_best_f1_score: 0.9601; train_kl_reg_loss: 22474.8397; train_edge_recon_loss: 1311176.4944; train_gene_expr_recon_loss: 1947032.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3280684.2665; train_optim_loss: 3280684.2665; val_kl_reg_loss: 22595.4205; val_edge_recon_loss: 1344291.9847; val_gene_expr_recon_loss: 2005090.3302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3371977.7405; val_optim_loss: 3371977.7405

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9633; val_auprc_score: 0.9838; val_best_acc_score: 0.9362; val_best_f1_score: 0.9584; train_kl_reg_loss: 22327.8885; train_edge_recon_loss: 1317977.6891; train_gene_expr_recon_loss: 1941803.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3282109.2273; train_optim_loss: 3282109.2273; val_kl_reg_loss: 22353.0148; val_edge_recon_loss: 1342995.9389; val_gene_expr_recon_loss: 1991665.8244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3357014.7767; val_optim_loss: 3357014.7767
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9619; val_auprc_score: 0.9834; val_best_acc_score: 0.9377; val_best_f1_score: 0.9593; train_kl_reg_loss: 22278.8779; train_edge_recon_loss: 1319319.6251; train_gene_expr_recon_loss: 1941838.1432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3283436.6486; train_optim_loss: 3283436.6486; val_kl_reg_loss: 22361.6684; val_edge_recon_loss: 1343076.3798; val_gene_expr_recon_loss: 1995317.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3360755.4466; val_optim_loss: 3360755.4466
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9636; val_auprc_score: 0.9842; val_best_acc_score: 0.9372; val_best_f1_score: 0.9591; train_kl_reg_loss: 22244.3008; train_edge_recon_loss: 1310509.7448; train_gene_expr_recon_loss: 1942802.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3275556.4468; train_optim_loss: 3275556.4468; val_kl_reg_loss: 22289.5274; val_edge_recon_loss: 1331845.9466; val_gene_expr_recon_loss: 1992735.4752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3346870.9504; val_optim_loss: 3346870.9504
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9642; val_auprc_score: 0.9847; val_best_acc_score: 0.9365; val_best_f1_score: 0.9587; train_kl_reg_loss: 22234.0519; train_edge_recon_loss: 1317439.2733; train_gene_expr_recon_loss: 1942048.9993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3281722.3268; train_optim_loss: 3281722.3268; val_kl_reg_loss: 22339.3815; val_edge_recon_loss: 1335007.9656; val_gene_expr_recon_loss: 1995943.7032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3353291.0477; val_optim_loss: 3353291.0477
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9641; val_auprc_score: 0.9845; val_best_acc_score: 0.9359; val_best_f1_score: 0.9582; train_kl_reg_loss: 22207.3673; train_edge_recon_loss: 1315755.1090; train_gene_expr_recon_loss: 1941670.2371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279632.7146; train_optim_loss: 3279632.7146; val_kl_reg_loss: 22248.4653; val_edge_recon_loss: 1347357.0143; val_gene_expr_recon_loss: 1998159.0926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367764.5668; val_optim_loss: 3367764.5668
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9609; val_auprc_score: 0.9827; val_best_acc_score: 0.9349; val_best_f1_score: 0.9576; train_kl_reg_loss: 22221.7298; train_edge_recon_loss: 1311530.4002; train_gene_expr_recon_loss: 1941459.0161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3275211.1520; train_optim_loss: 3275211.1520; val_kl_reg_loss: 22333.6516; val_edge_recon_loss: 1350105.3206; val_gene_expr_recon_loss: 1997275.4074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3369714.3779; val_optim_loss: 3369714.3779
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9621; val_auprc_score: 0.9834; val_best_acc_score: 0.9357; val_best_f1_score: 0.9580; train_kl_reg_loss: 22255.4367; train_edge_recon_loss: 1318884.2912; train_gene_expr_recon_loss: 1941501.1809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3282640.9073; train_optim_loss: 3282640.9073; val_kl_reg_loss: 22306.3571; val_edge_recon_loss: 1350001.7987; val_gene_expr_recon_loss: 1996343.6231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368651.7844; val_optim_loss: 3368651.7844

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9625; val_auprc_score: 0.9834; val_best_acc_score: 0.9370; val_best_f1_score: 0.9587; train_kl_reg_loss: 22227.2305; train_edge_recon_loss: 1311975.0650; train_gene_expr_recon_loss: 1940264.1661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274466.4603; train_optim_loss: 3274466.4603; val_kl_reg_loss: 22334.9952; val_edge_recon_loss: 1361267.7538; val_gene_expr_recon_loss: 1997008.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3380611.2290; val_optim_loss: 3380611.2290
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9626; val_auprc_score: 0.9837; val_best_acc_score: 0.9357; val_best_f1_score: 0.9579; train_kl_reg_loss: 22233.1070; train_edge_recon_loss: 1315732.6656; train_gene_expr_recon_loss: 1941331.9358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279297.7078; train_optim_loss: 3279297.7078; val_kl_reg_loss: 22319.4130; val_edge_recon_loss: 1363607.9924; val_gene_expr_recon_loss: 1999412.1059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3385339.5019; val_optim_loss: 3385339.5019
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9617; val_auprc_score: 0.9828; val_best_acc_score: 0.9371; val_best_f1_score: 0.9590; train_kl_reg_loss: 22218.8923; train_edge_recon_loss: 1312546.3629; train_gene_expr_recon_loss: 1940973.0842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3275738.3386; train_optim_loss: 3275738.3386; val_kl_reg_loss: 22303.4767; val_edge_recon_loss: 1340289.3693; val_gene_expr_recon_loss: 1996288.7519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3358881.5954; val_optim_loss: 3358881.5954
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9643; val_auprc_score: 0.9843; val_best_acc_score: 0.9374; val_best_f1_score: 0.9590; train_kl_reg_loss: 22214.1301; train_edge_recon_loss: 1316798.6044; train_gene_expr_recon_loss: 1940503.2108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279515.9432; train_optim_loss: 3279515.9432; val_kl_reg_loss: 22310.0172; val_edge_recon_loss: 1348610.3979; val_gene_expr_recon_loss: 1998072.3540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368992.7672; val_optim_loss: 3368992.7672

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 206 min 3 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9622
val AUPRC score: 0.9834
val best accuracy score: 0.9361
val best F1 score: 0.9583
val target rna MSE score: 0.9931
val source rna MSE score: 0.1207
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0580
Duration of model training in run 1: 3 hours, 28 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
