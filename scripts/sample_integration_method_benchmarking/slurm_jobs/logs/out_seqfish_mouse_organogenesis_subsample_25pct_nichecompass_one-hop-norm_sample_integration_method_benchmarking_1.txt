Run timestamp: 26062023_181608_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '6', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9702; val_auprc_score: 0.9678; val_best_acc_score: 0.9082; val_best_f1_score: 0.9114; train_kl_reg_loss: 73.5756; train_edge_recon_loss: 101709.6680; train_gene_expr_recon_loss: 136954.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238737.3672; train_optim_loss: 238737.3672; val_kl_reg_loss: 110.8110; val_edge_recon_loss: 117133.6562; val_gene_expr_recon_loss: 134601.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251846.1094; val_optim_loss: 251846.1094
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9695; val_auprc_score: 0.9689; val_best_acc_score: 0.9100; val_best_f1_score: 0.9096; train_kl_reg_loss: 154.7247; train_edge_recon_loss: 100285.1094; train_gene_expr_recon_loss: 135163.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235603.2891; train_optim_loss: 235603.2891; val_kl_reg_loss: 258.3972; val_edge_recon_loss: 109560.5469; val_gene_expr_recon_loss: 132997.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242816.7500; val_optim_loss: 242816.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9670; val_auprc_score: 0.9663; val_best_acc_score: 0.8641; val_best_f1_score: 0.8776; train_kl_reg_loss: 297.6703; train_edge_recon_loss: 103730.4961; train_gene_expr_recon_loss: 133018.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237047.0938; train_optim_loss: 237047.0938; val_kl_reg_loss: 372.9913; val_edge_recon_loss: 115078.1016; val_gene_expr_recon_loss: 131234.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246685.3438; val_optim_loss: 246685.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9717; val_auprc_score: 0.9701; val_best_acc_score: 0.8093; val_best_f1_score: 0.8386; train_kl_reg_loss: 417.5198; train_edge_recon_loss: 102820.8164; train_gene_expr_recon_loss: 131303.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234541.3516; train_optim_loss: 234541.3516; val_kl_reg_loss: 479.6309; val_edge_recon_loss: 118339.2578; val_gene_expr_recon_loss: 129498.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248317.8438; val_optim_loss: 248317.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9676; val_auprc_score: 0.9655; val_best_acc_score: 0.7864; val_best_f1_score: 0.8233; train_kl_reg_loss: 520.2491; train_edge_recon_loss: 103117.5742; train_gene_expr_recon_loss: 129948.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233586.7031; train_optim_loss: 233586.7031; val_kl_reg_loss: 584.6782; val_edge_recon_loss: 115566.0938; val_gene_expr_recon_loss: 127694.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243845.2188; val_optim_loss: 243845.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9655; val_auprc_score: 0.9639; val_best_acc_score: 0.7859; val_best_f1_score: 0.8228; train_kl_reg_loss: 649.7332; train_edge_recon_loss: 102026.1367; train_gene_expr_recon_loss: 128139.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230815.3594; train_optim_loss: 230815.3594; val_kl_reg_loss: 764.3809; val_edge_recon_loss: 122389.4922; val_gene_expr_recon_loss: 125828.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248982.8438; val_optim_loss: 248982.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9644; val_auprc_score: 0.9616; val_best_acc_score: 0.7775; val_best_f1_score: 0.8172; train_kl_reg_loss: 801.3084; train_edge_recon_loss: 100692.8008; train_gene_expr_recon_loss: 126443.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227937.4844; train_optim_loss: 227937.4844; val_kl_reg_loss: 787.5898; val_edge_recon_loss: 117075.8281; val_gene_expr_recon_loss: 125625.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243488.7188; val_optim_loss: 243488.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9624; val_auprc_score: 0.9579; val_best_acc_score: 0.7856; val_best_f1_score: 0.8226; train_kl_reg_loss: 826.6112; train_edge_recon_loss: 101207.7812; train_gene_expr_recon_loss: 126737.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228771.4375; train_optim_loss: 228771.4375; val_kl_reg_loss: 806.6384; val_edge_recon_loss: 116313.8984; val_gene_expr_recon_loss: 125409.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242530.1250; val_optim_loss: 242530.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9628; val_auprc_score: 0.9583; val_best_acc_score: 0.7882; val_best_f1_score: 0.8244; train_kl_reg_loss: 847.9350; train_edge_recon_loss: 102304.2305; train_gene_expr_recon_loss: 126540.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229693.0000; train_optim_loss: 229693.0000; val_kl_reg_loss: 826.4841; val_edge_recon_loss: 114824.1484; val_gene_expr_recon_loss: 125190.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240841.6250; val_optim_loss: 240841.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9624; val_auprc_score: 0.9600; val_best_acc_score: 0.7908; val_best_f1_score: 0.8262; train_kl_reg_loss: 866.7093; train_edge_recon_loss: 102634.7773; train_gene_expr_recon_loss: 125790.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229291.7812; train_optim_loss: 229291.7812; val_kl_reg_loss: 848.5891; val_edge_recon_loss: 116972.6953; val_gene_expr_recon_loss: 124971.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242793.0625; val_optim_loss: 242793.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9601; val_auprc_score: 0.9534; val_best_acc_score: 0.7900; val_best_f1_score: 0.8255; train_kl_reg_loss: 886.7376; train_edge_recon_loss: 103400.4844; train_gene_expr_recon_loss: 125936.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230223.5859; train_optim_loss: 230223.5859; val_kl_reg_loss: 870.3364; val_edge_recon_loss: 114654.8203; val_gene_expr_recon_loss: 124750.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240276.0781; val_optim_loss: 240276.0781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9613; val_auprc_score: 0.9598; val_best_acc_score: 0.7957; val_best_f1_score: 0.8295; train_kl_reg_loss: 911.1292; train_edge_recon_loss: 102286.8281; train_gene_expr_recon_loss: 125948.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229146.4531; train_optim_loss: 229146.4531; val_kl_reg_loss: 894.6005; val_edge_recon_loss: 119244.4297; val_gene_expr_recon_loss: 124527.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244666.8438; val_optim_loss: 244666.8438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9605; val_auprc_score: 0.9546; val_best_acc_score: 0.7913; val_best_f1_score: 0.8264; train_kl_reg_loss: 930.6681; train_edge_recon_loss: 103217.2539; train_gene_expr_recon_loss: 125375.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229523.0781; train_optim_loss: 229523.0781; val_kl_reg_loss: 911.7368; val_edge_recon_loss: 114140.9688; val_gene_expr_recon_loss: 124305.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239357.7812; val_optim_loss: 239357.7812
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9615; val_auprc_score: 0.9598; val_best_acc_score: 0.7952; val_best_f1_score: 0.8290; train_kl_reg_loss: 956.9706; train_edge_recon_loss: 102130.7188; train_gene_expr_recon_loss: 125497.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228585.1250; train_optim_loss: 228585.1250; val_kl_reg_loss: 934.6218; val_edge_recon_loss: 123360.3594; val_gene_expr_recon_loss: 124082.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248377.7031; val_optim_loss: 248377.7031
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9636; val_auprc_score: 0.9627; val_best_acc_score: 0.8008; val_best_f1_score: 0.8329; train_kl_reg_loss: 979.7059; train_edge_recon_loss: 101401.4727; train_gene_expr_recon_loss: 125056.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227437.5938; train_optim_loss: 227437.5938; val_kl_reg_loss: 958.2427; val_edge_recon_loss: 110017.1562; val_gene_expr_recon_loss: 123859.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234835.1875; val_optim_loss: 234835.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9630; val_auprc_score: 0.9610; val_best_acc_score: 0.8023; val_best_f1_score: 0.8339; train_kl_reg_loss: 1003.4141; train_edge_recon_loss: 100028.2734; train_gene_expr_recon_loss: 124879.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225911.3984; train_optim_loss: 225911.3984; val_kl_reg_loss: 981.7946; val_edge_recon_loss: 114237.2578; val_gene_expr_recon_loss: 123637.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238856.2500; val_optim_loss: 238856.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9598; val_auprc_score: 0.9582; val_best_acc_score: 0.7984; val_best_f1_score: 0.8311; train_kl_reg_loss: 1026.0357; train_edge_recon_loss: 101997.6250; train_gene_expr_recon_loss: 124525.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227548.9844; train_optim_loss: 227548.9844; val_kl_reg_loss: 1001.3638; val_edge_recon_loss: 112956.6641; val_gene_expr_recon_loss: 123417.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237375.9531; val_optim_loss: 237375.9531
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9613; val_auprc_score: 0.9608; val_best_acc_score: 0.7977; val_best_f1_score: 0.8306; train_kl_reg_loss: 1046.9318; train_edge_recon_loss: 101877.3906; train_gene_expr_recon_loss: 124222.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227146.6719; train_optim_loss: 227146.6719; val_kl_reg_loss: 1023.1437; val_edge_recon_loss: 119931.6562; val_gene_expr_recon_loss: 123199.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244154.5000; val_optim_loss: 244154.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9616; val_auprc_score: 0.9598; val_best_acc_score: 0.8021; val_best_f1_score: 0.8337; train_kl_reg_loss: 1062.1385; train_edge_recon_loss: 101395.6953; train_gene_expr_recon_loss: 123932.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226390.2500; train_optim_loss: 226390.2500; val_kl_reg_loss: 1025.0299; val_edge_recon_loss: 119935.2109; val_gene_expr_recon_loss: 123178.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244138.3125; val_optim_loss: 244138.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9615; val_auprc_score: 0.9612; val_best_acc_score: 0.8080; val_best_f1_score: 0.8379; train_kl_reg_loss: 1067.2188; train_edge_recon_loss: 99738.8789; train_gene_expr_recon_loss: 123973.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224779.9922; train_optim_loss: 224779.9922; val_kl_reg_loss: 1027.4629; val_edge_recon_loss: 116370.2969; val_gene_expr_recon_loss: 123156.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240554.4219; val_optim_loss: 240554.4219
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9610; val_auprc_score: 0.9570; val_best_acc_score: 0.8082; val_best_f1_score: 0.8380; train_kl_reg_loss: 1067.5679; train_edge_recon_loss: 102894.4844; train_gene_expr_recon_loss: 123933.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227895.9844; train_optim_loss: 227895.9844; val_kl_reg_loss: 1024.9677; val_edge_recon_loss: 123138.9219; val_gene_expr_recon_loss: 123135.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247299.6875; val_optim_loss: 247299.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 32 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9621
Val AUPRC score: 0.9602
Val best accuracy score: 0.7998
Val best F1 score: 0.8322
Val gene expr MSE score: 2.2056
Duration of model training in run 1: 0 hours, 0 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 27455
Number of validation edges: 3050
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9752; val_auprc_score: 0.9744; val_best_acc_score: 0.9221; val_best_f1_score: 0.9231; train_kl_reg_loss: 65.2330; train_edge_recon_loss: 102407.7344; train_gene_expr_recon_loss: 134870.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237343.6328; train_optim_loss: 237343.6328; val_kl_reg_loss: 95.7857; val_edge_recon_loss: 113726.9062; val_gene_expr_recon_loss: 134262.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248085.2500; val_optim_loss: 248085.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9695; val_auprc_score: 0.9656; val_best_acc_score: 0.9133; val_best_f1_score: 0.9149; train_kl_reg_loss: 134.3008; train_edge_recon_loss: 101027.7891; train_gene_expr_recon_loss: 133406.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234568.8672; train_optim_loss: 234568.8672; val_kl_reg_loss: 268.1922; val_edge_recon_loss: 123546.9922; val_gene_expr_recon_loss: 132566.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256381.3125; val_optim_loss: 256381.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9694; val_auprc_score: 0.9663; val_best_acc_score: 0.8362; val_best_f1_score: 0.8580; train_kl_reg_loss: 333.0017; train_edge_recon_loss: 103573.4102; train_gene_expr_recon_loss: 131778.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235684.9219; train_optim_loss: 235684.9219; val_kl_reg_loss: 448.5540; val_edge_recon_loss: 114097.3984; val_gene_expr_recon_loss: 130717.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245263.6875; val_optim_loss: 245263.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9714; val_auprc_score: 0.9676; val_best_acc_score: 0.8410; val_best_f1_score: 0.8617; train_kl_reg_loss: 475.3551; train_edge_recon_loss: 100626.5586; train_gene_expr_recon_loss: 129663.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230764.9219; train_optim_loss: 230764.9219; val_kl_reg_loss: 478.7905; val_edge_recon_loss: 110744.4141; val_gene_expr_recon_loss: 129325.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240548.7500; val_optim_loss: 240548.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9702; val_auprc_score: 0.9690; val_best_acc_score: 0.8356; val_best_f1_score: 0.8574; train_kl_reg_loss: 500.4343; train_edge_recon_loss: 104491.9414; train_gene_expr_recon_loss: 128299.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233292.1953; train_optim_loss: 233292.1953; val_kl_reg_loss: 526.9039; val_edge_recon_loss: 118220.0859; val_gene_expr_recon_loss: 127930.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246677.2188; val_optim_loss: 246677.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9691; val_auprc_score: 0.9679; val_best_acc_score: 0.8387; val_best_f1_score: 0.8599; train_kl_reg_loss: 575.5437; train_edge_recon_loss: 100567.2930; train_gene_expr_recon_loss: 126859.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228002.2031; train_optim_loss: 228002.2031; val_kl_reg_loss: 692.0079; val_edge_recon_loss: 114380.7891; val_gene_expr_recon_loss: 126154.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241227.5312; val_optim_loss: 241227.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9658; val_auprc_score: 0.9651; val_best_acc_score: 0.8270; val_best_f1_score: 0.8514; train_kl_reg_loss: 782.3379; train_edge_recon_loss: 100887.5312; train_gene_expr_recon_loss: 125111.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226781.5781; train_optim_loss: 226781.5781; val_kl_reg_loss: 978.0643; val_edge_recon_loss: 124710.9375; val_gene_expr_recon_loss: 124206.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249895.2188; val_optim_loss: 249895.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9592; val_auprc_score: 0.9567; val_best_acc_score: 0.8254; val_best_f1_score: 0.8502; train_kl_reg_loss: 1019.7928; train_edge_recon_loss: 102584.6758; train_gene_expr_recon_loss: 123994.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227599.0156; train_optim_loss: 227599.0156; val_kl_reg_loss: 1005.2480; val_edge_recon_loss: 118228.9219; val_gene_expr_recon_loss: 124011.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243245.1875; val_optim_loss: 243245.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9628; val_auprc_score: 0.9602; val_best_acc_score: 0.8228; val_best_f1_score: 0.8483; train_kl_reg_loss: 1040.6583; train_edge_recon_loss: 100614.4180; train_gene_expr_recon_loss: 123543.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225198.3672; train_optim_loss: 225198.3672; val_kl_reg_loss: 1012.4185; val_edge_recon_loss: 119891.1641; val_gene_expr_recon_loss: 123814.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244717.9375; val_optim_loss: 244717.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9628; val_auprc_score: 0.9615; val_best_acc_score: 0.8346; val_best_f1_score: 0.8569; train_kl_reg_loss: 1047.3458; train_edge_recon_loss: 100979.6641; train_gene_expr_recon_loss: 123383.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225410.6328; train_optim_loss: 225410.6328; val_kl_reg_loss: 1016.0011; val_edge_recon_loss: 108302.2656; val_gene_expr_recon_loss: 123626.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232944.9531; val_optim_loss: 232944.9531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9585; val_auprc_score: 0.9538; val_best_acc_score: 0.8284; val_best_f1_score: 0.8522; train_kl_reg_loss: 1048.0112; train_edge_recon_loss: 104015.7109; train_gene_expr_recon_loss: 123245.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228309.2500; train_optim_loss: 228309.2500; val_kl_reg_loss: 1012.7345; val_edge_recon_loss: 124282.8906; val_gene_expr_recon_loss: 123453.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248749.1875; val_optim_loss: 248749.1875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9596; val_auprc_score: 0.9548; val_best_acc_score: 0.8321; val_best_f1_score: 0.8548; train_kl_reg_loss: 1047.4204; train_edge_recon_loss: 103943.6836; train_gene_expr_recon_loss: 123228.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228219.6719; train_optim_loss: 228219.6719; val_kl_reg_loss: 1010.6560; val_edge_recon_loss: 117748.2656; val_gene_expr_recon_loss: 123292.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242051.4375; val_optim_loss: 242051.4375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9609; val_auprc_score: 0.9582; val_best_acc_score: 0.8370; val_best_f1_score: 0.8584; train_kl_reg_loss: 1043.8109; train_edge_recon_loss: 101313.4492; train_gene_expr_recon_loss: 122956.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225313.9219; train_optim_loss: 225313.9219; val_kl_reg_loss: 1006.2009; val_edge_recon_loss: 109116.8516; val_gene_expr_recon_loss: 123133.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233256.4688; val_optim_loss: 233256.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9585; val_auprc_score: 0.9538; val_best_acc_score: 0.8344; val_best_f1_score: 0.8564; train_kl_reg_loss: 1043.8483; train_edge_recon_loss: 101159.8594; train_gene_expr_recon_loss: 122815.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225019.6719; train_optim_loss: 225019.6719; val_kl_reg_loss: 1009.9512; val_edge_recon_loss: 118611.7266; val_gene_expr_recon_loss: 123116.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242738.5469; val_optim_loss: 242738.5469
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9613; val_auprc_score: 0.9577; val_best_acc_score: 0.8428; val_best_f1_score: 0.8627; train_kl_reg_loss: 1044.1025; train_edge_recon_loss: 102645.9453; train_gene_expr_recon_loss: 122852.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226542.5469; train_optim_loss: 226542.5469; val_kl_reg_loss: 1010.2649; val_edge_recon_loss: 112797.9688; val_gene_expr_recon_loss: 123100.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236908.3438; val_optim_loss: 236908.3438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9616; val_auprc_score: 0.9581; val_best_acc_score: 0.8474; val_best_f1_score: 0.8661; train_kl_reg_loss: 1043.1259; train_edge_recon_loss: 102324.0703; train_gene_expr_recon_loss: 122661.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226029.1094; train_optim_loss: 226029.1094; val_kl_reg_loss: 1010.4536; val_edge_recon_loss: 114555.7500; val_gene_expr_recon_loss: 123083.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238649.4219; val_optim_loss: 238649.4219

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9620
Val AUPRC score: 0.9563
Val best accuracy score: 0.8303
Val best F1 score: 0.8538
Val gene expr MSE score: 2.2072
Duration of model training in run 2: 0 hours, 0 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9941; val_auprc_score: 0.9938; val_best_acc_score: 0.9142; val_best_f1_score: 0.9207; train_kl_reg_loss: 91.3765; train_edge_recon_loss: 101553.8359; train_gene_expr_recon_loss: 136980.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238625.8438; train_optim_loss: 238625.8438; val_kl_reg_loss: 227.7533; val_edge_recon_loss: 113054.4766; val_gene_expr_recon_loss: 134379.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247661.2500; val_optim_loss: 247661.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9929; val_auprc_score: 0.9911; val_best_acc_score: 0.9059; val_best_f1_score: 0.8967; train_kl_reg_loss: 344.7923; train_edge_recon_loss: 102452.7832; train_gene_expr_recon_loss: 133481.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236278.9922; train_optim_loss: 236278.9922; val_kl_reg_loss: 482.8283; val_edge_recon_loss: 119721.2734; val_gene_expr_recon_loss: 130861.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251065.8594; val_optim_loss: 251065.8594
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9882; val_auprc_score: 0.9873; val_best_acc_score: 0.9253; val_best_f1_score: 0.9208; train_kl_reg_loss: 548.0532; train_edge_recon_loss: 102650.1016; train_gene_expr_recon_loss: 130084.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233283.0469; train_optim_loss: 233283.0469; val_kl_reg_loss: 657.7554; val_edge_recon_loss: 116883.9453; val_gene_expr_recon_loss: 127833.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245375.5938; val_optim_loss: 245375.5938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9825; val_auprc_score: 0.9824; val_best_acc_score: 0.9236; val_best_f1_score: 0.9196; train_kl_reg_loss: 819.2020; train_edge_recon_loss: 102664.4668; train_gene_expr_recon_loss: 127493.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230977.3984; train_optim_loss: 230977.3984; val_kl_reg_loss: 1059.8661; val_edge_recon_loss: 120617.4766; val_gene_expr_recon_loss: 124647.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246324.8438; val_optim_loss: 246324.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9730; val_auprc_score: 0.9730; val_best_acc_score: 0.8971; val_best_f1_score: 0.8893; train_kl_reg_loss: 1200.1452; train_edge_recon_loss: 101175.5820; train_gene_expr_recon_loss: 124473.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226849.5703; train_optim_loss: 226849.5703; val_kl_reg_loss: 1211.8604; val_edge_recon_loss: 118525.4062; val_gene_expr_recon_loss: 121961.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241698.5312; val_optim_loss: 241698.5312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9651; val_auprc_score: 0.9653; val_best_acc_score: 0.8633; val_best_f1_score: 0.8762; train_kl_reg_loss: 1251.9985; train_edge_recon_loss: 101559.4492; train_gene_expr_recon_loss: 122028.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224839.4531; train_optim_loss: 224839.4531; val_kl_reg_loss: 1275.6099; val_edge_recon_loss: 112969.3984; val_gene_expr_recon_loss: 119770.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234015.7500; val_optim_loss: 234015.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9541; val_auprc_score: 0.9537; val_best_acc_score: 0.8637; val_best_f1_score: 0.8723; train_kl_reg_loss: 1374.4521; train_edge_recon_loss: 100440.6406; train_gene_expr_recon_loss: 120050.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221865.5742; train_optim_loss: 221865.5742; val_kl_reg_loss: 1414.9180; val_edge_recon_loss: 109478.1562; val_gene_expr_recon_loss: 117985.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228878.2500; val_optim_loss: 228878.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9449; val_auprc_score: 0.9430; val_best_acc_score: 0.8598; val_best_f1_score: 0.8641; train_kl_reg_loss: 1503.8953; train_edge_recon_loss: 100384.0957; train_gene_expr_recon_loss: 118405.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220293.9297; train_optim_loss: 220293.9297; val_kl_reg_loss: 1568.9048; val_edge_recon_loss: 110969.2266; val_gene_expr_recon_loss: 116634.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229172.5625; val_optim_loss: 229172.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9355; val_auprc_score: 0.9310; val_best_acc_score: 0.8515; val_best_f1_score: 0.8625; train_kl_reg_loss: 1682.0735; train_edge_recon_loss: 99141.5312; train_gene_expr_recon_loss: 116922.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217745.8320; train_optim_loss: 217745.8320; val_kl_reg_loss: 1773.0582; val_edge_recon_loss: 106188.6953; val_gene_expr_recon_loss: 115612.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223574.0312; val_optim_loss: 223574.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9350; val_auprc_score: 0.9321; val_best_acc_score: 0.8492; val_best_f1_score: 0.8584; train_kl_reg_loss: 1938.6325; train_edge_recon_loss: 98192.7773; train_gene_expr_recon_loss: 115965.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216096.6289; train_optim_loss: 216096.6289; val_kl_reg_loss: 2153.2251; val_edge_recon_loss: 101473.7578; val_gene_expr_recon_loss: 114523.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218150.9688; val_optim_loss: 218150.9688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9342; val_auprc_score: 0.9313; val_best_acc_score: 0.8525; val_best_f1_score: 0.8617; train_kl_reg_loss: 2366.0369; train_edge_recon_loss: 94694.1836; train_gene_expr_recon_loss: 114944.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212004.4375; train_optim_loss: 212004.4375; val_kl_reg_loss: 2621.7104; val_edge_recon_loss: 94031.4141; val_gene_expr_recon_loss: 113609.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210262.8750; val_optim_loss: 210262.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9328; val_auprc_score: 0.9313; val_best_acc_score: 0.8521; val_best_f1_score: 0.8584; train_kl_reg_loss: 2813.2353; train_edge_recon_loss: 93369.7676; train_gene_expr_recon_loss: 114027.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210210.5117; train_optim_loss: 210210.5117; val_kl_reg_loss: 3054.5405; val_edge_recon_loss: 93451.1172; val_gene_expr_recon_loss: 112874.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209380.5312; val_optim_loss: 209380.5312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9377; val_auprc_score: 0.9377; val_best_acc_score: 0.8630; val_best_f1_score: 0.8685; train_kl_reg_loss: 3280.2081; train_edge_recon_loss: 91340.8125; train_gene_expr_recon_loss: 113310.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207931.2148; train_optim_loss: 207931.2148; val_kl_reg_loss: 3545.0034; val_edge_recon_loss: 94477.1094; val_gene_expr_recon_loss: 112110.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210132.3750; val_optim_loss: 210132.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9379; val_auprc_score: 0.9368; val_best_acc_score: 0.8609; val_best_f1_score: 0.8659; train_kl_reg_loss: 3774.8774; train_edge_recon_loss: 90617.1289; train_gene_expr_recon_loss: 112469.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206861.2852; train_optim_loss: 206861.2852; val_kl_reg_loss: 3983.3809; val_edge_recon_loss: 86537.7578; val_gene_expr_recon_loss: 111353.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201874.7188; val_optim_loss: 201874.7188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9419; val_auprc_score: 0.9397; val_best_acc_score: 0.8678; val_best_f1_score: 0.8708; train_kl_reg_loss: 4063.0958; train_edge_recon_loss: 88879.5820; train_gene_expr_recon_loss: 111802.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204744.8984; train_optim_loss: 204744.8984; val_kl_reg_loss: 4031.6528; val_edge_recon_loss: 86947.1406; val_gene_expr_recon_loss: 110626.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201605.6094; val_optim_loss: 201605.6094
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9454; val_auprc_score: 0.9449; val_best_acc_score: 0.8710; val_best_f1_score: 0.8749; train_kl_reg_loss: 4108.5850; train_edge_recon_loss: 89274.9844; train_gene_expr_recon_loss: 111068.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204452.3906; train_optim_loss: 204452.3906; val_kl_reg_loss: 4068.5564; val_edge_recon_loss: 90416.4219; val_gene_expr_recon_loss: 109904.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204389.1094; val_optim_loss: 204389.1094
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9476; val_auprc_score: 0.9466; val_best_acc_score: 0.8746; val_best_f1_score: 0.8760; train_kl_reg_loss: 4164.8959; train_edge_recon_loss: 87628.6738; train_gene_expr_recon_loss: 110306.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202099.9570; train_optim_loss: 202099.9570; val_kl_reg_loss: 4216.6201; val_edge_recon_loss: 85244.6875; val_gene_expr_recon_loss: 109193.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198655.2812; val_optim_loss: 198655.2812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9544; val_auprc_score: 0.9523; val_best_acc_score: 0.8822; val_best_f1_score: 0.8842; train_kl_reg_loss: 4307.0260; train_edge_recon_loss: 86011.8184; train_gene_expr_recon_loss: 109636.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199954.9336; train_optim_loss: 199954.9336; val_kl_reg_loss: 4354.0557; val_edge_recon_loss: 86042.5000; val_gene_expr_recon_loss: 108438.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198835.4688; val_optim_loss: 198835.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9584; val_auprc_score: 0.9569; val_best_acc_score: 0.8894; val_best_f1_score: 0.8913; train_kl_reg_loss: 4458.4856; train_edge_recon_loss: 84844.9375; train_gene_expr_recon_loss: 108731.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198034.9648; train_optim_loss: 198034.9648; val_kl_reg_loss: 4444.0566; val_edge_recon_loss: 81748.5547; val_gene_expr_recon_loss: 107641.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193834.5938; val_optim_loss: 193834.5938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9612; val_auprc_score: 0.9599; val_best_acc_score: 0.8955; val_best_f1_score: 0.8958; train_kl_reg_loss: 4510.7570; train_edge_recon_loss: 84311.4980; train_gene_expr_recon_loss: 108001.3652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196823.6133; train_optim_loss: 196823.6133; val_kl_reg_loss: 4411.8604; val_edge_recon_loss: 86923.7344; val_gene_expr_recon_loss: 106923.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198259.3438; val_optim_loss: 198259.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9635; val_auprc_score: 0.9614; val_best_acc_score: 0.8987; val_best_f1_score: 0.9001; train_kl_reg_loss: 4531.8667; train_edge_recon_loss: 85263.0938; train_gene_expr_recon_loss: 107127.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196922.1523; train_optim_loss: 196922.1523; val_kl_reg_loss: 4536.1099; val_edge_recon_loss: 84326.2969; val_gene_expr_recon_loss: 106071.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194934.2188; val_optim_loss: 194934.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9683; val_auprc_score: 0.9679; val_best_acc_score: 0.9083; val_best_f1_score: 0.9082; train_kl_reg_loss: 4651.4094; train_edge_recon_loss: 85011.8867; train_gene_expr_recon_loss: 106354.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196017.7617; train_optim_loss: 196017.7617; val_kl_reg_loss: 4586.6660; val_edge_recon_loss: 83449.4609; val_gene_expr_recon_loss: 105410.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193446.6875; val_optim_loss: 193446.6875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9696; val_auprc_score: 0.9661; val_best_acc_score: 0.9082; val_best_f1_score: 0.9093; train_kl_reg_loss: 4738.6996; train_edge_recon_loss: 83215.1953; train_gene_expr_recon_loss: 105466.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193420.7578; train_optim_loss: 193420.7578; val_kl_reg_loss: 4710.4570; val_edge_recon_loss: 80484.9062; val_gene_expr_recon_loss: 104628.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189824.0938; val_optim_loss: 189824.0938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9744; val_auprc_score: 0.9708; val_best_acc_score: 0.9189; val_best_f1_score: 0.9194; train_kl_reg_loss: 4790.9470; train_edge_recon_loss: 85024.8574; train_gene_expr_recon_loss: 105124.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194940.0234; train_optim_loss: 194940.0234; val_kl_reg_loss: 4699.1572; val_edge_recon_loss: 80044.8906; val_gene_expr_recon_loss: 104115.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188859.6875; val_optim_loss: 188859.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9772; val_auprc_score: 0.9753; val_best_acc_score: 0.9239; val_best_f1_score: 0.9234; train_kl_reg_loss: 4827.8982; train_edge_recon_loss: 81746.5781; train_gene_expr_recon_loss: 104094.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190669.0156; train_optim_loss: 190669.0156; val_kl_reg_loss: 4745.6904; val_edge_recon_loss: 85712.9766; val_gene_expr_recon_loss: 103301.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193760.6250; val_optim_loss: 193760.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9796; val_auprc_score: 0.9774; val_best_acc_score: 0.9288; val_best_f1_score: 0.9289; train_kl_reg_loss: 4837.8247; train_edge_recon_loss: 82473.1816; train_gene_expr_recon_loss: 103645.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190956.2656; train_optim_loss: 190956.2656; val_kl_reg_loss: 4648.2266; val_edge_recon_loss: 86383.1016; val_gene_expr_recon_loss: 102789.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193820.6875; val_optim_loss: 193820.6875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9827; val_auprc_score: 0.9799; val_best_acc_score: 0.9361; val_best_f1_score: 0.9365; train_kl_reg_loss: 4873.5076; train_edge_recon_loss: 82947.9473; train_gene_expr_recon_loss: 103138.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190960.1836; train_optim_loss: 190960.1836; val_kl_reg_loss: 4631.3633; val_edge_recon_loss: 81332.4453; val_gene_expr_recon_loss: 102264.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188228.4688; val_optim_loss: 188228.4688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9840; val_auprc_score: 0.9813; val_best_acc_score: 0.9386; val_best_f1_score: 0.9390; train_kl_reg_loss: 4840.2358; train_edge_recon_loss: 82211.2656; train_gene_expr_recon_loss: 102386.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189438.3828; train_optim_loss: 189438.3828; val_kl_reg_loss: 4664.4111; val_edge_recon_loss: 83287.2578; val_gene_expr_recon_loss: 101642.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189594.6250; val_optim_loss: 189594.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9838; val_auprc_score: 0.9808; val_best_acc_score: 0.9370; val_best_f1_score: 0.9381; train_kl_reg_loss: 4887.6985; train_edge_recon_loss: 81720.1797; train_gene_expr_recon_loss: 101987.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188595.8242; train_optim_loss: 188595.8242; val_kl_reg_loss: 4798.2314; val_edge_recon_loss: 82717.2891; val_gene_expr_recon_loss: 101114.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188630.4844; val_optim_loss: 188630.4844
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9853; val_auprc_score: 0.9822; val_best_acc_score: 0.9439; val_best_f1_score: 0.9446; train_kl_reg_loss: 4983.8706; train_edge_recon_loss: 83823.1250; train_gene_expr_recon_loss: 101343.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190150.4922; train_optim_loss: 190150.4922; val_kl_reg_loss: 4818.5024; val_edge_recon_loss: 81789.4141; val_gene_expr_recon_loss: 100777.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187385.3281; val_optim_loss: 187385.3281
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9852; val_auprc_score: 0.9806; val_best_acc_score: 0.9439; val_best_f1_score: 0.9447; train_kl_reg_loss: 4990.6484; train_edge_recon_loss: 81113.9980; train_gene_expr_recon_loss: 101110.8770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187215.5234; train_optim_loss: 187215.5234; val_kl_reg_loss: 4802.1074; val_edge_recon_loss: 82639.2812; val_gene_expr_recon_loss: 100219.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187660.7969; val_optim_loss: 187660.7969
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9859; val_auprc_score: 0.9836; val_best_acc_score: 0.9449; val_best_f1_score: 0.9453; train_kl_reg_loss: 4934.4392; train_edge_recon_loss: 82242.2344; train_gene_expr_recon_loss: 100476.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187652.7266; train_optim_loss: 187652.7266; val_kl_reg_loss: 4763.9980; val_edge_recon_loss: 81014.6641; val_gene_expr_recon_loss: 99897.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185676.5312; val_optim_loss: 185676.5312
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9871; val_auprc_score: 0.9849; val_best_acc_score: 0.9481; val_best_f1_score: 0.9489; train_kl_reg_loss: 4949.8571; train_edge_recon_loss: 79553.5371; train_gene_expr_recon_loss: 100119.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184622.6641; train_optim_loss: 184622.6641; val_kl_reg_loss: 4830.2334; val_edge_recon_loss: 82288.6016; val_gene_expr_recon_loss: 99417.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186536.7031; val_optim_loss: 186536.7031
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9880; val_auprc_score: 0.9865; val_best_acc_score: 0.9477; val_best_f1_score: 0.9485; train_kl_reg_loss: 4910.3643; train_edge_recon_loss: 81637.0039; train_gene_expr_recon_loss: 99548.1270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186095.4961; train_optim_loss: 186095.4961; val_kl_reg_loss: 4766.7734; val_edge_recon_loss: 82268.5078; val_gene_expr_recon_loss: 99056.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186091.7344; val_optim_loss: 186091.7344
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9885; val_auprc_score: 0.9870; val_best_acc_score: 0.9527; val_best_f1_score: 0.9536; train_kl_reg_loss: 4903.9758; train_edge_recon_loss: 81241.0293; train_gene_expr_recon_loss: 99412.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185557.0508; train_optim_loss: 185557.0508; val_kl_reg_loss: 4740.1367; val_edge_recon_loss: 82039.8047; val_gene_expr_recon_loss: 98864.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185644.4688; val_optim_loss: 185644.4688
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9890; val_auprc_score: 0.9861; val_best_acc_score: 0.9547; val_best_f1_score: 0.9557; train_kl_reg_loss: 4862.5022; train_edge_recon_loss: 81365.5801; train_gene_expr_recon_loss: 99081.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185309.8984; train_optim_loss: 185309.8984; val_kl_reg_loss: 4723.6797; val_edge_recon_loss: 81898.2969; val_gene_expr_recon_loss: 98520.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185142.7188; val_optim_loss: 185142.7188
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9892; val_auprc_score: 0.9852; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 4852.3285; train_edge_recon_loss: 82370.5098; train_gene_expr_recon_loss: 98866.7402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186089.5781; train_optim_loss: 186089.5781; val_kl_reg_loss: 4753.8047; val_edge_recon_loss: 79944.4922; val_gene_expr_recon_loss: 98239.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182937.9062; val_optim_loss: 182937.9062
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9863; val_best_acc_score: 0.9552; val_best_f1_score: 0.9560; train_kl_reg_loss: 4903.9686; train_edge_recon_loss: 81609.0762; train_gene_expr_recon_loss: 98404.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184917.5391; train_optim_loss: 184917.5391; val_kl_reg_loss: 4761.2393; val_edge_recon_loss: 81601.2656; val_gene_expr_recon_loss: 98032.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184395.0938; val_optim_loss: 184395.0938
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9904; val_auprc_score: 0.9879; val_best_acc_score: 0.9570; val_best_f1_score: 0.9576; train_kl_reg_loss: 4863.0206; train_edge_recon_loss: 80925.5605; train_gene_expr_recon_loss: 98442.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184230.7383; train_optim_loss: 184230.7383; val_kl_reg_loss: 4648.9043; val_edge_recon_loss: 81472.0234; val_gene_expr_recon_loss: 97653.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183774.3281; val_optim_loss: 183774.3281
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9892; val_auprc_score: 0.9863; val_best_acc_score: 0.9562; val_best_f1_score: 0.9572; train_kl_reg_loss: 4771.6233; train_edge_recon_loss: 81227.8906; train_gene_expr_recon_loss: 98206.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184206.2070; train_optim_loss: 184206.2070; val_kl_reg_loss: 4664.7461; val_edge_recon_loss: 82755.8203; val_gene_expr_recon_loss: 97474.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184895.0000; val_optim_loss: 184895.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9910; val_auprc_score: 0.9897; val_best_acc_score: 0.9578; val_best_f1_score: 0.9586; train_kl_reg_loss: 4791.7869; train_edge_recon_loss: 81117.8613; train_gene_expr_recon_loss: 97849.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183758.8398; train_optim_loss: 183758.8398; val_kl_reg_loss: 4659.5820; val_edge_recon_loss: 81374.5859; val_gene_expr_recon_loss: 97426.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183460.7812; val_optim_loss: 183460.7812
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9908; val_auprc_score: 0.9887; val_best_acc_score: 0.9598; val_best_f1_score: 0.9603; train_kl_reg_loss: 4795.0731; train_edge_recon_loss: 81673.9434; train_gene_expr_recon_loss: 97948.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184417.7305; train_optim_loss: 184417.7305; val_kl_reg_loss: 4653.0039; val_edge_recon_loss: 80447.9453; val_gene_expr_recon_loss: 97390.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182491.2656; val_optim_loss: 182491.2656
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9903; val_auprc_score: 0.9886; val_best_acc_score: 0.9570; val_best_f1_score: 0.9578; train_kl_reg_loss: 4790.0897; train_edge_recon_loss: 81822.3438; train_gene_expr_recon_loss: 97948.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184560.7266; train_optim_loss: 184560.7266; val_kl_reg_loss: 4653.2373; val_edge_recon_loss: 81873.7188; val_gene_expr_recon_loss: 97388.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183915.7188; val_optim_loss: 183915.7188
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9890; val_auprc_score: 0.9848; val_best_acc_score: 0.9553; val_best_f1_score: 0.9563; train_kl_reg_loss: 4781.1616; train_edge_recon_loss: 80156.7500; train_gene_expr_recon_loss: 97760.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182698.2578; train_optim_loss: 182698.2578; val_kl_reg_loss: 4631.4429; val_edge_recon_loss: 81041.4844; val_gene_expr_recon_loss: 97355.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183028.1875; val_optim_loss: 183028.1875
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9896; val_auprc_score: 0.9860; val_best_acc_score: 0.9567; val_best_f1_score: 0.9576; train_kl_reg_loss: 4770.8943; train_edge_recon_loss: 80380.3555; train_gene_expr_recon_loss: 97927.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183079.1172; train_optim_loss: 183079.1172; val_kl_reg_loss: 4630.5801; val_edge_recon_loss: 82570.7188; val_gene_expr_recon_loss: 97336.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184537.6875; val_optim_loss: 184537.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9904; val_auprc_score: 0.9876; val_best_acc_score: 0.9591; val_best_f1_score: 0.9598; train_kl_reg_loss: 4764.8107; train_edge_recon_loss: 80941.4551; train_gene_expr_recon_loss: 97748.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183455.0195; train_optim_loss: 183455.0195; val_kl_reg_loss: 4633.6631; val_edge_recon_loss: 77629.0703; val_gene_expr_recon_loss: 97334.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179597.4062; val_optim_loss: 179597.4062
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9902; val_auprc_score: 0.9883; val_best_acc_score: 0.9572; val_best_f1_score: 0.9580; train_kl_reg_loss: 4765.6880; train_edge_recon_loss: 81157.1660; train_gene_expr_recon_loss: 97954.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183877.5469; train_optim_loss: 183877.5469; val_kl_reg_loss: 4639.8003; val_edge_recon_loss: 81545.1719; val_gene_expr_recon_loss: 97329.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183514.7500; val_optim_loss: 183514.7500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9906; val_auprc_score: 0.9878; val_best_acc_score: 0.9583; val_best_f1_score: 0.9591; train_kl_reg_loss: 4768.5211; train_edge_recon_loss: 81100.4902; train_gene_expr_recon_loss: 97731.0098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183600.0156; train_optim_loss: 183600.0156; val_kl_reg_loss: 4635.5771; val_edge_recon_loss: 79865.7031; val_gene_expr_recon_loss: 97324.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181826.0938; val_optim_loss: 181826.0938
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9904; val_auprc_score: 0.9874; val_best_acc_score: 0.9578; val_best_f1_score: 0.9583; train_kl_reg_loss: 4768.4331; train_edge_recon_loss: 81055.2285; train_gene_expr_recon_loss: 97586.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183410.4727; train_optim_loss: 183410.4727; val_kl_reg_loss: 4639.7446; val_edge_recon_loss: 81428.0391; val_gene_expr_recon_loss: 97320.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183388.1250; val_optim_loss: 183388.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9893; val_auprc_score: 0.9863; val_best_acc_score: 0.9574; val_best_f1_score: 0.9580; train_kl_reg_loss: 4773.8522; train_edge_recon_loss: 81639.1328; train_gene_expr_recon_loss: 97799.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184212.4570; train_optim_loss: 184212.4570; val_kl_reg_loss: 4638.5400; val_edge_recon_loss: 81499.3828; val_gene_expr_recon_loss: 97320.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183457.9375; val_optim_loss: 183457.9375
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9903; val_auprc_score: 0.9871; val_best_acc_score: 0.9573; val_best_f1_score: 0.9579; train_kl_reg_loss: 4769.5260; train_edge_recon_loss: 80047.7012; train_gene_expr_recon_loss: 97670.4199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182487.6406; train_optim_loss: 182487.6406; val_kl_reg_loss: 4634.6709; val_edge_recon_loss: 81149.3672; val_gene_expr_recon_loss: 97319.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183103.8750; val_optim_loss: 183103.8750
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9904; val_auprc_score: 0.9877; val_best_acc_score: 0.9567; val_best_f1_score: 0.9576; train_kl_reg_loss: 4770.2302; train_edge_recon_loss: 83257.0117; train_gene_expr_recon_loss: 97663.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185691.0000; train_optim_loss: 185691.0000; val_kl_reg_loss: 4636.7891; val_edge_recon_loss: 85044.0000; val_gene_expr_recon_loss: 97319.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187000.6250; val_optim_loss: 187000.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 40 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9910
Val AUPRC score: 0.9891
Val best accuracy score: 0.9583
Val best F1 score: 0.9591
Val gene expr MSE score: 1.3091
Duration of model training in run 3: 0 hours, 2 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 53693
Number of validation edges: 5965
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9927; val_auprc_score: 0.9910; val_best_acc_score: 0.8892; val_best_f1_score: 0.8999; train_kl_reg_loss: 107.3139; train_edge_recon_loss: 103098.1816; train_gene_expr_recon_loss: 134118.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237323.9844; train_optim_loss: 237323.9844; val_kl_reg_loss: 274.8813; val_edge_recon_loss: 117499.1797; val_gene_expr_recon_loss: 130404.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248178.5312; val_optim_loss: 248178.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9916; val_auprc_score: 0.9916; val_best_acc_score: 0.8992; val_best_f1_score: 0.8887; train_kl_reg_loss: 407.0472; train_edge_recon_loss: 100779.7910; train_gene_expr_recon_loss: 130385.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231571.9688; train_optim_loss: 231571.9688; val_kl_reg_loss: 514.9022; val_edge_recon_loss: 117300.8438; val_gene_expr_recon_loss: 127113.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244929.4375; val_optim_loss: 244929.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9862; val_auprc_score: 0.9848; val_best_acc_score: 0.9161; val_best_f1_score: 0.9103; train_kl_reg_loss: 582.2854; train_edge_recon_loss: 103306.3652; train_gene_expr_recon_loss: 127570.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231459.1562; train_optim_loss: 231459.1562; val_kl_reg_loss: 741.5685; val_edge_recon_loss: 120931.0000; val_gene_expr_recon_loss: 124108.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245780.6250; val_optim_loss: 245780.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9811; val_auprc_score: 0.9817; val_best_acc_score: 0.9201; val_best_f1_score: 0.9162; train_kl_reg_loss: 949.2336; train_edge_recon_loss: 102321.0820; train_gene_expr_recon_loss: 124242.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227513.0781; train_optim_loss: 227513.0781; val_kl_reg_loss: 1204.4065; val_edge_recon_loss: 115596.8047; val_gene_expr_recon_loss: 120821.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237622.6250; val_optim_loss: 237622.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9729; val_auprc_score: 0.9721; val_best_acc_score: 0.8997; val_best_f1_score: 0.8929; train_kl_reg_loss: 1373.0399; train_edge_recon_loss: 102762.6270; train_gene_expr_recon_loss: 121166.9941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225302.6602; train_optim_loss: 225302.6602; val_kl_reg_loss: 1450.0585; val_edge_recon_loss: 115379.9219; val_gene_expr_recon_loss: 118061.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234891.1562; val_optim_loss: 234891.1562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9652; val_auprc_score: 0.9656; val_best_acc_score: 0.8632; val_best_f1_score: 0.8761; train_kl_reg_loss: 1482.7230; train_edge_recon_loss: 101813.7773; train_gene_expr_recon_loss: 118884.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222181.4141; train_optim_loss: 222181.4141; val_kl_reg_loss: 1393.5370; val_edge_recon_loss: 115826.4688; val_gene_expr_recon_loss: 116532.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233752.2188; val_optim_loss: 233752.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9544; val_auprc_score: 0.9520; val_best_acc_score: 0.8728; val_best_f1_score: 0.8797; train_kl_reg_loss: 1443.2030; train_edge_recon_loss: 100982.0156; train_gene_expr_recon_loss: 117516.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219941.5977; train_optim_loss: 219941.5977; val_kl_reg_loss: 1434.0519; val_edge_recon_loss: 112672.2891; val_gene_expr_recon_loss: 115078.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229184.6250; val_optim_loss: 229184.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9453; val_auprc_score: 0.9440; val_best_acc_score: 0.8616; val_best_f1_score: 0.8651; train_kl_reg_loss: 1535.3978; train_edge_recon_loss: 100135.6289; train_gene_expr_recon_loss: 116129.1543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217800.1836; train_optim_loss: 217800.1836; val_kl_reg_loss: 1562.2520; val_edge_recon_loss: 104414.2422; val_gene_expr_recon_loss: 113992.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219968.5938; val_optim_loss: 219968.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9410; val_auprc_score: 0.9384; val_best_acc_score: 0.8578; val_best_f1_score: 0.8635; train_kl_reg_loss: 1691.6432; train_edge_recon_loss: 98935.6016; train_gene_expr_recon_loss: 115101.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215728.5195; train_optim_loss: 215728.5195; val_kl_reg_loss: 1841.0291; val_edge_recon_loss: 98735.4609; val_gene_expr_recon_loss: 112994.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213570.6406; val_optim_loss: 213570.6406
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9354; val_auprc_score: 0.9323; val_best_acc_score: 0.8541; val_best_f1_score: 0.8590; train_kl_reg_loss: 2063.3637; train_edge_recon_loss: 97251.0293; train_gene_expr_recon_loss: 113655.0254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212969.4180; train_optim_loss: 212969.4180; val_kl_reg_loss: 2256.0806; val_edge_recon_loss: 97030.3906; val_gene_expr_recon_loss: 112041.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211327.6406; val_optim_loss: 211327.6406
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9336; val_auprc_score: 0.9327; val_best_acc_score: 0.8539; val_best_f1_score: 0.8603; train_kl_reg_loss: 2477.9770; train_edge_recon_loss: 95767.5312; train_gene_expr_recon_loss: 112932.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211178.3633; train_optim_loss: 211178.3633; val_kl_reg_loss: 2649.9612; val_edge_recon_loss: 93460.2344; val_gene_expr_recon_loss: 111323.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207434.0469; val_optim_loss: 207434.0469
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9375; val_auprc_score: 0.9357; val_best_acc_score: 0.8612; val_best_f1_score: 0.8665; train_kl_reg_loss: 2891.4482; train_edge_recon_loss: 94151.0527; train_gene_expr_recon_loss: 112303.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209345.5938; train_optim_loss: 209345.5938; val_kl_reg_loss: 3083.4424; val_edge_recon_loss: 92935.4766; val_gene_expr_recon_loss: 110768.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206787.6562; val_optim_loss: 206787.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9374; val_auprc_score: 0.9361; val_best_acc_score: 0.8639; val_best_f1_score: 0.8683; train_kl_reg_loss: 3408.7373; train_edge_recon_loss: 90161.5879; train_gene_expr_recon_loss: 111847.9004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205418.2266; train_optim_loss: 205418.2266; val_kl_reg_loss: 3654.2505; val_edge_recon_loss: 91185.8984; val_gene_expr_recon_loss: 109987.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204828.0938; val_optim_loss: 204828.0938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9391; val_auprc_score: 0.9370; val_best_acc_score: 0.8657; val_best_f1_score: 0.8692; train_kl_reg_loss: 3911.6422; train_edge_recon_loss: 88809.0586; train_gene_expr_recon_loss: 110865.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203586.4688; train_optim_loss: 203586.4688; val_kl_reg_loss: 4013.7388; val_edge_recon_loss: 88851.9609; val_gene_expr_recon_loss: 109356.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202221.8438; val_optim_loss: 202221.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9417; val_auprc_score: 0.9422; val_best_acc_score: 0.8652; val_best_f1_score: 0.8692; train_kl_reg_loss: 4181.0284; train_edge_recon_loss: 87272.6582; train_gene_expr_recon_loss: 110251.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201705.3359; train_optim_loss: 201705.3359; val_kl_reg_loss: 4110.1426; val_edge_recon_loss: 85447.5703; val_gene_expr_recon_loss: 108526.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198084.5000; val_optim_loss: 198084.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9436; val_auprc_score: 0.9436; val_best_acc_score: 0.8716; val_best_f1_score: 0.8717; train_kl_reg_loss: 4253.5935; train_edge_recon_loss: 88379.4824; train_gene_expr_recon_loss: 109330.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201963.6367; train_optim_loss: 201963.6367; val_kl_reg_loss: 4168.1719; val_edge_recon_loss: 86118.4688; val_gene_expr_recon_loss: 107828.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198114.7500; val_optim_loss: 198114.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9487; val_auprc_score: 0.9487; val_best_acc_score: 0.8746; val_best_f1_score: 0.8753; train_kl_reg_loss: 4301.2435; train_edge_recon_loss: 85040.0273; train_gene_expr_recon_loss: 108651.3262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197992.5977; train_optim_loss: 197992.5977; val_kl_reg_loss: 4234.6338; val_edge_recon_loss: 89419.8672; val_gene_expr_recon_loss: 106960.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200614.6875; val_optim_loss: 200614.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9513; val_auprc_score: 0.9499; val_best_acc_score: 0.8794; val_best_f1_score: 0.8794; train_kl_reg_loss: 4347.1880; train_edge_recon_loss: 86391.0449; train_gene_expr_recon_loss: 107625.4043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198363.6328; train_optim_loss: 198363.6328; val_kl_reg_loss: 4218.4922; val_edge_recon_loss: 87444.3438; val_gene_expr_recon_loss: 106280.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197942.8906; val_optim_loss: 197942.8906
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9599; val_auprc_score: 0.9609; val_best_acc_score: 0.8914; val_best_f1_score: 0.8920; train_kl_reg_loss: 4383.6997; train_edge_recon_loss: 85186.5137; train_gene_expr_recon_loss: 107131.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196701.8203; train_optim_loss: 196701.8203; val_kl_reg_loss: 4351.3203; val_edge_recon_loss: 85339.8594; val_gene_expr_recon_loss: 105438.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195129.4688; val_optim_loss: 195129.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9630; val_auprc_score: 0.9635; val_best_acc_score: 0.8964; val_best_f1_score: 0.8969; train_kl_reg_loss: 4534.2686; train_edge_recon_loss: 83983.7930; train_gene_expr_recon_loss: 106413.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194931.6758; train_optim_loss: 194931.6758; val_kl_reg_loss: 4467.3076; val_edge_recon_loss: 86131.3672; val_gene_expr_recon_loss: 104775.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195374.0312; val_optim_loss: 195374.0312
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9646; val_auprc_score: 0.9626; val_best_acc_score: 0.8988; val_best_f1_score: 0.9002; train_kl_reg_loss: 4630.9333; train_edge_recon_loss: 83843.1797; train_gene_expr_recon_loss: 105509.3184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193983.4336; train_optim_loss: 193983.4336; val_kl_reg_loss: 4643.7764; val_edge_recon_loss: 84264.7109; val_gene_expr_recon_loss: 104019.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192927.8438; val_optim_loss: 192927.8438
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9684; val_auprc_score: 0.9654; val_best_acc_score: 0.9087; val_best_f1_score: 0.9087; train_kl_reg_loss: 4841.9144; train_edge_recon_loss: 83427.9902; train_gene_expr_recon_loss: 104812.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193082.2578; train_optim_loss: 193082.2578; val_kl_reg_loss: 4768.6616; val_edge_recon_loss: 84354.0547; val_gene_expr_recon_loss: 103411.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192533.8125; val_optim_loss: 192533.8125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9703; val_auprc_score: 0.9690; val_best_acc_score: 0.9122; val_best_f1_score: 0.9121; train_kl_reg_loss: 4893.8308; train_edge_recon_loss: 85049.9062; train_gene_expr_recon_loss: 104099.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194043.3008; train_optim_loss: 194043.3008; val_kl_reg_loss: 4754.1279; val_edge_recon_loss: 85095.3828; val_gene_expr_recon_loss: 102766.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192616.4062; val_optim_loss: 192616.4062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9737; val_auprc_score: 0.9704; val_best_acc_score: 0.9169; val_best_f1_score: 0.9171; train_kl_reg_loss: 4863.9221; train_edge_recon_loss: 82224.9648; train_gene_expr_recon_loss: 103524.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190613.4766; train_optim_loss: 190613.4766; val_kl_reg_loss: 4651.1548; val_edge_recon_loss: 82544.6328; val_gene_expr_recon_loss: 102228.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189424.6250; val_optim_loss: 189424.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9763; val_auprc_score: 0.9751; val_best_acc_score: 0.9220; val_best_f1_score: 0.9227; train_kl_reg_loss: 4787.3047; train_edge_recon_loss: 82825.7559; train_gene_expr_recon_loss: 103107.9668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190721.0312; train_optim_loss: 190721.0312; val_kl_reg_loss: 4678.3447; val_edge_recon_loss: 80631.0703; val_gene_expr_recon_loss: 101643.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186953.3125; val_optim_loss: 186953.3125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9794; val_auprc_score: 0.9776; val_best_acc_score: 0.9284; val_best_f1_score: 0.9292; train_kl_reg_loss: 4774.5337; train_edge_recon_loss: 82267.5820; train_gene_expr_recon_loss: 102453.0898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189495.2031; train_optim_loss: 189495.2031; val_kl_reg_loss: 4484.3623; val_edge_recon_loss: 84138.7422; val_gene_expr_recon_loss: 101346.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189969.7344; val_optim_loss: 189969.7344
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9813; val_auprc_score: 0.9800; val_best_acc_score: 0.9342; val_best_f1_score: 0.9344; train_kl_reg_loss: 4701.0122; train_edge_recon_loss: 83766.8379; train_gene_expr_recon_loss: 102105.5430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190573.3906; train_optim_loss: 190573.3906; val_kl_reg_loss: 4533.2842; val_edge_recon_loss: 83231.1484; val_gene_expr_recon_loss: 100835.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188600.0625; val_optim_loss: 188600.0625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9831; val_auprc_score: 0.9826; val_best_acc_score: 0.9343; val_best_f1_score: 0.9348; train_kl_reg_loss: 4783.8422; train_edge_recon_loss: 81499.4141; train_gene_expr_recon_loss: 101515.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187798.8789; train_optim_loss: 187798.8789; val_kl_reg_loss: 4603.8721; val_edge_recon_loss: 80271.6562; val_gene_expr_recon_loss: 100336.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185212.1875; val_optim_loss: 185212.1875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9834; val_auprc_score: 0.9789; val_best_acc_score: 0.9397; val_best_f1_score: 0.9403; train_kl_reg_loss: 4814.3145; train_edge_recon_loss: 80686.3223; train_gene_expr_recon_loss: 101187.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186687.8086; train_optim_loss: 186687.8086; val_kl_reg_loss: 4589.4614; val_edge_recon_loss: 84472.0391; val_gene_expr_recon_loss: 99863.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188924.6875; val_optim_loss: 188924.6875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9841; val_auprc_score: 0.9804; val_best_acc_score: 0.9415; val_best_f1_score: 0.9420; train_kl_reg_loss: 4764.1688; train_edge_recon_loss: 82039.8105; train_gene_expr_recon_loss: 100660.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187464.3477; train_optim_loss: 187464.3477; val_kl_reg_loss: 4525.9795; val_edge_recon_loss: 81078.3438; val_gene_expr_recon_loss: 99533.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185137.9844; val_optim_loss: 185137.9844
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9856; val_auprc_score: 0.9824; val_best_acc_score: 0.9442; val_best_f1_score: 0.9453; train_kl_reg_loss: 4740.4194; train_edge_recon_loss: 81027.8965; train_gene_expr_recon_loss: 100328.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186097.2461; train_optim_loss: 186097.2461; val_kl_reg_loss: 4567.0342; val_edge_recon_loss: 81374.8750; val_gene_expr_recon_loss: 99235.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185177.8750; val_optim_loss: 185177.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9859; val_auprc_score: 0.9837; val_best_acc_score: 0.9439; val_best_f1_score: 0.9449; train_kl_reg_loss: 4749.6259; train_edge_recon_loss: 81567.5742; train_gene_expr_recon_loss: 100094.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186411.6641; train_optim_loss: 186411.6641; val_kl_reg_loss: 4574.3066; val_edge_recon_loss: 81845.4297; val_gene_expr_recon_loss: 98894.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185314.2500; val_optim_loss: 185314.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9873; val_auprc_score: 0.9848; val_best_acc_score: 0.9497; val_best_f1_score: 0.9499; train_kl_reg_loss: 4728.5066; train_edge_recon_loss: 81506.4863; train_gene_expr_recon_loss: 99686.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185921.0469; train_optim_loss: 185921.0469; val_kl_reg_loss: 4521.1631; val_edge_recon_loss: 80351.2891; val_gene_expr_recon_loss: 98538.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183410.8281; val_optim_loss: 183410.8281
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9871; val_auprc_score: 0.9836; val_best_acc_score: 0.9495; val_best_f1_score: 0.9500; train_kl_reg_loss: 4694.5372; train_edge_recon_loss: 81221.3848; train_gene_expr_recon_loss: 99216.9785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185132.9023; train_optim_loss: 185132.9023; val_kl_reg_loss: 4553.7939; val_edge_recon_loss: 81029.9375; val_gene_expr_recon_loss: 98205.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183789.0312; val_optim_loss: 183789.0312
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9888; val_auprc_score: 0.9865; val_best_acc_score: 0.9551; val_best_f1_score: 0.9554; train_kl_reg_loss: 4759.7087; train_edge_recon_loss: 83296.2539; train_gene_expr_recon_loss: 98985.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187041.9414; train_optim_loss: 187041.9414; val_kl_reg_loss: 4610.8242; val_edge_recon_loss: 79785.2266; val_gene_expr_recon_loss: 97883.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182279.6562; val_optim_loss: 182279.6562
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9900; val_auprc_score: 0.9889; val_best_acc_score: 0.9543; val_best_f1_score: 0.9548; train_kl_reg_loss: 4745.6296; train_edge_recon_loss: 80596.4043; train_gene_expr_recon_loss: 98530.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183872.8516; train_optim_loss: 183872.8516; val_kl_reg_loss: 4521.7686; val_edge_recon_loss: 79682.5312; val_gene_expr_recon_loss: 97640.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181845.0000; val_optim_loss: 181845.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9888; val_auprc_score: 0.9858; val_best_acc_score: 0.9531; val_best_f1_score: 0.9535; train_kl_reg_loss: 4697.9745; train_edge_recon_loss: 81011.3574; train_gene_expr_recon_loss: 98464.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184173.5039; train_optim_loss: 184173.5039; val_kl_reg_loss: 4549.6504; val_edge_recon_loss: 77211.7422; val_gene_expr_recon_loss: 97342.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179103.6250; val_optim_loss: 179103.6250
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9876; val_best_acc_score: 0.9547; val_best_f1_score: 0.9551; train_kl_reg_loss: 4703.2163; train_edge_recon_loss: 81170.5117; train_gene_expr_recon_loss: 98126.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184000.4609; train_optim_loss: 184000.4609; val_kl_reg_loss: 4498.7891; val_edge_recon_loss: 79476.7969; val_gene_expr_recon_loss: 97118.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181093.9375; val_optim_loss: 181093.9375
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9906; val_auprc_score: 0.9895; val_best_acc_score: 0.9541; val_best_f1_score: 0.9547; train_kl_reg_loss: 4638.7488; train_edge_recon_loss: 79908.3398; train_gene_expr_recon_loss: 97864.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182411.4727; train_optim_loss: 182411.4727; val_kl_reg_loss: 4404.3921; val_edge_recon_loss: 76220.4844; val_gene_expr_recon_loss: 96901.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177526.7500; val_optim_loss: 177526.7500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9889; val_auprc_score: 0.9870; val_best_acc_score: 0.9522; val_best_f1_score: 0.9529; train_kl_reg_loss: 4548.8772; train_edge_recon_loss: 80622.8164; train_gene_expr_recon_loss: 97567.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182739.3438; train_optim_loss: 182739.3438; val_kl_reg_loss: 4376.5830; val_edge_recon_loss: 82710.7109; val_gene_expr_recon_loss: 96520.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183607.6875; val_optim_loss: 183607.6875
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9904; val_auprc_score: 0.9869; val_best_acc_score: 0.9561; val_best_f1_score: 0.9566; train_kl_reg_loss: 4573.7257; train_edge_recon_loss: 81254.9414; train_gene_expr_recon_loss: 97424.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183253.3750; train_optim_loss: 183253.3750; val_kl_reg_loss: 4467.6606; val_edge_recon_loss: 80465.8125; val_gene_expr_recon_loss: 96508.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181441.9375; val_optim_loss: 181441.9375
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9903; val_auprc_score: 0.9885; val_best_acc_score: 0.9565; val_best_f1_score: 0.9571; train_kl_reg_loss: 4611.9734; train_edge_recon_loss: 80170.1406; train_gene_expr_recon_loss: 97188.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181970.7227; train_optim_loss: 181970.7227; val_kl_reg_loss: 4385.9619; val_edge_recon_loss: 80251.5000; val_gene_expr_recon_loss: 96196.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180833.6406; val_optim_loss: 180833.6406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9903; val_auprc_score: 0.9883; val_best_acc_score: 0.9567; val_best_f1_score: 0.9570; train_kl_reg_loss: 4532.3966; train_edge_recon_loss: 81366.6074; train_gene_expr_recon_loss: 96895.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182794.6523; train_optim_loss: 182794.6523; val_kl_reg_loss: 4376.4102; val_edge_recon_loss: 79857.3594; val_gene_expr_recon_loss: 96163.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180397.3438; val_optim_loss: 180397.3438
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9899; val_auprc_score: 0.9871; val_best_acc_score: 0.9548; val_best_f1_score: 0.9554; train_kl_reg_loss: 4533.1088; train_edge_recon_loss: 79817.3398; train_gene_expr_recon_loss: 96927.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181277.6992; train_optim_loss: 181277.6992; val_kl_reg_loss: 4374.5264; val_edge_recon_loss: 80204.8281; val_gene_expr_recon_loss: 96172.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180751.4062; val_optim_loss: 180751.4062
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9904; val_auprc_score: 0.9895; val_best_acc_score: 0.9554; val_best_f1_score: 0.9564; train_kl_reg_loss: 4525.8905; train_edge_recon_loss: 79323.7734; train_gene_expr_recon_loss: 96985.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180834.9961; train_optim_loss: 180834.9961; val_kl_reg_loss: 4366.1440; val_edge_recon_loss: 78217.2188; val_gene_expr_recon_loss: 96189.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178772.7656; val_optim_loss: 178772.7656

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 16 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9881
Val best accuracy score: 0.9573
Val best F1 score: 0.9575
Val gene expr MSE score: 1.3394
Duration of model training in run 4: 0 hours, 2 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.8732; val_best_f1_score: 0.8874; train_kl_reg_loss: 124.5026; train_edge_recon_loss: 102006.9094; train_gene_expr_recon_loss: 134070.2094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236201.6250; train_optim_loss: 236201.6250; val_kl_reg_loss: 261.3958; val_edge_recon_loss: 117126.4531; val_gene_expr_recon_loss: 135581.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252969.7188; val_optim_loss: 252969.7188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9486; val_best_f1_score: 0.9468; train_kl_reg_loss: 357.7278; train_edge_recon_loss: 100373.0844; train_gene_expr_recon_loss: 130737.4734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231468.2875; train_optim_loss: 231468.2875; val_kl_reg_loss: 522.1042; val_edge_recon_loss: 121805.5000; val_gene_expr_recon_loss: 131784.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254112.4688; val_optim_loss: 254112.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9885; val_auprc_score: 0.9879; val_best_acc_score: 0.9362; val_best_f1_score: 0.9334; train_kl_reg_loss: 593.5333; train_edge_recon_loss: 102832.6406; train_gene_expr_recon_loss: 127478.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230904.6406; train_optim_loss: 230904.6406; val_kl_reg_loss: 760.9816; val_edge_recon_loss: 114050.5156; val_gene_expr_recon_loss: 128681.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243493.4688; val_optim_loss: 243493.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9778; val_auprc_score: 0.9767; val_best_acc_score: 0.9077; val_best_f1_score: 0.9019; train_kl_reg_loss: 883.7259; train_edge_recon_loss: 102476.9734; train_gene_expr_recon_loss: 124869.3625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228230.0562; train_optim_loss: 228230.0562; val_kl_reg_loss: 1040.1086; val_edge_recon_loss: 111806.9609; val_gene_expr_recon_loss: 125440.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238287.7812; val_optim_loss: 238287.7812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9691; val_auprc_score: 0.9689; val_best_acc_score: 0.8805; val_best_f1_score: 0.8897; train_kl_reg_loss: 1051.0498; train_edge_recon_loss: 101833.9922; train_gene_expr_recon_loss: 121743.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224628.0406; train_optim_loss: 224628.0406; val_kl_reg_loss: 1125.5112; val_edge_recon_loss: 110652.5312; val_gene_expr_recon_loss: 123019.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234797.0312; val_optim_loss: 234797.0312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9525; val_auprc_score: 0.9500; val_best_acc_score: 0.8730; val_best_f1_score: 0.8776; train_kl_reg_loss: 1182.5286; train_edge_recon_loss: 101391.8578; train_gene_expr_recon_loss: 119594.1906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222168.5750; train_optim_loss: 222168.5750; val_kl_reg_loss: 1358.9320; val_edge_recon_loss: 109470.0781; val_gene_expr_recon_loss: 121213.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232042.5625; val_optim_loss: 232042.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9403; val_auprc_score: 0.9361; val_best_acc_score: 0.8595; val_best_f1_score: 0.8668; train_kl_reg_loss: 1513.2600; train_edge_recon_loss: 98092.5281; train_gene_expr_recon_loss: 117769.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217375.7500; train_optim_loss: 217375.7500; val_kl_reg_loss: 1830.8835; val_edge_recon_loss: 103146.5625; val_gene_expr_recon_loss: 119479.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224457.0312; val_optim_loss: 224457.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9350; val_auprc_score: 0.9314; val_best_acc_score: 0.8544; val_best_f1_score: 0.8613; train_kl_reg_loss: 2011.9301; train_edge_recon_loss: 95051.9062; train_gene_expr_recon_loss: 116331.6219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213395.4594; train_optim_loss: 213395.4594; val_kl_reg_loss: 2391.3330; val_edge_recon_loss: 96759.5703; val_gene_expr_recon_loss: 118190.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217341.3750; val_optim_loss: 217341.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9362; val_auprc_score: 0.9339; val_best_acc_score: 0.8541; val_best_f1_score: 0.8627; train_kl_reg_loss: 2577.7330; train_edge_recon_loss: 93860.7563; train_gene_expr_recon_loss: 115011.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211450.1531; train_optim_loss: 211450.1531; val_kl_reg_loss: 2990.5801; val_edge_recon_loss: 94378.5156; val_gene_expr_recon_loss: 117247.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214616.5625; val_optim_loss: 214616.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9373; val_auprc_score: 0.9382; val_best_acc_score: 0.8570; val_best_f1_score: 0.8629; train_kl_reg_loss: 3186.7824; train_edge_recon_loss: 91240.2891; train_gene_expr_recon_loss: 114185.9172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208612.9875; train_optim_loss: 208612.9875; val_kl_reg_loss: 3577.0200; val_edge_recon_loss: 91237.1797; val_gene_expr_recon_loss: 116483.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211297.8906; val_optim_loss: 211297.8906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9387; val_auprc_score: 0.9387; val_best_acc_score: 0.8572; val_best_f1_score: 0.8655; train_kl_reg_loss: 3706.0796; train_edge_recon_loss: 90430.0125; train_gene_expr_recon_loss: 113297.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207433.1625; train_optim_loss: 207433.1625; val_kl_reg_loss: 3859.6685; val_edge_recon_loss: 91358.5859; val_gene_expr_recon_loss: 115336.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210554.5625; val_optim_loss: 210554.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9456; val_auprc_score: 0.9464; val_best_acc_score: 0.8655; val_best_f1_score: 0.8702; train_kl_reg_loss: 3849.3710; train_edge_recon_loss: 88147.1781; train_gene_expr_recon_loss: 111800.3094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203796.8594; train_optim_loss: 203796.8594; val_kl_reg_loss: 3819.7261; val_edge_recon_loss: 87759.8203; val_gene_expr_recon_loss: 114166.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205746.1719; val_optim_loss: 205746.1719
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9514; val_auprc_score: 0.9502; val_best_acc_score: 0.8811; val_best_f1_score: 0.8838; train_kl_reg_loss: 3845.3146; train_edge_recon_loss: 88490.5609; train_gene_expr_recon_loss: 110895.7063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203231.5812; train_optim_loss: 203231.5812; val_kl_reg_loss: 3891.2461; val_edge_recon_loss: 89988.1172; val_gene_expr_recon_loss: 113032.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206911.4062; val_optim_loss: 206911.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9576; val_auprc_score: 0.9553; val_best_acc_score: 0.8878; val_best_f1_score: 0.8896; train_kl_reg_loss: 3902.8206; train_edge_recon_loss: 87221.6391; train_gene_expr_recon_loss: 109984.2922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201108.7500; train_optim_loss: 201108.7500; val_kl_reg_loss: 3922.2556; val_edge_recon_loss: 85855.8828; val_gene_expr_recon_loss: 112194.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201973.0938; val_optim_loss: 201973.0938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9640; val_auprc_score: 0.9625; val_best_acc_score: 0.9006; val_best_f1_score: 0.9015; train_kl_reg_loss: 4007.5695; train_edge_recon_loss: 86195.9563; train_gene_expr_recon_loss: 108902.7391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199106.2656; train_optim_loss: 199106.2656; val_kl_reg_loss: 4078.7861; val_edge_recon_loss: 84843.5391; val_gene_expr_recon_loss: 111302.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200225.2812; val_optim_loss: 200225.2812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9679; val_auprc_score: 0.9676; val_best_acc_score: 0.9054; val_best_f1_score: 0.9060; train_kl_reg_loss: 4159.7710; train_edge_recon_loss: 84826.2719; train_gene_expr_recon_loss: 108025.4937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197011.5375; train_optim_loss: 197011.5375; val_kl_reg_loss: 4204.7061; val_edge_recon_loss: 82940.6250; val_gene_expr_recon_loss: 110322.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197467.4688; val_optim_loss: 197467.4688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9703; val_auprc_score: 0.9671; val_best_acc_score: 0.9107; val_best_f1_score: 0.9120; train_kl_reg_loss: 4309.1287; train_edge_recon_loss: 84618.8797; train_gene_expr_recon_loss: 107184.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196112.4375; train_optim_loss: 196112.4375; val_kl_reg_loss: 4452.0010; val_edge_recon_loss: 82371.0547; val_gene_expr_recon_loss: 109215.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196038.6562; val_optim_loss: 196038.6562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9765; val_auprc_score: 0.9732; val_best_acc_score: 0.9216; val_best_f1_score: 0.9221; train_kl_reg_loss: 4557.8705; train_edge_recon_loss: 82994.4281; train_gene_expr_recon_loss: 106231.2563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193783.5531; train_optim_loss: 193783.5531; val_kl_reg_loss: 4576.9170; val_edge_recon_loss: 84783.6172; val_gene_expr_recon_loss: 108365.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197726.2031; val_optim_loss: 197726.2031
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9806; val_auprc_score: 0.9792; val_best_acc_score: 0.9304; val_best_f1_score: 0.9313; train_kl_reg_loss: 4601.8240; train_edge_recon_loss: 83488.0594; train_gene_expr_recon_loss: 105054.1844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193144.0656; train_optim_loss: 193144.0656; val_kl_reg_loss: 4647.7158; val_edge_recon_loss: 82034.8516; val_gene_expr_recon_loss: 107464.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194146.8750; val_optim_loss: 194146.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9827; val_auprc_score: 0.9805; val_best_acc_score: 0.9347; val_best_f1_score: 0.9354; train_kl_reg_loss: 4759.3345; train_edge_recon_loss: 81665.9578; train_gene_expr_recon_loss: 104184.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190610.1000; train_optim_loss: 190610.1000; val_kl_reg_loss: 4882.6064; val_edge_recon_loss: 83326.1719; val_gene_expr_recon_loss: 106619.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194828.3125; val_optim_loss: 194828.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9834; val_auprc_score: 0.9807; val_best_acc_score: 0.9383; val_best_f1_score: 0.9386; train_kl_reg_loss: 4910.5551; train_edge_recon_loss: 82013.4734; train_gene_expr_recon_loss: 103761.4328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190685.4625; train_optim_loss: 190685.4625; val_kl_reg_loss: 4878.1265; val_edge_recon_loss: 82828.0859; val_gene_expr_recon_loss: 105832.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193538.4375; val_optim_loss: 193538.4375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9859; val_auprc_score: 0.9833; val_best_acc_score: 0.9436; val_best_f1_score: 0.9445; train_kl_reg_loss: 4945.2572; train_edge_recon_loss: 82175.4031; train_gene_expr_recon_loss: 103019.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190140.5500; train_optim_loss: 190140.5500; val_kl_reg_loss: 5013.2637; val_edge_recon_loss: 79354.6250; val_gene_expr_recon_loss: 105219.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189587.8750; val_optim_loss: 189587.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9876; val_auprc_score: 0.9855; val_best_acc_score: 0.9490; val_best_f1_score: 0.9499; train_kl_reg_loss: 5058.3177; train_edge_recon_loss: 82147.7016; train_gene_expr_recon_loss: 102345.0984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189551.1156; train_optim_loss: 189551.1156; val_kl_reg_loss: 5024.3447; val_edge_recon_loss: 80803.3125; val_gene_expr_recon_loss: 104631.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190459.5938; val_optim_loss: 190459.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9889; val_auprc_score: 0.9872; val_best_acc_score: 0.9522; val_best_f1_score: 0.9527; train_kl_reg_loss: 5003.1497; train_edge_recon_loss: 82196.5625; train_gene_expr_recon_loss: 101718.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188918.1313; train_optim_loss: 188918.1313; val_kl_reg_loss: 4909.2935; val_edge_recon_loss: 79179.6875; val_gene_expr_recon_loss: 104248.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188337.4062; val_optim_loss: 188337.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9880; val_auprc_score: 0.9860; val_best_acc_score: 0.9507; val_best_f1_score: 0.9517; train_kl_reg_loss: 4955.8854; train_edge_recon_loss: 82607.1703; train_gene_expr_recon_loss: 101115.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188678.5562; train_optim_loss: 188678.5562; val_kl_reg_loss: 5010.5752; val_edge_recon_loss: 80272.9453; val_gene_expr_recon_loss: 103727.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189011.5000; val_optim_loss: 189011.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9897; val_auprc_score: 0.9882; val_best_acc_score: 0.9536; val_best_f1_score: 0.9543; train_kl_reg_loss: 5014.0123; train_edge_recon_loss: 82196.5219; train_gene_expr_recon_loss: 100812.7875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188023.3219; train_optim_loss: 188023.3219; val_kl_reg_loss: 4801.1992; val_edge_recon_loss: 81317.8438; val_gene_expr_recon_loss: 103286.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189405.5625; val_optim_loss: 189405.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9902; val_auprc_score: 0.9887; val_best_acc_score: 0.9560; val_best_f1_score: 0.9567; train_kl_reg_loss: 4973.5975; train_edge_recon_loss: 82653.3562; train_gene_expr_recon_loss: 100376.5094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188003.4625; train_optim_loss: 188003.4625; val_kl_reg_loss: 4754.7676; val_edge_recon_loss: 82918.5000; val_gene_expr_recon_loss: 102899.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190572.9062; val_optim_loss: 190572.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9903; val_auprc_score: 0.9878; val_best_acc_score: 0.9577; val_best_f1_score: 0.9583; train_kl_reg_loss: 4889.2563; train_edge_recon_loss: 81083.4953; train_gene_expr_recon_loss: 100124.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186097.3062; train_optim_loss: 186097.3062; val_kl_reg_loss: 4759.5615; val_edge_recon_loss: 78053.4062; val_gene_expr_recon_loss: 102779.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185592.7500; val_optim_loss: 185592.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9902; val_auprc_score: 0.9879; val_best_acc_score: 0.9566; val_best_f1_score: 0.9570; train_kl_reg_loss: 4903.4436; train_edge_recon_loss: 81738.3172; train_gene_expr_recon_loss: 100095.8078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186737.5750; train_optim_loss: 186737.5750; val_kl_reg_loss: 4776.6465; val_edge_recon_loss: 80674.2422; val_gene_expr_recon_loss: 102743.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188194.2969; val_optim_loss: 188194.2969
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9907; val_auprc_score: 0.9892; val_best_acc_score: 0.9573; val_best_f1_score: 0.9580; train_kl_reg_loss: 4906.8017; train_edge_recon_loss: 80513.7125; train_gene_expr_recon_loss: 100002.7484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185423.2625; train_optim_loss: 185423.2625; val_kl_reg_loss: 4780.2314; val_edge_recon_loss: 78694.0859; val_gene_expr_recon_loss: 102735.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186209.3438; val_optim_loss: 186209.3438
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9900; val_auprc_score: 0.9868; val_best_acc_score: 0.9566; val_best_f1_score: 0.9573; train_kl_reg_loss: 4906.0545; train_edge_recon_loss: 82930.0312; train_gene_expr_recon_loss: 100170.3641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188006.4562; train_optim_loss: 188006.4562; val_kl_reg_loss: 4770.3032; val_edge_recon_loss: 82874.1094; val_gene_expr_recon_loss: 102702.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190346.4688; val_optim_loss: 190346.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9909; val_auprc_score: 0.9895; val_best_acc_score: 0.9572; val_best_f1_score: 0.9576; train_kl_reg_loss: 4900.5997; train_edge_recon_loss: 81693.0406; train_gene_expr_recon_loss: 99964.2437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186557.8844; train_optim_loss: 186557.8844; val_kl_reg_loss: 4770.9941; val_edge_recon_loss: 78461.7656; val_gene_expr_recon_loss: 102698.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185931.0938; val_optim_loss: 185931.0938
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9559; val_best_f1_score: 0.9567; train_kl_reg_loss: 4901.6451; train_edge_recon_loss: 81361.2016; train_gene_expr_recon_loss: 99963.2047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186226.0531; train_optim_loss: 186226.0531; val_kl_reg_loss: 4775.3525; val_edge_recon_loss: 83032.4219; val_gene_expr_recon_loss: 102696.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190503.9375; val_optim_loss: 190503.9375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9909; val_auprc_score: 0.9887; val_best_acc_score: 0.9562; val_best_f1_score: 0.9570; train_kl_reg_loss: 4906.5968; train_edge_recon_loss: 81403.1281; train_gene_expr_recon_loss: 100049.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186359.0125; train_optim_loss: 186359.0125; val_kl_reg_loss: 4779.2388; val_edge_recon_loss: 78997.8750; val_gene_expr_recon_loss: 102689.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186466.3125; val_optim_loss: 186466.3125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 24 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9895
Val AUPRC score: 0.9867
Val best accuracy score: 0.9546
Val best F1 score: 0.9554
Val gene expr MSE score: 1.6359
Duration of model training in run 5: 0 hours, 2 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 80320
Number of validation edges: 8924
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9949; val_auprc_score: 0.9945; val_best_acc_score: 0.8442; val_best_f1_score: 0.8632; train_kl_reg_loss: 127.7326; train_edge_recon_loss: 101797.9516; train_gene_expr_recon_loss: 134901.0219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236826.7094; train_optim_loss: 236826.7094; val_kl_reg_loss: 278.4512; val_edge_recon_loss: 117744.1562; val_gene_expr_recon_loss: 132642.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250665.1094; val_optim_loss: 250665.1094
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9920; val_auprc_score: 0.9891; val_best_acc_score: 0.9541; val_best_f1_score: 0.9529; train_kl_reg_loss: 379.1858; train_edge_recon_loss: 102287.8734; train_gene_expr_recon_loss: 131101.7875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233768.8531; train_optim_loss: 233768.8531; val_kl_reg_loss: 511.2851; val_edge_recon_loss: 114462.4375; val_gene_expr_recon_loss: 128936.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243910.2344; val_optim_loss: 243910.2344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9880; val_auprc_score: 0.9868; val_best_acc_score: 0.9477; val_best_f1_score: 0.9468; train_kl_reg_loss: 640.0593; train_edge_recon_loss: 102716.9125; train_gene_expr_recon_loss: 127701.9156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231058.8875; train_optim_loss: 231058.8875; val_kl_reg_loss: 946.8115; val_edge_recon_loss: 120734.6172; val_gene_expr_recon_loss: 125233.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246915.1875; val_optim_loss: 246915.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9803; val_auprc_score: 0.9805; val_best_acc_score: 0.9224; val_best_f1_score: 0.9204; train_kl_reg_loss: 1189.7719; train_edge_recon_loss: 101919.7172; train_gene_expr_recon_loss: 123953.3297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227062.8188; train_optim_loss: 227062.8188; val_kl_reg_loss: 1279.3422; val_edge_recon_loss: 118492.4297; val_gene_expr_recon_loss: 121648.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241420.6562; val_optim_loss: 241420.6562
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9716; val_auprc_score: 0.9713; val_best_acc_score: 0.8803; val_best_f1_score: 0.8780; train_kl_reg_loss: 1293.4034; train_edge_recon_loss: 102545.9094; train_gene_expr_recon_loss: 120812.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224652.2469; train_optim_loss: 224652.2469; val_kl_reg_loss: 1279.7957; val_edge_recon_loss: 117213.2969; val_gene_expr_recon_loss: 119470.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237963.7969; val_optim_loss: 237963.7969
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9604; val_auprc_score: 0.9585; val_best_acc_score: 0.8799; val_best_f1_score: 0.8865; train_kl_reg_loss: 1333.9427; train_edge_recon_loss: 101357.0641; train_gene_expr_recon_loss: 118949.2906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221640.2969; train_optim_loss: 221640.2969; val_kl_reg_loss: 1375.5985; val_edge_recon_loss: 111750.2734; val_gene_expr_recon_loss: 117685.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230811.2969; val_optim_loss: 230811.2969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9505; val_auprc_score: 0.9478; val_best_acc_score: 0.8686; val_best_f1_score: 0.8740; train_kl_reg_loss: 1455.3753; train_edge_recon_loss: 100813.0766; train_gene_expr_recon_loss: 117265.1812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219533.6313; train_optim_loss: 219533.6313; val_kl_reg_loss: 1550.0020; val_edge_recon_loss: 105119.4141; val_gene_expr_recon_loss: 116442.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223111.9062; val_optim_loss: 223111.9062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9420; val_auprc_score: 0.9396; val_best_acc_score: 0.8579; val_best_f1_score: 0.8663; train_kl_reg_loss: 1753.1114; train_edge_recon_loss: 96763.1391; train_gene_expr_recon_loss: 115624.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214140.8531; train_optim_loss: 214140.8531; val_kl_reg_loss: 2080.0837; val_edge_recon_loss: 100144.7422; val_gene_expr_recon_loss: 115229.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217454.1562; val_optim_loss: 217454.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9383; val_auprc_score: 0.9354; val_best_acc_score: 0.8574; val_best_f1_score: 0.8660; train_kl_reg_loss: 2349.1133; train_edge_recon_loss: 95033.9438; train_gene_expr_recon_loss: 114717.8406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212100.8969; train_optim_loss: 212100.8969; val_kl_reg_loss: 2729.4814; val_edge_recon_loss: 90315.9531; val_gene_expr_recon_loss: 114438.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207484.0156; val_optim_loss: 207484.0156
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9383; val_auprc_score: 0.9388; val_best_acc_score: 0.8592; val_best_f1_score: 0.8657; train_kl_reg_loss: 3039.4759; train_edge_recon_loss: 92607.2656; train_gene_expr_recon_loss: 114133.6469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209780.3875; train_optim_loss: 209780.3875; val_kl_reg_loss: 3497.6558; val_edge_recon_loss: 89188.9375; val_gene_expr_recon_loss: 113734.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206421.3750; val_optim_loss: 206421.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9420; val_auprc_score: 0.9423; val_best_acc_score: 0.8665; val_best_f1_score: 0.8695; train_kl_reg_loss: 3694.7038; train_edge_recon_loss: 89275.3609; train_gene_expr_recon_loss: 113025.4016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205995.4688; train_optim_loss: 205995.4688; val_kl_reg_loss: 3887.6526; val_edge_recon_loss: 88249.4766; val_gene_expr_recon_loss: 112467.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204604.4062; val_optim_loss: 204604.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9443; val_auprc_score: 0.9425; val_best_acc_score: 0.8712; val_best_f1_score: 0.8748; train_kl_reg_loss: 3852.6883; train_edge_recon_loss: 89881.3562; train_gene_expr_recon_loss: 111948.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205682.7938; train_optim_loss: 205682.7938; val_kl_reg_loss: 3831.2271; val_edge_recon_loss: 87124.2812; val_gene_expr_recon_loss: 111413.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202368.5781; val_optim_loss: 202368.5781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9467; val_auprc_score: 0.9459; val_best_acc_score: 0.8739; val_best_f1_score: 0.8787; train_kl_reg_loss: 3861.7310; train_edge_recon_loss: 88912.8531; train_gene_expr_recon_loss: 110878.4719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203653.0562; train_optim_loss: 203653.0562; val_kl_reg_loss: 3984.6646; val_edge_recon_loss: 88041.1562; val_gene_expr_recon_loss: 110514.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202540.2812; val_optim_loss: 202540.2812
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9509; val_auprc_score: 0.9501; val_best_acc_score: 0.8785; val_best_f1_score: 0.8818; train_kl_reg_loss: 4023.7665; train_edge_recon_loss: 87475.7281; train_gene_expr_recon_loss: 110019.2359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201518.7313; train_optim_loss: 201518.7313; val_kl_reg_loss: 4061.6399; val_edge_recon_loss: 87989.2500; val_gene_expr_recon_loss: 109758.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201809.5938; val_optim_loss: 201809.5938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9588; val_auprc_score: 0.9576; val_best_acc_score: 0.8906; val_best_f1_score: 0.8925; train_kl_reg_loss: 4092.2840; train_edge_recon_loss: 85911.7766; train_gene_expr_recon_loss: 109009.3578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199013.4188; train_optim_loss: 199013.4188; val_kl_reg_loss: 4113.7344; val_edge_recon_loss: 85223.8203; val_gene_expr_recon_loss: 108845.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198183.5312; val_optim_loss: 198183.5312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9640; val_auprc_score: 0.9633; val_best_acc_score: 0.8985; val_best_f1_score: 0.8993; train_kl_reg_loss: 4235.9481; train_edge_recon_loss: 86523.6828; train_gene_expr_recon_loss: 108434.8969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199194.5281; train_optim_loss: 199194.5281; val_kl_reg_loss: 4354.6733; val_edge_recon_loss: 83750.4453; val_gene_expr_recon_loss: 107824.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195929.5000; val_optim_loss: 195929.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9656; val_auprc_score: 0.9627; val_best_acc_score: 0.9034; val_best_f1_score: 0.9049; train_kl_reg_loss: 4433.8385; train_edge_recon_loss: 84440.0063; train_gene_expr_recon_loss: 107154.4203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196028.2594; train_optim_loss: 196028.2594; val_kl_reg_loss: 4434.9766; val_edge_recon_loss: 84673.0156; val_gene_expr_recon_loss: 106888.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195996.5938; val_optim_loss: 195996.5938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9715; val_auprc_score: 0.9712; val_best_acc_score: 0.9083; val_best_f1_score: 0.9096; train_kl_reg_loss: 4492.9279; train_edge_recon_loss: 84039.7719; train_gene_expr_recon_loss: 106316.2828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194848.9813; train_optim_loss: 194848.9813; val_kl_reg_loss: 4457.5972; val_edge_recon_loss: 83821.6875; val_gene_expr_recon_loss: 105984.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194263.7500; val_optim_loss: 194263.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9768; val_auprc_score: 0.9723; val_best_acc_score: 0.9244; val_best_f1_score: 0.9255; train_kl_reg_loss: 4537.9666; train_edge_recon_loss: 82920.0719; train_gene_expr_recon_loss: 105461.4328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192919.4750; train_optim_loss: 192919.4750; val_kl_reg_loss: 4562.8618; val_edge_recon_loss: 81521.3906; val_gene_expr_recon_loss: 105187.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191271.3438; val_optim_loss: 191271.3438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9801; val_auprc_score: 0.9788; val_best_acc_score: 0.9300; val_best_f1_score: 0.9303; train_kl_reg_loss: 4658.8926; train_edge_recon_loss: 82622.8047; train_gene_expr_recon_loss: 104682.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191964.2375; train_optim_loss: 191964.2375; val_kl_reg_loss: 4601.9756; val_edge_recon_loss: 81634.2656; val_gene_expr_recon_loss: 104392.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190628.9375; val_optim_loss: 190628.9375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9828; val_auprc_score: 0.9800; val_best_acc_score: 0.9357; val_best_f1_score: 0.9359; train_kl_reg_loss: 4720.8870; train_edge_recon_loss: 81744.0375; train_gene_expr_recon_loss: 103701.3406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190166.2625; train_optim_loss: 190166.2625; val_kl_reg_loss: 4772.3208; val_edge_recon_loss: 80869.2812; val_gene_expr_recon_loss: 103491.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189133.3125; val_optim_loss: 189133.3125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9846; val_auprc_score: 0.9828; val_best_acc_score: 0.9412; val_best_f1_score: 0.9414; train_kl_reg_loss: 4878.3275; train_edge_recon_loss: 82849.7219; train_gene_expr_recon_loss: 103137.6859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190865.7344; train_optim_loss: 190865.7344; val_kl_reg_loss: 4783.2520; val_edge_recon_loss: 81478.1562; val_gene_expr_recon_loss: 102823.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189084.9531; val_optim_loss: 189084.9531
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9860; val_auprc_score: 0.9833; val_best_acc_score: 0.9446; val_best_f1_score: 0.9449; train_kl_reg_loss: 4863.7933; train_edge_recon_loss: 81969.5375; train_gene_expr_recon_loss: 102438.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189271.4000; train_optim_loss: 189271.4000; val_kl_reg_loss: 4847.0532; val_edge_recon_loss: 79879.5312; val_gene_expr_recon_loss: 102092.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186819.3906; val_optim_loss: 186819.3906
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9870; val_auprc_score: 0.9839; val_best_acc_score: 0.9487; val_best_f1_score: 0.9493; train_kl_reg_loss: 4932.1096; train_edge_recon_loss: 81957.4344; train_gene_expr_recon_loss: 101784.6375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188674.1844; train_optim_loss: 188674.1844; val_kl_reg_loss: 4869.4922; val_edge_recon_loss: 82004.8281; val_gene_expr_recon_loss: 101466.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188341.1875; val_optim_loss: 188341.1875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9877; val_auprc_score: 0.9835; val_best_acc_score: 0.9529; val_best_f1_score: 0.9536; train_kl_reg_loss: 4929.6371; train_edge_recon_loss: 80959.9328; train_gene_expr_recon_loss: 101244.0766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187133.6437; train_optim_loss: 187133.6437; val_kl_reg_loss: 4870.5078; val_edge_recon_loss: 79609.0781; val_gene_expr_recon_loss: 100825.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185305.0156; val_optim_loss: 185305.0156
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9892; val_auprc_score: 0.9862; val_best_acc_score: 0.9557; val_best_f1_score: 0.9563; train_kl_reg_loss: 4912.4939; train_edge_recon_loss: 81450.2547; train_gene_expr_recon_loss: 100536.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186899.0719; train_optim_loss: 186899.0719; val_kl_reg_loss: 4709.2275; val_edge_recon_loss: 82064.5078; val_gene_expr_recon_loss: 100465.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187239.3125; val_optim_loss: 187239.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9900; val_auprc_score: 0.9887; val_best_acc_score: 0.9575; val_best_f1_score: 0.9581; train_kl_reg_loss: 4920.6224; train_edge_recon_loss: 81719.5625; train_gene_expr_recon_loss: 99963.9281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186604.1125; train_optim_loss: 186604.1125; val_kl_reg_loss: 4778.5039; val_edge_recon_loss: 77142.6719; val_gene_expr_recon_loss: 99987.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181909.0938; val_optim_loss: 181909.0938
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9895; val_auprc_score: 0.9880; val_best_acc_score: 0.9564; val_best_f1_score: 0.9571; train_kl_reg_loss: 4921.3755; train_edge_recon_loss: 81622.6438; train_gene_expr_recon_loss: 99618.3062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186162.3250; train_optim_loss: 186162.3250; val_kl_reg_loss: 4741.3687; val_edge_recon_loss: 79838.3047; val_gene_expr_recon_loss: 99525.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184105.6562; val_optim_loss: 184105.6562
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9904; val_auprc_score: 0.9869; val_best_acc_score: 0.9592; val_best_f1_score: 0.9597; train_kl_reg_loss: 4915.6976; train_edge_recon_loss: 81809.1781; train_gene_expr_recon_loss: 99292.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186017.1469; train_optim_loss: 186017.1469; val_kl_reg_loss: 4766.1035; val_edge_recon_loss: 80328.1328; val_gene_expr_recon_loss: 99152.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184246.6250; val_optim_loss: 184246.6250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9911; val_auprc_score: 0.9885; val_best_acc_score: 0.9615; val_best_f1_score: 0.9619; train_kl_reg_loss: 4833.7035; train_edge_recon_loss: 80887.7156; train_gene_expr_recon_loss: 98879.4953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184600.9188; train_optim_loss: 184600.9188; val_kl_reg_loss: 4662.5649; val_edge_recon_loss: 80973.0703; val_gene_expr_recon_loss: 98783.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184419.4688; val_optim_loss: 184419.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9908; val_auprc_score: 0.9885; val_best_acc_score: 0.9597; val_best_f1_score: 0.9602; train_kl_reg_loss: 4776.6346; train_edge_recon_loss: 81853.5047; train_gene_expr_recon_loss: 98464.9156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185095.0594; train_optim_loss: 185095.0594; val_kl_reg_loss: 4661.6357; val_edge_recon_loss: 79678.1797; val_gene_expr_recon_loss: 98749.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183089.4219; val_optim_loss: 183089.4219
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9908; val_auprc_score: 0.9871; val_best_acc_score: 0.9602; val_best_f1_score: 0.9606; train_kl_reg_loss: 4785.5959; train_edge_recon_loss: 80450.3719; train_gene_expr_recon_loss: 98679.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183915.1688; train_optim_loss: 183915.1688; val_kl_reg_loss: 4680.3057; val_edge_recon_loss: 80568.9531; val_gene_expr_recon_loss: 98696.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183946.2188; val_optim_loss: 183946.2188
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9901; val_auprc_score: 0.9873; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 4807.5632; train_edge_recon_loss: 81572.5516; train_gene_expr_recon_loss: 98366.1844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184746.3062; train_optim_loss: 184746.3062; val_kl_reg_loss: 4690.4668; val_edge_recon_loss: 77801.7734; val_gene_expr_recon_loss: 98673.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181166.2031; val_optim_loss: 181166.2031
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9904; val_auprc_score: 0.9876; val_best_acc_score: 0.9594; val_best_f1_score: 0.9599; train_kl_reg_loss: 4799.6094; train_edge_recon_loss: 81850.5188; train_gene_expr_recon_loss: 98436.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185086.6719; train_optim_loss: 185086.6719; val_kl_reg_loss: 4687.5835; val_edge_recon_loss: 82599.6484; val_gene_expr_recon_loss: 98690.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185977.4688; val_optim_loss: 185977.4688
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9910; val_auprc_score: 0.9891; val_best_acc_score: 0.9596; val_best_f1_score: 0.9601; train_kl_reg_loss: 4802.8801; train_edge_recon_loss: 81387.6250; train_gene_expr_recon_loss: 98345.5875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184536.0969; train_optim_loss: 184536.0969; val_kl_reg_loss: 4678.2969; val_edge_recon_loss: 82165.5625; val_gene_expr_recon_loss: 98640.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185484.4062; val_optim_loss: 185484.4062
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9917; val_auprc_score: 0.9904; val_best_acc_score: 0.9624; val_best_f1_score: 0.9628; train_kl_reg_loss: 4784.7455; train_edge_recon_loss: 82162.2094; train_gene_expr_recon_loss: 98424.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185371.6688; train_optim_loss: 185371.6688; val_kl_reg_loss: 4656.9150; val_edge_recon_loss: 80364.3516; val_gene_expr_recon_loss: 98612.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183634.0000; val_optim_loss: 183634.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9901; val_auprc_score: 0.9855; val_best_acc_score: 0.9611; val_best_f1_score: 0.9615; train_kl_reg_loss: 4769.6313; train_edge_recon_loss: 80038.7125; train_gene_expr_recon_loss: 98268.2688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183076.6125; train_optim_loss: 183076.6125; val_kl_reg_loss: 4652.3633; val_edge_recon_loss: 81395.8438; val_gene_expr_recon_loss: 98600.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184648.3750; val_optim_loss: 184648.3750
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9916; val_auprc_score: 0.9900; val_best_acc_score: 0.9600; val_best_f1_score: 0.9605; train_kl_reg_loss: 4763.5768; train_edge_recon_loss: 79972.6625; train_gene_expr_recon_loss: 98167.8797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182904.1187; train_optim_loss: 182904.1187; val_kl_reg_loss: 4656.4590; val_edge_recon_loss: 80168.7188; val_gene_expr_recon_loss: 98585.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183410.5000; val_optim_loss: 183410.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9916; val_auprc_score: 0.9891; val_best_acc_score: 0.9615; val_best_f1_score: 0.9619; train_kl_reg_loss: 4763.9917; train_edge_recon_loss: 81031.1672; train_gene_expr_recon_loss: 98468.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184263.1656; train_optim_loss: 184263.1656; val_kl_reg_loss: 4654.6904; val_edge_recon_loss: 79549.6641; val_gene_expr_recon_loss: 98575.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182779.7188; val_optim_loss: 182779.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 47 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9903
Val AUPRC score: 0.9882
Val best accuracy score: 0.9593
Val best F1 score: 0.9598
Val gene expr MSE score: 1.4016
Duration of model training in run 6: 0 hours, 2 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9949; val_auprc_score: 0.9941; val_best_acc_score: 0.9614; val_best_f1_score: 0.9605; train_kl_reg_loss: 175.1960; train_edge_recon_loss: 101014.5513; train_gene_expr_recon_loss: 132711.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233901.7076; train_optim_loss: 233901.7076; val_kl_reg_loss: 397.4522; val_edge_recon_loss: 118527.5391; val_gene_expr_recon_loss: 130429.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249354.6250; val_optim_loss: 249354.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9893; val_auprc_score: 0.9885; val_best_acc_score: 0.9509; val_best_f1_score: 0.9501; train_kl_reg_loss: 577.0278; train_edge_recon_loss: 102183.6864; train_gene_expr_recon_loss: 126819.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229580.4754; train_optim_loss: 229580.4754; val_kl_reg_loss: 701.9257; val_edge_recon_loss: 117796.5391; val_gene_expr_recon_loss: 125800.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244298.7969; val_optim_loss: 244298.7969
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9756; val_auprc_score: 0.9756; val_best_acc_score: 0.9137; val_best_f1_score: 0.9106; train_kl_reg_loss: 849.4424; train_edge_recon_loss: 101870.1484; train_gene_expr_recon_loss: 122876.6763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225596.2679; train_optim_loss: 225596.2679; val_kl_reg_loss: 1012.9531; val_edge_recon_loss: 118605.1875; val_gene_expr_recon_loss: 121574.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241192.6250; val_optim_loss: 241192.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9587; val_auprc_score: 0.9589; val_best_acc_score: 0.8701; val_best_f1_score: 0.8795; train_kl_reg_loss: 1035.0657; train_edge_recon_loss: 102786.3214; train_gene_expr_recon_loss: 119326.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223147.4174; train_optim_loss: 223147.4174; val_kl_reg_loss: 1064.0969; val_edge_recon_loss: 109035.5703; val_gene_expr_recon_loss: 118878.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228978.5312; val_optim_loss: 228978.5312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9445; val_auprc_score: 0.9417; val_best_acc_score: 0.8659; val_best_f1_score: 0.8698; train_kl_reg_loss: 1192.0661; train_edge_recon_loss: 99347.1663; train_gene_expr_recon_loss: 116739.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217278.8237; train_optim_loss: 217278.8237; val_kl_reg_loss: 1462.0354; val_edge_recon_loss: 103705.3828; val_gene_expr_recon_loss: 116670.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221837.8438; val_optim_loss: 221837.8438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9374; val_auprc_score: 0.9318; val_best_acc_score: 0.8591; val_best_f1_score: 0.8667; train_kl_reg_loss: 1681.2572; train_edge_recon_loss: 97812.9520; train_gene_expr_recon_loss: 114559.2154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214053.4241; train_optim_loss: 214053.4241; val_kl_reg_loss: 2025.2754; val_edge_recon_loss: 96480.8750; val_gene_expr_recon_loss: 115104.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213610.5000; val_optim_loss: 213610.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9390; val_auprc_score: 0.9368; val_best_acc_score: 0.8651; val_best_f1_score: 0.8719; train_kl_reg_loss: 2402.1108; train_edge_recon_loss: 93745.0569; train_gene_expr_recon_loss: 113005.0402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209152.2076; train_optim_loss: 209152.2076; val_kl_reg_loss: 2886.7339; val_edge_recon_loss: 89602.2969; val_gene_expr_recon_loss: 113758.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206247.5312; val_optim_loss: 206247.5312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9412; val_auprc_score: 0.9408; val_best_acc_score: 0.8687; val_best_f1_score: 0.8730; train_kl_reg_loss: 3301.4482; train_edge_recon_loss: 91394.3772; train_gene_expr_recon_loss: 112027.8080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206723.6339; train_optim_loss: 206723.6339; val_kl_reg_loss: 3720.6699; val_edge_recon_loss: 87420.1172; val_gene_expr_recon_loss: 112691.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203832.2500; val_optim_loss: 203832.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9452; val_auprc_score: 0.9428; val_best_acc_score: 0.8764; val_best_f1_score: 0.8798; train_kl_reg_loss: 3737.7974; train_edge_recon_loss: 87584.4911; train_gene_expr_recon_loss: 110636.3627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201958.6518; train_optim_loss: 201958.6518; val_kl_reg_loss: 3777.4795; val_edge_recon_loss: 88484.2969; val_gene_expr_recon_loss: 111026.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203288.0938; val_optim_loss: 203288.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9553; val_auprc_score: 0.9541; val_best_acc_score: 0.8891; val_best_f1_score: 0.8912; train_kl_reg_loss: 3859.8960; train_edge_recon_loss: 87068.2143; train_gene_expr_recon_loss: 109146.6205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200074.7321; train_optim_loss: 200074.7321; val_kl_reg_loss: 4023.4304; val_edge_recon_loss: 82687.0078; val_gene_expr_recon_loss: 109694.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196405.3906; val_optim_loss: 196405.3906
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9628; val_auprc_score: 0.9618; val_best_acc_score: 0.8974; val_best_f1_score: 0.8993; train_kl_reg_loss: 4055.9882; train_edge_recon_loss: 86159.5536; train_gene_expr_recon_loss: 107916.7712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198132.3125; train_optim_loss: 198132.3125; val_kl_reg_loss: 4105.7236; val_edge_recon_loss: 82961.3125; val_gene_expr_recon_loss: 108662.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195729.2500; val_optim_loss: 195729.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9681; val_auprc_score: 0.9656; val_best_acc_score: 0.9069; val_best_f1_score: 0.9081; train_kl_reg_loss: 4120.0154; train_edge_recon_loss: 84729.1819; train_gene_expr_recon_loss: 106863.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195713.1094; train_optim_loss: 195713.1094; val_kl_reg_loss: 4166.8691; val_edge_recon_loss: 85700.8906; val_gene_expr_recon_loss: 107473.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197340.9375; val_optim_loss: 197340.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9755; val_auprc_score: 0.9716; val_best_acc_score: 0.9204; val_best_f1_score: 0.9218; train_kl_reg_loss: 4305.4955; train_edge_recon_loss: 83118.0547; train_gene_expr_recon_loss: 105516.8058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192940.3594; train_optim_loss: 192940.3594; val_kl_reg_loss: 4303.8379; val_edge_recon_loss: 81369.7656; val_gene_expr_recon_loss: 106233.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191907.0000; val_optim_loss: 191907.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9823; val_auprc_score: 0.9807; val_best_acc_score: 0.9353; val_best_f1_score: 0.9359; train_kl_reg_loss: 4356.0247; train_edge_recon_loss: 81945.9900; train_gene_expr_recon_loss: 104468.1395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190770.1518; train_optim_loss: 190770.1518; val_kl_reg_loss: 4321.6250; val_edge_recon_loss: 81299.1484; val_gene_expr_recon_loss: 105183.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190804.6094; val_optim_loss: 190804.6094
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9843; val_auprc_score: 0.9821; val_best_acc_score: 0.9397; val_best_f1_score: 0.9409; train_kl_reg_loss: 4421.0640; train_edge_recon_loss: 82112.4509; train_gene_expr_recon_loss: 103356.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189890.4509; train_optim_loss: 189890.4509; val_kl_reg_loss: 4488.7012; val_edge_recon_loss: 82257.4297; val_gene_expr_recon_loss: 104303.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191049.1719; val_optim_loss: 191049.1719
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9870; val_auprc_score: 0.9845; val_best_acc_score: 0.9472; val_best_f1_score: 0.9478; train_kl_reg_loss: 4584.3715; train_edge_recon_loss: 81890.4621; train_gene_expr_recon_loss: 102592.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189066.9821; train_optim_loss: 189066.9821; val_kl_reg_loss: 4516.0913; val_edge_recon_loss: 79654.4141; val_gene_expr_recon_loss: 103438.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187608.7812; val_optim_loss: 187608.7812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9886; val_auprc_score: 0.9859; val_best_acc_score: 0.9526; val_best_f1_score: 0.9533; train_kl_reg_loss: 4602.2564; train_edge_recon_loss: 81781.2835; train_gene_expr_recon_loss: 101637.0290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188020.5670; train_optim_loss: 188020.5670; val_kl_reg_loss: 4596.0957; val_edge_recon_loss: 80369.6016; val_gene_expr_recon_loss: 102554.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187520.6562; val_optim_loss: 187520.6562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9898; val_auprc_score: 0.9877; val_best_acc_score: 0.9539; val_best_f1_score: 0.9542; train_kl_reg_loss: 4669.3683; train_edge_recon_loss: 80567.5759; train_gene_expr_recon_loss: 100749.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185986.1049; train_optim_loss: 185986.1049; val_kl_reg_loss: 4588.5195; val_edge_recon_loss: 78803.4453; val_gene_expr_recon_loss: 101926.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185318.0312; val_optim_loss: 185318.0312
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9885; val_auprc_score: 0.9849; val_best_acc_score: 0.9547; val_best_f1_score: 0.9554; train_kl_reg_loss: 4649.9156; train_edge_recon_loss: 82095.8259; train_gene_expr_recon_loss: 100294.7355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187040.4754; train_optim_loss: 187040.4754; val_kl_reg_loss: 4607.1660; val_edge_recon_loss: 82964.2500; val_gene_expr_recon_loss: 101282.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188854.4062; val_optim_loss: 188854.4062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9904; val_auprc_score: 0.9884; val_best_acc_score: 0.9584; val_best_f1_score: 0.9589; train_kl_reg_loss: 4632.9868; train_edge_recon_loss: 80497.2600; train_gene_expr_recon_loss: 99774.2232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184904.4732; train_optim_loss: 184904.4732; val_kl_reg_loss: 4581.6338; val_edge_recon_loss: 79627.9453; val_gene_expr_recon_loss: 100766.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184976.1719; val_optim_loss: 184976.1719
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9908; val_auprc_score: 0.9879; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 4600.7431; train_edge_recon_loss: 81180.6127; train_gene_expr_recon_loss: 99241.7299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185023.0826; train_optim_loss: 185023.0826; val_kl_reg_loss: 4500.1064; val_edge_recon_loss: 78237.7969; val_gene_expr_recon_loss: 100269.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183007.3438; val_optim_loss: 183007.3438
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9919; val_auprc_score: 0.9904; val_best_acc_score: 0.9614; val_best_f1_score: 0.9621; train_kl_reg_loss: 4504.9079; train_edge_recon_loss: 80166.6641; train_gene_expr_recon_loss: 98645.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183316.8393; train_optim_loss: 183316.8393; val_kl_reg_loss: 4487.8862; val_edge_recon_loss: 76623.1484; val_gene_expr_recon_loss: 99865.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180976.7812; val_optim_loss: 180976.7812
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9919; val_auprc_score: 0.9899; val_best_acc_score: 0.9630; val_best_f1_score: 0.9634; train_kl_reg_loss: 4541.3358; train_edge_recon_loss: 81052.9364; train_gene_expr_recon_loss: 98318.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183913.0938; train_optim_loss: 183913.0938; val_kl_reg_loss: 4457.2163; val_edge_recon_loss: 81429.2344; val_gene_expr_recon_loss: 99428.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185315.0312; val_optim_loss: 185315.0312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 4486.6234; train_edge_recon_loss: 80201.2623; train_gene_expr_recon_loss: 97866.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182554.4531; train_optim_loss: 182554.4531; val_kl_reg_loss: 4431.1919; val_edge_recon_loss: 79951.7031; val_gene_expr_recon_loss: 99060.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183443.7500; val_optim_loss: 183443.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9892; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 4471.7906; train_edge_recon_loss: 79779.8404; train_gene_expr_recon_loss: 97452.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181704.5089; train_optim_loss: 181704.5089; val_kl_reg_loss: 4355.4648; val_edge_recon_loss: 78200.7656; val_gene_expr_recon_loss: 98670.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181227.1562; val_optim_loss: 181227.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9640; val_best_f1_score: 0.9645; train_kl_reg_loss: 4407.3169; train_edge_recon_loss: 80361.3426; train_gene_expr_recon_loss: 97225.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181994.3705; train_optim_loss: 181994.3705; val_kl_reg_loss: 4301.2559; val_edge_recon_loss: 81729.5469; val_gene_expr_recon_loss: 98639.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184669.9688; val_optim_loss: 184669.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9923; val_auprc_score: 0.9908; val_best_acc_score: 0.9640; val_best_f1_score: 0.9643; train_kl_reg_loss: 4412.6926; train_edge_recon_loss: 80333.1741; train_gene_expr_recon_loss: 97407.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182153.7210; train_optim_loss: 182153.7210; val_kl_reg_loss: 4273.7002; val_edge_recon_loss: 77335.8672; val_gene_expr_recon_loss: 98632.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180242.3438; val_optim_loss: 180242.3438
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9924; val_auprc_score: 0.9911; val_best_acc_score: 0.9643; val_best_f1_score: 0.9649; train_kl_reg_loss: 4389.6592; train_edge_recon_loss: 79793.2578; train_gene_expr_recon_loss: 97176.0904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181359.0067; train_optim_loss: 181359.0067; val_kl_reg_loss: 4277.7935; val_edge_recon_loss: 80294.3203; val_gene_expr_recon_loss: 98573.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183145.3125; val_optim_loss: 183145.3125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9924; val_auprc_score: 0.9889; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 4395.6472; train_edge_recon_loss: 81120.1987; train_gene_expr_recon_loss: 97172.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182688.4174; train_optim_loss: 182688.4174; val_kl_reg_loss: 4286.7466; val_edge_recon_loss: 78525.2266; val_gene_expr_recon_loss: 98566.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181378.5000; val_optim_loss: 181378.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9642; val_best_f1_score: 0.9648; train_kl_reg_loss: 4398.5209; train_edge_recon_loss: 79921.6562; train_gene_expr_recon_loss: 97281.9286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181602.1049; train_optim_loss: 181602.1049; val_kl_reg_loss: 4270.5742; val_edge_recon_loss: 80342.4297; val_gene_expr_recon_loss: 98537.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183150.5938; val_optim_loss: 183150.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9926; val_auprc_score: 0.9907; val_best_acc_score: 0.9655; val_best_f1_score: 0.9660; train_kl_reg_loss: 4385.6659; train_edge_recon_loss: 80084.3438; train_gene_expr_recon_loss: 97108.1417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181578.1518; train_optim_loss: 181578.1518; val_kl_reg_loss: 4275.7871; val_edge_recon_loss: 77086.0000; val_gene_expr_recon_loss: 98528.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179890.2812; val_optim_loss: 179890.2812
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9929; val_auprc_score: 0.9917; val_best_acc_score: 0.9652; val_best_f1_score: 0.9655; train_kl_reg_loss: 4390.1617; train_edge_recon_loss: 80147.4743; train_gene_expr_recon_loss: 97159.0112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181696.6451; train_optim_loss: 181696.6451; val_kl_reg_loss: 4275.5190; val_edge_recon_loss: 79623.9531; val_gene_expr_recon_loss: 98517.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182417.4375; val_optim_loss: 182417.4375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9925; val_auprc_score: 0.9912; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 4386.5149; train_edge_recon_loss: 80627.1060; train_gene_expr_recon_loss: 97055.2288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182068.8504; train_optim_loss: 182068.8504; val_kl_reg_loss: 4273.5957; val_edge_recon_loss: 80376.5469; val_gene_expr_recon_loss: 98510.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183161.0000; val_optim_loss: 183161.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9920; val_auprc_score: 0.9902; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 4387.5741; train_edge_recon_loss: 80606.6775; train_gene_expr_recon_loss: 97133.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182127.8906; train_optim_loss: 182127.8906; val_kl_reg_loss: 4275.2969; val_edge_recon_loss: 79180.5938; val_gene_expr_recon_loss: 98505.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181961.6875; val_optim_loss: 181961.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9929; val_auprc_score: 0.9919; val_best_acc_score: 0.9649; val_best_f1_score: 0.9653; train_kl_reg_loss: 4387.5319; train_edge_recon_loss: 80986.8304; train_gene_expr_recon_loss: 97046.7533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182421.1183; train_optim_loss: 182421.1183; val_kl_reg_loss: 4276.5068; val_edge_recon_loss: 78956.2344; val_gene_expr_recon_loss: 98505.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181738.3125; val_optim_loss: 181738.3125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9922; val_auprc_score: 0.9907; val_best_acc_score: 0.9637; val_best_f1_score: 0.9641; train_kl_reg_loss: 4388.8308; train_edge_recon_loss: 80163.6641; train_gene_expr_recon_loss: 97049.8292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181602.3237; train_optim_loss: 181602.3237; val_kl_reg_loss: 4280.7568; val_edge_recon_loss: 77655.5312; val_gene_expr_recon_loss: 98505.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180441.5000; val_optim_loss: 180441.5000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9918; val_auprc_score: 0.9898; val_best_acc_score: 0.9642; val_best_f1_score: 0.9646; train_kl_reg_loss: 4387.3096; train_edge_recon_loss: 79932.7377; train_gene_expr_recon_loss: 97163.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181483.0670; train_optim_loss: 181483.0670; val_kl_reg_loss: 4276.1592; val_edge_recon_loss: 78834.0156; val_gene_expr_recon_loss: 98504.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181615.0312; val_optim_loss: 181615.0312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 37 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9927
Val AUPRC score: 0.9909
Val best accuracy score: 0.9656
Val best F1 score: 0.9659
Val gene expr MSE score: 1.4509
Duration of model training in run 7: 0 hours, 3 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 106920
Number of validation edges: 11879
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9491; val_best_f1_score: 0.9471; train_kl_reg_loss: 189.3571; train_edge_recon_loss: 101366.5982; train_gene_expr_recon_loss: 128986.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230542.8326; train_optim_loss: 230542.8326; val_kl_reg_loss: 388.9714; val_edge_recon_loss: 120424.3906; val_gene_expr_recon_loss: 128151.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248965.2500; val_optim_loss: 248965.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9870; val_auprc_score: 0.9866; val_best_acc_score: 0.9408; val_best_f1_score: 0.9393; train_kl_reg_loss: 515.9855; train_edge_recon_loss: 102364.8862; train_gene_expr_recon_loss: 124395.9955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227276.8638; train_optim_loss: 227276.8638; val_kl_reg_loss: 758.4080; val_edge_recon_loss: 117896.9844; val_gene_expr_recon_loss: 123691.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242346.4688; val_optim_loss: 242346.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9737; val_auprc_score: 0.9735; val_best_acc_score: 0.8994; val_best_f1_score: 0.8927; train_kl_reg_loss: 966.0767; train_edge_recon_loss: 101805.1942; train_gene_expr_recon_loss: 120513.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223284.4754; train_optim_loss: 223284.4754; val_kl_reg_loss: 1097.7496; val_edge_recon_loss: 112028.1406; val_gene_expr_recon_loss: 119814.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232940.7031; val_optim_loss: 232940.7031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9601; val_auprc_score: 0.9586; val_best_acc_score: 0.8798; val_best_f1_score: 0.8854; train_kl_reg_loss: 1152.5319; train_edge_recon_loss: 101575.8504; train_gene_expr_recon_loss: 117290.3627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220018.7455; train_optim_loss: 220018.7455; val_kl_reg_loss: 1292.6794; val_edge_recon_loss: 106057.2500; val_gene_expr_recon_loss: 117300.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224650.7188; val_optim_loss: 224650.7188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9440; val_auprc_score: 0.9410; val_best_acc_score: 0.8630; val_best_f1_score: 0.8691; train_kl_reg_loss: 1530.9149; train_edge_recon_loss: 99168.8203; train_gene_expr_recon_loss: 114886.2444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215585.9821; train_optim_loss: 215585.9821; val_kl_reg_loss: 1888.8878; val_edge_recon_loss: 96946.3750; val_gene_expr_recon_loss: 115416.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214251.5938; val_optim_loss: 214251.5938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9399; val_auprc_score: 0.9376; val_best_acc_score: 0.8589; val_best_f1_score: 0.8676; train_kl_reg_loss: 2233.0545; train_edge_recon_loss: 95349.5435; train_gene_expr_recon_loss: 113072.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210654.6138; train_optim_loss: 210654.6138; val_kl_reg_loss: 2621.1108; val_edge_recon_loss: 94941.6016; val_gene_expr_recon_loss: 113986.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211549.0938; val_optim_loss: 211549.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9431; val_auprc_score: 0.9412; val_best_acc_score: 0.8638; val_best_f1_score: 0.8708; train_kl_reg_loss: 3044.1580; train_edge_recon_loss: 92406.5179; train_gene_expr_recon_loss: 111897.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207348.0045; train_optim_loss: 207348.0045; val_kl_reg_loss: 3475.3904; val_edge_recon_loss: 89352.6797; val_gene_expr_recon_loss: 112973.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205801.9375; val_optim_loss: 205801.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9489; val_auprc_score: 0.9490; val_best_acc_score: 0.8752; val_best_f1_score: 0.8779; train_kl_reg_loss: 3697.6917; train_edge_recon_loss: 89592.9375; train_gene_expr_recon_loss: 110759.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204050.0491; train_optim_loss: 204050.0491; val_kl_reg_loss: 3753.6523; val_edge_recon_loss: 87748.6484; val_gene_expr_recon_loss: 111494.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202996.5625; val_optim_loss: 202996.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9550; val_auprc_score: 0.9543; val_best_acc_score: 0.8864; val_best_f1_score: 0.8889; train_kl_reg_loss: 3811.9921; train_edge_recon_loss: 88076.0011; train_gene_expr_recon_loss: 109201.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201089.3371; train_optim_loss: 201089.3371; val_kl_reg_loss: 3828.7834; val_edge_recon_loss: 85283.9688; val_gene_expr_recon_loss: 110146.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199259.0312; val_optim_loss: 199259.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9617; val_auprc_score: 0.9585; val_best_acc_score: 0.8958; val_best_f1_score: 0.8969; train_kl_reg_loss: 4019.9506; train_edge_recon_loss: 86180.2400; train_gene_expr_recon_loss: 108120.0045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198320.1920; train_optim_loss: 198320.1920; val_kl_reg_loss: 3992.8081; val_edge_recon_loss: 86122.8438; val_gene_expr_recon_loss: 108930.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199045.9062; val_optim_loss: 199045.9062
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9666; val_auprc_score: 0.9658; val_best_acc_score: 0.9015; val_best_f1_score: 0.9027; train_kl_reg_loss: 4065.6380; train_edge_recon_loss: 85665.5592; train_gene_expr_recon_loss: 106725.3248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196456.5201; train_optim_loss: 196456.5201; val_kl_reg_loss: 4222.3066; val_edge_recon_loss: 84241.4297; val_gene_expr_recon_loss: 107928.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196392.4375; val_optim_loss: 196392.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9725; val_auprc_score: 0.9713; val_best_acc_score: 0.9126; val_best_f1_score: 0.9145; train_kl_reg_loss: 4445.7860; train_edge_recon_loss: 84480.1730; train_gene_expr_recon_loss: 105770.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194696.6027; train_optim_loss: 194696.6027; val_kl_reg_loss: 4451.8013; val_edge_recon_loss: 83875.3594; val_gene_expr_recon_loss: 106666.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194993.9688; val_optim_loss: 194993.9688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9782; val_auprc_score: 0.9765; val_best_acc_score: 0.9226; val_best_f1_score: 0.9238; train_kl_reg_loss: 4463.3663; train_edge_recon_loss: 83089.4933; train_gene_expr_recon_loss: 104704.6004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192257.4598; train_optim_loss: 192257.4598; val_kl_reg_loss: 4427.1538; val_edge_recon_loss: 80143.8906; val_gene_expr_recon_loss: 105618.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190189.6406; val_optim_loss: 190189.6406
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9821; val_auprc_score: 0.9800; val_best_acc_score: 0.9348; val_best_f1_score: 0.9350; train_kl_reg_loss: 4539.6556; train_edge_recon_loss: 83757.8638; train_gene_expr_recon_loss: 103635.8315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191933.3504; train_optim_loss: 191933.3504; val_kl_reg_loss: 4599.4873; val_edge_recon_loss: 81235.3594; val_gene_expr_recon_loss: 104584.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190418.8750; val_optim_loss: 190418.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9843; val_auprc_score: 0.9818; val_best_acc_score: 0.9410; val_best_f1_score: 0.9414; train_kl_reg_loss: 4605.7655; train_edge_recon_loss: 82226.0056; train_gene_expr_recon_loss: 102666.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189498.2366; train_optim_loss: 189498.2366; val_kl_reg_loss: 4596.0347; val_edge_recon_loss: 83355.9062; val_gene_expr_recon_loss: 103685.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191637.9062; val_optim_loss: 191637.9062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9877; val_auprc_score: 0.9860; val_best_acc_score: 0.9487; val_best_f1_score: 0.9491; train_kl_reg_loss: 4701.6606; train_edge_recon_loss: 82023.0792; train_gene_expr_recon_loss: 101871.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188595.9509; train_optim_loss: 188595.9509; val_kl_reg_loss: 4755.5342; val_edge_recon_loss: 81229.9766; val_gene_expr_recon_loss: 102849.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188835.1562; val_optim_loss: 188835.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9879; val_auprc_score: 0.9855; val_best_acc_score: 0.9508; val_best_f1_score: 0.9512; train_kl_reg_loss: 4717.5601; train_edge_recon_loss: 81805.6205; train_gene_expr_recon_loss: 101026.5335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187549.7121; train_optim_loss: 187549.7121; val_kl_reg_loss: 4664.5898; val_edge_recon_loss: 78852.8828; val_gene_expr_recon_loss: 102149.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185666.9375; val_optim_loss: 185666.9375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9558; val_best_f1_score: 0.9562; train_kl_reg_loss: 4709.2958; train_edge_recon_loss: 81296.2991; train_gene_expr_recon_loss: 100453.1942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186458.7924; train_optim_loss: 186458.7924; val_kl_reg_loss: 4712.1904; val_edge_recon_loss: 81408.4531; val_gene_expr_recon_loss: 101402.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187522.7656; val_optim_loss: 187522.7656
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9907; val_auprc_score: 0.9887; val_best_acc_score: 0.9566; val_best_f1_score: 0.9572; train_kl_reg_loss: 4722.4083; train_edge_recon_loss: 81117.3136; train_gene_expr_recon_loss: 99752.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185592.5737; train_optim_loss: 185592.5737; val_kl_reg_loss: 4664.8804; val_edge_recon_loss: 82644.8984; val_gene_expr_recon_loss: 100899.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188208.9531; val_optim_loss: 188208.9531
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9906; val_auprc_score: 0.9890; val_best_acc_score: 0.9577; val_best_f1_score: 0.9583; train_kl_reg_loss: 4664.6146; train_edge_recon_loss: 81369.0190; train_gene_expr_recon_loss: 99298.6752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185332.3103; train_optim_loss: 185332.3103; val_kl_reg_loss: 4629.8369; val_edge_recon_loss: 80711.4766; val_gene_expr_recon_loss: 100375.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185716.8438; val_optim_loss: 185716.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9904; val_auprc_score: 0.9877; val_best_acc_score: 0.9584; val_best_f1_score: 0.9589; train_kl_reg_loss: 4650.4037; train_edge_recon_loss: 81153.0938; train_gene_expr_recon_loss: 98966.1473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184769.6451; train_optim_loss: 184769.6451; val_kl_reg_loss: 4613.6577; val_edge_recon_loss: 81402.4609; val_gene_expr_recon_loss: 100355.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186371.1875; val_optim_loss: 186371.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9906; val_auprc_score: 0.9888; val_best_acc_score: 0.9595; val_best_f1_score: 0.9600; train_kl_reg_loss: 4651.2740; train_edge_recon_loss: 80464.9676; train_gene_expr_recon_loss: 98854.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183970.3192; train_optim_loss: 183970.3192; val_kl_reg_loss: 4630.3584; val_edge_recon_loss: 81386.8828; val_gene_expr_recon_loss: 100283.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186301.0938; val_optim_loss: 186301.0938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9912; val_auprc_score: 0.9885; val_best_acc_score: 0.9610; val_best_f1_score: 0.9615; train_kl_reg_loss: 4648.3345; train_edge_recon_loss: 80781.1964; train_gene_expr_recon_loss: 98869.7533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184299.2790; train_optim_loss: 184299.2790; val_kl_reg_loss: 4607.3643; val_edge_recon_loss: 82355.8828; val_gene_expr_recon_loss: 100266.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187230.0000; val_optim_loss: 187230.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 9 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9885
Val AUPRC score: 0.9858
Val best accuracy score: 0.9523
Val best F1 score: 0.9526
Val gene expr MSE score: 1.5804
Duration of model training in run 8: 0 hours, 2 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9627; val_best_f1_score: 0.9626; train_kl_reg_loss: 239.7434; train_edge_recon_loss: 102209.4444; train_gene_expr_recon_loss: 133525.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235974.6597; train_optim_loss: 235974.6597; val_kl_reg_loss: 487.7504; val_edge_recon_loss: 115092.4531; val_gene_expr_recon_loss: 127976.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243557.0000; val_optim_loss: 243557.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9801; val_auprc_score: 0.9801; val_best_acc_score: 0.9260; val_best_f1_score: 0.9256; train_kl_reg_loss: 872.2328; train_edge_recon_loss: 102311.4045; train_gene_expr_recon_loss: 126442.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229626.0260; train_optim_loss: 229626.0260; val_kl_reg_loss: 1155.0751; val_edge_recon_loss: 118321.2500; val_gene_expr_recon_loss: 121688.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241165.1875; val_optim_loss: 241165.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9658; val_auprc_score: 0.9641; val_best_acc_score: 0.8766; val_best_f1_score: 0.8770; train_kl_reg_loss: 1154.1872; train_edge_recon_loss: 101316.3681; train_gene_expr_recon_loss: 121711.3915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224181.9497; train_optim_loss: 224181.9497; val_kl_reg_loss: 1103.9058; val_edge_recon_loss: 112532.6953; val_gene_expr_recon_loss: 117918.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231555.0781; val_optim_loss: 231555.0781
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9499; val_auprc_score: 0.9484; val_best_acc_score: 0.8694; val_best_f1_score: 0.8722; train_kl_reg_loss: 1263.9221; train_edge_recon_loss: 100253.7326; train_gene_expr_recon_loss: 118381.9175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219899.5712; train_optim_loss: 219899.5712; val_kl_reg_loss: 1447.7476; val_edge_recon_loss: 103499.1953; val_gene_expr_recon_loss: 115430.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220377.7812; val_optim_loss: 220377.7812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9440; val_auprc_score: 0.9401; val_best_acc_score: 0.8685; val_best_f1_score: 0.8744; train_kl_reg_loss: 1794.4741; train_edge_recon_loss: 97436.6059; train_gene_expr_recon_loss: 116023.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215254.2882; train_optim_loss: 215254.2882; val_kl_reg_loss: 2309.3579; val_edge_recon_loss: 96148.8672; val_gene_expr_recon_loss: 113485.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211943.5000; val_optim_loss: 211943.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9468; val_auprc_score: 0.9440; val_best_acc_score: 0.8723; val_best_f1_score: 0.8772; train_kl_reg_loss: 2829.2561; train_edge_recon_loss: 91437.2170; train_gene_expr_recon_loss: 114533.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208800.1128; train_optim_loss: 208800.1128; val_kl_reg_loss: 3316.5144; val_edge_recon_loss: 89952.9141; val_gene_expr_recon_loss: 112332.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205602.2969; val_optim_loss: 205602.2969
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9498; val_auprc_score: 0.9491; val_best_acc_score: 0.8780; val_best_f1_score: 0.8825; train_kl_reg_loss: 3666.4042; train_edge_recon_loss: 88325.7457; train_gene_expr_recon_loss: 112996.6007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204988.7483; train_optim_loss: 204988.7483; val_kl_reg_loss: 3887.8374; val_edge_recon_loss: 88394.2656; val_gene_expr_recon_loss: 110513.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202795.7188; val_optim_loss: 202795.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9565; val_auprc_score: 0.9551; val_best_acc_score: 0.8881; val_best_f1_score: 0.8914; train_kl_reg_loss: 3992.8669; train_edge_recon_loss: 86324.9705; train_gene_expr_recon_loss: 111210.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201528.4271; train_optim_loss: 201528.4271; val_kl_reg_loss: 3912.4458; val_edge_recon_loss: 84240.1797; val_gene_expr_recon_loss: 109039.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197191.8125; val_optim_loss: 197191.8125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9663; val_auprc_score: 0.9638; val_best_acc_score: 0.9053; val_best_f1_score: 0.9061; train_kl_reg_loss: 3923.4878; train_edge_recon_loss: 86017.9965; train_gene_expr_recon_loss: 109883.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199824.7726; train_optim_loss: 199824.7726; val_kl_reg_loss: 3973.9766; val_edge_recon_loss: 83065.2344; val_gene_expr_recon_loss: 107912.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194951.5938; val_optim_loss: 194951.5938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9754; val_auprc_score: 0.9737; val_best_acc_score: 0.9205; val_best_f1_score: 0.9217; train_kl_reg_loss: 4156.8281; train_edge_recon_loss: 84531.5512; train_gene_expr_recon_loss: 108653.4540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197341.8351; train_optim_loss: 197341.8351; val_kl_reg_loss: 4028.2563; val_edge_recon_loss: 83471.3516; val_gene_expr_recon_loss: 106626.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194126.4844; val_optim_loss: 194126.4844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9814; val_auprc_score: 0.9796; val_best_acc_score: 0.9340; val_best_f1_score: 0.9346; train_kl_reg_loss: 4127.4358; train_edge_recon_loss: 83775.8281; train_gene_expr_recon_loss: 107277.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195181.0417; train_optim_loss: 195181.0417; val_kl_reg_loss: 4342.0059; val_edge_recon_loss: 82425.6641; val_gene_expr_recon_loss: 105262.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192029.9688; val_optim_loss: 192029.9688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9853; val_auprc_score: 0.9836; val_best_acc_score: 0.9426; val_best_f1_score: 0.9433; train_kl_reg_loss: 4474.7518; train_edge_recon_loss: 82036.9818; train_gene_expr_recon_loss: 106235.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192746.9809; train_optim_loss: 192746.9809; val_kl_reg_loss: 4407.8740; val_edge_recon_loss: 82217.7109; val_gene_expr_recon_loss: 104183.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190809.5469; val_optim_loss: 190809.5469
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9872; val_auprc_score: 0.9848; val_best_acc_score: 0.9496; val_best_f1_score: 0.9503; train_kl_reg_loss: 4496.7547; train_edge_recon_loss: 81885.1076; train_gene_expr_recon_loss: 104862.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191244.1233; train_optim_loss: 191244.1233; val_kl_reg_loss: 4604.6514; val_edge_recon_loss: 80943.5859; val_gene_expr_recon_loss: 103054.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188602.2969; val_optim_loss: 188602.2969
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9881; val_auprc_score: 0.9853; val_best_acc_score: 0.9536; val_best_f1_score: 0.9542; train_kl_reg_loss: 4649.7696; train_edge_recon_loss: 81549.0903; train_gene_expr_recon_loss: 103826.9019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190025.7587; train_optim_loss: 190025.7587; val_kl_reg_loss: 4629.4204; val_edge_recon_loss: 81169.4688; val_gene_expr_recon_loss: 102175.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187974.3125; val_optim_loss: 187974.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9892; val_auprc_score: 0.9859; val_best_acc_score: 0.9548; val_best_f1_score: 0.9555; train_kl_reg_loss: 4691.3270; train_edge_recon_loss: 80921.4358; train_gene_expr_recon_loss: 102810.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188423.2257; train_optim_loss: 188423.2257; val_kl_reg_loss: 4611.5635; val_edge_recon_loss: 81955.0625; val_gene_expr_recon_loss: 101259.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187825.9688; val_optim_loss: 187825.9688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9900; val_auprc_score: 0.9866; val_best_acc_score: 0.9571; val_best_f1_score: 0.9577; train_kl_reg_loss: 4679.7918; train_edge_recon_loss: 81750.3359; train_gene_expr_recon_loss: 102084.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188514.6840; train_optim_loss: 188514.6840; val_kl_reg_loss: 4683.8325; val_edge_recon_loss: 79867.7109; val_gene_expr_recon_loss: 100468.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185019.9375; val_optim_loss: 185019.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9903; val_auprc_score: 0.9872; val_best_acc_score: 0.9598; val_best_f1_score: 0.9604; train_kl_reg_loss: 4646.8025; train_edge_recon_loss: 81407.7786; train_gene_expr_recon_loss: 101353.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187407.8594; train_optim_loss: 187407.8594; val_kl_reg_loss: 4579.9229; val_edge_recon_loss: 80588.5234; val_gene_expr_recon_loss: 99945.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185113.4531; val_optim_loss: 185113.4531
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9907; val_auprc_score: 0.9877; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 4585.9579; train_edge_recon_loss: 80648.4323; train_gene_expr_recon_loss: 101043.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186278.3611; train_optim_loss: 186278.3611; val_kl_reg_loss: 4536.4067; val_edge_recon_loss: 80897.1562; val_gene_expr_recon_loss: 99216.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184650.3906; val_optim_loss: 184650.3906
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9912; val_auprc_score: 0.9876; val_best_acc_score: 0.9620; val_best_f1_score: 0.9625; train_kl_reg_loss: 4605.3149; train_edge_recon_loss: 81350.6094; train_gene_expr_recon_loss: 100318.3351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186274.2587; train_optim_loss: 186274.2587; val_kl_reg_loss: 4540.9697; val_edge_recon_loss: 80095.1016; val_gene_expr_recon_loss: 98748.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183384.7031; val_optim_loss: 183384.7031
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9912; val_auprc_score: 0.9876; val_best_acc_score: 0.9621; val_best_f1_score: 0.9627; train_kl_reg_loss: 4574.4209; train_edge_recon_loss: 80758.1181; train_gene_expr_recon_loss: 99764.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185096.9740; train_optim_loss: 185096.9740; val_kl_reg_loss: 4495.0449; val_edge_recon_loss: 78007.0312; val_gene_expr_recon_loss: 98251.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180753.4531; val_optim_loss: 180753.4531
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9647; val_best_f1_score: 0.9652; train_kl_reg_loss: 4489.0620; train_edge_recon_loss: 80736.6233; train_gene_expr_recon_loss: 99388.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184614.5833; train_optim_loss: 184614.5833; val_kl_reg_loss: 4451.2979; val_edge_recon_loss: 82777.6719; val_gene_expr_recon_loss: 97843.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185072.0000; val_optim_loss: 185072.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9928; val_auprc_score: 0.9898; val_best_acc_score: 0.9671; val_best_f1_score: 0.9675; train_kl_reg_loss: 4444.9403; train_edge_recon_loss: 80642.1762; train_gene_expr_recon_loss: 98713.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183800.4462; train_optim_loss: 183800.4462; val_kl_reg_loss: 4403.8877; val_edge_recon_loss: 78891.2969; val_gene_expr_recon_loss: 97383.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180678.3438; val_optim_loss: 180678.3438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9925; val_auprc_score: 0.9893; val_best_acc_score: 0.9671; val_best_f1_score: 0.9675; train_kl_reg_loss: 4440.9143; train_edge_recon_loss: 81807.3299; train_gene_expr_recon_loss: 98337.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184585.5156; train_optim_loss: 184585.5156; val_kl_reg_loss: 4330.4531; val_edge_recon_loss: 78581.3594; val_gene_expr_recon_loss: 96956.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179868.7969; val_optim_loss: 179868.7969
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 4404.8662; train_edge_recon_loss: 80056.2804; train_gene_expr_recon_loss: 97919.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182380.5816; train_optim_loss: 182380.5816; val_kl_reg_loss: 4281.6514; val_edge_recon_loss: 80497.0234; val_gene_expr_recon_loss: 96648.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181427.5625; val_optim_loss: 181427.5625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9935; val_auprc_score: 0.9919; val_best_acc_score: 0.9677; val_best_f1_score: 0.9680; train_kl_reg_loss: 4346.7981; train_edge_recon_loss: 79958.3108; train_gene_expr_recon_loss: 97472.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181777.5694; train_optim_loss: 181777.5694; val_kl_reg_loss: 4329.7061; val_edge_recon_loss: 79719.5078; val_gene_expr_recon_loss: 96241.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180290.8438; val_optim_loss: 180290.8438
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9938; val_auprc_score: 0.9913; val_best_acc_score: 0.9698; val_best_f1_score: 0.9701; train_kl_reg_loss: 4355.0308; train_edge_recon_loss: 80158.9913; train_gene_expr_recon_loss: 97438.4175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181952.4392; train_optim_loss: 181952.4392; val_kl_reg_loss: 4192.2500; val_edge_recon_loss: 78204.9844; val_gene_expr_recon_loss: 96026.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178423.5000; val_optim_loss: 178423.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9939; val_auprc_score: 0.9922; val_best_acc_score: 0.9681; val_best_f1_score: 0.9685; train_kl_reg_loss: 4314.0607; train_edge_recon_loss: 80263.6198; train_gene_expr_recon_loss: 96885.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181462.8420; train_optim_loss: 181462.8420; val_kl_reg_loss: 4153.1772; val_edge_recon_loss: 79392.2188; val_gene_expr_recon_loss: 95581.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179126.9688; val_optim_loss: 179126.9688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9948; val_auprc_score: 0.9936; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 4273.7250; train_edge_recon_loss: 79179.6207; train_gene_expr_recon_loss: 96749.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180203.2760; train_optim_loss: 180203.2760; val_kl_reg_loss: 4069.4209; val_edge_recon_loss: 78656.8438; val_gene_expr_recon_loss: 95270.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177996.9062; val_optim_loss: 177996.9062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9680; val_best_f1_score: 0.9685; train_kl_reg_loss: 4199.9422; train_edge_recon_loss: 80761.9262; train_gene_expr_recon_loss: 96458.4748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181420.3438; train_optim_loss: 181420.3438; val_kl_reg_loss: 4074.0405; val_edge_recon_loss: 77155.2656; val_gene_expr_recon_loss: 95094.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176324.2969; val_optim_loss: 176324.2969
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9937; val_auprc_score: 0.9912; val_best_acc_score: 0.9699; val_best_f1_score: 0.9702; train_kl_reg_loss: 4191.2442; train_edge_recon_loss: 78927.3655; train_gene_expr_recon_loss: 96248.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179367.0087; train_optim_loss: 179367.0087; val_kl_reg_loss: 4053.3096; val_edge_recon_loss: 76869.3672; val_gene_expr_recon_loss: 94722.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175644.9844; val_optim_loss: 175644.9844
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 4156.1170; train_edge_recon_loss: 79499.2135; train_gene_expr_recon_loss: 95791.7179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179447.0521; train_optim_loss: 179447.0521; val_kl_reg_loss: 4042.1338; val_edge_recon_loss: 78258.6406; val_gene_expr_recon_loss: 94524.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176825.3438; val_optim_loss: 176825.3438
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9940; val_auprc_score: 0.9918; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 4140.2056; train_edge_recon_loss: 78682.3125; train_gene_expr_recon_loss: 95582.1493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178404.6649; train_optim_loss: 178404.6649; val_kl_reg_loss: 4042.8494; val_edge_recon_loss: 79423.9531; val_gene_expr_recon_loss: 94341.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177807.8438; val_optim_loss: 177807.8438
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9938; val_auprc_score: 0.9920; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 4104.4200; train_edge_recon_loss: 79093.6615; train_gene_expr_recon_loss: 95211.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178409.7274; train_optim_loss: 178409.7274; val_kl_reg_loss: 3988.6504; val_edge_recon_loss: 81213.0000; val_gene_expr_recon_loss: 94026.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179227.6562; val_optim_loss: 179227.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9939; val_auprc_score: 0.9924; val_best_acc_score: 0.9702; val_best_f1_score: 0.9707; train_kl_reg_loss: 4066.8917; train_edge_recon_loss: 79115.2092; train_gene_expr_recon_loss: 95166.5095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178348.6076; train_optim_loss: 178348.6076; val_kl_reg_loss: 3969.6011; val_edge_recon_loss: 78645.7578; val_gene_expr_recon_loss: 93951.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176566.8750; val_optim_loss: 176566.8750
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9701; val_best_f1_score: 0.9704; train_kl_reg_loss: 4058.1216; train_edge_recon_loss: 79417.2144; train_gene_expr_recon_loss: 95201.0773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178676.4149; train_optim_loss: 178676.4149; val_kl_reg_loss: 3974.4255; val_edge_recon_loss: 77141.1953; val_gene_expr_recon_loss: 93961.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175077.3125; val_optim_loss: 175077.3125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9945; val_auprc_score: 0.9916; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 4073.9022; train_edge_recon_loss: 78404.2083; train_gene_expr_recon_loss: 95257.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177735.3854; train_optim_loss: 177735.3854; val_kl_reg_loss: 3985.4531; val_edge_recon_loss: 78216.3125; val_gene_expr_recon_loss: 93913.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176115.5312; val_optim_loss: 176115.5312
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9943; val_auprc_score: 0.9921; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 4070.3108; train_edge_recon_loss: 79268.0260; train_gene_expr_recon_loss: 95068.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178406.6181; train_optim_loss: 178406.6181; val_kl_reg_loss: 3986.8325; val_edge_recon_loss: 78619.6328; val_gene_expr_recon_loss: 93876.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176482.6562; val_optim_loss: 176482.6562
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9936; val_auprc_score: 0.9917; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 4067.3629; train_edge_recon_loss: 79918.9314; train_gene_expr_recon_loss: 95118.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179104.7222; train_optim_loss: 179104.7222; val_kl_reg_loss: 3977.2837; val_edge_recon_loss: 79390.8984; val_gene_expr_recon_loss: 93875.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177243.4375; val_optim_loss: 177243.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9937; val_auprc_score: 0.9914; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 4059.9543; train_edge_recon_loss: 78906.2778; train_gene_expr_recon_loss: 95082.5217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178048.7535; train_optim_loss: 178048.7535; val_kl_reg_loss: 3979.3279; val_edge_recon_loss: 79117.0625; val_gene_expr_recon_loss: 93866.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176962.6719; val_optim_loss: 176962.6719
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9699; val_best_f1_score: 0.9703; train_kl_reg_loss: 4063.6570; train_edge_recon_loss: 78768.4497; train_gene_expr_recon_loss: 94956.3637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177788.4688; train_optim_loss: 177788.4688; val_kl_reg_loss: 3978.9495; val_edge_recon_loss: 78557.3516; val_gene_expr_recon_loss: 93854.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176390.7656; val_optim_loss: 176390.7656
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9703; val_best_f1_score: 0.9708; train_kl_reg_loss: 4061.1159; train_edge_recon_loss: 79338.4905; train_gene_expr_recon_loss: 95058.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178457.6128; train_optim_loss: 178457.6128; val_kl_reg_loss: 3974.7073; val_edge_recon_loss: 79564.5469; val_gene_expr_recon_loss: 93851.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177390.7188; val_optim_loss: 177390.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 13 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9945
Val AUPRC score: 0.9923
Val best accuracy score: 0.9721
Val best F1 score: 0.9723
Val gene expr MSE score: 1.1893
Duration of model training in run 9: 0 hours, 5 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 11827
Number of validation nodes: 1314
Number of training edges: 133545
Number of validation edges: 14838
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9928; val_auprc_score: 0.9907; val_best_acc_score: 0.9625; val_best_f1_score: 0.9623; train_kl_reg_loss: 258.3671; train_edge_recon_loss: 101718.2205; train_gene_expr_recon_loss: 131006.4705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232983.0556; train_optim_loss: 232983.0556; val_kl_reg_loss: 523.8757; val_edge_recon_loss: 115766.6484; val_gene_expr_recon_loss: 125853.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242143.9688; val_optim_loss: 242143.9688
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9796; val_auprc_score: 0.9794; val_best_acc_score: 0.9254; val_best_f1_score: 0.9238; train_kl_reg_loss: 846.7302; train_edge_recon_loss: 102128.9123; train_gene_expr_recon_loss: 124511.9071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227487.5503; train_optim_loss: 227487.5503; val_kl_reg_loss: 1075.6719; val_edge_recon_loss: 117175.1953; val_gene_expr_recon_loss: 120126.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238376.9062; val_optim_loss: 238376.9062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9613; val_auprc_score: 0.9599; val_best_acc_score: 0.8737; val_best_f1_score: 0.8824; train_kl_reg_loss: 1148.5137; train_edge_recon_loss: 100898.8403; train_gene_expr_recon_loss: 119333.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221380.5625; train_optim_loss: 221380.5625; val_kl_reg_loss: 1183.8882; val_edge_recon_loss: 110129.5312; val_gene_expr_recon_loss: 116445.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227759.1719; val_optim_loss: 227759.1719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9459; val_auprc_score: 0.9431; val_best_acc_score: 0.8655; val_best_f1_score: 0.8717; train_kl_reg_loss: 1438.7761; train_edge_recon_loss: 99698.0538; train_gene_expr_recon_loss: 116176.7795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217313.6076; train_optim_loss: 217313.6076; val_kl_reg_loss: 1746.8647; val_edge_recon_loss: 99431.8125; val_gene_expr_recon_loss: 114100.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215279.3438; val_optim_loss: 215279.3438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9404; val_auprc_score: 0.9399; val_best_acc_score: 0.8610; val_best_f1_score: 0.8689; train_kl_reg_loss: 2235.4418; train_edge_recon_loss: 94922.3958; train_gene_expr_recon_loss: 114038.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211196.6059; train_optim_loss: 211196.6059; val_kl_reg_loss: 2778.3074; val_edge_recon_loss: 92866.5312; val_gene_expr_recon_loss: 112407.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208052.7812; val_optim_loss: 208052.7812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9429; val_auprc_score: 0.9423; val_best_acc_score: 0.8658; val_best_f1_score: 0.8706; train_kl_reg_loss: 3299.0063; train_edge_recon_loss: 91285.6128; train_gene_expr_recon_loss: 112436.3464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207020.9635; train_optim_loss: 207020.9635; val_kl_reg_loss: 3728.2886; val_edge_recon_loss: 87767.6016; val_gene_expr_recon_loss: 110790.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202286.6250; val_optim_loss: 202286.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9516; val_auprc_score: 0.9508; val_best_acc_score: 0.8804; val_best_f1_score: 0.8823; train_kl_reg_loss: 3851.4797; train_edge_recon_loss: 89001.4974; train_gene_expr_recon_loss: 110431.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203284.8924; train_optim_loss: 203284.8924; val_kl_reg_loss: 3594.8340; val_edge_recon_loss: 89279.3203; val_gene_expr_recon_loss: 108952.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201826.3594; val_optim_loss: 201826.3594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9600; val_auprc_score: 0.9581; val_best_acc_score: 0.8934; val_best_f1_score: 0.8950; train_kl_reg_loss: 3761.2678; train_edge_recon_loss: 86726.7214; train_gene_expr_recon_loss: 108861.3264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199349.3194; train_optim_loss: 199349.3194; val_kl_reg_loss: 3826.1348; val_edge_recon_loss: 85861.7422; val_gene_expr_recon_loss: 107739.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197426.9688; val_optim_loss: 197426.9688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9708; val_auprc_score: 0.9703; val_best_acc_score: 0.9092; val_best_f1_score: 0.9113; train_kl_reg_loss: 3961.3994; train_edge_recon_loss: 86274.0590; train_gene_expr_recon_loss: 107618.6128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197854.0729; train_optim_loss: 197854.0729; val_kl_reg_loss: 3940.4370; val_edge_recon_loss: 84649.3594; val_gene_expr_recon_loss: 106349.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194938.8750; val_optim_loss: 194938.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9804; val_auprc_score: 0.9778; val_best_acc_score: 0.9295; val_best_f1_score: 0.9307; train_kl_reg_loss: 4020.3137; train_edge_recon_loss: 83522.9549; train_gene_expr_recon_loss: 106153.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193696.9479; train_optim_loss: 193696.9479; val_kl_reg_loss: 4081.1997; val_edge_recon_loss: 82615.9453; val_gene_expr_recon_loss: 105365.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192062.3438; val_optim_loss: 192062.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9850; val_auprc_score: 0.9826; val_best_acc_score: 0.9417; val_best_f1_score: 0.9425; train_kl_reg_loss: 4296.4287; train_edge_recon_loss: 82778.4071; train_gene_expr_recon_loss: 105132.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192207.7378; train_optim_loss: 192207.7378; val_kl_reg_loss: 4244.4951; val_edge_recon_loss: 81878.1875; val_gene_expr_recon_loss: 103921.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190044.4844; val_optim_loss: 190044.4844
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9863; val_auprc_score: 0.9831; val_best_acc_score: 0.9469; val_best_f1_score: 0.9470; train_kl_reg_loss: 4427.4821; train_edge_recon_loss: 82521.5234; train_gene_expr_recon_loss: 103629.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190578.1545; train_optim_loss: 190578.1545; val_kl_reg_loss: 4491.4707; val_edge_recon_loss: 81948.6016; val_gene_expr_recon_loss: 102541.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188981.8438; val_optim_loss: 188981.8438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9889; val_auprc_score: 0.9868; val_best_acc_score: 0.9546; val_best_f1_score: 0.9550; train_kl_reg_loss: 4611.1783; train_edge_recon_loss: 81801.2431; train_gene_expr_recon_loss: 102501.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188914.2969; train_optim_loss: 188914.2969; val_kl_reg_loss: 4655.6865; val_edge_recon_loss: 81144.9609; val_gene_expr_recon_loss: 101498.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187299.4531; val_optim_loss: 187299.4531
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9896; val_auprc_score: 0.9869; val_best_acc_score: 0.9558; val_best_f1_score: 0.9563; train_kl_reg_loss: 4635.5579; train_edge_recon_loss: 81322.3203; train_gene_expr_recon_loss: 101620.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187578.6979; train_optim_loss: 187578.6979; val_kl_reg_loss: 4606.1626; val_edge_recon_loss: 82525.3672; val_gene_expr_recon_loss: 100689.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187820.9375; val_optim_loss: 187820.9375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9899; val_auprc_score: 0.9875; val_best_acc_score: 0.9575; val_best_f1_score: 0.9579; train_kl_reg_loss: 4662.2045; train_edge_recon_loss: 80147.8134; train_gene_expr_recon_loss: 100686.9644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185496.9792; train_optim_loss: 185496.9792; val_kl_reg_loss: 4554.5234; val_edge_recon_loss: 79151.2422; val_gene_expr_recon_loss: 99805.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183511.6562; val_optim_loss: 183511.6562
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9908; val_auprc_score: 0.9884; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 4606.7399; train_edge_recon_loss: 80701.3767; train_gene_expr_recon_loss: 99961.6545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185269.7708; train_optim_loss: 185269.7708; val_kl_reg_loss: 4572.2705; val_edge_recon_loss: 80510.0469; val_gene_expr_recon_loss: 99140.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184222.9531; val_optim_loss: 184222.9531
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9910; val_auprc_score: 0.9887; val_best_acc_score: 0.9617; val_best_f1_score: 0.9621; train_kl_reg_loss: 4583.1304; train_edge_recon_loss: 81188.8533; train_gene_expr_recon_loss: 99256.3724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185028.3542; train_optim_loss: 185028.3542; val_kl_reg_loss: 4520.0469; val_edge_recon_loss: 80307.2266; val_gene_expr_recon_loss: 98639.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183466.9688; val_optim_loss: 183466.9688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9922; val_auprc_score: 0.9901; val_best_acc_score: 0.9635; val_best_f1_score: 0.9639; train_kl_reg_loss: 4550.6169; train_edge_recon_loss: 80872.3507; train_gene_expr_recon_loss: 98829.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184252.5608; train_optim_loss: 184252.5608; val_kl_reg_loss: 4471.2383; val_edge_recon_loss: 77097.6953; val_gene_expr_recon_loss: 98097.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179666.4688; val_optim_loss: 179666.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9916; val_auprc_score: 0.9881; val_best_acc_score: 0.9654; val_best_f1_score: 0.9659; train_kl_reg_loss: 4545.8216; train_edge_recon_loss: 80242.3108; train_gene_expr_recon_loss: 98334.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183122.4358; train_optim_loss: 183122.4358; val_kl_reg_loss: 4452.5073; val_edge_recon_loss: 79036.3984; val_gene_expr_recon_loss: 97594.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181083.2812; val_optim_loss: 181083.2812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9665; val_best_f1_score: 0.9668; train_kl_reg_loss: 4490.4998; train_edge_recon_loss: 80046.1658; train_gene_expr_recon_loss: 97848.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182385.6562; train_optim_loss: 182385.6562; val_kl_reg_loss: 4466.0278; val_edge_recon_loss: 80362.3906; val_gene_expr_recon_loss: 97149.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181978.3438; val_optim_loss: 181978.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9927; val_auprc_score: 0.9901; val_best_acc_score: 0.9664; val_best_f1_score: 0.9667; train_kl_reg_loss: 4467.8090; train_edge_recon_loss: 80404.9158; train_gene_expr_recon_loss: 97160.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182032.8247; train_optim_loss: 182032.8247; val_kl_reg_loss: 4415.7202; val_edge_recon_loss: 78502.4844; val_gene_expr_recon_loss: 96698.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179616.8125; val_optim_loss: 179616.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9925; val_auprc_score: 0.9896; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 4460.8946; train_edge_recon_loss: 80735.5304; train_gene_expr_recon_loss: 96959.1085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182155.5312; train_optim_loss: 182155.5312; val_kl_reg_loss: 4341.5889; val_edge_recon_loss: 80076.2891; val_gene_expr_recon_loss: 96352.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180770.5625; val_optim_loss: 180770.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9930; val_auprc_score: 0.9897; val_best_acc_score: 0.9678; val_best_f1_score: 0.9680; train_kl_reg_loss: 4419.9557; train_edge_recon_loss: 80260.8247; train_gene_expr_recon_loss: 96605.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181286.2500; train_optim_loss: 181286.2500; val_kl_reg_loss: 4422.2959; val_edge_recon_loss: 77777.0156; val_gene_expr_recon_loss: 95940.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178139.8125; val_optim_loss: 178139.8125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9934; val_auprc_score: 0.9914; val_best_acc_score: 0.9684; val_best_f1_score: 0.9687; train_kl_reg_loss: 4383.9163; train_edge_recon_loss: 79794.2040; train_gene_expr_recon_loss: 96321.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180499.3993; train_optim_loss: 180499.3993; val_kl_reg_loss: 4352.7441; val_edge_recon_loss: 78517.5078; val_gene_expr_recon_loss: 95589.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178460.2344; val_optim_loss: 178460.2344
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9936; val_auprc_score: 0.9914; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 4390.6259; train_edge_recon_loss: 80223.0399; train_gene_expr_recon_loss: 95888.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180502.6128; train_optim_loss: 180502.6128; val_kl_reg_loss: 4314.9072; val_edge_recon_loss: 76782.3047; val_gene_expr_recon_loss: 95314.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176411.5000; val_optim_loss: 176411.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9934; val_auprc_score: 0.9916; val_best_acc_score: 0.9678; val_best_f1_score: 0.9682; train_kl_reg_loss: 4354.8036; train_edge_recon_loss: 80239.3446; train_gene_expr_recon_loss: 95549.0530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180143.2014; train_optim_loss: 180143.2014; val_kl_reg_loss: 4147.8496; val_edge_recon_loss: 79359.4297; val_gene_expr_recon_loss: 95018.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178525.3594; val_optim_loss: 178525.3594
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 4273.2212; train_edge_recon_loss: 78686.2266; train_gene_expr_recon_loss: 95358.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178318.2274; train_optim_loss: 178318.2274; val_kl_reg_loss: 4091.2168; val_edge_recon_loss: 76533.8828; val_gene_expr_recon_loss: 94730.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175355.2344; val_optim_loss: 175355.2344
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9941; val_auprc_score: 0.9915; val_best_acc_score: 0.9698; val_best_f1_score: 0.9703; train_kl_reg_loss: 4219.1896; train_edge_recon_loss: 79129.2969; train_gene_expr_recon_loss: 95109.7665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178458.2535; train_optim_loss: 178458.2535; val_kl_reg_loss: 4130.0811; val_edge_recon_loss: 78674.3906; val_gene_expr_recon_loss: 94419.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177223.5625; val_optim_loss: 177223.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 4197.1075; train_edge_recon_loss: 79379.3628; train_gene_expr_recon_loss: 94501.7561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178078.2274; train_optim_loss: 178078.2274; val_kl_reg_loss: 4087.8394; val_edge_recon_loss: 78877.2344; val_gene_expr_recon_loss: 94227.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177193.0312; val_optim_loss: 177193.0312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9934; val_auprc_score: 0.9915; val_best_acc_score: 0.9692; val_best_f1_score: 0.9697; train_kl_reg_loss: 4166.6127; train_edge_recon_loss: 78516.7656; train_gene_expr_recon_loss: 94538.2352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177221.6146; train_optim_loss: 177221.6146; val_kl_reg_loss: 4014.0740; val_edge_recon_loss: 76436.6328; val_gene_expr_recon_loss: 93846.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174297.2812; val_optim_loss: 174297.2812
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9947; val_auprc_score: 0.9933; val_best_acc_score: 0.9716; val_best_f1_score: 0.9718; train_kl_reg_loss: 4116.5181; train_edge_recon_loss: 80282.6050; train_gene_expr_recon_loss: 94159.2517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178558.3733; train_optim_loss: 178558.3733; val_kl_reg_loss: 4003.9307; val_edge_recon_loss: 78289.5078; val_gene_expr_recon_loss: 93660.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175953.6562; val_optim_loss: 175953.6562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 4125.7190; train_edge_recon_loss: 79850.1493; train_gene_expr_recon_loss: 93942.8038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177918.6736; train_optim_loss: 177918.6736; val_kl_reg_loss: 3955.4131; val_edge_recon_loss: 78511.3984; val_gene_expr_recon_loss: 93511.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175978.7500; val_optim_loss: 175978.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9937; val_auprc_score: 0.9915; val_best_acc_score: 0.9695; val_best_f1_score: 0.9701; train_kl_reg_loss: 4083.9677; train_edge_recon_loss: 79728.8229; train_gene_expr_recon_loss: 93882.8290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177695.6198; train_optim_loss: 177695.6198; val_kl_reg_loss: 3962.2048; val_edge_recon_loss: 77632.2266; val_gene_expr_recon_loss: 93204.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174799.0312; val_optim_loss: 174799.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9940; val_auprc_score: 0.9912; val_best_acc_score: 0.9709; val_best_f1_score: 0.9712; train_kl_reg_loss: 4057.5967; train_edge_recon_loss: 78652.7847; train_gene_expr_recon_loss: 93673.6632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176384.0451; train_optim_loss: 176384.0451; val_kl_reg_loss: 3963.1350; val_edge_recon_loss: 78880.3906; val_gene_expr_recon_loss: 93201.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176044.8438; val_optim_loss: 176044.8438
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9936; val_auprc_score: 0.9904; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 4071.0446; train_edge_recon_loss: 78622.9922; train_gene_expr_recon_loss: 93645.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176339.0608; train_optim_loss: 176339.0608; val_kl_reg_loss: 3952.6909; val_edge_recon_loss: 80480.8516; val_gene_expr_recon_loss: 93143.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177576.6250; val_optim_loss: 177576.6250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9946; val_auprc_score: 0.9931; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 4044.9945; train_edge_recon_loss: 78526.3576; train_gene_expr_recon_loss: 93565.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176136.4149; train_optim_loss: 176136.4149; val_kl_reg_loss: 3929.4395; val_edge_recon_loss: 78442.4844; val_gene_expr_recon_loss: 93113.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175485.6562; val_optim_loss: 175485.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 31 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9941
Val AUPRC score: 0.9905
Val best accuracy score: 0.9697
Val best F1 score: 0.9700
Val gene expr MSE score: 1.2214
Duration of model training in run 10: 0 hours, 4 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
