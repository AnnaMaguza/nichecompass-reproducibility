Run timestamp: 29082023_222254_16.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '6', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--filter_genes', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'visium_mouse_brain', '--reference_batches', 'batch1', 'batch2', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'data', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '6', '--timestamp_suffix', '_16']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 32285 genes.
Keeping 32285 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1530, n_latent: 1520, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 10948
Number of validation nodes: 1216
Number of training edges: 33527
Number of validation edges: 3725
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8239; val_auprc_score: 0.9022; val_best_acc_score: 0.7363; val_best_f1_score: 0.8306; train_kl_reg_loss: 137487.1711; train_edge_recon_loss: 2438063.3311; train_cat_covariates_contrastive_loss: 681815.6250; train_gene_expr_recon_loss: 75445248.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 78702614.9008; train_optim_loss: 78702614.9008; val_kl_reg_loss: 183038.5802; val_edge_recon_loss: 2736228.9667; val_cat_covariates_contrastive_loss: 626547.6958; val_gene_expr_recon_loss: 55460709.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59006524.8000; val_optim_loss: 59006524.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8457; val_auprc_score: 0.9086; val_best_acc_score: 0.7833; val_best_f1_score: 0.8546; train_kl_reg_loss: 148576.0380; train_edge_recon_loss: 2453794.9370; train_cat_covariates_contrastive_loss: 646497.9647; train_gene_expr_recon_loss: 51716918.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54965787.2977; train_optim_loss: 54965787.2977; val_kl_reg_loss: 146295.8937; val_edge_recon_loss: 2678037.6833; val_cat_covariates_contrastive_loss: 626603.0542; val_gene_expr_recon_loss: 50714729.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54165665.6000; val_optim_loss: 54165665.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8432; val_auprc_score: 0.9098; val_best_acc_score: 0.7947; val_best_f1_score: 0.8586; train_kl_reg_loss: 116235.2774; train_edge_recon_loss: 2365223.3187; train_cat_covariates_contrastive_loss: 635648.7791; train_gene_expr_recon_loss: 49485784.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52602891.8779; train_optim_loss: 52602891.8779; val_kl_reg_loss: 99520.4432; val_edge_recon_loss: 2338527.9000; val_cat_covariates_contrastive_loss: 626802.2375; val_gene_expr_recon_loss: 49270921.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52335772.2667; val_optim_loss: 52335772.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8457; val_auprc_score: 0.9091; val_best_acc_score: 0.8056; val_best_f1_score: 0.8717; train_kl_reg_loss: 108989.4332; train_edge_recon_loss: 2140066.7605; train_cat_covariates_contrastive_loss: 629124.8302; train_gene_expr_recon_loss: 48497507.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51375688.2748; train_optim_loss: 51375688.2748; val_kl_reg_loss: 115845.6130; val_edge_recon_loss: 2081686.3500; val_cat_covariates_contrastive_loss: 626799.0708; val_gene_expr_recon_loss: 48603663.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51427994.4000; val_optim_loss: 51427994.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8619; val_auprc_score: 0.9200; val_best_acc_score: 0.8070; val_best_f1_score: 0.8706; train_kl_reg_loss: 117850.6780; train_edge_recon_loss: 2047323.2214; train_cat_covariates_contrastive_loss: 628354.6827; train_gene_expr_recon_loss: 47706266.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50499794.9313; train_optim_loss: 50499794.9313; val_kl_reg_loss: 111785.0396; val_edge_recon_loss: 2054507.6000; val_cat_covariates_contrastive_loss: 626869.1167; val_gene_expr_recon_loss: 47901301.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50694463.7333; val_optim_loss: 50694463.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8752; val_auprc_score: 0.9271; val_best_acc_score: 0.8138; val_best_f1_score: 0.8742; train_kl_reg_loss: 112587.2509; train_edge_recon_loss: 2023203.1508; train_cat_covariates_contrastive_loss: 628106.3707; train_gene_expr_recon_loss: 47038843.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49802740.4275; train_optim_loss: 49802740.4275; val_kl_reg_loss: 105089.8099; val_edge_recon_loss: 2050199.5417; val_cat_covariates_contrastive_loss: 627080.7958; val_gene_expr_recon_loss: 47273166.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50055536.5333; val_optim_loss: 50055536.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8750; val_auprc_score: 0.9301; val_best_acc_score: 0.8082; val_best_f1_score: 0.8724; train_kl_reg_loss: 105511.0085; train_edge_recon_loss: 1999510.9036; train_cat_covariates_contrastive_loss: 628060.2610; train_gene_expr_recon_loss: 46496820.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49229903.1450; train_optim_loss: 49229903.1450; val_kl_reg_loss: 99659.7698; val_edge_recon_loss: 2032300.1667; val_cat_covariates_contrastive_loss: 627255.0208; val_gene_expr_recon_loss: 46619804.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49379018.9333; val_optim_loss: 49379018.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8949; val_auprc_score: 0.9445; val_best_acc_score: 0.8219; val_best_f1_score: 0.8812; train_kl_reg_loss: 94533.7779; train_edge_recon_loss: 2000729.0887; train_cat_covariates_contrastive_loss: 628226.6985; train_gene_expr_recon_loss: 45959793.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48683282.9618; train_optim_loss: 48683282.9618; val_kl_reg_loss: 89430.9182; val_edge_recon_loss: 1962233.2417; val_cat_covariates_contrastive_loss: 627545.4125; val_gene_expr_recon_loss: 46156548.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48835757.8667; val_optim_loss: 48835757.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9008; val_auprc_score: 0.9453; val_best_acc_score: 0.8158; val_best_f1_score: 0.8770; train_kl_reg_loss: 87629.3470; train_edge_recon_loss: 1972304.6861; train_cat_covariates_contrastive_loss: 628502.5153; train_gene_expr_recon_loss: 45512345.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48200782.3206; train_optim_loss: 48200782.3206; val_kl_reg_loss: 84685.4307; val_edge_recon_loss: 1999715.1083; val_cat_covariates_contrastive_loss: 627788.5583; val_gene_expr_recon_loss: 45892659.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48604848.5333; val_optim_loss: 48604848.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9126; val_auprc_score: 0.9527; val_best_acc_score: 0.8396; val_best_f1_score: 0.8841; train_kl_reg_loss: 81553.7762; train_edge_recon_loss: 1945800.9256; train_cat_covariates_contrastive_loss: 628893.9685; train_gene_expr_recon_loss: 45073999.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47730248.2748; train_optim_loss: 47730248.2748; val_kl_reg_loss: 77432.1896; val_edge_recon_loss: 1962688.1417; val_cat_covariates_contrastive_loss: 628502.0250; val_gene_expr_recon_loss: 45319640.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47988262.6667; val_optim_loss: 47988262.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9213; val_auprc_score: 0.9563; val_best_acc_score: 0.8566; val_best_f1_score: 0.8962; train_kl_reg_loss: 75656.4807; train_edge_recon_loss: 1939592.0639; train_cat_covariates_contrastive_loss: 629822.2762; train_gene_expr_recon_loss: 44692303.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47337374.4733; train_optim_loss: 47337374.4733; val_kl_reg_loss: 74441.6927; val_edge_recon_loss: 1898935.5333; val_cat_covariates_contrastive_loss: 629470.7292; val_gene_expr_recon_loss: 44952459.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47555307.4667; val_optim_loss: 47555307.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9292; val_auprc_score: 0.9584; val_best_acc_score: 0.8663; val_best_f1_score: 0.9035; train_kl_reg_loss: 71683.5072; train_edge_recon_loss: 1916724.2548; train_cat_covariates_contrastive_loss: 631344.7219; train_gene_expr_recon_loss: 44257815.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46877567.6336; train_optim_loss: 46877567.6336; val_kl_reg_loss: 73492.2729; val_edge_recon_loss: 1928999.6500; val_cat_covariates_contrastive_loss: 630629.2125; val_gene_expr_recon_loss: 44794698.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47427819.7333; val_optim_loss: 47427819.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9351; val_auprc_score: 0.9621; val_best_acc_score: 0.8757; val_best_f1_score: 0.9106; train_kl_reg_loss: 69666.7566; train_edge_recon_loss: 1889319.8559; train_cat_covariates_contrastive_loss: 632504.9971; train_gene_expr_recon_loss: 43867167.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46458659.4809; train_optim_loss: 46458659.4809; val_kl_reg_loss: 69891.4719; val_edge_recon_loss: 1911038.4667; val_cat_covariates_contrastive_loss: 633061.4000; val_gene_expr_recon_loss: 44196427.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46810418.9333; val_optim_loss: 46810418.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9429; val_auprc_score: 0.9631; val_best_acc_score: 0.8928; val_best_f1_score: 0.9219; train_kl_reg_loss: 67651.4237; train_edge_recon_loss: 1870546.5067; train_cat_covariates_contrastive_loss: 633309.0749; train_gene_expr_recon_loss: 43518437.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46089944.7328; train_optim_loss: 46089944.7328; val_kl_reg_loss: 66756.4448; val_edge_recon_loss: 1886443.6833; val_cat_covariates_contrastive_loss: 634927.7000; val_gene_expr_recon_loss: 43960744.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46548872.8000; val_optim_loss: 46548872.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9450; val_auprc_score: 0.9641; val_best_acc_score: 0.8928; val_best_f1_score: 0.9219; train_kl_reg_loss: 64294.5503; train_edge_recon_loss: 1860246.4208; train_cat_covariates_contrastive_loss: 634589.0530; train_gene_expr_recon_loss: 43169178.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45728308.9466; train_optim_loss: 45728308.9466; val_kl_reg_loss: 61379.4378; val_edge_recon_loss: 1889257.9167; val_cat_covariates_contrastive_loss: 634238.4917; val_gene_expr_recon_loss: 43416769.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46001646.1333; val_optim_loss: 46001646.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9508; val_auprc_score: 0.9710; val_best_acc_score: 0.8987; val_best_f1_score: 0.9259; train_kl_reg_loss: 62180.5863; train_edge_recon_loss: 1859029.8941; train_cat_covariates_contrastive_loss: 635102.7996; train_gene_expr_recon_loss: 42840576.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45396889.4962; train_optim_loss: 45396889.4962; val_kl_reg_loss: 61556.3078; val_edge_recon_loss: 1895651.7667; val_cat_covariates_contrastive_loss: 633557.9625; val_gene_expr_recon_loss: 43219722.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45810488.8000; val_optim_loss: 45810488.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9556; val_auprc_score: 0.9730; val_best_acc_score: 0.9087; val_best_f1_score: 0.9332; train_kl_reg_loss: 59770.5771; train_edge_recon_loss: 1832154.9523; train_cat_covariates_contrastive_loss: 635728.8025; train_gene_expr_recon_loss: 42576555.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45104209.5878; train_optim_loss: 45104209.5878; val_kl_reg_loss: 57926.3344; val_edge_recon_loss: 1847016.8667; val_cat_covariates_contrastive_loss: 635530.2458; val_gene_expr_recon_loss: 42894056.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45434529.8667; val_optim_loss: 45434529.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9521; val_auprc_score: 0.9686; val_best_acc_score: 0.9061; val_best_f1_score: 0.9314; train_kl_reg_loss: 57091.1247; train_edge_recon_loss: 1820922.9227; train_cat_covariates_contrastive_loss: 635849.9556; train_gene_expr_recon_loss: 42332421.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44846285.3435; train_optim_loss: 44846285.3435; val_kl_reg_loss: 57083.9117; val_edge_recon_loss: 1879379.7417; val_cat_covariates_contrastive_loss: 635371.9833; val_gene_expr_recon_loss: 42737677.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45309512.8000; val_optim_loss: 45309512.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9547; val_auprc_score: 0.9693; val_best_acc_score: 0.9197; val_best_f1_score: 0.9411; train_kl_reg_loss: 54710.0970; train_edge_recon_loss: 1818187.0620; train_cat_covariates_contrastive_loss: 636874.5773; train_gene_expr_recon_loss: 42106856.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44616628.0611; train_optim_loss: 44616628.0611; val_kl_reg_loss: 54416.0604; val_edge_recon_loss: 1820898.3000; val_cat_covariates_contrastive_loss: 633623.1000; val_gene_expr_recon_loss: 42399529.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44908466.4000; val_optim_loss: 44908466.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9627; val_auprc_score: 0.9756; val_best_acc_score: 0.9232; val_best_f1_score: 0.9434; train_kl_reg_loss: 53224.1175; train_edge_recon_loss: 1817082.1956; train_cat_covariates_contrastive_loss: 635841.1994; train_gene_expr_recon_loss: 41883275.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44389422.8702; train_optim_loss: 44389422.8702; val_kl_reg_loss: 52318.2521; val_edge_recon_loss: 1802727.3417; val_cat_covariates_contrastive_loss: 635688.2083; val_gene_expr_recon_loss: 42261066.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44751800.5333; val_optim_loss: 44751800.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9631; val_auprc_score: 0.9774; val_best_acc_score: 0.9253; val_best_f1_score: 0.9458; train_kl_reg_loss: 50977.8894; train_edge_recon_loss: 1824698.0162; train_cat_covariates_contrastive_loss: 635648.5973; train_gene_expr_recon_loss: 41664035.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44175359.6947; train_optim_loss: 44175359.6947; val_kl_reg_loss: 49853.5495; val_edge_recon_loss: 1794090.5917; val_cat_covariates_contrastive_loss: 637375.9958; val_gene_expr_recon_loss: 42001226.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44482546.6667; val_optim_loss: 44482546.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9630; val_auprc_score: 0.9757; val_best_acc_score: 0.9273; val_best_f1_score: 0.9473; train_kl_reg_loss: 48720.4497; train_edge_recon_loss: 1803775.2052; train_cat_covariates_contrastive_loss: 635567.6722; train_gene_expr_recon_loss: 41481803.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43969867.0840; train_optim_loss: 43969867.0840; val_kl_reg_loss: 47770.7440; val_edge_recon_loss: 1774342.4333; val_cat_covariates_contrastive_loss: 634471.7125; val_gene_expr_recon_loss: 41780170.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44236756.0000; val_optim_loss: 44236756.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9606; val_auprc_score: 0.9751; val_best_acc_score: 0.9246; val_best_f1_score: 0.9455; train_kl_reg_loss: 47006.5059; train_edge_recon_loss: 1803667.0153; train_cat_covariates_contrastive_loss: 635821.1942; train_gene_expr_recon_loss: 41289916.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43776411.4809; train_optim_loss: 43776411.4809; val_kl_reg_loss: 46549.4214; val_edge_recon_loss: 1805451.9833; val_cat_covariates_contrastive_loss: 635293.5833; val_gene_expr_recon_loss: 41720345.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44207640.0000; val_optim_loss: 44207640.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9638; val_auprc_score: 0.9760; val_best_acc_score: 0.9287; val_best_f1_score: 0.9480; train_kl_reg_loss: 45123.1489; train_edge_recon_loss: 1793185.2901; train_cat_covariates_contrastive_loss: 635450.7906; train_gene_expr_recon_loss: 41128483.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43602242.9313; train_optim_loss: 43602242.9313; val_kl_reg_loss: 44246.0630; val_edge_recon_loss: 1814135.8833; val_cat_covariates_contrastive_loss: 635936.3917; val_gene_expr_recon_loss: 41629369.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44123688.2667; val_optim_loss: 44123688.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9626; val_auprc_score: 0.9755; val_best_acc_score: 0.9266; val_best_f1_score: 0.9464; train_kl_reg_loss: 43102.7643; train_edge_recon_loss: 1800406.5391; train_cat_covariates_contrastive_loss: 635896.2724; train_gene_expr_recon_loss: 40928150.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43407555.9695; train_optim_loss: 43407555.9695; val_kl_reg_loss: 42511.0091; val_edge_recon_loss: 1836746.3833; val_cat_covariates_contrastive_loss: 636099.6958; val_gene_expr_recon_loss: 41308328.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43823686.1333; val_optim_loss: 43823686.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9686; val_auprc_score: 0.9789; val_best_acc_score: 0.9328; val_best_f1_score: 0.9506; train_kl_reg_loss: 41844.2562; train_edge_recon_loss: 1793090.6756; train_cat_covariates_contrastive_loss: 635521.2400; train_gene_expr_recon_loss: 40778337.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43248793.2214; train_optim_loss: 43248793.2214; val_kl_reg_loss: 41469.0406; val_edge_recon_loss: 1799432.8083; val_cat_covariates_contrastive_loss: 634671.7542; val_gene_expr_recon_loss: 40895179.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43370753.3333; val_optim_loss: 43370753.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9651; val_auprc_score: 0.9762; val_best_acc_score: 0.9303; val_best_f1_score: 0.9497; train_kl_reg_loss: 40577.4221; train_edge_recon_loss: 1769874.5906; train_cat_covariates_contrastive_loss: 635611.2524; train_gene_expr_recon_loss: 40598031.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43044095.2366; train_optim_loss: 43044095.2366; val_kl_reg_loss: 40510.5911; val_edge_recon_loss: 1786781.6917; val_cat_covariates_contrastive_loss: 636935.4125; val_gene_expr_recon_loss: 41025886.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43490113.8667; val_optim_loss: 43490113.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9678; val_auprc_score: 0.9797; val_best_acc_score: 0.9339; val_best_f1_score: 0.9523; train_kl_reg_loss: 39557.9194; train_edge_recon_loss: 1795191.3149; train_cat_covariates_contrastive_loss: 635322.2968; train_gene_expr_recon_loss: 40449135.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42919206.6260; train_optim_loss: 42919206.6260; val_kl_reg_loss: 39465.0008; val_edge_recon_loss: 1757990.1167; val_cat_covariates_contrastive_loss: 638619.9167; val_gene_expr_recon_loss: 40836657.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43272732.2667; val_optim_loss: 43272732.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9613; val_auprc_score: 0.9736; val_best_acc_score: 0.9297; val_best_f1_score: 0.9493; train_kl_reg_loss: 38525.0588; train_edge_recon_loss: 1778917.4408; train_cat_covariates_contrastive_loss: 635618.6951; train_gene_expr_recon_loss: 40294513.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42747575.1450; train_optim_loss: 42747575.1450; val_kl_reg_loss: 38456.0268; val_edge_recon_loss: 1775989.6833; val_cat_covariates_contrastive_loss: 635231.3583; val_gene_expr_recon_loss: 40591056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43040733.0667; val_optim_loss: 43040733.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9600; val_auprc_score: 0.9735; val_best_acc_score: 0.9266; val_best_f1_score: 0.9466; train_kl_reg_loss: 37356.0274; train_edge_recon_loss: 1776930.3855; train_cat_covariates_contrastive_loss: 634635.5897; train_gene_expr_recon_loss: 40181700.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42630622.1069; train_optim_loss: 42630622.1069; val_kl_reg_loss: 36587.5750; val_edge_recon_loss: 1817947.1583; val_cat_covariates_contrastive_loss: 633183.6042; val_gene_expr_recon_loss: 40613475.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43101193.6000; val_optim_loss: 43101193.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9694; val_auprc_score: 0.9783; val_best_acc_score: 0.9375; val_best_f1_score: 0.9542; train_kl_reg_loss: 36318.7879; train_edge_recon_loss: 1767500.8168; train_cat_covariates_contrastive_loss: 635786.3640; train_gene_expr_recon_loss: 40074932.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42514538.4733; train_optim_loss: 42514538.4733; val_kl_reg_loss: 35874.8685; val_edge_recon_loss: 1795601.7833; val_cat_covariates_contrastive_loss: 634966.1917; val_gene_expr_recon_loss: 40552235.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43018677.8667; val_optim_loss: 43018677.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9592; val_auprc_score: 0.9696; val_best_acc_score: 0.9337; val_best_f1_score: 0.9515; train_kl_reg_loss: 35343.1051; train_edge_recon_loss: 1768212.2366; train_cat_covariates_contrastive_loss: 634837.6660; train_gene_expr_recon_loss: 39951592.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42389985.8931; train_optim_loss: 42389985.8931; val_kl_reg_loss: 35152.2591; val_edge_recon_loss: 1797256.4250; val_cat_covariates_contrastive_loss: 634442.7583; val_gene_expr_recon_loss: 40354526.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42821377.8667; val_optim_loss: 42821377.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9640; val_auprc_score: 0.9760; val_best_acc_score: 0.9368; val_best_f1_score: 0.9539; train_kl_reg_loss: 34187.6643; train_edge_recon_loss: 1776194.6947; train_cat_covariates_contrastive_loss: 635128.0429; train_gene_expr_recon_loss: 39938909.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42384420.3664; train_optim_loss: 42384420.3664; val_kl_reg_loss: 34861.0516; val_edge_recon_loss: 1788976.4333; val_cat_covariates_contrastive_loss: 635607.3083; val_gene_expr_recon_loss: 40166184.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42625629.3333; val_optim_loss: 42625629.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9648; val_auprc_score: 0.9756; val_best_acc_score: 0.9361; val_best_f1_score: 0.9531; train_kl_reg_loss: 34082.9975; train_edge_recon_loss: 1767934.4179; train_cat_covariates_contrastive_loss: 634269.6617; train_gene_expr_recon_loss: 39754821.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42191108.9466; train_optim_loss: 42191108.9466; val_kl_reg_loss: 34150.1099; val_edge_recon_loss: 1789423.4500; val_cat_covariates_contrastive_loss: 631661.0125; val_gene_expr_recon_loss: 40261655.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42716890.1333; val_optim_loss: 42716890.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9558; val_auprc_score: 0.9692; val_best_acc_score: 0.9315; val_best_f1_score: 0.9509; train_kl_reg_loss: 33310.4656; train_edge_recon_loss: 1761123.2920; train_cat_covariates_contrastive_loss: 635796.4031; train_gene_expr_recon_loss: 39691340.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42121570.5038; train_optim_loss: 42121570.5038; val_kl_reg_loss: 32939.1911; val_edge_recon_loss: 1773781.7167; val_cat_covariates_contrastive_loss: 632369.9083; val_gene_expr_recon_loss: 39883289.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42322380.0000; val_optim_loss: 42322380.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9682; val_auprc_score: 0.9775; val_best_acc_score: 0.9414; val_best_f1_score: 0.9576; train_kl_reg_loss: 32361.8400; train_edge_recon_loss: 1753807.9094; train_cat_covariates_contrastive_loss: 634943.3469; train_gene_expr_recon_loss: 39602577.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42023691.0229; train_optim_loss: 42023691.0229; val_kl_reg_loss: 32116.4941; val_edge_recon_loss: 1737586.8250; val_cat_covariates_contrastive_loss: 633059.7125; val_gene_expr_recon_loss: 40237777.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42640540.8000; val_optim_loss: 42640540.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9625; val_auprc_score: 0.9734; val_best_acc_score: 0.9367; val_best_f1_score: 0.9539; train_kl_reg_loss: 31589.8464; train_edge_recon_loss: 1754621.1336; train_cat_covariates_contrastive_loss: 635510.1112; train_gene_expr_recon_loss: 39530005.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41951726.4122; train_optim_loss: 41951726.4122; val_kl_reg_loss: 31670.3802; val_edge_recon_loss: 1788347.9667; val_cat_covariates_contrastive_loss: 633524.3500; val_gene_expr_recon_loss: 40120539.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42574082.1333; val_optim_loss: 42574082.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9680; val_auprc_score: 0.9783; val_best_acc_score: 0.9365; val_best_f1_score: 0.9545; train_kl_reg_loss: 30698.5002; train_edge_recon_loss: 1772041.7490; train_cat_covariates_contrastive_loss: 634193.9218; train_gene_expr_recon_loss: 39455251.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41892185.9847; train_optim_loss: 41892185.9847; val_kl_reg_loss: 30852.7486; val_edge_recon_loss: 1749218.2500; val_cat_covariates_contrastive_loss: 634003.2458; val_gene_expr_recon_loss: 39975657.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42389730.6667; val_optim_loss: 42389730.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9632; val_auprc_score: 0.9758; val_best_acc_score: 0.9360; val_best_f1_score: 0.9536; train_kl_reg_loss: 30121.8919; train_edge_recon_loss: 1759677.1594; train_cat_covariates_contrastive_loss: 635332.8798; train_gene_expr_recon_loss: 39352190.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41777322.4122; train_optim_loss: 41777322.4122; val_kl_reg_loss: 30222.8743; val_edge_recon_loss: 1779738.9167; val_cat_covariates_contrastive_loss: 635534.3083; val_gene_expr_recon_loss: 39889670.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42335166.6667; val_optim_loss: 42335166.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9709; val_auprc_score: 0.9800; val_best_acc_score: 0.9434; val_best_f1_score: 0.9590; train_kl_reg_loss: 29940.0830; train_edge_recon_loss: 1767296.3979; train_cat_covariates_contrastive_loss: 633839.2071; train_gene_expr_recon_loss: 39311743.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41742819.4809; train_optim_loss: 41742819.4809; val_kl_reg_loss: 30035.1749; val_edge_recon_loss: 1740169.3250; val_cat_covariates_contrastive_loss: 638433.8333; val_gene_expr_recon_loss: 39671778.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42080416.5333; val_optim_loss: 42080416.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9673; val_auprc_score: 0.9767; val_best_acc_score: 0.9432; val_best_f1_score: 0.9590; train_kl_reg_loss: 29945.8011; train_edge_recon_loss: 1757793.8120; train_cat_covariates_contrastive_loss: 634045.9456; train_gene_expr_recon_loss: 39323122.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41744908.3359; train_optim_loss: 41744908.3359; val_kl_reg_loss: 30139.4979; val_edge_recon_loss: 1758053.5917; val_cat_covariates_contrastive_loss: 632915.1000; val_gene_expr_recon_loss: 39755206.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42176315.4667; val_optim_loss: 42176315.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9633; val_auprc_score: 0.9743; val_best_acc_score: 0.9415; val_best_f1_score: 0.9575; train_kl_reg_loss: 29905.2412; train_edge_recon_loss: 1760171.6641; train_cat_covariates_contrastive_loss: 633869.7304; train_gene_expr_recon_loss: 39296187.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41720134.2290; train_optim_loss: 41720134.2290; val_kl_reg_loss: 30060.9776; val_edge_recon_loss: 1762054.3500; val_cat_covariates_contrastive_loss: 633789.0375; val_gene_expr_recon_loss: 39867104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42293008.2667; val_optim_loss: 42293008.2667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9665; val_auprc_score: 0.9743; val_best_acc_score: 0.9430; val_best_f1_score: 0.9585; train_kl_reg_loss: 29824.6761; train_edge_recon_loss: 1751506.8139; train_cat_covariates_contrastive_loss: 634319.9318; train_gene_expr_recon_loss: 39302677.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41718328.2748; train_optim_loss: 41718328.2748; val_kl_reg_loss: 30013.6258; val_edge_recon_loss: 1748146.8167; val_cat_covariates_contrastive_loss: 634153.8667; val_gene_expr_recon_loss: 39578983.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41991298.1333; val_optim_loss: 41991298.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9640; val_auprc_score: 0.9748; val_best_acc_score: 0.9403; val_best_f1_score: 0.9568; train_kl_reg_loss: 29809.0274; train_edge_recon_loss: 1758555.1489; train_cat_covariates_contrastive_loss: 633788.8674; train_gene_expr_recon_loss: 39305180.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41727333.6183; train_optim_loss: 41727333.6183; val_kl_reg_loss: 30058.2510; val_edge_recon_loss: 1768014.9833; val_cat_covariates_contrastive_loss: 634003.8417; val_gene_expr_recon_loss: 39705688.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42137765.8667; val_optim_loss: 42137765.8667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9669; val_auprc_score: 0.9782; val_best_acc_score: 0.9424; val_best_f1_score: 0.9581; train_kl_reg_loss: 29763.0946; train_edge_recon_loss: 1766692.4771; train_cat_covariates_contrastive_loss: 635384.3316; train_gene_expr_recon_loss: 39300349.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41732189.2519; train_optim_loss: 41732189.2519; val_kl_reg_loss: 29810.8951; val_edge_recon_loss: 1756008.9750; val_cat_covariates_contrastive_loss: 635870.5708; val_gene_expr_recon_loss: 39835233.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42256923.7333; val_optim_loss: 42256923.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9677; val_auprc_score: 0.9758; val_best_acc_score: 0.9458; val_best_f1_score: 0.9603; train_kl_reg_loss: 29768.5057; train_edge_recon_loss: 1781596.2634; train_cat_covariates_contrastive_loss: 633949.9971; train_gene_expr_recon_loss: 39289903.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41735218.0763; train_optim_loss: 41735218.0763; val_kl_reg_loss: 29758.0773; val_edge_recon_loss: 1774888.3500; val_cat_covariates_contrastive_loss: 635662.4917; val_gene_expr_recon_loss: 39562935.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42003244.2667; val_optim_loss: 42003244.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9633; val_auprc_score: 0.9728; val_best_acc_score: 0.9395; val_best_f1_score: 0.9564; train_kl_reg_loss: 29649.1291; train_edge_recon_loss: 1757501.6727; train_cat_covariates_contrastive_loss: 634831.2829; train_gene_expr_recon_loss: 39274998.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41696980.7939; train_optim_loss: 41696980.7939; val_kl_reg_loss: 29906.8842; val_edge_recon_loss: 1753175.6417; val_cat_covariates_contrastive_loss: 635667.7708; val_gene_expr_recon_loss: 39840622.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42259373.0667; val_optim_loss: 42259373.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9652; val_auprc_score: 0.9758; val_best_acc_score: 0.9438; val_best_f1_score: 0.9591; train_kl_reg_loss: 29639.7460; train_edge_recon_loss: 1752392.4017; train_cat_covariates_contrastive_loss: 636157.7295; train_gene_expr_recon_loss: 39254581.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41672771.8473; train_optim_loss: 41672771.8473; val_kl_reg_loss: 29747.4720; val_edge_recon_loss: 1751578.4250; val_cat_covariates_contrastive_loss: 633965.7417; val_gene_expr_recon_loss: 39549690.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41964982.1333; val_optim_loss: 41964982.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9637; val_auprc_score: 0.9740; val_best_acc_score: 0.9410; val_best_f1_score: 0.9572; train_kl_reg_loss: 29638.6277; train_edge_recon_loss: 1748389.6689; train_cat_covariates_contrastive_loss: 634557.0677; train_gene_expr_recon_loss: 39264502.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41677087.5420; train_optim_loss: 41677087.5420; val_kl_reg_loss: 29827.0687; val_edge_recon_loss: 1757470.7000; val_cat_covariates_contrastive_loss: 633730.7667; val_gene_expr_recon_loss: 39718041.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42139069.6000; val_optim_loss: 42139069.6000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9634; val_auprc_score: 0.9741; val_best_acc_score: 0.9393; val_best_f1_score: 0.9561; train_kl_reg_loss: 29629.4048; train_edge_recon_loss: 1757803.8712; train_cat_covariates_contrastive_loss: 634080.8946; train_gene_expr_recon_loss: 39264419.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41685933.4046; train_optim_loss: 41685933.4046; val_kl_reg_loss: 29802.8414; val_edge_recon_loss: 1776621.5083; val_cat_covariates_contrastive_loss: 632950.5750; val_gene_expr_recon_loss: 39642169.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42081543.7333; val_optim_loss: 42081543.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9648; val_auprc_score: 0.9745; val_best_acc_score: 0.9436; val_best_f1_score: 0.9587; train_kl_reg_loss: 29611.6890; train_edge_recon_loss: 1753697.3101; train_cat_covariates_contrastive_loss: 635088.6522; train_gene_expr_recon_loss: 39276619.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41695017.0992; train_optim_loss: 41695017.0992; val_kl_reg_loss: 29728.2648; val_edge_recon_loss: 1777213.3750; val_cat_covariates_contrastive_loss: 635211.7500; val_gene_expr_recon_loss: 39636528.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42078682.4000; val_optim_loss: 42078682.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9676; val_auprc_score: 0.9764; val_best_acc_score: 0.9429; val_best_f1_score: 0.9586; train_kl_reg_loss: 29648.1224; train_edge_recon_loss: 1757675.7891; train_cat_covariates_contrastive_loss: 634263.6298; train_gene_expr_recon_loss: 39265415.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41687002.8702; train_optim_loss: 41687002.8702; val_kl_reg_loss: 29893.7913; val_edge_recon_loss: 1746109.0250; val_cat_covariates_contrastive_loss: 637044.4292; val_gene_expr_recon_loss: 39774166.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42187213.8667; val_optim_loss: 42187213.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9617; val_auprc_score: 0.9707; val_best_acc_score: 0.9358; val_best_f1_score: 0.9536; train_kl_reg_loss: 29658.5886; train_edge_recon_loss: 1748379.5248; train_cat_covariates_contrastive_loss: 635295.9800; train_gene_expr_recon_loss: 39230297.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41643632.0305; train_optim_loss: 41643632.0305; val_kl_reg_loss: 29837.8203; val_edge_recon_loss: 1786777.6583; val_cat_covariates_contrastive_loss: 633567.8708; val_gene_expr_recon_loss: 39724517.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42174700.5333; val_optim_loss: 42174700.5333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9674; val_auprc_score: 0.9787; val_best_acc_score: 0.9405; val_best_f1_score: 0.9570; train_kl_reg_loss: 29676.4284; train_edge_recon_loss: 1755994.5219; train_cat_covariates_contrastive_loss: 635092.8330; train_gene_expr_recon_loss: 39246381.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41667145.2519; train_optim_loss: 41667145.2519; val_kl_reg_loss: 29799.6799; val_edge_recon_loss: 1733167.1083; val_cat_covariates_contrastive_loss: 635520.3500; val_gene_expr_recon_loss: 39511572.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41910059.4667; val_optim_loss: 41910059.4667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9660; val_auprc_score: 0.9743; val_best_acc_score: 0.9410; val_best_f1_score: 0.9573; train_kl_reg_loss: 29648.6441; train_edge_recon_loss: 1748348.4637; train_cat_covariates_contrastive_loss: 635679.6503; train_gene_expr_recon_loss: 39230201.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41643878.3206; train_optim_loss: 41643878.3206; val_kl_reg_loss: 29810.2923; val_edge_recon_loss: 1775714.8833; val_cat_covariates_contrastive_loss: 637018.0000; val_gene_expr_recon_loss: 39739976.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42182519.2000; val_optim_loss: 42182519.2000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9652; val_auprc_score: 0.9734; val_best_acc_score: 0.9430; val_best_f1_score: 0.9590; train_kl_reg_loss: 29639.2074; train_edge_recon_loss: 1754840.3893; train_cat_covariates_contrastive_loss: 634294.2538; train_gene_expr_recon_loss: 39237889.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41656662.9618; train_optim_loss: 41656662.9618; val_kl_reg_loss: 29777.2047; val_edge_recon_loss: 1741870.0333; val_cat_covariates_contrastive_loss: 636403.9667; val_gene_expr_recon_loss: 39719252.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42127303.4667; val_optim_loss: 42127303.4667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9687; val_auprc_score: 0.9781; val_best_acc_score: 0.9434; val_best_f1_score: 0.9589; train_kl_reg_loss: 29612.3609; train_edge_recon_loss: 1764810.8235; train_cat_covariates_contrastive_loss: 633839.3764; train_gene_expr_recon_loss: 39258874.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41687136.5191; train_optim_loss: 41687136.5191; val_kl_reg_loss: 29786.4217; val_edge_recon_loss: 1768152.3000; val_cat_covariates_contrastive_loss: 635827.9250; val_gene_expr_recon_loss: 39834057.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42267823.7333; val_optim_loss: 42267823.7333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9657; val_auprc_score: 0.9770; val_best_acc_score: 0.9437; val_best_f1_score: 0.9590; train_kl_reg_loss: 29619.1564; train_edge_recon_loss: 1761119.5248; train_cat_covariates_contrastive_loss: 634428.2944; train_gene_expr_recon_loss: 39266225.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41691392.0305; train_optim_loss: 41691392.0305; val_kl_reg_loss: 29839.6040; val_edge_recon_loss: 1761053.0167; val_cat_covariates_contrastive_loss: 633864.2333; val_gene_expr_recon_loss: 39706621.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42131378.6667; val_optim_loss: 42131378.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9697; val_auprc_score: 0.9803; val_best_acc_score: 0.9414; val_best_f1_score: 0.9576; train_kl_reg_loss: 29620.9457; train_edge_recon_loss: 1751391.7786; train_cat_covariates_contrastive_loss: 634039.4604; train_gene_expr_recon_loss: 39250890.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41665943.0229; train_optim_loss: 41665943.0229; val_kl_reg_loss: 29799.0322; val_edge_recon_loss: 1752449.5250; val_cat_covariates_contrastive_loss: 635332.3792; val_gene_expr_recon_loss: 39815086.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42232667.7333; val_optim_loss: 42232667.7333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9652; val_auprc_score: 0.9748; val_best_acc_score: 0.9417; val_best_f1_score: 0.9576; train_kl_reg_loss: 29610.5617; train_edge_recon_loss: 1754441.7300; train_cat_covariates_contrastive_loss: 634270.6818; train_gene_expr_recon_loss: 39258789.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41677112.7328; train_optim_loss: 41677112.7328; val_kl_reg_loss: 29714.6102; val_edge_recon_loss: 1794000.4333; val_cat_covariates_contrastive_loss: 633051.9875; val_gene_expr_recon_loss: 39715886.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42172653.6000; val_optim_loss: 42172653.6000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9630; val_auprc_score: 0.9702; val_best_acc_score: 0.9397; val_best_f1_score: 0.9564; train_kl_reg_loss: 29613.5937; train_edge_recon_loss: 1753439.3158; train_cat_covariates_contrastive_loss: 633665.2257; train_gene_expr_recon_loss: 39257912.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41674631.0840; train_optim_loss: 41674631.0840; val_kl_reg_loss: 29846.4831; val_edge_recon_loss: 1771325.5917; val_cat_covariates_contrastive_loss: 637145.8500; val_gene_expr_recon_loss: 39804366.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42242685.3333; val_optim_loss: 42242685.3333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9631; val_auprc_score: 0.9736; val_best_acc_score: 0.9389; val_best_f1_score: 0.9557; train_kl_reg_loss: 29628.3916; train_edge_recon_loss: 1753819.1679; train_cat_covariates_contrastive_loss: 634791.3712; train_gene_expr_recon_loss: 39255944.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41674183.7252; train_optim_loss: 41674183.7252; val_kl_reg_loss: 29838.6865; val_edge_recon_loss: 1772485.3417; val_cat_covariates_contrastive_loss: 638136.9125; val_gene_expr_recon_loss: 39771539.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42212001.0667; val_optim_loss: 42212001.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 55 min 37 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9561
val AUPRC score: 0.9675
val best accuracy score: 0.9368
val best F1 score: 0.9541
val target rna MSE score: 284.9136
val source rna MSE score: 54.0532
Val cat covariate0 mean sim diff: -0.0022
Val cat covariate1 mean sim diff: -0.0379
Duration of model training in run 2: 0 hours, 55 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
