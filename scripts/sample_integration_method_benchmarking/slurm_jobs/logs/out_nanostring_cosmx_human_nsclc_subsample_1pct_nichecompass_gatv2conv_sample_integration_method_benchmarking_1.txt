Run timestamp: 31082023_220604_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7556; val_auprc_score: 0.8987; val_best_acc_score: 0.7831; val_best_f1_score: 0.8703; train_kl_reg_loss: 7517.1137; train_edge_recon_loss: 1712109.7228; train_cat_covariates_contrastive_loss: 694769.0462; train_gene_expr_recon_loss: 3039384.4728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5453780.3424; train_optim_loss: 5453780.3424; val_kl_reg_loss: 14036.4074; val_edge_recon_loss: 1648151.3295; val_cat_covariates_contrastive_loss: 626956.0227; val_gene_expr_recon_loss: 2607249.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4896393.4545; val_optim_loss: 4896393.4545
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8109; val_auprc_score: 0.9219; val_best_acc_score: 0.8091; val_best_f1_score: 0.8828; train_kl_reg_loss: 11348.8643; train_edge_recon_loss: 1555929.3478; train_cat_covariates_contrastive_loss: 632309.4823; train_gene_expr_recon_loss: 2652820.3342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4852408.0380; train_optim_loss: 4852408.0380; val_kl_reg_loss: 9822.4031; val_edge_recon_loss: 1541270.9659; val_cat_covariates_contrastive_loss: 627202.4205; val_gene_expr_recon_loss: 2557193.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4735489.7273; val_optim_loss: 4735489.7273
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8531; val_auprc_score: 0.9354; val_best_acc_score: 0.8484; val_best_f1_score: 0.9041; train_kl_reg_loss: 11293.4080; train_edge_recon_loss: 1486765.5774; train_cat_covariates_contrastive_loss: 634411.2323; train_gene_expr_recon_loss: 2589612.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722082.6576; train_optim_loss: 4722082.6576; val_kl_reg_loss: 12266.2178; val_edge_recon_loss: 1444097.0909; val_cat_covariates_contrastive_loss: 632270.9943; val_gene_expr_recon_loss: 2565045.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4653679.8636; val_optim_loss: 4653679.8636
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8593; val_auprc_score: 0.9354; val_best_acc_score: 0.8595; val_best_f1_score: 0.9110; train_kl_reg_loss: 11668.3557; train_edge_recon_loss: 1400515.0639; train_cat_covariates_contrastive_loss: 632208.2072; train_gene_expr_recon_loss: 2551307.0761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4595698.6793; train_optim_loss: 4595698.6793; val_kl_reg_loss: 11303.8994; val_edge_recon_loss: 1429295.0909; val_cat_covariates_contrastive_loss: 633870.6591; val_gene_expr_recon_loss: 2464660.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4539130.0909; val_optim_loss: 4539130.0909
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8630; val_auprc_score: 0.9383; val_best_acc_score: 0.8665; val_best_f1_score: 0.9156; train_kl_reg_loss: 10930.2137; train_edge_recon_loss: 1388769.6793; train_cat_covariates_contrastive_loss: 631960.2568; train_gene_expr_recon_loss: 2520566.1630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4552226.2935; train_optim_loss: 4552226.2935; val_kl_reg_loss: 11065.2255; val_edge_recon_loss: 1369495.4716; val_cat_covariates_contrastive_loss: 628920.9773; val_gene_expr_recon_loss: 2548506.0227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4557987.7273; val_optim_loss: 4557987.7273
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9015; val_auprc_score: 0.9525; val_best_acc_score: 0.8925; val_best_f1_score: 0.9304; train_kl_reg_loss: 10594.9268; train_edge_recon_loss: 1362656.5598; train_cat_covariates_contrastive_loss: 630420.1236; train_gene_expr_recon_loss: 2503392.5217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4507064.1196; train_optim_loss: 4507064.1196; val_kl_reg_loss: 10168.0353; val_edge_recon_loss: 1346313.5682; val_cat_covariates_contrastive_loss: 631124.4886; val_gene_expr_recon_loss: 2477626.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4465233.0909; val_optim_loss: 4465233.0909
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8946; val_auprc_score: 0.9480; val_best_acc_score: 0.8905; val_best_f1_score: 0.9299; train_kl_reg_loss: 10132.7205; train_edge_recon_loss: 1350938.1440; train_cat_covariates_contrastive_loss: 630194.8098; train_gene_expr_recon_loss: 2484259.7011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4475525.3505; train_optim_loss: 4475525.3505; val_kl_reg_loss: 9843.7683; val_edge_recon_loss: 1348911.4432; val_cat_covariates_contrastive_loss: 628515.8239; val_gene_expr_recon_loss: 2445022.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4432293.0682; val_optim_loss: 4432293.0682
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9022; val_auprc_score: 0.9505; val_best_acc_score: 0.8973; val_best_f1_score: 0.9350; train_kl_reg_loss: 9908.5469; train_edge_recon_loss: 1378436.3560; train_cat_covariates_contrastive_loss: 630566.3879; train_gene_expr_recon_loss: 2464098.2772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4483009.5543; train_optim_loss: 4483009.5543; val_kl_reg_loss: 10041.1084; val_edge_recon_loss: 1316298.3636; val_cat_covariates_contrastive_loss: 628678.2216; val_gene_expr_recon_loss: 2412939.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4367957.6136; val_optim_loss: 4367957.6136
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8970; val_auprc_score: 0.9493; val_best_acc_score: 0.9014; val_best_f1_score: 0.9360; train_kl_reg_loss: 9897.8156; train_edge_recon_loss: 1366502.3342; train_cat_covariates_contrastive_loss: 629549.1698; train_gene_expr_recon_loss: 2441453.3098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4447402.6060; train_optim_loss: 4447402.6060; val_kl_reg_loss: 10025.8072; val_edge_recon_loss: 1353307.6023; val_cat_covariates_contrastive_loss: 632692.5966; val_gene_expr_recon_loss: 2473484.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4469510.7500; val_optim_loss: 4469510.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8932; val_auprc_score: 0.9461; val_best_acc_score: 0.9057; val_best_f1_score: 0.9392; train_kl_reg_loss: 9833.3314; train_edge_recon_loss: 1355952.0734; train_cat_covariates_contrastive_loss: 630163.6162; train_gene_expr_recon_loss: 2432300.5082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428249.5380; train_optim_loss: 4428249.5380; val_kl_reg_loss: 9674.1788; val_edge_recon_loss: 1347030.6932; val_cat_covariates_contrastive_loss: 628686.4205; val_gene_expr_recon_loss: 2352271.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4337663.1818; val_optim_loss: 4337663.1818
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9031; val_auprc_score: 0.9496; val_best_acc_score: 0.9079; val_best_f1_score: 0.9404; train_kl_reg_loss: 9940.3024; train_edge_recon_loss: 1349856.6766; train_cat_covariates_contrastive_loss: 630787.7405; train_gene_expr_recon_loss: 2411809.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4402394.0761; train_optim_loss: 4402394.0761; val_kl_reg_loss: 9404.4764; val_edge_recon_loss: 1333256.0227; val_cat_covariates_contrastive_loss: 628926.1591; val_gene_expr_recon_loss: 2373057.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4344643.8182; val_optim_loss: 4344643.8182
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8960; val_auprc_score: 0.9454; val_best_acc_score: 0.9024; val_best_f1_score: 0.9370; train_kl_reg_loss: 9925.1414; train_edge_recon_loss: 1343346.8750; train_cat_covariates_contrastive_loss: 630966.1372; train_gene_expr_recon_loss: 2404708.8940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4388947.0489; train_optim_loss: 4388947.0489; val_kl_reg_loss: 10060.2303; val_edge_recon_loss: 1402400.7159; val_cat_covariates_contrastive_loss: 633472.5682; val_gene_expr_recon_loss: 2367974.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4413907.4545; val_optim_loss: 4413907.4545
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8973; val_auprc_score: 0.9463; val_best_acc_score: 0.9115; val_best_f1_score: 0.9429; train_kl_reg_loss: 9984.8628; train_edge_recon_loss: 1345147.1916; train_cat_covariates_contrastive_loss: 630888.6087; train_gene_expr_recon_loss: 2390405.9049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4376426.5598; train_optim_loss: 4376426.5598; val_kl_reg_loss: 9916.4660; val_edge_recon_loss: 1335047.3523; val_cat_covariates_contrastive_loss: 629995.8466; val_gene_expr_recon_loss: 2319872.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4294831.8409; val_optim_loss: 4294831.8409
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9027; val_auprc_score: 0.9543; val_best_acc_score: 0.9126; val_best_f1_score: 0.9449; train_kl_reg_loss: 10019.5476; train_edge_recon_loss: 1350581.8478; train_cat_covariates_contrastive_loss: 630189.6277; train_gene_expr_recon_loss: 2377143.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4367934.7174; train_optim_loss: 4367934.7174; val_kl_reg_loss: 9836.3698; val_edge_recon_loss: 1301964.2500; val_cat_covariates_contrastive_loss: 641254.8125; val_gene_expr_recon_loss: 2317264.1705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4270319.6364; val_optim_loss: 4270319.6364
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8996; val_auprc_score: 0.9508; val_best_acc_score: 0.9140; val_best_f1_score: 0.9451; train_kl_reg_loss: 10043.4794; train_edge_recon_loss: 1313251.0829; train_cat_covariates_contrastive_loss: 631364.0870; train_gene_expr_recon_loss: 2359906.1467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4314564.7772; train_optim_loss: 4314564.7772; val_kl_reg_loss: 9581.8107; val_edge_recon_loss: 1297361.9659; val_cat_covariates_contrastive_loss: 634096.6648; val_gene_expr_recon_loss: 2352066.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4293106.8409; val_optim_loss: 4293106.8409
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9185; val_auprc_score: 0.9548; val_best_acc_score: 0.9170; val_best_f1_score: 0.9459; train_kl_reg_loss: 9854.9939; train_edge_recon_loss: 1357142.9511; train_cat_covariates_contrastive_loss: 631652.2398; train_gene_expr_recon_loss: 2346144.5217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4344794.7120; train_optim_loss: 4344794.7120; val_kl_reg_loss: 9589.0700; val_edge_recon_loss: 1372009.7386; val_cat_covariates_contrastive_loss: 631130.6989; val_gene_expr_recon_loss: 2301025.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4313755.2273; val_optim_loss: 4313755.2273
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9177; val_auprc_score: 0.9515; val_best_acc_score: 0.9192; val_best_f1_score: 0.9465; train_kl_reg_loss: 9937.8188; train_edge_recon_loss: 1337475.6562; train_cat_covariates_contrastive_loss: 633291.6535; train_gene_expr_recon_loss: 2331821.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4312526.2364; train_optim_loss: 4312526.2364; val_kl_reg_loss: 10784.5240; val_edge_recon_loss: 1381143.2386; val_cat_covariates_contrastive_loss: 632106.3693; val_gene_expr_recon_loss: 2305252.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4329286.4091; val_optim_loss: 4329286.4091
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9228; val_auprc_score: 0.9578; val_best_acc_score: 0.9281; val_best_f1_score: 0.9537; train_kl_reg_loss: 10344.9403; train_edge_recon_loss: 1341796.0707; train_cat_covariates_contrastive_loss: 632117.5068; train_gene_expr_recon_loss: 2316642.3804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4300900.8913; train_optim_loss: 4300900.8913; val_kl_reg_loss: 10528.8018; val_edge_recon_loss: 1262717.0170; val_cat_covariates_contrastive_loss: 635068.3295; val_gene_expr_recon_loss: 2280898.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4189212.7955; val_optim_loss: 4189212.7955
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9145; val_auprc_score: 0.9477; val_best_acc_score: 0.9194; val_best_f1_score: 0.9469; train_kl_reg_loss: 10717.5399; train_edge_recon_loss: 1346405.2038; train_cat_covariates_contrastive_loss: 634274.5836; train_gene_expr_recon_loss: 2300183.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4291581.1739; train_optim_loss: 4291581.1739; val_kl_reg_loss: 10321.0579; val_edge_recon_loss: 1355727.9659; val_cat_covariates_contrastive_loss: 635070.4489; val_gene_expr_recon_loss: 2246868.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4247988.4091; val_optim_loss: 4247988.4091
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9057; val_auprc_score: 0.9454; val_best_acc_score: 0.9148; val_best_f1_score: 0.9444; train_kl_reg_loss: 10945.7485; train_edge_recon_loss: 1332801.7514; train_cat_covariates_contrastive_loss: 633526.0272; train_gene_expr_recon_loss: 2286726.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4264000.2065; train_optim_loss: 4264000.2065; val_kl_reg_loss: 11072.6377; val_edge_recon_loss: 1366788.1364; val_cat_covariates_contrastive_loss: 634433.9432; val_gene_expr_recon_loss: 2253579.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4265873.9545; val_optim_loss: 4265873.9545
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9206; val_auprc_score: 0.9552; val_best_acc_score: 0.9212; val_best_f1_score: 0.9487; train_kl_reg_loss: 11266.6162; train_edge_recon_loss: 1349270.3492; train_cat_covariates_contrastive_loss: 633843.9844; train_gene_expr_recon_loss: 2273100.2948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4267481.2473; train_optim_loss: 4267481.2473; val_kl_reg_loss: 11068.8775; val_edge_recon_loss: 1346502.9205; val_cat_covariates_contrastive_loss: 632621.8182; val_gene_expr_recon_loss: 2280661.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4270854.8182; val_optim_loss: 4270854.8182
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9032; val_auprc_score: 0.9446; val_best_acc_score: 0.9230; val_best_f1_score: 0.9504; train_kl_reg_loss: 11728.6132; train_edge_recon_loss: 1337004.4103; train_cat_covariates_contrastive_loss: 633848.6848; train_gene_expr_recon_loss: 2255330.2228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4237911.9484; train_optim_loss: 4237911.9484; val_kl_reg_loss: 11927.7839; val_edge_recon_loss: 1315809.2841; val_cat_covariates_contrastive_loss: 643093.8409; val_gene_expr_recon_loss: 2300551.4773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4271382.4091; val_optim_loss: 4271382.4091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9138; val_auprc_score: 0.9454; val_best_acc_score: 0.9250; val_best_f1_score: 0.9508; train_kl_reg_loss: 12072.8683; train_edge_recon_loss: 1338575.6345; train_cat_covariates_contrastive_loss: 632433.4266; train_gene_expr_recon_loss: 2239139.2052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4222221.1141; train_optim_loss: 4222221.1141; val_kl_reg_loss: 12572.8586; val_edge_recon_loss: 1351504.1534; val_cat_covariates_contrastive_loss: 631084.4205; val_gene_expr_recon_loss: 2285021.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4280183.3182; val_optim_loss: 4280183.3182
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9091; val_auprc_score: 0.9429; val_best_acc_score: 0.9213; val_best_f1_score: 0.9483; train_kl_reg_loss: 12307.1977; train_edge_recon_loss: 1327087.3098; train_cat_covariates_contrastive_loss: 633528.9409; train_gene_expr_recon_loss: 2234435.3573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4207358.8098; train_optim_loss: 4207358.8098; val_kl_reg_loss: 12623.6457; val_edge_recon_loss: 1382465.1932; val_cat_covariates_contrastive_loss: 632014.6648; val_gene_expr_recon_loss: 2218778.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4245882.0227; val_optim_loss: 4245882.0227
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9116; val_auprc_score: 0.9512; val_best_acc_score: 0.9230; val_best_f1_score: 0.9498; train_kl_reg_loss: 12451.3136; train_edge_recon_loss: 1328859.2160; train_cat_covariates_contrastive_loss: 633533.5720; train_gene_expr_recon_loss: 2227883.9810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4202728.1087; train_optim_loss: 4202728.1087; val_kl_reg_loss: 12560.7182; val_edge_recon_loss: 1339299.5909; val_cat_covariates_contrastive_loss: 634898.2614; val_gene_expr_recon_loss: 2293743.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4280502.0000; val_optim_loss: 4280502.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9164; val_auprc_score: 0.9521; val_best_acc_score: 0.9281; val_best_f1_score: 0.9534; train_kl_reg_loss: 12678.5793; train_edge_recon_loss: 1322628.7989; train_cat_covariates_contrastive_loss: 633933.1658; train_gene_expr_recon_loss: 2224649.3533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4193889.8967; train_optim_loss: 4193889.8967; val_kl_reg_loss: 13028.9372; val_edge_recon_loss: 1288364.0398; val_cat_covariates_contrastive_loss: 631708.4886; val_gene_expr_recon_loss: 2264266.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4197367.7955; val_optim_loss: 4197367.7955

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 51 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
val AUROC score: 0.9096
val AUPRC score: 0.9539
val best accuracy score: 0.9197
val best F1 score: 0.9485
val target rna MSE score: 0.5931
val source rna MSE score: 0.0618
Val cat covariate0 mean sim diff: 0.0031
Val cat covariate1 mean sim diff: 0.0031
Duration of model training in run 8: 0 hours, 8 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7791; val_auprc_score: 0.9082; val_best_acc_score: 0.7946; val_best_f1_score: 0.8758; train_kl_reg_loss: 8027.9883; train_edge_recon_loss: 1718458.1291; train_cat_covariates_contrastive_loss: 694579.6223; train_gene_expr_recon_loss: 3083727.7962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5504793.5109; train_optim_loss: 5504793.5109; val_kl_reg_loss: 12357.3576; val_edge_recon_loss: 1635190.5227; val_cat_covariates_contrastive_loss: 626978.0057; val_gene_expr_recon_loss: 2673490.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4948016.6364; val_optim_loss: 4948016.6364
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7965; val_auprc_score: 0.9108; val_best_acc_score: 0.8096; val_best_f1_score: 0.8833; train_kl_reg_loss: 15049.5161; train_edge_recon_loss: 1568335.4008; train_cat_covariates_contrastive_loss: 631586.2989; train_gene_expr_recon_loss: 2656199.5815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4871170.8043; train_optim_loss: 4871170.8043; val_kl_reg_loss: 14918.2926; val_edge_recon_loss: 1517998.4545; val_cat_covariates_contrastive_loss: 627175.7500; val_gene_expr_recon_loss: 2633219.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4793312.0909; val_optim_loss: 4793312.0909
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8224; val_auprc_score: 0.9214; val_best_acc_score: 0.8313; val_best_f1_score: 0.8943; train_kl_reg_loss: 13642.3945; train_edge_recon_loss: 1513477.5068; train_cat_covariates_contrastive_loss: 633771.5924; train_gene_expr_recon_loss: 2579894.1549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740785.6196; train_optim_loss: 4740785.6196; val_kl_reg_loss: 13002.9667; val_edge_recon_loss: 1481668.1818; val_cat_covariates_contrastive_loss: 628475.8239; val_gene_expr_recon_loss: 2514475.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4637622.5227; val_optim_loss: 4637622.5227
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8422; val_auprc_score: 0.9254; val_best_acc_score: 0.8486; val_best_f1_score: 0.9023; train_kl_reg_loss: 12935.7587; train_edge_recon_loss: 1456041.2432; train_cat_covariates_contrastive_loss: 632449.7901; train_gene_expr_recon_loss: 2543159.9239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4644586.6902; train_optim_loss: 4644586.6902; val_kl_reg_loss: 11517.5411; val_edge_recon_loss: 1486448.4886; val_cat_covariates_contrastive_loss: 631170.0398; val_gene_expr_recon_loss: 2491869.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4621005.6364; val_optim_loss: 4621005.6364
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8796; val_auprc_score: 0.9432; val_best_acc_score: 0.8604; val_best_f1_score: 0.9096; train_kl_reg_loss: 11420.2365; train_edge_recon_loss: 1404263.8071; train_cat_covariates_contrastive_loss: 631716.4103; train_gene_expr_recon_loss: 2516836.8804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4564237.3587; train_optim_loss: 4564237.3587; val_kl_reg_loss: 10855.0465; val_edge_recon_loss: 1461660.7614; val_cat_covariates_contrastive_loss: 636475.2330; val_gene_expr_recon_loss: 2468240.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4577231.3636; val_optim_loss: 4577231.3636
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8846; val_auprc_score: 0.9413; val_best_acc_score: 0.8788; val_best_f1_score: 0.9224; train_kl_reg_loss: 10812.1734; train_edge_recon_loss: 1375244.7595; train_cat_covariates_contrastive_loss: 632057.6114; train_gene_expr_recon_loss: 2497263.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4515377.7799; train_optim_loss: 4515377.7799; val_kl_reg_loss: 10468.6821; val_edge_recon_loss: 1360861.5000; val_cat_covariates_contrastive_loss: 632850.5568; val_gene_expr_recon_loss: 2455858.0227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4460038.7500; val_optim_loss: 4460038.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8825; val_auprc_score: 0.9398; val_best_acc_score: 0.8800; val_best_f1_score: 0.9225; train_kl_reg_loss: 10292.6839; train_edge_recon_loss: 1368141.6997; train_cat_covariates_contrastive_loss: 631769.5856; train_gene_expr_recon_loss: 2474535.3207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4484739.2717; train_optim_loss: 4484739.2717; val_kl_reg_loss: 10544.4264; val_edge_recon_loss: 1428619.0000; val_cat_covariates_contrastive_loss: 628620.2614; val_gene_expr_recon_loss: 2461206.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528990.0909; val_optim_loss: 4528990.0909
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8837; val_auprc_score: 0.9411; val_best_acc_score: 0.8941; val_best_f1_score: 0.9314; train_kl_reg_loss: 10227.5794; train_edge_recon_loss: 1369831.1182; train_cat_covariates_contrastive_loss: 631548.6332; train_gene_expr_recon_loss: 2455428.7962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4467036.1141; train_optim_loss: 4467036.1141; val_kl_reg_loss: 9707.0874; val_edge_recon_loss: 1338573.8977; val_cat_covariates_contrastive_loss: 636163.8693; val_gene_expr_recon_loss: 2469194.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4453639.3409; val_optim_loss: 4453639.3409
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8947; val_auprc_score: 0.9408; val_best_acc_score: 0.8991; val_best_f1_score: 0.9344; train_kl_reg_loss: 10075.4590; train_edge_recon_loss: 1360771.5707; train_cat_covariates_contrastive_loss: 630416.4694; train_gene_expr_recon_loss: 2436710.3179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4437973.7962; train_optim_loss: 4437973.7962; val_kl_reg_loss: 9451.5232; val_edge_recon_loss: 1372327.5568; val_cat_covariates_contrastive_loss: 631237.8920; val_gene_expr_recon_loss: 2430354.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4443371.2273; val_optim_loss: 4443371.2273
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9153; val_auprc_score: 0.9572; val_best_acc_score: 0.9074; val_best_f1_score: 0.9399; train_kl_reg_loss: 9966.9697; train_edge_recon_loss: 1355146.0652; train_cat_covariates_contrastive_loss: 631465.0027; train_gene_expr_recon_loss: 2416693.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4413271.9783; train_optim_loss: 4413271.9783; val_kl_reg_loss: 9921.5232; val_edge_recon_loss: 1374192.4432; val_cat_covariates_contrastive_loss: 631833.6250; val_gene_expr_recon_loss: 2389914.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4405862.0909; val_optim_loss: 4405862.0909
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9063; val_auprc_score: 0.9551; val_best_acc_score: 0.9009; val_best_f1_score: 0.9351; train_kl_reg_loss: 10184.4870; train_edge_recon_loss: 1352043.5489; train_cat_covariates_contrastive_loss: 631732.2677; train_gene_expr_recon_loss: 2408509.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4402469.3940; train_optim_loss: 4402469.3940; val_kl_reg_loss: 10167.1160; val_edge_recon_loss: 1345659.0341; val_cat_covariates_contrastive_loss: 632293.0284; val_gene_expr_recon_loss: 2443375.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4431494.9773; val_optim_loss: 4431494.9773
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9079; val_auprc_score: 0.9463; val_best_acc_score: 0.8985; val_best_f1_score: 0.9338; train_kl_reg_loss: 10072.0061; train_edge_recon_loss: 1350506.9565; train_cat_covariates_contrastive_loss: 631420.0591; train_gene_expr_recon_loss: 2393290.8587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4385289.8913; train_optim_loss: 4385289.8913; val_kl_reg_loss: 9932.0539; val_edge_recon_loss: 1396842.6932; val_cat_covariates_contrastive_loss: 633908.9943; val_gene_expr_recon_loss: 2349538.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4390222.7273; val_optim_loss: 4390222.7273
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9041; val_auprc_score: 0.9456; val_best_acc_score: 0.9044; val_best_f1_score: 0.9376; train_kl_reg_loss: 10048.7752; train_edge_recon_loss: 1339984.2147; train_cat_covariates_contrastive_loss: 632344.0910; train_gene_expr_recon_loss: 2375904.2147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4358281.3071; train_optim_loss: 4358281.3071; val_kl_reg_loss: 10043.9811; val_edge_recon_loss: 1423988.0227; val_cat_covariates_contrastive_loss: 631173.9830; val_gene_expr_recon_loss: 2407591.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4472797.2727; val_optim_loss: 4472797.2727
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9128; val_auprc_score: 0.9501; val_best_acc_score: 0.9078; val_best_f1_score: 0.9398; train_kl_reg_loss: 10294.6064; train_edge_recon_loss: 1320964.4124; train_cat_covariates_contrastive_loss: 632430.4389; train_gene_expr_recon_loss: 2364038.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4327727.8533; train_optim_loss: 4327727.8533; val_kl_reg_loss: 10375.7681; val_edge_recon_loss: 1353905.7045; val_cat_covariates_contrastive_loss: 632212.4773; val_gene_expr_recon_loss: 2390752.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4387246.4545; val_optim_loss: 4387246.4545
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9259; val_auprc_score: 0.9623; val_best_acc_score: 0.9128; val_best_f1_score: 0.9431; train_kl_reg_loss: 10214.4178; train_edge_recon_loss: 1324462.6264; train_cat_covariates_contrastive_loss: 632435.2412; train_gene_expr_recon_loss: 2344969.3505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4312081.6141; train_optim_loss: 4312081.6141; val_kl_reg_loss: 9902.9545; val_edge_recon_loss: 1340266.6136; val_cat_covariates_contrastive_loss: 641897.4830; val_gene_expr_recon_loss: 2389523.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4381590.5909; val_optim_loss: 4381590.5909
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9056; val_auprc_score: 0.9452; val_best_acc_score: 0.9080; val_best_f1_score: 0.9408; train_kl_reg_loss: 10340.0276; train_edge_recon_loss: 1349170.1590; train_cat_covariates_contrastive_loss: 633342.7969; train_gene_expr_recon_loss: 2331115.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4323968.1658; train_optim_loss: 4323968.1658; val_kl_reg_loss: 10264.7059; val_edge_recon_loss: 1395032.2045; val_cat_covariates_contrastive_loss: 637015.2443; val_gene_expr_recon_loss: 2319513.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4361825.7727; val_optim_loss: 4361825.7727
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8998; val_auprc_score: 0.9447; val_best_acc_score: 0.9080; val_best_f1_score: 0.9409; train_kl_reg_loss: 10663.0825; train_edge_recon_loss: 1323790.1889; train_cat_covariates_contrastive_loss: 633809.8397; train_gene_expr_recon_loss: 2318900.4402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4287163.5707; train_optim_loss: 4287163.5707; val_kl_reg_loss: 10155.0732; val_edge_recon_loss: 1327252.6136; val_cat_covariates_contrastive_loss: 632587.6250; val_gene_expr_recon_loss: 2300158.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4270153.6364; val_optim_loss: 4270153.6364
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9150; val_auprc_score: 0.9499; val_best_acc_score: 0.9157; val_best_f1_score: 0.9456; train_kl_reg_loss: 10756.2494; train_edge_recon_loss: 1335843.2541; train_cat_covariates_contrastive_loss: 633626.6039; train_gene_expr_recon_loss: 2302660.9212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4282887.0217; train_optim_loss: 4282887.0217; val_kl_reg_loss: 10714.7020; val_edge_recon_loss: 1339236.5114; val_cat_covariates_contrastive_loss: 631030.3864; val_gene_expr_recon_loss: 2283306.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4264288.3409; val_optim_loss: 4264288.3409
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9242; val_auprc_score: 0.9590; val_best_acc_score: 0.9206; val_best_f1_score: 0.9486; train_kl_reg_loss: 11162.8161; train_edge_recon_loss: 1349500.8770; train_cat_covariates_contrastive_loss: 635193.7289; train_gene_expr_recon_loss: 2289032.8913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4284890.3342; train_optim_loss: 4284890.3342; val_kl_reg_loss: 11075.8781; val_edge_recon_loss: 1303836.9545; val_cat_covariates_contrastive_loss: 633878.0966; val_gene_expr_recon_loss: 2309703.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4258494.4545; val_optim_loss: 4258494.4545
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9068; val_auprc_score: 0.9463; val_best_acc_score: 0.9157; val_best_f1_score: 0.9456; train_kl_reg_loss: 11790.9168; train_edge_recon_loss: 1326770.1698; train_cat_covariates_contrastive_loss: 633527.6929; train_gene_expr_recon_loss: 2274059.5774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4246148.3804; train_optim_loss: 4246148.3804; val_kl_reg_loss: 12575.0154; val_edge_recon_loss: 1373540.7045; val_cat_covariates_contrastive_loss: 632853.8636; val_gene_expr_recon_loss: 2242162.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4261132.5455; val_optim_loss: 4261132.5455
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9054; val_auprc_score: 0.9474; val_best_acc_score: 0.9108; val_best_f1_score: 0.9425; train_kl_reg_loss: 12146.5642; train_edge_recon_loss: 1332365.1889; train_cat_covariates_contrastive_loss: 633363.4688; train_gene_expr_recon_loss: 2253260.2962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4231135.5163; train_optim_loss: 4231135.5163; val_kl_reg_loss: 11987.5275; val_edge_recon_loss: 1377539.1364; val_cat_covariates_contrastive_loss: 635755.6364; val_gene_expr_recon_loss: 2252695.6932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4277978.0000; val_optim_loss: 4277978.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9178; val_auprc_score: 0.9537; val_best_acc_score: 0.9152; val_best_f1_score: 0.9453; train_kl_reg_loss: 12611.7148; train_edge_recon_loss: 1346137.8954; train_cat_covariates_contrastive_loss: 634563.1467; train_gene_expr_recon_loss: 2234040.9402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4227353.7092; train_optim_loss: 4227353.7092; val_kl_reg_loss: 12255.3411; val_edge_recon_loss: 1316716.4432; val_cat_covariates_contrastive_loss: 635051.8409; val_gene_expr_recon_loss: 2232438.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4196462.5000; val_optim_loss: 4196462.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9141; val_auprc_score: 0.9500; val_best_acc_score: 0.9179; val_best_f1_score: 0.9470; train_kl_reg_loss: 13024.2472; train_edge_recon_loss: 1345310.8220; train_cat_covariates_contrastive_loss: 634558.3886; train_gene_expr_recon_loss: 2222546.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4215440.3016; train_optim_loss: 4215440.3016; val_kl_reg_loss: 12988.7131; val_edge_recon_loss: 1335238.6591; val_cat_covariates_contrastive_loss: 633275.2557; val_gene_expr_recon_loss: 2250951.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4232454.4091; val_optim_loss: 4232454.4091
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9151; val_auprc_score: 0.9499; val_best_acc_score: 0.9242; val_best_f1_score: 0.9504; train_kl_reg_loss: 13637.1890; train_edge_recon_loss: 1347663.3098; train_cat_covariates_contrastive_loss: 634968.6447; train_gene_expr_recon_loss: 2205107.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4201376.5408; train_optim_loss: 4201376.5408; val_kl_reg_loss: 13924.8738; val_edge_recon_loss: 1358268.8295; val_cat_covariates_contrastive_loss: 634066.5852; val_gene_expr_recon_loss: 2316560.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4322820.3864; val_optim_loss: 4322820.3864
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9070; val_auprc_score: 0.9535; val_best_acc_score: 0.9232; val_best_f1_score: 0.9512; train_kl_reg_loss: 14285.5269; train_edge_recon_loss: 1327761.9783; train_cat_covariates_contrastive_loss: 634732.3804; train_gene_expr_recon_loss: 2184923.6019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4161703.5000; train_optim_loss: 4161703.5000; val_kl_reg_loss: 14242.6377; val_edge_recon_loss: 1249044.4205; val_cat_covariates_contrastive_loss: 643597.3068; val_gene_expr_recon_loss: 2265660.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4172544.9545; val_optim_loss: 4172544.9545
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9145; val_auprc_score: 0.9469; val_best_acc_score: 0.9225; val_best_f1_score: 0.9499; train_kl_reg_loss: 14621.8641; train_edge_recon_loss: 1337471.4504; train_cat_covariates_contrastive_loss: 635110.3213; train_gene_expr_recon_loss: 2160481.1168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4147684.7663; train_optim_loss: 4147684.7663; val_kl_reg_loss: 14954.2875; val_edge_recon_loss: 1358016.4432; val_cat_covariates_contrastive_loss: 635212.4545; val_gene_expr_recon_loss: 2198231.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4206414.3864; val_optim_loss: 4206414.3864
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9022; val_auprc_score: 0.9429; val_best_acc_score: 0.9203; val_best_f1_score: 0.9483; train_kl_reg_loss: 15659.3625; train_edge_recon_loss: 1321238.7785; train_cat_covariates_contrastive_loss: 635048.8913; train_gene_expr_recon_loss: 2143337.2908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4115284.3152; train_optim_loss: 4115284.3152; val_kl_reg_loss: 15354.9798; val_edge_recon_loss: 1354920.4205; val_cat_covariates_contrastive_loss: 646483.5227; val_gene_expr_recon_loss: 2188155.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4204914.6364; val_optim_loss: 4204914.6364
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9042; val_auprc_score: 0.9404; val_best_acc_score: 0.9189; val_best_f1_score: 0.9475; train_kl_reg_loss: 16060.6252; train_edge_recon_loss: 1347581.7120; train_cat_covariates_contrastive_loss: 636295.9334; train_gene_expr_recon_loss: 2117636.4986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4117574.7636; train_optim_loss: 4117574.7636; val_kl_reg_loss: 15422.8917; val_edge_recon_loss: 1329937.1591; val_cat_covariates_contrastive_loss: 643869.2443; val_gene_expr_recon_loss: 2159543.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4148772.7500; val_optim_loss: 4148772.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9212; val_auprc_score: 0.9510; val_best_acc_score: 0.9284; val_best_f1_score: 0.9531; train_kl_reg_loss: 16832.5388; train_edge_recon_loss: 1329238.5448; train_cat_covariates_contrastive_loss: 636453.8573; train_gene_expr_recon_loss: 2096684.0136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4079208.9647; train_optim_loss: 4079208.9647; val_kl_reg_loss: 16550.2359; val_edge_recon_loss: 1350896.9205; val_cat_covariates_contrastive_loss: 644432.7955; val_gene_expr_recon_loss: 2260507.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4272387.4545; val_optim_loss: 4272387.4545
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9118; val_auprc_score: 0.9428; val_best_acc_score: 0.9154; val_best_f1_score: 0.9447; train_kl_reg_loss: 17484.7471; train_edge_recon_loss: 1333801.6019; train_cat_covariates_contrastive_loss: 636899.6895; train_gene_expr_recon_loss: 2076457.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4064643.1875; train_optim_loss: 4064643.1875; val_kl_reg_loss: 17065.2779; val_edge_recon_loss: 1406546.7727; val_cat_covariates_contrastive_loss: 637340.5000; val_gene_expr_recon_loss: 2182808.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4243760.9091; val_optim_loss: 4243760.9091
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9003; val_auprc_score: 0.9390; val_best_acc_score: 0.9170; val_best_f1_score: 0.9463; train_kl_reg_loss: 17681.1034; train_edge_recon_loss: 1348863.4565; train_cat_covariates_contrastive_loss: 637629.0082; train_gene_expr_recon_loss: 2061467.3736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4065640.9429; train_optim_loss: 4065640.9429; val_kl_reg_loss: 17054.6032; val_edge_recon_loss: 1369745.1364; val_cat_covariates_contrastive_loss: 637559.5795; val_gene_expr_recon_loss: 2233306.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4257665.6136; val_optim_loss: 4257665.6136
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8914; val_auprc_score: 0.9295; val_best_acc_score: 0.9128; val_best_f1_score: 0.9426; train_kl_reg_loss: 18620.9122; train_edge_recon_loss: 1344690.3533; train_cat_covariates_contrastive_loss: 638053.4552; train_gene_expr_recon_loss: 2042433.2609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4043797.9837; train_optim_loss: 4043797.9837; val_kl_reg_loss: 18229.4817; val_edge_recon_loss: 1381722.4432; val_cat_covariates_contrastive_loss: 637240.7159; val_gene_expr_recon_loss: 2206012.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4243205.2500; val_optim_loss: 4243205.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9039; val_auprc_score: 0.9412; val_best_acc_score: 0.9155; val_best_f1_score: 0.9449; train_kl_reg_loss: 18423.7997; train_edge_recon_loss: 1323416.3736; train_cat_covariates_contrastive_loss: 636999.9375; train_gene_expr_recon_loss: 2013268.6101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3992108.7174; train_optim_loss: 3992108.7174; val_kl_reg_loss: 18067.0285; val_edge_recon_loss: 1341474.6477; val_cat_covariates_contrastive_loss: 637933.6705; val_gene_expr_recon_loss: 2150936.2614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4148411.5909; val_optim_loss: 4148411.5909
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9202; val_auprc_score: 0.9515; val_best_acc_score: 0.9216; val_best_f1_score: 0.9485; train_kl_reg_loss: 18919.3160; train_edge_recon_loss: 1338229.4443; train_cat_covariates_contrastive_loss: 636657.0693; train_gene_expr_recon_loss: 2001202.1943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3995008.0027; train_optim_loss: 3995008.0027; val_kl_reg_loss: 18603.9322; val_edge_recon_loss: 1339231.7045; val_cat_covariates_contrastive_loss: 635548.4148; val_gene_expr_recon_loss: 2156033.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4149417.2955; val_optim_loss: 4149417.2955
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9052; val_auprc_score: 0.9421; val_best_acc_score: 0.9191; val_best_f1_score: 0.9471; train_kl_reg_loss: 19354.8502; train_edge_recon_loss: 1321219.0367; train_cat_covariates_contrastive_loss: 636084.0577; train_gene_expr_recon_loss: 1997002.3139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3973660.2364; train_optim_loss: 3973660.2364; val_kl_reg_loss: 18713.0938; val_edge_recon_loss: 1346463.0341; val_cat_covariates_contrastive_loss: 640597.6080; val_gene_expr_recon_loss: 2109989.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4115762.9773; val_optim_loss: 4115762.9773
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9181; val_auprc_score: 0.9456; val_best_acc_score: 0.9233; val_best_f1_score: 0.9497; train_kl_reg_loss: 19560.7854; train_edge_recon_loss: 1330331.2568; train_cat_covariates_contrastive_loss: 638348.0054; train_gene_expr_recon_loss: 1989552.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3977792.3505; train_optim_loss: 3977792.3505; val_kl_reg_loss: 19930.5185; val_edge_recon_loss: 1365328.0909; val_cat_covariates_contrastive_loss: 635577.6250; val_gene_expr_recon_loss: 2144690.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4165526.7727; val_optim_loss: 4165526.7727
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9049; val_auprc_score: 0.9406; val_best_acc_score: 0.9217; val_best_f1_score: 0.9486; train_kl_reg_loss: 20016.2772; train_edge_recon_loss: 1339334.6834; train_cat_covariates_contrastive_loss: 636719.6963; train_gene_expr_recon_loss: 1982306.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3978376.7582; train_optim_loss: 3978376.7582; val_kl_reg_loss: 19718.9288; val_edge_recon_loss: 1335844.9886; val_cat_covariates_contrastive_loss: 643110.1534; val_gene_expr_recon_loss: 2088476.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087150.6818; val_optim_loss: 4087150.6818
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9012; val_auprc_score: 0.9393; val_best_acc_score: 0.9159; val_best_f1_score: 0.9454; train_kl_reg_loss: 20157.9988; train_edge_recon_loss: 1326302.7812; train_cat_covariates_contrastive_loss: 637673.3879; train_gene_expr_recon_loss: 1980129.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964263.5571; train_optim_loss: 3964263.5571; val_kl_reg_loss: 19966.3796; val_edge_recon_loss: 1308584.4886; val_cat_covariates_contrastive_loss: 635814.5511; val_gene_expr_recon_loss: 2122952.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087317.7727; val_optim_loss: 4087317.7727
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9031; val_auprc_score: 0.9346; val_best_acc_score: 0.9168; val_best_f1_score: 0.9457; train_kl_reg_loss: 20370.4938; train_edge_recon_loss: 1319433.8173; train_cat_covariates_contrastive_loss: 636396.2622; train_gene_expr_recon_loss: 1973735.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949935.6005; train_optim_loss: 3949935.6005; val_kl_reg_loss: 20077.7917; val_edge_recon_loss: 1390681.2727; val_cat_covariates_contrastive_loss: 639355.7216; val_gene_expr_recon_loss: 2089793.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4139907.8409; val_optim_loss: 4139907.8409
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9022; val_auprc_score: 0.9415; val_best_acc_score: 0.9207; val_best_f1_score: 0.9490; train_kl_reg_loss: 20402.2129; train_edge_recon_loss: 1340276.5516; train_cat_covariates_contrastive_loss: 637962.2140; train_gene_expr_recon_loss: 1972602.4280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3971243.4130; train_optim_loss: 3971243.4130; val_kl_reg_loss: 20204.3350; val_edge_recon_loss: 1278520.7614; val_cat_covariates_contrastive_loss: 636390.2159; val_gene_expr_recon_loss: 2161014.4886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096129.8409; val_optim_loss: 4096129.8409
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9188; val_auprc_score: 0.9497; val_best_acc_score: 0.9260; val_best_f1_score: 0.9518; train_kl_reg_loss: 20389.2535; train_edge_recon_loss: 1327562.4022; train_cat_covariates_contrastive_loss: 637657.1189; train_gene_expr_recon_loss: 1970604.3981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3956213.1793; train_optim_loss: 3956213.1793; val_kl_reg_loss: 19749.9604; val_edge_recon_loss: 1309484.3068; val_cat_covariates_contrastive_loss: 637615.3239; val_gene_expr_recon_loss: 2126894.7841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093744.3409; val_optim_loss: 4093744.3409

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9182; val_auprc_score: 0.9506; val_best_acc_score: 0.9235; val_best_f1_score: 0.9503; train_kl_reg_loss: 20313.3129; train_edge_recon_loss: 1330685.4633; train_cat_covariates_contrastive_loss: 638780.9939; train_gene_expr_recon_loss: 1965362.3193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3955142.0815; train_optim_loss: 3955142.0815; val_kl_reg_loss: 19654.8240; val_edge_recon_loss: 1349590.4091; val_cat_covariates_contrastive_loss: 640230.1307; val_gene_expr_recon_loss: 2087046.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096522.2955; val_optim_loss: 4096522.2955
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8993; val_auprc_score: 0.9386; val_best_acc_score: 0.9162; val_best_f1_score: 0.9457; train_kl_reg_loss: 20383.6452; train_edge_recon_loss: 1347455.2595; train_cat_covariates_contrastive_loss: 637264.6739; train_gene_expr_recon_loss: 1962517.7840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3967621.3641; train_optim_loss: 3967621.3641; val_kl_reg_loss: 20525.0147; val_edge_recon_loss: 1357311.9886; val_cat_covariates_contrastive_loss: 637806.9602; val_gene_expr_recon_loss: 2131648.0114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4147291.9773; val_optim_loss: 4147291.9773
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9182; val_auprc_score: 0.9528; val_best_acc_score: 0.9217; val_best_f1_score: 0.9495; train_kl_reg_loss: 20492.6409; train_edge_recon_loss: 1326331.7391; train_cat_covariates_contrastive_loss: 637342.6311; train_gene_expr_recon_loss: 1963400.2541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3947567.2690; train_optim_loss: 3947567.2690; val_kl_reg_loss: 20139.5344; val_edge_recon_loss: 1291319.2955; val_cat_covariates_contrastive_loss: 660776.7614; val_gene_expr_recon_loss: 2118095.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090331.3636; val_optim_loss: 4090331.3636
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8949; val_auprc_score: 0.9346; val_best_acc_score: 0.9126; val_best_f1_score: 0.9438; train_kl_reg_loss: 20462.0251; train_edge_recon_loss: 1330938.3111; train_cat_covariates_contrastive_loss: 636871.0217; train_gene_expr_recon_loss: 1963307.8804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3951579.2228; train_optim_loss: 3951579.2228; val_kl_reg_loss: 20104.7115; val_edge_recon_loss: 1357144.9886; val_cat_covariates_contrastive_loss: 637673.2159; val_gene_expr_recon_loss: 2131019.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145942.0455; val_optim_loss: 4145942.0455

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 51 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9192
val AUPRC score: 0.9468
val best accuracy score: 0.9231
val best F1 score: 0.9496
val target rna MSE score: 0.6633
val source rna MSE score: 0.0509
Val cat covariate0 mean sim diff: 0.0092
Val cat covariate1 mean sim diff: 0.0092
Duration of model training in run 7: 0 hours, 18 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7434; val_auprc_score: 0.8951; val_best_acc_score: 0.7754; val_best_f1_score: 0.8683; train_kl_reg_loss: 5024.6297; train_edge_recon_loss: 1784032.9196; train_cat_covariates_contrastive_loss: 723744.8857; train_gene_expr_recon_loss: 3170817.0107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5683619.4357; train_optim_loss: 5683619.4357; val_kl_reg_loss: 14315.0272; val_edge_recon_loss: 1632394.8750; val_cat_covariates_contrastive_loss: 626916.9062; val_gene_expr_recon_loss: 2790982.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5064609.2500; val_optim_loss: 5064609.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7790; val_auprc_score: 0.9088; val_best_acc_score: 0.7945; val_best_f1_score: 0.8762; train_kl_reg_loss: 11100.3685; train_edge_recon_loss: 1598846.6393; train_cat_covariates_contrastive_loss: 633441.5750; train_gene_expr_recon_loss: 2712681.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4956070.5500; train_optim_loss: 4956070.5500; val_kl_reg_loss: 10211.8296; val_edge_recon_loss: 1620669.4219; val_cat_covariates_contrastive_loss: 626943.8125; val_gene_expr_recon_loss: 2637040.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4894865.9375; val_optim_loss: 4894865.9375
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8119; val_auprc_score: 0.9192; val_best_acc_score: 0.8017; val_best_f1_score: 0.8770; train_kl_reg_loss: 11710.8928; train_edge_recon_loss: 1513472.3536; train_cat_covariates_contrastive_loss: 634178.7045; train_gene_expr_recon_loss: 2614092.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773454.7929; train_optim_loss: 4773454.7929; val_kl_reg_loss: 11081.1754; val_edge_recon_loss: 1561345.4375; val_cat_covariates_contrastive_loss: 628761.1016; val_gene_expr_recon_loss: 2578033.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779221.5000; val_optim_loss: 4779221.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8443; val_auprc_score: 0.9339; val_best_acc_score: 0.8274; val_best_f1_score: 0.8887; train_kl_reg_loss: 11890.7984; train_edge_recon_loss: 1449773.6643; train_cat_covariates_contrastive_loss: 634687.5268; train_gene_expr_recon_loss: 2583788.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4680140.8071; train_optim_loss: 4680140.8071; val_kl_reg_loss: 13170.0194; val_edge_recon_loss: 1480292.4062; val_cat_covariates_contrastive_loss: 631367.3359; val_gene_expr_recon_loss: 2560039.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4684869.1250; val_optim_loss: 4684869.1250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8300; val_auprc_score: 0.9276; val_best_acc_score: 0.8315; val_best_f1_score: 0.8922; train_kl_reg_loss: 12339.5053; train_edge_recon_loss: 1434248.3357; train_cat_covariates_contrastive_loss: 633238.6750; train_gene_expr_recon_loss: 2555857.5464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4635684.0714; train_optim_loss: 4635684.0714; val_kl_reg_loss: 12029.9531; val_edge_recon_loss: 1487288.4531; val_cat_covariates_contrastive_loss: 631791.6094; val_gene_expr_recon_loss: 2534040.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4665150.6250; val_optim_loss: 4665150.6250
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8626; val_auprc_score: 0.9382; val_best_acc_score: 0.8535; val_best_f1_score: 0.9066; train_kl_reg_loss: 11435.4640; train_edge_recon_loss: 1422968.1018; train_cat_covariates_contrastive_loss: 634924.0518; train_gene_expr_recon_loss: 2539795.3143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4609122.8929; train_optim_loss: 4609122.8929; val_kl_reg_loss: 11137.1827; val_edge_recon_loss: 1417697.4219; val_cat_covariates_contrastive_loss: 634961.9453; val_gene_expr_recon_loss: 2523166.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4586963.0625; val_optim_loss: 4586963.0625
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8587; val_auprc_score: 0.9390; val_best_acc_score: 0.8524; val_best_f1_score: 0.9063; train_kl_reg_loss: 11462.9283; train_edge_recon_loss: 1384395.1661; train_cat_covariates_contrastive_loss: 636243.3161; train_gene_expr_recon_loss: 2522465.7321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4554567.1786; train_optim_loss: 4554567.1786; val_kl_reg_loss: 11151.3358; val_edge_recon_loss: 1377422.8281; val_cat_covariates_contrastive_loss: 635341.7812; val_gene_expr_recon_loss: 2479071.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4502987.4375; val_optim_loss: 4502987.4375
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8653; val_auprc_score: 0.9373; val_best_acc_score: 0.8502; val_best_f1_score: 0.9041; train_kl_reg_loss: 11326.0121; train_edge_recon_loss: 1376550.9982; train_cat_covariates_contrastive_loss: 636780.5679; train_gene_expr_recon_loss: 2504842.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4529499.8500; train_optim_loss: 4529499.8500; val_kl_reg_loss: 11189.0409; val_edge_recon_loss: 1426649.2969; val_cat_covariates_contrastive_loss: 631042.8359; val_gene_expr_recon_loss: 2487422.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4556303.6875; val_optim_loss: 4556303.6875
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8753; val_auprc_score: 0.9436; val_best_acc_score: 0.8736; val_best_f1_score: 0.9188; train_kl_reg_loss: 10954.1105; train_edge_recon_loss: 1378195.6786; train_cat_covariates_contrastive_loss: 635972.6357; train_gene_expr_recon_loss: 2488313.2964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4513435.7286; train_optim_loss: 4513435.7286; val_kl_reg_loss: 11143.1205; val_edge_recon_loss: 1413828.7188; val_cat_covariates_contrastive_loss: 637181.5000; val_gene_expr_recon_loss: 2465559.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527712.8125; val_optim_loss: 4527712.8125
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8900; val_auprc_score: 0.9457; val_best_acc_score: 0.8828; val_best_f1_score: 0.9258; train_kl_reg_loss: 10740.2336; train_edge_recon_loss: 1387855.6268; train_cat_covariates_contrastive_loss: 635356.0938; train_gene_expr_recon_loss: 2476597.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4510548.9464; train_optim_loss: 4510548.9464; val_kl_reg_loss: 10362.4698; val_edge_recon_loss: 1373384.6250; val_cat_covariates_contrastive_loss: 633772.7969; val_gene_expr_recon_loss: 2449515.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4467034.8438; val_optim_loss: 4467034.8438
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8916; val_auprc_score: 0.9482; val_best_acc_score: 0.8940; val_best_f1_score: 0.9319; train_kl_reg_loss: 10570.7727; train_edge_recon_loss: 1362892.7554; train_cat_covariates_contrastive_loss: 634268.0125; train_gene_expr_recon_loss: 2462914.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470645.7250; train_optim_loss: 4470645.7250; val_kl_reg_loss: 10557.9323; val_edge_recon_loss: 1360643.7344; val_cat_covariates_contrastive_loss: 634475.5781; val_gene_expr_recon_loss: 2430332.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4436010.0625; val_optim_loss: 4436010.0625
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8974; val_auprc_score: 0.9529; val_best_acc_score: 0.8924; val_best_f1_score: 0.9317; train_kl_reg_loss: 10455.6521; train_edge_recon_loss: 1320301.3277; train_cat_covariates_contrastive_loss: 633642.8098; train_gene_expr_recon_loss: 2447955.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4412355.1893; train_optim_loss: 4412355.1893; val_kl_reg_loss: 10652.3746; val_edge_recon_loss: 1323590.4688; val_cat_covariates_contrastive_loss: 630363.6328; val_gene_expr_recon_loss: 2429128.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4393735.3125; val_optim_loss: 4393735.3125
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8974; val_auprc_score: 0.9527; val_best_acc_score: 0.8892; val_best_f1_score: 0.9296; train_kl_reg_loss: 10226.5402; train_edge_recon_loss: 1370466.2286; train_cat_covariates_contrastive_loss: 632348.8866; train_gene_expr_recon_loss: 2437689.4429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4450731.0929; train_optim_loss: 4450731.0929; val_kl_reg_loss: 10003.3293; val_edge_recon_loss: 1348627.3750; val_cat_covariates_contrastive_loss: 632695.2578; val_gene_expr_recon_loss: 2396172.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4387498.3750; val_optim_loss: 4387498.3750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9009; val_auprc_score: 0.9507; val_best_acc_score: 0.8896; val_best_f1_score: 0.9289; train_kl_reg_loss: 10159.3165; train_edge_recon_loss: 1361022.9607; train_cat_covariates_contrastive_loss: 633731.7366; train_gene_expr_recon_loss: 2415008.3143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4419922.3321; train_optim_loss: 4419922.3321; val_kl_reg_loss: 10102.6772; val_edge_recon_loss: 1336176.9688; val_cat_covariates_contrastive_loss: 632168.3828; val_gene_expr_recon_loss: 2411056.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4389504.6250; val_optim_loss: 4389504.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9002; val_auprc_score: 0.9437; val_best_acc_score: 0.8915; val_best_f1_score: 0.9296; train_kl_reg_loss: 10160.6529; train_edge_recon_loss: 1360937.3196; train_cat_covariates_contrastive_loss: 634972.3250; train_gene_expr_recon_loss: 2407413.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4413484.1643; train_optim_loss: 4413484.1643; val_kl_reg_loss: 9955.2152; val_edge_recon_loss: 1383767.2969; val_cat_covariates_contrastive_loss: 634600.1797; val_gene_expr_recon_loss: 2389472.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4417795.0625; val_optim_loss: 4417795.0625
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9065; val_auprc_score: 0.9535; val_best_acc_score: 0.8961; val_best_f1_score: 0.9332; train_kl_reg_loss: 10058.6153; train_edge_recon_loss: 1324637.9982; train_cat_covariates_contrastive_loss: 634393.5241; train_gene_expr_recon_loss: 2393348.9893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4362439.1036; train_optim_loss: 4362439.1036; val_kl_reg_loss: 10171.3860; val_edge_recon_loss: 1405474.5000; val_cat_covariates_contrastive_loss: 636420.3672; val_gene_expr_recon_loss: 2389356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4441422.3125; val_optim_loss: 4441422.3125
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9066; val_auprc_score: 0.9520; val_best_acc_score: 0.9073; val_best_f1_score: 0.9398; train_kl_reg_loss: 10105.1051; train_edge_recon_loss: 1306698.2536; train_cat_covariates_contrastive_loss: 633627.0348; train_gene_expr_recon_loss: 2381356.9750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4331787.3786; train_optim_loss: 4331787.3786; val_kl_reg_loss: 10238.0050; val_edge_recon_loss: 1384496.0000; val_cat_covariates_contrastive_loss: 631077.4141; val_gene_expr_recon_loss: 2382699.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4408510.5625; val_optim_loss: 4408510.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9206; val_auprc_score: 0.9604; val_best_acc_score: 0.9091; val_best_f1_score: 0.9415; train_kl_reg_loss: 10100.5735; train_edge_recon_loss: 1340557.9929; train_cat_covariates_contrastive_loss: 632356.0295; train_gene_expr_recon_loss: 2371724.5643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4354739.1714; train_optim_loss: 4354739.1714; val_kl_reg_loss: 10085.7733; val_edge_recon_loss: 1321018.1562; val_cat_covariates_contrastive_loss: 630546.8828; val_gene_expr_recon_loss: 2364442.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4326093.1562; val_optim_loss: 4326093.1562
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9115; val_auprc_score: 0.9570; val_best_acc_score: 0.9132; val_best_f1_score: 0.9443; train_kl_reg_loss: 10052.0107; train_edge_recon_loss: 1323512.5429; train_cat_covariates_contrastive_loss: 631992.4616; train_gene_expr_recon_loss: 2366264.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4331821.4036; train_optim_loss: 4331821.4036; val_kl_reg_loss: 10135.7770; val_edge_recon_loss: 1329110.1875; val_cat_covariates_contrastive_loss: 635806.5938; val_gene_expr_recon_loss: 2382309.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4357362.0625; val_optim_loss: 4357362.0625
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9161; val_auprc_score: 0.9549; val_best_acc_score: 0.9056; val_best_f1_score: 0.9378; train_kl_reg_loss: 10091.0292; train_edge_recon_loss: 1335894.2500; train_cat_covariates_contrastive_loss: 633565.3580; train_gene_expr_recon_loss: 2365787.6607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4345338.3036; train_optim_loss: 4345338.3036; val_kl_reg_loss: 10226.6699; val_edge_recon_loss: 1384808.9375; val_cat_covariates_contrastive_loss: 637030.9141; val_gene_expr_recon_loss: 2359568.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4391634.5625; val_optim_loss: 4391634.5625
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9125; val_auprc_score: 0.9553; val_best_acc_score: 0.9127; val_best_f1_score: 0.9433; train_kl_reg_loss: 10192.5700; train_edge_recon_loss: 1314796.3125; train_cat_covariates_contrastive_loss: 632971.2170; train_gene_expr_recon_loss: 2363244.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4321204.5464; train_optim_loss: 4321204.5464; val_kl_reg_loss: 10169.6300; val_edge_recon_loss: 1331071.0625; val_cat_covariates_contrastive_loss: 631316.0547; val_gene_expr_recon_loss: 2352236.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4324793.0000; val_optim_loss: 4324793.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9122; val_auprc_score: 0.9526; val_best_acc_score: 0.9111; val_best_f1_score: 0.9424; train_kl_reg_loss: 10173.5795; train_edge_recon_loss: 1341883.2286; train_cat_covariates_contrastive_loss: 632784.1536; train_gene_expr_recon_loss: 2363357.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4348198.2429; train_optim_loss: 4348198.2429; val_kl_reg_loss: 10293.6820; val_edge_recon_loss: 1337096.9219; val_cat_covariates_contrastive_loss: 630437.8359; val_gene_expr_recon_loss: 2376934.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4354762.9375; val_optim_loss: 4354762.9375
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8944; val_auprc_score: 0.9404; val_best_acc_score: 0.9047; val_best_f1_score: 0.9388; train_kl_reg_loss: 10171.0072; train_edge_recon_loss: 1332274.1741; train_cat_covariates_contrastive_loss: 633652.5107; train_gene_expr_recon_loss: 2357304.7393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4333402.4000; train_optim_loss: 4333402.4000; val_kl_reg_loss: 10255.0449; val_edge_recon_loss: 1339679.6562; val_cat_covariates_contrastive_loss: 633403.9609; val_gene_expr_recon_loss: 2356424.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4339763.4375; val_optim_loss: 4339763.4375
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9253; val_auprc_score: 0.9620; val_best_acc_score: 0.9156; val_best_f1_score: 0.9453; train_kl_reg_loss: 10183.2472; train_edge_recon_loss: 1333933.5929; train_cat_covariates_contrastive_loss: 632814.1089; train_gene_expr_recon_loss: 2361927.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4338858.5000; train_optim_loss: 4338858.5000; val_kl_reg_loss: 10197.7759; val_edge_recon_loss: 1284659.4375; val_cat_covariates_contrastive_loss: 630046.6797; val_gene_expr_recon_loss: 2350612.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4275516.5312; val_optim_loss: 4275516.5312
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9237; val_auprc_score: 0.9628; val_best_acc_score: 0.9152; val_best_f1_score: 0.9448; train_kl_reg_loss: 10234.0517; train_edge_recon_loss: 1323254.5411; train_cat_covariates_contrastive_loss: 632839.5741; train_gene_expr_recon_loss: 2360900.8143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4327228.9857; train_optim_loss: 4327228.9857; val_kl_reg_loss: 10096.6315; val_edge_recon_loss: 1336828.7500; val_cat_covariates_contrastive_loss: 632688.6328; val_gene_expr_recon_loss: 2358061.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4337675.1875; val_optim_loss: 4337675.1875
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9214; val_auprc_score: 0.9614; val_best_acc_score: 0.9115; val_best_f1_score: 0.9423; train_kl_reg_loss: 10140.4661; train_edge_recon_loss: 1328553.4018; train_cat_covariates_contrastive_loss: 632173.2170; train_gene_expr_recon_loss: 2356118.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4326985.8750; train_optim_loss: 4326985.8750; val_kl_reg_loss: 10165.8717; val_edge_recon_loss: 1335962.9219; val_cat_covariates_contrastive_loss: 632007.6562; val_gene_expr_recon_loss: 2370654.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4348791.2188; val_optim_loss: 4348791.2188
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9009; val_auprc_score: 0.9463; val_best_acc_score: 0.9043; val_best_f1_score: 0.9384; train_kl_reg_loss: 10195.9494; train_edge_recon_loss: 1332919.3036; train_cat_covariates_contrastive_loss: 632672.8446; train_gene_expr_recon_loss: 2356005.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4331793.8500; train_optim_loss: 4331793.8500; val_kl_reg_loss: 10251.5952; val_edge_recon_loss: 1335956.5625; val_cat_covariates_contrastive_loss: 633165.7969; val_gene_expr_recon_loss: 2365043.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4344417.3750; val_optim_loss: 4344417.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9306; val_auprc_score: 0.9618; val_best_acc_score: 0.9237; val_best_f1_score: 0.9499; train_kl_reg_loss: 10213.5439; train_edge_recon_loss: 1330302.1196; train_cat_covariates_contrastive_loss: 632624.5616; train_gene_expr_recon_loss: 2357429.3286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4330569.5214; train_optim_loss: 4330569.5214; val_kl_reg_loss: 10094.3818; val_edge_recon_loss: 1312687.8125; val_cat_covariates_contrastive_loss: 632723.8281; val_gene_expr_recon_loss: 2340962.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4296468.5625; val_optim_loss: 4296468.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9291; val_auprc_score: 0.9599; val_best_acc_score: 0.9182; val_best_f1_score: 0.9459; train_kl_reg_loss: 10185.0361; train_edge_recon_loss: 1367531.0125; train_cat_covariates_contrastive_loss: 633808.5312; train_gene_expr_recon_loss: 2351557.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4363082.1143; train_optim_loss: 4363082.1143; val_kl_reg_loss: 10227.5968; val_edge_recon_loss: 1377410.5000; val_cat_covariates_contrastive_loss: 636409.3125; val_gene_expr_recon_loss: 2359745.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4383792.8125; val_optim_loss: 4383792.8125
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9128; val_auprc_score: 0.9518; val_best_acc_score: 0.9158; val_best_f1_score: 0.9453; train_kl_reg_loss: 10163.2221; train_edge_recon_loss: 1320253.8214; train_cat_covariates_contrastive_loss: 632402.1446; train_gene_expr_recon_loss: 2349834.2750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4312653.4536; train_optim_loss: 4312653.4536; val_kl_reg_loss: 10250.5309; val_edge_recon_loss: 1334885.0938; val_cat_covariates_contrastive_loss: 630848.4766; val_gene_expr_recon_loss: 2368259.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4344243.8750; val_optim_loss: 4344243.8750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9073; val_auprc_score: 0.9527; val_best_acc_score: 0.9056; val_best_f1_score: 0.9391; train_kl_reg_loss: 10246.5485; train_edge_recon_loss: 1309911.3393; train_cat_covariates_contrastive_loss: 633362.7982; train_gene_expr_recon_loss: 2350644.0714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4304164.7679; train_optim_loss: 4304164.7679; val_kl_reg_loss: 10244.5807; val_edge_recon_loss: 1351503.7969; val_cat_covariates_contrastive_loss: 631128.4766; val_gene_expr_recon_loss: 2341405.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4334282.6875; val_optim_loss: 4334282.6875
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9164; val_auprc_score: 0.9551; val_best_acc_score: 0.9188; val_best_f1_score: 0.9467; train_kl_reg_loss: 10224.1031; train_edge_recon_loss: 1344623.3321; train_cat_covariates_contrastive_loss: 632013.8571; train_gene_expr_recon_loss: 2349201.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4336062.3214; train_optim_loss: 4336062.3214; val_kl_reg_loss: 10298.6036; val_edge_recon_loss: 1345516.6562; val_cat_covariates_contrastive_loss: 631944.9609; val_gene_expr_recon_loss: 2347768.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4335528.9688; val_optim_loss: 4335528.9688

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 38 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9245
val AUPRC score: 0.9620
val best accuracy score: 0.9131
val best F1 score: 0.9433
val target rna MSE score: 0.6828
val source rna MSE score: 0.0698
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0008
Duration of model training in run 6: 0 hours, 7 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7558; val_auprc_score: 0.8949; val_best_acc_score: 0.7740; val_best_f1_score: 0.8663; train_kl_reg_loss: 7605.6155; train_edge_recon_loss: 1780908.9268; train_cat_covariates_contrastive_loss: 704194.1830; train_gene_expr_recon_loss: 3118413.3143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5611122.0571; train_optim_loss: 5611122.0571; val_kl_reg_loss: 11464.8893; val_edge_recon_loss: 1709266.9844; val_cat_covariates_contrastive_loss: 627797.5938; val_gene_expr_recon_loss: 2777594.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5126123.4375; val_optim_loss: 5126123.4375
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7841; val_auprc_score: 0.9098; val_best_acc_score: 0.7967; val_best_f1_score: 0.8741; train_kl_reg_loss: 12186.1856; train_edge_recon_loss: 1569974.4679; train_cat_covariates_contrastive_loss: 632433.0875; train_gene_expr_recon_loss: 2681284.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4895878.6857; train_optim_loss: 4895878.6857; val_kl_reg_loss: 15301.0575; val_edge_recon_loss: 1555521.0156; val_cat_covariates_contrastive_loss: 627837.6719; val_gene_expr_recon_loss: 2639933.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4838593.3750; val_optim_loss: 4838593.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8192; val_auprc_score: 0.9282; val_best_acc_score: 0.8220; val_best_f1_score: 0.8915; train_kl_reg_loss: 12992.2812; train_edge_recon_loss: 1494142.9589; train_cat_covariates_contrastive_loss: 634716.3509; train_gene_expr_recon_loss: 2607109.2286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4748960.8000; train_optim_loss: 4748960.8000; val_kl_reg_loss: 12436.8861; val_edge_recon_loss: 1512687.8125; val_cat_covariates_contrastive_loss: 629141.8906; val_gene_expr_recon_loss: 2551158.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4705424.8125; val_optim_loss: 4705424.8125
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8682; val_auprc_score: 0.9455; val_best_acc_score: 0.8512; val_best_f1_score: 0.9060; train_kl_reg_loss: 12554.7016; train_edge_recon_loss: 1463934.3839; train_cat_covariates_contrastive_loss: 635717.7018; train_gene_expr_recon_loss: 2555370.9607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4667577.7786; train_optim_loss: 4667577.7786; val_kl_reg_loss: 12375.0088; val_edge_recon_loss: 1402233.9375; val_cat_covariates_contrastive_loss: 632686.8594; val_gene_expr_recon_loss: 2522296.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4569592.7500; val_optim_loss: 4569592.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8580; val_auprc_score: 0.9334; val_best_acc_score: 0.8568; val_best_f1_score: 0.9090; train_kl_reg_loss: 12205.8831; train_edge_recon_loss: 1412858.0911; train_cat_covariates_contrastive_loss: 635302.6366; train_gene_expr_recon_loss: 2535014.2964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4595380.9071; train_optim_loss: 4595380.9071; val_kl_reg_loss: 11719.1156; val_edge_recon_loss: 1400193.3281; val_cat_covariates_contrastive_loss: 632476.9766; val_gene_expr_recon_loss: 2526083.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4570473.3125; val_optim_loss: 4570473.3125
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8799; val_auprc_score: 0.9492; val_best_acc_score: 0.8693; val_best_f1_score: 0.9184; train_kl_reg_loss: 11634.5946; train_edge_recon_loss: 1394462.5393; train_cat_covariates_contrastive_loss: 636457.2125; train_gene_expr_recon_loss: 2515895.3429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558449.6857; train_optim_loss: 4558449.6857; val_kl_reg_loss: 11027.0305; val_edge_recon_loss: 1368112.2969; val_cat_covariates_contrastive_loss: 630709.2656; val_gene_expr_recon_loss: 2501570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4511418.5000; val_optim_loss: 4511418.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8833; val_auprc_score: 0.9462; val_best_acc_score: 0.8822; val_best_f1_score: 0.9260; train_kl_reg_loss: 10937.8554; train_edge_recon_loss: 1391713.1482; train_cat_covariates_contrastive_loss: 633206.2589; train_gene_expr_recon_loss: 2504581.8107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4540439.0714; train_optim_loss: 4540439.0714; val_kl_reg_loss: 10769.3857; val_edge_recon_loss: 1352074.3594; val_cat_covariates_contrastive_loss: 630986.0781; val_gene_expr_recon_loss: 2479777.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4473607.0000; val_optim_loss: 4473607.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9077; val_auprc_score: 0.9587; val_best_acc_score: 0.8897; val_best_f1_score: 0.9295; train_kl_reg_loss: 10691.8811; train_edge_recon_loss: 1385794.9804; train_cat_covariates_contrastive_loss: 633122.1821; train_gene_expr_recon_loss: 2491237.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4520846.3964; train_optim_loss: 4520846.3964; val_kl_reg_loss: 10942.0612; val_edge_recon_loss: 1332849.5781; val_cat_covariates_contrastive_loss: 635687.7734; val_gene_expr_recon_loss: 2474445.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4453925.1250; val_optim_loss: 4453925.1250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8973; val_auprc_score: 0.9503; val_best_acc_score: 0.8947; val_best_f1_score: 0.9319; train_kl_reg_loss: 10303.2414; train_edge_recon_loss: 1335159.0214; train_cat_covariates_contrastive_loss: 636852.2170; train_gene_expr_recon_loss: 2464471.9107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4446786.4071; train_optim_loss: 4446786.4071; val_kl_reg_loss: 10160.8571; val_edge_recon_loss: 1425317.1094; val_cat_covariates_contrastive_loss: 629903.1328; val_gene_expr_recon_loss: 2441210.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4506591.8750; val_optim_loss: 4506591.8750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9064; val_auprc_score: 0.9538; val_best_acc_score: 0.9050; val_best_f1_score: 0.9380; train_kl_reg_loss: 10337.8234; train_edge_recon_loss: 1362394.4268; train_cat_covariates_contrastive_loss: 634051.9277; train_gene_expr_recon_loss: 2453038.0893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4459822.2714; train_optim_loss: 4459822.2714; val_kl_reg_loss: 10507.7114; val_edge_recon_loss: 1338203.2969; val_cat_covariates_contrastive_loss: 634371.9453; val_gene_expr_recon_loss: 2455646.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4438729.5000; val_optim_loss: 4438729.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9098; val_auprc_score: 0.9511; val_best_acc_score: 0.9127; val_best_f1_score: 0.9429; train_kl_reg_loss: 10411.9632; train_edge_recon_loss: 1352231.3196; train_cat_covariates_contrastive_loss: 632572.6982; train_gene_expr_recon_loss: 2434035.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4429251.1714; train_optim_loss: 4429251.1714; val_kl_reg_loss: 10219.1023; val_edge_recon_loss: 1382086.0938; val_cat_covariates_contrastive_loss: 635137.8828; val_gene_expr_recon_loss: 2455866.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4483309.5625; val_optim_loss: 4483309.5625
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8973; val_auprc_score: 0.9458; val_best_acc_score: 0.9128; val_best_f1_score: 0.9440; train_kl_reg_loss: 10331.6679; train_edge_recon_loss: 1340013.7464; train_cat_covariates_contrastive_loss: 632607.0411; train_gene_expr_recon_loss: 2424751.2357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4407703.7036; train_optim_loss: 4407703.7036; val_kl_reg_loss: 10362.0265; val_edge_recon_loss: 1324801.7500; val_cat_covariates_contrastive_loss: 630521.8750; val_gene_expr_recon_loss: 2401231.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4366917.5000; val_optim_loss: 4366917.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9160; val_auprc_score: 0.9612; val_best_acc_score: 0.9159; val_best_f1_score: 0.9457; train_kl_reg_loss: 10196.9508; train_edge_recon_loss: 1359205.7821; train_cat_covariates_contrastive_loss: 631821.4080; train_gene_expr_recon_loss: 2411380.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4412604.1714; train_optim_loss: 4412604.1714; val_kl_reg_loss: 10214.5530; val_edge_recon_loss: 1320877.2188; val_cat_covariates_contrastive_loss: 629146.8828; val_gene_expr_recon_loss: 2403923.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4364162.6250; val_optim_loss: 4364162.6250
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9292; val_auprc_score: 0.9668; val_best_acc_score: 0.9239; val_best_f1_score: 0.9509; train_kl_reg_loss: 10253.0819; train_edge_recon_loss: 1351403.7643; train_cat_covariates_contrastive_loss: 631858.0696; train_gene_expr_recon_loss: 2399472.4393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4392987.3929; train_optim_loss: 4392987.3929; val_kl_reg_loss: 10252.1946; val_edge_recon_loss: 1259429.7812; val_cat_covariates_contrastive_loss: 630767.5547; val_gene_expr_recon_loss: 2396751.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4297200.9688; val_optim_loss: 4297200.9688
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9136; val_auprc_score: 0.9538; val_best_acc_score: 0.9116; val_best_f1_score: 0.9424; train_kl_reg_loss: 10176.1306; train_edge_recon_loss: 1332066.3339; train_cat_covariates_contrastive_loss: 631939.7571; train_gene_expr_recon_loss: 2391594.8536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4365777.0679; train_optim_loss: 4365777.0679; val_kl_reg_loss: 9904.4213; val_edge_recon_loss: 1370937.7969; val_cat_covariates_contrastive_loss: 640754.1562; val_gene_expr_recon_loss: 2394976.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4416572.8125; val_optim_loss: 4416572.8125
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9182; val_auprc_score: 0.9606; val_best_acc_score: 0.9146; val_best_f1_score: 0.9443; train_kl_reg_loss: 10123.8405; train_edge_recon_loss: 1332007.9812; train_cat_covariates_contrastive_loss: 632729.4384; train_gene_expr_recon_loss: 2380790.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4355651.6321; train_optim_loss: 4355651.6321; val_kl_reg_loss: 10347.1718; val_edge_recon_loss: 1347648.2812; val_cat_covariates_contrastive_loss: 630622.6328; val_gene_expr_recon_loss: 2367259.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4355877.7812; val_optim_loss: 4355877.7812
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9072; val_auprc_score: 0.9532; val_best_acc_score: 0.9175; val_best_f1_score: 0.9470; train_kl_reg_loss: 10147.1076; train_edge_recon_loss: 1328515.3946; train_cat_covariates_contrastive_loss: 632088.9616; train_gene_expr_recon_loss: 2367467.4071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4338218.8714; train_optim_loss: 4338218.8714; val_kl_reg_loss: 9953.7852; val_edge_recon_loss: 1298099.7344; val_cat_covariates_contrastive_loss: 630720.6094; val_gene_expr_recon_loss: 2355485.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4294259.3438; val_optim_loss: 4294259.3438
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9211; val_auprc_score: 0.9620; val_best_acc_score: 0.9157; val_best_f1_score: 0.9449; train_kl_reg_loss: 10002.2783; train_edge_recon_loss: 1331018.4929; train_cat_covariates_contrastive_loss: 631147.4437; train_gene_expr_recon_loss: 2363559.7893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4335727.9857; train_optim_loss: 4335727.9857; val_kl_reg_loss: 9734.0093; val_edge_recon_loss: 1350322.0938; val_cat_covariates_contrastive_loss: 631075.0000; val_gene_expr_recon_loss: 2369296.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4360427.9375; val_optim_loss: 4360427.9375
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9252; val_auprc_score: 0.9595; val_best_acc_score: 0.9276; val_best_f1_score: 0.9529; train_kl_reg_loss: 10073.5213; train_edge_recon_loss: 1326737.8696; train_cat_covariates_contrastive_loss: 632372.8375; train_gene_expr_recon_loss: 2343108.9393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4312293.1857; train_optim_loss: 4312293.1857; val_kl_reg_loss: 10222.5822; val_edge_recon_loss: 1281375.7969; val_cat_covariates_contrastive_loss: 634134.5547; val_gene_expr_recon_loss: 2339614.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4265347.1875; val_optim_loss: 4265347.1875
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9259; val_auprc_score: 0.9654; val_best_acc_score: 0.9133; val_best_f1_score: 0.9440; train_kl_reg_loss: 10154.7522; train_edge_recon_loss: 1316898.6500; train_cat_covariates_contrastive_loss: 634377.1062; train_gene_expr_recon_loss: 2334927.1946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4296357.7393; train_optim_loss: 4296357.7393; val_kl_reg_loss: 10443.6512; val_edge_recon_loss: 1314370.5000; val_cat_covariates_contrastive_loss: 633668.6875; val_gene_expr_recon_loss: 2352748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4311230.7500; val_optim_loss: 4311230.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9148; val_auprc_score: 0.9561; val_best_acc_score: 0.9191; val_best_f1_score: 0.9476; train_kl_reg_loss: 10490.5190; train_edge_recon_loss: 1326045.1518; train_cat_covariates_contrastive_loss: 633983.4661; train_gene_expr_recon_loss: 2326252.5321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4296771.6750; train_optim_loss: 4296771.6750; val_kl_reg_loss: 10271.5560; val_edge_recon_loss: 1322423.2969; val_cat_covariates_contrastive_loss: 631138.6797; val_gene_expr_recon_loss: 2349516.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4313349.8750; val_optim_loss: 4313349.8750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9064; val_auprc_score: 0.9508; val_best_acc_score: 0.9136; val_best_f1_score: 0.9446; train_kl_reg_loss: 10500.7466; train_edge_recon_loss: 1312489.9036; train_cat_covariates_contrastive_loss: 633134.8929; train_gene_expr_recon_loss: 2310752.7036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4266878.2393; train_optim_loss: 4266878.2393; val_kl_reg_loss: 10359.6309; val_edge_recon_loss: 1352885.1406; val_cat_covariates_contrastive_loss: 639721.6875; val_gene_expr_recon_loss: 2336935.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4339901.4375; val_optim_loss: 4339901.4375
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9195; val_auprc_score: 0.9610; val_best_acc_score: 0.9226; val_best_f1_score: 0.9503; train_kl_reg_loss: 10545.7018; train_edge_recon_loss: 1317698.4786; train_cat_covariates_contrastive_loss: 632765.3063; train_gene_expr_recon_loss: 2295998.1643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4257007.6429; train_optim_loss: 4257007.6429; val_kl_reg_loss: 10507.7583; val_edge_recon_loss: 1282736.3281; val_cat_covariates_contrastive_loss: 633055.5859; val_gene_expr_recon_loss: 2310298.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4236597.7812; val_optim_loss: 4236597.7812
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9194; val_auprc_score: 0.9572; val_best_acc_score: 0.9244; val_best_f1_score: 0.9507; train_kl_reg_loss: 10752.3664; train_edge_recon_loss: 1321429.2071; train_cat_covariates_contrastive_loss: 634984.6616; train_gene_expr_recon_loss: 2295598.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4262764.2750; train_optim_loss: 4262764.2750; val_kl_reg_loss: 11035.3020; val_edge_recon_loss: 1365507.5312; val_cat_covariates_contrastive_loss: 631619.2266; val_gene_expr_recon_loss: 2297986.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4306148.2188; val_optim_loss: 4306148.2188
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9261; val_auprc_score: 0.9610; val_best_acc_score: 0.9279; val_best_f1_score: 0.9526; train_kl_reg_loss: 10920.1437; train_edge_recon_loss: 1331971.6232; train_cat_covariates_contrastive_loss: 636072.6250; train_gene_expr_recon_loss: 2280016.5893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4258980.9893; train_optim_loss: 4258980.9893; val_kl_reg_loss: 10828.3469; val_edge_recon_loss: 1295990.0625; val_cat_covariates_contrastive_loss: 636955.6641; val_gene_expr_recon_loss: 2331576.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4275350.1250; val_optim_loss: 4275350.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9268; val_auprc_score: 0.9606; val_best_acc_score: 0.9297; val_best_f1_score: 0.9542; train_kl_reg_loss: 11058.4403; train_edge_recon_loss: 1327131.2732; train_cat_covariates_contrastive_loss: 634585.9446; train_gene_expr_recon_loss: 2272302.6679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4245078.3536; train_optim_loss: 4245078.3536; val_kl_reg_loss: 11223.5500; val_edge_recon_loss: 1329508.2031; val_cat_covariates_contrastive_loss: 635764.2031; val_gene_expr_recon_loss: 2305838.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4282334.5000; val_optim_loss: 4282334.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9227; val_auprc_score: 0.9595; val_best_acc_score: 0.9249; val_best_f1_score: 0.9513; train_kl_reg_loss: 11432.4707; train_edge_recon_loss: 1314839.5955; train_cat_covariates_contrastive_loss: 634934.3598; train_gene_expr_recon_loss: 2252096.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4213303.1429; train_optim_loss: 4213303.1429; val_kl_reg_loss: 11368.4828; val_edge_recon_loss: 1316348.2188; val_cat_covariates_contrastive_loss: 631660.6562; val_gene_expr_recon_loss: 2284123.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4243501.3750; val_optim_loss: 4243501.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9189; val_auprc_score: 0.9597; val_best_acc_score: 0.9306; val_best_f1_score: 0.9554; train_kl_reg_loss: 11521.9026; train_edge_recon_loss: 1320540.2089; train_cat_covariates_contrastive_loss: 634393.0473; train_gene_expr_recon_loss: 2240567.9161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4207023.0643; train_optim_loss: 4207023.0643; val_kl_reg_loss: 11662.8564; val_edge_recon_loss: 1268474.6250; val_cat_covariates_contrastive_loss: 636355.9062; val_gene_expr_recon_loss: 2286105.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4202598.4688; val_optim_loss: 4202598.4688
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9161; val_auprc_score: 0.9514; val_best_acc_score: 0.9214; val_best_f1_score: 0.9496; train_kl_reg_loss: 11796.6426; train_edge_recon_loss: 1334086.0571; train_cat_covariates_contrastive_loss: 634618.7429; train_gene_expr_recon_loss: 2232581.6304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4213083.0893; train_optim_loss: 4213083.0893; val_kl_reg_loss: 11893.8757; val_edge_recon_loss: 1316649.4375; val_cat_covariates_contrastive_loss: 633228.9062; val_gene_expr_recon_loss: 2292712.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4254484.3750; val_optim_loss: 4254484.3750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9226; val_auprc_score: 0.9595; val_best_acc_score: 0.9269; val_best_f1_score: 0.9533; train_kl_reg_loss: 11890.8478; train_edge_recon_loss: 1315144.1125; train_cat_covariates_contrastive_loss: 636064.1500; train_gene_expr_recon_loss: 2229376.2625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4192475.3750; train_optim_loss: 4192475.3750; val_kl_reg_loss: 11870.6792; val_edge_recon_loss: 1290096.7969; val_cat_covariates_contrastive_loss: 633740.1719; val_gene_expr_recon_loss: 2275353.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4211060.7500; val_optim_loss: 4211060.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9350; val_auprc_score: 0.9603; val_best_acc_score: 0.9259; val_best_f1_score: 0.9514; train_kl_reg_loss: 11952.2996; train_edge_recon_loss: 1323918.0634; train_cat_covariates_contrastive_loss: 635957.0625; train_gene_expr_recon_loss: 2231716.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4203544.0571; train_optim_loss: 4203544.0571; val_kl_reg_loss: 11982.8593; val_edge_recon_loss: 1341734.5000; val_cat_covariates_contrastive_loss: 634078.4141; val_gene_expr_recon_loss: 2276117.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4263913.1562; val_optim_loss: 4263913.1562
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9164; val_auprc_score: 0.9566; val_best_acc_score: 0.9269; val_best_f1_score: 0.9527; train_kl_reg_loss: 12016.8392; train_edge_recon_loss: 1308072.8179; train_cat_covariates_contrastive_loss: 634878.2509; train_gene_expr_recon_loss: 2229935.8429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4184903.7571; train_optim_loss: 4184903.7571; val_kl_reg_loss: 12189.6587; val_edge_recon_loss: 1322597.7969; val_cat_covariates_contrastive_loss: 632529.8359; val_gene_expr_recon_loss: 2281455.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4248773.1250; val_optim_loss: 4248773.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9329; val_auprc_score: 0.9679; val_best_acc_score: 0.9276; val_best_f1_score: 0.9530; train_kl_reg_loss: 12189.2876; train_edge_recon_loss: 1338717.1161; train_cat_covariates_contrastive_loss: 634410.2188; train_gene_expr_recon_loss: 2226420.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4211737.0179; train_optim_loss: 4211737.0179; val_kl_reg_loss: 11937.4003; val_edge_recon_loss: 1284665.4219; val_cat_covariates_contrastive_loss: 631891.6875; val_gene_expr_recon_loss: 2264821.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4193316.0938; val_optim_loss: 4193316.0938
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9118; val_auprc_score: 0.9496; val_best_acc_score: 0.9262; val_best_f1_score: 0.9520; train_kl_reg_loss: 12127.8477; train_edge_recon_loss: 1327810.5232; train_cat_covariates_contrastive_loss: 634356.7991; train_gene_expr_recon_loss: 2223416.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4197711.6393; train_optim_loss: 4197711.6393; val_kl_reg_loss: 12031.8011; val_edge_recon_loss: 1319655.9844; val_cat_covariates_contrastive_loss: 640202.1172; val_gene_expr_recon_loss: 2276525.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4248415.3750; val_optim_loss: 4248415.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9148; val_auprc_score: 0.9522; val_best_acc_score: 0.9258; val_best_f1_score: 0.9516; train_kl_reg_loss: 12085.1625; train_edge_recon_loss: 1347028.9446; train_cat_covariates_contrastive_loss: 634383.1687; train_gene_expr_recon_loss: 2218461.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4211959.0750; train_optim_loss: 4211959.0750; val_kl_reg_loss: 12062.3361; val_edge_recon_loss: 1338713.9688; val_cat_covariates_contrastive_loss: 640750.1172; val_gene_expr_recon_loss: 2281483.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4273010.0000; val_optim_loss: 4273010.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9196; val_auprc_score: 0.9564; val_best_acc_score: 0.9262; val_best_f1_score: 0.9520; train_kl_reg_loss: 12060.6929; train_edge_recon_loss: 1339246.6339; train_cat_covariates_contrastive_loss: 633768.7893; train_gene_expr_recon_loss: 2219937.7125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4205013.8393; train_optim_loss: 4205013.8393; val_kl_reg_loss: 12035.5857; val_edge_recon_loss: 1342685.7656; val_cat_covariates_contrastive_loss: 634710.4766; val_gene_expr_recon_loss: 2279145.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4268577.5625; val_optim_loss: 4268577.5625
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9264; val_auprc_score: 0.9572; val_best_acc_score: 0.9307; val_best_f1_score: 0.9541; train_kl_reg_loss: 12140.0883; train_edge_recon_loss: 1322232.0661; train_cat_covariates_contrastive_loss: 635240.0357; train_gene_expr_recon_loss: 2222207.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4191819.2821; train_optim_loss: 4191819.2821; val_kl_reg_loss: 12010.0194; val_edge_recon_loss: 1330708.4688; val_cat_covariates_contrastive_loss: 631643.8672; val_gene_expr_recon_loss: 2285268.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4259631.1250; val_optim_loss: 4259631.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9181; val_auprc_score: 0.9496; val_best_acc_score: 0.9283; val_best_f1_score: 0.9535; train_kl_reg_loss: 12130.0601; train_edge_recon_loss: 1330395.5161; train_cat_covariates_contrastive_loss: 633754.5527; train_gene_expr_recon_loss: 2220844.7929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4197124.9571; train_optim_loss: 4197124.9571; val_kl_reg_loss: 12117.0308; val_edge_recon_loss: 1335120.1875; val_cat_covariates_contrastive_loss: 632823.5469; val_gene_expr_recon_loss: 2273854.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4253915.5000; val_optim_loss: 4253915.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9266; val_auprc_score: 0.9575; val_best_acc_score: 0.9262; val_best_f1_score: 0.9517; train_kl_reg_loss: 12110.0406; train_edge_recon_loss: 1329691.8446; train_cat_covariates_contrastive_loss: 633915.6732; train_gene_expr_recon_loss: 2224144.2732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4199861.8429; train_optim_loss: 4199861.8429; val_kl_reg_loss: 11998.3312; val_edge_recon_loss: 1380267.7969; val_cat_covariates_contrastive_loss: 639837.4688; val_gene_expr_recon_loss: 2277869.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4309973.5000; val_optim_loss: 4309973.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9339; val_auprc_score: 0.9569; val_best_acc_score: 0.9342; val_best_f1_score: 0.9570; train_kl_reg_loss: 12135.4774; train_edge_recon_loss: 1335289.7911; train_cat_covariates_contrastive_loss: 634784.2973; train_gene_expr_recon_loss: 2224208.6393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4206418.2250; train_optim_loss: 4206418.2250; val_kl_reg_loss: 12080.9917; val_edge_recon_loss: 1327363.8438; val_cat_covariates_contrastive_loss: 634953.9766; val_gene_expr_recon_loss: 2278110.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4252508.8750; val_optim_loss: 4252508.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9296; val_auprc_score: 0.9567; val_best_acc_score: 0.9277; val_best_f1_score: 0.9528; train_kl_reg_loss: 12089.9800; train_edge_recon_loss: 1344553.0625; train_cat_covariates_contrastive_loss: 635798.5054; train_gene_expr_recon_loss: 2220246.6161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4212688.1607; train_optim_loss: 4212688.1607; val_kl_reg_loss: 12050.2972; val_edge_recon_loss: 1353036.8438; val_cat_covariates_contrastive_loss: 632698.0469; val_gene_expr_recon_loss: 2281405.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4279190.9688; val_optim_loss: 4279190.9688

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 58 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9236
val AUPRC score: 0.9592
val best accuracy score: 0.9303
val best F1 score: 0.9549
val target rna MSE score: 0.5598
val source rna MSE score: 0.0562
Val cat covariate0 mean sim diff: 0.0034
Val cat covariate1 mean sim diff: 0.0034
Duration of model training in run 5: 0 hours, 11 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7580; val_auprc_score: 0.9008; val_best_acc_score: 0.7738; val_best_f1_score: 0.8659; train_kl_reg_loss: 3353.4186; train_edge_recon_loss: 1825597.8856; train_cat_covariates_contrastive_loss: 757268.4309; train_gene_expr_recon_loss: 3284832.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5871052.4468; train_optim_loss: 5871052.4468; val_kl_reg_loss: 4230.1803; val_edge_recon_loss: 1846632.5625; val_cat_covariates_contrastive_loss: 627119.5104; val_gene_expr_recon_loss: 2879692.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5357674.5000; val_optim_loss: 5357674.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7481; val_auprc_score: 0.8970; val_best_acc_score: 0.7895; val_best_f1_score: 0.8742; train_kl_reg_loss: 11418.1143; train_edge_recon_loss: 1597656.1596; train_cat_covariates_contrastive_loss: 639113.6902; train_gene_expr_recon_loss: 2792494.1862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5040682.1702; train_optim_loss: 5040682.1702; val_kl_reg_loss: 16096.7956; val_edge_recon_loss: 1674373.6250; val_cat_covariates_contrastive_loss: 627153.0000; val_gene_expr_recon_loss: 2662689.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4980312.5000; val_optim_loss: 4980312.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7484; val_auprc_score: 0.8960; val_best_acc_score: 0.7810; val_best_f1_score: 0.8681; train_kl_reg_loss: 12878.4945; train_edge_recon_loss: 1566811.9707; train_cat_covariates_contrastive_loss: 631185.1130; train_gene_expr_recon_loss: 2651218.5372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4862094.1064; train_optim_loss: 4862094.1064; val_kl_reg_loss: 12840.2502; val_edge_recon_loss: 1648990.6875; val_cat_covariates_contrastive_loss: 628146.9583; val_gene_expr_recon_loss: 2577085.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4867063.7500; val_optim_loss: 4867063.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7866; val_auprc_score: 0.9089; val_best_acc_score: 0.7943; val_best_f1_score: 0.8731; train_kl_reg_loss: 13947.6810; train_edge_recon_loss: 1507576.1755; train_cat_covariates_contrastive_loss: 633985.2939; train_gene_expr_recon_loss: 2596713.8936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4752223.0532; train_optim_loss: 4752223.0532; val_kl_reg_loss: 13230.2855; val_edge_recon_loss: 1596878.3750; val_cat_covariates_contrastive_loss: 628975.7917; val_gene_expr_recon_loss: 2550257.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789342.2500; val_optim_loss: 4789342.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8082; val_auprc_score: 0.9186; val_best_acc_score: 0.8164; val_best_f1_score: 0.8858; train_kl_reg_loss: 13183.3671; train_edge_recon_loss: 1476142.2899; train_cat_covariates_contrastive_loss: 632778.7301; train_gene_expr_recon_loss: 2564576.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4686680.9043; train_optim_loss: 4686680.9043; val_kl_reg_loss: 11604.2119; val_edge_recon_loss: 1431027.5000; val_cat_covariates_contrastive_loss: 632334.6771; val_gene_expr_recon_loss: 2471645.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4546611.7500; val_optim_loss: 4546611.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8197; val_auprc_score: 0.9241; val_best_acc_score: 0.8205; val_best_f1_score: 0.8865; train_kl_reg_loss: 13830.6963; train_edge_recon_loss: 1438571.1277; train_cat_covariates_contrastive_loss: 634796.2061; train_gene_expr_recon_loss: 2545512.4628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4632710.4787; train_optim_loss: 4632710.4787; val_kl_reg_loss: 14482.4045; val_edge_recon_loss: 1435338.0417; val_cat_covariates_contrastive_loss: 632632.5000; val_gene_expr_recon_loss: 2497943.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4580396.4167; val_optim_loss: 4580396.4167
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8338; val_auprc_score: 0.9290; val_best_acc_score: 0.8357; val_best_f1_score: 0.8967; train_kl_reg_loss: 13250.2497; train_edge_recon_loss: 1445676.4362; train_cat_covariates_contrastive_loss: 633668.8497; train_gene_expr_recon_loss: 2526293.5266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4618889.0851; train_optim_loss: 4618889.0851; val_kl_reg_loss: 11534.3921; val_edge_recon_loss: 1416266.3750; val_cat_covariates_contrastive_loss: 633660.4479; val_gene_expr_recon_loss: 2494915.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4556376.6667; val_optim_loss: 4556376.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8555; val_auprc_score: 0.9356; val_best_acc_score: 0.8402; val_best_f1_score: 0.8979; train_kl_reg_loss: 12104.1214; train_edge_recon_loss: 1410170.4734; train_cat_covariates_contrastive_loss: 634846.4269; train_gene_expr_recon_loss: 2515756.1223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4572877.1064; train_optim_loss: 4572877.1064; val_kl_reg_loss: 12239.4342; val_edge_recon_loss: 1456792.1458; val_cat_covariates_contrastive_loss: 634772.5208; val_gene_expr_recon_loss: 2470373.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574177.6667; val_optim_loss: 4574177.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8723; val_auprc_score: 0.9423; val_best_acc_score: 0.8567; val_best_f1_score: 0.9076; train_kl_reg_loss: 11643.7193; train_edge_recon_loss: 1388162.1250; train_cat_covariates_contrastive_loss: 635457.6436; train_gene_expr_recon_loss: 2500511.1809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4535774.6915; train_optim_loss: 4535774.6915; val_kl_reg_loss: 11175.5295; val_edge_recon_loss: 1432866.9375; val_cat_covariates_contrastive_loss: 641482.0938; val_gene_expr_recon_loss: 2461659.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4547184.4167; val_optim_loss: 4547184.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8668; val_auprc_score: 0.9442; val_best_acc_score: 0.8534; val_best_f1_score: 0.9073; train_kl_reg_loss: 11242.1586; train_edge_recon_loss: 1400935.5293; train_cat_covariates_contrastive_loss: 636031.8803; train_gene_expr_recon_loss: 2491101.8298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4539311.4149; train_optim_loss: 4539311.4149; val_kl_reg_loss: 11050.1092; val_edge_recon_loss: 1392505.7708; val_cat_covariates_contrastive_loss: 636074.9479; val_gene_expr_recon_loss: 2457371.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4497002.0833; val_optim_loss: 4497002.0833
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8749; val_auprc_score: 0.9391; val_best_acc_score: 0.8667; val_best_f1_score: 0.9136; train_kl_reg_loss: 11371.2930; train_edge_recon_loss: 1347248.3298; train_cat_covariates_contrastive_loss: 634801.2194; train_gene_expr_recon_loss: 2495370.7660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4488791.5851; train_optim_loss: 4488791.5851; val_kl_reg_loss: 11113.8701; val_edge_recon_loss: 1465209.2917; val_cat_covariates_contrastive_loss: 633468.3542; val_gene_expr_recon_loss: 2462457.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4572248.8333; val_optim_loss: 4572248.8333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8559; val_auprc_score: 0.9303; val_best_acc_score: 0.8438; val_best_f1_score: 0.9000; train_kl_reg_loss: 11399.2709; train_edge_recon_loss: 1380571.3191; train_cat_covariates_contrastive_loss: 633932.1090; train_gene_expr_recon_loss: 2488971.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4514874.3404; train_optim_loss: 4514874.3404; val_kl_reg_loss: 11281.3454; val_edge_recon_loss: 1465102.0208; val_cat_covariates_contrastive_loss: 637876.9167; val_gene_expr_recon_loss: 2467386.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4581646.9167; val_optim_loss: 4581646.9167
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8351; val_auprc_score: 0.9278; val_best_acc_score: 0.8491; val_best_f1_score: 0.9053; train_kl_reg_loss: 11410.3269; train_edge_recon_loss: 1398427.2447; train_cat_covariates_contrastive_loss: 633999.2912; train_gene_expr_recon_loss: 2484102.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4527939.2447; train_optim_loss: 4527939.2447; val_kl_reg_loss: 11236.4269; val_edge_recon_loss: 1442712.8750; val_cat_covariates_contrastive_loss: 635721.3021; val_gene_expr_recon_loss: 2459152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4548822.5833; val_optim_loss: 4548822.5833
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8437; val_auprc_score: 0.9210; val_best_acc_score: 0.8450; val_best_f1_score: 0.8998; train_kl_reg_loss: 11383.6938; train_edge_recon_loss: 1368400.1090; train_cat_covariates_contrastive_loss: 633325.3949; train_gene_expr_recon_loss: 2486062.9840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4499172.1596; train_optim_loss: 4499172.1596; val_kl_reg_loss: 11224.3395; val_edge_recon_loss: 1519167.2500; val_cat_covariates_contrastive_loss: 630183.7292; val_gene_expr_recon_loss: 2464248.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4624823.4167; val_optim_loss: 4624823.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8756; val_auprc_score: 0.9497; val_best_acc_score: 0.8711; val_best_f1_score: 0.9182; train_kl_reg_loss: 11301.6702; train_edge_recon_loss: 1377687.0399; train_cat_covariates_contrastive_loss: 634311.1582; train_gene_expr_recon_loss: 2486777.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4510076.9840; train_optim_loss: 4510076.9840; val_kl_reg_loss: 11159.2591; val_edge_recon_loss: 1281288.6875; val_cat_covariates_contrastive_loss: 633706.1875; val_gene_expr_recon_loss: 2472261.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4398415.4167; val_optim_loss: 4398415.4167
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8594; val_auprc_score: 0.9291; val_best_acc_score: 0.8558; val_best_f1_score: 0.9051; train_kl_reg_loss: 11292.8035; train_edge_recon_loss: 1391107.2101; train_cat_covariates_contrastive_loss: 635101.2274; train_gene_expr_recon_loss: 2481977.5372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4519478.8085; train_optim_loss: 4519478.8085; val_kl_reg_loss: 11016.9985; val_edge_recon_loss: 1494393.8333; val_cat_covariates_contrastive_loss: 633901.9375; val_gene_expr_recon_loss: 2494986.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4634299.2500; val_optim_loss: 4634299.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8641; val_auprc_score: 0.9369; val_best_acc_score: 0.8543; val_best_f1_score: 0.9067; train_kl_reg_loss: 11266.2329; train_edge_recon_loss: 1380101.9335; train_cat_covariates_contrastive_loss: 633197.2221; train_gene_expr_recon_loss: 2488170.8883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512736.2872; train_optim_loss: 4512736.2872; val_kl_reg_loss: 11053.7222; val_edge_recon_loss: 1404411.0417; val_cat_covariates_contrastive_loss: 630643.9062; val_gene_expr_recon_loss: 2433231.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4479340.0000; val_optim_loss: 4479340.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8718; val_auprc_score: 0.9330; val_best_acc_score: 0.8674; val_best_f1_score: 0.9123; train_kl_reg_loss: 11363.8704; train_edge_recon_loss: 1388405.4282; train_cat_covariates_contrastive_loss: 632372.9641; train_gene_expr_recon_loss: 2480426.2128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512568.4787; train_optim_loss: 4512568.4787; val_kl_reg_loss: 11143.1545; val_edge_recon_loss: 1410304.8542; val_cat_covariates_contrastive_loss: 639389.5208; val_gene_expr_recon_loss: 2444612.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4505450.3333; val_optim_loss: 4505450.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8719; val_auprc_score: 0.9458; val_best_acc_score: 0.8602; val_best_f1_score: 0.9113; train_kl_reg_loss: 11322.2586; train_edge_recon_loss: 1389444.3803; train_cat_covariates_contrastive_loss: 633852.8537; train_gene_expr_recon_loss: 2481416.1543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4516035.6064; train_optim_loss: 4516035.6064; val_kl_reg_loss: 11148.7148; val_edge_recon_loss: 1331901.5625; val_cat_covariates_contrastive_loss: 632231.7396; val_gene_expr_recon_loss: 2456108.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4431390.5000; val_optim_loss: 4431390.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8419; val_auprc_score: 0.9262; val_best_acc_score: 0.8453; val_best_f1_score: 0.9004; train_kl_reg_loss: 11326.5788; train_edge_recon_loss: 1380987.2872; train_cat_covariates_contrastive_loss: 634075.7899; train_gene_expr_recon_loss: 2479434.4628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4505824.0851; train_optim_loss: 4505824.0851; val_kl_reg_loss: 11066.5669; val_edge_recon_loss: 1469245.4167; val_cat_covariates_contrastive_loss: 632423.7917; val_gene_expr_recon_loss: 2457053.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4569789.1667; val_optim_loss: 4569789.1667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8557; val_auprc_score: 0.9266; val_best_acc_score: 0.8564; val_best_f1_score: 0.9062; train_kl_reg_loss: 11326.3436; train_edge_recon_loss: 1395102.4894; train_cat_covariates_contrastive_loss: 633214.8338; train_gene_expr_recon_loss: 2477634.0691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4517277.7766; train_optim_loss: 4517277.7766; val_kl_reg_loss: 11094.4863; val_edge_recon_loss: 1436840.3542; val_cat_covariates_contrastive_loss: 636062.3333; val_gene_expr_recon_loss: 2419815.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4503813.0833; val_optim_loss: 4503813.0833
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8858; val_auprc_score: 0.9494; val_best_acc_score: 0.8607; val_best_f1_score: 0.9109; train_kl_reg_loss: 11314.5165; train_edge_recon_loss: 1366091.8032; train_cat_covariates_contrastive_loss: 633463.1649; train_gene_expr_recon_loss: 2476985.5532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4487855.0213; train_optim_loss: 4487855.0213; val_kl_reg_loss: 11165.6882; val_edge_recon_loss: 1419851.0417; val_cat_covariates_contrastive_loss: 631912.6667; val_gene_expr_recon_loss: 2481132.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4544062.0833; val_optim_loss: 4544062.0833
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8787; val_auprc_score: 0.9505; val_best_acc_score: 0.8713; val_best_f1_score: 0.9191; train_kl_reg_loss: 11319.3157; train_edge_recon_loss: 1361188.2447; train_cat_covariates_contrastive_loss: 633584.0253; train_gene_expr_recon_loss: 2479416.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4485508.1489; train_optim_loss: 4485508.1489; val_kl_reg_loss: 11093.7334; val_edge_recon_loss: 1303739.6875; val_cat_covariates_contrastive_loss: 638954.1979; val_gene_expr_recon_loss: 2473485.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427273.3333; val_optim_loss: 4427273.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 43 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
val AUROC score: 0.8714
val AUPRC score: 0.9370
val best accuracy score: 0.8571
val best F1 score: 0.9054
val target rna MSE score: 0.7465
val source rna MSE score: 0.1080
Val cat covariate0 mean sim diff: -0.0050
Val cat covariate1 mean sim diff: -0.0050
Duration of model training in run 4: 0 hours, 2 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7377; val_auprc_score: 0.9003; val_best_acc_score: 0.7706; val_best_f1_score: 0.8670; train_kl_reg_loss: 2836.2654; train_edge_recon_loss: 1801207.0691; train_cat_covariates_contrastive_loss: 769114.6636; train_gene_expr_recon_loss: 3266000.2606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5839158.2340; train_optim_loss: 5839158.2340; val_kl_reg_loss: 3573.9907; val_edge_recon_loss: 1901304.3958; val_cat_covariates_contrastive_loss: 627431.6458; val_gene_expr_recon_loss: 2844852.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5377162.7500; val_optim_loss: 5377162.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7373; val_auprc_score: 0.8890; val_best_acc_score: 0.7630; val_best_f1_score: 0.8562; train_kl_reg_loss: 8549.9836; train_edge_recon_loss: 1624645.8378; train_cat_covariates_contrastive_loss: 637480.7633; train_gene_expr_recon_loss: 2796325.5053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5067002.0957; train_optim_loss: 5067002.0957; val_kl_reg_loss: 10790.0599; val_edge_recon_loss: 1725645.5833; val_cat_covariates_contrastive_loss: 627094.1458; val_gene_expr_recon_loss: 2626961.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4990491.0833; val_optim_loss: 4990491.0833
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7585; val_auprc_score: 0.8961; val_best_acc_score: 0.7815; val_best_f1_score: 0.8649; train_kl_reg_loss: 12609.3819; train_edge_recon_loss: 1555354.1729; train_cat_covariates_contrastive_loss: 630937.0346; train_gene_expr_recon_loss: 2644013.6809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842914.2766; train_optim_loss: 4842914.2766; val_kl_reg_loss: 12796.0008; val_edge_recon_loss: 1599153.1250; val_cat_covariates_contrastive_loss: 627504.3646; val_gene_expr_recon_loss: 2577967.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817420.6667; val_optim_loss: 4817420.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7767; val_auprc_score: 0.9050; val_best_acc_score: 0.7864; val_best_f1_score: 0.8688; train_kl_reg_loss: 11864.4111; train_edge_recon_loss: 1543080.5532; train_cat_covariates_contrastive_loss: 633622.3949; train_gene_expr_recon_loss: 2602044.7340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4790612.1064; train_optim_loss: 4790612.1064; val_kl_reg_loss: 12792.4367; val_edge_recon_loss: 1631365.1250; val_cat_covariates_contrastive_loss: 627424.3333; val_gene_expr_recon_loss: 2551334.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822916.6667; val_optim_loss: 4822916.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7713; val_auprc_score: 0.8951; val_best_acc_score: 0.7890; val_best_f1_score: 0.8710; train_kl_reg_loss: 11582.2568; train_edge_recon_loss: 1496094.4654; train_cat_covariates_contrastive_loss: 634227.4761; train_gene_expr_recon_loss: 2571592.7181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4713496.9362; train_optim_loss: 4713496.9362; val_kl_reg_loss: 12636.9261; val_edge_recon_loss: 1602472.3958; val_cat_covariates_contrastive_loss: 629685.9479; val_gene_expr_recon_loss: 2523530.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768325.2500; val_optim_loss: 4768325.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8216; val_auprc_score: 0.9255; val_best_acc_score: 0.8085; val_best_f1_score: 0.8821; train_kl_reg_loss: 12827.3000; train_edge_recon_loss: 1468238.0532; train_cat_covariates_contrastive_loss: 632529.3497; train_gene_expr_recon_loss: 2557851.3830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4671446.0957; train_optim_loss: 4671446.0957; val_kl_reg_loss: 11949.4870; val_edge_recon_loss: 1523044.0000; val_cat_covariates_contrastive_loss: 631584.3021; val_gene_expr_recon_loss: 2499893.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4666471.2500; val_optim_loss: 4666471.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8202; val_auprc_score: 0.9175; val_best_acc_score: 0.8277; val_best_f1_score: 0.8928; train_kl_reg_loss: 11784.3660; train_edge_recon_loss: 1415148.3644; train_cat_covariates_contrastive_loss: 634649.0532; train_gene_expr_recon_loss: 2530607.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4592188.7872; train_optim_loss: 4592188.7872; val_kl_reg_loss: 11523.8125; val_edge_recon_loss: 1474738.6042; val_cat_covariates_contrastive_loss: 635186.0208; val_gene_expr_recon_loss: 2472875.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4594323.6667; val_optim_loss: 4594323.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8534; val_auprc_score: 0.9376; val_best_acc_score: 0.8382; val_best_f1_score: 0.8973; train_kl_reg_loss: 11218.8940; train_edge_recon_loss: 1429771.8484; train_cat_covariates_contrastive_loss: 635400.7380; train_gene_expr_recon_loss: 2520013.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4596404.9468; train_optim_loss: 4596404.9468; val_kl_reg_loss: 10557.1637; val_edge_recon_loss: 1442499.8542; val_cat_covariates_contrastive_loss: 639460.6354; val_gene_expr_recon_loss: 2487576.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4580094.4167; val_optim_loss: 4580094.4167
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8410; val_auprc_score: 0.9307; val_best_acc_score: 0.8288; val_best_f1_score: 0.8935; train_kl_reg_loss: 10844.7316; train_edge_recon_loss: 1404200.2952; train_cat_covariates_contrastive_loss: 634973.8856; train_gene_expr_recon_loss: 2511472.5213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561491.4043; train_optim_loss: 4561491.4043; val_kl_reg_loss: 10889.1704; val_edge_recon_loss: 1465454.5625; val_cat_covariates_contrastive_loss: 635484.2292; val_gene_expr_recon_loss: 2462668.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574496.4167; val_optim_loss: 4574496.4167
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8688; val_auprc_score: 0.9455; val_best_acc_score: 0.8555; val_best_f1_score: 0.9106; train_kl_reg_loss: 10981.0909; train_edge_recon_loss: 1388694.3298; train_cat_covariates_contrastive_loss: 634286.0426; train_gene_expr_recon_loss: 2485575.9947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4519537.4574; train_optim_loss: 4519537.4574; val_kl_reg_loss: 10691.2858; val_edge_recon_loss: 1368393.2708; val_cat_covariates_contrastive_loss: 639872.6771; val_gene_expr_recon_loss: 2454239.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4473196.9167; val_optim_loss: 4473196.9167
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8490; val_auprc_score: 0.9290; val_best_acc_score: 0.8473; val_best_f1_score: 0.9041; train_kl_reg_loss: 11126.4179; train_edge_recon_loss: 1377976.5106; train_cat_covariates_contrastive_loss: 633327.4043; train_gene_expr_recon_loss: 2485944.9840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4508375.2872; train_optim_loss: 4508375.2872; val_kl_reg_loss: 10666.9523; val_edge_recon_loss: 1434045.0833; val_cat_covariates_contrastive_loss: 632743.5208; val_gene_expr_recon_loss: 2459808.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4537263.8333; val_optim_loss: 4537263.8333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8680; val_auprc_score: 0.9374; val_best_acc_score: 0.8611; val_best_f1_score: 0.9103; train_kl_reg_loss: 10820.9991; train_edge_recon_loss: 1376994.4894; train_cat_covariates_contrastive_loss: 633724.1476; train_gene_expr_recon_loss: 2463661.5479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4485201.1383; train_optim_loss: 4485201.1383; val_kl_reg_loss: 10732.9941; val_edge_recon_loss: 1525243.2292; val_cat_covariates_contrastive_loss: 634407.5312; val_gene_expr_recon_loss: 2422583.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4592966.7500; val_optim_loss: 4592966.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8682; val_auprc_score: 0.9345; val_best_acc_score: 0.8648; val_best_f1_score: 0.9121; train_kl_reg_loss: 10840.4615; train_edge_recon_loss: 1373380.9840; train_cat_covariates_contrastive_loss: 633790.6476; train_gene_expr_recon_loss: 2459237.3245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4477249.4043; train_optim_loss: 4477249.4043; val_kl_reg_loss: 10500.4551; val_edge_recon_loss: 1421285.0833; val_cat_covariates_contrastive_loss: 635988.9792; val_gene_expr_recon_loss: 2442507.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4510282.0000; val_optim_loss: 4510282.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8814; val_auprc_score: 0.9427; val_best_acc_score: 0.8823; val_best_f1_score: 0.9246; train_kl_reg_loss: 10532.9154; train_edge_recon_loss: 1362059.6835; train_cat_covariates_contrastive_loss: 632193.2660; train_gene_expr_recon_loss: 2444744.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4449530.6170; train_optim_loss: 4449530.6170; val_kl_reg_loss: 10076.2227; val_edge_recon_loss: 1377522.0625; val_cat_covariates_contrastive_loss: 634043.3021; val_gene_expr_recon_loss: 2397115.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4418757.5000; val_optim_loss: 4418757.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8792; val_auprc_score: 0.9457; val_best_acc_score: 0.8727; val_best_f1_score: 0.9198; train_kl_reg_loss: 10661.0002; train_edge_recon_loss: 1379924.9628; train_cat_covariates_contrastive_loss: 633002.5293; train_gene_expr_recon_loss: 2440926.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4464515.0957; train_optim_loss: 4464515.0957; val_kl_reg_loss: 10196.6317; val_edge_recon_loss: 1370879.9167; val_cat_covariates_contrastive_loss: 633853.4688; val_gene_expr_recon_loss: 2410681.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4425611.5000; val_optim_loss: 4425611.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8864; val_auprc_score: 0.9490; val_best_acc_score: 0.8903; val_best_f1_score: 0.9291; train_kl_reg_loss: 10286.8113; train_edge_recon_loss: 1365225.4335; train_cat_covariates_contrastive_loss: 633013.8311; train_gene_expr_recon_loss: 2430186.4468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4438712.5638; train_optim_loss: 4438712.5638; val_kl_reg_loss: 10142.9701; val_edge_recon_loss: 1342207.3750; val_cat_covariates_contrastive_loss: 630625.5417; val_gene_expr_recon_loss: 2398395.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4381371.7500; val_optim_loss: 4381371.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8961; val_auprc_score: 0.9472; val_best_acc_score: 0.8888; val_best_f1_score: 0.9282; train_kl_reg_loss: 10216.0622; train_edge_recon_loss: 1353381.6436; train_cat_covariates_contrastive_loss: 631827.6742; train_gene_expr_recon_loss: 2426066.6277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4421491.9734; train_optim_loss: 4421491.9734; val_kl_reg_loss: 9980.5794; val_edge_recon_loss: 1395838.6875; val_cat_covariates_contrastive_loss: 628965.3021; val_gene_expr_recon_loss: 2391938.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4426723.4167; val_optim_loss: 4426723.4167
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8847; val_auprc_score: 0.9412; val_best_acc_score: 0.8865; val_best_f1_score: 0.9263; train_kl_reg_loss: 10403.7625; train_edge_recon_loss: 1367701.5984; train_cat_covariates_contrastive_loss: 632513.3604; train_gene_expr_recon_loss: 2417896.5851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428515.3830; train_optim_loss: 4428515.3830; val_kl_reg_loss: 10171.7983; val_edge_recon_loss: 1322314.5208; val_cat_covariates_contrastive_loss: 638689.4271; val_gene_expr_recon_loss: 2371708.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4342884.0417; val_optim_loss: 4342884.0417
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9047; val_auprc_score: 0.9484; val_best_acc_score: 0.8911; val_best_f1_score: 0.9285; train_kl_reg_loss: 10291.2940; train_edge_recon_loss: 1354258.7447; train_cat_covariates_contrastive_loss: 632966.9694; train_gene_expr_recon_loss: 2407718.8564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4405235.9043; train_optim_loss: 4405235.9043; val_kl_reg_loss: 9994.7668; val_edge_recon_loss: 1441117.3958; val_cat_covariates_contrastive_loss: 635353.7812; val_gene_expr_recon_loss: 2364587.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4451052.9167; val_optim_loss: 4451052.9167
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9023; val_auprc_score: 0.9459; val_best_acc_score: 0.8935; val_best_f1_score: 0.9316; train_kl_reg_loss: 10135.8927; train_edge_recon_loss: 1337681.7646; train_cat_covariates_contrastive_loss: 633458.7713; train_gene_expr_recon_loss: 2397943.4947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4379219.9309; train_optim_loss: 4379219.9309; val_kl_reg_loss: 9817.7786; val_edge_recon_loss: 1424161.4375; val_cat_covariates_contrastive_loss: 637081.0625; val_gene_expr_recon_loss: 2359312.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4430372.5000; val_optim_loss: 4430372.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8941; val_auprc_score: 0.9476; val_best_acc_score: 0.8976; val_best_f1_score: 0.9342; train_kl_reg_loss: 10134.4435; train_edge_recon_loss: 1332135.5505; train_cat_covariates_contrastive_loss: 633665.2460; train_gene_expr_recon_loss: 2392600.7979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4368536.0798; train_optim_loss: 4368536.0798; val_kl_reg_loss: 10204.9214; val_edge_recon_loss: 1305822.5417; val_cat_covariates_contrastive_loss: 636070.3854; val_gene_expr_recon_loss: 2351548.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4303646.5833; val_optim_loss: 4303646.5833
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9058; val_auprc_score: 0.9540; val_best_acc_score: 0.8954; val_best_f1_score: 0.9335; train_kl_reg_loss: 10244.7575; train_edge_recon_loss: 1353331.3590; train_cat_covariates_contrastive_loss: 632292.5997; train_gene_expr_recon_loss: 2376119.8511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4371988.5798; train_optim_loss: 4371988.5798; val_kl_reg_loss: 9874.3314; val_edge_recon_loss: 1283926.3021; val_cat_covariates_contrastive_loss: 632139.9167; val_gene_expr_recon_loss: 2359234.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4285175.3333; val_optim_loss: 4285175.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9170; val_auprc_score: 0.9614; val_best_acc_score: 0.9150; val_best_f1_score: 0.9457; train_kl_reg_loss: 10207.9038; train_edge_recon_loss: 1356704.8457; train_cat_covariates_contrastive_loss: 634955.6024; train_gene_expr_recon_loss: 2370991.9362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4372860.2926; train_optim_loss: 4372860.2926; val_kl_reg_loss: 10303.7858; val_edge_recon_loss: 1244068.3958; val_cat_covariates_contrastive_loss: 633823.5625; val_gene_expr_recon_loss: 2338513.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4226709.2500; val_optim_loss: 4226709.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8812; val_auprc_score: 0.9447; val_best_acc_score: 0.8946; val_best_f1_score: 0.9328; train_kl_reg_loss: 10222.9820; train_edge_recon_loss: 1357694.1888; train_cat_covariates_contrastive_loss: 632279.5931; train_gene_expr_recon_loss: 2363677.2766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4363874.0160; train_optim_loss: 4363874.0160; val_kl_reg_loss: 10001.0539; val_edge_recon_loss: 1310936.1667; val_cat_covariates_contrastive_loss: 633778.8125; val_gene_expr_recon_loss: 2342549.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4297265.2917; val_optim_loss: 4297265.2917
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9176; val_auprc_score: 0.9608; val_best_acc_score: 0.9060; val_best_f1_score: 0.9394; train_kl_reg_loss: 10178.0706; train_edge_recon_loss: 1333254.1543; train_cat_covariates_contrastive_loss: 633641.5625; train_gene_expr_recon_loss: 2360337.6862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4337411.4947; train_optim_loss: 4337411.4947; val_kl_reg_loss: 10058.1237; val_edge_recon_loss: 1396345.7292; val_cat_covariates_contrastive_loss: 648372.1250; val_gene_expr_recon_loss: 2316203.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4370980.0833; val_optim_loss: 4370980.0833
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9136; val_auprc_score: 0.9576; val_best_acc_score: 0.9124; val_best_f1_score: 0.9420; train_kl_reg_loss: 10228.7930; train_edge_recon_loss: 1320623.3803; train_cat_covariates_contrastive_loss: 632808.8883; train_gene_expr_recon_loss: 2349602.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4313263.9202; train_optim_loss: 4313263.9202; val_kl_reg_loss: 10304.7560; val_edge_recon_loss: 1297359.2604; val_cat_covariates_contrastive_loss: 629900.3125; val_gene_expr_recon_loss: 2372278.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4309842.8333; val_optim_loss: 4309842.8333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9198; val_auprc_score: 0.9624; val_best_acc_score: 0.9071; val_best_f1_score: 0.9394; train_kl_reg_loss: 10173.4030; train_edge_recon_loss: 1347325.3750; train_cat_covariates_contrastive_loss: 633146.7367; train_gene_expr_recon_loss: 2337665.6223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4328311.1223; train_optim_loss: 4328311.1223; val_kl_reg_loss: 10140.2723; val_edge_recon_loss: 1384136.0417; val_cat_covariates_contrastive_loss: 634726.3229; val_gene_expr_recon_loss: 2334814.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4363817.0000; val_optim_loss: 4363817.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9130; val_auprc_score: 0.9607; val_best_acc_score: 0.9106; val_best_f1_score: 0.9426; train_kl_reg_loss: 10163.5202; train_edge_recon_loss: 1340523.2473; train_cat_covariates_contrastive_loss: 632563.2247; train_gene_expr_recon_loss: 2333376.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4316626.3298; train_optim_loss: 4316626.3298; val_kl_reg_loss: 10065.5254; val_edge_recon_loss: 1338339.4583; val_cat_covariates_contrastive_loss: 640153.5521; val_gene_expr_recon_loss: 2327803.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4316362.1667; val_optim_loss: 4316362.1667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9022; val_auprc_score: 0.9467; val_best_acc_score: 0.9129; val_best_f1_score: 0.9439; train_kl_reg_loss: 10202.3451; train_edge_recon_loss: 1336958.8910; train_cat_covariates_contrastive_loss: 635240.1410; train_gene_expr_recon_loss: 2331136.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4313537.8032; train_optim_loss: 4313537.8032; val_kl_reg_loss: 10107.8327; val_edge_recon_loss: 1352363.0625; val_cat_covariates_contrastive_loss: 633086.5729; val_gene_expr_recon_loss: 2307255.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4302813.0000; val_optim_loss: 4302813.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9257; val_auprc_score: 0.9659; val_best_acc_score: 0.9144; val_best_f1_score: 0.9447; train_kl_reg_loss: 10308.3473; train_edge_recon_loss: 1313711.4707; train_cat_covariates_contrastive_loss: 634267.6090; train_gene_expr_recon_loss: 2330954.1064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4289241.5053; train_optim_loss: 4289241.5053; val_kl_reg_loss: 10136.5210; val_edge_recon_loss: 1292065.7708; val_cat_covariates_contrastive_loss: 632472.8125; val_gene_expr_recon_loss: 2330002.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4264677.7500; val_optim_loss: 4264677.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9077; val_auprc_score: 0.9482; val_best_acc_score: 0.9064; val_best_f1_score: 0.9383; train_kl_reg_loss: 10370.7178; train_edge_recon_loss: 1351606.2473; train_cat_covariates_contrastive_loss: 632809.0399; train_gene_expr_recon_loss: 2322797.9255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4317583.9255; train_optim_loss: 4317583.9255; val_kl_reg_loss: 10141.5682; val_edge_recon_loss: 1426057.2083; val_cat_covariates_contrastive_loss: 629420.4375; val_gene_expr_recon_loss: 2323737.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4389356.7917; val_optim_loss: 4389356.7917

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 22 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9023
val AUPRC score: 0.9567
val best accuracy score: 0.9012
val best F1 score: 0.9378
val target rna MSE score: 0.6322
val source rna MSE score: 0.0922
Val cat covariate0 mean sim diff: -0.0150
Val cat covariate1 mean sim diff: -0.0150
Duration of model training in run 3: 0 hours, 4 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7316; val_auprc_score: 0.8861; val_best_acc_score: 0.7749; val_best_f1_score: 0.8714; train_kl_reg_loss: 2983.5151; train_edge_recon_loss: 1862597.1450; train_cat_covariates_contrastive_loss: 829417.7325; train_gene_expr_recon_loss: 3368364.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6063363.2800; train_optim_loss: 6063363.2800; val_kl_reg_loss: 3175.0321; val_edge_recon_loss: 1912255.4583; val_cat_covariates_contrastive_loss: 626733.2917; val_gene_expr_recon_loss: 3127450.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5669613.8333; val_optim_loss: 5669613.8333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7463; val_auprc_score: 0.9023; val_best_acc_score: 0.7625; val_best_f1_score: 0.8610; train_kl_reg_loss: 3098.2370; train_edge_recon_loss: 1822696.0250; train_cat_covariates_contrastive_loss: 701346.1250; train_gene_expr_recon_loss: 2948312.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5475452.7200; train_optim_loss: 5475452.7200; val_kl_reg_loss: 3557.4059; val_edge_recon_loss: 1998596.7500; val_cat_covariates_contrastive_loss: 627403.2292; val_gene_expr_recon_loss: 2895469.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5525026.5000; val_optim_loss: 5525026.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7032; val_auprc_score: 0.8825; val_best_acc_score: 0.7737; val_best_f1_score: 0.8688; train_kl_reg_loss: 4702.2305; train_edge_recon_loss: 1731820.8350; train_cat_covariates_contrastive_loss: 677321.9750; train_gene_expr_recon_loss: 2766936.7700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5180781.8400; train_optim_loss: 5180781.8400; val_kl_reg_loss: 6418.8117; val_edge_recon_loss: 1648360.2500; val_cat_covariates_contrastive_loss: 627895.6250; val_gene_expr_recon_loss: 2870113.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5152788.3333; val_optim_loss: 5152788.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7042; val_auprc_score: 0.8757; val_best_acc_score: 0.7756; val_best_f1_score: 0.8696; train_kl_reg_loss: 9036.9759; train_edge_recon_loss: 1626375.6700; train_cat_covariates_contrastive_loss: 647424.0075; train_gene_expr_recon_loss: 2679200.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4962037.4800; train_optim_loss: 4962037.4800; val_kl_reg_loss: 7449.4385; val_edge_recon_loss: 1672412.3333; val_cat_covariates_contrastive_loss: 626916.5208; val_gene_expr_recon_loss: 2794270.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5101048.8333; val_optim_loss: 5101048.8333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7289; val_auprc_score: 0.8928; val_best_acc_score: 0.7923; val_best_f1_score: 0.8755; train_kl_reg_loss: 12454.1827; train_edge_recon_loss: 1628540.7400; train_cat_covariates_contrastive_loss: 637438.0100; train_gene_expr_recon_loss: 2640749.9400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4919182.8200; train_optim_loss: 4919182.8200; val_kl_reg_loss: 12322.3128; val_edge_recon_loss: 1609505.0000; val_cat_covariates_contrastive_loss: 626839.1458; val_gene_expr_recon_loss: 2675911.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4924578.3333; val_optim_loss: 4924578.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7198; val_auprc_score: 0.8855; val_best_acc_score: 0.7724; val_best_f1_score: 0.8662; train_kl_reg_loss: 12656.9753; train_edge_recon_loss: 1515731.7650; train_cat_covariates_contrastive_loss: 633556.0225; train_gene_expr_recon_loss: 2600496.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4762441.6600; train_optim_loss: 4762441.6600; val_kl_reg_loss: 13118.9206; val_edge_recon_loss: 1604716.3333; val_cat_covariates_contrastive_loss: 627805.9792; val_gene_expr_recon_loss: 2657338.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4902980.1667; val_optim_loss: 4902980.1667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7407; val_auprc_score: 0.8810; val_best_acc_score: 0.7701; val_best_f1_score: 0.8628; train_kl_reg_loss: 12067.0836; train_edge_recon_loss: 1536278.7850; train_cat_covariates_contrastive_loss: 635743.3825; train_gene_expr_recon_loss: 2577956.6800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4762045.9600; train_optim_loss: 4762045.9600; val_kl_reg_loss: 12491.2285; val_edge_recon_loss: 1708202.2500; val_cat_covariates_contrastive_loss: 631905.6667; val_gene_expr_recon_loss: 2682229.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5034828.6667; val_optim_loss: 5034828.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7432; val_auprc_score: 0.8941; val_best_acc_score: 0.7883; val_best_f1_score: 0.8745; train_kl_reg_loss: 11072.1491; train_edge_recon_loss: 1514867.9600; train_cat_covariates_contrastive_loss: 646188.4150; train_gene_expr_recon_loss: 2554003.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4726132.3000; train_optim_loss: 4726132.3000; val_kl_reg_loss: 12873.4749; val_edge_recon_loss: 1595254.7083; val_cat_covariates_contrastive_loss: 632157.9583; val_gene_expr_recon_loss: 2652441.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4892727.5000; val_optim_loss: 4892727.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7736; val_auprc_score: 0.9079; val_best_acc_score: 0.7832; val_best_f1_score: 0.8679; train_kl_reg_loss: 12681.9402; train_edge_recon_loss: 1459142.2850; train_cat_covariates_contrastive_loss: 662687.4600; train_gene_expr_recon_loss: 2542332.4300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4676844.2000; train_optim_loss: 4676844.2000; val_kl_reg_loss: 13271.0892; val_edge_recon_loss: 1582242.4167; val_cat_covariates_contrastive_loss: 642760.6458; val_gene_expr_recon_loss: 2638587.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4876861.3333; val_optim_loss: 4876861.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8091; val_auprc_score: 0.9217; val_best_acc_score: 0.8015; val_best_f1_score: 0.8715; train_kl_reg_loss: 12442.6101; train_edge_recon_loss: 1529588.4250; train_cat_covariates_contrastive_loss: 689230.5525; train_gene_expr_recon_loss: 2529325.7800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4760587.4000; train_optim_loss: 4760587.4000; val_kl_reg_loss: 12727.9066; val_edge_recon_loss: 1484990.6250; val_cat_covariates_contrastive_loss: 635235.5000; val_gene_expr_recon_loss: 2591815.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4724769.8333; val_optim_loss: 4724769.8333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8089; val_auprc_score: 0.9265; val_best_acc_score: 0.8134; val_best_f1_score: 0.8836; train_kl_reg_loss: 12203.2451; train_edge_recon_loss: 1496250.7200; train_cat_covariates_contrastive_loss: 640824.2975; train_gene_expr_recon_loss: 2527720.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4676998.5600; train_optim_loss: 4676998.5600; val_kl_reg_loss: 12144.2480; val_edge_recon_loss: 1379144.4167; val_cat_covariates_contrastive_loss: 637917.3542; val_gene_expr_recon_loss: 2602435.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4631641.6667; val_optim_loss: 4631641.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7820; val_auprc_score: 0.9053; val_best_acc_score: 0.8108; val_best_f1_score: 0.8802; train_kl_reg_loss: 12284.8218; train_edge_recon_loss: 1448723.5150; train_cat_covariates_contrastive_loss: 635179.2825; train_gene_expr_recon_loss: 2508899.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4605087.5200; train_optim_loss: 4605087.5200; val_kl_reg_loss: 12425.9720; val_edge_recon_loss: 1499260.7500; val_cat_covariates_contrastive_loss: 636048.7083; val_gene_expr_recon_loss: 2569461.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4717197.1667; val_optim_loss: 4717197.1667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8157; val_auprc_score: 0.9173; val_best_acc_score: 0.8078; val_best_f1_score: 0.8788; train_kl_reg_loss: 12637.4846; train_edge_recon_loss: 1406286.3200; train_cat_covariates_contrastive_loss: 665077.9900; train_gene_expr_recon_loss: 2494655.9200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4578657.7600; train_optim_loss: 4578657.7600; val_kl_reg_loss: 12398.3389; val_edge_recon_loss: 1504608.3333; val_cat_covariates_contrastive_loss: 634836.8958; val_gene_expr_recon_loss: 2556983.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4708826.6667; val_optim_loss: 4708826.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8009; val_auprc_score: 0.9237; val_best_acc_score: 0.8167; val_best_f1_score: 0.8868; train_kl_reg_loss: 12313.6130; train_edge_recon_loss: 1418112.7700; train_cat_covariates_contrastive_loss: 653232.1975; train_gene_expr_recon_loss: 2493663.2800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4577321.9000; train_optim_loss: 4577321.9000; val_kl_reg_loss: 13325.0846; val_edge_recon_loss: 1429798.9167; val_cat_covariates_contrastive_loss: 641747.5000; val_gene_expr_recon_loss: 2623610.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4708482.1667; val_optim_loss: 4708482.1667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8048; val_auprc_score: 0.9202; val_best_acc_score: 0.8233; val_best_f1_score: 0.8928; train_kl_reg_loss: 12329.5957; train_edge_recon_loss: 1437487.0650; train_cat_covariates_contrastive_loss: 645783.8875; train_gene_expr_recon_loss: 2489934.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4585535.1600; train_optim_loss: 4585535.1600; val_kl_reg_loss: 12784.0921; val_edge_recon_loss: 1423034.9167; val_cat_covariates_contrastive_loss: 636828.4583; val_gene_expr_recon_loss: 2593611.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4666258.8333; val_optim_loss: 4666258.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8043; val_auprc_score: 0.9203; val_best_acc_score: 0.8007; val_best_f1_score: 0.8751; train_kl_reg_loss: 12251.7752; train_edge_recon_loss: 1374901.1175; train_cat_covariates_contrastive_loss: 683788.7700; train_gene_expr_recon_loss: 2489076.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560018.3200; train_optim_loss: 4560018.3200; val_kl_reg_loss: 12327.0651; val_edge_recon_loss: 1537715.2500; val_cat_covariates_contrastive_loss: 633607.0417; val_gene_expr_recon_loss: 2567236.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4750886.0000; val_optim_loss: 4750886.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8102; val_auprc_score: 0.9144; val_best_acc_score: 0.8215; val_best_f1_score: 0.8828; train_kl_reg_loss: 11988.4938; train_edge_recon_loss: 1405564.3300; train_cat_covariates_contrastive_loss: 639091.8975; train_gene_expr_recon_loss: 2483604.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4540249.5000; train_optim_loss: 4540249.5000; val_kl_reg_loss: 11915.8486; val_edge_recon_loss: 1457024.9583; val_cat_covariates_contrastive_loss: 635763.4167; val_gene_expr_recon_loss: 2582284.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4686988.5000; val_optim_loss: 4686988.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8175; val_auprc_score: 0.9202; val_best_acc_score: 0.8130; val_best_f1_score: 0.8827; train_kl_reg_loss: 11870.0425; train_edge_recon_loss: 1416730.7150; train_cat_covariates_contrastive_loss: 689393.5250; train_gene_expr_recon_loss: 2467794.1700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4585788.4200; train_optim_loss: 4585788.4200; val_kl_reg_loss: 12367.1367; val_edge_recon_loss: 1478117.6667; val_cat_covariates_contrastive_loss: 632143.5000; val_gene_expr_recon_loss: 2597784.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4720412.5000; val_optim_loss: 4720412.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8109; val_auprc_score: 0.9166; val_best_acc_score: 0.8174; val_best_f1_score: 0.8863; train_kl_reg_loss: 11939.5952; train_edge_recon_loss: 1412744.6700; train_cat_covariates_contrastive_loss: 708387.8975; train_gene_expr_recon_loss: 2475190.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4608262.3400; train_optim_loss: 4608262.3400; val_kl_reg_loss: 12216.2975; val_edge_recon_loss: 1526840.7500; val_cat_covariates_contrastive_loss: 635421.9375; val_gene_expr_recon_loss: 2563794.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4738273.6667; val_optim_loss: 4738273.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 2 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
val AUROC score: 0.8095
val AUPRC score: 0.9222
val best accuracy score: 0.8120
val best F1 score: 0.8809
val target rna MSE score: 0.8259
val source rna MSE score: 0.2201
Val cat covariate0 mean sim diff: 0.0192
Val cat covariate1 mean sim diff: 0.0192
Duration of model training in run 2: 0 hours, 1 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7532; val_auprc_score: 0.8966; val_best_acc_score: 0.7881; val_best_f1_score: 0.8731; train_kl_reg_loss: 3395.5714; train_edge_recon_loss: 1823722.5950; train_cat_covariates_contrastive_loss: 816203.8550; train_gene_expr_recon_loss: 3402335.8900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6045657.9600; train_optim_loss: 6045657.9600; val_kl_reg_loss: 2938.5137; val_edge_recon_loss: 2022104.7083; val_cat_covariates_contrastive_loss: 626862.3333; val_gene_expr_recon_loss: 3016415.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5668321.0000; val_optim_loss: 5668321.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6999; val_auprc_score: 0.8727; val_best_acc_score: 0.7751; val_best_f1_score: 0.8696; train_kl_reg_loss: 3849.0210; train_edge_recon_loss: 1717517.1650; train_cat_covariates_contrastive_loss: 702489.5675; train_gene_expr_recon_loss: 3010511.5800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5434367.3200; train_optim_loss: 5434367.3200; val_kl_reg_loss: 5846.3717; val_edge_recon_loss: 1686478.6250; val_cat_covariates_contrastive_loss: 627438.8333; val_gene_expr_recon_loss: 2726195.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5045958.8333; val_optim_loss: 5045958.8333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7489; val_auprc_score: 0.8984; val_best_acc_score: 0.8088; val_best_f1_score: 0.8853; train_kl_reg_loss: 11112.3568; train_edge_recon_loss: 1679766.9750; train_cat_covariates_contrastive_loss: 657873.9700; train_gene_expr_recon_loss: 2815668.2400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5164421.5600; train_optim_loss: 5164421.5600; val_kl_reg_loss: 12430.9128; val_edge_recon_loss: 1457702.4167; val_cat_covariates_contrastive_loss: 626909.7083; val_gene_expr_recon_loss: 2625922.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722965.3333; val_optim_loss: 4722965.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7280; val_auprc_score: 0.8885; val_best_acc_score: 0.7841; val_best_f1_score: 0.8731; train_kl_reg_loss: 14206.2736; train_edge_recon_loss: 1513348.8350; train_cat_covariates_contrastive_loss: 642214.1825; train_gene_expr_recon_loss: 2700097.0700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4869866.3800; train_optim_loss: 4869866.3800; val_kl_reg_loss: 15385.9255; val_edge_recon_loss: 1654844.2500; val_cat_covariates_contrastive_loss: 627065.3958; val_gene_expr_recon_loss: 2700118.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4997414.1667; val_optim_loss: 4997414.1667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7545; val_auprc_score: 0.8876; val_best_acc_score: 0.7902; val_best_f1_score: 0.8743; train_kl_reg_loss: 15220.9907; train_edge_recon_loss: 1593105.2700; train_cat_covariates_contrastive_loss: 635102.1275; train_gene_expr_recon_loss: 2639975.8300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883404.2800; train_optim_loss: 4883404.2800; val_kl_reg_loss: 12757.3763; val_edge_recon_loss: 1612446.1250; val_cat_covariates_contrastive_loss: 626962.7500; val_gene_expr_recon_loss: 2538402.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4790569.3333; val_optim_loss: 4790569.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7495; val_auprc_score: 0.9014; val_best_acc_score: 0.8126; val_best_f1_score: 0.8903; train_kl_reg_loss: 13703.9616; train_edge_recon_loss: 1632829.5150; train_cat_covariates_contrastive_loss: 648729.0625; train_gene_expr_recon_loss: 2592537.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4887799.6400; train_optim_loss: 4887799.6400; val_kl_reg_loss: 15559.7852; val_edge_recon_loss: 1426012.1667; val_cat_covariates_contrastive_loss: 626875.3333; val_gene_expr_recon_loss: 2489062.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4557509.6667; val_optim_loss: 4557509.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7126; val_auprc_score: 0.8745; val_best_acc_score: 0.7773; val_best_f1_score: 0.8701; train_kl_reg_loss: 15852.0169; train_edge_recon_loss: 1544462.8150; train_cat_covariates_contrastive_loss: 636136.8975; train_gene_expr_recon_loss: 2570073.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4766524.9400; train_optim_loss: 4766524.9400; val_kl_reg_loss: 15130.4609; val_edge_recon_loss: 1696437.4167; val_cat_covariates_contrastive_loss: 627351.2708; val_gene_expr_recon_loss: 2468884.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4807803.8333; val_optim_loss: 4807803.8333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7725; val_auprc_score: 0.9088; val_best_acc_score: 0.7952; val_best_f1_score: 0.8744; train_kl_reg_loss: 15173.5841; train_edge_recon_loss: 1454069.3750; train_cat_covariates_contrastive_loss: 638032.5050; train_gene_expr_recon_loss: 2554587.4700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4661862.9200; train_optim_loss: 4661862.9200; val_kl_reg_loss: 14954.0960; val_edge_recon_loss: 1530745.5000; val_cat_covariates_contrastive_loss: 627544.9792; val_gene_expr_recon_loss: 2488631.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4661876.0000; val_optim_loss: 4661876.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7505; val_auprc_score: 0.8945; val_best_acc_score: 0.8004; val_best_f1_score: 0.8791; train_kl_reg_loss: 15833.9542; train_edge_recon_loss: 1450512.2400; train_cat_covariates_contrastive_loss: 651094.5225; train_gene_expr_recon_loss: 2542924.9100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4660365.5800; train_optim_loss: 4660365.5800; val_kl_reg_loss: 14266.1367; val_edge_recon_loss: 1512847.8750; val_cat_covariates_contrastive_loss: 629038.0208; val_gene_expr_recon_loss: 2520823.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676975.6667; val_optim_loss: 4676975.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7647; val_auprc_score: 0.9013; val_best_acc_score: 0.8068; val_best_f1_score: 0.8834; train_kl_reg_loss: 15868.4369; train_edge_recon_loss: 1522170.5950; train_cat_covariates_contrastive_loss: 636617.4275; train_gene_expr_recon_loss: 2539683.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4714339.8000; train_optim_loss: 4714339.8000; val_kl_reg_loss: 14111.1937; val_edge_recon_loss: 1539395.1250; val_cat_covariates_contrastive_loss: 627864.9583; val_gene_expr_recon_loss: 2516789.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4698161.0000; val_optim_loss: 4698161.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7327; val_auprc_score: 0.8905; val_best_acc_score: 0.7912; val_best_f1_score: 0.8738; train_kl_reg_loss: 14070.9764; train_edge_recon_loss: 1586536.8200; train_cat_covariates_contrastive_loss: 653215.4100; train_gene_expr_recon_loss: 2524739.5700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4778562.7600; train_optim_loss: 4778562.7600; val_kl_reg_loss: 14357.0280; val_edge_recon_loss: 1576945.7917; val_cat_covariates_contrastive_loss: 628301.8125; val_gene_expr_recon_loss: 2502401.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722006.0000; val_optim_loss: 4722006.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7575; val_auprc_score: 0.9062; val_best_acc_score: 0.7993; val_best_f1_score: 0.8793; train_kl_reg_loss: 15236.5607; train_edge_recon_loss: 1452552.6850; train_cat_covariates_contrastive_loss: 636987.1325; train_gene_expr_recon_loss: 2519577.9800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4624354.3800; train_optim_loss: 4624354.3800; val_kl_reg_loss: 14388.2900; val_edge_recon_loss: 1535437.5000; val_cat_covariates_contrastive_loss: 629451.9583; val_gene_expr_recon_loss: 2507138.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4686416.1667; val_optim_loss: 4686416.1667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7658; val_auprc_score: 0.9001; val_best_acc_score: 0.7847; val_best_f1_score: 0.8705; train_kl_reg_loss: 15035.6033; train_edge_recon_loss: 1439285.7150; train_cat_covariates_contrastive_loss: 636531.6975; train_gene_expr_recon_loss: 2529258.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4620111.7000; train_optim_loss: 4620111.7000; val_kl_reg_loss: 14500.7894; val_edge_recon_loss: 1588357.5833; val_cat_covariates_contrastive_loss: 629282.5833; val_gene_expr_recon_loss: 2488088.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4720229.5000; val_optim_loss: 4720229.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7546; val_auprc_score: 0.8963; val_best_acc_score: 0.7882; val_best_f1_score: 0.8744; train_kl_reg_loss: 14883.4591; train_edge_recon_loss: 1509534.5300; train_cat_covariates_contrastive_loss: 636865.9950; train_gene_expr_recon_loss: 2517533.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4678817.4000; train_optim_loss: 4678817.4000; val_kl_reg_loss: 14219.3779; val_edge_recon_loss: 1596899.3333; val_cat_covariates_contrastive_loss: 629531.7917; val_gene_expr_recon_loss: 2490503.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731154.3333; val_optim_loss: 4731154.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 46 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
val AUROC score: 0.7171
val AUPRC score: 0.8713
val best accuracy score: 0.7789
val best F1 score: 0.8672
val target rna MSE score: 0.8171
val source rna MSE score: 0.4252
Val cat covariate0 mean sim diff: -0.0049
Val cat covariate1 mean sim diff: -0.0049
Duration of model training in run 1: 0 hours, 0 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
