Run timestamp: 30082023_192351_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7711; val_auprc_score: 0.9098; val_best_acc_score: 0.7925; val_best_f1_score: 0.8761; train_kl_reg_loss: 8622.1661; train_edge_recon_loss: 1705556.0774; train_cat_covariates_contrastive_loss: 691537.1678; train_gene_expr_recon_loss: 3060526.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5466242.3424; train_optim_loss: 5466242.3424; val_kl_reg_loss: 14523.8186; val_edge_recon_loss: 1634527.6932; val_cat_covariates_contrastive_loss: 626824.8068; val_gene_expr_recon_loss: 2737397.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5013274.1364; val_optim_loss: 5013274.1364
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7908; val_auprc_score: 0.9158; val_best_acc_score: 0.8109; val_best_f1_score: 0.8847; train_kl_reg_loss: 15044.2938; train_edge_recon_loss: 1544421.7024; train_cat_covariates_contrastive_loss: 630722.2459; train_gene_expr_recon_loss: 2639990.0815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4830178.3478; train_optim_loss: 4830178.3478; val_kl_reg_loss: 15049.0841; val_edge_recon_loss: 1564475.6250; val_cat_covariates_contrastive_loss: 627476.1989; val_gene_expr_recon_loss: 2638475.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4845476.3182; val_optim_loss: 4845476.3182
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8239; val_auprc_score: 0.9217; val_best_acc_score: 0.8175; val_best_f1_score: 0.8875; train_kl_reg_loss: 12985.8597; train_edge_recon_loss: 1475773.0251; train_cat_covariates_contrastive_loss: 632512.5917; train_gene_expr_recon_loss: 2568109.7582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4689381.2663; train_optim_loss: 4689381.2663; val_kl_reg_loss: 11160.7848; val_edge_recon_loss: 1532496.7159; val_cat_covariates_contrastive_loss: 631596.1420; val_gene_expr_recon_loss: 2558767.0227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4734020.5455; val_optim_loss: 4734020.5455
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8442; val_auprc_score: 0.9311; val_best_acc_score: 0.8443; val_best_f1_score: 0.9013; train_kl_reg_loss: 11621.7049; train_edge_recon_loss: 1426441.0476; train_cat_covariates_contrastive_loss: 633065.5754; train_gene_expr_recon_loss: 2538615.3207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4609743.6359; train_optim_loss: 4609743.6359; val_kl_reg_loss: 10983.9673; val_edge_recon_loss: 1431268.6250; val_cat_covariates_contrastive_loss: 633014.4261; val_gene_expr_recon_loss: 2517211.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4592478.6364; val_optim_loss: 4592478.6364
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8780; val_auprc_score: 0.9387; val_best_acc_score: 0.8756; val_best_f1_score: 0.9199; train_kl_reg_loss: 10771.6546; train_edge_recon_loss: 1396053.9443; train_cat_covariates_contrastive_loss: 633250.4912; train_gene_expr_recon_loss: 2508201.3179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4548277.4239; train_optim_loss: 4548277.4239; val_kl_reg_loss: 10979.9855; val_edge_recon_loss: 1429110.0114; val_cat_covariates_contrastive_loss: 631832.9659; val_gene_expr_recon_loss: 2523467.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4595390.1364; val_optim_loss: 4595390.1364
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8675; val_auprc_score: 0.9331; val_best_acc_score: 0.8709; val_best_f1_score: 0.9183; train_kl_reg_loss: 10486.6851; train_edge_recon_loss: 1373468.4810; train_cat_covariates_contrastive_loss: 631093.9939; train_gene_expr_recon_loss: 2486253.6141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4501302.7717; train_optim_loss: 4501302.7717; val_kl_reg_loss: 10448.2572; val_edge_recon_loss: 1469235.7614; val_cat_covariates_contrastive_loss: 629194.4716; val_gene_expr_recon_loss: 2437878.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4546757.2955; val_optim_loss: 4546757.2955
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8933; val_auprc_score: 0.9489; val_best_acc_score: 0.8905; val_best_f1_score: 0.9300; train_kl_reg_loss: 10220.8091; train_edge_recon_loss: 1365662.2160; train_cat_covariates_contrastive_loss: 630888.7079; train_gene_expr_recon_loss: 2467730.2228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474501.9891; train_optim_loss: 4474501.9891; val_kl_reg_loss: 10082.0030; val_edge_recon_loss: 1356927.3068; val_cat_covariates_contrastive_loss: 630051.2784; val_gene_expr_recon_loss: 2492011.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4489071.9091; val_optim_loss: 4489071.9091
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8838; val_auprc_score: 0.9407; val_best_acc_score: 0.8881; val_best_f1_score: 0.9285; train_kl_reg_loss: 10143.8890; train_edge_recon_loss: 1337012.7473; train_cat_covariates_contrastive_loss: 630908.5944; train_gene_expr_recon_loss: 2447634.9864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4425700.2283; train_optim_loss: 4425700.2283; val_kl_reg_loss: 9515.5807; val_edge_recon_loss: 1369899.2273; val_cat_covariates_contrastive_loss: 630313.5114; val_gene_expr_recon_loss: 2429929.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439658.2273; val_optim_loss: 4439658.2273
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9014; val_auprc_score: 0.9489; val_best_acc_score: 0.8942; val_best_f1_score: 0.9312; train_kl_reg_loss: 10196.8958; train_edge_recon_loss: 1344340.1889; train_cat_covariates_contrastive_loss: 630828.0625; train_gene_expr_recon_loss: 2434255.7147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4419620.8804; train_optim_loss: 4419620.8804; val_kl_reg_loss: 9943.4238; val_edge_recon_loss: 1381848.1932; val_cat_covariates_contrastive_loss: 635242.6364; val_gene_expr_recon_loss: 2431503.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4458538.0909; val_optim_loss: 4458538.0909
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9024; val_auprc_score: 0.9506; val_best_acc_score: 0.9027; val_best_f1_score: 0.9374; train_kl_reg_loss: 9904.6287; train_edge_recon_loss: 1350270.6427; train_cat_covariates_contrastive_loss: 631603.9783; train_gene_expr_recon_loss: 2412552.0679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4404331.3370; train_optim_loss: 4404331.3370; val_kl_reg_loss: 9949.8791; val_edge_recon_loss: 1371727.4773; val_cat_covariates_contrastive_loss: 630614.4091; val_gene_expr_recon_loss: 2407620.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4419912.7955; val_optim_loss: 4419912.7955
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9068; val_auprc_score: 0.9538; val_best_acc_score: 0.9021; val_best_f1_score: 0.9363; train_kl_reg_loss: 10085.0564; train_edge_recon_loss: 1360672.3288; train_cat_covariates_contrastive_loss: 632295.5000; train_gene_expr_recon_loss: 2396013.0054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399065.8967; train_optim_loss: 4399065.8967; val_kl_reg_loss: 10058.6605; val_edge_recon_loss: 1353935.9091; val_cat_covariates_contrastive_loss: 632652.7102; val_gene_expr_recon_loss: 2418604.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4415251.7727; val_optim_loss: 4415251.7727
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9132; val_auprc_score: 0.9544; val_best_acc_score: 0.9102; val_best_f1_score: 0.9420; train_kl_reg_loss: 10010.6970; train_edge_recon_loss: 1339806.2500; train_cat_covariates_contrastive_loss: 631765.8139; train_gene_expr_recon_loss: 2380504.7527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4362087.4946; train_optim_loss: 4362087.4946; val_kl_reg_loss: 9638.2733; val_edge_recon_loss: 1340713.9545; val_cat_covariates_contrastive_loss: 637670.5000; val_gene_expr_recon_loss: 2355318.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4343340.8864; val_optim_loss: 4343340.8864
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9160; val_auprc_score: 0.9541; val_best_acc_score: 0.9087; val_best_f1_score: 0.9404; train_kl_reg_loss: 10189.6666; train_edge_recon_loss: 1355010.1413; train_cat_covariates_contrastive_loss: 631972.1345; train_gene_expr_recon_loss: 2363689.9457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4360861.8641; train_optim_loss: 4360861.8641; val_kl_reg_loss: 9688.0956; val_edge_recon_loss: 1364260.6023; val_cat_covariates_contrastive_loss: 644764.3068; val_gene_expr_recon_loss: 2370963.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4389676.5000; val_optim_loss: 4389676.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9114; val_auprc_score: 0.9518; val_best_acc_score: 0.9095; val_best_f1_score: 0.9410; train_kl_reg_loss: 10081.6769; train_edge_recon_loss: 1336270.5856; train_cat_covariates_contrastive_loss: 632489.7643; train_gene_expr_recon_loss: 2344335.8804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4323177.8832; train_optim_loss: 4323177.8832; val_kl_reg_loss: 10575.9023; val_edge_recon_loss: 1310923.3636; val_cat_covariates_contrastive_loss: 631903.0568; val_gene_expr_recon_loss: 2382703.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4336105.5000; val_optim_loss: 4336105.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9034; val_auprc_score: 0.9453; val_best_acc_score: 0.9137; val_best_f1_score: 0.9445; train_kl_reg_loss: 10551.3229; train_edge_recon_loss: 1328928.4130; train_cat_covariates_contrastive_loss: 631807.2174; train_gene_expr_recon_loss: 2329719.7174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4301006.6603; train_optim_loss: 4301006.6603; val_kl_reg_loss: 10250.9720; val_edge_recon_loss: 1350560.6477; val_cat_covariates_contrastive_loss: 630813.9091; val_gene_expr_recon_loss: 2331471.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4323096.5455; val_optim_loss: 4323096.5455
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9177; val_auprc_score: 0.9515; val_best_acc_score: 0.9239; val_best_f1_score: 0.9507; train_kl_reg_loss: 10612.4636; train_edge_recon_loss: 1340149.7174; train_cat_covariates_contrastive_loss: 633141.7357; train_gene_expr_recon_loss: 2312844.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4296748.3750; train_optim_loss: 4296748.3750; val_kl_reg_loss: 10964.1944; val_edge_recon_loss: 1347936.5568; val_cat_covariates_contrastive_loss: 632981.4830; val_gene_expr_recon_loss: 2303085.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4294968.0682; val_optim_loss: 4294968.0682
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9124; val_auprc_score: 0.9529; val_best_acc_score: 0.9220; val_best_f1_score: 0.9494; train_kl_reg_loss: 11073.3917; train_edge_recon_loss: 1314139.7289; train_cat_covariates_contrastive_loss: 633334.2174; train_gene_expr_recon_loss: 2294566.6440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4253113.9647; train_optim_loss: 4253113.9647; val_kl_reg_loss: 11379.2355; val_edge_recon_loss: 1293333.4886; val_cat_covariates_contrastive_loss: 632911.4659; val_gene_expr_recon_loss: 2298981.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4236605.7955; val_optim_loss: 4236605.7955
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9060; val_auprc_score: 0.9488; val_best_acc_score: 0.9160; val_best_f1_score: 0.9459; train_kl_reg_loss: 11428.9294; train_edge_recon_loss: 1331458.3336; train_cat_covariates_contrastive_loss: 633103.6019; train_gene_expr_recon_loss: 2279922.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4255912.9946; train_optim_loss: 4255912.9946; val_kl_reg_loss: 11152.4595; val_edge_recon_loss: 1369295.8977; val_cat_covariates_contrastive_loss: 632447.1818; val_gene_expr_recon_loss: 2288508.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4301404.0909; val_optim_loss: 4301404.0909
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9098; val_auprc_score: 0.9471; val_best_acc_score: 0.9218; val_best_f1_score: 0.9498; train_kl_reg_loss: 11794.7991; train_edge_recon_loss: 1323145.0774; train_cat_covariates_contrastive_loss: 634279.7446; train_gene_expr_recon_loss: 2265591.3940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4234811.0082; train_optim_loss: 4234811.0082; val_kl_reg_loss: 12275.4173; val_edge_recon_loss: 1313893.1420; val_cat_covariates_contrastive_loss: 634768.8409; val_gene_expr_recon_loss: 2336460.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4297398.2500; val_optim_loss: 4297398.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9130; val_auprc_score: 0.9487; val_best_acc_score: 0.9290; val_best_f1_score: 0.9545; train_kl_reg_loss: 12052.3476; train_edge_recon_loss: 1333876.8587; train_cat_covariates_contrastive_loss: 632793.0177; train_gene_expr_recon_loss: 2248412.7255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4227134.9620; train_optim_loss: 4227134.9620; val_kl_reg_loss: 12645.1893; val_edge_recon_loss: 1314194.2045; val_cat_covariates_contrastive_loss: 632609.7443; val_gene_expr_recon_loss: 2288095.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4247544.2955; val_optim_loss: 4247544.2955
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9099; val_auprc_score: 0.9488; val_best_acc_score: 0.9234; val_best_f1_score: 0.9509; train_kl_reg_loss: 12677.8372; train_edge_recon_loss: 1338624.4783; train_cat_covariates_contrastive_loss: 633620.5537; train_gene_expr_recon_loss: 2228424.4226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4213347.2745; train_optim_loss: 4213347.2745; val_kl_reg_loss: 13253.8187; val_edge_recon_loss: 1314064.2386; val_cat_covariates_contrastive_loss: 632358.4261; val_gene_expr_recon_loss: 2264298.5795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4223975.0909; val_optim_loss: 4223975.0909
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9102; val_auprc_score: 0.9462; val_best_acc_score: 0.9203; val_best_f1_score: 0.9482; train_kl_reg_loss: 13082.7269; train_edge_recon_loss: 1321496.2120; train_cat_covariates_contrastive_loss: 633477.1753; train_gene_expr_recon_loss: 2211177.8573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4179233.9728; train_optim_loss: 4179233.9728; val_kl_reg_loss: 13159.9538; val_edge_recon_loss: 1355900.0000; val_cat_covariates_contrastive_loss: 632427.7159; val_gene_expr_recon_loss: 2258361.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4259849.1591; val_optim_loss: 4259849.1591
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9080; val_auprc_score: 0.9432; val_best_acc_score: 0.9212; val_best_f1_score: 0.9486; train_kl_reg_loss: 13795.5893; train_edge_recon_loss: 1321402.7595; train_cat_covariates_contrastive_loss: 634844.0829; train_gene_expr_recon_loss: 2195231.2052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4165273.6576; train_optim_loss: 4165273.6576; val_kl_reg_loss: 13617.7819; val_edge_recon_loss: 1346505.3182; val_cat_covariates_contrastive_loss: 636269.9830; val_gene_expr_recon_loss: 2313849.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4310242.6136; val_optim_loss: 4310242.6136
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9144; val_auprc_score: 0.9495; val_best_acc_score: 0.9282; val_best_f1_score: 0.9531; train_kl_reg_loss: 13879.6597; train_edge_recon_loss: 1318783.8519; train_cat_covariates_contrastive_loss: 634688.1529; train_gene_expr_recon_loss: 2172730.0435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4140081.7065; train_optim_loss: 4140081.7065; val_kl_reg_loss: 14462.2385; val_edge_recon_loss: 1317226.6250; val_cat_covariates_contrastive_loss: 638533.9148; val_gene_expr_recon_loss: 2226525.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4196748.2500; val_optim_loss: 4196748.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9112; val_auprc_score: 0.9453; val_best_acc_score: 0.9360; val_best_f1_score: 0.9586; train_kl_reg_loss: 14725.9118; train_edge_recon_loss: 1341350.4701; train_cat_covariates_contrastive_loss: 633933.6019; train_gene_expr_recon_loss: 2152816.9198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4142826.8832; train_optim_loss: 4142826.8832; val_kl_reg_loss: 15075.1199; val_edge_recon_loss: 1333600.7273; val_cat_covariates_contrastive_loss: 648424.7443; val_gene_expr_recon_loss: 2210496.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4207597.4773; val_optim_loss: 4207597.4773
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9211; val_auprc_score: 0.9494; val_best_acc_score: 0.9296; val_best_f1_score: 0.9538; train_kl_reg_loss: 15411.8587; train_edge_recon_loss: 1333451.9090; train_cat_covariates_contrastive_loss: 636046.0652; train_gene_expr_recon_loss: 2133269.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4118179.2962; train_optim_loss: 4118179.2962; val_kl_reg_loss: 15654.6183; val_edge_recon_loss: 1321867.1136; val_cat_covariates_contrastive_loss: 636143.7841; val_gene_expr_recon_loss: 2159552.7386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4133218.3409; val_optim_loss: 4133218.3409
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9157; val_auprc_score: 0.9500; val_best_acc_score: 0.9231; val_best_f1_score: 0.9495; train_kl_reg_loss: 16300.8524; train_edge_recon_loss: 1329953.4429; train_cat_covariates_contrastive_loss: 636201.4742; train_gene_expr_recon_loss: 2108904.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4091359.7717; train_optim_loss: 4091359.7717; val_kl_reg_loss: 16049.1141; val_edge_recon_loss: 1362363.0909; val_cat_covariates_contrastive_loss: 634837.7045; val_gene_expr_recon_loss: 2186992.7386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4200242.5909; val_optim_loss: 4200242.5909
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9208; val_auprc_score: 0.9444; val_best_acc_score: 0.9234; val_best_f1_score: 0.9494; train_kl_reg_loss: 16597.8867; train_edge_recon_loss: 1329603.5774; train_cat_covariates_contrastive_loss: 635716.4531; train_gene_expr_recon_loss: 2089296.7677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4071214.6821; train_optim_loss: 4071214.6821; val_kl_reg_loss: 15716.9678; val_edge_recon_loss: 1366745.6591; val_cat_covariates_contrastive_loss: 637528.5966; val_gene_expr_recon_loss: 2145000.4773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4164991.7273; val_optim_loss: 4164991.7273
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9102; val_auprc_score: 0.9454; val_best_acc_score: 0.9261; val_best_f1_score: 0.9515; train_kl_reg_loss: 17289.9545; train_edge_recon_loss: 1321718.4769; train_cat_covariates_contrastive_loss: 636055.0020; train_gene_expr_recon_loss: 2070382.3655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4045445.7962; train_optim_loss: 4045445.7962; val_kl_reg_loss: 17779.0977; val_edge_recon_loss: 1400749.2273; val_cat_covariates_contrastive_loss: 636045.6420; val_gene_expr_recon_loss: 2227726.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4282300.4318; val_optim_loss: 4282300.4318
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9109; val_auprc_score: 0.9421; val_best_acc_score: 0.9308; val_best_f1_score: 0.9552; train_kl_reg_loss: 17835.5655; train_edge_recon_loss: 1325931.8764; train_cat_covariates_contrastive_loss: 637141.5673; train_gene_expr_recon_loss: 2054384.7867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4035293.7908; train_optim_loss: 4035293.7908; val_kl_reg_loss: 18727.2596; val_edge_recon_loss: 1308026.7955; val_cat_covariates_contrastive_loss: 634683.1420; val_gene_expr_recon_loss: 2127785.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089222.8409; val_optim_loss: 4089222.8409
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8944; val_auprc_score: 0.9334; val_best_acc_score: 0.9255; val_best_f1_score: 0.9523; train_kl_reg_loss: 18241.3156; train_edge_recon_loss: 1327811.2982; train_cat_covariates_contrastive_loss: 637218.6834; train_gene_expr_recon_loss: 2030816.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4014087.8913; train_optim_loss: 4014087.8913; val_kl_reg_loss: 17982.0513; val_edge_recon_loss: 1305209.5341; val_cat_covariates_contrastive_loss: 636200.7898; val_gene_expr_recon_loss: 2109312.3068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4068704.6364; val_optim_loss: 4068704.6364
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9107; val_auprc_score: 0.9437; val_best_acc_score: 0.9327; val_best_f1_score: 0.9567; train_kl_reg_loss: 18552.7239; train_edge_recon_loss: 1338041.3852; train_cat_covariates_contrastive_loss: 638108.2806; train_gene_expr_recon_loss: 2024057.9443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4018760.3370; train_optim_loss: 4018760.3370; val_kl_reg_loss: 18368.7104; val_edge_recon_loss: 1282456.8523; val_cat_covariates_contrastive_loss: 638178.0795; val_gene_expr_recon_loss: 2174215.2841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4113218.8864; val_optim_loss: 4113218.8864
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8967; val_auprc_score: 0.9350; val_best_acc_score: 0.9266; val_best_f1_score: 0.9526; train_kl_reg_loss: 19095.3069; train_edge_recon_loss: 1338239.7908; train_cat_covariates_contrastive_loss: 637250.6984; train_gene_expr_recon_loss: 2004856.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3999442.3859; train_optim_loss: 3999442.3859; val_kl_reg_loss: 19680.4663; val_edge_recon_loss: 1349033.1932; val_cat_covariates_contrastive_loss: 635656.1080; val_gene_expr_recon_loss: 2169812.6932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4174182.4318; val_optim_loss: 4174182.4318
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9252; val_auprc_score: 0.9523; val_best_acc_score: 0.9310; val_best_f1_score: 0.9549; train_kl_reg_loss: 19720.3073; train_edge_recon_loss: 1318132.7296; train_cat_covariates_contrastive_loss: 636385.8220; train_gene_expr_recon_loss: 1980135.6712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3954374.5353; train_optim_loss: 3954374.5353; val_kl_reg_loss: 18699.5307; val_edge_recon_loss: 1338149.5682; val_cat_covariates_contrastive_loss: 638688.6023; val_gene_expr_recon_loss: 2117251.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4112788.7727; val_optim_loss: 4112788.7727
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9102; val_auprc_score: 0.9412; val_best_acc_score: 0.9278; val_best_f1_score: 0.9527; train_kl_reg_loss: 20516.4392; train_edge_recon_loss: 1326910.1168; train_cat_covariates_contrastive_loss: 638010.3587; train_gene_expr_recon_loss: 1963541.1060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948978.0163; train_optim_loss: 3948978.0163; val_kl_reg_loss: 20066.7379; val_edge_recon_loss: 1407360.0682; val_cat_covariates_contrastive_loss: 650317.2784; val_gene_expr_recon_loss: 2133737.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4211481.3182; val_optim_loss: 4211481.3182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9024; val_auprc_score: 0.9384; val_best_acc_score: 0.9288; val_best_f1_score: 0.9537; train_kl_reg_loss: 20394.3661; train_edge_recon_loss: 1311011.6617; train_cat_covariates_contrastive_loss: 638235.1746; train_gene_expr_recon_loss: 1938955.3139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3908596.5217; train_optim_loss: 3908596.5217; val_kl_reg_loss: 21033.2480; val_edge_recon_loss: 1350198.3409; val_cat_covariates_contrastive_loss: 639108.5000; val_gene_expr_recon_loss: 2077999.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088339.6364; val_optim_loss: 4088339.6364
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9034; val_auprc_score: 0.9370; val_best_acc_score: 0.9253; val_best_f1_score: 0.9514; train_kl_reg_loss: 20786.1168; train_edge_recon_loss: 1338423.3906; train_cat_covariates_contrastive_loss: 636773.6012; train_gene_expr_recon_loss: 1929346.5041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3925329.6114; train_optim_loss: 3925329.6114; val_kl_reg_loss: 21394.4698; val_edge_recon_loss: 1351910.3182; val_cat_covariates_contrastive_loss: 647591.2841; val_gene_expr_recon_loss: 2150897.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4171793.6591; val_optim_loss: 4171793.6591
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9087; val_auprc_score: 0.9431; val_best_acc_score: 0.9282; val_best_f1_score: 0.9535; train_kl_reg_loss: 21233.1273; train_edge_recon_loss: 1323207.0625; train_cat_covariates_contrastive_loss: 637561.2731; train_gene_expr_recon_loss: 1922487.0353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3904488.5000; train_optim_loss: 3904488.5000; val_kl_reg_loss: 22380.4567; val_edge_recon_loss: 1305624.0568; val_cat_covariates_contrastive_loss: 637291.7727; val_gene_expr_recon_loss: 2115830.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4081127.1136; val_optim_loss: 4081127.1136
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9122; val_auprc_score: 0.9454; val_best_acc_score: 0.9300; val_best_f1_score: 0.9547; train_kl_reg_loss: 21272.9545; train_edge_recon_loss: 1327277.1576; train_cat_covariates_contrastive_loss: 636069.3845; train_gene_expr_recon_loss: 1916751.5448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3901371.0380; train_optim_loss: 3901371.0380; val_kl_reg_loss: 20546.5854; val_edge_recon_loss: 1323690.0455; val_cat_covariates_contrastive_loss: 644979.9034; val_gene_expr_recon_loss: 2082256.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4071472.6591; val_optim_loss: 4071472.6591

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 5 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.9086
val AUPRC score: 0.9436
val best accuracy score: 0.9302
val best F1 score: 0.9550
val target rna MSE score: 0.6567
val source rna MSE score: 0.0523
Val cat covariate0 mean sim diff: -0.0031
Val cat covariate1 mean sim diff: -0.0031
Duration of model training in run 8: 0 hours, 14 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7564; val_auprc_score: 0.9031; val_best_acc_score: 0.7909; val_best_f1_score: 0.8765; train_kl_reg_loss: 5376.9238; train_edge_recon_loss: 1748347.7935; train_cat_covariates_contrastive_loss: 708280.4287; train_gene_expr_recon_loss: 3083639.7880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5545644.9076; train_optim_loss: 5545644.9076; val_kl_reg_loss: 8431.4633; val_edge_recon_loss: 1591315.0114; val_cat_covariates_contrastive_loss: 626875.8125; val_gene_expr_recon_loss: 2788624.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5015246.6818; val_optim_loss: 5015246.6818
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7992; val_auprc_score: 0.9196; val_best_acc_score: 0.8108; val_best_f1_score: 0.8832; train_kl_reg_loss: 11481.6834; train_edge_recon_loss: 1556538.9416; train_cat_covariates_contrastive_loss: 632040.9586; train_gene_expr_recon_loss: 2653205.9620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4853267.5380; train_optim_loss: 4853267.5380; val_kl_reg_loss: 11044.7656; val_edge_recon_loss: 1514148.6136; val_cat_covariates_contrastive_loss: 627470.6307; val_gene_expr_recon_loss: 2646471.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4799135.6818; val_optim_loss: 4799135.6818
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8313; val_auprc_score: 0.9252; val_best_acc_score: 0.8263; val_best_f1_score: 0.8921; train_kl_reg_loss: 10594.9141; train_edge_recon_loss: 1496527.6345; train_cat_covariates_contrastive_loss: 633020.9029; train_gene_expr_recon_loss: 2577690.6793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4717834.1522; train_optim_loss: 4717834.1522; val_kl_reg_loss: 13681.0482; val_edge_recon_loss: 1478707.8977; val_cat_covariates_contrastive_loss: 631853.9489; val_gene_expr_recon_loss: 2652847.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4777090.9091; val_optim_loss: 4777090.9091
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8561; val_auprc_score: 0.9365; val_best_acc_score: 0.8555; val_best_f1_score: 0.9095; train_kl_reg_loss: 12004.0786; train_edge_recon_loss: 1421229.5774; train_cat_covariates_contrastive_loss: 633094.7344; train_gene_expr_recon_loss: 2544013.0815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4610341.4783; train_optim_loss: 4610341.4783; val_kl_reg_loss: 10872.9315; val_edge_recon_loss: 1453886.3182; val_cat_covariates_contrastive_loss: 630126.2614; val_gene_expr_recon_loss: 2665339.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4760224.5909; val_optim_loss: 4760224.5909
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8843; val_auprc_score: 0.9487; val_best_acc_score: 0.8803; val_best_f1_score: 0.9243; train_kl_reg_loss: 11039.7336; train_edge_recon_loss: 1383754.3913; train_cat_covariates_contrastive_loss: 633050.1087; train_gene_expr_recon_loss: 2518156.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4546000.6277; train_optim_loss: 4546000.6277; val_kl_reg_loss: 10212.6317; val_edge_recon_loss: 1340512.4943; val_cat_covariates_contrastive_loss: 630834.5057; val_gene_expr_recon_loss: 2528061.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4509621.2955; val_optim_loss: 4509621.2955
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8846; val_auprc_score: 0.9462; val_best_acc_score: 0.8849; val_best_f1_score: 0.9279; train_kl_reg_loss: 10799.1874; train_edge_recon_loss: 1378400.1073; train_cat_covariates_contrastive_loss: 631758.0598; train_gene_expr_recon_loss: 2500120.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4521078.2065; train_optim_loss: 4521078.2065; val_kl_reg_loss: 10981.9024; val_edge_recon_loss: 1291121.8239; val_cat_covariates_contrastive_loss: 630032.1932; val_gene_expr_recon_loss: 2510534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4442669.9091; val_optim_loss: 4442669.9091
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9034; val_auprc_score: 0.9518; val_best_acc_score: 0.8843; val_best_f1_score: 0.9260; train_kl_reg_loss: 10470.6364; train_edge_recon_loss: 1371923.5761; train_cat_covariates_contrastive_loss: 630890.4688; train_gene_expr_recon_loss: 2474509.0027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4487793.6549; train_optim_loss: 4487793.6549; val_kl_reg_loss: 9916.3427; val_edge_recon_loss: 1388487.7955; val_cat_covariates_contrastive_loss: 631955.9659; val_gene_expr_recon_loss: 2472344.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4502704.9091; val_optim_loss: 4502704.9091
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9107; val_auprc_score: 0.9588; val_best_acc_score: 0.8986; val_best_f1_score: 0.9346; train_kl_reg_loss: 9982.0723; train_edge_recon_loss: 1359245.2106; train_cat_covariates_contrastive_loss: 631229.7283; train_gene_expr_recon_loss: 2460041.4538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4460498.4484; train_optim_loss: 4460498.4484; val_kl_reg_loss: 10487.0335; val_edge_recon_loss: 1326607.3409; val_cat_covariates_contrastive_loss: 636218.9261; val_gene_expr_recon_loss: 2497701.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4471015.1364; val_optim_loss: 4471015.1364
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9193; val_auprc_score: 0.9581; val_best_acc_score: 0.9083; val_best_f1_score: 0.9403; train_kl_reg_loss: 9942.1292; train_edge_recon_loss: 1365283.8573; train_cat_covariates_contrastive_loss: 631580.8417; train_gene_expr_recon_loss: 2438845.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4445651.9674; train_optim_loss: 4445651.9674; val_kl_reg_loss: 9816.6929; val_edge_recon_loss: 1334708.3920; val_cat_covariates_contrastive_loss: 634627.5000; val_gene_expr_recon_loss: 2544577.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4523729.8864; val_optim_loss: 4523729.8864
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9059; val_auprc_score: 0.9512; val_best_acc_score: 0.9029; val_best_f1_score: 0.9372; train_kl_reg_loss: 9738.9277; train_edge_recon_loss: 1353413.8899; train_cat_covariates_contrastive_loss: 630382.7541; train_gene_expr_recon_loss: 2425557.7337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4419093.2799; train_optim_loss: 4419093.2799; val_kl_reg_loss: 9580.7000; val_edge_recon_loss: 1352041.9205; val_cat_covariates_contrastive_loss: 651892.7500; val_gene_expr_recon_loss: 2505851.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4519366.9091; val_optim_loss: 4519366.9091

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9131; val_auprc_score: 0.9593; val_best_acc_score: 0.9109; val_best_f1_score: 0.9438; train_kl_reg_loss: 9679.6496; train_edge_recon_loss: 1342497.4783; train_cat_covariates_contrastive_loss: 631428.6651; train_gene_expr_recon_loss: 2409729.1739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4393334.9918; train_optim_loss: 4393334.9918; val_kl_reg_loss: 9656.0648; val_edge_recon_loss: 1278315.1250; val_cat_covariates_contrastive_loss: 642215.4830; val_gene_expr_recon_loss: 2407786.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4337972.8864; val_optim_loss: 4337972.8864
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9143; val_auprc_score: 0.9541; val_best_acc_score: 0.9116; val_best_f1_score: 0.9430; train_kl_reg_loss: 9773.7326; train_edge_recon_loss: 1346893.7541; train_cat_covariates_contrastive_loss: 630789.1488; train_gene_expr_recon_loss: 2410697.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4398154.1141; train_optim_loss: 4398154.1141; val_kl_reg_loss: 9874.5141; val_edge_recon_loss: 1370783.8068; val_cat_covariates_contrastive_loss: 633067.7784; val_gene_expr_recon_loss: 2446473.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4460200.0455; val_optim_loss: 4460200.0455
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9108; val_auprc_score: 0.9554; val_best_acc_score: 0.9102; val_best_f1_score: 0.9426; train_kl_reg_loss: 9759.5387; train_edge_recon_loss: 1340067.9117; train_cat_covariates_contrastive_loss: 631513.0075; train_gene_expr_recon_loss: 2407625.3940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4388965.8478; train_optim_loss: 4388965.8478; val_kl_reg_loss: 9666.4270; val_edge_recon_loss: 1359789.3977; val_cat_covariates_contrastive_loss: 634881.7955; val_gene_expr_recon_loss: 2528732.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4533070.5909; val_optim_loss: 4533070.5909
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9240; val_auprc_score: 0.9580; val_best_acc_score: 0.9183; val_best_f1_score: 0.9465; train_kl_reg_loss: 9802.8522; train_edge_recon_loss: 1336212.3057; train_cat_covariates_contrastive_loss: 630205.7283; train_gene_expr_recon_loss: 2399493.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4375714.5897; train_optim_loss: 4375714.5897; val_kl_reg_loss: 9715.2335; val_edge_recon_loss: 1346171.3636; val_cat_covariates_contrastive_loss: 631813.6420; val_gene_expr_recon_loss: 2444012.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4431712.2727; val_optim_loss: 4431712.2727
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9082; val_auprc_score: 0.9508; val_best_acc_score: 0.9138; val_best_f1_score: 0.9447; train_kl_reg_loss: 9829.6915; train_edge_recon_loss: 1356712.5217; train_cat_covariates_contrastive_loss: 630323.5550; train_gene_expr_recon_loss: 2400860.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4397726.4701; train_optim_loss: 4397726.4701; val_kl_reg_loss: 9651.2491; val_edge_recon_loss: 1338215.6818; val_cat_covariates_contrastive_loss: 628419.0284; val_gene_expr_recon_loss: 2421806.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4398092.5000; val_optim_loss: 4398092.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9123; val_auprc_score: 0.9516; val_best_acc_score: 0.9126; val_best_f1_score: 0.9434; train_kl_reg_loss: 9818.3147; train_edge_recon_loss: 1334673.4620; train_cat_covariates_contrastive_loss: 630925.1304; train_gene_expr_recon_loss: 2398605.6304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4374022.5435; train_optim_loss: 4374022.5435; val_kl_reg_loss: 9759.4337; val_edge_recon_loss: 1368516.5000; val_cat_covariates_contrastive_loss: 631887.4375; val_gene_expr_recon_loss: 2429722.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439885.4091; val_optim_loss: 4439885.4091
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9097; val_auprc_score: 0.9474; val_best_acc_score: 0.9176; val_best_f1_score: 0.9474; train_kl_reg_loss: 9806.3158; train_edge_recon_loss: 1347862.9810; train_cat_covariates_contrastive_loss: 631117.8641; train_gene_expr_recon_loss: 2397806.2690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4386593.4565; train_optim_loss: 4386593.4565; val_kl_reg_loss: 9713.1817; val_edge_recon_loss: 1318286.7727; val_cat_covariates_contrastive_loss: 638875.4375; val_gene_expr_recon_loss: 2488054.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4454930.3409; val_optim_loss: 4454930.3409
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9099; val_auprc_score: 0.9481; val_best_acc_score: 0.9156; val_best_f1_score: 0.9445; train_kl_reg_loss: 9839.6479; train_edge_recon_loss: 1324996.1236; train_cat_covariates_contrastive_loss: 630530.4749; train_gene_expr_recon_loss: 2394202.0652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4359568.3125; train_optim_loss: 4359568.3125; val_kl_reg_loss: 9582.1064; val_edge_recon_loss: 1375866.6364; val_cat_covariates_contrastive_loss: 629717.7557; val_gene_expr_recon_loss: 2386887.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4402054.0909; val_optim_loss: 4402054.0909
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9102; val_auprc_score: 0.9536; val_best_acc_score: 0.9128; val_best_f1_score: 0.9437; train_kl_reg_loss: 9821.5865; train_edge_recon_loss: 1350411.5693; train_cat_covariates_contrastive_loss: 630083.5088; train_gene_expr_recon_loss: 2398260.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4388576.9946; train_optim_loss: 4388576.9946; val_kl_reg_loss: 9709.8683; val_edge_recon_loss: 1356309.1818; val_cat_covariates_contrastive_loss: 628709.1648; val_gene_expr_recon_loss: 2465263.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4459992.0227; val_optim_loss: 4459992.0227

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 27 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
val AUROC score: 0.9112
val AUPRC score: 0.9533
val best accuracy score: 0.9093
val best F1 score: 0.9412
val target rna MSE score: 0.7723
val source rna MSE score: 0.0780
Val cat covariate0 mean sim diff: 0.0009
Val cat covariate1 mean sim diff: 0.0009
Duration of model training in run 7: 0 hours, 5 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7367; val_auprc_score: 0.8927; val_best_acc_score: 0.7632; val_best_f1_score: 0.8590; train_kl_reg_loss: 5208.9574; train_edge_recon_loss: 1765179.6054; train_cat_covariates_contrastive_loss: 722569.0875; train_gene_expr_recon_loss: 3065134.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5558092.1571; train_optim_loss: 5558092.1571; val_kl_reg_loss: 12703.0663; val_edge_recon_loss: 1679826.0000; val_cat_covariates_contrastive_loss: 627441.3594; val_gene_expr_recon_loss: 2686367.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5006338.0625; val_optim_loss: 5006338.0625
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8085; val_auprc_score: 0.9140; val_best_acc_score: 0.8160; val_best_f1_score: 0.8862; train_kl_reg_loss: 12832.5520; train_edge_recon_loss: 1544523.8768; train_cat_covariates_contrastive_loss: 633212.6857; train_gene_expr_recon_loss: 2685077.6179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875646.7357; train_optim_loss: 4875646.7357; val_kl_reg_loss: 13223.9811; val_edge_recon_loss: 1463274.0312; val_cat_covariates_contrastive_loss: 630004.1719; val_gene_expr_recon_loss: 2579966.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4686468.8750; val_optim_loss: 4686468.8750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8335; val_auprc_score: 0.9263; val_best_acc_score: 0.8326; val_best_f1_score: 0.8948; train_kl_reg_loss: 12760.7052; train_edge_recon_loss: 1469936.5714; train_cat_covariates_contrastive_loss: 633547.8875; train_gene_expr_recon_loss: 2595413.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4711659.1071; train_optim_loss: 4711659.1071; val_kl_reg_loss: 11481.1533; val_edge_recon_loss: 1463912.1719; val_cat_covariates_contrastive_loss: 634128.8984; val_gene_expr_recon_loss: 2527233.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4636755.3750; val_optim_loss: 4636755.3750
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8602; val_auprc_score: 0.9337; val_best_acc_score: 0.8500; val_best_f1_score: 0.9046; train_kl_reg_loss: 12121.5284; train_edge_recon_loss: 1424034.5589; train_cat_covariates_contrastive_loss: 636581.4554; train_gene_expr_recon_loss: 2569453.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4642190.6643; train_optim_loss: 4642190.6643; val_kl_reg_loss: 12328.0577; val_edge_recon_loss: 1449740.4531; val_cat_covariates_contrastive_loss: 633768.0469; val_gene_expr_recon_loss: 2484498.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4580335.0625; val_optim_loss: 4580335.0625
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8653; val_auprc_score: 0.9354; val_best_acc_score: 0.8526; val_best_f1_score: 0.9082; train_kl_reg_loss: 11476.0950; train_edge_recon_loss: 1389912.7750; train_cat_covariates_contrastive_loss: 635371.8759; train_gene_expr_recon_loss: 2535857.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4572617.9214; train_optim_loss: 4572617.9214; val_kl_reg_loss: 10372.5984; val_edge_recon_loss: 1386705.8750; val_cat_covariates_contrastive_loss: 637172.6406; val_gene_expr_recon_loss: 2479492.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4513744.0000; val_optim_loss: 4513744.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8760; val_auprc_score: 0.9463; val_best_acc_score: 0.8634; val_best_f1_score: 0.9138; train_kl_reg_loss: 11414.3432; train_edge_recon_loss: 1400597.3304; train_cat_covariates_contrastive_loss: 636522.3607; train_gene_expr_recon_loss: 2524029.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4572563.9643; train_optim_loss: 4572563.9643; val_kl_reg_loss: 11223.3864; val_edge_recon_loss: 1398993.6562; val_cat_covariates_contrastive_loss: 633998.7031; val_gene_expr_recon_loss: 2478599.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4522815.5000; val_optim_loss: 4522815.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8796; val_auprc_score: 0.9461; val_best_acc_score: 0.8597; val_best_f1_score: 0.9125; train_kl_reg_loss: 11191.3233; train_edge_recon_loss: 1402592.1875; train_cat_covariates_contrastive_loss: 636510.7830; train_gene_expr_recon_loss: 2497949.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4548243.4500; train_optim_loss: 4548243.4500; val_kl_reg_loss: 10853.5322; val_edge_recon_loss: 1384191.6250; val_cat_covariates_contrastive_loss: 636166.6641; val_gene_expr_recon_loss: 2436511.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4467723.4375; val_optim_loss: 4467723.4375
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8944; val_auprc_score: 0.9532; val_best_acc_score: 0.8733; val_best_f1_score: 0.9189; train_kl_reg_loss: 11260.6383; train_edge_recon_loss: 1372413.6714; train_cat_covariates_contrastive_loss: 636667.5080; train_gene_expr_recon_loss: 2490513.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4510855.0929; train_optim_loss: 4510855.0929; val_kl_reg_loss: 10575.4603; val_edge_recon_loss: 1385055.7656; val_cat_covariates_contrastive_loss: 635684.1172; val_gene_expr_recon_loss: 2426874.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4458189.8125; val_optim_loss: 4458189.8125
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8962; val_auprc_score: 0.9526; val_best_acc_score: 0.8763; val_best_f1_score: 0.9202; train_kl_reg_loss: 11066.3148; train_edge_recon_loss: 1359429.8964; train_cat_covariates_contrastive_loss: 637207.7723; train_gene_expr_recon_loss: 2471121.2071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4478825.1964; train_optim_loss: 4478825.1964; val_kl_reg_loss: 10930.2373; val_edge_recon_loss: 1414382.4375; val_cat_covariates_contrastive_loss: 637416.9062; val_gene_expr_recon_loss: 2423288.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4486018.0000; val_optim_loss: 4486018.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9056; val_auprc_score: 0.9587; val_best_acc_score: 0.8820; val_best_f1_score: 0.9240; train_kl_reg_loss: 11055.3208; train_edge_recon_loss: 1380891.9268; train_cat_covariates_contrastive_loss: 637955.0277; train_gene_expr_recon_loss: 2461367.3250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4491269.5929; train_optim_loss: 4491269.5929; val_kl_reg_loss: 10300.3120; val_edge_recon_loss: 1380412.3281; val_cat_covariates_contrastive_loss: 639062.6094; val_gene_expr_recon_loss: 2392919.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4422694.5000; val_optim_loss: 4422694.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9062; val_auprc_score: 0.9599; val_best_acc_score: 0.8917; val_best_f1_score: 0.9311; train_kl_reg_loss: 10644.3765; train_edge_recon_loss: 1369008.4482; train_cat_covariates_contrastive_loss: 638638.3732; train_gene_expr_recon_loss: 2452207.8964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470499.1143; train_optim_loss: 4470499.1143; val_kl_reg_loss: 10279.7902; val_edge_recon_loss: 1379470.3438; val_cat_covariates_contrastive_loss: 637881.6172; val_gene_expr_recon_loss: 2400284.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427916.3125; val_optim_loss: 4427916.3125
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9174; val_auprc_score: 0.9653; val_best_acc_score: 0.9016; val_best_f1_score: 0.9380; train_kl_reg_loss: 10407.3329; train_edge_recon_loss: 1362876.3214; train_cat_covariates_contrastive_loss: 637195.8777; train_gene_expr_recon_loss: 2432093.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4442573.3714; train_optim_loss: 4442573.3714; val_kl_reg_loss: 10039.6289; val_edge_recon_loss: 1345278.7188; val_cat_covariates_contrastive_loss: 634854.0781; val_gene_expr_recon_loss: 2369666.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4359839.0625; val_optim_loss: 4359839.0625
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9090; val_auprc_score: 0.9558; val_best_acc_score: 0.9031; val_best_f1_score: 0.9384; train_kl_reg_loss: 10380.5255; train_edge_recon_loss: 1334648.3705; train_cat_covariates_contrastive_loss: 636999.8179; train_gene_expr_recon_loss: 2422118.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4404147.6321; train_optim_loss: 4404147.6321; val_kl_reg_loss: 9993.4550; val_edge_recon_loss: 1309615.5781; val_cat_covariates_contrastive_loss: 639099.0312; val_gene_expr_recon_loss: 2369346.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4328054.5938; val_optim_loss: 4328054.5938
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9121; val_auprc_score: 0.9594; val_best_acc_score: 0.9123; val_best_f1_score: 0.9442; train_kl_reg_loss: 10304.7727; train_edge_recon_loss: 1351343.2607; train_cat_covariates_contrastive_loss: 636875.1054; train_gene_expr_recon_loss: 2405104.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4403627.9250; train_optim_loss: 4403627.9250; val_kl_reg_loss: 10026.5624; val_edge_recon_loss: 1311879.5625; val_cat_covariates_contrastive_loss: 634892.6484; val_gene_expr_recon_loss: 2364112.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4320911.3750; val_optim_loss: 4320911.3750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8941; val_auprc_score: 0.9538; val_best_acc_score: 0.8983; val_best_f1_score: 0.9368; train_kl_reg_loss: 10157.5311; train_edge_recon_loss: 1321951.0813; train_cat_covariates_contrastive_loss: 635765.6571; train_gene_expr_recon_loss: 2405086.9536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4372961.2107; train_optim_loss: 4372961.2107; val_kl_reg_loss: 10186.4276; val_edge_recon_loss: 1330051.1250; val_cat_covariates_contrastive_loss: 631965.3125; val_gene_expr_recon_loss: 2359058.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4331261.5625; val_optim_loss: 4331261.5625
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9150; val_auprc_score: 0.9588; val_best_acc_score: 0.9088; val_best_f1_score: 0.9408; train_kl_reg_loss: 10173.0056; train_edge_recon_loss: 1326364.4500; train_cat_covariates_contrastive_loss: 634810.4866; train_gene_expr_recon_loss: 2384401.8107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4355749.7536; train_optim_loss: 4355749.7536; val_kl_reg_loss: 9904.6823; val_edge_recon_loss: 1357068.5000; val_cat_covariates_contrastive_loss: 634336.1094; val_gene_expr_recon_loss: 2344130.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4345440.1875; val_optim_loss: 4345440.1875
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9185; val_auprc_score: 0.9621; val_best_acc_score: 0.9117; val_best_f1_score: 0.9433; train_kl_reg_loss: 10278.4957; train_edge_recon_loss: 1335249.5000; train_cat_covariates_contrastive_loss: 633659.6929; train_gene_expr_recon_loss: 2384691.6607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4363879.3679; train_optim_loss: 4363879.3679; val_kl_reg_loss: 9943.2466; val_edge_recon_loss: 1364938.9375; val_cat_covariates_contrastive_loss: 636309.5547; val_gene_expr_recon_loss: 2340962.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4352153.8750; val_optim_loss: 4352153.8750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9134; val_auprc_score: 0.9551; val_best_acc_score: 0.9124; val_best_f1_score: 0.9432; train_kl_reg_loss: 10326.2405; train_edge_recon_loss: 1354631.3821; train_cat_covariates_contrastive_loss: 634217.1429; train_gene_expr_recon_loss: 2366503.4143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4365678.1821; train_optim_loss: 4365678.1821; val_kl_reg_loss: 10144.9037; val_edge_recon_loss: 1379994.2656; val_cat_covariates_contrastive_loss: 632840.6094; val_gene_expr_recon_loss: 2306611.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4329591.5000; val_optim_loss: 4329591.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9082; val_auprc_score: 0.9562; val_best_acc_score: 0.9052; val_best_f1_score: 0.9393; train_kl_reg_loss: 10150.4365; train_edge_recon_loss: 1326451.9964; train_cat_covariates_contrastive_loss: 632678.9000; train_gene_expr_recon_loss: 2352450.6321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4321731.9464; train_optim_loss: 4321731.9464; val_kl_reg_loss: 10252.4103; val_edge_recon_loss: 1358401.1250; val_cat_covariates_contrastive_loss: 632353.8203; val_gene_expr_recon_loss: 2341920.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4342928.0312; val_optim_loss: 4342928.0312
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9106; val_auprc_score: 0.9593; val_best_acc_score: 0.9072; val_best_f1_score: 0.9403; train_kl_reg_loss: 10233.3085; train_edge_recon_loss: 1340466.6018; train_cat_covariates_contrastive_loss: 633246.3804; train_gene_expr_recon_loss: 2351229.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4335175.6750; train_optim_loss: 4335175.6750; val_kl_reg_loss: 10248.6090; val_edge_recon_loss: 1355817.3281; val_cat_covariates_contrastive_loss: 630599.3594; val_gene_expr_recon_loss: 2316961.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4313626.3125; val_optim_loss: 4313626.3125
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9136; val_auprc_score: 0.9543; val_best_acc_score: 0.9151; val_best_f1_score: 0.9451; train_kl_reg_loss: 10295.8716; train_edge_recon_loss: 1358440.6482; train_cat_covariates_contrastive_loss: 632360.2446; train_gene_expr_recon_loss: 2349148.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4350245.5714; train_optim_loss: 4350245.5714; val_kl_reg_loss: 10228.6575; val_edge_recon_loss: 1368412.0625; val_cat_covariates_contrastive_loss: 635926.9531; val_gene_expr_recon_loss: 2314638.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4329206.1250; val_optim_loss: 4329206.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9216; val_auprc_score: 0.9634; val_best_acc_score: 0.9147; val_best_f1_score: 0.9453; train_kl_reg_loss: 10298.2151; train_edge_recon_loss: 1332205.1679; train_cat_covariates_contrastive_loss: 633594.0580; train_gene_expr_recon_loss: 2351631.6321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4327729.0536; train_optim_loss: 4327729.0536; val_kl_reg_loss: 10250.6875; val_edge_recon_loss: 1345665.4375; val_cat_covariates_contrastive_loss: 631984.1406; val_gene_expr_recon_loss: 2332348.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4320248.8438; val_optim_loss: 4320248.8438
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9199; val_auprc_score: 0.9615; val_best_acc_score: 0.9126; val_best_f1_score: 0.9429; train_kl_reg_loss: 10315.9094; train_edge_recon_loss: 1345000.1875; train_cat_covariates_contrastive_loss: 633104.1446; train_gene_expr_recon_loss: 2348221.5857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4336641.8607; train_optim_loss: 4336641.8607; val_kl_reg_loss: 10218.4003; val_edge_recon_loss: 1381522.3281; val_cat_covariates_contrastive_loss: 631128.8281; val_gene_expr_recon_loss: 2313330.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4336199.5938; val_optim_loss: 4336199.5938
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9149; val_auprc_score: 0.9617; val_best_acc_score: 0.9181; val_best_f1_score: 0.9477; train_kl_reg_loss: 10324.2673; train_edge_recon_loss: 1331160.3839; train_cat_covariates_contrastive_loss: 633089.0089; train_gene_expr_recon_loss: 2343028.1036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4317601.7929; train_optim_loss: 4317601.7929; val_kl_reg_loss: 10222.8518; val_edge_recon_loss: 1315797.0312; val_cat_covariates_contrastive_loss: 634363.6484; val_gene_expr_recon_loss: 2323625.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4284009.4688; val_optim_loss: 4284009.4688
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9236; val_auprc_score: 0.9649; val_best_acc_score: 0.9202; val_best_f1_score: 0.9487; train_kl_reg_loss: 10388.0816; train_edge_recon_loss: 1336416.1679; train_cat_covariates_contrastive_loss: 634229.2152; train_gene_expr_recon_loss: 2341440.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4322473.5107; train_optim_loss: 4322473.5107; val_kl_reg_loss: 10350.0166; val_edge_recon_loss: 1321785.7344; val_cat_covariates_contrastive_loss: 630616.5703; val_gene_expr_recon_loss: 2326203.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4288955.7812; val_optim_loss: 4288955.7812
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9145; val_auprc_score: 0.9562; val_best_acc_score: 0.9109; val_best_f1_score: 0.9427; train_kl_reg_loss: 10374.2178; train_edge_recon_loss: 1338413.0652; train_cat_covariates_contrastive_loss: 632763.9536; train_gene_expr_recon_loss: 2339165.4393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4320716.6679; train_optim_loss: 4320716.6679; val_kl_reg_loss: 10313.0553; val_edge_recon_loss: 1383735.4844; val_cat_covariates_contrastive_loss: 631592.2422; val_gene_expr_recon_loss: 2316834.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4342475.1562; val_optim_loss: 4342475.1562
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9188; val_auprc_score: 0.9576; val_best_acc_score: 0.9186; val_best_f1_score: 0.9468; train_kl_reg_loss: 10375.8888; train_edge_recon_loss: 1343726.9875; train_cat_covariates_contrastive_loss: 632602.8768; train_gene_expr_recon_loss: 2348563.7607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4335269.5214; train_optim_loss: 4335269.5214; val_kl_reg_loss: 10394.3378; val_edge_recon_loss: 1358040.0469; val_cat_covariates_contrastive_loss: 632051.9531; val_gene_expr_recon_loss: 2301190.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4301676.9375; val_optim_loss: 4301676.9375
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9173; val_auprc_score: 0.9581; val_best_acc_score: 0.9209; val_best_f1_score: 0.9496; train_kl_reg_loss: 10346.2902; train_edge_recon_loss: 1334114.7232; train_cat_covariates_contrastive_loss: 633137.9330; train_gene_expr_recon_loss: 2345375.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4322974.5929; train_optim_loss: 4322974.5929; val_kl_reg_loss: 10314.4937; val_edge_recon_loss: 1291639.1875; val_cat_covariates_contrastive_loss: 631445.5703; val_gene_expr_recon_loss: 2326138.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4259538.0938; val_optim_loss: 4259538.0938
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9157; val_auprc_score: 0.9572; val_best_acc_score: 0.9200; val_best_f1_score: 0.9487; train_kl_reg_loss: 10379.4602; train_edge_recon_loss: 1342655.0911; train_cat_covariates_contrastive_loss: 633746.6062; train_gene_expr_recon_loss: 2335669.2536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4322450.3964; train_optim_loss: 4322450.3964; val_kl_reg_loss: 10295.7012; val_edge_recon_loss: 1332893.2969; val_cat_covariates_contrastive_loss: 631514.8281; val_gene_expr_recon_loss: 2300932.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4275636.7188; val_optim_loss: 4275636.7188
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9218; val_auprc_score: 0.9608; val_best_acc_score: 0.9169; val_best_f1_score: 0.9462; train_kl_reg_loss: 10324.8428; train_edge_recon_loss: 1325522.0696; train_cat_covariates_contrastive_loss: 632228.3473; train_gene_expr_recon_loss: 2333548.8107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4301624.0786; train_optim_loss: 4301624.0786; val_kl_reg_loss: 10271.5801; val_edge_recon_loss: 1345887.2500; val_cat_covariates_contrastive_loss: 630863.0547; val_gene_expr_recon_loss: 2320495.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4307517.6250; val_optim_loss: 4307517.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9080; val_auprc_score: 0.9533; val_best_acc_score: 0.9152; val_best_f1_score: 0.9454; train_kl_reg_loss: 10416.5567; train_edge_recon_loss: 1330988.6446; train_cat_covariates_contrastive_loss: 633391.0545; train_gene_expr_recon_loss: 2334172.9607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4308969.2000; train_optim_loss: 4308969.2000; val_kl_reg_loss: 10325.7644; val_edge_recon_loss: 1353739.3594; val_cat_covariates_contrastive_loss: 633024.7891; val_gene_expr_recon_loss: 2299565.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4296655.6562; val_optim_loss: 4296655.6562
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9258; val_auprc_score: 0.9643; val_best_acc_score: 0.9183; val_best_f1_score: 0.9469; train_kl_reg_loss: 10412.6899; train_edge_recon_loss: 1338929.7411; train_cat_covariates_contrastive_loss: 632034.1116; train_gene_expr_recon_loss: 2334205.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4315581.9464; train_optim_loss: 4315581.9464; val_kl_reg_loss: 10304.0571; val_edge_recon_loss: 1360886.5312; val_cat_covariates_contrastive_loss: 632046.6328; val_gene_expr_recon_loss: 2296672.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4299909.6875; val_optim_loss: 4299909.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9129; val_auprc_score: 0.9564; val_best_acc_score: 0.9141; val_best_f1_score: 0.9452; train_kl_reg_loss: 10383.7203; train_edge_recon_loss: 1323873.7393; train_cat_covariates_contrastive_loss: 632106.2545; train_gene_expr_recon_loss: 2336280.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4302644.0821; train_optim_loss: 4302644.0821; val_kl_reg_loss: 10325.3193; val_edge_recon_loss: 1316016.4375; val_cat_covariates_contrastive_loss: 631691.0234; val_gene_expr_recon_loss: 2319785.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4277818.6875; val_optim_loss: 4277818.6875
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9223; val_auprc_score: 0.9657; val_best_acc_score: 0.9196; val_best_f1_score: 0.9487; train_kl_reg_loss: 10382.1354; train_edge_recon_loss: 1318892.3946; train_cat_covariates_contrastive_loss: 632154.6955; train_gene_expr_recon_loss: 2330328.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4291758.0179; train_optim_loss: 4291758.0179; val_kl_reg_loss: 10308.5106; val_edge_recon_loss: 1307836.6562; val_cat_covariates_contrastive_loss: 632381.7188; val_gene_expr_recon_loss: 2305057.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4255583.8750; val_optim_loss: 4255583.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9254; val_auprc_score: 0.9606; val_best_acc_score: 0.9189; val_best_f1_score: 0.9472; train_kl_reg_loss: 10371.7741; train_edge_recon_loss: 1343826.1214; train_cat_covariates_contrastive_loss: 632195.8580; train_gene_expr_recon_loss: 2328247.3714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4314641.0964; train_optim_loss: 4314641.0964; val_kl_reg_loss: 10285.1606; val_edge_recon_loss: 1371104.0625; val_cat_covariates_contrastive_loss: 632777.8438; val_gene_expr_recon_loss: 2298193.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4312360.6875; val_optim_loss: 4312360.6875
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9229; val_auprc_score: 0.9619; val_best_acc_score: 0.9187; val_best_f1_score: 0.9483; train_kl_reg_loss: 10350.6389; train_edge_recon_loss: 1334764.7625; train_cat_covariates_contrastive_loss: 632853.2473; train_gene_expr_recon_loss: 2331607.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4309576.3036; train_optim_loss: 4309576.3036; val_kl_reg_loss: 10208.1095; val_edge_recon_loss: 1302258.8125; val_cat_covariates_contrastive_loss: 630154.8906; val_gene_expr_recon_loss: 2311761.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4254382.8750; val_optim_loss: 4254382.8750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9133; val_auprc_score: 0.9573; val_best_acc_score: 0.9203; val_best_f1_score: 0.9490; train_kl_reg_loss: 10370.5534; train_edge_recon_loss: 1327844.3982; train_cat_covariates_contrastive_loss: 632378.4812; train_gene_expr_recon_loss: 2321823.3857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4292416.7964; train_optim_loss: 4292416.7964; val_kl_reg_loss: 10331.0032; val_edge_recon_loss: 1302711.0625; val_cat_covariates_contrastive_loss: 630625.0547; val_gene_expr_recon_loss: 2304892.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4248559.4062; val_optim_loss: 4248559.4062
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9304; val_auprc_score: 0.9645; val_best_acc_score: 0.9208; val_best_f1_score: 0.9485; train_kl_reg_loss: 10370.5514; train_edge_recon_loss: 1351980.5357; train_cat_covariates_contrastive_loss: 632852.4964; train_gene_expr_recon_loss: 2334981.5143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4330185.1036; train_optim_loss: 4330185.1036; val_kl_reg_loss: 10280.3058; val_edge_recon_loss: 1338289.3750; val_cat_covariates_contrastive_loss: 631416.7188; val_gene_expr_recon_loss: 2290823.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4270809.4375; val_optim_loss: 4270809.4375
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9211; val_auprc_score: 0.9590; val_best_acc_score: 0.9179; val_best_f1_score: 0.9469; train_kl_reg_loss: 10386.3495; train_edge_recon_loss: 1352121.0750; train_cat_covariates_contrastive_loss: 632099.4098; train_gene_expr_recon_loss: 2335446.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4330053.1571; train_optim_loss: 4330053.1571; val_kl_reg_loss: 10249.7842; val_edge_recon_loss: 1359365.1406; val_cat_covariates_contrastive_loss: 632591.4609; val_gene_expr_recon_loss: 2303496.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4305702.5625; val_optim_loss: 4305702.5625
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9186; val_auprc_score: 0.9592; val_best_acc_score: 0.9175; val_best_f1_score: 0.9465; train_kl_reg_loss: 10342.7942; train_edge_recon_loss: 1341336.2643; train_cat_covariates_contrastive_loss: 632119.0036; train_gene_expr_recon_loss: 2330487.5893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4314285.6607; train_optim_loss: 4314285.6607; val_kl_reg_loss: 10313.3700; val_edge_recon_loss: 1352946.0469; val_cat_covariates_contrastive_loss: 631617.7266; val_gene_expr_recon_loss: 2313272.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4308149.3438; val_optim_loss: 4308149.3438
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9101; val_auprc_score: 0.9539; val_best_acc_score: 0.9099; val_best_f1_score: 0.9422; train_kl_reg_loss: 10401.1449; train_edge_recon_loss: 1315502.0839; train_cat_covariates_contrastive_loss: 632401.4054; train_gene_expr_recon_loss: 2328945.1357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4287249.7429; train_optim_loss: 4287249.7429; val_kl_reg_loss: 10370.9056; val_edge_recon_loss: 1368789.6562; val_cat_covariates_contrastive_loss: 631837.7578; val_gene_expr_recon_loss: 2299158.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4310156.5938; val_optim_loss: 4310156.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8883; val_auprc_score: 0.9429; val_best_acc_score: 0.9067; val_best_f1_score: 0.9404; train_kl_reg_loss: 10392.5465; train_edge_recon_loss: 1341391.5214; train_cat_covariates_contrastive_loss: 633727.1625; train_gene_expr_recon_loss: 2328192.0036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4313703.2643; train_optim_loss: 4313703.2643; val_kl_reg_loss: 10444.6527; val_edge_recon_loss: 1381576.3594; val_cat_covariates_contrastive_loss: 633587.8750; val_gene_expr_recon_loss: 2313383.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4338992.6875; val_optim_loss: 4338992.6875
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9196; val_auprc_score: 0.9620; val_best_acc_score: 0.9184; val_best_f1_score: 0.9478; train_kl_reg_loss: 10414.4917; train_edge_recon_loss: 1329650.4000; train_cat_covariates_contrastive_loss: 632055.3063; train_gene_expr_recon_loss: 2331773.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4303893.2607; train_optim_loss: 4303893.2607; val_kl_reg_loss: 10361.6058; val_edge_recon_loss: 1326736.4844; val_cat_covariates_contrastive_loss: 632798.7812; val_gene_expr_recon_loss: 2318646.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4288543.5000; val_optim_loss: 4288543.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9141; val_auprc_score: 0.9515; val_best_acc_score: 0.9092; val_best_f1_score: 0.9411; train_kl_reg_loss: 10380.9528; train_edge_recon_loss: 1331580.4875; train_cat_covariates_contrastive_loss: 633345.6741; train_gene_expr_recon_loss: 2333519.5214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4308826.6536; train_optim_loss: 4308826.6536; val_kl_reg_loss: 10296.4779; val_edge_recon_loss: 1416310.1719; val_cat_covariates_contrastive_loss: 632073.8125; val_gene_expr_recon_loss: 2301713.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4360393.9688; val_optim_loss: 4360393.9688
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9113; val_auprc_score: 0.9519; val_best_acc_score: 0.9165; val_best_f1_score: 0.9461; train_kl_reg_loss: 10416.5096; train_edge_recon_loss: 1330758.5143; train_cat_covariates_contrastive_loss: 632796.7321; train_gene_expr_recon_loss: 2331934.4357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4305906.1893; train_optim_loss: 4305906.1893; val_kl_reg_loss: 10285.5787; val_edge_recon_loss: 1356131.2812; val_cat_covariates_contrastive_loss: 631221.3281; val_gene_expr_recon_loss: 2321017.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4318655.5625; val_optim_loss: 4318655.5625

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 46 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9078
val AUPRC score: 0.9439
val best accuracy score: 0.9097
val best F1 score: 0.9412
val target rna MSE score: 0.6709
val source rna MSE score: 0.0781
Val cat covariate0 mean sim diff: 0.0004
Val cat covariate1 mean sim diff: 0.0004
Duration of model training in run 6: 0 hours, 11 minutes and 55 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7421; val_auprc_score: 0.8950; val_best_acc_score: 0.7689; val_best_f1_score: 0.8648; train_kl_reg_loss: 5376.3189; train_edge_recon_loss: 1750012.1732; train_cat_covariates_contrastive_loss: 717822.7125; train_gene_expr_recon_loss: 3095809.7929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5569020.9929; train_optim_loss: 5569020.9929; val_kl_reg_loss: 14110.1947; val_edge_recon_loss: 1684861.4062; val_cat_covariates_contrastive_loss: 627073.2656; val_gene_expr_recon_loss: 2786599.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5112644.3750; val_optim_loss: 5112644.3750
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7777; val_auprc_score: 0.9086; val_best_acc_score: 0.7903; val_best_f1_score: 0.8716; train_kl_reg_loss: 12184.6301; train_edge_recon_loss: 1580635.2464; train_cat_covariates_contrastive_loss: 632744.9866; train_gene_expr_recon_loss: 2674795.4464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4900360.2857; train_optim_loss: 4900360.2857; val_kl_reg_loss: 12669.5494; val_edge_recon_loss: 1583587.9688; val_cat_covariates_contrastive_loss: 627313.6719; val_gene_expr_recon_loss: 2623957.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4847528.9375; val_optim_loss: 4847528.9375
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7753; val_auprc_score: 0.9024; val_best_acc_score: 0.7919; val_best_f1_score: 0.8745; train_kl_reg_loss: 12667.4281; train_edge_recon_loss: 1552645.3875; train_cat_covariates_contrastive_loss: 635249.8848; train_gene_expr_recon_loss: 2586065.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4786628.1643; train_optim_loss: 4786628.1643; val_kl_reg_loss: 9995.6696; val_edge_recon_loss: 1578779.7500; val_cat_covariates_contrastive_loss: 628369.3438; val_gene_expr_recon_loss: 2596931.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4814076.5000; val_optim_loss: 4814076.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8339; val_auprc_score: 0.9314; val_best_acc_score: 0.8240; val_best_f1_score: 0.8897; train_kl_reg_loss: 11426.4430; train_edge_recon_loss: 1473385.0018; train_cat_covariates_contrastive_loss: 633319.9759; train_gene_expr_recon_loss: 2557975.3393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4676106.7714; train_optim_loss: 4676106.7714; val_kl_reg_loss: 11522.2361; val_edge_recon_loss: 1479941.2656; val_cat_covariates_contrastive_loss: 633228.2891; val_gene_expr_recon_loss: 2580175.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4704867.4375; val_optim_loss: 4704867.4375
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8514; val_auprc_score: 0.9324; val_best_acc_score: 0.8405; val_best_f1_score: 0.8987; train_kl_reg_loss: 11891.7460; train_edge_recon_loss: 1438197.3018; train_cat_covariates_contrastive_loss: 634338.5929; train_gene_expr_recon_loss: 2527722.6786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4612150.3286; train_optim_loss: 4612150.3286; val_kl_reg_loss: 11223.7789; val_edge_recon_loss: 1436540.4844; val_cat_covariates_contrastive_loss: 633472.0781; val_gene_expr_recon_loss: 2544237.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4625474.1875; val_optim_loss: 4625474.1875
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8631; val_auprc_score: 0.9420; val_best_acc_score: 0.8537; val_best_f1_score: 0.9078; train_kl_reg_loss: 11272.1406; train_edge_recon_loss: 1363088.4482; train_cat_covariates_contrastive_loss: 632808.7205; train_gene_expr_recon_loss: 2510966.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4518136.0643; train_optim_loss: 4518136.0643; val_kl_reg_loss: 10927.7402; val_edge_recon_loss: 1427367.6562; val_cat_covariates_contrastive_loss: 631709.6016; val_gene_expr_recon_loss: 2519158.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4589163.8750; val_optim_loss: 4589163.8750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8858; val_auprc_score: 0.9462; val_best_acc_score: 0.8773; val_best_f1_score: 0.9216; train_kl_reg_loss: 10981.8145; train_edge_recon_loss: 1381485.7554; train_cat_covariates_contrastive_loss: 632005.3848; train_gene_expr_recon_loss: 2495672.5964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4520145.5571; train_optim_loss: 4520145.5571; val_kl_reg_loss: 10724.7736; val_edge_recon_loss: 1407187.9375; val_cat_covariates_contrastive_loss: 627908.8594; val_gene_expr_recon_loss: 2528589.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574410.9375; val_optim_loss: 4574410.9375
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8818; val_auprc_score: 0.9405; val_best_acc_score: 0.8812; val_best_f1_score: 0.9252; train_kl_reg_loss: 10724.0489; train_edge_recon_loss: 1363527.7625; train_cat_covariates_contrastive_loss: 631020.7223; train_gene_expr_recon_loss: 2472871.2321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4478143.7786; train_optim_loss: 4478143.7786; val_kl_reg_loss: 10560.5718; val_edge_recon_loss: 1339600.5469; val_cat_covariates_contrastive_loss: 628388.6094; val_gene_expr_recon_loss: 2526323.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4504872.8125; val_optim_loss: 4504872.8125
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8890; val_auprc_score: 0.9409; val_best_acc_score: 0.8876; val_best_f1_score: 0.9266; train_kl_reg_loss: 10387.1763; train_edge_recon_loss: 1373394.4946; train_cat_covariates_contrastive_loss: 630015.0116; train_gene_expr_recon_loss: 2462408.0536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4476204.7500; train_optim_loss: 4476204.7500; val_kl_reg_loss: 10376.4825; val_edge_recon_loss: 1385279.7500; val_cat_covariates_contrastive_loss: 631589.4688; val_gene_expr_recon_loss: 2496384.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4523630.2500; val_optim_loss: 4523630.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9085; val_auprc_score: 0.9544; val_best_acc_score: 0.8946; val_best_f1_score: 0.9325; train_kl_reg_loss: 10340.7360; train_edge_recon_loss: 1349090.2643; train_cat_covariates_contrastive_loss: 631706.8750; train_gene_expr_recon_loss: 2451542.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4442680.1679; train_optim_loss: 4442680.1679; val_kl_reg_loss: 10335.1359; val_edge_recon_loss: 1375305.9688; val_cat_covariates_contrastive_loss: 630005.2109; val_gene_expr_recon_loss: 2504902.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520549.0000; val_optim_loss: 4520549.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8991; val_auprc_score: 0.9460; val_best_acc_score: 0.8919; val_best_f1_score: 0.9303; train_kl_reg_loss: 10196.5906; train_edge_recon_loss: 1341071.8848; train_cat_covariates_contrastive_loss: 630499.8741; train_gene_expr_recon_loss: 2438096.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4419865.0464; train_optim_loss: 4419865.0464; val_kl_reg_loss: 10007.5015; val_edge_recon_loss: 1387340.7656; val_cat_covariates_contrastive_loss: 628852.0781; val_gene_expr_recon_loss: 2464186.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4490386.4375; val_optim_loss: 4490386.4375
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9157; val_auprc_score: 0.9582; val_best_acc_score: 0.9017; val_best_f1_score: 0.9363; train_kl_reg_loss: 9989.7763; train_edge_recon_loss: 1341254.9589; train_cat_covariates_contrastive_loss: 631036.7250; train_gene_expr_recon_loss: 2420779.9821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4403061.4214; train_optim_loss: 4403061.4214; val_kl_reg_loss: 9936.6073; val_edge_recon_loss: 1343841.4062; val_cat_covariates_contrastive_loss: 632062.1172; val_gene_expr_recon_loss: 2453817.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439657.3125; val_optim_loss: 4439657.3125
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9155; val_auprc_score: 0.9588; val_best_acc_score: 0.9153; val_best_f1_score: 0.9451; train_kl_reg_loss: 10124.8197; train_edge_recon_loss: 1341094.6482; train_cat_covariates_contrastive_loss: 631085.8170; train_gene_expr_recon_loss: 2410287.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4392593.2071; train_optim_loss: 4392593.2071; val_kl_reg_loss: 10094.2855; val_edge_recon_loss: 1371125.3906; val_cat_covariates_contrastive_loss: 629706.4531; val_gene_expr_recon_loss: 2443541.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4454467.7500; val_optim_loss: 4454467.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9250; val_auprc_score: 0.9666; val_best_acc_score: 0.9247; val_best_f1_score: 0.9521; train_kl_reg_loss: 9958.3414; train_edge_recon_loss: 1324296.1179; train_cat_covariates_contrastive_loss: 630784.8929; train_gene_expr_recon_loss: 2399299.4786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4364338.8643; train_optim_loss: 4364338.8643; val_kl_reg_loss: 9831.3306; val_edge_recon_loss: 1253684.1094; val_cat_covariates_contrastive_loss: 632423.5000; val_gene_expr_recon_loss: 2443543.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4339482.3750; val_optim_loss: 4339482.3750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9088; val_auprc_score: 0.9550; val_best_acc_score: 0.9106; val_best_f1_score: 0.9418; train_kl_reg_loss: 9896.6544; train_edge_recon_loss: 1350302.9250; train_cat_covariates_contrastive_loss: 631495.2232; train_gene_expr_recon_loss: 2385391.4786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4377086.3036; train_optim_loss: 4377086.3036; val_kl_reg_loss: 10006.5848; val_edge_recon_loss: 1381266.5469; val_cat_covariates_contrastive_loss: 635483.3750; val_gene_expr_recon_loss: 2437660.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4464417.0000; val_optim_loss: 4464417.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9145; val_auprc_score: 0.9611; val_best_acc_score: 0.9201; val_best_f1_score: 0.9493; train_kl_reg_loss: 9869.9817; train_edge_recon_loss: 1337690.8304; train_cat_covariates_contrastive_loss: 633171.6125; train_gene_expr_recon_loss: 2381094.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4361827.1607; train_optim_loss: 4361827.1607; val_kl_reg_loss: 10054.3790; val_edge_recon_loss: 1258872.0000; val_cat_covariates_contrastive_loss: 634152.1328; val_gene_expr_recon_loss: 2413400.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4316478.9688; val_optim_loss: 4316478.9688
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9108; val_auprc_score: 0.9559; val_best_acc_score: 0.9056; val_best_f1_score: 0.9390; train_kl_reg_loss: 9949.7926; train_edge_recon_loss: 1354915.5357; train_cat_covariates_contrastive_loss: 633268.8866; train_gene_expr_recon_loss: 2365514.3964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4363648.6393; train_optim_loss: 4363648.6393; val_kl_reg_loss: 10064.6696; val_edge_recon_loss: 1355929.7188; val_cat_covariates_contrastive_loss: 635269.3047; val_gene_expr_recon_loss: 2407180.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4408443.9375; val_optim_loss: 4408443.9375
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9268; val_auprc_score: 0.9624; val_best_acc_score: 0.9189; val_best_f1_score: 0.9467; train_kl_reg_loss: 10154.7650; train_edge_recon_loss: 1335327.3089; train_cat_covariates_contrastive_loss: 631401.6562; train_gene_expr_recon_loss: 2353063.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4329947.3143; train_optim_loss: 4329947.3143; val_kl_reg_loss: 9900.3625; val_edge_recon_loss: 1420702.0781; val_cat_covariates_contrastive_loss: 629838.9141; val_gene_expr_recon_loss: 2409450.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4469891.7500; val_optim_loss: 4469891.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9255; val_auprc_score: 0.9633; val_best_acc_score: 0.9119; val_best_f1_score: 0.9418; train_kl_reg_loss: 9977.7770; train_edge_recon_loss: 1347794.5625; train_cat_covariates_contrastive_loss: 632441.1714; train_gene_expr_recon_loss: 2349337.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4339550.7500; train_optim_loss: 4339550.7500; val_kl_reg_loss: 9942.9452; val_edge_recon_loss: 1383604.7500; val_cat_covariates_contrastive_loss: 628851.3047; val_gene_expr_recon_loss: 2379344.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4401743.4375; val_optim_loss: 4401743.4375
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9224; val_auprc_score: 0.9623; val_best_acc_score: 0.9168; val_best_f1_score: 0.9459; train_kl_reg_loss: 10000.2838; train_edge_recon_loss: 1338163.0804; train_cat_covariates_contrastive_loss: 631990.0786; train_gene_expr_recon_loss: 2344405.9536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4324559.4107; train_optim_loss: 4324559.4107; val_kl_reg_loss: 9907.6058; val_edge_recon_loss: 1363039.8594; val_cat_covariates_contrastive_loss: 632740.9375; val_gene_expr_recon_loss: 2379256.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4384944.6875; val_optim_loss: 4384944.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9281; val_auprc_score: 0.9602; val_best_acc_score: 0.9275; val_best_f1_score: 0.9520; train_kl_reg_loss: 10150.0651; train_edge_recon_loss: 1328153.6857; train_cat_covariates_contrastive_loss: 631208.6491; train_gene_expr_recon_loss: 2328076.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4297588.5857; train_optim_loss: 4297588.5857; val_kl_reg_loss: 10132.7358; val_edge_recon_loss: 1350782.4375; val_cat_covariates_contrastive_loss: 629305.5078; val_gene_expr_recon_loss: 2374803.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4365024.1250; val_optim_loss: 4365024.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9228; val_auprc_score: 0.9564; val_best_acc_score: 0.9203; val_best_f1_score: 0.9483; train_kl_reg_loss: 10160.1185; train_edge_recon_loss: 1323020.1107; train_cat_covariates_contrastive_loss: 631507.5321; train_gene_expr_recon_loss: 2325182.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4289870.2964; train_optim_loss: 4289870.2964; val_kl_reg_loss: 10161.2542; val_edge_recon_loss: 1355396.8281; val_cat_covariates_contrastive_loss: 630775.2109; val_gene_expr_recon_loss: 2376754.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4373087.6875; val_optim_loss: 4373087.6875
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9082; val_auprc_score: 0.9506; val_best_acc_score: 0.9110; val_best_f1_score: 0.9425; train_kl_reg_loss: 10155.1773; train_edge_recon_loss: 1342171.4232; train_cat_covariates_contrastive_loss: 632313.4866; train_gene_expr_recon_loss: 2326411.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4311051.8286; train_optim_loss: 4311051.8286; val_kl_reg_loss: 10268.0709; val_edge_recon_loss: 1379859.9531; val_cat_covariates_contrastive_loss: 630989.1406; val_gene_expr_recon_loss: 2372280.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4393397.4375; val_optim_loss: 4393397.4375
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9146; val_auprc_score: 0.9529; val_best_acc_score: 0.9202; val_best_f1_score: 0.9479; train_kl_reg_loss: 10150.6450; train_edge_recon_loss: 1338620.4196; train_cat_covariates_contrastive_loss: 633245.4518; train_gene_expr_recon_loss: 2323740.3714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4305756.8714; train_optim_loss: 4305756.8714; val_kl_reg_loss: 10161.1078; val_edge_recon_loss: 1331406.8750; val_cat_covariates_contrastive_loss: 631015.3203; val_gene_expr_recon_loss: 2380531.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4353115.0625; val_optim_loss: 4353115.0625

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 43 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9300
val AUPRC score: 0.9640
val best accuracy score: 0.9277
val best F1 score: 0.9536
val target rna MSE score: 0.7399
val source rna MSE score: 0.0794
Val cat covariate0 mean sim diff: 0.0124
Val cat covariate1 mean sim diff: 0.0124
Duration of model training in run 5: 0 hours, 4 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7506; val_auprc_score: 0.8991; val_best_acc_score: 0.7614; val_best_f1_score: 0.8594; train_kl_reg_loss: 3804.0565; train_edge_recon_loss: 1819592.3697; train_cat_covariates_contrastive_loss: 752352.0239; train_gene_expr_recon_loss: 3209152.7819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784901.2553; train_optim_loss: 5784901.2553; val_kl_reg_loss: 3945.1844; val_edge_recon_loss: 1915267.0208; val_cat_covariates_contrastive_loss: 627403.6667; val_gene_expr_recon_loss: 2896521.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5443137.3333; val_optim_loss: 5443137.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7612; val_auprc_score: 0.9021; val_best_acc_score: 0.7888; val_best_f1_score: 0.8739; train_kl_reg_loss: 10547.5640; train_edge_recon_loss: 1619650.2207; train_cat_covariates_contrastive_loss: 640908.4441; train_gene_expr_recon_loss: 2755116.1862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5026222.3830; train_optim_loss: 5026222.3830; val_kl_reg_loss: 9992.1281; val_edge_recon_loss: 1644971.8958; val_cat_covariates_contrastive_loss: 626860.8021; val_gene_expr_recon_loss: 2685814.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4967639.0000; val_optim_loss: 4967639.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7611; val_auprc_score: 0.9018; val_best_acc_score: 0.7937; val_best_f1_score: 0.8758; train_kl_reg_loss: 11473.5042; train_edge_recon_loss: 1560461.9468; train_cat_covariates_contrastive_loss: 633725.9162; train_gene_expr_recon_loss: 2613717.7979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819379.1915; train_optim_loss: 4819379.1915; val_kl_reg_loss: 11149.8524; val_edge_recon_loss: 1635354.5000; val_cat_covariates_contrastive_loss: 626889.3958; val_gene_expr_recon_loss: 2592482.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865876.2500; val_optim_loss: 4865876.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7685; val_auprc_score: 0.9074; val_best_acc_score: 0.7904; val_best_f1_score: 0.8735; train_kl_reg_loss: 12799.4083; train_edge_recon_loss: 1520158.9601; train_cat_covariates_contrastive_loss: 633447.1316; train_gene_expr_recon_loss: 2566583.6383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732989.1277; train_optim_loss: 4732989.1277; val_kl_reg_loss: 12956.4482; val_edge_recon_loss: 1560945.2292; val_cat_covariates_contrastive_loss: 628014.0000; val_gene_expr_recon_loss: 2543759.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745675.5833; val_optim_loss: 4745675.5833
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7804; val_auprc_score: 0.9152; val_best_acc_score: 0.8001; val_best_f1_score: 0.8791; train_kl_reg_loss: 12558.6093; train_edge_recon_loss: 1513090.9574; train_cat_covariates_contrastive_loss: 637267.0479; train_gene_expr_recon_loss: 2534638.2394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4697554.8936; train_optim_loss: 4697554.8936; val_kl_reg_loss: 15115.9149; val_edge_recon_loss: 1440483.8125; val_cat_covariates_contrastive_loss: 634123.6979; val_gene_expr_recon_loss: 2554171.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4643894.9167; val_optim_loss: 4643894.9167
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8253; val_auprc_score: 0.9261; val_best_acc_score: 0.8159; val_best_f1_score: 0.8827; train_kl_reg_loss: 12219.7387; train_edge_recon_loss: 1498847.3271; train_cat_covariates_contrastive_loss: 638799.8072; train_gene_expr_recon_loss: 2517916.2394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4667783.1383; train_optim_loss: 4667783.1383; val_kl_reg_loss: 12132.5869; val_edge_recon_loss: 1537655.9583; val_cat_covariates_contrastive_loss: 636671.3229; val_gene_expr_recon_loss: 2525099.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4711558.9167; val_optim_loss: 4711558.9167
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8504; val_auprc_score: 0.9352; val_best_acc_score: 0.8242; val_best_f1_score: 0.8897; train_kl_reg_loss: 12112.8832; train_edge_recon_loss: 1431627.9814; train_cat_covariates_contrastive_loss: 638724.6981; train_gene_expr_recon_loss: 2494701.3830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4577166.9149; train_optim_loss: 4577166.9149; val_kl_reg_loss: 12129.7964; val_edge_recon_loss: 1402749.6667; val_cat_covariates_contrastive_loss: 637730.6354; val_gene_expr_recon_loss: 2513188.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4565798.7083; val_optim_loss: 4565798.7083
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8422; val_auprc_score: 0.9369; val_best_acc_score: 0.8372; val_best_f1_score: 0.8984; train_kl_reg_loss: 12500.3701; train_edge_recon_loss: 1413939.3936; train_cat_covariates_contrastive_loss: 638831.9721; train_gene_expr_recon_loss: 2493212.6915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558484.4468; train_optim_loss: 4558484.4468; val_kl_reg_loss: 12520.7826; val_edge_recon_loss: 1343674.8542; val_cat_covariates_contrastive_loss: 635004.3021; val_gene_expr_recon_loss: 2509148.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4500348.6667; val_optim_loss: 4500348.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8658; val_auprc_score: 0.9381; val_best_acc_score: 0.8601; val_best_f1_score: 0.9096; train_kl_reg_loss: 12048.3968; train_edge_recon_loss: 1410042.9441; train_cat_covariates_contrastive_loss: 638011.0612; train_gene_expr_recon_loss: 2475731.6596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4535834.0532; train_optim_loss: 4535834.0532; val_kl_reg_loss: 12541.4749; val_edge_recon_loss: 1356858.8333; val_cat_covariates_contrastive_loss: 632512.2083; val_gene_expr_recon_loss: 2506027.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4507940.1667; val_optim_loss: 4507940.1667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8611; val_auprc_score: 0.9380; val_best_acc_score: 0.8509; val_best_f1_score: 0.9071; train_kl_reg_loss: 11689.1732; train_edge_recon_loss: 1382366.9468; train_cat_covariates_contrastive_loss: 635842.6330; train_gene_expr_recon_loss: 2472053.9096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4501952.7128; train_optim_loss: 4501952.7128; val_kl_reg_loss: 11771.1497; val_edge_recon_loss: 1398840.4583; val_cat_covariates_contrastive_loss: 640035.9271; val_gene_expr_recon_loss: 2503041.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4553688.9167; val_optim_loss: 4553688.9167
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8747; val_auprc_score: 0.9383; val_best_acc_score: 0.8725; val_best_f1_score: 0.9183; train_kl_reg_loss: 11449.5763; train_edge_recon_loss: 1335181.4920; train_cat_covariates_contrastive_loss: 634283.9322; train_gene_expr_recon_loss: 2460027.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4440942.4574; train_optim_loss: 4440942.4574; val_kl_reg_loss: 11386.7913; val_edge_recon_loss: 1343826.7917; val_cat_covariates_contrastive_loss: 635083.2292; val_gene_expr_recon_loss: 2480558.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4470855.3750; val_optim_loss: 4470855.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8730; val_auprc_score: 0.9377; val_best_acc_score: 0.8791; val_best_f1_score: 0.9242; train_kl_reg_loss: 11442.9632; train_edge_recon_loss: 1392019.8245; train_cat_covariates_contrastive_loss: 635113.6449; train_gene_expr_recon_loss: 2440872.4628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4479448.9149; train_optim_loss: 4479448.9149; val_kl_reg_loss: 11346.7686; val_edge_recon_loss: 1357720.8958; val_cat_covariates_contrastive_loss: 635318.0938; val_gene_expr_recon_loss: 2474963.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4479349.6667; val_optim_loss: 4479349.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8673; val_auprc_score: 0.9426; val_best_acc_score: 0.8689; val_best_f1_score: 0.9173; train_kl_reg_loss: 11082.4151; train_edge_recon_loss: 1380009.7048; train_cat_covariates_contrastive_loss: 634337.5426; train_gene_expr_recon_loss: 2440243.5585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4465673.2766; train_optim_loss: 4465673.2766; val_kl_reg_loss: 11153.0882; val_edge_recon_loss: 1332862.3125; val_cat_covariates_contrastive_loss: 631720.5833; val_gene_expr_recon_loss: 2441723.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4417459.0417; val_optim_loss: 4417459.0417
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8845; val_auprc_score: 0.9430; val_best_acc_score: 0.8773; val_best_f1_score: 0.9203; train_kl_reg_loss: 10886.4123; train_edge_recon_loss: 1364429.9894; train_cat_covariates_contrastive_loss: 633957.3484; train_gene_expr_recon_loss: 2422472.9521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4431746.7074; train_optim_loss: 4431746.7074; val_kl_reg_loss: 11001.5806; val_edge_recon_loss: 1458322.1250; val_cat_covariates_contrastive_loss: 637270.8021; val_gene_expr_recon_loss: 2438397.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4544991.9167; val_optim_loss: 4544991.9167
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8978; val_auprc_score: 0.9504; val_best_acc_score: 0.8868; val_best_f1_score: 0.9271; train_kl_reg_loss: 10604.2039; train_edge_recon_loss: 1372550.8564; train_cat_covariates_contrastive_loss: 633318.8989; train_gene_expr_recon_loss: 2415453.2287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4431927.1968; train_optim_loss: 4431927.1968; val_kl_reg_loss: 10702.2243; val_edge_recon_loss: 1423247.1667; val_cat_covariates_contrastive_loss: 637320.6771; val_gene_expr_recon_loss: 2469097.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4540367.4167; val_optim_loss: 4540367.4167
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8798; val_auprc_score: 0.9375; val_best_acc_score: 0.8772; val_best_f1_score: 0.9206; train_kl_reg_loss: 10717.8505; train_edge_recon_loss: 1379080.6729; train_cat_covariates_contrastive_loss: 634862.2407; train_gene_expr_recon_loss: 2413034.6064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4437695.3617; train_optim_loss: 4437695.3617; val_kl_reg_loss: 10908.9100; val_edge_recon_loss: 1430397.0000; val_cat_covariates_contrastive_loss: 630713.1979; val_gene_expr_recon_loss: 2437883.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4509902.0833; val_optim_loss: 4509902.0833
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9004; val_auprc_score: 0.9511; val_best_acc_score: 0.8889; val_best_f1_score: 0.9280; train_kl_reg_loss: 10848.7770; train_edge_recon_loss: 1354197.5771; train_cat_covariates_contrastive_loss: 634171.0878; train_gene_expr_recon_loss: 2400402.1170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399619.5851; train_optim_loss: 4399619.5851; val_kl_reg_loss: 10962.4910; val_edge_recon_loss: 1389829.6667; val_cat_covariates_contrastive_loss: 632192.3229; val_gene_expr_recon_loss: 2424571.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4457556.4167; val_optim_loss: 4457556.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8860; val_auprc_score: 0.9459; val_best_acc_score: 0.8883; val_best_f1_score: 0.9287; train_kl_reg_loss: 10718.6010; train_edge_recon_loss: 1356271.2899; train_cat_covariates_contrastive_loss: 632627.5027; train_gene_expr_recon_loss: 2390341.2234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4389958.5904; train_optim_loss: 4389958.5904; val_kl_reg_loss: 10944.5106; val_edge_recon_loss: 1398259.2917; val_cat_covariates_contrastive_loss: 632772.7188; val_gene_expr_recon_loss: 2466790.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4508767.4167; val_optim_loss: 4508767.4167
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8862; val_auprc_score: 0.9465; val_best_acc_score: 0.8857; val_best_f1_score: 0.9281; train_kl_reg_loss: 10780.9736; train_edge_recon_loss: 1363550.9894; train_cat_covariates_contrastive_loss: 633289.0771; train_gene_expr_recon_loss: 2398358.5319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4405979.5745; train_optim_loss: 4405979.5745; val_kl_reg_loss: 10740.9749; val_edge_recon_loss: 1322219.3125; val_cat_covariates_contrastive_loss: 638303.6875; val_gene_expr_recon_loss: 2389330.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4360594.8333; val_optim_loss: 4360594.8333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8969; val_auprc_score: 0.9472; val_best_acc_score: 0.8898; val_best_f1_score: 0.9297; train_kl_reg_loss: 10742.0565; train_edge_recon_loss: 1344549.8750; train_cat_covariates_contrastive_loss: 634216.4654; train_gene_expr_recon_loss: 2394233.4309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4383741.7979; train_optim_loss: 4383741.7979; val_kl_reg_loss: 10856.8787; val_edge_recon_loss: 1296643.9375; val_cat_covariates_contrastive_loss: 640345.0000; val_gene_expr_recon_loss: 2417785.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4365631.0833; val_optim_loss: 4365631.0833
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8976; val_auprc_score: 0.9506; val_best_acc_score: 0.8969; val_best_f1_score: 0.9341; train_kl_reg_loss: 10729.0066; train_edge_recon_loss: 1348268.5426; train_cat_covariates_contrastive_loss: 634258.6184; train_gene_expr_recon_loss: 2389815.6649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4383071.8830; train_optim_loss: 4383071.8830; val_kl_reg_loss: 10854.4891; val_edge_recon_loss: 1419366.5625; val_cat_covariates_contrastive_loss: 630295.0729; val_gene_expr_recon_loss: 2421982.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4482498.4167; val_optim_loss: 4482498.4167
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9218; val_auprc_score: 0.9609; val_best_acc_score: 0.9066; val_best_f1_score: 0.9399; train_kl_reg_loss: 10722.3398; train_edge_recon_loss: 1365866.8989; train_cat_covariates_contrastive_loss: 632595.7407; train_gene_expr_recon_loss: 2388712.1330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4397897.1011; train_optim_loss: 4397897.1011; val_kl_reg_loss: 10726.7861; val_edge_recon_loss: 1306998.7708; val_cat_covariates_contrastive_loss: 633768.6875; val_gene_expr_recon_loss: 2413265.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4364759.6667; val_optim_loss: 4364759.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9005; val_auprc_score: 0.9560; val_best_acc_score: 0.8872; val_best_f1_score: 0.9288; train_kl_reg_loss: 10643.1781; train_edge_recon_loss: 1375955.1915; train_cat_covariates_contrastive_loss: 632859.8843; train_gene_expr_recon_loss: 2386601.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4406059.4255; train_optim_loss: 4406059.4255; val_kl_reg_loss: 10755.5544; val_edge_recon_loss: 1330335.5000; val_cat_covariates_contrastive_loss: 650036.2812; val_gene_expr_recon_loss: 2394527.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4385654.8333; val_optim_loss: 4385654.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8994; val_auprc_score: 0.9473; val_best_acc_score: 0.8877; val_best_f1_score: 0.9277; train_kl_reg_loss: 10592.3989; train_edge_recon_loss: 1336888.5106; train_cat_covariates_contrastive_loss: 632553.8378; train_gene_expr_recon_loss: 2386480.1755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4366514.9043; train_optim_loss: 4366514.9043; val_kl_reg_loss: 10653.7694; val_edge_recon_loss: 1434594.1042; val_cat_covariates_contrastive_loss: 641717.0729; val_gene_expr_recon_loss: 2401733.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4488698.2500; val_optim_loss: 4488698.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9013; val_auprc_score: 0.9544; val_best_acc_score: 0.8978; val_best_f1_score: 0.9345; train_kl_reg_loss: 10645.2611; train_edge_recon_loss: 1347376.3936; train_cat_covariates_contrastive_loss: 634226.4016; train_gene_expr_recon_loss: 2382248.2553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4374496.3298; train_optim_loss: 4374496.3298; val_kl_reg_loss: 10692.4541; val_edge_recon_loss: 1385143.5625; val_cat_covariates_contrastive_loss: 640203.5417; val_gene_expr_recon_loss: 2464119.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4500159.0000; val_optim_loss: 4500159.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8988; val_auprc_score: 0.9446; val_best_acc_score: 0.8919; val_best_f1_score: 0.9301; train_kl_reg_loss: 10622.6323; train_edge_recon_loss: 1331165.3032; train_cat_covariates_contrastive_loss: 634459.7952; train_gene_expr_recon_loss: 2385106.5798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4361354.2819; train_optim_loss: 4361354.2819; val_kl_reg_loss: 10725.9025; val_edge_recon_loss: 1440702.4375; val_cat_covariates_contrastive_loss: 635141.1458; val_gene_expr_recon_loss: 2422466.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4509036.2500; val_optim_loss: 4509036.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8937; val_auprc_score: 0.9449; val_best_acc_score: 0.8896; val_best_f1_score: 0.9296; train_kl_reg_loss: 10659.7657; train_edge_recon_loss: 1339251.6995; train_cat_covariates_contrastive_loss: 633242.8870; train_gene_expr_recon_loss: 2389720.8617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4372875.2181; train_optim_loss: 4372875.2181; val_kl_reg_loss: 10736.3773; val_edge_recon_loss: 1362312.2292; val_cat_covariates_contrastive_loss: 635091.0312; val_gene_expr_recon_loss: 2437655.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4445795.0000; val_optim_loss: 4445795.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 22 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.9020
val AUPRC score: 0.9516
val best accuracy score: 0.8975
val best F1 score: 0.9341
val target rna MSE score: 0.7694
val source rna MSE score: 0.1029
Val cat covariate0 mean sim diff: 0.0101
Val cat covariate1 mean sim diff: 0.0101
Duration of model training in run 4: 0 hours, 3 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7567; val_auprc_score: 0.9046; val_best_acc_score: 0.7915; val_best_f1_score: 0.8764; train_kl_reg_loss: 8452.4637; train_edge_recon_loss: 1892161.3883; train_cat_covariates_contrastive_loss: 752788.3923; train_gene_expr_recon_loss: 3223826.2979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5877228.5851; train_optim_loss: 5877228.5851; val_kl_reg_loss: 15403.8657; val_edge_recon_loss: 1988813.9792; val_cat_covariates_contrastive_loss: 627136.8646; val_gene_expr_recon_loss: 2874127.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5505482.5833; val_optim_loss: 5505482.5833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7585; val_auprc_score: 0.9078; val_best_acc_score: 0.7766; val_best_f1_score: 0.8689; train_kl_reg_loss: 12376.8698; train_edge_recon_loss: 1680406.1543; train_cat_covariates_contrastive_loss: 690731.3617; train_gene_expr_recon_loss: 2761567.1223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5145081.4894; train_optim_loss: 5145081.4894; val_kl_reg_loss: 12857.6079; val_edge_recon_loss: 1662714.2083; val_cat_covariates_contrastive_loss: 628161.8229; val_gene_expr_recon_loss: 2750621.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5054354.7500; val_optim_loss: 5054354.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7831; val_auprc_score: 0.9074; val_best_acc_score: 0.7967; val_best_f1_score: 0.8757; train_kl_reg_loss: 14506.7474; train_edge_recon_loss: 1558238.0691; train_cat_covariates_contrastive_loss: 645225.1130; train_gene_expr_recon_loss: 2649029.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4866999.1596; train_optim_loss: 4866999.1596; val_kl_reg_loss: 14627.0174; val_edge_recon_loss: 1558680.1875; val_cat_covariates_contrastive_loss: 629829.4792; val_gene_expr_recon_loss: 2641424.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844561.0000; val_optim_loss: 4844561.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7960; val_auprc_score: 0.9149; val_best_acc_score: 0.8114; val_best_f1_score: 0.8859; train_kl_reg_loss: 14951.5872; train_edge_recon_loss: 1472612.0931; train_cat_covariates_contrastive_loss: 634146.8019; train_gene_expr_recon_loss: 2589714.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4711424.7872; train_optim_loss: 4711424.7872; val_kl_reg_loss: 13626.0732; val_edge_recon_loss: 1478371.2917; val_cat_covariates_contrastive_loss: 628495.8125; val_gene_expr_recon_loss: 2616091.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736584.5833; val_optim_loss: 4736584.5833
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8031; val_auprc_score: 0.9166; val_best_acc_score: 0.8305; val_best_f1_score: 0.8946; train_kl_reg_loss: 13940.7144; train_edge_recon_loss: 1468681.9415; train_cat_covariates_contrastive_loss: 631047.3205; train_gene_expr_recon_loss: 2558982.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4672652.5957; train_optim_loss: 4672652.5957; val_kl_reg_loss: 13426.7812; val_edge_recon_loss: 1384103.1458; val_cat_covariates_contrastive_loss: 628743.1458; val_gene_expr_recon_loss: 2584084.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4610357.7500; val_optim_loss: 4610357.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8239; val_auprc_score: 0.9211; val_best_acc_score: 0.8297; val_best_f1_score: 0.8937; train_kl_reg_loss: 13185.4169; train_edge_recon_loss: 1450014.8883; train_cat_covariates_contrastive_loss: 631495.2513; train_gene_expr_recon_loss: 2531263.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4625959.3191; train_optim_loss: 4625959.3191; val_kl_reg_loss: 13047.8750; val_edge_recon_loss: 1475334.2083; val_cat_covariates_contrastive_loss: 629262.2917; val_gene_expr_recon_loss: 2581708.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4699352.9167; val_optim_loss: 4699352.9167
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8260; val_auprc_score: 0.9257; val_best_acc_score: 0.8324; val_best_f1_score: 0.8957; train_kl_reg_loss: 12765.5583; train_edge_recon_loss: 1433684.7074; train_cat_covariates_contrastive_loss: 632145.1928; train_gene_expr_recon_loss: 2511038.1117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4589633.5532; train_optim_loss: 4589633.5532; val_kl_reg_loss: 12460.2000; val_edge_recon_loss: 1475452.4167; val_cat_covariates_contrastive_loss: 632084.8854; val_gene_expr_recon_loss: 2579497.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4699495.3333; val_optim_loss: 4699495.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8284; val_auprc_score: 0.9227; val_best_acc_score: 0.8325; val_best_f1_score: 0.8953; train_kl_reg_loss: 12530.9218; train_edge_recon_loss: 1413405.4761; train_cat_covariates_contrastive_loss: 632734.3963; train_gene_expr_recon_loss: 2498150.9043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4556821.7234; train_optim_loss: 4556821.7234; val_kl_reg_loss: 11949.4284; val_edge_recon_loss: 1522755.3125; val_cat_covariates_contrastive_loss: 631940.9479; val_gene_expr_recon_loss: 2529851.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4696497.1667; val_optim_loss: 4696497.1667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8534; val_auprc_score: 0.9358; val_best_acc_score: 0.8456; val_best_f1_score: 0.9008; train_kl_reg_loss: 12406.7301; train_edge_recon_loss: 1405989.0000; train_cat_covariates_contrastive_loss: 634379.0120; train_gene_expr_recon_loss: 2485741.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4538515.8191; train_optim_loss: 4538515.8191; val_kl_reg_loss: 11856.4398; val_edge_recon_loss: 1484996.8958; val_cat_covariates_contrastive_loss: 633241.5938; val_gene_expr_recon_loss: 2520280.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4650374.9167; val_optim_loss: 4650374.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8522; val_auprc_score: 0.9298; val_best_acc_score: 0.8558; val_best_f1_score: 0.9076; train_kl_reg_loss: 12085.5761; train_edge_recon_loss: 1410007.6170; train_cat_covariates_contrastive_loss: 633879.1064; train_gene_expr_recon_loss: 2475464.4415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4531436.7553; train_optim_loss: 4531436.7553; val_kl_reg_loss: 11861.7181; val_edge_recon_loss: 1415479.6458; val_cat_covariates_contrastive_loss: 633095.9896; val_gene_expr_recon_loss: 2557169.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4617606.6667; val_optim_loss: 4617606.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8743; val_auprc_score: 0.9449; val_best_acc_score: 0.8731; val_best_f1_score: 0.9192; train_kl_reg_loss: 11982.0013; train_edge_recon_loss: 1389641.4681; train_cat_covariates_contrastive_loss: 634264.6702; train_gene_expr_recon_loss: 2471166.3351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4507054.4894; train_optim_loss: 4507054.4894; val_kl_reg_loss: 11737.3394; val_edge_recon_loss: 1344293.9583; val_cat_covariates_contrastive_loss: 638726.9271; val_gene_expr_recon_loss: 2525254.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520012.9167; val_optim_loss: 4520012.9167
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8646; val_auprc_score: 0.9402; val_best_acc_score: 0.8598; val_best_f1_score: 0.9106; train_kl_reg_loss: 11957.3049; train_edge_recon_loss: 1380791.8059; train_cat_covariates_contrastive_loss: 634587.1689; train_gene_expr_recon_loss: 2468358.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4495694.7287; train_optim_loss: 4495694.7287; val_kl_reg_loss: 11810.1130; val_edge_recon_loss: 1430395.0833; val_cat_covariates_contrastive_loss: 633114.0729; val_gene_expr_recon_loss: 2526691.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4602010.9167; val_optim_loss: 4602010.9167
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8636; val_auprc_score: 0.9418; val_best_acc_score: 0.8553; val_best_f1_score: 0.9074; train_kl_reg_loss: 11909.3445; train_edge_recon_loss: 1398049.5186; train_cat_covariates_contrastive_loss: 633465.1888; train_gene_expr_recon_loss: 2469464.8989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512888.9681; train_optim_loss: 4512888.9681; val_kl_reg_loss: 11797.1060; val_edge_recon_loss: 1387589.3958; val_cat_covariates_contrastive_loss: 631945.1771; val_gene_expr_recon_loss: 2522539.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4553870.7500; val_optim_loss: 4553870.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8631; val_auprc_score: 0.9431; val_best_acc_score: 0.8627; val_best_f1_score: 0.9120; train_kl_reg_loss: 11947.7205; train_edge_recon_loss: 1391537.9468; train_cat_covariates_contrastive_loss: 632653.2487; train_gene_expr_recon_loss: 2464712.8723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4500851.7979; train_optim_loss: 4500851.7979; val_kl_reg_loss: 11692.3535; val_edge_recon_loss: 1421614.8958; val_cat_covariates_contrastive_loss: 643038.9167; val_gene_expr_recon_loss: 2521899.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4598245.8333; val_optim_loss: 4598245.8333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8528; val_auprc_score: 0.9346; val_best_acc_score: 0.8584; val_best_f1_score: 0.9097; train_kl_reg_loss: 11885.2167; train_edge_recon_loss: 1405001.9122; train_cat_covariates_contrastive_loss: 633589.7926; train_gene_expr_recon_loss: 2466601.4202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4517078.2979; train_optim_loss: 4517078.2979; val_kl_reg_loss: 11590.9655; val_edge_recon_loss: 1370250.8542; val_cat_covariates_contrastive_loss: 632037.2188; val_gene_expr_recon_loss: 2518851.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532730.5833; val_optim_loss: 4532730.5833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8532; val_auprc_score: 0.9315; val_best_acc_score: 0.8570; val_best_f1_score: 0.9073; train_kl_reg_loss: 11925.5705; train_edge_recon_loss: 1380141.1862; train_cat_covariates_contrastive_loss: 633836.7380; train_gene_expr_recon_loss: 2470298.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4496201.8298; train_optim_loss: 4496201.8298; val_kl_reg_loss: 11814.2860; val_edge_recon_loss: 1495074.0208; val_cat_covariates_contrastive_loss: 635321.1250; val_gene_expr_recon_loss: 2520482.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4662692.1667; val_optim_loss: 4662692.1667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8686; val_auprc_score: 0.9459; val_best_acc_score: 0.8671; val_best_f1_score: 0.9168; train_kl_reg_loss: 11886.9909; train_edge_recon_loss: 1372831.3803; train_cat_covariates_contrastive_loss: 632416.3963; train_gene_expr_recon_loss: 2467989.5638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4485124.3298; train_optim_loss: 4485124.3298; val_kl_reg_loss: 11713.4585; val_edge_recon_loss: 1266305.4688; val_cat_covariates_contrastive_loss: 633139.6146; val_gene_expr_recon_loss: 2541864.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4453022.7917; val_optim_loss: 4453022.7917
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8733; val_auprc_score: 0.9410; val_best_acc_score: 0.8718; val_best_f1_score: 0.9172; train_kl_reg_loss: 11888.5669; train_edge_recon_loss: 1367834.4761; train_cat_covariates_contrastive_loss: 633346.8032; train_gene_expr_recon_loss: 2461476.7926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474546.6383; train_optim_loss: 4474546.6383; val_kl_reg_loss: 11572.9362; val_edge_recon_loss: 1427635.7292; val_cat_covariates_contrastive_loss: 634327.6146; val_gene_expr_recon_loss: 2519761.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4593297.4167; val_optim_loss: 4593297.4167
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8449; val_auprc_score: 0.9288; val_best_acc_score: 0.8484; val_best_f1_score: 0.9023; train_kl_reg_loss: 11918.6186; train_edge_recon_loss: 1360742.6995; train_cat_covariates_contrastive_loss: 632956.8418; train_gene_expr_recon_loss: 2470218.0745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4475836.2766; train_optim_loss: 4475836.2766; val_kl_reg_loss: 11934.9300; val_edge_recon_loss: 1481389.6458; val_cat_covariates_contrastive_loss: 631985.8958; val_gene_expr_recon_loss: 2544396.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4669706.5833; val_optim_loss: 4669706.5833
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8767; val_auprc_score: 0.9420; val_best_acc_score: 0.8667; val_best_f1_score: 0.9134; train_kl_reg_loss: 11835.0469; train_edge_recon_loss: 1377491.4309; train_cat_covariates_contrastive_loss: 633232.1968; train_gene_expr_recon_loss: 2470446.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4493004.8191; train_optim_loss: 4493004.8191; val_kl_reg_loss: 11778.1208; val_edge_recon_loss: 1497166.7708; val_cat_covariates_contrastive_loss: 631649.2500; val_gene_expr_recon_loss: 2545108.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4685702.5833; val_optim_loss: 4685702.5833
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8780; val_auprc_score: 0.9452; val_best_acc_score: 0.8723; val_best_f1_score: 0.9184; train_kl_reg_loss: 11885.4823; train_edge_recon_loss: 1380151.0479; train_cat_covariates_contrastive_loss: 632281.6170; train_gene_expr_recon_loss: 2466166.5745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4490484.7181; train_optim_loss: 4490484.7181; val_kl_reg_loss: 11761.2344; val_edge_recon_loss: 1281076.5000; val_cat_covariates_contrastive_loss: 633689.3438; val_gene_expr_recon_loss: 2526827.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4453355.0833; val_optim_loss: 4453355.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8547; val_auprc_score: 0.9290; val_best_acc_score: 0.8605; val_best_f1_score: 0.9105; train_kl_reg_loss: 11868.4791; train_edge_recon_loss: 1370258.3271; train_cat_covariates_contrastive_loss: 633124.5146; train_gene_expr_recon_loss: 2464889.5053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4480140.8191; train_optim_loss: 4480140.8191; val_kl_reg_loss: 11677.2197; val_edge_recon_loss: 1413663.9167; val_cat_covariates_contrastive_loss: 630858.2917; val_gene_expr_recon_loss: 2542964.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4599164.1667; val_optim_loss: 4599164.1667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8753; val_auprc_score: 0.9458; val_best_acc_score: 0.8722; val_best_f1_score: 0.9180; train_kl_reg_loss: 11811.0621; train_edge_recon_loss: 1421256.5718; train_cat_covariates_contrastive_loss: 632976.5146; train_gene_expr_recon_loss: 2465114.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4531158.5957; train_optim_loss: 4531158.5957; val_kl_reg_loss: 11713.1746; val_edge_recon_loss: 1393147.3542; val_cat_covariates_contrastive_loss: 630291.9479; val_gene_expr_recon_loss: 2528647.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4563799.5000; val_optim_loss: 4563799.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8583; val_auprc_score: 0.9338; val_best_acc_score: 0.8594; val_best_f1_score: 0.9098; train_kl_reg_loss: 11843.5461; train_edge_recon_loss: 1389722.5266; train_cat_covariates_contrastive_loss: 633341.6915; train_gene_expr_recon_loss: 2466461.9681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4501369.7340; train_optim_loss: 4501369.7340; val_kl_reg_loss: 11639.7181; val_edge_recon_loss: 1431106.6458; val_cat_covariates_contrastive_loss: 634211.0521; val_gene_expr_recon_loss: 2544473.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4621430.2500; val_optim_loss: 4621430.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8453; val_auprc_score: 0.9311; val_best_acc_score: 0.8593; val_best_f1_score: 0.9105; train_kl_reg_loss: 11838.3843; train_edge_recon_loss: 1369284.9601; train_cat_covariates_contrastive_loss: 633983.5492; train_gene_expr_recon_loss: 2466637.9947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4481744.9149; train_optim_loss: 4481744.9149; val_kl_reg_loss: 11648.1851; val_edge_recon_loss: 1374884.2083; val_cat_covariates_contrastive_loss: 637313.7708; val_gene_expr_recon_loss: 2530409.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4554255.6667; val_optim_loss: 4554255.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 56 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.8506
val AUPRC score: 0.9357
val best accuracy score: 0.8580
val best F1 score: 0.9108
val target rna MSE score: 0.7105
val source rna MSE score: 0.1263
Val cat covariate0 mean sim diff: -0.0002
Val cat covariate1 mean sim diff: -0.0002
Duration of model training in run 3: 0 hours, 3 minutes and 2 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7829; val_auprc_score: 0.9184; val_best_acc_score: 0.7936; val_best_f1_score: 0.8781; train_kl_reg_loss: 3201.0009; train_edge_recon_loss: 1818409.7300; train_cat_covariates_contrastive_loss: 827949.3450; train_gene_expr_recon_loss: 3297396.3300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5946956.4200; train_optim_loss: 5946956.4200; val_kl_reg_loss: 3098.7417; val_edge_recon_loss: 2029683.2500; val_cat_covariates_contrastive_loss: 626764.0625; val_gene_expr_recon_loss: 3045839.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5705385.3333; val_optim_loss: 5705385.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7456; val_auprc_score: 0.8990; val_best_acc_score: 0.7627; val_best_f1_score: 0.8551; train_kl_reg_loss: 3599.1085; train_edge_recon_loss: 1826108.4200; train_cat_covariates_contrastive_loss: 708028.0150; train_gene_expr_recon_loss: 2919630.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5457365.7400; train_optim_loss: 5457365.7400; val_kl_reg_loss: 4041.2389; val_edge_recon_loss: 1882613.0000; val_cat_covariates_contrastive_loss: 628443.8125; val_gene_expr_recon_loss: 2786687.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5301785.6667; val_optim_loss: 5301785.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7225; val_auprc_score: 0.8913; val_best_acc_score: 0.7742; val_best_f1_score: 0.8670; train_kl_reg_loss: 7667.8332; train_edge_recon_loss: 1696216.7800; train_cat_covariates_contrastive_loss: 665235.7975; train_gene_expr_recon_loss: 2742879.5900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5112000.0200; train_optim_loss: 5112000.0200; val_kl_reg_loss: 11790.8841; val_edge_recon_loss: 1675115.5000; val_cat_covariates_contrastive_loss: 626899.8750; val_gene_expr_recon_loss: 2755092.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5068899.0000; val_optim_loss: 5068899.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7524; val_auprc_score: 0.9031; val_best_acc_score: 0.7802; val_best_f1_score: 0.8707; train_kl_reg_loss: 11706.9508; train_edge_recon_loss: 1558598.3400; train_cat_covariates_contrastive_loss: 646637.5875; train_gene_expr_recon_loss: 2657482.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4874425.3600; train_optim_loss: 4874425.3600; val_kl_reg_loss: 12687.3079; val_edge_recon_loss: 1542753.5417; val_cat_covariates_contrastive_loss: 627414.2500; val_gene_expr_recon_loss: 2608716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4791571.1667; val_optim_loss: 4791571.1667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7234; val_auprc_score: 0.8963; val_best_acc_score: 0.7619; val_best_f1_score: 0.8635; train_kl_reg_loss: 13404.1146; train_edge_recon_loss: 1553450.3800; train_cat_covariates_contrastive_loss: 635848.9775; train_gene_expr_recon_loss: 2600550.3700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803253.8500; train_optim_loss: 4803253.8500; val_kl_reg_loss: 15219.0153; val_edge_recon_loss: 1620512.4167; val_cat_covariates_contrastive_loss: 627446.7292; val_gene_expr_recon_loss: 2649393.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912571.5000; val_optim_loss: 4912571.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7118; val_auprc_score: 0.8851; val_best_acc_score: 0.7759; val_best_f1_score: 0.8649; train_kl_reg_loss: 13896.4208; train_edge_recon_loss: 1539348.1175; train_cat_covariates_contrastive_loss: 633943.4525; train_gene_expr_recon_loss: 2574218.1900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4761406.1900; train_optim_loss: 4761406.1900; val_kl_reg_loss: 13351.3734; val_edge_recon_loss: 1676546.2083; val_cat_covariates_contrastive_loss: 627192.7917; val_gene_expr_recon_loss: 2651972.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4969062.8333; val_optim_loss: 4969062.8333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7245; val_auprc_score: 0.8779; val_best_acc_score: 0.7648; val_best_f1_score: 0.8579; train_kl_reg_loss: 14379.6996; train_edge_recon_loss: 1553117.9450; train_cat_covariates_contrastive_loss: 635681.4600; train_gene_expr_recon_loss: 2560300.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4763479.6400; train_optim_loss: 4763479.6400; val_kl_reg_loss: 15827.7829; val_edge_recon_loss: 1702066.4167; val_cat_covariates_contrastive_loss: 628579.5417; val_gene_expr_recon_loss: 2604200.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950674.1667; val_optim_loss: 4950674.1667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7657; val_auprc_score: 0.9071; val_best_acc_score: 0.8103; val_best_f1_score: 0.8859; train_kl_reg_loss: 13495.2560; train_edge_recon_loss: 1545954.6000; train_cat_covariates_contrastive_loss: 635791.4175; train_gene_expr_recon_loss: 2539129.7800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4734371.0200; train_optim_loss: 4734371.0200; val_kl_reg_loss: 11373.9323; val_edge_recon_loss: 1503543.7917; val_cat_covariates_contrastive_loss: 627733.2292; val_gene_expr_recon_loss: 2545615.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4688266.0000; val_optim_loss: 4688266.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7449; val_auprc_score: 0.8928; val_best_acc_score: 0.7744; val_best_f1_score: 0.8614; train_kl_reg_loss: 12381.0716; train_edge_recon_loss: 1469628.4750; train_cat_covariates_contrastive_loss: 642312.8675; train_gene_expr_recon_loss: 2528610.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4652933.1600; train_optim_loss: 4652933.1600; val_kl_reg_loss: 14067.3590; val_edge_recon_loss: 1670781.2083; val_cat_covariates_contrastive_loss: 630668.3750; val_gene_expr_recon_loss: 2554161.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4869679.0000; val_optim_loss: 4869679.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7405; val_auprc_score: 0.8877; val_best_acc_score: 0.7760; val_best_f1_score: 0.8647; train_kl_reg_loss: 16070.9659; train_edge_recon_loss: 1486709.6000; train_cat_covariates_contrastive_loss: 646668.3200; train_gene_expr_recon_loss: 2518027.5700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4667476.5000; train_optim_loss: 4667476.5000; val_kl_reg_loss: 14179.0215; val_edge_recon_loss: 1655621.1250; val_cat_covariates_contrastive_loss: 630260.0000; val_gene_expr_recon_loss: 2543990.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4844051.0000; val_optim_loss: 4844051.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7939; val_auprc_score: 0.9102; val_best_acc_score: 0.7909; val_best_f1_score: 0.8709; train_kl_reg_loss: 14053.3431; train_edge_recon_loss: 1426946.8050; train_cat_covariates_contrastive_loss: 634841.7425; train_gene_expr_recon_loss: 2504897.2100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4580739.1400; train_optim_loss: 4580739.1400; val_kl_reg_loss: 12817.3053; val_edge_recon_loss: 1574696.2083; val_cat_covariates_contrastive_loss: 631198.6875; val_gene_expr_recon_loss: 2617328.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4836040.8333; val_optim_loss: 4836040.8333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8051; val_auprc_score: 0.9229; val_best_acc_score: 0.8060; val_best_f1_score: 0.8820; train_kl_reg_loss: 12704.7999; train_edge_recon_loss: 1498783.5400; train_cat_covariates_contrastive_loss: 684131.2425; train_gene_expr_recon_loss: 2506158.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4701778.4600; train_optim_loss: 4701778.4600; val_kl_reg_loss: 12318.0163; val_edge_recon_loss: 1493095.4167; val_cat_covariates_contrastive_loss: 630728.2708; val_gene_expr_recon_loss: 2547106.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4683248.1667; val_optim_loss: 4683248.1667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7690; val_auprc_score: 0.9001; val_best_acc_score: 0.7915; val_best_f1_score: 0.8712; train_kl_reg_loss: 12729.8920; train_edge_recon_loss: 1511723.5050; train_cat_covariates_contrastive_loss: 636552.1075; train_gene_expr_recon_loss: 2490087.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4651092.6800; train_optim_loss: 4651092.6800; val_kl_reg_loss: 11731.9749; val_edge_recon_loss: 1585198.6667; val_cat_covariates_contrastive_loss: 634219.6875; val_gene_expr_recon_loss: 2507302.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4738453.1667; val_optim_loss: 4738453.1667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7925; val_auprc_score: 0.9176; val_best_acc_score: 0.8000; val_best_f1_score: 0.8792; train_kl_reg_loss: 12392.6614; train_edge_recon_loss: 1448632.9050; train_cat_covariates_contrastive_loss: 686119.7900; train_gene_expr_recon_loss: 2487048.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4634193.8800; train_optim_loss: 4634193.8800; val_kl_reg_loss: 12830.6826; val_edge_recon_loss: 1435763.2917; val_cat_covariates_contrastive_loss: 638532.8125; val_gene_expr_recon_loss: 2547078.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4634205.6667; val_optim_loss: 4634205.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7618; val_auprc_score: 0.9059; val_best_acc_score: 0.7637; val_best_f1_score: 0.8590; train_kl_reg_loss: 12552.1916; train_edge_recon_loss: 1479417.7900; train_cat_covariates_contrastive_loss: 669955.7750; train_gene_expr_recon_loss: 2479203.2400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4641129.0200; train_optim_loss: 4641129.0200; val_kl_reg_loss: 12109.7448; val_edge_recon_loss: 1562175.8750; val_cat_covariates_contrastive_loss: 642320.1875; val_gene_expr_recon_loss: 2537607.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4754213.5000; val_optim_loss: 4754213.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7871; val_auprc_score: 0.9054; val_best_acc_score: 0.7902; val_best_f1_score: 0.8694; train_kl_reg_loss: 12238.2247; train_edge_recon_loss: 1500425.8100; train_cat_covariates_contrastive_loss: 644070.9625; train_gene_expr_recon_loss: 2470749.8700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4627484.8600; train_optim_loss: 4627484.8600; val_kl_reg_loss: 12269.3057; val_edge_recon_loss: 1405944.9583; val_cat_covariates_contrastive_loss: 636575.8958; val_gene_expr_recon_loss: 2488267.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4543057.8333; val_optim_loss: 4543057.8333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7487; val_auprc_score: 0.8868; val_best_acc_score: 0.7641; val_best_f1_score: 0.8541; train_kl_reg_loss: 12041.9721; train_edge_recon_loss: 1408301.3650; train_cat_covariates_contrastive_loss: 640073.5250; train_gene_expr_recon_loss: 2462749.2200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4523166.0200; train_optim_loss: 4523166.0200; val_kl_reg_loss: 12028.6868; val_edge_recon_loss: 1607910.9583; val_cat_covariates_contrastive_loss: 635116.3958; val_gene_expr_recon_loss: 2432639.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4687695.3333; val_optim_loss: 4687695.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7973; val_auprc_score: 0.9250; val_best_acc_score: 0.7859; val_best_f1_score: 0.8681; train_kl_reg_loss: 12084.7265; train_edge_recon_loss: 1398880.6925; train_cat_covariates_contrastive_loss: 636594.4675; train_gene_expr_recon_loss: 2462191.8200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4509751.6400; train_optim_loss: 4509751.6400; val_kl_reg_loss: 11942.6299; val_edge_recon_loss: 1409169.5000; val_cat_covariates_contrastive_loss: 633556.4375; val_gene_expr_recon_loss: 2498840.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4553509.5000; val_optim_loss: 4553509.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7916; val_auprc_score: 0.9024; val_best_acc_score: 0.7849; val_best_f1_score: 0.8620; train_kl_reg_loss: 12040.2413; train_edge_recon_loss: 1336849.2200; train_cat_covariates_contrastive_loss: 635456.6750; train_gene_expr_recon_loss: 2455113.4700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4439459.5800; train_optim_loss: 4439459.5800; val_kl_reg_loss: 11886.7184; val_edge_recon_loss: 1618236.0000; val_cat_covariates_contrastive_loss: 636521.9792; val_gene_expr_recon_loss: 2520504.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4787149.0000; val_optim_loss: 4787149.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7651; val_auprc_score: 0.9015; val_best_acc_score: 0.7923; val_best_f1_score: 0.8702; train_kl_reg_loss: 11823.4219; train_edge_recon_loss: 1383916.2475; train_cat_covariates_contrastive_loss: 639713.5525; train_gene_expr_recon_loss: 2439076.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4474529.5700; train_optim_loss: 4474529.5700; val_kl_reg_loss: 12013.0592; val_edge_recon_loss: 1468212.6250; val_cat_covariates_contrastive_loss: 641220.1667; val_gene_expr_recon_loss: 2522078.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4643524.5000; val_optim_loss: 4643524.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8137; val_auprc_score: 0.9316; val_best_acc_score: 0.8000; val_best_f1_score: 0.8765; train_kl_reg_loss: 11979.2521; train_edge_recon_loss: 1380666.9550; train_cat_covariates_contrastive_loss: 648856.8650; train_gene_expr_recon_loss: 2434082.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4475585.4000; train_optim_loss: 4475585.4000; val_kl_reg_loss: 11770.1745; val_edge_recon_loss: 1400719.4583; val_cat_covariates_contrastive_loss: 635635.0208; val_gene_expr_recon_loss: 2458213.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4506338.3333; val_optim_loss: 4506338.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8161; val_auprc_score: 0.9294; val_best_acc_score: 0.8020; val_best_f1_score: 0.8771; train_kl_reg_loss: 11822.8207; train_edge_recon_loss: 1391681.8600; train_cat_covariates_contrastive_loss: 653346.6625; train_gene_expr_recon_loss: 2431854.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4488705.4000; train_optim_loss: 4488705.4000; val_kl_reg_loss: 11831.4674; val_edge_recon_loss: 1406321.4167; val_cat_covariates_contrastive_loss: 641596.9375; val_gene_expr_recon_loss: 2477304.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4537054.0000; val_optim_loss: 4537054.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7872; val_auprc_score: 0.9216; val_best_acc_score: 0.7929; val_best_f1_score: 0.8685; train_kl_reg_loss: 11770.7692; train_edge_recon_loss: 1466963.1250; train_cat_covariates_contrastive_loss: 651276.0500; train_gene_expr_recon_loss: 2430618.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560628.7000; train_optim_loss: 4560628.7000; val_kl_reg_loss: 11808.6204; val_edge_recon_loss: 1465961.2917; val_cat_covariates_contrastive_loss: 634983.9375; val_gene_expr_recon_loss: 2508891.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4621645.6667; val_optim_loss: 4621645.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8146; val_auprc_score: 0.9296; val_best_acc_score: 0.7978; val_best_f1_score: 0.8723; train_kl_reg_loss: 11892.7036; train_edge_recon_loss: 1394917.0050; train_cat_covariates_contrastive_loss: 651164.6725; train_gene_expr_recon_loss: 2429044.8300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4487019.2200; train_optim_loss: 4487019.2200; val_kl_reg_loss: 12019.0749; val_edge_recon_loss: 1400777.9583; val_cat_covariates_contrastive_loss: 636026.7500; val_gene_expr_recon_loss: 2461598.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4510422.0000; val_optim_loss: 4510422.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8057; val_auprc_score: 0.9157; val_best_acc_score: 0.7882; val_best_f1_score: 0.8619; train_kl_reg_loss: 12047.2150; train_edge_recon_loss: 1370281.3500; train_cat_covariates_contrastive_loss: 680744.3675; train_gene_expr_recon_loss: 2433581.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4496654.6000; train_optim_loss: 4496654.6000; val_kl_reg_loss: 12081.7389; val_edge_recon_loss: 1578203.2917; val_cat_covariates_contrastive_loss: 645887.4792; val_gene_expr_recon_loss: 2450746.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4686919.3333; val_optim_loss: 4686919.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7755; val_auprc_score: 0.8970; val_best_acc_score: 0.7965; val_best_f1_score: 0.8720; train_kl_reg_loss: 12116.6774; train_edge_recon_loss: 1331934.4950; train_cat_covariates_contrastive_loss: 641879.2400; train_gene_expr_recon_loss: 2430393.9200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4416324.3000; train_optim_loss: 4416324.3000; val_kl_reg_loss: 12038.7516; val_edge_recon_loss: 1459719.9583; val_cat_covariates_contrastive_loss: 634923.9167; val_gene_expr_recon_loss: 2481230.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4587913.1667; val_optim_loss: 4587913.1667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8091; val_auprc_score: 0.9224; val_best_acc_score: 0.8018; val_best_f1_score: 0.8758; train_kl_reg_loss: 12099.0407; train_edge_recon_loss: 1425992.5250; train_cat_covariates_contrastive_loss: 680562.0725; train_gene_expr_recon_loss: 2435351.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4554004.9400; train_optim_loss: 4554004.9400; val_kl_reg_loss: 12142.6738; val_edge_recon_loss: 1429916.9167; val_cat_covariates_contrastive_loss: 640694.7708; val_gene_expr_recon_loss: 2547904.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4630658.8333; val_optim_loss: 4630658.8333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8131; val_auprc_score: 0.9298; val_best_acc_score: 0.8085; val_best_f1_score: 0.8794; train_kl_reg_loss: 12091.3572; train_edge_recon_loss: 1311719.3100; train_cat_covariates_contrastive_loss: 642917.3600; train_gene_expr_recon_loss: 2436554.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4403282.6200; train_optim_loss: 4403282.6200; val_kl_reg_loss: 11885.4141; val_edge_recon_loss: 1405637.5833; val_cat_covariates_contrastive_loss: 634547.5833; val_gene_expr_recon_loss: 2492031.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4544101.6667; val_optim_loss: 4544101.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7831; val_auprc_score: 0.9112; val_best_acc_score: 0.7927; val_best_f1_score: 0.8712; train_kl_reg_loss: 12167.8348; train_edge_recon_loss: 1396677.6100; train_cat_covariates_contrastive_loss: 640994.0950; train_gene_expr_recon_loss: 2435268.7900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4485108.3700; train_optim_loss: 4485108.3700; val_kl_reg_loss: 12277.8730; val_edge_recon_loss: 1461922.6667; val_cat_covariates_contrastive_loss: 632986.9792; val_gene_expr_recon_loss: 2505561.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4612748.8333; val_optim_loss: 4612748.8333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 47 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.7971
val AUPRC score: 0.9272
val best accuracy score: 0.8116
val best F1 score: 0.8852
val target rna MSE score: 0.7976
val source rna MSE score: 0.1742
Val cat covariate0 mean sim diff: 0.0054
Val cat covariate1 mean sim diff: 0.0054
Duration of model training in run 2: 0 hours, 1 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7387; val_auprc_score: 0.9049; val_best_acc_score: 0.7969; val_best_f1_score: 0.8803; train_kl_reg_loss: 6092.2625; train_edge_recon_loss: 1966468.3600; train_cat_covariates_contrastive_loss: 804613.5800; train_gene_expr_recon_loss: 3292109.4400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6069283.6600; train_optim_loss: 6069283.6600; val_kl_reg_loss: 6488.6673; val_edge_recon_loss: 2000568.3333; val_cat_covariates_contrastive_loss: 626738.2292; val_gene_expr_recon_loss: 3057412.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5691207.5000; val_optim_loss: 5691207.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7328; val_auprc_score: 0.8793; val_best_acc_score: 0.7757; val_best_f1_score: 0.8658; train_kl_reg_loss: 10759.8481; train_edge_recon_loss: 1901623.7900; train_cat_covariates_contrastive_loss: 721493.5650; train_gene_expr_recon_loss: 2924871.5800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5558748.8400; train_optim_loss: 5558748.8400; val_kl_reg_loss: 6323.7697; val_edge_recon_loss: 2031367.5000; val_cat_covariates_contrastive_loss: 627659.2708; val_gene_expr_recon_loss: 2865005.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5530356.5000; val_optim_loss: 5530356.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7198; val_auprc_score: 0.8876; val_best_acc_score: 0.7894; val_best_f1_score: 0.8752; train_kl_reg_loss: 8271.9424; train_edge_recon_loss: 1694469.8700; train_cat_covariates_contrastive_loss: 682247.0225; train_gene_expr_recon_loss: 2734490.9200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5119479.6800; train_optim_loss: 5119479.6800; val_kl_reg_loss: 9854.6631; val_edge_recon_loss: 1677478.4583; val_cat_covariates_contrastive_loss: 626870.8958; val_gene_expr_recon_loss: 2723699.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5037904.0000; val_optim_loss: 5037904.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7285; val_auprc_score: 0.8858; val_best_acc_score: 0.7738; val_best_f1_score: 0.8682; train_kl_reg_loss: 13240.2212; train_edge_recon_loss: 1547027.0200; train_cat_covariates_contrastive_loss: 637983.7800; train_gene_expr_recon_loss: 2651112.1100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4849363.1500; train_optim_loss: 4849363.1500; val_kl_reg_loss: 15592.8262; val_edge_recon_loss: 1608203.0833; val_cat_covariates_contrastive_loss: 626947.0208; val_gene_expr_recon_loss: 2707903.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4958646.8333; val_optim_loss: 4958646.8333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7164; val_auprc_score: 0.8832; val_best_acc_score: 0.7895; val_best_f1_score: 0.8783; train_kl_reg_loss: 15258.5992; train_edge_recon_loss: 1482984.2250; train_cat_covariates_contrastive_loss: 633183.2650; train_gene_expr_recon_loss: 2597695.7300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4729121.8200; train_optim_loss: 4729121.8200; val_kl_reg_loss: 15188.6051; val_edge_recon_loss: 1617382.1667; val_cat_covariates_contrastive_loss: 627813.5208; val_gene_expr_recon_loss: 2614862.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4875246.6667; val_optim_loss: 4875246.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7458; val_auprc_score: 0.8896; val_best_acc_score: 0.7836; val_best_f1_score: 0.8694; train_kl_reg_loss: 14927.5342; train_edge_recon_loss: 1567720.2800; train_cat_covariates_contrastive_loss: 637220.5650; train_gene_expr_recon_loss: 2570658.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4790526.9600; train_optim_loss: 4790526.9600; val_kl_reg_loss: 13764.5667; val_edge_recon_loss: 1606216.1667; val_cat_covariates_contrastive_loss: 627712.5417; val_gene_expr_recon_loss: 2627223.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4874917.1667; val_optim_loss: 4874917.1667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7436; val_auprc_score: 0.9006; val_best_acc_score: 0.7621; val_best_f1_score: 0.8617; train_kl_reg_loss: 13773.9587; train_edge_recon_loss: 1501157.9750; train_cat_covariates_contrastive_loss: 644930.2500; train_gene_expr_recon_loss: 2551242.9900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4711105.1600; train_optim_loss: 4711105.1600; val_kl_reg_loss: 14135.0335; val_edge_recon_loss: 1662452.0833; val_cat_covariates_contrastive_loss: 628238.8958; val_gene_expr_recon_loss: 2663373.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4968199.0000; val_optim_loss: 4968199.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7529; val_auprc_score: 0.8974; val_best_acc_score: 0.7849; val_best_f1_score: 0.8742; train_kl_reg_loss: 15150.1543; train_edge_recon_loss: 1482605.5450; train_cat_covariates_contrastive_loss: 636906.3850; train_gene_expr_recon_loss: 2540987.9400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4675650.0100; train_optim_loss: 4675650.0100; val_kl_reg_loss: 15277.5332; val_edge_recon_loss: 1550145.9583; val_cat_covariates_contrastive_loss: 628317.9167; val_gene_expr_recon_loss: 2664476.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858217.8333; val_optim_loss: 4858217.8333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7809; val_auprc_score: 0.9143; val_best_acc_score: 0.7834; val_best_f1_score: 0.8687; train_kl_reg_loss: 14227.0589; train_edge_recon_loss: 1499029.9950; train_cat_covariates_contrastive_loss: 640349.0500; train_gene_expr_recon_loss: 2521700.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4675306.6800; train_optim_loss: 4675306.6800; val_kl_reg_loss: 11964.9173; val_edge_recon_loss: 1589335.9583; val_cat_covariates_contrastive_loss: 630240.7500; val_gene_expr_recon_loss: 2629528.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4861070.3333; val_optim_loss: 4861070.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7571; val_auprc_score: 0.9043; val_best_acc_score: 0.7820; val_best_f1_score: 0.8716; train_kl_reg_loss: 12424.9144; train_edge_recon_loss: 1539858.7900; train_cat_covariates_contrastive_loss: 654404.8350; train_gene_expr_recon_loss: 2504393.7600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4711082.2800; train_optim_loss: 4711082.2800; val_kl_reg_loss: 12502.2194; val_edge_recon_loss: 1531101.1250; val_cat_covariates_contrastive_loss: 630519.9375; val_gene_expr_recon_loss: 2557793.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731916.8333; val_optim_loss: 4731916.8333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7945; val_auprc_score: 0.9199; val_best_acc_score: 0.7949; val_best_f1_score: 0.8747; train_kl_reg_loss: 13608.4386; train_edge_recon_loss: 1466023.7150; train_cat_covariates_contrastive_loss: 648615.1200; train_gene_expr_recon_loss: 2501296.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4629543.8200; train_optim_loss: 4629543.8200; val_kl_reg_loss: 12793.4238; val_edge_recon_loss: 1509558.7500; val_cat_covariates_contrastive_loss: 633339.5625; val_gene_expr_recon_loss: 2590667.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746359.1667; val_optim_loss: 4746359.1667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7625; val_auprc_score: 0.9060; val_best_acc_score: 0.7527; val_best_f1_score: 0.8555; train_kl_reg_loss: 14011.7862; train_edge_recon_loss: 1428520.9650; train_cat_covariates_contrastive_loss: 640097.3750; train_gene_expr_recon_loss: 2490633.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4573263.7600; train_optim_loss: 4573263.7600; val_kl_reg_loss: 14514.7191; val_edge_recon_loss: 1664704.7083; val_cat_covariates_contrastive_loss: 635568.9792; val_gene_expr_recon_loss: 2542516.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4857305.1667; val_optim_loss: 4857305.1667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7268; val_auprc_score: 0.8804; val_best_acc_score: 0.7388; val_best_f1_score: 0.8453; train_kl_reg_loss: 15353.7712; train_edge_recon_loss: 1478652.1000; train_cat_covariates_contrastive_loss: 669177.9250; train_gene_expr_recon_loss: 2481893.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4645077.3400; train_optim_loss: 4645077.3400; val_kl_reg_loss: 17304.9206; val_edge_recon_loss: 1765436.3750; val_cat_covariates_contrastive_loss: 640165.3958; val_gene_expr_recon_loss: 2585236.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5008143.0000; val_optim_loss: 5008143.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7884; val_auprc_score: 0.9234; val_best_acc_score: 0.7860; val_best_f1_score: 0.8752; train_kl_reg_loss: 15620.5436; train_edge_recon_loss: 1482992.8350; train_cat_covariates_contrastive_loss: 643974.5875; train_gene_expr_recon_loss: 2486194.1400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4628782.0600; train_optim_loss: 4628782.0600; val_kl_reg_loss: 15159.0088; val_edge_recon_loss: 1423544.4167; val_cat_covariates_contrastive_loss: 637782.5417; val_gene_expr_recon_loss: 2563243.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4639730.0000; val_optim_loss: 4639730.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7907; val_auprc_score: 0.9058; val_best_acc_score: 0.7700; val_best_f1_score: 0.8570; train_kl_reg_loss: 14912.6018; train_edge_recon_loss: 1415070.9200; train_cat_covariates_contrastive_loss: 683811.4250; train_gene_expr_recon_loss: 2469737.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4583532.7000; train_optim_loss: 4583532.7000; val_kl_reg_loss: 15139.2340; val_edge_recon_loss: 1634574.0417; val_cat_covariates_contrastive_loss: 643591.8958; val_gene_expr_recon_loss: 2539328.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4832634.1667; val_optim_loss: 4832634.1667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7533; val_auprc_score: 0.9026; val_best_acc_score: 0.7865; val_best_f1_score: 0.8724; train_kl_reg_loss: 15208.0263; train_edge_recon_loss: 1365203.7500; train_cat_covariates_contrastive_loss: 647789.9175; train_gene_expr_recon_loss: 2464968.9900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4493170.7400; train_optim_loss: 4493170.7400; val_kl_reg_loss: 14592.6064; val_edge_recon_loss: 1515444.8750; val_cat_covariates_contrastive_loss: 635284.9375; val_gene_expr_recon_loss: 2520839.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4686162.1667; val_optim_loss: 4686162.1667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7864; val_auprc_score: 0.9180; val_best_acc_score: 0.7826; val_best_f1_score: 0.8710; train_kl_reg_loss: 14624.4947; train_edge_recon_loss: 1402726.6800; train_cat_covariates_contrastive_loss: 642521.5375; train_gene_expr_recon_loss: 2454321.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4514194.3500; train_optim_loss: 4514194.3500; val_kl_reg_loss: 14012.8613; val_edge_recon_loss: 1513793.5417; val_cat_covariates_contrastive_loss: 643906.9583; val_gene_expr_recon_loss: 2528852.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4700566.0000; val_optim_loss: 4700566.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7781; val_auprc_score: 0.8995; val_best_acc_score: 0.7899; val_best_f1_score: 0.8678; train_kl_reg_loss: 13996.6962; train_edge_recon_loss: 1341297.2850; train_cat_covariates_contrastive_loss: 654347.6675; train_gene_expr_recon_loss: 2445710.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4455351.7100; train_optim_loss: 4455351.7100; val_kl_reg_loss: 14140.0781; val_edge_recon_loss: 1602267.2500; val_cat_covariates_contrastive_loss: 639105.8333; val_gene_expr_recon_loss: 2557535.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813049.0000; val_optim_loss: 4813049.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7822; val_auprc_score: 0.9034; val_best_acc_score: 0.7890; val_best_f1_score: 0.8737; train_kl_reg_loss: 14050.7211; train_edge_recon_loss: 1355467.6000; train_cat_covariates_contrastive_loss: 653939.0700; train_gene_expr_recon_loss: 2439594.1900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4463051.5400; train_optim_loss: 4463051.5400; val_kl_reg_loss: 13899.6481; val_edge_recon_loss: 1472528.3750; val_cat_covariates_contrastive_loss: 646863.4375; val_gene_expr_recon_loss: 2533428.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4666719.8333; val_optim_loss: 4666719.8333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7889; val_auprc_score: 0.9032; val_best_acc_score: 0.7935; val_best_f1_score: 0.8722; train_kl_reg_loss: 13998.1398; train_edge_recon_loss: 1418374.6150; train_cat_covariates_contrastive_loss: 646464.1950; train_gene_expr_recon_loss: 2441999.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4520836.4700; train_optim_loss: 4520836.4700; val_kl_reg_loss: 14018.5973; val_edge_recon_loss: 1580334.8750; val_cat_covariates_contrastive_loss: 653323.5000; val_gene_expr_recon_loss: 2536078.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4783755.1667; val_optim_loss: 4783755.1667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7853; val_auprc_score: 0.9020; val_best_acc_score: 0.7894; val_best_f1_score: 0.8706; train_kl_reg_loss: 13911.3498; train_edge_recon_loss: 1443224.3400; train_cat_covariates_contrastive_loss: 657787.1550; train_gene_expr_recon_loss: 2437760.5100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4552683.3600; train_optim_loss: 4552683.3600; val_kl_reg_loss: 13882.5309; val_edge_recon_loss: 1594004.9583; val_cat_covariates_contrastive_loss: 644269.0417; val_gene_expr_recon_loss: 2542530.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4794687.5000; val_optim_loss: 4794687.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7989; val_auprc_score: 0.9258; val_best_acc_score: 0.8011; val_best_f1_score: 0.8807; train_kl_reg_loss: 13870.8881; train_edge_recon_loss: 1386635.9700; train_cat_covariates_contrastive_loss: 651467.2600; train_gene_expr_recon_loss: 2435046.2300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4487020.3700; train_optim_loss: 4487020.3700; val_kl_reg_loss: 13722.7070; val_edge_recon_loss: 1426441.0000; val_cat_covariates_contrastive_loss: 641570.1667; val_gene_expr_recon_loss: 2554248.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4635982.0000; val_optim_loss: 4635982.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7941; val_auprc_score: 0.9040; val_best_acc_score: 0.8046; val_best_f1_score: 0.8813; train_kl_reg_loss: 13883.8709; train_edge_recon_loss: 1387507.2400; train_cat_covariates_contrastive_loss: 648048.0050; train_gene_expr_recon_loss: 2435627.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4485066.2900; train_optim_loss: 4485066.2900; val_kl_reg_loss: 13785.3636; val_edge_recon_loss: 1445186.5000; val_cat_covariates_contrastive_loss: 645322.3542; val_gene_expr_recon_loss: 2551446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4655740.1667; val_optim_loss: 4655740.1667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7965; val_auprc_score: 0.8981; val_best_acc_score: 0.7866; val_best_f1_score: 0.8678; train_kl_reg_loss: 13930.6056; train_edge_recon_loss: 1445052.6550; train_cat_covariates_contrastive_loss: 706238.2475; train_gene_expr_recon_loss: 2437620.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4602841.9000; train_optim_loss: 4602841.9000; val_kl_reg_loss: 13644.9906; val_edge_recon_loss: 1598341.2083; val_cat_covariates_contrastive_loss: 638445.7708; val_gene_expr_recon_loss: 2489140.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739572.6667; val_optim_loss: 4739572.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7647; val_auprc_score: 0.8868; val_best_acc_score: 0.7778; val_best_f1_score: 0.8643; train_kl_reg_loss: 13699.1186; train_edge_recon_loss: 1470212.3750; train_cat_covariates_contrastive_loss: 667940.2225; train_gene_expr_recon_loss: 2431491.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4583343.4200; train_optim_loss: 4583343.4200; val_kl_reg_loss: 13462.4854; val_edge_recon_loss: 1633036.2500; val_cat_covariates_contrastive_loss: 644277.8750; val_gene_expr_recon_loss: 2461896.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4752673.0000; val_optim_loss: 4752673.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8092; val_auprc_score: 0.9250; val_best_acc_score: 0.8168; val_best_f1_score: 0.8911; train_kl_reg_loss: 13497.3621; train_edge_recon_loss: 1454388.8200; train_cat_covariates_contrastive_loss: 643585.0425; train_gene_expr_recon_loss: 2432338.1900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4543809.3700; train_optim_loss: 4543809.3700; val_kl_reg_loss: 13258.8893; val_edge_recon_loss: 1386745.2500; val_cat_covariates_contrastive_loss: 643124.1667; val_gene_expr_recon_loss: 2505170.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4548298.1667; val_optim_loss: 4548298.1667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7740; val_auprc_score: 0.8917; val_best_acc_score: 0.7920; val_best_f1_score: 0.8735; train_kl_reg_loss: 13612.1093; train_edge_recon_loss: 1437096.6050; train_cat_covariates_contrastive_loss: 672523.3525; train_gene_expr_recon_loss: 2437876.0100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561108.0800; train_optim_loss: 4561108.0800; val_kl_reg_loss: 13784.6553; val_edge_recon_loss: 1591104.6250; val_cat_covariates_contrastive_loss: 649647.7500; val_gene_expr_recon_loss: 2493339.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747876.5000; val_optim_loss: 4747876.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8018; val_auprc_score: 0.9100; val_best_acc_score: 0.7993; val_best_f1_score: 0.8802; train_kl_reg_loss: 13602.6829; train_edge_recon_loss: 1363959.9900; train_cat_covariates_contrastive_loss: 641177.0050; train_gene_expr_recon_loss: 2431912.9900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4450652.6400; train_optim_loss: 4450652.6400; val_kl_reg_loss: 13191.5579; val_edge_recon_loss: 1481951.9583; val_cat_covariates_contrastive_loss: 640668.7708; val_gene_expr_recon_loss: 2506509.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4642321.5000; val_optim_loss: 4642321.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7819; val_auprc_score: 0.9113; val_best_acc_score: 0.7969; val_best_f1_score: 0.8769; train_kl_reg_loss: 13628.7468; train_edge_recon_loss: 1446272.5400; train_cat_covariates_contrastive_loss: 675468.1850; train_gene_expr_recon_loss: 2436475.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4571845.4200; train_optim_loss: 4571845.4200; val_kl_reg_loss: 13769.0915; val_edge_recon_loss: 1516865.4167; val_cat_covariates_contrastive_loss: 639927.3958; val_gene_expr_recon_loss: 2550496.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721058.6667; val_optim_loss: 4721058.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7953; val_auprc_score: 0.9118; val_best_acc_score: 0.8070; val_best_f1_score: 0.8827; train_kl_reg_loss: 13677.4750; train_edge_recon_loss: 1328605.8500; train_cat_covariates_contrastive_loss: 650579.9150; train_gene_expr_recon_loss: 2434564.9400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4427428.1600; train_optim_loss: 4427428.1600; val_kl_reg_loss: 13645.8320; val_edge_recon_loss: 1488106.0000; val_cat_covariates_contrastive_loss: 635055.0000; val_gene_expr_recon_loss: 2540015.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4676822.0000; val_optim_loss: 4676822.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7980; val_auprc_score: 0.9162; val_best_acc_score: 0.7946; val_best_f1_score: 0.8734; train_kl_reg_loss: 13545.6304; train_edge_recon_loss: 1457806.1550; train_cat_covariates_contrastive_loss: 641892.0075; train_gene_expr_recon_loss: 2433159.2200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4546403.0200; train_optim_loss: 4546403.0200; val_kl_reg_loss: 13232.5120; val_edge_recon_loss: 1581976.7500; val_cat_covariates_contrastive_loss: 645371.3542; val_gene_expr_recon_loss: 2460511.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4701091.8333; val_optim_loss: 4701091.8333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8194; val_auprc_score: 0.9291; val_best_acc_score: 0.8157; val_best_f1_score: 0.8883; train_kl_reg_loss: 13487.1900; train_edge_recon_loss: 1391209.3300; train_cat_covariates_contrastive_loss: 651870.5275; train_gene_expr_recon_loss: 2432433.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4489001.0000; train_optim_loss: 4489001.0000; val_kl_reg_loss: 13084.8490; val_edge_recon_loss: 1427566.7083; val_cat_covariates_contrastive_loss: 642262.8958; val_gene_expr_recon_loss: 2486728.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4569643.0000; val_optim_loss: 4569643.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7951; val_auprc_score: 0.9190; val_best_acc_score: 0.8007; val_best_f1_score: 0.8793; train_kl_reg_loss: 13585.7309; train_edge_recon_loss: 1384485.2750; train_cat_covariates_contrastive_loss: 639208.3825; train_gene_expr_recon_loss: 2434081.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471361.2200; train_optim_loss: 4471361.2200; val_kl_reg_loss: 13182.6367; val_edge_recon_loss: 1533372.9167; val_cat_covariates_contrastive_loss: 637683.5208; val_gene_expr_recon_loss: 2533811.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4718050.6667; val_optim_loss: 4718050.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7846; val_auprc_score: 0.9038; val_best_acc_score: 0.7915; val_best_f1_score: 0.8705; train_kl_reg_loss: 13493.3728; train_edge_recon_loss: 1394794.6100; train_cat_covariates_contrastive_loss: 677632.5300; train_gene_expr_recon_loss: 2441335.5600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4527256.0200; train_optim_loss: 4527256.0200; val_kl_reg_loss: 13147.8792; val_edge_recon_loss: 1562033.5417; val_cat_covariates_contrastive_loss: 644426.1458; val_gene_expr_recon_loss: 2450335.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4669943.3333; val_optim_loss: 4669943.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 20 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.7985
val AUPRC score: 0.9101
val best accuracy score: 0.7952
val best F1 score: 0.8741
val target rna MSE score: 0.7267
val source rna MSE score: 0.1637
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: 0.0002
Duration of model training in run 1: 0 hours, 2 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
