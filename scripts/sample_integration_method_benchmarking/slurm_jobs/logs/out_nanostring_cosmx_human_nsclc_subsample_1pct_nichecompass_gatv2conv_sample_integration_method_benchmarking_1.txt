Run timestamp: 25082023_132830_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7673; val_auprc_score: 0.9037; val_best_acc_score: 0.7957; val_best_f1_score: 0.8773; train_kl_reg_loss: 17973.9405; train_edge_recon_loss: 1720223.7024; train_gene_expr_recon_loss: 3235050.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4973248.0082; train_optim_loss: 4973248.0082; val_kl_reg_loss: 38002.3991; val_edge_recon_loss: 1739130.7727; val_gene_expr_recon_loss: 2828277.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4605410.3182; val_optim_loss: 4605410.3182
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7859; val_auprc_score: 0.9072; val_best_acc_score: 0.8007; val_best_f1_score: 0.8790; train_kl_reg_loss: 36697.4920; train_edge_recon_loss: 1629866.5340; train_gene_expr_recon_loss: 2734999.6712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4401563.6739; train_optim_loss: 4401563.6739; val_kl_reg_loss: 40138.9766; val_edge_recon_loss: 1633577.1591; val_gene_expr_recon_loss: 2684036.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4357752.9545; val_optim_loss: 4357752.9545
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8022; val_auprc_score: 0.9208; val_best_acc_score: 0.8162; val_best_f1_score: 0.8889; train_kl_reg_loss: 35937.8903; train_edge_recon_loss: 1555905.0679; train_gene_expr_recon_loss: 2650044.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4241886.9674; train_optim_loss: 4241886.9674; val_kl_reg_loss: 33600.2377; val_edge_recon_loss: 1559106.2273; val_gene_expr_recon_loss: 2703951.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4296657.7045; val_optim_loss: 4296657.7045
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8318; val_auprc_score: 0.9256; val_best_acc_score: 0.8310; val_best_f1_score: 0.8953; train_kl_reg_loss: 32018.9353; train_edge_recon_loss: 1517998.8859; train_gene_expr_recon_loss: 2597001.6141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4147019.4212; train_optim_loss: 4147019.4212; val_kl_reg_loss: 32594.8224; val_edge_recon_loss: 1559409.4091; val_gene_expr_recon_loss: 2608521.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4200525.9318; val_optim_loss: 4200525.9318
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8468; val_auprc_score: 0.9334; val_best_acc_score: 0.8586; val_best_f1_score: 0.9127; train_kl_reg_loss: 28746.4259; train_edge_recon_loss: 1461099.1291; train_gene_expr_recon_loss: 2558278.3614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4048123.9239; train_optim_loss: 4048123.9239; val_kl_reg_loss: 29305.4757; val_edge_recon_loss: 1419333.8068; val_gene_expr_recon_loss: 2587497.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4036136.5000; val_optim_loss: 4036136.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8396; val_auprc_score: 0.9221; val_best_acc_score: 0.8628; val_best_f1_score: 0.9136; train_kl_reg_loss: 28928.9986; train_edge_recon_loss: 1428590.4878; train_gene_expr_recon_loss: 2529669.4402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3987188.9185; train_optim_loss: 3987188.9185; val_kl_reg_loss: 30720.1829; val_edge_recon_loss: 1457427.9886; val_gene_expr_recon_loss: 2498648.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3986796.5682; val_optim_loss: 3986796.5682
Run timestamp: 25082023_133009_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7526; val_auprc_score: 0.8971; val_best_acc_score: 0.7917; val_best_f1_score: 0.8757; train_kl_reg_loss: 6880.8671; train_edge_recon_loss: 1688530.1467; train_gene_expr_recon_loss: 3019978.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4715389.1033; train_optim_loss: 4715389.1033; val_kl_reg_loss: 11662.7584; val_edge_recon_loss: 1682772.2500; val_gene_expr_recon_loss: 2737517.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4431953.0000; val_optim_loss: 4431953.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8747; val_auprc_score: 0.9429; val_best_acc_score: 0.8708; val_best_f1_score: 0.9184; train_kl_reg_loss: 27392.0187; train_edge_recon_loss: 1425122.4280; train_gene_expr_recon_loss: 2496540.1033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949054.5435; train_optim_loss: 3949054.5435; val_kl_reg_loss: 27618.8695; val_edge_recon_loss: 1469434.1705; val_gene_expr_recon_loss: 2523435.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4020488.0909; val_optim_loss: 4020488.0909
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8189; val_auprc_score: 0.9234; val_best_acc_score: 0.8096; val_best_f1_score: 0.8842; train_kl_reg_loss: 10806.5044; train_edge_recon_loss: 1554434.3505; train_gene_expr_recon_loss: 2649958.8152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4215199.6929; train_optim_loss: 4215199.6929; val_kl_reg_loss: 10669.9150; val_edge_recon_loss: 1619648.9773; val_gene_expr_recon_loss: 2546754.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4177073.7500; val_optim_loss: 4177073.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8926; val_auprc_score: 0.9446; val_best_acc_score: 0.8864; val_best_f1_score: 0.9267; train_kl_reg_loss: 25630.6848; train_edge_recon_loss: 1410403.2609; train_gene_expr_recon_loss: 2478760.8723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3914794.8152; train_optim_loss: 3914794.8152; val_kl_reg_loss: 25703.8384; val_edge_recon_loss: 1425996.0682; val_gene_expr_recon_loss: 2549681.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4001381.2727; val_optim_loss: 4001381.2727
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8449; val_auprc_score: 0.9313; val_best_acc_score: 0.8311; val_best_f1_score: 0.8922; train_kl_reg_loss: 10226.1653; train_edge_recon_loss: 1489573.8533; train_gene_expr_recon_loss: 2584821.2310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4084621.2391; train_optim_loss: 4084621.2391; val_kl_reg_loss: 10437.1514; val_edge_recon_loss: 1496568.5568; val_gene_expr_recon_loss: 2501579.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4008584.7727; val_optim_loss: 4008584.7727
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9003; val_auprc_score: 0.9556; val_best_acc_score: 0.8871; val_best_f1_score: 0.9285; train_kl_reg_loss: 24711.7462; train_edge_recon_loss: 1394165.6304; train_gene_expr_recon_loss: 2447220.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3866097.9783; train_optim_loss: 3866097.9783; val_kl_reg_loss: 24676.2072; val_edge_recon_loss: 1394543.0227; val_gene_expr_recon_loss: 2476045.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3895265.1591; val_optim_loss: 3895265.1591
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8914; val_auprc_score: 0.9479; val_best_acc_score: 0.8650; val_best_f1_score: 0.9140; train_kl_reg_loss: 9887.5729; train_edge_recon_loss: 1409122.3628; train_gene_expr_recon_loss: 2553822.7989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3972832.7337; train_optim_loss: 3972832.7337; val_kl_reg_loss: 9352.5331; val_edge_recon_loss: 1390080.2955; val_gene_expr_recon_loss: 2488154.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3887587.0682; val_optim_loss: 3887587.0682
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9237; val_auprc_score: 0.9647; val_best_acc_score: 0.9078; val_best_f1_score: 0.9410; train_kl_reg_loss: 21715.4808; train_edge_recon_loss: 1388155.4008; train_gene_expr_recon_loss: 2431306.8261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3841177.7147; train_optim_loss: 3841177.7147; val_kl_reg_loss: 21638.2724; val_edge_recon_loss: 1375203.8182; val_gene_expr_recon_loss: 2511236.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3908079.0227; val_optim_loss: 3908079.0227
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9198; val_auprc_score: 0.9631; val_best_acc_score: 0.8979; val_best_f1_score: 0.9347; train_kl_reg_loss: 9281.6341; train_edge_recon_loss: 1366136.5897; train_gene_expr_recon_loss: 2525060.9946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3900479.2092; train_optim_loss: 3900479.2092; val_kl_reg_loss: 8540.3343; val_edge_recon_loss: 1318675.3864; val_gene_expr_recon_loss: 2505905.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3833120.8864; val_optim_loss: 3833120.8864
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9277; val_auprc_score: 0.9602; val_best_acc_score: 0.9167; val_best_f1_score: 0.9455; train_kl_reg_loss: 21453.6084; train_edge_recon_loss: 1385230.4416; train_gene_expr_recon_loss: 2411263.0068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3817947.0679; train_optim_loss: 3817947.0679; val_kl_reg_loss: 21268.1316; val_edge_recon_loss: 1382292.3295; val_gene_expr_recon_loss: 2474010.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3877571.2727; val_optim_loss: 3877571.2727
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9400; val_auprc_score: 0.9744; val_best_acc_score: 0.9082; val_best_f1_score: 0.9402; train_kl_reg_loss: 8714.4798; train_edge_recon_loss: 1356190.4986; train_gene_expr_recon_loss: 2500005.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3864910.1739; train_optim_loss: 3864910.1739; val_kl_reg_loss: 8668.1231; val_edge_recon_loss: 1296337.2330; val_gene_expr_recon_loss: 2502433.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3807438.4773; val_optim_loss: 3807438.4773
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9321; val_auprc_score: 0.9611; val_best_acc_score: 0.9182; val_best_f1_score: 0.9471; train_kl_reg_loss: 19804.7146; train_edge_recon_loss: 1379288.0543; train_gene_expr_recon_loss: 2388629.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3787722.0435; train_optim_loss: 3787722.0435; val_kl_reg_loss: 18712.3613; val_edge_recon_loss: 1361977.5682; val_gene_expr_recon_loss: 2345115.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3725805.0000; val_optim_loss: 3725805.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9257; val_auprc_score: 0.9632; val_best_acc_score: 0.9066; val_best_f1_score: 0.9395; train_kl_reg_loss: 8739.0509; train_edge_recon_loss: 1339308.9837; train_gene_expr_recon_loss: 2480154.5326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3828202.5707; train_optim_loss: 3828202.5707; val_kl_reg_loss: 8246.2832; val_edge_recon_loss: 1348183.6932; val_gene_expr_recon_loss: 2471542.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3827972.2727; val_optim_loss: 3827972.2727
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9313; val_auprc_score: 0.9651; val_best_acc_score: 0.9133; val_best_f1_score: 0.9440; train_kl_reg_loss: 19525.8943; train_edge_recon_loss: 1365148.3125; train_gene_expr_recon_loss: 2367669.3913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3752343.6168; train_optim_loss: 3752343.6168; val_kl_reg_loss: 19430.2860; val_edge_recon_loss: 1402955.4318; val_gene_expr_recon_loss: 2372418.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3794803.7955; val_optim_loss: 3794803.7955
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9499; val_auprc_score: 0.9768; val_best_acc_score: 0.9282; val_best_f1_score: 0.9531; train_kl_reg_loss: 8691.7461; train_edge_recon_loss: 1354177.0870; train_gene_expr_recon_loss: 2463483.1277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3826351.9484; train_optim_loss: 3826351.9484; val_kl_reg_loss: 8947.7349; val_edge_recon_loss: 1350038.6818; val_gene_expr_recon_loss: 2402079.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3761065.5682; val_optim_loss: 3761065.5682
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9316; val_auprc_score: 0.9654; val_best_acc_score: 0.9183; val_best_f1_score: 0.9475; train_kl_reg_loss: 18770.9954; train_edge_recon_loss: 1371525.1155; train_gene_expr_recon_loss: 2343242.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3733538.2935; train_optim_loss: 3733538.2935; val_kl_reg_loss: 19301.5504; val_edge_recon_loss: 1341354.7500; val_gene_expr_recon_loss: 2420249.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3780905.9773; val_optim_loss: 3780905.9773
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9468; val_auprc_score: 0.9731; val_best_acc_score: 0.9258; val_best_f1_score: 0.9518; train_kl_reg_loss: 8558.3845; train_edge_recon_loss: 1319190.1067; train_gene_expr_recon_loss: 2449108.2147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3776856.6984; train_optim_loss: 3776856.6984; val_kl_reg_loss: 8281.1794; val_edge_recon_loss: 1365912.4659; val_gene_expr_recon_loss: 2376824.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3751018.2273; val_optim_loss: 3751018.2273
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9375; val_auprc_score: 0.9698; val_best_acc_score: 0.9238; val_best_f1_score: 0.9507; train_kl_reg_loss: 18647.1030; train_edge_recon_loss: 1352188.1658; train_gene_expr_recon_loss: 2322975.3804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3693810.6467; train_optim_loss: 3693810.6467; val_kl_reg_loss: 18156.5114; val_edge_recon_loss: 1374778.3182; val_gene_expr_recon_loss: 2386732.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3779667.1818; val_optim_loss: 3779667.1818
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9424; val_auprc_score: 0.9625; val_best_acc_score: 0.9328; val_best_f1_score: 0.9562; train_kl_reg_loss: 8467.4393; train_edge_recon_loss: 1329040.5190; train_gene_expr_recon_loss: 2426078.8451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3763586.7989; train_optim_loss: 3763586.7989; val_kl_reg_loss: 8350.9159; val_edge_recon_loss: 1346831.0568; val_gene_expr_recon_loss: 2370003.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3725185.7500; val_optim_loss: 3725185.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9415; val_auprc_score: 0.9718; val_best_acc_score: 0.9202; val_best_f1_score: 0.9488; train_kl_reg_loss: 18080.2186; train_edge_recon_loss: 1338958.5605; train_gene_expr_recon_loss: 2298796.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3655834.9620; train_optim_loss: 3655834.9620; val_kl_reg_loss: 17912.6435; val_edge_recon_loss: 1381595.5909; val_gene_expr_recon_loss: 2336557.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3736065.7045; val_optim_loss: 3736065.7045
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9620; val_auprc_score: 0.9794; val_best_acc_score: 0.9438; val_best_f1_score: 0.9638; train_kl_reg_loss: 8546.5255; train_edge_recon_loss: 1330195.0014; train_gene_expr_recon_loss: 2412073.3424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3750814.8913; train_optim_loss: 3750814.8913; val_kl_reg_loss: 8270.6698; val_edge_recon_loss: 1269840.5568; val_gene_expr_recon_loss: 2372308.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3650419.7500; val_optim_loss: 3650419.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9392; val_auprc_score: 0.9695; val_best_acc_score: 0.9255; val_best_f1_score: 0.9526; train_kl_reg_loss: 18007.4070; train_edge_recon_loss: 1355611.1739; train_gene_expr_recon_loss: 2279304.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3652923.4837; train_optim_loss: 3652923.4837; val_kl_reg_loss: 18188.0268; val_edge_recon_loss: 1288914.5909; val_gene_expr_recon_loss: 2297234.0795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3604336.6818; val_optim_loss: 3604336.6818
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9589; val_auprc_score: 0.9727; val_best_acc_score: 0.9386; val_best_f1_score: 0.9601; train_kl_reg_loss: 8526.5438; train_edge_recon_loss: 1322211.4837; train_gene_expr_recon_loss: 2397860.9429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3728598.9620; train_optim_loss: 3728598.9620; val_kl_reg_loss: 8389.0533; val_edge_recon_loss: 1333773.2614; val_gene_expr_recon_loss: 2345122.4773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3687284.8182; val_optim_loss: 3687284.8182
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9358; val_auprc_score: 0.9637; val_best_acc_score: 0.9223; val_best_f1_score: 0.9502; train_kl_reg_loss: 18361.6232; train_edge_recon_loss: 1339902.8424; train_gene_expr_recon_loss: 2271361.9280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3629626.3886; train_optim_loss: 3629626.3886; val_kl_reg_loss: 18183.2960; val_edge_recon_loss: 1344497.8523; val_gene_expr_recon_loss: 2303969.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3666650.4545; val_optim_loss: 3666650.4545
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9692; val_auprc_score: 0.9835; val_best_acc_score: 0.9506; val_best_f1_score: 0.9677; train_kl_reg_loss: 8591.4955; train_edge_recon_loss: 1325009.1291; train_gene_expr_recon_loss: 2379462.4810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3713063.1141; train_optim_loss: 3713063.1141; val_kl_reg_loss: 8348.8984; val_edge_recon_loss: 1283848.2386; val_gene_expr_recon_loss: 2361581.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3653779.1364; val_optim_loss: 3653779.1364
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9561; val_auprc_score: 0.9801; val_best_acc_score: 0.9354; val_best_f1_score: 0.9582; train_kl_reg_loss: 18275.9271; train_edge_recon_loss: 1355486.9416; train_gene_expr_recon_loss: 2272066.7880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3645829.6522; train_optim_loss: 3645829.6522; val_kl_reg_loss: 18145.3059; val_edge_recon_loss: 1323384.8636; val_gene_expr_recon_loss: 2322859.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3664389.1591; val_optim_loss: 3664389.1591
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9685; val_auprc_score: 0.9866; val_best_acc_score: 0.9442; val_best_f1_score: 0.9640; train_kl_reg_loss: 8451.8638; train_edge_recon_loss: 1340923.1617; train_gene_expr_recon_loss: 2366925.3614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3716300.4022; train_optim_loss: 3716300.4022; val_kl_reg_loss: 8234.4233; val_edge_recon_loss: 1264705.7500; val_gene_expr_recon_loss: 2352969.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3625910.0000; val_optim_loss: 3625910.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9463; val_auprc_score: 0.9738; val_best_acc_score: 0.9229; val_best_f1_score: 0.9501; train_kl_reg_loss: 18098.1770; train_edge_recon_loss: 1344352.0679; train_gene_expr_recon_loss: 2267093.4484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3629543.6821; train_optim_loss: 3629543.6821; val_kl_reg_loss: 17995.3251; val_edge_recon_loss: 1411148.8636; val_gene_expr_recon_loss: 2295379.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3724523.9773; val_optim_loss: 3724523.9773
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9690; val_auprc_score: 0.9811; val_best_acc_score: 0.9477; val_best_f1_score: 0.9658; train_kl_reg_loss: 8543.5205; train_edge_recon_loss: 1310985.3370; train_gene_expr_recon_loss: 2354558.7853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3674087.6277; train_optim_loss: 3674087.6277; val_kl_reg_loss: 8310.5758; val_edge_recon_loss: 1346904.6136; val_gene_expr_recon_loss: 2300781.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3655997.1818; val_optim_loss: 3655997.1818
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9408; val_auprc_score: 0.9717; val_best_acc_score: 0.9288; val_best_f1_score: 0.9545; train_kl_reg_loss: 18042.1393; train_edge_recon_loss: 1346442.0353; train_gene_expr_recon_loss: 2264961.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3629445.9538; train_optim_loss: 3629445.9538; val_kl_reg_loss: 17974.7033; val_edge_recon_loss: 1332641.0682; val_gene_expr_recon_loss: 2289660.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3640276.5909; val_optim_loss: 3640276.5909
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9708; val_auprc_score: 0.9834; val_best_acc_score: 0.9467; val_best_f1_score: 0.9653; train_kl_reg_loss: 8454.3708; train_edge_recon_loss: 1314707.2853; train_gene_expr_recon_loss: 2341390.5870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3664552.2527; train_optim_loss: 3664552.2527; val_kl_reg_loss: 8373.2393; val_edge_recon_loss: 1302077.4545; val_gene_expr_recon_loss: 2368428.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3678878.7273; val_optim_loss: 3678878.7273

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9385; val_auprc_score: 0.9665; val_best_acc_score: 0.9221; val_best_f1_score: 0.9502; train_kl_reg_loss: 18021.7891; train_edge_recon_loss: 1355105.1223; train_gene_expr_recon_loss: 2263410.8302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3636537.7391; train_optim_loss: 3636537.7391; val_kl_reg_loss: 18068.1665; val_edge_recon_loss: 1353742.0455; val_gene_expr_recon_loss: 2340649.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3712459.3636; val_optim_loss: 3712459.3636
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9679; val_auprc_score: 0.9856; val_best_acc_score: 0.9490; val_best_f1_score: 0.9671; train_kl_reg_loss: 8503.6620; train_edge_recon_loss: 1317958.8179; train_gene_expr_recon_loss: 2326993.8071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3653456.2880; train_optim_loss: 3653456.2880; val_kl_reg_loss: 8489.9865; val_edge_recon_loss: 1239899.1932; val_gene_expr_recon_loss: 2349356.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3597745.4545; val_optim_loss: 3597745.4545
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9454; val_auprc_score: 0.9736; val_best_acc_score: 0.9307; val_best_f1_score: 0.9553; train_kl_reg_loss: 18057.9189; train_edge_recon_loss: 1346007.0380; train_gene_expr_recon_loss: 2263915.0245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3627979.9918; train_optim_loss: 3627979.9918; val_kl_reg_loss: 17749.7834; val_edge_recon_loss: 1360893.2500; val_gene_expr_recon_loss: 2306174.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3684817.5682; val_optim_loss: 3684817.5682
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9727; val_auprc_score: 0.9855; val_best_acc_score: 0.9566; val_best_f1_score: 0.9713; train_kl_reg_loss: 8584.9120; train_edge_recon_loss: 1304867.7840; train_gene_expr_recon_loss: 2312566.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3626018.9158; train_optim_loss: 3626018.9158; val_kl_reg_loss: 8651.4935; val_edge_recon_loss: 1296199.2841; val_gene_expr_recon_loss: 2291439.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3596290.5682; val_optim_loss: 3596290.5682
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9437; val_auprc_score: 0.9728; val_best_acc_score: 0.9306; val_best_f1_score: 0.9554; train_kl_reg_loss: 18041.8197; train_edge_recon_loss: 1365947.5571; train_gene_expr_recon_loss: 2261539.6454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3645529.0272; train_optim_loss: 3645529.0272; val_kl_reg_loss: 18539.3727; val_edge_recon_loss: 1343257.4091; val_gene_expr_recon_loss: 2343890.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3705687.3409; val_optim_loss: 3705687.3409
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9655; val_auprc_score: 0.9813; val_best_acc_score: 0.9476; val_best_f1_score: 0.9659; train_kl_reg_loss: 8654.8156; train_edge_recon_loss: 1320549.8995; train_gene_expr_recon_loss: 2301727.3804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3630932.0897; train_optim_loss: 3630932.0897; val_kl_reg_loss: 8698.2365; val_edge_recon_loss: 1285593.3409; val_gene_expr_recon_loss: 2328240.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3622531.6364; val_optim_loss: 3622531.6364
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9458; val_auprc_score: 0.9710; val_best_acc_score: 0.9285; val_best_f1_score: 0.9541; train_kl_reg_loss: 18041.7126; train_edge_recon_loss: 1360537.8342; train_gene_expr_recon_loss: 2266165.7364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3644745.2880; train_optim_loss: 3644745.2880; val_kl_reg_loss: 18023.0066; val_edge_recon_loss: 1350613.3523; val_gene_expr_recon_loss: 2286315.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3654951.5227; val_optim_loss: 3654951.5227
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9660; val_auprc_score: 0.9828; val_best_acc_score: 0.9470; val_best_f1_score: 0.9647; train_kl_reg_loss: 8802.0426; train_edge_recon_loss: 1320947.7432; train_gene_expr_recon_loss: 2285232.7120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3614982.5082; train_optim_loss: 3614982.5082; val_kl_reg_loss: 8744.1138; val_edge_recon_loss: 1387440.0227; val_gene_expr_recon_loss: 2305865.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3702050.1136; val_optim_loss: 3702050.1136
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9661; val_auprc_score: 0.9803; val_best_acc_score: 0.9449; val_best_f1_score: 0.9641; train_kl_reg_loss: 8894.9395; train_edge_recon_loss: 1311742.8261; train_gene_expr_recon_loss: 2265749.2364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3586387.0163; train_optim_loss: 3586387.0163; val_kl_reg_loss: 8774.9492; val_edge_recon_loss: 1339374.7955; val_gene_expr_recon_loss: 2276707.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3624857.1818; val_optim_loss: 3624857.1818
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9714; val_auprc_score: 0.9802; val_best_acc_score: 0.9523; val_best_f1_score: 0.9684; train_kl_reg_loss: 9021.7547; train_edge_recon_loss: 1327931.1155; train_gene_expr_recon_loss: 2253099.0095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3590051.8832; train_optim_loss: 3590051.8832; val_kl_reg_loss: 8962.3309; val_edge_recon_loss: 1316885.1080; val_gene_expr_recon_loss: 2250318.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576165.5227; val_optim_loss: 3576165.5227

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 58 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9408
val AUPRC score: 0.9712
val best accuracy score: 0.9235
val best F1 score: 0.9506
val target rna MSE score: 0.6136
val source rna MSE score: 0.0661
Val cat covariate0 mean sim diff: -0.0014
Duration of model training in run 8: 0 hours, 7 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7553; val_auprc_score: 0.8943; val_best_acc_score: 0.7874; val_best_f1_score: 0.8723; train_kl_reg_loss: 14604.9377; train_edge_recon_loss: 1694907.8913; train_gene_expr_recon_loss: 3171324.0652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4880836.8750; train_optim_loss: 4880836.8750; val_kl_reg_loss: 34247.7436; val_edge_recon_loss: 1742805.3523; val_gene_expr_recon_loss: 2912497.0227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4689550.2273; val_optim_loss: 4689550.2273
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9687; val_auprc_score: 0.9787; val_best_acc_score: 0.9535; val_best_f1_score: 0.9694; train_kl_reg_loss: 9217.9805; train_edge_recon_loss: 1331144.8207; train_gene_expr_recon_loss: 2237602.3655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3577965.1658; train_optim_loss: 3577965.1658; val_kl_reg_loss: 9543.4191; val_edge_recon_loss: 1335338.2841; val_gene_expr_recon_loss: 2275775.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3620657.4318; val_optim_loss: 3620657.4318
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7946; val_auprc_score: 0.9154; val_best_acc_score: 0.8202; val_best_f1_score: 0.8904; train_kl_reg_loss: 29432.5131; train_edge_recon_loss: 1580604.7826; train_gene_expr_recon_loss: 2758653.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4368691.1875; train_optim_loss: 4368691.1875; val_kl_reg_loss: 31079.3214; val_edge_recon_loss: 1560122.9318; val_gene_expr_recon_loss: 2684727.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4275929.4091; val_optim_loss: 4275929.4091
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9712; val_auprc_score: 0.9836; val_best_acc_score: 0.9624; val_best_f1_score: 0.9754; train_kl_reg_loss: 9668.3123; train_edge_recon_loss: 1319522.2514; train_gene_expr_recon_loss: 2221687.4891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3550878.0625; train_optim_loss: 3550878.0625; val_kl_reg_loss: 9525.2196; val_edge_recon_loss: 1287878.1818; val_gene_expr_recon_loss: 2222332.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3519735.9091; val_optim_loss: 3519735.9091
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8168; val_auprc_score: 0.9268; val_best_acc_score: 0.8324; val_best_f1_score: 0.8984; train_kl_reg_loss: 32744.9352; train_edge_recon_loss: 1518447.4090; train_gene_expr_recon_loss: 2662844.3723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4214036.7310; train_optim_loss: 4214036.7310; val_kl_reg_loss: 30213.5330; val_edge_recon_loss: 1507337.4886; val_gene_expr_recon_loss: 2749615.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4287166.7500; val_optim_loss: 4287166.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9724; val_auprc_score: 0.9842; val_best_acc_score: 0.9508; val_best_f1_score: 0.9673; train_kl_reg_loss: 9807.6385; train_edge_recon_loss: 1314339.4946; train_gene_expr_recon_loss: 2200860.3764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3525007.5000; train_optim_loss: 3525007.5000; val_kl_reg_loss: 9842.0298; val_edge_recon_loss: 1364252.5114; val_gene_expr_recon_loss: 2250108.1477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3624202.7045; val_optim_loss: 3624202.7045
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8410; val_auprc_score: 0.9335; val_best_acc_score: 0.8404; val_best_f1_score: 0.9011; train_kl_reg_loss: 30765.3392; train_edge_recon_loss: 1505427.5897; train_gene_expr_recon_loss: 2610968.2989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4147161.2446; train_optim_loss: 4147161.2446; val_kl_reg_loss: 31039.5874; val_edge_recon_loss: 1508841.1136; val_gene_expr_recon_loss: 2566531.1705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4106411.8864; val_optim_loss: 4106411.8864
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8472; val_auprc_score: 0.9335; val_best_acc_score: 0.8669; val_best_f1_score: 0.9160; train_kl_reg_loss: 26581.1886; train_edge_recon_loss: 1466561.8967; train_gene_expr_recon_loss: 2569549.0109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4062692.1033; train_optim_loss: 4062692.1033; val_kl_reg_loss: 27813.6218; val_edge_recon_loss: 1456456.9205; val_gene_expr_recon_loss: 2596713.9773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4080984.5455; val_optim_loss: 4080984.5455
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9802; val_auprc_score: 0.9877; val_best_acc_score: 0.9603; val_best_f1_score: 0.9741; train_kl_reg_loss: 10104.3050; train_edge_recon_loss: 1301059.3295; train_gene_expr_recon_loss: 2179071.5476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3490235.1793; train_optim_loss: 3490235.1793; val_kl_reg_loss: 10504.4004; val_edge_recon_loss: 1255874.2841; val_gene_expr_recon_loss: 2230413.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3496792.1364; val_optim_loss: 3496792.1364
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8531; val_auprc_score: 0.9308; val_best_acc_score: 0.8676; val_best_f1_score: 0.9161; train_kl_reg_loss: 28219.2520; train_edge_recon_loss: 1443722.8872; train_gene_expr_recon_loss: 2542853.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4014795.8723; train_optim_loss: 4014795.8723; val_kl_reg_loss: 25780.1065; val_edge_recon_loss: 1510051.6023; val_gene_expr_recon_loss: 2525555.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4061387.5682; val_optim_loss: 4061387.5682
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8685; val_auprc_score: 0.9385; val_best_acc_score: 0.8745; val_best_f1_score: 0.9214; train_kl_reg_loss: 26140.0551; train_edge_recon_loss: 1435328.1073; train_gene_expr_recon_loss: 2507415.2853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3968883.4457; train_optim_loss: 3968883.4457; val_kl_reg_loss: 26710.8216; val_edge_recon_loss: 1431572.8523; val_gene_expr_recon_loss: 2566176.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4024460.0909; val_optim_loss: 4024460.0909
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9741; val_auprc_score: 0.9874; val_best_acc_score: 0.9538; val_best_f1_score: 0.9700; train_kl_reg_loss: 10544.1036; train_edge_recon_loss: 1313705.9633; train_gene_expr_recon_loss: 2157585.2704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3481835.3342; train_optim_loss: 3481835.3342; val_kl_reg_loss: 10182.0445; val_edge_recon_loss: 1290287.2443; val_gene_expr_recon_loss: 2198810.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3499279.9091; val_optim_loss: 3499279.9091
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8816; val_auprc_score: 0.9429; val_best_acc_score: 0.8768; val_best_f1_score: 0.9213; train_kl_reg_loss: 26041.8599; train_edge_recon_loss: 1404188.2242; train_gene_expr_recon_loss: 2486950.0516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3917180.1223; train_optim_loss: 3917180.1223; val_kl_reg_loss: 24260.0865; val_edge_recon_loss: 1484072.6250; val_gene_expr_recon_loss: 2487157.0682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3995489.7727; val_optim_loss: 3995489.7727
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9722; val_auprc_score: 0.9818; val_best_acc_score: 0.9584; val_best_f1_score: 0.9722; train_kl_reg_loss: 10994.3719; train_edge_recon_loss: 1324429.0652; train_gene_expr_recon_loss: 2136463.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3471887.2663; train_optim_loss: 3471887.2663; val_kl_reg_loss: 11050.2464; val_edge_recon_loss: 1340132.1932; val_gene_expr_recon_loss: 2165722.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3516905.0000; val_optim_loss: 3516905.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8933; val_auprc_score: 0.9467; val_best_acc_score: 0.8841; val_best_f1_score: 0.9254; train_kl_reg_loss: 23421.2598; train_edge_recon_loss: 1407959.8438; train_gene_expr_recon_loss: 2466192.8913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3897573.9973; train_optim_loss: 3897573.9973; val_kl_reg_loss: 22709.7404; val_edge_recon_loss: 1455468.7614; val_gene_expr_recon_loss: 2540880.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4019059.3182; val_optim_loss: 4019059.3182
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9178; val_auprc_score: 0.9645; val_best_acc_score: 0.9000; val_best_f1_score: 0.9361; train_kl_reg_loss: 22486.4371; train_edge_recon_loss: 1377944.5910; train_gene_expr_recon_loss: 2442064.3696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3842495.3995; train_optim_loss: 3842495.3995; val_kl_reg_loss: 22279.9812; val_edge_recon_loss: 1387625.5114; val_gene_expr_recon_loss: 2519389.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3929295.2045; val_optim_loss: 3929295.2045
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9737; val_auprc_score: 0.9866; val_best_acc_score: 0.9549; val_best_f1_score: 0.9705; train_kl_reg_loss: 11453.6640; train_edge_recon_loss: 1332220.7106; train_gene_expr_recon_loss: 2122102.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3465777.3179; train_optim_loss: 3465777.3179; val_kl_reg_loss: 11456.8685; val_edge_recon_loss: 1323642.1932; val_gene_expr_recon_loss: 2203847.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3538946.4773; val_optim_loss: 3538946.4773
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9250; val_auprc_score: 0.9655; val_best_acc_score: 0.9113; val_best_f1_score: 0.9432; train_kl_reg_loss: 20974.3779; train_edge_recon_loss: 1379244.7228; train_gene_expr_recon_loss: 2420503.5136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3820722.5978; train_optim_loss: 3820722.5978; val_kl_reg_loss: 19073.3251; val_edge_recon_loss: 1389879.1023; val_gene_expr_recon_loss: 2446721.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3855674.2273; val_optim_loss: 3855674.2273
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9251; val_auprc_score: 0.9647; val_best_acc_score: 0.9087; val_best_f1_score: 0.9407; train_kl_reg_loss: 18935.9338; train_edge_recon_loss: 1357590.5910; train_gene_expr_recon_loss: 2398626.7092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3775153.2255; train_optim_loss: 3775153.2255; val_kl_reg_loss: 18615.5526; val_edge_recon_loss: 1447706.4205; val_gene_expr_recon_loss: 2447979.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3914301.5455; val_optim_loss: 3914301.5455
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9667; val_auprc_score: 0.9773; val_best_acc_score: 0.9489; val_best_f1_score: 0.9664; train_kl_reg_loss: 11419.0426; train_edge_recon_loss: 1327410.0462; train_gene_expr_recon_loss: 2107374.4035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3446203.5054; train_optim_loss: 3446203.5054; val_kl_reg_loss: 11798.3704; val_edge_recon_loss: 1371601.8295; val_gene_expr_recon_loss: 2192894.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576294.5909; val_optim_loss: 3576294.5909
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9146; val_auprc_score: 0.9563; val_best_acc_score: 0.9096; val_best_f1_score: 0.9421; train_kl_reg_loss: 19328.8909; train_edge_recon_loss: 1374541.9029; train_gene_expr_recon_loss: 2369536.3342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3763407.1386; train_optim_loss: 3763407.1386; val_kl_reg_loss: 20079.2743; val_edge_recon_loss: 1355097.6364; val_gene_expr_recon_loss: 2400034.7273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3775211.6364; val_optim_loss: 3775211.6364

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9782; val_auprc_score: 0.9884; val_best_acc_score: 0.9612; val_best_f1_score: 0.9744; train_kl_reg_loss: 11980.5038; train_edge_recon_loss: 1321967.1019; train_gene_expr_recon_loss: 2069018.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3402965.8234; train_optim_loss: 3402965.8234; val_kl_reg_loss: 12013.2558; val_edge_recon_loss: 1332323.8523; val_gene_expr_recon_loss: 2126662.1477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3470999.2727; val_optim_loss: 3470999.2727
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9169; val_auprc_score: 0.9577; val_best_acc_score: 0.9125; val_best_f1_score: 0.9442; train_kl_reg_loss: 19661.5217; train_edge_recon_loss: 1360798.2758; train_gene_expr_recon_loss: 2347016.4579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3727476.2446; train_optim_loss: 3727476.2446; val_kl_reg_loss: 20430.0890; val_edge_recon_loss: 1401090.8864; val_gene_expr_recon_loss: 2454560.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3876081.5227; val_optim_loss: 3876081.5227
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9334; val_auprc_score: 0.9650; val_best_acc_score: 0.9253; val_best_f1_score: 0.9524; train_kl_reg_loss: 19466.6993; train_edge_recon_loss: 1350099.7758; train_gene_expr_recon_loss: 2325548.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3695115.0082; train_optim_loss: 3695115.0082; val_kl_reg_loss: 18421.5190; val_edge_recon_loss: 1343550.1705; val_gene_expr_recon_loss: 2335646.7159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3697618.4091; val_optim_loss: 3697618.4091
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9710; val_auprc_score: 0.9811; val_best_acc_score: 0.9575; val_best_f1_score: 0.9724; train_kl_reg_loss: 12222.8248; train_edge_recon_loss: 1319649.7731; train_gene_expr_recon_loss: 2055496.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3387368.8098; train_optim_loss: 3387368.8098; val_kl_reg_loss: 12149.5298; val_edge_recon_loss: 1294853.5227; val_gene_expr_recon_loss: 2214498.6705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3521501.7955; val_optim_loss: 3521501.7955
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9371; val_auprc_score: 0.9681; val_best_acc_score: 0.9206; val_best_f1_score: 0.9489; train_kl_reg_loss: 19040.9807; train_edge_recon_loss: 1360622.4905; train_gene_expr_recon_loss: 2302309.9484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3681973.4076; train_optim_loss: 3681973.4076; val_kl_reg_loss: 18728.2621; val_edge_recon_loss: 1370245.2273; val_gene_expr_recon_loss: 2406182.0227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3795155.5227; val_optim_loss: 3795155.5227
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9413; val_auprc_score: 0.9644; val_best_acc_score: 0.9294; val_best_f1_score: 0.9540; train_kl_reg_loss: 19217.8403; train_edge_recon_loss: 1343525.6046; train_gene_expr_recon_loss: 2277611.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3640355.3424; train_optim_loss: 3640355.3424; val_kl_reg_loss: 18702.5696; val_edge_recon_loss: 1372841.5227; val_gene_expr_recon_loss: 2364844.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3756388.3182; val_optim_loss: 3756388.3182
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9737; val_auprc_score: 0.9807; val_best_acc_score: 0.9563; val_best_f1_score: 0.9710; train_kl_reg_loss: 12368.4273; train_edge_recon_loss: 1325277.4402; train_gene_expr_recon_loss: 2052636.2133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3390282.0815; train_optim_loss: 3390282.0815; val_kl_reg_loss: 12089.3627; val_edge_recon_loss: 1357177.1932; val_gene_expr_recon_loss: 2167204.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3536471.0909; val_optim_loss: 3536471.0909
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9435; val_auprc_score: 0.9699; val_best_acc_score: 0.9260; val_best_f1_score: 0.9517; train_kl_reg_loss: 18714.1052; train_edge_recon_loss: 1360330.4592; train_gene_expr_recon_loss: 2261952.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3640997.1495; train_optim_loss: 3640997.1495; val_kl_reg_loss: 18673.7269; val_edge_recon_loss: 1399366.2727; val_gene_expr_recon_loss: 2317691.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3735731.1136; val_optim_loss: 3735731.1136
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9727; val_auprc_score: 0.9828; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 12422.0418; train_edge_recon_loss: 1327565.6128; train_gene_expr_recon_loss: 2047853.8057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3387841.4783; train_optim_loss: 3387841.4783; val_kl_reg_loss: 12117.4295; val_edge_recon_loss: 1301940.3295; val_gene_expr_recon_loss: 2129204.5455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3443262.3636; val_optim_loss: 3443262.3636
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9343; val_auprc_score: 0.9672; val_best_acc_score: 0.9268; val_best_f1_score: 0.9536; train_kl_reg_loss: 18434.8406; train_edge_recon_loss: 1327195.0027; train_gene_expr_recon_loss: 2234261.1182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3579890.9565; train_optim_loss: 3579890.9565; val_kl_reg_loss: 17124.0324; val_edge_recon_loss: 1289538.6477; val_gene_expr_recon_loss: 2246856.3864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3553519.0455; val_optim_loss: 3553519.0455
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9527; val_auprc_score: 0.9764; val_best_acc_score: 0.9301; val_best_f1_score: 0.9543; train_kl_reg_loss: 18498.8371; train_edge_recon_loss: 1370376.8356; train_gene_expr_recon_loss: 2213321.7976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3602197.4728; train_optim_loss: 3602197.4728; val_kl_reg_loss: 18391.5415; val_edge_recon_loss: 1407918.9659; val_gene_expr_recon_loss: 2333647.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759957.7273; val_optim_loss: 3759957.7273
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9763; val_auprc_score: 0.9799; val_best_acc_score: 0.9566; val_best_f1_score: 0.9716; train_kl_reg_loss: 12502.6696; train_edge_recon_loss: 1304193.1902; train_gene_expr_recon_loss: 2035563.5367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3352259.4022; train_optim_loss: 3352259.4022; val_kl_reg_loss: 12274.9053; val_edge_recon_loss: 1370192.5114; val_gene_expr_recon_loss: 2143262.0114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3525729.4091; val_optim_loss: 3525729.4091
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9508; val_auprc_score: 0.9710; val_best_acc_score: 0.9264; val_best_f1_score: 0.9527; train_kl_reg_loss: 18593.2647; train_edge_recon_loss: 1335679.8906; train_gene_expr_recon_loss: 2185454.2106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3539727.3750; train_optim_loss: 3539727.3750; val_kl_reg_loss: 17904.6784; val_edge_recon_loss: 1377597.7159; val_gene_expr_recon_loss: 2234635.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3630138.2955; val_optim_loss: 3630138.2955
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9547; val_auprc_score: 0.9758; val_best_acc_score: 0.9252; val_best_f1_score: 0.9509; train_kl_reg_loss: 18686.6518; train_edge_recon_loss: 1341381.4511; train_gene_expr_recon_loss: 2160740.8166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3520808.9158; train_optim_loss: 3520808.9158; val_kl_reg_loss: 18203.0419; val_edge_recon_loss: 1382398.7273; val_gene_expr_recon_loss: 2258279.4773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658881.2273; val_optim_loss: 3658881.2273
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9777; val_auprc_score: 0.9861; val_best_acc_score: 0.9639; val_best_f1_score: 0.9763; train_kl_reg_loss: 12678.6072; train_edge_recon_loss: 1308556.0000; train_gene_expr_recon_loss: 2038658.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359893.0136; train_optim_loss: 3359893.0136; val_kl_reg_loss: 12453.5349; val_edge_recon_loss: 1315317.7841; val_gene_expr_recon_loss: 2181206.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3508977.8636; val_optim_loss: 3508977.8636
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9494; val_auprc_score: 0.9708; val_best_acc_score: 0.9273; val_best_f1_score: 0.9523; train_kl_reg_loss: 18593.0535; train_edge_recon_loss: 1331216.6467; train_gene_expr_recon_loss: 2134227.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3484037.2826; train_optim_loss: 3484037.2826; val_kl_reg_loss: 18502.2759; val_edge_recon_loss: 1408005.0682; val_gene_expr_recon_loss: 2235350.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661857.6591; val_optim_loss: 3661857.6591
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9733; val_auprc_score: 0.9826; val_best_acc_score: 0.9575; val_best_f1_score: 0.9721; train_kl_reg_loss: 12729.1666; train_edge_recon_loss: 1284698.8709; train_gene_expr_recon_loss: 2034205.1359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3331633.1766; train_optim_loss: 3331633.1766; val_kl_reg_loss: 12434.3889; val_edge_recon_loss: 1347939.6477; val_gene_expr_recon_loss: 2179493.4205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3539867.5000; val_optim_loss: 3539867.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9512; val_auprc_score: 0.9735; val_best_acc_score: 0.9346; val_best_f1_score: 0.9574; train_kl_reg_loss: 18684.4907; train_edge_recon_loss: 1336309.2283; train_gene_expr_recon_loss: 2105613.2283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3460606.9565; train_optim_loss: 3460606.9565; val_kl_reg_loss: 19001.7003; val_edge_recon_loss: 1335527.6705; val_gene_expr_recon_loss: 2236657.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591186.5000; val_optim_loss: 3591186.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9512; val_auprc_score: 0.9785; val_best_acc_score: 0.9279; val_best_f1_score: 0.9536; train_kl_reg_loss: 18779.1926; train_edge_recon_loss: 1347419.4973; train_gene_expr_recon_loss: 2096431.4470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3462630.1413; train_optim_loss: 3462630.1413; val_kl_reg_loss: 18408.5901; val_edge_recon_loss: 1322291.9489; val_gene_expr_recon_loss: 2204665.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3545365.8409; val_optim_loss: 3545365.8409
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9713; val_auprc_score: 0.9817; val_best_acc_score: 0.9593; val_best_f1_score: 0.9734; train_kl_reg_loss: 12868.8588; train_edge_recon_loss: 1298401.8981; train_gene_expr_recon_loss: 2027800.8859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339071.6386; train_optim_loss: 3339071.6386; val_kl_reg_loss: 12482.7057; val_edge_recon_loss: 1327630.5568; val_gene_expr_recon_loss: 2187040.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3527153.3636; val_optim_loss: 3527153.3636
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9499; val_auprc_score: 0.9736; val_best_acc_score: 0.9273; val_best_f1_score: 0.9530; train_kl_reg_loss: 18722.0193; train_edge_recon_loss: 1342623.3954; train_gene_expr_recon_loss: 2091172.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3452518.3913; train_optim_loss: 3452518.3913; val_kl_reg_loss: 18464.1843; val_edge_recon_loss: 1348324.8409; val_gene_expr_recon_loss: 2212402.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3579191.4545; val_optim_loss: 3579191.4545

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9718; val_auprc_score: 0.9859; val_best_acc_score: 0.9589; val_best_f1_score: 0.9732; train_kl_reg_loss: 12830.4992; train_edge_recon_loss: 1320041.4959; train_gene_expr_recon_loss: 2025021.0163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3357893.0272; train_optim_loss: 3357893.0272; val_kl_reg_loss: 12551.6259; val_edge_recon_loss: 1312624.1477; val_gene_expr_recon_loss: 2215281.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3540457.1364; val_optim_loss: 3540457.1364
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9600; val_auprc_score: 0.9770; val_best_acc_score: 0.9345; val_best_f1_score: 0.9572; train_kl_reg_loss: 18646.9721; train_edge_recon_loss: 1329228.7745; train_gene_expr_recon_loss: 2084207.3641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3432083.1060; train_optim_loss: 3432083.1060; val_kl_reg_loss: 18139.1980; val_edge_recon_loss: 1374209.3636; val_gene_expr_recon_loss: 2218481.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3610829.9318; val_optim_loss: 3610829.9318
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9787; val_auprc_score: 0.9892; val_best_acc_score: 0.9651; val_best_f1_score: 0.9772; train_kl_reg_loss: 12867.3169; train_edge_recon_loss: 1305375.6141; train_gene_expr_recon_loss: 2025806.3247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344049.2554; train_optim_loss: 3344049.2554; val_kl_reg_loss: 12519.8638; val_edge_recon_loss: 1286512.8977; val_gene_expr_recon_loss: 2167966.8295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3466999.6136; val_optim_loss: 3466999.6136
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9546; val_auprc_score: 0.9792; val_best_acc_score: 0.9274; val_best_f1_score: 0.9530; train_kl_reg_loss: 18781.6070; train_edge_recon_loss: 1336079.0693; train_gene_expr_recon_loss: 2083238.9226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3438099.6033; train_optim_loss: 3438099.6033; val_kl_reg_loss: 18850.6365; val_edge_recon_loss: 1419142.5682; val_gene_expr_recon_loss: 2274625.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3712618.7045; val_optim_loss: 3712618.7045
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9789; val_auprc_score: 0.9886; val_best_acc_score: 0.9611; val_best_f1_score: 0.9745; train_kl_reg_loss: 12868.4030; train_edge_recon_loss: 1323360.8682; train_gene_expr_recon_loss: 2023348.7296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359578.0245; train_optim_loss: 3359578.0245; val_kl_reg_loss: 12629.3343; val_edge_recon_loss: 1310898.0114; val_gene_expr_recon_loss: 2136521.0227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3460048.3409; val_optim_loss: 3460048.3409
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9574; val_auprc_score: 0.9773; val_best_acc_score: 0.9378; val_best_f1_score: 0.9598; train_kl_reg_loss: 19004.7808; train_edge_recon_loss: 1353172.7337; train_gene_expr_recon_loss: 2079147.8410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3451325.3614; train_optim_loss: 3451325.3614; val_kl_reg_loss: 18551.9807; val_edge_recon_loss: 1323657.6818; val_gene_expr_recon_loss: 2189419.3523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3531629.0000; val_optim_loss: 3531629.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9781; val_auprc_score: 0.9848; val_best_acc_score: 0.9621; val_best_f1_score: 0.9751; train_kl_reg_loss: 12927.5081; train_edge_recon_loss: 1317562.1943; train_gene_expr_recon_loss: 2026458.1196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3356947.8397; train_optim_loss: 3356947.8397; val_kl_reg_loss: 12717.1259; val_edge_recon_loss: 1328658.6477; val_gene_expr_recon_loss: 2190059.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3531435.0000; val_optim_loss: 3531435.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9589; val_auprc_score: 0.9743; val_best_acc_score: 0.9405; val_best_f1_score: 0.9617; train_kl_reg_loss: 18889.8612; train_edge_recon_loss: 1347810.1264; train_gene_expr_recon_loss: 2072816.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3439516.8560; train_optim_loss: 3439516.8560; val_kl_reg_loss: 18336.0057; val_edge_recon_loss: 1316034.5114; val_gene_expr_recon_loss: 2217949.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3552320.3864; val_optim_loss: 3552320.3864
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9553; val_auprc_score: 0.9756; val_best_acc_score: 0.9373; val_best_f1_score: 0.9597; train_kl_reg_loss: 18871.8788; train_edge_recon_loss: 1325666.7480; train_gene_expr_recon_loss: 2073105.2976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3417643.9321; train_optim_loss: 3417643.9321; val_kl_reg_loss: 18744.2182; val_edge_recon_loss: 1339706.2500; val_gene_expr_recon_loss: 2203105.4886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3561555.9318; val_optim_loss: 3561555.9318

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 48 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9709
val AUPRC score: 0.9829
val best accuracy score: 0.9553
val best F1 score: 0.9710
val target rna MSE score: 0.5342
val source rna MSE score: 0.0498
Val cat covariate0 mean sim diff: -0.0038
Val cat covariate1 mean sim diff: -0.0038
Duration of model training in run 8: 0 hours, 15 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7882; val_auprc_score: 0.9140; val_best_acc_score: 0.8008; val_best_f1_score: 0.8809; train_kl_reg_loss: 6989.9144; train_edge_recon_loss: 1666980.1916; train_gene_expr_recon_loss: 3011291.6685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4685261.7717; train_optim_loss: 4685261.7717; val_kl_reg_loss: 12465.8833; val_edge_recon_loss: 1620916.2955; val_gene_expr_recon_loss: 2744319.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4377701.5227; val_optim_loss: 4377701.5227
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8209; val_auprc_score: 0.9179; val_best_acc_score: 0.8344; val_best_f1_score: 0.8982; train_kl_reg_loss: 11245.6582; train_edge_recon_loss: 1539534.7554; train_gene_expr_recon_loss: 2635011.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4185792.4293; train_optim_loss: 4185792.4293; val_kl_reg_loss: 9874.0618; val_edge_recon_loss: 1485951.3182; val_gene_expr_recon_loss: 2572598.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4068424.2500; val_optim_loss: 4068424.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9579; val_auprc_score: 0.9788; val_best_acc_score: 0.9388; val_best_f1_score: 0.9608; train_kl_reg_loss: 18937.5034; train_edge_recon_loss: 1329419.5367; train_gene_expr_recon_loss: 2069538.8587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3417895.9022; train_optim_loss: 3417895.9022; val_kl_reg_loss: 18933.3817; val_edge_recon_loss: 1309376.9773; val_gene_expr_recon_loss: 2174257.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3502567.9091; val_optim_loss: 3502567.9091
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8521; val_auprc_score: 0.9366; val_best_acc_score: 0.8508; val_best_f1_score: 0.9069; train_kl_reg_loss: 9928.7743; train_edge_recon_loss: 1470350.1875; train_gene_expr_recon_loss: 2578518.8071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4058797.7663; train_optim_loss: 4058797.7663; val_kl_reg_loss: 10503.2241; val_edge_recon_loss: 1413672.8636; val_gene_expr_recon_loss: 2515253.4773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3939429.5682; val_optim_loss: 3939429.5682
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8985; val_auprc_score: 0.9539; val_best_acc_score: 0.9007; val_best_f1_score: 0.9374; train_kl_reg_loss: 9495.3601; train_edge_recon_loss: 1396284.9688; train_gene_expr_recon_loss: 2537847.3261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3943627.6522; train_optim_loss: 3943627.6522; val_kl_reg_loss: 10426.8058; val_edge_recon_loss: 1284659.2841; val_gene_expr_recon_loss: 2601420.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3896506.9318; val_optim_loss: 3896506.9318
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9621; val_auprc_score: 0.9775; val_best_acc_score: 0.9388; val_best_f1_score: 0.9600; train_kl_reg_loss: 19005.8472; train_edge_recon_loss: 1323574.4307; train_gene_expr_recon_loss: 2064264.8302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3406845.1087; train_optim_loss: 3406845.1087; val_kl_reg_loss: 18922.5730; val_edge_recon_loss: 1402981.7045; val_gene_expr_recon_loss: 2222889.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3644793.9545; val_optim_loss: 3644793.9545
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9110; val_auprc_score: 0.9557; val_best_acc_score: 0.8977; val_best_f1_score: 0.9351; train_kl_reg_loss: 9022.8119; train_edge_recon_loss: 1349270.9728; train_gene_expr_recon_loss: 2513450.0408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3871743.8397; train_optim_loss: 3871743.8397; val_kl_reg_loss: 9035.8374; val_edge_recon_loss: 1361796.9773; val_gene_expr_recon_loss: 2563525.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3934358.3182; val_optim_loss: 3934358.3182
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9587; val_auprc_score: 0.9804; val_best_acc_score: 0.9361; val_best_f1_score: 0.9589; train_kl_reg_loss: 18911.7542; train_edge_recon_loss: 1331119.8288; train_gene_expr_recon_loss: 2062459.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3412491.3533; train_optim_loss: 3412491.3533; val_kl_reg_loss: 18382.0506; val_edge_recon_loss: 1345590.0795; val_gene_expr_recon_loss: 2213337.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3577309.8864; val_optim_loss: 3577309.8864
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9117; val_auprc_score: 0.9546; val_best_acc_score: 0.9045; val_best_f1_score: 0.9389; train_kl_reg_loss: 9083.7585; train_edge_recon_loss: 1358474.1304; train_gene_expr_recon_loss: 2489523.2310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3857081.1304; train_optim_loss: 3857081.1304; val_kl_reg_loss: 9501.4669; val_edge_recon_loss: 1382581.2727; val_gene_expr_recon_loss: 2492899.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3884982.6591; val_optim_loss: 3884982.6591
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9268; val_auprc_score: 0.9567; val_best_acc_score: 0.9137; val_best_f1_score: 0.9442; train_kl_reg_loss: 8680.2960; train_edge_recon_loss: 1348177.9198; train_gene_expr_recon_loss: 2468436.2473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3825294.4511; train_optim_loss: 3825294.4511; val_kl_reg_loss: 9016.5222; val_edge_recon_loss: 1351123.7614; val_gene_expr_recon_loss: 2484276.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3844416.4091; val_optim_loss: 3844416.4091
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9601; val_auprc_score: 0.9804; val_best_acc_score: 0.9346; val_best_f1_score: 0.9581; train_kl_reg_loss: 18788.9274; train_edge_recon_loss: 1344222.5448; train_gene_expr_recon_loss: 2060785.6590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3423797.1359; train_optim_loss: 3423797.1359; val_kl_reg_loss: 18569.0655; val_edge_recon_loss: 1311005.6932; val_gene_expr_recon_loss: 2248446.9432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3578021.7045; val_optim_loss: 3578021.7045
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9312; val_auprc_score: 0.9640; val_best_acc_score: 0.9131; val_best_f1_score: 0.9442; train_kl_reg_loss: 8745.4954; train_edge_recon_loss: 1338317.5136; train_gene_expr_recon_loss: 2451052.2446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3798115.2391; train_optim_loss: 3798115.2391; val_kl_reg_loss: 8877.4577; val_edge_recon_loss: 1320205.1477; val_gene_expr_recon_loss: 2468893.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3797976.2500; val_optim_loss: 3797976.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9503; val_auprc_score: 0.9756; val_best_acc_score: 0.9249; val_best_f1_score: 0.9515; train_kl_reg_loss: 8636.8877; train_edge_recon_loss: 1347213.4552; train_gene_expr_recon_loss: 2434583.4783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3790433.8179; train_optim_loss: 3790433.8179; val_kl_reg_loss: 8458.2290; val_edge_recon_loss: 1301175.5568; val_gene_expr_recon_loss: 2476202.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3785836.7045; val_optim_loss: 3785836.7045
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9553; val_auprc_score: 0.9790; val_best_acc_score: 0.9378; val_best_f1_score: 0.9599; train_kl_reg_loss: 18684.0670; train_edge_recon_loss: 1340542.0938; train_gene_expr_recon_loss: 2055666.7242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3414892.8777; train_optim_loss: 3414892.8777; val_kl_reg_loss: 18495.7377; val_edge_recon_loss: 1335324.7955; val_gene_expr_recon_loss: 2230884.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3584704.7727; val_optim_loss: 3584704.7727
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9344; val_auprc_score: 0.9615; val_best_acc_score: 0.9150; val_best_f1_score: 0.9442; train_kl_reg_loss: 8643.3324; train_edge_recon_loss: 1341049.0829; train_gene_expr_recon_loss: 2414207.9402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3763900.3560; train_optim_loss: 3763900.3560; val_kl_reg_loss: 8490.3471; val_edge_recon_loss: 1387756.7841; val_gene_expr_recon_loss: 2405485.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3801732.1818; val_optim_loss: 3801732.1818

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9694; val_auprc_score: 0.9852; val_best_acc_score: 0.9425; val_best_f1_score: 0.9625; train_kl_reg_loss: 18733.3701; train_edge_recon_loss: 1329741.2092; train_gene_expr_recon_loss: 2050806.5367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3399281.1359; train_optim_loss: 3399281.1359; val_kl_reg_loss: 18689.2383; val_edge_recon_loss: 1325377.0341; val_gene_expr_recon_loss: 2228016.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572082.7955; val_optim_loss: 3572082.7955
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9510; val_auprc_score: 0.9742; val_best_acc_score: 0.9267; val_best_f1_score: 0.9522; train_kl_reg_loss: 8617.0836; train_edge_recon_loss: 1345781.6800; train_gene_expr_recon_loss: 2401005.4429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3755404.2065; train_optim_loss: 3755404.2065; val_kl_reg_loss: 8802.5495; val_edge_recon_loss: 1337209.6250; val_gene_expr_recon_loss: 2364848.7614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3710860.9318; val_optim_loss: 3710860.9318
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9607; val_auprc_score: 0.9820; val_best_acc_score: 0.9300; val_best_f1_score: 0.9543; train_kl_reg_loss: 8693.9720; train_edge_recon_loss: 1334805.7147; train_gene_expr_recon_loss: 2383148.4918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3726648.1739; train_optim_loss: 3726648.1739; val_kl_reg_loss: 8316.6823; val_edge_recon_loss: 1361562.6136; val_gene_expr_recon_loss: 2370463.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3740343.1591; val_optim_loss: 3740343.1591
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9575; val_auprc_score: 0.9792; val_best_acc_score: 0.9372; val_best_f1_score: 0.9594; train_kl_reg_loss: 18714.4050; train_edge_recon_loss: 1337880.1753; train_gene_expr_recon_loss: 2048411.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3405006.4891; train_optim_loss: 3405006.4891; val_kl_reg_loss: 18203.2268; val_edge_recon_loss: 1345520.3750; val_gene_expr_recon_loss: 2210675.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3574398.9318; val_optim_loss: 3574398.9318
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9546; val_auprc_score: 0.9774; val_best_acc_score: 0.9353; val_best_f1_score: 0.9582; train_kl_reg_loss: 8725.1710; train_edge_recon_loss: 1316306.6277; train_gene_expr_recon_loss: 2360793.6766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3685825.4783; train_optim_loss: 3685825.4783; val_kl_reg_loss: 8615.6082; val_edge_recon_loss: 1317670.4545; val_gene_expr_recon_loss: 2348876.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3675163.0000; val_optim_loss: 3675163.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9564; val_auprc_score: 0.9788; val_best_acc_score: 0.9367; val_best_f1_score: 0.9585; train_kl_reg_loss: 8789.8446; train_edge_recon_loss: 1326293.9524; train_gene_expr_recon_loss: 2347113.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3682197.2473; train_optim_loss: 3682197.2473; val_kl_reg_loss: 8905.9347; val_edge_recon_loss: 1382321.3864; val_gene_expr_recon_loss: 2387898.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3779125.7045; val_optim_loss: 3779125.7045
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9554; val_auprc_score: 0.9728; val_best_acc_score: 0.9359; val_best_f1_score: 0.9582; train_kl_reg_loss: 18702.8311; train_edge_recon_loss: 1335885.1984; train_gene_expr_recon_loss: 2052290.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3406878.9837; train_optim_loss: 3406878.9837; val_kl_reg_loss: 18460.2926; val_edge_recon_loss: 1353848.5511; val_gene_expr_recon_loss: 2210724.2386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3583033.0455; val_optim_loss: 3583033.0455
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9513; val_auprc_score: 0.9691; val_best_acc_score: 0.9342; val_best_f1_score: 0.9570; train_kl_reg_loss: 9017.9999; train_edge_recon_loss: 1325797.9878; train_gene_expr_recon_loss: 2326034.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3660850.8043; train_optim_loss: 3660850.8043; val_kl_reg_loss: 8713.0196; val_edge_recon_loss: 1320871.3977; val_gene_expr_recon_loss: 2328879.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3658463.7955; val_optim_loss: 3658463.7955
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9576; val_auprc_score: 0.9756; val_best_acc_score: 0.9395; val_best_f1_score: 0.9609; train_kl_reg_loss: 18648.1146; train_edge_recon_loss: 1350012.4973; train_gene_expr_recon_loss: 2050691.8995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3419352.5299; train_optim_loss: 3419352.5299; val_kl_reg_loss: 18564.6868; val_edge_recon_loss: 1338962.1818; val_gene_expr_recon_loss: 2257777.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3615304.4545; val_optim_loss: 3615304.4545
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9553; val_auprc_score: 0.9733; val_best_acc_score: 0.9359; val_best_f1_score: 0.9582; train_kl_reg_loss: 9142.5124; train_edge_recon_loss: 1317449.6318; train_gene_expr_recon_loss: 2307530.9022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3634123.0299; train_optim_loss: 3634123.0299; val_kl_reg_loss: 9112.9818; val_edge_recon_loss: 1369850.6136; val_gene_expr_recon_loss: 2312031.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3690995.0909; val_optim_loss: 3690995.0909
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9571; val_auprc_score: 0.9764; val_best_acc_score: 0.9381; val_best_f1_score: 0.9600; train_kl_reg_loss: 9418.0596; train_edge_recon_loss: 1340585.1182; train_gene_expr_recon_loss: 2289438.7092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3639441.8859; train_optim_loss: 3639441.8859; val_kl_reg_loss: 9652.5706; val_edge_recon_loss: 1338314.7273; val_gene_expr_recon_loss: 2309442.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657409.5455; val_optim_loss: 3657409.5455
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9559; val_auprc_score: 0.9740; val_best_acc_score: 0.9362; val_best_f1_score: 0.9585; train_kl_reg_loss: 9612.0469; train_edge_recon_loss: 1321679.7228; train_gene_expr_recon_loss: 2267557.1304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598848.8967; train_optim_loss: 3598848.8967; val_kl_reg_loss: 9791.1767; val_edge_recon_loss: 1357085.6136; val_gene_expr_recon_loss: 2302684.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3669561.6364; val_optim_loss: 3669561.6364

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 41 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9574
val AUPRC score: 0.9776
val best accuracy score: 0.9403
val best F1 score: 0.9613
val target rna MSE score: 0.6437
val source rna MSE score: 0.0603
Val cat covariate0 mean sim diff: 0.0032
Duration of model training in run 7: 0 hours, 13 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7895; val_auprc_score: 0.9178; val_best_acc_score: 0.8013; val_best_f1_score: 0.8813; train_kl_reg_loss: 9312.1547; train_edge_recon_loss: 1744256.5054; train_gene_expr_recon_loss: 3280437.4214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5034006.0500; train_optim_loss: 5034006.0500; val_kl_reg_loss: 34694.0364; val_edge_recon_loss: 1904833.0156; val_gene_expr_recon_loss: 2912792.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4852319.3125; val_optim_loss: 4852319.3125
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7520; val_auprc_score: 0.8982; val_best_acc_score: 0.7874; val_best_f1_score: 0.8730; train_kl_reg_loss: 27869.5477; train_edge_recon_loss: 1673268.2929; train_gene_expr_recon_loss: 2781480.0250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4482617.8714; train_optim_loss: 4482617.8714; val_kl_reg_loss: 33956.5923; val_edge_recon_loss: 1738958.7031; val_gene_expr_recon_loss: 2754292.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527207.5000; val_optim_loss: 4527207.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9531; val_auprc_score: 0.9759; val_best_acc_score: 0.9404; val_best_f1_score: 0.9608; train_kl_reg_loss: 9871.6722; train_edge_recon_loss: 1311904.4226; train_gene_expr_recon_loss: 2254396.8954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3576172.9891; train_optim_loss: 3576172.9891; val_kl_reg_loss: 9780.5295; val_edge_recon_loss: 1341965.7159; val_gene_expr_recon_loss: 2340028.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3691774.6364; val_optim_loss: 3691774.6364
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7891; val_auprc_score: 0.9196; val_best_acc_score: 0.8022; val_best_f1_score: 0.8826; train_kl_reg_loss: 28234.2083; train_edge_recon_loss: 1622212.6375; train_gene_expr_recon_loss: 2681344.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4331791.5357; train_optim_loss: 4331791.5357; val_kl_reg_loss: 29225.4712; val_edge_recon_loss: 1550343.4688; val_gene_expr_recon_loss: 2683093.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4262662.5938; val_optim_loss: 4262662.5938
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9628; val_auprc_score: 0.9777; val_best_acc_score: 0.9465; val_best_f1_score: 0.9649; train_kl_reg_loss: 10151.5260; train_edge_recon_loss: 1325515.0639; train_gene_expr_recon_loss: 2234029.7446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3569696.3342; train_optim_loss: 3569696.3342; val_kl_reg_loss: 10194.6658; val_edge_recon_loss: 1352215.3636; val_gene_expr_recon_loss: 2249379.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3611789.1364; val_optim_loss: 3611789.1364
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8147; val_auprc_score: 0.9194; val_best_acc_score: 0.8205; val_best_f1_score: 0.8877; train_kl_reg_loss: 28733.1462; train_edge_recon_loss: 1599178.7804; train_gene_expr_recon_loss: 2635446.1143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4263358.0393; train_optim_loss: 4263358.0393; val_kl_reg_loss: 28346.9150; val_edge_recon_loss: 1576829.4531; val_gene_expr_recon_loss: 2652735.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4257911.4375; val_optim_loss: 4257911.4375
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8235; val_auprc_score: 0.9223; val_best_acc_score: 0.8279; val_best_f1_score: 0.8941; train_kl_reg_loss: 29751.6681; train_edge_recon_loss: 1516510.4607; train_gene_expr_recon_loss: 2587276.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4133538.3071; train_optim_loss: 4133538.3071; val_kl_reg_loss: 27488.5525; val_edge_recon_loss: 1540426.7031; val_gene_expr_recon_loss: 2643349.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4211264.2812; val_optim_loss: 4211264.2812
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9688; val_auprc_score: 0.9846; val_best_acc_score: 0.9474; val_best_f1_score: 0.9656; train_kl_reg_loss: 10452.9371; train_edge_recon_loss: 1313433.6569; train_gene_expr_recon_loss: 2215564.2731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3539450.8804; train_optim_loss: 3539450.8804; val_kl_reg_loss: 10220.8754; val_edge_recon_loss: 1318660.6818; val_gene_expr_recon_loss: 2340360.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3669242.3864; val_optim_loss: 3669242.3864
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8118; val_auprc_score: 0.9209; val_best_acc_score: 0.8301; val_best_f1_score: 0.8970; train_kl_reg_loss: 26909.2452; train_edge_recon_loss: 1473414.0964; train_gene_expr_recon_loss: 2559760.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4060084.0357; train_optim_loss: 4060084.0357; val_kl_reg_loss: 25050.7678; val_edge_recon_loss: 1510072.2656; val_gene_expr_recon_loss: 2598341.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4133464.9688; val_optim_loss: 4133464.9688
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9680; val_auprc_score: 0.9822; val_best_acc_score: 0.9478; val_best_f1_score: 0.9659; train_kl_reg_loss: 10715.8719; train_edge_recon_loss: 1320967.7405; train_gene_expr_recon_loss: 2195230.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3526914.3505; train_optim_loss: 3526914.3505; val_kl_reg_loss: 10586.2800; val_edge_recon_loss: 1294766.8068; val_gene_expr_recon_loss: 2232691.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3538044.9091; val_optim_loss: 3538044.9091
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8691; val_auprc_score: 0.9447; val_best_acc_score: 0.8591; val_best_f1_score: 0.9117; train_kl_reg_loss: 25355.3342; train_edge_recon_loss: 1476720.0768; train_gene_expr_recon_loss: 2525371.7179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4027447.1179; train_optim_loss: 4027447.1179; val_kl_reg_loss: 24761.3528; val_edge_recon_loss: 1414283.5469; val_gene_expr_recon_loss: 2566961.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4006006.0312; val_optim_loss: 4006006.0312
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8730; val_auprc_score: 0.9420; val_best_acc_score: 0.8560; val_best_f1_score: 0.9080; train_kl_reg_loss: 26233.0392; train_edge_recon_loss: 1442416.8589; train_gene_expr_recon_loss: 2503989.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3972639.5429; train_optim_loss: 3972639.5429; val_kl_reg_loss: 24607.4189; val_edge_recon_loss: 1450276.5312; val_gene_expr_recon_loss: 2554087.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4028971.4688; val_optim_loss: 4028971.4688
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9691; val_auprc_score: 0.9840; val_best_acc_score: 0.9502; val_best_f1_score: 0.9674; train_kl_reg_loss: 11253.0410; train_edge_recon_loss: 1339545.7242; train_gene_expr_recon_loss: 2175911.0408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3526709.8179; train_optim_loss: 3526709.8179; val_kl_reg_loss: 11178.3007; val_edge_recon_loss: 1292550.7045; val_gene_expr_recon_loss: 2217794.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3521523.6591; val_optim_loss: 3521523.6591
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8706; val_auprc_score: 0.9423; val_best_acc_score: 0.8544; val_best_f1_score: 0.9090; train_kl_reg_loss: 24799.7390; train_edge_recon_loss: 1438928.8268; train_gene_expr_recon_loss: 2485930.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3949659.3750; train_optim_loss: 3949659.3750; val_kl_reg_loss: 24423.2319; val_edge_recon_loss: 1460101.8281; val_gene_expr_recon_loss: 2540475.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4025000.9688; val_optim_loss: 4025000.9688
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9675; val_auprc_score: 0.9825; val_best_acc_score: 0.9461; val_best_f1_score: 0.9647; train_kl_reg_loss: 11875.5512; train_edge_recon_loss: 1311197.9973; train_gene_expr_recon_loss: 2147701.2079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3470774.7554; train_optim_loss: 3470774.7554; val_kl_reg_loss: 11573.9995; val_edge_recon_loss: 1318716.9205; val_gene_expr_recon_loss: 2224562.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3554853.3182; val_optim_loss: 3554853.3182
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8799; val_auprc_score: 0.9465; val_best_acc_score: 0.8743; val_best_f1_score: 0.9211; train_kl_reg_loss: 24064.0297; train_edge_recon_loss: 1423793.3768; train_gene_expr_recon_loss: 2473050.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3920907.9071; train_optim_loss: 3920907.9071; val_kl_reg_loss: 23206.4136; val_edge_recon_loss: 1391256.9688; val_gene_expr_recon_loss: 2539317.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3953781.2812; val_optim_loss: 3953781.2812
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9682; val_auprc_score: 0.9792; val_best_acc_score: 0.9471; val_best_f1_score: 0.9655; train_kl_reg_loss: 12124.6146; train_edge_recon_loss: 1329072.7133; train_gene_expr_recon_loss: 2129256.5842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3470453.9212; train_optim_loss: 3470453.9212; val_kl_reg_loss: 12202.4556; val_edge_recon_loss: 1380630.5909; val_gene_expr_recon_loss: 2174988.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3567821.4545; val_optim_loss: 3567821.4545
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8907; val_auprc_score: 0.9548; val_best_acc_score: 0.8717; val_best_f1_score: 0.9183; train_kl_reg_loss: 22883.7306; train_edge_recon_loss: 1415575.1696; train_gene_expr_recon_loss: 2446310.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3884769.0143; train_optim_loss: 3884769.0143; val_kl_reg_loss: 23123.2078; val_edge_recon_loss: 1455344.8438; val_gene_expr_recon_loss: 2512145.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3990613.0625; val_optim_loss: 3990613.0625
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9026; val_auprc_score: 0.9531; val_best_acc_score: 0.8884; val_best_f1_score: 0.9284; train_kl_reg_loss: 23156.5670; train_edge_recon_loss: 1392629.9054; train_gene_expr_recon_loss: 2432192.2429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3847978.7107; train_optim_loss: 3847978.7107; val_kl_reg_loss: 22207.3074; val_edge_recon_loss: 1423587.9688; val_gene_expr_recon_loss: 2497719.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3943514.6250; val_optim_loss: 3943514.6250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9253; val_auprc_score: 0.9676; val_best_acc_score: 0.8906; val_best_f1_score: 0.9309; train_kl_reg_loss: 22294.6607; train_edge_recon_loss: 1402989.0071; train_gene_expr_recon_loss: 2419644.1214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3844927.7643; train_optim_loss: 3844927.7643; val_kl_reg_loss: 21000.6274; val_edge_recon_loss: 1374904.2656; val_gene_expr_recon_loss: 2488787.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3884692.3125; val_optim_loss: 3884692.3125
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9661; val_auprc_score: 0.9837; val_best_acc_score: 0.9492; val_best_f1_score: 0.9673; train_kl_reg_loss: 12471.0048; train_edge_recon_loss: 1318567.9674; train_gene_expr_recon_loss: 2108966.4647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3440005.4293; train_optim_loss: 3440005.4293; val_kl_reg_loss: 13234.8333; val_edge_recon_loss: 1278956.4659; val_gene_expr_recon_loss: 2210429.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3502621.2273; val_optim_loss: 3502621.2273
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9204; val_auprc_score: 0.9616; val_best_acc_score: 0.8908; val_best_f1_score: 0.9297; train_kl_reg_loss: 21103.3475; train_edge_recon_loss: 1397580.6589; train_gene_expr_recon_loss: 2402232.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3820916.0036; train_optim_loss: 3820916.0036; val_kl_reg_loss: 19947.9863; val_edge_recon_loss: 1436089.1094; val_gene_expr_recon_loss: 2459007.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3915044.1562; val_optim_loss: 3915044.1562
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9198; val_auprc_score: 0.9613; val_best_acc_score: 0.9005; val_best_f1_score: 0.9362; train_kl_reg_loss: 20008.3311; train_edge_recon_loss: 1360928.5143; train_gene_expr_recon_loss: 2387590.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3768527.6000; train_optim_loss: 3768527.6000; val_kl_reg_loss: 20005.9355; val_edge_recon_loss: 1407795.8594; val_gene_expr_recon_loss: 2445024.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3872826.3125; val_optim_loss: 3872826.3125
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9748; val_auprc_score: 0.9852; val_best_acc_score: 0.9479; val_best_f1_score: 0.9656; train_kl_reg_loss: 13287.8210; train_edge_recon_loss: 1310419.0333; train_gene_expr_recon_loss: 2083716.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3407423.5815; train_optim_loss: 3407423.5815; val_kl_reg_loss: 12855.9521; val_edge_recon_loss: 1349872.3295; val_gene_expr_recon_loss: 2254640.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3617369.1136; val_optim_loss: 3617369.1136
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9294; val_auprc_score: 0.9678; val_best_acc_score: 0.9036; val_best_f1_score: 0.9375; train_kl_reg_loss: 20370.6336; train_edge_recon_loss: 1338300.6491; train_gene_expr_recon_loss: 2378000.9214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3736672.1929; train_optim_loss: 3736672.1929; val_kl_reg_loss: 19893.7097; val_edge_recon_loss: 1377722.0000; val_gene_expr_recon_loss: 2440775.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3838391.6250; val_optim_loss: 3838391.6250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9248; val_auprc_score: 0.9630; val_best_acc_score: 0.9108; val_best_f1_score: 0.9433; train_kl_reg_loss: 19250.2450; train_edge_recon_loss: 1362209.3964; train_gene_expr_recon_loss: 2364526.5071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3745986.1357; train_optim_loss: 3745986.1357; val_kl_reg_loss: 18768.4443; val_edge_recon_loss: 1314709.2188; val_gene_expr_recon_loss: 2426797.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3760275.6250; val_optim_loss: 3760275.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9367; val_auprc_score: 0.9683; val_best_acc_score: 0.9095; val_best_f1_score: 0.9417; train_kl_reg_loss: 19269.9557; train_edge_recon_loss: 1362092.3143; train_gene_expr_recon_loss: 2344711.8964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3726074.1571; train_optim_loss: 3726074.1571; val_kl_reg_loss: 18728.2075; val_edge_recon_loss: 1356927.4688; val_gene_expr_recon_loss: 2444657.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3820312.8750; val_optim_loss: 3820312.8750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9723; val_auprc_score: 0.9840; val_best_acc_score: 0.9517; val_best_f1_score: 0.9679; train_kl_reg_loss: 13549.9661; train_edge_recon_loss: 1319769.6467; train_gene_expr_recon_loss: 2064432.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3397752.4674; train_optim_loss: 3397752.4674; val_kl_reg_loss: 13169.6265; val_edge_recon_loss: 1322891.0341; val_gene_expr_recon_loss: 2140533.5227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3476594.1591; val_optim_loss: 3476594.1591
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9347; val_auprc_score: 0.9718; val_best_acc_score: 0.9031; val_best_f1_score: 0.9375; train_kl_reg_loss: 18429.4334; train_edge_recon_loss: 1371189.5125; train_gene_expr_recon_loss: 2334360.1321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3723979.0857; train_optim_loss: 3723979.0857; val_kl_reg_loss: 17798.3311; val_edge_recon_loss: 1381749.5312; val_gene_expr_recon_loss: 2412965.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3812513.4688; val_optim_loss: 3812513.4688
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9422; val_auprc_score: 0.9726; val_best_acc_score: 0.9234; val_best_f1_score: 0.9509; train_kl_reg_loss: 18513.0997; train_edge_recon_loss: 1346195.6464; train_gene_expr_recon_loss: 2317343.6321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3682052.3714; train_optim_loss: 3682052.3714; val_kl_reg_loss: 18297.5317; val_edge_recon_loss: 1294585.8125; val_gene_expr_recon_loss: 2394931.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3707814.6250; val_optim_loss: 3707814.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9664; val_auprc_score: 0.9772; val_best_acc_score: 0.9484; val_best_f1_score: 0.9657; train_kl_reg_loss: 13786.9853; train_edge_recon_loss: 1316959.0435; train_gene_expr_recon_loss: 2047356.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3378102.5788; train_optim_loss: 3378102.5788; val_kl_reg_loss: 13388.2683; val_edge_recon_loss: 1404650.7614; val_gene_expr_recon_loss: 2205857.9545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3623896.9545; val_optim_loss: 3623896.9545
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9405; val_auprc_score: 0.9714; val_best_acc_score: 0.9152; val_best_f1_score: 0.9449; train_kl_reg_loss: 17755.7210; train_edge_recon_loss: 1350773.7821; train_gene_expr_recon_loss: 2305781.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3674311.2929; train_optim_loss: 3674311.2929; val_kl_reg_loss: 17108.9353; val_edge_recon_loss: 1372620.9531; val_gene_expr_recon_loss: 2393158.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3782888.3438; val_optim_loss: 3782888.3438
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9456; val_auprc_score: 0.9711; val_best_acc_score: 0.9177; val_best_f1_score: 0.9467; train_kl_reg_loss: 17647.7402; train_edge_recon_loss: 1349491.7107; train_gene_expr_recon_loss: 2295531.9179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3662671.3643; train_optim_loss: 3662671.3643; val_kl_reg_loss: 17532.8191; val_edge_recon_loss: 1384179.1562; val_gene_expr_recon_loss: 2387135.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3788847.8438; val_optim_loss: 3788847.8438
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9428; val_auprc_score: 0.9693; val_best_acc_score: 0.9246; val_best_f1_score: 0.9512; train_kl_reg_loss: 17328.4838; train_edge_recon_loss: 1348037.2964; train_gene_expr_recon_loss: 2277105.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3642470.9036; train_optim_loss: 3642470.9036; val_kl_reg_loss: 17055.7429; val_edge_recon_loss: 1341619.4375; val_gene_expr_recon_loss: 2361268.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3719944.0938; val_optim_loss: 3719944.0938
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9737; val_auprc_score: 0.9883; val_best_acc_score: 0.9525; val_best_f1_score: 0.9692; train_kl_reg_loss: 14008.5232; train_edge_recon_loss: 1337002.7351; train_gene_expr_recon_loss: 2033021.4158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3384032.6630; train_optim_loss: 3384032.6630; val_kl_reg_loss: 13321.4288; val_edge_recon_loss: 1269028.7045; val_gene_expr_recon_loss: 2161118.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3443468.2955; val_optim_loss: 3443468.2955
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9504; val_auprc_score: 0.9773; val_best_acc_score: 0.9192; val_best_f1_score: 0.9474; train_kl_reg_loss: 17008.4694; train_edge_recon_loss: 1345777.4375; train_gene_expr_recon_loss: 2257951.6768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3620737.5643; train_optim_loss: 3620737.5643; val_kl_reg_loss: 16987.3656; val_edge_recon_loss: 1337513.3906; val_gene_expr_recon_loss: 2358746.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3713246.8438; val_optim_loss: 3713246.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9543; val_auprc_score: 0.9767; val_best_acc_score: 0.9270; val_best_f1_score: 0.9525; train_kl_reg_loss: 17046.2922; train_edge_recon_loss: 1331605.9804; train_gene_expr_recon_loss: 2231939.3518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3580591.6393; train_optim_loss: 3580591.6393; val_kl_reg_loss: 17154.0000; val_edge_recon_loss: 1355001.0625; val_gene_expr_recon_loss: 2337256.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3709411.9062; val_optim_loss: 3709411.9062
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9726; val_auprc_score: 0.9815; val_best_acc_score: 0.9550; val_best_f1_score: 0.9705; train_kl_reg_loss: 14387.6966; train_edge_recon_loss: 1312200.5666; train_gene_expr_recon_loss: 2007708.9293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3334297.1848; train_optim_loss: 3334297.1848; val_kl_reg_loss: 14712.3950; val_edge_recon_loss: 1311615.8295; val_gene_expr_recon_loss: 2173693.9886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3500022.2273; val_optim_loss: 3500022.2273
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9562; val_auprc_score: 0.9733; val_best_acc_score: 0.9244; val_best_f1_score: 0.9505; train_kl_reg_loss: 17418.5099; train_edge_recon_loss: 1354614.1607; train_gene_expr_recon_loss: 2229515.7768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3601548.4464; train_optim_loss: 3601548.4464; val_kl_reg_loss: 17433.1699; val_edge_recon_loss: 1362897.6875; val_gene_expr_recon_loss: 2351227.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3731557.8438; val_optim_loss: 3731557.8438
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9743; val_auprc_score: 0.9811; val_best_acc_score: 0.9520; val_best_f1_score: 0.9683; train_kl_reg_loss: 15230.7270; train_edge_recon_loss: 1293236.0428; train_gene_expr_recon_loss: 1981864.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3290330.9348; train_optim_loss: 3290330.9348; val_kl_reg_loss: 15146.9419; val_edge_recon_loss: 1340778.8864; val_gene_expr_recon_loss: 2183117.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3539043.2727; val_optim_loss: 3539043.2727
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9498; val_auprc_score: 0.9723; val_best_acc_score: 0.9163; val_best_f1_score: 0.9452; train_kl_reg_loss: 17385.8139; train_edge_recon_loss: 1326363.6821; train_gene_expr_recon_loss: 2229329.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3573079.4679; train_optim_loss: 3573079.4679; val_kl_reg_loss: 17257.5132; val_edge_recon_loss: 1445744.5156; val_gene_expr_recon_loss: 2337980.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3800982.7500; val_optim_loss: 3800982.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9529; val_auprc_score: 0.9794; val_best_acc_score: 0.9236; val_best_f1_score: 0.9505; train_kl_reg_loss: 17403.4509; train_edge_recon_loss: 1317997.9804; train_gene_expr_recon_loss: 2220548.0536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3555949.4893; train_optim_loss: 3555949.4893; val_kl_reg_loss: 17463.5562; val_edge_recon_loss: 1333151.6094; val_gene_expr_recon_loss: 2331052.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3681667.8125; val_optim_loss: 3681667.8125
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9692; val_auprc_score: 0.9843; val_best_acc_score: 0.9494; val_best_f1_score: 0.9667; train_kl_reg_loss: 15360.4664; train_edge_recon_loss: 1314981.2534; train_gene_expr_recon_loss: 1974342.1005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3304683.8288; train_optim_loss: 3304683.8288; val_kl_reg_loss: 15019.2627; val_edge_recon_loss: 1345491.4773; val_gene_expr_recon_loss: 2113693.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3474204.3182; val_optim_loss: 3474204.3182
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9494; val_auprc_score: 0.9734; val_best_acc_score: 0.9265; val_best_f1_score: 0.9529; train_kl_reg_loss: 17423.4739; train_edge_recon_loss: 1324167.0821; train_gene_expr_recon_loss: 2217937.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559527.7679; train_optim_loss: 3559527.7679; val_kl_reg_loss: 17409.6362; val_edge_recon_loss: 1301824.5312; val_gene_expr_recon_loss: 2330192.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3649426.9375; val_optim_loss: 3649426.9375
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9720; val_auprc_score: 0.9846; val_best_acc_score: 0.9539; val_best_f1_score: 0.9701; train_kl_reg_loss: 15351.3056; train_edge_recon_loss: 1337114.2174; train_gene_expr_recon_loss: 1961616.1916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3314081.7038; train_optim_loss: 3314081.7038; val_kl_reg_loss: 15202.4566; val_edge_recon_loss: 1321628.8523; val_gene_expr_recon_loss: 2154895.0455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3491726.3864; val_optim_loss: 3491726.3864
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9480; val_auprc_score: 0.9729; val_best_acc_score: 0.9293; val_best_f1_score: 0.9548; train_kl_reg_loss: 17615.4926; train_edge_recon_loss: 1320560.9045; train_gene_expr_recon_loss: 2216378.9821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3554555.3857; train_optim_loss: 3554555.3857; val_kl_reg_loss: 17671.1423; val_edge_recon_loss: 1298072.9688; val_gene_expr_recon_loss: 2331577.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3647322.0000; val_optim_loss: 3647322.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9435; val_auprc_score: 0.9720; val_best_acc_score: 0.9273; val_best_f1_score: 0.9534; train_kl_reg_loss: 17621.5754; train_edge_recon_loss: 1351220.6286; train_gene_expr_recon_loss: 2215742.6179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3584584.8393; train_optim_loss: 3584584.8393; val_kl_reg_loss: 17395.9619; val_edge_recon_loss: 1322991.7031; val_gene_expr_recon_loss: 2342053.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3682440.6562; val_optim_loss: 3682440.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9740; val_auprc_score: 0.9858; val_best_acc_score: 0.9556; val_best_f1_score: 0.9708; train_kl_reg_loss: 15375.0350; train_edge_recon_loss: 1326135.1019; train_gene_expr_recon_loss: 1933134.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274644.6033; train_optim_loss: 3274644.6033; val_kl_reg_loss: 15006.2576; val_edge_recon_loss: 1330603.3750; val_gene_expr_recon_loss: 2146201.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3491810.9773; val_optim_loss: 3491810.9773
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9548; val_auprc_score: 0.9761; val_best_acc_score: 0.9351; val_best_f1_score: 0.9587; train_kl_reg_loss: 17617.0995; train_edge_recon_loss: 1322083.4500; train_gene_expr_recon_loss: 2204959.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3544659.5571; train_optim_loss: 3544659.5571; val_kl_reg_loss: 17593.5842; val_edge_recon_loss: 1259067.0156; val_gene_expr_recon_loss: 2306452.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3583113.2812; val_optim_loss: 3583113.2812
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9754; val_auprc_score: 0.9861; val_best_acc_score: 0.9572; val_best_f1_score: 0.9720; train_kl_reg_loss: 15597.4820; train_edge_recon_loss: 1318462.8438; train_gene_expr_recon_loss: 1921646.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3255706.7527; train_optim_loss: 3255706.7527; val_kl_reg_loss: 15482.4888; val_edge_recon_loss: 1308788.1023; val_gene_expr_recon_loss: 2175346.5114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3499617.1136; val_optim_loss: 3499617.1136
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9481; val_auprc_score: 0.9741; val_best_acc_score: 0.9211; val_best_f1_score: 0.9480; train_kl_reg_loss: 17601.1512; train_edge_recon_loss: 1355475.6518; train_gene_expr_recon_loss: 2212264.4857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3585341.2893; train_optim_loss: 3585341.2893; val_kl_reg_loss: 17279.1138; val_edge_recon_loss: 1425253.5312; val_gene_expr_recon_loss: 2317065.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759598.0000; val_optim_loss: 3759598.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9735; val_auprc_score: 0.9818; val_best_acc_score: 0.9547; val_best_f1_score: 0.9704; train_kl_reg_loss: 15913.5304; train_edge_recon_loss: 1304647.0856; train_gene_expr_recon_loss: 1914457.1508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3235017.7690; train_optim_loss: 3235017.7690; val_kl_reg_loss: 15557.1454; val_edge_recon_loss: 1362851.1932; val_gene_expr_recon_loss: 2129909.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3508317.5000; val_optim_loss: 3508317.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9616; val_auprc_score: 0.9825; val_best_acc_score: 0.9336; val_best_f1_score: 0.9566; train_kl_reg_loss: 17591.0484; train_edge_recon_loss: 1352262.0018; train_gene_expr_recon_loss: 2207420.0446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3577273.1071; train_optim_loss: 3577273.1071; val_kl_reg_loss: 17661.4700; val_edge_recon_loss: 1354722.0781; val_gene_expr_recon_loss: 2351771.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3724155.0000; val_optim_loss: 3724155.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9490; val_auprc_score: 0.9717; val_best_acc_score: 0.9280; val_best_f1_score: 0.9535; train_kl_reg_loss: 17563.9549; train_edge_recon_loss: 1346137.6089; train_gene_expr_recon_loss: 2209967.5446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3573669.1000; train_optim_loss: 3573669.1000; val_kl_reg_loss: 17647.1289; val_edge_recon_loss: 1370411.0469; val_gene_expr_recon_loss: 2354672.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3742730.5000; val_optim_loss: 3742730.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9750; val_auprc_score: 0.9858; val_best_acc_score: 0.9601; val_best_f1_score: 0.9738; train_kl_reg_loss: 16143.1178; train_edge_recon_loss: 1326262.4416; train_gene_expr_recon_loss: 1912422.0095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3254827.5815; train_optim_loss: 3254827.5815; val_kl_reg_loss: 15714.3460; val_edge_recon_loss: 1305555.7273; val_gene_expr_recon_loss: 2096879.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3418149.5455; val_optim_loss: 3418149.5455
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9536; val_auprc_score: 0.9752; val_best_acc_score: 0.9291; val_best_f1_score: 0.9541; train_kl_reg_loss: 17549.0639; train_edge_recon_loss: 1353767.0321; train_gene_expr_recon_loss: 2198301.2321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3569617.3321; train_optim_loss: 3569617.3321; val_kl_reg_loss: 17588.2966; val_edge_recon_loss: 1337676.3125; val_gene_expr_recon_loss: 2300343.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3655608.3125; val_optim_loss: 3655608.3125
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9671; val_auprc_score: 0.9760; val_best_acc_score: 0.9530; val_best_f1_score: 0.9692; train_kl_reg_loss: 16166.5973; train_edge_recon_loss: 1313587.9973; train_gene_expr_recon_loss: 1904346.2622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234100.8804; train_optim_loss: 3234100.8804; val_kl_reg_loss: 15908.3075; val_edge_recon_loss: 1325319.8352; val_gene_expr_recon_loss: 2138531.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3479759.5909; val_optim_loss: 3479759.5909

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9631; val_auprc_score: 0.9835; val_best_acc_score: 0.9350; val_best_f1_score: 0.9579; train_kl_reg_loss: 17449.0567; train_edge_recon_loss: 1340622.9036; train_gene_expr_recon_loss: 2200089.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3558161.7607; train_optim_loss: 3558161.7607; val_kl_reg_loss: 17285.0190; val_edge_recon_loss: 1299774.4688; val_gene_expr_recon_loss: 2317320.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3634379.9375; val_optim_loss: 3634379.9375
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9600; val_auprc_score: 0.9788; val_best_acc_score: 0.9305; val_best_f1_score: 0.9547; train_kl_reg_loss: 17473.4811; train_edge_recon_loss: 1345834.5554; train_gene_expr_recon_loss: 2198899.9304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3562207.9643; train_optim_loss: 3562207.9643; val_kl_reg_loss: 17635.4189; val_edge_recon_loss: 1377721.0156; val_gene_expr_recon_loss: 2323678.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3719034.7500; val_optim_loss: 3719034.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9754; val_auprc_score: 0.9857; val_best_acc_score: 0.9614; val_best_f1_score: 0.9746; train_kl_reg_loss: 16256.4967; train_edge_recon_loss: 1309207.3125; train_gene_expr_recon_loss: 1900422.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3225886.2174; train_optim_loss: 3225886.2174; val_kl_reg_loss: 16088.3919; val_edge_recon_loss: 1342654.2045; val_gene_expr_recon_loss: 2088361.7614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3447104.3864; val_optim_loss: 3447104.3864
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9541; val_auprc_score: 0.9782; val_best_acc_score: 0.9322; val_best_f1_score: 0.9561; train_kl_reg_loss: 17480.0325; train_edge_recon_loss: 1336698.9518; train_gene_expr_recon_loss: 2199509.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3553688.1143; train_optim_loss: 3553688.1143; val_kl_reg_loss: 17545.8455; val_edge_recon_loss: 1358365.2656; val_gene_expr_recon_loss: 2312180.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3688092.0312; val_optim_loss: 3688092.0312
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9733; val_auprc_score: 0.9838; val_best_acc_score: 0.9569; val_best_f1_score: 0.9719; train_kl_reg_loss: 16338.6089; train_edge_recon_loss: 1304291.1196; train_gene_expr_recon_loss: 1899005.0217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3219634.7391; train_optim_loss: 3219634.7391; val_kl_reg_loss: 16106.7421; val_edge_recon_loss: 1298794.3182; val_gene_expr_recon_loss: 2118152.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3433053.2273; val_optim_loss: 3433053.2273
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9544; val_auprc_score: 0.9756; val_best_acc_score: 0.9313; val_best_f1_score: 0.9561; train_kl_reg_loss: 17536.2845; train_edge_recon_loss: 1314615.6982; train_gene_expr_recon_loss: 2203332.5429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3535484.5214; train_optim_loss: 3535484.5214; val_kl_reg_loss: 17435.7266; val_edge_recon_loss: 1314974.7656; val_gene_expr_recon_loss: 2328726.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661137.1250; val_optim_loss: 3661137.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9757; val_auprc_score: 0.9854; val_best_acc_score: 0.9556; val_best_f1_score: 0.9704; train_kl_reg_loss: 16495.7100; train_edge_recon_loss: 1291401.3954; train_gene_expr_recon_loss: 1892832.8859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3200729.9837; train_optim_loss: 3200729.9837; val_kl_reg_loss: 16328.1227; val_edge_recon_loss: 1386942.1591; val_gene_expr_recon_loss: 2161087.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3564357.4091; val_optim_loss: 3564357.4091

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 32 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9585
val AUPRC score: 0.9745
val best accuracy score: 0.9312
val best F1 score: 0.9557
val target rna MSE score: 0.6678
val source rna MSE score: 0.0688
Val cat covariate0 mean sim diff: 0.0057
Duration of model training in run 6: 0 hours, 9 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7280; val_auprc_score: 0.8793; val_best_acc_score: 0.7928; val_best_f1_score: 0.8778; train_kl_reg_loss: 14286.4292; train_edge_recon_loss: 1729084.0196; train_gene_expr_recon_loss: 3319091.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5062462.0857; train_optim_loss: 5062462.0857; val_kl_reg_loss: 31058.4114; val_edge_recon_loss: 1807571.2344; val_gene_expr_recon_loss: 3000353.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4838982.8750; val_optim_loss: 4838982.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9773; val_auprc_score: 0.9860; val_best_acc_score: 0.9552; val_best_f1_score: 0.9703; train_kl_reg_loss: 16530.0269; train_edge_recon_loss: 1320579.5245; train_gene_expr_recon_loss: 1888480.1304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3225589.6875; train_optim_loss: 3225589.6875; val_kl_reg_loss: 16205.5079; val_edge_recon_loss: 1389016.8864; val_gene_expr_recon_loss: 2065301.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3470524.1818; val_optim_loss: 3470524.1818
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7743; val_auprc_score: 0.9012; val_best_acc_score: 0.7904; val_best_f1_score: 0.8721; train_kl_reg_loss: 31983.7703; train_edge_recon_loss: 1625162.6804; train_gene_expr_recon_loss: 2802379.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4459526.2821; train_optim_loss: 4459526.2821; val_kl_reg_loss: 30468.9905; val_edge_recon_loss: 1702657.6875; val_gene_expr_recon_loss: 2809506.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4542633.6875; val_optim_loss: 4542633.6875
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7889; val_auprc_score: 0.9146; val_best_acc_score: 0.7993; val_best_f1_score: 0.8799; train_kl_reg_loss: 33300.2051; train_edge_recon_loss: 1583100.6839; train_gene_expr_recon_loss: 2700369.0786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4316769.9714; train_optim_loss: 4316769.9714; val_kl_reg_loss: 34483.2800; val_edge_recon_loss: 1630618.2656; val_gene_expr_recon_loss: 2709974.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4375076.5000; val_optim_loss: 4375076.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8027; val_auprc_score: 0.9140; val_best_acc_score: 0.8194; val_best_f1_score: 0.8888; train_kl_reg_loss: 30378.7843; train_edge_recon_loss: 1553722.7679; train_gene_expr_recon_loss: 2628677.7536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4212779.3036; train_optim_loss: 4212779.3036; val_kl_reg_loss: 29333.4802; val_edge_recon_loss: 1609974.7656; val_gene_expr_recon_loss: 2684039.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4323347.5000; val_optim_loss: 4323347.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9740; val_auprc_score: 0.9860; val_best_acc_score: 0.9540; val_best_f1_score: 0.9697; train_kl_reg_loss: 16525.1160; train_edge_recon_loss: 1322180.0598; train_gene_expr_recon_loss: 1893004.3709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231709.5462; train_optim_loss: 3231709.5462; val_kl_reg_loss: 16181.2069; val_edge_recon_loss: 1353791.3977; val_gene_expr_recon_loss: 2127661.6136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3497634.2045; val_optim_loss: 3497634.2045
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8200; val_auprc_score: 0.9229; val_best_acc_score: 0.8175; val_best_f1_score: 0.8891; train_kl_reg_loss: 28818.0052; train_edge_recon_loss: 1531076.7696; train_gene_expr_recon_loss: 2588855.7571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4148750.5321; train_optim_loss: 4148750.5321; val_kl_reg_loss: 28628.4946; val_edge_recon_loss: 1522581.6406; val_gene_expr_recon_loss: 2658879.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4210090.0312; val_optim_loss: 4210090.0312
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8355; val_auprc_score: 0.9326; val_best_acc_score: 0.8331; val_best_f1_score: 0.8961; train_kl_reg_loss: 28482.1984; train_edge_recon_loss: 1499162.2339; train_gene_expr_recon_loss: 2556721.6750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4084366.1036; train_optim_loss: 4084366.1036; val_kl_reg_loss: 27239.8953; val_edge_recon_loss: 1510209.4688; val_gene_expr_recon_loss: 2585966.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4123416.0625; val_optim_loss: 4123416.0625
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9771; val_auprc_score: 0.9862; val_best_acc_score: 0.9554; val_best_f1_score: 0.9707; train_kl_reg_loss: 16469.8928; train_edge_recon_loss: 1323992.7405; train_gene_expr_recon_loss: 1892930.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3233393.4973; train_optim_loss: 3233393.4973; val_kl_reg_loss: 16202.9243; val_edge_recon_loss: 1309255.2045; val_gene_expr_recon_loss: 2066110.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3391568.7727; val_optim_loss: 3391568.7727
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8541; val_auprc_score: 0.9360; val_best_acc_score: 0.8424; val_best_f1_score: 0.9002; train_kl_reg_loss: 28235.4391; train_edge_recon_loss: 1461713.4982; train_gene_expr_recon_loss: 2534349.7036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4024298.6214; train_optim_loss: 4024298.6214; val_kl_reg_loss: 30522.2434; val_edge_recon_loss: 1497776.9844; val_gene_expr_recon_loss: 2567972.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096272.0312; val_optim_loss: 4096272.0312
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8702; val_auprc_score: 0.9416; val_best_acc_score: 0.8615; val_best_f1_score: 0.9122; train_kl_reg_loss: 27561.6781; train_edge_recon_loss: 1461303.4875; train_gene_expr_recon_loss: 2508917.7464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3997782.8964; train_optim_loss: 3997782.8964; val_kl_reg_loss: 26062.0662; val_edge_recon_loss: 1434147.9688; val_gene_expr_recon_loss: 2565406.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4025617.0312; val_optim_loss: 4025617.0312
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8823; val_auprc_score: 0.9438; val_best_acc_score: 0.8683; val_best_f1_score: 0.9148; train_kl_reg_loss: 25171.1614; train_edge_recon_loss: 1430090.2286; train_gene_expr_recon_loss: 2487163.7393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3942425.1214; train_optim_loss: 3942425.1214; val_kl_reg_loss: 26394.4604; val_edge_recon_loss: 1417909.9688; val_gene_expr_recon_loss: 2557640.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4001944.8750; val_optim_loss: 4001944.8750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9674; val_auprc_score: 0.9825; val_best_acc_score: 0.9529; val_best_f1_score: 0.9690; train_kl_reg_loss: 16519.5974; train_edge_recon_loss: 1307574.1630; train_gene_expr_recon_loss: 1890222.8736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3214316.6386; train_optim_loss: 3214316.6386; val_kl_reg_loss: 15972.0708; val_edge_recon_loss: 1332130.1250; val_gene_expr_recon_loss: 2130171.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3478273.5455; val_optim_loss: 3478273.5455
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8922; val_auprc_score: 0.9546; val_best_acc_score: 0.8779; val_best_f1_score: 0.9218; train_kl_reg_loss: 25782.6124; train_edge_recon_loss: 1404292.8893; train_gene_expr_recon_loss: 2465209.4357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3895284.9464; train_optim_loss: 3895284.9464; val_kl_reg_loss: 24473.3154; val_edge_recon_loss: 1429796.1250; val_gene_expr_recon_loss: 2558143.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4012412.6562; val_optim_loss: 4012412.6562
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9200; val_auprc_score: 0.9642; val_best_acc_score: 0.8970; val_best_f1_score: 0.9336; train_kl_reg_loss: 24148.6859; train_edge_recon_loss: 1400346.5875; train_gene_expr_recon_loss: 2449798.3643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3874293.6393; train_optim_loss: 3874293.6393; val_kl_reg_loss: 23444.5950; val_edge_recon_loss: 1393230.8125; val_gene_expr_recon_loss: 2490647.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3907323.2500; val_optim_loss: 3907323.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9729; val_auprc_score: 0.9848; val_best_acc_score: 0.9533; val_best_f1_score: 0.9694; train_kl_reg_loss: 16490.8940; train_edge_recon_loss: 1308972.8234; train_gene_expr_recon_loss: 1890647.0897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3216110.7962; train_optim_loss: 3216110.7962; val_kl_reg_loss: 16353.3213; val_edge_recon_loss: 1301897.1364; val_gene_expr_recon_loss: 2126482.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3444732.5455; val_optim_loss: 3444732.5455
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9164; val_auprc_score: 0.9577; val_best_acc_score: 0.8877; val_best_f1_score: 0.9275; train_kl_reg_loss: 23233.8183; train_edge_recon_loss: 1394135.8464; train_gene_expr_recon_loss: 2423090.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3840460.5679; train_optim_loss: 3840460.5679; val_kl_reg_loss: 22859.5818; val_edge_recon_loss: 1481495.0469; val_gene_expr_recon_loss: 2511210.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4015564.9688; val_optim_loss: 4015564.9688
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9235; val_auprc_score: 0.9653; val_best_acc_score: 0.9000; val_best_f1_score: 0.9351; train_kl_reg_loss: 22092.1717; train_edge_recon_loss: 1390150.1161; train_gene_expr_recon_loss: 2423917.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3836160.1607; train_optim_loss: 3836160.1607; val_kl_reg_loss: 21627.1047; val_edge_recon_loss: 1410568.8438; val_gene_expr_recon_loss: 2476984.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3909180.3125; val_optim_loss: 3909180.3125
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9770; val_auprc_score: 0.9846; val_best_acc_score: 0.9578; val_best_f1_score: 0.9721; train_kl_reg_loss: 16464.2341; train_edge_recon_loss: 1311406.1821; train_gene_expr_recon_loss: 1888661.5149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3216531.9402; train_optim_loss: 3216531.9402; val_kl_reg_loss: 16150.3151; val_edge_recon_loss: 1314404.4659; val_gene_expr_recon_loss: 2074579.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3405134.2045; val_optim_loss: 3405134.2045
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9361; val_auprc_score: 0.9681; val_best_acc_score: 0.9127; val_best_f1_score: 0.9433; train_kl_reg_loss: 22199.5543; train_edge_recon_loss: 1381299.4929; train_gene_expr_recon_loss: 2401581.4464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3805080.4857; train_optim_loss: 3805080.4857; val_kl_reg_loss: 21741.3506; val_edge_recon_loss: 1361510.0156; val_gene_expr_recon_loss: 2467272.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3850523.4375; val_optim_loss: 3850523.4375
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9286; val_auprc_score: 0.9636; val_best_acc_score: 0.9096; val_best_f1_score: 0.9410; train_kl_reg_loss: 22167.6315; train_edge_recon_loss: 1392797.7286; train_gene_expr_recon_loss: 2378234.3464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3793199.7321; train_optim_loss: 3793199.7321; val_kl_reg_loss: 21439.9167; val_edge_recon_loss: 1420149.3125; val_gene_expr_recon_loss: 2454361.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3895950.5938; val_optim_loss: 3895950.5938
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9237; val_auprc_score: 0.9637; val_best_acc_score: 0.9101; val_best_f1_score: 0.9423; train_kl_reg_loss: 21416.9620; train_edge_recon_loss: 1353491.8268; train_gene_expr_recon_loss: 2370439.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3745347.8857; train_optim_loss: 3745347.8857; val_kl_reg_loss: 21426.7344; val_edge_recon_loss: 1343543.4844; val_gene_expr_recon_loss: 2454113.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3819083.1875; val_optim_loss: 3819083.1875
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9762; val_auprc_score: 0.9858; val_best_acc_score: 0.9573; val_best_f1_score: 0.9724; train_kl_reg_loss: 16470.8766; train_edge_recon_loss: 1322366.0720; train_gene_expr_recon_loss: 1885969.8274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224806.7663; train_optim_loss: 3224806.7663; val_kl_reg_loss: 16181.6705; val_edge_recon_loss: 1271547.3409; val_gene_expr_recon_loss: 2054887.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3342616.2045; val_optim_loss: 3342616.2045
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9354; val_auprc_score: 0.9683; val_best_acc_score: 0.9180; val_best_f1_score: 0.9473; train_kl_reg_loss: 20280.4741; train_edge_recon_loss: 1348942.8304; train_gene_expr_recon_loss: 2352893.1643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3722116.4429; train_optim_loss: 3722116.4429; val_kl_reg_loss: 19810.1052; val_edge_recon_loss: 1354857.4688; val_gene_expr_recon_loss: 2432911.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3807578.6250; val_optim_loss: 3807578.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9353; val_auprc_score: 0.9644; val_best_acc_score: 0.9191; val_best_f1_score: 0.9468; train_kl_reg_loss: 19712.7904; train_edge_recon_loss: 1372447.5946; train_gene_expr_recon_loss: 2336047.7893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3728208.1679; train_optim_loss: 3728208.1679; val_kl_reg_loss: 18595.3904; val_edge_recon_loss: 1415917.7031; val_gene_expr_recon_loss: 2426239.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3860753.0938; val_optim_loss: 3860753.0938
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9737; val_auprc_score: 0.9854; val_best_acc_score: 0.9539; val_best_f1_score: 0.9702; train_kl_reg_loss: 16533.5502; train_edge_recon_loss: 1316317.0014; train_gene_expr_recon_loss: 1890159.1291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223009.6766; train_optim_loss: 3223009.6766; val_kl_reg_loss: 16311.6238; val_edge_recon_loss: 1305133.6818; val_gene_expr_recon_loss: 2109079.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3430525.0682; val_optim_loss: 3430525.0682
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9418; val_auprc_score: 0.9732; val_best_acc_score: 0.9174; val_best_f1_score: 0.9464; train_kl_reg_loss: 18769.5892; train_edge_recon_loss: 1373290.3679; train_gene_expr_recon_loss: 2331525.0143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3723584.9821; train_optim_loss: 3723584.9821; val_kl_reg_loss: 18954.8826; val_edge_recon_loss: 1373488.7656; val_gene_expr_recon_loss: 2403416.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3795859.9375; val_optim_loss: 3795859.9375
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9492; val_auprc_score: 0.9724; val_best_acc_score: 0.9297; val_best_f1_score: 0.9536; train_kl_reg_loss: 18940.1882; train_edge_recon_loss: 1351337.3179; train_gene_expr_recon_loss: 2313478.8964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3683756.4214; train_optim_loss: 3683756.4214; val_kl_reg_loss: 18362.7244; val_edge_recon_loss: 1416859.2188; val_gene_expr_recon_loss: 2421318.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3856540.8750; val_optim_loss: 3856540.8750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9541; val_auprc_score: 0.9793; val_best_acc_score: 0.9290; val_best_f1_score: 0.9542; train_kl_reg_loss: 18486.8289; train_edge_recon_loss: 1357706.0250; train_gene_expr_recon_loss: 2296733.8839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3672926.7464; train_optim_loss: 3672926.7464; val_kl_reg_loss: 18136.5962; val_edge_recon_loss: 1344722.8281; val_gene_expr_recon_loss: 2401557.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3764416.7188; val_optim_loss: 3764416.7188
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9804; val_auprc_score: 0.9905; val_best_acc_score: 0.9601; val_best_f1_score: 0.9737; train_kl_reg_loss: 16506.4938; train_edge_recon_loss: 1318258.7989; train_gene_expr_recon_loss: 1887793.7908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222559.0734; train_optim_loss: 3222559.0734; val_kl_reg_loss: 16439.7051; val_edge_recon_loss: 1355582.6932; val_gene_expr_recon_loss: 2124967.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3496990.2727; val_optim_loss: 3496990.2727
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9500; val_auprc_score: 0.9779; val_best_acc_score: 0.9245; val_best_f1_score: 0.9512; train_kl_reg_loss: 17949.7992; train_edge_recon_loss: 1352686.3250; train_gene_expr_recon_loss: 2281710.2161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3652346.3500; train_optim_loss: 3652346.3500; val_kl_reg_loss: 18064.3799; val_edge_recon_loss: 1374438.2969; val_gene_expr_recon_loss: 2372825.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3765328.0938; val_optim_loss: 3765328.0938
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9441; val_auprc_score: 0.9702; val_best_acc_score: 0.9314; val_best_f1_score: 0.9553; train_kl_reg_loss: 17887.1884; train_edge_recon_loss: 1331583.4482; train_gene_expr_recon_loss: 2252951.7429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3602422.3679; train_optim_loss: 3602422.3679; val_kl_reg_loss: 18124.6489; val_edge_recon_loss: 1388164.2344; val_gene_expr_recon_loss: 2376798.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3783086.9375; val_optim_loss: 3783086.9375
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9750; val_auprc_score: 0.9876; val_best_acc_score: 0.9560; val_best_f1_score: 0.9710; train_kl_reg_loss: 16510.6369; train_edge_recon_loss: 1312438.1658; train_gene_expr_recon_loss: 1885016.0149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3213964.8179; train_optim_loss: 3213964.8179; val_kl_reg_loss: 16247.2857; val_edge_recon_loss: 1333423.0227; val_gene_expr_recon_loss: 2129857.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3479527.4773; val_optim_loss: 3479527.4773
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9466; val_auprc_score: 0.9723; val_best_acc_score: 0.9273; val_best_f1_score: 0.9532; train_kl_reg_loss: 18139.5355; train_edge_recon_loss: 1319244.7411; train_gene_expr_recon_loss: 2243035.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3580419.6321; train_optim_loss: 3580419.6321; val_kl_reg_loss: 17943.5278; val_edge_recon_loss: 1349794.0781; val_gene_expr_recon_loss: 2369508.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3737245.6562; val_optim_loss: 3737245.6562
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9591; val_auprc_score: 0.9794; val_best_acc_score: 0.9376; val_best_f1_score: 0.9593; train_kl_reg_loss: 18625.6282; train_edge_recon_loss: 1325943.8089; train_gene_expr_recon_loss: 2221834.2661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3566403.7000; train_optim_loss: 3566403.7000; val_kl_reg_loss: 17730.4116; val_edge_recon_loss: 1365541.2188; val_gene_expr_recon_loss: 2336574.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3719845.7812; val_optim_loss: 3719845.7812
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9762; val_auprc_score: 0.9851; val_best_acc_score: 0.9587; val_best_f1_score: 0.9728; train_kl_reg_loss: 16431.1876; train_edge_recon_loss: 1313616.6128; train_gene_expr_recon_loss: 1890170.6440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3220218.4538; train_optim_loss: 3220218.4538; val_kl_reg_loss: 16159.6934; val_edge_recon_loss: 1321613.5114; val_gene_expr_recon_loss: 2133453.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3471226.5000; val_optim_loss: 3471226.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9542; val_auprc_score: 0.9800; val_best_acc_score: 0.9322; val_best_f1_score: 0.9566; train_kl_reg_loss: 18309.8730; train_edge_recon_loss: 1341942.8018; train_gene_expr_recon_loss: 2207829.1339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3568081.8179; train_optim_loss: 3568081.8179; val_kl_reg_loss: 18263.2837; val_edge_recon_loss: 1334488.1250; val_gene_expr_recon_loss: 2335609.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3688360.8438; val_optim_loss: 3688360.8438
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9487; val_auprc_score: 0.9761; val_best_acc_score: 0.9312; val_best_f1_score: 0.9552; train_kl_reg_loss: 18650.3270; train_edge_recon_loss: 1331517.8464; train_gene_expr_recon_loss: 2187525.0839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3537693.2536; train_optim_loss: 3537693.2536; val_kl_reg_loss: 18170.1021; val_edge_recon_loss: 1380690.4062; val_gene_expr_recon_loss: 2306233.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3705093.7812; val_optim_loss: 3705093.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9785; val_auprc_score: 0.9871; val_best_acc_score: 0.9596; val_best_f1_score: 0.9738; train_kl_reg_loss: 16427.0913; train_edge_recon_loss: 1313967.6637; train_gene_expr_recon_loss: 1887256.6141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3217651.3696; train_optim_loss: 3217651.3696; val_kl_reg_loss: 16302.9279; val_edge_recon_loss: 1269650.0682; val_gene_expr_recon_loss: 2088490.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3374443.5455; val_optim_loss: 3374443.5455
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9562; val_auprc_score: 0.9808; val_best_acc_score: 0.9331; val_best_f1_score: 0.9574; train_kl_reg_loss: 18455.6943; train_edge_recon_loss: 1334282.5911; train_gene_expr_recon_loss: 2167357.8643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3520096.1643; train_optim_loss: 3520096.1643; val_kl_reg_loss: 18321.7712; val_edge_recon_loss: 1301873.9219; val_gene_expr_recon_loss: 2314516.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3634712.1250; val_optim_loss: 3634712.1250
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9773; val_auprc_score: 0.9871; val_best_acc_score: 0.9618; val_best_f1_score: 0.9752; train_kl_reg_loss: 16438.6108; train_edge_recon_loss: 1322622.4117; train_gene_expr_recon_loss: 1884918.5231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223979.5571; train_optim_loss: 3223979.5571; val_kl_reg_loss: 16351.9173; val_edge_recon_loss: 1263384.2159; val_gene_expr_recon_loss: 2134714.3523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3414450.5000; val_optim_loss: 3414450.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9601; val_auprc_score: 0.9791; val_best_acc_score: 0.9380; val_best_f1_score: 0.9599; train_kl_reg_loss: 18901.0391; train_edge_recon_loss: 1316100.7893; train_gene_expr_recon_loss: 2144522.1661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3479523.9964; train_optim_loss: 3479523.9964; val_kl_reg_loss: 18345.6611; val_edge_recon_loss: 1362004.7344; val_gene_expr_recon_loss: 2285156.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3665506.7812; val_optim_loss: 3665506.7812
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9809; val_auprc_score: 0.9908; val_best_acc_score: 0.9582; val_best_f1_score: 0.9726; train_kl_reg_loss: 16455.4826; train_edge_recon_loss: 1341823.2486; train_gene_expr_recon_loss: 1887722.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3246001.3641; train_optim_loss: 3246001.3641; val_kl_reg_loss: 16353.0530; val_edge_recon_loss: 1327677.1364; val_gene_expr_recon_loss: 2098128.8523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3442159.0682; val_optim_loss: 3442159.0682
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9515; val_auprc_score: 0.9733; val_best_acc_score: 0.9411; val_best_f1_score: 0.9615; train_kl_reg_loss: 18687.1414; train_edge_recon_loss: 1351123.6696; train_gene_expr_recon_loss: 2124693.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3494504.7036; train_optim_loss: 3494504.7036; val_kl_reg_loss: 18584.6982; val_edge_recon_loss: 1357774.1562; val_gene_expr_recon_loss: 2284588.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660947.8125; val_optim_loss: 3660947.8125
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9620; val_auprc_score: 0.9808; val_best_acc_score: 0.9424; val_best_f1_score: 0.9620; train_kl_reg_loss: 18981.8428; train_edge_recon_loss: 1340023.9393; train_gene_expr_recon_loss: 2106379.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3465385.0321; train_optim_loss: 3465385.0321; val_kl_reg_loss: 18619.6226; val_edge_recon_loss: 1349066.7188; val_gene_expr_recon_loss: 2283015.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3650702.1250; val_optim_loss: 3650702.1250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9735; val_auprc_score: 0.9843; val_best_acc_score: 0.9535; val_best_f1_score: 0.9695; train_kl_reg_loss: 16510.7511; train_edge_recon_loss: 1307020.8003; train_gene_expr_recon_loss: 1889185.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3212716.8043; train_optim_loss: 3212716.8043; val_kl_reg_loss: 16229.7103; val_edge_recon_loss: 1364576.2159; val_gene_expr_recon_loss: 2097116.1932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3477922.1364; val_optim_loss: 3477922.1364
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9709; val_auprc_score: 0.9851; val_best_acc_score: 0.9534; val_best_f1_score: 0.9693; train_kl_reg_loss: 19221.4396; train_edge_recon_loss: 1320031.2455; train_gene_expr_recon_loss: 2085646.6768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3424899.3679; train_optim_loss: 3424899.3679; val_kl_reg_loss: 18841.1519; val_edge_recon_loss: 1320963.0156; val_gene_expr_recon_loss: 2259037.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598841.9688; val_optim_loss: 3598841.9688
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9722; val_auprc_score: 0.9841; val_best_acc_score: 0.9513; val_best_f1_score: 0.9682; train_kl_reg_loss: 19594.7128; train_edge_recon_loss: 1329310.6679; train_gene_expr_recon_loss: 2058491.8286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3407397.1929; train_optim_loss: 3407397.1929; val_kl_reg_loss: 19362.9534; val_edge_recon_loss: 1306839.7031; val_gene_expr_recon_loss: 2252530.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3578732.8438; val_optim_loss: 3578732.8438

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 34 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9754
val AUPRC score: 0.9877
val best accuracy score: 0.9572
val best F1 score: 0.9717
val target rna MSE score: 1.1408
val source rna MSE score: 0.0413
Val cat covariate0 mean sim diff: -0.0020
Val cat covariate1 mean sim diff: -0.0020
Duration of model training in run 7: 0 hours, 21 minutes and 46 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7668; val_auprc_score: 0.9116; val_best_acc_score: 0.8048; val_best_f1_score: 0.8835; train_kl_reg_loss: 6074.4105; train_edge_recon_loss: 1703219.1589; train_gene_expr_recon_loss: 3112071.7964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821365.3571; train_optim_loss: 4821365.3571; val_kl_reg_loss: 15629.4321; val_edge_recon_loss: 1693801.6719; val_gene_expr_recon_loss: 2634429.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4343860.9688; val_optim_loss: 4343860.9688
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9707; val_auprc_score: 0.9858; val_best_acc_score: 0.9533; val_best_f1_score: 0.9691; train_kl_reg_loss: 20001.4257; train_edge_recon_loss: 1333282.6196; train_gene_expr_recon_loss: 2046041.3071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3399325.3643; train_optim_loss: 3399325.3643; val_kl_reg_loss: 19830.1047; val_edge_recon_loss: 1366250.9062; val_gene_expr_recon_loss: 2237807.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3623888.5625; val_optim_loss: 3623888.5625
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7678; val_auprc_score: 0.9061; val_best_acc_score: 0.7956; val_best_f1_score: 0.8774; train_kl_reg_loss: 11784.9102; train_edge_recon_loss: 1598528.2768; train_gene_expr_recon_loss: 2687767.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4298080.2071; train_optim_loss: 4298080.2071; val_kl_reg_loss: 9164.7945; val_edge_recon_loss: 1601654.5469; val_gene_expr_recon_loss: 2567084.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4177903.5000; val_optim_loss: 4177903.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7893; val_auprc_score: 0.9128; val_best_acc_score: 0.8040; val_best_f1_score: 0.8801; train_kl_reg_loss: 10803.2887; train_edge_recon_loss: 1535414.4982; train_gene_expr_recon_loss: 2614759.6893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4160977.4786; train_optim_loss: 4160977.4786; val_kl_reg_loss: 9063.5961; val_edge_recon_loss: 1550036.9219; val_gene_expr_recon_loss: 2553948.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4113049.2812; val_optim_loss: 4113049.2812
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9655; val_auprc_score: 0.9799; val_best_acc_score: 0.9464; val_best_f1_score: 0.9650; train_kl_reg_loss: 19613.2403; train_edge_recon_loss: 1357151.4589; train_gene_expr_recon_loss: 2032888.6232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3409653.2893; train_optim_loss: 3409653.2893; val_kl_reg_loss: 19000.7109; val_edge_recon_loss: 1342228.2656; val_gene_expr_recon_loss: 2233046.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3594275.7812; val_optim_loss: 3594275.7812
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8390; val_auprc_score: 0.9354; val_best_acc_score: 0.8411; val_best_f1_score: 0.9031; train_kl_reg_loss: 10309.6997; train_edge_recon_loss: 1440979.3875; train_gene_expr_recon_loss: 2575178.3464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4026467.4000; train_optim_loss: 4026467.4000; val_kl_reg_loss: 9632.8129; val_edge_recon_loss: 1374387.4688; val_gene_expr_recon_loss: 2519492.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3903513.1250; val_optim_loss: 3903513.1250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8733; val_auprc_score: 0.9455; val_best_acc_score: 0.8534; val_best_f1_score: 0.9083; train_kl_reg_loss: 9502.9185; train_edge_recon_loss: 1410255.5982; train_gene_expr_recon_loss: 2550592.0857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3970350.5857; train_optim_loss: 3970350.5857; val_kl_reg_loss: 8984.2271; val_edge_recon_loss: 1377933.5312; val_gene_expr_recon_loss: 2474519.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3861436.7812; val_optim_loss: 3861436.7812
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9710; val_auprc_score: 0.9867; val_best_acc_score: 0.9466; val_best_f1_score: 0.9649; train_kl_reg_loss: 19663.0696; train_edge_recon_loss: 1341178.0000; train_gene_expr_recon_loss: 2010199.9357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3371040.9929; train_optim_loss: 3371040.9929; val_kl_reg_loss: 20405.7275; val_edge_recon_loss: 1319658.6406; val_gene_expr_recon_loss: 2219268.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3559332.3750; val_optim_loss: 3559332.3750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8908; val_auprc_score: 0.9480; val_best_acc_score: 0.8753; val_best_f1_score: 0.9202; train_kl_reg_loss: 9173.1543; train_edge_recon_loss: 1366873.3696; train_gene_expr_recon_loss: 2526255.6071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3902302.1357; train_optim_loss: 3902302.1357; val_kl_reg_loss: 9194.6810; val_edge_recon_loss: 1402465.6875; val_gene_expr_recon_loss: 2458295.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3869955.5625; val_optim_loss: 3869955.5625
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9179; val_auprc_score: 0.9603; val_best_acc_score: 0.8905; val_best_f1_score: 0.9295; train_kl_reg_loss: 9162.2766; train_edge_recon_loss: 1369914.1214; train_gene_expr_recon_loss: 2507529.9857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3886606.3964; train_optim_loss: 3886606.3964; val_kl_reg_loss: 8454.9973; val_edge_recon_loss: 1379108.7812; val_gene_expr_recon_loss: 2460207.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3847771.1875; val_optim_loss: 3847771.1875
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9672; val_auprc_score: 0.9822; val_best_acc_score: 0.9494; val_best_f1_score: 0.9676; train_kl_reg_loss: 19979.7665; train_edge_recon_loss: 1338056.8661; train_gene_expr_recon_loss: 1992351.5339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3350388.1821; train_optim_loss: 3350388.1821; val_kl_reg_loss: 20093.0813; val_edge_recon_loss: 1255692.9688; val_gene_expr_recon_loss: 2222148.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3497934.1875; val_optim_loss: 3497934.1875
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9265; val_auprc_score: 0.9685; val_best_acc_score: 0.9047; val_best_f1_score: 0.9387; train_kl_reg_loss: 9000.1922; train_edge_recon_loss: 1319667.6429; train_gene_expr_recon_loss: 2490939.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819606.9321; train_optim_loss: 3819606.9321; val_kl_reg_loss: 8773.8397; val_edge_recon_loss: 1341924.9688; val_gene_expr_recon_loss: 2443939.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3794638.8125; val_optim_loss: 3794638.8125
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9729; val_auprc_score: 0.9865; val_best_acc_score: 0.9546; val_best_f1_score: 0.9703; train_kl_reg_loss: 20046.5198; train_edge_recon_loss: 1324648.5232; train_gene_expr_recon_loss: 1958636.8821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3303331.9321; train_optim_loss: 3303331.9321; val_kl_reg_loss: 19721.5647; val_edge_recon_loss: 1311393.9062; val_gene_expr_recon_loss: 2221130.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3552246.0938; val_optim_loss: 3552246.0938
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9279; val_auprc_score: 0.9633; val_best_acc_score: 0.9046; val_best_f1_score: 0.9376; train_kl_reg_loss: 8983.5853; train_edge_recon_loss: 1368942.3232; train_gene_expr_recon_loss: 2474458.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3852384.8143; train_optim_loss: 3852384.8143; val_kl_reg_loss: 8513.9799; val_edge_recon_loss: 1389006.0000; val_gene_expr_recon_loss: 2427745.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3825265.1875; val_optim_loss: 3825265.1875
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9308; val_auprc_score: 0.9656; val_best_acc_score: 0.9127; val_best_f1_score: 0.9436; train_kl_reg_loss: 8787.1408; train_edge_recon_loss: 1365035.3214; train_gene_expr_recon_loss: 2456008.0464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3829830.5000; train_optim_loss: 3829830.5000; val_kl_reg_loss: 8597.5796; val_edge_recon_loss: 1340339.3906; val_gene_expr_recon_loss: 2420090.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3769027.3438; val_optim_loss: 3769027.3438
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9650; val_auprc_score: 0.9767; val_best_acc_score: 0.9542; val_best_f1_score: 0.9702; train_kl_reg_loss: 19902.5459; train_edge_recon_loss: 1339440.6339; train_gene_expr_recon_loss: 1951353.8071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3310697.0071; train_optim_loss: 3310697.0071; val_kl_reg_loss: 20179.4883; val_edge_recon_loss: 1314432.6406; val_gene_expr_recon_loss: 2214521.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3549133.4688; val_optim_loss: 3549133.4688
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9327; val_auprc_score: 0.9672; val_best_acc_score: 0.9047; val_best_f1_score: 0.9387; train_kl_reg_loss: 8684.3562; train_edge_recon_loss: 1343860.6679; train_gene_expr_recon_loss: 2430715.3643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783260.3786; train_optim_loss: 3783260.3786; val_kl_reg_loss: 8794.2208; val_edge_recon_loss: 1375762.0469; val_gene_expr_recon_loss: 2379946.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3764502.3438; val_optim_loss: 3764502.3438
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9410; val_auprc_score: 0.9719; val_best_acc_score: 0.9258; val_best_f1_score: 0.9521; train_kl_reg_loss: 8665.7866; train_edge_recon_loss: 1341657.9321; train_gene_expr_recon_loss: 2421274.7929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3771598.4893; train_optim_loss: 3771598.4893; val_kl_reg_loss: 8540.7524; val_edge_recon_loss: 1291162.1406; val_gene_expr_recon_loss: 2379666.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3679369.0938; val_optim_loss: 3679369.0938
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9664; val_auprc_score: 0.9820; val_best_acc_score: 0.9470; val_best_f1_score: 0.9653; train_kl_reg_loss: 20148.9266; train_edge_recon_loss: 1327077.6634; train_gene_expr_recon_loss: 1943147.4857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3290374.0643; train_optim_loss: 3290374.0643; val_kl_reg_loss: 20505.2720; val_edge_recon_loss: 1348449.1250; val_gene_expr_recon_loss: 2201649.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3570603.9375; val_optim_loss: 3570603.9375
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9486; val_auprc_score: 0.9728; val_best_acc_score: 0.9224; val_best_f1_score: 0.9500; train_kl_reg_loss: 8512.2075; train_edge_recon_loss: 1341456.3232; train_gene_expr_recon_loss: 2407392.7714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3757361.3107; train_optim_loss: 3757361.3107; val_kl_reg_loss: 8335.0721; val_edge_recon_loss: 1329050.0156; val_gene_expr_recon_loss: 2357240.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3694625.1875; val_optim_loss: 3694625.1875
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9668; val_auprc_score: 0.9811; val_best_acc_score: 0.9502; val_best_f1_score: 0.9670; train_kl_reg_loss: 20313.9116; train_edge_recon_loss: 1321873.4696; train_gene_expr_recon_loss: 1933550.0821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3275737.4571; train_optim_loss: 3275737.4571; val_kl_reg_loss: 20455.9331; val_edge_recon_loss: 1373849.8906; val_gene_expr_recon_loss: 2203640.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3597946.0000; val_optim_loss: 3597946.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9442; val_auprc_score: 0.9694; val_best_acc_score: 0.9210; val_best_f1_score: 0.9481; train_kl_reg_loss: 8571.3145; train_edge_recon_loss: 1316650.9054; train_gene_expr_recon_loss: 2399577.5571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3724799.7679; train_optim_loss: 3724799.7679; val_kl_reg_loss: 8473.6338; val_edge_recon_loss: 1394523.0312; val_gene_expr_recon_loss: 2357569.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3760566.4688; val_optim_loss: 3760566.4688
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9527; val_auprc_score: 0.9711; val_best_acc_score: 0.9290; val_best_f1_score: 0.9538; train_kl_reg_loss: 8535.7902; train_edge_recon_loss: 1336250.4804; train_gene_expr_recon_loss: 2383017.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3727803.5929; train_optim_loss: 3727803.5929; val_kl_reg_loss: 8649.1255; val_edge_recon_loss: 1344427.0312; val_gene_expr_recon_loss: 2355612.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3708689.1250; val_optim_loss: 3708689.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9614; val_auprc_score: 0.9763; val_best_acc_score: 0.9459; val_best_f1_score: 0.9643; train_kl_reg_loss: 20545.9848; train_edge_recon_loss: 1331920.3946; train_gene_expr_recon_loss: 1911892.4929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3264358.8571; train_optim_loss: 3264358.8571; val_kl_reg_loss: 20418.2520; val_edge_recon_loss: 1346703.5000; val_gene_expr_recon_loss: 2178251.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3545372.9688; val_optim_loss: 3545372.9688
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9689; val_auprc_score: 0.9798; val_best_acc_score: 0.9474; val_best_f1_score: 0.9653; train_kl_reg_loss: 8698.9789; train_edge_recon_loss: 1323800.4679; train_gene_expr_recon_loss: 2376275.2571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3708774.7179; train_optim_loss: 3708774.7179; val_kl_reg_loss: 8561.6890; val_edge_recon_loss: 1282841.9531; val_gene_expr_recon_loss: 2355214.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3646618.5312; val_optim_loss: 3646618.5312
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9622; val_auprc_score: 0.9826; val_best_acc_score: 0.9362; val_best_f1_score: 0.9585; train_kl_reg_loss: 8678.8408; train_edge_recon_loss: 1334694.1179; train_gene_expr_recon_loss: 2356680.8643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3700053.8143; train_optim_loss: 3700053.8143; val_kl_reg_loss: 8402.0999; val_edge_recon_loss: 1322685.9062; val_gene_expr_recon_loss: 2328794.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3659882.1250; val_optim_loss: 3659882.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9625; val_auprc_score: 0.9776; val_best_acc_score: 0.9492; val_best_f1_score: 0.9668; train_kl_reg_loss: 20758.8699; train_edge_recon_loss: 1336469.0821; train_gene_expr_recon_loss: 1898674.7179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3255902.6714; train_optim_loss: 3255902.6714; val_kl_reg_loss: 20568.6057; val_edge_recon_loss: 1342429.6094; val_gene_expr_recon_loss: 2170887.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3533885.7188; val_optim_loss: 3533885.7188
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9731; val_auprc_score: 0.9869; val_best_acc_score: 0.9499; val_best_f1_score: 0.9669; train_kl_reg_loss: 8714.1773; train_edge_recon_loss: 1323587.1393; train_gene_expr_recon_loss: 2343511.5214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3675812.8286; train_optim_loss: 3675812.8286; val_kl_reg_loss: 8721.2118; val_edge_recon_loss: 1305593.1562; val_gene_expr_recon_loss: 2320694.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3635008.4688; val_optim_loss: 3635008.4688
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9474; val_auprc_score: 0.9679; val_best_acc_score: 0.9402; val_best_f1_score: 0.9609; train_kl_reg_loss: 8968.4148; train_edge_recon_loss: 1318510.5446; train_gene_expr_recon_loss: 2334212.7321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3661691.6857; train_optim_loss: 3661691.6857; val_kl_reg_loss: 9020.5258; val_edge_recon_loss: 1352011.2188; val_gene_expr_recon_loss: 2299290.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660322.5938; val_optim_loss: 3660322.5938
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9720; val_auprc_score: 0.9845; val_best_acc_score: 0.9502; val_best_f1_score: 0.9669; train_kl_reg_loss: 20865.1444; train_edge_recon_loss: 1325903.3982; train_gene_expr_recon_loss: 1890321.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3237089.8643; train_optim_loss: 3237089.8643; val_kl_reg_loss: 20624.6904; val_edge_recon_loss: 1396138.0000; val_gene_expr_recon_loss: 2153689.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3570452.5000; val_optim_loss: 3570452.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9655; val_auprc_score: 0.9797; val_best_acc_score: 0.9454; val_best_f1_score: 0.9644; train_kl_reg_loss: 8915.6560; train_edge_recon_loss: 1333050.8339; train_gene_expr_recon_loss: 2305293.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3647259.4893; train_optim_loss: 3647259.4893; val_kl_reg_loss: 8924.1252; val_edge_recon_loss: 1315887.8906; val_gene_expr_recon_loss: 2287368.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3612180.1875; val_optim_loss: 3612180.1875
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9714; val_auprc_score: 0.9863; val_best_acc_score: 0.9540; val_best_f1_score: 0.9702; train_kl_reg_loss: 20968.4170; train_edge_recon_loss: 1314416.5036; train_gene_expr_recon_loss: 1889294.7589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224679.6786; train_optim_loss: 3224679.6786; val_kl_reg_loss: 20882.9092; val_edge_recon_loss: 1302706.0625; val_gene_expr_recon_loss: 2192603.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3516192.3750; val_optim_loss: 3516192.3750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9653; val_auprc_score: 0.9824; val_best_acc_score: 0.9504; val_best_f1_score: 0.9676; train_kl_reg_loss: 9027.0427; train_edge_recon_loss: 1329109.2179; train_gene_expr_recon_loss: 2286105.4893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3624241.7464; train_optim_loss: 3624241.7464; val_kl_reg_loss: 9054.5454; val_edge_recon_loss: 1310707.1719; val_gene_expr_recon_loss: 2278868.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3598629.8438; val_optim_loss: 3598629.8438

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 8 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9711
val AUPRC score: 0.9869
val best accuracy score: 0.9562
val best F1 score: 0.9714
val target rna MSE score: 0.8881
val source rna MSE score: 0.0622
Val cat covariate0 mean sim diff: 0.0035
Duration of model training in run 5: 0 hours, 11 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9646; val_auprc_score: 0.9822; val_best_acc_score: 0.9477; val_best_f1_score: 0.9661; train_kl_reg_loss: 9212.5249; train_edge_recon_loss: 1318193.0161; train_gene_expr_recon_loss: 2278158.9107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3605564.4607; train_optim_loss: 3605564.4607; val_kl_reg_loss: 9196.0808; val_edge_recon_loss: 1289591.6875; val_gene_expr_recon_loss: 2260757.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3559545.4062; val_optim_loss: 3559545.4062
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9659; val_auprc_score: 0.9769; val_best_acc_score: 0.9513; val_best_f1_score: 0.9681; train_kl_reg_loss: 9286.1523; train_edge_recon_loss: 1318868.0813; train_gene_expr_recon_loss: 2258329.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3586484.0536; train_optim_loss: 3586484.0536; val_kl_reg_loss: 9378.1719; val_edge_recon_loss: 1315930.5156; val_gene_expr_recon_loss: 2248182.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3573490.8750; val_optim_loss: 3573490.8750
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9692; val_auprc_score: 0.9845; val_best_acc_score: 0.9433; val_best_f1_score: 0.9626; train_kl_reg_loss: 9603.9420; train_edge_recon_loss: 1310496.1304; train_gene_expr_recon_loss: 2242276.4750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3562376.5357; train_optim_loss: 3562376.5357; val_kl_reg_loss: 9795.5280; val_edge_recon_loss: 1357896.9219; val_gene_expr_recon_loss: 2252477.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3620170.3750; val_optim_loss: 3620170.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9675; val_auprc_score: 0.9825; val_best_acc_score: 0.9514; val_best_f1_score: 0.9680; train_kl_reg_loss: 9903.6923; train_edge_recon_loss: 1303592.1643; train_gene_expr_recon_loss: 2227378.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3540873.9000; train_optim_loss: 3540873.9000; val_kl_reg_loss: 10080.3522; val_edge_recon_loss: 1317533.7969; val_gene_expr_recon_loss: 2240056.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3567670.6562; val_optim_loss: 3567670.6562
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9727; val_auprc_score: 0.9862; val_best_acc_score: 0.9507; val_best_f1_score: 0.9674; train_kl_reg_loss: 10083.4934; train_edge_recon_loss: 1297333.6911; train_gene_expr_recon_loss: 2206808.4125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3514225.6071; train_optim_loss: 3514225.6071; val_kl_reg_loss: 10414.0728; val_edge_recon_loss: 1348542.1250; val_gene_expr_recon_loss: 2222576.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3581532.2188; val_optim_loss: 3581532.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9696; val_auprc_score: 0.9851; val_best_acc_score: 0.9555; val_best_f1_score: 0.9709; train_kl_reg_loss: 10375.0934; train_edge_recon_loss: 1313079.5857; train_gene_expr_recon_loss: 2187328.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3510782.7893; train_optim_loss: 3510782.7893; val_kl_reg_loss: 10275.1870; val_edge_recon_loss: 1317620.9531; val_gene_expr_recon_loss: 2215162.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3543058.1875; val_optim_loss: 3543058.1875
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9723; val_auprc_score: 0.9870; val_best_acc_score: 0.9538; val_best_f1_score: 0.9697; train_kl_reg_loss: 10437.5327; train_edge_recon_loss: 1308938.2982; train_gene_expr_recon_loss: 2181447.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3500823.0107; train_optim_loss: 3500823.0107; val_kl_reg_loss: 10399.2914; val_edge_recon_loss: 1294240.4219; val_gene_expr_recon_loss: 2202621.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3507261.3438; val_optim_loss: 3507261.3438
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9745; val_auprc_score: 0.9887; val_best_acc_score: 0.9549; val_best_f1_score: 0.9706; train_kl_reg_loss: 10514.8652; train_edge_recon_loss: 1321348.4125; train_gene_expr_recon_loss: 2169235.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3501098.8821; train_optim_loss: 3501098.8821; val_kl_reg_loss: 10476.0825; val_edge_recon_loss: 1302690.4531; val_gene_expr_recon_loss: 2204640.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3517807.5000; val_optim_loss: 3517807.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9718; val_auprc_score: 0.9851; val_best_acc_score: 0.9606; val_best_f1_score: 0.9743; train_kl_reg_loss: 10648.8256; train_edge_recon_loss: 1331562.0268; train_gene_expr_recon_loss: 2171208.0196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3513418.9000; train_optim_loss: 3513418.9000; val_kl_reg_loss: 10609.8003; val_edge_recon_loss: 1268482.2812; val_gene_expr_recon_loss: 2200882.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3479975.0938; val_optim_loss: 3479975.0938
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9673; val_auprc_score: 0.9793; val_best_acc_score: 0.9513; val_best_f1_score: 0.9680; train_kl_reg_loss: 10635.7115; train_edge_recon_loss: 1302304.9054; train_gene_expr_recon_loss: 2171702.6714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3484643.2964; train_optim_loss: 3484643.2964; val_kl_reg_loss: 10655.5691; val_edge_recon_loss: 1348274.5938; val_gene_expr_recon_loss: 2196390.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3555320.8125; val_optim_loss: 3555320.8125
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9630; val_auprc_score: 0.9808; val_best_acc_score: 0.9512; val_best_f1_score: 0.9679; train_kl_reg_loss: 10694.8485; train_edge_recon_loss: 1310158.5679; train_gene_expr_recon_loss: 2170817.8893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3491671.2964; train_optim_loss: 3491671.2964; val_kl_reg_loss: 10738.6168; val_edge_recon_loss: 1343576.3281; val_gene_expr_recon_loss: 2208005.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3562320.0938; val_optim_loss: 3562320.0938
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9694; val_auprc_score: 0.9829; val_best_acc_score: 0.9540; val_best_f1_score: 0.9700; train_kl_reg_loss: 10761.3965; train_edge_recon_loss: 1311578.0491; train_gene_expr_recon_loss: 2170885.1893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3493224.6536; train_optim_loss: 3493224.6536; val_kl_reg_loss: 10738.3174; val_edge_recon_loss: 1276831.2344; val_gene_expr_recon_loss: 2201794.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3489364.0000; val_optim_loss: 3489364.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9750; val_auprc_score: 0.9844; val_best_acc_score: 0.9585; val_best_f1_score: 0.9727; train_kl_reg_loss: 10804.1704; train_edge_recon_loss: 1317816.6893; train_gene_expr_recon_loss: 2165233.2071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3493854.0571; train_optim_loss: 3493854.0571; val_kl_reg_loss: 10834.7208; val_edge_recon_loss: 1312265.5781; val_gene_expr_recon_loss: 2199784.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3522884.9688; val_optim_loss: 3522884.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9720; val_auprc_score: 0.9874; val_best_acc_score: 0.9546; val_best_f1_score: 0.9706; train_kl_reg_loss: 10883.5334; train_edge_recon_loss: 1333498.7464; train_gene_expr_recon_loss: 2159739.3161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3504121.5821; train_optim_loss: 3504121.5821; val_kl_reg_loss: 10810.7476; val_edge_recon_loss: 1272481.8281; val_gene_expr_recon_loss: 2196744.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3480037.3125; val_optim_loss: 3480037.3125
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9750; val_auprc_score: 0.9860; val_best_acc_score: 0.9621; val_best_f1_score: 0.9749; train_kl_reg_loss: 10870.5429; train_edge_recon_loss: 1321524.7786; train_gene_expr_recon_loss: 2163534.3518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3495929.6571; train_optim_loss: 3495929.6571; val_kl_reg_loss: 10764.9821; val_edge_recon_loss: 1307578.1875; val_gene_expr_recon_loss: 2212517.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3530860.1250; val_optim_loss: 3530860.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9714; val_auprc_score: 0.9843; val_best_acc_score: 0.9515; val_best_f1_score: 0.9679; train_kl_reg_loss: 10861.4181; train_edge_recon_loss: 1301877.8536; train_gene_expr_recon_loss: 2159146.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3471886.1964; train_optim_loss: 3471886.1964; val_kl_reg_loss: 10795.6921; val_edge_recon_loss: 1357576.3594; val_gene_expr_recon_loss: 2194244.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3562616.3438; val_optim_loss: 3562616.3438
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9701; val_auprc_score: 0.9801; val_best_acc_score: 0.9500; val_best_f1_score: 0.9672; train_kl_reg_loss: 10848.1557; train_edge_recon_loss: 1317184.8946; train_gene_expr_recon_loss: 2157356.5768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3485389.6250; train_optim_loss: 3485389.6250; val_kl_reg_loss: 10732.6421; val_edge_recon_loss: 1351043.5000; val_gene_expr_recon_loss: 2214779.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576555.4062; val_optim_loss: 3576555.4062

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 56 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9711
val AUPRC score: 0.9839
val best accuracy score: 0.9551
val best F1 score: 0.9709
val target rna MSE score: 0.5773
val source rna MSE score: 0.0560
Val cat covariate0 mean sim diff: 0.0131
Val cat covariate1 mean sim diff: 0.0131
Duration of model training in run 6: 0 hours, 9 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7599; val_auprc_score: 0.9020; val_best_acc_score: 0.7875; val_best_f1_score: 0.8710; train_kl_reg_loss: 2705.2545; train_edge_recon_loss: 1707695.8821; train_gene_expr_recon_loss: 3063012.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773413.9143; train_optim_loss: 4773413.9143; val_kl_reg_loss: 6735.9207; val_edge_recon_loss: 1730991.0312; val_gene_expr_recon_loss: 2679962.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4417689.6250; val_optim_loss: 4417689.6250
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7942; val_auprc_score: 0.9103; val_best_acc_score: 0.8055; val_best_f1_score: 0.8825; train_kl_reg_loss: 8564.0362; train_edge_recon_loss: 1593168.4821; train_gene_expr_recon_loss: 2641766.8786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4243499.3964; train_optim_loss: 4243499.3964; val_kl_reg_loss: 7997.5220; val_edge_recon_loss: 1578686.6406; val_gene_expr_recon_loss: 2572411.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4159095.6875; val_optim_loss: 4159095.6875
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8430; val_auprc_score: 0.9288; val_best_acc_score: 0.8297; val_best_f1_score: 0.8928; train_kl_reg_loss: 9706.0150; train_edge_recon_loss: 1489843.3321; train_gene_expr_recon_loss: 2566763.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4066313.0571; train_optim_loss: 4066313.0571; val_kl_reg_loss: 10137.5933; val_edge_recon_loss: 1493617.2812; val_gene_expr_recon_loss: 2531306.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4035061.2188; val_optim_loss: 4035061.2188
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8555; val_auprc_score: 0.9367; val_best_acc_score: 0.8577; val_best_f1_score: 0.9106; train_kl_reg_loss: 10083.0154; train_edge_recon_loss: 1415863.6607; train_gene_expr_recon_loss: 2528103.3107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3954049.9714; train_optim_loss: 3954049.9714; val_kl_reg_loss: 9665.4512; val_edge_recon_loss: 1422808.3750; val_gene_expr_recon_loss: 2490633.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3923107.7500; val_optim_loss: 3923107.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8907; val_auprc_score: 0.9453; val_best_acc_score: 0.8695; val_best_f1_score: 0.9178; train_kl_reg_loss: 9704.2455; train_edge_recon_loss: 1390222.6804; train_gene_expr_recon_loss: 2507907.9643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3907834.8893; train_optim_loss: 3907834.8893; val_kl_reg_loss: 9153.3713; val_edge_recon_loss: 1376134.5781; val_gene_expr_recon_loss: 2482387.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3867675.2500; val_optim_loss: 3867675.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8893; val_auprc_score: 0.9483; val_best_acc_score: 0.8647; val_best_f1_score: 0.9124; train_kl_reg_loss: 9039.3661; train_edge_recon_loss: 1389559.4821; train_gene_expr_recon_loss: 2488751.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3887350.6107; train_optim_loss: 3887350.6107; val_kl_reg_loss: 8612.8199; val_edge_recon_loss: 1421936.0469; val_gene_expr_recon_loss: 2434168.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3864717.4062; val_optim_loss: 3864717.4062
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9105; val_auprc_score: 0.9583; val_best_acc_score: 0.8810; val_best_f1_score: 0.9237; train_kl_reg_loss: 8864.1071; train_edge_recon_loss: 1374232.6732; train_gene_expr_recon_loss: 2465154.3179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3848251.1143; train_optim_loss: 3848251.1143; val_kl_reg_loss: 8962.9935; val_edge_recon_loss: 1426336.4531; val_gene_expr_recon_loss: 2453042.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3888341.8438; val_optim_loss: 3888341.8438
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9226; val_auprc_score: 0.9599; val_best_acc_score: 0.9010; val_best_f1_score: 0.9354; train_kl_reg_loss: 8793.3283; train_edge_recon_loss: 1370345.2750; train_gene_expr_recon_loss: 2454547.0321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833685.6357; train_optim_loss: 3833685.6357; val_kl_reg_loss: 8798.9609; val_edge_recon_loss: 1364399.4219; val_gene_expr_recon_loss: 2437398.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3810597.3750; val_optim_loss: 3810597.3750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9388; val_auprc_score: 0.9687; val_best_acc_score: 0.9136; val_best_f1_score: 0.9435; train_kl_reg_loss: 8676.2916; train_edge_recon_loss: 1357332.7143; train_gene_expr_recon_loss: 2433078.8857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3799087.9036; train_optim_loss: 3799087.9036; val_kl_reg_loss: 8645.4071; val_edge_recon_loss: 1353218.2344; val_gene_expr_recon_loss: 2427164.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3789028.4062; val_optim_loss: 3789028.4062
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9410; val_auprc_score: 0.9716; val_best_acc_score: 0.9201; val_best_f1_score: 0.9489; train_kl_reg_loss: 8653.1510; train_edge_recon_loss: 1334175.5214; train_gene_expr_recon_loss: 2429372.4714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3772201.1429; train_optim_loss: 3772201.1429; val_kl_reg_loss: 8617.5455; val_edge_recon_loss: 1297324.2188; val_gene_expr_recon_loss: 2415984.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3721925.9375; val_optim_loss: 3721925.9375
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9457; val_auprc_score: 0.9727; val_best_acc_score: 0.9250; val_best_f1_score: 0.9511; train_kl_reg_loss: 8609.2886; train_edge_recon_loss: 1341910.2991; train_gene_expr_recon_loss: 2413764.0786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3764283.6643; train_optim_loss: 3764283.6643; val_kl_reg_loss: 8428.8639; val_edge_recon_loss: 1363195.2500; val_gene_expr_recon_loss: 2401434.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3773058.8750; val_optim_loss: 3773058.8750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9421; val_auprc_score: 0.9681; val_best_acc_score: 0.9282; val_best_f1_score: 0.9534; train_kl_reg_loss: 8553.4485; train_edge_recon_loss: 1327899.8643; train_gene_expr_recon_loss: 2393300.2714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3729753.5643; train_optim_loss: 3729753.5643; val_kl_reg_loss: 8619.6860; val_edge_recon_loss: 1314594.4375; val_gene_expr_recon_loss: 2390704.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3713918.1562; val_optim_loss: 3713918.1562
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9455; val_auprc_score: 0.9719; val_best_acc_score: 0.9289; val_best_f1_score: 0.9536; train_kl_reg_loss: 8595.7312; train_edge_recon_loss: 1322843.3250; train_gene_expr_recon_loss: 2382590.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3714029.1607; train_optim_loss: 3714029.1607; val_kl_reg_loss: 8587.9861; val_edge_recon_loss: 1358071.0625; val_gene_expr_recon_loss: 2348846.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3715505.0000; val_optim_loss: 3715505.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9488; val_auprc_score: 0.9699; val_best_acc_score: 0.9222; val_best_f1_score: 0.9498; train_kl_reg_loss: 8558.2133; train_edge_recon_loss: 1329186.4964; train_gene_expr_recon_loss: 2369398.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3707142.7714; train_optim_loss: 3707142.7714; val_kl_reg_loss: 8466.5597; val_edge_recon_loss: 1390597.3750; val_gene_expr_recon_loss: 2388254.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3787318.1562; val_optim_loss: 3787318.1562
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9556; val_auprc_score: 0.9744; val_best_acc_score: 0.9319; val_best_f1_score: 0.9548; train_kl_reg_loss: 8669.0284; train_edge_recon_loss: 1331092.4304; train_gene_expr_recon_loss: 2358517.5107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3698278.9643; train_optim_loss: 3698278.9643; val_kl_reg_loss: 8834.0809; val_edge_recon_loss: 1390227.2812; val_gene_expr_recon_loss: 2351130.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3750191.8125; val_optim_loss: 3750191.8125
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9543; val_auprc_score: 0.9702; val_best_acc_score: 0.9388; val_best_f1_score: 0.9604; train_kl_reg_loss: 8600.2324; train_edge_recon_loss: 1307938.5821; train_gene_expr_recon_loss: 2352606.0464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3669144.8643; train_optim_loss: 3669144.8643; val_kl_reg_loss: 8386.8146; val_edge_recon_loss: 1333192.7344; val_gene_expr_recon_loss: 2338380.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3679960.3125; val_optim_loss: 3679960.3125
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9551; val_auprc_score: 0.9746; val_best_acc_score: 0.9397; val_best_f1_score: 0.9606; train_kl_reg_loss: 8681.4868; train_edge_recon_loss: 1323042.4625; train_gene_expr_recon_loss: 2335066.2179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3666790.1607; train_optim_loss: 3666790.1607; val_kl_reg_loss: 8720.0391; val_edge_recon_loss: 1323565.8750; val_gene_expr_recon_loss: 2340857.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3673142.9375; val_optim_loss: 3673142.9375
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9643; val_auprc_score: 0.9787; val_best_acc_score: 0.9527; val_best_f1_score: 0.9694; train_kl_reg_loss: 8584.5536; train_edge_recon_loss: 1319489.3054; train_gene_expr_recon_loss: 2327836.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3655910.0643; train_optim_loss: 3655910.0643; val_kl_reg_loss: 8530.4529; val_edge_recon_loss: 1257532.4375; val_gene_expr_recon_loss: 2311344.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3577407.5000; val_optim_loss: 3577407.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9671; val_auprc_score: 0.9825; val_best_acc_score: 0.9486; val_best_f1_score: 0.9661; train_kl_reg_loss: 8723.2639; train_edge_recon_loss: 1322175.3357; train_gene_expr_recon_loss: 2308131.0357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3639029.6357; train_optim_loss: 3639029.6357; val_kl_reg_loss: 8774.9642; val_edge_recon_loss: 1337436.1719; val_gene_expr_recon_loss: 2301102.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3647313.2500; val_optim_loss: 3647313.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9627; val_auprc_score: 0.9751; val_best_acc_score: 0.9495; val_best_f1_score: 0.9670; train_kl_reg_loss: 8892.7840; train_edge_recon_loss: 1336139.6482; train_gene_expr_recon_loss: 2298289.0393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3643321.4786; train_optim_loss: 3643321.4786; val_kl_reg_loss: 9044.3798; val_edge_recon_loss: 1333254.6719; val_gene_expr_recon_loss: 2301688.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3643987.5312; val_optim_loss: 3643987.5312
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9713; val_auprc_score: 0.9845; val_best_acc_score: 0.9499; val_best_f1_score: 0.9674; train_kl_reg_loss: 8864.9665; train_edge_recon_loss: 1306784.7429; train_gene_expr_recon_loss: 2277669.1089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3593318.8214; train_optim_loss: 3593318.8214; val_kl_reg_loss: 9252.8167; val_edge_recon_loss: 1282373.2500; val_gene_expr_recon_loss: 2284705.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576332.0625; val_optim_loss: 3576332.0625
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9631; val_auprc_score: 0.9806; val_best_acc_score: 0.9438; val_best_f1_score: 0.9637; train_kl_reg_loss: 9142.2366; train_edge_recon_loss: 1305916.0179; train_gene_expr_recon_loss: 2270323.1464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3585381.3893; train_optim_loss: 3585381.3893; val_kl_reg_loss: 9553.4198; val_edge_recon_loss: 1273884.4688; val_gene_expr_recon_loss: 2292727.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576165.4688; val_optim_loss: 3576165.4688
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9655; val_auprc_score: 0.9826; val_best_acc_score: 0.9423; val_best_f1_score: 0.9626; train_kl_reg_loss: 9288.1739; train_edge_recon_loss: 1316117.6286; train_gene_expr_recon_loss: 2259246.6607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3584652.4679; train_optim_loss: 3584652.4679; val_kl_reg_loss: 9535.5746; val_edge_recon_loss: 1315303.5938; val_gene_expr_recon_loss: 2289441.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3614280.4375; val_optim_loss: 3614280.4375
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9749; val_auprc_score: 0.9861; val_best_acc_score: 0.9545; val_best_f1_score: 0.9703; train_kl_reg_loss: 9532.6621; train_edge_recon_loss: 1316614.8804; train_gene_expr_recon_loss: 2234819.9875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560967.5321; train_optim_loss: 3560967.5321; val_kl_reg_loss: 9544.9460; val_edge_recon_loss: 1297791.4375; val_gene_expr_recon_loss: 2261030.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3568367.2188; val_optim_loss: 3568367.2188
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9672; val_auprc_score: 0.9785; val_best_acc_score: 0.9495; val_best_f1_score: 0.9668; train_kl_reg_loss: 9625.9354; train_edge_recon_loss: 1319850.1786; train_gene_expr_recon_loss: 2223975.3929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3553451.4929; train_optim_loss: 3553451.4929; val_kl_reg_loss: 9840.4720; val_edge_recon_loss: 1333604.0938; val_gene_expr_recon_loss: 2268072.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3611517.1250; val_optim_loss: 3611517.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9698; val_auprc_score: 0.9826; val_best_acc_score: 0.9528; val_best_f1_score: 0.9690; train_kl_reg_loss: 9793.8273; train_edge_recon_loss: 1322095.9679; train_gene_expr_recon_loss: 2203137.9482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3535027.7536; train_optim_loss: 3535027.7536; val_kl_reg_loss: 10148.2749; val_edge_recon_loss: 1346518.6406; val_gene_expr_recon_loss: 2239503.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3596170.4375; val_optim_loss: 3596170.4375
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9614; val_auprc_score: 0.9750; val_best_acc_score: 0.9480; val_best_f1_score: 0.9659; train_kl_reg_loss: 10204.9458; train_edge_recon_loss: 1320028.7518; train_gene_expr_recon_loss: 2185722.1982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3515955.8964; train_optim_loss: 3515955.8964; val_kl_reg_loss: 10460.9771; val_edge_recon_loss: 1348721.6250; val_gene_expr_recon_loss: 2225571.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3584754.2812; val_optim_loss: 3584754.2812
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9807; val_auprc_score: 0.9924; val_best_acc_score: 0.9490; val_best_f1_score: 0.9663; train_kl_reg_loss: 10521.7799; train_edge_recon_loss: 1327401.7491; train_gene_expr_recon_loss: 2170293.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3508217.1750; train_optim_loss: 3508217.1750; val_kl_reg_loss: 10507.8932; val_edge_recon_loss: 1348303.8125; val_gene_expr_recon_loss: 2224643.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3583454.9688; val_optim_loss: 3583454.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9667; val_auprc_score: 0.9813; val_best_acc_score: 0.9398; val_best_f1_score: 0.9615; train_kl_reg_loss: 10685.2289; train_edge_recon_loss: 1313485.2429; train_gene_expr_recon_loss: 2148553.9946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3472724.4714; train_optim_loss: 3472724.4714; val_kl_reg_loss: 10681.7133; val_edge_recon_loss: 1278910.8594; val_gene_expr_recon_loss: 2215506.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3505098.9062; val_optim_loss: 3505098.9062
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9666; val_auprc_score: 0.9774; val_best_acc_score: 0.9436; val_best_f1_score: 0.9628; train_kl_reg_loss: 10785.3186; train_edge_recon_loss: 1297045.1893; train_gene_expr_recon_loss: 2139036.2625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3446866.7607; train_optim_loss: 3446866.7607; val_kl_reg_loss: 10690.3608; val_edge_recon_loss: 1351179.9375; val_gene_expr_recon_loss: 2202818.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3564689.2188; val_optim_loss: 3564689.2188
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9794; val_auprc_score: 0.9911; val_best_acc_score: 0.9536; val_best_f1_score: 0.9693; train_kl_reg_loss: 10903.3979; train_edge_recon_loss: 1333997.8536; train_gene_expr_recon_loss: 2134103.1089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3479004.3679; train_optim_loss: 3479004.3679; val_kl_reg_loss: 10909.3524; val_edge_recon_loss: 1316328.7812; val_gene_expr_recon_loss: 2218195.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3545433.3750; val_optim_loss: 3545433.3750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9738; val_auprc_score: 0.9824; val_best_acc_score: 0.9512; val_best_f1_score: 0.9676; train_kl_reg_loss: 10990.2783; train_edge_recon_loss: 1301945.0071; train_gene_expr_recon_loss: 2128197.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3441133.2321; train_optim_loss: 3441133.2321; val_kl_reg_loss: 10872.9061; val_edge_recon_loss: 1325679.9219; val_gene_expr_recon_loss: 2230262.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3566815.5312; val_optim_loss: 3566815.5312
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9676; val_auprc_score: 0.9812; val_best_acc_score: 0.9503; val_best_f1_score: 0.9671; train_kl_reg_loss: 11057.0783; train_edge_recon_loss: 1324433.4929; train_gene_expr_recon_loss: 2126449.1661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3461939.7321; train_optim_loss: 3461939.7321; val_kl_reg_loss: 10881.5249; val_edge_recon_loss: 1357882.5781; val_gene_expr_recon_loss: 2214099.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3582864.0312; val_optim_loss: 3582864.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9682; val_auprc_score: 0.9828; val_best_acc_score: 0.9502; val_best_f1_score: 0.9667; train_kl_reg_loss: 11114.8497; train_edge_recon_loss: 1321131.5375; train_gene_expr_recon_loss: 2125113.2661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3457359.6679; train_optim_loss: 3457359.6679; val_kl_reg_loss: 11001.7578; val_edge_recon_loss: 1355523.4531; val_gene_expr_recon_loss: 2221329.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3587854.2812; val_optim_loss: 3587854.2812
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9684; val_auprc_score: 0.9843; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 11142.8887; train_edge_recon_loss: 1322215.0054; train_gene_expr_recon_loss: 2128341.1179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3461699.0179; train_optim_loss: 3461699.0179; val_kl_reg_loss: 10943.7092; val_edge_recon_loss: 1265594.4219; val_gene_expr_recon_loss: 2204950.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3481488.6250; val_optim_loss: 3481488.6250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9716; val_auprc_score: 0.9836; val_best_acc_score: 0.9519; val_best_f1_score: 0.9676; train_kl_reg_loss: 11150.5036; train_edge_recon_loss: 1328613.7018; train_gene_expr_recon_loss: 2125045.8929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3464810.1143; train_optim_loss: 3464810.1143; val_kl_reg_loss: 10951.4845; val_edge_recon_loss: 1369094.2188; val_gene_expr_recon_loss: 2204831.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3584877.5938; val_optim_loss: 3584877.5938
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9667; val_auprc_score: 0.9815; val_best_acc_score: 0.9520; val_best_f1_score: 0.9689; train_kl_reg_loss: 11156.1831; train_edge_recon_loss: 1308303.1446; train_gene_expr_recon_loss: 2123709.8964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3443169.2357; train_optim_loss: 3443169.2357; val_kl_reg_loss: 11073.1423; val_edge_recon_loss: 1281818.0000; val_gene_expr_recon_loss: 2229031.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3521922.2812; val_optim_loss: 3521922.2812
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9710; val_auprc_score: 0.9817; val_best_acc_score: 0.9510; val_best_f1_score: 0.9673; train_kl_reg_loss: 11123.6508; train_edge_recon_loss: 1291644.9277; train_gene_expr_recon_loss: 2124070.0554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3426838.6107; train_optim_loss: 3426838.6107; val_kl_reg_loss: 11051.2697; val_edge_recon_loss: 1359843.6094; val_gene_expr_recon_loss: 2214466.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3585361.5625; val_optim_loss: 3585361.5625
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9683; val_auprc_score: 0.9840; val_best_acc_score: 0.9545; val_best_f1_score: 0.9706; train_kl_reg_loss: 11150.6905; train_edge_recon_loss: 1329113.9000; train_gene_expr_recon_loss: 2121920.8018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3462185.3893; train_optim_loss: 3462185.3893; val_kl_reg_loss: 11046.7357; val_edge_recon_loss: 1256055.5312; val_gene_expr_recon_loss: 2202924.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3470026.9375; val_optim_loss: 3470026.9375
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9742; val_auprc_score: 0.9856; val_best_acc_score: 0.9505; val_best_f1_score: 0.9673; train_kl_reg_loss: 11124.6534; train_edge_recon_loss: 1336471.7536; train_gene_expr_recon_loss: 2122795.4268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3470391.8286; train_optim_loss: 3470391.8286; val_kl_reg_loss: 11073.3387; val_edge_recon_loss: 1352872.1406; val_gene_expr_recon_loss: 2208793.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572738.8750; val_optim_loss: 3572738.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9722; val_auprc_score: 0.9872; val_best_acc_score: 0.9508; val_best_f1_score: 0.9676; train_kl_reg_loss: 11134.2954; train_edge_recon_loss: 1310082.8304; train_gene_expr_recon_loss: 2120762.0018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3441979.1250; train_optim_loss: 3441979.1250; val_kl_reg_loss: 11067.9242; val_edge_recon_loss: 1343813.4219; val_gene_expr_recon_loss: 2220441.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3575322.8438; val_optim_loss: 3575322.8438
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9735; val_auprc_score: 0.9872; val_best_acc_score: 0.9532; val_best_f1_score: 0.9693; train_kl_reg_loss: 11133.8442; train_edge_recon_loss: 1316054.4857; train_gene_expr_recon_loss: 2123235.9107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3450424.2357; train_optim_loss: 3450424.2357; val_kl_reg_loss: 11029.1691; val_edge_recon_loss: 1321416.1562; val_gene_expr_recon_loss: 2219611.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3552057.3125; val_optim_loss: 3552057.3125
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9724; val_auprc_score: 0.9880; val_best_acc_score: 0.9482; val_best_f1_score: 0.9657; train_kl_reg_loss: 11151.0660; train_edge_recon_loss: 1314262.2554; train_gene_expr_recon_loss: 2119126.7821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3444540.0964; train_optim_loss: 3444540.0964; val_kl_reg_loss: 11079.2548; val_edge_recon_loss: 1350958.0312; val_gene_expr_recon_loss: 2225214.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3587251.5938; val_optim_loss: 3587251.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9723; val_auprc_score: 0.9838; val_best_acc_score: 0.9555; val_best_f1_score: 0.9708; train_kl_reg_loss: 11181.1649; train_edge_recon_loss: 1303332.8545; train_gene_expr_recon_loss: 2120408.8286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3434922.8464; train_optim_loss: 3434922.8464; val_kl_reg_loss: 11089.5898; val_edge_recon_loss: 1312723.6250; val_gene_expr_recon_loss: 2209252.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3533065.7188; val_optim_loss: 3533065.7188
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9696; val_auprc_score: 0.9807; val_best_acc_score: 0.9498; val_best_f1_score: 0.9669; train_kl_reg_loss: 11177.2666; train_edge_recon_loss: 1328893.3589; train_gene_expr_recon_loss: 2117980.8339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3458051.4429; train_optim_loss: 3458051.4429; val_kl_reg_loss: 11089.3885; val_edge_recon_loss: 1358634.8438; val_gene_expr_recon_loss: 2219557.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3589281.7500; val_optim_loss: 3589281.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9732; val_auprc_score: 0.9821; val_best_acc_score: 0.9519; val_best_f1_score: 0.9679; train_kl_reg_loss: 11173.8841; train_edge_recon_loss: 1319418.5857; train_gene_expr_recon_loss: 2122852.0446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3453444.5071; train_optim_loss: 3453444.5071; val_kl_reg_loss: 11074.7579; val_edge_recon_loss: 1359257.0000; val_gene_expr_recon_loss: 2202572.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572904.4062; val_optim_loss: 3572904.4062
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9711; val_auprc_score: 0.9821; val_best_acc_score: 0.9513; val_best_f1_score: 0.9679; train_kl_reg_loss: 11202.3206; train_edge_recon_loss: 1313410.8321; train_gene_expr_recon_loss: 2118596.4804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3443209.6286; train_optim_loss: 3443209.6286; val_kl_reg_loss: 11077.2238; val_edge_recon_loss: 1357405.9531; val_gene_expr_recon_loss: 2213108.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3581592.0625; val_optim_loss: 3581592.0625

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 52 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9679
val AUPRC score: 0.9823
val best accuracy score: 0.9514
val best F1 score: 0.9681
val target rna MSE score: 0.5535
val source rna MSE score: 0.0618
Val cat covariate0 mean sim diff: -0.0013
Val cat covariate1 mean sim diff: -0.0013
Duration of model training in run 5: 0 hours, 12 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7610; val_auprc_score: 0.9104; val_best_acc_score: 0.7999; val_best_f1_score: 0.8809; train_kl_reg_loss: 3822.8916; train_edge_recon_loss: 1749987.8670; train_gene_expr_recon_loss: 3232372.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4986183.0957; train_optim_loss: 4986183.0957; val_kl_reg_loss: 7283.7611; val_edge_recon_loss: 1767365.0208; val_gene_expr_recon_loss: 2774743.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4549392.5833; val_optim_loss: 4549392.5833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7580; val_auprc_score: 0.9019; val_best_acc_score: 0.7893; val_best_f1_score: 0.8744; train_kl_reg_loss: 12345.0321; train_edge_recon_loss: 1636741.2181; train_gene_expr_recon_loss: 2722643.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4371729.2447; train_optim_loss: 4371729.2447; val_kl_reg_loss: 11983.4385; val_edge_recon_loss: 1684620.7917; val_gene_expr_recon_loss: 2565033.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4261637.7500; val_optim_loss: 4261637.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7849; val_auprc_score: 0.9135; val_best_acc_score: 0.7987; val_best_f1_score: 0.8814; train_kl_reg_loss: 12460.2882; train_edge_recon_loss: 1584916.7207; train_gene_expr_recon_loss: 2608921.9521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4206298.9362; train_optim_loss: 4206298.9362; val_kl_reg_loss: 11320.9699; val_edge_recon_loss: 1525916.3750; val_gene_expr_recon_loss: 2498189.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4035426.9167; val_optim_loss: 4035426.9167
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8003; val_auprc_score: 0.9169; val_best_acc_score: 0.7979; val_best_f1_score: 0.8771; train_kl_reg_loss: 11734.3125; train_edge_recon_loss: 1529873.4415; train_gene_expr_recon_loss: 2567689.3298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4109297.0957; train_optim_loss: 4109297.0957; val_kl_reg_loss: 9967.4876; val_edge_recon_loss: 1585971.0417; val_gene_expr_recon_loss: 2490527.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086465.5417; val_optim_loss: 4086465.5417
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8143; val_auprc_score: 0.9153; val_best_acc_score: 0.8180; val_best_f1_score: 0.8876; train_kl_reg_loss: 11288.7498; train_edge_recon_loss: 1487057.6383; train_gene_expr_recon_loss: 2547116.5904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4045462.9840; train_optim_loss: 4045462.9840; val_kl_reg_loss: 10945.7902; val_edge_recon_loss: 1478534.9375; val_gene_expr_recon_loss: 2477067.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3966548.2500; val_optim_loss: 3966548.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8496; val_auprc_score: 0.9354; val_best_acc_score: 0.8386; val_best_f1_score: 0.9007; train_kl_reg_loss: 10948.6670; train_edge_recon_loss: 1424283.3032; train_gene_expr_recon_loss: 2524326.4734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3959558.4521; train_optim_loss: 3959558.4521; val_kl_reg_loss: 10385.0308; val_edge_recon_loss: 1498175.2708; val_gene_expr_recon_loss: 2437537.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3946097.6250; val_optim_loss: 3946097.6250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8820; val_auprc_score: 0.9502; val_best_acc_score: 0.8574; val_best_f1_score: 0.9086; train_kl_reg_loss: 10531.0499; train_edge_recon_loss: 1417287.1676; train_gene_expr_recon_loss: 2504672.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3932490.9574; train_optim_loss: 3932490.9574; val_kl_reg_loss: 10098.2352; val_edge_recon_loss: 1350998.1458; val_gene_expr_recon_loss: 2451224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3812320.3333; val_optim_loss: 3812320.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8849; val_auprc_score: 0.9455; val_best_acc_score: 0.8694; val_best_f1_score: 0.9161; train_kl_reg_loss: 10086.8378; train_edge_recon_loss: 1378154.1649; train_gene_expr_recon_loss: 2493494.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3881735.1968; train_optim_loss: 3881735.1968; val_kl_reg_loss: 9706.9551; val_edge_recon_loss: 1501652.2917; val_gene_expr_recon_loss: 2404980.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3916339.7500; val_optim_loss: 3916339.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9077; val_auprc_score: 0.9547; val_best_acc_score: 0.8922; val_best_f1_score: 0.9307; train_kl_reg_loss: 9646.8905; train_edge_recon_loss: 1391361.7340; train_gene_expr_recon_loss: 2479662.5426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3880671.1543; train_optim_loss: 3880671.1543; val_kl_reg_loss: 9744.5348; val_edge_recon_loss: 1343444.5208; val_gene_expr_recon_loss: 2433015.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3786204.3333; val_optim_loss: 3786204.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9076; val_auprc_score: 0.9570; val_best_acc_score: 0.8857; val_best_f1_score: 0.9278; train_kl_reg_loss: 9610.6793; train_edge_recon_loss: 1348959.6489; train_gene_expr_recon_loss: 2459782.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3818352.4202; train_optim_loss: 3818352.4202; val_kl_reg_loss: 9566.1087; val_edge_recon_loss: 1342221.2917; val_gene_expr_recon_loss: 2416578.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3768366.2500; val_optim_loss: 3768366.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9101; val_auprc_score: 0.9521; val_best_acc_score: 0.8961; val_best_f1_score: 0.9335; train_kl_reg_loss: 9341.2359; train_edge_recon_loss: 1377877.9814; train_gene_expr_recon_loss: 2459027.3564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3846246.5585; train_optim_loss: 3846246.5585; val_kl_reg_loss: 8928.0018; val_edge_recon_loss: 1373112.1667; val_gene_expr_recon_loss: 2416960.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3799000.3750; val_optim_loss: 3799000.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9304; val_auprc_score: 0.9645; val_best_acc_score: 0.9045; val_best_f1_score: 0.9399; train_kl_reg_loss: 9145.3464; train_edge_recon_loss: 1377048.8138; train_gene_expr_recon_loss: 2449075.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3835270.0213; train_optim_loss: 3835270.0213; val_kl_reg_loss: 9356.0623; val_edge_recon_loss: 1294268.3542; val_gene_expr_recon_loss: 2424106.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3727731.0417; val_optim_loss: 3727731.0417
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9181; val_auprc_score: 0.9575; val_best_acc_score: 0.9027; val_best_f1_score: 0.9382; train_kl_reg_loss: 9263.1323; train_edge_recon_loss: 1354788.2606; train_gene_expr_recon_loss: 2433213.8617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3797265.2926; train_optim_loss: 3797265.2926; val_kl_reg_loss: 9202.7909; val_edge_recon_loss: 1335672.7708; val_gene_expr_recon_loss: 2394176.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3739051.8333; val_optim_loss: 3739051.8333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9327; val_auprc_score: 0.9669; val_best_acc_score: 0.9100; val_best_f1_score: 0.9417; train_kl_reg_loss: 9087.9502; train_edge_recon_loss: 1322271.4229; train_gene_expr_recon_loss: 2424611.7021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3755971.0798; train_optim_loss: 3755971.0798; val_kl_reg_loss: 9085.2637; val_edge_recon_loss: 1322691.2500; val_gene_expr_recon_loss: 2388007.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3719784.0417; val_optim_loss: 3719784.0417
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9384; val_auprc_score: 0.9725; val_best_acc_score: 0.9110; val_best_f1_score: 0.9435; train_kl_reg_loss: 9104.9159; train_edge_recon_loss: 1354624.4707; train_gene_expr_recon_loss: 2419536.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783265.6330; train_optim_loss: 3783265.6330; val_kl_reg_loss: 8748.2025; val_edge_recon_loss: 1267798.7604; val_gene_expr_recon_loss: 2336634.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3613181.5000; val_optim_loss: 3613181.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9316; val_auprc_score: 0.9626; val_best_acc_score: 0.9186; val_best_f1_score: 0.9475; train_kl_reg_loss: 9001.3735; train_edge_recon_loss: 1313761.9229; train_gene_expr_recon_loss: 2406599.3298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3729362.6330; train_optim_loss: 3729362.6330; val_kl_reg_loss: 8857.2655; val_edge_recon_loss: 1320593.4792; val_gene_expr_recon_loss: 2347360.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3676810.8333; val_optim_loss: 3676810.8333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9412; val_auprc_score: 0.9652; val_best_acc_score: 0.9208; val_best_f1_score: 0.9487; train_kl_reg_loss: 9014.9453; train_edge_recon_loss: 1317234.9920; train_gene_expr_recon_loss: 2405264.2872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3731514.2181; train_optim_loss: 3731514.2181; val_kl_reg_loss: 8919.9917; val_edge_recon_loss: 1368824.2292; val_gene_expr_recon_loss: 2343051.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3720795.2083; val_optim_loss: 3720795.2083
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9390; val_auprc_score: 0.9678; val_best_acc_score: 0.9186; val_best_f1_score: 0.9476; train_kl_reg_loss: 8921.3199; train_edge_recon_loss: 1330770.4920; train_gene_expr_recon_loss: 2383321.2713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3723013.0638; train_optim_loss: 3723013.0638; val_kl_reg_loss: 8912.1141; val_edge_recon_loss: 1422345.7917; val_gene_expr_recon_loss: 2344649.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3775907.8750; val_optim_loss: 3775907.8750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9358; val_auprc_score: 0.9586; val_best_acc_score: 0.9237; val_best_f1_score: 0.9499; train_kl_reg_loss: 8928.5341; train_edge_recon_loss: 1316796.6702; train_gene_expr_recon_loss: 2377257.0266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3702982.2394; train_optim_loss: 3702982.2394; val_kl_reg_loss: 8799.7463; val_edge_recon_loss: 1419753.1250; val_gene_expr_recon_loss: 2344158.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3772711.6250; val_optim_loss: 3772711.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9548; val_auprc_score: 0.9741; val_best_acc_score: 0.9360; val_best_f1_score: 0.9571; train_kl_reg_loss: 8901.6691; train_edge_recon_loss: 1294408.0000; train_gene_expr_recon_loss: 2373753.3989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3677063.0745; train_optim_loss: 3677063.0745; val_kl_reg_loss: 8848.4806; val_edge_recon_loss: 1365110.3958; val_gene_expr_recon_loss: 2352491.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3726449.9583; val_optim_loss: 3726449.9583
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9546; val_auprc_score: 0.9811; val_best_acc_score: 0.9291; val_best_f1_score: 0.9537; train_kl_reg_loss: 8989.3833; train_edge_recon_loss: 1344476.1915; train_gene_expr_recon_loss: 2367774.3085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3721239.8351; train_optim_loss: 3721239.8351; val_kl_reg_loss: 8884.6764; val_edge_recon_loss: 1317327.0625; val_gene_expr_recon_loss: 2340151.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3666363.0417; val_optim_loss: 3666363.0417
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9405; val_auprc_score: 0.9606; val_best_acc_score: 0.9221; val_best_f1_score: 0.9494; train_kl_reg_loss: 8964.0672; train_edge_recon_loss: 1335460.7553; train_gene_expr_recon_loss: 2369978.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3714403.6277; train_optim_loss: 3714403.6277; val_kl_reg_loss: 8853.2360; val_edge_recon_loss: 1372169.9583; val_gene_expr_recon_loss: 2302311.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3683334.5417; val_optim_loss: 3683334.5417
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9492; val_auprc_score: 0.9739; val_best_acc_score: 0.9292; val_best_f1_score: 0.9545; train_kl_reg_loss: 8962.5817; train_edge_recon_loss: 1330437.1941; train_gene_expr_recon_loss: 2364593.1011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3703992.8723; train_optim_loss: 3703992.8723; val_kl_reg_loss: 8916.4904; val_edge_recon_loss: 1318721.8542; val_gene_expr_recon_loss: 2323136.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3650775.0417; val_optim_loss: 3650775.0417

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 33 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
val AUROC score: 0.9312
val AUPRC score: 0.9689
val best accuracy score: 0.9090
val best F1 score: 0.9414
val target rna MSE score: 0.6299
val source rna MSE score: 0.0955
Val cat covariate0 mean sim diff: -0.0081
Val cat covariate1 mean sim diff: -0.0081
Duration of model training in run 4: 0 hours, 2 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7900; val_auprc_score: 0.9118; val_best_acc_score: 0.7773; val_best_f1_score: 0.8680; train_kl_reg_loss: 1851.1376; train_edge_recon_loss: 1740054.3085; train_gene_expr_recon_loss: 3296817.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5038723.3085; train_optim_loss: 5038723.3085; val_kl_reg_loss: 5420.1404; val_edge_recon_loss: 2016259.3542; val_gene_expr_recon_loss: 2921318.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4942997.5833; val_optim_loss: 4942997.5833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7364; val_auprc_score: 0.8930; val_best_acc_score: 0.7877; val_best_f1_score: 0.8731; train_kl_reg_loss: 9027.6321; train_edge_recon_loss: 1710234.2367; train_gene_expr_recon_loss: 2783045.4574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4502307.3564; train_optim_loss: 4502307.3564; val_kl_reg_loss: 8981.7033; val_edge_recon_loss: 1777177.9583; val_gene_expr_recon_loss: 2626967.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4413127.3333; val_optim_loss: 4413127.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7635; val_auprc_score: 0.8936; val_best_acc_score: 0.7956; val_best_f1_score: 0.8750; train_kl_reg_loss: 11477.9156; train_edge_recon_loss: 1617040.3511; train_gene_expr_recon_loss: 2637014.8989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4265533.1383; train_optim_loss: 4265533.1383; val_kl_reg_loss: 10939.9565; val_edge_recon_loss: 1638073.1250; val_gene_expr_recon_loss: 2591310.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4240323.7083; val_optim_loss: 4240323.7083
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7318; val_auprc_score: 0.8837; val_best_acc_score: 0.7871; val_best_f1_score: 0.8742; train_kl_reg_loss: 11364.6970; train_edge_recon_loss: 1539462.6356; train_gene_expr_recon_loss: 2591960.0585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4142787.3723; train_optim_loss: 4142787.3723; val_kl_reg_loss: 10401.4102; val_edge_recon_loss: 1693182.9583; val_gene_expr_recon_loss: 2544136.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4247721.1250; val_optim_loss: 4247721.1250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7905; val_auprc_score: 0.9123; val_best_acc_score: 0.8225; val_best_f1_score: 0.8935; train_kl_reg_loss: 11829.9407; train_edge_recon_loss: 1539182.5266; train_gene_expr_recon_loss: 2569623.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4120636.2447; train_optim_loss: 4120636.2447; val_kl_reg_loss: 10022.4144; val_edge_recon_loss: 1528793.0833; val_gene_expr_recon_loss: 2496990.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4035805.8333; val_optim_loss: 4035805.8333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8422; val_auprc_score: 0.9384; val_best_acc_score: 0.8392; val_best_f1_score: 0.9024; train_kl_reg_loss: 10132.9303; train_edge_recon_loss: 1487375.7207; train_gene_expr_recon_loss: 2546228.8564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4043737.5266; train_optim_loss: 4043737.5266; val_kl_reg_loss: 9608.0444; val_edge_recon_loss: 1419423.2083; val_gene_expr_recon_loss: 2524992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3954023.2500; val_optim_loss: 3954023.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8560; val_auprc_score: 0.9351; val_best_acc_score: 0.8309; val_best_f1_score: 0.8947; train_kl_reg_loss: 9886.6176; train_edge_recon_loss: 1433547.9814; train_gene_expr_recon_loss: 2534035.9043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3977470.4947; train_optim_loss: 3977470.4947; val_kl_reg_loss: 9625.6951; val_edge_recon_loss: 1442284.1458; val_gene_expr_recon_loss: 2497382.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3949292.3333; val_optim_loss: 3949292.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8657; val_auprc_score: 0.9432; val_best_acc_score: 0.8587; val_best_f1_score: 0.9122; train_kl_reg_loss: 9881.0593; train_edge_recon_loss: 1422172.4654; train_gene_expr_recon_loss: 2507496.9415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3939550.4574; train_optim_loss: 3939550.4574; val_kl_reg_loss: 9546.3501; val_edge_recon_loss: 1321819.8542; val_gene_expr_recon_loss: 2467515.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3798882.0000; val_optim_loss: 3798882.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8962; val_auprc_score: 0.9552; val_best_acc_score: 0.8637; val_best_f1_score: 0.9142; train_kl_reg_loss: 9803.8674; train_edge_recon_loss: 1378764.9309; train_gene_expr_recon_loss: 2496265.2872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3884834.1011; train_optim_loss: 3884834.1011; val_kl_reg_loss: 9871.1882; val_edge_recon_loss: 1349466.0417; val_gene_expr_recon_loss: 2471729.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3831066.8750; val_optim_loss: 3831066.8750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9009; val_auprc_score: 0.9509; val_best_acc_score: 0.8703; val_best_f1_score: 0.9159; train_kl_reg_loss: 9480.6155; train_edge_recon_loss: 1366908.9681; train_gene_expr_recon_loss: 2482684.5904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3859074.1596; train_optim_loss: 3859074.1596; val_kl_reg_loss: 9242.1969; val_edge_recon_loss: 1414127.5208; val_gene_expr_recon_loss: 2449993.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3873363.0833; val_optim_loss: 3873363.0833
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9128; val_auprc_score: 0.9583; val_best_acc_score: 0.8788; val_best_f1_score: 0.9226; train_kl_reg_loss: 9372.9625; train_edge_recon_loss: 1361790.6941; train_gene_expr_recon_loss: 2472044.6170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3843208.2660; train_optim_loss: 3843208.2660; val_kl_reg_loss: 9296.6738; val_edge_recon_loss: 1444239.7708; val_gene_expr_recon_loss: 2461423.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3914959.4583; val_optim_loss: 3914959.4583
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9140; val_auprc_score: 0.9626; val_best_acc_score: 0.8867; val_best_f1_score: 0.9277; train_kl_reg_loss: 9165.7631; train_edge_recon_loss: 1371118.9707; train_gene_expr_recon_loss: 2464329.5532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3844614.2926; train_optim_loss: 3844614.2926; val_kl_reg_loss: 9185.8757; val_edge_recon_loss: 1373362.0833; val_gene_expr_recon_loss: 2454852.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3837400.5833; val_optim_loss: 3837400.5833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9272; val_auprc_score: 0.9709; val_best_acc_score: 0.9060; val_best_f1_score: 0.9403; train_kl_reg_loss: 9240.7043; train_edge_recon_loss: 1360874.3564; train_gene_expr_recon_loss: 2448999.7979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819114.8457; train_optim_loss: 3819114.8457; val_kl_reg_loss: 9063.1084; val_edge_recon_loss: 1317651.2292; val_gene_expr_recon_loss: 2432124.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3758839.1667; val_optim_loss: 3758839.1667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9206; val_auprc_score: 0.9602; val_best_acc_score: 0.9029; val_best_f1_score: 0.9368; train_kl_reg_loss: 9289.9678; train_edge_recon_loss: 1355081.3537; train_gene_expr_recon_loss: 2446717.2713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811088.5851; train_optim_loss: 3811088.5851; val_kl_reg_loss: 9253.5360; val_edge_recon_loss: 1433129.2500; val_gene_expr_recon_loss: 2439829.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3882212.7917; val_optim_loss: 3882212.7917
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9192; val_auprc_score: 0.9586; val_best_acc_score: 0.8882; val_best_f1_score: 0.9280; train_kl_reg_loss: 9340.8638; train_edge_recon_loss: 1348638.0372; train_gene_expr_recon_loss: 2446054.8404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3804033.7660; train_optim_loss: 3804033.7660; val_kl_reg_loss: 9232.3005; val_edge_recon_loss: 1360410.5625; val_gene_expr_recon_loss: 2417321.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3786964.7083; val_optim_loss: 3786964.7083
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9295; val_auprc_score: 0.9609; val_best_acc_score: 0.8966; val_best_f1_score: 0.9321; train_kl_reg_loss: 9291.9222; train_edge_recon_loss: 1343559.3590; train_gene_expr_recon_loss: 2446865.5904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3799716.8777; train_optim_loss: 3799716.8777; val_kl_reg_loss: 9170.9098; val_edge_recon_loss: 1433657.7500; val_gene_expr_recon_loss: 2437742.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3880571.0417; val_optim_loss: 3880571.0417
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9261; val_auprc_score: 0.9571; val_best_acc_score: 0.9079; val_best_f1_score: 0.9392; train_kl_reg_loss: 9276.6689; train_edge_recon_loss: 1332848.1117; train_gene_expr_recon_loss: 2442889.9628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3785014.7500; train_optim_loss: 3785014.7500; val_kl_reg_loss: 9182.6779; val_edge_recon_loss: 1456212.9375; val_gene_expr_recon_loss: 2432178.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3897574.5000; val_optim_loss: 3897574.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9389; val_auprc_score: 0.9724; val_best_acc_score: 0.9081; val_best_f1_score: 0.9407; train_kl_reg_loss: 9282.2345; train_edge_recon_loss: 1342524.2021; train_gene_expr_recon_loss: 2433098.9043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3784905.3298; train_optim_loss: 3784905.3298; val_kl_reg_loss: 9235.1860; val_edge_recon_loss: 1356703.2083; val_gene_expr_recon_loss: 2465209.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3831147.5417; val_optim_loss: 3831147.5417
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9181; val_auprc_score: 0.9552; val_best_acc_score: 0.9023; val_best_f1_score: 0.9369; train_kl_reg_loss: 9286.6537; train_edge_recon_loss: 1342349.6516; train_gene_expr_recon_loss: 2437424.8511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3789061.1489; train_optim_loss: 3789061.1489; val_kl_reg_loss: 9141.5422; val_edge_recon_loss: 1393088.4792; val_gene_expr_recon_loss: 2426401.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3828631.7500; val_optim_loss: 3828631.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9397; val_auprc_score: 0.9732; val_best_acc_score: 0.9066; val_best_f1_score: 0.9401; train_kl_reg_loss: 9293.7337; train_edge_recon_loss: 1311112.9229; train_gene_expr_recon_loss: 2442434.9096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3762841.5585; train_optim_loss: 3762841.5585; val_kl_reg_loss: 9204.8428; val_edge_recon_loss: 1311770.6042; val_gene_expr_recon_loss: 2433412.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3754388.0417; val_optim_loss: 3754388.0417
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9388; val_auprc_score: 0.9742; val_best_acc_score: 0.9096; val_best_f1_score: 0.9417; train_kl_reg_loss: 9299.4349; train_edge_recon_loss: 1352588.4787; train_gene_expr_recon_loss: 2434413.2287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3796301.1543; train_optim_loss: 3796301.1543; val_kl_reg_loss: 9222.5991; val_edge_recon_loss: 1307702.7083; val_gene_expr_recon_loss: 2442320.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759245.7083; val_optim_loss: 3759245.7083
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9239; val_auprc_score: 0.9624; val_best_acc_score: 0.8946; val_best_f1_score: 0.9328; train_kl_reg_loss: 9303.4334; train_edge_recon_loss: 1326444.9255; train_gene_expr_recon_loss: 2438198.9947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3773947.3511; train_optim_loss: 3773947.3511; val_kl_reg_loss: 9160.5072; val_edge_recon_loss: 1422945.1250; val_gene_expr_recon_loss: 2393408.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3825514.0000; val_optim_loss: 3825514.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9361; val_auprc_score: 0.9756; val_best_acc_score: 0.9062; val_best_f1_score: 0.9400; train_kl_reg_loss: 9306.1236; train_edge_recon_loss: 1330460.6449; train_gene_expr_recon_loss: 2442685.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782452.0691; train_optim_loss: 3782452.0691; val_kl_reg_loss: 9141.5858; val_edge_recon_loss: 1242960.5521; val_gene_expr_recon_loss: 2434890.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3686993.0833; val_optim_loss: 3686993.0833
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9389; val_auprc_score: 0.9671; val_best_acc_score: 0.9059; val_best_f1_score: 0.9372; train_kl_reg_loss: 9288.6537; train_edge_recon_loss: 1339207.4122; train_gene_expr_recon_loss: 2436699.6330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3785195.6968; train_optim_loss: 3785195.6968; val_kl_reg_loss: 9233.8678; val_edge_recon_loss: 1458394.5417; val_gene_expr_recon_loss: 2451010.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3918639.3333; val_optim_loss: 3918639.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9218; val_auprc_score: 0.9624; val_best_acc_score: 0.9085; val_best_f1_score: 0.9410; train_kl_reg_loss: 9305.6271; train_edge_recon_loss: 1346129.3537; train_gene_expr_recon_loss: 2439863.3298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3795298.3298; train_optim_loss: 3795298.3298; val_kl_reg_loss: 9244.8452; val_edge_recon_loss: 1359819.3542; val_gene_expr_recon_loss: 2454757.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3823821.2083; val_optim_loss: 3823821.2083
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9155; val_auprc_score: 0.9568; val_best_acc_score: 0.9058; val_best_f1_score: 0.9402; train_kl_reg_loss: 9282.0154; train_edge_recon_loss: 1304334.0479; train_gene_expr_recon_loss: 2442541.6117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3756157.6596; train_optim_loss: 3756157.6596; val_kl_reg_loss: 9203.7078; val_edge_recon_loss: 1316490.7917; val_gene_expr_recon_loss: 2427827.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3753521.8333; val_optim_loss: 3753521.8333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9326; val_auprc_score: 0.9703; val_best_acc_score: 0.9103; val_best_f1_score: 0.9420; train_kl_reg_loss: 9287.7250; train_edge_recon_loss: 1327610.8191; train_gene_expr_recon_loss: 2433461.1064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3770359.6543; train_optim_loss: 3770359.6543; val_kl_reg_loss: 9224.1670; val_edge_recon_loss: 1326460.8542; val_gene_expr_recon_loss: 2444408.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3780093.2083; val_optim_loss: 3780093.2083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9172; val_auprc_score: 0.9617; val_best_acc_score: 0.9114; val_best_f1_score: 0.9436; train_kl_reg_loss: 9314.1234; train_edge_recon_loss: 1314280.8830; train_gene_expr_recon_loss: 2435039.7606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3758634.7606; train_optim_loss: 3758634.7606; val_kl_reg_loss: 9246.0076; val_edge_recon_loss: 1293157.2917; val_gene_expr_recon_loss: 2444668.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3747071.5000; val_optim_loss: 3747071.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9332; val_auprc_score: 0.9644; val_best_acc_score: 0.9041; val_best_f1_score: 0.9375; train_kl_reg_loss: 9302.5978; train_edge_recon_loss: 1335038.5957; train_gene_expr_recon_loss: 2437156.1489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3781497.3351; train_optim_loss: 3781497.3351; val_kl_reg_loss: 9236.2523; val_edge_recon_loss: 1448006.9375; val_gene_expr_recon_loss: 2429382.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3886625.4167; val_optim_loss: 3886625.4167
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9277; val_auprc_score: 0.9687; val_best_acc_score: 0.9075; val_best_f1_score: 0.9403; train_kl_reg_loss: 9310.7420; train_edge_recon_loss: 1342717.3484; train_gene_expr_recon_loss: 2441837.2819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3793865.3564; train_optim_loss: 3793865.3564; val_kl_reg_loss: 9255.8695; val_edge_recon_loss: 1353352.5417; val_gene_expr_recon_loss: 2447867.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3810476.2917; val_optim_loss: 3810476.2917
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9347; val_auprc_score: 0.9710; val_best_acc_score: 0.9090; val_best_f1_score: 0.9415; train_kl_reg_loss: 9308.1720; train_edge_recon_loss: 1357725.0452; train_gene_expr_recon_loss: 2444191.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3811225.0638; train_optim_loss: 3811225.0638; val_kl_reg_loss: 9233.6530; val_edge_recon_loss: 1312872.8125; val_gene_expr_recon_loss: 2418416.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3740522.6667; val_optim_loss: 3740522.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 1 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9178
val AUPRC score: 0.9606
val best accuracy score: 0.8981
val best F1 score: 0.9349
val target rna MSE score: 0.6793
val source rna MSE score: 0.1052
Val cat covariate0 mean sim diff: -0.0057
Val cat covariate1 mean sim diff: -0.0057
Duration of model training in run 3: 0 hours, 4 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8008; val_auprc_score: 0.9108; val_best_acc_score: 0.7876; val_best_f1_score: 0.8669; train_kl_reg_loss: 383.5669; train_edge_recon_loss: 1697094.7500; train_gene_expr_recon_loss: 3402355.4200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5099833.7600; train_optim_loss: 5099833.7600; val_kl_reg_loss: 853.4709; val_edge_recon_loss: 2158104.3750; val_gene_expr_recon_loss: 3166966.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5325924.1667; val_optim_loss: 5325924.1667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7395; val_auprc_score: 0.8954; val_best_acc_score: 0.8087; val_best_f1_score: 0.8879; train_kl_reg_loss: 2767.6475; train_edge_recon_loss: 1715269.6950; train_gene_expr_recon_loss: 2970672.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4688709.3600; train_optim_loss: 4688709.3600; val_kl_reg_loss: 3490.1458; val_edge_recon_loss: 1870102.0833; val_gene_expr_recon_loss: 2792419.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4666012.0000; val_optim_loss: 4666012.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7540; val_auprc_score: 0.9039; val_best_acc_score: 0.8033; val_best_f1_score: 0.8838; train_kl_reg_loss: 3644.1419; train_edge_recon_loss: 1691872.6550; train_gene_expr_recon_loss: 2745365.5600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4440882.3200; train_optim_loss: 4440882.3200; val_kl_reg_loss: 6393.5858; val_edge_recon_loss: 1692406.6667; val_gene_expr_recon_loss: 2663717.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4362517.5000; val_optim_loss: 4362517.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7226; val_auprc_score: 0.8771; val_best_acc_score: 0.7903; val_best_f1_score: 0.8745; train_kl_reg_loss: 8278.0234; train_edge_recon_loss: 1645564.3450; train_gene_expr_recon_loss: 2636201.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4290043.7200; train_optim_loss: 4290043.7200; val_kl_reg_loss: 9643.1546; val_edge_recon_loss: 1686101.6250; val_gene_expr_recon_loss: 2637659.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4333404.3333; val_optim_loss: 4333404.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.6991; val_auprc_score: 0.8619; val_best_acc_score: 0.7919; val_best_f1_score: 0.8768; train_kl_reg_loss: 11304.4383; train_edge_recon_loss: 1492905.3950; train_gene_expr_recon_loss: 2584719.2400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4088929.0400; train_optim_loss: 4088929.0400; val_kl_reg_loss: 11147.9567; val_edge_recon_loss: 1711419.5833; val_gene_expr_recon_loss: 2556091.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4278658.5000; val_optim_loss: 4278658.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7177; val_auprc_score: 0.8832; val_best_acc_score: 0.7991; val_best_f1_score: 0.8825; train_kl_reg_loss: 11659.0792; train_edge_recon_loss: 1490545.0450; train_gene_expr_recon_loss: 2553241.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4055446.0400; train_optim_loss: 4055446.0400; val_kl_reg_loss: 13880.9424; val_edge_recon_loss: 1625705.5417; val_gene_expr_recon_loss: 2543505.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4183091.7500; val_optim_loss: 4183091.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7266; val_auprc_score: 0.8833; val_best_acc_score: 0.7826; val_best_f1_score: 0.8713; train_kl_reg_loss: 10854.3834; train_edge_recon_loss: 1465678.6875; train_gene_expr_recon_loss: 2531300.9900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007834.0500; train_optim_loss: 4007834.0500; val_kl_reg_loss: 9165.3008; val_edge_recon_loss: 1723025.7083; val_gene_expr_recon_loss: 2542745.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4274936.6667; val_optim_loss: 4274936.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7691; val_auprc_score: 0.8991; val_best_acc_score: 0.8016; val_best_f1_score: 0.8828; train_kl_reg_loss: 10361.9065; train_edge_recon_loss: 1525555.6325; train_gene_expr_recon_loss: 2514570.4100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4050487.9500; train_optim_loss: 4050487.9500; val_kl_reg_loss: 10385.4268; val_edge_recon_loss: 1499045.1250; val_gene_expr_recon_loss: 2522484.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4031914.9167; val_optim_loss: 4031914.9167
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7653; val_auprc_score: 0.8999; val_best_acc_score: 0.8013; val_best_f1_score: 0.8796; train_kl_reg_loss: 10502.5038; train_edge_recon_loss: 1448566.7700; train_gene_expr_recon_loss: 2502615.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3961684.7800; train_optim_loss: 3961684.7800; val_kl_reg_loss: 9200.8822; val_edge_recon_loss: 1567218.7500; val_gene_expr_recon_loss: 2553399.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4129819.5000; val_optim_loss: 4129819.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7549; val_auprc_score: 0.8940; val_best_acc_score: 0.8047; val_best_f1_score: 0.8824; train_kl_reg_loss: 9650.5691; train_edge_recon_loss: 1405343.3900; train_gene_expr_recon_loss: 2494413.4400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3909407.3800; train_optim_loss: 3909407.3800; val_kl_reg_loss: 9740.4368; val_edge_recon_loss: 1505536.0833; val_gene_expr_recon_loss: 2479965.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3995241.5833; val_optim_loss: 3995241.5833
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8099; val_auprc_score: 0.9229; val_best_acc_score: 0.8194; val_best_f1_score: 0.8887; train_kl_reg_loss: 10186.6113; train_edge_recon_loss: 1417224.1150; train_gene_expr_recon_loss: 2489293.5700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3916704.3200; train_optim_loss: 3916704.3200; val_kl_reg_loss: 10315.0635; val_edge_recon_loss: 1441126.7083; val_gene_expr_recon_loss: 2441197.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3892639.5000; val_optim_loss: 3892639.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8112; val_auprc_score: 0.9240; val_best_acc_score: 0.8107; val_best_f1_score: 0.8813; train_kl_reg_loss: 11302.2488; train_edge_recon_loss: 1434577.4700; train_gene_expr_recon_loss: 2470911.1800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3916790.9100; train_optim_loss: 3916790.9100; val_kl_reg_loss: 10155.6315; val_edge_recon_loss: 1514119.1250; val_gene_expr_recon_loss: 2484783.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4009058.6667; val_optim_loss: 4009058.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8038; val_auprc_score: 0.8966; val_best_acc_score: 0.8162; val_best_f1_score: 0.8831; train_kl_reg_loss: 10503.9447; train_edge_recon_loss: 1490160.8800; train_gene_expr_recon_loss: 2465058.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3965723.7700; train_optim_loss: 3965723.7700; val_kl_reg_loss: 10034.8379; val_edge_recon_loss: 1549488.3750; val_gene_expr_recon_loss: 2538661.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098184.2500; val_optim_loss: 4098184.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8107; val_auprc_score: 0.9123; val_best_acc_score: 0.8189; val_best_f1_score: 0.8849; train_kl_reg_loss: 10409.6866; train_edge_recon_loss: 1423449.6300; train_gene_expr_recon_loss: 2453010.0300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3886869.3400; train_optim_loss: 3886869.3400; val_kl_reg_loss: 9928.0918; val_edge_recon_loss: 1479470.9583; val_gene_expr_recon_loss: 2417972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3907371.0833; val_optim_loss: 3907371.0833
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8034; val_auprc_score: 0.9199; val_best_acc_score: 0.8047; val_best_f1_score: 0.8808; train_kl_reg_loss: 9995.5638; train_edge_recon_loss: 1424355.4550; train_gene_expr_recon_loss: 2452343.5800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3886694.5900; train_optim_loss: 3886694.5900; val_kl_reg_loss: 9590.6654; val_edge_recon_loss: 1444175.4583; val_gene_expr_recon_loss: 2464997.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3918764.0000; val_optim_loss: 3918764.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8100; val_auprc_score: 0.9201; val_best_acc_score: 0.8119; val_best_f1_score: 0.8834; train_kl_reg_loss: 9965.4601; train_edge_recon_loss: 1362496.2400; train_gene_expr_recon_loss: 2441037.6200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3813499.3100; train_optim_loss: 3813499.3100; val_kl_reg_loss: 9806.2874; val_edge_recon_loss: 1452135.2083; val_gene_expr_recon_loss: 2517387.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3979329.0833; val_optim_loss: 3979329.0833
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8122; val_auprc_score: 0.9182; val_best_acc_score: 0.8188; val_best_f1_score: 0.8901; train_kl_reg_loss: 10000.0074; train_edge_recon_loss: 1434089.4500; train_gene_expr_recon_loss: 2441699.8700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3885789.3300; train_optim_loss: 3885789.3300; val_kl_reg_loss: 9864.6468; val_edge_recon_loss: 1372267.8333; val_gene_expr_recon_loss: 2501151.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3883284.3333; val_optim_loss: 3883284.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8166; val_auprc_score: 0.9192; val_best_acc_score: 0.7976; val_best_f1_score: 0.8759; train_kl_reg_loss: 10095.4389; train_edge_recon_loss: 1337991.8700; train_gene_expr_recon_loss: 2443186.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3791274.0300; train_optim_loss: 3791274.0300; val_kl_reg_loss: 9660.3167; val_edge_recon_loss: 1471286.1667; val_gene_expr_recon_loss: 2440091.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3921037.9167; val_optim_loss: 3921037.9167
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8323; val_auprc_score: 0.9299; val_best_acc_score: 0.8157; val_best_f1_score: 0.8805; train_kl_reg_loss: 10079.2998; train_edge_recon_loss: 1392027.9700; train_gene_expr_recon_loss: 2442291.9600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3844399.2400; train_optim_loss: 3844399.2400; val_kl_reg_loss: 9735.3398; val_edge_recon_loss: 1491572.7500; val_gene_expr_recon_loss: 2407326.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3908634.5000; val_optim_loss: 3908634.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8339; val_auprc_score: 0.9269; val_best_acc_score: 0.8194; val_best_f1_score: 0.8848; train_kl_reg_loss: 10081.3093; train_edge_recon_loss: 1386966.1875; train_gene_expr_recon_loss: 2442442.0700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3839489.5800; train_optim_loss: 3839489.5800; val_kl_reg_loss: 9673.0661; val_edge_recon_loss: 1446760.5833; val_gene_expr_recon_loss: 2436663.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3893096.6667; val_optim_loss: 3893096.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8314; val_auprc_score: 0.9253; val_best_acc_score: 0.8203; val_best_f1_score: 0.8847; train_kl_reg_loss: 10135.7754; train_edge_recon_loss: 1384669.2100; train_gene_expr_recon_loss: 2433115.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3827920.4400; train_optim_loss: 3827920.4400; val_kl_reg_loss: 9642.2204; val_edge_recon_loss: 1491281.7500; val_gene_expr_recon_loss: 2383332.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3884256.0000; val_optim_loss: 3884256.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8384; val_auprc_score: 0.9385; val_best_acc_score: 0.8317; val_best_f1_score: 0.8933; train_kl_reg_loss: 10181.8934; train_edge_recon_loss: 1392809.9300; train_gene_expr_recon_loss: 2437650.6600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3840642.4600; train_optim_loss: 3840642.4600; val_kl_reg_loss: 9889.3092; val_edge_recon_loss: 1385335.9583; val_gene_expr_recon_loss: 2471560.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3866786.2500; val_optim_loss: 3866786.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8331; val_auprc_score: 0.9365; val_best_acc_score: 0.8081; val_best_f1_score: 0.8789; train_kl_reg_loss: 10248.6481; train_edge_recon_loss: 1337722.1450; train_gene_expr_recon_loss: 2436778.5100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3784749.3000; train_optim_loss: 3784749.3000; val_kl_reg_loss: 9908.0303; val_edge_recon_loss: 1476704.6667; val_gene_expr_recon_loss: 2506803.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3993416.5833; val_optim_loss: 3993416.5833
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8358; val_auprc_score: 0.9283; val_best_acc_score: 0.8173; val_best_f1_score: 0.8863; train_kl_reg_loss: 10161.7109; train_edge_recon_loss: 1374886.8300; train_gene_expr_recon_loss: 2428047.1700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3813095.6900; train_optim_loss: 3813095.6900; val_kl_reg_loss: 9936.1497; val_edge_recon_loss: 1456818.5417; val_gene_expr_recon_loss: 2411797.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3878551.6667; val_optim_loss: 3878551.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8322; val_auprc_score: 0.9249; val_best_acc_score: 0.8244; val_best_f1_score: 0.8912; train_kl_reg_loss: 10204.2132; train_edge_recon_loss: 1401924.5550; train_gene_expr_recon_loss: 2434037.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3846166.4000; train_optim_loss: 3846166.4000; val_kl_reg_loss: 9879.3034; val_edge_recon_loss: 1402046.2083; val_gene_expr_recon_loss: 2459491.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3871417.4167; val_optim_loss: 3871417.4167
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7943; val_auprc_score: 0.8930; val_best_acc_score: 0.7948; val_best_f1_score: 0.8690; train_kl_reg_loss: 10105.6629; train_edge_recon_loss: 1408736.3150; train_gene_expr_recon_loss: 2430845.5900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3849687.5700; train_optim_loss: 3849687.5700; val_kl_reg_loss: 9579.7480; val_edge_recon_loss: 1573327.1250; val_gene_expr_recon_loss: 2431791.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4014698.0000; val_optim_loss: 4014698.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8236; val_auprc_score: 0.9215; val_best_acc_score: 0.8209; val_best_f1_score: 0.8881; train_kl_reg_loss: 10154.0532; train_edge_recon_loss: 1357120.5175; train_gene_expr_recon_loss: 2437221.2300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3804495.7700; train_optim_loss: 3804495.7700; val_kl_reg_loss: 9736.0501; val_edge_recon_loss: 1457113.8750; val_gene_expr_recon_loss: 2410827.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3877677.7500; val_optim_loss: 3877677.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8276; val_auprc_score: 0.9169; val_best_acc_score: 0.8189; val_best_f1_score: 0.8868; train_kl_reg_loss: 10120.2445; train_edge_recon_loss: 1354261.7625; train_gene_expr_recon_loss: 2430704.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3795086.5000; train_optim_loss: 3795086.5000; val_kl_reg_loss: 9847.3216; val_edge_recon_loss: 1469431.2917; val_gene_expr_recon_loss: 2451318.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3930596.6667; val_optim_loss: 3930596.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8110; val_auprc_score: 0.9163; val_best_acc_score: 0.8053; val_best_f1_score: 0.8792; train_kl_reg_loss: 10134.4140; train_edge_recon_loss: 1388122.8250; train_gene_expr_recon_loss: 2441608.7800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3839866.0000; train_optim_loss: 3839866.0000; val_kl_reg_loss: 9932.9626; val_edge_recon_loss: 1515397.0833; val_gene_expr_recon_loss: 2475217.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4000547.3333; val_optim_loss: 4000547.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8031; val_auprc_score: 0.9162; val_best_acc_score: 0.8187; val_best_f1_score: 0.8881; train_kl_reg_loss: 10146.2502; train_edge_recon_loss: 1354102.5250; train_gene_expr_recon_loss: 2436693.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3800942.2700; train_optim_loss: 3800942.2700; val_kl_reg_loss: 9652.8200; val_edge_recon_loss: 1428617.7500; val_gene_expr_recon_loss: 2420707.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3858977.7500; val_optim_loss: 3858977.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8275; val_auprc_score: 0.9163; val_best_acc_score: 0.8153; val_best_f1_score: 0.8839; train_kl_reg_loss: 10130.2638; train_edge_recon_loss: 1380447.4850; train_gene_expr_recon_loss: 2436024.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3826602.7000; train_optim_loss: 3826602.7000; val_kl_reg_loss: 9827.3923; val_edge_recon_loss: 1465030.7083; val_gene_expr_recon_loss: 2466918.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3941776.5000; val_optim_loss: 3941776.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8119; val_auprc_score: 0.9176; val_best_acc_score: 0.8101; val_best_f1_score: 0.8803; train_kl_reg_loss: 10158.4950; train_edge_recon_loss: 1371134.6200; train_gene_expr_recon_loss: 2435236.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3816529.2200; train_optim_loss: 3816529.2200; val_kl_reg_loss: 9726.9482; val_edge_recon_loss: 1498573.9167; val_gene_expr_recon_loss: 2439505.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3947806.0000; val_optim_loss: 3947806.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8456; val_auprc_score: 0.9360; val_best_acc_score: 0.8124; val_best_f1_score: 0.8803; train_kl_reg_loss: 10149.2766; train_edge_recon_loss: 1366792.1850; train_gene_expr_recon_loss: 2435176.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3812118.3400; train_optim_loss: 3812118.3400; val_kl_reg_loss: 9685.3535; val_edge_recon_loss: 1477076.4583; val_gene_expr_recon_loss: 2455577.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3942338.8333; val_optim_loss: 3942338.8333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8489; val_auprc_score: 0.9389; val_best_acc_score: 0.8215; val_best_f1_score: 0.8875; train_kl_reg_loss: 10179.8388; train_edge_recon_loss: 1366908.7150; train_gene_expr_recon_loss: 2437039.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3814128.2000; train_optim_loss: 3814128.2000; val_kl_reg_loss: 9687.0091; val_edge_recon_loss: 1477568.6667; val_gene_expr_recon_loss: 2455238.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3942494.0000; val_optim_loss: 3942494.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8392; val_auprc_score: 0.9341; val_best_acc_score: 0.8199; val_best_f1_score: 0.8869; train_kl_reg_loss: 10114.8705; train_edge_recon_loss: 1410208.6650; train_gene_expr_recon_loss: 2433666.5800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3853990.0800; train_optim_loss: 3853990.0800; val_kl_reg_loss: 9786.4010; val_edge_recon_loss: 1482667.7083; val_gene_expr_recon_loss: 2443964.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3936418.6667; val_optim_loss: 3936418.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7849; val_auprc_score: 0.8934; val_best_acc_score: 0.8044; val_best_f1_score: 0.8789; train_kl_reg_loss: 10113.4834; train_edge_recon_loss: 1340239.2250; train_gene_expr_recon_loss: 2435186.4400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3785539.1400; train_optim_loss: 3785539.1400; val_kl_reg_loss: 9777.8317; val_edge_recon_loss: 1527655.8333; val_gene_expr_recon_loss: 2466716.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4004150.3333; val_optim_loss: 4004150.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8083; val_auprc_score: 0.9230; val_best_acc_score: 0.8166; val_best_f1_score: 0.8869; train_kl_reg_loss: 10173.8173; train_edge_recon_loss: 1380005.9400; train_gene_expr_recon_loss: 2434554.0800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3824733.8400; train_optim_loss: 3824733.8400; val_kl_reg_loss: 9822.8672; val_edge_recon_loss: 1414644.8333; val_gene_expr_recon_loss: 2467472.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3891940.5000; val_optim_loss: 3891940.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8134; val_auprc_score: 0.9106; val_best_acc_score: 0.8139; val_best_f1_score: 0.8833; train_kl_reg_loss: 10112.8906; train_edge_recon_loss: 1399909.6050; train_gene_expr_recon_loss: 2435496.1400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3845518.6300; train_optim_loss: 3845518.6300; val_kl_reg_loss: 9882.6559; val_edge_recon_loss: 1516297.7500; val_gene_expr_recon_loss: 2468979.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3995160.3333; val_optim_loss: 3995160.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 37 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.8296
val AUPRC score: 0.9190
val best accuracy score: 0.8067
val best F1 score: 0.8767
val target rna MSE score: 0.6849
val source rna MSE score: 0.1543
Val cat covariate0 mean sim diff: -0.0037
Val cat covariate1 mean sim diff: -0.0037
Duration of model training in run 2: 0 hours, 2 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7382; val_auprc_score: 0.8995; val_best_acc_score: 0.7894; val_best_f1_score: 0.8761; train_kl_reg_loss: 365.8733; train_edge_recon_loss: 1691689.8750; train_gene_expr_recon_loss: 3391839.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5083894.9400; train_optim_loss: 5083894.9400; val_kl_reg_loss: 840.5828; val_edge_recon_loss: 2002360.6250; val_gene_expr_recon_loss: 3119567.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5122768.5000; val_optim_loss: 5122768.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7739; val_auprc_score: 0.9129; val_best_acc_score: 0.7958; val_best_f1_score: 0.8807; train_kl_reg_loss: 3433.6960; train_edge_recon_loss: 1729831.0500; train_gene_expr_recon_loss: 2969659.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4702924.1600; train_optim_loss: 4702924.1600; val_kl_reg_loss: 4771.8337; val_edge_recon_loss: 1959606.5833; val_gene_expr_recon_loss: 2821785.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4786164.0000; val_optim_loss: 4786164.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7325; val_auprc_score: 0.8938; val_best_acc_score: 0.7812; val_best_f1_score: 0.8715; train_kl_reg_loss: 6138.6735; train_edge_recon_loss: 1616909.7650; train_gene_expr_recon_loss: 2749140.6200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4372189.0300; train_optim_loss: 4372189.0300; val_kl_reg_loss: 10019.8327; val_edge_recon_loss: 1942150.3333; val_gene_expr_recon_loss: 2692071.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4644241.1667; val_optim_loss: 4644241.1667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7171; val_auprc_score: 0.8752; val_best_acc_score: 0.7898; val_best_f1_score: 0.8742; train_kl_reg_loss: 9905.2086; train_edge_recon_loss: 1682449.9700; train_gene_expr_recon_loss: 2631105.1200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4323460.3000; train_optim_loss: 4323460.3000; val_kl_reg_loss: 9803.9561; val_edge_recon_loss: 1786539.3750; val_gene_expr_recon_loss: 2695017.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4491361.0000; val_optim_loss: 4491361.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7243; val_auprc_score: 0.8846; val_best_acc_score: 0.7885; val_best_f1_score: 0.8770; train_kl_reg_loss: 9055.2885; train_edge_recon_loss: 1625204.9850; train_gene_expr_recon_loss: 2600238.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4234498.9400; train_optim_loss: 4234498.9400; val_kl_reg_loss: 10469.7959; val_edge_recon_loss: 1598724.5000; val_gene_expr_recon_loss: 2646133.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4255327.3333; val_optim_loss: 4255327.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7255; val_auprc_score: 0.8832; val_best_acc_score: 0.7820; val_best_f1_score: 0.8681; train_kl_reg_loss: 11500.0102; train_edge_recon_loss: 1531749.1600; train_gene_expr_recon_loss: 2563598.8900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4106848.0700; train_optim_loss: 4106848.0700; val_kl_reg_loss: 11620.0501; val_edge_recon_loss: 1739724.8750; val_gene_expr_recon_loss: 2630577.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4381922.7500; val_optim_loss: 4381922.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7427; val_auprc_score: 0.8944; val_best_acc_score: 0.7820; val_best_f1_score: 0.8681; train_kl_reg_loss: 11086.7854; train_edge_recon_loss: 1536114.1550; train_gene_expr_recon_loss: 2543020.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4090221.8100; train_optim_loss: 4090221.8100; val_kl_reg_loss: 12127.6510; val_edge_recon_loss: 1642463.5000; val_gene_expr_recon_loss: 2617688.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4272279.8333; val_optim_loss: 4272279.8333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7471; val_auprc_score: 0.8798; val_best_acc_score: 0.7708; val_best_f1_score: 0.8616; train_kl_reg_loss: 11116.0977; train_edge_recon_loss: 1514432.2950; train_gene_expr_recon_loss: 2519885.7200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4045434.1400; train_optim_loss: 4045434.1400; val_kl_reg_loss: 10356.5029; val_edge_recon_loss: 1673188.9583; val_gene_expr_recon_loss: 2594029.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4277574.7500; val_optim_loss: 4277574.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7445; val_auprc_score: 0.8918; val_best_acc_score: 0.7880; val_best_f1_score: 0.8739; train_kl_reg_loss: 10135.3880; train_edge_recon_loss: 1516133.7050; train_gene_expr_recon_loss: 2502481.2900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4028750.3900; train_optim_loss: 4028750.3900; val_kl_reg_loss: 10074.3721; val_edge_recon_loss: 1548652.4167; val_gene_expr_recon_loss: 2526768.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4085495.3333; val_optim_loss: 4085495.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7800; val_auprc_score: 0.9101; val_best_acc_score: 0.7978; val_best_f1_score: 0.8786; train_kl_reg_loss: 10046.1526; train_edge_recon_loss: 1550418.9550; train_gene_expr_recon_loss: 2498125.4700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4058590.5800; train_optim_loss: 4058590.5800; val_kl_reg_loss: 10154.6328; val_edge_recon_loss: 1517124.9167; val_gene_expr_recon_loss: 2544772.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4072051.9167; val_optim_loss: 4072051.9167
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7943; val_auprc_score: 0.9126; val_best_acc_score: 0.8036; val_best_f1_score: 0.8808; train_kl_reg_loss: 9979.5618; train_edge_recon_loss: 1509049.8350; train_gene_expr_recon_loss: 2486827.0200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4005856.4000; train_optim_loss: 4005856.4000; val_kl_reg_loss: 11101.0417; val_edge_recon_loss: 1463987.6250; val_gene_expr_recon_loss: 2537848.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4012937.3333; val_optim_loss: 4012937.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7812; val_auprc_score: 0.9111; val_best_acc_score: 0.7893; val_best_f1_score: 0.8747; train_kl_reg_loss: 10793.4686; train_edge_recon_loss: 1456797.0450; train_gene_expr_recon_loss: 2474811.4800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3942402.0400; train_optim_loss: 3942402.0400; val_kl_reg_loss: 11728.0612; val_edge_recon_loss: 1468847.5833; val_gene_expr_recon_loss: 2522066.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4002642.0000; val_optim_loss: 4002642.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8068; val_auprc_score: 0.9289; val_best_acc_score: 0.7881; val_best_f1_score: 0.8716; train_kl_reg_loss: 11547.5496; train_edge_recon_loss: 1441711.8050; train_gene_expr_recon_loss: 2472577.3800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3925836.7200; train_optim_loss: 3925836.7200; val_kl_reg_loss: 10691.6335; val_edge_recon_loss: 1524686.7083; val_gene_expr_recon_loss: 2495717.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4031095.5000; val_optim_loss: 4031095.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8146; val_auprc_score: 0.9246; val_best_acc_score: 0.7954; val_best_f1_score: 0.8728; train_kl_reg_loss: 10885.7309; train_edge_recon_loss: 1450847.3500; train_gene_expr_recon_loss: 2465601.6300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3927334.7000; train_optim_loss: 3927334.7000; val_kl_reg_loss: 10984.6813; val_edge_recon_loss: 1522966.2500; val_gene_expr_recon_loss: 2446077.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3980027.8333; val_optim_loss: 3980027.8333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8068; val_auprc_score: 0.9171; val_best_acc_score: 0.8126; val_best_f1_score: 0.8856; train_kl_reg_loss: 11107.0669; train_edge_recon_loss: 1371129.0300; train_gene_expr_recon_loss: 2456260.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3838496.6900; train_optim_loss: 3838496.6900; val_kl_reg_loss: 10739.5667; val_edge_recon_loss: 1460502.4583; val_gene_expr_recon_loss: 2475083.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3946325.0000; val_optim_loss: 3946325.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8245; val_auprc_score: 0.9209; val_best_acc_score: 0.8094; val_best_f1_score: 0.8811; train_kl_reg_loss: 10652.0683; train_edge_recon_loss: 1448431.9850; train_gene_expr_recon_loss: 2441006.1300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3900090.1800; train_optim_loss: 3900090.1800; val_kl_reg_loss: 10572.7236; val_edge_recon_loss: 1468486.4167; val_gene_expr_recon_loss: 2515139.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3994198.8333; val_optim_loss: 3994198.8333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8283; val_auprc_score: 0.9333; val_best_acc_score: 0.8033; val_best_f1_score: 0.8776; train_kl_reg_loss: 10564.0094; train_edge_recon_loss: 1376877.9400; train_gene_expr_recon_loss: 2432045.9700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819487.9200; train_optim_loss: 3819487.9200; val_kl_reg_loss: 10909.5221; val_edge_recon_loss: 1436204.3750; val_gene_expr_recon_loss: 2479724.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3926838.8333; val_optim_loss: 3926838.8333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8230; val_auprc_score: 0.9181; val_best_acc_score: 0.8078; val_best_f1_score: 0.8816; train_kl_reg_loss: 10825.4511; train_edge_recon_loss: 1336058.5550; train_gene_expr_recon_loss: 2425224.1100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3772108.1100; train_optim_loss: 3772108.1100; val_kl_reg_loss: 10137.3564; val_edge_recon_loss: 1527749.7917; val_gene_expr_recon_loss: 2451750.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3989637.5000; val_optim_loss: 3989637.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8147; val_auprc_score: 0.9147; val_best_acc_score: 0.8055; val_best_f1_score: 0.8777; train_kl_reg_loss: 10015.5205; train_edge_recon_loss: 1352161.6650; train_gene_expr_recon_loss: 2428192.5300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3790369.7200; train_optim_loss: 3790369.7200; val_kl_reg_loss: 10144.4049; val_edge_recon_loss: 1515978.6250; val_gene_expr_recon_loss: 2477181.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4003304.5000; val_optim_loss: 4003304.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8629; val_auprc_score: 0.9447; val_best_acc_score: 0.8277; val_best_f1_score: 0.8913; train_kl_reg_loss: 10329.6071; train_edge_recon_loss: 1327406.9350; train_gene_expr_recon_loss: 2421150.9700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3758887.5300; train_optim_loss: 3758887.5300; val_kl_reg_loss: 9935.1956; val_edge_recon_loss: 1495790.7083; val_gene_expr_recon_loss: 2460824.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3966550.5833; val_optim_loss: 3966550.5833
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8624; val_auprc_score: 0.9450; val_best_acc_score: 0.8374; val_best_f1_score: 0.8973; train_kl_reg_loss: 9816.6521; train_edge_recon_loss: 1302917.3300; train_gene_expr_recon_loss: 2409323.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3722057.3600; train_optim_loss: 3722057.3600; val_kl_reg_loss: 9968.8330; val_edge_recon_loss: 1431677.4167; val_gene_expr_recon_loss: 2516128.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3957774.7500; val_optim_loss: 3957774.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8542; val_auprc_score: 0.9364; val_best_acc_score: 0.8313; val_best_f1_score: 0.8933; train_kl_reg_loss: 9873.1569; train_edge_recon_loss: 1344050.7200; train_gene_expr_recon_loss: 2408310.0300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3762233.9200; train_optim_loss: 3762233.9200; val_kl_reg_loss: 9662.9987; val_edge_recon_loss: 1433652.8750; val_gene_expr_recon_loss: 2472300.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3915616.5000; val_optim_loss: 3915616.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8426; val_auprc_score: 0.9319; val_best_acc_score: 0.8259; val_best_f1_score: 0.8884; train_kl_reg_loss: 9799.0866; train_edge_recon_loss: 1414310.5850; train_gene_expr_recon_loss: 2405233.8200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3829343.4800; train_optim_loss: 3829343.4800; val_kl_reg_loss: 9575.2773; val_edge_recon_loss: 1524005.3750; val_gene_expr_recon_loss: 2404269.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3937850.5000; val_optim_loss: 3937850.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8560; val_auprc_score: 0.9286; val_best_acc_score: 0.8384; val_best_f1_score: 0.8959; train_kl_reg_loss: 9711.6480; train_edge_recon_loss: 1377657.7200; train_gene_expr_recon_loss: 2404228.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3791597.8100; train_optim_loss: 3791597.8100; val_kl_reg_loss: 9852.1937; val_edge_recon_loss: 1454191.1250; val_gene_expr_recon_loss: 2508692.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3972736.1667; val_optim_loss: 3972736.1667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8429; val_auprc_score: 0.9291; val_best_acc_score: 0.8432; val_best_f1_score: 0.9030; train_kl_reg_loss: 9735.1112; train_edge_recon_loss: 1363758.2500; train_gene_expr_recon_loss: 2392616.4100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3766109.7600; train_optim_loss: 3766109.7600; val_kl_reg_loss: 9668.0436; val_edge_recon_loss: 1404057.5417; val_gene_expr_recon_loss: 2451064.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3864790.4167; val_optim_loss: 3864790.4167
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8462; val_auprc_score: 0.9380; val_best_acc_score: 0.8326; val_best_f1_score: 0.8973; train_kl_reg_loss: 9856.8670; train_edge_recon_loss: 1320311.6450; train_gene_expr_recon_loss: 2401496.1100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3731664.6500; train_optim_loss: 3731664.6500; val_kl_reg_loss: 9828.2832; val_edge_recon_loss: 1402185.5000; val_gene_expr_recon_loss: 2410575.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3822588.8333; val_optim_loss: 3822588.8333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8660; val_auprc_score: 0.9381; val_best_acc_score: 0.8301; val_best_f1_score: 0.8899; train_kl_reg_loss: 9880.2167; train_edge_recon_loss: 1280189.4250; train_gene_expr_recon_loss: 2392411.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3682481.1300; train_optim_loss: 3682481.1300; val_kl_reg_loss: 9786.3665; val_edge_recon_loss: 1519565.6250; val_gene_expr_recon_loss: 2415969.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3945321.0000; val_optim_loss: 3945321.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8644; val_auprc_score: 0.9490; val_best_acc_score: 0.8352; val_best_f1_score: 0.8976; train_kl_reg_loss: 9820.3706; train_edge_recon_loss: 1353252.3025; train_gene_expr_recon_loss: 2398820.0800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3761892.7600; train_optim_loss: 3761892.7600; val_kl_reg_loss: 9702.9453; val_edge_recon_loss: 1407922.8750; val_gene_expr_recon_loss: 2440098.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3857724.0833; val_optim_loss: 3857724.0833
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8691; val_auprc_score: 0.9452; val_best_acc_score: 0.8375; val_best_f1_score: 0.8957; train_kl_reg_loss: 9812.4112; train_edge_recon_loss: 1344198.5400; train_gene_expr_recon_loss: 2396578.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3750589.1800; train_optim_loss: 3750589.1800; val_kl_reg_loss: 9732.9590; val_edge_recon_loss: 1478793.6667; val_gene_expr_recon_loss: 2487088.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3975615.1667; val_optim_loss: 3975615.1667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8775; val_auprc_score: 0.9496; val_best_acc_score: 0.8375; val_best_f1_score: 0.8950; train_kl_reg_loss: 9845.4110; train_edge_recon_loss: 1383641.8250; train_gene_expr_recon_loss: 2398042.0700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3791529.2800; train_optim_loss: 3791529.2800; val_kl_reg_loss: 9789.5664; val_edge_recon_loss: 1472665.9167; val_gene_expr_recon_loss: 2427285.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3909740.8333; val_optim_loss: 3909740.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8675; val_auprc_score: 0.9327; val_best_acc_score: 0.8400; val_best_f1_score: 0.8961; train_kl_reg_loss: 9841.9742; train_edge_recon_loss: 1297307.2900; train_gene_expr_recon_loss: 2392416.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3699565.4100; train_optim_loss: 3699565.4100; val_kl_reg_loss: 9719.0830; val_edge_recon_loss: 1494386.2500; val_gene_expr_recon_loss: 2398033.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3902138.9167; val_optim_loss: 3902138.9167
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8527; val_auprc_score: 0.9453; val_best_acc_score: 0.8438; val_best_f1_score: 0.9041; train_kl_reg_loss: 9818.4164; train_edge_recon_loss: 1412289.9000; train_gene_expr_recon_loss: 2397619.2100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819727.5400; train_optim_loss: 3819727.5400; val_kl_reg_loss: 9859.0101; val_edge_recon_loss: 1303003.0417; val_gene_expr_recon_loss: 2439156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3752018.0833; val_optim_loss: 3752018.0833
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8796; val_auprc_score: 0.9542; val_best_acc_score: 0.8543; val_best_f1_score: 0.9079; train_kl_reg_loss: 9832.5890; train_edge_recon_loss: 1269310.4350; train_gene_expr_recon_loss: 2402164.7700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3681307.7900; train_optim_loss: 3681307.7900; val_kl_reg_loss: 9816.5231; val_edge_recon_loss: 1353458.5417; val_gene_expr_recon_loss: 2440307.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3803583.0000; val_optim_loss: 3803583.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8578; val_auprc_score: 0.9476; val_best_acc_score: 0.8341; val_best_f1_score: 0.8984; train_kl_reg_loss: 9839.3243; train_edge_recon_loss: 1393849.7000; train_gene_expr_recon_loss: 2399576.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3803265.5900; train_optim_loss: 3803265.5900; val_kl_reg_loss: 9818.0505; val_edge_recon_loss: 1333738.0833; val_gene_expr_recon_loss: 2496920.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3840476.5833; val_optim_loss: 3840476.5833
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8680; val_auprc_score: 0.9499; val_best_acc_score: 0.8379; val_best_f1_score: 0.8976; train_kl_reg_loss: 9795.2741; train_edge_recon_loss: 1353012.4100; train_gene_expr_recon_loss: 2398542.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3761350.1400; train_optim_loss: 3761350.1400; val_kl_reg_loss: 9776.2493; val_edge_recon_loss: 1404696.2083; val_gene_expr_recon_loss: 2471759.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3886232.2500; val_optim_loss: 3886232.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8678; val_auprc_score: 0.9424; val_best_acc_score: 0.8506; val_best_f1_score: 0.9040; train_kl_reg_loss: 9827.1948; train_edge_recon_loss: 1328995.5550; train_gene_expr_recon_loss: 2389689.6500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3728512.3900; train_optim_loss: 3728512.3900; val_kl_reg_loss: 9854.7419; val_edge_recon_loss: 1465330.2500; val_gene_expr_recon_loss: 2414306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3889491.0000; val_optim_loss: 3889491.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8673; val_auprc_score: 0.9479; val_best_acc_score: 0.8370; val_best_f1_score: 0.8950; train_kl_reg_loss: 9797.4427; train_edge_recon_loss: 1303728.1850; train_gene_expr_recon_loss: 2399119.6300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3712645.2600; train_optim_loss: 3712645.2600; val_kl_reg_loss: 9664.0335; val_edge_recon_loss: 1486335.7083; val_gene_expr_recon_loss: 2442237.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3938237.5000; val_optim_loss: 3938237.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8655; val_auprc_score: 0.9458; val_best_acc_score: 0.8357; val_best_f1_score: 0.8946; train_kl_reg_loss: 9778.4587; train_edge_recon_loss: 1415222.9650; train_gene_expr_recon_loss: 2394629.3900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819630.8300; train_optim_loss: 3819630.8300; val_kl_reg_loss: 9661.0934; val_edge_recon_loss: 1492400.5833; val_gene_expr_recon_loss: 2424701.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3926763.5833; val_optim_loss: 3926763.5833
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8699; val_auprc_score: 0.9417; val_best_acc_score: 0.8379; val_best_f1_score: 0.8954; train_kl_reg_loss: 9833.1521; train_edge_recon_loss: 1367887.1300; train_gene_expr_recon_loss: 2405367.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3783088.0800; train_optim_loss: 3783088.0800; val_kl_reg_loss: 9859.6523; val_edge_recon_loss: 1463842.7500; val_gene_expr_recon_loss: 2409067.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3882770.2500; val_optim_loss: 3882770.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8789; val_auprc_score: 0.9491; val_best_acc_score: 0.8479; val_best_f1_score: 0.9028; train_kl_reg_loss: 9809.5377; train_edge_recon_loss: 1378721.8350; train_gene_expr_recon_loss: 2399731.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3788263.2600; train_optim_loss: 3788263.2600; val_kl_reg_loss: 9631.8037; val_edge_recon_loss: 1387859.1667; val_gene_expr_recon_loss: 2411171.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3808662.3333; val_optim_loss: 3808662.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 48 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.8660
val AUPRC score: 0.9426
val best accuracy score: 0.8437
val best F1 score: 0.8995
val target rna MSE score: 0.6459
val source rna MSE score: 0.1444
Val cat covariate0 mean sim diff: 0.0048
Val cat covariate1 mean sim diff: 0.0048
Duration of model training in run 1: 0 hours, 2 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
