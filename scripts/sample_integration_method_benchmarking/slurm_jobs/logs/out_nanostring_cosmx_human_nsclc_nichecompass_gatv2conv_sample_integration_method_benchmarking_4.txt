Run timestamp: 28082023_201718_4.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9828; val_auprc_score: 0.9938; val_best_acc_score: 0.9512; val_best_f1_score: 0.9684; train_kl_reg_loss: 15948.8638; train_edge_recon_loss: 1364637.4838; train_cat_covariates_contrastive_loss: 67139.7243; train_gene_expr_recon_loss: 2771865.3927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4219591.4638; train_optim_loss: 4219591.4638; val_kl_reg_loss: 13974.7762; val_edge_recon_loss: 1335629.8172; val_cat_covariates_contrastive_loss: 67517.9308; val_gene_expr_recon_loss: 2470170.7856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3887293.3053; val_optim_loss: 3887293.3053
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9851; val_auprc_score: 0.9944; val_best_acc_score: 0.9548; val_best_f1_score: 0.9707; train_kl_reg_loss: 16267.6761; train_edge_recon_loss: 1320075.7775; train_cat_covariates_contrastive_loss: 67753.6485; train_gene_expr_recon_loss: 2295934.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3700031.7859; train_optim_loss: 3700031.7859; val_kl_reg_loss: 18137.2412; val_edge_recon_loss: 1340724.7258; val_cat_covariates_contrastive_loss: 67837.9940; val_gene_expr_recon_loss: 2199216.4209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3625916.3953; val_optim_loss: 3625916.3953
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9852; val_auprc_score: 0.9943; val_best_acc_score: 0.9556; val_best_f1_score: 0.9711; train_kl_reg_loss: 18940.3385; train_edge_recon_loss: 1318313.6893; train_cat_covariates_contrastive_loss: 67916.4768; train_gene_expr_recon_loss: 2119176.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3524347.4860; train_optim_loss: 3524347.4860; val_kl_reg_loss: 20163.5374; val_edge_recon_loss: 1333032.9205; val_cat_covariates_contrastive_loss: 67850.8039; val_gene_expr_recon_loss: 2075834.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3496881.9219; val_optim_loss: 3496881.9219
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9872; val_auprc_score: 0.9952; val_best_acc_score: 0.9590; val_best_f1_score: 0.9733; train_kl_reg_loss: 20240.4268; train_edge_recon_loss: 1317547.1525; train_cat_covariates_contrastive_loss: 68000.8627; train_gene_expr_recon_loss: 2047069.7976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3452858.2456; train_optim_loss: 3452858.2456; val_kl_reg_loss: 21296.9363; val_edge_recon_loss: 1332716.2228; val_cat_covariates_contrastive_loss: 67857.2095; val_gene_expr_recon_loss: 2038027.0771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3459897.4516; val_optim_loss: 3459897.4516
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9873; val_auprc_score: 0.9953; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 21057.1307; train_edge_recon_loss: 1314436.1978; train_cat_covariates_contrastive_loss: 68025.2094; train_gene_expr_recon_loss: 2013494.0255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3417012.5687; train_optim_loss: 3417012.5687; val_kl_reg_loss: 21520.2684; val_edge_recon_loss: 1327624.5766; val_cat_covariates_contrastive_loss: 68232.5727; val_gene_expr_recon_loss: 2012184.5287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3429561.9486; val_optim_loss: 3429561.9486
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9876; val_auprc_score: 0.9951; val_best_acc_score: 0.9614; val_best_f1_score: 0.9749; train_kl_reg_loss: 21679.6988; train_edge_recon_loss: 1317126.3143; train_cat_covariates_contrastive_loss: 68030.4791; train_gene_expr_recon_loss: 1990843.1566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3397679.6478; train_optim_loss: 3397679.6478; val_kl_reg_loss: 21416.9699; val_edge_recon_loss: 1336516.9699; val_cat_covariates_contrastive_loss: 67977.6331; val_gene_expr_recon_loss: 1988838.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3414749.7796; val_optim_loss: 3414749.7796
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9878; val_auprc_score: 0.9954; val_best_acc_score: 0.9600; val_best_f1_score: 0.9740; train_kl_reg_loss: 22154.2171; train_edge_recon_loss: 1313495.9411; train_cat_covariates_contrastive_loss: 68033.4525; train_gene_expr_recon_loss: 1978330.9087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382014.5204; train_optim_loss: 3382014.5204; val_kl_reg_loss: 22480.5919; val_edge_recon_loss: 1326400.6453; val_cat_covariates_contrastive_loss: 68150.8762; val_gene_expr_recon_loss: 1979059.6418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3396091.7559; val_optim_loss: 3396091.7559
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9874; val_auprc_score: 0.9950; val_best_acc_score: 0.9597; val_best_f1_score: 0.9738; train_kl_reg_loss: 22493.4501; train_edge_recon_loss: 1315284.4463; train_cat_covariates_contrastive_loss: 68176.8940; train_gene_expr_recon_loss: 1967418.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3373373.1327; train_optim_loss: 3373373.1327; val_kl_reg_loss: 22943.3439; val_edge_recon_loss: 1328886.6265; val_cat_covariates_contrastive_loss: 68251.1153; val_gene_expr_recon_loss: 1979484.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3399565.5889; val_optim_loss: 3399565.5889
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9879; val_auprc_score: 0.9955; val_best_acc_score: 0.9617; val_best_f1_score: 0.9751; train_kl_reg_loss: 23021.2231; train_edge_recon_loss: 1315108.0593; train_cat_covariates_contrastive_loss: 68182.0308; train_gene_expr_recon_loss: 1956228.4113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3362539.7245; train_optim_loss: 3362539.7245; val_kl_reg_loss: 23356.2554; val_edge_recon_loss: 1328430.0010; val_cat_covariates_contrastive_loss: 68119.0876; val_gene_expr_recon_loss: 1959160.4012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379065.7530; val_optim_loss: 3379065.7530
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9889; val_auprc_score: 0.9955; val_best_acc_score: 0.9629; val_best_f1_score: 0.9758; train_kl_reg_loss: 23335.2951; train_edge_recon_loss: 1314629.4825; train_cat_covariates_contrastive_loss: 68248.3598; train_gene_expr_recon_loss: 1949987.7014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3356200.8370; train_optim_loss: 3356200.8370; val_kl_reg_loss: 23661.2641; val_edge_recon_loss: 1341590.4106; val_cat_covariates_contrastive_loss: 68411.7566; val_gene_expr_recon_loss: 1969596.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3403260.3458; val_optim_loss: 3403260.3458
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9897; val_auprc_score: 0.9961; val_best_acc_score: 0.9632; val_best_f1_score: 0.9760; train_kl_reg_loss: 23646.3620; train_edge_recon_loss: 1316886.5637; train_cat_covariates_contrastive_loss: 68304.5199; train_gene_expr_recon_loss: 1941642.8708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3350480.3196; train_optim_loss: 3350480.3196; val_kl_reg_loss: 23933.2353; val_edge_recon_loss: 1324809.3878; val_cat_covariates_contrastive_loss: 68911.1126; val_gene_expr_recon_loss: 1954054.7268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3371708.4694; val_optim_loss: 3371708.4694
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9884; val_auprc_score: 0.9954; val_best_acc_score: 0.9628; val_best_f1_score: 0.9758; train_kl_reg_loss: 24003.2139; train_edge_recon_loss: 1317130.8299; train_cat_covariates_contrastive_loss: 68362.4801; train_gene_expr_recon_loss: 1934496.8156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343993.3421; train_optim_loss: 3343993.3421; val_kl_reg_loss: 24557.9298; val_edge_recon_loss: 1322177.2984; val_cat_covariates_contrastive_loss: 68222.1706; val_gene_expr_recon_loss: 1939383.7836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354341.1818; val_optim_loss: 3354341.1818
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9878; val_auprc_score: 0.9951; val_best_acc_score: 0.9622; val_best_f1_score: 0.9754; train_kl_reg_loss: 24400.2395; train_edge_recon_loss: 1315258.1459; train_cat_covariates_contrastive_loss: 68308.2227; train_gene_expr_recon_loss: 1930013.1775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3337979.7882; train_optim_loss: 3337979.7882; val_kl_reg_loss: 24606.4364; val_edge_recon_loss: 1331811.6784; val_cat_covariates_contrastive_loss: 68548.7878; val_gene_expr_recon_loss: 1931388.8241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3356355.7243; val_optim_loss: 3356355.7243
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9888; val_auprc_score: 0.9956; val_best_acc_score: 0.9631; val_best_f1_score: 0.9760; train_kl_reg_loss: 24714.3511; train_edge_recon_loss: 1314866.7478; train_cat_covariates_contrastive_loss: 68312.8151; train_gene_expr_recon_loss: 1923928.5384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3331822.4549; train_optim_loss: 3331822.4549; val_kl_reg_loss: 24328.2622; val_edge_recon_loss: 1322904.6537; val_cat_covariates_contrastive_loss: 68649.6575; val_gene_expr_recon_loss: 1927334.9610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3343217.5287; val_optim_loss: 3343217.5287
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9887; val_auprc_score: 0.9956; val_best_acc_score: 0.9631; val_best_f1_score: 0.9760; train_kl_reg_loss: 24937.6361; train_edge_recon_loss: 1314111.9081; train_cat_covariates_contrastive_loss: 68335.7880; train_gene_expr_recon_loss: 1918081.5808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3325466.9116; train_optim_loss: 3325466.9116; val_kl_reg_loss: 25263.9366; val_edge_recon_loss: 1331785.4303; val_cat_covariates_contrastive_loss: 68352.1285; val_gene_expr_recon_loss: 1931165.8814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3356567.3765; val_optim_loss: 3356567.3765
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9887; val_auprc_score: 0.9956; val_best_acc_score: 0.9620; val_best_f1_score: 0.9753; train_kl_reg_loss: 25069.8502; train_edge_recon_loss: 1317179.9715; train_cat_covariates_contrastive_loss: 68318.8056; train_gene_expr_recon_loss: 1915937.0340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3326505.6631; train_optim_loss: 3326505.6631; val_kl_reg_loss: 25355.8704; val_edge_recon_loss: 1329731.1265; val_cat_covariates_contrastive_loss: 68582.1842; val_gene_expr_recon_loss: 1927073.3592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3350742.5405; val_optim_loss: 3350742.5405
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9883; val_auprc_score: 0.9955; val_best_acc_score: 0.9636; val_best_f1_score: 0.9763; train_kl_reg_loss: 25372.1892; train_edge_recon_loss: 1316228.2186; train_cat_covariates_contrastive_loss: 68414.8639; train_gene_expr_recon_loss: 1910094.1040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3320109.3762; train_optim_loss: 3320109.3762; val_kl_reg_loss: 26342.3934; val_edge_recon_loss: 1322851.8142; val_cat_covariates_contrastive_loss: 68102.8729; val_gene_expr_recon_loss: 1916493.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3333790.4239; val_optim_loss: 3333790.4239
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9884; val_auprc_score: 0.9954; val_best_acc_score: 0.9638; val_best_f1_score: 0.9764; train_kl_reg_loss: 25558.0096; train_edge_recon_loss: 1314994.8454; train_cat_covariates_contrastive_loss: 68297.0738; train_gene_expr_recon_loss: 1909191.9514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3318041.8795; train_optim_loss: 3318041.8795; val_kl_reg_loss: 25624.2890; val_edge_recon_loss: 1323840.6853; val_cat_covariates_contrastive_loss: 68512.2233; val_gene_expr_recon_loss: 1916070.5326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3334047.7194; val_optim_loss: 3334047.7194
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9875; val_auprc_score: 0.9950; val_best_acc_score: 0.9634; val_best_f1_score: 0.9762; train_kl_reg_loss: 25771.8645; train_edge_recon_loss: 1316490.7365; train_cat_covariates_contrastive_loss: 68275.7495; train_gene_expr_recon_loss: 1902775.0129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3313313.3627; train_optim_loss: 3313313.3627; val_kl_reg_loss: 25891.0261; val_edge_recon_loss: 1329913.8350; val_cat_covariates_contrastive_loss: 68334.2390; val_gene_expr_recon_loss: 1909573.7179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3333712.8083; val_optim_loss: 3333712.8083
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9884; val_auprc_score: 0.9955; val_best_acc_score: 0.9629; val_best_f1_score: 0.9758; train_kl_reg_loss: 26103.7346; train_edge_recon_loss: 1316261.9667; train_cat_covariates_contrastive_loss: 68347.7772; train_gene_expr_recon_loss: 1901445.6952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3312159.1755; train_optim_loss: 3312159.1755; val_kl_reg_loss: 25889.4960; val_edge_recon_loss: 1337629.6798; val_cat_covariates_contrastive_loss: 68467.8212; val_gene_expr_recon_loss: 1907124.7011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3339111.6986; val_optim_loss: 3339111.6986
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9890; val_auprc_score: 0.9956; val_best_acc_score: 0.9639; val_best_f1_score: 0.9765; train_kl_reg_loss: 26079.6273; train_edge_recon_loss: 1316437.5825; train_cat_covariates_contrastive_loss: 68318.8057; train_gene_expr_recon_loss: 1898685.8649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3309521.8810; train_optim_loss: 3309521.8810; val_kl_reg_loss: 26246.6121; val_edge_recon_loss: 1333331.8424; val_cat_covariates_contrastive_loss: 68621.1655; val_gene_expr_recon_loss: 1924407.3631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3352606.9832; val_optim_loss: 3352606.9832
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9879; val_auprc_score: 0.9953; val_best_acc_score: 0.9634; val_best_f1_score: 0.9761; train_kl_reg_loss: 26311.2760; train_edge_recon_loss: 1315547.0600; train_cat_covariates_contrastive_loss: 68390.6418; train_gene_expr_recon_loss: 1896855.7664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3307104.7432; train_optim_loss: 3307104.7432; val_kl_reg_loss: 26594.2676; val_edge_recon_loss: 1328665.8098; val_cat_covariates_contrastive_loss: 68119.8306; val_gene_expr_recon_loss: 1903116.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3326496.0287; val_optim_loss: 3326496.0287
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9887; val_auprc_score: 0.9957; val_best_acc_score: 0.9632; val_best_f1_score: 0.9761; train_kl_reg_loss: 26416.8328; train_edge_recon_loss: 1314150.1199; train_cat_covariates_contrastive_loss: 68370.6572; train_gene_expr_recon_loss: 1890062.0555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3298999.6668; train_optim_loss: 3298999.6668; val_kl_reg_loss: 26987.1904; val_edge_recon_loss: 1324747.0069; val_cat_covariates_contrastive_loss: 68553.4765; val_gene_expr_recon_loss: 1899309.2233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3319596.9002; val_optim_loss: 3319596.9002
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9888; val_auprc_score: 0.9956; val_best_acc_score: 0.9638; val_best_f1_score: 0.9765; train_kl_reg_loss: 26691.0217; train_edge_recon_loss: 1315159.9130; train_cat_covariates_contrastive_loss: 68374.8523; train_gene_expr_recon_loss: 1892066.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3302292.6301; train_optim_loss: 3302292.6301; val_kl_reg_loss: 26915.6041; val_edge_recon_loss: 1327281.2544; val_cat_covariates_contrastive_loss: 68460.8254; val_gene_expr_recon_loss: 1898194.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3320851.7905; val_optim_loss: 3320851.7905
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9893; val_auprc_score: 0.9959; val_best_acc_score: 0.9650; val_best_f1_score: 0.9772; train_kl_reg_loss: 27061.9208; train_edge_recon_loss: 1319264.0975; train_cat_covariates_contrastive_loss: 68396.0127; train_gene_expr_recon_loss: 1895332.9009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3310054.9330; train_optim_loss: 3310054.9330; val_kl_reg_loss: 27015.7315; val_edge_recon_loss: 1320416.7307; val_cat_covariates_contrastive_loss: 68825.6273; val_gene_expr_recon_loss: 1902251.9659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318510.0514; val_optim_loss: 3318510.0514
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9888; val_auprc_score: 0.9956; val_best_acc_score: 0.9637; val_best_f1_score: 0.9764; train_kl_reg_loss: 27360.8876; train_edge_recon_loss: 1312434.2036; train_cat_covariates_contrastive_loss: 68462.2978; train_gene_expr_recon_loss: 1888697.2076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3296954.5973; train_optim_loss: 3296954.5973; val_kl_reg_loss: 27750.4483; val_edge_recon_loss: 1317059.6134; val_cat_covariates_contrastive_loss: 68611.8753; val_gene_expr_recon_loss: 1896381.0894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3309803.0208; val_optim_loss: 3309803.0208
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9876; val_auprc_score: 0.9951; val_best_acc_score: 0.9630; val_best_f1_score: 0.9760; train_kl_reg_loss: 27146.7501; train_edge_recon_loss: 1315092.6880; train_cat_covariates_contrastive_loss: 68401.4213; train_gene_expr_recon_loss: 1884813.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3295454.1505; train_optim_loss: 3295454.1505; val_kl_reg_loss: 29084.9152; val_edge_recon_loss: 1327887.4738; val_cat_covariates_contrastive_loss: 68424.3635; val_gene_expr_recon_loss: 1971454.2698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3396851.0217; val_optim_loss: 3396851.0217
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9889; val_auprc_score: 0.9957; val_best_acc_score: 0.9643; val_best_f1_score: 0.9768; train_kl_reg_loss: 27954.8465; train_edge_recon_loss: 1315884.7950; train_cat_covariates_contrastive_loss: 68502.7377; train_gene_expr_recon_loss: 1888998.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301340.8996; train_optim_loss: 3301340.8996; val_kl_reg_loss: 28010.0499; val_edge_recon_loss: 1328397.1502; val_cat_covariates_contrastive_loss: 68715.9621; val_gene_expr_recon_loss: 1894199.2742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3319322.4358; val_optim_loss: 3319322.4358
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9886; val_auprc_score: 0.9956; val_best_acc_score: 0.9648; val_best_f1_score: 0.9771; train_kl_reg_loss: 28924.7993; train_edge_recon_loss: 1315012.1958; train_cat_covariates_contrastive_loss: 68534.9350; train_gene_expr_recon_loss: 1893535.0967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3306007.0260; train_optim_loss: 3306007.0260; val_kl_reg_loss: 28993.2893; val_edge_recon_loss: 1331202.0741; val_cat_covariates_contrastive_loss: 68542.6203; val_gene_expr_recon_loss: 1890479.6744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3319217.6630; val_optim_loss: 3319217.6630
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9883; val_auprc_score: 0.9954; val_best_acc_score: 0.9642; val_best_f1_score: 0.9767; train_kl_reg_loss: 28816.7963; train_edge_recon_loss: 1314441.6945; train_cat_covariates_contrastive_loss: 68619.0946; train_gene_expr_recon_loss: 1883324.2547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3295201.8391; train_optim_loss: 3295201.8391; val_kl_reg_loss: 28603.3840; val_edge_recon_loss: 1327330.9145; val_cat_covariates_contrastive_loss: 68535.1660; val_gene_expr_recon_loss: 1891552.3547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316021.8162; val_optim_loss: 3316021.8162

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9889; val_auprc_score: 0.9955; val_best_acc_score: 0.9648; val_best_f1_score: 0.9770; train_kl_reg_loss: 27695.2049; train_edge_recon_loss: 1313462.5027; train_cat_covariates_contrastive_loss: 68795.4599; train_gene_expr_recon_loss: 1845482.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3255435.9614; train_optim_loss: 3255435.9614; val_kl_reg_loss: 27638.3837; val_edge_recon_loss: 1328609.4921; val_cat_covariates_contrastive_loss: 68788.1369; val_gene_expr_recon_loss: 1860312.3859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3285348.4022; val_optim_loss: 3285348.4022
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9890; val_auprc_score: 0.9956; val_best_acc_score: 0.9653; val_best_f1_score: 0.9775; train_kl_reg_loss: 27467.4700; train_edge_recon_loss: 1313265.5010; train_cat_covariates_contrastive_loss: 68762.2503; train_gene_expr_recon_loss: 1839143.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3248638.7673; train_optim_loss: 3248638.7673; val_kl_reg_loss: 27438.3291; val_edge_recon_loss: 1324544.8483; val_cat_covariates_contrastive_loss: 68860.6996; val_gene_expr_recon_loss: 1855968.4565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3276812.3281; val_optim_loss: 3276812.3281
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9895; val_auprc_score: 0.9960; val_best_acc_score: 0.9662; val_best_f1_score: 0.9780; train_kl_reg_loss: 27075.4419; train_edge_recon_loss: 1311771.9459; train_cat_covariates_contrastive_loss: 68694.6709; train_gene_expr_recon_loss: 1835594.7839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3243136.8407; train_optim_loss: 3243136.8407; val_kl_reg_loss: 27025.4071; val_edge_recon_loss: 1321552.2268; val_cat_covariates_contrastive_loss: 68728.9645; val_gene_expr_recon_loss: 1856128.2974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3273434.9002; val_optim_loss: 3273434.9002
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9898; val_auprc_score: 0.9959; val_best_acc_score: 0.9660; val_best_f1_score: 0.9779; train_kl_reg_loss: 26580.4497; train_edge_recon_loss: 1313717.5319; train_cat_covariates_contrastive_loss: 68622.5040; train_gene_expr_recon_loss: 1834331.5557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3243252.0443; train_optim_loss: 3243252.0443; val_kl_reg_loss: 26494.5780; val_edge_recon_loss: 1322273.8345; val_cat_covariates_contrastive_loss: 68691.3907; val_gene_expr_recon_loss: 1853564.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3271023.8577; val_optim_loss: 3271023.8577
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9900; val_auprc_score: 0.9961; val_best_acc_score: 0.9658; val_best_f1_score: 0.9778; train_kl_reg_loss: 26412.9118; train_edge_recon_loss: 1310975.0002; train_cat_covariates_contrastive_loss: 68590.7737; train_gene_expr_recon_loss: 1832707.1931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238685.8788; train_optim_loss: 3238685.8788; val_kl_reg_loss: 26334.9702; val_edge_recon_loss: 1318078.8207; val_cat_covariates_contrastive_loss: 68720.8819; val_gene_expr_recon_loss: 1852421.4560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265556.1304; val_optim_loss: 3265556.1304
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9895; val_auprc_score: 0.9959; val_best_acc_score: 0.9661; val_best_f1_score: 0.9780; train_kl_reg_loss: 26226.0086; train_edge_recon_loss: 1314869.8586; train_cat_covariates_contrastive_loss: 68629.4539; train_gene_expr_recon_loss: 1831203.5971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3240928.9170; train_optim_loss: 3240928.9170; val_kl_reg_loss: 26041.2794; val_edge_recon_loss: 1320735.4807; val_cat_covariates_contrastive_loss: 68616.3759; val_gene_expr_recon_loss: 1849945.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265338.1858; val_optim_loss: 3265338.1858
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9897; val_auprc_score: 0.9960; val_best_acc_score: 0.9662; val_best_f1_score: 0.9780; train_kl_reg_loss: 26014.9091; train_edge_recon_loss: 1312401.5051; train_cat_covariates_contrastive_loss: 68566.6611; train_gene_expr_recon_loss: 1830855.2789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3237838.3533; train_optim_loss: 3237838.3533; val_kl_reg_loss: 25699.9003; val_edge_recon_loss: 1322673.2228; val_cat_covariates_contrastive_loss: 68846.3513; val_gene_expr_recon_loss: 1849659.2016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3266878.6818; val_optim_loss: 3266878.6818
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9897; val_auprc_score: 0.9960; val_best_acc_score: 0.9662; val_best_f1_score: 0.9780; train_kl_reg_loss: 25814.0000; train_edge_recon_loss: 1311357.7682; train_cat_covariates_contrastive_loss: 68571.7159; train_gene_expr_recon_loss: 1829751.3649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3235494.8472; train_optim_loss: 3235494.8472; val_kl_reg_loss: 25691.7069; val_edge_recon_loss: 1318856.6709; val_cat_covariates_contrastive_loss: 68644.2179; val_gene_expr_recon_loss: 1849935.5672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263128.1690; val_optim_loss: 3263128.1690
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9898; val_auprc_score: 0.9960; val_best_acc_score: 0.9666; val_best_f1_score: 0.9782; train_kl_reg_loss: 25564.2264; train_edge_recon_loss: 1310874.5980; train_cat_covariates_contrastive_loss: 68492.5226; train_gene_expr_recon_loss: 1829587.1694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234518.5164; train_optim_loss: 3234518.5164; val_kl_reg_loss: 25495.8424; val_edge_recon_loss: 1317560.1324; val_cat_covariates_contrastive_loss: 68758.7253; val_gene_expr_recon_loss: 1848276.5771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3260091.2836; val_optim_loss: 3260091.2836
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9891; val_auprc_score: 0.9955; val_best_acc_score: 0.9655; val_best_f1_score: 0.9776; train_kl_reg_loss: 25453.2130; train_edge_recon_loss: 1311061.0560; train_cat_covariates_contrastive_loss: 68445.0875; train_gene_expr_recon_loss: 1828652.1919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3233611.5473; train_optim_loss: 3233611.5473; val_kl_reg_loss: 25325.6165; val_edge_recon_loss: 1326354.4773; val_cat_covariates_contrastive_loss: 68464.8702; val_gene_expr_recon_loss: 1847669.6319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3267814.5919; val_optim_loss: 3267814.5919
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9898; val_auprc_score: 0.9960; val_best_acc_score: 0.9672; val_best_f1_score: 0.9786; train_kl_reg_loss: 25245.5958; train_edge_recon_loss: 1310772.8143; train_cat_covariates_contrastive_loss: 68416.2630; train_gene_expr_recon_loss: 1827754.0641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3232188.7358; train_optim_loss: 3232188.7358; val_kl_reg_loss: 25101.0250; val_edge_recon_loss: 1322979.5756; val_cat_covariates_contrastive_loss: 68613.7141; val_gene_expr_recon_loss: 1848166.4708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3264860.7866; val_optim_loss: 3264860.7866
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9891; val_auprc_score: 0.9957; val_best_acc_score: 0.9649; val_best_f1_score: 0.9772; train_kl_reg_loss: 25101.0688; train_edge_recon_loss: 1311430.8067; train_cat_covariates_contrastive_loss: 68435.5123; train_gene_expr_recon_loss: 1827714.0468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3232681.4354; train_optim_loss: 3232681.4354; val_kl_reg_loss: 25155.4946; val_edge_recon_loss: 1326331.8103; val_cat_covariates_contrastive_loss: 68250.7594; val_gene_expr_recon_loss: 1848638.5005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3268376.5662; val_optim_loss: 3268376.5662
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9892; val_auprc_score: 0.9957; val_best_acc_score: 0.9664; val_best_f1_score: 0.9782; train_kl_reg_loss: 24922.6078; train_edge_recon_loss: 1312190.0361; train_cat_covariates_contrastive_loss: 68357.0632; train_gene_expr_recon_loss: 1826242.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231712.1803; train_optim_loss: 3231712.1803; val_kl_reg_loss: 24618.5153; val_edge_recon_loss: 1318376.9318; val_cat_covariates_contrastive_loss: 68538.0131; val_gene_expr_recon_loss: 1846009.4545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3257542.9111; val_optim_loss: 3257542.9111
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9894; val_auprc_score: 0.9956; val_best_acc_score: 0.9667; val_best_f1_score: 0.9784; train_kl_reg_loss: 24747.7792; train_edge_recon_loss: 1310051.1680; train_cat_covariates_contrastive_loss: 68320.3875; train_gene_expr_recon_loss: 1826507.6827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3229627.0156; train_optim_loss: 3229627.0156; val_kl_reg_loss: 24908.3417; val_edge_recon_loss: 1318504.7446; val_cat_covariates_contrastive_loss: 68341.8492; val_gene_expr_recon_loss: 1846761.6285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258516.5623; val_optim_loss: 3258516.5623
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9894; val_auprc_score: 0.9958; val_best_acc_score: 0.9664; val_best_f1_score: 0.9782; train_kl_reg_loss: 24719.6539; train_edge_recon_loss: 1307773.7619; train_cat_covariates_contrastive_loss: 68258.5004; train_gene_expr_recon_loss: 1825959.3608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3226711.2777; train_optim_loss: 3226711.2777; val_kl_reg_loss: 24561.9407; val_edge_recon_loss: 1317663.0731; val_cat_covariates_contrastive_loss: 68436.9486; val_gene_expr_recon_loss: 1848253.2495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258915.2134; val_optim_loss: 3258915.2134
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9898; val_auprc_score: 0.9959; val_best_acc_score: 0.9665; val_best_f1_score: 0.9782; train_kl_reg_loss: 24541.0360; train_edge_recon_loss: 1310510.5277; train_cat_covariates_contrastive_loss: 68279.0525; train_gene_expr_recon_loss: 1825718.4853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3229049.0993; train_optim_loss: 3229049.0993; val_kl_reg_loss: 24370.0554; val_edge_recon_loss: 1326094.5212; val_cat_covariates_contrastive_loss: 68414.9674; val_gene_expr_recon_loss: 1845296.5721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3264176.1107; val_optim_loss: 3264176.1107
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9894; val_auprc_score: 0.9958; val_best_acc_score: 0.9664; val_best_f1_score: 0.9781; train_kl_reg_loss: 24429.8721; train_edge_recon_loss: 1308607.8231; train_cat_covariates_contrastive_loss: 68209.0944; train_gene_expr_recon_loss: 1824655.4793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3225902.2641; train_optim_loss: 3225902.2641; val_kl_reg_loss: 24313.4629; val_edge_recon_loss: 1323236.2327; val_cat_covariates_contrastive_loss: 68320.0185; val_gene_expr_recon_loss: 1844760.4308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3260630.1571; val_optim_loss: 3260630.1571

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9898; val_auprc_score: 0.9961; val_best_acc_score: 0.9668; val_best_f1_score: 0.9785; train_kl_reg_loss: 24213.9341; train_edge_recon_loss: 1309494.4564; train_cat_covariates_contrastive_loss: 68239.2856; train_gene_expr_recon_loss: 1820554.0663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222501.7425; train_optim_loss: 3222501.7425; val_kl_reg_loss: 24330.2561; val_edge_recon_loss: 1310876.1868; val_cat_covariates_contrastive_loss: 68296.9584; val_gene_expr_recon_loss: 1842612.7535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3246116.1482; val_optim_loss: 3246116.1482
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9899; val_auprc_score: 0.9961; val_best_acc_score: 0.9671; val_best_f1_score: 0.9786; train_kl_reg_loss: 24262.1871; train_edge_recon_loss: 1309388.8015; train_cat_covariates_contrastive_loss: 68215.3465; train_gene_expr_recon_loss: 1820885.8776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222752.2143; train_optim_loss: 3222752.2143; val_kl_reg_loss: 24327.4869; val_edge_recon_loss: 1317752.7376; val_cat_covariates_contrastive_loss: 68306.2824; val_gene_expr_recon_loss: 1843289.1932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3253675.6947; val_optim_loss: 3253675.6947
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9898; val_auprc_score: 0.9959; val_best_acc_score: 0.9672; val_best_f1_score: 0.9786; train_kl_reg_loss: 24268.5365; train_edge_recon_loss: 1312171.7906; train_cat_covariates_contrastive_loss: 68220.3447; train_gene_expr_recon_loss: 1819486.8692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224147.5382; train_optim_loss: 3224147.5382; val_kl_reg_loss: 24317.4488; val_edge_recon_loss: 1320136.6369; val_cat_covariates_contrastive_loss: 68294.4123; val_gene_expr_recon_loss: 1842198.2816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3254946.7905; val_optim_loss: 3254946.7905
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9896; val_auprc_score: 0.9957; val_best_acc_score: 0.9669; val_best_f1_score: 0.9785; train_kl_reg_loss: 24260.0742; train_edge_recon_loss: 1310039.3993; train_cat_covariates_contrastive_loss: 68232.6970; train_gene_expr_recon_loss: 1820326.1598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222858.3273; train_optim_loss: 3222858.3273; val_kl_reg_loss: 24291.9410; val_edge_recon_loss: 1326705.1087; val_cat_covariates_contrastive_loss: 68381.1235; val_gene_expr_recon_loss: 1841606.1660; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3260984.3291; val_optim_loss: 3260984.3291
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9901; val_auprc_score: 0.9961; val_best_acc_score: 0.9669; val_best_f1_score: 0.9785; train_kl_reg_loss: 24227.7620; train_edge_recon_loss: 1312186.6760; train_cat_covariates_contrastive_loss: 68225.7714; train_gene_expr_recon_loss: 1819741.7799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224381.9905; train_optim_loss: 3224381.9905; val_kl_reg_loss: 24262.0776; val_edge_recon_loss: 1312423.5015; val_cat_covariates_contrastive_loss: 68370.5639; val_gene_expr_recon_loss: 1842139.9516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3247196.1047; val_optim_loss: 3247196.1047

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9893; val_auprc_score: 0.9957; val_best_acc_score: 0.9661; val_best_f1_score: 0.9779; train_kl_reg_loss: 24227.4758; train_edge_recon_loss: 1310115.4739; train_cat_covariates_contrastive_loss: 68218.4660; train_gene_expr_recon_loss: 1819267.0265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3221828.4468; train_optim_loss: 3221828.4468; val_kl_reg_loss: 24261.0534; val_edge_recon_loss: 1324032.0672; val_cat_covariates_contrastive_loss: 68272.7263; val_gene_expr_recon_loss: 1842990.3923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3259556.2273; val_optim_loss: 3259556.2273
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9893; val_auprc_score: 0.9958; val_best_acc_score: 0.9661; val_best_f1_score: 0.9780; train_kl_reg_loss: 24209.8625; train_edge_recon_loss: 1311261.0166; train_cat_covariates_contrastive_loss: 68265.6218; train_gene_expr_recon_loss: 1819485.9430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223222.4436; train_optim_loss: 3223222.4436; val_kl_reg_loss: 24236.1615; val_edge_recon_loss: 1325061.0909; val_cat_covariates_contrastive_loss: 68238.3987; val_gene_expr_recon_loss: 1843782.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3261317.7787; val_optim_loss: 3261317.7787
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9903; val_auprc_score: 0.9963; val_best_acc_score: 0.9673; val_best_f1_score: 0.9787; train_kl_reg_loss: 24201.1837; train_edge_recon_loss: 1309734.0197; train_cat_covariates_contrastive_loss: 68250.5437; train_gene_expr_recon_loss: 1819126.4276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3221312.1749; train_optim_loss: 3221312.1749; val_kl_reg_loss: 24244.8894; val_edge_recon_loss: 1321081.3458; val_cat_covariates_contrastive_loss: 68351.0697; val_gene_expr_recon_loss: 1841294.2095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3254971.5247; val_optim_loss: 3254971.5247
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9904; val_auprc_score: 0.9961; val_best_acc_score: 0.9676; val_best_f1_score: 0.9789; train_kl_reg_loss: 24203.2809; train_edge_recon_loss: 1308334.4297; train_cat_covariates_contrastive_loss: 68241.2979; train_gene_expr_recon_loss: 1819642.9575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3220421.9614; train_optim_loss: 3220421.9614; val_kl_reg_loss: 24232.5782; val_edge_recon_loss: 1316918.1383; val_cat_covariates_contrastive_loss: 68419.7438; val_gene_expr_recon_loss: 1842302.8636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3251873.3350; val_optim_loss: 3251873.3350

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1114 min 5 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9682
val AUPRC score: 0.9844
val best accuracy score: 0.9552
val best F1 score: 0.9706
val target rna MSE score: 0.5397
val source rna MSE score: 0.0853
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.1048
Duration of model training in run 2: 18 hours, 38 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
