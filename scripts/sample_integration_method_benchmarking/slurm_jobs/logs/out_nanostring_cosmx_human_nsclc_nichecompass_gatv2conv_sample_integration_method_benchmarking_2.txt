Run timestamp: 28082023_201718_2.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '10000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9781; val_auprc_score: 0.9920; val_best_acc_score: 0.9446; val_best_f1_score: 0.9639; train_kl_reg_loss: 16236.7138; train_edge_recon_loss: 1371414.2927; train_cat_covariates_contrastive_loss: 6682.1032; train_gene_expr_recon_loss: 2756248.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4150581.1833; train_optim_loss: 4150581.1833; val_kl_reg_loss: 14454.6192; val_edge_recon_loss: 1339608.4200; val_cat_covariates_contrastive_loss: 6747.9891; val_gene_expr_recon_loss: 2439399.3123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3800210.3399; val_optim_loss: 3800210.3399
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9835; val_auprc_score: 0.9940; val_best_acc_score: 0.9522; val_best_f1_score: 0.9688; train_kl_reg_loss: 15998.4674; train_edge_recon_loss: 1321290.6127; train_cat_covariates_contrastive_loss: 6772.6784; train_gene_expr_recon_loss: 2276317.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3620378.9003; train_optim_loss: 3620378.9003; val_kl_reg_loss: 17352.2570; val_edge_recon_loss: 1328302.3691; val_cat_covariates_contrastive_loss: 6826.2705; val_gene_expr_recon_loss: 2157789.9249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3510270.8123; val_optim_loss: 3510270.8123
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9837; val_auprc_score: 0.9940; val_best_acc_score: 0.9536; val_best_f1_score: 0.9696; train_kl_reg_loss: 18461.5043; train_edge_recon_loss: 1316950.9484; train_cat_covariates_contrastive_loss: 6799.3103; train_gene_expr_recon_loss: 2104212.5055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3446424.2655; train_optim_loss: 3446424.2655; val_kl_reg_loss: 19004.1371; val_edge_recon_loss: 1329496.2213; val_cat_covariates_contrastive_loss: 6824.5633; val_gene_expr_recon_loss: 2062020.2589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3417345.1828; val_optim_loss: 3417345.1828
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9857; val_auprc_score: 0.9946; val_best_acc_score: 0.9570; val_best_f1_score: 0.9719; train_kl_reg_loss: 19706.2446; train_edge_recon_loss: 1317990.3782; train_cat_covariates_contrastive_loss: 6817.4789; train_gene_expr_recon_loss: 2036911.1274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3381425.2285; train_optim_loss: 3381425.2285; val_kl_reg_loss: 20220.9313; val_edge_recon_loss: 1324054.6462; val_cat_covariates_contrastive_loss: 6853.3946; val_gene_expr_recon_loss: 2028132.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379261.3152; val_optim_loss: 3379261.3152
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9858; val_auprc_score: 0.9948; val_best_acc_score: 0.9564; val_best_f1_score: 0.9715; train_kl_reg_loss: 20477.7905; train_edge_recon_loss: 1317155.8645; train_cat_covariates_contrastive_loss: 6828.3436; train_gene_expr_recon_loss: 2004459.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3348921.2147; train_optim_loss: 3348921.2147; val_kl_reg_loss: 20615.7711; val_edge_recon_loss: 1331156.9867; val_cat_covariates_contrastive_loss: 6884.6318; val_gene_expr_recon_loss: 2007493.5440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366150.9368; val_optim_loss: 3366150.9368
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9872; val_auprc_score: 0.9953; val_best_acc_score: 0.9585; val_best_f1_score: 0.9729; train_kl_reg_loss: 20932.0293; train_edge_recon_loss: 1316539.7316; train_cat_covariates_contrastive_loss: 6861.4499; train_gene_expr_recon_loss: 1984072.0282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328405.2388; train_optim_loss: 3328405.2388; val_kl_reg_loss: 21788.2138; val_edge_recon_loss: 1323436.9511; val_cat_covariates_contrastive_loss: 6887.0462; val_gene_expr_recon_loss: 1985774.5183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3337886.7243; val_optim_loss: 3337886.7243
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9874; val_auprc_score: 0.9952; val_best_acc_score: 0.9596; val_best_f1_score: 0.9734; train_kl_reg_loss: 21463.6939; train_edge_recon_loss: 1314388.3786; train_cat_covariates_contrastive_loss: 6871.6817; train_gene_expr_recon_loss: 1971175.5319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3313899.2876; train_optim_loss: 3313899.2876; val_kl_reg_loss: 21935.8777; val_edge_recon_loss: 1333909.2653; val_cat_covariates_contrastive_loss: 6893.5164; val_gene_expr_recon_loss: 1972432.0548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3335170.7213; val_optim_loss: 3335170.7213
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9863; val_auprc_score: 0.9947; val_best_acc_score: 0.9585; val_best_f1_score: 0.9727; train_kl_reg_loss: 21801.5599; train_edge_recon_loss: 1316293.0304; train_cat_covariates_contrastive_loss: 6891.0494; train_gene_expr_recon_loss: 1959605.7741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3304591.4142; train_optim_loss: 3304591.4142; val_kl_reg_loss: 22643.4123; val_edge_recon_loss: 1334541.3409; val_cat_covariates_contrastive_loss: 6871.7346; val_gene_expr_recon_loss: 1965347.9620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3329404.4595; val_optim_loss: 3329404.4595
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9883; val_auprc_score: 0.9955; val_best_acc_score: 0.9615; val_best_f1_score: 0.9747; train_kl_reg_loss: 22270.0558; train_edge_recon_loss: 1315065.7510; train_cat_covariates_contrastive_loss: 6903.6043; train_gene_expr_recon_loss: 1951425.4208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3295664.8325; train_optim_loss: 3295664.8325; val_kl_reg_loss: 22583.0740; val_edge_recon_loss: 1333315.0672; val_cat_covariates_contrastive_loss: 6920.1373; val_gene_expr_recon_loss: 1954053.4417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316871.7283; val_optim_loss: 3316871.7283
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9889; val_auprc_score: 0.9958; val_best_acc_score: 0.9614; val_best_f1_score: 0.9746; train_kl_reg_loss: 22575.7609; train_edge_recon_loss: 1316082.5454; train_cat_covariates_contrastive_loss: 6914.9631; train_gene_expr_recon_loss: 1941928.8773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3287502.1417; train_optim_loss: 3287502.1417; val_kl_reg_loss: 22388.3384; val_edge_recon_loss: 1330276.6243; val_cat_covariates_contrastive_loss: 6975.3692; val_gene_expr_recon_loss: 1949120.5306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3308760.8567; val_optim_loss: 3308760.8567
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9880; val_auprc_score: 0.9955; val_best_acc_score: 0.9608; val_best_f1_score: 0.9743; train_kl_reg_loss: 22975.1726; train_edge_recon_loss: 1315457.5527; train_cat_covariates_contrastive_loss: 6922.4312; train_gene_expr_recon_loss: 1937073.9442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3282429.1002; train_optim_loss: 3282429.1002; val_kl_reg_loss: 22782.1987; val_edge_recon_loss: 1330903.8379; val_cat_covariates_contrastive_loss: 6983.0305; val_gene_expr_recon_loss: 1951131.7159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3311800.7816; val_optim_loss: 3311800.7816
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9890; val_auprc_score: 0.9959; val_best_acc_score: 0.9625; val_best_f1_score: 0.9754; train_kl_reg_loss: 23316.3727; train_edge_recon_loss: 1315527.2307; train_cat_covariates_contrastive_loss: 6936.8638; train_gene_expr_recon_loss: 1928163.3387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3273943.8063; train_optim_loss: 3273943.8063; val_kl_reg_loss: 23379.5926; val_edge_recon_loss: 1324852.4862; val_cat_covariates_contrastive_loss: 6968.8014; val_gene_expr_recon_loss: 1929870.9995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3285071.8745; val_optim_loss: 3285071.8745
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9885; val_auprc_score: 0.9956; val_best_acc_score: 0.9611; val_best_f1_score: 0.9745; train_kl_reg_loss: 23565.3366; train_edge_recon_loss: 1314691.1518; train_cat_covariates_contrastive_loss: 6939.2620; train_gene_expr_recon_loss: 1926186.7095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3271382.4598; train_optim_loss: 3271382.4598; val_kl_reg_loss: 23803.1279; val_edge_recon_loss: 1333356.7979; val_cat_covariates_contrastive_loss: 7009.0052; val_gene_expr_recon_loss: 1934158.0578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3298326.9970; val_optim_loss: 3298326.9970
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9888; val_auprc_score: 0.9957; val_best_acc_score: 0.9629; val_best_f1_score: 0.9756; train_kl_reg_loss: 23923.3899; train_edge_recon_loss: 1313436.7409; train_cat_covariates_contrastive_loss: 6949.0503; train_gene_expr_recon_loss: 1919071.9149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3263381.0921; train_optim_loss: 3263381.0921; val_kl_reg_loss: 24470.9968; val_edge_recon_loss: 1328812.1275; val_cat_covariates_contrastive_loss: 6945.8664; val_gene_expr_recon_loss: 1922297.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3282526.6986; val_optim_loss: 3282526.6986
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9901; val_auprc_score: 0.9962; val_best_acc_score: 0.9645; val_best_f1_score: 0.9766; train_kl_reg_loss: 24187.8441; train_edge_recon_loss: 1316581.7611; train_cat_covariates_contrastive_loss: 6967.3949; train_gene_expr_recon_loss: 1917006.1831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3264743.1802; train_optim_loss: 3264743.1802; val_kl_reg_loss: 24341.5295; val_edge_recon_loss: 1333451.1551; val_cat_covariates_contrastive_loss: 7027.9569; val_gene_expr_recon_loss: 1923760.8859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3288581.5326; val_optim_loss: 3288581.5326
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9896; val_auprc_score: 0.9960; val_best_acc_score: 0.9636; val_best_f1_score: 0.9761; train_kl_reg_loss: 24382.0547; train_edge_recon_loss: 1316736.6757; train_cat_covariates_contrastive_loss: 6973.5625; train_gene_expr_recon_loss: 1909921.7021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3258013.9921; train_optim_loss: 3258013.9921; val_kl_reg_loss: 24519.6600; val_edge_recon_loss: 1333896.7243; val_cat_covariates_contrastive_loss: 7034.1860; val_gene_expr_recon_loss: 1917530.2910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3282980.8706; val_optim_loss: 3282980.8706
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9892; val_auprc_score: 0.9959; val_best_acc_score: 0.9623; val_best_f1_score: 0.9752; train_kl_reg_loss: 24708.3664; train_edge_recon_loss: 1316317.1975; train_cat_covariates_contrastive_loss: 6987.1312; train_gene_expr_recon_loss: 1908912.3825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3256925.0749; train_optim_loss: 3256925.0749; val_kl_reg_loss: 25803.3660; val_edge_recon_loss: 1327429.6023; val_cat_covariates_contrastive_loss: 6990.9935; val_gene_expr_recon_loss: 1920258.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3280482.1571; val_optim_loss: 3280482.1571
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9897; val_auprc_score: 0.9962; val_best_acc_score: 0.9632; val_best_f1_score: 0.9758; train_kl_reg_loss: 24990.4957; train_edge_recon_loss: 1314078.6810; train_cat_covariates_contrastive_loss: 6987.4227; train_gene_expr_recon_loss: 1906131.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3252188.5783; train_optim_loss: 3252188.5783; val_kl_reg_loss: 25008.7984; val_edge_recon_loss: 1330549.8962; val_cat_covariates_contrastive_loss: 7063.4600; val_gene_expr_recon_loss: 1915092.0267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3277714.1700; val_optim_loss: 3277714.1700
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9903; val_auprc_score: 0.9965; val_best_acc_score: 0.9635; val_best_f1_score: 0.9760; train_kl_reg_loss: 25426.1559; train_edge_recon_loss: 1315843.9147; train_cat_covariates_contrastive_loss: 7005.3564; train_gene_expr_recon_loss: 1902096.4113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3250371.8382; train_optim_loss: 3250371.8382; val_kl_reg_loss: 24946.3727; val_edge_recon_loss: 1335160.0203; val_cat_covariates_contrastive_loss: 7072.8595; val_gene_expr_recon_loss: 1905320.2574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272499.5020; val_optim_loss: 3272499.5020
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9894; val_auprc_score: 0.9960; val_best_acc_score: 0.9641; val_best_f1_score: 0.9764; train_kl_reg_loss: 25263.3493; train_edge_recon_loss: 1315386.7859; train_cat_covariates_contrastive_loss: 7001.0768; train_gene_expr_recon_loss: 1900501.3921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3248152.6011; train_optim_loss: 3248152.6011; val_kl_reg_loss: 26202.5329; val_edge_recon_loss: 1329115.5420; val_cat_covariates_contrastive_loss: 6997.9439; val_gene_expr_recon_loss: 1907941.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3270257.9921; val_optim_loss: 3270257.9921
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9896; val_auprc_score: 0.9961; val_best_acc_score: 0.9644; val_best_f1_score: 0.9767; train_kl_reg_loss: 25514.9857; train_edge_recon_loss: 1313874.8668; train_cat_covariates_contrastive_loss: 7011.6548; train_gene_expr_recon_loss: 1894910.0245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3241311.5328; train_optim_loss: 3241311.5328; val_kl_reg_loss: 25781.0618; val_edge_recon_loss: 1326724.1018; val_cat_covariates_contrastive_loss: 7033.8866; val_gene_expr_recon_loss: 1904415.1359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263954.1907; val_optim_loss: 3263954.1907
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9905; val_auprc_score: 0.9964; val_best_acc_score: 0.9644; val_best_f1_score: 0.9765; train_kl_reg_loss: 25873.0083; train_edge_recon_loss: 1315038.1562; train_cat_covariates_contrastive_loss: 7024.7539; train_gene_expr_recon_loss: 1892695.9737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3240631.8920; train_optim_loss: 3240631.8920; val_kl_reg_loss: 28063.7077; val_edge_recon_loss: 1326020.7950; val_cat_covariates_contrastive_loss: 7052.4418; val_gene_expr_recon_loss: 1901885.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263022.2283; val_optim_loss: 3263022.2283
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9899; val_auprc_score: 0.9961; val_best_acc_score: 0.9651; val_best_f1_score: 0.9771; train_kl_reg_loss: 26514.8284; train_edge_recon_loss: 1315408.0042; train_cat_covariates_contrastive_loss: 7027.6855; train_gene_expr_recon_loss: 1895498.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3244449.4784; train_optim_loss: 3244449.4784; val_kl_reg_loss: 26539.9650; val_edge_recon_loss: 1332372.9027; val_cat_covariates_contrastive_loss: 7063.8847; val_gene_expr_recon_loss: 1900874.8360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3266851.5968; val_optim_loss: 3266851.5968
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9903; val_auprc_score: 0.9962; val_best_acc_score: 0.9647; val_best_f1_score: 0.9767; train_kl_reg_loss: 26490.2567; train_edge_recon_loss: 1313573.8319; train_cat_covariates_contrastive_loss: 7036.0282; train_gene_expr_recon_loss: 1891581.7519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238681.8700; train_optim_loss: 3238681.8700; val_kl_reg_loss: 26652.9761; val_edge_recon_loss: 1335343.6161; val_cat_covariates_contrastive_loss: 7059.1283; val_gene_expr_recon_loss: 1897001.3300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3266057.0553; val_optim_loss: 3266057.0553
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9907; val_auprc_score: 0.9966; val_best_acc_score: 0.9651; val_best_f1_score: 0.9771; train_kl_reg_loss: 26915.1696; train_edge_recon_loss: 1316291.8705; train_cat_covariates_contrastive_loss: 7042.3978; train_gene_expr_recon_loss: 1888212.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238461.8701; train_optim_loss: 3238461.8701; val_kl_reg_loss: 25993.6314; val_edge_recon_loss: 1321736.3602; val_cat_covariates_contrastive_loss: 7094.2708; val_gene_expr_recon_loss: 1898818.4417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3253642.7045; val_optim_loss: 3253642.7045
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9907; val_auprc_score: 0.9965; val_best_acc_score: 0.9647; val_best_f1_score: 0.9768; train_kl_reg_loss: 27472.7825; train_edge_recon_loss: 1314904.6391; train_cat_covariates_contrastive_loss: 7035.7532; train_gene_expr_recon_loss: 1902883.0739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3252296.2506; train_optim_loss: 3252296.2506; val_kl_reg_loss: 29135.3755; val_edge_recon_loss: 1332853.2357; val_cat_covariates_contrastive_loss: 7072.1191; val_gene_expr_recon_loss: 1900686.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3269746.8696; val_optim_loss: 3269746.8696
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9899; val_auprc_score: 0.9961; val_best_acc_score: 0.9644; val_best_f1_score: 0.9766; train_kl_reg_loss: 28654.3966; train_edge_recon_loss: 1316047.1152; train_cat_covariates_contrastive_loss: 7051.5282; train_gene_expr_recon_loss: 1891717.9809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3243471.0194; train_optim_loss: 3243471.0194; val_kl_reg_loss: 30713.7935; val_edge_recon_loss: 1332265.6413; val_cat_covariates_contrastive_loss: 6997.9484; val_gene_expr_recon_loss: 1920367.1650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3290344.5514; val_optim_loss: 3290344.5514
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9906; val_auprc_score: 0.9963; val_best_acc_score: 0.9667; val_best_f1_score: 0.9781; train_kl_reg_loss: 28764.9682; train_edge_recon_loss: 1316566.2659; train_cat_covariates_contrastive_loss: 7049.5134; train_gene_expr_recon_loss: 1886772.5745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3239153.3234; train_optim_loss: 3239153.3234; val_kl_reg_loss: 28407.6031; val_edge_recon_loss: 1327293.6833; val_cat_covariates_contrastive_loss: 7098.8497; val_gene_expr_recon_loss: 1902238.2372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265038.3745; val_optim_loss: 3265038.3745
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9916; val_auprc_score: 0.9967; val_best_acc_score: 0.9672; val_best_f1_score: 0.9785; train_kl_reg_loss: 27982.3553; train_edge_recon_loss: 1315517.2923; train_cat_covariates_contrastive_loss: 7059.6255; train_gene_expr_recon_loss: 1884611.1346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3235170.4071; train_optim_loss: 3235170.4071; val_kl_reg_loss: 28144.7596; val_edge_recon_loss: 1324972.3661; val_cat_covariates_contrastive_loss: 7112.1328; val_gene_expr_recon_loss: 1899278.4788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3259507.7322; val_optim_loss: 3259507.7322

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9918; val_auprc_score: 0.9969; val_best_acc_score: 0.9680; val_best_f1_score: 0.9789; train_kl_reg_loss: 27282.9381; train_edge_recon_loss: 1312902.8597; train_cat_covariates_contrastive_loss: 7093.0258; train_gene_expr_recon_loss: 1848931.2404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3196210.0670; train_optim_loss: 3196210.0670; val_kl_reg_loss: 27393.7418; val_edge_recon_loss: 1328802.5015; val_cat_covariates_contrastive_loss: 7120.9816; val_gene_expr_recon_loss: 1862529.8276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3225847.0455; val_optim_loss: 3225847.0455
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9913; val_auprc_score: 0.9967; val_best_acc_score: 0.9675; val_best_f1_score: 0.9785; train_kl_reg_loss: 27026.2809; train_edge_recon_loss: 1312063.9249; train_cat_covariates_contrastive_loss: 7093.2871; train_gene_expr_recon_loss: 1841975.0259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3188158.5188; train_optim_loss: 3188158.5188; val_kl_reg_loss: 26874.0934; val_edge_recon_loss: 1332484.6616; val_cat_covariates_contrastive_loss: 7104.6679; val_gene_expr_recon_loss: 1857987.8478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3224451.2727; val_optim_loss: 3224451.2727
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9919; val_auprc_score: 0.9970; val_best_acc_score: 0.9684; val_best_f1_score: 0.9793; train_kl_reg_loss: 26369.0314; train_edge_recon_loss: 1309632.5629; train_cat_covariates_contrastive_loss: 7090.5326; train_gene_expr_recon_loss: 1838294.3881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181386.5171; train_optim_loss: 3181386.5171; val_kl_reg_loss: 26222.2687; val_edge_recon_loss: 1324796.8587; val_cat_covariates_contrastive_loss: 7118.9427; val_gene_expr_recon_loss: 1856093.0983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3214231.1660; val_optim_loss: 3214231.1660
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9919; val_auprc_score: 0.9969; val_best_acc_score: 0.9683; val_best_f1_score: 0.9791; train_kl_reg_loss: 26001.2233; train_edge_recon_loss: 1311852.2788; train_cat_covariates_contrastive_loss: 7086.0325; train_gene_expr_recon_loss: 1834943.3017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3179882.8367; train_optim_loss: 3179882.8367; val_kl_reg_loss: 25960.6211; val_edge_recon_loss: 1327399.9960; val_cat_covariates_contrastive_loss: 7111.0241; val_gene_expr_recon_loss: 1853795.5776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3214267.2184; val_optim_loss: 3214267.2184
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9919; val_auprc_score: 0.9967; val_best_acc_score: 0.9688; val_best_f1_score: 0.9795; train_kl_reg_loss: 25781.2718; train_edge_recon_loss: 1308735.3087; train_cat_covariates_contrastive_loss: 7077.9455; train_gene_expr_recon_loss: 1834564.5555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3176159.0860; train_optim_loss: 3176159.0860; val_kl_reg_loss: 25623.0160; val_edge_recon_loss: 1328208.0459; val_cat_covariates_contrastive_loss: 7122.6015; val_gene_expr_recon_loss: 1851489.7871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3212443.4427; val_optim_loss: 3212443.4427
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9916; val_auprc_score: 0.9968; val_best_acc_score: 0.9683; val_best_f1_score: 0.9791; train_kl_reg_loss: 25494.0972; train_edge_recon_loss: 1310127.4592; train_cat_covariates_contrastive_loss: 7075.9993; train_gene_expr_recon_loss: 1833312.8345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3176010.3888; train_optim_loss: 3176010.3888; val_kl_reg_loss: 25509.7691; val_edge_recon_loss: 1325822.2031; val_cat_covariates_contrastive_loss: 7107.6934; val_gene_expr_recon_loss: 1852550.2554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3210989.9140; val_optim_loss: 3210989.9140
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9919; val_auprc_score: 0.9969; val_best_acc_score: 0.9685; val_best_f1_score: 0.9793; train_kl_reg_loss: 25302.2751; train_edge_recon_loss: 1310233.5162; train_cat_covariates_contrastive_loss: 7072.5539; train_gene_expr_recon_loss: 1832438.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3175047.0843; train_optim_loss: 3175047.0843; val_kl_reg_loss: 25315.6635; val_edge_recon_loss: 1322907.3508; val_cat_covariates_contrastive_loss: 7095.0725; val_gene_expr_recon_loss: 1849427.5326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3204745.6107; val_optim_loss: 3204745.6107
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9919; val_auprc_score: 0.9968; val_best_acc_score: 0.9684; val_best_f1_score: 0.9793; train_kl_reg_loss: 25047.4032; train_edge_recon_loss: 1310794.6957; train_cat_covariates_contrastive_loss: 7073.6613; train_gene_expr_recon_loss: 1831608.5481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3174524.3098; train_optim_loss: 3174524.3098; val_kl_reg_loss: 24887.4293; val_edge_recon_loss: 1319196.5254; val_cat_covariates_contrastive_loss: 7122.8792; val_gene_expr_recon_loss: 1848112.7673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3199319.6047; val_optim_loss: 3199319.6047
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9920; val_auprc_score: 0.9969; val_best_acc_score: 0.9688; val_best_f1_score: 0.9795; train_kl_reg_loss: 24851.5014; train_edge_recon_loss: 1314046.2322; train_cat_covariates_contrastive_loss: 7072.6895; train_gene_expr_recon_loss: 1830110.4675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3176080.8919; train_optim_loss: 3176080.8919; val_kl_reg_loss: 24845.6825; val_edge_recon_loss: 1322480.6571; val_cat_covariates_contrastive_loss: 7109.0416; val_gene_expr_recon_loss: 1851050.2050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3205485.5949; val_optim_loss: 3205485.5949
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9915; val_auprc_score: 0.9967; val_best_acc_score: 0.9679; val_best_f1_score: 0.9789; train_kl_reg_loss: 24770.2805; train_edge_recon_loss: 1307822.7557; train_cat_covariates_contrastive_loss: 7058.4874; train_gene_expr_recon_loss: 1830183.4420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3169834.9621; train_optim_loss: 3169834.9621; val_kl_reg_loss: 24867.0161; val_edge_recon_loss: 1330362.9239; val_cat_covariates_contrastive_loss: 7081.1026; val_gene_expr_recon_loss: 1847015.4590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3209326.4960; val_optim_loss: 3209326.4960
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9918; val_auprc_score: 0.9968; val_best_acc_score: 0.9682; val_best_f1_score: 0.9791; train_kl_reg_loss: 24596.8944; train_edge_recon_loss: 1310229.7048; train_cat_covariates_contrastive_loss: 7064.2546; train_gene_expr_recon_loss: 1829769.0851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3171659.9393; train_optim_loss: 3171659.9393; val_kl_reg_loss: 24563.4421; val_edge_recon_loss: 1329782.4674; val_cat_covariates_contrastive_loss: 7078.5112; val_gene_expr_recon_loss: 1849686.6581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3211111.0820; val_optim_loss: 3211111.0820
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9918; val_auprc_score: 0.9968; val_best_acc_score: 0.9691; val_best_f1_score: 0.9796; train_kl_reg_loss: 24402.9820; train_edge_recon_loss: 1310137.8121; train_cat_covariates_contrastive_loss: 7057.6273; train_gene_expr_recon_loss: 1828878.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3170476.8937; train_optim_loss: 3170476.8937; val_kl_reg_loss: 24521.5226; val_edge_recon_loss: 1329960.6275; val_cat_covariates_contrastive_loss: 7068.5741; val_gene_expr_recon_loss: 1849211.7342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3210762.4634; val_optim_loss: 3210762.4634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9920; val_auprc_score: 0.9969; val_best_acc_score: 0.9689; val_best_f1_score: 0.9796; train_kl_reg_loss: 24219.6109; train_edge_recon_loss: 1309349.6646; train_cat_covariates_contrastive_loss: 7060.5232; train_gene_expr_recon_loss: 1824895.8797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3165525.6809; train_optim_loss: 3165525.6809; val_kl_reg_loss: 24256.0541; val_edge_recon_loss: 1321316.7184; val_cat_covariates_contrastive_loss: 7106.8334; val_gene_expr_recon_loss: 1846339.1477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3199018.7569; val_optim_loss: 3199018.7569
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9919; val_auprc_score: 0.9969; val_best_acc_score: 0.9689; val_best_f1_score: 0.9795; train_kl_reg_loss: 24183.5933; train_edge_recon_loss: 1310679.2299; train_cat_covariates_contrastive_loss: 7064.2727; train_gene_expr_recon_loss: 1824581.5105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166508.6061; train_optim_loss: 3166508.6061; val_kl_reg_loss: 24275.3886; val_edge_recon_loss: 1326881.7085; val_cat_covariates_contrastive_loss: 7091.1793; val_gene_expr_recon_loss: 1843067.8478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3201316.1166; val_optim_loss: 3201316.1166
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9920; val_auprc_score: 0.9970; val_best_acc_score: 0.9689; val_best_f1_score: 0.9796; train_kl_reg_loss: 24142.9037; train_edge_recon_loss: 1310715.7493; train_cat_covariates_contrastive_loss: 7064.1438; train_gene_expr_recon_loss: 1824264.3688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166187.1661; train_optim_loss: 3166187.1661; val_kl_reg_loss: 24221.3339; val_edge_recon_loss: 1319358.5529; val_cat_covariates_contrastive_loss: 7085.4373; val_gene_expr_recon_loss: 1844631.3824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3195296.7026; val_optim_loss: 3195296.7026
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9917; val_auprc_score: 0.9968; val_best_acc_score: 0.9683; val_best_f1_score: 0.9791; train_kl_reg_loss: 24131.0687; train_edge_recon_loss: 1308987.9685; train_cat_covariates_contrastive_loss: 7060.7382; train_gene_expr_recon_loss: 1824318.9234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3164498.7008; train_optim_loss: 3164498.7008; val_kl_reg_loss: 24204.5112; val_edge_recon_loss: 1326221.1497; val_cat_covariates_contrastive_loss: 7084.2983; val_gene_expr_recon_loss: 1844833.2747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3202343.2372; val_optim_loss: 3202343.2372
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9918; val_auprc_score: 0.9969; val_best_acc_score: 0.9686; val_best_f1_score: 0.9793; train_kl_reg_loss: 24105.7731; train_edge_recon_loss: 1308983.6149; train_cat_covariates_contrastive_loss: 7061.5283; train_gene_expr_recon_loss: 1823617.9245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3163768.8421; train_optim_loss: 3163768.8421; val_kl_reg_loss: 24170.6338; val_edge_recon_loss: 1327133.9323; val_cat_covariates_contrastive_loss: 7088.2226; val_gene_expr_recon_loss: 1846781.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3205174.6838; val_optim_loss: 3205174.6838
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9917; val_auprc_score: 0.9968; val_best_acc_score: 0.9684; val_best_f1_score: 0.9793; train_kl_reg_loss: 24089.6560; train_edge_recon_loss: 1309966.8053; train_cat_covariates_contrastive_loss: 7061.6327; train_gene_expr_recon_loss: 1823441.5307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3164559.6267; train_optim_loss: 3164559.6267; val_kl_reg_loss: 24192.4946; val_edge_recon_loss: 1324043.0232; val_cat_covariates_contrastive_loss: 7094.0009; val_gene_expr_recon_loss: 1843341.8404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3198671.3498; val_optim_loss: 3198671.3498
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9920; val_auprc_score: 0.9969; val_best_acc_score: 0.9688; val_best_f1_score: 0.9795; train_kl_reg_loss: 24075.4045; train_edge_recon_loss: 1308293.4343; train_cat_covariates_contrastive_loss: 7059.6546; train_gene_expr_recon_loss: 1823959.1533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3163387.6480; train_optim_loss: 3163387.6480; val_kl_reg_loss: 24127.3615; val_edge_recon_loss: 1322972.7041; val_cat_covariates_contrastive_loss: 7076.9114; val_gene_expr_recon_loss: 1846528.6077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200705.5820; val_optim_loss: 3200705.5820

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9920; val_auprc_score: 0.9970; val_best_acc_score: 0.9685; val_best_f1_score: 0.9793; train_kl_reg_loss: 24032.0750; train_edge_recon_loss: 1309399.1140; train_cat_covariates_contrastive_loss: 7058.2090; train_gene_expr_recon_loss: 1822874.2728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3163363.6710; train_optim_loss: 3163363.6710; val_kl_reg_loss: 24109.8437; val_edge_recon_loss: 1323505.4284; val_cat_covariates_contrastive_loss: 7080.7191; val_gene_expr_recon_loss: 1844797.7169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3199493.7095; val_optim_loss: 3199493.7095
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9922; val_auprc_score: 0.9970; val_best_acc_score: 0.9690; val_best_f1_score: 0.9796; train_kl_reg_loss: 24019.6131; train_edge_recon_loss: 1310845.4116; train_cat_covariates_contrastive_loss: 7059.6789; train_gene_expr_recon_loss: 1822941.1260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3164865.8294; train_optim_loss: 3164865.8294; val_kl_reg_loss: 24116.6946; val_edge_recon_loss: 1318686.4600; val_cat_covariates_contrastive_loss: 7079.3261; val_gene_expr_recon_loss: 1846038.1527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3195920.6225; val_optim_loss: 3195920.6225
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9923; val_auprc_score: 0.9971; val_best_acc_score: 0.9696; val_best_f1_score: 0.9800; train_kl_reg_loss: 24027.4241; train_edge_recon_loss: 1308877.7589; train_cat_covariates_contrastive_loss: 7061.8142; train_gene_expr_recon_loss: 1823171.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3163138.6846; train_optim_loss: 3163138.6846; val_kl_reg_loss: 24099.7452; val_edge_recon_loss: 1320118.9827; val_cat_covariates_contrastive_loss: 7088.5644; val_gene_expr_recon_loss: 1844485.3557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3195792.6522; val_optim_loss: 3195792.6522
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9919; val_auprc_score: 0.9969; val_best_acc_score: 0.9685; val_best_f1_score: 0.9792; train_kl_reg_loss: 24018.3599; train_edge_recon_loss: 1307990.2654; train_cat_covariates_contrastive_loss: 7060.1005; train_gene_expr_recon_loss: 1823150.1499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3162218.8775; train_optim_loss: 3162218.8775; val_kl_reg_loss: 24087.6587; val_edge_recon_loss: 1336303.9842; val_cat_covariates_contrastive_loss: 7082.8172; val_gene_expr_recon_loss: 1845342.2520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3212816.7184; val_optim_loss: 3212816.7184

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1017 min 50 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9854
val AUPRC score: 0.9938
val best accuracy score: 0.9645
val best F1 score: 0.9766
val target rna MSE score: 0.5897
val source rna MSE score: 0.0868
Val cat covariate0 mean sim diff: 0.0002
Val cat covariate1 mean sim diff: -0.0972
Duration of model training in run 2: 17 hours, 2 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
