Loading adata}.
Computing benchmarking metrics...
Computing GCS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 2 minutes 38 seconds.

Computing MLAMI Metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 15 minutes 12 seconds.

Computing CAS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Combining spatial nearest neighbor graphs...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 15 minutes 41 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 21 minutes 41 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 21 minutes 45 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 25 minutes 32 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 25 minutes 33 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 37 minutes 3 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 37 minutes 46 seconds.

BGC metric computed. Elapsed time: 37 minutes 46 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 37 minutes 47 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 29 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 11 minutes 43 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 11 minutes 58 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 17 minutes 53 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 17 minutes 56 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 21 minutes 39 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 21 minutes 40 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 33 minutes 6 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 33 minutes 35 seconds.

BGC metric computed. Elapsed time: 33 minutes 36 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 33 minutes 37 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 30 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 11 minutes 40 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 11 minutes 55 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 17 minutes 47 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 17 minutes 51 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 21 minutes 33 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 21 minutes 34 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 33 minutes 3 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 33 minutes 39 seconds.

BGC metric computed. Elapsed time: 33 minutes 40 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 33 minutes 41 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 33 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 13 minutes 8 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 13 minutes 22 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 19 minutes 19 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 19 minutes 26 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 23 minutes 39 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 23 minutes 40 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 36 minutes 7 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 36 minutes 40 seconds.

BGC metric computed. Elapsed time: 36 minutes 40 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 36 minutes 42 seconds.

Loading adata}.
Computing benchmarking metrics...
Computing GCS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 2 minutes 44 seconds.

Computing MLAMI Metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 15 minutes 39 seconds.

Computing CAS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Combining spatial nearest neighbor graphs...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 16 minutes 8 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 22 minutes 2 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 22 minutes 9 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 25 minutes 10 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 25 minutes 12 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 34 minutes 16 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 34 minutes 57 seconds.

BGC metric computed. Elapsed time: 34 minutes 58 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 34 minutes 59 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 29 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 14 minutes 0 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 14 minutes 15 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 19 minutes 55 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 19 minutes 59 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 23 minutes 3 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 23 minutes 4 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 33 minutes 12 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 33 minutes 44 seconds.

BGC metric computed. Elapsed time: 33 minutes 46 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 33 minutes 47 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 35 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 9 minutes 51 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 10 minutes 5 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 16 minutes 7 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 16 minutes 14 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 19 minutes 13 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 19 minutes 15 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 28 minutes 23 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 28 minutes 48 seconds.

BGC metric computed. Elapsed time: 28 minutes 49 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 28 minutes 50 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 37 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 11 minutes 39 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 11 minutes 55 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 18 minutes 3 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 18 minutes 13 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 21 minutes 13 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 21 minutes 15 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 30 minutes 15 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 30 minutes 39 seconds.

BGC metric computed. Elapsed time: 30 minutes 39 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 30 minutes 41 seconds.

Loading adata}.
Computing benchmarking metrics...
Computing GCS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 2 minutes 34 seconds.

Computing MLAMI Metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0', 'leiden_latent_0.1', 'leiden_latent_0.55'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'spatial_15knng_n_neighbors', 'leiden'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'spatial_15knng_connectivities', 'spatial_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 13 minutes 57 seconds.

Computing CAS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Combining spatial nearest neighbor graphs...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 14 minutes 27 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 20 minutes 27 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 20 minutes 32 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 24 minutes 52 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 24 minutes 53 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 37 minutes 52 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 38 minutes 37 seconds.

BGC metric computed. Elapsed time: 38 minutes 37 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 38 minutes 38 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 30 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 11 minutes 24 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 11 minutes 39 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 17 minutes 44 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 17 minutes 57 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 22 minutes 17 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 22 minutes 19 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 35 minutes 32 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 36 minutes 4 seconds.

BGC metric computed. Elapsed time: 36 minutes 4 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 36 minutes 5 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 29 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 12 minutes 40 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 12 minutes 55 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 18 minutes 51 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 19 minutes 1 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 23 minutes 19 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 23 minutes 20 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 36 minutes 14 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 36 minutes 45 seconds.

BGC metric computed. Elapsed time: 36 minutes 45 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 36 minutes 46 seconds.

Computing benchmarking metrics...
Computing GCS metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph for batch lung5_rep1...
Computing latent nearest neighbor graph for batch lung5_rep2...
Computing latent nearest neighbor graph for batch lung5_rep3...
Computing GCS for batch lung5_rep1...
Computing GCS for batch lung5_rep2...
Computing GCS for batch lung5_rep3...
GCS metric computed. Elapsed time: 0 minutes 30 seconds.

Computing MLAMI Metric...
Using precomputed spatial nearest neighbor graph...
Computing latent nearest neighbor graph...
Computing spatial Leiden clusterings for batch lung5_rep1...
Computing spatial Leiden clusterings for batch lung5_rep2...
Computing spatial Leiden clusterings for batch lung5_rep3...
Computing latent Leiden clusterings...
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 46603 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 48743 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
AnnData object with n_obs × n_vars = 45845 × 960
    obs: 'cell_type', 'batch', 'fov', 'leiden_latent_0.1', 'leiden_latent_0.55', 'leiden_latent_1.0', 'index', 'leiden_spatial_0.1', 'leiden_spatial_0.55', 'leiden_spatial_1.0'
    uns: 'nichecompass_latent_run1_umap', 'nichecompass_latent_run2_umap', 'nichecompass_latent_run3_umap', 'nichecompass_latent_run4_umap', 'nichecompass_latent_run5_umap', 'nichecompass_latent_run6_umap', 'nichecompass_latent_run7_umap', 'nichecompass_latent_run8_umap', 'nichecompass_model_training_duration_run1', 'nichecompass_model_training_duration_run2', 'nichecompass_model_training_duration_run3', 'nichecompass_model_training_duration_run4', 'nichecompass_model_training_duration_run5', 'nichecompass_model_training_duration_run6', 'nichecompass_model_training_duration_run7', 'nichecompass_model_training_duration_run8', 'nichecompass_latent_run1_15knng_n_neighbors', 'leiden', 'spatial_15knng_n_neighbors', 'cell_type_nhood_enrichment', 'cell_type_spatial_nhood_enrichment', 'cell_type_latent_nhood_enrichment', 'nichecompass_latent_run1_90knng_n_neighbors', 'nichecompass_latent_run2_15knng_n_neighbors', 'nichecompass_latent_run2_90knng_n_neighbors', 'nichecompass_latent_run3_15knng_n_neighbors', 'nichecompass_latent_run3_90knng_n_neighbors'
    obsm: 'nichecompass_latent_run1', 'nichecompass_latent_run1_X_umap', 'nichecompass_latent_run2', 'nichecompass_latent_run2_X_umap', 'nichecompass_latent_run3', 'nichecompass_latent_run3_X_umap', 'nichecompass_latent_run4', 'nichecompass_latent_run4_X_umap', 'nichecompass_latent_run5', 'nichecompass_latent_run6', 'nichecompass_latent_run7', 'nichecompass_latent_run8', 'spatial'
    obsp: 'nichecompass_latent_run1_connectivities', 'nichecompass_latent_run1_distances', 'nichecompass_latent_run2_connectivities', 'nichecompass_latent_run2_distances', 'nichecompass_latent_run3_connectivities', 'nichecompass_latent_run3_distances', 'nichecompass_latent_run4_connectivities', 'nichecompass_latent_run4_distances', 'nichecompass_latent_run5_connectivities', 'nichecompass_latent_run5_distances', 'nichecompass_latent_run6_connectivities', 'nichecompass_latent_run6_distances', 'nichecompass_latent_run7_connectivities', 'nichecompass_latent_run7_distances', 'nichecompass_latent_run8_connectivities', 'nichecompass_latent_run8_distances', 'nichecompass_latent_run1_15knng_connectivities', 'nichecompass_latent_run1_15knng_distances', 'spatial_15knng_connectivities', 'nichecompass_latent_run1_90knng_connectivities', 'nichecompass_latent_run1_90knng_distances', 'nichecompass_latent_run2_15knng_connectivities', 'nichecompass_latent_run2_15knng_distances', 'nichecompass_latent_run2_90knng_connectivities', 'nichecompass_latent_run2_90knng_distances', 'nichecompass_latent_run3_15knng_connectivities', 'nichecompass_latent_run3_15knng_distances', 'nichecompass_latent_run3_90knng_connectivities', 'nichecompass_latent_run3_90knng_distances', 'nichecompass_latent_run4_15knng_connectivities', 'nichecompass_latent_run4_15knng_distances'
Computing MLAMI for batch lung5_rep1...
Computing MLAMI for batch lung5_rep2...
Computing MLAMI for batch lung5_rep3...
MLAMI metric computed. Elapsed time: 11 minutes 36 seconds.

Computing CAS metric...
Using precomputed spatial nearest neighbor graph...
Computing spatial neighborhood enrichment scores...
Using precomputed latent nearest neighbor graph...
Computing latent neighborhood enrichment scores...
Computing CAS...
CAS metric computed. Elapsed time: 11 minutes 51 seconds.

Computing CLISIS metric...
Computing spatial nearest neighbor graph for batch lung5_rep1...
Computing spatial cell CLISI scores for batch lung5_rep1...
Computing spatial nearest neighbor graph for batch lung5_rep2...
Computing spatial cell CLISI scores for batch lung5_rep2...
Computing spatial nearest neighbor graph for batch lung5_rep3...
Computing spatial cell CLISI scores for batch lung5_rep3...
Computing latent nearest neighbor graph...
Computing latent cell CLISI scores...
Computing CLISIS...
CLISIS metric computed. Elapsed time: 17 minutes 45 seconds.

Computing CNMI and CARI metrics...
CNMI and CARI metrics computed. Elapsed time: 17 minutes 53 seconds.

Computing CASW Metric...
CASW metric computed. Elapsed time: 22 minutes 13 seconds.

Computing CLISI metric...
CLISI metric computed. Elapsed time: 22 minutes 14 seconds.

Computing NASW Metric...
Using precomputed latent nearest neighbor graph...
Computing latent Leiden clusterings...
Using precomputed latent Leiden clusters for resolution 0.1.
Using precomputed latent Leiden clusters for resolution 0.55.
Using precomputed latent Leiden clusters for resolution 1.0.
Computing NASW...
NASW metric computed. Elapsed time: 35 minutes 11 seconds.

Computing BASW Metric...
BASW metric computed. Elapsed time: 35 minutes 43 seconds.

BGC metric computed. Elapsed time: 35 minutes 43 seconds.

Computing BLISI Metric...
BLISI metric computed. Elapsed time: 35 minutes 44 seconds.

