Run timestamp: 22082023_170833_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '512', '512', '512', '512', '512', '512', '512', '512', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8362; val_auprc_score: 0.9622; val_best_acc_score: 0.8753; val_best_f1_score: 0.9315; train_kl_reg_loss: 5230.9948; train_edge_recon_loss: 1008871.7206; train_gene_expr_recon_loss: 2151349.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3165452.6441; train_optim_loss: 3165452.6441; val_kl_reg_loss: 8358.2785; val_edge_recon_loss: 1094053.9000; val_gene_expr_recon_loss: 1960504.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3062916.5750; val_optim_loss: 3062916.5750
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8374; val_auprc_score: 0.9633; val_best_acc_score: 0.8974; val_best_f1_score: 0.9433; train_kl_reg_loss: 10225.1626; train_edge_recon_loss: 936123.1456; train_gene_expr_recon_loss: 1885711.1456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2832059.4559; train_optim_loss: 2832059.4559; val_kl_reg_loss: 11566.1779; val_edge_recon_loss: 880029.0250; val_gene_expr_recon_loss: 1839790.6625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2731385.8500; val_optim_loss: 2731385.8500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8586; val_auprc_score: 0.9641; val_best_acc_score: 0.8998; val_best_f1_score: 0.9436; train_kl_reg_loss: 11487.3376; train_edge_recon_loss: 883451.6015; train_gene_expr_recon_loss: 1808974.6926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2703913.6324; train_optim_loss: 2703913.6324; val_kl_reg_loss: 13061.4306; val_edge_recon_loss: 859332.8688; val_gene_expr_recon_loss: 1790557.5875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2662951.9000; val_optim_loss: 2662951.9000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8946; val_auprc_score: 0.9716; val_best_acc_score: 0.9119; val_best_f1_score: 0.9500; train_kl_reg_loss: 12303.7960; train_edge_recon_loss: 859531.3037; train_gene_expr_recon_loss: 1758139.3412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2629974.4441; train_optim_loss: 2629974.4441; val_kl_reg_loss: 12358.9866; val_edge_recon_loss: 899052.0938; val_gene_expr_recon_loss: 1753923.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2665334.8250; val_optim_loss: 2665334.8250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9170; val_auprc_score: 0.9790; val_best_acc_score: 0.9224; val_best_f1_score: 0.9558; train_kl_reg_loss: 12964.1676; train_edge_recon_loss: 828451.4971; train_gene_expr_recon_loss: 1719803.4721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2561219.1471; train_optim_loss: 2561219.1471; val_kl_reg_loss: 13274.5150; val_edge_recon_loss: 834778.5500; val_gene_expr_recon_loss: 1719378.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2567431.3500; val_optim_loss: 2567431.3500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9407; val_auprc_score: 0.9860; val_best_acc_score: 0.9365; val_best_f1_score: 0.9635; train_kl_reg_loss: 12808.1370; train_edge_recon_loss: 815726.0375; train_gene_expr_recon_loss: 1692300.1265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2520834.3000; train_optim_loss: 2520834.3000; val_kl_reg_loss: 13696.8684; val_edge_recon_loss: 831300.7000; val_gene_expr_recon_loss: 1676788.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2521785.8500; val_optim_loss: 2521785.8500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9266; val_auprc_score: 0.9818; val_best_acc_score: 0.9465; val_best_f1_score: 0.9696; train_kl_reg_loss: 13250.2578; train_edge_recon_loss: 819876.5949; train_gene_expr_recon_loss: 1670029.2515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2503156.1029; train_optim_loss: 2503156.1029; val_kl_reg_loss: 12684.2933; val_edge_recon_loss: 753270.3500; val_gene_expr_recon_loss: 1668127.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2434082.4000; val_optim_loss: 2434082.4000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9377; val_auprc_score: 0.9827; val_best_acc_score: 0.9436; val_best_f1_score: 0.9675; train_kl_reg_loss: 12940.7345; train_edge_recon_loss: 811676.3632; train_gene_expr_recon_loss: 1649455.3721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2474072.4706; train_optim_loss: 2474072.4706; val_kl_reg_loss: 13501.1016; val_edge_recon_loss: 817184.2125; val_gene_expr_recon_loss: 1649859.1625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2480544.4750; val_optim_loss: 2480544.4750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9435; val_auprc_score: 0.9840; val_best_acc_score: 0.9475; val_best_f1_score: 0.9699; train_kl_reg_loss: 12855.3239; train_edge_recon_loss: 798433.4765; train_gene_expr_recon_loss: 1633137.4118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2444426.1971; train_optim_loss: 2444426.1971; val_kl_reg_loss: 12566.0984; val_edge_recon_loss: 806540.6438; val_gene_expr_recon_loss: 1637264.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2456371.5500; val_optim_loss: 2456371.5500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9525; val_auprc_score: 0.9868; val_best_acc_score: 0.9539; val_best_f1_score: 0.9732; train_kl_reg_loss: 12570.9288; train_edge_recon_loss: 801588.5412; train_gene_expr_recon_loss: 1615861.1676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2430020.6441; train_optim_loss: 2430020.6441; val_kl_reg_loss: 12447.0427; val_edge_recon_loss: 808500.1438; val_gene_expr_recon_loss: 1617065.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2438012.9000; val_optim_loss: 2438012.9000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9425; val_auprc_score: 0.9818; val_best_acc_score: 0.9502; val_best_f1_score: 0.9712; train_kl_reg_loss: 12485.9959; train_edge_recon_loss: 807615.7824; train_gene_expr_recon_loss: 1601435.7985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2421537.5824; train_optim_loss: 2421537.5824; val_kl_reg_loss: 12182.1961; val_edge_recon_loss: 785898.6813; val_gene_expr_recon_loss: 1612863.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2410944.3500; val_optim_loss: 2410944.3500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9404; val_auprc_score: 0.9817; val_best_acc_score: 0.9538; val_best_f1_score: 0.9735; train_kl_reg_loss: 11910.5409; train_edge_recon_loss: 799844.2566; train_gene_expr_recon_loss: 1587710.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2399464.9971; train_optim_loss: 2399464.9971; val_kl_reg_loss: 11616.2074; val_edge_recon_loss: 774092.2188; val_gene_expr_recon_loss: 1586102.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2371810.5750; val_optim_loss: 2371810.5750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9529; val_auprc_score: 0.9875; val_best_acc_score: 0.9565; val_best_f1_score: 0.9748; train_kl_reg_loss: 11465.7179; train_edge_recon_loss: 783262.0257; train_gene_expr_recon_loss: 1575319.2176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2370046.9765; train_optim_loss: 2370046.9765; val_kl_reg_loss: 11191.5597; val_edge_recon_loss: 825718.3875; val_gene_expr_recon_loss: 1590961.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2427871.3500; val_optim_loss: 2427871.3500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9533; val_auprc_score: 0.9873; val_best_acc_score: 0.9580; val_best_f1_score: 0.9758; train_kl_reg_loss: 11265.8835; train_edge_recon_loss: 792003.7360; train_gene_expr_recon_loss: 1565118.9735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2368388.5941; train_optim_loss: 2368388.5941; val_kl_reg_loss: 11124.9479; val_edge_recon_loss: 779095.8562; val_gene_expr_recon_loss: 1564886.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2355106.9000; val_optim_loss: 2355106.9000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9535; val_auprc_score: 0.9870; val_best_acc_score: 0.9572; val_best_f1_score: 0.9753; train_kl_reg_loss: 10977.4480; train_edge_recon_loss: 785043.5691; train_gene_expr_recon_loss: 1552726.0632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2348747.0794; train_optim_loss: 2348747.0794; val_kl_reg_loss: 10714.1632; val_edge_recon_loss: 811415.7063; val_gene_expr_recon_loss: 1575659.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2397789.1500; val_optim_loss: 2397789.1500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9494; val_auprc_score: 0.9836; val_best_acc_score: 0.9584; val_best_f1_score: 0.9760; train_kl_reg_loss: 10827.7361; train_edge_recon_loss: 788413.5544; train_gene_expr_recon_loss: 1541386.5279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2340627.8088; train_optim_loss: 2340627.8088; val_kl_reg_loss: 10857.7673; val_edge_recon_loss: 804677.2188; val_gene_expr_recon_loss: 1551882.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2367417.8500; val_optim_loss: 2367417.8500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9496; val_auprc_score: 0.9864; val_best_acc_score: 0.9571; val_best_f1_score: 0.9754; train_kl_reg_loss: 10719.2678; train_edge_recon_loss: 779755.0574; train_gene_expr_recon_loss: 1530863.4412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2321337.7588; train_optim_loss: 2321337.7588; val_kl_reg_loss: 10715.0561; val_edge_recon_loss: 781522.6375; val_gene_expr_recon_loss: 1534221.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2326459.5250; val_optim_loss: 2326459.5250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9514; val_auprc_score: 0.9841; val_best_acc_score: 0.9612; val_best_f1_score: 0.9774; train_kl_reg_loss: 10670.8696; train_edge_recon_loss: 795712.1478; train_gene_expr_recon_loss: 1520088.3059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2326471.3147; train_optim_loss: 2326471.3147; val_kl_reg_loss: 10416.6157; val_edge_recon_loss: 815907.8812; val_gene_expr_recon_loss: 1531635.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2357959.8500; val_optim_loss: 2357959.8500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9616; val_auprc_score: 0.9905; val_best_acc_score: 0.9626; val_best_f1_score: 0.9783; train_kl_reg_loss: 10446.2197; train_edge_recon_loss: 779351.5636; train_gene_expr_recon_loss: 1508442.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2298239.9912; train_optim_loss: 2298239.9912; val_kl_reg_loss: 10361.3711; val_edge_recon_loss: 799842.8750; val_gene_expr_recon_loss: 1537908.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2348112.9750; val_optim_loss: 2348112.9750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9563; val_auprc_score: 0.9850; val_best_acc_score: 0.9632; val_best_f1_score: 0.9786; train_kl_reg_loss: 10300.7815; train_edge_recon_loss: 791223.1169; train_gene_expr_recon_loss: 1498223.4382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2299747.3353; train_optim_loss: 2299747.3353; val_kl_reg_loss: 10155.1266; val_edge_recon_loss: 824001.2188; val_gene_expr_recon_loss: 1510957.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2345114.3000; val_optim_loss: 2345114.3000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9613; val_auprc_score: 0.9884; val_best_acc_score: 0.9634; val_best_f1_score: 0.9789; train_kl_reg_loss: 10280.7807; train_edge_recon_loss: 785936.6779; train_gene_expr_recon_loss: 1484643.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2280860.6221; train_optim_loss: 2280860.6221; val_kl_reg_loss: 10097.5442; val_edge_recon_loss: 779518.9125; val_gene_expr_recon_loss: 1493788.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2283405.1500; val_optim_loss: 2283405.1500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9655; val_auprc_score: 0.9921; val_best_acc_score: 0.9643; val_best_f1_score: 0.9792; train_kl_reg_loss: 10107.5307; train_edge_recon_loss: 782670.7312; train_gene_expr_recon_loss: 1476557.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2269335.8382; train_optim_loss: 2269335.8382; val_kl_reg_loss: 10127.4489; val_edge_recon_loss: 824960.2937; val_gene_expr_recon_loss: 1491261.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2326349.2250; val_optim_loss: 2326349.2250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9580; val_auprc_score: 0.9850; val_best_acc_score: 0.9631; val_best_f1_score: 0.9785; train_kl_reg_loss: 10097.2897; train_edge_recon_loss: 772296.1978; train_gene_expr_recon_loss: 1467024.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2249417.6382; train_optim_loss: 2249417.6382; val_kl_reg_loss: 9965.0397; val_edge_recon_loss: 814610.8313; val_gene_expr_recon_loss: 1475182.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2299758.3500; val_optim_loss: 2299758.3500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9639; val_auprc_score: 0.9895; val_best_acc_score: 0.9662; val_best_f1_score: 0.9806; train_kl_reg_loss: 10056.5296; train_edge_recon_loss: 779452.6368; train_gene_expr_recon_loss: 1455171.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2244680.7647; train_optim_loss: 2244680.7647; val_kl_reg_loss: 10119.2287; val_edge_recon_loss: 763193.7625; val_gene_expr_recon_loss: 1470523.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2243836.4250; val_optim_loss: 2243836.4250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9597; val_auprc_score: 0.9886; val_best_acc_score: 0.9662; val_best_f1_score: 0.9804; train_kl_reg_loss: 10078.2518; train_edge_recon_loss: 783194.5596; train_gene_expr_recon_loss: 1440987.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2234260.1618; train_optim_loss: 2234260.1618; val_kl_reg_loss: 9798.8800; val_edge_recon_loss: 782998.6125; val_gene_expr_recon_loss: 1452767.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2245565.1500; val_optim_loss: 2245565.1500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9667; val_auprc_score: 0.9909; val_best_acc_score: 0.9652; val_best_f1_score: 0.9799; train_kl_reg_loss: 9977.8509; train_edge_recon_loss: 789506.6728; train_gene_expr_recon_loss: 1429701.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2229185.7309; train_optim_loss: 2229185.7309; val_kl_reg_loss: 10060.2963; val_edge_recon_loss: 798489.5250; val_gene_expr_recon_loss: 1447635.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2256185.5250; val_optim_loss: 2256185.5250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9709; val_auprc_score: 0.9933; val_best_acc_score: 0.9661; val_best_f1_score: 0.9804; train_kl_reg_loss: 10068.4550; train_edge_recon_loss: 774319.3456; train_gene_expr_recon_loss: 1418745.5294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2203133.3353; train_optim_loss: 2203133.3353; val_kl_reg_loss: 9866.9186; val_edge_recon_loss: 763807.0563; val_gene_expr_recon_loss: 1439347.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2213021.1250; val_optim_loss: 2213021.1250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9703; val_auprc_score: 0.9933; val_best_acc_score: 0.9640; val_best_f1_score: 0.9793; train_kl_reg_loss: 10012.4572; train_edge_recon_loss: 777395.4963; train_gene_expr_recon_loss: 1408484.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2195892.1662; train_optim_loss: 2195892.1662; val_kl_reg_loss: 9757.8799; val_edge_recon_loss: 764494.3000; val_gene_expr_recon_loss: 1433417.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2207669.9875; val_optim_loss: 2207669.9875
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9644; val_auprc_score: 0.9885; val_best_acc_score: 0.9674; val_best_f1_score: 0.9812; train_kl_reg_loss: 10107.7084; train_edge_recon_loss: 781620.8176; train_gene_expr_recon_loss: 1394398.4471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2186126.9765; train_optim_loss: 2186126.9765; val_kl_reg_loss: 9858.3758; val_edge_recon_loss: 792353.1375; val_gene_expr_recon_loss: 1424032.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2226243.8750; val_optim_loss: 2226243.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9611; val_auprc_score: 0.9880; val_best_acc_score: 0.9689; val_best_f1_score: 0.9820; train_kl_reg_loss: 10103.8732; train_edge_recon_loss: 766353.4132; train_gene_expr_recon_loss: 1385731.7618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2162189.0500; train_optim_loss: 2162189.0500; val_kl_reg_loss: 10114.3109; val_edge_recon_loss: 800398.8313; val_gene_expr_recon_loss: 1413076.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2223589.4250; val_optim_loss: 2223589.4250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9584; val_auprc_score: 0.9846; val_best_acc_score: 0.9693; val_best_f1_score: 0.9823; train_kl_reg_loss: 10155.3780; train_edge_recon_loss: 789043.1471; train_gene_expr_recon_loss: 1374533.5824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2173732.1235; train_optim_loss: 2173732.1235; val_kl_reg_loss: 9984.3486; val_edge_recon_loss: 775627.4375; val_gene_expr_recon_loss: 1392216.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2177828.5500; val_optim_loss: 2177828.5500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9669; val_auprc_score: 0.9895; val_best_acc_score: 0.9703; val_best_f1_score: 0.9827; train_kl_reg_loss: 10136.9974; train_edge_recon_loss: 777021.5603; train_gene_expr_recon_loss: 1364102.9059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2151261.4500; train_optim_loss: 2151261.4500; val_kl_reg_loss: 9926.7869; val_edge_recon_loss: 779575.8313; val_gene_expr_recon_loss: 1389612.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2179114.7750; val_optim_loss: 2179114.7750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9582; val_auprc_score: 0.9845; val_best_acc_score: 0.9677; val_best_f1_score: 0.9813; train_kl_reg_loss: 10123.3873; train_edge_recon_loss: 788015.5831; train_gene_expr_recon_loss: 1353738.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2151877.8485; train_optim_loss: 2151877.8485; val_kl_reg_loss: 10308.3923; val_edge_recon_loss: 805646.2250; val_gene_expr_recon_loss: 1383265.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2199220.4750; val_optim_loss: 2199220.4750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9709; val_auprc_score: 0.9919; val_best_acc_score: 0.9707; val_best_f1_score: 0.9830; train_kl_reg_loss: 10282.0742; train_edge_recon_loss: 785376.0750; train_gene_expr_recon_loss: 1348123.8956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2143782.0471; train_optim_loss: 2143782.0471; val_kl_reg_loss: 10283.5522; val_edge_recon_loss: 793057.8000; val_gene_expr_recon_loss: 1374954.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2178296.2125; val_optim_loss: 2178296.2125
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9659; val_auprc_score: 0.9861; val_best_acc_score: 0.9742; val_best_f1_score: 0.9850; train_kl_reg_loss: 10359.1460; train_edge_recon_loss: 778139.7456; train_gene_expr_recon_loss: 1339185.4176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2127684.3015; train_optim_loss: 2127684.3015; val_kl_reg_loss: 10177.4765; val_edge_recon_loss: 773949.3313; val_gene_expr_recon_loss: 1356957.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2141084.1250; val_optim_loss: 2141084.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9645; val_auprc_score: 0.9893; val_best_acc_score: 0.9691; val_best_f1_score: 0.9820; train_kl_reg_loss: 10343.0265; train_edge_recon_loss: 767687.3588; train_gene_expr_recon_loss: 1330375.2162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2108405.6015; train_optim_loss: 2108405.6015; val_kl_reg_loss: 10554.4915; val_edge_recon_loss: 779365.8750; val_gene_expr_recon_loss: 1356506.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2146426.9250; val_optim_loss: 2146426.9250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9715; val_auprc_score: 0.9923; val_best_acc_score: 0.9727; val_best_f1_score: 0.9842; train_kl_reg_loss: 10401.1657; train_edge_recon_loss: 775700.0426; train_gene_expr_recon_loss: 1323829.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2109931.1206; train_optim_loss: 2109931.1206; val_kl_reg_loss: 10122.1339; val_edge_recon_loss: 768784.9688; val_gene_expr_recon_loss: 1357395.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2136303.0125; val_optim_loss: 2136303.0125
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9704; val_auprc_score: 0.9914; val_best_acc_score: 0.9702; val_best_f1_score: 0.9827; train_kl_reg_loss: 10336.8556; train_edge_recon_loss: 780460.4574; train_gene_expr_recon_loss: 1318442.1912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2109239.5088; train_optim_loss: 2109239.5088; val_kl_reg_loss: 10359.1387; val_edge_recon_loss: 793389.6062; val_gene_expr_recon_loss: 1358943.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2162691.8375; val_optim_loss: 2162691.8375
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9676; val_auprc_score: 0.9893; val_best_acc_score: 0.9729; val_best_f1_score: 0.9843; train_kl_reg_loss: 10429.1901; train_edge_recon_loss: 781893.9478; train_gene_expr_recon_loss: 1308877.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2101200.4882; train_optim_loss: 2101200.4882; val_kl_reg_loss: 10276.0309; val_edge_recon_loss: 764766.9187; val_gene_expr_recon_loss: 1336802.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2111845.4375; val_optim_loss: 2111845.4375
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9682; val_auprc_score: 0.9884; val_best_acc_score: 0.9746; val_best_f1_score: 0.9853; train_kl_reg_loss: 10559.8618; train_edge_recon_loss: 782513.6978; train_gene_expr_recon_loss: 1302516.2103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2095589.7779; train_optim_loss: 2095589.7779; val_kl_reg_loss: 10377.0555; val_edge_recon_loss: 748278.4875; val_gene_expr_recon_loss: 1330564.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2089219.8625; val_optim_loss: 2089219.8625
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9604; val_auprc_score: 0.9870; val_best_acc_score: 0.9685; val_best_f1_score: 0.9818; train_kl_reg_loss: 10549.4560; train_edge_recon_loss: 787079.3301; train_gene_expr_recon_loss: 1295700.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2093329.6176; train_optim_loss: 2093329.6176; val_kl_reg_loss: 10683.3520; val_edge_recon_loss: 769219.4375; val_gene_expr_recon_loss: 1322678.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2102581.0500; val_optim_loss: 2102581.0500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9637; val_auprc_score: 0.9859; val_best_acc_score: 0.9712; val_best_f1_score: 0.9833; train_kl_reg_loss: 10596.4338; train_edge_recon_loss: 774573.4985; train_gene_expr_recon_loss: 1289477.5809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2074647.5074; train_optim_loss: 2074647.5074; val_kl_reg_loss: 10771.2955; val_edge_recon_loss: 789383.7375; val_gene_expr_recon_loss: 1323191.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2123346.3375; val_optim_loss: 2123346.3375
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9631; val_auprc_score: 0.9875; val_best_acc_score: 0.9725; val_best_f1_score: 0.9841; train_kl_reg_loss: 10499.9981; train_edge_recon_loss: 780443.9875; train_gene_expr_recon_loss: 1285672.3853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2076616.3662; train_optim_loss: 2076616.3662; val_kl_reg_loss: 10441.6966; val_edge_recon_loss: 747950.6250; val_gene_expr_recon_loss: 1315520.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2073913.1500; val_optim_loss: 2073913.1500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9652; val_auprc_score: 0.9896; val_best_acc_score: 0.9734; val_best_f1_score: 0.9847; train_kl_reg_loss: 10491.0787; train_edge_recon_loss: 766353.7912; train_gene_expr_recon_loss: 1279268.9044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2056113.7853; train_optim_loss: 2056113.7853; val_kl_reg_loss: 10414.3843; val_edge_recon_loss: 763633.0188; val_gene_expr_recon_loss: 1308517.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2082565.3000; val_optim_loss: 2082565.3000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9626; val_auprc_score: 0.9895; val_best_acc_score: 0.9675; val_best_f1_score: 0.9811; train_kl_reg_loss: 10608.6436; train_edge_recon_loss: 776924.7949; train_gene_expr_recon_loss: 1274315.0162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2061848.4588; train_optim_loss: 2061848.4588; val_kl_reg_loss: 10626.1743; val_edge_recon_loss: 803377.9625; val_gene_expr_recon_loss: 1317206.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2131210.4125; val_optim_loss: 2131210.4125
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9618; val_auprc_score: 0.9875; val_best_acc_score: 0.9685; val_best_f1_score: 0.9817; train_kl_reg_loss: 10764.9058; train_edge_recon_loss: 783319.2331; train_gene_expr_recon_loss: 1272662.6544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2066746.7691; train_optim_loss: 2066746.7691; val_kl_reg_loss: 10755.9034; val_edge_recon_loss: 820355.5188; val_gene_expr_recon_loss: 1310354.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2141465.9625; val_optim_loss: 2141465.9625
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9696; val_auprc_score: 0.9900; val_best_acc_score: 0.9733; val_best_f1_score: 0.9846; train_kl_reg_loss: 10775.8842; train_edge_recon_loss: 781298.0191; train_gene_expr_recon_loss: 1265641.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2057715.2500; train_optim_loss: 2057715.2500; val_kl_reg_loss: 10652.2258; val_edge_recon_loss: 775735.7688; val_gene_expr_recon_loss: 1313786.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2100174.4000; val_optim_loss: 2100174.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9707; val_auprc_score: 0.9920; val_best_acc_score: 0.9691; val_best_f1_score: 0.9820; train_kl_reg_loss: 10735.1813; train_edge_recon_loss: 783558.5176; train_gene_expr_recon_loss: 1254716.4059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2049010.0985; train_optim_loss: 2049010.0985; val_kl_reg_loss: 10879.1049; val_edge_recon_loss: 820821.6250; val_gene_expr_recon_loss: 1297224.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2128924.7375; val_optim_loss: 2128924.7375
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9705; val_auprc_score: 0.9898; val_best_acc_score: 0.9729; val_best_f1_score: 0.9843; train_kl_reg_loss: 10853.7288; train_edge_recon_loss: 770906.4699; train_gene_expr_recon_loss: 1252567.7162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2034327.9294; train_optim_loss: 2034327.9294; val_kl_reg_loss: 10854.9254; val_edge_recon_loss: 770039.0687; val_gene_expr_recon_loss: 1288262.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2069156.4625; val_optim_loss: 2069156.4625
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9768; val_auprc_score: 0.9944; val_best_acc_score: 0.9722; val_best_f1_score: 0.9839; train_kl_reg_loss: 10867.1941; train_edge_recon_loss: 784758.9482; train_gene_expr_recon_loss: 1251728.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2047354.6765; train_optim_loss: 2047354.6765; val_kl_reg_loss: 10788.6985; val_edge_recon_loss: 775642.9625; val_gene_expr_recon_loss: 1299621.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2086053.6625; val_optim_loss: 2086053.6625
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9647; val_auprc_score: 0.9873; val_best_acc_score: 0.9728; val_best_f1_score: 0.9842; train_kl_reg_loss: 10859.8427; train_edge_recon_loss: 770091.4022; train_gene_expr_recon_loss: 1250342.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2031293.2721; train_optim_loss: 2031293.2721; val_kl_reg_loss: 10887.5675; val_edge_recon_loss: 767686.7063; val_gene_expr_recon_loss: 1296462.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2075036.8000; val_optim_loss: 2075036.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9621; val_auprc_score: 0.9857; val_best_acc_score: 0.9717; val_best_f1_score: 0.9836; train_kl_reg_loss: 10869.7302; train_edge_recon_loss: 781546.4088; train_gene_expr_recon_loss: 1250240.4912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2042656.6338; train_optim_loss: 2042656.6338; val_kl_reg_loss: 10929.9721; val_edge_recon_loss: 792548.8125; val_gene_expr_recon_loss: 1297535.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2101014.3125; val_optim_loss: 2101014.3125
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9757; val_auprc_score: 0.9937; val_best_acc_score: 0.9757; val_best_f1_score: 0.9859; train_kl_reg_loss: 10923.9588; train_edge_recon_loss: 782867.3493; train_gene_expr_recon_loss: 1247896.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2041687.4235; train_optim_loss: 2041687.4235; val_kl_reg_loss: 10916.8802; val_edge_recon_loss: 757775.4625; val_gene_expr_recon_loss: 1293110.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2061802.9000; val_optim_loss: 2061802.9000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9650; val_auprc_score: 0.9868; val_best_acc_score: 0.9726; val_best_f1_score: 0.9841; train_kl_reg_loss: 10902.0370; train_edge_recon_loss: 779862.4544; train_gene_expr_recon_loss: 1248336.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2039100.8926; train_optim_loss: 2039100.8926; val_kl_reg_loss: 10886.4344; val_edge_recon_loss: 775248.8063; val_gene_expr_recon_loss: 1296561.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2082696.7125; val_optim_loss: 2082696.7125
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9630; val_auprc_score: 0.9866; val_best_acc_score: 0.9719; val_best_f1_score: 0.9837; train_kl_reg_loss: 10870.6340; train_edge_recon_loss: 787375.0956; train_gene_expr_recon_loss: 1246095.8721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2044341.6044; train_optim_loss: 2044341.6044; val_kl_reg_loss: 10835.3011; val_edge_recon_loss: 785872.2312; val_gene_expr_recon_loss: 1298560.3375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2095267.9000; val_optim_loss: 2095267.9000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9653; val_auprc_score: 0.9891; val_best_acc_score: 0.9720; val_best_f1_score: 0.9837; train_kl_reg_loss: 10875.2703; train_edge_recon_loss: 780426.1412; train_gene_expr_recon_loss: 1248679.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2039981.0544; train_optim_loss: 2039981.0544; val_kl_reg_loss: 10901.2237; val_edge_recon_loss: 791398.7937; val_gene_expr_recon_loss: 1293285.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2095585.2750; val_optim_loss: 2095585.2750
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9701; val_auprc_score: 0.9911; val_best_acc_score: 0.9730; val_best_f1_score: 0.9843; train_kl_reg_loss: 10877.5786; train_edge_recon_loss: 779800.0824; train_gene_expr_recon_loss: 1245408.9088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2036086.5735; train_optim_loss: 2036086.5735; val_kl_reg_loss: 10855.9621; val_edge_recon_loss: 788811.0687; val_gene_expr_recon_loss: 1293269.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2092936.6875; val_optim_loss: 2092936.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9751; val_auprc_score: 0.9932; val_best_acc_score: 0.9721; val_best_f1_score: 0.9837; train_kl_reg_loss: 10842.2353; train_edge_recon_loss: 770487.0897; train_gene_expr_recon_loss: 1244218.4309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2025547.7588; train_optim_loss: 2025547.7588; val_kl_reg_loss: 10830.2962; val_edge_recon_loss: 816974.9875; val_gene_expr_recon_loss: 1287190.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2114995.4500; val_optim_loss: 2114995.4500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9676; val_auprc_score: 0.9893; val_best_acc_score: 0.9726; val_best_f1_score: 0.9839; train_kl_reg_loss: 10879.0015; train_edge_recon_loss: 770227.6456; train_gene_expr_recon_loss: 1245827.1765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2026933.8265; train_optim_loss: 2026933.8265; val_kl_reg_loss: 10873.3541; val_edge_recon_loss: 813848.6562; val_gene_expr_recon_loss: 1298083.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2122805.7875; val_optim_loss: 2122805.7875
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9678; val_auprc_score: 0.9912; val_best_acc_score: 0.9698; val_best_f1_score: 0.9825; train_kl_reg_loss: 10873.7465; train_edge_recon_loss: 781585.0669; train_gene_expr_recon_loss: 1245989.0647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2038447.8868; train_optim_loss: 2038447.8868; val_kl_reg_loss: 10875.5697; val_edge_recon_loss: 793699.4250; val_gene_expr_recon_loss: 1296080.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2100655.2875; val_optim_loss: 2100655.2875
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9695; val_auprc_score: 0.9909; val_best_acc_score: 0.9727; val_best_f1_score: 0.9842; train_kl_reg_loss: 10851.2851; train_edge_recon_loss: 779318.2971; train_gene_expr_recon_loss: 1245513.5809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2035683.1662; train_optim_loss: 2035683.1662; val_kl_reg_loss: 10884.7688; val_edge_recon_loss: 777177.2937; val_gene_expr_recon_loss: 1293453.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2081515.4000; val_optim_loss: 2081515.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 21 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9782
val AUPRC score: 0.9941
val best accuracy score: 0.9738
val best F1 score: 0.9848
val target rna MSE score: 0.8396
val source rna MSE score: 0.1113
Val cat covariate0 mean sim diff: 0.0035
Duration of model training in run 8: 0 hours, 22 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8044; val_auprc_score: 0.9572; val_best_acc_score: 0.8769; val_best_f1_score: 0.9328; train_kl_reg_loss: 5288.8431; train_edge_recon_loss: 1013029.2978; train_gene_expr_recon_loss: 2123399.3412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141717.4941; train_optim_loss: 3141717.4941; val_kl_reg_loss: 8654.1895; val_edge_recon_loss: 1014086.3125; val_gene_expr_recon_loss: 1984991.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3007731.8500; val_optim_loss: 3007731.8500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8326; val_auprc_score: 0.9620; val_best_acc_score: 0.8813; val_best_f1_score: 0.9338; train_kl_reg_loss: 10620.1020; train_edge_recon_loss: 949418.2375; train_gene_expr_recon_loss: 1891311.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2851349.5294; train_optim_loss: 2851349.5294; val_kl_reg_loss: 10972.9056; val_edge_recon_loss: 967325.1312; val_gene_expr_recon_loss: 1869816.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2848114.3750; val_optim_loss: 2848114.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8679; val_auprc_score: 0.9663; val_best_acc_score: 0.8955; val_best_f1_score: 0.9407; train_kl_reg_loss: 11411.6837; train_edge_recon_loss: 885923.9662; train_gene_expr_recon_loss: 1816765.0647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2714100.7118; train_optim_loss: 2714100.7118; val_kl_reg_loss: 11159.1934; val_edge_recon_loss: 916320.8313; val_gene_expr_recon_loss: 1828257.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2755737.6500; val_optim_loss: 2755737.6500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9111; val_auprc_score: 0.9782; val_best_acc_score: 0.9196; val_best_f1_score: 0.9543; train_kl_reg_loss: 12251.5933; train_edge_recon_loss: 858121.7265; train_gene_expr_recon_loss: 1771707.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2642081.0176; train_optim_loss: 2642081.0176; val_kl_reg_loss: 11872.1829; val_edge_recon_loss: 846645.6125; val_gene_expr_recon_loss: 1778224.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2636741.8250; val_optim_loss: 2636741.8250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9201; val_auprc_score: 0.9808; val_best_acc_score: 0.9276; val_best_f1_score: 0.9585; train_kl_reg_loss: 11982.2289; train_edge_recon_loss: 838933.7816; train_gene_expr_recon_loss: 1735442.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2586358.2147; train_optim_loss: 2586358.2147; val_kl_reg_loss: 12340.3133; val_edge_recon_loss: 855342.0500; val_gene_expr_recon_loss: 1748849.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2616532.0250; val_optim_loss: 2616532.0250
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9347; val_auprc_score: 0.9827; val_best_acc_score: 0.9303; val_best_f1_score: 0.9594; train_kl_reg_loss: 12643.8451; train_edge_recon_loss: 821513.8132; train_gene_expr_recon_loss: 1706203.9868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2540361.6471; train_optim_loss: 2540361.6471; val_kl_reg_loss: 13338.2851; val_edge_recon_loss: 863007.8125; val_gene_expr_recon_loss: 1713368.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2589714.9000; val_optim_loss: 2589714.9000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9368; val_auprc_score: 0.9817; val_best_acc_score: 0.9428; val_best_f1_score: 0.9671; train_kl_reg_loss: 12973.4449; train_edge_recon_loss: 816731.5426; train_gene_expr_recon_loss: 1681990.8250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2511695.8118; train_optim_loss: 2511695.8118; val_kl_reg_loss: 13005.7575; val_edge_recon_loss: 807822.6000; val_gene_expr_recon_loss: 1701964.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2522793.2500; val_optim_loss: 2522793.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9380; val_auprc_score: 0.9841; val_best_acc_score: 0.9400; val_best_f1_score: 0.9655; train_kl_reg_loss: 13023.9072; train_edge_recon_loss: 800697.3824; train_gene_expr_recon_loss: 1662210.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2475932.0118; train_optim_loss: 2475932.0118; val_kl_reg_loss: 12702.4215; val_edge_recon_loss: 848546.9000; val_gene_expr_recon_loss: 1678048.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2539298.0500; val_optim_loss: 2539298.0500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9359; val_auprc_score: 0.9837; val_best_acc_score: 0.9421; val_best_f1_score: 0.9666; train_kl_reg_loss: 12656.1696; train_edge_recon_loss: 805774.8750; train_gene_expr_recon_loss: 1643547.2926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2461978.3382; train_optim_loss: 2461978.3382; val_kl_reg_loss: 12245.8288; val_edge_recon_loss: 837868.8688; val_gene_expr_recon_loss: 1657257.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2507371.8000; val_optim_loss: 2507371.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9414; val_auprc_score: 0.9813; val_best_acc_score: 0.9521; val_best_f1_score: 0.9725; train_kl_reg_loss: 12278.5118; train_edge_recon_loss: 799952.5625; train_gene_expr_recon_loss: 1625839.9485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2438071.0265; train_optim_loss: 2438071.0265; val_kl_reg_loss: 11791.3417; val_edge_recon_loss: 784176.4187; val_gene_expr_recon_loss: 1651637.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2447605.3750; val_optim_loss: 2447605.3750
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9399; val_auprc_score: 0.9845; val_best_acc_score: 0.9563; val_best_f1_score: 0.9749; train_kl_reg_loss: 12071.2482; train_edge_recon_loss: 796910.7324; train_gene_expr_recon_loss: 1609643.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2418624.9941; train_optim_loss: 2418624.9941; val_kl_reg_loss: 11952.9145; val_edge_recon_loss: 770310.2000; val_gene_expr_recon_loss: 1648984.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2431247.2750; val_optim_loss: 2431247.2750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9495; val_auprc_score: 0.9864; val_best_acc_score: 0.9521; val_best_f1_score: 0.9724; train_kl_reg_loss: 11945.7129; train_edge_recon_loss: 806820.8382; train_gene_expr_recon_loss: 1593057.7824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2411824.3353; train_optim_loss: 2411824.3353; val_kl_reg_loss: 11723.0155; val_edge_recon_loss: 793932.9375; val_gene_expr_recon_loss: 1609171.6125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2414827.5750; val_optim_loss: 2414827.5750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9527; val_auprc_score: 0.9860; val_best_acc_score: 0.9555; val_best_f1_score: 0.9743; train_kl_reg_loss: 11861.6969; train_edge_recon_loss: 793397.5941; train_gene_expr_recon_loss: 1581568.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2386827.8441; train_optim_loss: 2386827.8441; val_kl_reg_loss: 11654.8021; val_edge_recon_loss: 793952.0750; val_gene_expr_recon_loss: 1595482.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2401089.5000; val_optim_loss: 2401089.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9553; val_auprc_score: 0.9879; val_best_acc_score: 0.9541; val_best_f1_score: 0.9737; train_kl_reg_loss: 11738.1392; train_edge_recon_loss: 785999.3331; train_gene_expr_recon_loss: 1567277.3309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2365014.8029; train_optim_loss: 2365014.8029; val_kl_reg_loss: 11603.8957; val_edge_recon_loss: 787509.5938; val_gene_expr_recon_loss: 1589318.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2388431.9000; val_optim_loss: 2388431.9000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9456; val_auprc_score: 0.9827; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 11777.4233; train_edge_recon_loss: 791503.2882; train_gene_expr_recon_loss: 1555390.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2358671.0941; train_optim_loss: 2358671.0941; val_kl_reg_loss: 11480.1532; val_edge_recon_loss: 802979.4000; val_gene_expr_recon_loss: 1564357.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2378816.8750; val_optim_loss: 2378816.8750
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9527; val_auprc_score: 0.9876; val_best_acc_score: 0.9581; val_best_f1_score: 0.9757; train_kl_reg_loss: 11535.3550; train_edge_recon_loss: 795661.4625; train_gene_expr_recon_loss: 1542826.9338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2350023.7500; train_optim_loss: 2350023.7500; val_kl_reg_loss: 11535.6779; val_edge_recon_loss: 798464.0563; val_gene_expr_recon_loss: 1566995.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2376995.0000; val_optim_loss: 2376995.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9545; val_auprc_score: 0.9868; val_best_acc_score: 0.9580; val_best_f1_score: 0.9757; train_kl_reg_loss: 11330.9061; train_edge_recon_loss: 787356.2051; train_gene_expr_recon_loss: 1530011.9074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2328699.0029; train_optim_loss: 2328699.0029; val_kl_reg_loss: 11075.1972; val_edge_recon_loss: 812665.4375; val_gene_expr_recon_loss: 1546084.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2369825.4250; val_optim_loss: 2369825.4250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9461; val_auprc_score: 0.9827; val_best_acc_score: 0.9585; val_best_f1_score: 0.9761; train_kl_reg_loss: 11228.9510; train_edge_recon_loss: 779543.1279; train_gene_expr_recon_loss: 1519376.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2310148.0853; train_optim_loss: 2310148.0853; val_kl_reg_loss: 11199.4584; val_edge_recon_loss: 783127.4750; val_gene_expr_recon_loss: 1536352.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2330679.3250; val_optim_loss: 2330679.3250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9457; val_auprc_score: 0.9819; val_best_acc_score: 0.9534; val_best_f1_score: 0.9730; train_kl_reg_loss: 10984.2084; train_edge_recon_loss: 786669.2169; train_gene_expr_recon_loss: 1507471.8279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2305125.2382; train_optim_loss: 2305125.2382; val_kl_reg_loss: 11129.1741; val_edge_recon_loss: 807691.4187; val_gene_expr_recon_loss: 1541061.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2359881.9000; val_optim_loss: 2359881.9000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9554; val_auprc_score: 0.9860; val_best_acc_score: 0.9613; val_best_f1_score: 0.9775; train_kl_reg_loss: 11083.2875; train_edge_recon_loss: 786440.4963; train_gene_expr_recon_loss: 1497793.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2295316.9971; train_optim_loss: 2295316.9971; val_kl_reg_loss: 10943.7239; val_edge_recon_loss: 807031.3000; val_gene_expr_recon_loss: 1535458.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2353433.0500; val_optim_loss: 2353433.0500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9524; val_auprc_score: 0.9846; val_best_acc_score: 0.9606; val_best_f1_score: 0.9772; train_kl_reg_loss: 10812.1999; train_edge_recon_loss: 782102.3221; train_gene_expr_recon_loss: 1483825.4221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2276739.9559; train_optim_loss: 2276739.9559; val_kl_reg_loss: 10920.2600; val_edge_recon_loss: 795905.8187; val_gene_expr_recon_loss: 1509577.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2316403.4250; val_optim_loss: 2316403.4250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9510; val_auprc_score: 0.9850; val_best_acc_score: 0.9611; val_best_f1_score: 0.9774; train_kl_reg_loss: 10855.8126; train_edge_recon_loss: 784520.0191; train_gene_expr_recon_loss: 1473235.9235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2268611.7632; train_optim_loss: 2268611.7632; val_kl_reg_loss: 11097.9948; val_edge_recon_loss: 820541.3313; val_gene_expr_recon_loss: 1494688.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2326328.0000; val_optim_loss: 2326328.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9520; val_auprc_score: 0.9870; val_best_acc_score: 0.9636; val_best_f1_score: 0.9790; train_kl_reg_loss: 10967.0681; train_edge_recon_loss: 783749.6044; train_gene_expr_recon_loss: 1461977.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2256693.6765; train_optim_loss: 2256693.6765; val_kl_reg_loss: 11350.3788; val_edge_recon_loss: 776245.8750; val_gene_expr_recon_loss: 1500307.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2287903.5250; val_optim_loss: 2287903.5250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9571; val_auprc_score: 0.9869; val_best_acc_score: 0.9647; val_best_f1_score: 0.9798; train_kl_reg_loss: 10911.2882; train_edge_recon_loss: 789094.2059; train_gene_expr_recon_loss: 1449269.7706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2249275.2676; train_optim_loss: 2249275.2676; val_kl_reg_loss: 10770.6189; val_edge_recon_loss: 753045.6375; val_gene_expr_recon_loss: 1478738.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2242555.0000; val_optim_loss: 2242555.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9571; val_auprc_score: 0.9902; val_best_acc_score: 0.9629; val_best_f1_score: 0.9787; train_kl_reg_loss: 10887.0497; train_edge_recon_loss: 778011.4110; train_gene_expr_recon_loss: 1437366.4779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2226264.9221; train_optim_loss: 2226264.9221; val_kl_reg_loss: 10746.0390; val_edge_recon_loss: 767352.4938; val_gene_expr_recon_loss: 1469134.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2247233.0500; val_optim_loss: 2247233.0500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9644; val_auprc_score: 0.9888; val_best_acc_score: 0.9658; val_best_f1_score: 0.9803; train_kl_reg_loss: 10658.5882; train_edge_recon_loss: 775120.9368; train_gene_expr_recon_loss: 1426531.5015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2212311.0309; train_optim_loss: 2212311.0309; val_kl_reg_loss: 10656.3443; val_edge_recon_loss: 777635.1000; val_gene_expr_recon_loss: 1455659.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2243950.7250; val_optim_loss: 2243950.7250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9633; val_auprc_score: 0.9898; val_best_acc_score: 0.9696; val_best_f1_score: 0.9826; train_kl_reg_loss: 10685.3165; train_edge_recon_loss: 786925.2743; train_gene_expr_recon_loss: 1417296.3191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2214906.9118; train_optim_loss: 2214906.9118; val_kl_reg_loss: 10765.1679; val_edge_recon_loss: 728038.9375; val_gene_expr_recon_loss: 1449640.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2188444.9500; val_optim_loss: 2188444.9500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9594; val_auprc_score: 0.9847; val_best_acc_score: 0.9635; val_best_f1_score: 0.9787; train_kl_reg_loss: 10833.8160; train_edge_recon_loss: 781969.3088; train_gene_expr_recon_loss: 1405076.4956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2197879.6206; train_optim_loss: 2197879.6206; val_kl_reg_loss: 11063.8952; val_edge_recon_loss: 829195.5875; val_gene_expr_recon_loss: 1433109.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2273369.4250; val_optim_loss: 2273369.4250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9595; val_auprc_score: 0.9885; val_best_acc_score: 0.9652; val_best_f1_score: 0.9799; train_kl_reg_loss: 10711.8899; train_edge_recon_loss: 781636.0191; train_gene_expr_recon_loss: 1395238.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2187585.9426; train_optim_loss: 2187585.9426; val_kl_reg_loss: 10476.6791; val_edge_recon_loss: 782549.6687; val_gene_expr_recon_loss: 1430934.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2223961.2500; val_optim_loss: 2223961.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9683; val_auprc_score: 0.9900; val_best_acc_score: 0.9694; val_best_f1_score: 0.9822; train_kl_reg_loss: 10853.4901; train_edge_recon_loss: 762784.3360; train_gene_expr_recon_loss: 1384850.8588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2158488.6868; train_optim_loss: 2158488.6868; val_kl_reg_loss: 10810.2271; val_edge_recon_loss: 790679.9563; val_gene_expr_recon_loss: 1420672.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2222162.9375; val_optim_loss: 2222162.9375
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9609; val_auprc_score: 0.9880; val_best_acc_score: 0.9671; val_best_f1_score: 0.9811; train_kl_reg_loss: 10748.8989; train_edge_recon_loss: 794686.5765; train_gene_expr_recon_loss: 1374385.1971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2179820.6721; train_optim_loss: 2179820.6721; val_kl_reg_loss: 10574.2140; val_edge_recon_loss: 759371.2000; val_gene_expr_recon_loss: 1416941.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2186886.8500; val_optim_loss: 2186886.8500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9609; val_auprc_score: 0.9902; val_best_acc_score: 0.9664; val_best_f1_score: 0.9807; train_kl_reg_loss: 10640.4169; train_edge_recon_loss: 786657.8706; train_gene_expr_recon_loss: 1369798.6353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2167096.9147; train_optim_loss: 2167096.9147; val_kl_reg_loss: 10934.1200; val_edge_recon_loss: 753887.6937; val_gene_expr_recon_loss: 1416946.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2181768.5125; val_optim_loss: 2181768.5125
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9655; val_auprc_score: 0.9898; val_best_acc_score: 0.9653; val_best_f1_score: 0.9799; train_kl_reg_loss: 10770.6543; train_edge_recon_loss: 769970.4831; train_gene_expr_recon_loss: 1360353.7309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2141094.8588; train_optim_loss: 2141094.8588; val_kl_reg_loss: 10623.9692; val_edge_recon_loss: 806868.8812; val_gene_expr_recon_loss: 1406910.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2224403.8250; val_optim_loss: 2224403.8250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9613; val_auprc_score: 0.9839; val_best_acc_score: 0.9677; val_best_f1_score: 0.9812; train_kl_reg_loss: 10764.0800; train_edge_recon_loss: 789016.6846; train_gene_expr_recon_loss: 1352144.0574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2151924.8176; train_optim_loss: 2151924.8176; val_kl_reg_loss: 10627.9205; val_edge_recon_loss: 829256.8688; val_gene_expr_recon_loss: 1386657.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2226542.6750; val_optim_loss: 2226542.6750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9602; val_auprc_score: 0.9883; val_best_acc_score: 0.9652; val_best_f1_score: 0.9799; train_kl_reg_loss: 10693.9754; train_edge_recon_loss: 783974.1169; train_gene_expr_recon_loss: 1344654.4147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2139322.5074; train_optim_loss: 2139322.5074; val_kl_reg_loss: 10805.5867; val_edge_recon_loss: 779303.6000; val_gene_expr_recon_loss: 1387798.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2177907.2750; val_optim_loss: 2177907.2750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9581; val_auprc_score: 0.9872; val_best_acc_score: 0.9677; val_best_f1_score: 0.9813; train_kl_reg_loss: 10807.0825; train_edge_recon_loss: 780088.0669; train_gene_expr_recon_loss: 1333524.2324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2124419.3824; train_optim_loss: 2124419.3824; val_kl_reg_loss: 10862.8756; val_edge_recon_loss: 778065.6375; val_gene_expr_recon_loss: 1382677.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2171605.8875; val_optim_loss: 2171605.8875
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9648; val_auprc_score: 0.9890; val_best_acc_score: 0.9656; val_best_f1_score: 0.9801; train_kl_reg_loss: 10735.8128; train_edge_recon_loss: 776489.2949; train_gene_expr_recon_loss: 1325636.0397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2112861.1382; train_optim_loss: 2112861.1382; val_kl_reg_loss: 10605.2446; val_edge_recon_loss: 777887.7875; val_gene_expr_recon_loss: 1374296.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2162789.6375; val_optim_loss: 2162789.6375
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9603; val_auprc_score: 0.9871; val_best_acc_score: 0.9635; val_best_f1_score: 0.9788; train_kl_reg_loss: 10771.8740; train_edge_recon_loss: 775663.5368; train_gene_expr_recon_loss: 1322638.9235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2109074.3221; train_optim_loss: 2109074.3221; val_kl_reg_loss: 10737.0943; val_edge_recon_loss: 808983.9437; val_gene_expr_recon_loss: 1360256.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2179977.4750; val_optim_loss: 2179977.4750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9613; val_auprc_score: 0.9879; val_best_acc_score: 0.9648; val_best_f1_score: 0.9798; train_kl_reg_loss: 10817.5467; train_edge_recon_loss: 779146.8838; train_gene_expr_recon_loss: 1314201.2706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2104165.7088; train_optim_loss: 2104165.7088; val_kl_reg_loss: 10801.0476; val_edge_recon_loss: 752765.4812; val_gene_expr_recon_loss: 1360936.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2124502.9750; val_optim_loss: 2124502.9750
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9599; val_auprc_score: 0.9859; val_best_acc_score: 0.9695; val_best_f1_score: 0.9824; train_kl_reg_loss: 10812.5669; train_edge_recon_loss: 804187.7699; train_gene_expr_recon_loss: 1307033.0412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2122033.3779; train_optim_loss: 2122033.3779; val_kl_reg_loss: 10696.5877; val_edge_recon_loss: 773099.6813; val_gene_expr_recon_loss: 1348887.2375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2132683.4750; val_optim_loss: 2132683.4750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9661; val_auprc_score: 0.9878; val_best_acc_score: 0.9683; val_best_f1_score: 0.9816; train_kl_reg_loss: 10802.8223; train_edge_recon_loss: 780951.5000; train_gene_expr_recon_loss: 1299407.3603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2091161.6691; train_optim_loss: 2091161.6691; val_kl_reg_loss: 10907.4854; val_edge_recon_loss: 814345.6375; val_gene_expr_recon_loss: 1348593.2875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2173846.4500; val_optim_loss: 2173846.4500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9671; val_auprc_score: 0.9890; val_best_acc_score: 0.9673; val_best_f1_score: 0.9810; train_kl_reg_loss: 10903.4864; train_edge_recon_loss: 775684.0728; train_gene_expr_recon_loss: 1294288.2574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2080875.8147; train_optim_loss: 2080875.8147; val_kl_reg_loss: 10565.9732; val_edge_recon_loss: 810960.5750; val_gene_expr_recon_loss: 1337604.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2159131.1000; val_optim_loss: 2159131.1000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9533; val_auprc_score: 0.9858; val_best_acc_score: 0.9680; val_best_f1_score: 0.9816; train_kl_reg_loss: 10702.0699; train_edge_recon_loss: 792629.5390; train_gene_expr_recon_loss: 1293702.4118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2097034.0353; train_optim_loss: 2097034.0353; val_kl_reg_loss: 10740.4382; val_edge_recon_loss: 780386.5563; val_gene_expr_recon_loss: 1339557.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2130684.4500; val_optim_loss: 2130684.4500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9622; val_auprc_score: 0.9881; val_best_acc_score: 0.9696; val_best_f1_score: 0.9824; train_kl_reg_loss: 10669.6042; train_edge_recon_loss: 779729.7493; train_gene_expr_recon_loss: 1280343.6662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2070743.0206; train_optim_loss: 2070743.0206; val_kl_reg_loss: 10743.1055; val_edge_recon_loss: 785103.3500; val_gene_expr_recon_loss: 1340324.1000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2136170.5750; val_optim_loss: 2136170.5750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9692; val_auprc_score: 0.9905; val_best_acc_score: 0.9709; val_best_f1_score: 0.9831; train_kl_reg_loss: 10743.5236; train_edge_recon_loss: 777451.9250; train_gene_expr_recon_loss: 1278324.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2066519.8015; train_optim_loss: 2066519.8015; val_kl_reg_loss: 10763.4224; val_edge_recon_loss: 809636.5625; val_gene_expr_recon_loss: 1332552.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2152952.9625; val_optim_loss: 2152952.9625
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9662; val_auprc_score: 0.9895; val_best_acc_score: 0.9699; val_best_f1_score: 0.9827; train_kl_reg_loss: 10802.3178; train_edge_recon_loss: 764985.2324; train_gene_expr_recon_loss: 1276327.2485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2052114.8000; train_optim_loss: 2052114.8000; val_kl_reg_loss: 10872.5430; val_edge_recon_loss: 767437.1500; val_gene_expr_recon_loss: 1324639.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2102949.5875; val_optim_loss: 2102949.5875
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9586; val_auprc_score: 0.9891; val_best_acc_score: 0.9719; val_best_f1_score: 0.9838; train_kl_reg_loss: 10876.4223; train_edge_recon_loss: 779408.7096; train_gene_expr_recon_loss: 1276465.0515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2066750.1779; train_optim_loss: 2066750.1779; val_kl_reg_loss: 10877.0299; val_edge_recon_loss: 748508.9750; val_gene_expr_recon_loss: 1342512.7875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2101898.7750; val_optim_loss: 2101898.7750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9696; val_auprc_score: 0.9896; val_best_acc_score: 0.9729; val_best_f1_score: 0.9843; train_kl_reg_loss: 10913.0455; train_edge_recon_loss: 771176.5897; train_gene_expr_recon_loss: 1273510.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2055600.4926; train_optim_loss: 2055600.4926; val_kl_reg_loss: 10950.8097; val_edge_recon_loss: 758887.8313; val_gene_expr_recon_loss: 1336934.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2106773.1000; val_optim_loss: 2106773.1000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9537; val_auprc_score: 0.9839; val_best_acc_score: 0.9671; val_best_f1_score: 0.9811; train_kl_reg_loss: 10903.5149; train_edge_recon_loss: 774246.9706; train_gene_expr_recon_loss: 1273622.3015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2058772.7868; train_optim_loss: 2058772.7868; val_kl_reg_loss: 10912.2519; val_edge_recon_loss: 764960.3875; val_gene_expr_recon_loss: 1330363.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2106235.6250; val_optim_loss: 2106235.6250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9644; val_auprc_score: 0.9876; val_best_acc_score: 0.9697; val_best_f1_score: 0.9823; train_kl_reg_loss: 10930.9388; train_edge_recon_loss: 777260.4566; train_gene_expr_recon_loss: 1273727.1118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2061918.4897; train_optim_loss: 2061918.4897; val_kl_reg_loss: 10953.8427; val_edge_recon_loss: 810146.5250; val_gene_expr_recon_loss: 1339292.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2160392.5375; val_optim_loss: 2160392.5375
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9758; val_auprc_score: 0.9941; val_best_acc_score: 0.9741; val_best_f1_score: 0.9851; train_kl_reg_loss: 10955.5340; train_edge_recon_loss: 784059.3787; train_gene_expr_recon_loss: 1272621.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2067636.3382; train_optim_loss: 2067636.3382; val_kl_reg_loss: 10867.6045; val_edge_recon_loss: 752837.5375; val_gene_expr_recon_loss: 1319901.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2083607.0000; val_optim_loss: 2083607.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9725; val_auprc_score: 0.9924; val_best_acc_score: 0.9708; val_best_f1_score: 0.9830; train_kl_reg_loss: 10958.0539; train_edge_recon_loss: 781505.8750; train_gene_expr_recon_loss: 1270645.8221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2063109.7515; train_optim_loss: 2063109.7515; val_kl_reg_loss: 10898.1512; val_edge_recon_loss: 800328.0188; val_gene_expr_recon_loss: 1327390.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2138616.3750; val_optim_loss: 2138616.3750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9617; val_auprc_score: 0.9874; val_best_acc_score: 0.9699; val_best_f1_score: 0.9825; train_kl_reg_loss: 10967.6513; train_edge_recon_loss: 770819.7890; train_gene_expr_recon_loss: 1270816.5279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2052603.9632; train_optim_loss: 2052603.9632; val_kl_reg_loss: 10913.6658; val_edge_recon_loss: 777887.6125; val_gene_expr_recon_loss: 1325416.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2114217.5375; val_optim_loss: 2114217.5375
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9619; val_auprc_score: 0.9892; val_best_acc_score: 0.9699; val_best_f1_score: 0.9825; train_kl_reg_loss: 10965.7854; train_edge_recon_loss: 757012.3949; train_gene_expr_recon_loss: 1271361.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2039339.7544; train_optim_loss: 2039339.7544; val_kl_reg_loss: 10922.8035; val_edge_recon_loss: 785548.6875; val_gene_expr_recon_loss: 1339171.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2135643.2750; val_optim_loss: 2135643.2750
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9668; val_auprc_score: 0.9869; val_best_acc_score: 0.9730; val_best_f1_score: 0.9843; train_kl_reg_loss: 10985.7566; train_edge_recon_loss: 782693.0125; train_gene_expr_recon_loss: 1267144.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2060823.0676; train_optim_loss: 2060823.0676; val_kl_reg_loss: 10990.0589; val_edge_recon_loss: 770512.2750; val_gene_expr_recon_loss: 1324767.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2106270.2750; val_optim_loss: 2106270.2750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9640; val_auprc_score: 0.9865; val_best_acc_score: 0.9729; val_best_f1_score: 0.9844; train_kl_reg_loss: 11003.9037; train_edge_recon_loss: 778201.6904; train_gene_expr_recon_loss: 1268340.9897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2057546.5750; train_optim_loss: 2057546.5750; val_kl_reg_loss: 10971.9765; val_edge_recon_loss: 747200.5750; val_gene_expr_recon_loss: 1329195.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2087367.7750; val_optim_loss: 2087367.7750
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9679; val_auprc_score: 0.9899; val_best_acc_score: 0.9708; val_best_f1_score: 0.9829; train_kl_reg_loss: 11000.1472; train_edge_recon_loss: 772540.4257; train_gene_expr_recon_loss: 1268394.4250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2051934.9941; train_optim_loss: 2051934.9941; val_kl_reg_loss: 10984.9479; val_edge_recon_loss: 794022.1000; val_gene_expr_recon_loss: 1329446.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2134453.0875; val_optim_loss: 2134453.0875
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9722; val_auprc_score: 0.9924; val_best_acc_score: 0.9713; val_best_f1_score: 0.9834; train_kl_reg_loss: 11003.0013; train_edge_recon_loss: 774861.9235; train_gene_expr_recon_loss: 1266014.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2051879.3015; train_optim_loss: 2051879.3015; val_kl_reg_loss: 10994.5639; val_edge_recon_loss: 773994.5750; val_gene_expr_recon_loss: 1327574.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2112564.0125; val_optim_loss: 2112564.0125
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9660; val_auprc_score: 0.9874; val_best_acc_score: 0.9717; val_best_f1_score: 0.9836; train_kl_reg_loss: 10994.2693; train_edge_recon_loss: 775474.0860; train_gene_expr_recon_loss: 1267800.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2054269.3485; train_optim_loss: 2054269.3485; val_kl_reg_loss: 11033.3237; val_edge_recon_loss: 768216.0188; val_gene_expr_recon_loss: 1330647.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2109897.0000; val_optim_loss: 2109897.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 30 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9719
val AUPRC score: 0.9889
val best accuracy score: 0.9708
val best F1 score: 0.9830
val target rna MSE score: 0.8429
val source rna MSE score: 0.1227
Val cat covariate0 mean sim diff: -0.0015
Duration of model training in run 7: 0 hours, 21 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8641; val_auprc_score: 0.9689; val_best_acc_score: 0.8799; val_best_f1_score: 0.9329; train_kl_reg_loss: 5905.0121; train_edge_recon_loss: 1040015.3223; train_gene_expr_recon_loss: 2185468.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231388.9102; train_optim_loss: 3231388.9102; val_kl_reg_loss: 7914.7247; val_edge_recon_loss: 1078651.6172; val_gene_expr_recon_loss: 1981749.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3068315.7188; val_optim_loss: 3068315.7188
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8238; val_auprc_score: 0.9584; val_best_acc_score: 0.8798; val_best_f1_score: 0.9331; train_kl_reg_loss: 10727.8732; train_edge_recon_loss: 960008.0684; train_gene_expr_recon_loss: 1926155.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2896891.6953; train_optim_loss: 2896891.6953; val_kl_reg_loss: 11071.7408; val_edge_recon_loss: 979497.6953; val_gene_expr_recon_loss: 1877504.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2868073.9375; val_optim_loss: 2868073.9375
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8568; val_auprc_score: 0.9664; val_best_acc_score: 0.8872; val_best_f1_score: 0.9370; train_kl_reg_loss: 11421.8720; train_edge_recon_loss: 894038.1943; train_gene_expr_recon_loss: 1843209.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2748669.7734; train_optim_loss: 2748669.7734; val_kl_reg_loss: 12166.0930; val_edge_recon_loss: 799774.1641; val_gene_expr_recon_loss: 1825424.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2637364.7500; val_optim_loss: 2637364.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8935; val_auprc_score: 0.9746; val_best_acc_score: 0.9056; val_best_f1_score: 0.9460; train_kl_reg_loss: 12203.3605; train_edge_recon_loss: 876378.7549; train_gene_expr_recon_loss: 1799075.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2687658.0234; train_optim_loss: 2687658.0234; val_kl_reg_loss: 11903.4478; val_edge_recon_loss: 739351.3672; val_gene_expr_recon_loss: 1792243.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2543498.7500; val_optim_loss: 2543498.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8993; val_auprc_score: 0.9738; val_best_acc_score: 0.9211; val_best_f1_score: 0.9548; train_kl_reg_loss: 11868.3414; train_edge_recon_loss: 839639.4424; train_gene_expr_recon_loss: 1764837.2754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616345.0664; train_optim_loss: 2616345.0664; val_kl_reg_loss: 12693.4310; val_edge_recon_loss: 953344.5938; val_gene_expr_recon_loss: 1761917.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2727955.4062; val_optim_loss: 2727955.4062
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9105; val_auprc_score: 0.9783; val_best_acc_score: 0.9220; val_best_f1_score: 0.9554; train_kl_reg_loss: 12949.9773; train_edge_recon_loss: 832909.3711; train_gene_expr_recon_loss: 1738627.1270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2584486.4805; train_optim_loss: 2584486.4805; val_kl_reg_loss: 13413.8771; val_edge_recon_loss: 897738.0078; val_gene_expr_recon_loss: 1733867.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2645019.5625; val_optim_loss: 2645019.5625
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9322; val_auprc_score: 0.9825; val_best_acc_score: 0.9326; val_best_f1_score: 0.9613; train_kl_reg_loss: 13311.1799; train_edge_recon_loss: 818200.8418; train_gene_expr_recon_loss: 1712819.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2544331.4102; train_optim_loss: 2544331.4102; val_kl_reg_loss: 13034.2308; val_edge_recon_loss: 831365.0469; val_gene_expr_recon_loss: 1691594.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2535993.5000; val_optim_loss: 2535993.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9381; val_auprc_score: 0.9816; val_best_acc_score: 0.9356; val_best_f1_score: 0.9627; train_kl_reg_loss: 13362.2066; train_edge_recon_loss: 831953.6465; train_gene_expr_recon_loss: 1697657.9434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2542973.8047; train_optim_loss: 2542973.8047; val_kl_reg_loss: 14105.3573; val_edge_recon_loss: 856954.2500; val_gene_expr_recon_loss: 1696108.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2567167.9375; val_optim_loss: 2567167.9375
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9414; val_auprc_score: 0.9863; val_best_acc_score: 0.9415; val_best_f1_score: 0.9663; train_kl_reg_loss: 13225.7501; train_edge_recon_loss: 819401.6387; train_gene_expr_recon_loss: 1679780.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2512408.3086; train_optim_loss: 2512408.3086; val_kl_reg_loss: 13410.6200; val_edge_recon_loss: 855351.2422; val_gene_expr_recon_loss: 1674684.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2543446.3125; val_optim_loss: 2543446.3125
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9486; val_auprc_score: 0.9859; val_best_acc_score: 0.9439; val_best_f1_score: 0.9675; train_kl_reg_loss: 13065.2877; train_edge_recon_loss: 796419.7520; train_gene_expr_recon_loss: 1660792.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2470277.4141; train_optim_loss: 2470277.4141; val_kl_reg_loss: 12948.0963; val_edge_recon_loss: 910580.5625; val_gene_expr_recon_loss: 1676305.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2599833.6875; val_optim_loss: 2599833.6875
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9501; val_auprc_score: 0.9848; val_best_acc_score: 0.9482; val_best_f1_score: 0.9700; train_kl_reg_loss: 12812.8180; train_edge_recon_loss: 796236.1533; train_gene_expr_recon_loss: 1647952.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2457001.1641; train_optim_loss: 2457001.1641; val_kl_reg_loss: 12526.8125; val_edge_recon_loss: 812602.4453; val_gene_expr_recon_loss: 1661185.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2486314.8750; val_optim_loss: 2486314.8750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9498; val_auprc_score: 0.9855; val_best_acc_score: 0.9458; val_best_f1_score: 0.9687; train_kl_reg_loss: 12480.4544; train_edge_recon_loss: 799532.6328; train_gene_expr_recon_loss: 1636546.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2448559.5273; train_optim_loss: 2448559.5273; val_kl_reg_loss: 12403.6943; val_edge_recon_loss: 815999.0625; val_gene_expr_recon_loss: 1630080.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2458482.8750; val_optim_loss: 2458482.8750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9476; val_auprc_score: 0.9883; val_best_acc_score: 0.9449; val_best_f1_score: 0.9682; train_kl_reg_loss: 12380.0468; train_edge_recon_loss: 796923.4941; train_gene_expr_recon_loss: 1625312.7383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2434616.2852; train_optim_loss: 2434616.2852; val_kl_reg_loss: 11854.3794; val_edge_recon_loss: 790346.0391; val_gene_expr_recon_loss: 1633985.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2436185.8750; val_optim_loss: 2436185.8750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9442; val_auprc_score: 0.9875; val_best_acc_score: 0.9483; val_best_f1_score: 0.9705; train_kl_reg_loss: 12114.3870; train_edge_recon_loss: 794351.2441; train_gene_expr_recon_loss: 1614492.5996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2420958.2266; train_optim_loss: 2420958.2266; val_kl_reg_loss: 12102.2526; val_edge_recon_loss: 805074.3672; val_gene_expr_recon_loss: 1623278.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2440455.5625; val_optim_loss: 2440455.5625
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9472; val_auprc_score: 0.9847; val_best_acc_score: 0.9572; val_best_f1_score: 0.9757; train_kl_reg_loss: 11810.2429; train_edge_recon_loss: 797147.8057; train_gene_expr_recon_loss: 1599801.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2408759.2109; train_optim_loss: 2408759.2109; val_kl_reg_loss: 11505.6909; val_edge_recon_loss: 639367.1641; val_gene_expr_recon_loss: 1592551.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2243424.0312; val_optim_loss: 2243424.0312
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9404; val_auprc_score: 0.9826; val_best_acc_score: 0.9552; val_best_f1_score: 0.9743; train_kl_reg_loss: 11371.9332; train_edge_recon_loss: 797606.2480; train_gene_expr_recon_loss: 1587207.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2396186.0625; train_optim_loss: 2396186.0625; val_kl_reg_loss: 11385.1544; val_edge_recon_loss: 771757.0234; val_gene_expr_recon_loss: 1609874.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2393016.8438; val_optim_loss: 2393016.8438
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9591; val_auprc_score: 0.9886; val_best_acc_score: 0.9549; val_best_f1_score: 0.9738; train_kl_reg_loss: 11315.2314; train_edge_recon_loss: 792029.8105; train_gene_expr_recon_loss: 1579387.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2382732.9961; train_optim_loss: 2382732.9961; val_kl_reg_loss: 11253.9337; val_edge_recon_loss: 886697.5469; val_gene_expr_recon_loss: 1594768.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2492719.8125; val_optim_loss: 2492719.8125
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9542; val_auprc_score: 0.9858; val_best_acc_score: 0.9550; val_best_f1_score: 0.9740; train_kl_reg_loss: 11185.8225; train_edge_recon_loss: 792443.2197; train_gene_expr_recon_loss: 1567328.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2370958.0273; train_optim_loss: 2370958.0273; val_kl_reg_loss: 11424.1604; val_edge_recon_loss: 865338.6875; val_gene_expr_recon_loss: 1576891.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2453654.3750; val_optim_loss: 2453654.3750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9514; val_auprc_score: 0.9856; val_best_acc_score: 0.9575; val_best_f1_score: 0.9755; train_kl_reg_loss: 11130.2537; train_edge_recon_loss: 783439.1182; train_gene_expr_recon_loss: 1559162.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2353731.6055; train_optim_loss: 2353731.6055; val_kl_reg_loss: 11151.0830; val_edge_recon_loss: 750476.3750; val_gene_expr_recon_loss: 1567348.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2328975.6250; val_optim_loss: 2328975.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9481; val_auprc_score: 0.9855; val_best_acc_score: 0.9511; val_best_f1_score: 0.9718; train_kl_reg_loss: 11153.4037; train_edge_recon_loss: 782684.3184; train_gene_expr_recon_loss: 1547030.4121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2340868.1367; train_optim_loss: 2340868.1367; val_kl_reg_loss: 11158.5522; val_edge_recon_loss: 775235.8477; val_gene_expr_recon_loss: 1544748.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2331142.6719; val_optim_loss: 2331142.6719
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9564; val_auprc_score: 0.9897; val_best_acc_score: 0.9557; val_best_f1_score: 0.9746; train_kl_reg_loss: 11217.7414; train_edge_recon_loss: 782885.2715; train_gene_expr_recon_loss: 1546875.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2340978.0508; train_optim_loss: 2340978.0508; val_kl_reg_loss: 11238.6660; val_edge_recon_loss: 750285.0078; val_gene_expr_recon_loss: 1569985.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2331509.3125; val_optim_loss: 2331509.3125
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9586; val_auprc_score: 0.9893; val_best_acc_score: 0.9558; val_best_f1_score: 0.9746; train_kl_reg_loss: 11218.3599; train_edge_recon_loss: 779590.0059; train_gene_expr_recon_loss: 1548037.5566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2338845.9336; train_optim_loss: 2338845.9336; val_kl_reg_loss: 11100.1971; val_edge_recon_loss: 712062.1328; val_gene_expr_recon_loss: 1572679.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2295842.1562; val_optim_loss: 2295842.1562
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9503; val_auprc_score: 0.9863; val_best_acc_score: 0.9571; val_best_f1_score: 0.9752; train_kl_reg_loss: 11167.1579; train_edge_recon_loss: 796388.0488; train_gene_expr_recon_loss: 1543294.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2350849.4805; train_optim_loss: 2350849.4805; val_kl_reg_loss: 11217.0710; val_edge_recon_loss: 762337.4062; val_gene_expr_recon_loss: 1534969.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2308523.4688; val_optim_loss: 2308523.4688

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 6 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
val AUROC score: 0.9533
val AUPRC score: 0.9898
val best accuracy score: 0.9553
val best F1 score: 0.9743
val target rna MSE score: 0.8942
val source rna MSE score: 0.2491
Val cat covariate0 mean sim diff: 0.0035
Duration of model training in run 6: 0 hours, 4 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8268; val_auprc_score: 0.9646; val_best_acc_score: 0.8835; val_best_f1_score: 0.9360; train_kl_reg_loss: 4584.2201; train_edge_recon_loss: 1015824.1660; train_gene_expr_recon_loss: 2174243.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3194651.9648; train_optim_loss: 3194651.9648; val_kl_reg_loss: 10673.9331; val_edge_recon_loss: 1089760.3359; val_gene_expr_recon_loss: 1973216.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3073650.3125; val_optim_loss: 3073650.3125
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8390; val_auprc_score: 0.9619; val_best_acc_score: 0.8862; val_best_f1_score: 0.9368; train_kl_reg_loss: 11273.3863; train_edge_recon_loss: 956864.4189; train_gene_expr_recon_loss: 1901572.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2869709.8164; train_optim_loss: 2869709.8164; val_kl_reg_loss: 12031.8433; val_edge_recon_loss: 992160.6328; val_gene_expr_recon_loss: 1852778.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2856971.1562; val_optim_loss: 2856971.1562
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8621; val_auprc_score: 0.9685; val_best_acc_score: 0.8954; val_best_f1_score: 0.9415; train_kl_reg_loss: 11952.1582; train_edge_recon_loss: 889513.0254; train_gene_expr_recon_loss: 1817507.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2718972.6406; train_optim_loss: 2718972.6406; val_kl_reg_loss: 11614.9604; val_edge_recon_loss: 1007218.6250; val_gene_expr_recon_loss: 1785936.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804770.3438; val_optim_loss: 2804770.3438
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8794; val_auprc_score: 0.9729; val_best_acc_score: 0.9025; val_best_f1_score: 0.9452; train_kl_reg_loss: 12038.1360; train_edge_recon_loss: 882271.9678; train_gene_expr_recon_loss: 1774105.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2668415.2422; train_optim_loss: 2668415.2422; val_kl_reg_loss: 12665.7228; val_edge_recon_loss: 946366.4844; val_gene_expr_recon_loss: 1749523.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2708555.7812; val_optim_loss: 2708555.7812
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9072; val_auprc_score: 0.9790; val_best_acc_score: 0.9169; val_best_f1_score: 0.9523; train_kl_reg_loss: 12698.1383; train_edge_recon_loss: 844917.3545; train_gene_expr_recon_loss: 1734810.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2592425.8828; train_optim_loss: 2592425.8828; val_kl_reg_loss: 12973.2546; val_edge_recon_loss: 916107.7969; val_gene_expr_recon_loss: 1724363.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2653444.9062; val_optim_loss: 2653444.9062
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8975; val_auprc_score: 0.9749; val_best_acc_score: 0.9195; val_best_f1_score: 0.9547; train_kl_reg_loss: 13426.4354; train_edge_recon_loss: 820544.1328; train_gene_expr_recon_loss: 1710642.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2544613.3047; train_optim_loss: 2544613.3047; val_kl_reg_loss: 13715.4557; val_edge_recon_loss: 863983.2578; val_gene_expr_recon_loss: 1706978.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2584677.5000; val_optim_loss: 2584677.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9117; val_auprc_score: 0.9788; val_best_acc_score: 0.9283; val_best_f1_score: 0.9590; train_kl_reg_loss: 13462.2782; train_edge_recon_loss: 818947.8076; train_gene_expr_recon_loss: 1693536.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2525946.5312; train_optim_loss: 2525946.5312; val_kl_reg_loss: 13077.8071; val_edge_recon_loss: 761787.4766; val_gene_expr_recon_loss: 1655062.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2429927.4375; val_optim_loss: 2429927.4375
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9360; val_auprc_score: 0.9844; val_best_acc_score: 0.9384; val_best_f1_score: 0.9648; train_kl_reg_loss: 13504.9888; train_edge_recon_loss: 812479.2324; train_gene_expr_recon_loss: 1670444.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2496428.4688; train_optim_loss: 2496428.4688; val_kl_reg_loss: 13426.3226; val_edge_recon_loss: 838252.5469; val_gene_expr_recon_loss: 1668314.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2519993.1250; val_optim_loss: 2519993.1250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9442; val_auprc_score: 0.9860; val_best_acc_score: 0.9482; val_best_f1_score: 0.9703; train_kl_reg_loss: 13555.8918; train_edge_recon_loss: 808936.6885; train_gene_expr_recon_loss: 1652679.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2475171.6914; train_optim_loss: 2475171.6914; val_kl_reg_loss: 13567.4591; val_edge_recon_loss: 795794.0703; val_gene_expr_recon_loss: 1626997.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2436358.5938; val_optim_loss: 2436358.5938
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9329; val_auprc_score: 0.9831; val_best_acc_score: 0.9391; val_best_f1_score: 0.9651; train_kl_reg_loss: 13511.2928; train_edge_recon_loss: 801305.2871; train_gene_expr_recon_loss: 1640808.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2455624.7148; train_optim_loss: 2455624.7148; val_kl_reg_loss: 13670.0865; val_edge_recon_loss: 791793.8828; val_gene_expr_recon_loss: 1632838.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2438302.0000; val_optim_loss: 2438302.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9436; val_auprc_score: 0.9873; val_best_acc_score: 0.9431; val_best_f1_score: 0.9675; train_kl_reg_loss: 13162.6542; train_edge_recon_loss: 802488.6211; train_gene_expr_recon_loss: 1623157.5273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2438808.8047; train_optim_loss: 2438808.8047; val_kl_reg_loss: 13339.1985; val_edge_recon_loss: 762857.0000; val_gene_expr_recon_loss: 1630437.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2406633.7812; val_optim_loss: 2406633.7812
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9485; val_auprc_score: 0.9841; val_best_acc_score: 0.9490; val_best_f1_score: 0.9704; train_kl_reg_loss: 13152.5800; train_edge_recon_loss: 790535.7285; train_gene_expr_recon_loss: 1612214.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2415903.0508; train_optim_loss: 2415903.0508; val_kl_reg_loss: 12718.7061; val_edge_recon_loss: 740795.9062; val_gene_expr_recon_loss: 1613229.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2366744.2188; val_optim_loss: 2366744.2188
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9464; val_auprc_score: 0.9849; val_best_acc_score: 0.9491; val_best_f1_score: 0.9706; train_kl_reg_loss: 12922.5578; train_edge_recon_loss: 795302.4648; train_gene_expr_recon_loss: 1599640.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2407865.2344; train_optim_loss: 2407865.2344; val_kl_reg_loss: 12365.3330; val_edge_recon_loss: 774849.6680; val_gene_expr_recon_loss: 1561742.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2348957.7969; val_optim_loss: 2348957.7969
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9419; val_auprc_score: 0.9844; val_best_acc_score: 0.9546; val_best_f1_score: 0.9738; train_kl_reg_loss: 12454.0113; train_edge_recon_loss: 795334.7969; train_gene_expr_recon_loss: 1590822.8066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2398611.6133; train_optim_loss: 2398611.6133; val_kl_reg_loss: 12620.4867; val_edge_recon_loss: 803604.8125; val_gene_expr_recon_loss: 1576126.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2392352.0312; val_optim_loss: 2392352.0312
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9586; val_auprc_score: 0.9908; val_best_acc_score: 0.9572; val_best_f1_score: 0.9754; train_kl_reg_loss: 12463.9906; train_edge_recon_loss: 803078.8545; train_gene_expr_recon_loss: 1578103.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2393646.0273; train_optim_loss: 2393646.0273; val_kl_reg_loss: 12090.5363; val_edge_recon_loss: 680180.7656; val_gene_expr_recon_loss: 1579557.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2271828.4375; val_optim_loss: 2271828.4375
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9517; val_auprc_score: 0.9848; val_best_acc_score: 0.9594; val_best_f1_score: 0.9768; train_kl_reg_loss: 12273.9122; train_edge_recon_loss: 791346.3604; train_gene_expr_recon_loss: 1566921.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2370541.5781; train_optim_loss: 2370541.5781; val_kl_reg_loss: 12093.8063; val_edge_recon_loss: 857749.6016; val_gene_expr_recon_loss: 1581549.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2451392.5312; val_optim_loss: 2451392.5312
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9463; val_auprc_score: 0.9801; val_best_acc_score: 0.9569; val_best_f1_score: 0.9753; train_kl_reg_loss: 12212.9342; train_edge_recon_loss: 804031.5283; train_gene_expr_recon_loss: 1555134.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2371378.9297; train_optim_loss: 2371378.9297; val_kl_reg_loss: 12318.1967; val_edge_recon_loss: 806530.0234; val_gene_expr_recon_loss: 1559187.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2378035.4062; val_optim_loss: 2378035.4062
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9581; val_auprc_score: 0.9901; val_best_acc_score: 0.9601; val_best_f1_score: 0.9770; train_kl_reg_loss: 12041.9773; train_edge_recon_loss: 782454.3848; train_gene_expr_recon_loss: 1543697.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2338194.3242; train_optim_loss: 2338194.3242; val_kl_reg_loss: 11723.6580; val_edge_recon_loss: 826109.6719; val_gene_expr_recon_loss: 1536977.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2374810.3750; val_optim_loss: 2374810.3750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9507; val_auprc_score: 0.9840; val_best_acc_score: 0.9604; val_best_f1_score: 0.9770; train_kl_reg_loss: 11756.9676; train_edge_recon_loss: 791080.7822; train_gene_expr_recon_loss: 1534120.8340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2336958.5742; train_optim_loss: 2336958.5742; val_kl_reg_loss: 11852.2791; val_edge_recon_loss: 696093.3359; val_gene_expr_recon_loss: 1537098.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2245044.3281; val_optim_loss: 2245044.3281
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9600; val_auprc_score: 0.9882; val_best_acc_score: 0.9633; val_best_f1_score: 0.9790; train_kl_reg_loss: 11823.7622; train_edge_recon_loss: 768928.5088; train_gene_expr_recon_loss: 1521790.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2302542.5508; train_optim_loss: 2302542.5508; val_kl_reg_loss: 11667.7080; val_edge_recon_loss: 710436.9805; val_gene_expr_recon_loss: 1513128.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2235233.2812; val_optim_loss: 2235233.2812
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9590; val_auprc_score: 0.9900; val_best_acc_score: 0.9576; val_best_f1_score: 0.9753; train_kl_reg_loss: 11646.2434; train_edge_recon_loss: 783603.6963; train_gene_expr_recon_loss: 1510317.2598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2305567.2051; train_optim_loss: 2305567.2051; val_kl_reg_loss: 11844.0563; val_edge_recon_loss: 723128.0078; val_gene_expr_recon_loss: 1540501.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2275473.6562; val_optim_loss: 2275473.6562
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9534; val_auprc_score: 0.9877; val_best_acc_score: 0.9575; val_best_f1_score: 0.9754; train_kl_reg_loss: 11514.3491; train_edge_recon_loss: 788274.4307; train_gene_expr_recon_loss: 1499252.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2299041.5586; train_optim_loss: 2299041.5586; val_kl_reg_loss: 11022.0272; val_edge_recon_loss: 718442.5547; val_gene_expr_recon_loss: 1495172.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2224637.1250; val_optim_loss: 2224637.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9624; val_auprc_score: 0.9888; val_best_acc_score: 0.9630; val_best_f1_score: 0.9785; train_kl_reg_loss: 11350.3555; train_edge_recon_loss: 771829.6074; train_gene_expr_recon_loss: 1489557.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2272737.5703; train_optim_loss: 2272737.5703; val_kl_reg_loss: 11581.4609; val_edge_recon_loss: 772832.0312; val_gene_expr_recon_loss: 1492000.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2276414.4688; val_optim_loss: 2276414.4688
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9648; val_auprc_score: 0.9898; val_best_acc_score: 0.9609; val_best_f1_score: 0.9774; train_kl_reg_loss: 11241.3058; train_edge_recon_loss: 811943.3887; train_gene_expr_recon_loss: 1476972.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2300156.9766; train_optim_loss: 2300156.9766; val_kl_reg_loss: 11321.0160; val_edge_recon_loss: 764213.3203; val_gene_expr_recon_loss: 1498189.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2273724.0312; val_optim_loss: 2273724.0312
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9633; val_auprc_score: 0.9908; val_best_acc_score: 0.9611; val_best_f1_score: 0.9774; train_kl_reg_loss: 11264.2295; train_edge_recon_loss: 784453.6377; train_gene_expr_recon_loss: 1470900.0371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2266617.9023; train_optim_loss: 2266617.9023; val_kl_reg_loss: 11114.0902; val_edge_recon_loss: 795316.5625; val_gene_expr_recon_loss: 1456675.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2263105.8750; val_optim_loss: 2263105.8750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9530; val_auprc_score: 0.9878; val_best_acc_score: 0.9634; val_best_f1_score: 0.9789; train_kl_reg_loss: 11249.8587; train_edge_recon_loss: 785535.3613; train_gene_expr_recon_loss: 1462138.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2258923.9102; train_optim_loss: 2258923.9102; val_kl_reg_loss: 11316.8363; val_edge_recon_loss: 750792.4414; val_gene_expr_recon_loss: 1479064.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2241174.0312; val_optim_loss: 2241174.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9625; val_auprc_score: 0.9888; val_best_acc_score: 0.9611; val_best_f1_score: 0.9777; train_kl_reg_loss: 11314.2169; train_edge_recon_loss: 788692.0137; train_gene_expr_recon_loss: 1448488.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2248494.3984; train_optim_loss: 2248494.3984; val_kl_reg_loss: 11354.5129; val_edge_recon_loss: 828318.8594; val_gene_expr_recon_loss: 1472334.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2312008.3281; val_optim_loss: 2312008.3281
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9619; val_auprc_score: 0.9907; val_best_acc_score: 0.9585; val_best_f1_score: 0.9760; train_kl_reg_loss: 11359.8366; train_edge_recon_loss: 783487.6357; train_gene_expr_recon_loss: 1449587.0742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2244434.5273; train_optim_loss: 2244434.5273; val_kl_reg_loss: 11348.2134; val_edge_recon_loss: 720586.6250; val_gene_expr_recon_loss: 1445897.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2177832.6406; val_optim_loss: 2177832.6406
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9616; val_auprc_score: 0.9870; val_best_acc_score: 0.9645; val_best_f1_score: 0.9796; train_kl_reg_loss: 11361.3418; train_edge_recon_loss: 787716.3711; train_gene_expr_recon_loss: 1446876.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2245954.4355; train_optim_loss: 2245954.4355; val_kl_reg_loss: 11423.1348; val_edge_recon_loss: 724568.7266; val_gene_expr_recon_loss: 1467230.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2203222.5312; val_optim_loss: 2203222.5312
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9696; val_auprc_score: 0.9929; val_best_acc_score: 0.9674; val_best_f1_score: 0.9814; train_kl_reg_loss: 11329.7286; train_edge_recon_loss: 781657.4434; train_gene_expr_recon_loss: 1446038.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2239025.3125; train_optim_loss: 2239025.3125; val_kl_reg_loss: 11251.8922; val_edge_recon_loss: 690879.0938; val_gene_expr_recon_loss: 1471786.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2173917.3125; val_optim_loss: 2173917.3125
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9687; val_auprc_score: 0.9896; val_best_acc_score: 0.9657; val_best_f1_score: 0.9801; train_kl_reg_loss: 11337.1386; train_edge_recon_loss: 794052.4707; train_gene_expr_recon_loss: 1445438.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2250828.5547; train_optim_loss: 2250828.5547; val_kl_reg_loss: 11225.4712; val_edge_recon_loss: 899890.6875; val_gene_expr_recon_loss: 1442932.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2354048.7812; val_optim_loss: 2354048.7812
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9633; val_auprc_score: 0.9899; val_best_acc_score: 0.9622; val_best_f1_score: 0.9781; train_kl_reg_loss: 11317.4211; train_edge_recon_loss: 779103.6016; train_gene_expr_recon_loss: 1439468.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2229889.4844; train_optim_loss: 2229889.4844; val_kl_reg_loss: 11276.6543; val_edge_recon_loss: 794635.5547; val_gene_expr_recon_loss: 1452919.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2258832.0312; val_optim_loss: 2258832.0312
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9574; val_auprc_score: 0.9866; val_best_acc_score: 0.9590; val_best_f1_score: 0.9762; train_kl_reg_loss: 11308.7577; train_edge_recon_loss: 780613.9121; train_gene_expr_recon_loss: 1442478.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2234401.5000; train_optim_loss: 2234401.5000; val_kl_reg_loss: 11268.5327; val_edge_recon_loss: 794869.8828; val_gene_expr_recon_loss: 1468122.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2274261.3125; val_optim_loss: 2274261.3125
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9537; val_auprc_score: 0.9856; val_best_acc_score: 0.9639; val_best_f1_score: 0.9792; train_kl_reg_loss: 11299.2446; train_edge_recon_loss: 796766.3115; train_gene_expr_recon_loss: 1440703.1582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2248768.6992; train_optim_loss: 2248768.6992; val_kl_reg_loss: 11301.0956; val_edge_recon_loss: 735724.1641; val_gene_expr_recon_loss: 1474674.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2221700.0000; val_optim_loss: 2221700.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9654; val_auprc_score: 0.9907; val_best_acc_score: 0.9644; val_best_f1_score: 0.9795; train_kl_reg_loss: 11286.4059; train_edge_recon_loss: 795394.7520; train_gene_expr_recon_loss: 1439172.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2245853.6250; train_optim_loss: 2245853.6250; val_kl_reg_loss: 11363.9290; val_edge_recon_loss: 718766.2344; val_gene_expr_recon_loss: 1447760.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2177890.5000; val_optim_loss: 2177890.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9557; val_auprc_score: 0.9859; val_best_acc_score: 0.9611; val_best_f1_score: 0.9773; train_kl_reg_loss: 11294.7906; train_edge_recon_loss: 774813.2920; train_gene_expr_recon_loss: 1438344.5332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2224452.6211; train_optim_loss: 2224452.6211; val_kl_reg_loss: 11328.8424; val_edge_recon_loss: 815996.5234; val_gene_expr_recon_loss: 1456784.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2284110.2500; val_optim_loss: 2284110.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9574; val_auprc_score: 0.9866; val_best_acc_score: 0.9648; val_best_f1_score: 0.9797; train_kl_reg_loss: 11305.9311; train_edge_recon_loss: 767436.0986; train_gene_expr_recon_loss: 1438059.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2216801.2617; train_optim_loss: 2216801.2617; val_kl_reg_loss: 11252.8008; val_edge_recon_loss: 705999.1797; val_gene_expr_recon_loss: 1447029.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2164281.0312; val_optim_loss: 2164281.0312
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9691; val_auprc_score: 0.9911; val_best_acc_score: 0.9645; val_best_f1_score: 0.9792; train_kl_reg_loss: 11327.2540; train_edge_recon_loss: 769667.1436; train_gene_expr_recon_loss: 1438306.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2219301.2246; train_optim_loss: 2219301.2246; val_kl_reg_loss: 11366.0825; val_edge_recon_loss: 866297.4844; val_gene_expr_recon_loss: 1457054.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2334717.9375; val_optim_loss: 2334717.9375
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9650; val_auprc_score: 0.9877; val_best_acc_score: 0.9666; val_best_f1_score: 0.9808; train_kl_reg_loss: 11322.2779; train_edge_recon_loss: 765469.6211; train_gene_expr_recon_loss: 1437190.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2213982.6445; train_optim_loss: 2213982.6445; val_kl_reg_loss: 11319.9591; val_edge_recon_loss: 687420.7480; val_gene_expr_recon_loss: 1453219.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2151960.5000; val_optim_loss: 2151960.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9564; val_auprc_score: 0.9877; val_best_acc_score: 0.9593; val_best_f1_score: 0.9763; train_kl_reg_loss: 11320.5586; train_edge_recon_loss: 775949.3115; train_gene_expr_recon_loss: 1438444.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2225714.0508; train_optim_loss: 2225714.0508; val_kl_reg_loss: 11261.1343; val_edge_recon_loss: 838722.3125; val_gene_expr_recon_loss: 1449597.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2299581.0938; val_optim_loss: 2299581.0938
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9679; val_auprc_score: 0.9885; val_best_acc_score: 0.9659; val_best_f1_score: 0.9802; train_kl_reg_loss: 11303.8524; train_edge_recon_loss: 773847.5156; train_gene_expr_recon_loss: 1438681.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2223833.2773; train_optim_loss: 2223833.2773; val_kl_reg_loss: 11317.2917; val_edge_recon_loss: 722468.3516; val_gene_expr_recon_loss: 1441866.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2175652.3125; val_optim_loss: 2175652.3125
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9530; val_auprc_score: 0.9862; val_best_acc_score: 0.9624; val_best_f1_score: 0.9784; train_kl_reg_loss: 11305.7581; train_edge_recon_loss: 779945.9941; train_gene_expr_recon_loss: 1436079.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2227330.8535; train_optim_loss: 2227330.8535; val_kl_reg_loss: 11295.0814; val_edge_recon_loss: 808774.2031; val_gene_expr_recon_loss: 1448574.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2268643.7188; val_optim_loss: 2268643.7188
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9569; val_auprc_score: 0.9886; val_best_acc_score: 0.9632; val_best_f1_score: 0.9788; train_kl_reg_loss: 11324.1165; train_edge_recon_loss: 774248.8105; train_gene_expr_recon_loss: 1436926.7324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2222499.6758; train_optim_loss: 2222499.6758; val_kl_reg_loss: 11377.1704; val_edge_recon_loss: 817153.8750; val_gene_expr_recon_loss: 1437425.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2265956.6250; val_optim_loss: 2265956.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9660; val_auprc_score: 0.9902; val_best_acc_score: 0.9658; val_best_f1_score: 0.9801; train_kl_reg_loss: 11298.4451; train_edge_recon_loss: 764720.6592; train_gene_expr_recon_loss: 1437778.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2213797.2832; train_optim_loss: 2213797.2832; val_kl_reg_loss: 11209.9413; val_edge_recon_loss: 899082.4531; val_gene_expr_recon_loss: 1434255.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2344547.5625; val_optim_loss: 2344547.5625
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9610; val_auprc_score: 0.9884; val_best_acc_score: 0.9669; val_best_f1_score: 0.9810; train_kl_reg_loss: 11304.1936; train_edge_recon_loss: 783040.5674; train_gene_expr_recon_loss: 1437577.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2231922.6934; train_optim_loss: 2231922.6934; val_kl_reg_loss: 11305.4357; val_edge_recon_loss: 755629.9688; val_gene_expr_recon_loss: 1460481.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2227416.6250; val_optim_loss: 2227416.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9629; val_auprc_score: 0.9878; val_best_acc_score: 0.9659; val_best_f1_score: 0.9803; train_kl_reg_loss: 11306.2893; train_edge_recon_loss: 780672.4463; train_gene_expr_recon_loss: 1436934.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2228913.4473; train_optim_loss: 2228913.4473; val_kl_reg_loss: 11220.0389; val_edge_recon_loss: 783302.7109; val_gene_expr_recon_loss: 1461601.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2256124.7188; val_optim_loss: 2256124.7188
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9615; val_auprc_score: 0.9861; val_best_acc_score: 0.9675; val_best_f1_score: 0.9814; train_kl_reg_loss: 11313.0276; train_edge_recon_loss: 788732.8408; train_gene_expr_recon_loss: 1438572.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2238617.8711; train_optim_loss: 2238617.8711; val_kl_reg_loss: 11371.0420; val_edge_recon_loss: 686600.2461; val_gene_expr_recon_loss: 1468567.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2166539.0625; val_optim_loss: 2166539.0625

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 52 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9724
val AUPRC score: 0.9941
val best accuracy score: 0.9659
val best F1 score: 0.9803
val target rna MSE score: 0.7482
val source rna MSE score: 0.1699
Val cat covariate0 mean sim diff: -0.0020
Duration of model training in run 5: 0 hours, 10 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8712; val_auprc_score: 0.9730; val_best_acc_score: 0.8910; val_best_f1_score: 0.9399; train_kl_reg_loss: 2547.6723; train_edge_recon_loss: 1014755.8052; train_gene_expr_recon_loss: 2236585.8837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3253889.3721; train_optim_loss: 3253889.3721; val_kl_reg_loss: 4654.4986; val_edge_recon_loss: 1078636.2375; val_gene_expr_recon_loss: 2087904.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3171195.1000; val_optim_loss: 3171195.1000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8144; val_auprc_score: 0.9588; val_best_acc_score: 0.8840; val_best_f1_score: 0.9352; train_kl_reg_loss: 6898.7126; train_edge_recon_loss: 965021.6250; train_gene_expr_recon_loss: 2012385.0523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2984305.3721; train_optim_loss: 2984305.3721; val_kl_reg_loss: 10028.4512; val_edge_recon_loss: 987383.6750; val_gene_expr_recon_loss: 1959657.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2957069.6500; val_optim_loss: 2957069.6500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8435; val_auprc_score: 0.9643; val_best_acc_score: 0.8798; val_best_f1_score: 0.9323; train_kl_reg_loss: 10988.6324; train_edge_recon_loss: 933454.4041; train_gene_expr_recon_loss: 1890968.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2835411.5407; train_optim_loss: 2835411.5407; val_kl_reg_loss: 10133.8287; val_edge_recon_loss: 984093.5500; val_gene_expr_recon_loss: 1857071.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2851299.1500; val_optim_loss: 2851299.1500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8599; val_auprc_score: 0.9680; val_best_acc_score: 0.8912; val_best_f1_score: 0.9391; train_kl_reg_loss: 11494.9561; train_edge_recon_loss: 888585.3968; train_gene_expr_recon_loss: 1834781.7326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2734862.0581; train_optim_loss: 2734862.0581; val_kl_reg_loss: 11757.8357; val_edge_recon_loss: 917710.9500; val_gene_expr_recon_loss: 1794905.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2724374.7000; val_optim_loss: 2724374.7000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8814; val_auprc_score: 0.9769; val_best_acc_score: 0.9062; val_best_f1_score: 0.9472; train_kl_reg_loss: 12566.2387; train_edge_recon_loss: 859793.3314; train_gene_expr_recon_loss: 1793403.8808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2665763.4709; train_optim_loss: 2665763.4709; val_kl_reg_loss: 12998.0934; val_edge_recon_loss: 785937.4375; val_gene_expr_recon_loss: 1776783.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2575718.9500; val_optim_loss: 2575718.9500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8935; val_auprc_score: 0.9743; val_best_acc_score: 0.9113; val_best_f1_score: 0.9498; train_kl_reg_loss: 12272.4019; train_edge_recon_loss: 841720.7994; train_gene_expr_recon_loss: 1767786.7006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2621779.9012; train_optim_loss: 2621779.9012; val_kl_reg_loss: 12300.8773; val_edge_recon_loss: 853007.5875; val_gene_expr_recon_loss: 1779873.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2645181.7000; val_optim_loss: 2645181.7000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9059; val_auprc_score: 0.9759; val_best_acc_score: 0.9215; val_best_f1_score: 0.9552; train_kl_reg_loss: 12919.0110; train_edge_recon_loss: 828115.1860; train_gene_expr_recon_loss: 1744479.0523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2585513.2384; train_optim_loss: 2585513.2384; val_kl_reg_loss: 13212.7977; val_edge_recon_loss: 873026.3125; val_gene_expr_recon_loss: 1745113.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2631352.9500; val_optim_loss: 2631352.9500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9108; val_auprc_score: 0.9826; val_best_acc_score: 0.9256; val_best_f1_score: 0.9580; train_kl_reg_loss: 13708.6284; train_edge_recon_loss: 810527.7006; train_gene_expr_recon_loss: 1721294.3256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2545530.6686; train_optim_loss: 2545530.6686; val_kl_reg_loss: 13724.9990; val_edge_recon_loss: 776745.0125; val_gene_expr_recon_loss: 1709273.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2499743.8000; val_optim_loss: 2499743.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9121; val_auprc_score: 0.9810; val_best_acc_score: 0.9304; val_best_f1_score: 0.9607; train_kl_reg_loss: 14254.0874; train_edge_recon_loss: 853873.3459; train_gene_expr_recon_loss: 1706810.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2574937.7849; train_optim_loss: 2574937.7849; val_kl_reg_loss: 14183.7607; val_edge_recon_loss: 785295.6250; val_gene_expr_recon_loss: 1673328.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2472807.6500; val_optim_loss: 2472807.6500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9272; val_auprc_score: 0.9843; val_best_acc_score: 0.9382; val_best_f1_score: 0.9649; train_kl_reg_loss: 13924.0729; train_edge_recon_loss: 817965.8648; train_gene_expr_recon_loss: 1696438.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2528328.5581; train_optim_loss: 2528328.5581; val_kl_reg_loss: 13131.5658; val_edge_recon_loss: 776950.3000; val_gene_expr_recon_loss: 1694864.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2484946.8000; val_optim_loss: 2484946.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9272; val_auprc_score: 0.9834; val_best_acc_score: 0.9351; val_best_f1_score: 0.9632; train_kl_reg_loss: 14052.2989; train_edge_recon_loss: 826478.3881; train_gene_expr_recon_loss: 1685787.4622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2526318.1512; train_optim_loss: 2526318.1512; val_kl_reg_loss: 13230.6826; val_edge_recon_loss: 783455.8375; val_gene_expr_recon_loss: 1696278.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2492965.1500; val_optim_loss: 2492965.1500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9244; val_auprc_score: 0.9806; val_best_acc_score: 0.9341; val_best_f1_score: 0.9623; train_kl_reg_loss: 13500.7142; train_edge_recon_loss: 807746.0712; train_gene_expr_recon_loss: 1671370.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2492617.1977; train_optim_loss: 2492617.1977; val_kl_reg_loss: 13311.4809; val_edge_recon_loss: 841786.5375; val_gene_expr_recon_loss: 1686083.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2541181.6000; val_optim_loss: 2541181.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9303; val_auprc_score: 0.9833; val_best_acc_score: 0.9389; val_best_f1_score: 0.9651; train_kl_reg_loss: 13763.5917; train_edge_recon_loss: 808586.6904; train_gene_expr_recon_loss: 1659736.0262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2482086.3081; train_optim_loss: 2482086.3081; val_kl_reg_loss: 13690.4205; val_edge_recon_loss: 806578.5625; val_gene_expr_recon_loss: 1700403.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2520672.2000; val_optim_loss: 2520672.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9371; val_auprc_score: 0.9816; val_best_acc_score: 0.9376; val_best_f1_score: 0.9643; train_kl_reg_loss: 13740.0605; train_edge_recon_loss: 788839.8619; train_gene_expr_recon_loss: 1650391.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2452971.0640; train_optim_loss: 2452971.0640; val_kl_reg_loss: 13852.2967; val_edge_recon_loss: 809891.0750; val_gene_expr_recon_loss: 1659814.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2483557.6000; val_optim_loss: 2483557.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9394; val_auprc_score: 0.9855; val_best_acc_score: 0.9409; val_best_f1_score: 0.9661; train_kl_reg_loss: 13916.9507; train_edge_recon_loss: 816014.8365; train_gene_expr_recon_loss: 1649768.5785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2479700.3750; train_optim_loss: 2479700.3750; val_kl_reg_loss: 13592.1910; val_edge_recon_loss: 826426.6250; val_gene_expr_recon_loss: 1667984.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2508003.6000; val_optim_loss: 2508003.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9428; val_auprc_score: 0.9874; val_best_acc_score: 0.9452; val_best_f1_score: 0.9683; train_kl_reg_loss: 13874.8208; train_edge_recon_loss: 794814.2703; train_gene_expr_recon_loss: 1647277.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2455966.1279; train_optim_loss: 2455966.1279; val_kl_reg_loss: 14182.9922; val_edge_recon_loss: 822146.9000; val_gene_expr_recon_loss: 1660961.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2497291.5500; val_optim_loss: 2497291.5500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9299; val_auprc_score: 0.9824; val_best_acc_score: 0.9449; val_best_f1_score: 0.9687; train_kl_reg_loss: 13983.6976; train_edge_recon_loss: 789255.8096; train_gene_expr_recon_loss: 1644687.4593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2447926.9767; train_optim_loss: 2447926.9767; val_kl_reg_loss: 13987.6857; val_edge_recon_loss: 778876.8875; val_gene_expr_recon_loss: 1641097.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2433962.4000; val_optim_loss: 2433962.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9286; val_auprc_score: 0.9827; val_best_acc_score: 0.9419; val_best_f1_score: 0.9673; train_kl_reg_loss: 13882.3837; train_edge_recon_loss: 802533.1802; train_gene_expr_recon_loss: 1645187.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2461603.2326; train_optim_loss: 2461603.2326; val_kl_reg_loss: 13646.1189; val_edge_recon_loss: 755892.2000; val_gene_expr_recon_loss: 1680268.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2449806.7500; val_optim_loss: 2449806.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9321; val_auprc_score: 0.9783; val_best_acc_score: 0.9395; val_best_f1_score: 0.9649; train_kl_reg_loss: 13799.4031; train_edge_recon_loss: 792167.5451; train_gene_expr_recon_loss: 1642550.5349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2448517.5000; train_optim_loss: 2448517.5000; val_kl_reg_loss: 13610.7570; val_edge_recon_loss: 891478.5125; val_gene_expr_recon_loss: 1630049.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2535138.6500; val_optim_loss: 2535138.6500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9433; val_auprc_score: 0.9832; val_best_acc_score: 0.9415; val_best_f1_score: 0.9661; train_kl_reg_loss: 13868.7024; train_edge_recon_loss: 816314.0189; train_gene_expr_recon_loss: 1642848.4855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2473031.1919; train_optim_loss: 2473031.1919; val_kl_reg_loss: 13780.2520; val_edge_recon_loss: 866148.5000; val_gene_expr_recon_loss: 1642490.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2522419.5500; val_optim_loss: 2522419.5500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9398; val_auprc_score: 0.9820; val_best_acc_score: 0.9458; val_best_f1_score: 0.9684; train_kl_reg_loss: 13815.6662; train_edge_recon_loss: 800381.5988; train_gene_expr_recon_loss: 1638671.3314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2452868.5872; train_optim_loss: 2452868.5872; val_kl_reg_loss: 13817.1016; val_edge_recon_loss: 838881.2875; val_gene_expr_recon_loss: 1626603.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2479301.7000; val_optim_loss: 2479301.7000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9314; val_auprc_score: 0.9841; val_best_acc_score: 0.9445; val_best_f1_score: 0.9685; train_kl_reg_loss: 13814.7616; train_edge_recon_loss: 796316.4491; train_gene_expr_recon_loss: 1641516.7965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2451647.9884; train_optim_loss: 2451647.9884; val_kl_reg_loss: 13945.1758; val_edge_recon_loss: 791287.8625; val_gene_expr_recon_loss: 1652309.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2457542.1000; val_optim_loss: 2457542.1000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9503; val_auprc_score: 0.9869; val_best_acc_score: 0.9458; val_best_f1_score: 0.9687; train_kl_reg_loss: 13836.6858; train_edge_recon_loss: 795924.1759; train_gene_expr_recon_loss: 1639299.9331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2449060.7965; train_optim_loss: 2449060.7965; val_kl_reg_loss: 13681.6354; val_edge_recon_loss: 833325.7500; val_gene_expr_recon_loss: 1641432.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2488439.9500; val_optim_loss: 2488439.9500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9482; val_auprc_score: 0.9886; val_best_acc_score: 0.9473; val_best_f1_score: 0.9699; train_kl_reg_loss: 13867.4392; train_edge_recon_loss: 814606.5930; train_gene_expr_recon_loss: 1640284.3110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2468758.3547; train_optim_loss: 2468758.3547; val_kl_reg_loss: 13807.1998; val_edge_recon_loss: 798934.0250; val_gene_expr_recon_loss: 1665154.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477895.7000; val_optim_loss: 2477895.7000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9484; val_auprc_score: 0.9843; val_best_acc_score: 0.9464; val_best_f1_score: 0.9693; train_kl_reg_loss: 13856.4933; train_edge_recon_loss: 800567.8459; train_gene_expr_recon_loss: 1640408.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2454833.0988; train_optim_loss: 2454833.0988; val_kl_reg_loss: 13883.1467; val_edge_recon_loss: 796955.7125; val_gene_expr_recon_loss: 1653046.3250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2463885.2000; val_optim_loss: 2463885.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 28 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9389
val AUPRC score: 0.9846
val best accuracy score: 0.9477
val best F1 score: 0.9704
val target rna MSE score: 1.0034
val source rna MSE score: 0.3438
Val cat covariate0 mean sim diff: -0.0058
Duration of model training in run 4: 0 hours, 2 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8655; val_auprc_score: 0.9700; val_best_acc_score: 0.8844; val_best_f1_score: 0.9367; train_kl_reg_loss: 3329.6204; train_edge_recon_loss: 1044523.2718; train_gene_expr_recon_loss: 2301154.7558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3349007.6453; train_optim_loss: 3349007.6453; val_kl_reg_loss: 6115.6146; val_edge_recon_loss: 1121391.8625; val_gene_expr_recon_loss: 2112929.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3240436.6500; val_optim_loss: 3240436.6500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8270; val_auprc_score: 0.9622; val_best_acc_score: 0.8810; val_best_f1_score: 0.9341; train_kl_reg_loss: 8326.4745; train_edge_recon_loss: 1009535.6206; train_gene_expr_recon_loss: 2037447.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3055309.3547; train_optim_loss: 3055309.3547; val_kl_reg_loss: 9116.3238; val_edge_recon_loss: 989630.6000; val_gene_expr_recon_loss: 1953179.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2951926.4000; val_optim_loss: 2951926.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8335; val_auprc_score: 0.9621; val_best_acc_score: 0.8906; val_best_f1_score: 0.9395; train_kl_reg_loss: 10994.7088; train_edge_recon_loss: 932729.1134; train_gene_expr_recon_loss: 1920848.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2864572.4709; train_optim_loss: 2864572.4709; val_kl_reg_loss: 10434.8580; val_edge_recon_loss: 880682.8000; val_gene_expr_recon_loss: 1864294.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2755411.7000; val_optim_loss: 2755411.7000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8650; val_auprc_score: 0.9697; val_best_acc_score: 0.8898; val_best_f1_score: 0.9382; train_kl_reg_loss: 10964.0359; train_edge_recon_loss: 929356.4375; train_gene_expr_recon_loss: 1864688.9738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2805009.4477; train_optim_loss: 2805009.4477; val_kl_reg_loss: 10066.4930; val_edge_recon_loss: 919326.0875; val_gene_expr_recon_loss: 1822997.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2752390.0000; val_optim_loss: 2752390.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8783; val_auprc_score: 0.9712; val_best_acc_score: 0.9056; val_best_f1_score: 0.9472; train_kl_reg_loss: 11488.7004; train_edge_recon_loss: 877917.2311; train_gene_expr_recon_loss: 1820697.5436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2710103.4767; train_optim_loss: 2710103.4767; val_kl_reg_loss: 11630.3549; val_edge_recon_loss: 835849.5125; val_gene_expr_recon_loss: 1838544.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2686024.1000; val_optim_loss: 2686024.1000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8819; val_auprc_score: 0.9737; val_best_acc_score: 0.9136; val_best_f1_score: 0.9514; train_kl_reg_loss: 11604.9239; train_edge_recon_loss: 844116.5233; train_gene_expr_recon_loss: 1791578.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2647299.6047; train_optim_loss: 2647299.6047; val_kl_reg_loss: 11446.3230; val_edge_recon_loss: 815758.7500; val_gene_expr_recon_loss: 1798918.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2626123.2000; val_optim_loss: 2626123.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9070; val_auprc_score: 0.9781; val_best_acc_score: 0.9147; val_best_f1_score: 0.9511; train_kl_reg_loss: 11809.7978; train_edge_recon_loss: 818909.1265; train_gene_expr_recon_loss: 1763220.9012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2593939.8547; train_optim_loss: 2593939.8547; val_kl_reg_loss: 12925.3775; val_edge_recon_loss: 876773.1250; val_gene_expr_recon_loss: 1742682.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2632381.2000; val_optim_loss: 2632381.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9283; val_auprc_score: 0.9858; val_best_acc_score: 0.9338; val_best_f1_score: 0.9624; train_kl_reg_loss: 12976.4114; train_edge_recon_loss: 820994.3706; train_gene_expr_recon_loss: 1739397.2703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2573368.0523; train_optim_loss: 2573368.0523; val_kl_reg_loss: 12752.7947; val_edge_recon_loss: 768895.7625; val_gene_expr_recon_loss: 1721679.2250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2503327.7000; val_optim_loss: 2503327.7000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9161; val_auprc_score: 0.9735; val_best_acc_score: 0.9293; val_best_f1_score: 0.9589; train_kl_reg_loss: 12944.9992; train_edge_recon_loss: 821713.5959; train_gene_expr_recon_loss: 1717652.3895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2552311.0000; train_optim_loss: 2552311.0000; val_kl_reg_loss: 12779.4230; val_edge_recon_loss: 859050.3500; val_gene_expr_recon_loss: 1702539.0250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2574368.8500; val_optim_loss: 2574368.8500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9352; val_auprc_score: 0.9849; val_best_acc_score: 0.9375; val_best_f1_score: 0.9639; train_kl_reg_loss: 13529.1127; train_edge_recon_loss: 804369.2805; train_gene_expr_recon_loss: 1698907.8052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2516806.2035; train_optim_loss: 2516806.2035; val_kl_reg_loss: 13383.8951; val_edge_recon_loss: 838293.3000; val_gene_expr_recon_loss: 1647906.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2499583.5000; val_optim_loss: 2499583.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9336; val_auprc_score: 0.9828; val_best_acc_score: 0.9411; val_best_f1_score: 0.9664; train_kl_reg_loss: 13650.1990; train_edge_recon_loss: 802507.6308; train_gene_expr_recon_loss: 1687425.8110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2503583.6453; train_optim_loss: 2503583.6453; val_kl_reg_loss: 13736.6029; val_edge_recon_loss: 781764.0000; val_gene_expr_recon_loss: 1650508.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2446009.0500; val_optim_loss: 2446009.0500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9367; val_auprc_score: 0.9843; val_best_acc_score: 0.9376; val_best_f1_score: 0.9645; train_kl_reg_loss: 13751.3561; train_edge_recon_loss: 819386.1599; train_gene_expr_recon_loss: 1679006.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2512144.4884; train_optim_loss: 2512144.4884; val_kl_reg_loss: 13370.2426; val_edge_recon_loss: 778520.8875; val_gene_expr_recon_loss: 1700909.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2492800.6500; val_optim_loss: 2492800.6500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9423; val_auprc_score: 0.9861; val_best_acc_score: 0.9358; val_best_f1_score: 0.9630; train_kl_reg_loss: 13272.6131; train_edge_recon_loss: 800742.7892; train_gene_expr_recon_loss: 1664723.2238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2478738.6105; train_optim_loss: 2478738.6105; val_kl_reg_loss: 12629.1088; val_edge_recon_loss: 861793.9625; val_gene_expr_recon_loss: 1659913.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2534336.4500; val_optim_loss: 2534336.4500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9348; val_auprc_score: 0.9837; val_best_acc_score: 0.9416; val_best_f1_score: 0.9665; train_kl_reg_loss: 13270.2940; train_edge_recon_loss: 811681.2892; train_gene_expr_recon_loss: 1653059.7762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2478011.3663; train_optim_loss: 2478011.3663; val_kl_reg_loss: 13045.2000; val_edge_recon_loss: 798714.1125; val_gene_expr_recon_loss: 1628475.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2440234.8000; val_optim_loss: 2440234.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9389; val_auprc_score: 0.9853; val_best_acc_score: 0.9404; val_best_f1_score: 0.9657; train_kl_reg_loss: 13410.2519; train_edge_recon_loss: 797795.5654; train_gene_expr_recon_loss: 1641430.7703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2452636.5930; train_optim_loss: 2452636.5930; val_kl_reg_loss: 12942.7367; val_edge_recon_loss: 842906.9875; val_gene_expr_recon_loss: 1621759.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2477609.4000; val_optim_loss: 2477609.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9381; val_auprc_score: 0.9820; val_best_acc_score: 0.9467; val_best_f1_score: 0.9695; train_kl_reg_loss: 13058.0803; train_edge_recon_loss: 806313.8808; train_gene_expr_recon_loss: 1630668.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2450040.8488; train_optim_loss: 2450040.8488; val_kl_reg_loss: 13160.7984; val_edge_recon_loss: 816284.4500; val_gene_expr_recon_loss: 1620193.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2449638.5000; val_optim_loss: 2449638.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9550; val_auprc_score: 0.9893; val_best_acc_score: 0.9520; val_best_f1_score: 0.9724; train_kl_reg_loss: 12874.7308; train_edge_recon_loss: 798504.2747; train_gene_expr_recon_loss: 1622212.0378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2433591.0407; train_optim_loss: 2433591.0407; val_kl_reg_loss: 12928.6309; val_edge_recon_loss: 790011.3250; val_gene_expr_recon_loss: 1657114.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2460054.9000; val_optim_loss: 2460054.9000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9444; val_auprc_score: 0.9869; val_best_acc_score: 0.9497; val_best_f1_score: 0.9710; train_kl_reg_loss: 13017.6431; train_edge_recon_loss: 777380.2137; train_gene_expr_recon_loss: 1610023.4797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2400421.3198; train_optim_loss: 2400421.3198; val_kl_reg_loss: 12619.0588; val_edge_recon_loss: 778509.6250; val_gene_expr_recon_loss: 1611270.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2402398.8000; val_optim_loss: 2402398.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9431; val_auprc_score: 0.9857; val_best_acc_score: 0.9463; val_best_f1_score: 0.9691; train_kl_reg_loss: 12674.6306; train_edge_recon_loss: 793453.3241; train_gene_expr_recon_loss: 1603383.6279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2409511.5698; train_optim_loss: 2409511.5698; val_kl_reg_loss: 12388.0246; val_edge_recon_loss: 832446.1875; val_gene_expr_recon_loss: 1578121.7750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2422955.9500; val_optim_loss: 2422955.9500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9385; val_auprc_score: 0.9825; val_best_acc_score: 0.9546; val_best_f1_score: 0.9736; train_kl_reg_loss: 12561.5442; train_edge_recon_loss: 809907.6933; train_gene_expr_recon_loss: 1594730.1395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2417199.3779; train_optim_loss: 2417199.3779; val_kl_reg_loss: 12844.4344; val_edge_recon_loss: 836583.7000; val_gene_expr_recon_loss: 1635678.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2485106.5500; val_optim_loss: 2485106.5500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9539; val_auprc_score: 0.9888; val_best_acc_score: 0.9548; val_best_f1_score: 0.9740; train_kl_reg_loss: 12688.1367; train_edge_recon_loss: 785560.1163; train_gene_expr_recon_loss: 1585094.2035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2383342.4477; train_optim_loss: 2383342.4477; val_kl_reg_loss: 12159.9650; val_edge_recon_loss: 791436.8500; val_gene_expr_recon_loss: 1557018.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2360615.3500; val_optim_loss: 2360615.3500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9496; val_auprc_score: 0.9842; val_best_acc_score: 0.9511; val_best_f1_score: 0.9721; train_kl_reg_loss: 12281.8027; train_edge_recon_loss: 783165.8997; train_gene_expr_recon_loss: 1581716.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2377163.9826; train_optim_loss: 2377163.9826; val_kl_reg_loss: 12570.7996; val_edge_recon_loss: 780380.4250; val_gene_expr_recon_loss: 1628856.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2421807.7500; val_optim_loss: 2421807.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9613; val_auprc_score: 0.9912; val_best_acc_score: 0.9573; val_best_f1_score: 0.9753; train_kl_reg_loss: 12385.5433; train_edge_recon_loss: 790767.4331; train_gene_expr_recon_loss: 1569436.2733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2372589.2616; train_optim_loss: 2372589.2616; val_kl_reg_loss: 12169.7580; val_edge_recon_loss: 787063.4000; val_gene_expr_recon_loss: 1609407.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2408640.7500; val_optim_loss: 2408640.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9572; val_auprc_score: 0.9894; val_best_acc_score: 0.9582; val_best_f1_score: 0.9758; train_kl_reg_loss: 12400.3689; train_edge_recon_loss: 791550.7064; train_gene_expr_recon_loss: 1562575.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2366526.7907; train_optim_loss: 2366526.7907; val_kl_reg_loss: 12280.5098; val_edge_recon_loss: 802342.7500; val_gene_expr_recon_loss: 1561331.8250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2375955.1000; val_optim_loss: 2375955.1000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9509; val_auprc_score: 0.9875; val_best_acc_score: 0.9583; val_best_f1_score: 0.9763; train_kl_reg_loss: 12219.8122; train_edge_recon_loss: 798520.5058; train_gene_expr_recon_loss: 1554381.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2365122.0291; train_optim_loss: 2365122.0291; val_kl_reg_loss: 12050.6256; val_edge_recon_loss: 737435.5500; val_gene_expr_recon_loss: 1554511.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2303997.7500; val_optim_loss: 2303997.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9560; val_auprc_score: 0.9864; val_best_acc_score: 0.9561; val_best_f1_score: 0.9748; train_kl_reg_loss: 12349.1264; train_edge_recon_loss: 785231.8067; train_gene_expr_recon_loss: 1544203.3081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2341784.2326; train_optim_loss: 2341784.2326; val_kl_reg_loss: 12047.9594; val_edge_recon_loss: 765212.5625; val_gene_expr_recon_loss: 1520139.3500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2297399.8500; val_optim_loss: 2297399.8500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9575; val_auprc_score: 0.9892; val_best_acc_score: 0.9561; val_best_f1_score: 0.9746; train_kl_reg_loss: 11955.4966; train_edge_recon_loss: 774922.4985; train_gene_expr_recon_loss: 1533327.7762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2320205.7965; train_optim_loss: 2320205.7965; val_kl_reg_loss: 11653.0879; val_edge_recon_loss: 805587.5625; val_gene_expr_recon_loss: 1516082.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2333322.8500; val_optim_loss: 2333322.8500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9562; val_auprc_score: 0.9898; val_best_acc_score: 0.9540; val_best_f1_score: 0.9734; train_kl_reg_loss: 11835.5403; train_edge_recon_loss: 801082.1279; train_gene_expr_recon_loss: 1527068.5552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2339986.2151; train_optim_loss: 2339986.2151; val_kl_reg_loss: 11849.0508; val_edge_recon_loss: 821575.5000; val_gene_expr_recon_loss: 1526942.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2360367.3000; val_optim_loss: 2360367.3000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9545; val_auprc_score: 0.9881; val_best_acc_score: 0.9544; val_best_f1_score: 0.9734; train_kl_reg_loss: 12239.0418; train_edge_recon_loss: 795348.3808; train_gene_expr_recon_loss: 1519932.0058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2327519.4244; train_optim_loss: 2327519.4244; val_kl_reg_loss: 11774.8869; val_edge_recon_loss: 819735.8875; val_gene_expr_recon_loss: 1502211.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2333721.9000; val_optim_loss: 2333721.9000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9633; val_auprc_score: 0.9868; val_best_acc_score: 0.9584; val_best_f1_score: 0.9756; train_kl_reg_loss: 11851.3789; train_edge_recon_loss: 778987.2340; train_gene_expr_recon_loss: 1510599.8517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2301438.4593; train_optim_loss: 2301438.4593; val_kl_reg_loss: 11883.7184; val_edge_recon_loss: 827434.2750; val_gene_expr_recon_loss: 1535336.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2374654.3500; val_optim_loss: 2374654.3500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9569; val_auprc_score: 0.9864; val_best_acc_score: 0.9606; val_best_f1_score: 0.9771; train_kl_reg_loss: 11920.4540; train_edge_recon_loss: 779120.1388; train_gene_expr_recon_loss: 1504771.4593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2295812.0523; train_optim_loss: 2295812.0523; val_kl_reg_loss: 11794.7906; val_edge_recon_loss: 771578.2125; val_gene_expr_recon_loss: 1492399.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2275772.4750; val_optim_loss: 2275772.4750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9557; val_auprc_score: 0.9889; val_best_acc_score: 0.9598; val_best_f1_score: 0.9768; train_kl_reg_loss: 11779.4791; train_edge_recon_loss: 783776.1730; train_gene_expr_recon_loss: 1500494.1453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2296049.7907; train_optim_loss: 2296049.7907; val_kl_reg_loss: 11754.3818; val_edge_recon_loss: 785521.0500; val_gene_expr_recon_loss: 1528801.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2326076.5500; val_optim_loss: 2326076.5500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9561; val_auprc_score: 0.9892; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 11854.9509; train_edge_recon_loss: 783788.4142; train_gene_expr_recon_loss: 1502037.4041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2297680.7791; train_optim_loss: 2297680.7791; val_kl_reg_loss: 11720.8553; val_edge_recon_loss: 811727.1875; val_gene_expr_recon_loss: 1468802.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2292250.7000; val_optim_loss: 2292250.7000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9421; val_auprc_score: 0.9807; val_best_acc_score: 0.9561; val_best_f1_score: 0.9746; train_kl_reg_loss: 11877.5415; train_edge_recon_loss: 774438.9797; train_gene_expr_recon_loss: 1500135.5087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2286452.0116; train_optim_loss: 2286452.0116; val_kl_reg_loss: 11947.6896; val_edge_recon_loss: 820494.6625; val_gene_expr_recon_loss: 1519116.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2351559.0000; val_optim_loss: 2351559.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9488; val_auprc_score: 0.9829; val_best_acc_score: 0.9520; val_best_f1_score: 0.9719; train_kl_reg_loss: 11926.7833; train_edge_recon_loss: 768074.0422; train_gene_expr_recon_loss: 1499099.8866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2279100.7267; train_optim_loss: 2279100.7267; val_kl_reg_loss: 11757.7352; val_edge_recon_loss: 873539.7000; val_gene_expr_recon_loss: 1509655.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2394953.3500; val_optim_loss: 2394953.3500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9651; val_auprc_score: 0.9916; val_best_acc_score: 0.9611; val_best_f1_score: 0.9774; train_kl_reg_loss: 11926.9536; train_edge_recon_loss: 787248.3416; train_gene_expr_recon_loss: 1499567.8023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2298743.0814; train_optim_loss: 2298743.0814; val_kl_reg_loss: 11954.2225; val_edge_recon_loss: 785977.7500; val_gene_expr_recon_loss: 1511563.5250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2309495.5000; val_optim_loss: 2309495.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9558; val_auprc_score: 0.9886; val_best_acc_score: 0.9561; val_best_f1_score: 0.9749; train_kl_reg_loss: 11932.9998; train_edge_recon_loss: 797382.9273; train_gene_expr_recon_loss: 1501522.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2310838.4477; train_optim_loss: 2310838.4477; val_kl_reg_loss: 11793.4977; val_edge_recon_loss: 776065.1750; val_gene_expr_recon_loss: 1518671.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2306530.3000; val_optim_loss: 2306530.3000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9580; val_auprc_score: 0.9866; val_best_acc_score: 0.9613; val_best_f1_score: 0.9777; train_kl_reg_loss: 11944.9965; train_edge_recon_loss: 771728.7035; train_gene_expr_recon_loss: 1497369.8517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2281043.5523; train_optim_loss: 2281043.5523; val_kl_reg_loss: 11930.5146; val_edge_recon_loss: 779930.0750; val_gene_expr_recon_loss: 1499218.0750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2291078.6500; val_optim_loss: 2291078.6500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9570; val_auprc_score: 0.9902; val_best_acc_score: 0.9606; val_best_f1_score: 0.9774; train_kl_reg_loss: 11934.3928; train_edge_recon_loss: 798420.2536; train_gene_expr_recon_loss: 1498130.5959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2308485.2384; train_optim_loss: 2308485.2384; val_kl_reg_loss: 11718.1539; val_edge_recon_loss: 751629.7375; val_gene_expr_recon_loss: 1451388.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2214736.2000; val_optim_loss: 2214736.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9599; val_auprc_score: 0.9891; val_best_acc_score: 0.9568; val_best_f1_score: 0.9746; train_kl_reg_loss: 11939.6110; train_edge_recon_loss: 794290.0552; train_gene_expr_recon_loss: 1498554.1308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2304783.7965; train_optim_loss: 2304783.7965; val_kl_reg_loss: 11848.1307; val_edge_recon_loss: 842120.0375; val_gene_expr_recon_loss: 1513774.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2367743.1000; val_optim_loss: 2367743.1000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9449; val_auprc_score: 0.9850; val_best_acc_score: 0.9535; val_best_f1_score: 0.9730; train_kl_reg_loss: 11961.4093; train_edge_recon_loss: 773966.0392; train_gene_expr_recon_loss: 1498359.1657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2284286.5988; train_optim_loss: 2284286.5988; val_kl_reg_loss: 11854.1049; val_edge_recon_loss: 827200.6875; val_gene_expr_recon_loss: 1545979.9250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2385034.8000; val_optim_loss: 2385034.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9570; val_auprc_score: 0.9879; val_best_acc_score: 0.9560; val_best_f1_score: 0.9744; train_kl_reg_loss: 11965.9564; train_edge_recon_loss: 780824.9695; train_gene_expr_recon_loss: 1499276.4826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2292067.4302; train_optim_loss: 2292067.4302; val_kl_reg_loss: 11931.3977; val_edge_recon_loss: 800017.7375; val_gene_expr_recon_loss: 1492983.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2304932.8000; val_optim_loss: 2304932.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9654; val_auprc_score: 0.9894; val_best_acc_score: 0.9597; val_best_f1_score: 0.9764; train_kl_reg_loss: 11939.4501; train_edge_recon_loss: 798663.6759; train_gene_expr_recon_loss: 1500528.6570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2311131.7849; train_optim_loss: 2311131.7849; val_kl_reg_loss: 11736.2918; val_edge_recon_loss: 834776.8625; val_gene_expr_recon_loss: 1491495.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2338008.7000; val_optim_loss: 2338008.7000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9659; val_auprc_score: 0.9923; val_best_acc_score: 0.9616; val_best_f1_score: 0.9777; train_kl_reg_loss: 11960.8015; train_edge_recon_loss: 769905.7544; train_gene_expr_recon_loss: 1497732.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2279599.0930; train_optim_loss: 2279599.0930; val_kl_reg_loss: 11721.4807; val_edge_recon_loss: 782610.0125; val_gene_expr_recon_loss: 1479458.1500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2273789.6500; val_optim_loss: 2273789.6500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9575; val_auprc_score: 0.9897; val_best_acc_score: 0.9576; val_best_f1_score: 0.9752; train_kl_reg_loss: 11957.3487; train_edge_recon_loss: 767388.8663; train_gene_expr_recon_loss: 1500502.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2279848.7849; train_optim_loss: 2279848.7849; val_kl_reg_loss: 11891.5592; val_edge_recon_loss: 810592.5500; val_gene_expr_recon_loss: 1510703.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2333187.7500; val_optim_loss: 2333187.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9480; val_auprc_score: 0.9823; val_best_acc_score: 0.9539; val_best_f1_score: 0.9731; train_kl_reg_loss: 11948.2705; train_edge_recon_loss: 794225.7413; train_gene_expr_recon_loss: 1498276.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2304450.7674; train_optim_loss: 2304450.7674; val_kl_reg_loss: 12106.6080; val_edge_recon_loss: 845057.9750; val_gene_expr_recon_loss: 1491194.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2348358.9000; val_optim_loss: 2348358.9000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9567; val_auprc_score: 0.9872; val_best_acc_score: 0.9636; val_best_f1_score: 0.9789; train_kl_reg_loss: 11939.5104; train_edge_recon_loss: 777229.6177; train_gene_expr_recon_loss: 1498160.1483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2287329.2849; train_optim_loss: 2287329.2849; val_kl_reg_loss: 11704.0521; val_edge_recon_loss: 771550.1875; val_gene_expr_recon_loss: 1481900.7250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2265154.9500; val_optim_loss: 2265154.9500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 19 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9657
val AUPRC score: 0.9908
val best accuracy score: 0.9564
val best F1 score: 0.9750
val target rna MSE score: 0.7696
val source rna MSE score: 0.2157
Val cat covariate0 mean sim diff: -0.0054
Duration of model training in run 3: 0 hours, 6 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8349; val_auprc_score: 0.9644; val_best_acc_score: 0.8819; val_best_f1_score: 0.9347; train_kl_reg_loss: 1587.1361; train_edge_recon_loss: 1010860.7841; train_gene_expr_recon_loss: 2304027.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3316475.4659; train_optim_loss: 3316475.4659; val_kl_reg_loss: 4452.7803; val_edge_recon_loss: 1238229.1667; val_gene_expr_recon_loss: 2242054.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3484736.0000; val_optim_loss: 3484736.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8216; val_auprc_score: 0.9594; val_best_acc_score: 0.8890; val_best_f1_score: 0.9394; train_kl_reg_loss: 6327.1758; train_edge_recon_loss: 1046930.4318; train_gene_expr_recon_loss: 2129269.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3182527.4205; train_optim_loss: 3182527.4205; val_kl_reg_loss: 6979.2965; val_edge_recon_loss: 1084694.0833; val_gene_expr_recon_loss: 1986211.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3077885.3333; val_optim_loss: 3077885.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8168; val_auprc_score: 0.9602; val_best_acc_score: 0.8852; val_best_f1_score: 0.9367; train_kl_reg_loss: 7633.9184; train_edge_recon_loss: 1008497.1051; train_gene_expr_recon_loss: 2006867.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022998.0568; train_optim_loss: 3022998.0568; val_kl_reg_loss: 6508.2295; val_edge_recon_loss: 1060030.3958; val_gene_expr_recon_loss: 1949467.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3016005.8333; val_optim_loss: 3016005.8333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8109; val_auprc_score: 0.9645; val_best_acc_score: 0.8968; val_best_f1_score: 0.9441; train_kl_reg_loss: 9712.0194; train_edge_recon_loss: 924190.2528; train_gene_expr_recon_loss: 1922874.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2856776.8864; train_optim_loss: 2856776.8864; val_kl_reg_loss: 11071.7874; val_edge_recon_loss: 806597.4167; val_gene_expr_recon_loss: 1865342.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2683011.5833; val_optim_loss: 2683011.5833
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8424; val_auprc_score: 0.9637; val_best_acc_score: 0.8791; val_best_f1_score: 0.9333; train_kl_reg_loss: 12097.5613; train_edge_recon_loss: 932423.3040; train_gene_expr_recon_loss: 1867713.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2812234.4205; train_optim_loss: 2812234.4205; val_kl_reg_loss: 13332.5840; val_edge_recon_loss: 917639.1875; val_gene_expr_recon_loss: 1804659.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2735631.7500; val_optim_loss: 2735631.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8237; val_auprc_score: 0.9532; val_best_acc_score: 0.8735; val_best_f1_score: 0.9295; train_kl_reg_loss: 12648.2279; train_edge_recon_loss: 928242.0710; train_gene_expr_recon_loss: 1834109.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2774999.7273; train_optim_loss: 2774999.7273; val_kl_reg_loss: 11868.4290; val_edge_recon_loss: 961247.0833; val_gene_expr_recon_loss: 1799277.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2772393.0000; val_optim_loss: 2772393.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8340; val_auprc_score: 0.9626; val_best_acc_score: 0.8737; val_best_f1_score: 0.9294; train_kl_reg_loss: 11227.2315; train_edge_recon_loss: 903130.3068; train_gene_expr_recon_loss: 1814175.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2728532.8409; train_optim_loss: 2728532.8409; val_kl_reg_loss: 10674.4111; val_edge_recon_loss: 982521.0000; val_gene_expr_recon_loss: 1787881.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2781076.5833; val_optim_loss: 2781076.5833
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8448; val_auprc_score: 0.9576; val_best_acc_score: 0.8748; val_best_f1_score: 0.9303; train_kl_reg_loss: 11636.2005; train_edge_recon_loss: 866749.0199; train_gene_expr_recon_loss: 1786089.2898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2664474.5341; train_optim_loss: 2664474.5341; val_kl_reg_loss: 12028.7370; val_edge_recon_loss: 915751.3542; val_gene_expr_recon_loss: 1747164.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2674944.5833; val_optim_loss: 2674944.5833
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8770; val_auprc_score: 0.9731; val_best_acc_score: 0.8880; val_best_f1_score: 0.9372; train_kl_reg_loss: 12353.3326; train_edge_recon_loss: 849995.9233; train_gene_expr_recon_loss: 1773385.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2635734.7159; train_optim_loss: 2635734.7159; val_kl_reg_loss: 12806.2142; val_edge_recon_loss: 813727.1458; val_gene_expr_recon_loss: 1768525.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2595058.5833; val_optim_loss: 2595058.5833
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8683; val_auprc_score: 0.9697; val_best_acc_score: 0.8814; val_best_f1_score: 0.9341; train_kl_reg_loss: 12774.1997; train_edge_recon_loss: 828350.4517; train_gene_expr_recon_loss: 1766542.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2607666.7841; train_optim_loss: 2607666.7841; val_kl_reg_loss: 13208.7653; val_edge_recon_loss: 900558.8958; val_gene_expr_recon_loss: 1739398.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2653166.4167; val_optim_loss: 2653166.4167
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8813; val_auprc_score: 0.9674; val_best_acc_score: 0.8879; val_best_f1_score: 0.9357; train_kl_reg_loss: 13052.6655; train_edge_recon_loss: 826565.9290; train_gene_expr_recon_loss: 1737668.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2577287.2500; train_optim_loss: 2577287.2500; val_kl_reg_loss: 12329.2578; val_edge_recon_loss: 899949.3958; val_gene_expr_recon_loss: 1778356.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2690634.9167; val_optim_loss: 2690634.9167
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8785; val_auprc_score: 0.9662; val_best_acc_score: 0.8911; val_best_f1_score: 0.9370; train_kl_reg_loss: 12567.5685; train_edge_recon_loss: 817768.9403; train_gene_expr_recon_loss: 1729412.0114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2559748.5114; train_optim_loss: 2559748.5114; val_kl_reg_loss: 12855.2930; val_edge_recon_loss: 936260.2917; val_gene_expr_recon_loss: 1723136.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2672252.3333; val_optim_loss: 2672252.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9035; val_auprc_score: 0.9695; val_best_acc_score: 0.8938; val_best_f1_score: 0.9387; train_kl_reg_loss: 12811.9755; train_edge_recon_loss: 849060.1761; train_gene_expr_recon_loss: 1715509.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2577381.9773; train_optim_loss: 2577381.9773; val_kl_reg_loss: 13063.8919; val_edge_recon_loss: 908321.6042; val_gene_expr_recon_loss: 1766671.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2688056.9167; val_optim_loss: 2688056.9167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8929; val_auprc_score: 0.9725; val_best_acc_score: 0.8943; val_best_f1_score: 0.9398; train_kl_reg_loss: 13181.7505; train_edge_recon_loss: 835096.7301; train_gene_expr_recon_loss: 1706335.0398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2554613.5341; train_optim_loss: 2554613.5341; val_kl_reg_loss: 12903.1208; val_edge_recon_loss: 887504.2292; val_gene_expr_recon_loss: 1724957.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2625365.1667; val_optim_loss: 2625365.1667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8738; val_auprc_score: 0.9716; val_best_acc_score: 0.8932; val_best_f1_score: 0.9404; train_kl_reg_loss: 13029.9363; train_edge_recon_loss: 815709.5994; train_gene_expr_recon_loss: 1703087.9432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531827.4886; train_optim_loss: 2531827.4886; val_kl_reg_loss: 13270.7786; val_edge_recon_loss: 907418.5000; val_gene_expr_recon_loss: 1667374.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2588063.6667; val_optim_loss: 2588063.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8754; val_auprc_score: 0.9724; val_best_acc_score: 0.8974; val_best_f1_score: 0.9418; train_kl_reg_loss: 13051.2251; train_edge_recon_loss: 845825.5341; train_gene_expr_recon_loss: 1706297.5852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2565174.3409; train_optim_loss: 2565174.3409; val_kl_reg_loss: 12421.2624; val_edge_recon_loss: 833936.5417; val_gene_expr_recon_loss: 1646529.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2492887.5000; val_optim_loss: 2492887.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8781; val_auprc_score: 0.9591; val_best_acc_score: 0.8988; val_best_f1_score: 0.9423; train_kl_reg_loss: 13013.3902; train_edge_recon_loss: 833861.7557; train_gene_expr_recon_loss: 1706479.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2553354.3977; train_optim_loss: 2553354.3977; val_kl_reg_loss: 13020.9115; val_edge_recon_loss: 867803.3750; val_gene_expr_recon_loss: 1717420.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2598245.1667; val_optim_loss: 2598245.1667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8890; val_auprc_score: 0.9730; val_best_acc_score: 0.8928; val_best_f1_score: 0.9396; train_kl_reg_loss: 12962.1551; train_edge_recon_loss: 825970.2415; train_gene_expr_recon_loss: 1700944.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2539877.1023; train_optim_loss: 2539877.1023; val_kl_reg_loss: 13122.8958; val_edge_recon_loss: 915933.0208; val_gene_expr_recon_loss: 1739226.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2668282.0833; val_optim_loss: 2668282.0833
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9021; val_auprc_score: 0.9734; val_best_acc_score: 0.8992; val_best_f1_score: 0.9432; train_kl_reg_loss: 13053.6527; train_edge_recon_loss: 839130.9375; train_gene_expr_recon_loss: 1700967.0966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2553151.6932; train_optim_loss: 2553151.6932; val_kl_reg_loss: 13753.5322; val_edge_recon_loss: 867694.2292; val_gene_expr_recon_loss: 1821326.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2702773.9167; val_optim_loss: 2702773.9167
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8892; val_auprc_score: 0.9705; val_best_acc_score: 0.9008; val_best_f1_score: 0.9442; train_kl_reg_loss: 13099.7757; train_edge_recon_loss: 798172.3977; train_gene_expr_recon_loss: 1699946.2898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2511218.4545; train_optim_loss: 2511218.4545; val_kl_reg_loss: 13123.1748; val_edge_recon_loss: 781877.1875; val_gene_expr_recon_loss: 1710837.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2505837.7500; val_optim_loss: 2505837.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9094; val_auprc_score: 0.9798; val_best_acc_score: 0.9120; val_best_f1_score: 0.9502; train_kl_reg_loss: 13118.3032; train_edge_recon_loss: 823799.5966; train_gene_expr_recon_loss: 1699630.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2536548.8182; train_optim_loss: 2536548.8182; val_kl_reg_loss: 13244.0306; val_edge_recon_loss: 760203.8958; val_gene_expr_recon_loss: 1668538.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2441986.8333; val_optim_loss: 2441986.8333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9121; val_auprc_score: 0.9807; val_best_acc_score: 0.9069; val_best_f1_score: 0.9475; train_kl_reg_loss: 13108.4325; train_edge_recon_loss: 833060.1619; train_gene_expr_recon_loss: 1704103.0739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2550271.6818; train_optim_loss: 2550271.6818; val_kl_reg_loss: 13377.0830; val_edge_recon_loss: 768260.6875; val_gene_expr_recon_loss: 1721007.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2502645.7500; val_optim_loss: 2502645.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9011; val_auprc_score: 0.9751; val_best_acc_score: 0.8988; val_best_f1_score: 0.9412; train_kl_reg_loss: 13058.0079; train_edge_recon_loss: 840200.0909; train_gene_expr_recon_loss: 1698416.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2551674.9886; train_optim_loss: 2551674.9886; val_kl_reg_loss: 13049.6960; val_edge_recon_loss: 941863.6042; val_gene_expr_recon_loss: 1679094.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2634008.0833; val_optim_loss: 2634008.0833
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8961; val_auprc_score: 0.9761; val_best_acc_score: 0.9013; val_best_f1_score: 0.9447; train_kl_reg_loss: 13024.0066; train_edge_recon_loss: 827874.2088; train_gene_expr_recon_loss: 1698534.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2539433.1364; train_optim_loss: 2539433.1364; val_kl_reg_loss: 12992.3672; val_edge_recon_loss: 805040.9792; val_gene_expr_recon_loss: 1739985.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2558019.0000; val_optim_loss: 2558019.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9080; val_auprc_score: 0.9804; val_best_acc_score: 0.9095; val_best_f1_score: 0.9492; train_kl_reg_loss: 13067.3979; train_edge_recon_loss: 821230.9091; train_gene_expr_recon_loss: 1699133.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2533431.5682; train_optim_loss: 2533431.5682; val_kl_reg_loss: 13050.2161; val_edge_recon_loss: 823166.6250; val_gene_expr_recon_loss: 1716999.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2553216.2500; val_optim_loss: 2553216.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9162; val_auprc_score: 0.9793; val_best_acc_score: 0.9059; val_best_f1_score: 0.9466; train_kl_reg_loss: 13090.7305; train_edge_recon_loss: 824879.6534; train_gene_expr_recon_loss: 1701101.5341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2539071.9091; train_optim_loss: 2539071.9091; val_kl_reg_loss: 13072.0765; val_edge_recon_loss: 848791.5833; val_gene_expr_recon_loss: 1714600.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2576464.3333; val_optim_loss: 2576464.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9056; val_auprc_score: 0.9778; val_best_acc_score: 0.9117; val_best_f1_score: 0.9502; train_kl_reg_loss: 13049.2600; train_edge_recon_loss: 808410.7500; train_gene_expr_recon_loss: 1697437.1080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2518897.1250; train_optim_loss: 2518897.1250; val_kl_reg_loss: 13093.8659; val_edge_recon_loss: 758237.6667; val_gene_expr_recon_loss: 1727969.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2499301.2500; val_optim_loss: 2499301.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8955; val_auprc_score: 0.9745; val_best_acc_score: 0.8996; val_best_f1_score: 0.9429; train_kl_reg_loss: 13097.4415; train_edge_recon_loss: 815477.0142; train_gene_expr_recon_loss: 1702661.9943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531236.4659; train_optim_loss: 2531236.4659; val_kl_reg_loss: 13028.5244; val_edge_recon_loss: 861901.3333; val_gene_expr_recon_loss: 1715946.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2590875.9167; val_optim_loss: 2590875.9167
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8887; val_auprc_score: 0.9735; val_best_acc_score: 0.8974; val_best_f1_score: 0.9417; train_kl_reg_loss: 13060.7958; train_edge_recon_loss: 821799.2301; train_gene_expr_recon_loss: 1702330.7386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2537190.7500; train_optim_loss: 2537190.7500; val_kl_reg_loss: 12950.9694; val_edge_recon_loss: 928781.2292; val_gene_expr_recon_loss: 1683357.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2625089.8333; val_optim_loss: 2625089.8333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 21 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.8738
val AUPRC score: 0.9704
val best accuracy score: 0.9020
val best F1 score: 0.9446
val target rna MSE score: 1.1981
val source rna MSE score: 0.6741
Val cat covariate0 mean sim diff: -0.0212
Duration of model training in run 2: 0 hours, 1 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8545; val_auprc_score: 0.9701; val_best_acc_score: 0.8791; val_best_f1_score: 0.9324; train_kl_reg_loss: 1112.6051; train_edge_recon_loss: 996451.9347; train_gene_expr_recon_loss: 2270163.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3267727.7955; train_optim_loss: 3267727.7955; val_kl_reg_loss: 3539.0932; val_edge_recon_loss: 1212575.3542; val_gene_expr_recon_loss: 2191213.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407328.1667; val_optim_loss: 3407328.1667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8130; val_auprc_score: 0.9563; val_best_acc_score: 0.8821; val_best_f1_score: 0.9350; train_kl_reg_loss: 4418.7365; train_edge_recon_loss: 1023437.9290; train_gene_expr_recon_loss: 2127155.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3155012.0682; train_optim_loss: 3155012.0682; val_kl_reg_loss: 5104.2588; val_edge_recon_loss: 1092041.4167; val_gene_expr_recon_loss: 2104231.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3201377.5000; val_optim_loss: 3201377.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7830; val_auprc_score: 0.9502; val_best_acc_score: 0.8854; val_best_f1_score: 0.9373; train_kl_reg_loss: 5050.7629; train_edge_recon_loss: 995031.8892; train_gene_expr_recon_loss: 2018631.2784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3018713.8977; train_optim_loss: 3018713.8977; val_kl_reg_loss: 6263.5000; val_edge_recon_loss: 1002217.7083; val_gene_expr_recon_loss: 2081848.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3090330.0833; val_optim_loss: 3090330.0833
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7734; val_auprc_score: 0.9461; val_best_acc_score: 0.8675; val_best_f1_score: 0.9273; train_kl_reg_loss: 7266.5311; train_edge_recon_loss: 984467.5966; train_gene_expr_recon_loss: 1934466.2330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2926200.3636; train_optim_loss: 2926200.3636; val_kl_reg_loss: 8540.5911; val_edge_recon_loss: 1045985.8542; val_gene_expr_recon_loss: 1877898.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2932425.0833; val_optim_loss: 2932425.0833
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7924; val_auprc_score: 0.9500; val_best_acc_score: 0.8723; val_best_f1_score: 0.9293; train_kl_reg_loss: 10732.6406; train_edge_recon_loss: 937138.8352; train_gene_expr_recon_loss: 1880039.8920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2827911.3977; train_optim_loss: 2827911.3977; val_kl_reg_loss: 12013.8288; val_edge_recon_loss: 965507.0000; val_gene_expr_recon_loss: 1860905.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2838426.3333; val_optim_loss: 2838426.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8188; val_auprc_score: 0.9562; val_best_acc_score: 0.8868; val_best_f1_score: 0.9366; train_kl_reg_loss: 11273.7927; train_edge_recon_loss: 902470.6619; train_gene_expr_recon_loss: 1846076.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2759821.2386; train_optim_loss: 2759821.2386; val_kl_reg_loss: 11015.4310; val_edge_recon_loss: 968131.8750; val_gene_expr_recon_loss: 1881655.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2860802.5833; val_optim_loss: 2860802.5833
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8438; val_auprc_score: 0.9621; val_best_acc_score: 0.8813; val_best_f1_score: 0.9335; train_kl_reg_loss: 10968.8518; train_edge_recon_loss: 913324.2869; train_gene_expr_recon_loss: 1813212.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2737505.6250; train_optim_loss: 2737505.6250; val_kl_reg_loss: 11311.8971; val_edge_recon_loss: 948121.1250; val_gene_expr_recon_loss: 1776587.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2736020.3333; val_optim_loss: 2736020.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8481; val_auprc_score: 0.9658; val_best_acc_score: 0.8823; val_best_f1_score: 0.9345; train_kl_reg_loss: 10519.1016; train_edge_recon_loss: 881930.9375; train_gene_expr_recon_loss: 1795877.8352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2688327.8864; train_optim_loss: 2688327.8864; val_kl_reg_loss: 10951.3105; val_edge_recon_loss: 908188.9375; val_gene_expr_recon_loss: 1804358.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2723498.6667; val_optim_loss: 2723498.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8293; val_auprc_score: 0.9598; val_best_acc_score: 0.8768; val_best_f1_score: 0.9322; train_kl_reg_loss: 11228.2155; train_edge_recon_loss: 892013.4773; train_gene_expr_recon_loss: 1778122.2386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2681363.9205; train_optim_loss: 2681363.9205; val_kl_reg_loss: 12725.2751; val_edge_recon_loss: 890834.3542; val_gene_expr_recon_loss: 1830363.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2733923.5000; val_optim_loss: 2733923.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8620; val_auprc_score: 0.9598; val_best_acc_score: 0.8767; val_best_f1_score: 0.9297; train_kl_reg_loss: 11683.5690; train_edge_recon_loss: 886137.3580; train_gene_expr_recon_loss: 1761573.0227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2659393.9205; train_optim_loss: 2659393.9205; val_kl_reg_loss: 10827.8229; val_edge_recon_loss: 1017496.6250; val_gene_expr_recon_loss: 1830821.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2859146.2500; val_optim_loss: 2859146.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8868; val_auprc_score: 0.9764; val_best_acc_score: 0.9038; val_best_f1_score: 0.9465; train_kl_reg_loss: 11537.2411; train_edge_recon_loss: 845650.9091; train_gene_expr_recon_loss: 1742899.6705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2600087.8068; train_optim_loss: 2600087.8068; val_kl_reg_loss: 12209.7262; val_edge_recon_loss: 803564.8542; val_gene_expr_recon_loss: 1754864.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2570638.6667; val_optim_loss: 2570638.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8828; val_auprc_score: 0.9730; val_best_acc_score: 0.8977; val_best_f1_score: 0.9415; train_kl_reg_loss: 11957.6137; train_edge_recon_loss: 842766.2585; train_gene_expr_recon_loss: 1728014.8693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2582738.7273; train_optim_loss: 2582738.7273; val_kl_reg_loss: 12249.6032; val_edge_recon_loss: 806690.2500; val_gene_expr_recon_loss: 1798377.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2617317.0833; val_optim_loss: 2617317.0833
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8711; val_auprc_score: 0.9677; val_best_acc_score: 0.8965; val_best_f1_score: 0.9403; train_kl_reg_loss: 12592.1708; train_edge_recon_loss: 858009.9830; train_gene_expr_recon_loss: 1714225.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2584827.2955; train_optim_loss: 2584827.2955; val_kl_reg_loss: 13008.1081; val_edge_recon_loss: 880286.5833; val_gene_expr_recon_loss: 1673870.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2567165.1667; val_optim_loss: 2567165.1667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8818; val_auprc_score: 0.9634; val_best_acc_score: 0.9017; val_best_f1_score: 0.9439; train_kl_reg_loss: 12934.0021; train_edge_recon_loss: 843743.2244; train_gene_expr_recon_loss: 1706395.5511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2563072.7727; train_optim_loss: 2563072.7727; val_kl_reg_loss: 12523.9105; val_edge_recon_loss: 876716.9792; val_gene_expr_recon_loss: 1676001.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2565242.6667; val_optim_loss: 2565242.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8645; val_auprc_score: 0.9658; val_best_acc_score: 0.9069; val_best_f1_score: 0.9472; train_kl_reg_loss: 12927.3532; train_edge_recon_loss: 795212.6562; train_gene_expr_recon_loss: 1701635.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2509775.2273; train_optim_loss: 2509775.2273; val_kl_reg_loss: 12654.4974; val_edge_recon_loss: 800258.9167; val_gene_expr_recon_loss: 1732681.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2545595.1667; val_optim_loss: 2545595.1667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8820; val_auprc_score: 0.9657; val_best_acc_score: 0.9106; val_best_f1_score: 0.9493; train_kl_reg_loss: 12793.2158; train_edge_recon_loss: 820012.0142; train_gene_expr_recon_loss: 1691031.2159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523836.4432; train_optim_loss: 2523836.4432; val_kl_reg_loss: 12262.6585; val_edge_recon_loss: 826486.5833; val_gene_expr_recon_loss: 1659302.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2498051.7500; val_optim_loss: 2498051.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9107; val_auprc_score: 0.9728; val_best_acc_score: 0.9116; val_best_f1_score: 0.9492; train_kl_reg_loss: 13086.9861; train_edge_recon_loss: 846584.7244; train_gene_expr_recon_loss: 1677520.4148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2537192.1250; train_optim_loss: 2537192.1250; val_kl_reg_loss: 13407.4600; val_edge_recon_loss: 879366.6875; val_gene_expr_recon_loss: 1739968.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2632743.0000; val_optim_loss: 2632743.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8839; val_auprc_score: 0.9669; val_best_acc_score: 0.9210; val_best_f1_score: 0.9550; train_kl_reg_loss: 13078.7812; train_edge_recon_loss: 838306.9034; train_gene_expr_recon_loss: 1671801.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523186.7500; train_optim_loss: 2523186.7500; val_kl_reg_loss: 12991.5205; val_edge_recon_loss: 842658.2917; val_gene_expr_recon_loss: 1631790.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2487440.4167; val_optim_loss: 2487440.4167
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9453; val_auprc_score: 0.9860; val_best_acc_score: 0.9322; val_best_f1_score: 0.9611; train_kl_reg_loss: 12889.9392; train_edge_recon_loss: 854530.2670; train_gene_expr_recon_loss: 1661877.1534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2529297.3750; train_optim_loss: 2529297.3750; val_kl_reg_loss: 13074.9157; val_edge_recon_loss: 799393.0000; val_gene_expr_recon_loss: 1687581.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2500049.5833; val_optim_loss: 2500049.5833
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9399; val_auprc_score: 0.9866; val_best_acc_score: 0.9311; val_best_f1_score: 0.9605; train_kl_reg_loss: 12924.8896; train_edge_recon_loss: 826477.4602; train_gene_expr_recon_loss: 1659399.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2498801.6477; train_optim_loss: 2498801.6477; val_kl_reg_loss: 12788.1833; val_edge_recon_loss: 834895.2708; val_gene_expr_recon_loss: 1694717.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2542400.8333; val_optim_loss: 2542400.8333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9132; val_auprc_score: 0.9788; val_best_acc_score: 0.9341; val_best_f1_score: 0.9619; train_kl_reg_loss: 13502.5353; train_edge_recon_loss: 835459.8125; train_gene_expr_recon_loss: 1650753.2330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2499715.5909; train_optim_loss: 2499715.5909; val_kl_reg_loss: 13926.9329; val_edge_recon_loss: 853539.0625; val_gene_expr_recon_loss: 1728424.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2595890.7500; val_optim_loss: 2595890.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9363; val_auprc_score: 0.9859; val_best_acc_score: 0.9372; val_best_f1_score: 0.9640; train_kl_reg_loss: 13573.2561; train_edge_recon_loss: 807116.4830; train_gene_expr_recon_loss: 1644552.5284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2465242.2727; train_optim_loss: 2465242.2727; val_kl_reg_loss: 13138.7464; val_edge_recon_loss: 738220.2292; val_gene_expr_recon_loss: 1659644.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2411003.8333; val_optim_loss: 2411003.8333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9424; val_auprc_score: 0.9863; val_best_acc_score: 0.9305; val_best_f1_score: 0.9604; train_kl_reg_loss: 13049.3601; train_edge_recon_loss: 811285.0199; train_gene_expr_recon_loss: 1639278.2102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2463612.6136; train_optim_loss: 2463612.6136; val_kl_reg_loss: 13105.4219; val_edge_recon_loss: 859591.8750; val_gene_expr_recon_loss: 1623331.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2496029.1667; val_optim_loss: 2496029.1667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9325; val_auprc_score: 0.9762; val_best_acc_score: 0.9382; val_best_f1_score: 0.9639; train_kl_reg_loss: 13180.3695; train_edge_recon_loss: 791280.5028; train_gene_expr_recon_loss: 1629185.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2433646.4773; train_optim_loss: 2433646.4773; val_kl_reg_loss: 13380.4160; val_edge_recon_loss: 882793.5417; val_gene_expr_recon_loss: 1629047.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2525221.4167; val_optim_loss: 2525221.4167
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9079; val_auprc_score: 0.9725; val_best_acc_score: 0.9412; val_best_f1_score: 0.9666; train_kl_reg_loss: 13420.5226; train_edge_recon_loss: 801598.4972; train_gene_expr_recon_loss: 1625722.3011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2440741.3182; train_optim_loss: 2440741.3182; val_kl_reg_loss: 12960.2832; val_edge_recon_loss: 785763.7083; val_gene_expr_recon_loss: 1651364.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2450088.9167; val_optim_loss: 2450088.9167
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9347; val_auprc_score: 0.9835; val_best_acc_score: 0.9331; val_best_f1_score: 0.9615; train_kl_reg_loss: 13172.9363; train_edge_recon_loss: 781298.9886; train_gene_expr_recon_loss: 1616332.2670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2410804.2159; train_optim_loss: 2410804.2159; val_kl_reg_loss: 13161.9720; val_edge_recon_loss: 899662.8958; val_gene_expr_recon_loss: 1664985.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2577810.0833; val_optim_loss: 2577810.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9237; val_auprc_score: 0.9795; val_best_acc_score: 0.9418; val_best_f1_score: 0.9669; train_kl_reg_loss: 13089.8551; train_edge_recon_loss: 803328.0028; train_gene_expr_recon_loss: 1615024.8580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2431442.6932; train_optim_loss: 2431442.6932; val_kl_reg_loss: 13003.3079; val_edge_recon_loss: 782905.7083; val_gene_expr_recon_loss: 1616384.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2412293.5833; val_optim_loss: 2412293.5833
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9304; val_auprc_score: 0.9832; val_best_acc_score: 0.9380; val_best_f1_score: 0.9647; train_kl_reg_loss: 13053.5127; train_edge_recon_loss: 808984.7188; train_gene_expr_recon_loss: 1612990.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2435028.7045; train_optim_loss: 2435028.7045; val_kl_reg_loss: 12854.8073; val_edge_recon_loss: 792189.5833; val_gene_expr_recon_loss: 1641816.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2446861.0000; val_optim_loss: 2446861.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9431; val_auprc_score: 0.9862; val_best_acc_score: 0.9370; val_best_f1_score: 0.9636; train_kl_reg_loss: 13126.4034; train_edge_recon_loss: 795763.1676; train_gene_expr_recon_loss: 1610194.9261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2419084.5114; train_optim_loss: 2419084.5114; val_kl_reg_loss: 12963.8444; val_edge_recon_loss: 856120.2083; val_gene_expr_recon_loss: 1626282.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2495366.6667; val_optim_loss: 2495366.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9352; val_auprc_score: 0.9809; val_best_acc_score: 0.9449; val_best_f1_score: 0.9685; train_kl_reg_loss: 13189.3416; train_edge_recon_loss: 783225.6903; train_gene_expr_recon_loss: 1612215.6989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2408630.7386; train_optim_loss: 2408630.7386; val_kl_reg_loss: 13185.9391; val_edge_recon_loss: 802905.7917; val_gene_expr_recon_loss: 1658134.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2474226.3333; val_optim_loss: 2474226.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 27 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9076
val AUPRC score: 0.9744
val best accuracy score: 0.9306
val best F1 score: 0.9606
val target rna MSE score: 1.1132
val source rna MSE score: 0.4667
Val cat covariate0 mean sim diff: -0.0120
Duration of model training in run 1: 0 hours, 1 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
