Run timestamp: 28082023_201718_3.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '10000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9851; val_auprc_score: 0.9948; val_best_acc_score: 0.9510; val_best_f1_score: 0.9681; train_kl_reg_loss: 13167.5455; train_edge_recon_loss: 1373776.7940; train_cat_covariates_contrastive_loss: 6913.3053; train_gene_expr_recon_loss: 2782519.0182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4176376.6658; train_optim_loss: 4176376.6658; val_kl_reg_loss: 13080.4337; val_edge_recon_loss: 1339904.9560; val_cat_covariates_contrastive_loss: 6957.1230; val_gene_expr_recon_loss: 2464362.6611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3824305.1650; val_optim_loss: 3824305.1650
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9883; val_auprc_score: 0.9958; val_best_acc_score: 0.9582; val_best_f1_score: 0.9728; train_kl_reg_loss: 15394.2294; train_edge_recon_loss: 1316876.1574; train_cat_covariates_contrastive_loss: 7022.4290; train_gene_expr_recon_loss: 2292960.5088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3632253.3257; train_optim_loss: 3632253.3257; val_kl_reg_loss: 17157.5049; val_edge_recon_loss: 1331671.2816; val_cat_covariates_contrastive_loss: 7035.9945; val_gene_expr_recon_loss: 2169664.8765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3525529.6532; val_optim_loss: 3525529.6532
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9894; val_auprc_score: 0.9960; val_best_acc_score: 0.9613; val_best_f1_score: 0.9747; train_kl_reg_loss: 18144.3741; train_edge_recon_loss: 1318490.4283; train_cat_covariates_contrastive_loss: 7053.9167; train_gene_expr_recon_loss: 2113299.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3456988.5256; train_optim_loss: 3456988.5256; val_kl_reg_loss: 18694.9957; val_edge_recon_loss: 1336355.2327; val_cat_covariates_contrastive_loss: 7076.9583; val_gene_expr_recon_loss: 2069222.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3431350.1364; val_optim_loss: 3431350.1364
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9898; val_auprc_score: 0.9962; val_best_acc_score: 0.9619; val_best_f1_score: 0.9752; train_kl_reg_loss: 19336.3661; train_edge_recon_loss: 1317197.9972; train_cat_covariates_contrastive_loss: 7076.5162; train_gene_expr_recon_loss: 2045878.1265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3389489.0057; train_optim_loss: 3389489.0057; val_kl_reg_loss: 19899.0445; val_edge_recon_loss: 1334861.7510; val_cat_covariates_contrastive_loss: 7100.8245; val_gene_expr_recon_loss: 2026222.5346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3388084.1551; val_optim_loss: 3388084.1551
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9911; val_auprc_score: 0.9965; val_best_acc_score: 0.9648; val_best_f1_score: 0.9770; train_kl_reg_loss: 20123.9139; train_edge_recon_loss: 1315898.7659; train_cat_covariates_contrastive_loss: 7105.7708; train_gene_expr_recon_loss: 2011393.5757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3354522.0291; train_optim_loss: 3354522.0291; val_kl_reg_loss: 20311.7537; val_edge_recon_loss: 1330617.3829; val_cat_covariates_contrastive_loss: 7114.2190; val_gene_expr_recon_loss: 2005221.8686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3363265.2194; val_optim_loss: 3363265.2194
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9913; val_auprc_score: 0.9968; val_best_acc_score: 0.9645; val_best_f1_score: 0.9768; train_kl_reg_loss: 20708.6889; train_edge_recon_loss: 1317021.7316; train_cat_covariates_contrastive_loss: 7131.0776; train_gene_expr_recon_loss: 1992038.4332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3336899.9339; train_optim_loss: 3336899.9339; val_kl_reg_loss: 21138.5044; val_edge_recon_loss: 1336105.6388; val_cat_covariates_contrastive_loss: 7188.8459; val_gene_expr_recon_loss: 1990041.3394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354474.3320; val_optim_loss: 3354474.3320
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9915; val_auprc_score: 0.9969; val_best_acc_score: 0.9659; val_best_f1_score: 0.9778; train_kl_reg_loss: 21132.1300; train_edge_recon_loss: 1315232.6230; train_cat_covariates_contrastive_loss: 7142.1207; train_gene_expr_recon_loss: 1977315.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3320822.3148; train_optim_loss: 3320822.3148; val_kl_reg_loss: 21381.9816; val_edge_recon_loss: 1326513.9333; val_cat_covariates_contrastive_loss: 7164.1610; val_gene_expr_recon_loss: 1972245.4956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3327305.5702; val_optim_loss: 3327305.5702
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9910; val_auprc_score: 0.9966; val_best_acc_score: 0.9647; val_best_f1_score: 0.9769; train_kl_reg_loss: 21546.2204; train_edge_recon_loss: 1313996.4488; train_cat_covariates_contrastive_loss: 7165.1009; train_gene_expr_recon_loss: 1968751.3345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3311459.1071; train_optim_loss: 3311459.1071; val_kl_reg_loss: 21863.8994; val_edge_recon_loss: 1337415.9333; val_cat_covariates_contrastive_loss: 7229.5740; val_gene_expr_recon_loss: 1978029.5825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3344538.9872; val_optim_loss: 3344538.9872
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9917; val_auprc_score: 0.9970; val_best_acc_score: 0.9660; val_best_f1_score: 0.9779; train_kl_reg_loss: 22064.7447; train_edge_recon_loss: 1315134.4278; train_cat_covariates_contrastive_loss: 7176.6663; train_gene_expr_recon_loss: 1959425.1807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3303801.0181; train_optim_loss: 3303801.0181; val_kl_reg_loss: 22478.1993; val_edge_recon_loss: 1323835.4007; val_cat_covariates_contrastive_loss: 7180.0939; val_gene_expr_recon_loss: 1963489.9857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316983.6818; val_optim_loss: 3316983.6818
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9919; val_auprc_score: 0.9968; val_best_acc_score: 0.9672; val_best_f1_score: 0.9785; train_kl_reg_loss: 22459.2386; train_edge_recon_loss: 1314413.3677; train_cat_covariates_contrastive_loss: 7202.0013; train_gene_expr_recon_loss: 1947184.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3291259.2163; train_optim_loss: 3291259.2163; val_kl_reg_loss: 22888.0578; val_edge_recon_loss: 1336799.6136; val_cat_covariates_contrastive_loss: 7241.2802; val_gene_expr_recon_loss: 1970727.7060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3337656.6749; val_optim_loss: 3337656.6749
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9914; val_auprc_score: 0.9967; val_best_acc_score: 0.9658; val_best_f1_score: 0.9777; train_kl_reg_loss: 22801.6650; train_edge_recon_loss: 1315240.3754; train_cat_covariates_contrastive_loss: 7211.2537; train_gene_expr_recon_loss: 1943092.2534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3288345.5458; train_optim_loss: 3288345.5458; val_kl_reg_loss: 23525.9437; val_edge_recon_loss: 1329786.7485; val_cat_covariates_contrastive_loss: 7192.3123; val_gene_expr_recon_loss: 1956403.2381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316908.2421; val_optim_loss: 3316908.2421
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9927; val_auprc_score: 0.9972; val_best_acc_score: 0.9684; val_best_f1_score: 0.9794; train_kl_reg_loss: 23156.4324; train_edge_recon_loss: 1316516.3753; train_cat_covariates_contrastive_loss: 7235.0848; train_gene_expr_recon_loss: 1936157.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3283065.6364; train_optim_loss: 3283065.6364; val_kl_reg_loss: 23091.2293; val_edge_recon_loss: 1332177.6695; val_cat_covariates_contrastive_loss: 7321.8198; val_gene_expr_recon_loss: 1941257.8878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303848.5949; val_optim_loss: 3303848.5949
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9923; val_auprc_score: 0.9970; val_best_acc_score: 0.9677; val_best_f1_score: 0.9789; train_kl_reg_loss: 23614.6105; train_edge_recon_loss: 1315996.1128; train_cat_covariates_contrastive_loss: 7242.5522; train_gene_expr_recon_loss: 1931783.3057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278636.5822; train_optim_loss: 3278636.5822; val_kl_reg_loss: 23915.6762; val_edge_recon_loss: 1327976.4397; val_cat_covariates_contrastive_loss: 7253.8401; val_gene_expr_recon_loss: 1934240.6487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3293386.6097; val_optim_loss: 3293386.6097
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9928; val_auprc_score: 0.9973; val_best_acc_score: 0.9688; val_best_f1_score: 0.9796; train_kl_reg_loss: 23876.6616; train_edge_recon_loss: 1315601.9953; train_cat_covariates_contrastive_loss: 7258.0843; train_gene_expr_recon_loss: 1926121.9396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3272858.6837; train_optim_loss: 3272858.6837; val_kl_reg_loss: 24042.7777; val_edge_recon_loss: 1329958.6680; val_cat_covariates_contrastive_loss: 7291.6448; val_gene_expr_recon_loss: 1932840.3977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3294133.4872; val_optim_loss: 3294133.4872
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9925; val_auprc_score: 0.9970; val_best_acc_score: 0.9695; val_best_f1_score: 0.9801; train_kl_reg_loss: 24218.5488; train_edge_recon_loss: 1317076.5330; train_cat_covariates_contrastive_loss: 7276.8577; train_gene_expr_recon_loss: 1922345.8065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3270917.7465; train_optim_loss: 3270917.7465; val_kl_reg_loss: 24710.7949; val_edge_recon_loss: 1330088.8740; val_cat_covariates_contrastive_loss: 7289.0641; val_gene_expr_recon_loss: 1924559.5153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3286648.2490; val_optim_loss: 3286648.2490
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9925; val_auprc_score: 0.9971; val_best_acc_score: 0.9686; val_best_f1_score: 0.9795; train_kl_reg_loss: 24980.7062; train_edge_recon_loss: 1315766.2901; train_cat_covariates_contrastive_loss: 7289.7602; train_gene_expr_recon_loss: 1918158.2136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3266194.9693; train_optim_loss: 3266194.9693; val_kl_reg_loss: 25215.5053; val_edge_recon_loss: 1330738.1616; val_cat_covariates_contrastive_loss: 7306.7288; val_gene_expr_recon_loss: 1918963.1156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3282223.5198; val_optim_loss: 3282223.5198
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9930; val_auprc_score: 0.9973; val_best_acc_score: 0.9694; val_best_f1_score: 0.9800; train_kl_reg_loss: 25403.4725; train_edge_recon_loss: 1315856.0747; train_cat_covariates_contrastive_loss: 7305.9525; train_gene_expr_recon_loss: 1913762.8877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3262328.3883; train_optim_loss: 3262328.3883; val_kl_reg_loss: 25639.2798; val_edge_recon_loss: 1331448.5074; val_cat_covariates_contrastive_loss: 7316.7692; val_gene_expr_recon_loss: 1914700.7712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3279105.3271; val_optim_loss: 3279105.3271
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9930; val_auprc_score: 0.9973; val_best_acc_score: 0.9705; val_best_f1_score: 0.9807; train_kl_reg_loss: 25578.8650; train_edge_recon_loss: 1311264.0094; train_cat_covariates_contrastive_loss: 7322.2226; train_gene_expr_recon_loss: 1907405.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3251570.2670; train_optim_loss: 3251570.2670; val_kl_reg_loss: 25639.3532; val_edge_recon_loss: 1320854.8251; val_cat_covariates_contrastive_loss: 7319.6926; val_gene_expr_recon_loss: 1911839.4289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265653.2935; val_optim_loss: 3265653.2935
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9929; val_auprc_score: 0.9972; val_best_acc_score: 0.9701; val_best_f1_score: 0.9804; train_kl_reg_loss: 25504.4055; train_edge_recon_loss: 1315391.9689; train_cat_covariates_contrastive_loss: 7329.0643; train_gene_expr_recon_loss: 1904846.6442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3253072.0832; train_optim_loss: 3253072.0832; val_kl_reg_loss: 25929.7631; val_edge_recon_loss: 1332268.2569; val_cat_covariates_contrastive_loss: 7350.1029; val_gene_expr_recon_loss: 1912863.5603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3278411.6838; val_optim_loss: 3278411.6838
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9972; val_best_acc_score: 0.9707; val_best_f1_score: 0.9809; train_kl_reg_loss: 25465.6250; train_edge_recon_loss: 1315898.0866; train_cat_covariates_contrastive_loss: 7333.7668; train_gene_expr_recon_loss: 1902248.8410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3250946.3225; train_optim_loss: 3250946.3225; val_kl_reg_loss: 25461.1262; val_edge_recon_loss: 1324925.3024; val_cat_covariates_contrastive_loss: 7380.4143; val_gene_expr_recon_loss: 1910077.6947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3267844.5296; val_optim_loss: 3267844.5296
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9933; val_auprc_score: 0.9975; val_best_acc_score: 0.9707; val_best_f1_score: 0.9809; train_kl_reg_loss: 25874.1698; train_edge_recon_loss: 1316770.4647; train_cat_covariates_contrastive_loss: 7340.7478; train_gene_expr_recon_loss: 1899321.7395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3249307.1243; train_optim_loss: 3249307.1243; val_kl_reg_loss: 26499.5945; val_edge_recon_loss: 1322088.7554; val_cat_covariates_contrastive_loss: 7340.9909; val_gene_expr_recon_loss: 1907932.3859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263861.7322; val_optim_loss: 3263861.7322
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9933; val_auprc_score: 0.9975; val_best_acc_score: 0.9711; val_best_f1_score: 0.9811; train_kl_reg_loss: 25948.0742; train_edge_recon_loss: 1313523.4141; train_cat_covariates_contrastive_loss: 7362.3747; train_gene_expr_recon_loss: 1897868.5271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3244702.3886; train_optim_loss: 3244702.3886; val_kl_reg_loss: 26083.4272; val_edge_recon_loss: 1331767.0558; val_cat_covariates_contrastive_loss: 7398.0268; val_gene_expr_recon_loss: 1904319.9086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3269568.4259; val_optim_loss: 3269568.4259
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9938; val_auprc_score: 0.9977; val_best_acc_score: 0.9713; val_best_f1_score: 0.9812; train_kl_reg_loss: 25788.3817; train_edge_recon_loss: 1315052.0988; train_cat_covariates_contrastive_loss: 7368.7696; train_gene_expr_recon_loss: 1893808.6804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3242017.9346; train_optim_loss: 3242017.9346; val_kl_reg_loss: 25756.1650; val_edge_recon_loss: 1327201.8508; val_cat_covariates_contrastive_loss: 7365.8481; val_gene_expr_recon_loss: 1896494.3508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256818.2144; val_optim_loss: 3256818.2144
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9935; val_auprc_score: 0.9975; val_best_acc_score: 0.9716; val_best_f1_score: 0.9814; train_kl_reg_loss: 26676.7904; train_edge_recon_loss: 1317131.1885; train_cat_covariates_contrastive_loss: 7373.3070; train_gene_expr_recon_loss: 1908505.4916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3259686.7780; train_optim_loss: 3259686.7780; val_kl_reg_loss: 27694.6138; val_edge_recon_loss: 1326949.9224; val_cat_covariates_contrastive_loss: 7413.6068; val_gene_expr_recon_loss: 1932955.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3295013.9506; val_optim_loss: 3295013.9506
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9933; val_auprc_score: 0.9973; val_best_acc_score: 0.9718; val_best_f1_score: 0.9815; train_kl_reg_loss: 27254.9971; train_edge_recon_loss: 1315675.7497; train_cat_covariates_contrastive_loss: 7396.7835; train_gene_expr_recon_loss: 1889733.0577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3240060.5893; train_optim_loss: 3240060.5893; val_kl_reg_loss: 26773.1170; val_edge_recon_loss: 1326589.4452; val_cat_covariates_contrastive_loss: 7437.2051; val_gene_expr_recon_loss: 1908220.9743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3269020.7480; val_optim_loss: 3269020.7480
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9938; val_auprc_score: 0.9975; val_best_acc_score: 0.9720; val_best_f1_score: 0.9817; train_kl_reg_loss: 26926.1303; train_edge_recon_loss: 1315371.7455; train_cat_covariates_contrastive_loss: 7397.9446; train_gene_expr_recon_loss: 1889487.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3239183.1204; train_optim_loss: 3239183.1204; val_kl_reg_loss: 27253.0460; val_edge_recon_loss: 1327711.4738; val_cat_covariates_contrastive_loss: 7375.2198; val_gene_expr_recon_loss: 1894627.0558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256966.7935; val_optim_loss: 3256966.7935
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9938; val_auprc_score: 0.9975; val_best_acc_score: 0.9730; val_best_f1_score: 0.9823; train_kl_reg_loss: 26726.9894; train_edge_recon_loss: 1315312.0678; train_cat_covariates_contrastive_loss: 7399.5352; train_gene_expr_recon_loss: 1885561.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3235000.0211; train_optim_loss: 3235000.0211; val_kl_reg_loss: 26959.3360; val_edge_recon_loss: 1336716.8073; val_cat_covariates_contrastive_loss: 7436.6149; val_gene_expr_recon_loss: 1891072.2964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3262185.0672; val_optim_loss: 3262185.0672

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9943; val_auprc_score: 0.9978; val_best_acc_score: 0.9738; val_best_f1_score: 0.9829; train_kl_reg_loss: 26005.5202; train_edge_recon_loss: 1313649.4677; train_cat_covariates_contrastive_loss: 7445.5433; train_gene_expr_recon_loss: 1849942.0974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3197042.6304; train_optim_loss: 3197042.6304; val_kl_reg_loss: 26100.0754; val_edge_recon_loss: 1321634.5697; val_cat_covariates_contrastive_loss: 7467.8695; val_gene_expr_recon_loss: 1863258.6245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3218461.1403; val_optim_loss: 3218461.1403
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9942; val_auprc_score: 0.9977; val_best_acc_score: 0.9743; val_best_f1_score: 0.9831; train_kl_reg_loss: 25904.4737; train_edge_recon_loss: 1312541.5113; train_cat_covariates_contrastive_loss: 7448.5317; train_gene_expr_recon_loss: 1844189.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3190084.2872; train_optim_loss: 3190084.2872; val_kl_reg_loss: 25841.0884; val_edge_recon_loss: 1330021.8972; val_cat_covariates_contrastive_loss: 7476.0809; val_gene_expr_recon_loss: 1858896.8977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3222235.9615; val_optim_loss: 3222235.9615
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9944; val_auprc_score: 0.9978; val_best_acc_score: 0.9740; val_best_f1_score: 0.9830; train_kl_reg_loss: 25688.6911; train_edge_recon_loss: 1313973.8370; train_cat_covariates_contrastive_loss: 7449.6144; train_gene_expr_recon_loss: 1840619.9625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3187732.1076; train_optim_loss: 3187732.1076; val_kl_reg_loss: 25656.6941; val_edge_recon_loss: 1326262.2648; val_cat_covariates_contrastive_loss: 7472.9346; val_gene_expr_recon_loss: 1856780.6206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3216172.5168; val_optim_loss: 3216172.5168
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9943; val_auprc_score: 0.9978; val_best_acc_score: 0.9741; val_best_f1_score: 0.9831; train_kl_reg_loss: 25487.3505; train_edge_recon_loss: 1311715.6018; train_cat_covariates_contrastive_loss: 7448.3530; train_gene_expr_recon_loss: 1838416.6227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3183067.9288; train_optim_loss: 3183067.9288; val_kl_reg_loss: 25493.0194; val_edge_recon_loss: 1322367.5326; val_cat_covariates_contrastive_loss: 7455.1669; val_gene_expr_recon_loss: 1852970.0805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3208285.7984; val_optim_loss: 3208285.7984
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9979; val_best_acc_score: 0.9738; val_best_f1_score: 0.9829; train_kl_reg_loss: 25203.2530; train_edge_recon_loss: 1310910.9152; train_cat_covariates_contrastive_loss: 7445.6893; train_gene_expr_recon_loss: 1837850.6525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181410.5081; train_optim_loss: 3181410.5081; val_kl_reg_loss: 25118.3698; val_edge_recon_loss: 1328727.7638; val_cat_covariates_contrastive_loss: 7455.9483; val_gene_expr_recon_loss: 1852530.8696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213832.9476; val_optim_loss: 3213832.9476
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9942; val_auprc_score: 0.9977; val_best_acc_score: 0.9742; val_best_f1_score: 0.9831; train_kl_reg_loss: 25027.8369; train_edge_recon_loss: 1309790.0283; train_cat_covariates_contrastive_loss: 7444.5925; train_gene_expr_recon_loss: 1836238.7581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3178501.2153; train_optim_loss: 3178501.2153; val_kl_reg_loss: 25129.0586; val_edge_recon_loss: 1327698.8409; val_cat_covariates_contrastive_loss: 7458.4454; val_gene_expr_recon_loss: 1853201.4970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213487.8350; val_optim_loss: 3213487.8350
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9943; val_auprc_score: 0.9977; val_best_acc_score: 0.9744; val_best_f1_score: 0.9832; train_kl_reg_loss: 24794.0972; train_edge_recon_loss: 1310513.0313; train_cat_covariates_contrastive_loss: 7440.2045; train_gene_expr_recon_loss: 1836370.0989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3179117.4325; train_optim_loss: 3179117.4325; val_kl_reg_loss: 25043.3586; val_edge_recon_loss: 1323046.0751; val_cat_covariates_contrastive_loss: 7449.0269; val_gene_expr_recon_loss: 1853230.7638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3208769.2213; val_optim_loss: 3208769.2213
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9944; val_auprc_score: 0.9977; val_best_acc_score: 0.9742; val_best_f1_score: 0.9830; train_kl_reg_loss: 24685.3961; train_edge_recon_loss: 1310474.3248; train_cat_covariates_contrastive_loss: 7440.6673; train_gene_expr_recon_loss: 1834778.8819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3177379.2674; train_optim_loss: 3177379.2674; val_kl_reg_loss: 24766.6469; val_edge_recon_loss: 1330917.8943; val_cat_covariates_contrastive_loss: 7453.1788; val_gene_expr_recon_loss: 1850473.6813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213611.4032; val_optim_loss: 3213611.4032

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9946; val_auprc_score: 0.9978; val_best_acc_score: 0.9744; val_best_f1_score: 0.9832; train_kl_reg_loss: 24527.8066; train_edge_recon_loss: 1309546.8311; train_cat_covariates_contrastive_loss: 7435.2781; train_gene_expr_recon_loss: 1830370.0150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3171879.9349; train_optim_loss: 3171879.9349; val_kl_reg_loss: 24524.0620; val_edge_recon_loss: 1333432.0973; val_cat_covariates_contrastive_loss: 7463.2159; val_gene_expr_recon_loss: 1847817.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213236.4595; val_optim_loss: 3213236.4595
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9946; val_auprc_score: 0.9979; val_best_acc_score: 0.9750; val_best_f1_score: 0.9836; train_kl_reg_loss: 24448.0046; train_edge_recon_loss: 1309937.6333; train_cat_covariates_contrastive_loss: 7441.1382; train_gene_expr_recon_loss: 1829686.6589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3171513.4331; train_optim_loss: 3171513.4331; val_kl_reg_loss: 24532.6003; val_edge_recon_loss: 1322063.9960; val_cat_covariates_contrastive_loss: 7473.9210; val_gene_expr_recon_loss: 1846043.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200114.4308; val_optim_loss: 3200114.4308
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9946; val_auprc_score: 0.9978; val_best_acc_score: 0.9750; val_best_f1_score: 0.9836; train_kl_reg_loss: 24436.7203; train_edge_recon_loss: 1312118.8234; train_cat_covariates_contrastive_loss: 7443.0042; train_gene_expr_recon_loss: 1830244.3686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3174242.9117; train_optim_loss: 3174242.9117; val_kl_reg_loss: 24429.4605; val_edge_recon_loss: 1327133.3419; val_cat_covariates_contrastive_loss: 7457.6545; val_gene_expr_recon_loss: 1848348.7515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3207369.2065; val_optim_loss: 3207369.2065
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9945; val_auprc_score: 0.9978; val_best_acc_score: 0.9747; val_best_f1_score: 0.9835; train_kl_reg_loss: 24417.9425; train_edge_recon_loss: 1312531.4810; train_cat_covariates_contrastive_loss: 7441.6937; train_gene_expr_recon_loss: 1829745.3725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3174136.4897; train_optim_loss: 3174136.4897; val_kl_reg_loss: 24402.5411; val_edge_recon_loss: 1319655.7989; val_cat_covariates_contrastive_loss: 7478.6161; val_gene_expr_recon_loss: 1851668.5079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3203205.4575; val_optim_loss: 3203205.4575
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9945; val_auprc_score: 0.9979; val_best_acc_score: 0.9747; val_best_f1_score: 0.9835; train_kl_reg_loss: 24382.1692; train_edge_recon_loss: 1308972.6451; train_cat_covariates_contrastive_loss: 7443.7225; train_gene_expr_recon_loss: 1829568.9071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3170367.4451; train_optim_loss: 3170367.4451; val_kl_reg_loss: 24443.6816; val_edge_recon_loss: 1324876.0242; val_cat_covariates_contrastive_loss: 7462.8799; val_gene_expr_recon_loss: 1847696.7263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3204479.3103; val_optim_loss: 3204479.3103
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9944; val_auprc_score: 0.9978; val_best_acc_score: 0.9745; val_best_f1_score: 0.9833; train_kl_reg_loss: 24340.9656; train_edge_recon_loss: 1310117.6970; train_cat_covariates_contrastive_loss: 7442.3516; train_gene_expr_recon_loss: 1829787.3383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3171688.3542; train_optim_loss: 3171688.3542; val_kl_reg_loss: 24378.6869; val_edge_recon_loss: 1333229.1996; val_cat_covariates_contrastive_loss: 7460.6246; val_gene_expr_recon_loss: 1848128.2144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213196.7253; val_optim_loss: 3213196.7253

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9946; val_auprc_score: 0.9980; val_best_acc_score: 0.9747; val_best_f1_score: 0.9834; train_kl_reg_loss: 24322.6185; train_edge_recon_loss: 1307660.7774; train_cat_covariates_contrastive_loss: 7446.8348; train_gene_expr_recon_loss: 1829257.3682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3168687.6002; train_optim_loss: 3168687.6002; val_kl_reg_loss: 24377.0614; val_edge_recon_loss: 1323742.5079; val_cat_covariates_contrastive_loss: 7471.5276; val_gene_expr_recon_loss: 1844948.3468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200539.4387; val_optim_loss: 3200539.4387
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9943; val_auprc_score: 0.9977; val_best_acc_score: 0.9744; val_best_f1_score: 0.9833; train_kl_reg_loss: 24317.9069; train_edge_recon_loss: 1311661.2626; train_cat_covariates_contrastive_loss: 7443.6151; train_gene_expr_recon_loss: 1829240.1862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3172662.9680; train_optim_loss: 3172662.9680; val_kl_reg_loss: 24398.5832; val_edge_recon_loss: 1326644.7401; val_cat_covariates_contrastive_loss: 7470.6832; val_gene_expr_recon_loss: 1849422.9185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3207936.9239; val_optim_loss: 3207936.9239
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9947; val_auprc_score: 0.9979; val_best_acc_score: 0.9750; val_best_f1_score: 0.9836; train_kl_reg_loss: 24321.5900; train_edge_recon_loss: 1312580.8013; train_cat_covariates_contrastive_loss: 7445.0868; train_gene_expr_recon_loss: 1829305.4623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3173652.9397; train_optim_loss: 3173652.9397; val_kl_reg_loss: 24378.2888; val_edge_recon_loss: 1325060.0464; val_cat_covariates_contrastive_loss: 7460.7436; val_gene_expr_recon_loss: 1847731.3706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3204630.4476; val_optim_loss: 3204630.4476
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9945; val_auprc_score: 0.9979; val_best_acc_score: 0.9742; val_best_f1_score: 0.9831; train_kl_reg_loss: 24321.7185; train_edge_recon_loss: 1311218.7848; train_cat_covariates_contrastive_loss: 7445.8550; train_gene_expr_recon_loss: 1828780.7018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3171767.0569; train_optim_loss: 3171767.0569; val_kl_reg_loss: 24383.1892; val_edge_recon_loss: 1325618.4195; val_cat_covariates_contrastive_loss: 7457.1526; val_gene_expr_recon_loss: 1848392.3409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3205851.0998; val_optim_loss: 3205851.0998

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 889 min 52 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9847
val AUPRC score: 0.9935
val best accuracy score: 0.9630
val best F1 score: 0.9756
val target rna MSE score: 0.5564
val source rna MSE score: 0.0865
Val cat covariate0 mean sim diff: -0.0000
Val cat covariate1 mean sim diff: -0.0942
Duration of model training in run 2: 14 hours, 54 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
