Run timestamp: 23082023_224509_4.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '4', '--run_index', '5', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 863288
Number of validation edges: 95920
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9606; val_auprc_score: 0.9836; val_best_acc_score: 0.9319; val_best_f1_score: 0.9557; train_kl_reg_loss: 13617.0000; train_edge_recon_loss: 1363446.7771; train_gene_expr_recon_loss: 2887914.5766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4264978.3532; train_optim_loss: 4264978.3532; val_kl_reg_loss: 12513.4823; val_edge_recon_loss: 1337838.7755; val_gene_expr_recon_loss: 2608998.4813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3959350.7360; val_optim_loss: 3959350.7360
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9673; val_auprc_score: 0.9862; val_best_acc_score: 0.9403; val_best_f1_score: 0.9610; train_kl_reg_loss: 15642.4248; train_edge_recon_loss: 1323966.5708; train_gene_expr_recon_loss: 2442774.5506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3782383.5455; train_optim_loss: 3782383.5455; val_kl_reg_loss: 18086.1963; val_edge_recon_loss: 1330138.0830; val_gene_expr_recon_loss: 2338009.4160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3686233.7000; val_optim_loss: 3686233.7000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9711; val_auprc_score: 0.9878; val_best_acc_score: 0.9429; val_best_f1_score: 0.9626; train_kl_reg_loss: 19390.5284; train_edge_recon_loss: 1324895.4447; train_gene_expr_recon_loss: 2278201.6483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3622487.6189; train_optim_loss: 3622487.6189; val_kl_reg_loss: 20247.2687; val_edge_recon_loss: 1337120.0590; val_gene_expr_recon_loss: 2245204.3097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602571.6420; val_optim_loss: 3602571.6420
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9725; val_auprc_score: 0.9884; val_best_acc_score: 0.9426; val_best_f1_score: 0.9623; train_kl_reg_loss: 21502.3453; train_edge_recon_loss: 1325303.4256; train_gene_expr_recon_loss: 2213093.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559899.2307; train_optim_loss: 3559899.2307; val_kl_reg_loss: 22103.1362; val_edge_recon_loss: 1349421.0810; val_gene_expr_recon_loss: 2209718.3733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3581242.5867; val_optim_loss: 3581242.5867
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9735; val_auprc_score: 0.9882; val_best_acc_score: 0.9472; val_best_f1_score: 0.9655; train_kl_reg_loss: 23003.8138; train_edge_recon_loss: 1327053.6843; train_gene_expr_recon_loss: 2184886.3834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3534943.8830; train_optim_loss: 3534943.8830; val_kl_reg_loss: 24847.3673; val_edge_recon_loss: 1326544.9007; val_gene_expr_recon_loss: 2182784.0533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3534176.3227; val_optim_loss: 3534176.3227
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9771; val_auprc_score: 0.9904; val_best_acc_score: 0.9499; val_best_f1_score: 0.9671; train_kl_reg_loss: 24221.7273; train_edge_recon_loss: 1322903.9108; train_gene_expr_recon_loss: 2161657.8038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3508783.4429; train_optim_loss: 3508783.4429; val_kl_reg_loss: 24907.2192; val_edge_recon_loss: 1334943.9368; val_gene_expr_recon_loss: 2165969.5200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3525820.6747; val_optim_loss: 3525820.6747
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9770; val_auprc_score: 0.9902; val_best_acc_score: 0.9495; val_best_f1_score: 0.9667; train_kl_reg_loss: 25263.3557; train_edge_recon_loss: 1323032.5742; train_gene_expr_recon_loss: 2149061.6549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3497357.5816; train_optim_loss: 3497357.5816; val_kl_reg_loss: 25803.9621; val_edge_recon_loss: 1345701.7013; val_gene_expr_recon_loss: 2178416.1377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3549921.7987; val_optim_loss: 3549921.7987
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9793; val_auprc_score: 0.9912; val_best_acc_score: 0.9520; val_best_f1_score: 0.9683; train_kl_reg_loss: 26308.4695; train_edge_recon_loss: 1321249.6698; train_gene_expr_recon_loss: 2139730.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3487288.4177; train_optim_loss: 3487288.4177; val_kl_reg_loss: 26848.3151; val_edge_recon_loss: 1352688.1790; val_gene_expr_recon_loss: 2149861.3910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3529397.8833; val_optim_loss: 3529397.8833
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9786; val_auprc_score: 0.9912; val_best_acc_score: 0.9504; val_best_f1_score: 0.9674; train_kl_reg_loss: 105713.1218; train_edge_recon_loss: 1325612.1847; train_gene_expr_recon_loss: 2156908.8256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3588234.1313; train_optim_loss: 3588234.1313; val_kl_reg_loss: 30288.7508; val_edge_recon_loss: 1339783.6843; val_gene_expr_recon_loss: 2186446.3673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3556518.8087; val_optim_loss: 3556518.8087
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9791; val_auprc_score: 0.9910; val_best_acc_score: 0.9523; val_best_f1_score: 0.9687; train_kl_reg_loss: 440331909.8589; train_edge_recon_loss: 1331396.0009; train_gene_expr_recon_loss: 2243192.5583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443906482.7616; train_optim_loss: 443906482.7616; val_kl_reg_loss: 48040.2230; val_edge_recon_loss: 1347856.1773; val_gene_expr_recon_loss: 2215940.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3611837.3887; val_optim_loss: 3611837.3887

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9803; val_auprc_score: 0.9919; val_best_acc_score: 0.9530; val_best_f1_score: 0.9692; train_kl_reg_loss: 45372.3038; train_edge_recon_loss: 1321609.0609; train_gene_expr_recon_loss: 2147569.1833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3514550.5508; train_optim_loss: 3514550.5508; val_kl_reg_loss: 42557.7196; val_edge_recon_loss: 1320707.2295; val_gene_expr_recon_loss: 2161136.8780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3524401.8313; val_optim_loss: 3524401.8313
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9803; val_auprc_score: 0.9917; val_best_acc_score: 0.9526; val_best_f1_score: 0.9687; train_kl_reg_loss: 40603.6800; train_edge_recon_loss: 1319807.3778; train_gene_expr_recon_loss: 2126595.6221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3487006.6790; train_optim_loss: 3487006.6790; val_kl_reg_loss: 39270.6168; val_edge_recon_loss: 1342971.1667; val_gene_expr_recon_loss: 2144320.0793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3526561.8667; val_optim_loss: 3526561.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9810; val_auprc_score: 0.9922; val_best_acc_score: 0.9541; val_best_f1_score: 0.9698; train_kl_reg_loss: 37848.5572; train_edge_recon_loss: 1323184.2143; train_gene_expr_recon_loss: 2113123.9780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3474156.7516; train_optim_loss: 3474156.7516; val_kl_reg_loss: 37274.6928; val_edge_recon_loss: 1335162.0340; val_gene_expr_recon_loss: 2136202.8110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3508639.5400; val_optim_loss: 3508639.5400
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9807; val_auprc_score: 0.9920; val_best_acc_score: 0.9537; val_best_f1_score: 0.9695; train_kl_reg_loss: 36346.4888; train_edge_recon_loss: 1319738.2182; train_gene_expr_recon_loss: 2102884.0012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3458968.7077; train_optim_loss: 3458968.7077; val_kl_reg_loss: 35820.2479; val_edge_recon_loss: 1331816.7493; val_gene_expr_recon_loss: 2122213.1777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3489850.1760; val_optim_loss: 3489850.1760
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9810; val_auprc_score: 0.9921; val_best_acc_score: 0.9538; val_best_f1_score: 0.9697; train_kl_reg_loss: 35331.4320; train_edge_recon_loss: 1320182.9118; train_gene_expr_recon_loss: 2092988.7748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3448503.1171; train_optim_loss: 3448503.1171; val_kl_reg_loss: 35336.5792; val_edge_recon_loss: 1333920.0920; val_gene_expr_recon_loss: 2117507.7950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3486764.4667; val_optim_loss: 3486764.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9815; val_auprc_score: 0.9923; val_best_acc_score: 0.9547; val_best_f1_score: 0.9702; train_kl_reg_loss: 35000.9693; train_edge_recon_loss: 1320085.9681; train_gene_expr_recon_loss: 2086565.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3441652.1754; train_optim_loss: 3441652.1754; val_kl_reg_loss: 34698.1657; val_edge_recon_loss: 1333474.1258; val_gene_expr_recon_loss: 2112864.2363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3481036.5333; val_optim_loss: 3481036.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9824; val_auprc_score: 0.9928; val_best_acc_score: 0.9553; val_best_f1_score: 0.9706; train_kl_reg_loss: 34518.4827; train_edge_recon_loss: 1318975.2692; train_gene_expr_recon_loss: 2079907.0342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3433400.7849; train_optim_loss: 3433400.7849; val_kl_reg_loss: 33973.9499; val_edge_recon_loss: 1336186.7367; val_gene_expr_recon_loss: 2104437.2610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3474597.9447; val_optim_loss: 3474597.9447
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9816; val_auprc_score: 0.9925; val_best_acc_score: 0.9552; val_best_f1_score: 0.9706; train_kl_reg_loss: 34017.3233; train_edge_recon_loss: 1317264.4450; train_gene_expr_recon_loss: 2075121.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3426403.3080; train_optim_loss: 3426403.3080; val_kl_reg_loss: 33576.0746; val_edge_recon_loss: 1334968.3053; val_gene_expr_recon_loss: 2102271.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3470815.8127; val_optim_loss: 3470815.8127
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9833; val_auprc_score: 0.9931; val_best_acc_score: 0.9556; val_best_f1_score: 0.9707; train_kl_reg_loss: 33581.7687; train_edge_recon_loss: 1320912.5184; train_gene_expr_recon_loss: 2066660.5261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3421154.8121; train_optim_loss: 3421154.8121; val_kl_reg_loss: 33254.5930; val_edge_recon_loss: 1342542.4373; val_gene_expr_recon_loss: 2094215.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3470012.5033; val_optim_loss: 3470012.5033
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9826; val_auprc_score: 0.9929; val_best_acc_score: 0.9560; val_best_f1_score: 0.9710; train_kl_reg_loss: 33107.8004; train_edge_recon_loss: 1321960.1957; train_gene_expr_recon_loss: 2061935.3802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3417003.3767; train_optim_loss: 3417003.3767; val_kl_reg_loss: 32940.6725; val_edge_recon_loss: 1329552.0438; val_gene_expr_recon_loss: 2087767.3070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3450260.0073; val_optim_loss: 3450260.0073
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9826; val_auprc_score: 0.9928; val_best_acc_score: 0.9550; val_best_f1_score: 0.9704; train_kl_reg_loss: 32546.1324; train_edge_recon_loss: 1318901.1475; train_gene_expr_recon_loss: 2058319.9282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3409767.2094; train_optim_loss: 3409767.2094; val_kl_reg_loss: 32386.2475; val_edge_recon_loss: 1332310.3207; val_gene_expr_recon_loss: 2089037.3770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3453733.9480; val_optim_loss: 3453733.9480
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9831; val_auprc_score: 0.9932; val_best_acc_score: 0.9562; val_best_f1_score: 0.9712; train_kl_reg_loss: 32128.6865; train_edge_recon_loss: 1320255.4506; train_gene_expr_recon_loss: 2054698.4168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3407082.5533; train_optim_loss: 3407082.5533; val_kl_reg_loss: 31933.4965; val_edge_recon_loss: 1326179.1927; val_gene_expr_recon_loss: 2083527.5653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3441640.2533; val_optim_loss: 3441640.2533
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9830; val_auprc_score: 0.9929; val_best_acc_score: 0.9567; val_best_f1_score: 0.9714; train_kl_reg_loss: 31365.9447; train_edge_recon_loss: 1320360.9833; train_gene_expr_recon_loss: 2051736.0800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3403463.0082; train_optim_loss: 3403463.0082; val_kl_reg_loss: 31057.1757; val_edge_recon_loss: 1331147.1890; val_gene_expr_recon_loss: 2083363.9460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3445568.3080; val_optim_loss: 3445568.3080
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9833; val_auprc_score: 0.9932; val_best_acc_score: 0.9566; val_best_f1_score: 0.9713; train_kl_reg_loss: 30896.4753; train_edge_recon_loss: 1319493.6624; train_gene_expr_recon_loss: 2049262.1140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3399652.2518; train_optim_loss: 3399652.2518; val_kl_reg_loss: 30718.4911; val_edge_recon_loss: 1339541.8193; val_gene_expr_recon_loss: 2080877.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3451137.9840; val_optim_loss: 3451137.9840
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9836; val_auprc_score: 0.9930; val_best_acc_score: 0.9568; val_best_f1_score: 0.9715; train_kl_reg_loss: 30642.2557; train_edge_recon_loss: 1319141.1061; train_gene_expr_recon_loss: 2048034.0203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3397817.3806; train_optim_loss: 3397817.3806; val_kl_reg_loss: 30594.2089; val_edge_recon_loss: 1325656.0188; val_gene_expr_recon_loss: 2077218.5480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3433468.7773; val_optim_loss: 3433468.7773
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9827; val_auprc_score: 0.9926; val_best_acc_score: 0.9567; val_best_f1_score: 0.9715; train_kl_reg_loss: 30311.8469; train_edge_recon_loss: 1319244.4545; train_gene_expr_recon_loss: 2044339.7550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3393896.0539; train_optim_loss: 3393896.0539; val_kl_reg_loss: 30336.9403; val_edge_recon_loss: 1329195.8720; val_gene_expr_recon_loss: 2078475.7827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3438008.5940; val_optim_loss: 3438008.5940
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9846; val_auprc_score: 0.9939; val_best_acc_score: 0.9576; val_best_f1_score: 0.9721; train_kl_reg_loss: 29985.1367; train_edge_recon_loss: 1320156.3239; train_gene_expr_recon_loss: 2042499.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3392640.9412; train_optim_loss: 3392640.9412; val_kl_reg_loss: 29689.9607; val_edge_recon_loss: 1325103.9553; val_gene_expr_recon_loss: 2078614.1140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3433408.0320; val_optim_loss: 3433408.0320
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9833; val_auprc_score: 0.9932; val_best_acc_score: 0.9577; val_best_f1_score: 0.9721; train_kl_reg_loss: 29552.4955; train_edge_recon_loss: 1323607.8734; train_gene_expr_recon_loss: 2041364.4387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3394524.8074; train_optim_loss: 3394524.8074; val_kl_reg_loss: 29414.9362; val_edge_recon_loss: 1331036.9077; val_gene_expr_recon_loss: 2077957.7810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3438409.6240; val_optim_loss: 3438409.6240
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9846; val_auprc_score: 0.9938; val_best_acc_score: 0.9587; val_best_f1_score: 0.9728; train_kl_reg_loss: 29350.4182; train_edge_recon_loss: 1316574.8940; train_gene_expr_recon_loss: 2040824.5988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3386749.9111; train_optim_loss: 3386749.9111; val_kl_reg_loss: 28999.4126; val_edge_recon_loss: 1325910.9903; val_gene_expr_recon_loss: 2070189.3033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3425099.7053; val_optim_loss: 3425099.7053
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9846; val_auprc_score: 0.9939; val_best_acc_score: 0.9578; val_best_f1_score: 0.9722; train_kl_reg_loss: 29046.1206; train_edge_recon_loss: 1316763.7982; train_gene_expr_recon_loss: 2038939.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3384749.6270; train_optim_loss: 3384749.6270; val_kl_reg_loss: 28759.3019; val_edge_recon_loss: 1329290.7390; val_gene_expr_recon_loss: 2073099.5387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3431149.5800; val_optim_loss: 3431149.5800
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9837; val_auprc_score: 0.9932; val_best_acc_score: 0.9584; val_best_f1_score: 0.9726; train_kl_reg_loss: 28798.6528; train_edge_recon_loss: 1319887.6969; train_gene_expr_recon_loss: 2036208.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3384895.1345; train_optim_loss: 3384895.1345; val_kl_reg_loss: 28658.1603; val_edge_recon_loss: 1332092.8790; val_gene_expr_recon_loss: 2068312.7233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3429063.7707; val_optim_loss: 3429063.7707
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9846; val_auprc_score: 0.9936; val_best_acc_score: 0.9596; val_best_f1_score: 0.9734; train_kl_reg_loss: 28445.3757; train_edge_recon_loss: 1320311.9670; train_gene_expr_recon_loss: 2036302.8912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3385060.2335; train_optim_loss: 3385060.2335; val_kl_reg_loss: 28137.8570; val_edge_recon_loss: 1326273.3502; val_gene_expr_recon_loss: 2072480.3210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3426891.5340; val_optim_loss: 3426891.5340
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9841; val_auprc_score: 0.9934; val_best_acc_score: 0.9582; val_best_f1_score: 0.9725; train_kl_reg_loss: 28342.4268; train_edge_recon_loss: 1314932.8061; train_gene_expr_recon_loss: 2033761.9474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3377037.1790; train_optim_loss: 3377037.1790; val_kl_reg_loss: 28155.6985; val_edge_recon_loss: 1326907.4577; val_gene_expr_recon_loss: 2069808.4717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3424871.6227; val_optim_loss: 3424871.6227
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9845; val_auprc_score: 0.9939; val_best_acc_score: 0.9567; val_best_f1_score: 0.9715; train_kl_reg_loss: 27979.4486; train_edge_recon_loss: 1319493.1312; train_gene_expr_recon_loss: 2032525.9226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3379998.5030; train_optim_loss: 3379998.5030; val_kl_reg_loss: 28034.5828; val_edge_recon_loss: 1324916.0383; val_gene_expr_recon_loss: 2067246.1653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3420196.7873; val_optim_loss: 3420196.7873
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9848; val_auprc_score: 0.9938; val_best_acc_score: 0.9580; val_best_f1_score: 0.9723; train_kl_reg_loss: 27913.1390; train_edge_recon_loss: 1318195.4478; train_gene_expr_recon_loss: 2030558.0478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3376666.6362; train_optim_loss: 3376666.6362; val_kl_reg_loss: 27646.2371; val_edge_recon_loss: 1328073.7247; val_gene_expr_recon_loss: 2068792.1010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3424512.0587; val_optim_loss: 3424512.0587
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9836; val_auprc_score: 0.9934; val_best_acc_score: 0.9568; val_best_f1_score: 0.9716; train_kl_reg_loss: 27657.1793; train_edge_recon_loss: 1317331.6284; train_gene_expr_recon_loss: 2030784.9877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3375773.7954; train_optim_loss: 3375773.7954; val_kl_reg_loss: 27550.2084; val_edge_recon_loss: 1315704.3982; val_gene_expr_recon_loss: 2070266.7920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3413521.3933; val_optim_loss: 3413521.3933
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9849; val_auprc_score: 0.9937; val_best_acc_score: 0.9588; val_best_f1_score: 0.9729; train_kl_reg_loss: 27491.8154; train_edge_recon_loss: 1318164.5340; train_gene_expr_recon_loss: 2030753.1585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3376409.5073; train_optim_loss: 3376409.5073; val_kl_reg_loss: 27556.9292; val_edge_recon_loss: 1327286.9758; val_gene_expr_recon_loss: 2064538.4957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3419382.4000; val_optim_loss: 3419382.4000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9845; val_auprc_score: 0.9937; val_best_acc_score: 0.9594; val_best_f1_score: 0.9732; train_kl_reg_loss: 27246.3325; train_edge_recon_loss: 1316345.5726; train_gene_expr_recon_loss: 2029122.6873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3372714.5901; train_optim_loss: 3372714.5901; val_kl_reg_loss: 27317.4508; val_edge_recon_loss: 1329133.1350; val_gene_expr_recon_loss: 2066892.0783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3423342.6580; val_optim_loss: 3423342.6580
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9846; val_auprc_score: 0.9937; val_best_acc_score: 0.9585; val_best_f1_score: 0.9727; train_kl_reg_loss: 26970.7953; train_edge_recon_loss: 1317388.6506; train_gene_expr_recon_loss: 2027096.5305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3371455.9745; train_optim_loss: 3371455.9745; val_kl_reg_loss: 27048.6262; val_edge_recon_loss: 1330318.0033; val_gene_expr_recon_loss: 2068356.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3425722.8280; val_optim_loss: 3425722.8280
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9596; val_best_f1_score: 0.9734; train_kl_reg_loss: 26878.5267; train_edge_recon_loss: 1316729.8094; train_gene_expr_recon_loss: 2026700.6193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3370308.9550; train_optim_loss: 3370308.9550; val_kl_reg_loss: 26502.8729; val_edge_recon_loss: 1328606.8350; val_gene_expr_recon_loss: 2067445.3653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3422555.0700; val_optim_loss: 3422555.0700

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9589; val_best_f1_score: 0.9729; train_kl_reg_loss: 26370.6931; train_edge_recon_loss: 1314923.8806; train_gene_expr_recon_loss: 2018883.0289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3360177.6025; train_optim_loss: 3360177.6025; val_kl_reg_loss: 26444.6304; val_edge_recon_loss: 1334819.3953; val_gene_expr_recon_loss: 2058369.9580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3419633.9860; val_optim_loss: 3419633.9860
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9851; val_auprc_score: 0.9939; val_best_acc_score: 0.9588; val_best_f1_score: 0.9729; train_kl_reg_loss: 26376.5724; train_edge_recon_loss: 1318160.8857; train_gene_expr_recon_loss: 2017802.5072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3362339.9697; train_optim_loss: 3362339.9697; val_kl_reg_loss: 26283.0979; val_edge_recon_loss: 1327892.6623; val_gene_expr_recon_loss: 2059200.3153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3413376.0707; val_optim_loss: 3413376.0707
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9853; val_auprc_score: 0.9941; val_best_acc_score: 0.9596; val_best_f1_score: 0.9734; train_kl_reg_loss: 26290.8964; train_edge_recon_loss: 1317909.4937; train_gene_expr_recon_loss: 2016133.6356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3360334.0264; train_optim_loss: 3360334.0264; val_kl_reg_loss: 26277.5286; val_edge_recon_loss: 1329623.9617; val_gene_expr_recon_loss: 2056064.6867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3411966.1813; val_optim_loss: 3411966.1813
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9849; val_auprc_score: 0.9935; val_best_acc_score: 0.9588; val_best_f1_score: 0.9728; train_kl_reg_loss: 26178.6709; train_edge_recon_loss: 1315900.2491; train_gene_expr_recon_loss: 2016763.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3358841.9816; train_optim_loss: 3358841.9816; val_kl_reg_loss: 26126.2138; val_edge_recon_loss: 1330295.6880; val_gene_expr_recon_loss: 2059860.0307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3416281.9333; val_optim_loss: 3416281.9333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9851; val_auprc_score: 0.9940; val_best_acc_score: 0.9589; val_best_f1_score: 0.9729; train_kl_reg_loss: 26175.9475; train_edge_recon_loss: 1316195.8931; train_gene_expr_recon_loss: 2016940.3465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359312.1869; train_optim_loss: 3359312.1869; val_kl_reg_loss: 26156.8369; val_edge_recon_loss: 1327977.4280; val_gene_expr_recon_loss: 2053713.4983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407847.7567; val_optim_loss: 3407847.7567
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9853; val_auprc_score: 0.9940; val_best_acc_score: 0.9598; val_best_f1_score: 0.9735; train_kl_reg_loss: 26113.1846; train_edge_recon_loss: 1315444.9891; train_gene_expr_recon_loss: 2016179.1197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3357737.2928; train_optim_loss: 3357737.2928; val_kl_reg_loss: 26167.9114; val_edge_recon_loss: 1326273.1513; val_gene_expr_recon_loss: 2057607.8737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3410048.9213; val_optim_loss: 3410048.9213
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9854; val_auprc_score: 0.9941; val_best_acc_score: 0.9599; val_best_f1_score: 0.9736; train_kl_reg_loss: 26096.5726; train_edge_recon_loss: 1315524.7257; train_gene_expr_recon_loss: 2016298.3813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3357919.6779; train_optim_loss: 3357919.6779; val_kl_reg_loss: 25976.9729; val_edge_recon_loss: 1317271.4317; val_gene_expr_recon_loss: 2055972.4513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3399220.8613; val_optim_loss: 3399220.8613
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9850; val_auprc_score: 0.9937; val_best_acc_score: 0.9587; val_best_f1_score: 0.9728; train_kl_reg_loss: 25990.5693; train_edge_recon_loss: 1317753.6080; train_gene_expr_recon_loss: 2016041.5474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359785.7256; train_optim_loss: 3359785.7256; val_kl_reg_loss: 26036.5030; val_edge_recon_loss: 1331067.9060; val_gene_expr_recon_loss: 2059306.6873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3416411.0933; val_optim_loss: 3416411.0933
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9851; val_auprc_score: 0.9938; val_best_acc_score: 0.9594; val_best_f1_score: 0.9732; train_kl_reg_loss: 26001.6862; train_edge_recon_loss: 1317659.2012; train_gene_expr_recon_loss: 2016161.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359821.9524; train_optim_loss: 3359821.9524; val_kl_reg_loss: 26004.9974; val_edge_recon_loss: 1325114.1527; val_gene_expr_recon_loss: 2056209.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407328.5400; val_optim_loss: 3407328.5400
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9596; val_best_f1_score: 0.9733; train_kl_reg_loss: 26024.5994; train_edge_recon_loss: 1315582.2259; train_gene_expr_recon_loss: 2015909.1997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3357516.0263; train_optim_loss: 3357516.0263; val_kl_reg_loss: 25989.2165; val_edge_recon_loss: 1329972.5622; val_gene_expr_recon_loss: 2059239.6527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3415201.4233; val_optim_loss: 3415201.4233
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9853; val_auprc_score: 0.9938; val_best_acc_score: 0.9598; val_best_f1_score: 0.9734; train_kl_reg_loss: 25992.0071; train_edge_recon_loss: 1313246.4142; train_gene_expr_recon_loss: 2015235.7643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3354474.1863; train_optim_loss: 3354474.1863; val_kl_reg_loss: 25918.1929; val_edge_recon_loss: 1325784.6643; val_gene_expr_recon_loss: 2060598.7217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3412301.5767; val_optim_loss: 3412301.5767

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9591; val_best_f1_score: 0.9731; train_kl_reg_loss: 25947.2443; train_edge_recon_loss: 1317337.8449; train_gene_expr_recon_loss: 2015597.7165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3358882.8036; train_optim_loss: 3358882.8036; val_kl_reg_loss: 25932.3673; val_edge_recon_loss: 1327065.7240; val_gene_expr_recon_loss: 2056655.9967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3409654.0887; val_optim_loss: 3409654.0887
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9849; val_auprc_score: 0.9938; val_best_acc_score: 0.9589; val_best_f1_score: 0.9730; train_kl_reg_loss: 25934.8868; train_edge_recon_loss: 1315660.6895; train_gene_expr_recon_loss: 2013603.5505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3355199.1242; train_optim_loss: 3355199.1242; val_kl_reg_loss: 25914.0570; val_edge_recon_loss: 1321266.3643; val_gene_expr_recon_loss: 2054434.2620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3401614.6827; val_optim_loss: 3401614.6827
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9854; val_auprc_score: 0.9939; val_best_acc_score: 0.9597; val_best_f1_score: 0.9735; train_kl_reg_loss: 25905.5728; train_edge_recon_loss: 1314738.7647; train_gene_expr_recon_loss: 2013872.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3354516.8273; train_optim_loss: 3354516.8273; val_kl_reg_loss: 25903.0290; val_edge_recon_loss: 1326632.0205; val_gene_expr_recon_loss: 2053493.8483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3406028.8927; val_optim_loss: 3406028.8927
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9857; val_auprc_score: 0.9941; val_best_acc_score: 0.9598; val_best_f1_score: 0.9734; train_kl_reg_loss: 25915.8335; train_edge_recon_loss: 1319036.1879; train_gene_expr_recon_loss: 2014645.5284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3359597.5485; train_optim_loss: 3359597.5485; val_kl_reg_loss: 25888.8174; val_edge_recon_loss: 1330232.7990; val_gene_expr_recon_loss: 2055786.6157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3411908.2360; val_optim_loss: 3411908.2360

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1506 min 30 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9853
val AUPRC score: 0.9940
val best accuracy score: 0.9597
val best F1 score: 0.9734
val target rna MSE score: 0.9817
val source rna MSE score: 0.0821
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0723
Duration of model training in run 5: 25 hours, 13 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
