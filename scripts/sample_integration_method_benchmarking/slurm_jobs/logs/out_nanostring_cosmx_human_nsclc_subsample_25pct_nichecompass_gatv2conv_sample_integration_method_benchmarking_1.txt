Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9635; val_auprc_score: 0.9808; val_best_acc_score: 0.9563; val_best_f1_score: 0.9717; train_kl_reg_loss: 38527.8147; train_edge_recon_loss: 1319992.5247; train_cat_covariates_contrastive_loss: 642874.7005; train_gene_expr_recon_loss: 2063845.8898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4065240.9304; train_optim_loss: 4065240.9304; val_kl_reg_loss: 38822.6818; val_edge_recon_loss: 1326694.2695; val_cat_covariates_contrastive_loss: 641559.0840; val_gene_expr_recon_loss: 2110278.8845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4117354.9250; val_optim_loss: 4117354.9250
Run timestamp: 04092023_094005_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '8', '--edge_batch_size_list', '256', '256', '--node_batch_size_list', 'None', 'None', '--seeds', '3', '2', '--run_index', '4', '3', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 292269
Number of validation edges: 32474
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9345; val_auprc_score: 0.9731; val_best_acc_score: 0.9116; val_best_f1_score: 0.9439; train_kl_reg_loss: 16178.3545; train_edge_recon_loss: 1410743.9254; train_cat_covariates_contrastive_loss: 634500.2699; train_gene_expr_recon_loss: 3115556.6552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5176979.1996; train_optim_loss: 5176979.1996; val_kl_reg_loss: 11658.4933; val_edge_recon_loss: 1364865.3238; val_cat_covariates_contrastive_loss: 631501.0920; val_gene_expr_recon_loss: 2888368.8504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4896393.7559; val_optim_loss: 4896393.7559
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9469; val_auprc_score: 0.9771; val_best_acc_score: 0.9254; val_best_f1_score: 0.9522; train_kl_reg_loss: 12396.7405; train_edge_recon_loss: 1344959.7953; train_cat_covariates_contrastive_loss: 632922.7016; train_gene_expr_recon_loss: 2811808.7229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802087.9628; train_optim_loss: 4802087.9628; val_kl_reg_loss: 13275.3101; val_edge_recon_loss: 1343777.2746; val_cat_covariates_contrastive_loss: 633290.7028; val_gene_expr_recon_loss: 2727862.4646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4718205.7520; val_optim_loss: 4718205.7520
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9554; val_auprc_score: 0.9799; val_best_acc_score: 0.9343; val_best_f1_score: 0.9575; train_kl_reg_loss: 14809.0130; train_edge_recon_loss: 1336156.0526; train_cat_covariates_contrastive_loss: 635313.7907; train_gene_expr_recon_loss: 2647441.9124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4633720.7763; train_optim_loss: 4633720.7763; val_kl_reg_loss: 16236.4291; val_edge_recon_loss: 1351316.5561; val_cat_covariates_contrastive_loss: 636481.7539; val_gene_expr_recon_loss: 2543472.0098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4547506.7638; val_optim_loss: 4547506.7638
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9667; val_auprc_score: 0.9831; val_best_acc_score: 0.9571; val_best_f1_score: 0.9722; train_kl_reg_loss: 38049.4379; train_edge_recon_loss: 1320157.0235; train_cat_covariates_contrastive_loss: 642631.2282; train_gene_expr_recon_loss: 2060089.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4060927.2961; train_optim_loss: 4060927.2961; val_kl_reg_loss: 38093.2584; val_edge_recon_loss: 1326391.6697; val_cat_covariates_contrastive_loss: 642308.4213; val_gene_expr_recon_loss: 2107991.9330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4114785.2830; val_optim_loss: 4114785.2830
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9560; val_auprc_score: 0.9796; val_best_acc_score: 0.9407; val_best_f1_score: 0.9619; train_kl_reg_loss: 17781.3893; train_edge_recon_loss: 1332256.2588; train_cat_covariates_contrastive_loss: 636209.0944; train_gene_expr_recon_loss: 2476174.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4462421.5517; train_optim_loss: 4462421.5517; val_kl_reg_loss: 19623.6811; val_edge_recon_loss: 1332244.0586; val_cat_covariates_contrastive_loss: 635948.0472; val_gene_expr_recon_loss: 2407663.0354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4395478.8287; val_optim_loss: 4395478.8287
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9567; val_auprc_score: 0.9796; val_best_acc_score: 0.9413; val_best_f1_score: 0.9622; train_kl_reg_loss: 20094.2623; train_edge_recon_loss: 1331136.6398; train_cat_covariates_contrastive_loss: 637390.8767; train_gene_expr_recon_loss: 2367864.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4356486.1329; train_optim_loss: 4356486.1329; val_kl_reg_loss: 20458.4441; val_edge_recon_loss: 1333545.6880; val_cat_covariates_contrastive_loss: 636610.8583; val_gene_expr_recon_loss: 2333496.0079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4324111.0217; val_optim_loss: 4324111.0217
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9589; val_auprc_score: 0.9808; val_best_acc_score: 0.9453; val_best_f1_score: 0.9648; train_kl_reg_loss: 21696.1666; train_edge_recon_loss: 1326756.0339; train_cat_covariates_contrastive_loss: 637408.2807; train_gene_expr_recon_loss: 2299063.7432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4284924.2268; train_optim_loss: 4284924.2268; val_kl_reg_loss: 23179.0970; val_edge_recon_loss: 1329503.9646; val_cat_covariates_contrastive_loss: 637258.9085; val_gene_expr_recon_loss: 2271665.8671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4261607.8366; val_optim_loss: 4261607.8366
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9633; val_auprc_score: 0.9806; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 37732.2380; train_edge_recon_loss: 1323763.2278; train_cat_covariates_contrastive_loss: 642685.1642; train_gene_expr_recon_loss: 2056928.5797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4061109.2086; train_optim_loss: 4061109.2086; val_kl_reg_loss: 37601.6533; val_edge_recon_loss: 1327380.5690; val_cat_covariates_contrastive_loss: 642275.4753; val_gene_expr_recon_loss: 2108030.6040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4115288.2810; val_optim_loss: 4115288.2810
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9583; val_auprc_score: 0.9804; val_best_acc_score: 0.9414; val_best_f1_score: 0.9622; train_kl_reg_loss: 22775.3377; train_edge_recon_loss: 1327614.5962; train_cat_covariates_contrastive_loss: 637760.6411; train_gene_expr_recon_loss: 2253255.1189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4241405.6909; train_optim_loss: 4241405.6909; val_kl_reg_loss: 22611.6837; val_edge_recon_loss: 1327213.6073; val_cat_covariates_contrastive_loss: 639437.2677; val_gene_expr_recon_loss: 2244666.1220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4233928.6791; val_optim_loss: 4233928.6791
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9582; val_auprc_score: 0.9802; val_best_acc_score: 0.9426; val_best_f1_score: 0.9627; train_kl_reg_loss: 23633.9504; train_edge_recon_loss: 1327807.3231; train_cat_covariates_contrastive_loss: 637934.1138; train_gene_expr_recon_loss: 2219047.3919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4208422.7771; train_optim_loss: 4208422.7771; val_kl_reg_loss: 24127.3033; val_edge_recon_loss: 1337102.7077; val_cat_covariates_contrastive_loss: 637786.2977; val_gene_expr_recon_loss: 2231511.8593; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4230528.1614; val_optim_loss: 4230528.1614
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9594; val_auprc_score: 0.9805; val_best_acc_score: 0.9446; val_best_f1_score: 0.9642; train_kl_reg_loss: 24417.1155; train_edge_recon_loss: 1325595.0211; train_cat_covariates_contrastive_loss: 638186.0030; train_gene_expr_recon_loss: 2198975.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4187174.0140; train_optim_loss: 4187174.0140; val_kl_reg_loss: 24137.3543; val_edge_recon_loss: 1333658.1270; val_cat_covariates_contrastive_loss: 639710.3981; val_gene_expr_recon_loss: 2200201.6427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4197707.5315; val_optim_loss: 4197707.5315
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9637; val_auprc_score: 0.9806; val_best_acc_score: 0.9585; val_best_f1_score: 0.9730; train_kl_reg_loss: 37421.0150; train_edge_recon_loss: 1323449.3094; train_cat_covariates_contrastive_loss: 642347.0390; train_gene_expr_recon_loss: 2053589.0509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4056806.4136; train_optim_loss: 4056806.4136; val_kl_reg_loss: 37332.0345; val_edge_recon_loss: 1326837.2227; val_cat_covariates_contrastive_loss: 641659.0395; val_gene_expr_recon_loss: 2105773.1415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4111601.4380; val_optim_loss: 4111601.4380
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9578; val_auprc_score: 0.9795; val_best_acc_score: 0.9460; val_best_f1_score: 0.9650; train_kl_reg_loss: 24997.4412; train_edge_recon_loss: 1324669.1073; train_cat_covariates_contrastive_loss: 638088.1598; train_gene_expr_recon_loss: 2174604.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4162359.3503; train_optim_loss: 4162359.3503; val_kl_reg_loss: 25588.2042; val_edge_recon_loss: 1343283.9469; val_cat_covariates_contrastive_loss: 636136.9178; val_gene_expr_recon_loss: 2206618.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4211627.2382; val_optim_loss: 4211627.2382
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9611; val_auprc_score: 0.9810; val_best_acc_score: 0.9491; val_best_f1_score: 0.9671; train_kl_reg_loss: 25554.0181; train_edge_recon_loss: 1322620.9299; train_cat_covariates_contrastive_loss: 638156.7689; train_gene_expr_recon_loss: 2164864.7351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4151196.4575; train_optim_loss: 4151196.4575; val_kl_reg_loss: 25139.9101; val_edge_recon_loss: 1320504.9026; val_cat_covariates_contrastive_loss: 640212.4636; val_gene_expr_recon_loss: 2181617.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4167474.6378; val_optim_loss: 4167474.6378
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9634; val_auprc_score: 0.9820; val_best_acc_score: 0.9457; val_best_f1_score: 0.9650; train_kl_reg_loss: 26045.6084; train_edge_recon_loss: 1321278.0298; train_cat_covariates_contrastive_loss: 638497.7451; train_gene_expr_recon_loss: 2150547.1463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4136368.5407; train_optim_loss: 4136368.5407; val_kl_reg_loss: 25153.5943; val_edge_recon_loss: 1340572.5886; val_cat_covariates_contrastive_loss: 642281.8410; val_gene_expr_recon_loss: 2170165.0148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4178173.0472; val_optim_loss: 4178173.0472
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9607; val_auprc_score: 0.9797; val_best_acc_score: 0.9563; val_best_f1_score: 0.9718; train_kl_reg_loss: 36966.0227; train_edge_recon_loss: 1318115.3042; train_cat_covariates_contrastive_loss: 642385.7663; train_gene_expr_recon_loss: 2052665.5151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4050132.6111; train_optim_loss: 4050132.6111; val_kl_reg_loss: 37387.5846; val_edge_recon_loss: 1318561.6072; val_cat_covariates_contrastive_loss: 641872.6678; val_gene_expr_recon_loss: 2101042.0870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098863.9460; val_optim_loss: 4098863.9460
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9628; val_auprc_score: 0.9823; val_best_acc_score: 0.9486; val_best_f1_score: 0.9668; train_kl_reg_loss: 26292.7677; train_edge_recon_loss: 1322139.8225; train_cat_covariates_contrastive_loss: 638511.8873; train_gene_expr_recon_loss: 2142056.3608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4129000.8358; train_optim_loss: 4129000.8358; val_kl_reg_loss: 26179.5958; val_edge_recon_loss: 1335121.0915; val_cat_covariates_contrastive_loss: 640437.1171; val_gene_expr_recon_loss: 2164854.3967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4166592.1949; val_optim_loss: 4166592.1949
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9625; val_auprc_score: 0.9820; val_best_acc_score: 0.9472; val_best_f1_score: 0.9659; train_kl_reg_loss: 26874.9888; train_edge_recon_loss: 1323496.0273; train_cat_covariates_contrastive_loss: 638428.0303; train_gene_expr_recon_loss: 2133779.2592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4122578.3067; train_optim_loss: 4122578.3067; val_kl_reg_loss: 26261.4024; val_edge_recon_loss: 1333563.2303; val_cat_covariates_contrastive_loss: 640923.4473; val_gene_expr_recon_loss: 2167000.5079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4167748.5748; val_optim_loss: 4167748.5748
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9621; val_auprc_score: 0.9819; val_best_acc_score: 0.9457; val_best_f1_score: 0.9649; train_kl_reg_loss: 27132.2551; train_edge_recon_loss: 1328588.2298; train_cat_covariates_contrastive_loss: 638732.8561; train_gene_expr_recon_loss: 2121381.3141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4115834.6519; train_optim_loss: 4115834.6519; val_kl_reg_loss: 26721.3295; val_edge_recon_loss: 1333521.2904; val_cat_covariates_contrastive_loss: 640187.5226; val_gene_expr_recon_loss: 2150132.1909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4150562.3307; val_optim_loss: 4150562.3307
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9657; val_auprc_score: 0.9822; val_best_acc_score: 0.9590; val_best_f1_score: 0.9734; train_kl_reg_loss: 36523.1244; train_edge_recon_loss: 1319960.0519; train_cat_covariates_contrastive_loss: 642332.1624; train_gene_expr_recon_loss: 2050208.0852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4049023.4263; train_optim_loss: 4049023.4263; val_kl_reg_loss: 36376.1890; val_edge_recon_loss: 1320217.2357; val_cat_covariates_contrastive_loss: 642622.5853; val_gene_expr_recon_loss: 2101233.0320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4100449.0380; val_optim_loss: 4100449.0380
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9559; val_auprc_score: 0.9779; val_best_acc_score: 0.9477; val_best_f1_score: 0.9661; train_kl_reg_loss: 27305.6303; train_edge_recon_loss: 1331196.1573; train_cat_covariates_contrastive_loss: 638727.6899; train_gene_expr_recon_loss: 2121930.2756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4119159.7493; train_optim_loss: 4119159.7493; val_kl_reg_loss: 28444.2749; val_edge_recon_loss: 1345459.4144; val_cat_covariates_contrastive_loss: 636965.8282; val_gene_expr_recon_loss: 2147430.7746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158300.3031; val_optim_loss: 4158300.3031
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9555; val_auprc_score: 0.9782; val_best_acc_score: 0.9470; val_best_f1_score: 0.9658; train_kl_reg_loss: 27597.7444; train_edge_recon_loss: 1331738.6805; train_cat_covariates_contrastive_loss: 638536.4402; train_gene_expr_recon_loss: 2110815.8215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4108688.6883; train_optim_loss: 4108688.6883; val_kl_reg_loss: 28714.1784; val_edge_recon_loss: 1348127.4331; val_cat_covariates_contrastive_loss: 637126.8853; val_gene_expr_recon_loss: 2144912.6014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158881.1102; val_optim_loss: 4158881.1102
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9617; val_auprc_score: 0.9808; val_best_acc_score: 0.9486; val_best_f1_score: 0.9669; train_kl_reg_loss: 27866.8192; train_edge_recon_loss: 1318278.7169; train_cat_covariates_contrastive_loss: 638912.3037; train_gene_expr_recon_loss: 2112542.5872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4097600.4330; train_optim_loss: 4097600.4330; val_kl_reg_loss: 28215.2313; val_edge_recon_loss: 1332558.7618; val_cat_covariates_contrastive_loss: 639701.3627; val_gene_expr_recon_loss: 2140470.9744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4140946.3287; val_optim_loss: 4140946.3287
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9648; val_auprc_score: 0.9814; val_best_acc_score: 0.9575; val_best_f1_score: 0.9724; train_kl_reg_loss: 35882.6193; train_edge_recon_loss: 1322367.4575; train_cat_covariates_contrastive_loss: 642112.2223; train_gene_expr_recon_loss: 2047238.6135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4047600.9091; train_optim_loss: 4047600.9091; val_kl_reg_loss: 35550.7477; val_edge_recon_loss: 1322436.3980; val_cat_covariates_contrastive_loss: 642280.0755; val_gene_expr_recon_loss: 2101607.7890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101875.0170; val_optim_loss: 4101875.0170
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9617; val_auprc_score: 0.9815; val_best_acc_score: 0.9490; val_best_f1_score: 0.9670; train_kl_reg_loss: 28091.9873; train_edge_recon_loss: 1321409.7428; train_cat_covariates_contrastive_loss: 638921.9888; train_gene_expr_recon_loss: 2100974.5218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4089398.2410; train_optim_loss: 4089398.2410; val_kl_reg_loss: 28978.9188; val_edge_recon_loss: 1319628.2047; val_cat_covariates_contrastive_loss: 639632.9326; val_gene_expr_recon_loss: 2134408.5335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4122648.5984; val_optim_loss: 4122648.5984
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9606; val_auprc_score: 0.9807; val_best_acc_score: 0.9489; val_best_f1_score: 0.9671; train_kl_reg_loss: 28391.0410; train_edge_recon_loss: 1320445.6372; train_cat_covariates_contrastive_loss: 638878.4492; train_gene_expr_recon_loss: 2098734.2145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4086449.3415; train_optim_loss: 4086449.3415; val_kl_reg_loss: 28311.6162; val_edge_recon_loss: 1327847.7598; val_cat_covariates_contrastive_loss: 638809.3588; val_gene_expr_recon_loss: 2136865.1663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4131833.9252; val_optim_loss: 4131833.9252
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9580; val_auprc_score: 0.9785; val_best_acc_score: 0.9484; val_best_f1_score: 0.9665; train_kl_reg_loss: 28372.4257; train_edge_recon_loss: 1323689.8346; train_cat_covariates_contrastive_loss: 638876.3390; train_gene_expr_recon_loss: 2100271.3668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4091209.9634; train_optim_loss: 4091209.9634; val_kl_reg_loss: 29574.6408; val_edge_recon_loss: 1340381.1270; val_cat_covariates_contrastive_loss: 637750.0935; val_gene_expr_recon_loss: 2137589.0679; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145294.9173; val_optim_loss: 4145294.9173
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9660; val_auprc_score: 0.9821; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 35382.4512; train_edge_recon_loss: 1320950.1449; train_cat_covariates_contrastive_loss: 642174.7841; train_gene_expr_recon_loss: 2047742.9227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4046250.3053; train_optim_loss: 4046250.3053; val_kl_reg_loss: 35049.1934; val_edge_recon_loss: 1323406.2777; val_cat_covariates_contrastive_loss: 642739.2007; val_gene_expr_recon_loss: 2100616.6930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101811.3630; val_optim_loss: 4101811.3630
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9588; val_auprc_score: 0.9795; val_best_acc_score: 0.9469; val_best_f1_score: 0.9656; train_kl_reg_loss: 28756.9042; train_edge_recon_loss: 1326732.5335; train_cat_covariates_contrastive_loss: 639105.7948; train_gene_expr_recon_loss: 2089489.2242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4084084.4584; train_optim_loss: 4084084.4584; val_kl_reg_loss: 29479.4053; val_edge_recon_loss: 1333253.8504; val_cat_covariates_contrastive_loss: 638253.5881; val_gene_expr_recon_loss: 2127480.5610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4128467.3898; val_optim_loss: 4128467.3898
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9644; val_auprc_score: 0.9827; val_best_acc_score: 0.9520; val_best_f1_score: 0.9691; train_kl_reg_loss: 28634.0817; train_edge_recon_loss: 1321204.7090; train_cat_covariates_contrastive_loss: 638949.0621; train_gene_expr_recon_loss: 2089683.2161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4078471.0720; train_optim_loss: 4078471.0720; val_kl_reg_loss: 29113.0224; val_edge_recon_loss: 1323518.0709; val_cat_covariates_contrastive_loss: 637864.5807; val_gene_expr_recon_loss: 2155330.5344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145826.2283; val_optim_loss: 4145826.2283

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9608; val_auprc_score: 0.9805; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 28627.5686; train_edge_recon_loss: 1318622.0577; train_cat_covariates_contrastive_loss: 639387.7942; train_gene_expr_recon_loss: 2059819.4465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4046456.8662; train_optim_loss: 4046456.8662; val_kl_reg_loss: 29050.4641; val_edge_recon_loss: 1324414.3809; val_cat_covariates_contrastive_loss: 639249.3770; val_gene_expr_recon_loss: 2106126.6791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098840.8898; val_optim_loss: 4098840.8898
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9623; val_auprc_score: 0.9813; val_best_acc_score: 0.9489; val_best_f1_score: 0.9671; train_kl_reg_loss: 28674.8347; train_edge_recon_loss: 1323810.5503; train_cat_covariates_contrastive_loss: 639399.6542; train_gene_expr_recon_loss: 2041318.0340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4033203.0687; train_optim_loss: 4033203.0687; val_kl_reg_loss: 28649.4164; val_edge_recon_loss: 1329098.4823; val_cat_covariates_contrastive_loss: 639244.4129; val_gene_expr_recon_loss: 2099211.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096203.9764; val_optim_loss: 4096203.9764
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9651; val_auprc_score: 0.9814; val_best_acc_score: 0.9580; val_best_f1_score: 0.9727; train_kl_reg_loss: 34894.9460; train_edge_recon_loss: 1326358.2756; train_cat_covariates_contrastive_loss: 641814.9493; train_gene_expr_recon_loss: 2044590.0966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4047658.2694; train_optim_loss: 4047658.2694; val_kl_reg_loss: 34301.3767; val_edge_recon_loss: 1326522.0765; val_cat_covariates_contrastive_loss: 642159.4128; val_gene_expr_recon_loss: 2098981.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101964.2730; val_optim_loss: 4101964.2730
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9621; val_auprc_score: 0.9811; val_best_acc_score: 0.9506; val_best_f1_score: 0.9682; train_kl_reg_loss: 28638.3682; train_edge_recon_loss: 1321920.5497; train_cat_covariates_contrastive_loss: 639226.6982; train_gene_expr_recon_loss: 2034272.5445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4024058.1600; train_optim_loss: 4024058.1600; val_kl_reg_loss: 28532.5247; val_edge_recon_loss: 1310916.3799; val_cat_covariates_contrastive_loss: 639103.1895; val_gene_expr_recon_loss: 2095773.8455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4074325.9449; val_optim_loss: 4074325.9449
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9671; val_auprc_score: 0.9837; val_best_acc_score: 0.9533; val_best_f1_score: 0.9697; train_kl_reg_loss: 28474.0512; train_edge_recon_loss: 1321980.9362; train_cat_covariates_contrastive_loss: 639261.4674; train_gene_expr_recon_loss: 2027835.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4017551.7191; train_optim_loss: 4017551.7191; val_kl_reg_loss: 28510.7896; val_edge_recon_loss: 1316212.3406; val_cat_covariates_contrastive_loss: 640404.7751; val_gene_expr_recon_loss: 2091083.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4076211.6437; val_optim_loss: 4076211.6437

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9663; val_auprc_score: 0.9824; val_best_acc_score: 0.9582; val_best_f1_score: 0.9729; train_kl_reg_loss: 34173.2890; train_edge_recon_loss: 1322820.8521; train_cat_covariates_contrastive_loss: 641796.6833; train_gene_expr_recon_loss: 2035929.9586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4034720.7842; train_optim_loss: 4034720.7842; val_kl_reg_loss: 34022.8930; val_edge_recon_loss: 1328277.6035; val_cat_covariates_contrastive_loss: 642036.8660; val_gene_expr_recon_loss: 2095008.8135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4099346.1780; val_optim_loss: 4099346.1780
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9628; val_auprc_score: 0.9816; val_best_acc_score: 0.9488; val_best_f1_score: 0.9670; train_kl_reg_loss: 28518.9883; train_edge_recon_loss: 1315909.4200; train_cat_covariates_contrastive_loss: 639362.1767; train_gene_expr_recon_loss: 2024866.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4008656.6351; train_optim_loss: 4008656.6351; val_kl_reg_loss: 28264.5631; val_edge_recon_loss: 1328942.2411; val_cat_covariates_contrastive_loss: 639461.7195; val_gene_expr_recon_loss: 2085474.1319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082142.6516; val_optim_loss: 4082142.6516
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9611; val_auprc_score: 0.9805; val_best_acc_score: 0.9502; val_best_f1_score: 0.9678; train_kl_reg_loss: 28362.7472; train_edge_recon_loss: 1319917.5864; train_cat_covariates_contrastive_loss: 639242.8397; train_gene_expr_recon_loss: 2022948.3735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4010471.5433; train_optim_loss: 4010471.5433; val_kl_reg_loss: 28066.4258; val_edge_recon_loss: 1330845.4370; val_cat_covariates_contrastive_loss: 639796.1949; val_gene_expr_recon_loss: 2093880.0807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4092588.1378; val_optim_loss: 4092588.1378
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9641; val_auprc_score: 0.9809; val_best_acc_score: 0.9574; val_best_f1_score: 0.9723; train_kl_reg_loss: 34194.0986; train_edge_recon_loss: 1319300.9447; train_cat_covariates_contrastive_loss: 641881.4085; train_gene_expr_recon_loss: 2035415.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030792.3529; train_optim_loss: 4030792.3529; val_kl_reg_loss: 34151.7542; val_edge_recon_loss: 1320784.0810; val_cat_covariates_contrastive_loss: 642033.4865; val_gene_expr_recon_loss: 2095722.7890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4092692.0970; val_optim_loss: 4092692.0970
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9606; val_auprc_score: 0.9805; val_best_acc_score: 0.9500; val_best_f1_score: 0.9676; train_kl_reg_loss: 28226.9628; train_edge_recon_loss: 1314968.2831; train_cat_covariates_contrastive_loss: 639156.5599; train_gene_expr_recon_loss: 2020768.1164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4003119.9175; train_optim_loss: 4003119.9175; val_kl_reg_loss: 28272.3048; val_edge_recon_loss: 1333057.1811; val_cat_covariates_contrastive_loss: 638959.1831; val_gene_expr_recon_loss: 2085834.2205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086122.8858; val_optim_loss: 4086122.8858

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9604; val_auprc_score: 0.9804; val_best_acc_score: 0.9505; val_best_f1_score: 0.9680; train_kl_reg_loss: 28163.9259; train_edge_recon_loss: 1323142.0935; train_cat_covariates_contrastive_loss: 639248.6347; train_gene_expr_recon_loss: 2014626.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4005180.8805; train_optim_loss: 4005180.8805; val_kl_reg_loss: 28124.5890; val_edge_recon_loss: 1335311.5541; val_cat_covariates_contrastive_loss: 639625.8130; val_gene_expr_recon_loss: 2085035.6772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088097.6496; val_optim_loss: 4088097.6496
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9659; val_auprc_score: 0.9822; val_best_acc_score: 0.9588; val_best_f1_score: 0.9734; train_kl_reg_loss: 34121.3776; train_edge_recon_loss: 1320759.4667; train_cat_covariates_contrastive_loss: 641873.2284; train_gene_expr_recon_loss: 2034384.1839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4031138.2548; train_optim_loss: 4031138.2548; val_kl_reg_loss: 34207.5798; val_edge_recon_loss: 1317519.2385; val_cat_covariates_contrastive_loss: 641524.6240; val_gene_expr_recon_loss: 2094168.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087420.2290; val_optim_loss: 4087420.2290
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9604; val_auprc_score: 0.9808; val_best_acc_score: 0.9497; val_best_f1_score: 0.9675; train_kl_reg_loss: 28196.0923; train_edge_recon_loss: 1316958.5125; train_cat_covariates_contrastive_loss: 639146.1550; train_gene_expr_recon_loss: 2014278.4457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3998579.2049; train_optim_loss: 3998579.2049; val_kl_reg_loss: 28319.0798; val_edge_recon_loss: 1330149.6644; val_cat_covariates_contrastive_loss: 638594.6314; val_gene_expr_recon_loss: 2086971.8169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4084035.1772; val_optim_loss: 4084035.1772
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9634; val_auprc_score: 0.9818; val_best_acc_score: 0.9516; val_best_f1_score: 0.9686; train_kl_reg_loss: 28172.7309; train_edge_recon_loss: 1326208.1137; train_cat_covariates_contrastive_loss: 639284.5798; train_gene_expr_recon_loss: 2016052.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4009718.1081; train_optim_loss: 4009718.1081; val_kl_reg_loss: 28378.7640; val_edge_recon_loss: 1326202.7047; val_cat_covariates_contrastive_loss: 639287.5281; val_gene_expr_recon_loss: 2087223.0856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4081092.0787; val_optim_loss: 4081092.0787
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9666; val_auprc_score: 0.9820; val_best_acc_score: 0.9584; val_best_f1_score: 0.9730; train_kl_reg_loss: 34088.1975; train_edge_recon_loss: 1319663.8230; train_cat_covariates_contrastive_loss: 641888.4581; train_gene_expr_recon_loss: 2035265.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030906.0766; train_optim_loss: 4030906.0766; val_kl_reg_loss: 33744.2487; val_edge_recon_loss: 1326841.0325; val_cat_covariates_contrastive_loss: 642803.0742; val_gene_expr_recon_loss: 2094505.8260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097894.1840; val_optim_loss: 4097894.1840
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9625; val_auprc_score: 0.9810; val_best_acc_score: 0.9512; val_best_f1_score: 0.9684; train_kl_reg_loss: 28106.0119; train_edge_recon_loss: 1319484.7948; train_cat_covariates_contrastive_loss: 639228.2342; train_gene_expr_recon_loss: 2014776.1311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4001595.1751; train_optim_loss: 4001595.1751; val_kl_reg_loss: 28301.3957; val_edge_recon_loss: 1323969.5241; val_cat_covariates_contrastive_loss: 638016.3076; val_gene_expr_recon_loss: 2081594.3278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4071881.5571; val_optim_loss: 4071881.5571
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9592; val_auprc_score: 0.9797; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 28082.1231; train_edge_recon_loss: 1317928.3478; train_cat_covariates_contrastive_loss: 639039.2598; train_gene_expr_recon_loss: 2015291.9507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4000341.6813; train_optim_loss: 4000341.6813; val_kl_reg_loss: 28320.9305; val_edge_recon_loss: 1326834.0472; val_cat_covariates_contrastive_loss: 638406.8883; val_gene_expr_recon_loss: 2084739.6850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4078301.5571; val_optim_loss: 4078301.5571
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9667; val_auprc_score: 0.9825; val_best_acc_score: 0.9586; val_best_f1_score: 0.9731; train_kl_reg_loss: 33987.2863; train_edge_recon_loss: 1318482.4247; train_cat_covariates_contrastive_loss: 642065.9204; train_gene_expr_recon_loss: 2035195.2920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4029730.9240; train_optim_loss: 4029730.9240; val_kl_reg_loss: 33960.5993; val_edge_recon_loss: 1323563.5175; val_cat_covariates_contrastive_loss: 642036.4515; val_gene_expr_recon_loss: 2094629.1415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4094189.7180; val_optim_loss: 4094189.7180
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9625; val_auprc_score: 0.9819; val_best_acc_score: 0.9493; val_best_f1_score: 0.9672; train_kl_reg_loss: 28106.5719; train_edge_recon_loss: 1317197.7048; train_cat_covariates_contrastive_loss: 639102.3799; train_gene_expr_recon_loss: 2014719.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3999126.0867; train_optim_loss: 3999126.0867; val_kl_reg_loss: 28219.5186; val_edge_recon_loss: 1332049.0945; val_cat_covariates_contrastive_loss: 639018.1260; val_gene_expr_recon_loss: 2083929.4439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4083216.1850; val_optim_loss: 4083216.1850
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9607; val_auprc_score: 0.9800; val_best_acc_score: 0.9505; val_best_f1_score: 0.9680; train_kl_reg_loss: 28075.2087; train_edge_recon_loss: 1319805.1199; train_cat_covariates_contrastive_loss: 639221.8955; train_gene_expr_recon_loss: 2015002.2942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4002104.5158; train_optim_loss: 4002104.5158; val_kl_reg_loss: 28124.3823; val_edge_recon_loss: 1338075.4902; val_cat_covariates_contrastive_loss: 638272.7003; val_gene_expr_recon_loss: 2086296.0148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090768.5787; val_optim_loss: 4090768.5787
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9626; val_auprc_score: 0.9807; val_best_acc_score: 0.9516; val_best_f1_score: 0.9685; train_kl_reg_loss: 28056.0551; train_edge_recon_loss: 1319722.9905; train_cat_covariates_contrastive_loss: 638890.2836; train_gene_expr_recon_loss: 2012231.7658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3998901.0981; train_optim_loss: 3998901.0981; val_kl_reg_loss: 28185.3406; val_edge_recon_loss: 1332888.3287; val_cat_covariates_contrastive_loss: 639242.4454; val_gene_expr_recon_loss: 2082108.6644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082424.7756; val_optim_loss: 4082424.7756
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9639; val_auprc_score: 0.9806; val_best_acc_score: 0.9579; val_best_f1_score: 0.9727; train_kl_reg_loss: 33975.9946; train_edge_recon_loss: 1322051.7181; train_cat_covariates_contrastive_loss: 641840.1343; train_gene_expr_recon_loss: 2034229.0421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032096.8908; train_optim_loss: 4032096.8908; val_kl_reg_loss: 34127.1603; val_edge_recon_loss: 1325110.7795; val_cat_covariates_contrastive_loss: 641619.9120; val_gene_expr_recon_loss: 2093549.9335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4094407.7840; val_optim_loss: 4094407.7840

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9612; val_auprc_score: 0.9805; val_best_acc_score: 0.9499; val_best_f1_score: 0.9675; train_kl_reg_loss: 28055.6819; train_edge_recon_loss: 1323408.9829; train_cat_covariates_contrastive_loss: 639143.1697; train_gene_expr_recon_loss: 2011720.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4002328.0556; train_optim_loss: 4002328.0556; val_kl_reg_loss: 28181.4012; val_edge_recon_loss: 1334039.7057; val_cat_covariates_contrastive_loss: 638519.0881; val_gene_expr_recon_loss: 2081497.3819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082237.5709; val_optim_loss: 4082237.5709
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9646; val_auprc_score: 0.9823; val_best_acc_score: 0.9518; val_best_f1_score: 0.9688; train_kl_reg_loss: 28078.3515; train_edge_recon_loss: 1318864.1137; train_cat_covariates_contrastive_loss: 638873.0083; train_gene_expr_recon_loss: 2010768.7131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3996584.1885; train_optim_loss: 3996584.1885; val_kl_reg_loss: 28214.9386; val_edge_recon_loss: 1334467.1900; val_cat_covariates_contrastive_loss: 639495.3287; val_gene_expr_recon_loss: 2083360.2234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4085537.6909; val_optim_loss: 4085537.6909
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9671; val_auprc_score: 0.9827; val_best_acc_score: 0.9580; val_best_f1_score: 0.9728; train_kl_reg_loss: 33979.5826; train_edge_recon_loss: 1315547.5310; train_cat_covariates_contrastive_loss: 641883.5188; train_gene_expr_recon_loss: 2035401.0185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4026811.6501; train_optim_loss: 4026811.6501; val_kl_reg_loss: 33927.9090; val_edge_recon_loss: 1327062.1635; val_cat_covariates_contrastive_loss: 641834.1587; val_gene_expr_recon_loss: 2094558.6585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097382.8850; val_optim_loss: 4097382.8850
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9617; val_auprc_score: 0.9808; val_best_acc_score: 0.9501; val_best_f1_score: 0.9677; train_kl_reg_loss: 28054.5660; train_edge_recon_loss: 1315530.9164; train_cat_covariates_contrastive_loss: 639393.9465; train_gene_expr_recon_loss: 2013269.4872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3996248.9214; train_optim_loss: 3996248.9214; val_kl_reg_loss: 28074.2463; val_edge_recon_loss: 1333956.3189; val_cat_covariates_contrastive_loss: 639113.4867; val_gene_expr_recon_loss: 2085251.0600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086395.1142; val_optim_loss: 4086395.1142
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9627; val_auprc_score: 0.9819; val_best_acc_score: 0.9515; val_best_f1_score: 0.9686; train_kl_reg_loss: 28024.4148; train_edge_recon_loss: 1317569.2845; train_cat_covariates_contrastive_loss: 639115.7631; train_gene_expr_recon_loss: 2013460.8202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3998170.2824; train_optim_loss: 3998170.2824; val_kl_reg_loss: 28157.9847; val_edge_recon_loss: 1326276.0679; val_cat_covariates_contrastive_loss: 638484.9823; val_gene_expr_recon_loss: 2085027.4331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4077946.4488; val_optim_loss: 4077946.4488

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9659; val_auprc_score: 0.9821; val_best_acc_score: 0.9583; val_best_f1_score: 0.9730; train_kl_reg_loss: 33904.8508; train_edge_recon_loss: 1323244.4584; train_cat_covariates_contrastive_loss: 641699.7848; train_gene_expr_recon_loss: 2033282.7784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032131.8717; train_optim_loss: 4032131.8717; val_kl_reg_loss: 33917.5877; val_edge_recon_loss: 1325154.7165; val_cat_covariates_contrastive_loss: 642856.0960; val_gene_expr_recon_loss: 2093942.2215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095870.6300; val_optim_loss: 4095870.6300

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 302 min 54 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9170
val AUPRC score: 0.9488
val best accuracy score: 0.9366
val best F1 score: 0.9588
val target rna MSE score: 1.0856
val source rna MSE score: 0.0899
Val cat covariate0 mean sim diff: -0.0019
Val cat covariate1 mean sim diff: -0.0740
Duration of model training in run 4: 5 hours, 5 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 292269
Number of validation edges: 32474
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9299; val_auprc_score: 0.9718; val_best_acc_score: 0.9070; val_best_f1_score: 0.9411; train_kl_reg_loss: 13843.2248; train_edge_recon_loss: 1414113.3089; train_cat_covariates_contrastive_loss: 635719.4156; train_gene_expr_recon_loss: 3134550.5407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5198226.4882; train_optim_loss: 5198226.4882; val_kl_reg_loss: 11368.2024; val_edge_recon_loss: 1368349.3415; val_cat_covariates_contrastive_loss: 630929.0714; val_gene_expr_recon_loss: 2929617.0689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4940263.6811; val_optim_loss: 4940263.6811
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9462; val_auprc_score: 0.9768; val_best_acc_score: 0.9225; val_best_f1_score: 0.9504; train_kl_reg_loss: 11673.1266; train_edge_recon_loss: 1343038.9658; train_cat_covariates_contrastive_loss: 632863.9072; train_gene_expr_recon_loss: 2825357.5718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4812933.5784; train_optim_loss: 4812933.5784; val_kl_reg_loss: 11979.6050; val_edge_recon_loss: 1352325.4616; val_cat_covariates_contrastive_loss: 633121.6678; val_gene_expr_recon_loss: 2765869.9980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763296.7402; val_optim_loss: 4763296.7402
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9651; val_auprc_score: 0.9815; val_best_acc_score: 0.9578; val_best_f1_score: 0.9726; train_kl_reg_loss: 33876.7453; train_edge_recon_loss: 1319392.8056; train_cat_covariates_contrastive_loss: 641907.9771; train_gene_expr_recon_loss: 2033590.8219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4028768.3507; train_optim_loss: 4028768.3507; val_kl_reg_loss: 33891.2082; val_edge_recon_loss: 1328659.3275; val_cat_covariates_contrastive_loss: 641755.2477; val_gene_expr_recon_loss: 2092757.9430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097063.7350; val_optim_loss: 4097063.7350
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9539; val_auprc_score: 0.9792; val_best_acc_score: 0.9340; val_best_f1_score: 0.9575; train_kl_reg_loss: 13735.0507; train_edge_recon_loss: 1335945.7594; train_cat_covariates_contrastive_loss: 634477.4360; train_gene_expr_recon_loss: 2658289.1090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4642447.3549; train_optim_loss: 4642447.3549; val_kl_reg_loss: 15753.9015; val_edge_recon_loss: 1345232.7904; val_cat_covariates_contrastive_loss: 635726.9163; val_gene_expr_recon_loss: 2574158.9921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4570872.5906; val_optim_loss: 4570872.5906
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9528; val_auprc_score: 0.9780; val_best_acc_score: 0.9374; val_best_f1_score: 0.9596; train_kl_reg_loss: 16860.8934; train_edge_recon_loss: 1334961.2881; train_cat_covariates_contrastive_loss: 635781.6247; train_gene_expr_recon_loss: 2480670.6627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4468274.4597; train_optim_loss: 4468274.4597; val_kl_reg_loss: 18885.2307; val_edge_recon_loss: 1342202.4793; val_cat_covariates_contrastive_loss: 634075.7594; val_gene_expr_recon_loss: 2441121.1457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4436284.6102; val_optim_loss: 4436284.6102
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9558; val_auprc_score: 0.9796; val_best_acc_score: 0.9412; val_best_f1_score: 0.9622; train_kl_reg_loss: 19394.7223; train_edge_recon_loss: 1333925.4284; train_cat_covariates_contrastive_loss: 636633.4873; train_gene_expr_recon_loss: 2364917.0008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4354870.6434; train_optim_loss: 4354870.6434; val_kl_reg_loss: 21021.3580; val_edge_recon_loss: 1340688.3720; val_cat_covariates_contrastive_loss: 635868.3396; val_gene_expr_recon_loss: 2352212.2087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4349790.2579; val_optim_loss: 4349790.2579
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9649; val_auprc_score: 0.9816; val_best_acc_score: 0.9587; val_best_f1_score: 0.9733; train_kl_reg_loss: 33871.2690; train_edge_recon_loss: 1317953.7945; train_cat_covariates_contrastive_loss: 641865.1823; train_gene_expr_recon_loss: 2033295.5351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4026985.7831; train_optim_loss: 4026985.7831; val_kl_reg_loss: 33981.4216; val_edge_recon_loss: 1316045.8368; val_cat_covariates_contrastive_loss: 641095.1123; val_gene_expr_recon_loss: 2095075.2255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086197.5960; val_optim_loss: 4086197.5960
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9595; val_auprc_score: 0.9807; val_best_acc_score: 0.9438; val_best_f1_score: 0.9637; train_kl_reg_loss: 21049.7740; train_edge_recon_loss: 1329059.6786; train_cat_covariates_contrastive_loss: 637131.3203; train_gene_expr_recon_loss: 2290367.0686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4277607.8376; train_optim_loss: 4277607.8376; val_kl_reg_loss: 21356.5016; val_edge_recon_loss: 1345611.7618; val_cat_covariates_contrastive_loss: 637830.6954; val_gene_expr_recon_loss: 2297819.9508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4302618.8976; val_optim_loss: 4302618.8976
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9603; val_auprc_score: 0.9817; val_best_acc_score: 0.9444; val_best_f1_score: 0.9640; train_kl_reg_loss: 22320.5659; train_edge_recon_loss: 1330610.2232; train_cat_covariates_contrastive_loss: 637390.3938; train_gene_expr_recon_loss: 2240901.8764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4231223.0595; train_optim_loss: 4231223.0595; val_kl_reg_loss: 22444.2389; val_edge_recon_loss: 1332278.7579; val_cat_covariates_contrastive_loss: 638990.6767; val_gene_expr_recon_loss: 2259742.8583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4253456.5315; val_optim_loss: 4253456.5315
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9584; val_auprc_score: 0.9802; val_best_acc_score: 0.9446; val_best_f1_score: 0.9644; train_kl_reg_loss: 23304.6150; train_edge_recon_loss: 1325496.5473; train_cat_covariates_contrastive_loss: 637437.6799; train_gene_expr_recon_loss: 2209281.2880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4195520.1259; train_optim_loss: 4195520.1259; val_kl_reg_loss: 23979.2027; val_edge_recon_loss: 1334119.7156; val_cat_covariates_contrastive_loss: 636538.2781; val_gene_expr_recon_loss: 2219336.7785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4213973.9783; val_optim_loss: 4213973.9783
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9650; val_auprc_score: 0.9815; val_best_acc_score: 0.9582; val_best_f1_score: 0.9729; train_kl_reg_loss: 33861.8821; train_edge_recon_loss: 1321217.6641; train_cat_covariates_contrastive_loss: 641562.5734; train_gene_expr_recon_loss: 2033513.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030156.1058; train_optim_loss: 4030156.1058; val_kl_reg_loss: 33951.0122; val_edge_recon_loss: 1320464.5525; val_cat_covariates_contrastive_loss: 641589.0375; val_gene_expr_recon_loss: 2094292.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090297.4930; val_optim_loss: 4090297.4930
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9619; val_auprc_score: 0.9817; val_best_acc_score: 0.9444; val_best_f1_score: 0.9638; train_kl_reg_loss: 23866.7040; train_edge_recon_loss: 1327126.1157; train_cat_covariates_contrastive_loss: 637721.1021; train_gene_expr_recon_loss: 2181296.6100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4170010.5296; train_optim_loss: 4170010.5296; val_kl_reg_loss: 23955.7688; val_edge_recon_loss: 1339067.6594; val_cat_covariates_contrastive_loss: 639709.7293; val_gene_expr_recon_loss: 2222803.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4225536.4193; val_optim_loss: 4225536.4193
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9628; val_auprc_score: 0.9825; val_best_acc_score: 0.9473; val_best_f1_score: 0.9661; train_kl_reg_loss: 24558.8414; train_edge_recon_loss: 1331567.5439; train_cat_covariates_contrastive_loss: 637992.9953; train_gene_expr_recon_loss: 2165998.0516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4160117.4319; train_optim_loss: 4160117.4319; val_kl_reg_loss: 25318.3832; val_edge_recon_loss: 1324744.9006; val_cat_covariates_contrastive_loss: 638275.4001; val_gene_expr_recon_loss: 2187500.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4175839.3563; val_optim_loss: 4175839.3563
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9592; val_auprc_score: 0.9808; val_best_acc_score: 0.9443; val_best_f1_score: 0.9641; train_kl_reg_loss: 25135.9393; train_edge_recon_loss: 1323782.3922; train_cat_covariates_contrastive_loss: 638446.3903; train_gene_expr_recon_loss: 2148216.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4135581.3201; train_optim_loss: 4135581.3201; val_kl_reg_loss: 26042.1337; val_edge_recon_loss: 1327670.0896; val_cat_covariates_contrastive_loss: 637127.7707; val_gene_expr_recon_loss: 2187518.5886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4178358.5846; val_optim_loss: 4178358.5846
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9645; val_auprc_score: 0.9813; val_best_acc_score: 0.9578; val_best_f1_score: 0.9726; train_kl_reg_loss: 33878.5830; train_edge_recon_loss: 1322401.4436; train_cat_covariates_contrastive_loss: 641587.6425; train_gene_expr_recon_loss: 2032138.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030006.4167; train_optim_loss: 4030006.4167; val_kl_reg_loss: 33903.5889; val_edge_recon_loss: 1331023.2190; val_cat_covariates_contrastive_loss: 641176.6863; val_gene_expr_recon_loss: 2095681.1870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101784.6860; val_optim_loss: 4101784.6860
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9588; val_auprc_score: 0.9805; val_best_acc_score: 0.9460; val_best_f1_score: 0.9653; train_kl_reg_loss: 25516.3713; train_edge_recon_loss: 1322385.9557; train_cat_covariates_contrastive_loss: 637970.2410; train_gene_expr_recon_loss: 2141997.0710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4127869.6399; train_optim_loss: 4127869.6399; val_kl_reg_loss: 25380.8507; val_edge_recon_loss: 1335817.2067; val_cat_covariates_contrastive_loss: 637419.0241; val_gene_expr_recon_loss: 2211352.5335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4209969.6260; val_optim_loss: 4209969.6260
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9577; val_auprc_score: 0.9795; val_best_acc_score: 0.9438; val_best_f1_score: 0.9636; train_kl_reg_loss: 26152.0284; train_edge_recon_loss: 1327622.0089; train_cat_covariates_contrastive_loss: 638350.6225; train_gene_expr_recon_loss: 2130945.4403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4123070.1040; train_optim_loss: 4123070.1040; val_kl_reg_loss: 25153.9003; val_edge_recon_loss: 1344521.3671; val_cat_covariates_contrastive_loss: 638898.8445; val_gene_expr_recon_loss: 2185407.9734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4193982.0728; val_optim_loss: 4193982.0728
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9594; val_auprc_score: 0.9803; val_best_acc_score: 0.9467; val_best_f1_score: 0.9657; train_kl_reg_loss: 26402.0039; train_edge_recon_loss: 1325555.8133; train_cat_covariates_contrastive_loss: 638350.1127; train_gene_expr_recon_loss: 2123542.7391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4113850.6666; train_optim_loss: 4113850.6666; val_kl_reg_loss: 27620.0494; val_edge_recon_loss: 1350801.9350; val_cat_covariates_contrastive_loss: 637456.7844; val_gene_expr_recon_loss: 2171636.6043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4187515.3740; val_optim_loss: 4187515.3740

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9608; val_auprc_score: 0.9804; val_best_acc_score: 0.9478; val_best_f1_score: 0.9660; train_kl_reg_loss: 26365.3392; train_edge_recon_loss: 1316715.0462; train_cat_covariates_contrastive_loss: 638696.8007; train_gene_expr_recon_loss: 2073174.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4054951.9310; train_optim_loss: 4054951.9310; val_kl_reg_loss: 26527.1098; val_edge_recon_loss: 1331215.6565; val_cat_covariates_contrastive_loss: 637055.1097; val_gene_expr_recon_loss: 2130706.4675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4125504.3406; val_optim_loss: 4125504.3406
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9645; val_auprc_score: 0.9812; val_best_acc_score: 0.9579; val_best_f1_score: 0.9726; train_kl_reg_loss: 33873.0004; train_edge_recon_loss: 1321125.4316; train_cat_covariates_contrastive_loss: 641852.9442; train_gene_expr_recon_loss: 2033670.4602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030521.8398; train_optim_loss: 4030521.8398; val_kl_reg_loss: 33885.8167; val_edge_recon_loss: 1329244.2530; val_cat_covariates_contrastive_loss: 641346.6145; val_gene_expr_recon_loss: 2094116.0530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098592.7290; val_optim_loss: 4098592.7290
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9601; val_auprc_score: 0.9798; val_best_acc_score: 0.9472; val_best_f1_score: 0.9657; train_kl_reg_loss: 26538.2890; train_edge_recon_loss: 1316666.6275; train_cat_covariates_contrastive_loss: 638511.1471; train_gene_expr_recon_loss: 2063326.0358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4045042.1027; train_optim_loss: 4045042.1027; val_kl_reg_loss: 26117.0556; val_edge_recon_loss: 1345310.1772; val_cat_covariates_contrastive_loss: 638711.9719; val_gene_expr_recon_loss: 2121221.7913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4131361.0000; val_optim_loss: 4131361.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9574; val_auprc_score: 0.9790; val_best_acc_score: 0.9460; val_best_f1_score: 0.9651; train_kl_reg_loss: 26443.4770; train_edge_recon_loss: 1326881.5408; train_cat_covariates_contrastive_loss: 638374.9308; train_gene_expr_recon_loss: 2057049.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4048748.9783; train_optim_loss: 4048748.9783; val_kl_reg_loss: 26660.3495; val_edge_recon_loss: 1342833.0935; val_cat_covariates_contrastive_loss: 637571.5507; val_gene_expr_recon_loss: 2124129.7087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4131194.7146; val_optim_loss: 4131194.7146
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9611; val_auprc_score: 0.9810; val_best_acc_score: 0.9489; val_best_f1_score: 0.9670; train_kl_reg_loss: 26214.8393; train_edge_recon_loss: 1321163.1640; train_cat_covariates_contrastive_loss: 638296.8475; train_gene_expr_recon_loss: 2054151.9423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4039826.7929; train_optim_loss: 4039826.7929; val_kl_reg_loss: 26588.3442; val_edge_recon_loss: 1318618.9473; val_cat_covariates_contrastive_loss: 638574.1737; val_gene_expr_recon_loss: 2121790.8150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4105572.2815; val_optim_loss: 4105572.2815
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9651; val_auprc_score: 0.9818; val_best_acc_score: 0.9582; val_best_f1_score: 0.9729; train_kl_reg_loss: 33841.5382; train_edge_recon_loss: 1319004.6161; train_cat_covariates_contrastive_loss: 641938.1867; train_gene_expr_recon_loss: 2033183.4260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4027967.7643; train_optim_loss: 4027967.7643; val_kl_reg_loss: 33847.3447; val_edge_recon_loss: 1319571.0390; val_cat_covariates_contrastive_loss: 642187.3225; val_gene_expr_recon_loss: 2094994.6540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090600.3670; val_optim_loss: 4090600.3670
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9622; val_auprc_score: 0.9813; val_best_acc_score: 0.9494; val_best_f1_score: 0.9672; train_kl_reg_loss: 26176.2118; train_edge_recon_loss: 1319259.9421; train_cat_covariates_contrastive_loss: 638534.5234; train_gene_expr_recon_loss: 2051146.7086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4035117.3833; train_optim_loss: 4035117.3833; val_kl_reg_loss: 25824.0916; val_edge_recon_loss: 1326660.3159; val_cat_covariates_contrastive_loss: 639549.8214; val_gene_expr_recon_loss: 2119197.0797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4111231.3189; val_optim_loss: 4111231.3189
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9599; val_auprc_score: 0.9802; val_best_acc_score: 0.9494; val_best_f1_score: 0.9674; train_kl_reg_loss: 26123.6363; train_edge_recon_loss: 1321664.8249; train_cat_covariates_contrastive_loss: 638220.5496; train_gene_expr_recon_loss: 2047397.0251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4033406.0339; train_optim_loss: 4033406.0339; val_kl_reg_loss: 26785.4427; val_edge_recon_loss: 1323070.0453; val_cat_covariates_contrastive_loss: 636986.1998; val_gene_expr_recon_loss: 2119875.6988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4106717.3898; val_optim_loss: 4106717.3898
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9593; val_auprc_score: 0.9797; val_best_acc_score: 0.9485; val_best_f1_score: 0.9667; train_kl_reg_loss: 26134.6152; train_edge_recon_loss: 1321799.7201; train_cat_covariates_contrastive_loss: 638111.1622; train_gene_expr_recon_loss: 2046353.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032398.6075; train_optim_loss: 4032398.6075; val_kl_reg_loss: 26313.2872; val_edge_recon_loss: 1330882.5340; val_cat_covariates_contrastive_loss: 637483.9021; val_gene_expr_recon_loss: 2115712.4616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4110392.1752; val_optim_loss: 4110392.1752

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9648; val_auprc_score: 0.9811; val_best_acc_score: 0.9581; val_best_f1_score: 0.9728; train_kl_reg_loss: 33838.9254; train_edge_recon_loss: 1318291.4632; train_cat_covariates_contrastive_loss: 641838.7993; train_gene_expr_recon_loss: 2033124.5068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4027093.6967; train_optim_loss: 4027093.6967; val_kl_reg_loss: 33861.7131; val_edge_recon_loss: 1323192.9315; val_cat_covariates_contrastive_loss: 641733.3782; val_gene_expr_recon_loss: 2092556.9045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4091344.9300; val_optim_loss: 4091344.9300
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9602; val_auprc_score: 0.9808; val_best_acc_score: 0.9490; val_best_f1_score: 0.9672; train_kl_reg_loss: 26067.2012; train_edge_recon_loss: 1321710.6577; train_cat_covariates_contrastive_loss: 638315.8059; train_gene_expr_recon_loss: 2045261.4354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4031355.1066; train_optim_loss: 4031355.1066; val_kl_reg_loss: 25857.7971; val_edge_recon_loss: 1308980.3307; val_cat_covariates_contrastive_loss: 639076.6993; val_gene_expr_recon_loss: 2113415.5827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087330.4272; val_optim_loss: 4087330.4272
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9617; val_auprc_score: 0.9810; val_best_acc_score: 0.9499; val_best_f1_score: 0.9676; train_kl_reg_loss: 25857.7086; train_edge_recon_loss: 1325012.3510; train_cat_covariates_contrastive_loss: 638216.7982; train_gene_expr_recon_loss: 2042021.6546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4031108.5112; train_optim_loss: 4031108.5112; val_kl_reg_loss: 26540.5516; val_edge_recon_loss: 1326741.1565; val_cat_covariates_contrastive_loss: 636612.7416; val_gene_expr_recon_loss: 2113151.6201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4103046.0630; val_optim_loss: 4103046.0630
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9594; val_auprc_score: 0.9792; val_best_acc_score: 0.9476; val_best_f1_score: 0.9662; train_kl_reg_loss: 25866.7988; train_edge_recon_loss: 1319235.2155; train_cat_covariates_contrastive_loss: 638349.8967; train_gene_expr_recon_loss: 2040197.6822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4023649.5880; train_optim_loss: 4023649.5880; val_kl_reg_loss: 25984.8147; val_edge_recon_loss: 1331776.2933; val_cat_covariates_contrastive_loss: 638052.2347; val_gene_expr_recon_loss: 2109008.0640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104821.4094; val_optim_loss: 4104821.4094
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9666; val_auprc_score: 0.9824; val_best_acc_score: 0.9586; val_best_f1_score: 0.9731; train_kl_reg_loss: 33854.3661; train_edge_recon_loss: 1321010.1860; train_cat_covariates_contrastive_loss: 641859.9605; train_gene_expr_recon_loss: 2032870.8940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4029595.4085; train_optim_loss: 4029595.4085; val_kl_reg_loss: 33865.7636; val_edge_recon_loss: 1327933.3525; val_cat_covariates_contrastive_loss: 642044.0038; val_gene_expr_recon_loss: 2094830.0440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098673.1670; val_optim_loss: 4098673.1670
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9607; val_auprc_score: 0.9805; val_best_acc_score: 0.9478; val_best_f1_score: 0.9662; train_kl_reg_loss: 25777.7102; train_edge_recon_loss: 1315849.9024; train_cat_covariates_contrastive_loss: 638179.4576; train_gene_expr_recon_loss: 2038315.8422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4018122.9107; train_optim_loss: 4018122.9107; val_kl_reg_loss: 25796.4673; val_edge_recon_loss: 1343236.2825; val_cat_covariates_contrastive_loss: 637902.4065; val_gene_expr_recon_loss: 2109864.3120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4116799.4803; val_optim_loss: 4116799.4803
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9609; val_auprc_score: 0.9808; val_best_acc_score: 0.9500; val_best_f1_score: 0.9678; train_kl_reg_loss: 25763.1884; train_edge_recon_loss: 1326369.5055; train_cat_covariates_contrastive_loss: 638036.2902; train_gene_expr_recon_loss: 2035786.1359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4025955.1178; train_optim_loss: 4025955.1178; val_kl_reg_loss: 25757.5811; val_edge_recon_loss: 1318169.8839; val_cat_covariates_contrastive_loss: 637949.1211; val_gene_expr_recon_loss: 2111042.2717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4092918.8465; val_optim_loss: 4092918.8465
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9648; val_auprc_score: 0.9814; val_best_acc_score: 0.9586; val_best_f1_score: 0.9731; train_kl_reg_loss: 33874.6380; train_edge_recon_loss: 1320989.5433; train_cat_covariates_contrastive_loss: 641730.2664; train_gene_expr_recon_loss: 2033110.9713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4029705.4177; train_optim_loss: 4029705.4177; val_kl_reg_loss: 33933.1287; val_edge_recon_loss: 1323467.5305; val_cat_covariates_contrastive_loss: 641447.0030; val_gene_expr_recon_loss: 2094218.3275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093065.9900; val_optim_loss: 4093065.9900

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9609; val_auprc_score: 0.9808; val_best_acc_score: 0.9471; val_best_f1_score: 0.9657; train_kl_reg_loss: 25773.3063; train_edge_recon_loss: 1319785.0915; train_cat_covariates_contrastive_loss: 637901.1929; train_gene_expr_recon_loss: 2031254.4290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4014714.0153; train_optim_loss: 4014714.0153; val_kl_reg_loss: 25757.2772; val_edge_recon_loss: 1354971.8445; val_cat_covariates_contrastive_loss: 637890.0551; val_gene_expr_recon_loss: 2104796.2736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4123415.4488; val_optim_loss: 4123415.4488
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9616; val_auprc_score: 0.9814; val_best_acc_score: 0.9487; val_best_f1_score: 0.9669; train_kl_reg_loss: 25626.2362; train_edge_recon_loss: 1316046.6395; train_cat_covariates_contrastive_loss: 638009.4561; train_gene_expr_recon_loss: 2030070.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4009752.9602; train_optim_loss: 4009752.9602; val_kl_reg_loss: 25782.6655; val_edge_recon_loss: 1317758.8735; val_cat_covariates_contrastive_loss: 636866.5349; val_gene_expr_recon_loss: 2108927.0482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089335.1280; val_optim_loss: 4089335.1280
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9649; val_auprc_score: 0.9815; val_best_acc_score: 0.9578; val_best_f1_score: 0.9726; train_kl_reg_loss: 33860.9566; train_edge_recon_loss: 1323824.2523; train_cat_covariates_contrastive_loss: 641831.2942; train_gene_expr_recon_loss: 2033445.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032962.2148; train_optim_loss: 4032962.2148; val_kl_reg_loss: 33834.4309; val_edge_recon_loss: 1328013.2685; val_cat_covariates_contrastive_loss: 641942.7415; val_gene_expr_recon_loss: 2093104.8935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096895.3220; val_optim_loss: 4096895.3220
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9607; val_auprc_score: 0.9808; val_best_acc_score: 0.9493; val_best_f1_score: 0.9674; train_kl_reg_loss: 25606.9979; train_edge_recon_loss: 1319650.8748; train_cat_covariates_contrastive_loss: 637799.2634; train_gene_expr_recon_loss: 2031579.6202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4014636.7542; train_optim_loss: 4014636.7542; val_kl_reg_loss: 25620.7426; val_edge_recon_loss: 1325819.5886; val_cat_covariates_contrastive_loss: 637955.7451; val_gene_expr_recon_loss: 2108274.3583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097670.4272; val_optim_loss: 4097670.4272
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9645; val_auprc_score: 0.9826; val_best_acc_score: 0.9495; val_best_f1_score: 0.9673; train_kl_reg_loss: 25584.8291; train_edge_recon_loss: 1319154.1952; train_cat_covariates_contrastive_loss: 637967.9644; train_gene_expr_recon_loss: 2029621.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4012328.0779; train_optim_loss: 4012328.0779; val_kl_reg_loss: 25741.7453; val_edge_recon_loss: 1320515.4296; val_cat_covariates_contrastive_loss: 637476.9547; val_gene_expr_recon_loss: 2108735.5512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4092469.6811; val_optim_loss: 4092469.6811

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 198 min 48 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9209
val AUPRC score: 0.9504
val best accuracy score: 0.9355
val best F1 score: 0.9578
val target rna MSE score: 1.1699
val source rna MSE score: 0.0937
Val cat covariate0 mean sim diff: -0.0015
Val cat covariate1 mean sim diff: -0.0643
Duration of model training in run 3: 3 hours, 21 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 904 min 39 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9227
val AUPRC score: 0.9496
val best accuracy score: 0.9452
val best F1 score: 0.9642
val target rna MSE score: 1.0692
val source rna MSE score: 0.0727
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0755
Duration of model training in run 7: 15 hours, 9 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 433334
Number of validation edges: 48148
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9330; val_auprc_score: 0.9723; val_best_acc_score: 0.9162; val_best_f1_score: 0.9469; train_kl_reg_loss: 14049.8423; train_edge_recon_loss: 1393393.7408; train_cat_covariates_contrastive_loss: 635001.8721; train_gene_expr_recon_loss: 3066774.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5109220.0786; train_optim_loss: 5109220.0786; val_kl_reg_loss: 11921.9247; val_edge_recon_loss: 1356356.8869; val_cat_covariates_contrastive_loss: 630396.8439; val_gene_expr_recon_loss: 2843121.8810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841797.5265; val_optim_loss: 4841797.5265
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9541; val_auprc_score: 0.9791; val_best_acc_score: 0.9359; val_best_f1_score: 0.9587; train_kl_reg_loss: 13321.2443; train_edge_recon_loss: 1339280.5344; train_cat_covariates_contrastive_loss: 633899.0471; train_gene_expr_recon_loss: 2735280.8165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721781.6421; train_optim_loss: 4721781.6421; val_kl_reg_loss: 14443.8220; val_edge_recon_loss: 1353852.9954; val_cat_covariates_contrastive_loss: 636194.0737; val_gene_expr_recon_loss: 2627607.6561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4632098.5370; val_optim_loss: 4632098.5370
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9576; val_auprc_score: 0.9804; val_best_acc_score: 0.9428; val_best_f1_score: 0.9633; train_kl_reg_loss: 17025.2240; train_edge_recon_loss: 1334391.4587; train_cat_covariates_contrastive_loss: 635635.9798; train_gene_expr_recon_loss: 2509942.0120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4496994.6711; train_optim_loss: 4496994.6711; val_kl_reg_loss: 19254.6348; val_edge_recon_loss: 1323809.9144; val_cat_covariates_contrastive_loss: 637147.5794; val_gene_expr_recon_loss: 2431451.0331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4411663.1468; val_optim_loss: 4411663.1468
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9583; val_auprc_score: 0.9804; val_best_acc_score: 0.9438; val_best_f1_score: 0.9637; train_kl_reg_loss: 20325.2487; train_edge_recon_loss: 1331384.8860; train_cat_covariates_contrastive_loss: 636626.9168; train_gene_expr_recon_loss: 2369000.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4357337.9451; train_optim_loss: 4357337.9451; val_kl_reg_loss: 20779.9746; val_edge_recon_loss: 1349288.0562; val_cat_covariates_contrastive_loss: 637555.2388; val_gene_expr_recon_loss: 2343426.4398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4351049.7249; val_optim_loss: 4351049.7249
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9585; val_auprc_score: 0.9796; val_best_acc_score: 0.9470; val_best_f1_score: 0.9658; train_kl_reg_loss: 22407.0199; train_edge_recon_loss: 1327394.4114; train_cat_covariates_contrastive_loss: 637183.1347; train_gene_expr_recon_loss: 2289874.1341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4276858.6979; train_optim_loss: 4276858.6979; val_kl_reg_loss: 23416.0382; val_edge_recon_loss: 1348904.9656; val_cat_covariates_contrastive_loss: 636442.3433; val_gene_expr_recon_loss: 2282395.6376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4291158.9841; val_optim_loss: 4291158.9841
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9577; val_auprc_score: 0.9799; val_best_acc_score: 0.9450; val_best_f1_score: 0.9646; train_kl_reg_loss: 23956.2322; train_edge_recon_loss: 1325254.6389; train_cat_covariates_contrastive_loss: 637774.7006; train_gene_expr_recon_loss: 2246036.1734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4233021.7401; train_optim_loss: 4233021.7401; val_kl_reg_loss: 25574.1854; val_edge_recon_loss: 1342276.0274; val_cat_covariates_contrastive_loss: 636664.9468; val_gene_expr_recon_loss: 2252474.0575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4256989.2407; val_optim_loss: 4256989.2407
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9600; val_auprc_score: 0.9808; val_best_acc_score: 0.9470; val_best_f1_score: 0.9657; train_kl_reg_loss: 25119.0359; train_edge_recon_loss: 1325329.0569; train_cat_covariates_contrastive_loss: 637994.5359; train_gene_expr_recon_loss: 2213437.2260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4201879.8548; train_optim_loss: 4201879.8548; val_kl_reg_loss: 25234.3017; val_edge_recon_loss: 1332572.8320; val_cat_covariates_contrastive_loss: 637809.4048; val_gene_expr_recon_loss: 2228704.6700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4224321.2090; val_optim_loss: 4224321.2090
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9622; val_auprc_score: 0.9816; val_best_acc_score: 0.9494; val_best_f1_score: 0.9673; train_kl_reg_loss: 25801.4681; train_edge_recon_loss: 1328612.7379; train_cat_covariates_contrastive_loss: 638372.1529; train_gene_expr_recon_loss: 2196447.8745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4189234.2274; train_optim_loss: 4189234.2274; val_kl_reg_loss: 26598.9017; val_edge_recon_loss: 1326075.7275; val_cat_covariates_contrastive_loss: 637367.4706; val_gene_expr_recon_loss: 2230798.1164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4220840.2156; val_optim_loss: 4220840.2156
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9653; val_auprc_score: 0.9835; val_best_acc_score: 0.9485; val_best_f1_score: 0.9668; train_kl_reg_loss: 26685.1912; train_edge_recon_loss: 1325884.4464; train_cat_covariates_contrastive_loss: 638351.5735; train_gene_expr_recon_loss: 2180907.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4171828.4631; train_optim_loss: 4171828.4631; val_kl_reg_loss: 25519.6685; val_edge_recon_loss: 1331779.9428; val_cat_covariates_contrastive_loss: 642801.0043; val_gene_expr_recon_loss: 2211358.1991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4211458.7976; val_optim_loss: 4211458.7976
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9624; val_auprc_score: 0.9812; val_best_acc_score: 0.9502; val_best_f1_score: 0.9678; train_kl_reg_loss: 27484.3904; train_edge_recon_loss: 1326063.9246; train_cat_covariates_contrastive_loss: 638986.2806; train_gene_expr_recon_loss: 2172669.6294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4165204.2273; train_optim_loss: 4165204.2273; val_kl_reg_loss: 27642.7905; val_edge_recon_loss: 1334844.4878; val_cat_covariates_contrastive_loss: 639454.9478; val_gene_expr_recon_loss: 2192843.1832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4194785.4021; val_optim_loss: 4194785.4021
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9616; val_auprc_score: 0.9808; val_best_acc_score: 0.9521; val_best_f1_score: 0.9690; train_kl_reg_loss: 28007.1590; train_edge_recon_loss: 1322429.3865; train_cat_covariates_contrastive_loss: 639040.9399; train_gene_expr_recon_loss: 2150417.9739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4139895.4607; train_optim_loss: 4139895.4607; val_kl_reg_loss: 27443.0993; val_edge_recon_loss: 1337499.2500; val_cat_covariates_contrastive_loss: 639473.6157; val_gene_expr_recon_loss: 2197273.8161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4201689.7870; val_optim_loss: 4201689.7870
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9642; val_auprc_score: 0.9818; val_best_acc_score: 0.9551; val_best_f1_score: 0.9709; train_kl_reg_loss: 28471.0854; train_edge_recon_loss: 1327094.7130; train_cat_covariates_contrastive_loss: 639090.6098; train_gene_expr_recon_loss: 2151491.3390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4146147.7465; train_optim_loss: 4146147.7465; val_kl_reg_loss: 28692.2171; val_edge_recon_loss: 1330194.1620; val_cat_covariates_contrastive_loss: 640053.7060; val_gene_expr_recon_loss: 2180483.8122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4179423.9048; val_optim_loss: 4179423.9048
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9642; val_auprc_score: 0.9822; val_best_acc_score: 0.9528; val_best_f1_score: 0.9694; train_kl_reg_loss: 29288.2245; train_edge_recon_loss: 1322974.9753; train_cat_covariates_contrastive_loss: 639488.9321; train_gene_expr_recon_loss: 2145374.8595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4137126.9888; train_optim_loss: 4137126.9888; val_kl_reg_loss: 28805.8507; val_edge_recon_loss: 1334910.4312; val_cat_covariates_contrastive_loss: 641502.7771; val_gene_expr_recon_loss: 2172085.4630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4177304.5106; val_optim_loss: 4177304.5106
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9650; val_auprc_score: 0.9824; val_best_acc_score: 0.9547; val_best_f1_score: 0.9707; train_kl_reg_loss: 29521.7215; train_edge_recon_loss: 1324470.3598; train_cat_covariates_contrastive_loss: 639318.0054; train_gene_expr_recon_loss: 2139473.5784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4132783.6652; train_optim_loss: 4132783.6652; val_kl_reg_loss: 27876.5259; val_edge_recon_loss: 1323256.1085; val_cat_covariates_contrastive_loss: 640248.1161; val_gene_expr_recon_loss: 2219301.4299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4210682.1746; val_optim_loss: 4210682.1746
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9610; val_auprc_score: 0.9803; val_best_acc_score: 0.9515; val_best_f1_score: 0.9685; train_kl_reg_loss: 30067.2119; train_edge_recon_loss: 1323613.6057; train_cat_covariates_contrastive_loss: 639570.3699; train_gene_expr_recon_loss: 2131489.1526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4124740.3463; train_optim_loss: 4124740.3463; val_kl_reg_loss: 30710.5342; val_edge_recon_loss: 1330896.5572; val_cat_covariates_contrastive_loss: 639340.2814; val_gene_expr_recon_loss: 2168023.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4168970.9299; val_optim_loss: 4168970.9299
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9603; val_auprc_score: 0.9807; val_best_acc_score: 0.9499; val_best_f1_score: 0.9676; train_kl_reg_loss: 30270.3946; train_edge_recon_loss: 1323585.8613; train_cat_covariates_contrastive_loss: 639535.3079; train_gene_expr_recon_loss: 2132091.5332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4125483.1000; train_optim_loss: 4125483.1000; val_kl_reg_loss: 30821.1486; val_edge_recon_loss: 1338120.2136; val_cat_covariates_contrastive_loss: 639298.7120; val_gene_expr_recon_loss: 2203967.0721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4212207.1481; val_optim_loss: 4212207.1481
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9636; val_auprc_score: 0.9819; val_best_acc_score: 0.9553; val_best_f1_score: 0.9713; train_kl_reg_loss: 30859.9761; train_edge_recon_loss: 1325451.8759; train_cat_covariates_contrastive_loss: 639873.3459; train_gene_expr_recon_loss: 2123461.1553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4119646.3503; train_optim_loss: 4119646.3503; val_kl_reg_loss: 31122.5517; val_edge_recon_loss: 1310611.1098; val_cat_covariates_contrastive_loss: 640174.7751; val_gene_expr_recon_loss: 2170060.3347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4151968.7791; val_optim_loss: 4151968.7791
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9602; val_auprc_score: 0.9796; val_best_acc_score: 0.9526; val_best_f1_score: 0.9693; train_kl_reg_loss: 31225.2977; train_edge_recon_loss: 1326997.3048; train_cat_covariates_contrastive_loss: 640162.4721; train_gene_expr_recon_loss: 2123684.4318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4122069.5090; train_optim_loss: 4122069.5090; val_kl_reg_loss: 31601.7222; val_edge_recon_loss: 1332062.7884; val_cat_covariates_contrastive_loss: 640656.9659; val_gene_expr_recon_loss: 2162220.5430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4166542.0265; val_optim_loss: 4166542.0265
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9608; val_auprc_score: 0.9792; val_best_acc_score: 0.9544; val_best_f1_score: 0.9705; train_kl_reg_loss: 31569.2291; train_edge_recon_loss: 1320144.6485; train_cat_covariates_contrastive_loss: 639996.3314; train_gene_expr_recon_loss: 2119595.9699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4111306.1804; train_optim_loss: 4111306.1804; val_kl_reg_loss: 32413.2460; val_edge_recon_loss: 1351189.1323; val_cat_covariates_contrastive_loss: 639989.0165; val_gene_expr_recon_loss: 2152141.3181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4175732.7063; val_optim_loss: 4175732.7063
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9619; val_auprc_score: 0.9803; val_best_acc_score: 0.9551; val_best_f1_score: 0.9710; train_kl_reg_loss: 32049.1665; train_edge_recon_loss: 1323267.0536; train_cat_covariates_contrastive_loss: 640401.8203; train_gene_expr_recon_loss: 2119163.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4114881.7829; train_optim_loss: 4114881.7829; val_kl_reg_loss: 32524.6177; val_edge_recon_loss: 1343036.8634; val_cat_covariates_contrastive_loss: 638825.2646; val_gene_expr_recon_loss: 2152958.1614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4167344.8995; val_optim_loss: 4167344.8995
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9646; val_auprc_score: 0.9817; val_best_acc_score: 0.9563; val_best_f1_score: 0.9718; train_kl_reg_loss: 32503.2435; train_edge_recon_loss: 1324551.4219; train_cat_covariates_contrastive_loss: 640406.8395; train_gene_expr_recon_loss: 2111332.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4108794.3311; train_optim_loss: 4108794.3311; val_kl_reg_loss: 33293.7661; val_edge_recon_loss: 1315600.2447; val_cat_covariates_contrastive_loss: 639859.4841; val_gene_expr_recon_loss: 2170169.8571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4158923.3505; val_optim_loss: 4158923.3505

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9635; val_auprc_score: 0.9811; val_best_acc_score: 0.9543; val_best_f1_score: 0.9705; train_kl_reg_loss: 32053.0506; train_edge_recon_loss: 1320098.2542; train_cat_covariates_contrastive_loss: 640677.0257; train_gene_expr_recon_loss: 2057294.8442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4050123.1709; train_optim_loss: 4050123.1709; val_kl_reg_loss: 32318.1879; val_edge_recon_loss: 1342361.8942; val_cat_covariates_contrastive_loss: 640309.4673; val_gene_expr_recon_loss: 2122652.4511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4137641.9947; val_optim_loss: 4137641.9947
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9640; val_auprc_score: 0.9812; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 31915.0190; train_edge_recon_loss: 1321265.1470; train_cat_covariates_contrastive_loss: 640694.0028; train_gene_expr_recon_loss: 2045559.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4039433.8229; train_optim_loss: 4039433.8229; val_kl_reg_loss: 32614.8860; val_edge_recon_loss: 1336909.5503; val_cat_covariates_contrastive_loss: 639500.1944; val_gene_expr_recon_loss: 2112284.7811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4121309.4074; val_optim_loss: 4121309.4074
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9641; val_auprc_score: 0.9815; val_best_acc_score: 0.9567; val_best_f1_score: 0.9720; train_kl_reg_loss: 31785.0794; train_edge_recon_loss: 1317803.1875; train_cat_covariates_contrastive_loss: 640700.6317; train_gene_expr_recon_loss: 2040816.2846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4031105.1788; train_optim_loss: 4031105.1788; val_kl_reg_loss: 31487.4866; val_edge_recon_loss: 1326549.6376; val_cat_covariates_contrastive_loss: 641381.6300; val_gene_expr_recon_loss: 2101651.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101070.3810; val_optim_loss: 4101070.3810
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9668; val_auprc_score: 0.9834; val_best_acc_score: 0.9580; val_best_f1_score: 0.9728; train_kl_reg_loss: 31569.8952; train_edge_recon_loss: 1321557.0434; train_cat_covariates_contrastive_loss: 640559.0809; train_gene_expr_recon_loss: 2036357.7442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030043.7662; train_optim_loss: 4030043.7662; val_kl_reg_loss: 31216.4122; val_edge_recon_loss: 1310505.4497; val_cat_covariates_contrastive_loss: 642979.7520; val_gene_expr_recon_loss: 2102185.8499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086887.4775; val_optim_loss: 4086887.4775
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9652; val_auprc_score: 0.9820; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 31322.7921; train_edge_recon_loss: 1320425.4889; train_cat_covariates_contrastive_loss: 640377.8140; train_gene_expr_recon_loss: 2031716.3574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4023842.4538; train_optim_loss: 4023842.4538; val_kl_reg_loss: 31468.1861; val_edge_recon_loss: 1332445.7894; val_cat_covariates_contrastive_loss: 641664.6901; val_gene_expr_recon_loss: 2103340.7183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4108919.3796; val_optim_loss: 4108919.3796
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9659; val_auprc_score: 0.9826; val_best_acc_score: 0.9573; val_best_f1_score: 0.9724; train_kl_reg_loss: 31180.7396; train_edge_recon_loss: 1320958.3999; train_cat_covariates_contrastive_loss: 640698.1251; train_gene_expr_recon_loss: 2031386.2823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4024223.5474; train_optim_loss: 4024223.5474; val_kl_reg_loss: 31619.0895; val_edge_recon_loss: 1321423.8601; val_cat_covariates_contrastive_loss: 640146.8022; val_gene_expr_recon_loss: 2100797.3995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093987.1415; val_optim_loss: 4093987.1415
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9600; val_auprc_score: 0.9795; val_best_acc_score: 0.9552; val_best_f1_score: 0.9711; train_kl_reg_loss: 30989.6671; train_edge_recon_loss: 1321942.7136; train_cat_covariates_contrastive_loss: 640413.9592; train_gene_expr_recon_loss: 2028569.9626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4021916.3033; train_optim_loss: 4021916.3033; val_kl_reg_loss: 31504.9739; val_edge_recon_loss: 1330942.8548; val_cat_covariates_contrastive_loss: 639684.5460; val_gene_expr_recon_loss: 2097467.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4099599.5119; val_optim_loss: 4099599.5119
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9640; val_auprc_score: 0.9817; val_best_acc_score: 0.9553; val_best_f1_score: 0.9712; train_kl_reg_loss: 30867.9402; train_edge_recon_loss: 1320264.8085; train_cat_covariates_contrastive_loss: 640488.4454; train_gene_expr_recon_loss: 2027439.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4019061.0397; train_optim_loss: 4019061.0397; val_kl_reg_loss: 30667.4853; val_edge_recon_loss: 1320847.1687; val_cat_covariates_contrastive_loss: 640641.0966; val_gene_expr_recon_loss: 2103252.8492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095408.5873; val_optim_loss: 4095408.5873

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9667; val_auprc_score: 0.9827; val_best_acc_score: 0.9568; val_best_f1_score: 0.9719; train_kl_reg_loss: 30678.4043; train_edge_recon_loss: 1319785.3520; train_cat_covariates_contrastive_loss: 640581.7598; train_gene_expr_recon_loss: 2019181.4226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4010226.9389; train_optim_loss: 4010226.9389; val_kl_reg_loss: 30904.9725; val_edge_recon_loss: 1325203.7917; val_cat_covariates_contrastive_loss: 641325.8753; val_gene_expr_recon_loss: 2090993.1415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088427.7923; val_optim_loss: 4088427.7923
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9657; val_auprc_score: 0.9824; val_best_acc_score: 0.9563; val_best_f1_score: 0.9716; train_kl_reg_loss: 30690.8761; train_edge_recon_loss: 1313463.5734; train_cat_covariates_contrastive_loss: 640442.8068; train_gene_expr_recon_loss: 2019971.5510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4004568.8080; train_optim_loss: 4004568.8080; val_kl_reg_loss: 30844.3820; val_edge_recon_loss: 1327222.1091; val_cat_covariates_contrastive_loss: 639799.2530; val_gene_expr_recon_loss: 2102740.7282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4100606.4749; val_optim_loss: 4100606.4749
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9632; val_auprc_score: 0.9809; val_best_acc_score: 0.9563; val_best_f1_score: 0.9717; train_kl_reg_loss: 30613.6052; train_edge_recon_loss: 1318395.0786; train_cat_covariates_contrastive_loss: 640272.8165; train_gene_expr_recon_loss: 2020196.4004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4009477.9005; train_optim_loss: 4009477.9005; val_kl_reg_loss: 30729.1238; val_edge_recon_loss: 1319901.3198; val_cat_covariates_contrastive_loss: 640592.3383; val_gene_expr_recon_loss: 2095015.4841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086238.2593; val_optim_loss: 4086238.2593
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9661; val_auprc_score: 0.9830; val_best_acc_score: 0.9569; val_best_f1_score: 0.9721; train_kl_reg_loss: 30576.3219; train_edge_recon_loss: 1320150.3802; train_cat_covariates_contrastive_loss: 640234.8981; train_gene_expr_recon_loss: 2018473.9418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4009435.5415; train_optim_loss: 4009435.5415; val_kl_reg_loss: 30559.7110; val_edge_recon_loss: 1314567.8882; val_cat_covariates_contrastive_loss: 642227.1617; val_gene_expr_recon_loss: 2095365.0946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082719.8677; val_optim_loss: 4082719.8677
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9644; val_auprc_score: 0.9815; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 30589.0786; train_edge_recon_loss: 1319930.8749; train_cat_covariates_contrastive_loss: 640262.0808; train_gene_expr_recon_loss: 2019661.8606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4010443.8978; train_optim_loss: 4010443.8978; val_kl_reg_loss: 30603.4203; val_edge_recon_loss: 1324088.8466; val_cat_covariates_contrastive_loss: 639884.0499; val_gene_expr_recon_loss: 2094774.1455; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089350.4537; val_optim_loss: 4089350.4537
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9659; val_auprc_score: 0.9822; val_best_acc_score: 0.9568; val_best_f1_score: 0.9721; train_kl_reg_loss: 30608.9107; train_edge_recon_loss: 1320372.6137; train_cat_covariates_contrastive_loss: 640277.7648; train_gene_expr_recon_loss: 2019770.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4011030.2007; train_optim_loss: 4011030.2007; val_kl_reg_loss: 30689.3524; val_edge_recon_loss: 1325772.0774; val_cat_covariates_contrastive_loss: 640260.1068; val_gene_expr_recon_loss: 2091739.8294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088461.3717; val_optim_loss: 4088461.3717
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9654; val_auprc_score: 0.9818; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 30529.6642; train_edge_recon_loss: 1318586.7603; train_cat_covariates_contrastive_loss: 640398.2896; train_gene_expr_recon_loss: 2018303.3315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007818.0436; train_optim_loss: 4007818.0436; val_kl_reg_loss: 30561.5341; val_edge_recon_loss: 1330106.2722; val_cat_covariates_contrastive_loss: 639561.3429; val_gene_expr_recon_loss: 2090348.8433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090577.9828; val_optim_loss: 4090577.9828
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9672; val_auprc_score: 0.9826; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 30492.5116; train_edge_recon_loss: 1318640.9409; train_cat_covariates_contrastive_loss: 640374.2143; train_gene_expr_recon_loss: 2017537.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007045.2847; train_optim_loss: 4007045.2847; val_kl_reg_loss: 30576.3086; val_edge_recon_loss: 1338951.9127; val_cat_covariates_contrastive_loss: 640676.1184; val_gene_expr_recon_loss: 2090224.1257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4100428.4683; val_optim_loss: 4100428.4683

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9649; val_auprc_score: 0.9818; val_best_acc_score: 0.9571; val_best_f1_score: 0.9722; train_kl_reg_loss: 30437.8534; train_edge_recon_loss: 1319261.6567; train_cat_covariates_contrastive_loss: 640239.9579; train_gene_expr_recon_loss: 2017732.5348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007671.9979; train_optim_loss: 4007671.9979; val_kl_reg_loss: 30541.2305; val_edge_recon_loss: 1326768.6412; val_cat_covariates_contrastive_loss: 639998.2011; val_gene_expr_recon_loss: 2093580.3466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090888.3995; val_optim_loss: 4090888.3995
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9653; val_auprc_score: 0.9822; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 30491.8459; train_edge_recon_loss: 1321024.8711; train_cat_covariates_contrastive_loss: 640061.8376; train_gene_expr_recon_loss: 2017651.7197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4009230.2730; train_optim_loss: 4009230.2730; val_kl_reg_loss: 30353.4564; val_edge_recon_loss: 1327069.2030; val_cat_covariates_contrastive_loss: 641459.9263; val_gene_expr_recon_loss: 2091258.4048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090140.9960; val_optim_loss: 4090140.9960
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9653; val_auprc_score: 0.9823; val_best_acc_score: 0.9564; val_best_f1_score: 0.9717; train_kl_reg_loss: 30464.4566; train_edge_recon_loss: 1319570.6097; train_cat_covariates_contrastive_loss: 640287.9627; train_gene_expr_recon_loss: 2016735.7355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007058.7626; train_optim_loss: 4007058.7626; val_kl_reg_loss: 30502.6098; val_edge_recon_loss: 1322888.8399; val_cat_covariates_contrastive_loss: 641332.8439; val_gene_expr_recon_loss: 2087592.6964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082317.0013; val_optim_loss: 4082317.0013
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9625; val_auprc_score: 0.9802; val_best_acc_score: 0.9549; val_best_f1_score: 0.9708; train_kl_reg_loss: 30522.4664; train_edge_recon_loss: 1316874.0706; train_cat_covariates_contrastive_loss: 640394.1863; train_gene_expr_recon_loss: 2017902.0406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4005692.7630; train_optim_loss: 4005692.7630; val_kl_reg_loss: 30566.9837; val_edge_recon_loss: 1342515.8142; val_cat_covariates_contrastive_loss: 639249.6812; val_gene_expr_recon_loss: 2093033.7937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4105366.2751; val_optim_loss: 4105366.2751
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9648; val_auprc_score: 0.9818; val_best_acc_score: 0.9560; val_best_f1_score: 0.9715; train_kl_reg_loss: 30439.5203; train_edge_recon_loss: 1318107.6986; train_cat_covariates_contrastive_loss: 640191.3986; train_gene_expr_recon_loss: 2016379.9643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4005118.5859; train_optim_loss: 4005118.5859; val_kl_reg_loss: 30455.1864; val_edge_recon_loss: 1331025.8505; val_cat_covariates_contrastive_loss: 640345.0215; val_gene_expr_recon_loss: 2095723.7487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097549.8108; val_optim_loss: 4097549.8108
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9661; val_auprc_score: 0.9824; val_best_acc_score: 0.9568; val_best_f1_score: 0.9720; train_kl_reg_loss: 30456.2361; train_edge_recon_loss: 1320700.2033; train_cat_covariates_contrastive_loss: 640240.1378; train_gene_expr_recon_loss: 2016256.4019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007652.9789; train_optim_loss: 4007652.9789; val_kl_reg_loss: 30523.9937; val_edge_recon_loss: 1317912.6171; val_cat_covariates_contrastive_loss: 640213.3905; val_gene_expr_recon_loss: 2085245.3876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4073895.3823; val_optim_loss: 4073895.3823
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9661; val_auprc_score: 0.9822; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 30451.2139; train_edge_recon_loss: 1319048.7134; train_cat_covariates_contrastive_loss: 640452.6263; train_gene_expr_recon_loss: 2016086.6122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006039.1642; train_optim_loss: 4006039.1642; val_kl_reg_loss: 30510.3762; val_edge_recon_loss: 1335579.0337; val_cat_covariates_contrastive_loss: 640970.6892; val_gene_expr_recon_loss: 2097138.5642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104198.6706; val_optim_loss: 4104198.6706
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9647; val_auprc_score: 0.9816; val_best_acc_score: 0.9561; val_best_f1_score: 0.9714; train_kl_reg_loss: 30486.3925; train_edge_recon_loss: 1316372.3362; train_cat_covariates_contrastive_loss: 640434.1468; train_gene_expr_recon_loss: 2015821.1093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4003113.9858; train_optim_loss: 4003113.9858; val_kl_reg_loss: 30489.9723; val_edge_recon_loss: 1329721.2983; val_cat_covariates_contrastive_loss: 640015.2354; val_gene_expr_recon_loss: 2094287.0146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4094513.5212; val_optim_loss: 4094513.5212
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9649; val_auprc_score: 0.9817; val_best_acc_score: 0.9561; val_best_f1_score: 0.9716; train_kl_reg_loss: 30468.8146; train_edge_recon_loss: 1320471.0617; train_cat_covariates_contrastive_loss: 640089.2291; train_gene_expr_recon_loss: 2016594.4533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007623.5570; train_optim_loss: 4007623.5570; val_kl_reg_loss: 30547.4989; val_edge_recon_loss: 1329264.4775; val_cat_covariates_contrastive_loss: 640682.0747; val_gene_expr_recon_loss: 2093363.0542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093857.1124; val_optim_loss: 4093857.1124
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9662; val_auprc_score: 0.9831; val_best_acc_score: 0.9569; val_best_f1_score: 0.9721; train_kl_reg_loss: 30461.2809; train_edge_recon_loss: 1318882.6590; train_cat_covariates_contrastive_loss: 640208.4581; train_gene_expr_recon_loss: 2017044.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006597.0001; train_optim_loss: 4006597.0001; val_kl_reg_loss: 30509.1143; val_edge_recon_loss: 1323871.9253; val_cat_covariates_contrastive_loss: 640106.4160; val_gene_expr_recon_loss: 2091676.5271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086163.9762; val_optim_loss: 4086163.9762

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9644; val_auprc_score: 0.9822; val_best_acc_score: 0.9550; val_best_f1_score: 0.9710; train_kl_reg_loss: 30418.3071; train_edge_recon_loss: 1316486.2171; train_cat_covariates_contrastive_loss: 640147.0620; train_gene_expr_recon_loss: 2014456.5134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4001508.0973; train_optim_loss: 4001508.0973; val_kl_reg_loss: 30476.6860; val_edge_recon_loss: 1315997.0890; val_cat_covariates_contrastive_loss: 639979.0066; val_gene_expr_recon_loss: 2089386.4868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4075839.2526; val_optim_loss: 4075839.2526
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9637; val_auprc_score: 0.9814; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 30441.8148; train_edge_recon_loss: 1317251.9492; train_cat_covariates_contrastive_loss: 640407.6152; train_gene_expr_recon_loss: 2017141.8693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4005243.2499; train_optim_loss: 4005243.2499; val_kl_reg_loss: 30606.8802; val_edge_recon_loss: 1334218.5331; val_cat_covariates_contrastive_loss: 640957.6310; val_gene_expr_recon_loss: 2103815.3181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4109598.3492; val_optim_loss: 4109598.3492
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9670; val_auprc_score: 0.9829; val_best_acc_score: 0.9581; val_best_f1_score: 0.9727; train_kl_reg_loss: 30452.3117; train_edge_recon_loss: 1319199.9310; train_cat_covariates_contrastive_loss: 640502.9345; train_gene_expr_recon_loss: 2017521.7782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007676.9544; train_optim_loss: 4007676.9544; val_kl_reg_loss: 30473.9163; val_edge_recon_loss: 1333628.0685; val_cat_covariates_contrastive_loss: 641065.1911; val_gene_expr_recon_loss: 2091411.3995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096578.5807; val_optim_loss: 4096578.5807
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9648; val_auprc_score: 0.9816; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 30490.0271; train_edge_recon_loss: 1318719.1712; train_cat_covariates_contrastive_loss: 640061.0845; train_gene_expr_recon_loss: 2016854.2298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006124.5090; train_optim_loss: 4006124.5090; val_kl_reg_loss: 30603.0562; val_edge_recon_loss: 1328584.9795; val_cat_covariates_contrastive_loss: 641093.5737; val_gene_expr_recon_loss: 2093431.2216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093712.8188; val_optim_loss: 4093712.8188

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 568 min 29 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9247
val AUPRC score: 0.9532
val best accuracy score: 0.9430
val best F1 score: 0.9628
val target rna MSE score: 1.0954
val source rna MSE score: 0.0778
Val cat covariate0 mean sim diff: -0.0014
Val cat covariate1 mean sim diff: -0.0767
Duration of model training in run 6: 9 hours, 31 minutes and 45 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 433334
Number of validation edges: 48148
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9370; val_auprc_score: 0.9737; val_best_acc_score: 0.9187; val_best_f1_score: 0.9485; train_kl_reg_loss: 14204.4322; train_edge_recon_loss: 1393693.3529; train_cat_covariates_contrastive_loss: 634667.5741; train_gene_expr_recon_loss: 3063462.7476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5106028.1051; train_optim_loss: 5106028.1051; val_kl_reg_loss: 11759.4664; val_edge_recon_loss: 1360624.9286; val_cat_covariates_contrastive_loss: 630726.5192; val_gene_expr_recon_loss: 2853716.1495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4856827.0899; val_optim_loss: 4856827.0899
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9484; val_auprc_score: 0.9774; val_best_acc_score: 0.9306; val_best_f1_score: 0.9557; train_kl_reg_loss: 13201.7493; train_edge_recon_loss: 1344702.5203; train_cat_covariates_contrastive_loss: 633588.1788; train_gene_expr_recon_loss: 2741192.0337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732684.4895; train_optim_loss: 4732684.4895; val_kl_reg_loss: 15047.7049; val_edge_recon_loss: 1345119.3651; val_cat_covariates_contrastive_loss: 634339.2930; val_gene_expr_recon_loss: 2632489.9881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4626996.3280; val_optim_loss: 4626996.3280
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9560; val_auprc_score: 0.9797; val_best_acc_score: 0.9400; val_best_f1_score: 0.9614; train_kl_reg_loss: 16516.3803; train_edge_recon_loss: 1334584.0317; train_cat_covariates_contrastive_loss: 635457.7608; train_gene_expr_recon_loss: 2526687.5648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4513245.7341; train_optim_loss: 4513245.7341; val_kl_reg_loss: 18375.8789; val_edge_recon_loss: 1342669.0278; val_cat_covariates_contrastive_loss: 635649.7060; val_gene_expr_recon_loss: 2457739.6759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4454434.2619; val_optim_loss: 4454434.2619
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9578; val_auprc_score: 0.9797; val_best_acc_score: 0.9442; val_best_f1_score: 0.9641; train_kl_reg_loss: 19779.0189; train_edge_recon_loss: 1334053.9596; train_cat_covariates_contrastive_loss: 636845.9847; train_gene_expr_recon_loss: 2390995.5705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4381674.5288; train_optim_loss: 4381674.5288; val_kl_reg_loss: 21557.5386; val_edge_recon_loss: 1332275.0529; val_cat_covariates_contrastive_loss: 636399.1610; val_gene_expr_recon_loss: 2354994.7738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4345226.5238; val_optim_loss: 4345226.5238
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9544; val_auprc_score: 0.9784; val_best_acc_score: 0.9429; val_best_f1_score: 0.9631; train_kl_reg_loss: 21986.3406; train_edge_recon_loss: 1329822.4159; train_cat_covariates_contrastive_loss: 637360.7184; train_gene_expr_recon_loss: 2312680.5697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4301850.0458; train_optim_loss: 4301850.0458; val_kl_reg_loss: 24156.8640; val_edge_recon_loss: 1334226.9563; val_cat_covariates_contrastive_loss: 635031.0625; val_gene_expr_recon_loss: 2307651.1944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4301066.0820; val_optim_loss: 4301066.0820
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9604; val_auprc_score: 0.9806; val_best_acc_score: 0.9479; val_best_f1_score: 0.9664; train_kl_reg_loss: 23569.7289; train_edge_recon_loss: 1329809.2005; train_cat_covariates_contrastive_loss: 637964.4418; train_gene_expr_recon_loss: 2261128.2740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4252471.6502; train_optim_loss: 4252471.6502; val_kl_reg_loss: 25546.5166; val_edge_recon_loss: 1339092.6567; val_cat_covariates_contrastive_loss: 636275.8892; val_gene_expr_recon_loss: 2277174.0999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4278089.1521; val_optim_loss: 4278089.1521
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9638; val_auprc_score: 0.9822; val_best_acc_score: 0.9500; val_best_f1_score: 0.9676; train_kl_reg_loss: 24510.2050; train_edge_recon_loss: 1327522.2517; train_cat_covariates_contrastive_loss: 638054.2861; train_gene_expr_recon_loss: 2238739.8951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4228826.6369; train_optim_loss: 4228826.6369; val_kl_reg_loss: 25249.8167; val_edge_recon_loss: 1331513.7282; val_cat_covariates_contrastive_loss: 638578.1078; val_gene_expr_recon_loss: 2244583.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4239925.4008; val_optim_loss: 4239925.4008
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9618; val_auprc_score: 0.9812; val_best_acc_score: 0.9512; val_best_f1_score: 0.9684; train_kl_reg_loss: 25504.8000; train_edge_recon_loss: 1325438.0338; train_cat_covariates_contrastive_loss: 638157.2261; train_gene_expr_recon_loss: 2211677.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4200777.5499; train_optim_loss: 4200777.5499; val_kl_reg_loss: 27050.4920; val_edge_recon_loss: 1332455.6806; val_cat_covariates_contrastive_loss: 636532.5648; val_gene_expr_recon_loss: 2268143.6554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4264182.3902; val_optim_loss: 4264182.3902
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9612; val_auprc_score: 0.9811; val_best_acc_score: 0.9498; val_best_f1_score: 0.9674; train_kl_reg_loss: 26381.0930; train_edge_recon_loss: 1324557.7403; train_cat_covariates_contrastive_loss: 638513.2977; train_gene_expr_recon_loss: 2197189.5676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4186641.7016; train_optim_loss: 4186641.7016; val_kl_reg_loss: 27492.7926; val_edge_recon_loss: 1338160.4577; val_cat_covariates_contrastive_loss: 637330.8019; val_gene_expr_recon_loss: 2207955.5642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4210939.6151; val_optim_loss: 4210939.6151
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9586; val_auprc_score: 0.9790; val_best_acc_score: 0.9510; val_best_f1_score: 0.9683; train_kl_reg_loss: 27171.4441; train_edge_recon_loss: 1329352.3395; train_cat_covariates_contrastive_loss: 638628.1311; train_gene_expr_recon_loss: 2187384.9510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4182536.8644; train_optim_loss: 4182536.8644; val_kl_reg_loss: 30689.1301; val_edge_recon_loss: 1341631.4180; val_cat_covariates_contrastive_loss: 635453.6561; val_gene_expr_recon_loss: 2204349.4418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4212123.6336; val_optim_loss: 4212123.6336
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9606; val_auprc_score: 0.9803; val_best_acc_score: 0.9515; val_best_f1_score: 0.9687; train_kl_reg_loss: 27737.8644; train_edge_recon_loss: 1323586.1497; train_cat_covariates_contrastive_loss: 638847.2538; train_gene_expr_recon_loss: 2171586.2818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4161757.5442; train_optim_loss: 4161757.5442; val_kl_reg_loss: 29206.4324; val_edge_recon_loss: 1325521.8631; val_cat_covariates_contrastive_loss: 637695.9931; val_gene_expr_recon_loss: 2192442.2493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4184866.5503; val_optim_loss: 4184866.5503
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9604; val_auprc_score: 0.9801; val_best_acc_score: 0.9518; val_best_f1_score: 0.9688; train_kl_reg_loss: 28309.8605; train_edge_recon_loss: 1324443.1415; train_cat_covariates_contrastive_loss: 638928.2928; train_gene_expr_recon_loss: 2165790.1588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4157471.4572; train_optim_loss: 4157471.4572; val_kl_reg_loss: 29149.1751; val_edge_recon_loss: 1326782.0400; val_cat_covariates_contrastive_loss: 637629.6253; val_gene_expr_recon_loss: 2187798.7804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4181359.6164; val_optim_loss: 4181359.6164
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9595; val_auprc_score: 0.9796; val_best_acc_score: 0.9497; val_best_f1_score: 0.9675; train_kl_reg_loss: 28865.7911; train_edge_recon_loss: 1323998.4001; train_cat_covariates_contrastive_loss: 639376.6941; train_gene_expr_recon_loss: 2155396.3517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4147637.2377; train_optim_loss: 4147637.2377; val_kl_reg_loss: 28241.1919; val_edge_recon_loss: 1330618.3095; val_cat_covariates_contrastive_loss: 639124.6660; val_gene_expr_recon_loss: 2181127.8730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4179112.0582; val_optim_loss: 4179112.0582
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9619; val_auprc_score: 0.9807; val_best_acc_score: 0.9539; val_best_f1_score: 0.9701; train_kl_reg_loss: 29065.0180; train_edge_recon_loss: 1328530.0763; train_cat_covariates_contrastive_loss: 639265.8771; train_gene_expr_recon_loss: 2148923.5292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4145784.4978; train_optim_loss: 4145784.4978; val_kl_reg_loss: 30172.7714; val_edge_recon_loss: 1330845.3710; val_cat_covariates_contrastive_loss: 638618.7235; val_gene_expr_recon_loss: 2181646.3743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4181283.2447; val_optim_loss: 4181283.2447
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9634; val_auprc_score: 0.9818; val_best_acc_score: 0.9531; val_best_f1_score: 0.9696; train_kl_reg_loss: 29816.4890; train_edge_recon_loss: 1324880.3724; train_cat_covariates_contrastive_loss: 639583.9952; train_gene_expr_recon_loss: 2136554.7629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4130835.6205; train_optim_loss: 4130835.6205; val_kl_reg_loss: 29483.6134; val_edge_recon_loss: 1330116.5522; val_cat_covariates_contrastive_loss: 640056.9653; val_gene_expr_recon_loss: 2166101.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4165759.0437; val_optim_loss: 4165759.0437
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9617; val_auprc_score: 0.9808; val_best_acc_score: 0.9545; val_best_f1_score: 0.9706; train_kl_reg_loss: 29934.2355; train_edge_recon_loss: 1323196.6111; train_cat_covariates_contrastive_loss: 639351.2098; train_gene_expr_recon_loss: 2137954.6533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4130436.7110; train_optim_loss: 4130436.7110; val_kl_reg_loss: 30476.7337; val_edge_recon_loss: 1331326.7530; val_cat_covariates_contrastive_loss: 638050.5384; val_gene_expr_recon_loss: 2168601.7619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4168455.7950; val_optim_loss: 4168455.7950
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9669; val_auprc_score: 0.9835; val_best_acc_score: 0.9544; val_best_f1_score: 0.9705; train_kl_reg_loss: 30447.6883; train_edge_recon_loss: 1322293.6703; train_cat_covariates_contrastive_loss: 639667.5567; train_gene_expr_recon_loss: 2137032.8668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4129441.7825; train_optim_loss: 4129441.7825; val_kl_reg_loss: 29814.0172; val_edge_recon_loss: 1329801.6872; val_cat_covariates_contrastive_loss: 642548.2358; val_gene_expr_recon_loss: 2163007.5086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4165171.4511; val_optim_loss: 4165171.4511
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9669; val_auprc_score: 0.9837; val_best_acc_score: 0.9530; val_best_f1_score: 0.9696; train_kl_reg_loss: 30655.7267; train_edge_recon_loss: 1324875.2762; train_cat_covariates_contrastive_loss: 639923.6312; train_gene_expr_recon_loss: 2131337.4373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4126792.0732; train_optim_loss: 4126792.0732; val_kl_reg_loss: 29590.0668; val_edge_recon_loss: 1324930.2705; val_cat_covariates_contrastive_loss: 642119.2659; val_gene_expr_recon_loss: 2176862.1396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4173501.7288; val_optim_loss: 4173501.7288
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9659; val_auprc_score: 0.9826; val_best_acc_score: 0.9549; val_best_f1_score: 0.9708; train_kl_reg_loss: 31055.0294; train_edge_recon_loss: 1325247.9080; train_cat_covariates_contrastive_loss: 639783.1977; train_gene_expr_recon_loss: 2124100.8551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4120186.9855; train_optim_loss: 4120186.9855; val_kl_reg_loss: 30870.3699; val_edge_recon_loss: 1326827.3204; val_cat_covariates_contrastive_loss: 640979.1944; val_gene_expr_recon_loss: 2159025.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4157702.8479; val_optim_loss: 4157702.8479
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9647; val_auprc_score: 0.9820; val_best_acc_score: 0.9510; val_best_f1_score: 0.9682; train_kl_reg_loss: 31111.9277; train_edge_recon_loss: 1321383.9816; train_cat_covariates_contrastive_loss: 639608.6147; train_gene_expr_recon_loss: 2122082.8744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4114187.4018; train_optim_loss: 4114187.4018; val_kl_reg_loss: 30906.2245; val_edge_recon_loss: 1331384.2698; val_cat_covariates_contrastive_loss: 642253.9689; val_gene_expr_recon_loss: 2157431.9729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4161976.4537; val_optim_loss: 4161976.4537
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9599; val_auprc_score: 0.9797; val_best_acc_score: 0.9530; val_best_f1_score: 0.9695; train_kl_reg_loss: 31432.5876; train_edge_recon_loss: 1324910.1357; train_cat_covariates_contrastive_loss: 639945.0862; train_gene_expr_recon_loss: 2113020.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4109308.7784; train_optim_loss: 4109308.7784; val_kl_reg_loss: 32516.3302; val_edge_recon_loss: 1341214.6786; val_cat_covariates_contrastive_loss: 638999.1101; val_gene_expr_recon_loss: 2160058.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4172788.9206; val_optim_loss: 4172788.9206
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9619; val_auprc_score: 0.9803; val_best_acc_score: 0.9545; val_best_f1_score: 0.9705; train_kl_reg_loss: 31668.7290; train_edge_recon_loss: 1321346.7881; train_cat_covariates_contrastive_loss: 639915.2569; train_gene_expr_recon_loss: 2124144.0162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4117074.7887; train_optim_loss: 4117074.7887; val_kl_reg_loss: 34231.6467; val_edge_recon_loss: 1330642.7235; val_cat_covariates_contrastive_loss: 638582.6657; val_gene_expr_recon_loss: 2184412.5172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4187869.5569; val_optim_loss: 4187869.5569
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9623; val_auprc_score: 0.9807; val_best_acc_score: 0.9551; val_best_f1_score: 0.9710; train_kl_reg_loss: 32302.6309; train_edge_recon_loss: 1323429.3340; train_cat_covariates_contrastive_loss: 640199.1265; train_gene_expr_recon_loss: 2113130.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4109061.1460; train_optim_loss: 4109061.1460; val_kl_reg_loss: 33359.7783; val_edge_recon_loss: 1325426.2123; val_cat_covariates_contrastive_loss: 638423.0721; val_gene_expr_recon_loss: 2155397.4239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4152606.4947; val_optim_loss: 4152606.4947
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9642; val_auprc_score: 0.9821; val_best_acc_score: 0.9548; val_best_f1_score: 0.9708; train_kl_reg_loss: 32451.7217; train_edge_recon_loss: 1327193.9070; train_cat_covariates_contrastive_loss: 640357.2352; train_gene_expr_recon_loss: 2111109.5961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4111112.4603; train_optim_loss: 4111112.4603; val_kl_reg_loss: 31863.2009; val_edge_recon_loss: 1334267.7427; val_cat_covariates_contrastive_loss: 640487.3760; val_gene_expr_recon_loss: 2176590.2573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4183208.5741; val_optim_loss: 4183208.5741
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9642; val_auprc_score: 0.9817; val_best_acc_score: 0.9529; val_best_f1_score: 0.9694; train_kl_reg_loss: 32484.1358; train_edge_recon_loss: 1326593.6555; train_cat_covariates_contrastive_loss: 640521.2751; train_gene_expr_recon_loss: 2107532.0203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4107131.0871; train_optim_loss: 4107131.0871; val_kl_reg_loss: 32667.1131; val_edge_recon_loss: 1341198.5595; val_cat_covariates_contrastive_loss: 640327.2808; val_gene_expr_recon_loss: 2217940.4735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4232133.4206; val_optim_loss: 4232133.4206
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9643; val_auprc_score: 0.9820; val_best_acc_score: 0.9555; val_best_f1_score: 0.9713; train_kl_reg_loss: 33413.7081; train_edge_recon_loss: 1320386.3339; train_cat_covariates_contrastive_loss: 640563.6437; train_gene_expr_recon_loss: 2128086.9804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4122450.6621; train_optim_loss: 4122450.6621; val_kl_reg_loss: 34901.4784; val_edge_recon_loss: 1325889.1984; val_cat_covariates_contrastive_loss: 640350.6399; val_gene_expr_recon_loss: 2160971.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4162112.5913; val_optim_loss: 4162112.5913
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9639; val_auprc_score: 0.9823; val_best_acc_score: 0.9530; val_best_f1_score: 0.9696; train_kl_reg_loss: 33570.3001; train_edge_recon_loss: 1322009.5864; train_cat_covariates_contrastive_loss: 640724.3049; train_gene_expr_recon_loss: 2106066.7158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4102370.9092; train_optim_loss: 4102370.9092; val_kl_reg_loss: 33724.4671; val_edge_recon_loss: 1326783.0794; val_cat_covariates_contrastive_loss: 642526.6399; val_gene_expr_recon_loss: 2151714.4041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4154748.5820; val_optim_loss: 4154748.5820

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9646; val_auprc_score: 0.9814; val_best_acc_score: 0.9575; val_best_f1_score: 0.9725; train_kl_reg_loss: 33098.0090; train_edge_recon_loss: 1324602.1186; train_cat_covariates_contrastive_loss: 641191.1589; train_gene_expr_recon_loss: 2053209.4857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4052100.7720; train_optim_loss: 4052100.7720; val_kl_reg_loss: 33242.9297; val_edge_recon_loss: 1316325.8089; val_cat_covariates_contrastive_loss: 640860.4134; val_gene_expr_recon_loss: 2113871.3929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104300.5595; val_optim_loss: 4104300.5595
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9619; val_auprc_score: 0.9803; val_best_acc_score: 0.9574; val_best_f1_score: 0.9725; train_kl_reg_loss: 32889.4223; train_edge_recon_loss: 1322430.9069; train_cat_covariates_contrastive_loss: 641077.5117; train_gene_expr_recon_loss: 2040682.6263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4037080.4669; train_optim_loss: 4037080.4669; val_kl_reg_loss: 32819.8669; val_edge_recon_loss: 1321502.4180; val_cat_covariates_contrastive_loss: 641594.7464; val_gene_expr_recon_loss: 2101790.9729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097708.0066; val_optim_loss: 4097708.0066
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9633; val_auprc_score: 0.9813; val_best_acc_score: 0.9574; val_best_f1_score: 0.9724; train_kl_reg_loss: 32842.0196; train_edge_recon_loss: 1319946.9896; train_cat_covariates_contrastive_loss: 641202.7305; train_gene_expr_recon_loss: 2035714.2669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4029706.0063; train_optim_loss: 4029706.0063; val_kl_reg_loss: 32860.0068; val_edge_recon_loss: 1312130.4525; val_cat_covariates_contrastive_loss: 640967.5817; val_gene_expr_recon_loss: 2102537.5741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088495.6071; val_optim_loss: 4088495.6071
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9671; val_auprc_score: 0.9828; val_best_acc_score: 0.9574; val_best_f1_score: 0.9723; train_kl_reg_loss: 32593.9257; train_edge_recon_loss: 1319341.2924; train_cat_covariates_contrastive_loss: 641222.8855; train_gene_expr_recon_loss: 2033601.9163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4026760.0226; train_optim_loss: 4026760.0226; val_kl_reg_loss: 32469.8646; val_edge_recon_loss: 1328225.2169; val_cat_covariates_contrastive_loss: 641298.2057; val_gene_expr_recon_loss: 2096948.7321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098942.0119; val_optim_loss: 4098942.0119
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9638; val_auprc_score: 0.9814; val_best_acc_score: 0.9574; val_best_f1_score: 0.9724; train_kl_reg_loss: 32445.2498; train_edge_recon_loss: 1321428.6786; train_cat_covariates_contrastive_loss: 640835.3452; train_gene_expr_recon_loss: 2029258.6486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4023967.9164; train_optim_loss: 4023967.9164; val_kl_reg_loss: 32597.4175; val_edge_recon_loss: 1323709.3545; val_cat_covariates_contrastive_loss: 639994.4805; val_gene_expr_recon_loss: 2097441.0079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093742.2526; val_optim_loss: 4093742.2526
