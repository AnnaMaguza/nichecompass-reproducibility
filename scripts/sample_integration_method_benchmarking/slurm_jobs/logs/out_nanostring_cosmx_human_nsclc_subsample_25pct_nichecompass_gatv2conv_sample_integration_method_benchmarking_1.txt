Run timestamp: 03092023_114057_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 573937
Number of validation edges: 63770
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9402; val_auprc_score: 0.9744; val_best_acc_score: 0.9195; val_best_f1_score: 0.9488; train_kl_reg_loss: 14987.9843; train_edge_recon_loss: 1388345.1709; train_cat_covariates_contrastive_loss: 633811.5783; train_gene_expr_recon_loss: 3012369.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5049514.2852; train_optim_loss: 5049514.2852; val_kl_reg_loss: 12982.0696; val_edge_recon_loss: 1356816.1295; val_cat_covariates_contrastive_loss: 632273.4190; val_gene_expr_recon_loss: 2776283.0160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4778354.6160; val_optim_loss: 4778354.6160
Run timestamp: 03092023_115037_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '256', '256', '256', '256', '256', '256', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 573937
Number of validation edges: 63770
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9433; val_auprc_score: 0.9753; val_best_acc_score: 0.9250; val_best_f1_score: 0.9521; train_kl_reg_loss: 13182.1758; train_edge_recon_loss: 1383854.6718; train_cat_covariates_contrastive_loss: 634354.1260; train_gene_expr_recon_loss: 3001742.7216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5033133.6928; train_optim_loss: 5033133.6928; val_kl_reg_loss: 13141.0492; val_edge_recon_loss: 1352716.0730; val_cat_covariates_contrastive_loss: 630659.2065; val_gene_expr_recon_loss: 2774943.5340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4771459.8700; val_optim_loss: 4771459.8700
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9572; val_auprc_score: 0.9802; val_best_acc_score: 0.9446; val_best_f1_score: 0.9643; train_kl_reg_loss: 13934.5684; train_edge_recon_loss: 1336402.8542; train_cat_covariates_contrastive_loss: 634133.4398; train_gene_expr_recon_loss: 2663011.0242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4647481.8869; train_optim_loss: 4647481.8869; val_kl_reg_loss: 17056.9394; val_edge_recon_loss: 1332713.7810; val_cat_covariates_contrastive_loss: 633261.6948; val_gene_expr_recon_loss: 2528045.8390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4511078.2570; val_optim_loss: 4511078.2570
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9618; val_auprc_score: 0.9815; val_best_acc_score: 0.9483; val_best_f1_score: 0.9665; train_kl_reg_loss: 18437.1093; train_edge_recon_loss: 1332278.3559; train_cat_covariates_contrastive_loss: 636126.7185; train_gene_expr_recon_loss: 2465963.1062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4452805.2907; train_optim_loss: 4452805.2907; val_kl_reg_loss: 20234.0336; val_edge_recon_loss: 1339129.5930; val_cat_covariates_contrastive_loss: 637420.6353; val_gene_expr_recon_loss: 2391297.1095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4388081.3570; val_optim_loss: 4388081.3570
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9642; val_auprc_score: 0.9823; val_best_acc_score: 0.9519; val_best_f1_score: 0.9689; train_kl_reg_loss: 21417.9819; train_edge_recon_loss: 1328103.4112; train_cat_covariates_contrastive_loss: 636805.5024; train_gene_expr_recon_loss: 2364353.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4350680.0668; train_optim_loss: 4350680.0668; val_kl_reg_loss: 21842.6257; val_edge_recon_loss: 1330356.7270; val_cat_covariates_contrastive_loss: 637799.6183; val_gene_expr_recon_loss: 2336311.2830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4326310.2520; val_optim_loss: 4326310.2520
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9658; val_auprc_score: 0.9832; val_best_acc_score: 0.9508; val_best_f1_score: 0.9681; train_kl_reg_loss: 23480.8257; train_edge_recon_loss: 1326120.1412; train_cat_covariates_contrastive_loss: 637417.5341; train_gene_expr_recon_loss: 2313773.3311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4300791.8329; train_optim_loss: 4300791.8329; val_kl_reg_loss: 23271.6500; val_edge_recon_loss: 1333730.6927; val_cat_covariates_contrastive_loss: 638135.4655; val_gene_expr_recon_loss: 2292737.3410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4287875.1570; val_optim_loss: 4287875.1570
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9620; val_auprc_score: 0.9810; val_best_acc_score: 0.9496; val_best_f1_score: 0.9674; train_kl_reg_loss: 25084.1679; train_edge_recon_loss: 1328499.8084; train_cat_covariates_contrastive_loss: 637958.8474; train_gene_expr_recon_loss: 2276310.2985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4267853.1210; train_optim_loss: 4267853.1210; val_kl_reg_loss: 25254.4085; val_edge_recon_loss: 1344611.8495; val_cat_covariates_contrastive_loss: 638893.4642; val_gene_expr_recon_loss: 2253077.1475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4261836.8620; val_optim_loss: 4261836.8620
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9665; val_auprc_score: 0.9836; val_best_acc_score: 0.9511; val_best_f1_score: 0.9685; train_kl_reg_loss: 26461.8876; train_edge_recon_loss: 1326677.7947; train_cat_covariates_contrastive_loss: 638383.3063; train_gene_expr_recon_loss: 2248450.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4239973.0103; train_optim_loss: 4239973.0103; val_kl_reg_loss: 25196.7473; val_edge_recon_loss: 1322388.6025; val_cat_covariates_contrastive_loss: 640860.9135; val_gene_expr_recon_loss: 2251779.0155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4240225.3020; val_optim_loss: 4240225.3020
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9589; val_auprc_score: 0.9796; val_best_acc_score: 0.9519; val_best_f1_score: 0.9690; train_kl_reg_loss: 27327.7212; train_edge_recon_loss: 1324892.1257; train_cat_covariates_contrastive_loss: 638670.8084; train_gene_expr_recon_loss: 2233898.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4224789.3945; train_optim_loss: 4224789.3945; val_kl_reg_loss: 28456.6450; val_edge_recon_loss: 1318386.1523; val_cat_covariates_contrastive_loss: 637267.2535; val_gene_expr_recon_loss: 2231785.8610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4215895.9180; val_optim_loss: 4215895.9180
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9625; val_auprc_score: 0.9817; val_best_acc_score: 0.9518; val_best_f1_score: 0.9689; train_kl_reg_loss: 28429.4413; train_edge_recon_loss: 1326390.0670; train_cat_covariates_contrastive_loss: 638907.3469; train_gene_expr_recon_loss: 2215371.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4209097.9682; train_optim_loss: 4209097.9682; val_kl_reg_loss: 29194.3558; val_edge_recon_loss: 1328116.1650; val_cat_covariates_contrastive_loss: 638136.5752; val_gene_expr_recon_loss: 2236804.5815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4232251.6750; val_optim_loss: 4232251.6750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9580; val_auprc_score: 0.9787; val_best_acc_score: 0.9534; val_best_f1_score: 0.9699; train_kl_reg_loss: 29332.5560; train_edge_recon_loss: 1321496.1726; train_cat_covariates_contrastive_loss: 639303.2046; train_gene_expr_recon_loss: 2209157.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4199289.0479; train_optim_loss: 4199289.0479; val_kl_reg_loss: 30228.5587; val_edge_recon_loss: 1322003.3260; val_cat_covariates_contrastive_loss: 637455.3280; val_gene_expr_recon_loss: 2218003.2115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4207690.4310; val_optim_loss: 4207690.4310
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9665; val_auprc_score: 0.9830; val_best_acc_score: 0.9530; val_best_f1_score: 0.9695; train_kl_reg_loss: 30367.6272; train_edge_recon_loss: 1325262.3703; train_cat_covariates_contrastive_loss: 639501.1582; train_gene_expr_recon_loss: 2195543.2544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4190674.4150; train_optim_loss: 4190674.4150; val_kl_reg_loss: 28854.3644; val_edge_recon_loss: 1329387.0870; val_cat_covariates_contrastive_loss: 642481.4165; val_gene_expr_recon_loss: 2202866.7170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4203589.5850; val_optim_loss: 4203589.5850
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9673; val_auprc_score: 0.9839; val_best_acc_score: 0.9552; val_best_f1_score: 0.9710; train_kl_reg_loss: 30789.7991; train_edge_recon_loss: 1325509.8758; train_cat_covariates_contrastive_loss: 639923.2843; train_gene_expr_recon_loss: 2191624.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4187847.8347; train_optim_loss: 4187847.8347; val_kl_reg_loss: 30502.4081; val_edge_recon_loss: 1328283.4575; val_cat_covariates_contrastive_loss: 642648.5707; val_gene_expr_recon_loss: 2237711.1825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4239145.6140; val_optim_loss: 4239145.6140
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9645; val_auprc_score: 0.9823; val_best_acc_score: 0.9544; val_best_f1_score: 0.9705; train_kl_reg_loss: 31651.8383; train_edge_recon_loss: 1323240.0678; train_cat_covariates_contrastive_loss: 640267.0970; train_gene_expr_recon_loss: 2178057.7849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4173216.7911; train_optim_loss: 4173216.7911; val_kl_reg_loss: 31900.4357; val_edge_recon_loss: 1336955.9580; val_cat_covariates_contrastive_loss: 639925.5770; val_gene_expr_recon_loss: 2180275.3220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4189057.2940; val_optim_loss: 4189057.2940
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9635; val_auprc_score: 0.9813; val_best_acc_score: 0.9558; val_best_f1_score: 0.9714; train_kl_reg_loss: 32176.2949; train_edge_recon_loss: 1325610.3979; train_cat_covariates_contrastive_loss: 640285.2555; train_gene_expr_recon_loss: 2175242.0124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4173313.9638; train_optim_loss: 4173313.9638; val_kl_reg_loss: 31753.9147; val_edge_recon_loss: 1328363.8353; val_cat_covariates_contrastive_loss: 640122.4788; val_gene_expr_recon_loss: 2175919.2220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4176159.4510; val_optim_loss: 4176159.4510
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9651; val_auprc_score: 0.9823; val_best_acc_score: 0.9544; val_best_f1_score: 0.9705; train_kl_reg_loss: 32411.8871; train_edge_recon_loss: 1325530.9316; train_cat_covariates_contrastive_loss: 640419.3469; train_gene_expr_recon_loss: 2182479.9571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4180842.1263; train_optim_loss: 4180842.1263; val_kl_reg_loss: 33451.6020; val_edge_recon_loss: 1330983.3415; val_cat_covariates_contrastive_loss: 640709.8010; val_gene_expr_recon_loss: 2190701.5225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4195846.2790; val_optim_loss: 4195846.2790
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9614; val_auprc_score: 0.9805; val_best_acc_score: 0.9524; val_best_f1_score: 0.9691; train_kl_reg_loss: 33332.6859; train_edge_recon_loss: 1327414.3651; train_cat_covariates_contrastive_loss: 640820.8483; train_gene_expr_recon_loss: 2165720.4172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4167288.3196; train_optim_loss: 4167288.3196; val_kl_reg_loss: 32566.6712; val_edge_recon_loss: 1333247.8475; val_cat_covariates_contrastive_loss: 640791.1880; val_gene_expr_recon_loss: 2193466.5550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4200072.2500; val_optim_loss: 4200072.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9660; val_auprc_score: 0.9829; val_best_acc_score: 0.9551; val_best_f1_score: 0.9709; train_kl_reg_loss: 33564.9678; train_edge_recon_loss: 1327757.4410; train_cat_covariates_contrastive_loss: 640706.0236; train_gene_expr_recon_loss: 2165378.1968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4167406.6282; train_optim_loss: 4167406.6282; val_kl_reg_loss: 34360.6180; val_edge_recon_loss: 1322867.7393; val_cat_covariates_contrastive_loss: 641138.8850; val_gene_expr_recon_loss: 2174432.6155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4172799.8660; val_optim_loss: 4172799.8660
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9646; val_auprc_score: 0.9823; val_best_acc_score: 0.9546; val_best_f1_score: 0.9706; train_kl_reg_loss: 34799.6164; train_edge_recon_loss: 1324594.4143; train_cat_covariates_contrastive_loss: 641226.8561; train_gene_expr_recon_loss: 2168500.3133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4169121.2009; train_optim_loss: 4169121.2009; val_kl_reg_loss: 34560.8942; val_edge_recon_loss: 1324775.2690; val_cat_covariates_contrastive_loss: 641848.7893; val_gene_expr_recon_loss: 2179558.2420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4180743.1920; val_optim_loss: 4180743.1920
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9626; val_auprc_score: 0.9812; val_best_acc_score: 0.9543; val_best_f1_score: 0.9704; train_kl_reg_loss: 34856.1518; train_edge_recon_loss: 1324175.4296; train_cat_covariates_contrastive_loss: 641383.9248; train_gene_expr_recon_loss: 2167976.0619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4168391.5668; train_optim_loss: 4168391.5668; val_kl_reg_loss: 34261.7121; val_edge_recon_loss: 1324513.8060; val_cat_covariates_contrastive_loss: 640306.6585; val_gene_expr_recon_loss: 2202214.5770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4201296.7550; val_optim_loss: 4201296.7550
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9610; val_auprc_score: 0.9802; val_best_acc_score: 0.9550; val_best_f1_score: 0.9709; train_kl_reg_loss: 35171.4822; train_edge_recon_loss: 1327184.5786; train_cat_covariates_contrastive_loss: 641550.6800; train_gene_expr_recon_loss: 2157526.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4161433.7029; train_optim_loss: 4161433.7029; val_kl_reg_loss: 36792.0927; val_edge_recon_loss: 1319524.3345; val_cat_covariates_contrastive_loss: 639745.7218; val_gene_expr_recon_loss: 2167017.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4163079.2540; val_optim_loss: 4163079.2540
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9638; val_auprc_score: 0.9815; val_best_acc_score: 0.9556; val_best_f1_score: 0.9713; train_kl_reg_loss: 36573.5122; train_edge_recon_loss: 1328177.7007; train_cat_covariates_contrastive_loss: 641313.3489; train_gene_expr_recon_loss: 2169891.3199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4175955.8811; train_optim_loss: 4175955.8811; val_kl_reg_loss: 38552.5416; val_edge_recon_loss: 1321056.0505; val_cat_covariates_contrastive_loss: 640256.3285; val_gene_expr_recon_loss: 2171296.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4171161.8280; val_optim_loss: 4171161.8280
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9662; val_auprc_score: 0.9828; val_best_acc_score: 0.9547; val_best_f1_score: 0.9706; train_kl_reg_loss: 39885.7117; train_edge_recon_loss: 1327443.0907; train_cat_covariates_contrastive_loss: 642150.7749; train_gene_expr_recon_loss: 2184930.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4194410.4202; train_optim_loss: 4194410.4202; val_kl_reg_loss: 38336.1058; val_edge_recon_loss: 1331233.6810; val_cat_covariates_contrastive_loss: 642890.0290; val_gene_expr_recon_loss: 2184124.8825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4196584.7180; val_optim_loss: 4196584.7180
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9677; val_auprc_score: 0.9834; val_best_acc_score: 0.9574; val_best_f1_score: 0.9723; train_kl_reg_loss: 40111.3422; train_edge_recon_loss: 1327120.3799; train_cat_covariates_contrastive_loss: 642421.6431; train_gene_expr_recon_loss: 2163101.0398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4172754.4088; train_optim_loss: 4172754.4088; val_kl_reg_loss: 39094.8650; val_edge_recon_loss: 1332850.3270; val_cat_covariates_contrastive_loss: 644567.9513; val_gene_expr_recon_loss: 2169030.9365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4185544.0700; val_optim_loss: 4185544.0700
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9654; val_auprc_score: 0.9819; val_best_acc_score: 0.9579; val_best_f1_score: 0.9727; train_kl_reg_loss: 43859.6662; train_edge_recon_loss: 1327982.4803; train_cat_covariates_contrastive_loss: 642631.9731; train_gene_expr_recon_loss: 2208808.8664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4223282.9873; train_optim_loss: 4223282.9873; val_kl_reg_loss: 42674.9882; val_edge_recon_loss: 1328562.5488; val_cat_covariates_contrastive_loss: 641954.3800; val_gene_expr_recon_loss: 2194675.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4207867.5830; val_optim_loss: 4207867.5830

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9656; val_auprc_score: 0.9824; val_best_acc_score: 0.9575; val_best_f1_score: 0.9725; train_kl_reg_loss: 43532.9461; train_edge_recon_loss: 1321716.2312; train_cat_covariates_contrastive_loss: 643190.3311; train_gene_expr_recon_loss: 2124831.5620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4133271.0621; train_optim_loss: 4133271.0621; val_kl_reg_loss: 43328.3329; val_edge_recon_loss: 1334022.2035; val_cat_covariates_contrastive_loss: 643737.0610; val_gene_expr_recon_loss: 2141185.5145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4162273.1150; val_optim_loss: 4162273.1150
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9652; val_auprc_score: 0.9821; val_best_acc_score: 0.9577; val_best_f1_score: 0.9726; train_kl_reg_loss: 43360.3946; train_edge_recon_loss: 1319973.5987; train_cat_covariates_contrastive_loss: 643440.4021; train_gene_expr_recon_loss: 2104447.8085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4111222.2063; train_optim_loss: 4111222.2063; val_kl_reg_loss: 43035.1197; val_edge_recon_loss: 1323541.8345; val_cat_covariates_contrastive_loss: 643072.6983; val_gene_expr_recon_loss: 2132474.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4142123.6990; val_optim_loss: 4142123.6990
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9647; val_auprc_score: 0.9820; val_best_acc_score: 0.9572; val_best_f1_score: 0.9723; train_kl_reg_loss: 42455.3286; train_edge_recon_loss: 1322593.5877; train_cat_covariates_contrastive_loss: 643506.6796; train_gene_expr_recon_loss: 2091530.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4100085.8482; train_optim_loss: 4100085.8482; val_kl_reg_loss: 41956.6606; val_edge_recon_loss: 1317189.6545; val_cat_covariates_contrastive_loss: 643176.9750; val_gene_expr_recon_loss: 2123375.7275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4125699.0230; val_optim_loss: 4125699.0230
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9646; val_auprc_score: 0.9814; val_best_acc_score: 0.9572; val_best_f1_score: 0.9722; train_kl_reg_loss: 41888.2517; train_edge_recon_loss: 1318556.6279; train_cat_covariates_contrastive_loss: 643445.3275; train_gene_expr_recon_loss: 2086258.1309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4090148.3418; train_optim_loss: 4090148.3418; val_kl_reg_loss: 41508.1812; val_edge_recon_loss: 1325494.3583; val_cat_covariates_contrastive_loss: 643586.7820; val_gene_expr_recon_loss: 2119835.8615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4130425.1830; val_optim_loss: 4130425.1830
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9668; val_auprc_score: 0.9826; val_best_acc_score: 0.9592; val_best_f1_score: 0.9735; train_kl_reg_loss: 41491.6729; train_edge_recon_loss: 1320670.7700; train_cat_covariates_contrastive_loss: 643617.9433; train_gene_expr_recon_loss: 2079926.5164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4085706.9013; train_optim_loss: 4085706.9013; val_kl_reg_loss: 41129.4689; val_edge_recon_loss: 1326530.7870; val_cat_covariates_contrastive_loss: 643609.8745; val_gene_expr_recon_loss: 2115355.0830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4126625.2170; val_optim_loss: 4126625.2170
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9648; val_auprc_score: 0.9818; val_best_acc_score: 0.9576; val_best_f1_score: 0.9725; train_kl_reg_loss: 41031.3554; train_edge_recon_loss: 1320906.9004; train_cat_covariates_contrastive_loss: 643363.0188; train_gene_expr_recon_loss: 2075044.6854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4080345.9612; train_optim_loss: 4080345.9612; val_kl_reg_loss: 40414.5535; val_edge_recon_loss: 1322014.3232; val_cat_covariates_contrastive_loss: 643341.0613; val_gene_expr_recon_loss: 2112296.6465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4118066.5740; val_optim_loss: 4118066.5740
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9679; val_auprc_score: 0.9830; val_best_acc_score: 0.9593; val_best_f1_score: 0.9736; train_kl_reg_loss: 40707.9264; train_edge_recon_loss: 1319369.6551; train_cat_covariates_contrastive_loss: 643214.0263; train_gene_expr_recon_loss: 2069803.1413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4073094.7496; train_optim_loss: 4073094.7496; val_kl_reg_loss: 39600.3254; val_edge_recon_loss: 1328281.8300; val_cat_covariates_contrastive_loss: 644747.0175; val_gene_expr_recon_loss: 2109546.0445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4122175.2240; val_optim_loss: 4122175.2240
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9668; val_auprc_score: 0.9830; val_best_acc_score: 0.9591; val_best_f1_score: 0.9736; train_kl_reg_loss: 40443.0916; train_edge_recon_loss: 1323762.8196; train_cat_covariates_contrastive_loss: 643451.3331; train_gene_expr_recon_loss: 2068126.9957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4075784.2428; train_optim_loss: 4075784.2428; val_kl_reg_loss: 39955.2195; val_edge_recon_loss: 1312360.0815; val_cat_covariates_contrastive_loss: 644938.0980; val_gene_expr_recon_loss: 2109170.1820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4106423.5650; val_optim_loss: 4106423.5650
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9663; val_auprc_score: 0.9826; val_best_acc_score: 0.9586; val_best_f1_score: 0.9733; train_kl_reg_loss: 40157.8703; train_edge_recon_loss: 1321590.8449; train_cat_covariates_contrastive_loss: 643201.0051; train_gene_expr_recon_loss: 2064217.2288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4069166.9542; train_optim_loss: 4069166.9542; val_kl_reg_loss: 39184.5392; val_edge_recon_loss: 1315536.1330; val_cat_covariates_contrastive_loss: 644141.9030; val_gene_expr_recon_loss: 2108261.8845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4107124.4610; val_optim_loss: 4107124.4610
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9649; val_auprc_score: 0.9820; val_best_acc_score: 0.9565; val_best_f1_score: 0.9719; train_kl_reg_loss: 39695.7760; train_edge_recon_loss: 1323609.8644; train_cat_covariates_contrastive_loss: 643070.6854; train_gene_expr_recon_loss: 2061365.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4067741.8905; train_optim_loss: 4067741.8905; val_kl_reg_loss: 38799.7574; val_edge_recon_loss: 1327455.9615; val_cat_covariates_contrastive_loss: 643686.9313; val_gene_expr_recon_loss: 2101630.2280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4111572.8850; val_optim_loss: 4111572.8850
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9634; val_auprc_score: 0.9812; val_best_acc_score: 0.9580; val_best_f1_score: 0.9729; train_kl_reg_loss: 39415.3574; train_edge_recon_loss: 1323415.8591; train_cat_covariates_contrastive_loss: 642838.2968; train_gene_expr_recon_loss: 2058774.7595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4064444.2745; train_optim_loss: 4064444.2745; val_kl_reg_loss: 38959.8291; val_edge_recon_loss: 1319549.7755; val_cat_covariates_contrastive_loss: 641694.4740; val_gene_expr_recon_loss: 2099252.6260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4099456.6950; val_optim_loss: 4099456.6950
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9635; val_auprc_score: 0.9802; val_best_acc_score: 0.9580; val_best_f1_score: 0.9727; train_kl_reg_loss: 39069.4869; train_edge_recon_loss: 1320083.4970; train_cat_covariates_contrastive_loss: 642886.8304; train_gene_expr_recon_loss: 2056487.4140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4058527.2323; train_optim_loss: 4058527.2323; val_kl_reg_loss: 39179.8532; val_edge_recon_loss: 1344215.0850; val_cat_covariates_contrastive_loss: 641395.3363; val_gene_expr_recon_loss: 2099397.7695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4124188.0420; val_optim_loss: 4124188.0420
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9667; val_auprc_score: 0.9825; val_best_acc_score: 0.9589; val_best_f1_score: 0.9733; train_kl_reg_loss: 38652.8741; train_edge_recon_loss: 1319445.7433; train_cat_covariates_contrastive_loss: 642754.2006; train_gene_expr_recon_loss: 2055839.0092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4056691.8317; train_optim_loss: 4056691.8317; val_kl_reg_loss: 38089.7878; val_edge_recon_loss: 1327500.7825; val_cat_covariates_contrastive_loss: 642973.9570; val_gene_expr_recon_loss: 2096225.6475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104790.1760; val_optim_loss: 4104790.1760
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9656; val_auprc_score: 0.9820; val_best_acc_score: 0.9584; val_best_f1_score: 0.9731; train_kl_reg_loss: 38366.5389; train_edge_recon_loss: 1323751.8988; train_cat_covariates_contrastive_loss: 642503.4413; train_gene_expr_recon_loss: 2053355.7027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4057977.5814; train_optim_loss: 4057977.5814; val_kl_reg_loss: 38274.5553; val_edge_recon_loss: 1312460.7312; val_cat_covariates_contrastive_loss: 642904.1720; val_gene_expr_recon_loss: 2095410.2785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4089049.7340; val_optim_loss: 4089049.7340
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9647; val_auprc_score: 0.9813; val_best_acc_score: 0.9591; val_best_f1_score: 0.9735; train_kl_reg_loss: 38163.7703; train_edge_recon_loss: 1321186.4576; train_cat_covariates_contrastive_loss: 642871.9483; train_gene_expr_recon_loss: 2051039.7713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4053261.9477; train_optim_loss: 4053261.9477; val_kl_reg_loss: 38159.5733; val_edge_recon_loss: 1323764.5888; val_cat_covariates_contrastive_loss: 642327.9152; val_gene_expr_recon_loss: 2097399.8875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101651.9640; val_optim_loss: 4101651.9640
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9672; val_auprc_score: 0.9826; val_best_acc_score: 0.9589; val_best_f1_score: 0.9732; train_kl_reg_loss: 37864.8878; train_edge_recon_loss: 1322569.4041; train_cat_covariates_contrastive_loss: 642575.1948; train_gene_expr_recon_loss: 2049392.6409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4052402.1269; train_optim_loss: 4052402.1269; val_kl_reg_loss: 37674.1869; val_edge_recon_loss: 1326717.8455; val_cat_covariates_contrastive_loss: 641955.6945; val_gene_expr_recon_loss: 2094234.6930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4100582.4190; val_optim_loss: 4100582.4190
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9649; val_auprc_score: 0.9814; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 37543.0458; train_edge_recon_loss: 1320551.9046; train_cat_covariates_contrastive_loss: 642300.2838; train_gene_expr_recon_loss: 2048598.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4048993.4619; train_optim_loss: 4048993.4619; val_kl_reg_loss: 37014.3836; val_edge_recon_loss: 1328689.9175; val_cat_covariates_contrastive_loss: 641835.3715; val_gene_expr_recon_loss: 2095647.0785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4103186.7530; val_optim_loss: 4103186.7530
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9669; val_auprc_score: 0.9825; val_best_acc_score: 0.9589; val_best_f1_score: 0.9733; train_kl_reg_loss: 37220.7725; train_edge_recon_loss: 1321768.1821; train_cat_covariates_contrastive_loss: 642274.4502; train_gene_expr_recon_loss: 2046707.6264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4047971.0307; train_optim_loss: 4047971.0307; val_kl_reg_loss: 37879.4810; val_edge_recon_loss: 1330091.6800; val_cat_covariates_contrastive_loss: 641430.1262; val_gene_expr_recon_loss: 2094253.1210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4103654.4090; val_optim_loss: 4103654.4090

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9661; val_auprc_score: 0.9821; val_best_acc_score: 0.9594; val_best_f1_score: 0.9736; train_kl_reg_loss: 37063.8710; train_edge_recon_loss: 1318905.0041; train_cat_covariates_contrastive_loss: 642374.8144; train_gene_expr_recon_loss: 2038848.9828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4037192.6712; train_optim_loss: 4037192.6712; val_kl_reg_loss: 37006.5110; val_edge_recon_loss: 1329071.0100; val_cat_covariates_contrastive_loss: 642610.4995; val_gene_expr_recon_loss: 2089906.4780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098594.5000; val_optim_loss: 4098594.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9657; val_auprc_score: 0.9821; val_best_acc_score: 0.9583; val_best_f1_score: 0.9730; train_kl_reg_loss: 37000.7153; train_edge_recon_loss: 1322444.0196; train_cat_covariates_contrastive_loss: 642429.9636; train_gene_expr_recon_loss: 2038332.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4040207.4357; train_optim_loss: 4040207.4357; val_kl_reg_loss: 36965.5772; val_edge_recon_loss: 1327241.2900; val_cat_covariates_contrastive_loss: 641903.9147; val_gene_expr_recon_loss: 2089444.9925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095555.7810; val_optim_loss: 4095555.7810
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9674; val_auprc_score: 0.9832; val_best_acc_score: 0.9588; val_best_f1_score: 0.9733; train_kl_reg_loss: 37049.3529; train_edge_recon_loss: 1319036.7322; train_cat_covariates_contrastive_loss: 642302.8724; train_gene_expr_recon_loss: 2038088.2084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4036477.1674; train_optim_loss: 4036477.1674; val_kl_reg_loss: 36774.0347; val_edge_recon_loss: 1317678.4370; val_cat_covariates_contrastive_loss: 643022.3960; val_gene_expr_recon_loss: 2089393.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086868.0720; val_optim_loss: 4086868.0720
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9656; val_auprc_score: 0.9818; val_best_acc_score: 0.9591; val_best_f1_score: 0.9735; train_kl_reg_loss: 36938.4636; train_edge_recon_loss: 1320030.4856; train_cat_covariates_contrastive_loss: 642380.1438; train_gene_expr_recon_loss: 2037412.6347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4036761.7270; train_optim_loss: 4036761.7270; val_kl_reg_loss: 36802.7963; val_edge_recon_loss: 1318326.7455; val_cat_covariates_contrastive_loss: 641847.2515; val_gene_expr_recon_loss: 2089736.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086712.9820; val_optim_loss: 4086712.9820
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9645; val_auprc_score: 0.9809; val_best_acc_score: 0.9579; val_best_f1_score: 0.9727; train_kl_reg_loss: 36849.7425; train_edge_recon_loss: 1316265.9602; train_cat_covariates_contrastive_loss: 642272.3525; train_gene_expr_recon_loss: 2038314.2059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4033702.2622; train_optim_loss: 4033702.2622; val_kl_reg_loss: 36742.1476; val_edge_recon_loss: 1321786.5840; val_cat_covariates_contrastive_loss: 641803.5367; val_gene_expr_recon_loss: 2089958.2270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090290.5010; val_optim_loss: 4090290.5010
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9671; val_auprc_score: 0.9824; val_best_acc_score: 0.9587; val_best_f1_score: 0.9732; train_kl_reg_loss: 36781.3056; train_edge_recon_loss: 1316035.1873; train_cat_covariates_contrastive_loss: 642056.7148; train_gene_expr_recon_loss: 2037180.5837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032053.7919; train_optim_loss: 4032053.7919; val_kl_reg_loss: 36957.9874; val_edge_recon_loss: 1328150.0470; val_cat_covariates_contrastive_loss: 642254.9245; val_gene_expr_recon_loss: 2089765.6770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4097128.6310; val_optim_loss: 4097128.6310
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9678; val_auprc_score: 0.9830; val_best_acc_score: 0.9594; val_best_f1_score: 0.9736; train_kl_reg_loss: 36798.3660; train_edge_recon_loss: 1316919.9597; train_cat_covariates_contrastive_loss: 642445.6226; train_gene_expr_recon_loss: 2036647.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032811.7740; train_optim_loss: 4032811.7740; val_kl_reg_loss: 36582.7503; val_edge_recon_loss: 1324492.1620; val_cat_covariates_contrastive_loss: 642322.4613; val_gene_expr_recon_loss: 2092717.4530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4096114.8210; val_optim_loss: 4096114.8210
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9650; val_auprc_score: 0.9816; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 36740.0102; train_edge_recon_loss: 1317212.4687; train_cat_covariates_contrastive_loss: 642220.7950; train_gene_expr_recon_loss: 2037013.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4033187.1919; train_optim_loss: 4033187.1919; val_kl_reg_loss: 36685.0343; val_edge_recon_loss: 1325707.0158; val_cat_covariates_contrastive_loss: 641748.2797; val_gene_expr_recon_loss: 2090336.3050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4094476.6290; val_optim_loss: 4094476.6290

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9674; val_auprc_score: 0.9832; val_best_acc_score: 0.9589; val_best_f1_score: 0.9734; train_kl_reg_loss: 36771.6711; train_edge_recon_loss: 1317139.6407; train_cat_covariates_contrastive_loss: 642231.0747; train_gene_expr_recon_loss: 2036178.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032320.8266; train_optim_loss: 4032320.8266; val_kl_reg_loss: 36620.8809; val_edge_recon_loss: 1322480.5070; val_cat_covariates_contrastive_loss: 642623.5080; val_gene_expr_recon_loss: 2089075.5470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090800.4360; val_optim_loss: 4090800.4360
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9644; val_auprc_score: 0.9811; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 36667.9984; train_edge_recon_loss: 1321697.0931; train_cat_covariates_contrastive_loss: 642179.1317; train_gene_expr_recon_loss: 2035833.7669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4036377.9903; train_optim_loss: 4036377.9903; val_kl_reg_loss: 36578.5975; val_edge_recon_loss: 1323430.3383; val_cat_covariates_contrastive_loss: 642225.6262; val_gene_expr_recon_loss: 2088508.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090742.9610; val_optim_loss: 4090742.9610
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9654; val_auprc_score: 0.9818; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 36642.1018; train_edge_recon_loss: 1320928.0141; train_cat_covariates_contrastive_loss: 642051.6904; train_gene_expr_recon_loss: 2035848.5319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4035470.3381; train_optim_loss: 4035470.3381; val_kl_reg_loss: 36463.7813; val_edge_recon_loss: 1330384.6083; val_cat_covariates_contrastive_loss: 642431.4468; val_gene_expr_recon_loss: 2089068.9175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098348.7550; val_optim_loss: 4098348.7550
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9653; val_auprc_score: 0.9818; val_best_acc_score: 0.9582; val_best_f1_score: 0.9730; train_kl_reg_loss: 36650.0830; train_edge_recon_loss: 1317921.3408; train_cat_covariates_contrastive_loss: 642203.0996; train_gene_expr_recon_loss: 2035757.5023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4032532.0275; train_optim_loss: 4032532.0275; val_kl_reg_loss: 36576.5674; val_edge_recon_loss: 1322816.1490; val_cat_covariates_contrastive_loss: 642638.8315; val_gene_expr_recon_loss: 2089478.6335; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4091510.1790; val_optim_loss: 4091510.1790

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 895 min 37 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9276
val AUPRC score: 0.9538
val best accuracy score: 0.9461
val best F1 score: 0.9648
val target rna MSE score: 1.1088
val source rna MSE score: 0.0724
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.0781
Duration of model training in run 8: 15 hours, 0 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 573937
Number of validation edges: 63770
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9487; val_auprc_score: 0.9784; val_best_acc_score: 0.9281; val_best_f1_score: 0.9541; train_kl_reg_loss: 13061.7890; train_edge_recon_loss: 1388441.3060; train_cat_covariates_contrastive_loss: 633299.9573; train_gene_expr_recon_loss: 3021684.1194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5056487.1740; train_optim_loss: 5056487.1740; val_kl_reg_loss: 10513.9596; val_edge_recon_loss: 1344339.5330; val_cat_covariates_contrastive_loss: 631653.5270; val_gene_expr_recon_loss: 2804520.3650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4791027.3540; val_optim_loss: 4791027.3540
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9607; val_auprc_score: 0.9819; val_best_acc_score: 0.9450; val_best_f1_score: 0.9646; train_kl_reg_loss: 12418.5976; train_edge_recon_loss: 1333394.3074; train_cat_covariates_contrastive_loss: 633529.7689; train_gene_expr_recon_loss: 2702389.4994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4681732.1758; train_optim_loss: 4681732.1758; val_kl_reg_loss: 14656.1126; val_edge_recon_loss: 1328949.4815; val_cat_covariates_contrastive_loss: 635112.8453; val_gene_expr_recon_loss: 2577045.4720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4555763.9080; val_optim_loss: 4555763.9080
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9646; val_auprc_score: 0.9829; val_best_acc_score: 0.9493; val_best_f1_score: 0.9673; train_kl_reg_loss: 17572.7536; train_edge_recon_loss: 1326720.7489; train_cat_covariates_contrastive_loss: 635587.3789; train_gene_expr_recon_loss: 2483036.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4462917.3870; train_optim_loss: 4462917.3870; val_kl_reg_loss: 19228.6269; val_edge_recon_loss: 1340486.3460; val_cat_covariates_contrastive_loss: 637117.1508; val_gene_expr_recon_loss: 2408412.3615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4405244.4910; val_optim_loss: 4405244.4910
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9627; val_auprc_score: 0.9815; val_best_acc_score: 0.9508; val_best_f1_score: 0.9682; train_kl_reg_loss: 20802.3376; train_edge_recon_loss: 1331371.0666; train_cat_covariates_contrastive_loss: 636730.3489; train_gene_expr_recon_loss: 2368667.5521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4357571.3036; train_optim_loss: 4357571.3036; val_kl_reg_loss: 22290.2432; val_edge_recon_loss: 1334410.0005; val_cat_covariates_contrastive_loss: 636889.8222; val_gene_expr_recon_loss: 2339829.6025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4333419.6630; val_optim_loss: 4333419.6630
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9605; val_auprc_score: 0.9797; val_best_acc_score: 0.9512; val_best_f1_score: 0.9683; train_kl_reg_loss: 23060.8030; train_edge_recon_loss: 1327601.9528; train_cat_covariates_contrastive_loss: 637538.3694; train_gene_expr_recon_loss: 2309787.6921; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4297988.8141; train_optim_loss: 4297988.8141; val_kl_reg_loss: 23709.2837; val_edge_recon_loss: 1350157.0790; val_cat_covariates_contrastive_loss: 636225.3140; val_gene_expr_recon_loss: 2303237.3555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4313329.0490; val_optim_loss: 4313329.0490
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9675; val_auprc_score: 0.9847; val_best_acc_score: 0.9486; val_best_f1_score: 0.9667; train_kl_reg_loss: 24589.9803; train_edge_recon_loss: 1323349.7706; train_cat_covariates_contrastive_loss: 637556.3245; train_gene_expr_recon_loss: 2268883.4150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4254379.4894; train_optim_loss: 4254379.4894; val_kl_reg_loss: 24124.0660; val_edge_recon_loss: 1327839.3065; val_cat_covariates_contrastive_loss: 641489.5922; val_gene_expr_recon_loss: 2268359.4980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4261812.4620; val_optim_loss: 4261812.4620
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9693; val_auprc_score: 0.9851; val_best_acc_score: 0.9517; val_best_f1_score: 0.9687; train_kl_reg_loss: 26035.9855; train_edge_recon_loss: 1327331.6383; train_cat_covariates_contrastive_loss: 638191.8943; train_gene_expr_recon_loss: 2248417.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4239976.5576; train_optim_loss: 4239976.5576; val_kl_reg_loss: 25834.9474; val_edge_recon_loss: 1326575.4560; val_cat_covariates_contrastive_loss: 643005.0907; val_gene_expr_recon_loss: 2250059.6325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4245475.1020; val_optim_loss: 4245475.1020
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9596; val_auprc_score: 0.9796; val_best_acc_score: 0.9489; val_best_f1_score: 0.9668; train_kl_reg_loss: 27251.3911; train_edge_recon_loss: 1323627.6334; train_cat_covariates_contrastive_loss: 638674.0954; train_gene_expr_recon_loss: 2227132.9715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4216686.0951; train_optim_loss: 4216686.0951; val_kl_reg_loss: 27802.2259; val_edge_recon_loss: 1337244.1260; val_cat_covariates_contrastive_loss: 637768.1870; val_gene_expr_recon_loss: 2238138.3445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4240952.8760; val_optim_loss: 4240952.8760
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9618; val_auprc_score: 0.9808; val_best_acc_score: 0.9526; val_best_f1_score: 0.9693; train_kl_reg_loss: 28051.9449; train_edge_recon_loss: 1326390.2213; train_cat_covariates_contrastive_loss: 638814.8632; train_gene_expr_recon_loss: 2210061.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4203318.9006; train_optim_loss: 4203318.9006; val_kl_reg_loss: 28224.0401; val_edge_recon_loss: 1323756.4660; val_cat_covariates_contrastive_loss: 637992.2935; val_gene_expr_recon_loss: 2210230.3215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4200203.1370; val_optim_loss: 4200203.1370
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9665; val_auprc_score: 0.9833; val_best_acc_score: 0.9535; val_best_f1_score: 0.9698; train_kl_reg_loss: 29013.5008; train_edge_recon_loss: 1327726.5076; train_cat_covariates_contrastive_loss: 639303.7402; train_gene_expr_recon_loss: 2204289.0607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4200332.8041; train_optim_loss: 4200332.8041; val_kl_reg_loss: 28080.4679; val_edge_recon_loss: 1335373.5167; val_cat_covariates_contrastive_loss: 641607.5300; val_gene_expr_recon_loss: 2214530.3575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4219591.8720; val_optim_loss: 4219591.8720
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9617; val_auprc_score: 0.9807; val_best_acc_score: 0.9534; val_best_f1_score: 0.9699; train_kl_reg_loss: 29969.7772; train_edge_recon_loss: 1322667.0218; train_cat_covariates_contrastive_loss: 639320.9913; train_gene_expr_recon_loss: 2193456.9069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4185414.6938; train_optim_loss: 4185414.6938; val_kl_reg_loss: 28270.5354; val_edge_recon_loss: 1324582.7788; val_cat_covariates_contrastive_loss: 639179.0972; val_gene_expr_recon_loss: 2268942.9605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4260975.3690; val_optim_loss: 4260975.3690
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9621; val_auprc_score: 0.9811; val_best_acc_score: 0.9540; val_best_f1_score: 0.9703; train_kl_reg_loss: 30667.9576; train_edge_recon_loss: 1322811.7524; train_cat_covariates_contrastive_loss: 639673.1041; train_gene_expr_recon_loss: 2198830.7605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4191983.5700; train_optim_loss: 4191983.5700; val_kl_reg_loss: 31634.3154; val_edge_recon_loss: 1326897.6950; val_cat_covariates_contrastive_loss: 640521.6380; val_gene_expr_recon_loss: 2197759.9550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4196813.6060; val_optim_loss: 4196813.6060
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9642; val_auprc_score: 0.9811; val_best_acc_score: 0.9546; val_best_f1_score: 0.9705; train_kl_reg_loss: 31503.4537; train_edge_recon_loss: 1324705.8703; train_cat_covariates_contrastive_loss: 640098.0121; train_gene_expr_recon_loss: 2175197.2560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4171504.5900; train_optim_loss: 4171504.5900; val_kl_reg_loss: 31457.8524; val_edge_recon_loss: 1330183.4395; val_cat_covariates_contrastive_loss: 640000.9415; val_gene_expr_recon_loss: 2194973.0900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4196615.3160; val_optim_loss: 4196615.3160
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9646; val_auprc_score: 0.9823; val_best_acc_score: 0.9563; val_best_f1_score: 0.9718; train_kl_reg_loss: 31983.3518; train_edge_recon_loss: 1325343.3485; train_cat_covariates_contrastive_loss: 640076.2542; train_gene_expr_recon_loss: 2183530.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4180933.2388; train_optim_loss: 4180933.2388; val_kl_reg_loss: 34021.8540; val_edge_recon_loss: 1315425.9640; val_cat_covariates_contrastive_loss: 639273.9692; val_gene_expr_recon_loss: 2248753.6345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4237475.4180; val_optim_loss: 4237475.4180
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9635; val_auprc_score: 0.9811; val_best_acc_score: 0.9552; val_best_f1_score: 0.9709; train_kl_reg_loss: 32710.5824; train_edge_recon_loss: 1322886.6207; train_cat_covariates_contrastive_loss: 640370.0286; train_gene_expr_recon_loss: 2166743.9003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4162711.1286; train_optim_loss: 4162711.1286; val_kl_reg_loss: 32881.6192; val_edge_recon_loss: 1329868.8805; val_cat_covariates_contrastive_loss: 641869.8335; val_gene_expr_recon_loss: 2193491.6175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4198111.9400; val_optim_loss: 4198111.9400
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9653; val_auprc_score: 0.9826; val_best_acc_score: 0.9541; val_best_f1_score: 0.9702; train_kl_reg_loss: 33189.8016; train_edge_recon_loss: 1325291.3176; train_cat_covariates_contrastive_loss: 640714.0062; train_gene_expr_recon_loss: 2172564.9338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4171760.0599; train_optim_loss: 4171760.0599; val_kl_reg_loss: 33053.5679; val_edge_recon_loss: 1323755.7212; val_cat_covariates_contrastive_loss: 641970.5755; val_gene_expr_recon_loss: 2193880.4245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4192660.3100; val_optim_loss: 4192660.3100
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9634; val_auprc_score: 0.9815; val_best_acc_score: 0.9527; val_best_f1_score: 0.9695; train_kl_reg_loss: 33732.2857; train_edge_recon_loss: 1327485.7836; train_cat_covariates_contrastive_loss: 640644.0400; train_gene_expr_recon_loss: 2159321.2740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4161183.3838; train_optim_loss: 4161183.3838; val_kl_reg_loss: 35042.9442; val_edge_recon_loss: 1322900.6860; val_cat_covariates_contrastive_loss: 639338.8932; val_gene_expr_recon_loss: 2329846.5150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4327129.0360; val_optim_loss: 4327129.0360
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9633; val_auprc_score: 0.9813; val_best_acc_score: 0.9561; val_best_f1_score: 0.9717; train_kl_reg_loss: 34079.4889; train_edge_recon_loss: 1327594.2656; train_cat_covariates_contrastive_loss: 641010.0839; train_gene_expr_recon_loss: 2164540.0213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4167223.8641; train_optim_loss: 4167223.8641; val_kl_reg_loss: 34245.0575; val_edge_recon_loss: 1314368.7660; val_cat_covariates_contrastive_loss: 641207.5293; val_gene_expr_recon_loss: 2188696.6495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4178517.9950; val_optim_loss: 4178517.9950
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9625; val_auprc_score: 0.9804; val_best_acc_score: 0.9548; val_best_f1_score: 0.9707; train_kl_reg_loss: 34806.1951; train_edge_recon_loss: 1326045.8995; train_cat_covariates_contrastive_loss: 641169.7121; train_gene_expr_recon_loss: 2161598.6281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4163620.4351; train_optim_loss: 4163620.4351; val_kl_reg_loss: 34997.5308; val_edge_recon_loss: 1341276.0030; val_cat_covariates_contrastive_loss: 640255.6920; val_gene_expr_recon_loss: 2188337.1765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4204866.4030; val_optim_loss: 4204866.4030
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9628; val_auprc_score: 0.9810; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 35087.7733; train_edge_recon_loss: 1324772.4570; train_cat_covariates_contrastive_loss: 641621.6671; train_gene_expr_recon_loss: 2155651.3308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4157133.2245; train_optim_loss: 4157133.2245; val_kl_reg_loss: 34766.2503; val_edge_recon_loss: 1327798.2035; val_cat_covariates_contrastive_loss: 640758.2118; val_gene_expr_recon_loss: 2198601.6775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4201924.3370; val_optim_loss: 4201924.3370
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9661; val_auprc_score: 0.9829; val_best_acc_score: 0.9586; val_best_f1_score: 0.9733; train_kl_reg_loss: 37715.3937; train_edge_recon_loss: 1323884.8221; train_cat_covariates_contrastive_loss: 641926.0256; train_gene_expr_recon_loss: 2204222.9214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4207749.1608; train_optim_loss: 4207749.1608; val_kl_reg_loss: 38428.6615; val_edge_recon_loss: 1327769.9867; val_cat_covariates_contrastive_loss: 643129.5983; val_gene_expr_recon_loss: 2213296.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4222625.0640; val_optim_loss: 4222625.0640
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9653; val_auprc_score: 0.9823; val_best_acc_score: 0.9574; val_best_f1_score: 0.9724; train_kl_reg_loss: 39560.3880; train_edge_recon_loss: 1326342.1518; train_cat_covariates_contrastive_loss: 642048.7288; train_gene_expr_recon_loss: 2188964.5792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4196915.8488; train_optim_loss: 4196915.8488; val_kl_reg_loss: 40354.7625; val_edge_recon_loss: 1331797.8855; val_cat_covariates_contrastive_loss: 643368.9070; val_gene_expr_recon_loss: 2252727.0570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4268248.6260; val_optim_loss: 4268248.6260

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9611; val_auprc_score: 0.9798; val_best_acc_score: 0.9571; val_best_f1_score: 0.9722; train_kl_reg_loss: 40459.1739; train_edge_recon_loss: 1324641.0897; train_cat_covariates_contrastive_loss: 643233.0180; train_gene_expr_recon_loss: 2126555.5588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4134888.8433; train_optim_loss: 4134888.8433; val_kl_reg_loss: 41089.0890; val_edge_recon_loss: 1325778.0610; val_cat_covariates_contrastive_loss: 641945.2900; val_gene_expr_recon_loss: 2142566.9595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4151379.3900; val_optim_loss: 4151379.3900
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9646; val_auprc_score: 0.9817; val_best_acc_score: 0.9560; val_best_f1_score: 0.9714; train_kl_reg_loss: 40338.6828; train_edge_recon_loss: 1322995.9137; train_cat_covariates_contrastive_loss: 643283.0897; train_gene_expr_recon_loss: 2094323.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4100940.8211; train_optim_loss: 4100940.8211; val_kl_reg_loss: 39664.2993; val_edge_recon_loss: 1332463.3580; val_cat_covariates_contrastive_loss: 644022.9870; val_gene_expr_recon_loss: 2131224.6525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4147375.3000; val_optim_loss: 4147375.3000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9618; val_auprc_score: 0.9797; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 39849.2708; train_edge_recon_loss: 1323215.3583; train_cat_covariates_contrastive_loss: 643201.4987; train_gene_expr_recon_loss: 2082318.2072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4088584.3375; train_optim_loss: 4088584.3375; val_kl_reg_loss: 39555.5989; val_edge_recon_loss: 1323640.9487; val_cat_covariates_contrastive_loss: 642729.7458; val_gene_expr_recon_loss: 2122454.2485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4128380.5320; val_optim_loss: 4128380.5320
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9626; val_auprc_score: 0.9807; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 39302.7353; train_edge_recon_loss: 1320071.7604; train_cat_covariates_contrastive_loss: 642932.9993; train_gene_expr_recon_loss: 2075550.1163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4077857.6104; train_optim_loss: 4077857.6104; val_kl_reg_loss: 38766.4883; val_edge_recon_loss: 1333131.2835; val_cat_covariates_contrastive_loss: 643871.8775; val_gene_expr_recon_loss: 2116944.4010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4132714.0550; val_optim_loss: 4132714.0550
