Run timestamp: 29082023_180518_3.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '6', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--filter_genes', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'visium_mouse_brain', '--reference_batches', 'batch1', 'batch2', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'data', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 32285 genes.
Keeping 32285 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1530, n_latent: 1520, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 10948
Number of validation nodes: 1216
Number of training edges: 33527
Number of validation edges: 3725
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8033; val_auprc_score: 0.8912; val_best_acc_score: 0.7503; val_best_f1_score: 0.8328; train_kl_reg_loss: 153874.0994; train_edge_recon_loss: 2479453.7195; train_cat_covariates_contrastive_loss: 718101.3850; train_gene_expr_recon_loss: 82434121.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 85785550.2595; train_optim_loss: 85785550.2595; val_kl_reg_loss: 106520.4500; val_edge_recon_loss: 2723345.5833; val_cat_covariates_contrastive_loss: 626559.0833; val_gene_expr_recon_loss: 56253963.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59710388.5333; val_optim_loss: 59710388.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8265; val_auprc_score: 0.9015; val_best_acc_score: 0.7803; val_best_f1_score: 0.8487; train_kl_reg_loss: 121255.8020; train_edge_recon_loss: 2446146.0038; train_cat_covariates_contrastive_loss: 665141.8316; train_gene_expr_recon_loss: 52774208.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56006752.4885; train_optim_loss: 56006752.4885; val_kl_reg_loss: 132372.4385; val_edge_recon_loss: 2725587.9833; val_cat_covariates_contrastive_loss: 626589.1083; val_gene_expr_recon_loss: 51351248.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54835797.6000; val_optim_loss: 54835797.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8307; val_auprc_score: 0.9014; val_best_acc_score: 0.7698; val_best_f1_score: 0.8518; train_kl_reg_loss: 112395.7790; train_edge_recon_loss: 2448114.0038; train_cat_covariates_contrastive_loss: 660253.0429; train_gene_expr_recon_loss: 50355494.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53576257.1603; train_optim_loss: 53576257.1603; val_kl_reg_loss: 107908.5437; val_edge_recon_loss: 2644823.1000; val_cat_covariates_contrastive_loss: 626635.5625; val_gene_expr_recon_loss: 49716954.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53096321.8667; val_optim_loss: 53096321.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8295; val_auprc_score: 0.9003; val_best_acc_score: 0.7898; val_best_f1_score: 0.8567; train_kl_reg_loss: 97092.6319; train_edge_recon_loss: 2406346.1279; train_cat_covariates_contrastive_loss: 646314.9656; train_gene_expr_recon_loss: 49271348.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52421102.1679; train_optim_loss: 52421102.1679; val_kl_reg_loss: 94467.0198; val_edge_recon_loss: 2550257.3667; val_cat_covariates_contrastive_loss: 626848.1417; val_gene_expr_recon_loss: 48896293.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52167865.6000; val_optim_loss: 52167865.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8346; val_auprc_score: 0.9063; val_best_acc_score: 0.7867; val_best_f1_score: 0.8560; train_kl_reg_loss: 75407.5878; train_edge_recon_loss: 2269022.3235; train_cat_covariates_contrastive_loss: 632575.7600; train_gene_expr_recon_loss: 48481880.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51458885.9542; train_optim_loss: 51458885.9542; val_kl_reg_loss: 73383.5943; val_edge_recon_loss: 2235146.1000; val_cat_covariates_contrastive_loss: 627190.9583; val_gene_expr_recon_loss: 47976174.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50911894.9333; val_optim_loss: 50911894.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8555; val_auprc_score: 0.9187; val_best_acc_score: 0.8109; val_best_f1_score: 0.8731; train_kl_reg_loss: 86006.1679; train_edge_recon_loss: 2090501.8655; train_cat_covariates_contrastive_loss: 628896.0916; train_gene_expr_recon_loss: 47741740.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50547144.1832; train_optim_loss: 50547144.1832; val_kl_reg_loss: 93636.5115; val_edge_recon_loss: 2039220.1833; val_cat_covariates_contrastive_loss: 627133.0792; val_gene_expr_recon_loss: 47623771.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50383761.6000; val_optim_loss: 50383761.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8590; val_auprc_score: 0.9183; val_best_acc_score: 0.8117; val_best_f1_score: 0.8727; train_kl_reg_loss: 95032.5924; train_edge_recon_loss: 2037772.1517; train_cat_covariates_contrastive_loss: 628618.4933; train_gene_expr_recon_loss: 47178855.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49940278.3206; train_optim_loss: 49940278.3206; val_kl_reg_loss: 91966.8365; val_edge_recon_loss: 2042366.4583; val_cat_covariates_contrastive_loss: 627241.2250; val_gene_expr_recon_loss: 46944564.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49706138.9333; val_optim_loss: 49706138.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8575; val_auprc_score: 0.9199; val_best_acc_score: 0.8165; val_best_f1_score: 0.8786; train_kl_reg_loss: 94489.7579; train_edge_recon_loss: 1997441.5964; train_cat_covariates_contrastive_loss: 628482.5072; train_gene_expr_recon_loss: 46674725.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49395139.6641; train_optim_loss: 49395139.6641; val_kl_reg_loss: 89961.3469; val_edge_recon_loss: 1955049.3333; val_cat_covariates_contrastive_loss: 627453.1792; val_gene_expr_recon_loss: 46316008.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48988471.7333; val_optim_loss: 48988471.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8760; val_auprc_score: 0.9285; val_best_acc_score: 0.8172; val_best_f1_score: 0.8782; train_kl_reg_loss: 87208.1936; train_edge_recon_loss: 1984134.6508; train_cat_covariates_contrastive_loss: 628671.8306; train_gene_expr_recon_loss: 46145357.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48845371.9084; train_optim_loss: 48845371.9084; val_kl_reg_loss: 81343.2927; val_edge_recon_loss: 1972289.1833; val_cat_covariates_contrastive_loss: 628298.8042; val_gene_expr_recon_loss: 45895833.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48577764.5333; val_optim_loss: 48577764.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8743; val_auprc_score: 0.9274; val_best_acc_score: 0.8198; val_best_f1_score: 0.8780; train_kl_reg_loss: 81497.9367; train_edge_recon_loss: 1968213.9303; train_cat_covariates_contrastive_loss: 628819.0677; train_gene_expr_recon_loss: 45743306.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48421837.2519; train_optim_loss: 48421837.2519; val_kl_reg_loss: 77322.2578; val_edge_recon_loss: 1959215.3333; val_cat_covariates_contrastive_loss: 628593.9250; val_gene_expr_recon_loss: 45421369.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48086501.3333; val_optim_loss: 48086501.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8901; val_auprc_score: 0.9395; val_best_acc_score: 0.8248; val_best_f1_score: 0.8789; train_kl_reg_loss: 73830.2824; train_edge_recon_loss: 1936118.5563; train_cat_covariates_contrastive_loss: 629396.1045; train_gene_expr_recon_loss: 45306203.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47945548.4885; train_optim_loss: 47945548.4885; val_kl_reg_loss: 68996.6906; val_edge_recon_loss: 1948416.7000; val_cat_covariates_contrastive_loss: 629589.8917; val_gene_expr_recon_loss: 45101136.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47748139.7333; val_optim_loss: 47748139.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8965; val_auprc_score: 0.9415; val_best_acc_score: 0.8329; val_best_f1_score: 0.8852; train_kl_reg_loss: 68034.6308; train_edge_recon_loss: 1928326.4313; train_cat_covariates_contrastive_loss: 630043.1489; train_gene_expr_recon_loss: 44915138.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47541542.4427; train_optim_loss: 47541542.4427; val_kl_reg_loss: 65782.6844; val_edge_recon_loss: 1931441.2250; val_cat_covariates_contrastive_loss: 630934.0875; val_gene_expr_recon_loss: 44734621.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47362779.7333; val_optim_loss: 47362779.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9035; val_auprc_score: 0.9420; val_best_acc_score: 0.8424; val_best_f1_score: 0.8883; train_kl_reg_loss: 64776.1291; train_edge_recon_loss: 1898090.4647; train_cat_covariates_contrastive_loss: 631285.5262; train_gene_expr_recon_loss: 44533073.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47127225.8015; train_optim_loss: 47127225.8015; val_kl_reg_loss: 62416.9766; val_edge_recon_loss: 1959985.7000; val_cat_covariates_contrastive_loss: 630840.4708; val_gene_expr_recon_loss: 44264049.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46917292.5333; val_optim_loss: 46917292.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9094; val_auprc_score: 0.9470; val_best_acc_score: 0.8515; val_best_f1_score: 0.8953; train_kl_reg_loss: 61135.0161; train_edge_recon_loss: 1903889.0324; train_cat_covariates_contrastive_loss: 632479.0291; train_gene_expr_recon_loss: 44141483.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46738986.9924; train_optim_loss: 46738986.9924; val_kl_reg_loss: 58529.9557; val_edge_recon_loss: 1928026.9917; val_cat_covariates_contrastive_loss: 633085.1708; val_gene_expr_recon_loss: 43978618.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46598260.8000; val_optim_loss: 46598260.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9199; val_auprc_score: 0.9526; val_best_acc_score: 0.8605; val_best_f1_score: 0.8998; train_kl_reg_loss: 58161.0720; train_edge_recon_loss: 1874010.4714; train_cat_covariates_contrastive_loss: 633695.8220; train_gene_expr_recon_loss: 43806874.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46372741.8931; train_optim_loss: 46372741.8931; val_kl_reg_loss: 56278.9701; val_edge_recon_loss: 1929297.8000; val_cat_covariates_contrastive_loss: 634690.0917; val_gene_expr_recon_loss: 43590685.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46210952.5333; val_optim_loss: 46210952.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9261; val_auprc_score: 0.9543; val_best_acc_score: 0.8721; val_best_f1_score: 0.9079; train_kl_reg_loss: 54734.9092; train_edge_recon_loss: 1870233.0983; train_cat_covariates_contrastive_loss: 635562.0840; train_gene_expr_recon_loss: 43447725.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46008255.8473; train_optim_loss: 46008255.8473; val_kl_reg_loss: 52986.5161; val_edge_recon_loss: 1872414.6333; val_cat_covariates_contrastive_loss: 635369.7917; val_gene_expr_recon_loss: 43227482.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45788253.0667; val_optim_loss: 45788253.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9320; val_auprc_score: 0.9598; val_best_acc_score: 0.8782; val_best_f1_score: 0.9128; train_kl_reg_loss: 52838.7544; train_edge_recon_loss: 1870665.3798; train_cat_covariates_contrastive_loss: 636718.7853; train_gene_expr_recon_loss: 43153707.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45713930.4733; train_optim_loss: 45713930.4733; val_kl_reg_loss: 51194.5638; val_edge_recon_loss: 1884284.1167; val_cat_covariates_contrastive_loss: 638392.2292; val_gene_expr_recon_loss: 43017230.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45591102.1333; val_optim_loss: 45591102.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9322; val_auprc_score: 0.9586; val_best_acc_score: 0.8791; val_best_f1_score: 0.9128; train_kl_reg_loss: 51543.8979; train_edge_recon_loss: 1845170.2777; train_cat_covariates_contrastive_loss: 636395.0124; train_gene_expr_recon_loss: 42911472.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45444581.3130; train_optim_loss: 45444581.3130; val_kl_reg_loss: 50171.3208; val_edge_recon_loss: 1868032.5750; val_cat_covariates_contrastive_loss: 639897.5583; val_gene_expr_recon_loss: 42736998.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45295100.0000; val_optim_loss: 45295100.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9430; val_auprc_score: 0.9639; val_best_acc_score: 0.8930; val_best_f1_score: 0.9227; train_kl_reg_loss: 50075.4600; train_edge_recon_loss: 1839644.1221; train_cat_covariates_contrastive_loss: 638322.7223; train_gene_expr_recon_loss: 42638168.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45166210.2901; train_optim_loss: 45166210.2901; val_kl_reg_loss: 48525.0305; val_edge_recon_loss: 1829995.2750; val_cat_covariates_contrastive_loss: 638539.7000; val_gene_expr_recon_loss: 42482996.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45000056.8000; val_optim_loss: 45000056.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9482; val_auprc_score: 0.9683; val_best_acc_score: 0.8987; val_best_f1_score: 0.9263; train_kl_reg_loss: 47661.9229; train_edge_recon_loss: 1828217.9265; train_cat_covariates_contrastive_loss: 637464.7209; train_gene_expr_recon_loss: 42409195.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44922540.5496; train_optim_loss: 44922540.5496; val_kl_reg_loss: 46093.1628; val_edge_recon_loss: 1841089.1250; val_cat_covariates_contrastive_loss: 640938.3750; val_gene_expr_recon_loss: 42315609.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44843729.8667; val_optim_loss: 44843729.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9468; val_auprc_score: 0.9651; val_best_acc_score: 0.9049; val_best_f1_score: 0.9324; train_kl_reg_loss: 45522.7943; train_edge_recon_loss: 1830007.1441; train_cat_covariates_contrastive_loss: 637978.0797; train_gene_expr_recon_loss: 42189696.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44703204.2137; train_optim_loss: 44703204.2137; val_kl_reg_loss: 44602.0271; val_edge_recon_loss: 1795408.3167; val_cat_covariates_contrastive_loss: 640621.7000; val_gene_expr_recon_loss: 42047606.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44528238.6667; val_optim_loss: 44528238.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9454; val_auprc_score: 0.9656; val_best_acc_score: 0.8984; val_best_f1_score: 0.9260; train_kl_reg_loss: 42945.2060; train_edge_recon_loss: 1823731.0639; train_cat_covariates_contrastive_loss: 639466.0391; train_gene_expr_recon_loss: 41974186.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44480329.1908; train_optim_loss: 44480329.1908; val_kl_reg_loss: 41935.1323; val_edge_recon_loss: 1878533.6583; val_cat_covariates_contrastive_loss: 635552.7500; val_gene_expr_recon_loss: 42027751.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44583772.5333; val_optim_loss: 44583772.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9505; val_auprc_score: 0.9664; val_best_acc_score: 0.9048; val_best_f1_score: 0.9311; train_kl_reg_loss: 41620.6748; train_edge_recon_loss: 1812095.0849; train_cat_covariates_contrastive_loss: 639561.8254; train_gene_expr_recon_loss: 41782291.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44275568.4885; train_optim_loss: 44275568.4885; val_kl_reg_loss: 39357.4305; val_edge_recon_loss: 1854056.3667; val_cat_covariates_contrastive_loss: 640468.9833; val_gene_expr_recon_loss: 41817834.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44351717.8667; val_optim_loss: 44351717.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9518; val_auprc_score: 0.9694; val_best_acc_score: 0.9083; val_best_f1_score: 0.9341; train_kl_reg_loss: 39809.4028; train_edge_recon_loss: 1806456.8597; train_cat_covariates_contrastive_loss: 639915.6551; train_gene_expr_recon_loss: 41584998.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44071180.4275; train_optim_loss: 44071180.4275; val_kl_reg_loss: 37953.7516; val_edge_recon_loss: 1825313.2250; val_cat_covariates_contrastive_loss: 638075.7875; val_gene_expr_recon_loss: 41369187.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43870530.9333; val_optim_loss: 43870530.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9555; val_auprc_score: 0.9720; val_best_acc_score: 0.9104; val_best_f1_score: 0.9357; train_kl_reg_loss: 38521.7155; train_edge_recon_loss: 1805216.9771; train_cat_covariates_contrastive_loss: 639260.1808; train_gene_expr_recon_loss: 41415399.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43898398.2595; train_optim_loss: 43898398.2595; val_kl_reg_loss: 37047.8164; val_edge_recon_loss: 1831668.7750; val_cat_covariates_contrastive_loss: 639402.5250; val_gene_expr_recon_loss: 41420588.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43928707.7333; val_optim_loss: 43928707.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9592; val_auprc_score: 0.9748; val_best_acc_score: 0.9158; val_best_f1_score: 0.9393; train_kl_reg_loss: 36656.6813; train_edge_recon_loss: 1800690.0296; train_cat_covariates_contrastive_loss: 639753.0878; train_gene_expr_recon_loss: 41244872.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43721972.0000; train_optim_loss: 43721972.0000; val_kl_reg_loss: 35901.8854; val_edge_recon_loss: 1777417.2167; val_cat_covariates_contrastive_loss: 641245.5208; val_gene_expr_recon_loss: 41285326.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43739891.2000; val_optim_loss: 43739891.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9564; val_auprc_score: 0.9686; val_best_acc_score: 0.9224; val_best_f1_score: 0.9434; train_kl_reg_loss: 35495.9108; train_edge_recon_loss: 1794017.7557; train_cat_covariates_contrastive_loss: 641411.7114; train_gene_expr_recon_loss: 41054624.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43525550.1069; train_optim_loss: 43525550.1069; val_kl_reg_loss: 34654.2419; val_edge_recon_loss: 1801302.9250; val_cat_covariates_contrastive_loss: 641539.3208; val_gene_expr_recon_loss: 40854786.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43332282.9333; val_optim_loss: 43332282.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9607; val_auprc_score: 0.9741; val_best_acc_score: 0.9242; val_best_f1_score: 0.9451; train_kl_reg_loss: 34112.6526; train_edge_recon_loss: 1793345.4599; train_cat_covariates_contrastive_loss: 639878.0577; train_gene_expr_recon_loss: 40898206.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43365542.5954; train_optim_loss: 43365542.5954; val_kl_reg_loss: 33168.6865; val_edge_recon_loss: 1793989.8750; val_cat_covariates_contrastive_loss: 640486.3708; val_gene_expr_recon_loss: 40809209.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43276853.3333; val_optim_loss: 43276853.3333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9590; val_auprc_score: 0.9737; val_best_acc_score: 0.9198; val_best_f1_score: 0.9421; train_kl_reg_loss: 33149.9441; train_edge_recon_loss: 1776842.4065; train_cat_covariates_contrastive_loss: 641769.6775; train_gene_expr_recon_loss: 40777102.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43228863.9084; train_optim_loss: 43228863.9084; val_kl_reg_loss: 32945.7695; val_edge_recon_loss: 1794920.7667; val_cat_covariates_contrastive_loss: 640158.4500; val_gene_expr_recon_loss: 40763841.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43231865.8667; val_optim_loss: 43231865.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9525; val_auprc_score: 0.9685; val_best_acc_score: 0.9150; val_best_f1_score: 0.9388; train_kl_reg_loss: 32297.6445; train_edge_recon_loss: 1783596.0324; train_cat_covariates_contrastive_loss: 640827.3593; train_gene_expr_recon_loss: 40669370.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43126091.1450; train_optim_loss: 43126091.1450; val_kl_reg_loss: 31762.0276; val_edge_recon_loss: 1818507.3833; val_cat_covariates_contrastive_loss: 636455.8375; val_gene_expr_recon_loss: 40656912.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43143637.3333; val_optim_loss: 43143637.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9646; val_auprc_score: 0.9766; val_best_acc_score: 0.9292; val_best_f1_score: 0.9489; train_kl_reg_loss: 31627.5057; train_edge_recon_loss: 1758320.4523; train_cat_covariates_contrastive_loss: 640152.1551; train_gene_expr_recon_loss: 40580508.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43010608.3664; train_optim_loss: 43010608.3664; val_kl_reg_loss: 31890.5379; val_edge_recon_loss: 1777221.4667; val_cat_covariates_contrastive_loss: 641142.2167; val_gene_expr_recon_loss: 40564569.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43014824.0000; val_optim_loss: 43014824.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9619; val_auprc_score: 0.9741; val_best_acc_score: 0.9316; val_best_f1_score: 0.9512; train_kl_reg_loss: 31258.6765; train_edge_recon_loss: 1783759.5821; train_cat_covariates_contrastive_loss: 639353.4461; train_gene_expr_recon_loss: 40417276.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42871647.8779; train_optim_loss: 42871647.8779; val_kl_reg_loss: 30538.5655; val_edge_recon_loss: 1743369.6417; val_cat_covariates_contrastive_loss: 637998.6292; val_gene_expr_recon_loss: 40417897.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42829805.0667; val_optim_loss: 42829805.0667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9655; val_auprc_score: 0.9769; val_best_acc_score: 0.9332; val_best_f1_score: 0.9516; train_kl_reg_loss: 30252.2124; train_edge_recon_loss: 1776710.2252; train_cat_covariates_contrastive_loss: 639835.2815; train_gene_expr_recon_loss: 40306079.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42752877.6489; train_optim_loss: 42752877.6489; val_kl_reg_loss: 29550.1875; val_edge_recon_loss: 1785232.8500; val_cat_covariates_contrastive_loss: 637103.6458; val_gene_expr_recon_loss: 40177701.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42629588.8000; val_optim_loss: 42629588.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9622; val_auprc_score: 0.9753; val_best_acc_score: 0.9295; val_best_f1_score: 0.9490; train_kl_reg_loss: 29646.7911; train_edge_recon_loss: 1757833.9332; train_cat_covariates_contrastive_loss: 639834.2729; train_gene_expr_recon_loss: 40237422.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42664737.1908; train_optim_loss: 42664737.1908; val_kl_reg_loss: 29704.6935; val_edge_recon_loss: 1798449.6083; val_cat_covariates_contrastive_loss: 638215.8583; val_gene_expr_recon_loss: 40070877.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42537247.7333; val_optim_loss: 42537247.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9644; val_auprc_score: 0.9769; val_best_acc_score: 0.9311; val_best_f1_score: 0.9508; train_kl_reg_loss: 29200.6158; train_edge_recon_loss: 1780809.9189; train_cat_covariates_contrastive_loss: 638998.8440; train_gene_expr_recon_loss: 40187424.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42636433.4656; train_optim_loss: 42636433.4656; val_kl_reg_loss: 27779.5723; val_edge_recon_loss: 1769579.6583; val_cat_covariates_contrastive_loss: 636689.4750; val_gene_expr_recon_loss: 40236546.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42670595.2000; val_optim_loss: 42670595.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9623; val_auprc_score: 0.9737; val_best_acc_score: 0.9326; val_best_f1_score: 0.9507; train_kl_reg_loss: 29065.7978; train_edge_recon_loss: 1766971.1775; train_cat_covariates_contrastive_loss: 638334.3492; train_gene_expr_recon_loss: 40093940.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42528312.3969; train_optim_loss: 42528312.3969; val_kl_reg_loss: 29307.4892; val_edge_recon_loss: 1786854.9500; val_cat_covariates_contrastive_loss: 640663.3750; val_gene_expr_recon_loss: 39825299.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42282125.3333; val_optim_loss: 42282125.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9682; val_auprc_score: 0.9787; val_best_acc_score: 0.9352; val_best_f1_score: 0.9529; train_kl_reg_loss: 28457.0636; train_edge_recon_loss: 1771512.8473; train_cat_covariates_contrastive_loss: 638804.8001; train_gene_expr_recon_loss: 39976963.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42415737.6489; train_optim_loss: 42415737.6489; val_kl_reg_loss: 27774.8388; val_edge_recon_loss: 1775853.3417; val_cat_covariates_contrastive_loss: 637422.0792; val_gene_expr_recon_loss: 39958161.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42399212.8000; val_optim_loss: 42399212.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9638; val_auprc_score: 0.9760; val_best_acc_score: 0.9314; val_best_f1_score: 0.9505; train_kl_reg_loss: 27783.2056; train_edge_recon_loss: 1758323.0782; train_cat_covariates_contrastive_loss: 640201.1178; train_gene_expr_recon_loss: 39875125.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42301433.4351; train_optim_loss: 42301433.4351; val_kl_reg_loss: 27636.2668; val_edge_recon_loss: 1765275.8667; val_cat_covariates_contrastive_loss: 640606.8833; val_gene_expr_recon_loss: 39815601.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42249121.0667; val_optim_loss: 42249121.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9620; val_auprc_score: 0.9710; val_best_acc_score: 0.9357; val_best_f1_score: 0.9542; train_kl_reg_loss: 27325.8883; train_edge_recon_loss: 1760364.4189; train_cat_covariates_contrastive_loss: 638507.1565; train_gene_expr_recon_loss: 39813862.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42240059.8168; train_optim_loss: 42240059.8168; val_kl_reg_loss: 27315.4960; val_edge_recon_loss: 1718288.7917; val_cat_covariates_contrastive_loss: 637036.2375; val_gene_expr_recon_loss: 39831354.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42213995.2000; val_optim_loss: 42213995.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9643; val_auprc_score: 0.9763; val_best_acc_score: 0.9331; val_best_f1_score: 0.9517; train_kl_reg_loss: 26871.9456; train_edge_recon_loss: 1754758.8473; train_cat_covariates_contrastive_loss: 640483.4585; train_gene_expr_recon_loss: 39775104.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42197218.4733; train_optim_loss: 42197218.4733; val_kl_reg_loss: 26068.9270; val_edge_recon_loss: 1774673.3167; val_cat_covariates_contrastive_loss: 640236.4875; val_gene_expr_recon_loss: 39728446.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42169425.6000; val_optim_loss: 42169425.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9623; val_auprc_score: 0.9746; val_best_acc_score: 0.9302; val_best_f1_score: 0.9495; train_kl_reg_loss: 26426.3575; train_edge_recon_loss: 1763493.2080; train_cat_covariates_contrastive_loss: 637052.8015; train_gene_expr_recon_loss: 39780136.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42207108.5802; train_optim_loss: 42207108.5802; val_kl_reg_loss: 26478.9813; val_edge_recon_loss: 1809107.3000; val_cat_covariates_contrastive_loss: 637745.8375; val_gene_expr_recon_loss: 39667022.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42140354.4000; val_optim_loss: 42140354.4000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9629; val_auprc_score: 0.9749; val_best_acc_score: 0.9350; val_best_f1_score: 0.9530; train_kl_reg_loss: 26010.0011; train_edge_recon_loss: 1753115.0029; train_cat_covariates_contrastive_loss: 638323.8955; train_gene_expr_recon_loss: 39650772.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42068221.8931; train_optim_loss: 42068221.8931; val_kl_reg_loss: 25803.5000; val_edge_recon_loss: 1759366.8250; val_cat_covariates_contrastive_loss: 642288.5458; val_gene_expr_recon_loss: 39671232.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42098690.9333; val_optim_loss: 42098690.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9650; val_auprc_score: 0.9760; val_best_acc_score: 0.9356; val_best_f1_score: 0.9537; train_kl_reg_loss: 25739.5346; train_edge_recon_loss: 1752940.2786; train_cat_covariates_contrastive_loss: 639543.5320; train_gene_expr_recon_loss: 39626838.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42045062.4122; train_optim_loss: 42045062.4122; val_kl_reg_loss: 25705.1342; val_edge_recon_loss: 1741506.7083; val_cat_covariates_contrastive_loss: 640209.4750; val_gene_expr_recon_loss: 39448936.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41856357.6000; val_optim_loss: 41856357.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9691; val_auprc_score: 0.9791; val_best_acc_score: 0.9397; val_best_f1_score: 0.9565; train_kl_reg_loss: 25324.8696; train_edge_recon_loss: 1751592.0782; train_cat_covariates_contrastive_loss: 638318.4141; train_gene_expr_recon_loss: 39551798.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41967033.6183; train_optim_loss: 41967033.6183; val_kl_reg_loss: 25091.4737; val_edge_recon_loss: 1755938.2083; val_cat_covariates_contrastive_loss: 642433.1708; val_gene_expr_recon_loss: 39543626.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41967088.5333; val_optim_loss: 41967088.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9612; val_auprc_score: 0.9743; val_best_acc_score: 0.9330; val_best_f1_score: 0.9517; train_kl_reg_loss: 25039.0113; train_edge_recon_loss: 1747030.0840; train_cat_covariates_contrastive_loss: 636855.1780; train_gene_expr_recon_loss: 39517859.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41926783.6031; train_optim_loss: 41926783.6031; val_kl_reg_loss: 25050.6146; val_edge_recon_loss: 1763439.7000; val_cat_covariates_contrastive_loss: 638490.3958; val_gene_expr_recon_loss: 39605241.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42032221.6000; val_optim_loss: 42032221.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9589; val_auprc_score: 0.9694; val_best_acc_score: 0.9338; val_best_f1_score: 0.9526; train_kl_reg_loss: 24971.6962; train_edge_recon_loss: 1741640.5324; train_cat_covariates_contrastive_loss: 637726.3974; train_gene_expr_recon_loss: 39527999.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41932338.2290; train_optim_loss: 41932338.2290; val_kl_reg_loss: 24893.4199; val_edge_recon_loss: 1760293.1500; val_cat_covariates_contrastive_loss: 641936.6500; val_gene_expr_recon_loss: 39393485.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41820609.3333; val_optim_loss: 41820609.3333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9672; val_auprc_score: 0.9785; val_best_acc_score: 0.9412; val_best_f1_score: 0.9576; train_kl_reg_loss: 24714.7834; train_edge_recon_loss: 1758609.7462; train_cat_covariates_contrastive_loss: 636869.4680; train_gene_expr_recon_loss: 39413222.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41833416.1832; train_optim_loss: 41833416.1832; val_kl_reg_loss: 24723.1495; val_edge_recon_loss: 1748838.4583; val_cat_covariates_contrastive_loss: 637469.0167; val_gene_expr_recon_loss: 39480423.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41891454.1333; val_optim_loss: 41891454.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9658; val_auprc_score: 0.9752; val_best_acc_score: 0.9403; val_best_f1_score: 0.9566; train_kl_reg_loss: 24366.1235; train_edge_recon_loss: 1763387.9590; train_cat_covariates_contrastive_loss: 637269.9432; train_gene_expr_recon_loss: 39369985.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41795009.0076; train_optim_loss: 41795009.0076; val_kl_reg_loss: 24230.2227; val_edge_recon_loss: 1762536.0917; val_cat_covariates_contrastive_loss: 635662.9792; val_gene_expr_recon_loss: 39314038.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41736468.5333; val_optim_loss: 41736468.5333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9661; val_auprc_score: 0.9743; val_best_acc_score: 0.9423; val_best_f1_score: 0.9584; train_kl_reg_loss: 23962.2904; train_edge_recon_loss: 1748770.1441; train_cat_covariates_contrastive_loss: 637753.5506; train_gene_expr_recon_loss: 39308481.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41718966.9924; train_optim_loss: 41718966.9924; val_kl_reg_loss: 24429.9617; val_edge_recon_loss: 1760357.8500; val_cat_covariates_contrastive_loss: 638078.5125; val_gene_expr_recon_loss: 39475047.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41897913.8667; val_optim_loss: 41897913.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9665; val_auprc_score: 0.9776; val_best_acc_score: 0.9387; val_best_f1_score: 0.9555; train_kl_reg_loss: 24082.1467; train_edge_recon_loss: 1749365.0773; train_cat_covariates_contrastive_loss: 637768.5768; train_gene_expr_recon_loss: 39290060.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41701276.1832; train_optim_loss: 41701276.1832; val_kl_reg_loss: 24123.8055; val_edge_recon_loss: 1781375.5250; val_cat_covariates_contrastive_loss: 637964.3083; val_gene_expr_recon_loss: 39193267.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41636730.9333; val_optim_loss: 41636730.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9633; val_auprc_score: 0.9747; val_best_acc_score: 0.9445; val_best_f1_score: 0.9602; train_kl_reg_loss: 23754.7090; train_edge_recon_loss: 1753142.1517; train_cat_covariates_contrastive_loss: 638810.8726; train_gene_expr_recon_loss: 39235268.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41650975.7252; train_optim_loss: 41650975.7252; val_kl_reg_loss: 23724.6870; val_edge_recon_loss: 1712557.4583; val_cat_covariates_contrastive_loss: 640333.8583; val_gene_expr_recon_loss: 39221014.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41597630.9333; val_optim_loss: 41597630.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9642; val_auprc_score: 0.9734; val_best_acc_score: 0.9422; val_best_f1_score: 0.9584; train_kl_reg_loss: 23736.7642; train_edge_recon_loss: 1744902.4656; train_cat_covariates_contrastive_loss: 638905.6508; train_gene_expr_recon_loss: 39214273.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41621818.4733; train_optim_loss: 41621818.4733; val_kl_reg_loss: 24216.2561; val_edge_recon_loss: 1745303.8833; val_cat_covariates_contrastive_loss: 641947.5417; val_gene_expr_recon_loss: 39228331.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41639798.9333; val_optim_loss: 41639798.9333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9651; val_auprc_score: 0.9760; val_best_acc_score: 0.9423; val_best_f1_score: 0.9584; train_kl_reg_loss: 23607.5689; train_edge_recon_loss: 1746028.9227; train_cat_covariates_contrastive_loss: 637447.0277; train_gene_expr_recon_loss: 39160281.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41567365.5573; train_optim_loss: 41567365.5573; val_kl_reg_loss: 23394.1906; val_edge_recon_loss: 1741339.7917; val_cat_covariates_contrastive_loss: 638203.3542; val_gene_expr_recon_loss: 39096801.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41499738.6667; val_optim_loss: 41499738.6667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9656; val_auprc_score: 0.9779; val_best_acc_score: 0.9384; val_best_f1_score: 0.9556; train_kl_reg_loss: 23426.5250; train_edge_recon_loss: 1744199.5019; train_cat_covariates_contrastive_loss: 639551.8359; train_gene_expr_recon_loss: 39127338.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41534515.8473; train_optim_loss: 41534515.8473; val_kl_reg_loss: 22835.7057; val_edge_recon_loss: 1761113.4333; val_cat_covariates_contrastive_loss: 634648.3250; val_gene_expr_recon_loss: 39327846.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41746444.2667; val_optim_loss: 41746444.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9659; val_auprc_score: 0.9758; val_best_acc_score: 0.9451; val_best_f1_score: 0.9603; train_kl_reg_loss: 23131.2380; train_edge_recon_loss: 1745408.9599; train_cat_covariates_contrastive_loss: 638038.4117; train_gene_expr_recon_loss: 39104116.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41510694.8092; train_optim_loss: 41510694.8092; val_kl_reg_loss: 23232.7061; val_edge_recon_loss: 1751760.7750; val_cat_covariates_contrastive_loss: 638476.8583; val_gene_expr_recon_loss: 39006866.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41420336.2667; val_optim_loss: 41420336.2667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9685; val_auprc_score: 0.9763; val_best_acc_score: 0.9451; val_best_f1_score: 0.9599; train_kl_reg_loss: 23050.2698; train_edge_recon_loss: 1740947.7844; train_cat_covariates_contrastive_loss: 637229.9284; train_gene_expr_recon_loss: 39087573.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41488801.3130; train_optim_loss: 41488801.3130; val_kl_reg_loss: 23615.2659; val_edge_recon_loss: 1772475.4417; val_cat_covariates_contrastive_loss: 638107.4000; val_gene_expr_recon_loss: 39194934.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41629133.3333; val_optim_loss: 41629133.3333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9611; val_auprc_score: 0.9732; val_best_acc_score: 0.9428; val_best_f1_score: 0.9586; train_kl_reg_loss: 23139.5563; train_edge_recon_loss: 1738068.8244; train_cat_covariates_contrastive_loss: 639365.7982; train_gene_expr_recon_loss: 39052009.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41452583.5115; train_optim_loss: 41452583.5115; val_kl_reg_loss: 23499.8745; val_edge_recon_loss: 1759138.6500; val_cat_covariates_contrastive_loss: 636419.2667; val_gene_expr_recon_loss: 38830517.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41249575.2000; val_optim_loss: 41249575.2000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9663; val_auprc_score: 0.9774; val_best_acc_score: 0.9474; val_best_f1_score: 0.9621; train_kl_reg_loss: 22981.9352; train_edge_recon_loss: 1742202.5401; train_cat_covariates_contrastive_loss: 637150.3030; train_gene_expr_recon_loss: 39010482.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41412817.1298; train_optim_loss: 41412817.1298; val_kl_reg_loss: 22991.4596; val_edge_recon_loss: 1756472.2167; val_cat_covariates_contrastive_loss: 637967.6625; val_gene_expr_recon_loss: 39060804.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41478235.7333; val_optim_loss: 41478235.7333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9685; val_auprc_score: 0.9792; val_best_acc_score: 0.9481; val_best_f1_score: 0.9625; train_kl_reg_loss: 22780.8593; train_edge_recon_loss: 1737904.2557; train_cat_covariates_contrastive_loss: 638194.9757; train_gene_expr_recon_loss: 38988805.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41387685.0382; train_optim_loss: 41387685.0382; val_kl_reg_loss: 22524.5152; val_edge_recon_loss: 1739185.4750; val_cat_covariates_contrastive_loss: 638486.1917; val_gene_expr_recon_loss: 38882961.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41283157.8667; val_optim_loss: 41283157.8667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9628; val_auprc_score: 0.9712; val_best_acc_score: 0.9434; val_best_f1_score: 0.9587; train_kl_reg_loss: 22669.6676; train_edge_recon_loss: 1743676.6031; train_cat_covariates_contrastive_loss: 637929.0205; train_gene_expr_recon_loss: 38990447.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41394723.1145; train_optim_loss: 41394723.1145; val_kl_reg_loss: 22566.0072; val_edge_recon_loss: 1800643.3833; val_cat_covariates_contrastive_loss: 637078.6167; val_gene_expr_recon_loss: 38888902.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41349190.9333; val_optim_loss: 41349190.9333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9681; val_auprc_score: 0.9788; val_best_acc_score: 0.9475; val_best_f1_score: 0.9621; train_kl_reg_loss: 22692.5133; train_edge_recon_loss: 1737302.7519; train_cat_covariates_contrastive_loss: 638116.3373; train_gene_expr_recon_loss: 38952601.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41350713.4656; train_optim_loss: 41350713.4656; val_kl_reg_loss: 22926.1214; val_edge_recon_loss: 1760996.8583; val_cat_covariates_contrastive_loss: 637982.9958; val_gene_expr_recon_loss: 39136949.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41558856.2667; val_optim_loss: 41558856.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9696; val_auprc_score: 0.9781; val_best_acc_score: 0.9510; val_best_f1_score: 0.9643; train_kl_reg_loss: 22888.9348; train_edge_recon_loss: 1755929.9800; train_cat_covariates_contrastive_loss: 638215.9919; train_gene_expr_recon_loss: 38895841.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41312876.5496; train_optim_loss: 41312876.5496; val_kl_reg_loss: 22942.2042; val_edge_recon_loss: 1742763.4250; val_cat_covariates_contrastive_loss: 637942.0583; val_gene_expr_recon_loss: 38876821.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41280468.2667; val_optim_loss: 41280468.2667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9689; val_auprc_score: 0.9781; val_best_acc_score: 0.9485; val_best_f1_score: 0.9628; train_kl_reg_loss: 22893.0939; train_edge_recon_loss: 1737991.9113; train_cat_covariates_contrastive_loss: 638087.5205; train_gene_expr_recon_loss: 38876913.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41275886.1374; train_optim_loss: 41275886.1374; val_kl_reg_loss: 22997.7682; val_edge_recon_loss: 1754839.9250; val_cat_covariates_contrastive_loss: 635011.5250; val_gene_expr_recon_loss: 38911084.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41323932.8000; val_optim_loss: 41323932.8000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9585; val_auprc_score: 0.9715; val_best_acc_score: 0.9412; val_best_f1_score: 0.9576; train_kl_reg_loss: 22950.4619; train_edge_recon_loss: 1728675.5534; train_cat_covariates_contrastive_loss: 638064.1508; train_gene_expr_recon_loss: 38872910.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41262600.4580; train_optim_loss: 41262600.4580; val_kl_reg_loss: 22965.2167; val_edge_recon_loss: 1762217.1500; val_cat_covariates_contrastive_loss: 636880.8583; val_gene_expr_recon_loss: 38955032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41377095.7333; val_optim_loss: 41377095.7333
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9666; val_auprc_score: 0.9780; val_best_acc_score: 0.9448; val_best_f1_score: 0.9602; train_kl_reg_loss: 22863.0381; train_edge_recon_loss: 1740427.3101; train_cat_covariates_contrastive_loss: 638415.0191; train_gene_expr_recon_loss: 38884781.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41286486.5649; train_optim_loss: 41286486.5649; val_kl_reg_loss: 22754.4303; val_edge_recon_loss: 1754538.0583; val_cat_covariates_contrastive_loss: 646660.8458; val_gene_expr_recon_loss: 38870628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41294580.8000; val_optim_loss: 41294580.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 67 min 16 sec.
Using best model state, which was in epoch 57.

--- MODEL EVALUATION ---
val AUROC score: 0.9643
val AUPRC score: 0.9747
val best accuracy score: 0.9421
val best F1 score: 0.9576
val target rna MSE score: 374.7597
val source rna MSE score: 62.2211
Val cat covariate0 mean sim diff: 0.0059
Val cat covariate1 mean sim diff: -0.0376
Duration of model training in run 2: 1 hours, 8 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
