Run timestamp: 30082023_173911_5.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '8', '--edge_batch_size_list', '256', '256', '--node_batch_size_list', 'None', 'None', '--seeds', '3', '2', '--run_index', '4', '3', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9649; val_auprc_score: 0.9864; val_best_acc_score: 0.9358; val_best_f1_score: 0.9589; train_kl_reg_loss: 15288.7187; train_edge_recon_loss: 1357691.5296; train_cat_covariates_contrastive_loss: 639296.1623; train_gene_expr_recon_loss: 2680113.8293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4692390.2443; train_optim_loss: 4692390.2443; val_kl_reg_loss: 17814.8332; val_edge_recon_loss: 1339304.6713; val_cat_covariates_contrastive_loss: 641471.9171; val_gene_expr_recon_loss: 2353418.1144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4352009.5248; val_optim_loss: 4352009.5248
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9690; val_auprc_score: 0.9877; val_best_acc_score: 0.9426; val_best_f1_score: 0.9630; train_kl_reg_loss: 21167.1776; train_edge_recon_loss: 1325434.1185; train_cat_covariates_contrastive_loss: 640597.0869; train_gene_expr_recon_loss: 2207394.1397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4194592.5209; train_optim_loss: 4194592.5209; val_kl_reg_loss: 22333.2516; val_edge_recon_loss: 1338227.5282; val_cat_covariates_contrastive_loss: 641856.3113; val_gene_expr_recon_loss: 2131059.4752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4133476.5564; val_optim_loss: 4133476.5564
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9705; val_auprc_score: 0.9883; val_best_acc_score: 0.9450; val_best_f1_score: 0.9645; train_kl_reg_loss: 24337.6236; train_edge_recon_loss: 1323879.3118; train_cat_covariates_contrastive_loss: 640854.2299; train_gene_expr_recon_loss: 2094519.9764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4083591.1399; train_optim_loss: 4083591.1399; val_kl_reg_loss: 25147.6648; val_edge_recon_loss: 1331256.9958; val_cat_covariates_contrastive_loss: 641705.2080; val_gene_expr_recon_loss: 2075965.8943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4074075.7634; val_optim_loss: 4074075.7634
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9724; val_auprc_score: 0.9893; val_best_acc_score: 0.9422; val_best_f1_score: 0.9628; train_kl_reg_loss: 26034.9486; train_edge_recon_loss: 1319795.4511; train_cat_covariates_contrastive_loss: 641288.9035; train_gene_expr_recon_loss: 2053401.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4040521.1446; train_optim_loss: 4040521.1446; val_kl_reg_loss: 25463.1755; val_edge_recon_loss: 1334801.7428; val_cat_covariates_contrastive_loss: 644238.9865; val_gene_expr_recon_loss: 2058927.9349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4063431.8376; val_optim_loss: 4063431.8376
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9688; val_auprc_score: 0.9871; val_best_acc_score: 0.9459; val_best_f1_score: 0.9650; train_kl_reg_loss: 27117.4491; train_edge_recon_loss: 1321694.9074; train_cat_covariates_contrastive_loss: 641257.7649; train_gene_expr_recon_loss: 2031473.0493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4021543.1706; train_optim_loss: 4021543.1706; val_kl_reg_loss: 28186.7775; val_edge_recon_loss: 1336428.5552; val_cat_covariates_contrastive_loss: 640653.1239; val_gene_expr_recon_loss: 2039397.4916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4044665.9525; val_optim_loss: 4044665.9525
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9695; val_auprc_score: 0.9878; val_best_acc_score: 0.9448; val_best_f1_score: 0.9644; train_kl_reg_loss: 28132.3622; train_edge_recon_loss: 1320734.6542; train_cat_covariates_contrastive_loss: 641464.0606; train_gene_expr_recon_loss: 2018652.0178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4008983.0945; train_optim_loss: 4008983.0945; val_kl_reg_loss: 28806.2632; val_edge_recon_loss: 1329863.2571; val_cat_covariates_contrastive_loss: 641022.6952; val_gene_expr_recon_loss: 2024758.5827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4024450.8025; val_optim_loss: 4024450.8025
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9721; val_auprc_score: 0.9888; val_best_acc_score: 0.9464; val_best_f1_score: 0.9654; train_kl_reg_loss: 28921.0488; train_edge_recon_loss: 1317989.3103; train_cat_covariates_contrastive_loss: 641767.3887; train_gene_expr_recon_loss: 2007560.6065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3996238.3563; train_optim_loss: 3996238.3563; val_kl_reg_loss: 29255.6955; val_edge_recon_loss: 1323104.2228; val_cat_covariates_contrastive_loss: 643528.0438; val_gene_expr_recon_loss: 2017658.7777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4013546.7441; val_optim_loss: 4013546.7441
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9700; val_auprc_score: 0.9876; val_best_acc_score: 0.9473; val_best_f1_score: 0.9659; train_kl_reg_loss: 29599.9965; train_edge_recon_loss: 1318735.1534; train_cat_covariates_contrastive_loss: 642016.4299; train_gene_expr_recon_loss: 2000217.4252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3990569.0061; train_optim_loss: 3990569.0061; val_kl_reg_loss: 30735.3008; val_edge_recon_loss: 1336217.9991; val_cat_covariates_contrastive_loss: 641998.5218; val_gene_expr_recon_loss: 1999619.0574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4008570.8748; val_optim_loss: 4008570.8748
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9707; val_auprc_score: 0.9881; val_best_acc_score: 0.9493; val_best_f1_score: 0.9673; train_kl_reg_loss: 30302.5144; train_edge_recon_loss: 1317570.1985; train_cat_covariates_contrastive_loss: 642166.3132; train_gene_expr_recon_loss: 1991715.0926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3981754.1207; train_optim_loss: 3981754.1207; val_kl_reg_loss: 31432.7861; val_edge_recon_loss: 1324307.4676; val_cat_covariates_contrastive_loss: 641196.4276; val_gene_expr_recon_loss: 2010944.9597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4007881.6342; val_optim_loss: 4007881.6342
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9709; val_auprc_score: 0.9880; val_best_acc_score: 0.9504; val_best_f1_score: 0.9680; train_kl_reg_loss: 30933.3102; train_edge_recon_loss: 1318416.9029; train_cat_covariates_contrastive_loss: 642336.4902; train_gene_expr_recon_loss: 1986206.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3977893.5927; train_optim_loss: 3977893.5927; val_kl_reg_loss: 32022.7236; val_edge_recon_loss: 1323722.8559; val_cat_covariates_contrastive_loss: 641899.2639; val_gene_expr_recon_loss: 1986586.7856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3984231.6282; val_optim_loss: 3984231.6282
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9741; val_auprc_score: 0.9893; val_best_acc_score: 0.9529; val_best_f1_score: 0.9696; train_kl_reg_loss: 31344.4324; train_edge_recon_loss: 1314715.1535; train_cat_covariates_contrastive_loss: 642506.0413; train_gene_expr_recon_loss: 1982004.7990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3970570.4264; train_optim_loss: 3970570.4264; val_kl_reg_loss: 30905.7472; val_edge_recon_loss: 1326442.0267; val_cat_covariates_contrastive_loss: 645197.8485; val_gene_expr_recon_loss: 1980366.6208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3982912.2376; val_optim_loss: 3982912.2376
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9739; val_auprc_score: 0.9893; val_best_acc_score: 0.9516; val_best_f1_score: 0.9687; train_kl_reg_loss: 31916.7931; train_edge_recon_loss: 1317793.5003; train_cat_covariates_contrastive_loss: 642810.1160; train_gene_expr_recon_loss: 1974329.6527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3966850.0616; train_optim_loss: 3966850.0616; val_kl_reg_loss: 32449.8895; val_edge_recon_loss: 1328940.1636; val_cat_covariates_contrastive_loss: 643465.4691; val_gene_expr_recon_loss: 1979863.7616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3984719.2812; val_optim_loss: 3984719.2812
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9716; val_auprc_score: 0.9881; val_best_acc_score: 0.9508; val_best_f1_score: 0.9682; train_kl_reg_loss: 32309.5835; train_edge_recon_loss: 1319778.2003; train_cat_covariates_contrastive_loss: 642929.1354; train_gene_expr_recon_loss: 1972907.3845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3967924.3036; train_optim_loss: 3967924.3036; val_kl_reg_loss: 32685.7964; val_edge_recon_loss: 1332961.4220; val_cat_covariates_contrastive_loss: 643639.8988; val_gene_expr_recon_loss: 1976755.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3986042.9748; val_optim_loss: 3986042.9748
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9690; val_auprc_score: 0.9870; val_best_acc_score: 0.9516; val_best_f1_score: 0.9686; train_kl_reg_loss: 32785.6529; train_edge_recon_loss: 1318411.4450; train_cat_covariates_contrastive_loss: 642910.1650; train_gene_expr_recon_loss: 1965948.0958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3960055.3606; train_optim_loss: 3960055.3606; val_kl_reg_loss: 32111.7892; val_edge_recon_loss: 1321783.4873; val_cat_covariates_contrastive_loss: 642274.1225; val_gene_expr_recon_loss: 1968540.4319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3964709.8307; val_optim_loss: 3964709.8307
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9690; val_auprc_score: 0.9869; val_best_acc_score: 0.9517; val_best_f1_score: 0.9688; train_kl_reg_loss: 33123.5356; train_edge_recon_loss: 1317345.0724; train_cat_covariates_contrastive_loss: 643068.5177; train_gene_expr_recon_loss: 1965468.2835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3959005.4103; train_optim_loss: 3959005.4103; val_kl_reg_loss: 34127.0311; val_edge_recon_loss: 1328968.8270; val_cat_covariates_contrastive_loss: 641341.9807; val_gene_expr_recon_loss: 1972929.1337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3977366.9713; val_optim_loss: 3977366.9713
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9717; val_auprc_score: 0.9880; val_best_acc_score: 0.9537; val_best_f1_score: 0.9700; train_kl_reg_loss: 33351.5989; train_edge_recon_loss: 1318647.3728; train_cat_covariates_contrastive_loss: 643059.2649; train_gene_expr_recon_loss: 1958467.7501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3953525.9872; train_optim_loss: 3953525.9872; val_kl_reg_loss: 33778.3670; val_edge_recon_loss: 1327355.3981; val_cat_covariates_contrastive_loss: 642644.7386; val_gene_expr_recon_loss: 2003297.0092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4007075.5193; val_optim_loss: 4007075.5193
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9712; val_auprc_score: 0.9878; val_best_acc_score: 0.9534; val_best_f1_score: 0.9699; train_kl_reg_loss: 34225.7380; train_edge_recon_loss: 1319297.8684; train_cat_covariates_contrastive_loss: 643364.3415; train_gene_expr_recon_loss: 1960243.3522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3957131.2987; train_optim_loss: 3957131.2987; val_kl_reg_loss: 34251.1354; val_edge_recon_loss: 1332416.1587; val_cat_covariates_contrastive_loss: 643136.2150; val_gene_expr_recon_loss: 1966506.3700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3976309.8777; val_optim_loss: 3976309.8777
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9680; val_auprc_score: 0.9863; val_best_acc_score: 0.9516; val_best_f1_score: 0.9688; train_kl_reg_loss: 34568.0228; train_edge_recon_loss: 1316879.6932; train_cat_covariates_contrastive_loss: 643449.3500; train_gene_expr_recon_loss: 1958687.6122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3953584.6781; train_optim_loss: 3953584.6781; val_kl_reg_loss: 36312.2521; val_edge_recon_loss: 1335953.2079; val_cat_covariates_contrastive_loss: 642654.5671; val_gene_expr_recon_loss: 1979821.0399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3994741.0644; val_optim_loss: 3994741.0644

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9739; val_auprc_score: 0.9891; val_best_acc_score: 0.9544; val_best_f1_score: 0.9705; train_kl_reg_loss: 35171.6677; train_edge_recon_loss: 1316631.1928; train_cat_covariates_contrastive_loss: 643917.4298; train_gene_expr_recon_loss: 1907886.9381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3903607.2266; train_optim_loss: 3903607.2266; val_kl_reg_loss: 34480.6629; val_edge_recon_loss: 1315373.9025; val_cat_covariates_contrastive_loss: 645045.0563; val_gene_expr_recon_loss: 1916462.5119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3911362.1347; val_optim_loss: 3911362.1347
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9727; val_auprc_score: 0.9883; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 34192.1336; train_edge_recon_loss: 1315514.0867; train_cat_covariates_contrastive_loss: 643535.7114; train_gene_expr_recon_loss: 1892490.8514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3885732.7817; train_optim_loss: 3885732.7817; val_kl_reg_loss: 34202.9793; val_edge_recon_loss: 1322236.1955; val_cat_covariates_contrastive_loss: 643185.9275; val_gene_expr_recon_loss: 1909204.8092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3908829.9099; val_optim_loss: 3908829.9099
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9721; val_auprc_score: 0.9882; val_best_acc_score: 0.9549; val_best_f1_score: 0.9709; train_kl_reg_loss: 33345.9638; train_edge_recon_loss: 1312509.9588; train_cat_covariates_contrastive_loss: 643231.9108; train_gene_expr_recon_loss: 1887161.3439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3876249.1764; train_optim_loss: 3876249.1764; val_kl_reg_loss: 32849.4442; val_edge_recon_loss: 1317561.7938; val_cat_covariates_contrastive_loss: 643410.5054; val_gene_expr_recon_loss: 1906841.9295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3900663.6708; val_optim_loss: 3900663.6708
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9728; val_auprc_score: 0.9885; val_best_acc_score: 0.9556; val_best_f1_score: 0.9713; train_kl_reg_loss: 32724.6386; train_edge_recon_loss: 1314248.9850; train_cat_covariates_contrastive_loss: 642896.7671; train_gene_expr_recon_loss: 1883650.2037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3873520.5951; train_optim_loss: 3873520.5951; val_kl_reg_loss: 32362.3985; val_edge_recon_loss: 1322123.6186; val_cat_covariates_contrastive_loss: 643128.2450; val_gene_expr_recon_loss: 1902184.5817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3899798.8480; val_optim_loss: 3899798.8480
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9720; val_auprc_score: 0.9881; val_best_acc_score: 0.9554; val_best_f1_score: 0.9712; train_kl_reg_loss: 32184.5434; train_edge_recon_loss: 1311077.7863; train_cat_covariates_contrastive_loss: 642506.7266; train_gene_expr_recon_loss: 1881590.5517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3867359.6094; train_optim_loss: 3867359.6094; val_kl_reg_loss: 32172.6641; val_edge_recon_loss: 1323711.8291; val_cat_covariates_contrastive_loss: 642193.4726; val_gene_expr_recon_loss: 1902499.5488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3900577.5129; val_optim_loss: 3900577.5129
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9738; val_auprc_score: 0.9887; val_best_acc_score: 0.9562; val_best_f1_score: 0.9717; train_kl_reg_loss: 31765.2046; train_edge_recon_loss: 1311288.1576; train_cat_covariates_contrastive_loss: 642341.6968; train_gene_expr_recon_loss: 1879967.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3865362.8402; train_optim_loss: 3865362.8402; val_kl_reg_loss: 30941.1869; val_edge_recon_loss: 1316245.0691; val_cat_covariates_contrastive_loss: 643161.7156; val_gene_expr_recon_loss: 1900004.3577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3890352.3317; val_optim_loss: 3890352.3317
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9730; val_auprc_score: 0.9884; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 31340.1785; train_edge_recon_loss: 1312979.8276; train_cat_covariates_contrastive_loss: 642000.6461; train_gene_expr_recon_loss: 1877360.9075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3863681.5564; train_optim_loss: 3863681.5564; val_kl_reg_loss: 31283.4309; val_edge_recon_loss: 1316978.9506; val_cat_covariates_contrastive_loss: 641490.6502; val_gene_expr_recon_loss: 1899395.6431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3889148.6797; val_optim_loss: 3889148.6797
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9737; val_auprc_score: 0.9886; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 31027.3396; train_edge_recon_loss: 1311174.6845; train_cat_covariates_contrastive_loss: 641836.4298; train_gene_expr_recon_loss: 1876618.5112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3860656.9657; train_optim_loss: 3860656.9657; val_kl_reg_loss: 31210.4457; val_edge_recon_loss: 1315829.9053; val_cat_covariates_contrastive_loss: 641720.2627; val_gene_expr_recon_loss: 1899628.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3888388.7396; val_optim_loss: 3888388.7396
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9741; val_auprc_score: 0.9890; val_best_acc_score: 0.9557; val_best_f1_score: 0.9714; train_kl_reg_loss: 30569.5642; train_edge_recon_loss: 1312125.7909; train_cat_covariates_contrastive_loss: 641547.0624; train_gene_expr_recon_loss: 1875063.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3859306.0467; train_optim_loss: 3859306.0467; val_kl_reg_loss: 30364.5730; val_edge_recon_loss: 1321502.6171; val_cat_covariates_contrastive_loss: 642415.3219; val_gene_expr_recon_loss: 1898067.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3892350.1035; val_optim_loss: 3892350.1035
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9740; val_auprc_score: 0.9890; val_best_acc_score: 0.9567; val_best_f1_score: 0.9719; train_kl_reg_loss: 30243.2398; train_edge_recon_loss: 1312296.6423; train_cat_covariates_contrastive_loss: 641339.4238; train_gene_expr_recon_loss: 1875123.6093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3859002.9149; train_optim_loss: 3859002.9149; val_kl_reg_loss: 29808.1109; val_edge_recon_loss: 1317306.2345; val_cat_covariates_contrastive_loss: 641346.2024; val_gene_expr_recon_loss: 1895041.6218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3883502.1609; val_optim_loss: 3883502.1609
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9725; val_auprc_score: 0.9881; val_best_acc_score: 0.9551; val_best_f1_score: 0.9709; train_kl_reg_loss: 29901.8238; train_edge_recon_loss: 1312784.9480; train_cat_covariates_contrastive_loss: 641122.5054; train_gene_expr_recon_loss: 1872501.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3856310.3462; train_optim_loss: 3856310.3462; val_kl_reg_loss: 30004.1316; val_edge_recon_loss: 1327117.0006; val_cat_covariates_contrastive_loss: 641037.2679; val_gene_expr_recon_loss: 1894463.9931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3892622.3916; val_optim_loss: 3892622.3916
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9732; val_auprc_score: 0.9885; val_best_acc_score: 0.9558; val_best_f1_score: 0.9713; train_kl_reg_loss: 29603.1562; train_edge_recon_loss: 1309650.9588; train_cat_covariates_contrastive_loss: 641054.9437; train_gene_expr_recon_loss: 1872895.5874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3853204.6459; train_optim_loss: 3853204.6459; val_kl_reg_loss: 29482.2544; val_edge_recon_loss: 1327806.4999; val_cat_covariates_contrastive_loss: 641209.4219; val_gene_expr_recon_loss: 1893898.7983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3892396.9743; val_optim_loss: 3892396.9743
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9728; val_auprc_score: 0.9882; val_best_acc_score: 0.9570; val_best_f1_score: 0.9722; train_kl_reg_loss: 29380.8136; train_edge_recon_loss: 1312671.6464; train_cat_covariates_contrastive_loss: 640861.5361; train_gene_expr_recon_loss: 1871260.0926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3854174.0871; train_optim_loss: 3854174.0871; val_kl_reg_loss: 29296.4752; val_edge_recon_loss: 1322171.6394; val_cat_covariates_contrastive_loss: 640718.2498; val_gene_expr_recon_loss: 1893567.5653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3885753.9327; val_optim_loss: 3885753.9327
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9712; val_auprc_score: 0.9879; val_best_acc_score: 0.9552; val_best_f1_score: 0.9710; train_kl_reg_loss: 29145.9407; train_edge_recon_loss: 1312984.2501; train_cat_covariates_contrastive_loss: 640675.7214; train_gene_expr_recon_loss: 1870353.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3853159.1349; train_optim_loss: 3853159.1349; val_kl_reg_loss: 29087.7952; val_edge_recon_loss: 1317957.4396; val_cat_covariates_contrastive_loss: 640465.2535; val_gene_expr_recon_loss: 1893654.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3881165.1772; val_optim_loss: 3881165.1772
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9728; val_auprc_score: 0.9883; val_best_acc_score: 0.9560; val_best_f1_score: 0.9715; train_kl_reg_loss: 28887.9988; train_edge_recon_loss: 1312505.1652; train_cat_covariates_contrastive_loss: 640603.2682; train_gene_expr_recon_loss: 1870308.1622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3852304.5934; train_optim_loss: 3852304.5934; val_kl_reg_loss: 28622.0071; val_edge_recon_loss: 1317692.3666; val_cat_covariates_contrastive_loss: 640747.6816; val_gene_expr_recon_loss: 1893371.2668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3880433.3203; val_optim_loss: 3880433.3203
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9724; val_auprc_score: 0.9879; val_best_acc_score: 0.9558; val_best_f1_score: 0.9715; train_kl_reg_loss: 28632.6058; train_edge_recon_loss: 1309533.8407; train_cat_covariates_contrastive_loss: 640453.8968; train_gene_expr_recon_loss: 1869414.3082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3848034.6500; train_optim_loss: 3848034.6500; val_kl_reg_loss: 28611.1449; val_edge_recon_loss: 1320836.5816; val_cat_covariates_contrastive_loss: 640126.3141; val_gene_expr_recon_loss: 1891181.9161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3880755.9540; val_optim_loss: 3880755.9540
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9741; val_auprc_score: 0.9890; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 28437.0519; train_edge_recon_loss: 1310578.9447; train_cat_covariates_contrastive_loss: 640238.7658; train_gene_expr_recon_loss: 1868049.9770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3847304.7391; train_optim_loss: 3847304.7391; val_kl_reg_loss: 28027.3426; val_edge_recon_loss: 1316003.2651; val_cat_covariates_contrastive_loss: 641103.0866; val_gene_expr_recon_loss: 1888247.4042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3873381.1015; val_optim_loss: 3873381.1015
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9743; val_auprc_score: 0.9891; val_best_acc_score: 0.9560; val_best_f1_score: 0.9715; train_kl_reg_loss: 28193.3248; train_edge_recon_loss: 1309853.6280; train_cat_covariates_contrastive_loss: 640116.5300; train_gene_expr_recon_loss: 1867995.7347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3846159.2161; train_optim_loss: 3846159.2161; val_kl_reg_loss: 28082.6726; val_edge_recon_loss: 1320141.1394; val_cat_covariates_contrastive_loss: 640247.7453; val_gene_expr_recon_loss: 1890852.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3879323.6832; val_optim_loss: 3879323.6832
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9725; val_auprc_score: 0.9882; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 28034.7594; train_edge_recon_loss: 1310330.4689; train_cat_covariates_contrastive_loss: 639955.6147; train_gene_expr_recon_loss: 1866801.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3845122.6517; train_optim_loss: 3845122.6517; val_kl_reg_loss: 28370.1831; val_edge_recon_loss: 1318974.8052; val_cat_covariates_contrastive_loss: 639510.8212; val_gene_expr_recon_loss: 1891225.0485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3878080.8639; val_optim_loss: 3878080.8639
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9715; val_auprc_score: 0.9878; val_best_acc_score: 0.9554; val_best_f1_score: 0.9712; train_kl_reg_loss: 27773.7072; train_edge_recon_loss: 1309596.1086; train_cat_covariates_contrastive_loss: 639734.8569; train_gene_expr_recon_loss: 1866494.4377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3843599.1114; train_optim_loss: 3843599.1114; val_kl_reg_loss: 27821.2287; val_edge_recon_loss: 1318160.8129; val_cat_covariates_contrastive_loss: 639539.3251; val_gene_expr_recon_loss: 1890350.2542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3875871.6153; val_optim_loss: 3875871.6153
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9724; val_auprc_score: 0.9882; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 27560.4792; train_edge_recon_loss: 1309863.5085; train_cat_covariates_contrastive_loss: 639702.2422; train_gene_expr_recon_loss: 1866513.5728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3843639.8028; train_optim_loss: 3843639.8028; val_kl_reg_loss: 27839.2174; val_edge_recon_loss: 1318292.7275; val_cat_covariates_contrastive_loss: 639334.0082; val_gene_expr_recon_loss: 1889948.6144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3875414.5644; val_optim_loss: 3875414.5644

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9738; val_auprc_score: 0.9889; val_best_acc_score: 0.9572; val_best_f1_score: 0.9723; train_kl_reg_loss: 27469.0656; train_edge_recon_loss: 1309824.7109; train_cat_covariates_contrastive_loss: 639772.1591; train_gene_expr_recon_loss: 1859147.5379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3836213.4726; train_optim_loss: 3836213.4726; val_kl_reg_loss: 27671.0819; val_edge_recon_loss: 1319787.3929; val_cat_covariates_contrastive_loss: 639503.4897; val_gene_expr_recon_loss: 1887009.8191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3873971.7832; val_optim_loss: 3873971.7832
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9733; val_auprc_score: 0.9885; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 27481.8702; train_edge_recon_loss: 1309587.4142; train_cat_covariates_contrastive_loss: 639575.3668; train_gene_expr_recon_loss: 1858588.3937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3835233.0426; train_optim_loss: 3835233.0426; val_kl_reg_loss: 27508.2349; val_edge_recon_loss: 1316417.2478; val_cat_covariates_contrastive_loss: 639900.4547; val_gene_expr_recon_loss: 1885321.5027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3869147.4381; val_optim_loss: 3869147.4381
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9727; val_auprc_score: 0.9884; val_best_acc_score: 0.9567; val_best_f1_score: 0.9720; train_kl_reg_loss: 27450.8616; train_edge_recon_loss: 1310230.0336; train_cat_covariates_contrastive_loss: 639721.2174; train_gene_expr_recon_loss: 1858183.9451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3835586.0576; train_optim_loss: 3835586.0576; val_kl_reg_loss: 27507.2208; val_edge_recon_loss: 1311031.9339; val_cat_covariates_contrastive_loss: 639254.9531; val_gene_expr_recon_loss: 1885328.9302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3863123.0421; val_optim_loss: 3863123.0421
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9726; val_auprc_score: 0.9882; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 27377.1328; train_edge_recon_loss: 1308079.1009; train_cat_covariates_contrastive_loss: 639683.9691; train_gene_expr_recon_loss: 1858115.0235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833255.2262; train_optim_loss: 3833255.2262; val_kl_reg_loss: 27444.7234; val_edge_recon_loss: 1318152.8248; val_cat_covariates_contrastive_loss: 639159.0948; val_gene_expr_recon_loss: 1884874.7983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3869631.4361; val_optim_loss: 3869631.4361
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9721; val_auprc_score: 0.9877; val_best_acc_score: 0.9562; val_best_f1_score: 0.9716; train_kl_reg_loss: 27358.6888; train_edge_recon_loss: 1310048.5363; train_cat_covariates_contrastive_loss: 639503.2543; train_gene_expr_recon_loss: 1858003.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3834914.3685; train_optim_loss: 3834914.3685; val_kl_reg_loss: 27292.7407; val_edge_recon_loss: 1324339.3713; val_cat_covariates_contrastive_loss: 639418.6647; val_gene_expr_recon_loss: 1881933.5252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3872984.3015; val_optim_loss: 3872984.3015
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9732; val_auprc_score: 0.9883; val_best_acc_score: 0.9571; val_best_f1_score: 0.9722; train_kl_reg_loss: 27343.7231; train_edge_recon_loss: 1307744.9724; train_cat_covariates_contrastive_loss: 639687.7245; train_gene_expr_recon_loss: 1858269.4044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833045.8276; train_optim_loss: 3833045.8276; val_kl_reg_loss: 27407.0988; val_edge_recon_loss: 1323027.9759; val_cat_covariates_contrastive_loss: 639825.3740; val_gene_expr_recon_loss: 1883597.8700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3873858.3203; val_optim_loss: 3873858.3203
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9728; val_auprc_score: 0.9883; val_best_acc_score: 0.9570; val_best_f1_score: 0.9721; train_kl_reg_loss: 27333.6944; train_edge_recon_loss: 1311739.5528; train_cat_covariates_contrastive_loss: 639544.0008; train_gene_expr_recon_loss: 1857817.5369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3836434.7864; train_optim_loss: 3836434.7864; val_kl_reg_loss: 27488.8469; val_edge_recon_loss: 1321166.6009; val_cat_covariates_contrastive_loss: 639288.8313; val_gene_expr_recon_loss: 1882481.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3870425.7005; val_optim_loss: 3870425.7005

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9729; val_auprc_score: 0.9883; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 27343.3404; train_edge_recon_loss: 1309979.0355; train_cat_covariates_contrastive_loss: 639459.8741; train_gene_expr_recon_loss: 1857089.3845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833871.6369; train_optim_loss: 3833871.6369; val_kl_reg_loss: 27412.5655; val_edge_recon_loss: 1322708.3453; val_cat_covariates_contrastive_loss: 639429.1127; val_gene_expr_recon_loss: 1883396.4906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3872946.5208; val_optim_loss: 3872946.5208
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9727; val_auprc_score: 0.9882; val_best_acc_score: 0.9573; val_best_f1_score: 0.9724; train_kl_reg_loss: 27336.2720; train_edge_recon_loss: 1306873.8612; train_cat_covariates_contrastive_loss: 639660.5171; train_gene_expr_recon_loss: 1857416.4218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3831287.0717; train_optim_loss: 3831287.0717; val_kl_reg_loss: 27441.2306; val_edge_recon_loss: 1316012.1030; val_cat_covariates_contrastive_loss: 639077.4347; val_gene_expr_recon_loss: 1885330.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3867861.3030; val_optim_loss: 3867861.3030
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9732; val_auprc_score: 0.9885; val_best_acc_score: 0.9568; val_best_f1_score: 0.9720; train_kl_reg_loss: 27343.5437; train_edge_recon_loss: 1308926.4053; train_cat_covariates_contrastive_loss: 639656.5332; train_gene_expr_recon_loss: 1857182.8388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833109.3200; train_optim_loss: 3833109.3200; val_kl_reg_loss: 27447.5805; val_edge_recon_loss: 1323413.3543; val_cat_covariates_contrastive_loss: 639476.4436; val_gene_expr_recon_loss: 1882622.2094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3872959.5876; val_optim_loss: 3872959.5876
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9734; val_auprc_score: 0.9886; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 27337.7131; train_edge_recon_loss: 1310864.5725; train_cat_covariates_contrastive_loss: 639494.8230; train_gene_expr_recon_loss: 1857884.8732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3835581.9810; train_optim_loss: 3835581.9810; val_kl_reg_loss: 27373.5935; val_edge_recon_loss: 1315754.4312; val_cat_covariates_contrastive_loss: 639524.0212; val_gene_expr_recon_loss: 1884863.1015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3867515.1520; val_optim_loss: 3867515.1520

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1168 min 42 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9326
val AUPRC score: 0.9612
val best accuracy score: 0.9435
val best F1 score: 0.9631
val target rna MSE score: 0.5091
val source rna MSE score: 0.0886
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.1021
Duration of model training in run 4: 19 hours, 35 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9668; val_auprc_score: 0.9874; val_best_acc_score: 0.9377; val_best_f1_score: 0.9600; train_kl_reg_loss: 15661.7421; train_edge_recon_loss: 1354097.1809; train_cat_covariates_contrastive_loss: 639627.3984; train_gene_expr_recon_loss: 2665491.4366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4674877.7588; train_optim_loss: 4674877.7588; val_kl_reg_loss: 18330.6519; val_edge_recon_loss: 1333537.0356; val_cat_covariates_contrastive_loss: 640877.9835; val_gene_expr_recon_loss: 2328332.8431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4321078.5074; val_optim_loss: 4321078.5074
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9629; val_auprc_score: 0.9854; val_best_acc_score: 0.9377; val_best_f1_score: 0.9601; train_kl_reg_loss: 21747.8089; train_edge_recon_loss: 1326397.9640; train_cat_covariates_contrastive_loss: 640144.3108; train_gene_expr_recon_loss: 2199757.0460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4188047.1252; train_optim_loss: 4188047.1252; val_kl_reg_loss: 25748.4196; val_edge_recon_loss: 1339090.7658; val_cat_covariates_contrastive_loss: 638254.0401; val_gene_expr_recon_loss: 2122920.3460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4126013.5634; val_optim_loss: 4126013.5634
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9662; val_auprc_score: 0.9864; val_best_acc_score: 0.9427; val_best_f1_score: 0.9632; train_kl_reg_loss: 24912.7272; train_edge_recon_loss: 1322710.5294; train_cat_covariates_contrastive_loss: 640438.4134; train_gene_expr_recon_loss: 2086373.7556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4074435.4237; train_optim_loss: 4074435.4237; val_kl_reg_loss: 26230.6560; val_edge_recon_loss: 1338563.8912; val_cat_covariates_contrastive_loss: 639115.5918; val_gene_expr_recon_loss: 2056294.2614; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4060204.4015; val_optim_loss: 4060204.4015
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9691; val_auprc_score: 0.9877; val_best_acc_score: 0.9433; val_best_f1_score: 0.9634; train_kl_reg_loss: 26464.1038; train_edge_recon_loss: 1322091.0381; train_cat_covariates_contrastive_loss: 640827.7429; train_gene_expr_recon_loss: 2047132.8405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4036515.7268; train_optim_loss: 4036515.7268; val_kl_reg_loss: 27185.9690; val_edge_recon_loss: 1334513.7356; val_cat_covariates_contrastive_loss: 641510.0949; val_gene_expr_recon_loss: 2032110.2730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4035320.0777; val_optim_loss: 4035320.0777
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9674; val_auprc_score: 0.9868; val_best_acc_score: 0.9461; val_best_f1_score: 0.9653; train_kl_reg_loss: 27618.8708; train_edge_recon_loss: 1321713.0661; train_cat_covariates_contrastive_loss: 641394.7307; train_gene_expr_recon_loss: 2027573.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4018300.2459; train_optim_loss: 4018300.2459; val_kl_reg_loss: 29527.9222; val_edge_recon_loss: 1331158.4777; val_cat_covariates_contrastive_loss: 639763.5040; val_gene_expr_recon_loss: 2020361.2837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4020811.1931; val_optim_loss: 4020811.1931
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9698; val_auprc_score: 0.9878; val_best_acc_score: 0.9475; val_best_f1_score: 0.9662; train_kl_reg_loss: 28548.4021; train_edge_recon_loss: 1320721.3538; train_cat_covariates_contrastive_loss: 641651.5677; train_gene_expr_recon_loss: 2013706.7408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4004628.0616; train_optim_loss: 4004628.0616; val_kl_reg_loss: 29991.6972; val_edge_recon_loss: 1323540.0121; val_cat_covariates_contrastive_loss: 640609.2021; val_gene_expr_recon_loss: 2012187.3374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4006328.2411; val_optim_loss: 4006328.2411
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9693; val_auprc_score: 0.9876; val_best_acc_score: 0.9463; val_best_f1_score: 0.9653; train_kl_reg_loss: 29387.4779; train_edge_recon_loss: 1320990.9855; train_cat_covariates_contrastive_loss: 641857.4346; train_gene_expr_recon_loss: 2003336.9851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3995572.8806; train_optim_loss: 3995572.8806; val_kl_reg_loss: 29072.8019; val_edge_recon_loss: 1335703.1056; val_cat_covariates_contrastive_loss: 641665.6505; val_gene_expr_recon_loss: 2014717.6057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4021159.1594; val_optim_loss: 4021159.1594
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9711; val_auprc_score: 0.9881; val_best_acc_score: 0.9509; val_best_f1_score: 0.9683; train_kl_reg_loss: 29969.1137; train_edge_recon_loss: 1320002.1350; train_cat_covariates_contrastive_loss: 641976.5439; train_gene_expr_recon_loss: 1994850.8819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3986798.6757; train_optim_loss: 3986798.6757; val_kl_reg_loss: 30060.3255; val_edge_recon_loss: 1328535.7798; val_cat_covariates_contrastive_loss: 641683.3390; val_gene_expr_recon_loss: 2010412.0448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4010691.4896; val_optim_loss: 4010691.4896
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9697; val_auprc_score: 0.9875; val_best_acc_score: 0.9492; val_best_f1_score: 0.9672; train_kl_reg_loss: 30551.5277; train_edge_recon_loss: 1323082.6423; train_cat_covariates_contrastive_loss: 642194.2410; train_gene_expr_recon_loss: 1990070.3361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3985898.7480; train_optim_loss: 3985898.7480; val_kl_reg_loss: 30225.9140; val_edge_recon_loss: 1333867.7193; val_cat_covariates_contrastive_loss: 642558.8854; val_gene_expr_recon_loss: 2002620.0804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4009272.6045; val_optim_loss: 4009272.6045
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9692; val_auprc_score: 0.9870; val_best_acc_score: 0.9502; val_best_f1_score: 0.9679; train_kl_reg_loss: 31020.2061; train_edge_recon_loss: 1319707.2678; train_cat_covariates_contrastive_loss: 642282.7133; train_gene_expr_recon_loss: 1982992.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3976003.0290; train_optim_loss: 3976003.0290; val_kl_reg_loss: 32567.6869; val_edge_recon_loss: 1328932.1641; val_cat_covariates_contrastive_loss: 641111.6759; val_gene_expr_recon_loss: 1981677.3512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3984288.8787; val_optim_loss: 3984288.8787
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9758; val_auprc_score: 0.9904; val_best_acc_score: 0.9484; val_best_f1_score: 0.9666; train_kl_reg_loss: 31711.4227; train_edge_recon_loss: 1317330.1351; train_cat_covariates_contrastive_loss: 642529.7077; train_gene_expr_recon_loss: 1976392.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3967963.4344; train_optim_loss: 3967963.4344; val_kl_reg_loss: 30160.4184; val_edge_recon_loss: 1334924.8141; val_cat_covariates_contrastive_loss: 647631.4821; val_gene_expr_recon_loss: 1974502.1248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3987218.8475; val_optim_loss: 3987218.8475
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9698; val_auprc_score: 0.9875; val_best_acc_score: 0.9504; val_best_f1_score: 0.9679; train_kl_reg_loss: 32014.0347; train_edge_recon_loss: 1320414.9304; train_cat_covariates_contrastive_loss: 642669.2000; train_gene_expr_recon_loss: 1971478.2636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3966576.4295; train_optim_loss: 3966576.4295; val_kl_reg_loss: 31881.6488; val_edge_recon_loss: 1335358.9353; val_cat_covariates_contrastive_loss: 642176.2304; val_gene_expr_recon_loss: 1969302.0720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3978718.8876; val_optim_loss: 3978718.8876
