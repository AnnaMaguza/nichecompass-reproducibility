Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9730; val_auprc_score: 0.9884; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 34473.2348; train_edge_recon_loss: 1313703.1384; train_cat_covariates_contrastive_loss: 643212.8599; train_gene_expr_recon_loss: 1874099.2909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3865488.5241; train_optim_loss: 3865488.5241; val_kl_reg_loss: 34424.7845; val_edge_recon_loss: 1326281.8295; val_cat_covariates_contrastive_loss: 642928.3082; val_gene_expr_recon_loss: 1889135.7834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3892770.7030; val_optim_loss: 3892770.7030
Run timestamp: 01092023_095132_5.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '2', '--run_index', '3', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9662; val_auprc_score: 0.9873; val_best_acc_score: 0.9356; val_best_f1_score: 0.9585; train_kl_reg_loss: 16566.2239; train_edge_recon_loss: 1361207.4872; train_cat_covariates_contrastive_loss: 640901.4420; train_gene_expr_recon_loss: 2657085.7173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4675760.8711; train_optim_loss: 4675760.8711; val_kl_reg_loss: 18789.1820; val_edge_recon_loss: 1334835.5478; val_cat_covariates_contrastive_loss: 640565.3010; val_gene_expr_recon_loss: 2334185.1703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4328375.1965; val_optim_loss: 4328375.1965
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9714; val_auprc_score: 0.9878; val_best_acc_score: 0.9547; val_best_f1_score: 0.9707; train_kl_reg_loss: 34390.9996; train_edge_recon_loss: 1313805.0993; train_cat_covariates_contrastive_loss: 643079.6195; train_gene_expr_recon_loss: 1873601.2119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3864876.9307; train_optim_loss: 3864876.9307; val_kl_reg_loss: 34283.9332; val_edge_recon_loss: 1321699.8853; val_cat_covariates_contrastive_loss: 642544.6777; val_gene_expr_recon_loss: 1889722.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3888250.7649; val_optim_loss: 3888250.7649
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9674; val_auprc_score: 0.9874; val_best_acc_score: 0.9407; val_best_f1_score: 0.9619; train_kl_reg_loss: 21847.3708; train_edge_recon_loss: 1324708.2565; train_cat_covariates_contrastive_loss: 640625.9057; train_gene_expr_recon_loss: 2199415.1051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4186596.6370; train_optim_loss: 4186596.6370; val_kl_reg_loss: 24278.7320; val_edge_recon_loss: 1332648.0813; val_cat_covariates_contrastive_loss: 640949.7241; val_gene_expr_recon_loss: 2130826.3517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4128702.8772; val_optim_loss: 4128702.8772
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9722; val_auprc_score: 0.9881; val_best_acc_score: 0.9559; val_best_f1_score: 0.9715; train_kl_reg_loss: 34256.4107; train_edge_recon_loss: 1313217.5139; train_cat_covariates_contrastive_loss: 643149.2015; train_gene_expr_recon_loss: 1872866.7399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3863489.8671; train_optim_loss: 3863489.8671; val_kl_reg_loss: 34113.6526; val_edge_recon_loss: 1321101.6616; val_cat_covariates_contrastive_loss: 643572.6640; val_gene_expr_recon_loss: 1889901.5361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3888689.5153; val_optim_loss: 3888689.5153
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9698; val_auprc_score: 0.9882; val_best_acc_score: 0.9445; val_best_f1_score: 0.9642; train_kl_reg_loss: 24980.7350; train_edge_recon_loss: 1325121.8818; train_cat_covariates_contrastive_loss: 640839.8958; train_gene_expr_recon_loss: 2087211.4269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4078153.9399; train_optim_loss: 4078153.9399; val_kl_reg_loss: 24853.7105; val_edge_recon_loss: 1329119.0162; val_cat_covariates_contrastive_loss: 643042.9288; val_gene_expr_recon_loss: 2072632.7050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4069648.3515; val_optim_loss: 4069648.3515
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9717; val_auprc_score: 0.9879; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 34173.5251; train_edge_recon_loss: 1314957.1920; train_cat_covariates_contrastive_loss: 643090.1634; train_gene_expr_recon_loss: 1872836.5148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3865057.3980; train_optim_loss: 3865057.3980; val_kl_reg_loss: 34105.2968; val_edge_recon_loss: 1319285.0787; val_cat_covariates_contrastive_loss: 642684.6493; val_gene_expr_recon_loss: 1891900.1829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3887975.2168; val_optim_loss: 3887975.2168
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9686; val_auprc_score: 0.9875; val_best_acc_score: 0.9449; val_best_f1_score: 0.9646; train_kl_reg_loss: 26545.9082; train_edge_recon_loss: 1323367.1907; train_cat_covariates_contrastive_loss: 641075.5865; train_gene_expr_recon_loss: 2047803.5587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4038792.2436; train_optim_loss: 4038792.2436; val_kl_reg_loss: 25960.5842; val_edge_recon_loss: 1341802.7005; val_cat_covariates_contrastive_loss: 641748.3187; val_gene_expr_recon_loss: 2056731.0730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4066242.6752; val_optim_loss: 4066242.6752
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9711; val_auprc_score: 0.9875; val_best_acc_score: 0.9554; val_best_f1_score: 0.9711; train_kl_reg_loss: 34103.4961; train_edge_recon_loss: 1312679.8175; train_cat_covariates_contrastive_loss: 643005.2303; train_gene_expr_recon_loss: 1872598.6202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3862387.1637; train_optim_loss: 3862387.1637; val_kl_reg_loss: 34147.0956; val_edge_recon_loss: 1328566.1999; val_cat_covariates_contrastive_loss: 642503.3402; val_gene_expr_recon_loss: 1887309.7718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3892526.3975; val_optim_loss: 3892526.3975
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9704; val_auprc_score: 0.9882; val_best_acc_score: 0.9462; val_best_f1_score: 0.9653; train_kl_reg_loss: 27628.3084; train_edge_recon_loss: 1324663.5640; train_cat_covariates_contrastive_loss: 641515.6036; train_gene_expr_recon_loss: 2028129.0983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4021936.5759; train_optim_loss: 4021936.5759; val_kl_reg_loss: 27697.6234; val_edge_recon_loss: 1331692.6097; val_cat_covariates_contrastive_loss: 641978.3131; val_gene_expr_recon_loss: 2039241.5856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4040610.1342; val_optim_loss: 4040610.1342
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9732; val_auprc_score: 0.9886; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 34022.6599; train_edge_recon_loss: 1311610.1531; train_cat_covariates_contrastive_loss: 642958.5482; train_gene_expr_recon_loss: 1872501.6876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3861093.0486; train_optim_loss: 3861093.0486; val_kl_reg_loss: 34036.6555; val_edge_recon_loss: 1321346.0515; val_cat_covariates_contrastive_loss: 643064.5653; val_gene_expr_recon_loss: 1886479.4562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3884926.7342; val_optim_loss: 3884926.7342
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9705; val_auprc_score: 0.9880; val_best_acc_score: 0.9480; val_best_f1_score: 0.9665; train_kl_reg_loss: 28555.8610; train_edge_recon_loss: 1319423.5405; train_cat_covariates_contrastive_loss: 641865.0137; train_gene_expr_recon_loss: 2014687.1045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4004531.5208; train_optim_loss: 4004531.5208; val_kl_reg_loss: 28619.3289; val_edge_recon_loss: 1330304.6215; val_cat_covariates_contrastive_loss: 641889.2611; val_gene_expr_recon_loss: 2010234.0389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4011047.2500; val_optim_loss: 4011047.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9724; val_auprc_score: 0.9881; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 33950.3965; train_edge_recon_loss: 1311636.9741; train_cat_covariates_contrastive_loss: 642798.6250; train_gene_expr_recon_loss: 1871813.3343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3860199.3291; train_optim_loss: 3860199.3291; val_kl_reg_loss: 33811.9107; val_edge_recon_loss: 1324037.2985; val_cat_covariates_contrastive_loss: 642707.5718; val_gene_expr_recon_loss: 1888826.6173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3889383.4005; val_optim_loss: 3889383.4005
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9734; val_auprc_score: 0.9890; val_best_acc_score: 0.9505; val_best_f1_score: 0.9681; train_kl_reg_loss: 29124.1919; train_edge_recon_loss: 1320031.3063; train_cat_covariates_contrastive_loss: 642078.3316; train_gene_expr_recon_loss: 2003957.9928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3995191.8222; train_optim_loss: 3995191.8222; val_kl_reg_loss: 28352.3836; val_edge_recon_loss: 1325042.3912; val_cat_covariates_contrastive_loss: 643673.6223; val_gene_expr_recon_loss: 2018511.0735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4015579.4762; val_optim_loss: 4015579.4762
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9726; val_auprc_score: 0.9884; val_best_acc_score: 0.9556; val_best_f1_score: 0.9713; train_kl_reg_loss: 33835.0792; train_edge_recon_loss: 1313543.4084; train_cat_covariates_contrastive_loss: 642877.0467; train_gene_expr_recon_loss: 1872033.7501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3862289.2834; train_optim_loss: 3862289.2834; val_kl_reg_loss: 33846.0612; val_edge_recon_loss: 1318577.2765; val_cat_covariates_contrastive_loss: 642808.3021; val_gene_expr_recon_loss: 1885936.2149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3881167.8629; val_optim_loss: 3881167.8629
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9729; val_auprc_score: 0.9889; val_best_acc_score: 0.9498; val_best_f1_score: 0.9675; train_kl_reg_loss: 30024.0006; train_edge_recon_loss: 1320743.4190; train_cat_covariates_contrastive_loss: 642412.4253; train_gene_expr_recon_loss: 1996483.5687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3989663.4147; train_optim_loss: 3989663.4147; val_kl_reg_loss: 29811.3502; val_edge_recon_loss: 1329691.7323; val_cat_covariates_contrastive_loss: 644404.1205; val_gene_expr_recon_loss: 2002902.8926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4006810.0985; val_optim_loss: 4006810.0985
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9720; val_auprc_score: 0.9879; val_best_acc_score: 0.9556; val_best_f1_score: 0.9712; train_kl_reg_loss: 33774.6100; train_edge_recon_loss: 1312705.4469; train_cat_covariates_contrastive_loss: 642966.1228; train_gene_expr_recon_loss: 1871773.5948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3861219.7759; train_optim_loss: 3861219.7759; val_kl_reg_loss: 33843.4807; val_edge_recon_loss: 1320146.1745; val_cat_covariates_contrastive_loss: 642632.2266; val_gene_expr_recon_loss: 1886134.5275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3882756.4124; val_optim_loss: 3882756.4124
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9688; val_auprc_score: 0.9870; val_best_acc_score: 0.9510; val_best_f1_score: 0.9685; train_kl_reg_loss: 30652.9688; train_edge_recon_loss: 1317755.9610; train_cat_covariates_contrastive_loss: 642758.1446; train_gene_expr_recon_loss: 1989203.1418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3980370.2121; train_optim_loss: 3980370.2121; val_kl_reg_loss: 32183.0765; val_edge_recon_loss: 1327511.7314; val_cat_covariates_contrastive_loss: 641105.9428; val_gene_expr_recon_loss: 1994554.5171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3995355.2703; val_optim_loss: 3995355.2703
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9693; val_auprc_score: 0.9874; val_best_acc_score: 0.9518; val_best_f1_score: 0.9689; train_kl_reg_loss: 31047.7712; train_edge_recon_loss: 1319207.3101; train_cat_covariates_contrastive_loss: 642836.9043; train_gene_expr_recon_loss: 1979678.3637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3972770.3511; train_optim_loss: 3972770.3511; val_kl_reg_loss: 32719.7264; val_edge_recon_loss: 1328876.6990; val_cat_covariates_contrastive_loss: 641641.5553; val_gene_expr_recon_loss: 1984604.8923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3987842.8723; val_optim_loss: 3987842.8723
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9724; val_auprc_score: 0.9879; val_best_acc_score: 0.9556; val_best_f1_score: 0.9712; train_kl_reg_loss: 33687.2701; train_edge_recon_loss: 1312661.4216; train_cat_covariates_contrastive_loss: 642833.7297; train_gene_expr_recon_loss: 1872450.2444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3861632.6653; train_optim_loss: 3861632.6653; val_kl_reg_loss: 33597.8529; val_edge_recon_loss: 1322529.3084; val_cat_covariates_contrastive_loss: 642945.2816; val_gene_expr_recon_loss: 1887026.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3886098.5292; val_optim_loss: 3886098.5292
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9707; val_auprc_score: 0.9878; val_best_acc_score: 0.9527; val_best_f1_score: 0.9695; train_kl_reg_loss: 31449.6933; train_edge_recon_loss: 1317360.1936; train_cat_covariates_contrastive_loss: 642945.4915; train_gene_expr_recon_loss: 1977668.5963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3969423.9779; train_optim_loss: 3969423.9779; val_kl_reg_loss: 32308.0062; val_edge_recon_loss: 1327307.4153; val_cat_covariates_contrastive_loss: 641747.3624; val_gene_expr_recon_loss: 1990807.6371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3992170.4302; val_optim_loss: 3992170.4302
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9719; val_auprc_score: 0.9879; val_best_acc_score: 0.9552; val_best_f1_score: 0.9710; train_kl_reg_loss: 33568.3371; train_edge_recon_loss: 1313633.0375; train_cat_covariates_contrastive_loss: 642836.9130; train_gene_expr_recon_loss: 1870373.7217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3860412.0105; train_optim_loss: 3860412.0105; val_kl_reg_loss: 33491.6649; val_edge_recon_loss: 1327951.0621; val_cat_covariates_contrastive_loss: 642900.8314; val_gene_expr_recon_loss: 1887167.4584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3891511.0134; val_optim_loss: 3891511.0134
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9722; val_auprc_score: 0.9885; val_best_acc_score: 0.9536; val_best_f1_score: 0.9701; train_kl_reg_loss: 32071.5864; train_edge_recon_loss: 1318345.1353; train_cat_covariates_contrastive_loss: 643172.5037; train_gene_expr_recon_loss: 1972169.6726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3965758.8999; train_optim_loss: 3965758.8999; val_kl_reg_loss: 32134.4650; val_edge_recon_loss: 1328947.2181; val_cat_covariates_contrastive_loss: 642935.5215; val_gene_expr_recon_loss: 1972962.8829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3976980.0896; val_optim_loss: 3976980.0896
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9700; val_auprc_score: 0.9871; val_best_acc_score: 0.9551; val_best_f1_score: 0.9710; train_kl_reg_loss: 33565.0699; train_edge_recon_loss: 1309858.9933; train_cat_covariates_contrastive_loss: 642821.9235; train_gene_expr_recon_loss: 1870701.2485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3856947.2362; train_optim_loss: 3856947.2362; val_kl_reg_loss: 33417.9275; val_edge_recon_loss: 1317670.9285; val_cat_covariates_contrastive_loss: 642188.6569; val_gene_expr_recon_loss: 1888628.9235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3881906.4337; val_optim_loss: 3881906.4337
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9721; val_auprc_score: 0.9885; val_best_acc_score: 0.9536; val_best_f1_score: 0.9700; train_kl_reg_loss: 32327.9455; train_edge_recon_loss: 1320773.3603; train_cat_covariates_contrastive_loss: 643214.6847; train_gene_expr_recon_loss: 1966892.9584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3963208.9507; train_optim_loss: 3963208.9507; val_kl_reg_loss: 32488.4582; val_edge_recon_loss: 1330707.0368; val_cat_covariates_contrastive_loss: 643797.2907; val_gene_expr_recon_loss: 1976971.7780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3983964.5767; val_optim_loss: 3983964.5767

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9715; val_auprc_score: 0.9877; val_best_acc_score: 0.9549; val_best_f1_score: 0.9708; train_kl_reg_loss: 33419.7313; train_edge_recon_loss: 1312742.1904; train_cat_covariates_contrastive_loss: 642756.5769; train_gene_expr_recon_loss: 1870008.5946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3858927.0944; train_optim_loss: 3858927.0944; val_kl_reg_loss: 33418.2871; val_edge_recon_loss: 1326786.8537; val_cat_covariates_contrastive_loss: 642266.3677; val_gene_expr_recon_loss: 1887563.2923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3890034.7970; val_optim_loss: 3890034.7970
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9698; val_auprc_score: 0.9875; val_best_acc_score: 0.9503; val_best_f1_score: 0.9679; train_kl_reg_loss: 33007.8899; train_edge_recon_loss: 1317531.6506; train_cat_covariates_contrastive_loss: 643533.6764; train_gene_expr_recon_loss: 1965101.8410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3959175.0585; train_optim_loss: 3959175.0585; val_kl_reg_loss: 33313.3128; val_edge_recon_loss: 1327065.8353; val_cat_covariates_contrastive_loss: 642566.5429; val_gene_expr_recon_loss: 1968279.9510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3971225.6446; val_optim_loss: 3971225.6446
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9712; val_auprc_score: 0.9876; val_best_acc_score: 0.9555; val_best_f1_score: 0.9712; train_kl_reg_loss: 33404.3567; train_edge_recon_loss: 1311780.8116; train_cat_covariates_contrastive_loss: 642703.9907; train_gene_expr_recon_loss: 1870269.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3858158.5469; train_optim_loss: 3858158.5469; val_kl_reg_loss: 33419.3610; val_edge_recon_loss: 1322160.3350; val_cat_covariates_contrastive_loss: 642617.5059; val_gene_expr_recon_loss: 1886921.0131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3885118.2178; val_optim_loss: 3885118.2178
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9718; val_auprc_score: 0.9882; val_best_acc_score: 0.9535; val_best_f1_score: 0.9700; train_kl_reg_loss: 34172.9799; train_edge_recon_loss: 1318549.7753; train_cat_covariates_contrastive_loss: 643531.9511; train_gene_expr_recon_loss: 1966272.1155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3962526.8218; train_optim_loss: 3962526.8218; val_kl_reg_loss: 34600.1107; val_edge_recon_loss: 1329128.5972; val_cat_covariates_contrastive_loss: 643658.5578; val_gene_expr_recon_loss: 1966334.1822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3973721.4520; val_optim_loss: 3973721.4520
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9732; val_auprc_score: 0.9885; val_best_acc_score: 0.9564; val_best_f1_score: 0.9718; train_kl_reg_loss: 33414.6475; train_edge_recon_loss: 1312870.7760; train_cat_covariates_contrastive_loss: 642881.7419; train_gene_expr_recon_loss: 1870119.9182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3859287.0850; train_optim_loss: 3859287.0850; val_kl_reg_loss: 33392.0647; val_edge_recon_loss: 1315373.7621; val_cat_covariates_contrastive_loss: 642719.1907; val_gene_expr_recon_loss: 1887879.5577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3879364.5762; val_optim_loss: 3879364.5762
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9715; val_auprc_score: 0.9882; val_best_acc_score: 0.9539; val_best_f1_score: 0.9703; train_kl_reg_loss: 34052.4475; train_edge_recon_loss: 1318914.6917; train_cat_covariates_contrastive_loss: 643741.0068; train_gene_expr_recon_loss: 1955841.4774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3952549.6222; train_optim_loss: 3952549.6222; val_kl_reg_loss: 35145.2795; val_edge_recon_loss: 1321012.6295; val_cat_covariates_contrastive_loss: 643401.7116; val_gene_expr_recon_loss: 1972142.3723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3971701.9975; val_optim_loss: 3971701.9975
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9718; val_auprc_score: 0.9879; val_best_acc_score: 0.9552; val_best_f1_score: 0.9709; train_kl_reg_loss: 33387.1122; train_edge_recon_loss: 1309451.2708; train_cat_covariates_contrastive_loss: 642820.2184; train_gene_expr_recon_loss: 1869991.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3855650.4433; train_optim_loss: 3855650.4433; val_kl_reg_loss: 33405.6568; val_edge_recon_loss: 1325627.5856; val_cat_covariates_contrastive_loss: 642700.7927; val_gene_expr_recon_loss: 1886700.6356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3888434.6703; val_optim_loss: 3888434.6703
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9716; val_auprc_score: 0.9882; val_best_acc_score: 0.9534; val_best_f1_score: 0.9699; train_kl_reg_loss: 34853.5270; train_edge_recon_loss: 1314194.4521; train_cat_covariates_contrastive_loss: 643758.9280; train_gene_expr_recon_loss: 1952260.8881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3945067.7976; train_optim_loss: 3945067.7976; val_kl_reg_loss: 35073.1572; val_edge_recon_loss: 1323987.8782; val_cat_covariates_contrastive_loss: 643473.5022; val_gene_expr_recon_loss: 1971990.7131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3974525.2485; val_optim_loss: 3974525.2485
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9724; val_auprc_score: 0.9882; val_best_acc_score: 0.9560; val_best_f1_score: 0.9716; train_kl_reg_loss: 33373.5105; train_edge_recon_loss: 1312334.3565; train_cat_covariates_contrastive_loss: 642882.6276; train_gene_expr_recon_loss: 1869775.5955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3858366.0902; train_optim_loss: 3858366.0902; val_kl_reg_loss: 33401.6959; val_edge_recon_loss: 1316300.8517; val_cat_covariates_contrastive_loss: 642594.0640; val_gene_expr_recon_loss: 1888692.8921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3880989.5094; val_optim_loss: 3880989.5094
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9705; val_auprc_score: 0.9876; val_best_acc_score: 0.9519; val_best_f1_score: 0.9689; train_kl_reg_loss: 429645772.1971; train_edge_recon_loss: 1318385.2966; train_cat_covariates_contrastive_loss: 643818.9865; train_gene_expr_recon_loss: 1977402.2653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 433585396.9920; train_optim_loss: 433585396.9920; val_kl_reg_loss: 37598.6732; val_edge_recon_loss: 1330394.3626; val_cat_covariates_contrastive_loss: 644142.6035; val_gene_expr_recon_loss: 2011446.0953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4023581.7262; val_optim_loss: 4023581.7262
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9727; val_auprc_score: 0.9883; val_best_acc_score: 0.9562; val_best_f1_score: 0.9716; train_kl_reg_loss: 33381.4364; train_edge_recon_loss: 1313576.4897; train_cat_covariates_contrastive_loss: 642742.7847; train_gene_expr_recon_loss: 1870782.8566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3860483.5678; train_optim_loss: 3860483.5678; val_kl_reg_loss: 33378.4329; val_edge_recon_loss: 1327629.1953; val_cat_covariates_contrastive_loss: 642391.8329; val_gene_expr_recon_loss: 1887587.6376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3890987.0955; val_optim_loss: 3890987.0955

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9745; val_auprc_score: 0.9894; val_best_acc_score: 0.9564; val_best_f1_score: 0.9718; train_kl_reg_loss: 37175.2953; train_edge_recon_loss: 1312420.8810; train_cat_covariates_contrastive_loss: 644748.2074; train_gene_expr_recon_loss: 1943971.0222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3938315.4059; train_optim_loss: 3938315.4059; val_kl_reg_loss: 37032.5135; val_edge_recon_loss: 1318152.0535; val_cat_covariates_contrastive_loss: 645459.5226; val_gene_expr_recon_loss: 1944510.9168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3945155.0020; val_optim_loss: 3945155.0020
