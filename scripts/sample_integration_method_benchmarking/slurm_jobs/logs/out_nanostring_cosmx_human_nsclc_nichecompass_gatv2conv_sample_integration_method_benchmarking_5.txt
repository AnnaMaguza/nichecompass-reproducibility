Run timestamp: 23082023_204355_5.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '8', '--edge_batch_size_list', '512', '512', '--node_batch_size_list', 'None', 'None', '--seeds', '3', '2', '--run_index', '4', '3', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9644; val_auprc_score: 0.9844; val_best_acc_score: 0.9377; val_best_f1_score: 0.9592; train_kl_reg_loss: 16550.1506; train_edge_recon_loss: 1367863.9382; train_gene_expr_recon_loss: 2754347.8207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4138761.9074; train_optim_loss: 4138761.9074; val_kl_reg_loss: 14220.3601; val_edge_recon_loss: 1344543.2500; val_gene_expr_recon_loss: 2440548.5632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3799312.1739; val_optim_loss: 3799312.1739
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9723; val_auprc_score: 0.9879; val_best_acc_score: 0.9473; val_best_f1_score: 0.9655; train_kl_reg_loss: 16068.7484; train_edge_recon_loss: 1321913.3278; train_gene_expr_recon_loss: 2285033.6677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3623015.7444; train_optim_loss: 3623015.7444; val_kl_reg_loss: 17735.5300; val_edge_recon_loss: 1338129.3409; val_gene_expr_recon_loss: 2165198.9160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3521063.7875; val_optim_loss: 3521063.7875
Run timestamp: 23082023_210226_5.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '8', '--edge_batch_size_list', '256', '256', '--node_batch_size_list', 'None', 'None', '--seeds', '3', '2', '--run_index', '4', '3', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9664; val_auprc_score: 0.9851; val_best_acc_score: 0.9408; val_best_f1_score: 0.9612; train_kl_reg_loss: 14341.9819; train_edge_recon_loss: 1352513.7024; train_gene_expr_recon_loss: 2628918.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3995774.3315; train_optim_loss: 3995774.3315; val_kl_reg_loss: 15112.7397; val_edge_recon_loss: 1341306.5423; val_gene_expr_recon_loss: 2297119.8856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3653539.1683; val_optim_loss: 3653539.1683
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9751; val_auprc_score: 0.9892; val_best_acc_score: 0.9503; val_best_f1_score: 0.9675; train_kl_reg_loss: 18599.0589; train_edge_recon_loss: 1319477.0008; train_gene_expr_recon_loss: 2112752.3623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3450828.4244; train_optim_loss: 3450828.4244; val_kl_reg_loss: 19737.5006; val_edge_recon_loss: 1321704.1621; val_gene_expr_recon_loss: 2063066.2480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3404507.9091; val_optim_loss: 3404507.9091
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9725; val_auprc_score: 0.9883; val_best_acc_score: 0.9458; val_best_f1_score: 0.9645; train_kl_reg_loss: 17868.1495; train_edge_recon_loss: 1321031.2322; train_gene_expr_recon_loss: 2181792.1650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3520691.5466; train_optim_loss: 3520691.5466; val_kl_reg_loss: 19649.0092; val_edge_recon_loss: 1336267.1248; val_gene_expr_recon_loss: 2112839.2441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3468755.3752; val_optim_loss: 3468755.3752
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9772; val_auprc_score: 0.9903; val_best_acc_score: 0.9510; val_best_f1_score: 0.9679; train_kl_reg_loss: 19778.8911; train_edge_recon_loss: 1318848.6894; train_gene_expr_recon_loss: 2044174.2990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3382801.8778; train_optim_loss: 3382801.8778; val_kl_reg_loss: 20466.5608; val_edge_recon_loss: 1332491.1215; val_gene_expr_recon_loss: 2017708.7120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3370666.3923; val_optim_loss: 3370666.3923
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9750; val_auprc_score: 0.9891; val_best_acc_score: 0.9484; val_best_f1_score: 0.9661; train_kl_reg_loss: 20850.7584; train_edge_recon_loss: 1315618.4049; train_gene_expr_recon_loss: 2075943.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3412412.8514; train_optim_loss: 3412412.8514; val_kl_reg_loss: 22018.0086; val_edge_recon_loss: 1334270.3705; val_gene_expr_recon_loss: 2054295.7262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3410584.1045; val_optim_loss: 3410584.1045
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9786; val_auprc_score: 0.9909; val_best_acc_score: 0.9535; val_best_f1_score: 0.9695; train_kl_reg_loss: 20505.8792; train_edge_recon_loss: 1316507.4320; train_gene_expr_recon_loss: 2009385.3741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346398.6860; train_optim_loss: 3346398.6860; val_kl_reg_loss: 20877.5062; val_edge_recon_loss: 1332445.9970; val_gene_expr_recon_loss: 2000801.0855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354124.5958; val_optim_loss: 3354124.5958
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9763; val_auprc_score: 0.9897; val_best_acc_score: 0.9525; val_best_f1_score: 0.9689; train_kl_reg_loss: 22526.3985; train_edge_recon_loss: 1318043.0108; train_gene_expr_recon_loss: 2036048.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3376618.3119; train_optim_loss: 3376618.3119; val_kl_reg_loss: 22842.5262; val_edge_recon_loss: 1331057.3348; val_gene_expr_recon_loss: 2032385.0319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3386284.8960; val_optim_loss: 3386284.8960
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9772; val_auprc_score: 0.9904; val_best_acc_score: 0.9528; val_best_f1_score: 0.9689; train_kl_reg_loss: 21021.3739; train_edge_recon_loss: 1315630.1297; train_gene_expr_recon_loss: 1989393.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3326044.8551; train_optim_loss: 3326044.8551; val_kl_reg_loss: 20962.3331; val_edge_recon_loss: 1335047.7381; val_gene_expr_recon_loss: 1984659.5904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3340669.6621; val_optim_loss: 3340669.6621
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9778; val_auprc_score: 0.9905; val_best_acc_score: 0.9529; val_best_f1_score: 0.9690; train_kl_reg_loss: 23672.4258; train_edge_recon_loss: 1320171.9782; train_gene_expr_recon_loss: 2016342.4986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3360186.9020; train_optim_loss: 3360186.9020; val_kl_reg_loss: 24701.5883; val_edge_recon_loss: 1330992.5032; val_gene_expr_recon_loss: 2016461.1748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3372155.2688; val_optim_loss: 3372155.2688
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9788; val_auprc_score: 0.9907; val_best_acc_score: 0.9555; val_best_f1_score: 0.9707; train_kl_reg_loss: 21502.5938; train_edge_recon_loss: 1318172.5736; train_gene_expr_recon_loss: 1974750.6397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3314425.8090; train_optim_loss: 3314425.8090; val_kl_reg_loss: 21802.8362; val_edge_recon_loss: 1338311.8389; val_gene_expr_recon_loss: 1983126.9259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3343241.5949; val_optim_loss: 3343241.5949
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9784; val_auprc_score: 0.9907; val_best_acc_score: 0.9539; val_best_f1_score: 0.9697; train_kl_reg_loss: 24789.7069; train_edge_recon_loss: 1321112.8204; train_gene_expr_recon_loss: 2001365.9755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3347268.5019; train_optim_loss: 3347268.5019; val_kl_reg_loss: 26384.2957; val_edge_recon_loss: 1336141.8450; val_gene_expr_recon_loss: 2017899.6498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3380425.7911; val_optim_loss: 3380425.7911
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9788; val_auprc_score: 0.9905; val_best_acc_score: 0.9562; val_best_f1_score: 0.9712; train_kl_reg_loss: 21953.2174; train_edge_recon_loss: 1315225.2683; train_gene_expr_recon_loss: 1965038.9082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3302217.3949; train_optim_loss: 3302217.3949; val_kl_reg_loss: 22689.9839; val_edge_recon_loss: 1332352.9056; val_gene_expr_recon_loss: 1965140.5267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3320183.4170; val_optim_loss: 3320183.4170
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9809; val_auprc_score: 0.9920; val_best_acc_score: 0.9566; val_best_f1_score: 0.9715; train_kl_reg_loss: 25717.2309; train_edge_recon_loss: 1317314.8344; train_gene_expr_recon_loss: 1988141.4109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3331173.4774; train_optim_loss: 3331173.4774; val_kl_reg_loss: 26140.5807; val_edge_recon_loss: 1334147.9359; val_gene_expr_recon_loss: 1990763.2097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3351051.7248; val_optim_loss: 3351051.7248
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9808; val_auprc_score: 0.9919; val_best_acc_score: 0.9563; val_best_f1_score: 0.9712; train_kl_reg_loss: 22252.7400; train_edge_recon_loss: 1314973.7607; train_gene_expr_recon_loss: 1954858.5326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3292085.0325; train_optim_loss: 3292085.0325; val_kl_reg_loss: 22336.7548; val_edge_recon_loss: 1330007.9486; val_gene_expr_recon_loss: 1950891.3547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303236.0563; val_optim_loss: 3303236.0563
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9804; val_auprc_score: 0.9919; val_best_acc_score: 0.9550; val_best_f1_score: 0.9704; train_kl_reg_loss: 26368.7349; train_edge_recon_loss: 1317715.9015; train_gene_expr_recon_loss: 1984814.4795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328899.1166; train_optim_loss: 3328899.1166; val_kl_reg_loss: 26373.2247; val_edge_recon_loss: 1333856.9406; val_gene_expr_recon_loss: 1987973.5188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3348203.6876; val_optim_loss: 3348203.6876
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9799; val_auprc_score: 0.9911; val_best_acc_score: 0.9573; val_best_f1_score: 0.9719; train_kl_reg_loss: 22634.2223; train_edge_recon_loss: 1314035.9461; train_gene_expr_recon_loss: 1948347.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3285017.7994; train_optim_loss: 3285017.7994; val_kl_reg_loss: 22808.5048; val_edge_recon_loss: 1329098.2969; val_gene_expr_recon_loss: 1941980.8300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3293887.6285; val_optim_loss: 3293887.6285
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9814; val_auprc_score: 0.9923; val_best_acc_score: 0.9570; val_best_f1_score: 0.9718; train_kl_reg_loss: 27209.5384; train_edge_recon_loss: 1318131.1722; train_gene_expr_recon_loss: 1974373.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3319714.6050; train_optim_loss: 3319714.6050; val_kl_reg_loss: 27543.6211; val_edge_recon_loss: 1328716.4223; val_gene_expr_recon_loss: 1975445.7421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3331705.7901; val_optim_loss: 3331705.7901
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9799; val_auprc_score: 0.9913; val_best_acc_score: 0.9560; val_best_f1_score: 0.9711; train_kl_reg_loss: 23054.5836; train_edge_recon_loss: 1317505.6489; train_gene_expr_recon_loss: 1939208.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279769.0680; train_optim_loss: 3279769.0680; val_kl_reg_loss: 23606.7675; val_edge_recon_loss: 1329221.9620; val_gene_expr_recon_loss: 1950937.7268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303766.4713; val_optim_loss: 3303766.4713
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9801; val_auprc_score: 0.9911; val_best_acc_score: 0.9580; val_best_f1_score: 0.9724; train_kl_reg_loss: 23326.9714; train_edge_recon_loss: 1316127.9446; train_gene_expr_recon_loss: 1932876.2492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3272331.1660; train_optim_loss: 3272331.1660; val_kl_reg_loss: 23506.3242; val_edge_recon_loss: 1327564.2787; val_gene_expr_recon_loss: 1929444.1991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3280514.8024; val_optim_loss: 3280514.8024
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9816; val_auprc_score: 0.9922; val_best_acc_score: 0.9583; val_best_f1_score: 0.9725; train_kl_reg_loss: 28390.6979; train_edge_recon_loss: 1317931.4684; train_gene_expr_recon_loss: 1972983.5746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3319305.7401; train_optim_loss: 3319305.7401; val_kl_reg_loss: 28714.4399; val_edge_recon_loss: 1334170.7780; val_gene_expr_recon_loss: 1969143.2938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3332028.5173; val_optim_loss: 3332028.5173
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9810; val_auprc_score: 0.9919; val_best_acc_score: 0.9579; val_best_f1_score: 0.9723; train_kl_reg_loss: 23649.0790; train_edge_recon_loss: 1315966.2283; train_gene_expr_recon_loss: 1927493.2736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3267108.5812; train_optim_loss: 3267108.5812; val_kl_reg_loss: 23641.6086; val_edge_recon_loss: 1332458.5637; val_gene_expr_recon_loss: 1926518.6971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3282618.8686; val_optim_loss: 3282618.8686
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9807; val_auprc_score: 0.9918; val_best_acc_score: 0.9563; val_best_f1_score: 0.9712; train_kl_reg_loss: 28242.1672; train_edge_recon_loss: 1318377.4624; train_gene_expr_recon_loss: 1961274.9927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3307894.6220; train_optim_loss: 3307894.6220; val_kl_reg_loss: 29098.4162; val_edge_recon_loss: 1338452.9609; val_gene_expr_recon_loss: 1964575.9725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3332127.3465; val_optim_loss: 3332127.3465
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9801; val_auprc_score: 0.9913; val_best_acc_score: 0.9569; val_best_f1_score: 0.9716; train_kl_reg_loss: 24060.3848; train_edge_recon_loss: 1315521.2613; train_gene_expr_recon_loss: 1926359.4589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3265941.1073; train_optim_loss: 3265941.1073; val_kl_reg_loss: 24911.3723; val_edge_recon_loss: 1335587.4051; val_gene_expr_recon_loss: 1934996.0277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3295494.7964; val_optim_loss: 3295494.7964
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9819; val_auprc_score: 0.9923; val_best_acc_score: 0.9577; val_best_f1_score: 0.9721; train_kl_reg_loss: 29372.9257; train_edge_recon_loss: 1320333.3784; train_gene_expr_recon_loss: 1960089.2006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3309795.5035; train_optim_loss: 3309795.5035; val_kl_reg_loss: 29744.5216; val_edge_recon_loss: 1340916.8389; val_gene_expr_recon_loss: 1967151.4738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3337812.8262; val_optim_loss: 3337812.8262
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9824; val_auprc_score: 0.9924; val_best_acc_score: 0.9593; val_best_f1_score: 0.9732; train_kl_reg_loss: 24339.0712; train_edge_recon_loss: 1315808.6952; train_gene_expr_recon_loss: 1919484.7524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3259632.5221; train_optim_loss: 3259632.5221; val_kl_reg_loss: 24739.4210; val_edge_recon_loss: 1335143.1571; val_gene_expr_recon_loss: 1919294.6685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3279177.2530; val_optim_loss: 3279177.2530
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9815; val_auprc_score: 0.9918; val_best_acc_score: 0.9591; val_best_f1_score: 0.9730; train_kl_reg_loss: 30235.4278; train_edge_recon_loss: 1320558.2741; train_gene_expr_recon_loss: 1950740.1281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301533.8298; train_optim_loss: 3301533.8298; val_kl_reg_loss: 29456.5433; val_edge_recon_loss: 1339917.7559; val_gene_expr_recon_loss: 1946741.1495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316115.4510; val_optim_loss: 3316115.4510
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9826; val_auprc_score: 0.9927; val_best_acc_score: 0.9584; val_best_f1_score: 0.9727; train_kl_reg_loss: 24676.4973; train_edge_recon_loss: 1314425.0185; train_gene_expr_recon_loss: 1913255.5701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3252357.0847; train_optim_loss: 3252357.0847; val_kl_reg_loss: 24406.2766; val_edge_recon_loss: 1328534.9728; val_gene_expr_recon_loss: 1936600.1542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3289541.3962; val_optim_loss: 3289541.3962
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9816; val_auprc_score: 0.9923; val_best_acc_score: 0.9576; val_best_f1_score: 0.9720; train_kl_reg_loss: 34149.7792; train_edge_recon_loss: 1319861.2920; train_gene_expr_recon_loss: 1977720.2598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3331731.3293; train_optim_loss: 3331731.3293; val_kl_reg_loss: 34958.3122; val_edge_recon_loss: 1344815.0418; val_gene_expr_recon_loss: 2057754.6386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3437527.9970; val_optim_loss: 3437527.9970
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9830; val_auprc_score: 0.9928; val_best_acc_score: 0.9603; val_best_f1_score: 0.9739; train_kl_reg_loss: 24905.9827; train_edge_recon_loss: 1317080.4065; train_gene_expr_recon_loss: 1910765.5944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3252751.9830; train_optim_loss: 3252751.9830; val_kl_reg_loss: 24869.1138; val_edge_recon_loss: 1329111.1823; val_gene_expr_recon_loss: 1912440.6117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3266420.9091; val_optim_loss: 3266420.9091
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8475; val_auprc_score: 0.9447; val_best_acc_score: 0.8018; val_best_f1_score: 0.8761; train_kl_reg_loss: 219474.6720; train_edge_recon_loss: 1408754.8874; train_gene_expr_recon_loss: 2811918.0240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4440147.5865; train_optim_loss: 4440147.5865; val_kl_reg_loss: 214128.9847; val_edge_recon_loss: 1798035.7396; val_gene_expr_recon_loss: 6092102.3386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8104267.0624; val_optim_loss: 8104267.0624
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9829; val_auprc_score: 0.9927; val_best_acc_score: 0.9602; val_best_f1_score: 0.9738; train_kl_reg_loss: 24944.0977; train_edge_recon_loss: 1315352.0641; train_gene_expr_recon_loss: 1906053.9151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3246350.0773; train_optim_loss: 3246350.0773; val_kl_reg_loss: 25013.4577; val_edge_recon_loss: 1332314.4901; val_gene_expr_recon_loss: 1909182.6571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3266510.6087; val_optim_loss: 3266510.6087
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9821; val_auprc_score: 0.9924; val_best_acc_score: 0.9587; val_best_f1_score: 0.9727; train_kl_reg_loss: 194283.5794; train_edge_recon_loss: 1357909.5547; train_gene_expr_recon_loss: 2477154.9872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4029348.1169; train_optim_loss: 4029348.1169; val_kl_reg_loss: 42541.0678; val_edge_recon_loss: 1339400.3692; val_gene_expr_recon_loss: 2017990.0295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3399931.4678; val_optim_loss: 3399931.4678
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9816; val_auprc_score: 0.9921; val_best_acc_score: 0.9596; val_best_f1_score: 0.9733; train_kl_reg_loss: 25241.3066; train_edge_recon_loss: 1316485.0208; train_gene_expr_recon_loss: 1906643.5842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3248369.9106; train_optim_loss: 3248369.9106; val_kl_reg_loss: 25661.3336; val_edge_recon_loss: 1333223.0702; val_gene_expr_recon_loss: 1915561.0539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3274445.4555; val_optim_loss: 3274445.4555
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8572; val_auprc_score: 0.9489; val_best_acc_score: 0.8069; val_best_f1_score: 0.8773; train_kl_reg_loss: 120113498.2383; train_edge_recon_loss: 1370585.4487; train_gene_expr_recon_loss: 2834536.1511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 124318627.4595; train_optim_loss: 124318627.4595; val_kl_reg_loss: 159985.7461; val_edge_recon_loss: 1766128.5166; val_gene_expr_recon_loss: 7485425.0109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9411539.2733; val_optim_loss: 9411539.2733
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9819; val_auprc_score: 0.9921; val_best_acc_score: 0.9601; val_best_f1_score: 0.9737; train_kl_reg_loss: 25459.2164; train_edge_recon_loss: 1314546.5784; train_gene_expr_recon_loss: 1900010.7343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3240016.5275; train_optim_loss: 3240016.5275; val_kl_reg_loss: 25869.2037; val_edge_recon_loss: 1330332.7085; val_gene_expr_recon_loss: 1902318.6601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258520.5771; val_optim_loss: 3258520.5771

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9745; val_auprc_score: 0.9889; val_best_acc_score: 0.9507; val_best_f1_score: 0.9676; train_kl_reg_loss: 78825.7239; train_edge_recon_loss: 1396157.4579; train_gene_expr_recon_loss: 2920078.7013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4395061.8833; train_optim_loss: 4395061.8833; val_kl_reg_loss: 52976.8975; val_edge_recon_loss: 1337106.8918; val_gene_expr_recon_loss: 2213948.9282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3604032.7163; val_optim_loss: 3604032.7163
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9836; val_auprc_score: 0.9931; val_best_acc_score: 0.9616; val_best_f1_score: 0.9748; train_kl_reg_loss: 25592.1140; train_edge_recon_loss: 1316921.9772; train_gene_expr_recon_loss: 1898745.0249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3241259.1169; train_optim_loss: 3241259.1169; val_kl_reg_loss: 25828.5171; val_edge_recon_loss: 1321507.0756; val_gene_expr_recon_loss: 1910916.9145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258252.4970; val_optim_loss: 3258252.4970
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9826; val_auprc_score: 0.9924; val_best_acc_score: 0.9606; val_best_f1_score: 0.9740; train_kl_reg_loss: 26961.3879; train_edge_recon_loss: 1315809.1628; train_gene_expr_recon_loss: 1898353.9696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3241124.5216; train_optim_loss: 3241124.5216; val_kl_reg_loss: 27051.3850; val_edge_recon_loss: 1338980.3034; val_gene_expr_recon_loss: 1899814.8261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265846.5109; val_optim_loss: 3265846.5109
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9806; val_auprc_score: 0.9919; val_best_acc_score: 0.9557; val_best_f1_score: 0.9708; train_kl_reg_loss: 48360.8485; train_edge_recon_loss: 1322255.8632; train_gene_expr_recon_loss: 2118732.6853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3489349.3974; train_optim_loss: 3489349.3974; val_kl_reg_loss: 44126.8044; val_edge_recon_loss: 1339931.0811; val_gene_expr_recon_loss: 2056160.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3440218.1589; val_optim_loss: 3440218.1589
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9826; val_auprc_score: 0.9921; val_best_acc_score: 0.9619; val_best_f1_score: 0.9749; train_kl_reg_loss: 26756.0253; train_edge_recon_loss: 1315941.0955; train_gene_expr_recon_loss: 1893863.1213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3236560.2419; train_optim_loss: 3236560.2419; val_kl_reg_loss: 26770.0315; val_edge_recon_loss: 1334997.1122; val_gene_expr_recon_loss: 1899130.1467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3260897.2974; val_optim_loss: 3260897.2974
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9837; val_auprc_score: 0.9933; val_best_acc_score: 0.9589; val_best_f1_score: 0.9729; train_kl_reg_loss: 71169.0713; train_edge_recon_loss: 1325303.4166; train_gene_expr_recon_loss: 2015853.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3412326.1379; train_optim_loss: 3412326.1379; val_kl_reg_loss: 42634.3641; val_edge_recon_loss: 1342434.2048; val_gene_expr_recon_loss: 1999335.9985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384404.5658; val_optim_loss: 3384404.5658
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9841; val_auprc_score: 0.9932; val_best_acc_score: 0.9618; val_best_f1_score: 0.9748; train_kl_reg_loss: 26362.7359; train_edge_recon_loss: 1315088.3902; train_gene_expr_recon_loss: 1892697.0893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234148.2124; train_optim_loss: 3234148.2124; val_kl_reg_loss: 26063.2543; val_edge_recon_loss: 1334985.3859; val_gene_expr_recon_loss: 1894779.7653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3255828.4002; val_optim_loss: 3255828.4002
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9839; val_auprc_score: 0.9934; val_best_acc_score: 0.9601; val_best_f1_score: 0.9737; train_kl_reg_loss: 42048.4346; train_edge_recon_loss: 1324772.8998; train_gene_expr_recon_loss: 1973912.6728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3340734.0057; train_optim_loss: 3340734.0057; val_kl_reg_loss: 41839.7688; val_edge_recon_loss: 1332074.1062; val_gene_expr_recon_loss: 1970575.5030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3344489.3772; val_optim_loss: 3344489.3772
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9835; val_auprc_score: 0.9930; val_best_acc_score: 0.9620; val_best_f1_score: 0.9750; train_kl_reg_loss: 26661.4228; train_edge_recon_loss: 1315212.7505; train_gene_expr_recon_loss: 1896146.3705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238020.5459; train_optim_loss: 3238020.5459; val_kl_reg_loss: 27383.2229; val_edge_recon_loss: 1325373.0845; val_gene_expr_recon_loss: 1897305.9368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3250062.2342; val_optim_loss: 3250062.2342
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9342; val_auprc_score: 0.9737; val_best_acc_score: 0.8975; val_best_f1_score: 0.9334; train_kl_reg_loss: 1300039.9149; train_edge_recon_loss: 1505392.9648; train_gene_expr_recon_loss: 5777421.8371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8582854.7359; train_optim_loss: 8582854.7359; val_kl_reg_loss: 53074.6880; val_edge_recon_loss: 1380070.2006; val_gene_expr_recon_loss: 2819755.7530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4252900.6403; val_optim_loss: 4252900.6403

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 418 min 12 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
val AUROC score: 0.9822
val AUPRC score: 0.9923
val best accuracy score: 0.9594
val best F1 score: 0.9732
val target rna MSE score: 0.6873
val source rna MSE score: 0.0979
Val cat covariate0 mean sim diff: -0.0001
Val cat covariate1 mean sim diff: -0.0897
Duration of model training in run 4: 7 hours, 8 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9691; val_auprc_score: 0.9863; val_best_acc_score: 0.9434; val_best_f1_score: 0.9629; train_kl_reg_loss: 13906.9462; train_edge_recon_loss: 1351505.5168; train_gene_expr_recon_loss: 2641579.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006992.3838; train_optim_loss: 4006992.3838; val_kl_reg_loss: 15199.9877; val_edge_recon_loss: 1349389.4394; val_gene_expr_recon_loss: 2314168.4052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3678757.8322; val_optim_loss: 3678757.8322
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9651; val_auprc_score: 0.9844; val_best_acc_score: 0.9408; val_best_f1_score: 0.9613; train_kl_reg_loss: 40218.9694; train_edge_recon_loss: 1331631.8821; train_gene_expr_recon_loss: 2658517.6593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030368.5090; train_optim_loss: 4030368.5090; val_kl_reg_loss: 36342.1969; val_edge_recon_loss: 1358111.5795; val_gene_expr_recon_loss: 2575239.5010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3969693.2708; val_optim_loss: 3969693.2708
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9734; val_auprc_score: 0.9884; val_best_acc_score: 0.9482; val_best_f1_score: 0.9660; train_kl_reg_loss: 17900.4652; train_edge_recon_loss: 1321012.7790; train_gene_expr_recon_loss: 2183385.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3522298.4414; train_optim_loss: 3522298.4414; val_kl_reg_loss: 20080.1543; val_edge_recon_loss: 1339859.9891; val_gene_expr_recon_loss: 2116869.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3476809.7936; val_optim_loss: 3476809.7936
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9752; val_auprc_score: 0.9896; val_best_acc_score: 0.9490; val_best_f1_score: 0.9665; train_kl_reg_loss: 20879.6747; train_edge_recon_loss: 1319652.1104; train_gene_expr_recon_loss: 2074224.9624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3414756.7469; train_optim_loss: 3414756.7469; val_kl_reg_loss: 21668.6632; val_edge_recon_loss: 1328167.2980; val_gene_expr_recon_loss: 2060837.4530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3410673.4134; val_optim_loss: 3410673.4134
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9787; val_auprc_score: 0.9908; val_best_acc_score: 0.9549; val_best_f1_score: 0.9703; train_kl_reg_loss: 38000.9880; train_edge_recon_loss: 1326453.0598; train_gene_expr_recon_loss: 2336255.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3700709.1065; train_optim_loss: 3700709.1065; val_kl_reg_loss: 39821.7458; val_edge_recon_loss: 1336215.3829; val_gene_expr_recon_loss: 2177904.6853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3553941.8073; val_optim_loss: 3553941.8073
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9778; val_auprc_score: 0.9906; val_best_acc_score: 0.9520; val_best_f1_score: 0.9684; train_kl_reg_loss: 22527.9654; train_edge_recon_loss: 1316700.9511; train_gene_expr_recon_loss: 2034909.7741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3374138.6933; train_optim_loss: 3374138.6933; val_kl_reg_loss: 22690.9451; val_edge_recon_loss: 1336560.5916; val_gene_expr_recon_loss: 2029392.7163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3388644.2569; val_optim_loss: 3388644.2569
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9792; val_auprc_score: 0.9911; val_best_acc_score: 0.9560; val_best_f1_score: 0.9710; train_kl_reg_loss: 115077.8163; train_edge_recon_loss: 1322547.6901; train_gene_expr_recon_loss: 2140916.0384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578541.5451; train_optim_loss: 3578541.5451; val_kl_reg_loss: 53144.5428; val_edge_recon_loss: 1341406.6517; val_gene_expr_recon_loss: 2123436.1136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3517987.3014; val_optim_loss: 3517987.3014
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9791; val_auprc_score: 0.9912; val_best_acc_score: 0.9535; val_best_f1_score: 0.9694; train_kl_reg_loss: 23539.4717; train_edge_recon_loss: 1317611.0935; train_gene_expr_recon_loss: 2015341.7842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3356492.3491; train_optim_loss: 3356492.3491; val_kl_reg_loss: 24107.9966; val_edge_recon_loss: 1333769.1031; val_gene_expr_recon_loss: 2019720.3146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3377597.4139; val_optim_loss: 3377597.4139

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9819; val_auprc_score: 0.9925; val_best_acc_score: 0.9580; val_best_f1_score: 0.9724; train_kl_reg_loss: 50109.3521; train_edge_recon_loss: 1317377.4350; train_gene_expr_recon_loss: 2047546.6881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3415033.4731; train_optim_loss: 3415033.4731; val_kl_reg_loss: 48045.0796; val_edge_recon_loss: 1329878.8908; val_gene_expr_recon_loss: 2029138.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407062.1798; val_optim_loss: 3407062.1798
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9782; val_auprc_score: 0.9902; val_best_acc_score: 0.9544; val_best_f1_score: 0.9700; train_kl_reg_loss: 24779.6652; train_edge_recon_loss: 1321062.0142; train_gene_expr_recon_loss: 2003830.4810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3349672.1609; train_optim_loss: 3349672.1609; val_kl_reg_loss: 25299.1643; val_edge_recon_loss: 1333738.1229; val_gene_expr_recon_loss: 2006403.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3365440.6990; val_optim_loss: 3365440.6990
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9825; val_auprc_score: 0.9927; val_best_acc_score: 0.9586; val_best_f1_score: 0.9727; train_kl_reg_loss: 46515.0170; train_edge_recon_loss: 1318623.3573; train_gene_expr_recon_loss: 2015815.4655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3380953.8385; train_optim_loss: 3380953.8385; val_kl_reg_loss: 44920.1641; val_edge_recon_loss: 1336850.8152; val_gene_expr_recon_loss: 2002586.5909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384357.5761; val_optim_loss: 3384357.5761
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9792; val_auprc_score: 0.9914; val_best_acc_score: 0.9540; val_best_f1_score: 0.9697; train_kl_reg_loss: 25415.2129; train_edge_recon_loss: 1318027.9580; train_gene_expr_recon_loss: 1989890.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3333333.6515; train_optim_loss: 3333333.6515; val_kl_reg_loss: 27199.5462; val_edge_recon_loss: 1340042.5266; val_gene_expr_recon_loss: 2002774.9153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3370016.9871; val_optim_loss: 3370016.9871
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9834; val_auprc_score: 0.9930; val_best_acc_score: 0.9600; val_best_f1_score: 0.9736; train_kl_reg_loss: 44471.8793; train_edge_recon_loss: 1318104.3807; train_gene_expr_recon_loss: 1990151.2993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3352727.5600; train_optim_loss: 3352727.5600; val_kl_reg_loss: 44142.5344; val_edge_recon_loss: 1336565.8933; val_gene_expr_recon_loss: 1983055.3053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3363763.7312; val_optim_loss: 3363763.7312
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9800; val_auprc_score: 0.9916; val_best_acc_score: 0.9553; val_best_f1_score: 0.9706; train_kl_reg_loss: 27317.4664; train_edge_recon_loss: 1318938.7278; train_gene_expr_recon_loss: 1993793.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3340049.5071; train_optim_loss: 3340049.5071; val_kl_reg_loss: 27271.3673; val_edge_recon_loss: 1327903.1308; val_gene_expr_recon_loss: 1990304.7478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3345479.2386; val_optim_loss: 3345479.2386
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9834; val_auprc_score: 0.9930; val_best_acc_score: 0.9607; val_best_f1_score: 0.9742; train_kl_reg_loss: 43754.5875; train_edge_recon_loss: 1317655.3718; train_gene_expr_recon_loss: 1970684.4730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3332094.4314; train_optim_loss: 3332094.4314; val_kl_reg_loss: 43589.8194; val_edge_recon_loss: 1330895.8953; val_gene_expr_recon_loss: 1965132.1324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3339617.8458; val_optim_loss: 3339617.8458
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9814; val_auprc_score: 0.9921; val_best_acc_score: 0.9579; val_best_f1_score: 0.9722; train_kl_reg_loss: 426704.2172; train_edge_recon_loss: 1320211.6021; train_gene_expr_recon_loss: 2006168.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3753083.8738; train_optim_loss: 3753083.8738; val_kl_reg_loss: 29555.1444; val_edge_recon_loss: 1339963.3764; val_gene_expr_recon_loss: 2000700.4079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3370218.9238; val_optim_loss: 3370218.9238
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9784; val_auprc_score: 0.9904; val_best_acc_score: 0.9569; val_best_f1_score: 0.9716; train_kl_reg_loss: 604721981801088.3750; train_edge_recon_loss: 1321641.2314; train_gene_expr_recon_loss: 2027210.8084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 604721985149209.6250; train_optim_loss: 604721985149209.6250; val_kl_reg_loss: 129036003.2724; val_edge_recon_loss: 1339261.2931; val_gene_expr_recon_loss: 2055493.2416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132430756.4173; val_optim_loss: 132430756.4173

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 634 min 0 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9842
val AUPRC score: 0.9932
val best accuracy score: 0.9630
val best F1 score: 0.9755
val target rna MSE score: 0.6111
val source rna MSE score: 0.0940
Val cat covariate0 mean sim diff: -0.0002
Val cat covariate1 mean sim diff: -0.0899
Duration of model training in run 4: 10 hours, 38 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9656; val_auprc_score: 0.9851; val_best_acc_score: 0.9383; val_best_f1_score: 0.9597; train_kl_reg_loss: 16703.5764; train_edge_recon_loss: 1368048.0702; train_gene_expr_recon_loss: 2743667.6733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4128419.3223; train_optim_loss: 4128419.3223; val_kl_reg_loss: 14297.1552; val_edge_recon_loss: 1342901.1334; val_gene_expr_recon_loss: 2431552.8182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3788751.0968; val_optim_loss: 3788751.0968
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9789; val_auprc_score: 0.9908; val_best_acc_score: 0.9559; val_best_f1_score: 0.9710; train_kl_reg_loss: 47783756.7447; train_edge_recon_loss: 1326828.2686; train_gene_expr_recon_loss: 2063518.1913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51174106.3464; train_optim_loss: 51174106.3464; val_kl_reg_loss: 61842.0716; val_edge_recon_loss: 1339733.3661; val_gene_expr_recon_loss: 2067602.7327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3469178.1614; val_optim_loss: 3469178.1614
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9730; val_auprc_score: 0.9883; val_best_acc_score: 0.9470; val_best_f1_score: 0.9653; train_kl_reg_loss: 16103.8410; train_edge_recon_loss: 1320913.8972; train_gene_expr_recon_loss: 2276984.7805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3614002.5250; train_optim_loss: 3614002.5250; val_kl_reg_loss: 17589.9942; val_edge_recon_loss: 1333833.3701; val_gene_expr_recon_loss: 2169651.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3521074.6176; val_optim_loss: 3521074.6176
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9819; val_auprc_score: 0.9927; val_best_acc_score: 0.9544; val_best_f1_score: 0.9701; train_kl_reg_loss: 166729.8750; train_edge_recon_loss: 1326973.8822; train_gene_expr_recon_loss: 2049710.7299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3543414.4872; train_optim_loss: 3543414.4872; val_kl_reg_loss: 62998.4510; val_edge_recon_loss: 1339303.4189; val_gene_expr_recon_loss: 2047823.5139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3450125.3827; val_optim_loss: 3450125.3827
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9743; val_auprc_score: 0.9885; val_best_acc_score: 0.9507; val_best_f1_score: 0.9676; train_kl_reg_loss: 18614.2935; train_edge_recon_loss: 1318827.3734; train_gene_expr_recon_loss: 2108127.9845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3445569.6508; train_optim_loss: 3445569.6508; val_kl_reg_loss: 19582.3178; val_edge_recon_loss: 1329359.9274; val_gene_expr_recon_loss: 2070236.3859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3419178.6383; val_optim_loss: 3419178.6383

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9825; val_auprc_score: 0.9928; val_best_acc_score: 0.9579; val_best_f1_score: 0.9723; train_kl_reg_loss: 58084.3813; train_edge_recon_loss: 1319868.1773; train_gene_expr_recon_loss: 1987800.8930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3365753.4510; train_optim_loss: 3365753.4510; val_kl_reg_loss: 52740.3646; val_edge_recon_loss: 1333099.2214; val_gene_expr_recon_loss: 1995706.6604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3381546.2500; val_optim_loss: 3381546.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9765; val_auprc_score: 0.9898; val_best_acc_score: 0.9526; val_best_f1_score: 0.9689; train_kl_reg_loss: 19870.3736; train_edge_recon_loss: 1318122.4914; train_gene_expr_recon_loss: 2042424.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3380417.1602; train_optim_loss: 3380417.1602; val_kl_reg_loss: 20306.3181; val_edge_recon_loss: 1325511.3048; val_gene_expr_recon_loss: 2027116.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3372934.4091; val_optim_loss: 3372934.4091
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9780; val_auprc_score: 0.9906; val_best_acc_score: 0.9533; val_best_f1_score: 0.9693; train_kl_reg_loss: 20595.7002; train_edge_recon_loss: 1316731.5455; train_gene_expr_recon_loss: 2009540.7889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346868.0346; train_optim_loss: 3346868.0346; val_kl_reg_loss: 20791.1900; val_edge_recon_loss: 1325920.2169; val_gene_expr_recon_loss: 1999906.9822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3346618.3883; val_optim_loss: 3346618.3883
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9822; val_auprc_score: 0.9926; val_best_acc_score: 0.9580; val_best_f1_score: 0.9723; train_kl_reg_loss: 48082.4681; train_edge_recon_loss: 1319105.2909; train_gene_expr_recon_loss: 1976059.1508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343246.9099; train_optim_loss: 3343246.9099; val_kl_reg_loss: 44852.2766; val_edge_recon_loss: 1330748.2906; val_gene_expr_recon_loss: 1988010.6077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3363611.1787; val_optim_loss: 3363611.1787
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9783; val_auprc_score: 0.9908; val_best_acc_score: 0.9535; val_best_f1_score: 0.9694; train_kl_reg_loss: 21021.3644; train_edge_recon_loss: 1314894.2912; train_gene_expr_recon_loss: 1987868.3317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3323783.9858; train_optim_loss: 3323783.9858; val_kl_reg_loss: 21625.9323; val_edge_recon_loss: 1327021.9442; val_gene_expr_recon_loss: 2003176.9377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3351824.8152; val_optim_loss: 3351824.8152
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9831; val_auprc_score: 0.9929; val_best_acc_score: 0.9593; val_best_f1_score: 0.9732; train_kl_reg_loss: 43167.1803; train_edge_recon_loss: 1320150.7518; train_gene_expr_recon_loss: 1967583.1905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3330901.1210; train_optim_loss: 3330901.1210; val_kl_reg_loss: 42319.2158; val_edge_recon_loss: 1335377.3240; val_gene_expr_recon_loss: 1980808.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3358504.9376; val_optim_loss: 3358504.9376
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9792; val_auprc_score: 0.9911; val_best_acc_score: 0.9547; val_best_f1_score: 0.9702; train_kl_reg_loss: 21625.9908; train_edge_recon_loss: 1315277.5911; train_gene_expr_recon_loss: 1975853.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3312756.9315; train_optim_loss: 3312756.9315; val_kl_reg_loss: 21547.5190; val_edge_recon_loss: 1330426.5771; val_gene_expr_recon_loss: 1970132.1616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3322106.2559; val_optim_loss: 3322106.2559
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9830; val_auprc_score: 0.9929; val_best_acc_score: 0.9587; val_best_f1_score: 0.9728; train_kl_reg_loss: 41838.7951; train_edge_recon_loss: 1318468.8573; train_gene_expr_recon_loss: 1960221.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3320529.5618; train_optim_loss: 3320529.5618; val_kl_reg_loss: 41689.0838; val_edge_recon_loss: 1341142.9678; val_gene_expr_recon_loss: 1974132.8634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3356964.9144; val_optim_loss: 3356964.9144
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9802; val_auprc_score: 0.9917; val_best_acc_score: 0.9561; val_best_f1_score: 0.9710; train_kl_reg_loss: 21986.5207; train_edge_recon_loss: 1315718.5287; train_gene_expr_recon_loss: 1963650.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301355.9939; train_optim_loss: 3301355.9939; val_kl_reg_loss: 22061.7749; val_edge_recon_loss: 1329179.9664; val_gene_expr_recon_loss: 1962963.4768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3314205.2174; val_optim_loss: 3314205.2174

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 321 min 44 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
val AUROC score: 0.9799
val AUPRC score: 0.9915
val best accuracy score: 0.9545
val best F1 score: 0.9700
val target rna MSE score: 0.7288
val source rna MSE score: 0.1006
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0871
Duration of model training in run 3: 5 hours, 32 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9800; val_auprc_score: 0.9914; val_best_acc_score: 0.9576; val_best_f1_score: 0.9722; train_kl_reg_loss: 22419.5468; train_edge_recon_loss: 1316835.7977; train_gene_expr_recon_loss: 1955139.4845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3294394.8341; train_optim_loss: 3294394.8341; val_kl_reg_loss: 22947.6263; val_edge_recon_loss: 1318453.6052; val_gene_expr_recon_loss: 1955560.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3296961.4575; val_optim_loss: 3296961.4575
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9797; val_auprc_score: 0.9910; val_best_acc_score: 0.9566; val_best_f1_score: 0.9714; train_kl_reg_loss: 22724.3895; train_edge_recon_loss: 1316354.4593; train_gene_expr_recon_loss: 1947812.5083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3286891.3576; train_optim_loss: 3286891.3576; val_kl_reg_loss: 23095.5006; val_edge_recon_loss: 1337924.6057; val_gene_expr_recon_loss: 1949954.5647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3310974.6798; val_optim_loss: 3310974.6798
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9800; val_auprc_score: 0.9916; val_best_acc_score: 0.9563; val_best_f1_score: 0.9713; train_kl_reg_loss: 23068.6931; train_edge_recon_loss: 1315756.5183; train_gene_expr_recon_loss: 1940828.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279653.3050; train_optim_loss: 3279653.3050; val_kl_reg_loss: 23349.6457; val_edge_recon_loss: 1331370.8093; val_gene_expr_recon_loss: 1938066.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3292787.2569; val_optim_loss: 3292787.2569
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9811; val_auprc_score: 0.9919; val_best_acc_score: 0.9580; val_best_f1_score: 0.9723; train_kl_reg_loss: 23367.9419; train_edge_recon_loss: 1315483.8529; train_gene_expr_recon_loss: 1932987.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3271838.8971; train_optim_loss: 3271838.8971; val_kl_reg_loss: 23633.2938; val_edge_recon_loss: 1324934.5193; val_gene_expr_recon_loss: 1936051.0316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3284618.8468; val_optim_loss: 3284618.8468
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9809; val_auprc_score: 0.9917; val_best_acc_score: 0.9576; val_best_f1_score: 0.9721; train_kl_reg_loss: 23614.6335; train_edge_recon_loss: 1318759.1720; train_gene_expr_recon_loss: 1926735.3037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269109.1091; train_optim_loss: 3269109.1091; val_kl_reg_loss: 23816.0457; val_edge_recon_loss: 1330711.3720; val_gene_expr_recon_loss: 1931434.1808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3285961.5998; val_optim_loss: 3285961.5998
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9799; val_auprc_score: 0.9914; val_best_acc_score: 0.9569; val_best_f1_score: 0.9716; train_kl_reg_loss: 24276.8666; train_edge_recon_loss: 1316633.5609; train_gene_expr_recon_loss: 1928065.2703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3268975.6972; train_optim_loss: 3268975.6972; val_kl_reg_loss: 26027.6891; val_edge_recon_loss: 1331354.7125; val_gene_expr_recon_loss: 1948120.2372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3305502.6413; val_optim_loss: 3305502.6413
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9824; val_auprc_score: 0.9925; val_best_acc_score: 0.9597; val_best_f1_score: 0.9735; train_kl_reg_loss: 24688.6887; train_edge_recon_loss: 1314590.6627; train_gene_expr_recon_loss: 1918934.7027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3258214.0531; train_optim_loss: 3258214.0531; val_kl_reg_loss: 24460.7427; val_edge_recon_loss: 1326209.8498; val_gene_expr_recon_loss: 1922312.2712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272982.8686; val_optim_loss: 3272982.8686
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9828; val_auprc_score: 0.9926; val_best_acc_score: 0.9603; val_best_f1_score: 0.9738; train_kl_reg_loss: 25230.1074; train_edge_recon_loss: 1317481.7363; train_gene_expr_recon_loss: 1913508.5855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3256220.4261; train_optim_loss: 3256220.4261; val_kl_reg_loss: 24656.1563; val_edge_recon_loss: 1335518.2258; val_gene_expr_recon_loss: 1920478.5138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3280652.8953; val_optim_loss: 3280652.8953
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9834; val_auprc_score: 0.9930; val_best_acc_score: 0.9592; val_best_f1_score: 0.9730; train_kl_reg_loss: 25072.8723; train_edge_recon_loss: 1316214.4571; train_gene_expr_recon_loss: 1916383.1173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3257670.4433; train_optim_loss: 3257670.4433; val_kl_reg_loss: 24953.4781; val_edge_recon_loss: 1341633.9689; val_gene_expr_recon_loss: 1938476.8972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3305064.3330; val_optim_loss: 3305064.3330
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9832; val_auprc_score: 0.9929; val_best_acc_score: 0.9599; val_best_f1_score: 0.9736; train_kl_reg_loss: 25681.6985; train_edge_recon_loss: 1316229.4257; train_gene_expr_recon_loss: 1905547.4606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3247458.5820; train_optim_loss: 3247458.5820; val_kl_reg_loss: 25806.9718; val_edge_recon_loss: 1333733.2208; val_gene_expr_recon_loss: 1910103.6650; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3269643.8518; val_optim_loss: 3269643.8518
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9838; val_auprc_score: 0.9931; val_best_acc_score: 0.9619; val_best_f1_score: 0.9749; train_kl_reg_loss: 26060.1937; train_edge_recon_loss: 1316551.5231; train_gene_expr_recon_loss: 1911239.1647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3253850.8822; train_optim_loss: 3253850.8822; val_kl_reg_loss: 26158.7712; val_edge_recon_loss: 1326713.9190; val_gene_expr_recon_loss: 1910323.2055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263195.8903; val_optim_loss: 3263195.8903
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9820; val_auprc_score: 0.9921; val_best_acc_score: 0.9589; val_best_f1_score: 0.9729; train_kl_reg_loss: 26736.8907; train_edge_recon_loss: 1317752.3383; train_gene_expr_recon_loss: 1904962.3311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3249451.5587; train_optim_loss: 3249451.5587; val_kl_reg_loss: 27079.2120; val_edge_recon_loss: 1335045.3182; val_gene_expr_recon_loss: 1916501.9550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3278626.4783; val_optim_loss: 3278626.4783
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9814; val_auprc_score: 0.9918; val_best_acc_score: 0.9606; val_best_f1_score: 0.9741; train_kl_reg_loss: 26822.4693; train_edge_recon_loss: 1315279.2638; train_gene_expr_recon_loss: 1897191.1765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3239292.9111; train_optim_loss: 3239292.9111; val_kl_reg_loss: 25896.0377; val_edge_recon_loss: 1331251.2016; val_gene_expr_recon_loss: 1914478.3503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3271625.5820; val_optim_loss: 3271625.5820
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9821; val_auprc_score: 0.9924; val_best_acc_score: 0.9609; val_best_f1_score: 0.9743; train_kl_reg_loss: 26833.8936; train_edge_recon_loss: 1314907.2959; train_gene_expr_recon_loss: 1896438.0856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238179.2740; train_optim_loss: 3238179.2740; val_kl_reg_loss: 27672.2744; val_edge_recon_loss: 1321583.3019; val_gene_expr_recon_loss: 1908051.7624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3257307.3251; val_optim_loss: 3257307.3251
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9818; val_auprc_score: 0.9920; val_best_acc_score: 0.9599; val_best_f1_score: 0.9735; train_kl_reg_loss: 26944.6910; train_edge_recon_loss: 1316327.1923; train_gene_expr_recon_loss: 1895045.0008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238316.8846; train_optim_loss: 3238316.8846; val_kl_reg_loss: 27289.8723; val_edge_recon_loss: 1333254.7283; val_gene_expr_recon_loss: 1899734.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3260279.0998; val_optim_loss: 3260279.0998
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9827; val_auprc_score: 0.9923; val_best_acc_score: 0.9611; val_best_f1_score: 0.9744; train_kl_reg_loss: 26837.5225; train_edge_recon_loss: 1316116.5545; train_gene_expr_recon_loss: 1891835.1200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234789.2017; train_optim_loss: 3234789.2017; val_kl_reg_loss: 26604.8358; val_edge_recon_loss: 1330336.6378; val_gene_expr_recon_loss: 1890209.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3247151.0800; val_optim_loss: 3247151.0800
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9816; val_auprc_score: 0.9919; val_best_acc_score: 0.9595; val_best_f1_score: 0.9733; train_kl_reg_loss: 20893598679308.0352; train_edge_recon_loss: 1316748.6197; train_gene_expr_recon_loss: 1930388.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20893601923371.0820; train_optim_loss: 20893601923371.0820; val_kl_reg_loss: 50256252767.3587; val_edge_recon_loss: 1337545.6245; val_gene_expr_recon_loss: 2015045.1512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50259604566.6858; val_optim_loss: 50259604566.6858
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9833; val_auprc_score: 0.9927; val_best_acc_score: 0.9613; val_best_f1_score: 0.9745; train_kl_reg_loss: 50204727.9343; train_edge_recon_loss: 1319614.9338; train_gene_expr_recon_loss: 1931062.8985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53455406.4560; train_optim_loss: 53455406.4560; val_kl_reg_loss: 31473.4109; val_edge_recon_loss: 1334898.5919; val_gene_expr_recon_loss: 1913874.4995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3280246.5227; val_optim_loss: 3280246.5227
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9833; val_auprc_score: 0.9928; val_best_acc_score: 0.9615; val_best_f1_score: 0.9746; train_kl_reg_loss: 31029.2593; train_edge_recon_loss: 1316050.9699; train_gene_expr_recon_loss: 1910333.2780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3257413.5088; train_optim_loss: 3257413.5088; val_kl_reg_loss: 31145.8018; val_edge_recon_loss: 1325196.8948; val_gene_expr_recon_loss: 1912226.9600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3268569.6621; val_optim_loss: 3268569.6621
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8768; val_auprc_score: 0.9566; val_best_acc_score: 0.8197; val_best_f1_score: 0.8847; train_kl_reg_loss: 70896471084681.7656; train_edge_recon_loss: 1356829.2122; train_gene_expr_recon_loss: 2686654.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70896475126738.5625; train_optim_loss: 70896475126738.5625; val_kl_reg_loss: 313379.7937; val_edge_recon_loss: 1993067.7149; val_gene_expr_recon_loss: 14989156.9763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 17295604.4506; val_optim_loss: 17295604.4506

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9147; val_auprc_score: 0.9684; val_best_acc_score: 0.8631; val_best_f1_score: 0.9109; train_kl_reg_loss: 200075.8489; train_edge_recon_loss: 1818279.1106; train_gene_expr_recon_loss: 8234291.9870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10252646.9342; train_optim_loss: 10252646.9342; val_kl_reg_loss: 112830.7116; val_edge_recon_loss: 1635949.7890; val_gene_expr_recon_loss: 3208168.2599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4956948.7787; val_optim_loss: 4956948.7787
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9701; val_auprc_score: 0.9871; val_best_acc_score: 0.9455; val_best_f1_score: 0.9643; train_kl_reg_loss: 76609.0133; train_edge_recon_loss: 1427814.8096; train_gene_expr_recon_loss: 2566303.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4070726.8263; train_optim_loss: 4070726.8263; val_kl_reg_loss: 47792.9682; val_edge_recon_loss: 1331057.7213; val_gene_expr_recon_loss: 2202538.4254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3581389.1136; val_optim_loss: 3581389.1136
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9818; val_auprc_score: 0.9925; val_best_acc_score: 0.9571; val_best_f1_score: 0.9718; train_kl_reg_loss: 40886.7519; train_edge_recon_loss: 1313368.6902; train_gene_expr_recon_loss: 2096155.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3450410.6634; train_optim_loss: 3450410.6634; val_kl_reg_loss: 37457.4382; val_edge_recon_loss: 1323635.3888; val_gene_expr_recon_loss: 2014419.1467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375511.9733; val_optim_loss: 3375511.9733
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9834; val_auprc_score: 0.9931; val_best_acc_score: 0.9601; val_best_f1_score: 0.9737; train_kl_reg_loss: 35666.1983; train_edge_recon_loss: 1311538.1247; train_gene_expr_recon_loss: 1962090.5024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3309294.8236; train_optim_loss: 3309294.8236; val_kl_reg_loss: 34888.6196; val_edge_recon_loss: 1327694.4862; val_gene_expr_recon_loss: 1943445.7717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3306028.8834; val_optim_loss: 3306028.8834

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 601 min 41 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9831
val AUPRC score: 0.9926
val best accuracy score: 0.9623
val best F1 score: 0.9751
val target rna MSE score: 0.5894
val source rna MSE score: 0.0943
Val cat covariate0 mean sim diff: 0.0007
Val cat covariate1 mean sim diff: -0.0940
Duration of model training in run 3: 10 hours, 5 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
