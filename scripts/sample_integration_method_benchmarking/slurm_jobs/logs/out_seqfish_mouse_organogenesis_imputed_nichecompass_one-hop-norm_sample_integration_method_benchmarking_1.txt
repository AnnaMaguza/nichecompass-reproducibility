Run timestamp: 16082023_144653_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '--cell_type_key', 'celltype_mapped_refined', '--filter_genes', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5715 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5715, n_cat_covariates_embed_input: 0, n_hidden: 1567, n_latent: 1557, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1557, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5715
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1557, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5715

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9269; val_auprc_score: 0.9848; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 28120312.7251; train_edge_recon_loss: 1120145.9598; train_gene_expr_recon_loss: 289924094.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 319164554.2857; train_optim_loss: 319164554.2857; val_kl_reg_loss: 657852.3125; val_edge_recon_loss: 1187696.5000; val_gene_expr_recon_loss: 97241336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 99086888.0000; val_optim_loss: 99086888.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9246; val_auprc_score: 0.9832; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 947856.6473; train_edge_recon_loss: 1193237.3750; train_gene_expr_recon_loss: 91738436.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 93879529.7143; train_optim_loss: 93879529.7143; val_kl_reg_loss: 1186205.3125; val_edge_recon_loss: 1177620.8125; val_gene_expr_recon_loss: 85385768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 87749596.0000; val_optim_loss: 87749596.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9173; val_auprc_score: 0.9801; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 1358322.2946; train_edge_recon_loss: 1194024.8393; train_gene_expr_recon_loss: 83024877.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 85577225.1429; train_optim_loss: 85577225.1429; val_kl_reg_loss: 1419171.4375; val_edge_recon_loss: 1184569.6875; val_gene_expr_recon_loss: 81265844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 83869584.0000; val_optim_loss: 83869584.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9100; val_auprc_score: 0.9774; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1488059.9375; train_edge_recon_loss: 1192612.7143; train_gene_expr_recon_loss: 79671373.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82352045.7143; train_optim_loss: 82352045.7143; val_kl_reg_loss: 1459459.1875; val_edge_recon_loss: 1206723.8125; val_gene_expr_recon_loss: 78570180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 81236364.0000; val_optim_loss: 81236364.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9175; val_auprc_score: 0.9800; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 1488300.8304; train_edge_recon_loss: 1198559.8393; train_gene_expr_recon_loss: 77830562.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 80517424.0000; train_optim_loss: 80517424.0000; val_kl_reg_loss: 1430761.3750; val_edge_recon_loss: 1199818.1875; val_gene_expr_recon_loss: 77117280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 79747860.0000; val_optim_loss: 79747860.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9139; val_auprc_score: 0.9790; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 1449878.0714; train_edge_recon_loss: 1193574.3482; train_gene_expr_recon_loss: 76407957.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79051410.2857; train_optim_loss: 79051410.2857; val_kl_reg_loss: 1382986.6250; val_edge_recon_loss: 1189946.6875; val_gene_expr_recon_loss: 75640992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 78213928.0000; val_optim_loss: 78213928.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9156; val_auprc_score: 0.9805; val_best_acc_score: 0.8605; val_best_f1_score: 0.9250; train_kl_reg_loss: 1401792.1875; train_edge_recon_loss: 1203199.0714; train_gene_expr_recon_loss: 74819302.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77424294.2857; train_optim_loss: 77424294.2857; val_kl_reg_loss: 1336703.4375; val_edge_recon_loss: 1134559.6875; val_gene_expr_recon_loss: 73900544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 76371804.0000; val_optim_loss: 76371804.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9201; val_auprc_score: 0.9806; val_best_acc_score: 0.8490; val_best_f1_score: 0.9184; train_kl_reg_loss: 1351754.2321; train_edge_recon_loss: 1199043.1161; train_gene_expr_recon_loss: 72838774.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 75389572.0000; train_optim_loss: 75389572.0000; val_kl_reg_loss: 1286355.2500; val_edge_recon_loss: 1223111.8750; val_gene_expr_recon_loss: 71650908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74160376.0000; val_optim_loss: 74160376.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9173; val_auprc_score: 0.9804; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 1303106.6250; train_edge_recon_loss: 1193094.4554; train_gene_expr_recon_loss: 70436164.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 72932364.0000; train_optim_loss: 72932364.0000; val_kl_reg_loss: 1241347.5625; val_edge_recon_loss: 1201178.3125; val_gene_expr_recon_loss: 69088508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71531036.0000; val_optim_loss: 71531036.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9240; val_auprc_score: 0.9824; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 1254595.8304; train_edge_recon_loss: 1193738.0625; train_gene_expr_recon_loss: 67721500.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70169833.7143; train_optim_loss: 70169833.7143; val_kl_reg_loss: 1194425.5625; val_edge_recon_loss: 1194517.2500; val_gene_expr_recon_loss: 66230412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68619356.0000; val_optim_loss: 68619356.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8976; val_auprc_score: 0.9725; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 3331792357.2679; train_edge_recon_loss: 1137700.3125; train_gene_expr_recon_loss: 673525866.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006456017.7143; train_optim_loss: 4006456017.7143; val_kl_reg_loss: 2285673.1250; val_edge_recon_loss: 1199852.5625; val_gene_expr_recon_loss: 119276544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 122762068.0000; val_optim_loss: 122762068.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8615; val_auprc_score: 0.9592; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 145549395.6250; train_edge_recon_loss: 1180536.6696; train_gene_expr_recon_loss: 326236141.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 472966085.7143; train_optim_loss: 472966085.7143; val_kl_reg_loss: 4388042.2500; val_edge_recon_loss: 1198004.3750; val_gene_expr_recon_loss: 122510164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 128096208.0000; val_optim_loss: 128096208.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8280; val_auprc_score: 0.9484; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 76519167734.9286; train_edge_recon_loss: 1176541.8304; train_gene_expr_recon_loss: 518473141.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77038817153.1429; train_optim_loss: 77038817153.1429; val_kl_reg_loss: 5854465.7500; val_edge_recon_loss: 1196545.5625; val_gene_expr_recon_loss: 95489364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 102540376.0000; val_optim_loss: 102540376.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8290; val_auprc_score: 0.9476; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 788467059098.1072; train_edge_recon_loss: 1179875.3929; train_gene_expr_recon_loss: 297466440.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 788765723802.2858; train_optim_loss: 788765723802.2858; val_kl_reg_loss: 6368194.0000; val_edge_recon_loss: 1216206.5625; val_gene_expr_recon_loss: 87749688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 95334088.0000; val_optim_loss: 95334088.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8263; val_auprc_score: 0.9483; val_best_acc_score: 0.8552; val_best_f1_score: 0.9220; train_kl_reg_loss: 6525375.3929; train_edge_recon_loss: 1194746.7679; train_gene_expr_recon_loss: 83537010.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 91257131.4286; train_optim_loss: 91257131.4286; val_kl_reg_loss: 6290133.2500; val_edge_recon_loss: 1175086.2500; val_gene_expr_recon_loss: 80875336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88340556.0000; val_optim_loss: 88340556.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8239; val_auprc_score: 0.9454; val_best_acc_score: 0.8499; val_best_f1_score: 0.9188; train_kl_reg_loss: 6389464.1071; train_edge_recon_loss: 1192700.8214; train_gene_expr_recon_loss: 79036022.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86618189.1429; train_optim_loss: 86618189.1429; val_kl_reg_loss: 6126620.0000; val_edge_recon_loss: 1218861.8125; val_gene_expr_recon_loss: 77695724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 85041204.0000; val_optim_loss: 85041204.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8205; val_auprc_score: 0.9447; val_best_acc_score: 0.8504; val_best_f1_score: 0.9191; train_kl_reg_loss: 6246136.5714; train_edge_recon_loss: 1195495.7857; train_gene_expr_recon_loss: 76786918.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 84228550.8571; train_optim_loss: 84228550.8571; val_kl_reg_loss: 6019250.2500; val_edge_recon_loss: 1207290.7500; val_gene_expr_recon_loss: 76198024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 83424564.0000; val_optim_loss: 83424564.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8230; val_auprc_score: 0.9449; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 6115147.2857; train_edge_recon_loss: 1189199.8393; train_gene_expr_recon_loss: 75797621.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 83101967.4286; train_optim_loss: 83101967.4286; val_kl_reg_loss: 5877474.5000; val_edge_recon_loss: 1217917.6875; val_gene_expr_recon_loss: 75673408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82768804.0000; val_optim_loss: 82768804.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 23 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
val AUROC score: 0.9184
val AUPRC score: 0.9806
val best accuracy score: 0.8513
val best F1 score: 0.9197
val target rna MSE score: 30.1102
val source rna MSE score: 44.0963
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 1: 0 hours, 6 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5715 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5715, n_cat_covariates_embed_input: 0, n_hidden: 1567, n_latent: 1557, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1557, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5715
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1557, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5715

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9202; val_auprc_score: 0.9831; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 50307293.2649; train_edge_recon_loss: 1125341.0134; train_gene_expr_recon_loss: 517620516.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 569053148.5714; train_optim_loss: 569053148.5714; val_kl_reg_loss: 688461.2500; val_edge_recon_loss: 1189616.4375; val_gene_expr_recon_loss: 103812228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105690308.0000; val_optim_loss: 105690308.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9107; val_auprc_score: 0.9789; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1120863.4866; train_edge_recon_loss: 1183696.4375; train_gene_expr_recon_loss: 110377671.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 112682230.8571; train_optim_loss: 112682230.8571; val_kl_reg_loss: 1334531.3125; val_edge_recon_loss: 1197761.4375; val_gene_expr_recon_loss: 90412008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 92944300.0000; val_optim_loss: 92944300.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9061; val_auprc_score: 0.9768; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 1478077.7857; train_edge_recon_loss: 1203763.6339; train_gene_expr_recon_loss: 87407401.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 90089242.2857; train_optim_loss: 90089242.2857; val_kl_reg_loss: 1490000.0000; val_edge_recon_loss: 1214865.7500; val_gene_expr_recon_loss: 83350160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86055024.0000; val_optim_loss: 86055024.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9106; val_auprc_score: 0.9786; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 1512942.2321; train_edge_recon_loss: 1185224.6071; train_gene_expr_recon_loss: 82211609.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 84909777.1429; train_optim_loss: 84909777.1429; val_kl_reg_loss: 1421409.7500; val_edge_recon_loss: 1196487.0625; val_gene_expr_recon_loss: 81013712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 83631612.0000; val_optim_loss: 83631612.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9154; val_auprc_score: 0.9799; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1401252.8929; train_edge_recon_loss: 1192346.1964; train_gene_expr_recon_loss: 79667233.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82260833.7143; train_optim_loss: 82260833.7143; val_kl_reg_loss: 1280605.8750; val_edge_recon_loss: 1203765.2500; val_gene_expr_recon_loss: 78566228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 81050596.0000; val_optim_loss: 81050596.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9107; val_auprc_score: 0.9792; val_best_acc_score: 0.8507; val_best_f1_score: 0.9194; train_kl_reg_loss: 1249942.2054; train_edge_recon_loss: 1205041.3304; train_gene_expr_recon_loss: 77514849.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79969833.1429; train_optim_loss: 79969833.1429; val_kl_reg_loss: 1143377.6250; val_edge_recon_loss: 1209335.2500; val_gene_expr_recon_loss: 76322092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 78674804.0000; val_optim_loss: 78674804.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9143; val_auprc_score: 0.9813; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 1115158.6250; train_edge_recon_loss: 1187167.9286; train_gene_expr_recon_loss: 75119814.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77422140.0000; train_optim_loss: 77422140.0000; val_kl_reg_loss: 1020329.7188; val_edge_recon_loss: 1185121.0625; val_gene_expr_recon_loss: 73695168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75900620.0000; val_optim_loss: 75900620.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9161; val_auprc_score: 0.9816; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 998576.8438; train_edge_recon_loss: 1209523.5982; train_gene_expr_recon_loss: 72305342.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74513442.2857; train_optim_loss: 74513442.2857; val_kl_reg_loss: 913751.5625; val_edge_recon_loss: 1190290.0625; val_gene_expr_recon_loss: 70671792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72775836.0000; val_optim_loss: 72775836.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9128; val_auprc_score: 0.9810; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 899860.8929; train_edge_recon_loss: 1195922.5714; train_gene_expr_recon_loss: 69230820.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71326602.8571; train_optim_loss: 71326602.8571; val_kl_reg_loss: 827605.4375; val_edge_recon_loss: 1203763.3750; val_gene_expr_recon_loss: 67616460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69647828.0000; val_optim_loss: 69647828.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9139; val_auprc_score: 0.9823; val_best_acc_score: 0.8576; val_best_f1_score: 0.9233; train_kl_reg_loss: 814428.9955; train_edge_recon_loss: 1191084.9196; train_gene_expr_recon_loss: 66248431.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68253945.4286; train_optim_loss: 68253945.4286; val_kl_reg_loss: 751600.4375; val_edge_recon_loss: 1159748.2500; val_gene_expr_recon_loss: 64805390.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66716738.0000; val_optim_loss: 66716738.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9204; val_auprc_score: 0.9836; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 741184.2232; train_edge_recon_loss: 1196811.2946; train_gene_expr_recon_loss: 63672951.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65610946.0000; train_optim_loss: 65610946.0000; val_kl_reg_loss: 684790.5312; val_edge_recon_loss: 1208896.7500; val_gene_expr_recon_loss: 62543730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64437418.0000; val_optim_loss: 64437418.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9085; val_auprc_score: 0.9809; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 676379.2589; train_edge_recon_loss: 1197514.9018; train_gene_expr_recon_loss: 61681071.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63554964.8571; train_optim_loss: 63554964.8571; val_kl_reg_loss: 628082.3438; val_edge_recon_loss: 1198303.6250; val_gene_expr_recon_loss: 60907498.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62733884.0000; val_optim_loss: 62733884.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9155; val_auprc_score: 0.9824; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 621009.9688; train_edge_recon_loss: 1194498.3036; train_gene_expr_recon_loss: 60287704.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62103213.1429; train_optim_loss: 62103213.1429; val_kl_reg_loss: 576751.7500; val_edge_recon_loss: 1194852.3125; val_gene_expr_recon_loss: 59726196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61497800.0000; val_optim_loss: 61497800.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9129; val_auprc_score: 0.9817; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 572932.9866; train_edge_recon_loss: 1196622.4375; train_gene_expr_recon_loss: 59345258.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61114814.0000; train_optim_loss: 61114814.0000; val_kl_reg_loss: 532953.6250; val_edge_recon_loss: 1208435.8750; val_gene_expr_recon_loss: 58949924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60691314.0000; val_optim_loss: 60691314.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9089; val_auprc_score: 0.9818; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 530866.5424; train_edge_recon_loss: 1192759.8393; train_gene_expr_recon_loss: 58708360.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60431987.1429; train_optim_loss: 60431987.1429; val_kl_reg_loss: 495089.9531; val_edge_recon_loss: 1177408.5625; val_gene_expr_recon_loss: 58488352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60160852.0000; val_optim_loss: 60160852.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9089; val_auprc_score: 0.9814; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 494002.9397; train_edge_recon_loss: 1186474.3661; train_gene_expr_recon_loss: 58262950.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59943427.7143; train_optim_loss: 59943427.7143; val_kl_reg_loss: 462089.0938; val_edge_recon_loss: 1199334.7500; val_gene_expr_recon_loss: 58097534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59758958.0000; val_optim_loss: 59758958.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9050; val_auprc_score: 0.9816; val_best_acc_score: 0.8582; val_best_f1_score: 0.9237; train_kl_reg_loss: 459517.8125; train_edge_recon_loss: 1194791.4732; train_gene_expr_recon_loss: 57850353.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59504662.5714; train_optim_loss: 59504662.5714; val_kl_reg_loss: 429989.7031; val_edge_recon_loss: 1155701.8125; val_gene_expr_recon_loss: 57735184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59320876.0000; val_optim_loss: 59320876.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8961; val_auprc_score: 0.9736; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 20625415309465.4727; train_edge_recon_loss: 1139123.5893; train_gene_expr_recon_loss: 567381932.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20625983118182.5703; train_optim_loss: 20625983118182.5703; val_kl_reg_loss: 5973634.0000; val_edge_recon_loss: 1205819.7500; val_gene_expr_recon_loss: 1177126080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1184305536.0000; val_optim_loss: 1184305536.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.6686; val_auprc_score: 0.8967; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 410154874921777.5625; train_edge_recon_loss: 1153166.2768; train_gene_expr_recon_loss: 1253869522.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 410156147279341.6875; train_optim_loss: 410156147279341.6875; val_kl_reg_loss: 4284342075392.0000; val_edge_recon_loss: 1210606.4375; val_gene_expr_recon_loss: 1221099648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4285564452864.0000; val_optim_loss: 4285564452864.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7648; val_auprc_score: 0.9293; val_best_acc_score: 0.8591; val_best_f1_score: 0.9242; train_kl_reg_loss: 267271901477006432.0000; train_edge_recon_loss: 1188228.2857; train_gene_expr_recon_loss: 1564355657.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 267271902714504992.0000; train_optim_loss: 267271902714504992.0000; val_kl_reg_loss: 23517359.0000; val_edge_recon_loss: 1153599.3125; val_gene_expr_recon_loss: 1020624704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1045295648.0000; val_optim_loss: 1045295648.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7980; val_auprc_score: 0.9374; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 2582114481773414.5000; train_edge_recon_loss: 1196967.0000; train_gene_expr_recon_loss: 1152586550.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2582115533919565.5000; train_optim_loss: 2582115533919565.5000; val_kl_reg_loss: 19026628.0000; val_edge_recon_loss: 1180307.9375; val_gene_expr_recon_loss: 912539680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 932746592.0000; val_optim_loss: 932746592.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7929; val_auprc_score: 0.9348; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 19284856.0000; train_edge_recon_loss: 1196259.1429; train_gene_expr_recon_loss: 894265979.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 914747090.2857; train_optim_loss: 914747090.2857; val_kl_reg_loss: 18405677.0000; val_edge_recon_loss: 1209587.5000; val_gene_expr_recon_loss: 886352704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 905967968.0000; val_optim_loss: 905967968.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8054; val_auprc_score: 0.9387; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 18647448.2857; train_edge_recon_loss: 1190235.0714; train_gene_expr_recon_loss: 882964155.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 902801842.2857; train_optim_loss: 902801842.2857; val_kl_reg_loss: 17742255.0000; val_edge_recon_loss: 1221292.0000; val_gene_expr_recon_loss: 879614848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 898578400.0000; val_optim_loss: 898578400.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7936; val_auprc_score: 0.9343; val_best_acc_score: 0.8494; val_best_f1_score: 0.9186; train_kl_reg_loss: 17993624.5714; train_edge_recon_loss: 1191749.0000; train_gene_expr_recon_loss: 879058500.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 898243872.0000; train_optim_loss: 898243872.0000; val_kl_reg_loss: 17139877.0000; val_edge_recon_loss: 1211808.3125; val_gene_expr_recon_loss: 878056928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 896408608.0000; val_optim_loss: 896408608.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7950; val_auprc_score: 0.9363; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 17388993.2857; train_edge_recon_loss: 1192246.9911; train_gene_expr_recon_loss: 877224612.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 895805846.8571; train_optim_loss: 895805846.8571; val_kl_reg_loss: 16602881.0000; val_edge_recon_loss: 1199416.0625; val_gene_expr_recon_loss: 876068608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 893870912.0000; val_optim_loss: 893870912.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 48 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
val AUROC score: 0.9064
val AUPRC score: 0.9814
val best accuracy score: 0.8532
val best F1 score: 0.9208
val target rna MSE score: 19.9899
val source rna MSE score: 22.4143
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 2: 0 hours, 9 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5726 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5726, n_cat_covariates_embed_input: 0, n_hidden: 1565, n_latent: 1555, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5726
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5726

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9447; val_auprc_score: 0.9878; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 6107279.7077; train_edge_recon_loss: 1152153.1667; train_gene_expr_recon_loss: 253148803.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 260408238.2222; train_optim_loss: 260408238.2222; val_kl_reg_loss: 781349.6667; val_edge_recon_loss: 1185897.7917; val_gene_expr_recon_loss: 90581074.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 92548322.6667; val_optim_loss: 92548322.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9402; val_auprc_score: 0.9858; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 971191.3981; train_edge_recon_loss: 1193253.2917; train_gene_expr_recon_loss: 82876662.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 85041106.9630; train_optim_loss: 85041106.9630; val_kl_reg_loss: 1033283.2917; val_edge_recon_loss: 1203572.8333; val_gene_expr_recon_loss: 79485565.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 81722421.3333; val_optim_loss: 81722421.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9382; val_auprc_score: 0.9853; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 1051209.2153; train_edge_recon_loss: 1191057.6204; train_gene_expr_recon_loss: 77932976.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 80175243.5556; train_optim_loss: 80175243.5556; val_kl_reg_loss: 1008539.6875; val_edge_recon_loss: 1200103.3750; val_gene_expr_recon_loss: 76465290.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 78673933.3333; val_optim_loss: 78673933.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9425; val_auprc_score: 0.9871; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 1004860.0162; train_edge_recon_loss: 1191876.8287; train_gene_expr_recon_loss: 74858184.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77054920.8889; train_optim_loss: 77054920.8889; val_kl_reg_loss: 954146.8750; val_edge_recon_loss: 1179813.7083; val_gene_expr_recon_loss: 73139184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75273144.0000; val_optim_loss: 75273144.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9411; val_auprc_score: 0.9865; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 946635.2338; train_edge_recon_loss: 1198408.5741; train_gene_expr_recon_loss: 71126104.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 73271147.8519; train_optim_loss: 73271147.8519; val_kl_reg_loss: 894860.2292; val_edge_recon_loss: 1191293.5000; val_gene_expr_recon_loss: 69107536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71193688.0000; val_optim_loss: 71193688.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9377; val_auprc_score: 0.9861; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 898409.0972; train_edge_recon_loss: 1200618.8426; train_gene_expr_recon_loss: 67043556.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69142585.1852; train_optim_loss: 69142585.1852; val_kl_reg_loss: 853088.1875; val_edge_recon_loss: 1189687.2083; val_gene_expr_recon_loss: 64936092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66978868.0000; val_optim_loss: 66978868.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9363; val_auprc_score: 0.9857; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 846341.8125; train_edge_recon_loss: 1197680.2176; train_gene_expr_recon_loss: 63143069.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65187092.1481; train_optim_loss: 65187092.1481; val_kl_reg_loss: 800866.0833; val_edge_recon_loss: 1206098.9583; val_gene_expr_recon_loss: 61491757.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63498721.3333; val_optim_loss: 63498721.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9308; val_auprc_score: 0.9848; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 792236.4074; train_edge_recon_loss: 1192348.0972; train_gene_expr_recon_loss: 60222927.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62207512.4444; train_optim_loss: 62207512.4444; val_kl_reg_loss: 748922.5833; val_edge_recon_loss: 1195901.2083; val_gene_expr_recon_loss: 59197473.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61142297.3333; val_optim_loss: 61142297.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9321; val_auprc_score: 0.9858; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 742087.0278; train_edge_recon_loss: 1196392.4259; train_gene_expr_recon_loss: 58416225.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60354705.6296; train_optim_loss: 60354705.6296; val_kl_reg_loss: 701207.8958; val_edge_recon_loss: 1181679.7083; val_gene_expr_recon_loss: 57837081.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59719969.3333; val_optim_loss: 59719969.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9258; val_auprc_score: 0.9846; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 695644.2870; train_edge_recon_loss: 1201598.7083; train_gene_expr_recon_loss: 57375015.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59272258.5185; train_optim_loss: 59272258.5185; val_kl_reg_loss: 657520.5000; val_edge_recon_loss: 1183668.9583; val_gene_expr_recon_loss: 57044116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58885305.3333; val_optim_loss: 58885305.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9219; val_auprc_score: 0.9842; val_best_acc_score: 0.8557; val_best_f1_score: 0.9223; train_kl_reg_loss: 651579.6088; train_edge_recon_loss: 1191574.4630; train_gene_expr_recon_loss: 56734349.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58577503.8519; train_optim_loss: 58577503.8519; val_kl_reg_loss: 616716.6875; val_edge_recon_loss: 1173891.5417; val_gene_expr_recon_loss: 56545850.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58336458.6667; val_optim_loss: 58336458.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9205; val_auprc_score: 0.9838; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 610763.9491; train_edge_recon_loss: 1207132.0741; train_gene_expr_recon_loss: 56302602.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58120498.2222; train_optim_loss: 58120498.2222; val_kl_reg_loss: 577115.1250; val_edge_recon_loss: 1203710.7917; val_gene_expr_recon_loss: 56160157.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57940982.6667; val_optim_loss: 57940982.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9166; val_auprc_score: 0.9834; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 572740.1065; train_edge_recon_loss: 1196981.2731; train_gene_expr_recon_loss: 55977531.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57747253.1852; train_optim_loss: 57747253.1852; val_kl_reg_loss: 540995.1458; val_edge_recon_loss: 1204350.5833; val_gene_expr_recon_loss: 55860864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57606209.3333; val_optim_loss: 57606209.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9089; val_auprc_score: 0.9822; val_best_acc_score: 0.8554; val_best_f1_score: 0.9220; train_kl_reg_loss: 537212.6736; train_edge_recon_loss: 1197712.3519; train_gene_expr_recon_loss: 55686601.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57421527.2593; train_optim_loss: 57421527.2593; val_kl_reg_loss: 507704.5521; val_edge_recon_loss: 1175929.3333; val_gene_expr_recon_loss: 55588918.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57272553.3333; val_optim_loss: 57272553.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9083; val_auprc_score: 0.9818; val_best_acc_score: 0.8530; val_best_f1_score: 0.9206; train_kl_reg_loss: 504243.6956; train_edge_recon_loss: 1189703.1852; train_gene_expr_recon_loss: 55440245.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57134192.8889; train_optim_loss: 57134192.8889; val_kl_reg_loss: 477559.6979; val_edge_recon_loss: 1195736.6250; val_gene_expr_recon_loss: 55364869.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57038166.6667; val_optim_loss: 57038166.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9028; val_auprc_score: 0.9808; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 473599.0590; train_edge_recon_loss: 1202655.8565; train_gene_expr_recon_loss: 55216289.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56892544.5926; train_optim_loss: 56892544.5926; val_kl_reg_loss: 448326.3854; val_edge_recon_loss: 1196200.2083; val_gene_expr_recon_loss: 55162592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56807118.6667; val_optim_loss: 56807118.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9056; val_auprc_score: 0.9806; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 1373934900.7338; train_edge_recon_loss: 1184846.9352; train_gene_expr_recon_loss: 184045157.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1559164892.8889; train_optim_loss: 1559164892.8889; val_kl_reg_loss: 2034119722.6667; val_edge_recon_loss: 1203827.6250; val_gene_expr_recon_loss: 367865109.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2403188650.6667; val_optim_loss: 2403188650.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.6795; val_auprc_score: 0.9012; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 25033944007395.4258; train_edge_recon_loss: 1148216.8102; train_gene_expr_recon_loss: 1493098429.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 25035438200116.1484; train_optim_loss: 25035438200116.1484; val_kl_reg_loss: 4923810133.3333; val_edge_recon_loss: 1193226.7917; val_gene_expr_recon_loss: 1344687573.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6269690880.0000; val_optim_loss: 6269690880.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.6899; val_auprc_score: 0.9029; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 3587861094.3333; train_edge_recon_loss: 1192113.2037; train_gene_expr_recon_loss: 1085515010.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4674568272.5926; train_optim_loss: 4674568272.5926; val_kl_reg_loss: 9866441.3333; val_edge_recon_loss: 1207184.5417; val_gene_expr_recon_loss: 863108224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 874181866.6667; val_optim_loss: 874181866.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8170; val_auprc_score: 0.9404; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 4783059305547.9443; train_edge_recon_loss: 1205002.2269; train_gene_expr_recon_loss: 913100653.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783973453252.7412; train_optim_loss: 4783973453252.7412; val_kl_reg_loss: 6525249.1667; val_edge_recon_loss: 1219820.6667; val_gene_expr_recon_loss: 858724117.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 866469184.0000; val_optim_loss: 866469184.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8128; val_auprc_score: 0.9411; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 6564678.6111; train_edge_recon_loss: 1195693.2963; train_gene_expr_recon_loss: 857625102.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 865385476.7407; train_optim_loss: 865385476.7407; val_kl_reg_loss: 6295281.3333; val_edge_recon_loss: 1184016.2917; val_gene_expr_recon_loss: 856583765.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 864063082.6667; val_optim_loss: 864063082.6667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8223; val_auprc_score: 0.9440; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 6328943.5370; train_edge_recon_loss: 1200815.3380; train_gene_expr_recon_loss: 854971510.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 862501269.3333; train_optim_loss: 862501269.3333; val_kl_reg_loss: 6078277.0000; val_edge_recon_loss: 1184953.9167; val_gene_expr_recon_loss: 854932544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 862195776.0000; val_optim_loss: 862195776.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8154; val_auprc_score: 0.9411; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 6123163.4074; train_edge_recon_loss: 1190371.3333; train_gene_expr_recon_loss: 854264843.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 861578377.4815; train_optim_loss: 861578377.4815; val_kl_reg_loss: 5876734.8333; val_edge_recon_loss: 1200629.6250; val_gene_expr_recon_loss: 854644480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 861721834.6667; val_optim_loss: 861721834.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8324; val_auprc_score: 0.9466; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 5918601.9630; train_edge_recon_loss: 1210158.6574; train_gene_expr_recon_loss: 854008194.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 861136957.6296; train_optim_loss: 861136957.6296; val_kl_reg_loss: 5689274.1667; val_edge_recon_loss: 1195794.5000; val_gene_expr_recon_loss: 854533973.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 861419050.6667; val_optim_loss: 861419050.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 50 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9052
val AUPRC score: 0.9810
val best accuracy score: 0.8513
val best F1 score: 0.9197
val target rna MSE score: 11.0302
val source rna MSE score: 23.8909
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 3: 0 hours, 15 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5726 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5726, n_cat_covariates_embed_input: 0, n_hidden: 1565, n_latent: 1555, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5726
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5726

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9446; val_auprc_score: 0.9865; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 83825544.7727; train_edge_recon_loss: 1150232.1389; train_gene_expr_recon_loss: 417667889.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 502643659.5556; train_optim_loss: 502643659.5556; val_kl_reg_loss: 1203356.5833; val_edge_recon_loss: 1216499.5417; val_gene_expr_recon_loss: 89241909.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 91661762.6667; val_optim_loss: 91661762.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9434; val_auprc_score: 0.9859; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 1495260.6713; train_edge_recon_loss: 1204535.5000; train_gene_expr_recon_loss: 86977605.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 89677402.0741; train_optim_loss: 89677402.0741; val_kl_reg_loss: 1571333.7083; val_edge_recon_loss: 1204509.8333; val_gene_expr_recon_loss: 83178176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 85954018.6667; val_optim_loss: 85954018.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9408; val_auprc_score: 0.9854; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 1561195.3981; train_edge_recon_loss: 1192617.4120; train_gene_expr_recon_loss: 81309491.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 84063304.2963; train_optim_loss: 84063304.2963; val_kl_reg_loss: 1472152.0417; val_edge_recon_loss: 1202765.5417; val_gene_expr_recon_loss: 79505904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82180821.3333; val_optim_loss: 82180821.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9429; val_auprc_score: 0.9864; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 1435225.1667; train_edge_recon_loss: 1197181.9676; train_gene_expr_recon_loss: 77317442.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79949850.3704; train_optim_loss: 79949850.3704; val_kl_reg_loss: 1339744.2917; val_edge_recon_loss: 1183487.4167; val_gene_expr_recon_loss: 74753341.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 77276570.6667; val_optim_loss: 77276570.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9436; val_auprc_score: 0.9866; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 1309668.3611; train_edge_recon_loss: 1194826.4907; train_gene_expr_recon_loss: 71942906.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74447401.4815; train_optim_loss: 74447401.4815; val_kl_reg_loss: 1222323.5833; val_edge_recon_loss: 1194703.2917; val_gene_expr_recon_loss: 68968970.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71385997.3333; val_optim_loss: 71385997.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9427; val_auprc_score: 0.9866; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 1194674.5509; train_edge_recon_loss: 1191901.5463; train_gene_expr_recon_loss: 66446291.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68832866.9630; train_optim_loss: 68832866.9630; val_kl_reg_loss: 1116051.1667; val_edge_recon_loss: 1201624.8333; val_gene_expr_recon_loss: 64104190.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66421868.0000; val_optim_loss: 66421868.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9403; val_auprc_score: 0.9866; val_best_acc_score: 0.8542; val_best_f1_score: 0.9213; train_kl_reg_loss: 1088465.2986; train_edge_recon_loss: 1180433.0556; train_gene_expr_recon_loss: 62458712.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64727610.3704; train_optim_loss: 64727610.3704; val_kl_reg_loss: 1015766.7500; val_edge_recon_loss: 1185512.2083; val_gene_expr_recon_loss: 61110493.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63311772.0000; val_optim_loss: 63311772.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8995; val_auprc_score: 0.9713; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 1066755637.8588; train_edge_recon_loss: 1163698.8958; train_gene_expr_recon_loss: 450197413.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1518116779.5556; train_optim_loss: 1518116779.5556; val_kl_reg_loss: 3547897.2500; val_edge_recon_loss: 1187785.3750; val_gene_expr_recon_loss: 678735978.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 683471658.6667; val_optim_loss: 683471658.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8519; val_auprc_score: 0.9564; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 17749024424.6852; train_edge_recon_loss: 1178560.5324; train_gene_expr_recon_loss: 1047079535.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18797282145.1852; train_optim_loss: 18797282145.1852; val_kl_reg_loss: 8029291.8333; val_edge_recon_loss: 1173407.2083; val_gene_expr_recon_loss: 892198186.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 901400874.6667; val_optim_loss: 901400874.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8721; val_auprc_score: 0.9633; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 6751548.4444; train_edge_recon_loss: 1194254.2639; train_gene_expr_recon_loss: 884713462.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 892659266.3704; train_optim_loss: 892659266.3704; val_kl_reg_loss: 5074415.0000; val_edge_recon_loss: 1222299.6250; val_gene_expr_recon_loss: 881063680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 887360384.0000; val_optim_loss: 887360384.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8866; val_auprc_score: 0.9713; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 4137577.0648; train_edge_recon_loss: 1195444.7500; train_gene_expr_recon_loss: 878595131.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 883928158.8148; train_optim_loss: 883928158.8148; val_kl_reg_loss: 3214420.3333; val_edge_recon_loss: 1178047.7083; val_gene_expr_recon_loss: 878189354.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 882581824.0000; val_optim_loss: 882581824.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8826; val_auprc_score: 0.9695; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 3216241.8426; train_edge_recon_loss: 1194923.5648; train_gene_expr_recon_loss: 877051908.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 881463080.2963; train_optim_loss: 881463080.2963; val_kl_reg_loss: 3094889.0000; val_edge_recon_loss: 1202488.4167; val_gene_expr_recon_loss: 878102016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 882399381.3333; val_optim_loss: 882399381.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8849; val_auprc_score: 0.9707; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 3103943.7037; train_edge_recon_loss: 1193002.0139; train_gene_expr_recon_loss: 877292800.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 881589741.0370; train_optim_loss: 881589741.0370; val_kl_reg_loss: 2986843.0833; val_edge_recon_loss: 1204109.9167; val_gene_expr_recon_loss: 877758805.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 881949760.0000; val_optim_loss: 881949760.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8888; val_auprc_score: 0.9725; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 2992536.5370; train_edge_recon_loss: 1199235.8333; train_gene_expr_recon_loss: 877006511.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 881198288.5926; train_optim_loss: 881198288.5926; val_kl_reg_loss: 2879045.0000; val_edge_recon_loss: 1189267.8750; val_gene_expr_recon_loss: 877841472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 881909781.3333; val_optim_loss: 881909781.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8919; val_auprc_score: 0.9737; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 2884947.9722; train_edge_recon_loss: 1199378.2269; train_gene_expr_recon_loss: 876888064.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 880972389.9259; train_optim_loss: 880972389.9259; val_kl_reg_loss: 2775516.4167; val_edge_recon_loss: 1181275.0417; val_gene_expr_recon_loss: 877566037.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 881522816.0000; val_optim_loss: 881522816.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 51 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
val AUROC score: 0.9407
val AUPRC score: 0.9863
val best accuracy score: 0.8503
val best F1 score: 0.9191
val target rna MSE score: 25.4313
val source rna MSE score: 39.1296
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 4: 0 hours, 9 minutes and 2 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5740 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5740, n_cat_covariates_embed_input: 0, n_hidden: 1564, n_latent: 1554, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1554, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5740
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1554, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5740

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9422; val_auprc_score: 0.9844; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 92287669.0551; train_edge_recon_loss: 1154619.0737; train_gene_expr_recon_loss: 326307430.3590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 419749713.4359; train_optim_loss: 419749713.4359; val_kl_reg_loss: 131290352.0000; val_edge_recon_loss: 1214585.4500; val_gene_expr_recon_loss: 97551588.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 230056531.2000; val_optim_loss: 230056531.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9264; val_auprc_score: 0.9779; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 6985472.1603; train_edge_recon_loss: 1193711.1346; train_gene_expr_recon_loss: 132066732.5128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 140245915.2821; train_optim_loss: 140245915.2821; val_kl_reg_loss: 4145776.7000; val_edge_recon_loss: 1225536.1000; val_gene_expr_recon_loss: 92004108.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 97375420.8000; val_optim_loss: 97375420.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9270; val_auprc_score: 0.9787; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 4100140.7756; train_edge_recon_loss: 1194825.8494; train_gene_expr_recon_loss: 88236221.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 93531188.3077; train_optim_loss: 93531188.3077; val_kl_reg_loss: 3804473.2500; val_edge_recon_loss: 1192361.9500; val_gene_expr_recon_loss: 84979736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 89976572.8000; val_optim_loss: 89976572.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9347; val_auprc_score: 0.9814; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 3604703.2179; train_edge_recon_loss: 1195406.2500; train_gene_expr_recon_loss: 81372453.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86172563.0769; train_optim_loss: 86172563.0769; val_kl_reg_loss: 3289653.0500; val_edge_recon_loss: 1201764.8250; val_gene_expr_recon_loss: 77466899.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 81958318.4000; val_optim_loss: 81958318.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8992; val_auprc_score: 0.9682; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 320792564.1346; train_edge_recon_loss: 1190987.5369; train_gene_expr_recon_loss: 178084242.8718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 500067780.3077; train_optim_loss: 500067780.3077; val_kl_reg_loss: 4396192.9000; val_edge_recon_loss: 1190752.1000; val_gene_expr_recon_loss: 87289193.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 92876137.6000; val_optim_loss: 92876137.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8963; val_auprc_score: 0.9666; val_best_acc_score: 0.8497; val_best_f1_score: 0.9188; train_kl_reg_loss: 5049053.4103; train_edge_recon_loss: 1192654.0449; train_gene_expr_recon_loss: 77325779.8974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 83567487.5897; train_optim_loss: 83567487.5897; val_kl_reg_loss: 4263497.5000; val_edge_recon_loss: 1236695.1250; val_gene_expr_recon_loss: 69981438.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75481632.0000; val_optim_loss: 75481632.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7633; val_auprc_score: 0.9244; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 2001190785761.6345; train_edge_recon_loss: 1170913.1907; train_gene_expr_recon_loss: 401209109.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2001593174066.0513; train_optim_loss: 2001593174066.0513; val_kl_reg_loss: 13623744.6000; val_edge_recon_loss: 1215601.3000; val_gene_expr_recon_loss: 126360020.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 141199366.4000; val_optim_loss: 141199366.4000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7111; val_auprc_score: 0.9094; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 412726983264046.6250; train_edge_recon_loss: 1186594.8526; train_gene_expr_recon_loss: 283673231.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 412727272454577.4375; train_optim_loss: 412727272454577.4375; val_kl_reg_loss: 18235957.2000; val_edge_recon_loss: 1209335.0000; val_gene_expr_recon_loss: 76574398.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 96019691.2000; val_optim_loss: 96019691.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7274; val_auprc_score: 0.9151; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 16816655689143.9238; train_edge_recon_loss: 1190126.2340; train_gene_expr_recon_loss: 177540136.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 16816834993544.6152; train_optim_loss: 16816834993544.6152; val_kl_reg_loss: 14155657.6000; val_edge_recon_loss: 1194305.5250; val_gene_expr_recon_loss: 72864153.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88214116.8000; val_optim_loss: 88214116.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7532; val_auprc_score: 0.9231; val_best_acc_score: 0.8545; val_best_f1_score: 0.9215; train_kl_reg_loss: 9349026753112.7695; train_edge_recon_loss: 1198206.1538; train_gene_expr_recon_loss: 311409340.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 9349339609941.7441; train_optim_loss: 9349339609941.7441; val_kl_reg_loss: 11594454.6000; val_edge_recon_loss: 1189896.4250; val_gene_expr_recon_loss: 880361728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 893146073.6000; val_optim_loss: 893146073.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7603; val_auprc_score: 0.9239; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 11656703.2051; train_edge_recon_loss: 1188867.2500; train_gene_expr_recon_loss: 880417826.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 893263396.1026; train_optim_loss: 893263396.1026; val_kl_reg_loss: 11336953.6000; val_edge_recon_loss: 1207908.6000; val_gene_expr_recon_loss: 881014412.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 893559270.4000; val_optim_loss: 893559270.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7683; val_auprc_score: 0.9262; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 11395278.2564; train_edge_recon_loss: 1197793.9423; train_gene_expr_recon_loss: 880059867.8974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 892652941.1282; train_optim_loss: 892652941.1282; val_kl_reg_loss: 11070629.0000; val_edge_recon_loss: 1204485.8500; val_gene_expr_recon_loss: 880250124.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 892525235.2000; val_optim_loss: 892525235.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7659; val_auprc_score: 0.9257; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 11121437.4359; train_edge_recon_loss: 1195946.3622; train_gene_expr_recon_loss: 879928019.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 892245402.2564; train_optim_loss: 892245402.2564; val_kl_reg_loss: 10803218.0000; val_edge_recon_loss: 1202344.9250; val_gene_expr_recon_loss: 880292134.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 892297689.6000; val_optim_loss: 892297689.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7676; val_auprc_score: 0.9258; val_best_acc_score: 0.8514; val_best_f1_score: 0.9198; train_kl_reg_loss: 10845328.6923; train_edge_recon_loss: 1194044.2981; train_gene_expr_recon_loss: 879801954.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 891841325.9487; train_optim_loss: 891841325.9487; val_kl_reg_loss: 10544111.0000; val_edge_recon_loss: 1209361.8000; val_gene_expr_recon_loss: 880050342.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 891803814.4000; val_optim_loss: 891803814.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 26 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
val AUROC score: 0.8919
val AUPRC score: 0.9659
val best accuracy score: 0.8523
val best F1 score: 0.9203
val target rna MSE score: 34.7835
val source rna MSE score: 32.9246
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 5: 0 hours, 12 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5740 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5740, n_cat_covariates_embed_input: 0, n_hidden: 1564, n_latent: 1554, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1554, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5740
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1554, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5740

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9334; val_auprc_score: 0.9810; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 772837975.7871; train_edge_recon_loss: 1143668.1827; train_gene_expr_recon_loss: 407246499.8974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1181228127.7949; train_optim_loss: 1181228127.7949; val_kl_reg_loss: 3311099.4000; val_edge_recon_loss: 1191090.1250; val_gene_expr_recon_loss: 105546550.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 110048739.2000; val_optim_loss: 110048739.2000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9120; val_auprc_score: 0.9736; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 5423972.5897; train_edge_recon_loss: 1193045.6506; train_gene_expr_recon_loss: 127732647.1795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 134349666.2564; train_optim_loss: 134349666.2564; val_kl_reg_loss: 5519263.3000; val_edge_recon_loss: 1168149.4000; val_gene_expr_recon_loss: 89445081.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 96132492.8000; val_optim_loss: 96132492.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9113; val_auprc_score: 0.9729; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 5561324.8205; train_edge_recon_loss: 1197927.6731; train_gene_expr_recon_loss: 86335037.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 93094290.0513; train_optim_loss: 93094290.0513; val_kl_reg_loss: 5385292.7000; val_edge_recon_loss: 1177535.8750; val_gene_expr_recon_loss: 83076752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 89639579.2000; val_optim_loss: 89639579.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9111; val_auprc_score: 0.9726; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 5369927.4615; train_edge_recon_loss: 1199673.7115; train_gene_expr_recon_loss: 79695678.3590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86265279.7949; train_optim_loss: 86265279.7949; val_kl_reg_loss: 5175785.5000; val_edge_recon_loss: 1187442.7000; val_gene_expr_recon_loss: 76060878.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82424107.2000; val_optim_loss: 82424107.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9133; val_auprc_score: 0.9730; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 1724160546.8205; train_edge_recon_loss: 1196116.1410; train_gene_expr_recon_loss: 157268318.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1882624911.7949; train_optim_loss: 1882624911.7949; val_kl_reg_loss: 42432140138250240.0000; val_edge_recon_loss: 1209683.7500; val_gene_expr_recon_loss: 269355673.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42432140138250240.0000; val_optim_loss: 42432140138250240.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8257; val_auprc_score: 0.9444; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 6711885540918449.0000; train_edge_recon_loss: 1170289.8814; train_gene_expr_recon_loss: 1587516537.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6711887097052464.0000; train_optim_loss: 6711887097052464.0000; val_kl_reg_loss: 18304733.6000; val_edge_recon_loss: 1204941.7500; val_gene_expr_recon_loss: 1257504256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1277013913.6000; val_optim_loss: 1277013913.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8200; val_auprc_score: 0.9432; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 17943597.6410; train_edge_recon_loss: 1197721.6827; train_gene_expr_recon_loss: 960725267.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 979866582.9744; train_optim_loss: 979866582.9744; val_kl_reg_loss: 16122313.2000; val_edge_recon_loss: 1202158.4750; val_gene_expr_recon_loss: 883570329.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 900894784.0000; val_optim_loss: 900894784.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8446; val_auprc_score: 0.9517; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 14635048.1795; train_edge_recon_loss: 1195516.8718; train_gene_expr_recon_loss: 880583845.7436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 896414411.4872; train_optim_loss: 896414411.4872; val_kl_reg_loss: 12707524.8000; val_edge_recon_loss: 1204716.9000; val_gene_expr_recon_loss: 879052083.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 892964326.4000; val_optim_loss: 892964326.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8364; val_auprc_score: 0.9484; val_best_acc_score: 0.8518; val_best_f1_score: 0.9199; train_kl_reg_loss: 12739921.7436; train_edge_recon_loss: 1190222.9808; train_gene_expr_recon_loss: 878475567.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 892405712.4103; train_optim_loss: 892405712.4103; val_kl_reg_loss: 12386650.6000; val_edge_recon_loss: 1199818.9750; val_gene_expr_recon_loss: 878854835.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 892441305.6000; val_optim_loss: 892441305.6000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8426; val_auprc_score: 0.9512; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 12425757.6410; train_edge_recon_loss: 1201323.3878; train_gene_expr_recon_loss: 878119809.6410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 891746888.2051; train_optim_loss: 891746888.2051; val_kl_reg_loss: 12075781.4000; val_edge_recon_loss: 1189189.2500; val_gene_expr_recon_loss: 878470617.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 891735590.4000; val_optim_loss: 891735590.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8460; val_auprc_score: 0.9518; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 12095942.2821; train_edge_recon_loss: 1194737.6186; train_gene_expr_recon_loss: 877946157.9487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 891236841.0256; train_optim_loss: 891236841.0256; val_kl_reg_loss: 11759010.8000; val_edge_recon_loss: 1205674.4500; val_gene_expr_recon_loss: 878324006.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 891288704.0000; val_optim_loss: 891288704.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8476; val_auprc_score: 0.9527; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 11762860.0000; train_edge_recon_loss: 1191578.7212; train_gene_expr_recon_loss: 877737171.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 890691608.6154; train_optim_loss: 890691608.6154; val_kl_reg_loss: 11416999.2000; val_edge_recon_loss: 1189085.4250; val_gene_expr_recon_loss: 877765504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 890371571.2000; val_optim_loss: 890371571.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 35 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9150
val AUPRC score: 0.9734
val best accuracy score: 0.8510
val best F1 score: 0.9195
val target rna MSE score: 30.1134
val source rna MSE score: 44.1221
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 0 hours, 10 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5741 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5741, n_cat_covariates_embed_input: 0, n_hidden: 1565, n_latent: 1555, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5741
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5741

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9375; val_auprc_score: 0.9830; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 23082834.3551; train_edge_recon_loss: 1164112.2007; train_gene_expr_recon_loss: 308552741.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 332799687.0769; train_optim_loss: 332799687.0769; val_kl_reg_loss: 2392634.8750; val_edge_recon_loss: 1188513.3958; val_gene_expr_recon_loss: 93537816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 97118964.0000; val_optim_loss: 97118964.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9305; val_auprc_score: 0.9810; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 2784226.4375; train_edge_recon_loss: 1197842.1442; train_gene_expr_recon_loss: 86227031.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 90209099.6923; train_optim_loss: 90209099.6923; val_kl_reg_loss: 2752822.8750; val_edge_recon_loss: 1183255.0833; val_gene_expr_recon_loss: 82698632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86634709.3333; val_optim_loss: 86634709.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9319; val_auprc_score: 0.9812; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 2633602.8125; train_edge_recon_loss: 1195779.1827; train_gene_expr_recon_loss: 78352035.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82181417.6923; train_optim_loss: 82181417.6923; val_kl_reg_loss: 2461703.9167; val_edge_recon_loss: 1204166.5417; val_gene_expr_recon_loss: 73012972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 76678842.6667; val_optim_loss: 76678842.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9335; val_auprc_score: 0.9825; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 2347460.8510; train_edge_recon_loss: 1192170.9591; train_gene_expr_recon_loss: 68370567.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71910199.0769; train_optim_loss: 71910199.0769; val_kl_reg_loss: 2189003.3333; val_edge_recon_loss: 1190284.8542; val_gene_expr_recon_loss: 65015044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68394332.0000; val_optim_loss: 68394332.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9341; val_auprc_score: 0.9826; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 14774644780.7909; train_edge_recon_loss: 1190582.0962; train_gene_expr_recon_loss: 118519827.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 14894355349.4615; train_optim_loss: 14894355349.4615; val_kl_reg_loss: 438773946.6667; val_edge_recon_loss: 1206726.9792; val_gene_expr_recon_loss: 103609982.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 543590656.0000; val_optim_loss: 543590656.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6906; val_auprc_score: 0.9053; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 21237608786135316.0000; train_edge_recon_loss: 1159317.3990; train_gene_expr_recon_loss: 1014460921.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 21237609733550048.0000; train_optim_loss: 21237609733550048.0000; val_kl_reg_loss: 165161466992437920.0000; val_edge_recon_loss: 1180539.3958; val_gene_expr_recon_loss: 270987026.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 165161466992437920.0000; val_optim_loss: 165161466992437920.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8372; val_auprc_score: 0.9478; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 483350699352216576.0000; train_edge_recon_loss: 1188569.6274; train_gene_expr_recon_loss: 314320378.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 483350699572644736.0000; train_optim_loss: 483350699572644736.0000; val_kl_reg_loss: 16789993.1667; val_edge_recon_loss: 1210658.2083; val_gene_expr_recon_loss: 97194236.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 115194886.6667; val_optim_loss: 115194886.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8542; val_auprc_score: 0.9548; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 14842225.3269; train_edge_recon_loss: 1193055.7380; train_gene_expr_recon_loss: 94108909.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 110144190.4615; train_optim_loss: 110144190.4615; val_kl_reg_loss: 12440866.8333; val_edge_recon_loss: 1189035.4583; val_gene_expr_recon_loss: 83843881.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 97473785.3333; val_optim_loss: 97473785.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8592; val_auprc_score: 0.9566; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 12345974.3846; train_edge_recon_loss: 1194927.7019; train_gene_expr_recon_loss: 83552577.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 97093479.5385; train_optim_loss: 97093479.5385; val_kl_reg_loss: 12050942.1667; val_edge_recon_loss: 1186218.2292; val_gene_expr_recon_loss: 83301882.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 96539042.6667; val_optim_loss: 96539042.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8583; val_auprc_score: 0.9556; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 11942642.6346; train_edge_recon_loss: 1194337.0673; train_gene_expr_recon_loss: 83035808.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 96172788.6154; train_optim_loss: 96172788.6154; val_kl_reg_loss: 11623140.6667; val_edge_recon_loss: 1206168.6250; val_gene_expr_recon_loss: 82984561.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 95813870.6667; val_optim_loss: 95813870.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8586; val_auprc_score: 0.9555; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 11542406.8269; train_edge_recon_loss: 1193020.3510; train_gene_expr_recon_loss: 83348630.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 96084057.3846; train_optim_loss: 96084057.3846; val_kl_reg_loss: 11240972.6667; val_edge_recon_loss: 1214130.5625; val_gene_expr_recon_loss: 82417374.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 94872478.6667; val_optim_loss: 94872478.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8629; val_auprc_score: 0.9569; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 11124313.2115; train_edge_recon_loss: 1194550.6635; train_gene_expr_recon_loss: 82085817.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 94404681.3846; train_optim_loss: 94404681.3846; val_kl_reg_loss: 10829377.3333; val_edge_recon_loss: 1215881.5417; val_gene_expr_recon_loss: 81925781.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 93971041.3333; val_optim_loss: 93971041.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 5 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9334
val AUPRC score: 0.9823
val best accuracy score: 0.8520
val best F1 score: 0.9201
val target rna MSE score: 26.7981
val source rna MSE score: 40.7390
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 7: 0 hours, 14 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5741 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5741, n_cat_covariates_embed_input: 0, n_hidden: 1565, n_latent: 1555, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5741
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1555, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 5741

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9386; val_auprc_score: 0.9842; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 54958454.1045; train_edge_recon_loss: 1158113.9195; train_gene_expr_recon_loss: 274265082.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 330381648.4615; train_optim_loss: 330381648.4615; val_kl_reg_loss: 1838383.6667; val_edge_recon_loss: 1200925.5417; val_gene_expr_recon_loss: 86549858.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 89589168.0000; val_optim_loss: 89589168.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9372; val_auprc_score: 0.9840; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 1857117.8245; train_edge_recon_loss: 1201524.3101; train_gene_expr_recon_loss: 82987893.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86046535.2308; train_optim_loss: 86046535.2308; val_kl_reg_loss: 1777369.6458; val_edge_recon_loss: 1192235.5417; val_gene_expr_recon_loss: 79228028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82197634.6667; val_optim_loss: 82197634.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9371; val_auprc_score: 0.9845; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 1721630.9327; train_edge_recon_loss: 1199231.0264; train_gene_expr_recon_loss: 74747695.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77668556.9231; train_optim_loss: 77668556.9231; val_kl_reg_loss: 1632317.2500; val_edge_recon_loss: 1197410.0208; val_gene_expr_recon_loss: 69925486.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72755213.3333; val_optim_loss: 72755213.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9361; val_auprc_score: 0.9849; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 1584480.0024; train_edge_recon_loss: 1192825.8726; train_gene_expr_recon_loss: 66571509.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69348815.2308; train_optim_loss: 69348815.2308; val_kl_reg_loss: 1503289.2917; val_edge_recon_loss: 1185968.9375; val_gene_expr_recon_loss: 63975362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66664620.0000; val_optim_loss: 66664620.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8822; val_auprc_score: 0.9641; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 36880474321909.4219; train_edge_recon_loss: 1167111.6466; train_gene_expr_recon_loss: 617716883.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36881093952276.3828; train_optim_loss: 36881093952276.3828; val_kl_reg_loss: 4636604.8333; val_edge_recon_loss: 1205111.3333; val_gene_expr_recon_loss: 84146757.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 89988474.6667; val_optim_loss: 89988474.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8951; val_auprc_score: 0.9688; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 538701202068.5577; train_edge_recon_loss: 1190387.4856; train_gene_expr_recon_loss: 161403860.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 538863832043.5385; train_optim_loss: 538863832043.5385; val_kl_reg_loss: 3540154.3750; val_edge_recon_loss: 1206653.6667; val_gene_expr_recon_loss: 70793378.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75540188.0000; val_optim_loss: 75540188.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9115; val_auprc_score: 0.9760; val_best_acc_score: 0.8540; val_best_f1_score: 0.9213; train_kl_reg_loss: 2887008.8221; train_edge_recon_loss: 1194887.1923; train_gene_expr_recon_loss: 69908410.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 73990306.1538; train_optim_loss: 73990306.1538; val_kl_reg_loss: 2287008.2917; val_edge_recon_loss: 1186826.2083; val_gene_expr_recon_loss: 68952425.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72426260.0000; val_optim_loss: 72426260.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8671; val_auprc_score: 0.9592; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 1417259961308736.2500; train_edge_recon_loss: 1186674.2284; train_gene_expr_recon_loss: 247972108.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1417260201494270.2500; train_optim_loss: 1417260201494270.2500; val_kl_reg_loss: 9497596.0000; val_edge_recon_loss: 1190114.4792; val_gene_expr_recon_loss: 71806506.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82494217.3333; val_optim_loss: 82494217.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8713; val_auprc_score: 0.9611; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 9370008.3654; train_edge_recon_loss: 1192431.8389; train_gene_expr_recon_loss: 70995904.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 81558344.9231; train_optim_loss: 81558344.9231; val_kl_reg_loss: 9024269.8333; val_edge_recon_loss: 1173181.5417; val_gene_expr_recon_loss: 70298061.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 80495512.0000; val_optim_loss: 80495512.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8751; val_auprc_score: 0.9626; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 8851694.4231; train_edge_recon_loss: 1198935.5216; train_gene_expr_recon_loss: 69983157.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 80033787.3846; train_optim_loss: 80033787.3846; val_kl_reg_loss: 8510871.1667; val_edge_recon_loss: 1171490.1458; val_gene_expr_recon_loss: 69623946.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 79306309.3333; val_optim_loss: 79306309.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8786; val_auprc_score: 0.9631; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 8356834.2019; train_edge_recon_loss: 1192636.4327; train_gene_expr_recon_loss: 69621666.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79171136.7692; train_optim_loss: 79171136.7692; val_kl_reg_loss: 8020856.9167; val_edge_recon_loss: 1195538.6042; val_gene_expr_recon_loss: 69470994.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 78687389.3333; val_optim_loss: 78687389.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8773; val_auprc_score: 0.9630; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 7866974.0962; train_edge_recon_loss: 1193821.6466; train_gene_expr_recon_loss: 69403749.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 78464545.2308; train_optim_loss: 78464545.2308; val_kl_reg_loss: 7538060.8333; val_edge_recon_loss: 1187272.8958; val_gene_expr_recon_loss: 69159026.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 77884361.3333; val_optim_loss: 77884361.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 42 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9364
val AUPRC score: 0.9851
val best accuracy score: 0.8544
val best F1 score: 0.9215
val target rna MSE score: 919.6456
val source rna MSE score: 40.7827
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 15 minutes and 2 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
