Run timestamp: 16082023_223436_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '2048', '2048', '2048', '2048', '2048', '2048', '2048', '2048', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9550; val_auprc_score: 0.9902; val_best_acc_score: 0.9127; val_best_f1_score: 0.9505; train_kl_reg_loss: 1165.9143; train_edge_recon_loss: 1005549.1761; train_gene_expr_recon_loss: 2317273.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3323988.9545; train_optim_loss: 3323988.9545; val_kl_reg_loss: 4361.6585; val_edge_recon_loss: 1208542.1667; val_gene_expr_recon_loss: 2271632.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3484536.1667; val_optim_loss: 3484536.1667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9031; val_auprc_score: 0.9783; val_best_acc_score: 0.8882; val_best_f1_score: 0.9379; train_kl_reg_loss: 7072.8028; train_edge_recon_loss: 1027217.0170; train_gene_expr_recon_loss: 2156298.0114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3190587.8523; train_optim_loss: 3190587.8523; val_kl_reg_loss: 8282.1576; val_edge_recon_loss: 1171594.5000; val_gene_expr_recon_loss: 2107308.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3287185.3333; val_optim_loss: 3287185.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8602; val_auprc_score: 0.9685; val_best_acc_score: 0.8846; val_best_f1_score: 0.9359; train_kl_reg_loss: 8597.4615; train_edge_recon_loss: 1007985.5312; train_gene_expr_recon_loss: 2042504.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3059087.8523; train_optim_loss: 3059087.8523; val_kl_reg_loss: 9211.2285; val_edge_recon_loss: 1052341.0208; val_gene_expr_recon_loss: 2045796.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3107348.5000; val_optim_loss: 3107348.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8277; val_auprc_score: 0.9614; val_best_acc_score: 0.8869; val_best_f1_score: 0.9374; train_kl_reg_loss: 10192.4946; train_edge_recon_loss: 990643.4318; train_gene_expr_recon_loss: 1952685.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2953521.3750; train_optim_loss: 2953521.3750; val_kl_reg_loss: 11072.1527; val_edge_recon_loss: 988654.8958; val_gene_expr_recon_loss: 1955306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2955033.0000; val_optim_loss: 2955033.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8415; val_auprc_score: 0.9645; val_best_acc_score: 0.8904; val_best_f1_score: 0.9390; train_kl_reg_loss: 12578.0216; train_edge_recon_loss: 949065.1335; train_gene_expr_recon_loss: 1897414.6705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2859057.8182; train_optim_loss: 2859057.8182; val_kl_reg_loss: 12211.4365; val_edge_recon_loss: 967306.2292; val_gene_expr_recon_loss: 1928052.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2907570.0833; val_optim_loss: 2907570.0833
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8629; val_auprc_score: 0.9677; val_best_acc_score: 0.8930; val_best_f1_score: 0.9400; train_kl_reg_loss: 12090.6080; train_edge_recon_loss: 928960.1534; train_gene_expr_recon_loss: 1864171.4432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2805222.2045; train_optim_loss: 2805222.2045; val_kl_reg_loss: 11698.4274; val_edge_recon_loss: 961177.5417; val_gene_expr_recon_loss: 1878535.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2851410.9167; val_optim_loss: 2851410.9167
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8676; val_auprc_score: 0.9686; val_best_acc_score: 0.9017; val_best_f1_score: 0.9450; train_kl_reg_loss: 11598.2662; train_edge_recon_loss: 869092.1108; train_gene_expr_recon_loss: 1839884.6080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2720575.0114; train_optim_loss: 2720575.0114; val_kl_reg_loss: 12107.0775; val_edge_recon_loss: 905016.2917; val_gene_expr_recon_loss: 1868853.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2785977.0000; val_optim_loss: 2785977.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8878; val_auprc_score: 0.9740; val_best_acc_score: 0.9094; val_best_f1_score: 0.9493; train_kl_reg_loss: 12794.9252; train_edge_recon_loss: 884271.9290; train_gene_expr_recon_loss: 1821771.2386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2718838.1023; train_optim_loss: 2718838.1023; val_kl_reg_loss: 14206.9824; val_edge_recon_loss: 833688.4792; val_gene_expr_recon_loss: 1858215.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2706111.0833; val_optim_loss: 2706111.0833
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8987; val_auprc_score: 0.9731; val_best_acc_score: 0.9149; val_best_f1_score: 0.9520; train_kl_reg_loss: 14454.2916; train_edge_recon_loss: 837475.4489; train_gene_expr_recon_loss: 1800544.5284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2652474.2841; train_optim_loss: 2652474.2841; val_kl_reg_loss: 14502.4570; val_edge_recon_loss: 885095.9792; val_gene_expr_recon_loss: 1845506.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2745104.5000; val_optim_loss: 2745104.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9179; val_auprc_score: 0.9830; val_best_acc_score: 0.9316; val_best_f1_score: 0.9615; train_kl_reg_loss: 13920.9017; train_edge_recon_loss: 851692.2614; train_gene_expr_recon_loss: 1785482.1989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2651095.3636; train_optim_loss: 2651095.3636; val_kl_reg_loss: 13701.7031; val_edge_recon_loss: 769124.3542; val_gene_expr_recon_loss: 1821260.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2604086.9167; val_optim_loss: 2604086.9167
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9183; val_auprc_score: 0.9787; val_best_acc_score: 0.9332; val_best_f1_score: 0.9615; train_kl_reg_loss: 14635.2903; train_edge_recon_loss: 836508.9830; train_gene_expr_recon_loss: 1770596.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2621740.7727; train_optim_loss: 2621740.7727; val_kl_reg_loss: 14676.4300; val_edge_recon_loss: 836674.8958; val_gene_expr_recon_loss: 1800790.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2652142.1667; val_optim_loss: 2652142.1667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9345; val_auprc_score: 0.9836; val_best_acc_score: 0.9403; val_best_f1_score: 0.9657; train_kl_reg_loss: 14680.7263; train_edge_recon_loss: 828672.0341; train_gene_expr_recon_loss: 1755539.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2598892.6477; train_optim_loss: 2598892.6477; val_kl_reg_loss: 14931.3753; val_edge_recon_loss: 820382.4167; val_gene_expr_recon_loss: 1779822.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2615136.0833; val_optim_loss: 2615136.0833
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9262; val_auprc_score: 0.9775; val_best_acc_score: 0.9433; val_best_f1_score: 0.9675; train_kl_reg_loss: 15025.2577; train_edge_recon_loss: 807689.3324; train_gene_expr_recon_loss: 1743896.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2566611.4432; train_optim_loss: 2566611.4432; val_kl_reg_loss: 14986.6882; val_edge_recon_loss: 819589.6875; val_gene_expr_recon_loss: 1773831.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2608408.3333; val_optim_loss: 2608408.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9329; val_auprc_score: 0.9812; val_best_acc_score: 0.9447; val_best_f1_score: 0.9680; train_kl_reg_loss: 15032.7650; train_edge_recon_loss: 803084.9886; train_gene_expr_recon_loss: 1733976.1193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2552093.8636; train_optim_loss: 2552093.8636; val_kl_reg_loss: 14874.5306; val_edge_recon_loss: 834512.9167; val_gene_expr_recon_loss: 1758097.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2607485.1667; val_optim_loss: 2607485.1667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9321; val_auprc_score: 0.9791; val_best_acc_score: 0.9455; val_best_f1_score: 0.9684; train_kl_reg_loss: 15018.6883; train_edge_recon_loss: 798301.1023; train_gene_expr_recon_loss: 1726895.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2540214.8409; train_optim_loss: 2540214.8409; val_kl_reg_loss: 14892.8311; val_edge_recon_loss: 827005.1667; val_gene_expr_recon_loss: 1748391.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2590289.5833; val_optim_loss: 2590289.5833
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9381; val_auprc_score: 0.9813; val_best_acc_score: 0.9459; val_best_f1_score: 0.9689; train_kl_reg_loss: 14965.2154; train_edge_recon_loss: 797387.3153; train_gene_expr_recon_loss: 1728016.9148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2540369.4318; train_optim_loss: 2540369.4318; val_kl_reg_loss: 14760.1943; val_edge_recon_loss: 829999.8958; val_gene_expr_recon_loss: 1758215.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2602976.0000; val_optim_loss: 2602976.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9357; val_auprc_score: 0.9825; val_best_acc_score: 0.9461; val_best_f1_score: 0.9691; train_kl_reg_loss: 14861.8994; train_edge_recon_loss: 812033.7955; train_gene_expr_recon_loss: 1724695.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2551590.7955; train_optim_loss: 2551590.7955; val_kl_reg_loss: 14683.6032; val_edge_recon_loss: 776286.0417; val_gene_expr_recon_loss: 1769451.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2560421.0000; val_optim_loss: 2560421.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9321; val_auprc_score: 0.9799; val_best_acc_score: 0.9450; val_best_f1_score: 0.9683; train_kl_reg_loss: 14875.8122; train_edge_recon_loss: 812428.6790; train_gene_expr_recon_loss: 1723212.7898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2550517.2841; train_optim_loss: 2550517.2841; val_kl_reg_loss: 14694.7477; val_edge_recon_loss: 854947.9167; val_gene_expr_recon_loss: 1769357.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2638999.8333; val_optim_loss: 2638999.8333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9355; val_auprc_score: 0.9828; val_best_acc_score: 0.9488; val_best_f1_score: 0.9706; train_kl_reg_loss: 14926.2960; train_edge_recon_loss: 815877.6278; train_gene_expr_recon_loss: 1722003.5511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2552807.4886; train_optim_loss: 2552807.4886; val_kl_reg_loss: 14828.9469; val_edge_recon_loss: 811409.8125; val_gene_expr_recon_loss: 1767882.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2594121.0000; val_optim_loss: 2594121.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9427; val_auprc_score: 0.9853; val_best_acc_score: 0.9490; val_best_f1_score: 0.9709; train_kl_reg_loss: 14921.1766; train_edge_recon_loss: 798360.3182; train_gene_expr_recon_loss: 1722224.0739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2535505.5795; train_optim_loss: 2535505.5795; val_kl_reg_loss: 14806.9655; val_edge_recon_loss: 808312.7708; val_gene_expr_recon_loss: 1750367.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2573486.9167; val_optim_loss: 2573486.9167
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9435; val_auprc_score: 0.9849; val_best_acc_score: 0.9520; val_best_f1_score: 0.9725; train_kl_reg_loss: 14943.0416; train_edge_recon_loss: 808905.7244; train_gene_expr_recon_loss: 1718105.7386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2541954.5000; train_optim_loss: 2541954.5000; val_kl_reg_loss: 14762.3743; val_edge_recon_loss: 767692.8958; val_gene_expr_recon_loss: 1761296.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2543751.3333; val_optim_loss: 2543751.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9419; val_auprc_score: 0.9807; val_best_acc_score: 0.9469; val_best_f1_score: 0.9694; train_kl_reg_loss: 14891.6887; train_edge_recon_loss: 810769.4858; train_gene_expr_recon_loss: 1720555.4943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546216.7045; train_optim_loss: 2546216.7045; val_kl_reg_loss: 14640.3314; val_edge_recon_loss: 834846.1042; val_gene_expr_recon_loss: 1735309.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2584795.5000; val_optim_loss: 2584795.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9506; val_auprc_score: 0.9885; val_best_acc_score: 0.9525; val_best_f1_score: 0.9728; train_kl_reg_loss: 14908.0740; train_edge_recon_loss: 789009.0938; train_gene_expr_recon_loss: 1719022.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2522939.8409; train_optim_loss: 2522939.8409; val_kl_reg_loss: 14789.9896; val_edge_recon_loss: 796432.0417; val_gene_expr_recon_loss: 1771614.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2582836.1667; val_optim_loss: 2582836.1667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9399; val_auprc_score: 0.9828; val_best_acc_score: 0.9482; val_best_f1_score: 0.9701; train_kl_reg_loss: 14970.5709; train_edge_recon_loss: 798851.6364; train_gene_expr_recon_loss: 1719360.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2533182.8295; train_optim_loss: 2533182.8295; val_kl_reg_loss: 14810.6305; val_edge_recon_loss: 835961.4167; val_gene_expr_recon_loss: 1756619.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2607391.5833; val_optim_loss: 2607391.5833
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9479; val_auprc_score: 0.9857; val_best_acc_score: 0.9494; val_best_f1_score: 0.9707; train_kl_reg_loss: 15005.7193; train_edge_recon_loss: 808756.3438; train_gene_expr_recon_loss: 1716643.4034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2540405.4659; train_optim_loss: 2540405.4659; val_kl_reg_loss: 14683.5479; val_edge_recon_loss: 816957.8125; val_gene_expr_recon_loss: 1741510.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2573152.0833; val_optim_loss: 2573152.0833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9374; val_auprc_score: 0.9825; val_best_acc_score: 0.9478; val_best_f1_score: 0.9700; train_kl_reg_loss: 14938.0191; train_edge_recon_loss: 794878.5057; train_gene_expr_recon_loss: 1716821.4716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2526638.0000; train_optim_loss: 2526638.0000; val_kl_reg_loss: 14756.4622; val_edge_recon_loss: 790557.9167; val_gene_expr_recon_loss: 1756528.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2561843.3333; val_optim_loss: 2561843.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9401; val_auprc_score: 0.9833; val_best_acc_score: 0.9487; val_best_f1_score: 0.9705; train_kl_reg_loss: 14925.4401; train_edge_recon_loss: 808365.9744; train_gene_expr_recon_loss: 1718425.3295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2541716.7159; train_optim_loss: 2541716.7159; val_kl_reg_loss: 14849.5049; val_edge_recon_loss: 823036.4375; val_gene_expr_recon_loss: 1777645.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2615531.5833; val_optim_loss: 2615531.5833
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9411; val_auprc_score: 0.9853; val_best_acc_score: 0.9521; val_best_f1_score: 0.9725; train_kl_reg_loss: 14948.1784; train_edge_recon_loss: 812647.8381; train_gene_expr_recon_loss: 1716024.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2543620.1023; train_optim_loss: 2543620.1023; val_kl_reg_loss: 14844.9020; val_edge_recon_loss: 801443.2500; val_gene_expr_recon_loss: 1769126.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2585414.9167; val_optim_loss: 2585414.9167
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9447; val_auprc_score: 0.9842; val_best_acc_score: 0.9525; val_best_f1_score: 0.9726; train_kl_reg_loss: 14907.1177; train_edge_recon_loss: 817519.7301; train_gene_expr_recon_loss: 1715345.6705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2547772.5227; train_optim_loss: 2547772.5227; val_kl_reg_loss: 14845.2939; val_edge_recon_loss: 803545.4375; val_gene_expr_recon_loss: 1771815.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2590206.4167; val_optim_loss: 2590206.4167

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 39 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9381
val AUPRC score: 0.9842
val best accuracy score: 0.9477
val best F1 score: 0.9702
val target rna MSE score: 1.1875
val source rna MSE score: 0.3745
Val cat covariate0 mean sim diff: -0.0054
Duration of model training in run 8: 0 hours, 1 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9474; val_auprc_score: 0.9858; val_best_acc_score: 0.9109; val_best_f1_score: 0.9501; train_kl_reg_loss: 1289.1839; train_edge_recon_loss: 1022867.0057; train_gene_expr_recon_loss: 2311516.6023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3335672.7614; train_optim_loss: 3335672.7614; val_kl_reg_loss: 4454.8128; val_edge_recon_loss: 1168681.3750; val_gene_expr_recon_loss: 2253617.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3426753.5833; val_optim_loss: 3426753.5833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9185; val_auprc_score: 0.9809; val_best_acc_score: 0.8980; val_best_f1_score: 0.9406; train_kl_reg_loss: 7594.2574; train_edge_recon_loss: 1047434.5881; train_gene_expr_recon_loss: 2154792.0682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3209820.9205; train_optim_loss: 3209820.9205; val_kl_reg_loss: 8524.1283; val_edge_recon_loss: 1220372.0417; val_gene_expr_recon_loss: 2098517.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3327413.5833; val_optim_loss: 3327413.5833
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8845; val_auprc_score: 0.9739; val_best_acc_score: 0.8825; val_best_f1_score: 0.9339; train_kl_reg_loss: 9086.3696; train_edge_recon_loss: 1019738.3665; train_gene_expr_recon_loss: 2039231.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3068056.1023; train_optim_loss: 3068056.1023; val_kl_reg_loss: 8848.6035; val_edge_recon_loss: 1122861.9583; val_gene_expr_recon_loss: 1997805.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3129516.0000; val_optim_loss: 3129516.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8429; val_auprc_score: 0.9655; val_best_acc_score: 0.8873; val_best_f1_score: 0.9373; train_kl_reg_loss: 10201.1313; train_edge_recon_loss: 984559.8466; train_gene_expr_recon_loss: 1950337.3580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2945098.3295; train_optim_loss: 2945098.3295; val_kl_reg_loss: 12212.4723; val_edge_recon_loss: 994842.3125; val_gene_expr_recon_loss: 1936881.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2943936.7500; val_optim_loss: 2943936.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8593; val_auprc_score: 0.9684; val_best_acc_score: 0.8899; val_best_f1_score: 0.9387; train_kl_reg_loss: 12526.3484; train_edge_recon_loss: 955527.8864; train_gene_expr_recon_loss: 1898040.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2866094.2841; train_optim_loss: 2866094.2841; val_kl_reg_loss: 12974.8682; val_edge_recon_loss: 968460.4792; val_gene_expr_recon_loss: 1889022.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2870458.3333; val_optim_loss: 2870458.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8692; val_auprc_score: 0.9698; val_best_acc_score: 0.9022; val_best_f1_score: 0.9456; train_kl_reg_loss: 12288.9766; train_edge_recon_loss: 934071.3835; train_gene_expr_recon_loss: 1865072.2216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2811432.5909; train_optim_loss: 2811432.5909; val_kl_reg_loss: 11097.2796; val_edge_recon_loss: 917663.5417; val_gene_expr_recon_loss: 1845017.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2773778.1667; val_optim_loss: 2773778.1667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8949; val_auprc_score: 0.9739; val_best_acc_score: 0.9118; val_best_f1_score: 0.9500; train_kl_reg_loss: 11320.0205; train_edge_recon_loss: 894667.8636; train_gene_expr_recon_loss: 1841405.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2747393.3750; train_optim_loss: 2747393.3750; val_kl_reg_loss: 12162.8913; val_edge_recon_loss: 863652.7917; val_gene_expr_recon_loss: 1843462.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2719278.0000; val_optim_loss: 2719278.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8985; val_auprc_score: 0.9751; val_best_acc_score: 0.9160; val_best_f1_score: 0.9528; train_kl_reg_loss: 13718.5868; train_edge_recon_loss: 880696.5057; train_gene_expr_recon_loss: 1820993.6534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2715408.7159; train_optim_loss: 2715408.7159; val_kl_reg_loss: 13566.9587; val_edge_recon_loss: 826183.5625; val_gene_expr_recon_loss: 1832289.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2672040.0000; val_optim_loss: 2672040.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8959; val_auprc_score: 0.9714; val_best_acc_score: 0.9190; val_best_f1_score: 0.9540; train_kl_reg_loss: 14820.3307; train_edge_recon_loss: 862635.4233; train_gene_expr_recon_loss: 1801678.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2679134.0114; train_optim_loss: 2679134.0114; val_kl_reg_loss: 14781.6165; val_edge_recon_loss: 877796.4375; val_gene_expr_recon_loss: 1787673.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2680251.3333; val_optim_loss: 2680251.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9198; val_auprc_score: 0.9769; val_best_acc_score: 0.9302; val_best_f1_score: 0.9600; train_kl_reg_loss: 14684.1688; train_edge_recon_loss: 849676.6676; train_gene_expr_recon_loss: 1780924.6648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2645285.4773; train_optim_loss: 2645285.4773; val_kl_reg_loss: 13953.2959; val_edge_recon_loss: 829151.4583; val_gene_expr_recon_loss: 1784171.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2627275.7500; val_optim_loss: 2627275.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9278; val_auprc_score: 0.9789; val_best_acc_score: 0.9335; val_best_f1_score: 0.9617; train_kl_reg_loss: 15127.0441; train_edge_recon_loss: 829800.1989; train_gene_expr_recon_loss: 1769518.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2614445.7727; train_optim_loss: 2614445.7727; val_kl_reg_loss: 14906.7168; val_edge_recon_loss: 847736.0625; val_gene_expr_recon_loss: 1775769.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2638412.4167; val_optim_loss: 2638412.4167
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9359; val_auprc_score: 0.9840; val_best_acc_score: 0.9397; val_best_f1_score: 0.9651; train_kl_reg_loss: 15323.5672; train_edge_recon_loss: 820270.0568; train_gene_expr_recon_loss: 1757369.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2592963.3977; train_optim_loss: 2592963.3977; val_kl_reg_loss: 15110.3984; val_edge_recon_loss: 846916.3333; val_gene_expr_recon_loss: 1762797.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2624824.1667; val_optim_loss: 2624824.1667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9380; val_auprc_score: 0.9842; val_best_acc_score: 0.9445; val_best_f1_score: 0.9682; train_kl_reg_loss: 15629.8891; train_edge_recon_loss: 812446.0568; train_gene_expr_recon_loss: 1742824.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2570900.4545; train_optim_loss: 2570900.4545; val_kl_reg_loss: 15435.7728; val_edge_recon_loss: 772382.2292; val_gene_expr_recon_loss: 1763485.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2551303.0833; val_optim_loss: 2551303.0833
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9451; val_auprc_score: 0.9869; val_best_acc_score: 0.9489; val_best_f1_score: 0.9703; train_kl_reg_loss: 15611.4197; train_edge_recon_loss: 794547.0795; train_gene_expr_recon_loss: 1731924.2557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2542082.7386; train_optim_loss: 2542082.7386; val_kl_reg_loss: 15697.7464; val_edge_recon_loss: 837007.5000; val_gene_expr_recon_loss: 1736110.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2588815.8333; val_optim_loss: 2588815.8333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9423; val_auprc_score: 0.9840; val_best_acc_score: 0.9497; val_best_f1_score: 0.9711; train_kl_reg_loss: 16050.6039; train_edge_recon_loss: 811876.6989; train_gene_expr_recon_loss: 1724141.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2552068.7955; train_optim_loss: 2552068.7955; val_kl_reg_loss: 15900.8402; val_edge_recon_loss: 837635.3958; val_gene_expr_recon_loss: 1728690.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2582227.0833; val_optim_loss: 2582227.0833
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9483; val_auprc_score: 0.9831; val_best_acc_score: 0.9538; val_best_f1_score: 0.9736; train_kl_reg_loss: 16256.4918; train_edge_recon_loss: 802467.8693; train_gene_expr_recon_loss: 1713950.1648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2532674.5341; train_optim_loss: 2532674.5341; val_kl_reg_loss: 15939.2113; val_edge_recon_loss: 788953.8542; val_gene_expr_recon_loss: 1726535.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2531428.9167; val_optim_loss: 2531428.9167
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9524; val_auprc_score: 0.9897; val_best_acc_score: 0.9499; val_best_f1_score: 0.9713; train_kl_reg_loss: 15949.2757; train_edge_recon_loss: 818066.7983; train_gene_expr_recon_loss: 1705325.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2539341.9545; train_optim_loss: 2539341.9545; val_kl_reg_loss: 15600.4147; val_edge_recon_loss: 799681.5208; val_gene_expr_recon_loss: 1716352.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2531634.1667; val_optim_loss: 2531634.1667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9509; val_auprc_score: 0.9849; val_best_acc_score: 0.9540; val_best_f1_score: 0.9736; train_kl_reg_loss: 16024.7535; train_edge_recon_loss: 806093.0653; train_gene_expr_recon_loss: 1696870.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2518988.0682; train_optim_loss: 2518988.0682; val_kl_reg_loss: 16012.7969; val_edge_recon_loss: 805251.7083; val_gene_expr_recon_loss: 1741499.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2562764.3333; val_optim_loss: 2562764.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9423; val_auprc_score: 0.9813; val_best_acc_score: 0.9508; val_best_f1_score: 0.9716; train_kl_reg_loss: 16021.8174; train_edge_recon_loss: 824420.6705; train_gene_expr_recon_loss: 1691213.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531655.9545; train_optim_loss: 2531655.9545; val_kl_reg_loss: 15587.0010; val_edge_recon_loss: 830575.3958; val_gene_expr_recon_loss: 1712265.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2558427.8333; val_optim_loss: 2558427.8333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9567; val_auprc_score: 0.9863; val_best_acc_score: 0.9541; val_best_f1_score: 0.9736; train_kl_reg_loss: 15888.0868; train_edge_recon_loss: 806617.9943; train_gene_expr_recon_loss: 1681129.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2503635.1023; train_optim_loss: 2503635.1023; val_kl_reg_loss: 15584.4980; val_edge_recon_loss: 808157.9583; val_gene_expr_recon_loss: 1702019.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2525762.3333; val_optim_loss: 2525762.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9474; val_auprc_score: 0.9877; val_best_acc_score: 0.9524; val_best_f1_score: 0.9726; train_kl_reg_loss: 15811.5004; train_edge_recon_loss: 800027.0824; train_gene_expr_recon_loss: 1675172.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2491010.9545; train_optim_loss: 2491010.9545; val_kl_reg_loss: 15432.8545; val_edge_recon_loss: 804097.5000; val_gene_expr_recon_loss: 1698607.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2518137.8333; val_optim_loss: 2518137.8333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9596; val_auprc_score: 0.9875; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 15252.8982; train_edge_recon_loss: 789106.9972; train_gene_expr_recon_loss: 1669504.4830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2473864.3864; train_optim_loss: 2473864.3864; val_kl_reg_loss: 14764.1725; val_edge_recon_loss: 817248.3750; val_gene_expr_recon_loss: 1689640.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2521652.9167; val_optim_loss: 2521652.9167
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9567; val_auprc_score: 0.9893; val_best_acc_score: 0.9586; val_best_f1_score: 0.9762; train_kl_reg_loss: 14894.2415; train_edge_recon_loss: 782841.1477; train_gene_expr_recon_loss: 1664553.9830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2462289.3750; train_optim_loss: 2462289.3750; val_kl_reg_loss: 14993.2243; val_edge_recon_loss: 790885.6667; val_gene_expr_recon_loss: 1684661.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2490540.1667; val_optim_loss: 2490540.1667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9468; val_auprc_score: 0.9856; val_best_acc_score: 0.9496; val_best_f1_score: 0.9709; train_kl_reg_loss: 15151.6032; train_edge_recon_loss: 774451.5994; train_gene_expr_recon_loss: 1656052.5284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2445655.7273; train_optim_loss: 2445655.7273; val_kl_reg_loss: 14772.5449; val_edge_recon_loss: 825066.4792; val_gene_expr_recon_loss: 1673050.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2512889.7500; val_optim_loss: 2512889.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9616; val_auprc_score: 0.9887; val_best_acc_score: 0.9623; val_best_f1_score: 0.9782; train_kl_reg_loss: 14714.3204; train_edge_recon_loss: 790932.3977; train_gene_expr_recon_loss: 1653403.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2459050.4318; train_optim_loss: 2459050.4318; val_kl_reg_loss: 14256.6517; val_edge_recon_loss: 789247.0417; val_gene_expr_recon_loss: 1668796.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2472300.0833; val_optim_loss: 2472300.0833
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9629; val_auprc_score: 0.9906; val_best_acc_score: 0.9590; val_best_f1_score: 0.9763; train_kl_reg_loss: 14484.4082; train_edge_recon_loss: 802649.9233; train_gene_expr_recon_loss: 1646621.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2463755.5909; train_optim_loss: 2463755.5909; val_kl_reg_loss: 14490.8079; val_edge_recon_loss: 808802.6667; val_gene_expr_recon_loss: 1665971.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2489264.9167; val_optim_loss: 2489264.9167
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9562; val_auprc_score: 0.9871; val_best_acc_score: 0.9538; val_best_f1_score: 0.9734; train_kl_reg_loss: 14525.3639; train_edge_recon_loss: 803697.1165; train_gene_expr_recon_loss: 1643062.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2461284.8523; train_optim_loss: 2461284.8523; val_kl_reg_loss: 14377.8034; val_edge_recon_loss: 818738.1042; val_gene_expr_recon_loss: 1655167.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2488283.1667; val_optim_loss: 2488283.1667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9600; val_auprc_score: 0.9880; val_best_acc_score: 0.9623; val_best_f1_score: 0.9783; train_kl_reg_loss: 14435.9683; train_edge_recon_loss: 788624.0795; train_gene_expr_recon_loss: 1637553.1080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2440613.1477; train_optim_loss: 2440613.1477; val_kl_reg_loss: 13999.1576; val_edge_recon_loss: 766571.4792; val_gene_expr_recon_loss: 1633782.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2414352.9167; val_optim_loss: 2414352.9167
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9654; val_auprc_score: 0.9909; val_best_acc_score: 0.9636; val_best_f1_score: 0.9791; train_kl_reg_loss: 14082.5917; train_edge_recon_loss: 791040.3267; train_gene_expr_recon_loss: 1631011.4943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2436134.4432; train_optim_loss: 2436134.4432; val_kl_reg_loss: 14062.5690; val_edge_recon_loss: 790538.2917; val_gene_expr_recon_loss: 1656808.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2461409.5000; val_optim_loss: 2461409.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9654; val_auprc_score: 0.9915; val_best_acc_score: 0.9628; val_best_f1_score: 0.9785; train_kl_reg_loss: 14071.2159; train_edge_recon_loss: 799956.7301; train_gene_expr_recon_loss: 1629314.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2443342.4091; train_optim_loss: 2443342.4091; val_kl_reg_loss: 13697.6068; val_edge_recon_loss: 770159.2917; val_gene_expr_recon_loss: 1633800.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2417657.4167; val_optim_loss: 2417657.4167
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9590; val_auprc_score: 0.9868; val_best_acc_score: 0.9622; val_best_f1_score: 0.9782; train_kl_reg_loss: 13752.7742; train_edge_recon_loss: 792537.1165; train_gene_expr_recon_loss: 1624898.0966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2431187.9659; train_optim_loss: 2431187.9659; val_kl_reg_loss: 13908.5068; val_edge_recon_loss: 798967.5417; val_gene_expr_recon_loss: 1652230.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2465106.2500; val_optim_loss: 2465106.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9676; val_auprc_score: 0.9924; val_best_acc_score: 0.9638; val_best_f1_score: 0.9792; train_kl_reg_loss: 14118.9575; train_edge_recon_loss: 798071.7358; train_gene_expr_recon_loss: 1618744.7670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2430935.4659; train_optim_loss: 2430935.4659; val_kl_reg_loss: 13908.5869; val_edge_recon_loss: 766578.7292; val_gene_expr_recon_loss: 1639930.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2420417.4167; val_optim_loss: 2420417.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9620; val_auprc_score: 0.9903; val_best_acc_score: 0.9614; val_best_f1_score: 0.9778; train_kl_reg_loss: 13955.1057; train_edge_recon_loss: 778456.5455; train_gene_expr_recon_loss: 1613804.0227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2406215.6705; train_optim_loss: 2406215.6705; val_kl_reg_loss: 13848.9388; val_edge_recon_loss: 765459.8125; val_gene_expr_recon_loss: 1647148.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2426457.0000; val_optim_loss: 2426457.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9589; val_auprc_score: 0.9867; val_best_acc_score: 0.9626; val_best_f1_score: 0.9785; train_kl_reg_loss: 13911.6552; train_edge_recon_loss: 788680.1989; train_gene_expr_recon_loss: 1614187.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2416779.4432; train_optim_loss: 2416779.4432; val_kl_reg_loss: 13844.5524; val_edge_recon_loss: 790067.6667; val_gene_expr_recon_loss: 1628233.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2432145.8333; val_optim_loss: 2432145.8333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9702; val_auprc_score: 0.9917; val_best_acc_score: 0.9655; val_best_f1_score: 0.9800; train_kl_reg_loss: 13950.1267; train_edge_recon_loss: 781398.6250; train_gene_expr_recon_loss: 1611252.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2406601.3864; train_optim_loss: 2406601.3864; val_kl_reg_loss: 13790.7174; val_edge_recon_loss: 779612.6250; val_gene_expr_recon_loss: 1625353.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2418757.0000; val_optim_loss: 2418757.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9590; val_auprc_score: 0.9900; val_best_acc_score: 0.9580; val_best_f1_score: 0.9757; train_kl_reg_loss: 13998.8805; train_edge_recon_loss: 783486.8807; train_gene_expr_recon_loss: 1614942.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2412428.6023; train_optim_loss: 2412428.6023; val_kl_reg_loss: 13873.3158; val_edge_recon_loss: 833351.2083; val_gene_expr_recon_loss: 1641316.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2488541.4167; val_optim_loss: 2488541.4167

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 8 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9572
val AUPRC score: 0.9868
val best accuracy score: 0.9599
val best F1 score: 0.9767
val target rna MSE score: 1.1185
val source rna MSE score: 0.1982
Val cat covariate0 mean sim diff: -0.0047
Duration of model training in run 7: 0 hours, 2 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9602; val_auprc_score: 0.9879; val_best_acc_score: 0.9343; val_best_f1_score: 0.9625; train_kl_reg_loss: 625.6456; train_edge_recon_loss: 1008462.7500; train_gene_expr_recon_loss: 2317393.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3326481.9844; train_optim_loss: 3326481.9844; val_kl_reg_loss: 1595.7439; val_edge_recon_loss: 1192703.8125; val_gene_expr_recon_loss: 2266888.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3461188.2500; val_optim_loss: 3461188.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9362; val_auprc_score: 0.9825; val_best_acc_score: 0.9163; val_best_f1_score: 0.9526; train_kl_reg_loss: 4366.3634; train_edge_recon_loss: 1035298.8477; train_gene_expr_recon_loss: 2195305.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234970.5625; train_optim_loss: 3234970.5625; val_kl_reg_loss: 6914.7251; val_edge_recon_loss: 1181716.7500; val_gene_expr_recon_loss: 2142519.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3331150.3750; val_optim_loss: 3331150.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9208; val_auprc_score: 0.9832; val_best_acc_score: 0.8995; val_best_f1_score: 0.9446; train_kl_reg_loss: 8497.0940; train_edge_recon_loss: 1044360.1133; train_gene_expr_recon_loss: 2101498.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3154355.9219; train_optim_loss: 3154355.9219; val_kl_reg_loss: 9485.6108; val_edge_recon_loss: 1091762.1250; val_gene_expr_recon_loss: 2069142.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3170390.5000; val_optim_loss: 3170390.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8803; val_auprc_score: 0.9723; val_best_acc_score: 0.8923; val_best_f1_score: 0.9404; train_kl_reg_loss: 8637.0281; train_edge_recon_loss: 1017285.0000; train_gene_expr_recon_loss: 2023194.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3049116.1094; train_optim_loss: 3049116.1094; val_kl_reg_loss: 8568.2930; val_edge_recon_loss: 1043978.1875; val_gene_expr_recon_loss: 2010040.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3062587.2500; val_optim_loss: 3062587.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8469; val_auprc_score: 0.9628; val_best_acc_score: 0.8815; val_best_f1_score: 0.9335; train_kl_reg_loss: 9103.3810; train_edge_recon_loss: 996795.3750; train_gene_expr_recon_loss: 1961408.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2967307.3438; train_optim_loss: 2967307.3438; val_kl_reg_loss: 10848.7319; val_edge_recon_loss: 1095114.2500; val_gene_expr_recon_loss: 1949020.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3054983.0000; val_optim_loss: 3054983.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8464; val_auprc_score: 0.9670; val_best_acc_score: 0.8883; val_best_f1_score: 0.9379; train_kl_reg_loss: 11557.4470; train_edge_recon_loss: 964897.3320; train_gene_expr_recon_loss: 1912224.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2888679.5156; train_optim_loss: 2888679.5156; val_kl_reg_loss: 12022.4370; val_edge_recon_loss: 994664.4375; val_gene_expr_recon_loss: 1907949.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2914636.7500; val_optim_loss: 2914636.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8502; val_auprc_score: 0.9657; val_best_acc_score: 0.8956; val_best_f1_score: 0.9421; train_kl_reg_loss: 12921.5923; train_edge_recon_loss: 922422.5586; train_gene_expr_recon_loss: 1878144.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2813488.9531; train_optim_loss: 2813488.9531; val_kl_reg_loss: 14290.8184; val_edge_recon_loss: 910679.3125; val_gene_expr_recon_loss: 1884383.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2809353.6250; val_optim_loss: 2809353.6250
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8653; val_auprc_score: 0.9683; val_best_acc_score: 0.8976; val_best_f1_score: 0.9427; train_kl_reg_loss: 12806.7456; train_edge_recon_loss: 912098.1992; train_gene_expr_recon_loss: 1855688.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2780593.1875; train_optim_loss: 2780593.1875; val_kl_reg_loss: 11401.9307; val_edge_recon_loss: 927007.9062; val_gene_expr_recon_loss: 1865700.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804110.3750; val_optim_loss: 2804110.3750
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8729; val_auprc_score: 0.9683; val_best_acc_score: 0.8956; val_best_f1_score: 0.9405; train_kl_reg_loss: 11695.2401; train_edge_recon_loss: 901389.9531; train_gene_expr_recon_loss: 1840245.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2753330.8281; train_optim_loss: 2753330.8281; val_kl_reg_loss: 11391.2598; val_edge_recon_loss: 934338.2188; val_gene_expr_recon_loss: 1847940.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2793670.0000; val_optim_loss: 2793670.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8919; val_auprc_score: 0.9758; val_best_acc_score: 0.9033; val_best_f1_score: 0.9461; train_kl_reg_loss: 12425.8110; train_edge_recon_loss: 887313.4062; train_gene_expr_recon_loss: 1825150.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2724890.0781; train_optim_loss: 2724890.0781; val_kl_reg_loss: 12778.3545; val_edge_recon_loss: 878659.9375; val_gene_expr_recon_loss: 1824853.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2716291.7500; val_optim_loss: 2716291.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8883; val_auprc_score: 0.9721; val_best_acc_score: 0.9122; val_best_f1_score: 0.9506; train_kl_reg_loss: 13343.8518; train_edge_recon_loss: 851619.0977; train_gene_expr_recon_loss: 1810259.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2675222.2812; train_optim_loss: 2675222.2812; val_kl_reg_loss: 13422.5332; val_edge_recon_loss: 844110.9688; val_gene_expr_recon_loss: 1819873.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2677407.3750; val_optim_loss: 2677407.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9038; val_auprc_score: 0.9740; val_best_acc_score: 0.9216; val_best_f1_score: 0.9556; train_kl_reg_loss: 13640.8004; train_edge_recon_loss: 851486.3320; train_gene_expr_recon_loss: 1798210.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2663337.6250; train_optim_loss: 2663337.6250; val_kl_reg_loss: 14020.1113; val_edge_recon_loss: 819581.0938; val_gene_expr_recon_loss: 1806157.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2639758.6250; val_optim_loss: 2639758.6250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9140; val_auprc_score: 0.9774; val_best_acc_score: 0.9282; val_best_f1_score: 0.9594; train_kl_reg_loss: 14159.1945; train_edge_recon_loss: 829019.0820; train_gene_expr_recon_loss: 1788874.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2632052.6562; train_optim_loss: 2632052.6562; val_kl_reg_loss: 14254.7495; val_edge_recon_loss: 812054.7812; val_gene_expr_recon_loss: 1792742.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2619052.0000; val_optim_loss: 2619052.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9314; val_auprc_score: 0.9815; val_best_acc_score: 0.9350; val_best_f1_score: 0.9630; train_kl_reg_loss: 14719.1066; train_edge_recon_loss: 833695.7617; train_gene_expr_recon_loss: 1774601.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2623016.8281; train_optim_loss: 2623016.8281; val_kl_reg_loss: 15040.4229; val_edge_recon_loss: 814712.0625; val_gene_expr_recon_loss: 1793629.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2623382.5000; val_optim_loss: 2623382.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9285; val_auprc_score: 0.9810; val_best_acc_score: 0.9323; val_best_f1_score: 0.9610; train_kl_reg_loss: 15555.8034; train_edge_recon_loss: 806550.5078; train_gene_expr_recon_loss: 1763100.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2585206.3906; train_optim_loss: 2585206.3906; val_kl_reg_loss: 15826.9473; val_edge_recon_loss: 837867.0625; val_gene_expr_recon_loss: 1782369.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2636063.1250; val_optim_loss: 2636063.1250
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9351; val_auprc_score: 0.9814; val_best_acc_score: 0.9308; val_best_f1_score: 0.9602; train_kl_reg_loss: 16148.2587; train_edge_recon_loss: 810530.5039; train_gene_expr_recon_loss: 1754835.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2581514.0625; train_optim_loss: 2581514.0625; val_kl_reg_loss: 16067.3994; val_edge_recon_loss: 883412.1875; val_gene_expr_recon_loss: 1762628.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2662108.1250; val_optim_loss: 2662108.1250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9386; val_auprc_score: 0.9795; val_best_acc_score: 0.9411; val_best_f1_score: 0.9660; train_kl_reg_loss: 16190.4462; train_edge_recon_loss: 809013.5508; train_gene_expr_recon_loss: 1743936.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2569140.8594; train_optim_loss: 2569140.8594; val_kl_reg_loss: 16116.9727; val_edge_recon_loss: 840647.6562; val_gene_expr_recon_loss: 1759679.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2616443.6250; val_optim_loss: 2616443.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9503; val_auprc_score: 0.9871; val_best_acc_score: 0.9441; val_best_f1_score: 0.9678; train_kl_reg_loss: 16226.6211; train_edge_recon_loss: 812464.2930; train_gene_expr_recon_loss: 1734148.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2562838.9531; train_optim_loss: 2562838.9531; val_kl_reg_loss: 16076.3755; val_edge_recon_loss: 813320.0000; val_gene_expr_recon_loss: 1756466.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2585862.7500; val_optim_loss: 2585862.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9534; val_auprc_score: 0.9889; val_best_acc_score: 0.9482; val_best_f1_score: 0.9703; train_kl_reg_loss: 16506.7908; train_edge_recon_loss: 810848.2031; train_gene_expr_recon_loss: 1727495.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2554850.7344; train_optim_loss: 2554850.7344; val_kl_reg_loss: 16530.6895; val_edge_recon_loss: 775466.8125; val_gene_expr_recon_loss: 1742142.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2534139.7500; val_optim_loss: 2534139.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9535; val_auprc_score: 0.9878; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 16734.6364; train_edge_recon_loss: 800656.0117; train_gene_expr_recon_loss: 1718217.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2535607.9219; train_optim_loss: 2535607.9219; val_kl_reg_loss: 16613.8096; val_edge_recon_loss: 792693.7500; val_gene_expr_recon_loss: 1727811.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2537118.8750; val_optim_loss: 2537118.8750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9597; val_auprc_score: 0.9893; val_best_acc_score: 0.9545; val_best_f1_score: 0.9737; train_kl_reg_loss: 16614.0593; train_edge_recon_loss: 816877.2812; train_gene_expr_recon_loss: 1713123.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2546615.2656; train_optim_loss: 2546615.2656; val_kl_reg_loss: 16372.6982; val_edge_recon_loss: 797652.4375; val_gene_expr_recon_loss: 1723916.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2537941.3750; val_optim_loss: 2537941.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9452; val_auprc_score: 0.9839; val_best_acc_score: 0.9495; val_best_f1_score: 0.9709; train_kl_reg_loss: 16667.0837; train_edge_recon_loss: 806997.1172; train_gene_expr_recon_loss: 1707746.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531410.2969; train_optim_loss: 2531410.2969; val_kl_reg_loss: 16497.6553; val_edge_recon_loss: 815920.7500; val_gene_expr_recon_loss: 1712556.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2544974.8750; val_optim_loss: 2544974.8750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9599; val_auprc_score: 0.9897; val_best_acc_score: 0.9545; val_best_f1_score: 0.9736; train_kl_reg_loss: 16711.7418; train_edge_recon_loss: 806451.3164; train_gene_expr_recon_loss: 1700787.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523950.7969; train_optim_loss: 2523950.7969; val_kl_reg_loss: 16362.3301; val_edge_recon_loss: 817144.4688; val_gene_expr_recon_loss: 1713690.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2547197.7500; val_optim_loss: 2547197.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9467; val_auprc_score: 0.9812; val_best_acc_score: 0.9515; val_best_f1_score: 0.9721; train_kl_reg_loss: 16582.2122; train_edge_recon_loss: 781707.5508; train_gene_expr_recon_loss: 1694986.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2493276.1875; train_optim_loss: 2493276.1875; val_kl_reg_loss: 16325.9175; val_edge_recon_loss: 815312.9375; val_gene_expr_recon_loss: 1710317.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2541956.0000; val_optim_loss: 2541956.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9685; val_auprc_score: 0.9921; val_best_acc_score: 0.9607; val_best_f1_score: 0.9770; train_kl_reg_loss: 16541.9312; train_edge_recon_loss: 806455.1602; train_gene_expr_recon_loss: 1696093.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2519090.5781; train_optim_loss: 2519090.5781; val_kl_reg_loss: 16311.2026; val_edge_recon_loss: 816787.9375; val_gene_expr_recon_loss: 1710005.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2543104.1250; val_optim_loss: 2543104.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9607; val_auprc_score: 0.9888; val_best_acc_score: 0.9570; val_best_f1_score: 0.9751; train_kl_reg_loss: 16499.2300; train_edge_recon_loss: 792425.8438; train_gene_expr_recon_loss: 1691829.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2500754.5000; train_optim_loss: 2500754.5000; val_kl_reg_loss: 16256.9307; val_edge_recon_loss: 798932.0312; val_gene_expr_recon_loss: 1712980.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2528169.0000; val_optim_loss: 2528169.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9653; val_auprc_score: 0.9915; val_best_acc_score: 0.9577; val_best_f1_score: 0.9755; train_kl_reg_loss: 16499.3102; train_edge_recon_loss: 812152.9141; train_gene_expr_recon_loss: 1690764.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2519416.4531; train_optim_loss: 2519416.4531; val_kl_reg_loss: 16358.5142; val_edge_recon_loss: 792908.7500; val_gene_expr_recon_loss: 1705923.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2515190.5000; val_optim_loss: 2515190.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9508; val_auprc_score: 0.9876; val_best_acc_score: 0.9595; val_best_f1_score: 0.9769; train_kl_reg_loss: 16522.8944; train_edge_recon_loss: 792311.1680; train_gene_expr_recon_loss: 1694040.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2502874.0469; train_optim_loss: 2502874.0469; val_kl_reg_loss: 16357.9141; val_edge_recon_loss: 741799.9688; val_gene_expr_recon_loss: 1711859.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2470017.0000; val_optim_loss: 2470017.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9547; val_auprc_score: 0.9862; val_best_acc_score: 0.9553; val_best_f1_score: 0.9742; train_kl_reg_loss: 16516.1328; train_edge_recon_loss: 790875.4492; train_gene_expr_recon_loss: 1691338.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2498729.7344; train_optim_loss: 2498729.7344; val_kl_reg_loss: 16380.2710; val_edge_recon_loss: 811607.1250; val_gene_expr_recon_loss: 1713356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2541343.3750; val_optim_loss: 2541343.3750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9470; val_auprc_score: 0.9823; val_best_acc_score: 0.9562; val_best_f1_score: 0.9750; train_kl_reg_loss: 16492.8685; train_edge_recon_loss: 804456.0352; train_gene_expr_recon_loss: 1691141.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2512090.3594; train_optim_loss: 2512090.3594; val_kl_reg_loss: 16386.4229; val_edge_recon_loss: 753107.2812; val_gene_expr_recon_loss: 1711342.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2480836.1250; val_optim_loss: 2480836.1250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9564; val_auprc_score: 0.9889; val_best_acc_score: 0.9543; val_best_f1_score: 0.9738; train_kl_reg_loss: 16548.0311; train_edge_recon_loss: 799273.3828; train_gene_expr_recon_loss: 1691061.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2506883.1719; train_optim_loss: 2506883.1719; val_kl_reg_loss: 16464.9746; val_edge_recon_loss: 783214.0312; val_gene_expr_recon_loss: 1701327.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2501006.0000; val_optim_loss: 2501006.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9576; val_auprc_score: 0.9867; val_best_acc_score: 0.9558; val_best_f1_score: 0.9744; train_kl_reg_loss: 16591.8770; train_edge_recon_loss: 817123.1055; train_gene_expr_recon_loss: 1689968.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523683.0469; train_optim_loss: 2523683.0469; val_kl_reg_loss: 16367.7061; val_edge_recon_loss: 784036.6875; val_gene_expr_recon_loss: 1714274.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2514678.6250; val_optim_loss: 2514678.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9562; val_auprc_score: 0.9899; val_best_acc_score: 0.9569; val_best_f1_score: 0.9754; train_kl_reg_loss: 16643.0735; train_edge_recon_loss: 816802.5000; train_gene_expr_recon_loss: 1693757.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2527202.7188; train_optim_loss: 2527202.7188; val_kl_reg_loss: 16479.6738; val_edge_recon_loss: 752620.1875; val_gene_expr_recon_loss: 1705523.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2474623.1250; val_optim_loss: 2474623.1250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9527; val_auprc_score: 0.9870; val_best_acc_score: 0.9591; val_best_f1_score: 0.9765; train_kl_reg_loss: 16587.5544; train_edge_recon_loss: 799672.0781; train_gene_expr_recon_loss: 1689248.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2505508.1250; train_optim_loss: 2505508.1250; val_kl_reg_loss: 16502.7754; val_edge_recon_loss: 769899.0312; val_gene_expr_recon_loss: 1703817.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2490219.3750; val_optim_loss: 2490219.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9524; val_auprc_score: 0.9856; val_best_acc_score: 0.9537; val_best_f1_score: 0.9732; train_kl_reg_loss: 16565.6705; train_edge_recon_loss: 790883.9023; train_gene_expr_recon_loss: 1689962.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2497411.8438; train_optim_loss: 2497411.8438; val_kl_reg_loss: 16345.2129; val_edge_recon_loss: 848376.5938; val_gene_expr_recon_loss: 1711074.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2575795.8750; val_optim_loss: 2575795.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9520; val_auprc_score: 0.9853; val_best_acc_score: 0.9557; val_best_f1_score: 0.9743; train_kl_reg_loss: 16603.5836; train_edge_recon_loss: 808870.3828; train_gene_expr_recon_loss: 1691467.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2516941.1094; train_optim_loss: 2516941.1094; val_kl_reg_loss: 16386.8672; val_edge_recon_loss: 809344.2188; val_gene_expr_recon_loss: 1706783.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2532514.8750; val_optim_loss: 2532514.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 34 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9581
val AUPRC score: 0.9885
val best accuracy score: 0.9547
val best F1 score: 0.9740
val target rna MSE score: 1.0758
val source rna MSE score: 0.3411
Val cat covariate0 mean sim diff: -0.0026
Duration of model training in run 6: 0 hours, 1 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9596; val_auprc_score: 0.9892; val_best_acc_score: 0.9337; val_best_f1_score: 0.9619; train_kl_reg_loss: 575.3102; train_edge_recon_loss: 1007926.7422; train_gene_expr_recon_loss: 2244623.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3253125.1719; train_optim_loss: 3253125.1719; val_kl_reg_loss: 1397.2405; val_edge_recon_loss: 1153137.8125; val_gene_expr_recon_loss: 2161980.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316515.8750; val_optim_loss: 3316515.8750
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9322; val_auprc_score: 0.9841; val_best_acc_score: 0.9098; val_best_f1_score: 0.9474; train_kl_reg_loss: 3183.2718; train_edge_recon_loss: 1015697.3672; train_gene_expr_recon_loss: 2138172.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157052.7656; train_optim_loss: 3157052.7656; val_kl_reg_loss: 4827.1865; val_edge_recon_loss: 1227177.4375; val_gene_expr_recon_loss: 2071527.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303532.3750; val_optim_loss: 3303532.3750
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9003; val_auprc_score: 0.9753; val_best_acc_score: 0.8946; val_best_f1_score: 0.9399; train_kl_reg_loss: 5912.1773; train_edge_recon_loss: 1027563.7227; train_gene_expr_recon_loss: 2055848.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3089324.2812; train_optim_loss: 3089324.2812; val_kl_reg_loss: 5724.9651; val_edge_recon_loss: 1180823.6250; val_gene_expr_recon_loss: 1991966.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3178515.5000; val_optim_loss: 3178515.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8558; val_auprc_score: 0.9645; val_best_acc_score: 0.8846; val_best_f1_score: 0.9353; train_kl_reg_loss: 6192.8045; train_edge_recon_loss: 1004192.4023; train_gene_expr_recon_loss: 1986856.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2997242.1562; train_optim_loss: 2997242.1562; val_kl_reg_loss: 7225.4314; val_edge_recon_loss: 1062910.2812; val_gene_expr_recon_loss: 1947311.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3017447.6250; val_optim_loss: 3017447.6250
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8319; val_auprc_score: 0.9577; val_best_acc_score: 0.8830; val_best_f1_score: 0.9349; train_kl_reg_loss: 8630.7419; train_edge_recon_loss: 961550.9180; train_gene_expr_recon_loss: 1929503.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2899685.5000; train_optim_loss: 2899685.5000; val_kl_reg_loss: 9747.7305; val_edge_recon_loss: 1036842.1562; val_gene_expr_recon_loss: 1898052.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2944641.8750; val_optim_loss: 2944641.8750
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8501; val_auprc_score: 0.9619; val_best_acc_score: 0.8895; val_best_f1_score: 0.9382; train_kl_reg_loss: 11347.4528; train_edge_recon_loss: 952928.5000; train_gene_expr_recon_loss: 1885517.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2849793.8594; train_optim_loss: 2849793.8594; val_kl_reg_loss: 11086.6592; val_edge_recon_loss: 992550.4375; val_gene_expr_recon_loss: 1849903.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2853541.0000; val_optim_loss: 2853541.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8637; val_auprc_score: 0.9682; val_best_acc_score: 0.8974; val_best_f1_score: 0.9422; train_kl_reg_loss: 11049.6255; train_edge_recon_loss: 925178.5938; train_gene_expr_recon_loss: 1860795.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2797023.4062; train_optim_loss: 2797023.4062; val_kl_reg_loss: 10746.7217; val_edge_recon_loss: 929298.7500; val_gene_expr_recon_loss: 1833092.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2773137.8750; val_optim_loss: 2773137.8750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8794; val_auprc_score: 0.9711; val_best_acc_score: 0.9068; val_best_f1_score: 0.9475; train_kl_reg_loss: 11449.7681; train_edge_recon_loss: 897293.5078; train_gene_expr_recon_loss: 1837904.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2746647.6094; train_optim_loss: 2746647.6094; val_kl_reg_loss: 11904.5981; val_edge_recon_loss: 872755.7500; val_gene_expr_recon_loss: 1813104.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2697764.5000; val_optim_loss: 2697764.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8895; val_auprc_score: 0.9734; val_best_acc_score: 0.9075; val_best_f1_score: 0.9473; train_kl_reg_loss: 12320.0294; train_edge_recon_loss: 876048.5820; train_gene_expr_recon_loss: 1820546.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2708914.7969; train_optim_loss: 2708914.7969; val_kl_reg_loss: 12465.8794; val_edge_recon_loss: 896099.8438; val_gene_expr_recon_loss: 1793769.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2702334.8750; val_optim_loss: 2702334.8750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8961; val_auprc_score: 0.9767; val_best_acc_score: 0.9096; val_best_f1_score: 0.9492; train_kl_reg_loss: 12857.5934; train_edge_recon_loss: 863206.8359; train_gene_expr_recon_loss: 1803120.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2679184.8906; train_optim_loss: 2679184.8906; val_kl_reg_loss: 12875.1875; val_edge_recon_loss: 877872.8750; val_gene_expr_recon_loss: 1785685.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2676433.7500; val_optim_loss: 2676433.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9105; val_auprc_score: 0.9789; val_best_acc_score: 0.9220; val_best_f1_score: 0.9559; train_kl_reg_loss: 13292.7254; train_edge_recon_loss: 828404.0547; train_gene_expr_recon_loss: 1792873.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2634570.6875; train_optim_loss: 2634570.6875; val_kl_reg_loss: 13574.7290; val_edge_recon_loss: 838231.6875; val_gene_expr_recon_loss: 1768010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2619816.3750; val_optim_loss: 2619816.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9152; val_auprc_score: 0.9794; val_best_acc_score: 0.9340; val_best_f1_score: 0.9626; train_kl_reg_loss: 13475.6679; train_edge_recon_loss: 837099.1992; train_gene_expr_recon_loss: 1776790.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2627365.0000; train_optim_loss: 2627365.0000; val_kl_reg_loss: 13523.3970; val_edge_recon_loss: 791880.3750; val_gene_expr_recon_loss: 1759871.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2565275.3750; val_optim_loss: 2565275.3750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9153; val_auprc_score: 0.9789; val_best_acc_score: 0.9383; val_best_f1_score: 0.9649; train_kl_reg_loss: 13724.7033; train_edge_recon_loss: 817252.3008; train_gene_expr_recon_loss: 1759740.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2590717.8281; train_optim_loss: 2590717.8281; val_kl_reg_loss: 13870.7280; val_edge_recon_loss: 794961.9062; val_gene_expr_recon_loss: 1743899.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2552732.3750; val_optim_loss: 2552732.3750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9396; val_auprc_score: 0.9873; val_best_acc_score: 0.9407; val_best_f1_score: 0.9661; train_kl_reg_loss: 14026.9951; train_edge_recon_loss: 814872.4609; train_gene_expr_recon_loss: 1749461.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2578361.1562; train_optim_loss: 2578361.1562; val_kl_reg_loss: 13716.3867; val_edge_recon_loss: 789367.1875; val_gene_expr_recon_loss: 1739952.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2543036.2500; val_optim_loss: 2543036.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9321; val_auprc_score: 0.9809; val_best_acc_score: 0.9405; val_best_f1_score: 0.9660; train_kl_reg_loss: 14393.4791; train_edge_recon_loss: 826619.8242; train_gene_expr_recon_loss: 1740148.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2581161.4844; train_optim_loss: 2581161.4844; val_kl_reg_loss: 14472.4014; val_edge_recon_loss: 821606.2188; val_gene_expr_recon_loss: 1732825.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2568903.6250; val_optim_loss: 2568903.6250
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9445; val_auprc_score: 0.9841; val_best_acc_score: 0.9435; val_best_f1_score: 0.9673; train_kl_reg_loss: 14756.7426; train_edge_recon_loss: 798342.3086; train_gene_expr_recon_loss: 1731901.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2545000.1719; train_optim_loss: 2545000.1719; val_kl_reg_loss: 14823.7295; val_edge_recon_loss: 844702.4688; val_gene_expr_recon_loss: 1714654.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2574180.5000; val_optim_loss: 2574180.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9427; val_auprc_score: 0.9846; val_best_acc_score: 0.9458; val_best_f1_score: 0.9688; train_kl_reg_loss: 14820.6556; train_edge_recon_loss: 828446.7969; train_gene_expr_recon_loss: 1727089.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2570356.5781; train_optim_loss: 2570356.5781; val_kl_reg_loss: 14458.1030; val_edge_recon_loss: 822861.3438; val_gene_expr_recon_loss: 1707544.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2544863.7500; val_optim_loss: 2544863.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9395; val_auprc_score: 0.9805; val_best_acc_score: 0.9460; val_best_f1_score: 0.9690; train_kl_reg_loss: 14643.8765; train_edge_recon_loss: 797500.0820; train_gene_expr_recon_loss: 1719035.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531179.3906; train_optim_loss: 2531179.3906; val_kl_reg_loss: 14711.7715; val_edge_recon_loss: 829748.6875; val_gene_expr_recon_loss: 1700030.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2544490.6250; val_optim_loss: 2544490.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9540; val_auprc_score: 0.9889; val_best_acc_score: 0.9524; val_best_f1_score: 0.9726; train_kl_reg_loss: 14909.6121; train_edge_recon_loss: 792818.0781; train_gene_expr_recon_loss: 1713615.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2521343.0000; train_optim_loss: 2521343.0000; val_kl_reg_loss: 14879.9175; val_edge_recon_loss: 805666.7500; val_gene_expr_recon_loss: 1693071.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2513618.6250; val_optim_loss: 2513618.6250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9443; val_auprc_score: 0.9848; val_best_acc_score: 0.9527; val_best_f1_score: 0.9730; train_kl_reg_loss: 15012.3871; train_edge_recon_loss: 804464.1094; train_gene_expr_recon_loss: 1712528.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2532004.5312; train_optim_loss: 2532004.5312; val_kl_reg_loss: 14908.0820; val_edge_recon_loss: 768744.7188; val_gene_expr_recon_loss: 1700340.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2483993.2500; val_optim_loss: 2483993.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9497; val_auprc_score: 0.9878; val_best_acc_score: 0.9517; val_best_f1_score: 0.9724; train_kl_reg_loss: 15067.6362; train_edge_recon_loss: 800402.0078; train_gene_expr_recon_loss: 1709863.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2525332.8906; train_optim_loss: 2525332.8906; val_kl_reg_loss: 14971.4209; val_edge_recon_loss: 761458.1562; val_gene_expr_recon_loss: 1694856.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2471286.3750; val_optim_loss: 2471286.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9418; val_auprc_score: 0.9822; val_best_acc_score: 0.9516; val_best_f1_score: 0.9720; train_kl_reg_loss: 15119.8139; train_edge_recon_loss: 792735.7031; train_gene_expr_recon_loss: 1713944.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2521800.2812; train_optim_loss: 2521800.2812; val_kl_reg_loss: 14881.0928; val_edge_recon_loss: 819967.7188; val_gene_expr_recon_loss: 1700167.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2535015.7500; val_optim_loss: 2535015.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9511; val_auprc_score: 0.9875; val_best_acc_score: 0.9517; val_best_f1_score: 0.9721; train_kl_reg_loss: 15056.6096; train_edge_recon_loss: 804466.4805; train_gene_expr_recon_loss: 1706918.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2526441.9844; train_optim_loss: 2526441.9844; val_kl_reg_loss: 14924.7417; val_edge_recon_loss: 806978.9688; val_gene_expr_recon_loss: 1691471.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2513375.1250; val_optim_loss: 2513375.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9404; val_auprc_score: 0.9813; val_best_acc_score: 0.9481; val_best_f1_score: 0.9698; train_kl_reg_loss: 15091.0949; train_edge_recon_loss: 797748.4688; train_gene_expr_recon_loss: 1706710.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2519549.9688; train_optim_loss: 2519549.9688; val_kl_reg_loss: 14930.2939; val_edge_recon_loss: 860715.1562; val_gene_expr_recon_loss: 1697203.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2572848.5000; val_optim_loss: 2572848.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9438; val_auprc_score: 0.9841; val_best_acc_score: 0.9499; val_best_f1_score: 0.9712; train_kl_reg_loss: 15081.9788; train_edge_recon_loss: 800563.1953; train_gene_expr_recon_loss: 1707075.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2522720.7969; train_optim_loss: 2522720.7969; val_kl_reg_loss: 14878.9990; val_edge_recon_loss: 810455.1875; val_gene_expr_recon_loss: 1699452.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2524787.1250; val_optim_loss: 2524787.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9527; val_auprc_score: 0.9872; val_best_acc_score: 0.9538; val_best_f1_score: 0.9734; train_kl_reg_loss: 15036.0651; train_edge_recon_loss: 802643.7930; train_gene_expr_recon_loss: 1705910.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2523590.0469; train_optim_loss: 2523590.0469; val_kl_reg_loss: 14844.4053; val_edge_recon_loss: 794971.0312; val_gene_expr_recon_loss: 1691239.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2501055.0000; val_optim_loss: 2501055.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9592; val_auprc_score: 0.9880; val_best_acc_score: 0.9580; val_best_f1_score: 0.9758; train_kl_reg_loss: 15047.2964; train_edge_recon_loss: 810022.0391; train_gene_expr_recon_loss: 1706910.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2531979.8438; train_optim_loss: 2531979.8438; val_kl_reg_loss: 14897.8794; val_edge_recon_loss: 777939.0000; val_gene_expr_recon_loss: 1690773.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2483610.7500; val_optim_loss: 2483610.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9508; val_auprc_score: 0.9894; val_best_acc_score: 0.9573; val_best_f1_score: 0.9759; train_kl_reg_loss: 15055.3510; train_edge_recon_loss: 808392.4258; train_gene_expr_recon_loss: 1705785.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2529232.9688; train_optim_loss: 2529232.9688; val_kl_reg_loss: 14843.5269; val_edge_recon_loss: 714359.6250; val_gene_expr_recon_loss: 1684447.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2413650.2500; val_optim_loss: 2413650.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9530; val_auprc_score: 0.9886; val_best_acc_score: 0.9507; val_best_f1_score: 0.9717; train_kl_reg_loss: 15044.4168; train_edge_recon_loss: 816113.5195; train_gene_expr_recon_loss: 1706207.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2537365.7500; train_optim_loss: 2537365.7500; val_kl_reg_loss: 14943.4976; val_edge_recon_loss: 781826.7188; val_gene_expr_recon_loss: 1689179.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2485949.8750; val_optim_loss: 2485949.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9503; val_auprc_score: 0.9870; val_best_acc_score: 0.9488; val_best_f1_score: 0.9704; train_kl_reg_loss: 15048.9546; train_edge_recon_loss: 804555.8711; train_gene_expr_recon_loss: 1709756.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2529360.9531; train_optim_loss: 2529360.9531; val_kl_reg_loss: 14874.9072; val_edge_recon_loss: 823143.9062; val_gene_expr_recon_loss: 1706407.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2544426.2500; val_optim_loss: 2544426.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9466; val_auprc_score: 0.9841; val_best_acc_score: 0.9548; val_best_f1_score: 0.9741; train_kl_reg_loss: 15059.3993; train_edge_recon_loss: 806506.3203; train_gene_expr_recon_loss: 1705383.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2526948.8125; train_optim_loss: 2526948.8125; val_kl_reg_loss: 14809.9951; val_edge_recon_loss: 780446.7812; val_gene_expr_recon_loss: 1691576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2486832.7500; val_optim_loss: 2486832.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9473; val_auprc_score: 0.9844; val_best_acc_score: 0.9519; val_best_f1_score: 0.9722; train_kl_reg_loss: 15050.6862; train_edge_recon_loss: 815483.5195; train_gene_expr_recon_loss: 1707619.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2538153.3750; train_optim_loss: 2538153.3750; val_kl_reg_loss: 14909.4810; val_edge_recon_loss: 807285.1562; val_gene_expr_recon_loss: 1697607.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2519802.1250; val_optim_loss: 2519802.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9431; val_auprc_score: 0.9857; val_best_acc_score: 0.9521; val_best_f1_score: 0.9726; train_kl_reg_loss: 15092.6930; train_edge_recon_loss: 788312.8477; train_gene_expr_recon_loss: 1706641.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2510047.3750; train_optim_loss: 2510047.3750; val_kl_reg_loss: 14952.8516; val_edge_recon_loss: 787265.8438; val_gene_expr_recon_loss: 1695205.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2497424.5000; val_optim_loss: 2497424.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9436; val_auprc_score: 0.9820; val_best_acc_score: 0.9484; val_best_f1_score: 0.9702; train_kl_reg_loss: 15085.1629; train_edge_recon_loss: 793587.9141; train_gene_expr_recon_loss: 1704854.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2513527.8750; train_optim_loss: 2513527.8750; val_kl_reg_loss: 14925.9893; val_edge_recon_loss: 814168.9062; val_gene_expr_recon_loss: 1695767.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2524862.6250; val_optim_loss: 2524862.6250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9534; val_auprc_score: 0.9881; val_best_acc_score: 0.9560; val_best_f1_score: 0.9748; train_kl_reg_loss: 15052.3705; train_edge_recon_loss: 797006.3516; train_gene_expr_recon_loss: 1703748.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2515807.3906; train_optim_loss: 2515807.3906; val_kl_reg_loss: 14880.5889; val_edge_recon_loss: 754705.0938; val_gene_expr_recon_loss: 1689834.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2459420.2500; val_optim_loss: 2459420.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9418; val_auprc_score: 0.9847; val_best_acc_score: 0.9520; val_best_f1_score: 0.9724; train_kl_reg_loss: 15065.5172; train_edge_recon_loss: 798523.6758; train_gene_expr_recon_loss: 1706465.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2520054.8906; train_optim_loss: 2520054.8906; val_kl_reg_loss: 14870.5264; val_edge_recon_loss: 803563.1562; val_gene_expr_recon_loss: 1701644.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2520078.2500; val_optim_loss: 2520078.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 34 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9428
val AUPRC score: 0.9850
val best accuracy score: 0.9491
val best F1 score: 0.9708
val target rna MSE score: 1.0379
val source rna MSE score: 0.3614
Val cat covariate0 mean sim diff: -0.0041
Duration of model training in run 5: 0 hours, 1 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9639; val_auprc_score: 0.9924; val_best_acc_score: 0.9293; val_best_f1_score: 0.9581; train_kl_reg_loss: 417.9572; train_edge_recon_loss: 1032926.2955; train_gene_expr_recon_loss: 2268009.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301353.6818; train_optim_loss: 3301353.6818; val_kl_reg_loss: 1005.2525; val_edge_recon_loss: 1206199.6250; val_gene_expr_recon_loss: 2190150.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3397355.7500; val_optim_loss: 3397355.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9441; val_auprc_score: 0.9853; val_best_acc_score: 0.9192; val_best_f1_score: 0.9538; train_kl_reg_loss: 2228.4708; train_edge_recon_loss: 1034979.7727; train_gene_expr_recon_loss: 2182955.3409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3220163.5909; train_optim_loss: 3220163.5909; val_kl_reg_loss: 4207.6569; val_edge_recon_loss: 1242532.3750; val_gene_expr_recon_loss: 2090099.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3336839.2500; val_optim_loss: 3336839.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9260; val_auprc_score: 0.9810; val_best_acc_score: 0.9066; val_best_f1_score: 0.9466; train_kl_reg_loss: 6623.2251; train_edge_recon_loss: 1026758.9489; train_gene_expr_recon_loss: 2102679.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3136062.0682; train_optim_loss: 3136062.0682; val_kl_reg_loss: 7391.6755; val_edge_recon_loss: 1187556.0000; val_gene_expr_recon_loss: 2084422.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3279369.8750; val_optim_loss: 3279369.8750
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9147; val_auprc_score: 0.9810; val_best_acc_score: 0.8903; val_best_f1_score: 0.9386; train_kl_reg_loss: 9092.0505; train_edge_recon_loss: 1024840.5739; train_gene_expr_recon_loss: 2037387.8523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3071320.5000; train_optim_loss: 3071320.5000; val_kl_reg_loss: 11098.3105; val_edge_recon_loss: 1269866.8125; val_gene_expr_recon_loss: 2024351.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3305316.2500; val_optim_loss: 3305316.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8939; val_auprc_score: 0.9758; val_best_acc_score: 0.8907; val_best_f1_score: 0.9387; train_kl_reg_loss: 8506.1569; train_edge_recon_loss: 1036219.9091; train_gene_expr_recon_loss: 1971424.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3016150.9091; train_optim_loss: 3016150.9091; val_kl_reg_loss: 9474.5464; val_edge_recon_loss: 1163197.0625; val_gene_expr_recon_loss: 1990205.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3162877.2500; val_optim_loss: 3162877.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8821; val_auprc_score: 0.9779; val_best_acc_score: 0.9035; val_best_f1_score: 0.9468; train_kl_reg_loss: 9049.4518; train_edge_recon_loss: 1011041.1989; train_gene_expr_recon_loss: 1928540.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2948631.1591; train_optim_loss: 2948631.1591; val_kl_reg_loss: 7667.6235; val_edge_recon_loss: 1026162.9688; val_gene_expr_recon_loss: 1990246.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3024076.8750; val_optim_loss: 3024076.8750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8535; val_auprc_score: 0.9677; val_best_acc_score: 0.8901; val_best_f1_score: 0.9389; train_kl_reg_loss: 9137.1546; train_edge_recon_loss: 986781.2330; train_gene_expr_recon_loss: 1887895.1591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2883813.5455; train_optim_loss: 2883813.5455; val_kl_reg_loss: 10008.4736; val_edge_recon_loss: 993861.5938; val_gene_expr_recon_loss: 1843588.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2847459.0000; val_optim_loss: 2847459.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8490; val_auprc_score: 0.9670; val_best_acc_score: 0.8946; val_best_f1_score: 0.9412; train_kl_reg_loss: 11808.1123; train_edge_recon_loss: 945497.4034; train_gene_expr_recon_loss: 1863441.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2820747.4318; train_optim_loss: 2820747.4318; val_kl_reg_loss: 12619.2783; val_edge_recon_loss: 953317.2812; val_gene_expr_recon_loss: 1828889.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2794825.6250; val_optim_loss: 2794825.6250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8289; val_auprc_score: 0.9577; val_best_acc_score: 0.8943; val_best_f1_score: 0.9413; train_kl_reg_loss: 12583.9379; train_edge_recon_loss: 938569.2159; train_gene_expr_recon_loss: 1840953.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2792106.4091; train_optim_loss: 2792106.4091; val_kl_reg_loss: 13052.2256; val_edge_recon_loss: 887739.4375; val_gene_expr_recon_loss: 1790038.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2690829.7500; val_optim_loss: 2690829.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8475; val_auprc_score: 0.9640; val_best_acc_score: 0.8915; val_best_f1_score: 0.9391; train_kl_reg_loss: 12831.0083; train_edge_recon_loss: 915225.0057; train_gene_expr_recon_loss: 1820647.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2748703.1136; train_optim_loss: 2748703.1136; val_kl_reg_loss: 12552.5146; val_edge_recon_loss: 1019824.1875; val_gene_expr_recon_loss: 1852532.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2884909.1250; val_optim_loss: 2884909.1250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8659; val_auprc_score: 0.9678; val_best_acc_score: 0.9015; val_best_f1_score: 0.9446; train_kl_reg_loss: 12536.1954; train_edge_recon_loss: 907503.6080; train_gene_expr_recon_loss: 1813777.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2733817.4091; train_optim_loss: 2733817.4091; val_kl_reg_loss: 11716.2910; val_edge_recon_loss: 901469.2812; val_gene_expr_recon_loss: 1734376.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2647562.3750; val_optim_loss: 2647562.3750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8779; val_auprc_score: 0.9724; val_best_acc_score: 0.8956; val_best_f1_score: 0.9412; train_kl_reg_loss: 11722.5304; train_edge_recon_loss: 888647.4148; train_gene_expr_recon_loss: 1795866.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2696236.1818; train_optim_loss: 2696236.1818; val_kl_reg_loss: 11909.5859; val_edge_recon_loss: 912284.8438; val_gene_expr_recon_loss: 1841383.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2765577.7500; val_optim_loss: 2765577.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8820; val_auprc_score: 0.9709; val_best_acc_score: 0.9036; val_best_f1_score: 0.9453; train_kl_reg_loss: 11510.2209; train_edge_recon_loss: 894128.4318; train_gene_expr_recon_loss: 1787947.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2693585.7045; train_optim_loss: 2693585.7045; val_kl_reg_loss: 10651.8682; val_edge_recon_loss: 902811.1875; val_gene_expr_recon_loss: 1768356.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2681820.0000; val_optim_loss: 2681820.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8958; val_auprc_score: 0.9768; val_best_acc_score: 0.9108; val_best_f1_score: 0.9496; train_kl_reg_loss: 12195.8622; train_edge_recon_loss: 848445.5398; train_gene_expr_recon_loss: 1780262.6023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2640904.0227; train_optim_loss: 2640904.0227; val_kl_reg_loss: 13198.7573; val_edge_recon_loss: 862719.1875; val_gene_expr_recon_loss: 1827082.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2703000.7500; val_optim_loss: 2703000.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9143; val_auprc_score: 0.9815; val_best_acc_score: 0.9134; val_best_f1_score: 0.9503; train_kl_reg_loss: 13497.5244; train_edge_recon_loss: 851214.0455; train_gene_expr_recon_loss: 1768040.9659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2632752.5000; train_optim_loss: 2632752.5000; val_kl_reg_loss: 13234.4365; val_edge_recon_loss: 909580.0000; val_gene_expr_recon_loss: 1724990.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2647804.7500; val_optim_loss: 2647804.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9053; val_auprc_score: 0.9775; val_best_acc_score: 0.9207; val_best_f1_score: 0.9553; train_kl_reg_loss: 13709.2950; train_edge_recon_loss: 836699.4773; train_gene_expr_recon_loss: 1764161.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2614570.2500; train_optim_loss: 2614570.2500; val_kl_reg_loss: 14518.1167; val_edge_recon_loss: 798111.6250; val_gene_expr_recon_loss: 1920390.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2733019.8750; val_optim_loss: 2733019.8750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9152; val_auprc_score: 0.9796; val_best_acc_score: 0.9217; val_best_f1_score: 0.9553; train_kl_reg_loss: 13680.0824; train_edge_recon_loss: 843399.2955; train_gene_expr_recon_loss: 1759207.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616286.4545; train_optim_loss: 2616286.4545; val_kl_reg_loss: 13090.9058; val_edge_recon_loss: 817858.0000; val_gene_expr_recon_loss: 1728962.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2559911.0000; val_optim_loss: 2559911.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9249; val_auprc_score: 0.9823; val_best_acc_score: 0.9238; val_best_f1_score: 0.9568; train_kl_reg_loss: 13711.1877; train_edge_recon_loss: 832764.8352; train_gene_expr_recon_loss: 1766766.3977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2613242.4318; train_optim_loss: 2613242.4318; val_kl_reg_loss: 13827.1489; val_edge_recon_loss: 809339.4062; val_gene_expr_recon_loss: 1748326.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2571492.6250; val_optim_loss: 2571492.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9224; val_auprc_score: 0.9840; val_best_acc_score: 0.9217; val_best_f1_score: 0.9556; train_kl_reg_loss: 13747.5321; train_edge_recon_loss: 841804.2386; train_gene_expr_recon_loss: 1766637.4886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2622189.2500; train_optim_loss: 2622189.2500; val_kl_reg_loss: 13006.0898; val_edge_recon_loss: 784135.8750; val_gene_expr_recon_loss: 1760266.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2557408.2500; val_optim_loss: 2557408.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9051; val_auprc_score: 0.9793; val_best_acc_score: 0.9153; val_best_f1_score: 0.9516; train_kl_reg_loss: 13711.6697; train_edge_recon_loss: 855280.1932; train_gene_expr_recon_loss: 1764760.6023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2633752.4773; train_optim_loss: 2633752.4773; val_kl_reg_loss: 13573.9961; val_edge_recon_loss: 896932.1250; val_gene_expr_recon_loss: 1752721.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2663227.2500; val_optim_loss: 2663227.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9117; val_auprc_score: 0.9774; val_best_acc_score: 0.9183; val_best_f1_score: 0.9534; train_kl_reg_loss: 13718.6966; train_edge_recon_loss: 834041.3920; train_gene_expr_recon_loss: 1762476.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2610236.2273; train_optim_loss: 2610236.2273; val_kl_reg_loss: 13578.2358; val_edge_recon_loss: 916867.9062; val_gene_expr_recon_loss: 1775283.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2705729.8750; val_optim_loss: 2705729.8750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8997; val_auprc_score: 0.9746; val_best_acc_score: 0.9186; val_best_f1_score: 0.9537; train_kl_reg_loss: 13821.3811; train_edge_recon_loss: 832712.7727; train_gene_expr_recon_loss: 1759839.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606374.0000; train_optim_loss: 2606374.0000; val_kl_reg_loss: 13411.9438; val_edge_recon_loss: 864400.9062; val_gene_expr_recon_loss: 1652990.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2530803.7500; val_optim_loss: 2530803.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9193; val_auprc_score: 0.9828; val_best_acc_score: 0.9231; val_best_f1_score: 0.9560; train_kl_reg_loss: 13857.7725; train_edge_recon_loss: 840167.1080; train_gene_expr_recon_loss: 1755602.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2609627.0455; train_optim_loss: 2609627.0455; val_kl_reg_loss: 14382.0649; val_edge_recon_loss: 805181.5312; val_gene_expr_recon_loss: 1834630.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2654194.0000; val_optim_loss: 2654194.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9108; val_auprc_score: 0.9804; val_best_acc_score: 0.9210; val_best_f1_score: 0.9551; train_kl_reg_loss: 13873.3446; train_edge_recon_loss: 842273.4375; train_gene_expr_recon_loss: 1757621.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2613768.5909; train_optim_loss: 2613768.5909; val_kl_reg_loss: 13540.0112; val_edge_recon_loss: 865851.1562; val_gene_expr_recon_loss: 1726196.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2605587.8750; val_optim_loss: 2605587.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9090; val_auprc_score: 0.9728; val_best_acc_score: 0.9203; val_best_f1_score: 0.9545; train_kl_reg_loss: 13907.0398; train_edge_recon_loss: 837235.1818; train_gene_expr_recon_loss: 1755223.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606365.8864; train_optim_loss: 2606365.8864; val_kl_reg_loss: 14455.3501; val_edge_recon_loss: 814786.7500; val_gene_expr_recon_loss: 1836015.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2665257.7500; val_optim_loss: 2665257.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9057; val_auprc_score: 0.9771; val_best_acc_score: 0.9238; val_best_f1_score: 0.9566; train_kl_reg_loss: 14099.1818; train_edge_recon_loss: 831378.5682; train_gene_expr_recon_loss: 1758106.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2603584.0000; train_optim_loss: 2603584.0000; val_kl_reg_loss: 14078.1387; val_edge_recon_loss: 890454.5625; val_gene_expr_recon_loss: 1782730.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2687263.1250; val_optim_loss: 2687263.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9097; val_auprc_score: 0.9791; val_best_acc_score: 0.9289; val_best_f1_score: 0.9594; train_kl_reg_loss: 14036.7202; train_edge_recon_loss: 813319.8920; train_gene_expr_recon_loss: 1753089.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2580446.4091; train_optim_loss: 2580446.4091; val_kl_reg_loss: 13503.2539; val_edge_recon_loss: 870545.0625; val_gene_expr_recon_loss: 1698595.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2582644.0000; val_optim_loss: 2582644.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9248; val_auprc_score: 0.9833; val_best_acc_score: 0.9317; val_best_f1_score: 0.9609; train_kl_reg_loss: 14080.2349; train_edge_recon_loss: 842026.7955; train_gene_expr_recon_loss: 1760371.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616478.0909; train_optim_loss: 2616478.0909; val_kl_reg_loss: 14023.3643; val_edge_recon_loss: 821055.6875; val_gene_expr_recon_loss: 1788020.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2623099.5000; val_optim_loss: 2623099.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9296; val_auprc_score: 0.9848; val_best_acc_score: 0.9311; val_best_f1_score: 0.9607; train_kl_reg_loss: 14099.9689; train_edge_recon_loss: 834255.7330; train_gene_expr_recon_loss: 1760548.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2608904.5455; train_optim_loss: 2608904.5455; val_kl_reg_loss: 13841.4414; val_edge_recon_loss: 802050.8438; val_gene_expr_recon_loss: 1735696.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2551589.0000; val_optim_loss: 2551589.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9158; val_auprc_score: 0.9803; val_best_acc_score: 0.9211; val_best_f1_score: 0.9549; train_kl_reg_loss: 14059.2336; train_edge_recon_loss: 855241.0341; train_gene_expr_recon_loss: 1754973.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2624273.3636; train_optim_loss: 2624273.3636; val_kl_reg_loss: 14141.5083; val_edge_recon_loss: 857976.4688; val_gene_expr_recon_loss: 1845381.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2717499.8750; val_optim_loss: 2717499.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 47 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9010
val AUPRC score: 0.9768
val best accuracy score: 0.9148
val best F1 score: 0.9519
val target rna MSE score: 1.3129
val source rna MSE score: 0.5928
Val cat covariate0 mean sim diff: -0.0168
Duration of model training in run 4: 0 hours, 0 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9536; val_auprc_score: 0.9899; val_best_acc_score: 0.9236; val_best_f1_score: 0.9547; train_kl_reg_loss: 320.5753; train_edge_recon_loss: 1013811.7841; train_gene_expr_recon_loss: 2308516.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3322648.4318; train_optim_loss: 3322648.4318; val_kl_reg_loss: 772.6213; val_edge_recon_loss: 1136314.1250; val_gene_expr_recon_loss: 2083074.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3220161.5000; val_optim_loss: 3220161.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9365; val_auprc_score: 0.9856; val_best_acc_score: 0.9137; val_best_f1_score: 0.9508; train_kl_reg_loss: 1648.2141; train_edge_recon_loss: 1034949.6761; train_gene_expr_recon_loss: 2211881.2045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3248479.0682; train_optim_loss: 3248479.0682; val_kl_reg_loss: 2808.9391; val_edge_recon_loss: 1158508.9375; val_gene_expr_recon_loss: 2051685.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213003.6250; val_optim_loss: 3213003.6250
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9341; val_auprc_score: 0.9854; val_best_acc_score: 0.9119; val_best_f1_score: 0.9503; train_kl_reg_loss: 5515.1661; train_edge_recon_loss: 1009927.4830; train_gene_expr_recon_loss: 2129531.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3144974.3864; train_optim_loss: 3144974.3864; val_kl_reg_loss: 6124.3582; val_edge_recon_loss: 1121875.9375; val_gene_expr_recon_loss: 2019957.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3147958.0000; val_optim_loss: 3147958.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8995; val_auprc_score: 0.9731; val_best_acc_score: 0.8977; val_best_f1_score: 0.9401; train_kl_reg_loss: 7867.4559; train_edge_recon_loss: 1027922.5170; train_gene_expr_recon_loss: 2066126.9205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3101916.8636; train_optim_loss: 3101916.8636; val_kl_reg_loss: 7525.8906; val_edge_recon_loss: 1215769.8125; val_gene_expr_recon_loss: 1965643.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3188939.2500; val_optim_loss: 3188939.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8984; val_auprc_score: 0.9749; val_best_acc_score: 0.8893; val_best_f1_score: 0.9378; train_kl_reg_loss: 7943.6887; train_edge_recon_loss: 1021907.0455; train_gene_expr_recon_loss: 2020912.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3050763.5682; train_optim_loss: 3050763.5682; val_kl_reg_loss: 7528.8384; val_edge_recon_loss: 1085381.1875; val_gene_expr_recon_loss: 2082987.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3175897.5000; val_optim_loss: 3175897.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8740; val_auprc_score: 0.9723; val_best_acc_score: 0.8844; val_best_f1_score: 0.9359; train_kl_reg_loss: 8058.9154; train_edge_recon_loss: 1004110.3125; train_gene_expr_recon_loss: 1968975.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2981144.7955; train_optim_loss: 2981144.7955; val_kl_reg_loss: 7196.3096; val_edge_recon_loss: 1037677.8438; val_gene_expr_recon_loss: 1875738.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2920612.1250; val_optim_loss: 2920612.1250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8545; val_auprc_score: 0.9688; val_best_acc_score: 0.8899; val_best_f1_score: 0.9384; train_kl_reg_loss: 8182.1961; train_edge_recon_loss: 1001439.3239; train_gene_expr_recon_loss: 1934492.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2944114.0909; train_optim_loss: 2944114.0909; val_kl_reg_loss: 7318.6846; val_edge_recon_loss: 1043612.9062; val_gene_expr_recon_loss: 1973100.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3024032.2500; val_optim_loss: 3024032.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8338; val_auprc_score: 0.9616; val_best_acc_score: 0.8846; val_best_f1_score: 0.9356; train_kl_reg_loss: 9090.6204; train_edge_recon_loss: 958023.1875; train_gene_expr_recon_loss: 1895696.7159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2862810.5227; train_optim_loss: 2862810.5227; val_kl_reg_loss: 9641.8350; val_edge_recon_loss: 977709.3438; val_gene_expr_recon_loss: 1852254.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2839605.7500; val_optim_loss: 2839605.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8490; val_auprc_score: 0.9649; val_best_acc_score: 0.8879; val_best_f1_score: 0.9371; train_kl_reg_loss: 11069.4583; train_edge_recon_loss: 946548.3920; train_gene_expr_recon_loss: 1865175.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2822793.4545; train_optim_loss: 2822793.4545; val_kl_reg_loss: 12460.6191; val_edge_recon_loss: 1004877.0000; val_gene_expr_recon_loss: 1878909.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2896247.1250; val_optim_loss: 2896247.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8491; val_auprc_score: 0.9697; val_best_acc_score: 0.8964; val_best_f1_score: 0.9426; train_kl_reg_loss: 12688.3460; train_edge_recon_loss: 942177.7557; train_gene_expr_recon_loss: 1843111.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2797977.7045; train_optim_loss: 2797977.7045; val_kl_reg_loss: 12739.9800; val_edge_recon_loss: 883185.6562; val_gene_expr_recon_loss: 1849886.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2745812.5000; val_optim_loss: 2745812.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8677; val_auprc_score: 0.9703; val_best_acc_score: 0.8970; val_best_f1_score: 0.9425; train_kl_reg_loss: 12719.7957; train_edge_recon_loss: 944150.2841; train_gene_expr_recon_loss: 1832606.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2789476.7955; train_optim_loss: 2789476.7955; val_kl_reg_loss: 12251.2778; val_edge_recon_loss: 885853.5938; val_gene_expr_recon_loss: 1906572.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804677.7500; val_optim_loss: 2804677.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8621; val_auprc_score: 0.9687; val_best_acc_score: 0.8917; val_best_f1_score: 0.9390; train_kl_reg_loss: 11730.4564; train_edge_recon_loss: 912550.2330; train_gene_expr_recon_loss: 1811312.1932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2735592.8182; train_optim_loss: 2735592.8182; val_kl_reg_loss: 10989.4336; val_edge_recon_loss: 941527.1250; val_gene_expr_recon_loss: 1757728.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2710245.2500; val_optim_loss: 2710245.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8604; val_auprc_score: 0.9675; val_best_acc_score: 0.8931; val_best_f1_score: 0.9395; train_kl_reg_loss: 11624.0637; train_edge_recon_loss: 904772.3523; train_gene_expr_recon_loss: 1810984.5341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2727380.9318; train_optim_loss: 2727380.9318; val_kl_reg_loss: 11163.4204; val_edge_recon_loss: 907040.4688; val_gene_expr_recon_loss: 1752101.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2670305.5000; val_optim_loss: 2670305.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8583; val_auprc_score: 0.9643; val_best_acc_score: 0.8995; val_best_f1_score: 0.9440; train_kl_reg_loss: 12158.5115; train_edge_recon_loss: 885655.1080; train_gene_expr_recon_loss: 1797909.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2695723.2273; train_optim_loss: 2695723.2273; val_kl_reg_loss: 12842.9248; val_edge_recon_loss: 941834.3125; val_gene_expr_recon_loss: 1639021.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2593698.7500; val_optim_loss: 2593698.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8688; val_auprc_score: 0.9702; val_best_acc_score: 0.9050; val_best_f1_score: 0.9472; train_kl_reg_loss: 13128.6732; train_edge_recon_loss: 870371.5000; train_gene_expr_recon_loss: 1789642.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2673142.6136; train_optim_loss: 2673142.6136; val_kl_reg_loss: 12836.2153; val_edge_recon_loss: 801923.8750; val_gene_expr_recon_loss: 1704928.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2519688.7500; val_optim_loss: 2519688.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8825; val_auprc_score: 0.9645; val_best_acc_score: 0.9060; val_best_f1_score: 0.9464; train_kl_reg_loss: 13630.0413; train_edge_recon_loss: 838739.8409; train_gene_expr_recon_loss: 1780862.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2633232.1364; train_optim_loss: 2633232.1364; val_kl_reg_loss: 12857.9053; val_edge_recon_loss: 951953.6250; val_gene_expr_recon_loss: 1743886.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2708698.0000; val_optim_loss: 2708698.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8876; val_auprc_score: 0.9658; val_best_acc_score: 0.9158; val_best_f1_score: 0.9519; train_kl_reg_loss: 14043.3849; train_edge_recon_loss: 850512.9886; train_gene_expr_recon_loss: 1768303.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2632859.7727; train_optim_loss: 2632859.7727; val_kl_reg_loss: 13352.2847; val_edge_recon_loss: 911707.3750; val_gene_expr_recon_loss: 1717611.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2642670.7500; val_optim_loss: 2642670.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8964; val_auprc_score: 0.9744; val_best_acc_score: 0.9122; val_best_f1_score: 0.9501; train_kl_reg_loss: 14433.4794; train_edge_recon_loss: 830412.6818; train_gene_expr_recon_loss: 1761379.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2606226.0682; train_optim_loss: 2606226.0682; val_kl_reg_loss: 14385.5039; val_edge_recon_loss: 916599.0312; val_gene_expr_recon_loss: 1968413.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2899398.0000; val_optim_loss: 2899398.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9115; val_auprc_score: 0.9774; val_best_acc_score: 0.9200; val_best_f1_score: 0.9546; train_kl_reg_loss: 14974.5542; train_edge_recon_loss: 837534.2443; train_gene_expr_recon_loss: 1753090.4432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605599.2500; train_optim_loss: 2605599.2500; val_kl_reg_loss: 15600.2012; val_edge_recon_loss: 867186.3750; val_gene_expr_recon_loss: 1753535.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2636321.8750; val_optim_loss: 2636321.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9061; val_auprc_score: 0.9722; val_best_acc_score: 0.9232; val_best_f1_score: 0.9564; train_kl_reg_loss: 15267.0471; train_edge_recon_loss: 813004.5909; train_gene_expr_recon_loss: 1753315.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2581586.7045; train_optim_loss: 2581586.7045; val_kl_reg_loss: 15410.5278; val_edge_recon_loss: 841545.8750; val_gene_expr_recon_loss: 1817806.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2674763.2500; val_optim_loss: 2674763.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9158; val_auprc_score: 0.9785; val_best_acc_score: 0.9253; val_best_f1_score: 0.9574; train_kl_reg_loss: 15241.5795; train_edge_recon_loss: 830680.3864; train_gene_expr_recon_loss: 1746703.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2592625.4773; train_optim_loss: 2592625.4773; val_kl_reg_loss: 15277.0625; val_edge_recon_loss: 850184.6562; val_gene_expr_recon_loss: 1704890.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2570352.6250; val_optim_loss: 2570352.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9023; val_auprc_score: 0.9777; val_best_acc_score: 0.9194; val_best_f1_score: 0.9545; train_kl_reg_loss: 15167.2237; train_edge_recon_loss: 813088.6364; train_gene_expr_recon_loss: 1743285.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2571541.6136; train_optim_loss: 2571541.6136; val_kl_reg_loss: 15084.1411; val_edge_recon_loss: 810663.0625; val_gene_expr_recon_loss: 1716921.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2542668.1250; val_optim_loss: 2542668.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9121; val_auprc_score: 0.9789; val_best_acc_score: 0.9264; val_best_f1_score: 0.9590; train_kl_reg_loss: 15077.4355; train_edge_recon_loss: 822236.4716; train_gene_expr_recon_loss: 1738600.6932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2575914.5909; train_optim_loss: 2575914.5909; val_kl_reg_loss: 14123.9648; val_edge_recon_loss: 834782.0625; val_gene_expr_recon_loss: 1681829.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2530735.7500; val_optim_loss: 2530735.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 30 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
val AUROC score: 0.8680
val AUPRC score: 0.9666
val best accuracy score: 0.8921
val best F1 score: 0.9390
val target rna MSE score: 1.4054
val source rna MSE score: 0.6330
Val cat covariate0 mean sim diff: -0.0411
Duration of model training in run 3: 0 hours, 0 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8869; val_auprc_score: 0.9678; val_best_acc_score: 0.8806; val_best_f1_score: 0.9310; train_kl_reg_loss: 158.8364; train_edge_recon_loss: 991174.8021; train_gene_expr_recon_loss: 2372977.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3364311.4167; train_optim_loss: 3364311.4167; val_kl_reg_loss: 379.6030; val_edge_recon_loss: 1269105.1250; val_gene_expr_recon_loss: 2318429.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3587914.2500; val_optim_loss: 3587914.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8881; val_auprc_score: 0.9775; val_best_acc_score: 0.8687; val_best_f1_score: 0.9286; train_kl_reg_loss: 626.3182; train_edge_recon_loss: 1010721.6354; train_gene_expr_recon_loss: 2295354.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3306702.1667; train_optim_loss: 3306702.1667; val_kl_reg_loss: 1014.7098; val_edge_recon_loss: 1158112.1250; val_gene_expr_recon_loss: 2270118.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3429245.0000; val_optim_loss: 3429245.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9036; val_auprc_score: 0.9781; val_best_acc_score: 0.8785; val_best_f1_score: 0.9337; train_kl_reg_loss: 1384.5063; train_edge_recon_loss: 1048024.7083; train_gene_expr_recon_loss: 2251779.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301189.2500; train_optim_loss: 3301189.2500; val_kl_reg_loss: 1902.8862; val_edge_recon_loss: 1157215.2500; val_gene_expr_recon_loss: 2222501.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3381619.5000; val_optim_loss: 3381619.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8839; val_auprc_score: 0.9668; val_best_acc_score: 0.8713; val_best_f1_score: 0.9298; train_kl_reg_loss: 2689.2288; train_edge_recon_loss: 1018306.6771; train_gene_expr_recon_loss: 2210046.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231042.4167; train_optim_loss: 3231042.4167; val_kl_reg_loss: 3741.7236; val_edge_recon_loss: 1187245.7500; val_gene_expr_recon_loss: 2175210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366197.5000; val_optim_loss: 3366197.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8867; val_auprc_score: 0.9759; val_best_acc_score: 0.8802; val_best_f1_score: 0.9344; train_kl_reg_loss: 4944.5022; train_edge_recon_loss: 1047663.7396; train_gene_expr_recon_loss: 2161106.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3213715.1250; train_optim_loss: 3213715.1250; val_kl_reg_loss: 5730.4204; val_edge_recon_loss: 1170063.3750; val_gene_expr_recon_loss: 2132098.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3307892.2500; val_optim_loss: 3307892.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8666; val_auprc_score: 0.9642; val_best_acc_score: 0.8680; val_best_f1_score: 0.9268; train_kl_reg_loss: 5906.6131; train_edge_recon_loss: 1030347.3958; train_gene_expr_recon_loss: 2120323.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3156577.0417; train_optim_loss: 3156577.0417; val_kl_reg_loss: 5650.6787; val_edge_recon_loss: 1295962.1250; val_gene_expr_recon_loss: 2096336.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3397949.0000; val_optim_loss: 3397949.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8762; val_auprc_score: 0.9690; val_best_acc_score: 0.8954; val_best_f1_score: 0.9421; train_kl_reg_loss: 6248.1375; train_edge_recon_loss: 1006162.3333; train_gene_expr_recon_loss: 2086387.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3098797.8333; train_optim_loss: 3098797.8333; val_kl_reg_loss: 6624.5283; val_edge_recon_loss: 1098927.0000; val_gene_expr_recon_loss: 2062758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3168309.5000; val_optim_loss: 3168309.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8738; val_auprc_score: 0.9658; val_best_acc_score: 0.8817; val_best_f1_score: 0.9329; train_kl_reg_loss: 7376.3595; train_edge_recon_loss: 1006809.1354; train_gene_expr_recon_loss: 2050271.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3064456.6667; train_optim_loss: 3064456.6667; val_kl_reg_loss: 7403.1943; val_edge_recon_loss: 1226193.5000; val_gene_expr_recon_loss: 2029568.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3263165.0000; val_optim_loss: 3263165.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8601; val_auprc_score: 0.9692; val_best_acc_score: 0.8899; val_best_f1_score: 0.9394; train_kl_reg_loss: 8338.8984; train_edge_recon_loss: 1014015.3438; train_gene_expr_recon_loss: 2016122.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3038476.7917; train_optim_loss: 3038476.7917; val_kl_reg_loss: 7563.0400; val_edge_recon_loss: 1071443.8750; val_gene_expr_recon_loss: 1998815.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3077822.0000; val_optim_loss: 3077822.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8630; val_auprc_score: 0.9687; val_best_acc_score: 0.8802; val_best_f1_score: 0.9332; train_kl_reg_loss: 8179.9213; train_edge_recon_loss: 1015002.0417; train_gene_expr_recon_loss: 1982563.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3005745.7083; train_optim_loss: 3005745.7083; val_kl_reg_loss: 6966.7695; val_edge_recon_loss: 1160265.0000; val_gene_expr_recon_loss: 1972813.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3140045.0000; val_optim_loss: 3140045.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8443; val_auprc_score: 0.9671; val_best_acc_score: 0.8806; val_best_f1_score: 0.9343; train_kl_reg_loss: 7289.6910; train_edge_recon_loss: 964085.6146; train_gene_expr_recon_loss: 1956189.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2927565.0000; train_optim_loss: 2927565.0000; val_kl_reg_loss: 6817.6123; val_edge_recon_loss: 1078609.2500; val_gene_expr_recon_loss: 1951077.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3036504.0000; val_optim_loss: 3036504.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8289; val_auprc_score: 0.9566; val_best_acc_score: 0.8869; val_best_f1_score: 0.9375; train_kl_reg_loss: 7759.3260; train_edge_recon_loss: 989832.6771; train_gene_expr_recon_loss: 1940346.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2937938.2917; train_optim_loss: 2937938.2917; val_kl_reg_loss: 7809.1343; val_edge_recon_loss: 1023765.9375; val_gene_expr_recon_loss: 1930956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2962531.0000; val_optim_loss: 2962531.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8320; val_auprc_score: 0.9673; val_best_acc_score: 0.8806; val_best_f1_score: 0.9350; train_kl_reg_loss: 8596.0264; train_edge_recon_loss: 982334.9479; train_gene_expr_recon_loss: 1915967.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2906898.6667; train_optim_loss: 2906898.6667; val_kl_reg_loss: 8628.3691; val_edge_recon_loss: 970803.0625; val_gene_expr_recon_loss: 1912121.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2891553.2500; val_optim_loss: 2891553.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8054; val_auprc_score: 0.9509; val_best_acc_score: 0.8845; val_best_f1_score: 0.9364; train_kl_reg_loss: 9650.3084; train_edge_recon_loss: 956905.1667; train_gene_expr_recon_loss: 1901112.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2867668.2917; train_optim_loss: 2867668.2917; val_kl_reg_loss: 9759.1328; val_edge_recon_loss: 976044.9375; val_gene_expr_recon_loss: 1896312.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2882116.7500; val_optim_loss: 2882116.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8098; val_auprc_score: 0.9557; val_best_acc_score: 0.8740; val_best_f1_score: 0.9296; train_kl_reg_loss: 10222.1714; train_edge_recon_loss: 950383.5729; train_gene_expr_recon_loss: 1891429.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2852035.2500; train_optim_loss: 2852035.2500; val_kl_reg_loss: 10536.5352; val_edge_recon_loss: 1017553.7500; val_gene_expr_recon_loss: 1881579.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2909670.0000; val_optim_loss: 2909670.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8017; val_auprc_score: 0.9532; val_best_acc_score: 0.8784; val_best_f1_score: 0.9326; train_kl_reg_loss: 11473.2049; train_edge_recon_loss: 930114.6562; train_gene_expr_recon_loss: 1871364.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2812952.3333; train_optim_loss: 2812952.3333; val_kl_reg_loss: 12379.2910; val_edge_recon_loss: 987518.8750; val_gene_expr_recon_loss: 1867344.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2867242.5000; val_optim_loss: 2867242.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8248; val_auprc_score: 0.9576; val_best_acc_score: 0.8838; val_best_f1_score: 0.9361; train_kl_reg_loss: 12771.8154; train_edge_recon_loss: 899140.3438; train_gene_expr_recon_loss: 1859253.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2771165.1667; train_optim_loss: 2771165.1667; val_kl_reg_loss: 12829.8398; val_edge_recon_loss: 952677.8125; val_gene_expr_recon_loss: 1855437.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2820945.5000; val_optim_loss: 2820945.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8350; val_auprc_score: 0.9554; val_best_acc_score: 0.8812; val_best_f1_score: 0.9333; train_kl_reg_loss: 13062.6154; train_edge_recon_loss: 925808.0417; train_gene_expr_recon_loss: 1849329.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2788199.7500; train_optim_loss: 2788199.7500; val_kl_reg_loss: 12948.3760; val_edge_recon_loss: 991351.3125; val_gene_expr_recon_loss: 1845365.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2849664.7500; val_optim_loss: 2849664.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8480; val_auprc_score: 0.9663; val_best_acc_score: 0.8778; val_best_f1_score: 0.9321; train_kl_reg_loss: 12920.2007; train_edge_recon_loss: 907843.7083; train_gene_expr_recon_loss: 1838286.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2759050.7500; train_optim_loss: 2759050.7500; val_kl_reg_loss: 12544.9443; val_edge_recon_loss: 957391.8125; val_gene_expr_recon_loss: 1837214.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807151.2500; val_optim_loss: 2807151.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8529; val_auprc_score: 0.9662; val_best_acc_score: 0.8906; val_best_f1_score: 0.9387; train_kl_reg_loss: 12571.7293; train_edge_recon_loss: 885371.5417; train_gene_expr_recon_loss: 1832283.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2730226.3333; train_optim_loss: 2730226.3333; val_kl_reg_loss: 12503.1074; val_edge_recon_loss: 887222.7500; val_gene_expr_recon_loss: 1829651.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2729377.5000; val_optim_loss: 2729377.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8674; val_auprc_score: 0.9721; val_best_acc_score: 0.8858; val_best_f1_score: 0.9360; train_kl_reg_loss: 12439.8156; train_edge_recon_loss: 899134.6354; train_gene_expr_recon_loss: 1826585.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2738159.7500; train_optim_loss: 2738159.7500; val_kl_reg_loss: 12314.7666; val_edge_recon_loss: 898598.3125; val_gene_expr_recon_loss: 1822553.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2733466.7500; val_optim_loss: 2733466.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8729; val_auprc_score: 0.9648; val_best_acc_score: 0.8820; val_best_f1_score: 0.9329; train_kl_reg_loss: 12231.0908; train_edge_recon_loss: 860436.1250; train_gene_expr_recon_loss: 1814300.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2686967.6667; train_optim_loss: 2686967.6667; val_kl_reg_loss: 12142.2539; val_edge_recon_loss: 948520.8125; val_gene_expr_recon_loss: 1816394.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2777057.7500; val_optim_loss: 2777057.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8465; val_auprc_score: 0.9592; val_best_acc_score: 0.8805; val_best_f1_score: 0.9337; train_kl_reg_loss: 12107.7811; train_edge_recon_loss: 890045.0729; train_gene_expr_recon_loss: 1806627.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2708780.6250; train_optim_loss: 2708780.6250; val_kl_reg_loss: 12359.2188; val_edge_recon_loss: 927287.0625; val_gene_expr_recon_loss: 1811200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2750846.2500; val_optim_loss: 2750846.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8679; val_auprc_score: 0.9646; val_best_acc_score: 0.8843; val_best_f1_score: 0.9347; train_kl_reg_loss: 12447.8446; train_edge_recon_loss: 857826.2917; train_gene_expr_recon_loss: 1807100.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2677374.1667; train_optim_loss: 2677374.1667; val_kl_reg_loss: 12998.8105; val_edge_recon_loss: 923889.1250; val_gene_expr_recon_loss: 1802852.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2739740.5000; val_optim_loss: 2739740.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8666; val_auprc_score: 0.9664; val_best_acc_score: 0.8908; val_best_f1_score: 0.9390; train_kl_reg_loss: 12968.8258; train_edge_recon_loss: 862562.4375; train_gene_expr_recon_loss: 1800476.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2676007.7083; train_optim_loss: 2676007.7083; val_kl_reg_loss: 12990.4746; val_edge_recon_loss: 879974.5000; val_gene_expr_recon_loss: 1801827.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2694792.0000; val_optim_loss: 2694792.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8509; val_auprc_score: 0.9644; val_best_acc_score: 0.8953; val_best_f1_score: 0.9421; train_kl_reg_loss: 12907.1805; train_edge_recon_loss: 883332.9896; train_gene_expr_recon_loss: 1796047.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2692287.3333; train_optim_loss: 2692287.3333; val_kl_reg_loss: 13071.8105; val_edge_recon_loss: 828586.6875; val_gene_expr_recon_loss: 1800961.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2642620.0000; val_optim_loss: 2642620.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8696; val_auprc_score: 0.9708; val_best_acc_score: 0.8846; val_best_f1_score: 0.9354; train_kl_reg_loss: 12854.7275; train_edge_recon_loss: 897302.9896; train_gene_expr_recon_loss: 1795914.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2706072.5833; train_optim_loss: 2706072.5833; val_kl_reg_loss: 12917.6211; val_edge_recon_loss: 916542.3125; val_gene_expr_recon_loss: 1800632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2730092.0000; val_optim_loss: 2730092.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8655; val_auprc_score: 0.9619; val_best_acc_score: 0.8885; val_best_f1_score: 0.9378; train_kl_reg_loss: 12797.4715; train_edge_recon_loss: 867849.1354; train_gene_expr_recon_loss: 1801271.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2681918.2917; train_optim_loss: 2681918.2917; val_kl_reg_loss: 12994.0742; val_edge_recon_loss: 888302.0000; val_gene_expr_recon_loss: 1800314.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2701610.7500; val_optim_loss: 2701610.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8794; val_auprc_score: 0.9676; val_best_acc_score: 0.8799; val_best_f1_score: 0.9308; train_kl_reg_loss: 12732.7459; train_edge_recon_loss: 876115.4062; train_gene_expr_recon_loss: 1793111.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2681959.8750; train_optim_loss: 2681959.8750; val_kl_reg_loss: 12895.9766; val_edge_recon_loss: 991300.8750; val_gene_expr_recon_loss: 1799858.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804055.5000; val_optim_loss: 2804055.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8562; val_auprc_score: 0.9604; val_best_acc_score: 0.8986; val_best_f1_score: 0.9439; train_kl_reg_loss: 12729.1035; train_edge_recon_loss: 824962.9583; train_gene_expr_recon_loss: 1796905.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2634597.9583; train_optim_loss: 2634597.9583; val_kl_reg_loss: 12924.4512; val_edge_recon_loss: 804599.6250; val_gene_expr_recon_loss: 1798889.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2616413.7500; val_optim_loss: 2616413.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8789; val_auprc_score: 0.9696; val_best_acc_score: 0.8891; val_best_f1_score: 0.9381; train_kl_reg_loss: 12717.4450; train_edge_recon_loss: 864347.3750; train_gene_expr_recon_loss: 1793089.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2670154.1250; train_optim_loss: 2670154.1250; val_kl_reg_loss: 12909.4209; val_edge_recon_loss: 888994.3125; val_gene_expr_recon_loss: 1798080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2699983.7500; val_optim_loss: 2699983.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8819; val_auprc_score: 0.9754; val_best_acc_score: 0.9032; val_best_f1_score: 0.9460; train_kl_reg_loss: 12741.3970; train_edge_recon_loss: 856927.7188; train_gene_expr_recon_loss: 1792767.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2662436.9167; train_optim_loss: 2662436.9167; val_kl_reg_loss: 12888.4346; val_edge_recon_loss: 811234.6875; val_gene_expr_recon_loss: 1797309.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2621433.0000; val_optim_loss: 2621433.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8828; val_auprc_score: 0.9737; val_best_acc_score: 0.8909; val_best_f1_score: 0.9386; train_kl_reg_loss: 12805.1138; train_edge_recon_loss: 849301.4583; train_gene_expr_recon_loss: 1790401.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2652508.2500; train_optim_loss: 2652508.2500; val_kl_reg_loss: 12903.4971; val_edge_recon_loss: 906603.9375; val_gene_expr_recon_loss: 1796633.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2716141.0000; val_optim_loss: 2716141.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8575; val_auprc_score: 0.9677; val_best_acc_score: 0.8947; val_best_f1_score: 0.9418; train_kl_reg_loss: 12880.7878; train_edge_recon_loss: 851574.9167; train_gene_expr_recon_loss: 1791329.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2655785.4167; train_optim_loss: 2655785.4167; val_kl_reg_loss: 13031.0684; val_edge_recon_loss: 831141.7500; val_gene_expr_recon_loss: 1795684.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2639857.0000; val_optim_loss: 2639857.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8570; val_auprc_score: 0.9618; val_best_acc_score: 0.8950; val_best_f1_score: 0.9411; train_kl_reg_loss: 12831.5607; train_edge_recon_loss: 848278.3021; train_gene_expr_recon_loss: 1790534.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2651644.2917; train_optim_loss: 2651644.2917; val_kl_reg_loss: 12996.1445; val_edge_recon_loss: 875057.8125; val_gene_expr_recon_loss: 1795609.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2683663.2500; val_optim_loss: 2683663.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8539; val_auprc_score: 0.9632; val_best_acc_score: 0.8897; val_best_f1_score: 0.9381; train_kl_reg_loss: 12805.8496; train_edge_recon_loss: 849340.5000; train_gene_expr_recon_loss: 1788757.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2650903.6667; train_optim_loss: 2650903.6667; val_kl_reg_loss: 13045.7529; val_edge_recon_loss: 927603.3125; val_gene_expr_recon_loss: 1795561.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2736210.5000; val_optim_loss: 2736210.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8384; val_auprc_score: 0.9550; val_best_acc_score: 0.8882; val_best_f1_score: 0.9374; train_kl_reg_loss: 12817.0754; train_edge_recon_loss: 829471.8958; train_gene_expr_recon_loss: 1792732.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2635021.2500; train_optim_loss: 2635021.2500; val_kl_reg_loss: 13008.3867; val_edge_recon_loss: 904478.5000; val_gene_expr_recon_loss: 1795518.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2713005.0000; val_optim_loss: 2713005.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8985; val_auprc_score: 0.9740; val_best_acc_score: 0.9011; val_best_f1_score: 0.9446; train_kl_reg_loss: 12818.1655; train_edge_recon_loss: 842156.2917; train_gene_expr_recon_loss: 1786545.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2641519.8750; train_optim_loss: 2641519.8750; val_kl_reg_loss: 12974.7656; val_edge_recon_loss: 828744.6250; val_gene_expr_recon_loss: 1795493.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2637212.5000; val_optim_loss: 2637212.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 40 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.8748
val AUPRC score: 0.9666
val best accuracy score: 0.8838
val best F1 score: 0.9341
val target rna MSE score: 1.4061
val source rna MSE score: 1.0480
Val cat covariate0 mean sim diff: -0.0101
Duration of model training in run 2: 0 hours, 0 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9019; val_auprc_score: 0.9802; val_best_acc_score: 0.9014; val_best_f1_score: 0.9434; train_kl_reg_loss: 160.5942; train_edge_recon_loss: 1025093.4896; train_gene_expr_recon_loss: 2365967.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3391221.1667; train_optim_loss: 3391221.1667; val_kl_reg_loss: 370.9902; val_edge_recon_loss: 1079821.6250; val_gene_expr_recon_loss: 2291536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3371728.5000; val_optim_loss: 3371728.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8949; val_auprc_score: 0.9795; val_best_acc_score: 0.8803; val_best_f1_score: 0.9351; train_kl_reg_loss: 678.5888; train_edge_recon_loss: 1004216.2083; train_gene_expr_recon_loss: 2291930.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3296825.0833; train_optim_loss: 3296825.0833; val_kl_reg_loss: 1116.1631; val_edge_recon_loss: 1098981.3750; val_gene_expr_recon_loss: 2242115.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3342213.2500; val_optim_loss: 3342213.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9041; val_auprc_score: 0.9739; val_best_acc_score: 0.8786; val_best_f1_score: 0.9334; train_kl_reg_loss: 1515.5203; train_edge_recon_loss: 1052860.7708; train_gene_expr_recon_loss: 2241071.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3295448.0417; train_optim_loss: 3295448.0417; val_kl_reg_loss: 2061.8745; val_edge_recon_loss: 1200499.7500; val_gene_expr_recon_loss: 2195116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3397677.5000; val_optim_loss: 3397677.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9165; val_auprc_score: 0.9737; val_best_acc_score: 0.8892; val_best_f1_score: 0.9328; train_kl_reg_loss: 3147.5817; train_edge_recon_loss: 1030164.1771; train_gene_expr_recon_loss: 2197267.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3230578.9167; train_optim_loss: 3230578.9167; val_kl_reg_loss: 4437.7461; val_edge_recon_loss: 1251187.0000; val_gene_expr_recon_loss: 2149572.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3405197.2500; val_optim_loss: 3405197.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8880; val_auprc_score: 0.9707; val_best_acc_score: 0.8947; val_best_f1_score: 0.9420; train_kl_reg_loss: 5516.9443; train_edge_recon_loss: 1014925.2292; train_gene_expr_recon_loss: 2149916.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3170358.4167; train_optim_loss: 3170358.4167; val_kl_reg_loss: 6012.5269; val_edge_recon_loss: 1152183.8750; val_gene_expr_recon_loss: 2109207.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3267404.0000; val_optim_loss: 3267404.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8803; val_auprc_score: 0.9676; val_best_acc_score: 0.8856; val_best_f1_score: 0.9372; train_kl_reg_loss: 6401.7610; train_edge_recon_loss: 1029206.3750; train_gene_expr_recon_loss: 2106693.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3142301.2083; train_optim_loss: 3142301.2083; val_kl_reg_loss: 5484.2021; val_edge_recon_loss: 1154798.3750; val_gene_expr_recon_loss: 2074844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3235126.5000; val_optim_loss: 3235126.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8835; val_auprc_score: 0.9751; val_best_acc_score: 0.8925; val_best_f1_score: 0.9403; train_kl_reg_loss: 5769.7970; train_edge_recon_loss: 1007637.2396; train_gene_expr_recon_loss: 2077762.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3091169.0417; train_optim_loss: 3091169.0417; val_kl_reg_loss: 5896.3154; val_edge_recon_loss: 1135639.5000; val_gene_expr_recon_loss: 2041471.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3183007.2500; val_optim_loss: 3183007.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8779; val_auprc_score: 0.9743; val_best_acc_score: 0.8916; val_best_f1_score: 0.9397; train_kl_reg_loss: 6844.5097; train_edge_recon_loss: 1026812.7812; train_gene_expr_recon_loss: 2044727.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3078384.7917; train_optim_loss: 3078384.7917; val_kl_reg_loss: 7303.9331; val_edge_recon_loss: 1145354.6250; val_gene_expr_recon_loss: 2009947.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3162606.0000; val_optim_loss: 3162606.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8577; val_auprc_score: 0.9653; val_best_acc_score: 0.8937; val_best_f1_score: 0.9408; train_kl_reg_loss: 8105.8932; train_edge_recon_loss: 1029288.3854; train_gene_expr_recon_loss: 2011996.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3049390.6667; train_optim_loss: 3049390.6667; val_kl_reg_loss: 7421.1958; val_edge_recon_loss: 1122068.0000; val_gene_expr_recon_loss: 1981430.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3110920.0000; val_optim_loss: 3110920.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8534; val_auprc_score: 0.9697; val_best_acc_score: 0.8951; val_best_f1_score: 0.9416; train_kl_reg_loss: 7559.1379; train_edge_recon_loss: 1023203.3750; train_gene_expr_recon_loss: 1982328.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3013091.2917; train_optim_loss: 3013091.2917; val_kl_reg_loss: 6823.6128; val_edge_recon_loss: 1069668.6250; val_gene_expr_recon_loss: 1957383.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3033876.0000; val_optim_loss: 3033876.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8386; val_auprc_score: 0.9641; val_best_acc_score: 0.8929; val_best_f1_score: 0.9408; train_kl_reg_loss: 7400.7209; train_edge_recon_loss: 1009825.6667; train_gene_expr_recon_loss: 1957617.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2974844.3333; train_optim_loss: 2974844.3333; val_kl_reg_loss: 7306.6943; val_edge_recon_loss: 1021321.0000; val_gene_expr_recon_loss: 1936293.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2964920.7500; val_optim_loss: 2964920.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8251; val_auprc_score: 0.9602; val_best_acc_score: 0.8835; val_best_f1_score: 0.9351; train_kl_reg_loss: 8138.9303; train_edge_recon_loss: 974298.1667; train_gene_expr_recon_loss: 1940277.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2922714.5833; train_optim_loss: 2922714.5833; val_kl_reg_loss: 8325.2285; val_edge_recon_loss: 1069606.8750; val_gene_expr_recon_loss: 1916231.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2994163.5000; val_optim_loss: 2994163.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8349; val_auprc_score: 0.9640; val_best_acc_score: 0.8894; val_best_f1_score: 0.9386; train_kl_reg_loss: 9222.4103; train_edge_recon_loss: 970247.3021; train_gene_expr_recon_loss: 1917297.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2896766.9583; train_optim_loss: 2896766.9583; val_kl_reg_loss: 9738.7627; val_edge_recon_loss: 985715.0000; val_gene_expr_recon_loss: 1896544.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2891998.0000; val_optim_loss: 2891998.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7983; val_auprc_score: 0.9517; val_best_acc_score: 0.8803; val_best_f1_score: 0.9336; train_kl_reg_loss: 10449.4660; train_edge_recon_loss: 924599.9375; train_gene_expr_recon_loss: 1893985.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2829034.8333; train_optim_loss: 2829034.8333; val_kl_reg_loss: 9882.4648; val_edge_recon_loss: 1027774.0625; val_gene_expr_recon_loss: 1881035.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2918691.7500; val_optim_loss: 2918691.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8271; val_auprc_score: 0.9638; val_best_acc_score: 0.8948; val_best_f1_score: 0.9419; train_kl_reg_loss: 10320.4559; train_edge_recon_loss: 965809.1458; train_gene_expr_recon_loss: 1887683.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2863812.7917; train_optim_loss: 2863812.7917; val_kl_reg_loss: 10581.0547; val_edge_recon_loss: 927255.7500; val_gene_expr_recon_loss: 1866383.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804220.5000; val_optim_loss: 2804220.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7974; val_auprc_score: 0.9498; val_best_acc_score: 0.8896; val_best_f1_score: 0.9392; train_kl_reg_loss: 12105.0791; train_edge_recon_loss: 928043.8333; train_gene_expr_recon_loss: 1872634.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2812783.6667; train_optim_loss: 2812783.6667; val_kl_reg_loss: 12821.5156; val_edge_recon_loss: 936891.3750; val_gene_expr_recon_loss: 1853356.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2803069.5000; val_optim_loss: 2803069.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7996; val_auprc_score: 0.9564; val_best_acc_score: 0.8874; val_best_f1_score: 0.9381; train_kl_reg_loss: 13158.2549; train_edge_recon_loss: 921304.4792; train_gene_expr_recon_loss: 1853640.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2788103.0000; train_optim_loss: 2788103.0000; val_kl_reg_loss: 13124.9385; val_edge_recon_loss: 937174.5000; val_gene_expr_recon_loss: 1841854.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2792153.7500; val_optim_loss: 2792153.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8300; val_auprc_score: 0.9519; val_best_acc_score: 0.8811; val_best_f1_score: 0.9328; train_kl_reg_loss: 13175.0794; train_edge_recon_loss: 893479.7604; train_gene_expr_recon_loss: 1839125.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2745779.8333; train_optim_loss: 2745779.8333; val_kl_reg_loss: 12665.8721; val_edge_recon_loss: 1024634.2500; val_gene_expr_recon_loss: 1830953.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2868254.0000; val_optim_loss: 2868254.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8353; val_auprc_score: 0.9569; val_best_acc_score: 0.8866; val_best_f1_score: 0.9367; train_kl_reg_loss: 12840.6603; train_edge_recon_loss: 960087.2917; train_gene_expr_recon_loss: 1837240.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2810168.2500; train_optim_loss: 2810168.2500; val_kl_reg_loss: 12325.6074; val_edge_recon_loss: 982742.0000; val_gene_expr_recon_loss: 1821513.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2816581.0000; val_optim_loss: 2816581.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8326; val_auprc_score: 0.9519; val_best_acc_score: 0.8781; val_best_f1_score: 0.9312; train_kl_reg_loss: 12514.9634; train_edge_recon_loss: 886687.2292; train_gene_expr_recon_loss: 1825714.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2724916.5417; train_optim_loss: 2724916.5417; val_kl_reg_loss: 11919.7627; val_edge_recon_loss: 1048586.6250; val_gene_expr_recon_loss: 1813268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2873774.5000; val_optim_loss: 2873774.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8449; val_auprc_score: 0.9636; val_best_acc_score: 0.8843; val_best_f1_score: 0.9352; train_kl_reg_loss: 12093.5234; train_edge_recon_loss: 878873.6146; train_gene_expr_recon_loss: 1816388.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2707355.2500; train_optim_loss: 2707355.2500; val_kl_reg_loss: 11612.8779; val_edge_recon_loss: 985628.1250; val_gene_expr_recon_loss: 1805141.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2802382.2500; val_optim_loss: 2802382.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8737; val_auprc_score: 0.9751; val_best_acc_score: 0.8985; val_best_f1_score: 0.9438; train_kl_reg_loss: 11939.9541; train_edge_recon_loss: 890614.6562; train_gene_expr_recon_loss: 1814536.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2717091.3750; train_optim_loss: 2717091.3750; val_kl_reg_loss: 11473.6582; val_edge_recon_loss: 861269.6250; val_gene_expr_recon_loss: 1804436.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2677179.5000; val_optim_loss: 2677179.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8559; val_auprc_score: 0.9667; val_best_acc_score: 0.8925; val_best_f1_score: 0.9399; train_kl_reg_loss: 11721.6004; train_edge_recon_loss: 910519.7917; train_gene_expr_recon_loss: 1813470.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2735711.5833; train_optim_loss: 2735711.5833; val_kl_reg_loss: 11396.1113; val_edge_recon_loss: 914295.0000; val_gene_expr_recon_loss: 1804108.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2729799.5000; val_optim_loss: 2729799.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8420; val_auprc_score: 0.9673; val_best_acc_score: 0.8973; val_best_f1_score: 0.9434; train_kl_reg_loss: 11611.8151; train_edge_recon_loss: 888088.4479; train_gene_expr_recon_loss: 1812029.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2711729.7083; train_optim_loss: 2711729.7083; val_kl_reg_loss: 11261.4551; val_edge_recon_loss: 859033.6875; val_gene_expr_recon_loss: 1803501.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2673796.5000; val_optim_loss: 2673796.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8361; val_auprc_score: 0.9608; val_best_acc_score: 0.8836; val_best_f1_score: 0.9353; train_kl_reg_loss: 11604.6344; train_edge_recon_loss: 902050.3750; train_gene_expr_recon_loss: 1811029.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2724684.9583; train_optim_loss: 2724684.9583; val_kl_reg_loss: 11169.9844; val_edge_recon_loss: 955561.5000; val_gene_expr_recon_loss: 1802862.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2769594.2500; val_optim_loss: 2769594.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8911; val_auprc_score: 0.9797; val_best_acc_score: 0.9063; val_best_f1_score: 0.9482; train_kl_reg_loss: 11510.3667; train_edge_recon_loss: 913769.9792; train_gene_expr_recon_loss: 1810522.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2735802.7083; train_optim_loss: 2735802.7083; val_kl_reg_loss: 11128.8379; val_edge_recon_loss: 802932.5000; val_gene_expr_recon_loss: 1802360.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2616422.0000; val_optim_loss: 2616422.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8413; val_auprc_score: 0.9535; val_best_acc_score: 0.8925; val_best_f1_score: 0.9401; train_kl_reg_loss: 11475.3477; train_edge_recon_loss: 881326.8021; train_gene_expr_recon_loss: 1812097.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2704899.7083; train_optim_loss: 2704899.7083; val_kl_reg_loss: 11159.2617; val_edge_recon_loss: 914748.0625; val_gene_expr_recon_loss: 1801661.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2727569.2500; val_optim_loss: 2727569.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8462; val_auprc_score: 0.9597; val_best_acc_score: 0.9060; val_best_f1_score: 0.9478; train_kl_reg_loss: 11454.6792; train_edge_recon_loss: 892223.3438; train_gene_expr_recon_loss: 1810304.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2713982.2083; train_optim_loss: 2713982.2083; val_kl_reg_loss: 11146.3809; val_edge_recon_loss: 838050.3750; val_gene_expr_recon_loss: 1800901.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2650098.0000; val_optim_loss: 2650098.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8383; val_auprc_score: 0.9577; val_best_acc_score: 0.8836; val_best_f1_score: 0.9346; train_kl_reg_loss: 11463.2155; train_edge_recon_loss: 900180.5417; train_gene_expr_recon_loss: 1807291.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2718935.7500; train_optim_loss: 2718935.7500; val_kl_reg_loss: 11141.5625; val_edge_recon_loss: 991160.7500; val_gene_expr_recon_loss: 1800277.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2802579.7500; val_optim_loss: 2802579.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8598; val_auprc_score: 0.9629; val_best_acc_score: 0.8888; val_best_f1_score: 0.9372; train_kl_reg_loss: 11403.8822; train_edge_recon_loss: 887251.4062; train_gene_expr_recon_loss: 1805821.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2704477.0000; train_optim_loss: 2704477.0000; val_kl_reg_loss: 11051.2725; val_edge_recon_loss: 981363.3125; val_gene_expr_recon_loss: 1799600.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2792015.2500; val_optim_loss: 2792015.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8305; val_auprc_score: 0.9570; val_best_acc_score: 0.8901; val_best_f1_score: 0.9392; train_kl_reg_loss: 11426.5931; train_edge_recon_loss: 886655.5417; train_gene_expr_recon_loss: 1805776.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2703858.1667; train_optim_loss: 2703858.1667; val_kl_reg_loss: 11116.5449; val_edge_recon_loss: 911344.6875; val_gene_expr_recon_loss: 1799498.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2721959.2500; val_optim_loss: 2721959.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8376; val_auprc_score: 0.9603; val_best_acc_score: 0.8859; val_best_f1_score: 0.9368; train_kl_reg_loss: 11369.3966; train_edge_recon_loss: 876535.7708; train_gene_expr_recon_loss: 1797724.1042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2685629.3333; train_optim_loss: 2685629.3333; val_kl_reg_loss: 11055.7354; val_edge_recon_loss: 914120.0000; val_gene_expr_recon_loss: 1799393.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2724568.7500; val_optim_loss: 2724568.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8539; val_auprc_score: 0.9684; val_best_acc_score: 0.8959; val_best_f1_score: 0.9426; train_kl_reg_loss: 11417.8413; train_edge_recon_loss: 899178.5104; train_gene_expr_recon_loss: 1804264.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2714860.7917; train_optim_loss: 2714860.7917; val_kl_reg_loss: 11136.7832; val_edge_recon_loss: 838923.1875; val_gene_expr_recon_loss: 1799286.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2649346.7500; val_optim_loss: 2649346.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8579; val_auprc_score: 0.9654; val_best_acc_score: 0.8798; val_best_f1_score: 0.9325; train_kl_reg_loss: 11367.9025; train_edge_recon_loss: 881032.6875; train_gene_expr_recon_loss: 1807712.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2700112.9583; train_optim_loss: 2700112.9583; val_kl_reg_loss: 11037.1758; val_edge_recon_loss: 1008166.3750; val_gene_expr_recon_loss: 1799233.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2818436.5000; val_optim_loss: 2818436.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 34 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.8452
val AUPRC score: 0.9607
val best accuracy score: 0.8985
val best F1 score: 0.9438
val target rna MSE score: 1.4519
val source rna MSE score: 0.8330
Val cat covariate0 mean sim diff: -0.0254
Duration of model training in run 1: 0 hours, 0 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
