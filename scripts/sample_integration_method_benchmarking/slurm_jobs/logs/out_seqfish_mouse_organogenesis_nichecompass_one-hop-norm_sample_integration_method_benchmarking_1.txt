Run timestamp: 26062023_181550_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '6', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9716; val_auprc_score: 0.9750; val_best_acc_score: 0.8662; val_best_f1_score: 0.8789; train_kl_reg_loss: 241.1858; train_edge_recon_loss: 101727.4475; train_gene_expr_recon_loss: 136281.4129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238250.0469; train_optim_loss: 238250.0469; val_kl_reg_loss: 445.4407; val_edge_recon_loss: 119943.0938; val_gene_expr_recon_loss: 132608.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252997.1719; val_optim_loss: 252997.1719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9700; val_auprc_score: 0.9726; val_best_acc_score: 0.8723; val_best_f1_score: 0.8831; train_kl_reg_loss: 582.9317; train_edge_recon_loss: 101602.4420; train_gene_expr_recon_loss: 131181.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233366.6585; train_optim_loss: 233366.6585; val_kl_reg_loss: 806.8267; val_edge_recon_loss: 117904.1016; val_gene_expr_recon_loss: 127825.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246536.8750; val_optim_loss: 246536.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9575; val_auprc_score: 0.9585; val_best_acc_score: 0.8851; val_best_f1_score: 0.8837; train_kl_reg_loss: 924.8912; train_edge_recon_loss: 100588.5257; train_gene_expr_recon_loss: 126771.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228284.4732; train_optim_loss: 228284.4732; val_kl_reg_loss: 896.0356; val_edge_recon_loss: 109581.2891; val_gene_expr_recon_loss: 124160.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234637.6875; val_optim_loss: 234637.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9310; val_auprc_score: 0.9264; val_best_acc_score: 0.8544; val_best_f1_score: 0.8599; train_kl_reg_loss: 983.8454; train_edge_recon_loss: 98740.2132; train_gene_expr_recon_loss: 123797.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223521.9911; train_optim_loss: 223521.9911; val_kl_reg_loss: 1237.5776; val_edge_recon_loss: 99372.0312; val_gene_expr_recon_loss: 122326.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222935.9062; val_optim_loss: 222935.9062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9044; val_auprc_score: 0.8945; val_best_acc_score: 0.8280; val_best_f1_score: 0.8358; train_kl_reg_loss: 2124.4127; train_edge_recon_loss: 91710.0301; train_gene_expr_recon_loss: 122134.6886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215969.1295; train_optim_loss: 215969.1295; val_kl_reg_loss: 3422.1282; val_edge_recon_loss: 86043.0625; val_gene_expr_recon_loss: 121160.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210625.8281; val_optim_loss: 210625.8281
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9126; val_auprc_score: 0.9061; val_best_acc_score: 0.8350; val_best_f1_score: 0.8428; train_kl_reg_loss: 4469.5399; train_edge_recon_loss: 85246.7779; train_gene_expr_recon_loss: 120591.4520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210307.7701; train_optim_loss: 210307.7701; val_kl_reg_loss: 4889.7695; val_edge_recon_loss: 85625.6797; val_gene_expr_recon_loss: 119014.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209530.0938; val_optim_loss: 209530.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9218; val_auprc_score: 0.9173; val_best_acc_score: 0.8438; val_best_f1_score: 0.8534; train_kl_reg_loss: 4730.5807; train_edge_recon_loss: 84352.8605; train_gene_expr_recon_loss: 118358.6071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207442.0469; train_optim_loss: 207442.0469; val_kl_reg_loss: 4181.1616; val_edge_recon_loss: 84441.4297; val_gene_expr_recon_loss: 116814.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205437.1250; val_optim_loss: 205437.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9308; val_auprc_score: 0.9280; val_best_acc_score: 0.8548; val_best_f1_score: 0.8616; train_kl_reg_loss: 4377.4842; train_edge_recon_loss: 84380.2422; train_gene_expr_recon_loss: 116155.1808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204912.9062; train_optim_loss: 204912.9062; val_kl_reg_loss: 4402.5596; val_edge_recon_loss: 81507.1484; val_gene_expr_recon_loss: 114864.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200774.4062; val_optim_loss: 200774.4062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9343; val_auprc_score: 0.9327; val_best_acc_score: 0.8535; val_best_f1_score: 0.8602; train_kl_reg_loss: 4683.9216; train_edge_recon_loss: 83833.6607; train_gene_expr_recon_loss: 114369.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202887.4665; train_optim_loss: 202887.4665; val_kl_reg_loss: 4548.4600; val_edge_recon_loss: 82711.9531; val_gene_expr_recon_loss: 113325.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200586.2500; val_optim_loss: 200586.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9415; val_auprc_score: 0.9393; val_best_acc_score: 0.8630; val_best_f1_score: 0.8679; train_kl_reg_loss: 4646.3948; train_edge_recon_loss: 82701.2835; train_gene_expr_recon_loss: 112937.1808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200284.8616; train_optim_loss: 200284.8616; val_kl_reg_loss: 4366.8945; val_edge_recon_loss: 83097.0078; val_gene_expr_recon_loss: 111879.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199343.7188; val_optim_loss: 199343.7188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9473; val_auprc_score: 0.9458; val_best_acc_score: 0.8655; val_best_f1_score: 0.8702; train_kl_reg_loss: 4519.0259; train_edge_recon_loss: 82113.2366; train_gene_expr_recon_loss: 111447.7154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198079.9777; train_optim_loss: 198079.9777; val_kl_reg_loss: 4400.5059; val_edge_recon_loss: 80104.3750; val_gene_expr_recon_loss: 110409.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194914.6406; val_optim_loss: 194914.6406
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9533; val_auprc_score: 0.9522; val_best_acc_score: 0.8753; val_best_f1_score: 0.8786; train_kl_reg_loss: 4631.1294; train_edge_recon_loss: 81090.6194; train_gene_expr_recon_loss: 110044.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195765.9107; train_optim_loss: 195765.9107; val_kl_reg_loss: 4525.3291; val_edge_recon_loss: 81200.3359; val_gene_expr_recon_loss: 108967.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194693.5000; val_optim_loss: 194693.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9556; val_auprc_score: 0.9536; val_best_acc_score: 0.8776; val_best_f1_score: 0.8800; train_kl_reg_loss: 4729.7400; train_edge_recon_loss: 80454.3817; train_gene_expr_recon_loss: 108562.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193746.2723; train_optim_loss: 193746.2723; val_kl_reg_loss: 4640.7705; val_edge_recon_loss: 80386.2500; val_gene_expr_recon_loss: 107593.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192620.6875; val_optim_loss: 192620.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9602; val_auprc_score: 0.9589; val_best_acc_score: 0.8863; val_best_f1_score: 0.8887; train_kl_reg_loss: 4870.7011; train_edge_recon_loss: 81841.6484; train_gene_expr_recon_loss: 107324.2310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194036.5826; train_optim_loss: 194036.5826; val_kl_reg_loss: 4680.9502; val_edge_recon_loss: 80224.2969; val_gene_expr_recon_loss: 106348.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191254.2500; val_optim_loss: 191254.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9636; val_auprc_score: 0.9621; val_best_acc_score: 0.8910; val_best_f1_score: 0.8930; train_kl_reg_loss: 4878.8209; train_edge_recon_loss: 81575.7969; train_gene_expr_recon_loss: 106040.2076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192494.8259; train_optim_loss: 192494.8259; val_kl_reg_loss: 4697.1699; val_edge_recon_loss: 82845.6875; val_gene_expr_recon_loss: 105286.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192829.4219; val_optim_loss: 192829.4219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9671; val_auprc_score: 0.9659; val_best_acc_score: 0.8982; val_best_f1_score: 0.9010; train_kl_reg_loss: 4860.4305; train_edge_recon_loss: 80424.5815; train_gene_expr_recon_loss: 104951.4554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190236.4688; train_optim_loss: 190236.4688; val_kl_reg_loss: 4717.3286; val_edge_recon_loss: 81286.8672; val_gene_expr_recon_loss: 104265.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190269.8906; val_optim_loss: 190269.8906
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9695; val_auprc_score: 0.9686; val_best_acc_score: 0.9015; val_best_f1_score: 0.9043; train_kl_reg_loss: 4880.0809; train_edge_recon_loss: 81685.6172; train_gene_expr_recon_loss: 104033.9509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190599.6518; train_optim_loss: 190599.6518; val_kl_reg_loss: 4751.9868; val_edge_recon_loss: 78703.6250; val_gene_expr_recon_loss: 103440.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186896.0000; val_optim_loss: 186896.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9723; val_auprc_score: 0.9708; val_best_acc_score: 0.9092; val_best_f1_score: 0.9116; train_kl_reg_loss: 4887.2618; train_edge_recon_loss: 81270.1060; train_gene_expr_recon_loss: 103216.6038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189373.9688; train_optim_loss: 189373.9688; val_kl_reg_loss: 4633.9893; val_edge_recon_loss: 82667.3047; val_gene_expr_recon_loss: 102763.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190064.3438; val_optim_loss: 190064.3438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9754; val_auprc_score: 0.9736; val_best_acc_score: 0.9139; val_best_f1_score: 0.9152; train_kl_reg_loss: 4827.0710; train_edge_recon_loss: 80571.7723; train_gene_expr_recon_loss: 102539.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187938.2366; train_optim_loss: 187938.2366; val_kl_reg_loss: 4683.5410; val_edge_recon_loss: 79440.6016; val_gene_expr_recon_loss: 102074.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186198.8438; val_optim_loss: 186198.8438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9763; val_auprc_score: 0.9745; val_best_acc_score: 0.9179; val_best_f1_score: 0.9193; train_kl_reg_loss: 4789.0322; train_edge_recon_loss: 80976.0056; train_gene_expr_recon_loss: 101809.9464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187574.9888; train_optim_loss: 187574.9888; val_kl_reg_loss: 4660.9917; val_edge_recon_loss: 77443.1016; val_gene_expr_recon_loss: 101452.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183556.4219; val_optim_loss: 183556.4219
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9773; val_auprc_score: 0.9756; val_best_acc_score: 0.9179; val_best_f1_score: 0.9195; train_kl_reg_loss: 4815.5318; train_edge_recon_loss: 80559.8147; train_gene_expr_recon_loss: 101342.3962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186717.7411; train_optim_loss: 186717.7411; val_kl_reg_loss: 4556.4297; val_edge_recon_loss: 80894.5781; val_gene_expr_recon_loss: 100891.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186342.5000; val_optim_loss: 186342.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9790; val_auprc_score: 0.9770; val_best_acc_score: 0.9232; val_best_f1_score: 0.9247; train_kl_reg_loss: 4762.8790; train_edge_recon_loss: 80140.3516; train_gene_expr_recon_loss: 100724.9978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185628.2277; train_optim_loss: 185628.2277; val_kl_reg_loss: 4663.5254; val_edge_recon_loss: 79532.9375; val_gene_expr_recon_loss: 100423.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184619.9062; val_optim_loss: 184619.9062
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9801; val_auprc_score: 0.9785; val_best_acc_score: 0.9253; val_best_f1_score: 0.9268; train_kl_reg_loss: 4742.3595; train_edge_recon_loss: 79946.2723; train_gene_expr_recon_loss: 100296.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184984.8482; train_optim_loss: 184984.8482; val_kl_reg_loss: 4565.4473; val_edge_recon_loss: 80040.4453; val_gene_expr_recon_loss: 100057.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184663.5625; val_optim_loss: 184663.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9803; val_auprc_score: 0.9780; val_best_acc_score: 0.9263; val_best_f1_score: 0.9273; train_kl_reg_loss: 4735.3871; train_edge_recon_loss: 79751.4888; train_gene_expr_recon_loss: 99986.7054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184473.5848; train_optim_loss: 184473.5848; val_kl_reg_loss: 4576.4502; val_edge_recon_loss: 78154.9766; val_gene_expr_recon_loss: 99895.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182627.0781; val_optim_loss: 182627.0781
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9804; val_auprc_score: 0.9788; val_best_acc_score: 0.9267; val_best_f1_score: 0.9284; train_kl_reg_loss: 4726.4978; train_edge_recon_loss: 79496.3069; train_gene_expr_recon_loss: 99862.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184085.3125; train_optim_loss: 184085.3125; val_kl_reg_loss: 4555.3271; val_edge_recon_loss: 80279.5000; val_gene_expr_recon_loss: 99883.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184718.1562; val_optim_loss: 184718.1562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9810; val_auprc_score: 0.9793; val_best_acc_score: 0.9274; val_best_f1_score: 0.9288; train_kl_reg_loss: 4731.4677; train_edge_recon_loss: 80365.1842; train_gene_expr_recon_loss: 99872.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184969.1942; train_optim_loss: 184969.1942; val_kl_reg_loss: 4554.1538; val_edge_recon_loss: 79833.9219; val_gene_expr_recon_loss: 99898.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184286.6875; val_optim_loss: 184286.6875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9799; val_auprc_score: 0.9766; val_best_acc_score: 0.9264; val_best_f1_score: 0.9270; train_kl_reg_loss: 4735.0674; train_edge_recon_loss: 79971.0770; train_gene_expr_recon_loss: 99901.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184608.0670; train_optim_loss: 184608.0670; val_kl_reg_loss: 4501.2197; val_edge_recon_loss: 81178.5312; val_gene_expr_recon_loss: 99790.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185470.2500; val_optim_loss: 185470.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9810; val_auprc_score: 0.9794; val_best_acc_score: 0.9272; val_best_f1_score: 0.9280; train_kl_reg_loss: 4697.9471; train_edge_recon_loss: 80793.8136; train_gene_expr_recon_loss: 99784.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185276.4688; train_optim_loss: 185276.4688; val_kl_reg_loss: 4501.6885; val_edge_recon_loss: 78712.6719; val_gene_expr_recon_loss: 99791.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183005.8125; val_optim_loss: 183005.8125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9809; val_auprc_score: 0.9800; val_best_acc_score: 0.9275; val_best_f1_score: 0.9288; train_kl_reg_loss: 4696.1486; train_edge_recon_loss: 80027.8817; train_gene_expr_recon_loss: 99889.1417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184613.1696; train_optim_loss: 184613.1696; val_kl_reg_loss: 4508.1455; val_edge_recon_loss: 80076.9688; val_gene_expr_recon_loss: 99797.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184382.9531; val_optim_loss: 184382.9531
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9806; val_auprc_score: 0.9791; val_best_acc_score: 0.9274; val_best_f1_score: 0.9288; train_kl_reg_loss: 4693.2089; train_edge_recon_loss: 80177.5815; train_gene_expr_recon_loss: 99752.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184623.0625; train_optim_loss: 184623.0625; val_kl_reg_loss: 4504.8154; val_edge_recon_loss: 79418.8438; val_gene_expr_recon_loss: 99798.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183722.0625; val_optim_loss: 183722.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 0 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9806
Val AUPRC score: 0.9793
Val best accuracy score: 0.9269
Val best F1 score: 0.9283
Val gene expr MSE score: 1.4364
Duration of model training in run 1: 0 hours, 4 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9732; val_auprc_score: 0.9764; val_best_acc_score: 0.8805; val_best_f1_score: 0.8900; train_kl_reg_loss: 223.4992; train_edge_recon_loss: 101381.0647; train_gene_expr_recon_loss: 133440.3326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235044.8951; train_optim_loss: 235044.8951; val_kl_reg_loss: 453.8487; val_edge_recon_loss: 117480.0859; val_gene_expr_recon_loss: 129377.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247311.1562; val_optim_loss: 247311.1562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9693; val_auprc_score: 0.9722; val_best_acc_score: 0.8854; val_best_f1_score: 0.8929; train_kl_reg_loss: 539.2779; train_edge_recon_loss: 102884.9185; train_gene_expr_recon_loss: 128547.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231971.7031; train_optim_loss: 231971.7031; val_kl_reg_loss: 727.4012; val_edge_recon_loss: 114780.2578; val_gene_expr_recon_loss: 124783.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240290.9062; val_optim_loss: 240290.9062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9555; val_auprc_score: 0.9561; val_best_acc_score: 0.8823; val_best_f1_score: 0.8815; train_kl_reg_loss: 853.8359; train_edge_recon_loss: 101633.0603; train_gene_expr_recon_loss: 124333.8717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226820.7701; train_optim_loss: 226820.7701; val_kl_reg_loss: 807.9774; val_edge_recon_loss: 112374.4766; val_gene_expr_recon_loss: 121383.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234566.2812; val_optim_loss: 234566.2812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9324; val_auprc_score: 0.9276; val_best_acc_score: 0.8590; val_best_f1_score: 0.8643; train_kl_reg_loss: 946.6187; train_edge_recon_loss: 100102.4922; train_gene_expr_recon_loss: 121552.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222601.2991; train_optim_loss: 222601.2991; val_kl_reg_loss: 1261.4312; val_edge_recon_loss: 97481.7344; val_gene_expr_recon_loss: 119435.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218178.4375; val_optim_loss: 218178.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9056; val_auprc_score: 0.8957; val_best_acc_score: 0.8305; val_best_f1_score: 0.8403; train_kl_reg_loss: 2257.0950; train_edge_recon_loss: 91869.7444; train_gene_expr_recon_loss: 120102.2165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214229.0558; train_optim_loss: 214229.0558; val_kl_reg_loss: 3852.5076; val_edge_recon_loss: 86783.5547; val_gene_expr_recon_loss: 118417.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209053.2188; val_optim_loss: 209053.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9153; val_auprc_score: 0.9091; val_best_acc_score: 0.8399; val_best_f1_score: 0.8479; train_kl_reg_loss: 4921.1813; train_edge_recon_loss: 85436.5826; train_gene_expr_recon_loss: 118448.3404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208806.1027; train_optim_loss: 208806.1027; val_kl_reg_loss: 5166.1367; val_edge_recon_loss: 83859.3594; val_gene_expr_recon_loss: 115957.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204983.0781; val_optim_loss: 204983.0781
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9254; val_auprc_score: 0.9214; val_best_acc_score: 0.8482; val_best_f1_score: 0.8547; train_kl_reg_loss: 4853.9979; train_edge_recon_loss: 84399.4096; train_gene_expr_recon_loss: 115754.5201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205007.9263; train_optim_loss: 205007.9263; val_kl_reg_loss: 4265.8457; val_edge_recon_loss: 85354.5156; val_gene_expr_recon_loss: 113638.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203259.1406; val_optim_loss: 203259.1406
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9354; val_auprc_score: 0.9353; val_best_acc_score: 0.8562; val_best_f1_score: 0.8611; train_kl_reg_loss: 4489.7847; train_edge_recon_loss: 84540.8516; train_gene_expr_recon_loss: 113567.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202597.9107; train_optim_loss: 202597.9107; val_kl_reg_loss: 4547.6504; val_edge_recon_loss: 85596.8984; val_gene_expr_recon_loss: 111710.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201854.6562; val_optim_loss: 201854.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9413; val_auprc_score: 0.9399; val_best_acc_score: 0.8654; val_best_f1_score: 0.8686; train_kl_reg_loss: 4689.3230; train_edge_recon_loss: 83071.7388; train_gene_expr_recon_loss: 111984.5525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199745.6138; train_optim_loss: 199745.6138; val_kl_reg_loss: 4407.9307; val_edge_recon_loss: 82878.0859; val_gene_expr_recon_loss: 110346.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197632.5938; val_optim_loss: 197632.5938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9472; val_auprc_score: 0.9457; val_best_acc_score: 0.8721; val_best_f1_score: 0.8741; train_kl_reg_loss: 4530.3665; train_edge_recon_loss: 82677.4498; train_gene_expr_recon_loss: 110515.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197723.7299; train_optim_loss: 197723.7299; val_kl_reg_loss: 4412.5791; val_edge_recon_loss: 81691.9688; val_gene_expr_recon_loss: 109019.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195124.1875; val_optim_loss: 195124.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9566; val_auprc_score: 0.9548; val_best_acc_score: 0.8823; val_best_f1_score: 0.8844; train_kl_reg_loss: 4597.6262; train_edge_recon_loss: 82421.6116; train_gene_expr_recon_loss: 109218.2355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196237.4777; train_optim_loss: 196237.4777; val_kl_reg_loss: 4435.4971; val_edge_recon_loss: 79978.1797; val_gene_expr_recon_loss: 107668.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192082.3438; val_optim_loss: 192082.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9579; val_auprc_score: 0.9565; val_best_acc_score: 0.8843; val_best_f1_score: 0.8868; train_kl_reg_loss: 4591.9803; train_edge_recon_loss: 82080.3393; train_gene_expr_recon_loss: 107890.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194563.3125; train_optim_loss: 194563.3125; val_kl_reg_loss: 4556.4233; val_edge_recon_loss: 81242.4844; val_gene_expr_recon_loss: 106439.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192238.7656; val_optim_loss: 192238.7656
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9622; val_auprc_score: 0.9613; val_best_acc_score: 0.8902; val_best_f1_score: 0.8918; train_kl_reg_loss: 4763.7353; train_edge_recon_loss: 81216.6417; train_gene_expr_recon_loss: 106677.2199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192657.5960; train_optim_loss: 192657.5960; val_kl_reg_loss: 4623.0967; val_edge_recon_loss: 82471.6797; val_gene_expr_recon_loss: 105239.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192334.0312; val_optim_loss: 192334.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9654; val_auprc_score: 0.9631; val_best_acc_score: 0.8964; val_best_f1_score: 0.8980; train_kl_reg_loss: 4729.9478; train_edge_recon_loss: 80295.4900; train_gene_expr_recon_loss: 105434.7723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190460.2098; train_optim_loss: 190460.2098; val_kl_reg_loss: 4587.2910; val_edge_recon_loss: 81103.5000; val_gene_expr_recon_loss: 104084.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189775.3125; val_optim_loss: 189775.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9682; val_auprc_score: 0.9671; val_best_acc_score: 0.8990; val_best_f1_score: 0.9007; train_kl_reg_loss: 4797.6304; train_edge_recon_loss: 81327.0335; train_gene_expr_recon_loss: 104507.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190632.2634; train_optim_loss: 190632.2634; val_kl_reg_loss: 4633.8350; val_edge_recon_loss: 80859.7500; val_gene_expr_recon_loss: 103196.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188690.4375; val_optim_loss: 188690.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9708; val_auprc_score: 0.9683; val_best_acc_score: 0.9065; val_best_f1_score: 0.9083; train_kl_reg_loss: 4761.2595; train_edge_recon_loss: 80920.0435; train_gene_expr_recon_loss: 103464.4888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189145.7924; train_optim_loss: 189145.7924; val_kl_reg_loss: 4608.0938; val_edge_recon_loss: 83552.0156; val_gene_expr_recon_loss: 102346.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190507.0312; val_optim_loss: 190507.0312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9753; val_auprc_score: 0.9749; val_best_acc_score: 0.9150; val_best_f1_score: 0.9161; train_kl_reg_loss: 4771.2772; train_edge_recon_loss: 79356.8940; train_gene_expr_recon_loss: 102751.3181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186879.4888; train_optim_loss: 186879.4888; val_kl_reg_loss: 4535.2695; val_edge_recon_loss: 80629.4453; val_gene_expr_recon_loss: 101513.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186678.3438; val_optim_loss: 186678.3438
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9764; val_auprc_score: 0.9756; val_best_acc_score: 0.9181; val_best_f1_score: 0.9188; train_kl_reg_loss: 4725.5441; train_edge_recon_loss: 80715.3929; train_gene_expr_recon_loss: 102008.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187449.7433; train_optim_loss: 187449.7433; val_kl_reg_loss: 4582.4536; val_edge_recon_loss: 80043.1016; val_gene_expr_recon_loss: 100856.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185482.1250; val_optim_loss: 185482.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9773; val_auprc_score: 0.9749; val_best_acc_score: 0.9201; val_best_f1_score: 0.9208; train_kl_reg_loss: 4684.5834; train_edge_recon_loss: 80049.7109; train_gene_expr_recon_loss: 101427.1083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186161.4040; train_optim_loss: 186161.4040; val_kl_reg_loss: 4491.8926; val_edge_recon_loss: 81038.9453; val_gene_expr_recon_loss: 100283.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185814.4688; val_optim_loss: 185814.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9789; val_auprc_score: 0.9769; val_best_acc_score: 0.9237; val_best_f1_score: 0.9247; train_kl_reg_loss: 4680.3863; train_edge_recon_loss: 80134.6696; train_gene_expr_recon_loss: 100780.8382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185595.8929; train_optim_loss: 185595.8929; val_kl_reg_loss: 4461.8813; val_edge_recon_loss: 79797.1562; val_gene_expr_recon_loss: 99722.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183981.1250; val_optim_loss: 183981.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9814; val_auprc_score: 0.9800; val_best_acc_score: 0.9287; val_best_f1_score: 0.9286; train_kl_reg_loss: 4630.2784; train_edge_recon_loss: 79280.2824; train_gene_expr_recon_loss: 100245.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184156.4085; train_optim_loss: 184156.4085; val_kl_reg_loss: 4453.1670; val_edge_recon_loss: 81729.8828; val_gene_expr_recon_loss: 99199.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185382.4062; val_optim_loss: 185382.4062
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9818; val_auprc_score: 0.9788; val_best_acc_score: 0.9308; val_best_f1_score: 0.9312; train_kl_reg_loss: 4593.2254; train_edge_recon_loss: 80277.3092; train_gene_expr_recon_loss: 99691.5904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184562.1228; train_optim_loss: 184562.1228; val_kl_reg_loss: 4521.4502; val_edge_recon_loss: 78469.0625; val_gene_expr_recon_loss: 98762.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181753.1094; val_optim_loss: 181753.1094
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9826; val_auprc_score: 0.9812; val_best_acc_score: 0.9324; val_best_f1_score: 0.9330; train_kl_reg_loss: 4604.2772; train_edge_recon_loss: 79463.7757; train_gene_expr_recon_loss: 99202.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183270.1763; train_optim_loss: 183270.1763; val_kl_reg_loss: 4422.8955; val_edge_recon_loss: 78156.9297; val_gene_expr_recon_loss: 98227.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180807.2812; val_optim_loss: 180807.2812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9817; val_auprc_score: 0.9780; val_best_acc_score: 0.9322; val_best_f1_score: 0.9332; train_kl_reg_loss: 4606.2356; train_edge_recon_loss: 80309.2556; train_gene_expr_recon_loss: 98872.1295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183787.6205; train_optim_loss: 183787.6205; val_kl_reg_loss: 4371.6318; val_edge_recon_loss: 78961.3359; val_gene_expr_recon_loss: 97918.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181251.2969; val_optim_loss: 181251.2969
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9835; val_auprc_score: 0.9819; val_best_acc_score: 0.9345; val_best_f1_score: 0.9355; train_kl_reg_loss: 4527.0716; train_edge_recon_loss: 79104.9040; train_gene_expr_recon_loss: 98504.6395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182136.6161; train_optim_loss: 182136.6161; val_kl_reg_loss: 4391.9902; val_edge_recon_loss: 80304.5859; val_gene_expr_recon_loss: 97477.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182174.5312; val_optim_loss: 182174.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9843; val_auprc_score: 0.9819; val_best_acc_score: 0.9374; val_best_f1_score: 0.9378; train_kl_reg_loss: 4509.9587; train_edge_recon_loss: 79513.8717; train_gene_expr_recon_loss: 98125.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182148.9062; train_optim_loss: 182148.9062; val_kl_reg_loss: 4320.7119; val_edge_recon_loss: 78888.1484; val_gene_expr_recon_loss: 97245.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180454.5781; val_optim_loss: 180454.5781
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9852; val_auprc_score: 0.9828; val_best_acc_score: 0.9395; val_best_f1_score: 0.9404; train_kl_reg_loss: 4482.2183; train_edge_recon_loss: 79056.4408; train_gene_expr_recon_loss: 97829.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181368.4487; train_optim_loss: 181368.4487; val_kl_reg_loss: 4289.3574; val_edge_recon_loss: 77691.0000; val_gene_expr_recon_loss: 96871.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178852.2500; val_optim_loss: 178852.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9861; val_auprc_score: 0.9848; val_best_acc_score: 0.9406; val_best_f1_score: 0.9415; train_kl_reg_loss: 4445.0673; train_edge_recon_loss: 78701.4844; train_gene_expr_recon_loss: 97529.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180676.1161; train_optim_loss: 180676.1161; val_kl_reg_loss: 4290.0732; val_edge_recon_loss: 79742.8906; val_gene_expr_recon_loss: 96577.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180610.1406; val_optim_loss: 180610.1406
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9855; val_auprc_score: 0.9837; val_best_acc_score: 0.9398; val_best_f1_score: 0.9407; train_kl_reg_loss: 4434.5868; train_edge_recon_loss: 78863.9230; train_gene_expr_recon_loss: 97248.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180546.5223; train_optim_loss: 180546.5223; val_kl_reg_loss: 4238.3862; val_edge_recon_loss: 79183.1562; val_gene_expr_recon_loss: 96254.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179675.9062; val_optim_loss: 179675.9062
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9863; val_auprc_score: 0.9839; val_best_acc_score: 0.9429; val_best_f1_score: 0.9437; train_kl_reg_loss: 4407.3279; train_edge_recon_loss: 79532.8047; train_gene_expr_recon_loss: 96908.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180848.7076; train_optim_loss: 180848.7076; val_kl_reg_loss: 4221.7314; val_edge_recon_loss: 80775.4531; val_gene_expr_recon_loss: 95997.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180994.4688; val_optim_loss: 180994.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9867; val_auprc_score: 0.9858; val_best_acc_score: 0.9424; val_best_f1_score: 0.9433; train_kl_reg_loss: 4369.3456; train_edge_recon_loss: 78995.1853; train_gene_expr_recon_loss: 96677.3839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180041.9152; train_optim_loss: 180041.9152; val_kl_reg_loss: 4224.4688; val_edge_recon_loss: 77959.3047; val_gene_expr_recon_loss: 95928.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178112.0156; val_optim_loss: 178112.0156
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9870; val_auprc_score: 0.9855; val_best_acc_score: 0.9447; val_best_f1_score: 0.9454; train_kl_reg_loss: 4371.0455; train_edge_recon_loss: 78898.0112; train_gene_expr_recon_loss: 96733.2946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180002.3504; train_optim_loss: 180002.3504; val_kl_reg_loss: 4232.9229; val_edge_recon_loss: 79011.4844; val_gene_expr_recon_loss: 95898.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179142.5625; val_optim_loss: 179142.5625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9865; val_auprc_score: 0.9847; val_best_acc_score: 0.9440; val_best_f1_score: 0.9447; train_kl_reg_loss: 4366.3470; train_edge_recon_loss: 78800.3571; train_gene_expr_recon_loss: 96586.5770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179753.2790; train_optim_loss: 179753.2790; val_kl_reg_loss: 4228.9443; val_edge_recon_loss: 77171.5000; val_gene_expr_recon_loss: 95881.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177281.6250; val_optim_loss: 177281.6250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9863; val_auprc_score: 0.9836; val_best_acc_score: 0.9415; val_best_f1_score: 0.9421; train_kl_reg_loss: 4381.5727; train_edge_recon_loss: 78465.8661; train_gene_expr_recon_loss: 96568.8025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179416.2455; train_optim_loss: 179416.2455; val_kl_reg_loss: 4237.1792; val_edge_recon_loss: 79371.8203; val_gene_expr_recon_loss: 95836.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179445.4062; val_optim_loss: 179445.4062
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9862; val_auprc_score: 0.9840; val_best_acc_score: 0.9427; val_best_f1_score: 0.9436; train_kl_reg_loss: 4380.7627; train_edge_recon_loss: 78831.0692; train_gene_expr_recon_loss: 96547.3962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179759.2277; train_optim_loss: 179759.2277; val_kl_reg_loss: 4226.9688; val_edge_recon_loss: 82575.9922; val_gene_expr_recon_loss: 95830.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182633.7812; val_optim_loss: 182633.7812
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9866; val_auprc_score: 0.9855; val_best_acc_score: 0.9426; val_best_f1_score: 0.9434; train_kl_reg_loss: 4364.7125; train_edge_recon_loss: 78979.3951; train_gene_expr_recon_loss: 96541.4230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179885.5312; train_optim_loss: 179885.5312; val_kl_reg_loss: 4215.7817; val_edge_recon_loss: 78548.2891; val_gene_expr_recon_loss: 95779.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178543.7188; val_optim_loss: 178543.7188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9864; val_auprc_score: 0.9845; val_best_acc_score: 0.9428; val_best_f1_score: 0.9437; train_kl_reg_loss: 4359.1757; train_edge_recon_loss: 78574.2578; train_gene_expr_recon_loss: 96483.2433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179416.6808; train_optim_loss: 179416.6808; val_kl_reg_loss: 4219.3848; val_edge_recon_loss: 79409.4922; val_gene_expr_recon_loss: 95779.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179408.2656; val_optim_loss: 179408.2656
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9869; val_auprc_score: 0.9845; val_best_acc_score: 0.9446; val_best_f1_score: 0.9453; train_kl_reg_loss: 4359.1062; train_edge_recon_loss: 78631.5435; train_gene_expr_recon_loss: 96418.7902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179409.4397; train_optim_loss: 179409.4397; val_kl_reg_loss: 4220.6758; val_edge_recon_loss: 79598.1797; val_gene_expr_recon_loss: 95776.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179595.2500; val_optim_loss: 179595.2500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9867; val_auprc_score: 0.9843; val_best_acc_score: 0.9442; val_best_f1_score: 0.9450; train_kl_reg_loss: 4362.4225; train_edge_recon_loss: 78537.9621; train_gene_expr_recon_loss: 96472.0904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179372.4754; train_optim_loss: 179372.4754; val_kl_reg_loss: 4217.2036; val_edge_recon_loss: 79202.6406; val_gene_expr_recon_loss: 95773.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179193.6250; val_optim_loss: 179193.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 26 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9863
Val AUPRC score: 0.9838
Val best accuracy score: 0.9422
Val best F1 score: 0.9431
Val gene expr MSE score: 1.3058
Duration of model training in run 2: 0 hours, 5 minutes and 31 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9866; val_auprc_score: 0.9880; val_best_acc_score: 0.8623; val_best_f1_score: 0.8659; train_kl_reg_loss: 340.8482; train_edge_recon_loss: 102366.7751; train_gene_expr_recon_loss: 134589.9035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237297.5290; train_optim_loss: 237297.5290; val_kl_reg_loss: 643.7044; val_edge_recon_loss: 119760.5859; val_gene_expr_recon_loss: 128538.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248942.5859; val_optim_loss: 248942.5859
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9608; val_auprc_score: 0.9613; val_best_acc_score: 0.8912; val_best_f1_score: 0.8944; train_kl_reg_loss: 893.7530; train_edge_recon_loss: 101715.9833; train_gene_expr_recon_loss: 126042.3744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228652.1083; train_optim_loss: 228652.1083; val_kl_reg_loss: 960.3412; val_edge_recon_loss: 106025.8516; val_gene_expr_recon_loss: 122442.7227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229428.9141; val_optim_loss: 229428.9141
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9271; val_auprc_score: 0.9246; val_best_acc_score: 0.8478; val_best_f1_score: 0.8538; train_kl_reg_loss: 2371.3338; train_edge_recon_loss: 91819.1060; train_gene_expr_recon_loss: 121913.9877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216104.4286; train_optim_loss: 216104.4286; val_kl_reg_loss: 4657.2695; val_edge_recon_loss: 85415.5352; val_gene_expr_recon_loss: 120146.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210219.0000; val_optim_loss: 210219.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9428; val_auprc_score: 0.9412; val_best_acc_score: 0.8656; val_best_f1_score: 0.8695; train_kl_reg_loss: 4714.9228; train_edge_recon_loss: 83567.6936; train_gene_expr_recon_loss: 118293.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206576.4062; train_optim_loss: 206576.4062; val_kl_reg_loss: 4247.7158; val_edge_recon_loss: 82387.9336; val_gene_expr_recon_loss: 115507.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202143.0625; val_optim_loss: 202143.0625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9526; val_auprc_score: 0.9525; val_best_acc_score: 0.8783; val_best_f1_score: 0.8802; train_kl_reg_loss: 4588.3259; train_edge_recon_loss: 82823.9637; train_gene_expr_recon_loss: 114624.9369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202037.2288; train_optim_loss: 202037.2288; val_kl_reg_loss: 4448.5295; val_edge_recon_loss: 80991.2344; val_gene_expr_recon_loss: 112889.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198328.9844; val_optim_loss: 198328.9844
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9633; val_auprc_score: 0.9623; val_best_acc_score: 0.8945; val_best_f1_score: 0.8959; train_kl_reg_loss: 4575.8175; train_edge_recon_loss: 82407.4280; train_gene_expr_recon_loss: 111639.1842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198622.4308; train_optim_loss: 198622.4308; val_kl_reg_loss: 4459.4678; val_edge_recon_loss: 79994.4102; val_gene_expr_recon_loss: 109598.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194052.8125; val_optim_loss: 194052.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9704; val_auprc_score: 0.9692; val_best_acc_score: 0.9048; val_best_f1_score: 0.9062; train_kl_reg_loss: 4640.6850; train_edge_recon_loss: 81707.7171; train_gene_expr_recon_loss: 108897.2444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195245.6473; train_optim_loss: 195245.6473; val_kl_reg_loss: 4606.7432; val_edge_recon_loss: 80838.9844; val_gene_expr_recon_loss: 106714.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192160.1719; val_optim_loss: 192160.1719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9756; val_auprc_score: 0.9752; val_best_acc_score: 0.9140; val_best_f1_score: 0.9146; train_kl_reg_loss: 4771.8668; train_edge_recon_loss: 81046.0084; train_gene_expr_recon_loss: 106510.0134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192327.8873; train_optim_loss: 192327.8873; val_kl_reg_loss: 4769.6777; val_edge_recon_loss: 80844.2344; val_gene_expr_recon_loss: 104986.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190600.1016; val_optim_loss: 190600.1016
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9793; val_auprc_score: 0.9787; val_best_acc_score: 0.9231; val_best_f1_score: 0.9241; train_kl_reg_loss: 4816.7724; train_edge_recon_loss: 81012.8544; train_gene_expr_recon_loss: 104637.2679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190466.8951; train_optim_loss: 190466.8951; val_kl_reg_loss: 4692.9668; val_edge_recon_loss: 80096.6328; val_gene_expr_recon_loss: 102909.8711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187699.4688; val_optim_loss: 187699.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9825; val_best_acc_score: 0.9324; val_best_f1_score: 0.9335; train_kl_reg_loss: 4715.0755; train_edge_recon_loss: 80083.4029; train_gene_expr_recon_loss: 103237.9241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188036.4018; train_optim_loss: 188036.4018; val_kl_reg_loss: 4558.0618; val_edge_recon_loss: 78992.1875; val_gene_expr_recon_loss: 102318.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185868.4531; val_optim_loss: 185868.4531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9859; val_auprc_score: 0.9851; val_best_acc_score: 0.9401; val_best_f1_score: 0.9406; train_kl_reg_loss: 4633.5384; train_edge_recon_loss: 80062.2807; train_gene_expr_recon_loss: 102012.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186708.2277; train_optim_loss: 186708.2277; val_kl_reg_loss: 4493.3862; val_edge_recon_loss: 77514.9102; val_gene_expr_recon_loss: 100595.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182603.6172; val_optim_loss: 182603.6172
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9879; val_auprc_score: 0.9871; val_best_acc_score: 0.9443; val_best_f1_score: 0.9446; train_kl_reg_loss: 4630.8354; train_edge_recon_loss: 79996.5670; train_gene_expr_recon_loss: 101051.1283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185678.5324; train_optim_loss: 185678.5324; val_kl_reg_loss: 4515.2595; val_edge_recon_loss: 78649.1172; val_gene_expr_recon_loss: 100304.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183468.5781; val_optim_loss: 183468.5781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9879; val_auprc_score: 0.9868; val_best_acc_score: 0.9451; val_best_f1_score: 0.9462; train_kl_reg_loss: 4579.7890; train_edge_recon_loss: 78897.1205; train_gene_expr_recon_loss: 100299.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183776.4375; train_optim_loss: 183776.4375; val_kl_reg_loss: 4428.0195; val_edge_recon_loss: 80279.1992; val_gene_expr_recon_loss: 99558.0742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184265.2969; val_optim_loss: 184265.2969
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9481; val_best_f1_score: 0.9486; train_kl_reg_loss: 4536.6046; train_edge_recon_loss: 79712.0162; train_gene_expr_recon_loss: 99508.7567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183757.3783; train_optim_loss: 183757.3783; val_kl_reg_loss: 4426.5449; val_edge_recon_loss: 79875.3398; val_gene_expr_recon_loss: 98591.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182893.8281; val_optim_loss: 182893.8281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9896; val_auprc_score: 0.9886; val_best_acc_score: 0.9498; val_best_f1_score: 0.9502; train_kl_reg_loss: 4493.6629; train_edge_recon_loss: 79392.5140; train_gene_expr_recon_loss: 99086.4838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182972.6607; train_optim_loss: 182972.6607; val_kl_reg_loss: 4353.4604; val_edge_recon_loss: 78190.9180; val_gene_expr_recon_loss: 98262.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180806.4844; val_optim_loss: 180806.4844
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9893; val_auprc_score: 0.9880; val_best_acc_score: 0.9483; val_best_f1_score: 0.9488; train_kl_reg_loss: 4472.8704; train_edge_recon_loss: 79004.7561; train_gene_expr_recon_loss: 99093.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182570.8839; train_optim_loss: 182570.8839; val_kl_reg_loss: 4361.6506; val_edge_recon_loss: 80997.6289; val_gene_expr_recon_loss: 98430.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183790.1406; val_optim_loss: 183790.1406
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9895; val_auprc_score: 0.9885; val_best_acc_score: 0.9483; val_best_f1_score: 0.9488; train_kl_reg_loss: 4473.0684; train_edge_recon_loss: 79297.5050; train_gene_expr_recon_loss: 98906.3175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182676.8929; train_optim_loss: 182676.8929; val_kl_reg_loss: 4352.8169; val_edge_recon_loss: 78555.2305; val_gene_expr_recon_loss: 98182.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181090.4844; val_optim_loss: 181090.4844
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9897; val_auprc_score: 0.9886; val_best_acc_score: 0.9490; val_best_f1_score: 0.9495; train_kl_reg_loss: 4464.8803; train_edge_recon_loss: 79536.8242; train_gene_expr_recon_loss: 98959.2684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182960.9710; train_optim_loss: 182960.9710; val_kl_reg_loss: 4366.9724; val_edge_recon_loss: 77646.5195; val_gene_expr_recon_loss: 98020.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180033.6562; val_optim_loss: 180033.6562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9894; val_auprc_score: 0.9883; val_best_acc_score: 0.9480; val_best_f1_score: 0.9485; train_kl_reg_loss: 4469.6529; train_edge_recon_loss: 79321.8131; train_gene_expr_recon_loss: 98960.9275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182752.3906; train_optim_loss: 182752.3906; val_kl_reg_loss: 4335.9424; val_edge_recon_loss: 78228.3320; val_gene_expr_recon_loss: 98172.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180737.0312; val_optim_loss: 180737.0312
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9897; val_auprc_score: 0.9886; val_best_acc_score: 0.9496; val_best_f1_score: 0.9500; train_kl_reg_loss: 4461.6511; train_edge_recon_loss: 79582.2109; train_gene_expr_recon_loss: 98875.0502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182918.9107; train_optim_loss: 182918.9107; val_kl_reg_loss: 4356.4644; val_edge_recon_loss: 78524.2617; val_gene_expr_recon_loss: 98060.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180941.2344; val_optim_loss: 180941.2344
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9896; val_auprc_score: 0.9883; val_best_acc_score: 0.9496; val_best_f1_score: 0.9501; train_kl_reg_loss: 4460.4338; train_edge_recon_loss: 78537.2494; train_gene_expr_recon_loss: 98681.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181678.9286; train_optim_loss: 181678.9286; val_kl_reg_loss: 4313.3269; val_edge_recon_loss: 79529.0039; val_gene_expr_recon_loss: 97845.6055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181687.9375; val_optim_loss: 181687.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9902; val_auprc_score: 0.9895; val_best_acc_score: 0.9508; val_best_f1_score: 0.9511; train_kl_reg_loss: 4420.9923; train_edge_recon_loss: 79976.2935; train_gene_expr_recon_loss: 98642.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183039.8504; train_optim_loss: 183039.8504; val_kl_reg_loss: 4318.4602; val_edge_recon_loss: 77150.4375; val_gene_expr_recon_loss: 97780.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179249.7266; val_optim_loss: 179249.7266
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9897; val_auprc_score: 0.9889; val_best_acc_score: 0.9502; val_best_f1_score: 0.9509; train_kl_reg_loss: 4431.8787; train_edge_recon_loss: 79548.1451; train_gene_expr_recon_loss: 98737.1217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182717.1429; train_optim_loss: 182717.1429; val_kl_reg_loss: 4338.4058; val_edge_recon_loss: 78301.9727; val_gene_expr_recon_loss: 99091.9102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181732.2891; val_optim_loss: 181732.2891
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9900; val_auprc_score: 0.9889; val_best_acc_score: 0.9510; val_best_f1_score: 0.9514; train_kl_reg_loss: 4442.2773; train_edge_recon_loss: 79638.2840; train_gene_expr_recon_loss: 98686.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182766.7779; train_optim_loss: 182766.7779; val_kl_reg_loss: 4368.3374; val_edge_recon_loss: 77997.3086; val_gene_expr_recon_loss: 98883.8164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181249.4609; val_optim_loss: 181249.4609
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9896; val_auprc_score: 0.9885; val_best_acc_score: 0.9508; val_best_f1_score: 0.9511; train_kl_reg_loss: 4451.6850; train_edge_recon_loss: 79323.0391; train_gene_expr_recon_loss: 98782.6356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182557.3583; train_optim_loss: 182557.3583; val_kl_reg_loss: 4347.3169; val_edge_recon_loss: 80464.2969; val_gene_expr_recon_loss: 97915.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182726.8281; val_optim_loss: 182726.8281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9898; val_auprc_score: 0.9888; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 4454.0731; train_edge_recon_loss: 79760.8945; train_gene_expr_recon_loss: 98764.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182979.6975; train_optim_loss: 182979.6975; val_kl_reg_loss: 4302.2271; val_edge_recon_loss: 81491.4844; val_gene_expr_recon_loss: 98261.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184055.0156; val_optim_loss: 184055.0156
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9903; val_auprc_score: 0.9899; val_best_acc_score: 0.9511; val_best_f1_score: 0.9517; train_kl_reg_loss: 4451.0352; train_edge_recon_loss: 79266.3689; train_gene_expr_recon_loss: 98756.2623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182473.6652; train_optim_loss: 182473.6652; val_kl_reg_loss: 4305.5977; val_edge_recon_loss: 79019.7617; val_gene_expr_recon_loss: 98089.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181414.8125; val_optim_loss: 181414.8125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9894; val_auprc_score: 0.9882; val_best_acc_score: 0.9489; val_best_f1_score: 0.9494; train_kl_reg_loss: 4452.8571; train_edge_recon_loss: 78800.8343; train_gene_expr_recon_loss: 98729.0396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181982.7321; train_optim_loss: 181982.7321; val_kl_reg_loss: 4308.4287; val_edge_recon_loss: 81285.2383; val_gene_expr_recon_loss: 98447.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184040.7734; val_optim_loss: 184040.7734

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 18 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9898
Val AUPRC score: 0.9885
Val best accuracy score: 0.9493
Val best F1 score: 0.9498
Val gene expr MSE score: 1.3687
Duration of model training in run 3: 0 hours, 7 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9840; val_auprc_score: 0.9860; val_best_acc_score: 0.8656; val_best_f1_score: 0.8633; train_kl_reg_loss: 367.3997; train_edge_recon_loss: 101959.2729; train_gene_expr_recon_loss: 132749.0084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235075.6819; train_optim_loss: 235075.6819; val_kl_reg_loss: 761.9038; val_edge_recon_loss: 116154.1289; val_gene_expr_recon_loss: 128202.6992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245118.7344; val_optim_loss: 245118.7344
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9524; val_auprc_score: 0.9510; val_best_acc_score: 0.8807; val_best_f1_score: 0.8831; train_kl_reg_loss: 903.4578; train_edge_recon_loss: 100430.9397; train_gene_expr_recon_loss: 125536.3025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226870.6998; train_optim_loss: 226870.6998; val_kl_reg_loss: 1084.1322; val_edge_recon_loss: 97761.1758; val_gene_expr_recon_loss: 123146.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221992.2422; val_optim_loss: 221992.2422
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9264; val_auprc_score: 0.9241; val_best_acc_score: 0.8460; val_best_f1_score: 0.8508; train_kl_reg_loss: 3112.3882; train_edge_recon_loss: 90069.6574; train_gene_expr_recon_loss: 121722.7048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214904.7511; train_optim_loss: 214904.7511; val_kl_reg_loss: 5187.7920; val_edge_recon_loss: 84432.3711; val_gene_expr_recon_loss: 119906.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209527.1406; val_optim_loss: 209527.1406
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9441; val_auprc_score: 0.9440; val_best_acc_score: 0.8663; val_best_f1_score: 0.8698; train_kl_reg_loss: 4704.1490; train_edge_recon_loss: 83747.5095; train_gene_expr_recon_loss: 118195.1317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206646.7913; train_optim_loss: 206646.7913; val_kl_reg_loss: 4213.4897; val_edge_recon_loss: 83217.1406; val_gene_expr_recon_loss: 116593.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204024.4219; val_optim_loss: 204024.4219
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9559; val_auprc_score: 0.9555; val_best_acc_score: 0.8821; val_best_f1_score: 0.8849; train_kl_reg_loss: 4549.9741; train_edge_recon_loss: 83718.2377; train_gene_expr_recon_loss: 114657.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202925.5926; train_optim_loss: 202925.5926; val_kl_reg_loss: 4407.5330; val_edge_recon_loss: 78969.7344; val_gene_expr_recon_loss: 113662.4258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197039.6953; val_optim_loss: 197039.6953
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9654; val_auprc_score: 0.9652; val_best_acc_score: 0.8949; val_best_f1_score: 0.8969; train_kl_reg_loss: 4513.5487; train_edge_recon_loss: 81896.3633; train_gene_expr_recon_loss: 111916.8549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198326.7679; train_optim_loss: 198326.7679; val_kl_reg_loss: 4474.2788; val_edge_recon_loss: 80924.0391; val_gene_expr_recon_loss: 110076.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195475.2188; val_optim_loss: 195475.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9729; val_auprc_score: 0.9718; val_best_acc_score: 0.9107; val_best_f1_score: 0.9121; train_kl_reg_loss: 4635.1483; train_edge_recon_loss: 82128.4085; train_gene_expr_recon_loss: 109404.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196168.1708; train_optim_loss: 196168.1708; val_kl_reg_loss: 4684.4985; val_edge_recon_loss: 79623.6328; val_gene_expr_recon_loss: 107998.8477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192306.9688; val_optim_loss: 192306.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9789; val_auprc_score: 0.9780; val_best_acc_score: 0.9216; val_best_f1_score: 0.9220; train_kl_reg_loss: 4825.6125; train_edge_recon_loss: 80461.0854; train_gene_expr_recon_loss: 107185.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192471.9732; train_optim_loss: 192471.9732; val_kl_reg_loss: 4747.3828; val_edge_recon_loss: 81224.4883; val_gene_expr_recon_loss: 105827.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191799.8125; val_optim_loss: 191799.8125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9818; val_auprc_score: 0.9802; val_best_acc_score: 0.9284; val_best_f1_score: 0.9295; train_kl_reg_loss: 4853.2764; train_edge_recon_loss: 81828.0564; train_gene_expr_recon_loss: 105402.3465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192083.6808; train_optim_loss: 192083.6808; val_kl_reg_loss: 4752.5852; val_edge_recon_loss: 80599.5625; val_gene_expr_recon_loss: 105100.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 190452.7266; val_optim_loss: 190452.7266
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9845; val_auprc_score: 0.9834; val_best_acc_score: 0.9361; val_best_f1_score: 0.9370; train_kl_reg_loss: 4867.2912; train_edge_recon_loss: 80984.9224; train_gene_expr_recon_loss: 104044.0218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189896.2344; train_optim_loss: 189896.2344; val_kl_reg_loss: 4765.8286; val_edge_recon_loss: 79536.2422; val_gene_expr_recon_loss: 104078.8398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188380.9141; val_optim_loss: 188380.9141
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9863; val_auprc_score: 0.9854; val_best_acc_score: 0.9404; val_best_f1_score: 0.9411; train_kl_reg_loss: 4818.2681; train_edge_recon_loss: 80353.4196; train_gene_expr_recon_loss: 102995.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188166.7679; train_optim_loss: 188166.7679; val_kl_reg_loss: 4649.0293; val_edge_recon_loss: 81125.3320; val_gene_expr_recon_loss: 102444.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188218.4844; val_optim_loss: 188218.4844
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9874; val_auprc_score: 0.9863; val_best_acc_score: 0.9429; val_best_f1_score: 0.9437; train_kl_reg_loss: 4712.6965; train_edge_recon_loss: 79956.4598; train_gene_expr_recon_loss: 102043.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186712.4196; train_optim_loss: 186712.4196; val_kl_reg_loss: 4601.6951; val_edge_recon_loss: 79612.5625; val_gene_expr_recon_loss: 102075.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186290.1797; val_optim_loss: 186290.1797
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9885; val_auprc_score: 0.9875; val_best_acc_score: 0.9468; val_best_f1_score: 0.9474; train_kl_reg_loss: 4682.0559; train_edge_recon_loss: 79964.6685; train_gene_expr_recon_loss: 101273.8454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185920.5703; train_optim_loss: 185920.5703; val_kl_reg_loss: 4544.6931; val_edge_recon_loss: 78616.9844; val_gene_expr_recon_loss: 100686.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183848.2500; val_optim_loss: 183848.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9896; val_auprc_score: 0.9883; val_best_acc_score: 0.9489; val_best_f1_score: 0.9492; train_kl_reg_loss: 4620.3127; train_edge_recon_loss: 79817.6875; train_gene_expr_recon_loss: 100623.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185061.5781; train_optim_loss: 185061.5781; val_kl_reg_loss: 4566.6140; val_edge_recon_loss: 80125.1680; val_gene_expr_recon_loss: 100351.5430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185043.3281; val_optim_loss: 185043.3281
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9909; val_auprc_score: 0.9895; val_best_acc_score: 0.9542; val_best_f1_score: 0.9545; train_kl_reg_loss: 4592.3907; train_edge_recon_loss: 79029.7193; train_gene_expr_recon_loss: 99943.6278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183565.7366; train_optim_loss: 183565.7366; val_kl_reg_loss: 4497.4431; val_edge_recon_loss: 77574.2109; val_gene_expr_recon_loss: 99654.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181725.8281; val_optim_loss: 181725.8281
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9910; val_auprc_score: 0.9903; val_best_acc_score: 0.9541; val_best_f1_score: 0.9544; train_kl_reg_loss: 4547.0959; train_edge_recon_loss: 79431.0145; train_gene_expr_recon_loss: 99429.3231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183407.4342; train_optim_loss: 183407.4342; val_kl_reg_loss: 4397.1304; val_edge_recon_loss: 77143.6016; val_gene_expr_recon_loss: 99506.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181047.6016; val_optim_loss: 181047.6016
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9907; val_auprc_score: 0.9886; val_best_acc_score: 0.9543; val_best_f1_score: 0.9546; train_kl_reg_loss: 4477.9322; train_edge_recon_loss: 78648.7461; train_gene_expr_recon_loss: 98893.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182019.8627; train_optim_loss: 182019.8627; val_kl_reg_loss: 4398.2358; val_edge_recon_loss: 79430.1992; val_gene_expr_recon_loss: 98392.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182220.6797; val_optim_loss: 182220.6797
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9920; val_auprc_score: 0.9905; val_best_acc_score: 0.9577; val_best_f1_score: 0.9581; train_kl_reg_loss: 4477.7048; train_edge_recon_loss: 78773.6797; train_gene_expr_recon_loss: 98552.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181803.6830; train_optim_loss: 181803.6830; val_kl_reg_loss: 4394.1357; val_edge_recon_loss: 76525.4414; val_gene_expr_recon_loss: 98182.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179101.8750; val_optim_loss: 179101.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9922; val_auprc_score: 0.9915; val_best_acc_score: 0.9576; val_best_f1_score: 0.9580; train_kl_reg_loss: 4465.7433; train_edge_recon_loss: 79023.5184; train_gene_expr_recon_loss: 98042.5167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181531.7801; train_optim_loss: 181531.7801; val_kl_reg_loss: 4355.1587; val_edge_recon_loss: 76932.3555; val_gene_expr_recon_loss: 97921.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179209.0469; val_optim_loss: 179209.0469
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9924; val_auprc_score: 0.9908; val_best_acc_score: 0.9590; val_best_f1_score: 0.9593; train_kl_reg_loss: 4430.7861; train_edge_recon_loss: 79142.6847; train_gene_expr_recon_loss: 97683.3136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181256.7835; train_optim_loss: 181256.7835; val_kl_reg_loss: 4305.2607; val_edge_recon_loss: 77199.0977; val_gene_expr_recon_loss: 97842.1055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179346.4609; val_optim_loss: 179346.4609
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9932; val_auprc_score: 0.9924; val_best_acc_score: 0.9610; val_best_f1_score: 0.9612; train_kl_reg_loss: 4388.2109; train_edge_recon_loss: 78952.5435; train_gene_expr_recon_loss: 97247.5318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180588.2857; train_optim_loss: 180588.2857; val_kl_reg_loss: 4345.4128; val_edge_recon_loss: 78159.8633; val_gene_expr_recon_loss: 97684.6055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180189.8906; val_optim_loss: 180189.8906

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9932; val_auprc_score: 0.9927; val_best_acc_score: 0.9603; val_best_f1_score: 0.9606; train_kl_reg_loss: 4402.1804; train_edge_recon_loss: 79059.2746; train_gene_expr_recon_loss: 96961.4860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180422.9420; train_optim_loss: 180422.9420; val_kl_reg_loss: 4270.8704; val_edge_recon_loss: 79173.8086; val_gene_expr_recon_loss: 96890.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180335.3984; val_optim_loss: 180335.3984
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9929; val_auprc_score: 0.9919; val_best_acc_score: 0.9600; val_best_f1_score: 0.9604; train_kl_reg_loss: 4359.4314; train_edge_recon_loss: 78627.0765; train_gene_expr_recon_loss: 96903.4838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179889.9900; train_optim_loss: 179889.9900; val_kl_reg_loss: 4248.3652; val_edge_recon_loss: 78940.5898; val_gene_expr_recon_loss: 96989.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180178.4219; val_optim_loss: 180178.4219
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9928; val_auprc_score: 0.9917; val_best_acc_score: 0.9597; val_best_f1_score: 0.9600; train_kl_reg_loss: 4336.0657; train_edge_recon_loss: 79167.6445; train_gene_expr_recon_loss: 96887.2160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180390.9252; train_optim_loss: 180390.9252; val_kl_reg_loss: 4273.2068; val_edge_recon_loss: 77232.5664; val_gene_expr_recon_loss: 97350.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178856.4844; val_optim_loss: 178856.4844
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9932; val_auprc_score: 0.9924; val_best_acc_score: 0.9606; val_best_f1_score: 0.9607; train_kl_reg_loss: 4364.1752; train_edge_recon_loss: 79283.7974; train_gene_expr_recon_loss: 96890.2254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180538.1975; train_optim_loss: 180538.1975; val_kl_reg_loss: 4284.4858; val_edge_recon_loss: 80270.4414; val_gene_expr_recon_loss: 97122.6602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181677.5781; val_optim_loss: 181677.5781
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9931; val_auprc_score: 0.9921; val_best_acc_score: 0.9604; val_best_f1_score: 0.9604; train_kl_reg_loss: 4352.0032; train_edge_recon_loss: 78727.2628; train_gene_expr_recon_loss: 96831.0301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179910.2969; train_optim_loss: 179910.2969; val_kl_reg_loss: 4117.8972; val_edge_recon_loss: 78831.0430; val_gene_expr_recon_loss: 96732.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179681.0156; val_optim_loss: 179681.0156
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9931; val_auprc_score: 0.9925; val_best_acc_score: 0.9605; val_best_f1_score: 0.9608; train_kl_reg_loss: 4284.8507; train_edge_recon_loss: 78969.2628; train_gene_expr_recon_loss: 96710.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179964.1272; train_optim_loss: 179964.1272; val_kl_reg_loss: 4155.7915; val_edge_recon_loss: 79595.9453; val_gene_expr_recon_loss: 97063.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180815.2109; val_optim_loss: 180815.2109

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9932; val_auprc_score: 0.9922; val_best_acc_score: 0.9608; val_best_f1_score: 0.9611; train_kl_reg_loss: 4318.7443; train_edge_recon_loss: 78278.9626; train_gene_expr_recon_loss: 96747.6981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179345.4051; train_optim_loss: 179345.4051; val_kl_reg_loss: 4154.9985; val_edge_recon_loss: 77340.3750; val_gene_expr_recon_loss: 97226.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178722.1250; val_optim_loss: 178722.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9933; val_auprc_score: 0.9923; val_best_acc_score: 0.9603; val_best_f1_score: 0.9604; train_kl_reg_loss: 4309.7410; train_edge_recon_loss: 79290.7997; train_gene_expr_recon_loss: 96702.2394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180302.7812; train_optim_loss: 180302.7812; val_kl_reg_loss: 4147.6470; val_edge_recon_loss: 78112.5312; val_gene_expr_recon_loss: 97213.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179473.6875; val_optim_loss: 179473.6875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9930; val_auprc_score: 0.9924; val_best_acc_score: 0.9602; val_best_f1_score: 0.9607; train_kl_reg_loss: 4303.0248; train_edge_recon_loss: 78563.0586; train_gene_expr_recon_loss: 96746.2238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179612.3080; train_optim_loss: 179612.3080; val_kl_reg_loss: 4144.8679; val_edge_recon_loss: 78490.2539; val_gene_expr_recon_loss: 97017.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179652.9688; val_optim_loss: 179652.9688
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9929; val_auprc_score: 0.9922; val_best_acc_score: 0.9598; val_best_f1_score: 0.9600; train_kl_reg_loss: 4303.4502; train_edge_recon_loss: 78689.8571; train_gene_expr_recon_loss: 96767.5681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179760.8750; train_optim_loss: 179760.8750; val_kl_reg_loss: 4133.1228; val_edge_recon_loss: 77700.0352; val_gene_expr_recon_loss: 97035.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178868.3672; val_optim_loss: 178868.3672

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9930; val_auprc_score: 0.9919; val_best_acc_score: 0.9605; val_best_f1_score: 0.9608; train_kl_reg_loss: 4301.8980; train_edge_recon_loss: 78234.9782; train_gene_expr_recon_loss: 96783.6747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179320.5502; train_optim_loss: 179320.5502; val_kl_reg_loss: 4124.9971; val_edge_recon_loss: 77511.4297; val_gene_expr_recon_loss: 96746.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178382.9375; val_optim_loss: 178382.9375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9931; val_auprc_score: 0.9926; val_best_acc_score: 0.9600; val_best_f1_score: 0.9602; train_kl_reg_loss: 4300.4708; train_edge_recon_loss: 79036.0374; train_gene_expr_recon_loss: 96757.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180093.7400; train_optim_loss: 180093.7400; val_kl_reg_loss: 4145.8853; val_edge_recon_loss: 79445.4922; val_gene_expr_recon_loss: 97517.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181109.3594; val_optim_loss: 181109.3594
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9933; val_auprc_score: 0.9927; val_best_acc_score: 0.9605; val_best_f1_score: 0.9608; train_kl_reg_loss: 4302.4508; train_edge_recon_loss: 78586.5513; train_gene_expr_recon_loss: 96805.1691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179694.1730; train_optim_loss: 179694.1730; val_kl_reg_loss: 4137.4375; val_edge_recon_loss: 78823.7148; val_gene_expr_recon_loss: 96725.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179686.6875; val_optim_loss: 179686.6875
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9932; val_auprc_score: 0.9923; val_best_acc_score: 0.9609; val_best_f1_score: 0.9612; train_kl_reg_loss: 4299.9408; train_edge_recon_loss: 78691.9118; train_gene_expr_recon_loss: 96788.2751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179780.1295; train_optim_loss: 179780.1295; val_kl_reg_loss: 4133.6841; val_edge_recon_loss: 79615.2734; val_gene_expr_recon_loss: 96743.7695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180492.7344; val_optim_loss: 180492.7344

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9930; val_auprc_score: 0.9924; val_best_acc_score: 0.9599; val_best_f1_score: 0.9600; train_kl_reg_loss: 4300.1846; train_edge_recon_loss: 78543.7199; train_gene_expr_recon_loss: 96737.4202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179581.3237; train_optim_loss: 179581.3237; val_kl_reg_loss: 4131.9172; val_edge_recon_loss: 77224.8945; val_gene_expr_recon_loss: 96866.6289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178223.4375; val_optim_loss: 178223.4375
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9928; val_auprc_score: 0.9918; val_best_acc_score: 0.9600; val_best_f1_score: 0.9603; train_kl_reg_loss: 4301.2948; train_edge_recon_loss: 79332.8142; train_gene_expr_recon_loss: 96764.7829; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180398.8906; train_optim_loss: 180398.8906; val_kl_reg_loss: 4126.7893; val_edge_recon_loss: 77512.8398; val_gene_expr_recon_loss: 96756.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178396.4219; val_optim_loss: 178396.4219
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9934; val_auprc_score: 0.9927; val_best_acc_score: 0.9614; val_best_f1_score: 0.9616; train_kl_reg_loss: 4302.7606; train_edge_recon_loss: 78420.1574; train_gene_expr_recon_loss: 96819.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179542.3560; train_optim_loss: 179542.3560; val_kl_reg_loss: 4136.6584; val_edge_recon_loss: 75977.4297; val_gene_expr_recon_loss: 97103.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177217.4688; val_optim_loss: 177217.4688
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9932; val_auprc_score: 0.9923; val_best_acc_score: 0.9604; val_best_f1_score: 0.9605; train_kl_reg_loss: 4299.4612; train_edge_recon_loss: 78843.0329; train_gene_expr_recon_loss: 96832.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179975.0312; train_optim_loss: 179975.0312; val_kl_reg_loss: 4135.1003; val_edge_recon_loss: 77468.9141; val_gene_expr_recon_loss: 97292.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178896.9688; val_optim_loss: 178896.9688
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9928; val_auprc_score: 0.9915; val_best_acc_score: 0.9601; val_best_f1_score: 0.9604; train_kl_reg_loss: 4300.1289; train_edge_recon_loss: 79362.1853; train_gene_expr_recon_loss: 96815.2433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180477.5558; train_optim_loss: 180477.5558; val_kl_reg_loss: 4140.3208; val_edge_recon_loss: 80852.8398; val_gene_expr_recon_loss: 97095.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182088.5781; val_optim_loss: 182088.5781
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9930; val_auprc_score: 0.9918; val_best_acc_score: 0.9606; val_best_f1_score: 0.9609; train_kl_reg_loss: 4298.4013; train_edge_recon_loss: 78688.8477; train_gene_expr_recon_loss: 96761.6791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179748.9297; train_optim_loss: 179748.9297; val_kl_reg_loss: 4127.0945; val_edge_recon_loss: 79506.5117; val_gene_expr_recon_loss: 96741.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180375.0469; val_optim_loss: 180375.0469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9935; val_auprc_score: 0.9930; val_best_acc_score: 0.9618; val_best_f1_score: 0.9620; train_kl_reg_loss: 4301.6753; train_edge_recon_loss: 78889.8599; train_gene_expr_recon_loss: 96848.0809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180039.6183; train_optim_loss: 180039.6183; val_kl_reg_loss: 4131.5608; val_edge_recon_loss: 78748.7383; val_gene_expr_recon_loss: 97286.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180166.6484; val_optim_loss: 180166.6484
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9928; val_auprc_score: 0.9915; val_best_acc_score: 0.9608; val_best_f1_score: 0.9609; train_kl_reg_loss: 4299.6401; train_edge_recon_loss: 78710.5792; train_gene_expr_recon_loss: 96727.5619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179737.7824; train_optim_loss: 179737.7824; val_kl_reg_loss: 4133.3699; val_edge_recon_loss: 77021.6953; val_gene_expr_recon_loss: 96871.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178026.7266; val_optim_loss: 178026.7266
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9932; val_auprc_score: 0.9923; val_best_acc_score: 0.9611; val_best_f1_score: 0.9614; train_kl_reg_loss: 4299.5131; train_edge_recon_loss: 78395.8253; train_gene_expr_recon_loss: 96788.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179483.4420; train_optim_loss: 179483.4420; val_kl_reg_loss: 4137.1052; val_edge_recon_loss: 78885.5273; val_gene_expr_recon_loss: 96667.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179690.1953; val_optim_loss: 179690.1953

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 50 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9931
Val AUPRC score: 0.9924
Val best accuracy score: 0.9608
Val best F1 score: 0.9611
Val gene expr MSE score: 1.2810
Duration of model training in run 4: 0 hours, 11 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9797; val_auprc_score: 0.9814; val_best_acc_score: 0.8931; val_best_f1_score: 0.9009; train_kl_reg_loss: 537.8873; train_edge_recon_loss: 102421.6145; train_gene_expr_recon_loss: 131773.0164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234732.5180; train_optim_loss: 234732.5180; val_kl_reg_loss: 909.3313; val_edge_recon_loss: 115718.8203; val_gene_expr_recon_loss: 125123.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241751.3281; val_optim_loss: 241751.3281
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9319; val_auprc_score: 0.9289; val_best_acc_score: 0.8526; val_best_f1_score: 0.8589; train_kl_reg_loss: 1721.8915; train_edge_recon_loss: 95480.8461; train_gene_expr_recon_loss: 122352.0551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219554.7953; train_optim_loss: 219554.7953; val_kl_reg_loss: 4412.8322; val_edge_recon_loss: 85374.6719; val_gene_expr_recon_loss: 120415.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210202.8281; val_optim_loss: 210202.8281
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9527; val_auprc_score: 0.9524; val_best_acc_score: 0.8770; val_best_f1_score: 0.8788; train_kl_reg_loss: 4667.1733; train_edge_recon_loss: 84602.8332; train_gene_expr_recon_loss: 117496.3102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206766.3156; train_optim_loss: 206766.3156; val_kl_reg_loss: 4484.2827; val_edge_recon_loss: 83778.9245; val_gene_expr_recon_loss: 114809.2630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203072.4635; val_optim_loss: 203072.4635
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9707; val_auprc_score: 0.9707; val_best_acc_score: 0.9062; val_best_f1_score: 0.9073; train_kl_reg_loss: 4492.6396; train_edge_recon_loss: 82643.8008; train_gene_expr_recon_loss: 112850.1035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199986.5430; train_optim_loss: 199986.5430; val_kl_reg_loss: 4332.6468; val_edge_recon_loss: 80692.3984; val_gene_expr_recon_loss: 111108.1979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196133.2448; val_optim_loss: 196133.2448
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9790; val_auprc_score: 0.9780; val_best_acc_score: 0.9213; val_best_f1_score: 0.9225; train_kl_reg_loss: 4565.3570; train_edge_recon_loss: 81993.5094; train_gene_expr_recon_loss: 109396.4559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195955.3219; train_optim_loss: 195955.3219; val_kl_reg_loss: 4630.3236; val_edge_recon_loss: 79952.2812; val_gene_expr_recon_loss: 107855.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192438.4271; val_optim_loss: 192438.4271
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9843; val_auprc_score: 0.9831; val_best_acc_score: 0.9357; val_best_f1_score: 0.9364; train_kl_reg_loss: 4680.8314; train_edge_recon_loss: 80656.7672; train_gene_expr_recon_loss: 106362.7312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 191700.3297; train_optim_loss: 191700.3297; val_kl_reg_loss: 4584.8989; val_edge_recon_loss: 80019.1979; val_gene_expr_recon_loss: 105301.9036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189906.0000; val_optim_loss: 189906.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9878; val_auprc_score: 0.9870; val_best_acc_score: 0.9437; val_best_f1_score: 0.9446; train_kl_reg_loss: 4692.4342; train_edge_recon_loss: 79938.1570; train_gene_expr_recon_loss: 104153.8758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188784.4672; train_optim_loss: 188784.4672; val_kl_reg_loss: 4618.0295; val_edge_recon_loss: 77430.8438; val_gene_expr_recon_loss: 103543.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185592.3698; val_optim_loss: 185592.3698
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9899; val_auprc_score: 0.9890; val_best_acc_score: 0.9498; val_best_f1_score: 0.9505; train_kl_reg_loss: 4654.6484; train_edge_recon_loss: 80424.3223; train_gene_expr_recon_loss: 102568.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187647.6758; train_optim_loss: 187647.6758; val_kl_reg_loss: 4573.0475; val_edge_recon_loss: 77839.2396; val_gene_expr_recon_loss: 101936.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184348.6250; val_optim_loss: 184348.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9912; val_auprc_score: 0.9906; val_best_acc_score: 0.9536; val_best_f1_score: 0.9540; train_kl_reg_loss: 4572.1696; train_edge_recon_loss: 79698.1449; train_gene_expr_recon_loss: 101184.9461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185455.2625; train_optim_loss: 185455.2625; val_kl_reg_loss: 4451.2479; val_edge_recon_loss: 78441.6146; val_gene_expr_recon_loss: 100904.6042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183797.4688; val_optim_loss: 183797.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9920; val_auprc_score: 0.9911; val_best_acc_score: 0.9574; val_best_f1_score: 0.9577; train_kl_reg_loss: 4508.1568; train_edge_recon_loss: 79800.5016; train_gene_expr_recon_loss: 100256.5688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184565.2289; train_optim_loss: 184565.2289; val_kl_reg_loss: 4403.0537; val_edge_recon_loss: 77883.1380; val_gene_expr_recon_loss: 100024.2161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182310.4062; val_optim_loss: 182310.4062
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9929; val_auprc_score: 0.9923; val_best_acc_score: 0.9595; val_best_f1_score: 0.9598; train_kl_reg_loss: 4423.7914; train_edge_recon_loss: 79478.5309; train_gene_expr_recon_loss: 99231.3992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183133.7227; train_optim_loss: 183133.7227; val_kl_reg_loss: 4306.9714; val_edge_recon_loss: 79026.5781; val_gene_expr_recon_loss: 99093.2318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182426.7760; val_optim_loss: 182426.7760
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9937; val_auprc_score: 0.9933; val_best_acc_score: 0.9618; val_best_f1_score: 0.9624; train_kl_reg_loss: 4374.8801; train_edge_recon_loss: 79091.9066; train_gene_expr_recon_loss: 98448.4988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181915.2836; train_optim_loss: 181915.2836; val_kl_reg_loss: 4369.2806; val_edge_recon_loss: 78445.0234; val_gene_expr_recon_loss: 98186.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181000.7604; val_optim_loss: 181000.7604
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9940; val_auprc_score: 0.9932; val_best_acc_score: 0.9645; val_best_f1_score: 0.9649; train_kl_reg_loss: 4345.5957; train_edge_recon_loss: 79035.8270; train_gene_expr_recon_loss: 97718.4164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181099.8398; train_optim_loss: 181099.8398; val_kl_reg_loss: 4215.6610; val_edge_recon_loss: 77803.9922; val_gene_expr_recon_loss: 97795.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179815.0677; val_optim_loss: 179815.0677
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9945; val_auprc_score: 0.9938; val_best_acc_score: 0.9660; val_best_f1_score: 0.9663; train_kl_reg_loss: 4283.6353; train_edge_recon_loss: 79035.3574; train_gene_expr_recon_loss: 97152.2488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180471.2422; train_optim_loss: 180471.2422; val_kl_reg_loss: 4212.8945; val_edge_recon_loss: 78492.9766; val_gene_expr_recon_loss: 97257.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179963.7969; val_optim_loss: 179963.7969
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9950; val_auprc_score: 0.9944; val_best_acc_score: 0.9681; val_best_f1_score: 0.9685; train_kl_reg_loss: 4253.6872; train_edge_recon_loss: 78293.8891; train_gene_expr_recon_loss: 96590.3836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179137.9594; train_optim_loss: 179137.9594; val_kl_reg_loss: 4146.2427; val_edge_recon_loss: 79381.8281; val_gene_expr_recon_loss: 96716.8724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180244.9427; val_optim_loss: 180244.9427
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9949; val_auprc_score: 0.9943; val_best_acc_score: 0.9676; val_best_f1_score: 0.9680; train_kl_reg_loss: 4220.9161; train_edge_recon_loss: 78970.5777; train_gene_expr_recon_loss: 96074.3602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179265.8531; train_optim_loss: 179265.8531; val_kl_reg_loss: 4135.2811; val_edge_recon_loss: 77026.0339; val_gene_expr_recon_loss: 95949.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177110.6771; val_optim_loss: 177110.6771
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9953; val_auprc_score: 0.9948; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 4185.9950; train_edge_recon_loss: 78478.6910; train_gene_expr_recon_loss: 95531.9781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178196.6656; train_optim_loss: 178196.6656; val_kl_reg_loss: 4105.2769; val_edge_recon_loss: 78451.9974; val_gene_expr_recon_loss: 95659.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178216.5573; val_optim_loss: 178216.5573
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9953; val_best_acc_score: 0.9713; val_best_f1_score: 0.9714; train_kl_reg_loss: 4158.0908; train_edge_recon_loss: 77840.5254; train_gene_expr_recon_loss: 95094.9973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177093.6141; train_optim_loss: 177093.6141; val_kl_reg_loss: 4050.8312; val_edge_recon_loss: 76830.4479; val_gene_expr_recon_loss: 95275.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176157.2604; val_optim_loss: 176157.2604
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9956; val_auprc_score: 0.9947; val_best_acc_score: 0.9712; val_best_f1_score: 0.9714; train_kl_reg_loss: 4151.5044; train_edge_recon_loss: 78284.0855; train_gene_expr_recon_loss: 94687.3070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177122.8977; train_optim_loss: 177122.8977; val_kl_reg_loss: 4128.0412; val_edge_recon_loss: 77286.6536; val_gene_expr_recon_loss: 94718.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176133.4688; val_optim_loss: 176133.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9950; val_best_acc_score: 0.9714; val_best_f1_score: 0.9717; train_kl_reg_loss: 4107.3775; train_edge_recon_loss: 77811.1309; train_gene_expr_recon_loss: 94192.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176111.1117; train_optim_loss: 176111.1117; val_kl_reg_loss: 4020.8984; val_edge_recon_loss: 76676.4583; val_gene_expr_recon_loss: 94461.0521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175158.4062; val_optim_loss: 175158.4062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9962; val_auprc_score: 0.9959; val_best_acc_score: 0.9723; val_best_f1_score: 0.9725; train_kl_reg_loss: 4103.3837; train_edge_recon_loss: 77816.6824; train_gene_expr_recon_loss: 93717.8727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175637.9391; train_optim_loss: 175637.9391; val_kl_reg_loss: 4065.4723; val_edge_recon_loss: 75847.1276; val_gene_expr_recon_loss: 93923.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173835.6302; val_optim_loss: 173835.6302
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9955; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 4081.3727; train_edge_recon_loss: 77690.8109; train_gene_expr_recon_loss: 93543.0953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175315.2781; train_optim_loss: 175315.2781; val_kl_reg_loss: 4079.2274; val_edge_recon_loss: 75833.1823; val_gene_expr_recon_loss: 93706.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173618.8750; val_optim_loss: 173618.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9734; val_best_f1_score: 0.9735; train_kl_reg_loss: 4078.8420; train_edge_recon_loss: 77711.6684; train_gene_expr_recon_loss: 93161.5332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174952.0422; train_optim_loss: 174952.0422; val_kl_reg_loss: 4068.2503; val_edge_recon_loss: 74932.4479; val_gene_expr_recon_loss: 93232.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172233.5885; val_optim_loss: 172233.5885
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9965; val_auprc_score: 0.9959; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 4066.9781; train_edge_recon_loss: 78208.3020; train_gene_expr_recon_loss: 92846.1676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175121.4492; train_optim_loss: 175121.4492; val_kl_reg_loss: 3985.6230; val_edge_recon_loss: 76472.7057; val_gene_expr_recon_loss: 92769.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173228.1667; val_optim_loss: 173228.1667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 4040.6193; train_edge_recon_loss: 77494.9578; train_gene_expr_recon_loss: 92528.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174064.0242; train_optim_loss: 174064.0242; val_kl_reg_loss: 3959.7220; val_edge_recon_loss: 76569.6797; val_gene_expr_recon_loss: 92824.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173354.0573; val_optim_loss: 173354.0573
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9753; val_best_f1_score: 0.9755; train_kl_reg_loss: 3895.2202; train_edge_recon_loss: 77132.1590; train_gene_expr_recon_loss: 92226.2875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173253.6680; train_optim_loss: 173253.6680; val_kl_reg_loss: 3658.6522; val_edge_recon_loss: 77369.2708; val_gene_expr_recon_loss: 92449.2135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173477.1354; val_optim_loss: 173477.1354

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9743; val_best_f1_score: 0.9745; train_kl_reg_loss: 3797.0399; train_edge_recon_loss: 77148.4055; train_gene_expr_recon_loss: 92084.4047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173029.8477; train_optim_loss: 173029.8477; val_kl_reg_loss: 3581.4689; val_edge_recon_loss: 75015.3047; val_gene_expr_recon_loss: 92404.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171001.1771; val_optim_loss: 171001.1771
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9757; val_best_f1_score: 0.9759; train_kl_reg_loss: 3779.6510; train_edge_recon_loss: 77574.4863; train_gene_expr_recon_loss: 91950.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173305.1094; train_optim_loss: 173305.1094; val_kl_reg_loss: 3619.5345; val_edge_recon_loss: 78194.1927; val_gene_expr_recon_loss: 92552.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174366.0000; val_optim_loss: 174366.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9751; val_best_f1_score: 0.9753; train_kl_reg_loss: 3780.6704; train_edge_recon_loss: 77329.7996; train_gene_expr_recon_loss: 91925.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173036.0000; train_optim_loss: 173036.0000; val_kl_reg_loss: 3595.2625; val_edge_recon_loss: 77771.9193; val_gene_expr_recon_loss: 92263.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173630.7135; val_optim_loss: 173630.7135
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9967; val_auprc_score: 0.9964; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 3768.8865; train_edge_recon_loss: 77488.3133; train_gene_expr_recon_loss: 91929.8781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173187.0797; train_optim_loss: 173187.0797; val_kl_reg_loss: 3595.1366; val_edge_recon_loss: 77009.6849; val_gene_expr_recon_loss: 92136.9323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172741.7500; val_optim_loss: 172741.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9750; val_best_f1_score: 0.9751; train_kl_reg_loss: 3760.5443; train_edge_recon_loss: 77606.6492; train_gene_expr_recon_loss: 91862.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173230.0945; train_optim_loss: 173230.0945; val_kl_reg_loss: 3591.9049; val_edge_recon_loss: 76986.2370; val_gene_expr_recon_loss: 92321.9870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172900.1302; val_optim_loss: 172900.1302
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9968; val_auprc_score: 0.9964; val_best_acc_score: 0.9760; val_best_f1_score: 0.9762; train_kl_reg_loss: 3763.3518; train_edge_recon_loss: 77564.2723; train_gene_expr_recon_loss: 91855.2012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173182.8266; train_optim_loss: 173182.8266; val_kl_reg_loss: 3598.8595; val_edge_recon_loss: 75557.3542; val_gene_expr_recon_loss: 92227.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171383.3490; val_optim_loss: 171383.3490
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9968; val_auprc_score: 0.9965; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 3766.1099; train_edge_recon_loss: 77223.6805; train_gene_expr_recon_loss: 92024.6707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173014.4602; train_optim_loss: 173014.4602; val_kl_reg_loss: 3604.2271; val_edge_recon_loss: 77769.9974; val_gene_expr_recon_loss: 92168.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173542.9323; val_optim_loss: 173542.9323

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 2 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9967
Val AUPRC score: 0.9962
Val best accuracy score: 0.9758
Val best F1 score: 0.9759
Val gene expr MSE score: 1.0885
Duration of model training in run 5: 0 hours, 14 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9818; val_auprc_score: 0.9828; val_best_acc_score: 0.8857; val_best_f1_score: 0.8944; train_kl_reg_loss: 558.5074; train_edge_recon_loss: 102118.5879; train_gene_expr_recon_loss: 131446.8590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234123.9531; train_optim_loss: 234123.9531; val_kl_reg_loss: 963.0449; val_edge_recon_loss: 114847.6953; val_gene_expr_recon_loss: 125070.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240881.4427; val_optim_loss: 240881.4427
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9311; val_auprc_score: 0.9297; val_best_acc_score: 0.8492; val_best_f1_score: 0.8533; train_kl_reg_loss: 1616.0633; train_edge_recon_loss: 95939.1359; train_gene_expr_recon_loss: 122740.4098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220295.6102; train_optim_loss: 220295.6102; val_kl_reg_loss: 4116.7230; val_edge_recon_loss: 86223.9010; val_gene_expr_recon_loss: 121107.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211448.3229; val_optim_loss: 211448.3229
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9484; val_auprc_score: 0.9477; val_best_acc_score: 0.8734; val_best_f1_score: 0.8751; train_kl_reg_loss: 4591.4610; train_edge_recon_loss: 84512.6070; train_gene_expr_recon_loss: 118101.6723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207205.7383; train_optim_loss: 207205.7383; val_kl_reg_loss: 4526.5293; val_edge_recon_loss: 81479.0417; val_gene_expr_recon_loss: 115330.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201335.8333; val_optim_loss: 201335.8333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9654; val_auprc_score: 0.9649; val_best_acc_score: 0.8997; val_best_f1_score: 0.9015; train_kl_reg_loss: 4540.9696; train_edge_recon_loss: 83172.0637; train_gene_expr_recon_loss: 113612.5883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201325.6211; train_optim_loss: 201325.6211; val_kl_reg_loss: 4343.3918; val_edge_recon_loss: 80023.9453; val_gene_expr_recon_loss: 111934.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196301.8385; val_optim_loss: 196301.8385
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9781; val_auprc_score: 0.9777; val_best_acc_score: 0.9206; val_best_f1_score: 0.9220; train_kl_reg_loss: 4537.5408; train_edge_recon_loss: 82128.7484; train_gene_expr_recon_loss: 109917.1082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196583.3969; train_optim_loss: 196583.3969; val_kl_reg_loss: 4547.9323; val_edge_recon_loss: 80172.6432; val_gene_expr_recon_loss: 108574.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193294.7083; val_optim_loss: 193294.7083
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9850; val_auprc_score: 0.9842; val_best_acc_score: 0.9357; val_best_f1_score: 0.9365; train_kl_reg_loss: 4675.2497; train_edge_recon_loss: 81289.1961; train_gene_expr_recon_loss: 106835.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192800.0758; train_optim_loss: 192800.0758; val_kl_reg_loss: 4635.2067; val_edge_recon_loss: 80794.2188; val_gene_expr_recon_loss: 105849.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191279.0052; val_optim_loss: 191279.0052
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9888; val_auprc_score: 0.9878; val_best_acc_score: 0.9463; val_best_f1_score: 0.9468; train_kl_reg_loss: 4748.2251; train_edge_recon_loss: 80069.2176; train_gene_expr_recon_loss: 104372.3656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189189.8109; train_optim_loss: 189189.8109; val_kl_reg_loss: 4613.4256; val_edge_recon_loss: 77662.3411; val_gene_expr_recon_loss: 103865.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186141.5104; val_optim_loss: 186141.5104
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9904; val_auprc_score: 0.9898; val_best_acc_score: 0.9516; val_best_f1_score: 0.9522; train_kl_reg_loss: 4707.2899; train_edge_recon_loss: 79622.4590; train_gene_expr_recon_loss: 102741.9234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187071.6719; train_optim_loss: 187071.6719; val_kl_reg_loss: 4608.6507; val_edge_recon_loss: 79418.3698; val_gene_expr_recon_loss: 101997.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186024.5104; val_optim_loss: 186024.5104
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9916; val_auprc_score: 0.9910; val_best_acc_score: 0.9550; val_best_f1_score: 0.9556; train_kl_reg_loss: 4650.4269; train_edge_recon_loss: 80318.0008; train_gene_expr_recon_loss: 101312.8246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186281.2516; train_optim_loss: 186281.2516; val_kl_reg_loss: 4555.8179; val_edge_recon_loss: 78571.3229; val_gene_expr_recon_loss: 100961.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184088.1510; val_optim_loss: 184088.1510
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9926; val_auprc_score: 0.9919; val_best_acc_score: 0.9583; val_best_f1_score: 0.9586; train_kl_reg_loss: 4604.5689; train_edge_recon_loss: 79507.8555; train_gene_expr_recon_loss: 100224.0609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184336.4852; train_optim_loss: 184336.4852; val_kl_reg_loss: 4458.3643; val_edge_recon_loss: 78393.7370; val_gene_expr_recon_loss: 99940.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182792.3281; val_optim_loss: 182792.3281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9930; val_auprc_score: 0.9922; val_best_acc_score: 0.9602; val_best_f1_score: 0.9606; train_kl_reg_loss: 4500.6854; train_edge_recon_loss: 78895.3695; train_gene_expr_recon_loss: 99373.7289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182769.7812; train_optim_loss: 182769.7812; val_kl_reg_loss: 4383.9720; val_edge_recon_loss: 76732.4141; val_gene_expr_recon_loss: 99187.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180304.2448; val_optim_loss: 180304.2448
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9934; val_auprc_score: 0.9927; val_best_acc_score: 0.9614; val_best_f1_score: 0.9616; train_kl_reg_loss: 4453.0713; train_edge_recon_loss: 78811.0113; train_gene_expr_recon_loss: 98615.8668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181879.9477; train_optim_loss: 181879.9477; val_kl_reg_loss: 4323.9943; val_edge_recon_loss: 77730.7630; val_gene_expr_recon_loss: 98224.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180279.2083; val_optim_loss: 180279.2083
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9938; val_auprc_score: 0.9929; val_best_acc_score: 0.9633; val_best_f1_score: 0.9637; train_kl_reg_loss: 4387.5910; train_edge_recon_loss: 79049.5883; train_gene_expr_recon_loss: 97862.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181300.0438; train_optim_loss: 181300.0438; val_kl_reg_loss: 4285.2380; val_edge_recon_loss: 76377.4036; val_gene_expr_recon_loss: 97614.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178277.5677; val_optim_loss: 178277.5677
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9940; val_auprc_score: 0.9930; val_best_acc_score: 0.9646; val_best_f1_score: 0.9650; train_kl_reg_loss: 4335.7531; train_edge_recon_loss: 78862.7715; train_gene_expr_recon_loss: 97230.6223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180429.1437; train_optim_loss: 180429.1437; val_kl_reg_loss: 4309.4466; val_edge_recon_loss: 80016.8672; val_gene_expr_recon_loss: 97244.2448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181570.5573; val_optim_loss: 181570.5573
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9947; val_auprc_score: 0.9942; val_best_acc_score: 0.9667; val_best_f1_score: 0.9670; train_kl_reg_loss: 4307.5104; train_edge_recon_loss: 78960.2480; train_gene_expr_recon_loss: 96644.2262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179911.9852; train_optim_loss: 179911.9852; val_kl_reg_loss: 4111.2585; val_edge_recon_loss: 76269.5104; val_gene_expr_recon_loss: 96817.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177198.6667; val_optim_loss: 177198.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9948; val_auprc_score: 0.9938; val_best_acc_score: 0.9669; val_best_f1_score: 0.9672; train_kl_reg_loss: 4252.4749; train_edge_recon_loss: 78060.7437; train_gene_expr_recon_loss: 96082.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178395.8570; train_optim_loss: 178395.8570; val_kl_reg_loss: 4125.9382; val_edge_recon_loss: 75976.3281; val_gene_expr_recon_loss: 96134.4089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176236.6719; val_optim_loss: 176236.6719
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9947; val_auprc_score: 0.9939; val_best_acc_score: 0.9674; val_best_f1_score: 0.9677; train_kl_reg_loss: 4208.8622; train_edge_recon_loss: 78501.0059; train_gene_expr_recon_loss: 95585.6762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178295.5453; train_optim_loss: 178295.5453; val_kl_reg_loss: 4110.2292; val_edge_recon_loss: 76508.6693; val_gene_expr_recon_loss: 95472.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176091.4479; val_optim_loss: 176091.4479
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9953; val_auprc_score: 0.9947; val_best_acc_score: 0.9696; val_best_f1_score: 0.9699; train_kl_reg_loss: 4177.6867; train_edge_recon_loss: 78500.1062; train_gene_expr_recon_loss: 95077.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177755.0742; train_optim_loss: 177755.0742; val_kl_reg_loss: 4127.7630; val_edge_recon_loss: 77038.5573; val_gene_expr_recon_loss: 95156.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176322.9688; val_optim_loss: 176322.9688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9957; val_auprc_score: 0.9952; val_best_acc_score: 0.9709; val_best_f1_score: 0.9710; train_kl_reg_loss: 4144.1592; train_edge_recon_loss: 78553.8750; train_gene_expr_recon_loss: 94465.2594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177163.2930; train_optim_loss: 177163.2930; val_kl_reg_loss: 4039.3348; val_edge_recon_loss: 77302.7760; val_gene_expr_recon_loss: 94706.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176048.1719; val_optim_loss: 176048.1719
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9959; val_auprc_score: 0.9955; val_best_acc_score: 0.9715; val_best_f1_score: 0.9718; train_kl_reg_loss: 4116.4057; train_edge_recon_loss: 78511.9590; train_gene_expr_recon_loss: 94217.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176846.3109; train_optim_loss: 176846.3109; val_kl_reg_loss: 4127.1338; val_edge_recon_loss: 77307.3568; val_gene_expr_recon_loss: 94319.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175754.1354; val_optim_loss: 175754.1354
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9958; val_auprc_score: 0.9951; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 4100.7798; train_edge_recon_loss: 77877.6754; train_gene_expr_recon_loss: 93826.0137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175804.4672; train_optim_loss: 175804.4672; val_kl_reg_loss: 4009.2169; val_edge_recon_loss: 77776.1302; val_gene_expr_recon_loss: 94084.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175870.1667; val_optim_loss: 175870.1667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9961; val_auprc_score: 0.9953; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 4092.2864; train_edge_recon_loss: 78051.6242; train_gene_expr_recon_loss: 93369.6418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175513.5531; train_optim_loss: 175513.5531; val_kl_reg_loss: 3952.7919; val_edge_recon_loss: 76566.9401; val_gene_expr_recon_loss: 93587.9401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174107.6719; val_optim_loss: 174107.6719
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9962; val_auprc_score: 0.9947; val_best_acc_score: 0.9740; val_best_f1_score: 0.9742; train_kl_reg_loss: 4064.8064; train_edge_recon_loss: 77349.7309; train_gene_expr_recon_loss: 93008.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174422.8195; train_optim_loss: 174422.8195; val_kl_reg_loss: 4026.2782; val_edge_recon_loss: 76015.3073; val_gene_expr_recon_loss: 93160.4974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173202.0833; val_optim_loss: 173202.0833
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9962; val_auprc_score: 0.9958; val_best_acc_score: 0.9730; val_best_f1_score: 0.9732; train_kl_reg_loss: 4046.7867; train_edge_recon_loss: 77710.2926; train_gene_expr_recon_loss: 92688.5773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174445.6562; train_optim_loss: 174445.6562; val_kl_reg_loss: 4009.2744; val_edge_recon_loss: 78683.8281; val_gene_expr_recon_loss: 92932.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175625.1719; val_optim_loss: 175625.1719
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9965; val_auprc_score: 0.9954; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 4040.5784; train_edge_recon_loss: 77412.7941; train_gene_expr_recon_loss: 92437.5750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173890.9453; train_optim_loss: 173890.9453; val_kl_reg_loss: 3972.3878; val_edge_recon_loss: 77997.9792; val_gene_expr_recon_loss: 92612.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174583.1719; val_optim_loss: 174583.1719
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9965; val_auprc_score: 0.9961; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 3964.9458; train_edge_recon_loss: 77210.8883; train_gene_expr_recon_loss: 92105.1187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173280.9500; train_optim_loss: 173280.9500; val_kl_reg_loss: 3807.9189; val_edge_recon_loss: 79273.7969; val_gene_expr_recon_loss: 92386.5026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175468.2188; val_optim_loss: 175468.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9747; val_best_f1_score: 0.9748; train_kl_reg_loss: 3930.1157; train_edge_recon_loss: 77089.9082; train_gene_expr_recon_loss: 92015.6121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173035.6383; train_optim_loss: 173035.6383; val_kl_reg_loss: 3773.3693; val_edge_recon_loss: 76136.7396; val_gene_expr_recon_loss: 92155.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172065.9948; val_optim_loss: 172065.9948
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9964; val_auprc_score: 0.9957; val_best_acc_score: 0.9744; val_best_f1_score: 0.9745; train_kl_reg_loss: 3908.6983; train_edge_recon_loss: 77208.7723; train_gene_expr_recon_loss: 91960.0453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173077.5141; train_optim_loss: 173077.5141; val_kl_reg_loss: 3783.3604; val_edge_recon_loss: 76912.9245; val_gene_expr_recon_loss: 92320.4010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173016.6771; val_optim_loss: 173016.6771
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 3899.1919; train_edge_recon_loss: 77295.2891; train_gene_expr_recon_loss: 91891.3156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173085.7945; train_optim_loss: 173085.7945; val_kl_reg_loss: 3764.1476; val_edge_recon_loss: 77465.0964; val_gene_expr_recon_loss: 92223.9115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173453.1562; val_optim_loss: 173453.1562
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9759; val_best_f1_score: 0.9760; train_kl_reg_loss: 3907.1390; train_edge_recon_loss: 77865.8379; train_gene_expr_recon_loss: 91863.8062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173636.7836; train_optim_loss: 173636.7836; val_kl_reg_loss: 3780.1998; val_edge_recon_loss: 74878.3906; val_gene_expr_recon_loss: 92268.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170926.7083; val_optim_loss: 170926.7083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 3894.1806; train_edge_recon_loss: 77158.7234; train_gene_expr_recon_loss: 91808.1297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172861.0336; train_optim_loss: 172861.0336; val_kl_reg_loss: 3750.3192; val_edge_recon_loss: 77066.6068; val_gene_expr_recon_loss: 92055.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172872.0885; val_optim_loss: 172872.0885
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9968; val_auprc_score: 0.9963; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 3897.7757; train_edge_recon_loss: 77192.8762; train_gene_expr_recon_loss: 91753.1449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172843.7961; train_optim_loss: 172843.7961; val_kl_reg_loss: 3767.6359; val_edge_recon_loss: 75882.3464; val_gene_expr_recon_loss: 92076.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171726.2344; val_optim_loss: 171726.2344
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9966; val_auprc_score: 0.9961; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 3893.0215; train_edge_recon_loss: 77216.5797; train_gene_expr_recon_loss: 91668.2355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172777.8367; train_optim_loss: 172777.8367; val_kl_reg_loss: 3770.8766; val_edge_recon_loss: 77184.5260; val_gene_expr_recon_loss: 92384.0755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173339.4792; val_optim_loss: 173339.4792

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9966; val_auprc_score: 0.9962; val_best_acc_score: 0.9754; val_best_f1_score: 0.9755; train_kl_reg_loss: 3892.2005; train_edge_recon_loss: 77397.1418; train_gene_expr_recon_loss: 91770.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173059.6461; train_optim_loss: 173059.6461; val_kl_reg_loss: 3770.1116; val_edge_recon_loss: 77770.7057; val_gene_expr_recon_loss: 92251.2161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173792.0365; val_optim_loss: 173792.0365
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 3888.6486; train_edge_recon_loss: 77361.0086; train_gene_expr_recon_loss: 91598.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172848.6102; train_optim_loss: 172848.6102; val_kl_reg_loss: 3766.4105; val_edge_recon_loss: 75970.7734; val_gene_expr_recon_loss: 92220.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171957.9167; val_optim_loss: 171957.9167
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9966; val_auprc_score: 0.9958; val_best_acc_score: 0.9749; val_best_f1_score: 0.9751; train_kl_reg_loss: 3886.2628; train_edge_recon_loss: 77300.7055; train_gene_expr_recon_loss: 91712.0371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172899.0031; train_optim_loss: 172899.0031; val_kl_reg_loss: 3759.7055; val_edge_recon_loss: 76808.9219; val_gene_expr_recon_loss: 92111.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172680.3802; val_optim_loss: 172680.3802

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 26 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9962
Val AUPRC score: 0.9953
Val best accuracy score: 0.9748
Val best F1 score: 0.9751
Val gene expr MSE score: 1.0902
Duration of model training in run 6: 0 hours, 15 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9696; val_auprc_score: 0.9709; val_best_acc_score: 0.9049; val_best_f1_score: 0.9065; train_kl_reg_loss: 584.5338; train_edge_recon_loss: 101953.8936; train_gene_expr_recon_loss: 128755.0995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231293.5252; train_optim_loss: 231293.5252; val_kl_reg_loss: 872.4455; val_edge_recon_loss: 107794.8021; val_gene_expr_recon_loss: 123080.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231748.1458; val_optim_loss: 231748.1458
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9426; val_auprc_score: 0.9421; val_best_acc_score: 0.8602; val_best_f1_score: 0.8634; train_kl_reg_loss: 3173.7869; train_edge_recon_loss: 89561.0938; train_gene_expr_recon_loss: 120431.8206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213166.6989; train_optim_loss: 213166.6989; val_kl_reg_loss: 4105.0492; val_edge_recon_loss: 84016.8542; val_gene_expr_recon_loss: 117961.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206083.1667; val_optim_loss: 206083.1667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9670; val_auprc_score: 0.9668; val_best_acc_score: 0.9009; val_best_f1_score: 0.9016; train_kl_reg_loss: 4396.1127; train_edge_recon_loss: 83774.6986; train_gene_expr_recon_loss: 114984.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203155.0817; train_optim_loss: 203155.0817; val_kl_reg_loss: 4177.4645; val_edge_recon_loss: 80608.7240; val_gene_expr_recon_loss: 113190.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197976.4844; val_optim_loss: 197976.4844
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9827; val_auprc_score: 0.9818; val_best_acc_score: 0.9315; val_best_f1_score: 0.9326; train_kl_reg_loss: 4390.4401; train_edge_recon_loss: 81386.5469; train_gene_expr_recon_loss: 110753.4165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196530.4032; train_optim_loss: 196530.4032; val_kl_reg_loss: 4433.6782; val_edge_recon_loss: 80648.7604; val_gene_expr_recon_loss: 109072.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194155.0417; val_optim_loss: 194155.0417
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9876; val_auprc_score: 0.9865; val_best_acc_score: 0.9437; val_best_f1_score: 0.9446; train_kl_reg_loss: 4646.5668; train_edge_recon_loss: 80367.2566; train_gene_expr_recon_loss: 107140.8245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192154.6472; train_optim_loss: 192154.6472; val_kl_reg_loss: 4654.1416; val_edge_recon_loss: 80273.6042; val_gene_expr_recon_loss: 106580.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191508.3177; val_optim_loss: 191508.3177
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9897; val_auprc_score: 0.9886; val_best_acc_score: 0.9508; val_best_f1_score: 0.9513; train_kl_reg_loss: 4650.6681; train_edge_recon_loss: 79677.7593; train_gene_expr_recon_loss: 104882.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189211.2230; train_optim_loss: 189211.2230; val_kl_reg_loss: 4486.8538; val_edge_recon_loss: 78613.5312; val_gene_expr_recon_loss: 104458.4635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 187558.8490; val_optim_loss: 187558.8490
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9914; val_auprc_score: 0.9901; val_best_acc_score: 0.9552; val_best_f1_score: 0.9555; train_kl_reg_loss: 4519.2073; train_edge_recon_loss: 79612.8939; train_gene_expr_recon_loss: 103227.1716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187359.2734; train_optim_loss: 187359.2734; val_kl_reg_loss: 4483.1326; val_edge_recon_loss: 77752.8021; val_gene_expr_recon_loss: 102980.3490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185216.2865; val_optim_loss: 185216.2865
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9928; val_auprc_score: 0.9919; val_best_acc_score: 0.9596; val_best_f1_score: 0.9600; train_kl_reg_loss: 4459.2958; train_edge_recon_loss: 79495.2650; train_gene_expr_recon_loss: 102016.7915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185971.3528; train_optim_loss: 185971.3528; val_kl_reg_loss: 4308.5319; val_edge_recon_loss: 76663.4115; val_gene_expr_recon_loss: 101727.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182699.3021; val_optim_loss: 182699.3021
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9936; val_auprc_score: 0.9931; val_best_acc_score: 0.9609; val_best_f1_score: 0.9610; train_kl_reg_loss: 4379.1054; train_edge_recon_loss: 78872.6232; train_gene_expr_recon_loss: 100872.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184124.0847; train_optim_loss: 184124.0847; val_kl_reg_loss: 4333.7923; val_edge_recon_loss: 77748.7526; val_gene_expr_recon_loss: 100946.4505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183028.9948; val_optim_loss: 183028.9948
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9939; val_auprc_score: 0.9932; val_best_acc_score: 0.9632; val_best_f1_score: 0.9635; train_kl_reg_loss: 4313.0953; train_edge_recon_loss: 78819.7656; train_gene_expr_recon_loss: 99882.9555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183015.8131; train_optim_loss: 183015.8131; val_kl_reg_loss: 4303.6934; val_edge_recon_loss: 79244.9245; val_gene_expr_recon_loss: 100015.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183564.4844; val_optim_loss: 183564.4844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9944; val_auprc_score: 0.9938; val_best_acc_score: 0.9655; val_best_f1_score: 0.9658; train_kl_reg_loss: 4269.3364; train_edge_recon_loss: 79237.3984; train_gene_expr_recon_loss: 98911.3386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182418.0727; train_optim_loss: 182418.0727; val_kl_reg_loss: 4223.5674; val_edge_recon_loss: 77320.7031; val_gene_expr_recon_loss: 99325.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180870.1719; val_optim_loss: 180870.1719
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9943; val_best_acc_score: 0.9679; val_best_f1_score: 0.9682; train_kl_reg_loss: 4214.5605; train_edge_recon_loss: 78657.0724; train_gene_expr_recon_loss: 98150.0334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181021.6659; train_optim_loss: 181021.6659; val_kl_reg_loss: 4174.6574; val_edge_recon_loss: 77886.8385; val_gene_expr_recon_loss: 98271.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180333.2396; val_optim_loss: 180333.2396
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9956; val_auprc_score: 0.9949; val_best_acc_score: 0.9692; val_best_f1_score: 0.9694; train_kl_reg_loss: 4184.6794; train_edge_recon_loss: 78578.2978; train_gene_expr_recon_loss: 97529.1677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180292.1454; train_optim_loss: 180292.1454; val_kl_reg_loss: 4101.9069; val_edge_recon_loss: 76860.2995; val_gene_expr_recon_loss: 97681.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178643.3958; val_optim_loss: 178643.3958
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9954; val_auprc_score: 0.9946; val_best_acc_score: 0.9695; val_best_f1_score: 0.9697; train_kl_reg_loss: 4137.4253; train_edge_recon_loss: 78110.5959; train_gene_expr_recon_loss: 96979.9498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179227.9712; train_optim_loss: 179227.9712; val_kl_reg_loss: 4046.1252; val_edge_recon_loss: 77781.8750; val_gene_expr_recon_loss: 97172.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179000.6146; val_optim_loss: 179000.6146
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9716; val_best_f1_score: 0.9718; train_kl_reg_loss: 4097.3532; train_edge_recon_loss: 78240.1331; train_gene_expr_recon_loss: 96220.0276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178557.5150; train_optim_loss: 178557.5150; val_kl_reg_loss: 4042.8963; val_edge_recon_loss: 77257.8073; val_gene_expr_recon_loss: 96458.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177758.7240; val_optim_loss: 177758.7240
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9965; val_auprc_score: 0.9958; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 4061.2891; train_edge_recon_loss: 77683.6343; train_gene_expr_recon_loss: 95624.1731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177369.0962; train_optim_loss: 177369.0962; val_kl_reg_loss: 3964.9153; val_edge_recon_loss: 76388.7839; val_gene_expr_recon_loss: 95863.9818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176217.6771; val_optim_loss: 176217.6771
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9962; val_auprc_score: 0.9955; val_best_acc_score: 0.9733; val_best_f1_score: 0.9735; train_kl_reg_loss: 4037.1673; train_edge_recon_loss: 77813.4183; train_gene_expr_recon_loss: 95153.3011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177003.8840; train_optim_loss: 177003.8840; val_kl_reg_loss: 3971.9861; val_edge_recon_loss: 76076.6120; val_gene_expr_recon_loss: 95424.5990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175473.1979; val_optim_loss: 175473.1979
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9960; val_best_acc_score: 0.9746; val_best_f1_score: 0.9748; train_kl_reg_loss: 4012.2517; train_edge_recon_loss: 77527.3311; train_gene_expr_recon_loss: 94670.9997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176210.5817; train_optim_loss: 176210.5817; val_kl_reg_loss: 4015.8786; val_edge_recon_loss: 77192.5339; val_gene_expr_recon_loss: 95047.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176255.5781; val_optim_loss: 176255.5781
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9970; val_auprc_score: 0.9965; val_best_acc_score: 0.9755; val_best_f1_score: 0.9757; train_kl_reg_loss: 4008.7980; train_edge_recon_loss: 77534.8350; train_gene_expr_recon_loss: 94363.2662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175906.8996; train_optim_loss: 175906.8996; val_kl_reg_loss: 3956.2843; val_edge_recon_loss: 77263.5521; val_gene_expr_recon_loss: 94729.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175949.4896; val_optim_loss: 175949.4896
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9969; val_auprc_score: 0.9963; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 3986.9366; train_edge_recon_loss: 77682.2320; train_gene_expr_recon_loss: 93907.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175576.2951; train_optim_loss: 175576.2951; val_kl_reg_loss: 3945.0112; val_edge_recon_loss: 76448.7760; val_gene_expr_recon_loss: 93963.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174356.8542; val_optim_loss: 174356.8542
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9970; val_auprc_score: 0.9963; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 3993.6270; train_edge_recon_loss: 77610.3089; train_gene_expr_recon_loss: 93595.6139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175199.5499; train_optim_loss: 175199.5499; val_kl_reg_loss: 3881.8396; val_edge_recon_loss: 75966.9453; val_gene_expr_recon_loss: 93881.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173730.1406; val_optim_loss: 173730.1406
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9971; val_auprc_score: 0.9965; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 3969.1423; train_edge_recon_loss: 77578.0153; train_gene_expr_recon_loss: 93042.9426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174590.0998; train_optim_loss: 174590.0998; val_kl_reg_loss: 3945.7347; val_edge_recon_loss: 75461.4193; val_gene_expr_recon_loss: 93499.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172906.5260; val_optim_loss: 172906.5260
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9780; val_best_f1_score: 0.9782; train_kl_reg_loss: 3956.4269; train_edge_recon_loss: 76987.7767; train_gene_expr_recon_loss: 92750.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173694.8359; train_optim_loss: 173694.8359; val_kl_reg_loss: 3911.3028; val_edge_recon_loss: 76900.7526; val_gene_expr_recon_loss: 93179.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173991.0938; val_optim_loss: 173991.0938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 3952.8985; train_edge_recon_loss: 77293.0129; train_gene_expr_recon_loss: 92592.4032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173838.3149; train_optim_loss: 173838.3149; val_kl_reg_loss: 3957.3723; val_edge_recon_loss: 76552.5391; val_gene_expr_recon_loss: 92985.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173495.0885; val_optim_loss: 173495.0885
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9790; val_best_f1_score: 0.9792; train_kl_reg_loss: 3948.2257; train_edge_recon_loss: 77484.7611; train_gene_expr_recon_loss: 92113.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173546.3095; train_optim_loss: 173546.3095; val_kl_reg_loss: 3931.6114; val_edge_recon_loss: 75451.8984; val_gene_expr_recon_loss: 92530.4818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171913.9948; val_optim_loss: 171913.9948
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9973; val_auprc_score: 0.9968; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 3657.6329; train_edge_recon_loss: 77045.2915; train_gene_expr_recon_loss: 91831.8338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172534.7572; train_optim_loss: 172534.7572; val_kl_reg_loss: 3331.0420; val_edge_recon_loss: 76026.5703; val_gene_expr_recon_loss: 92226.4401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171584.0573; val_optim_loss: 171584.0573
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 3490.0831; train_edge_recon_loss: 76867.0700; train_gene_expr_recon_loss: 91691.6746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172048.8257; train_optim_loss: 172048.8257; val_kl_reg_loss: 3347.1922; val_edge_recon_loss: 77143.0964; val_gene_expr_recon_loss: 92107.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172598.1823; val_optim_loss: 172598.1823
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9963; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 3444.5057; train_edge_recon_loss: 76913.7770; train_gene_expr_recon_loss: 91326.6932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171684.9754; train_optim_loss: 171684.9754; val_kl_reg_loss: 3335.7339; val_edge_recon_loss: 76518.5052; val_gene_expr_recon_loss: 91860.6615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171714.9010; val_optim_loss: 171714.9010
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 3431.6907; train_edge_recon_loss: 76816.8173; train_gene_expr_recon_loss: 91206.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171454.5319; train_optim_loss: 171454.5319; val_kl_reg_loss: 3337.9812; val_edge_recon_loss: 76476.8385; val_gene_expr_recon_loss: 91678.3724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171493.1927; val_optim_loss: 171493.1927
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 3407.0080; train_edge_recon_loss: 76805.7488; train_gene_expr_recon_loss: 90992.2094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171204.9657; train_optim_loss: 171204.9657; val_kl_reg_loss: 3295.2527; val_edge_recon_loss: 75704.8620; val_gene_expr_recon_loss: 91476.9714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170477.0833; val_optim_loss: 170477.0833
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 3390.8992; train_edge_recon_loss: 77075.5433; train_gene_expr_recon_loss: 90690.7485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171157.1893; train_optim_loss: 171157.1893; val_kl_reg_loss: 3268.3945; val_edge_recon_loss: 74475.5443; val_gene_expr_recon_loss: 91194.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168938.6146; val_optim_loss: 168938.6146
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9821; val_best_f1_score: 0.9821; train_kl_reg_loss: 3376.9330; train_edge_recon_loss: 76619.9168; train_gene_expr_recon_loss: 90689.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170685.9639; train_optim_loss: 170685.9639; val_kl_reg_loss: 3309.2438; val_edge_recon_loss: 76134.3151; val_gene_expr_recon_loss: 90906.5495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170350.1146; val_optim_loss: 170350.1146
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 3373.9237; train_edge_recon_loss: 76341.6061; train_gene_expr_recon_loss: 90320.6716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170036.2007; train_optim_loss: 170036.2007; val_kl_reg_loss: 3313.9530; val_edge_recon_loss: 75333.3490; val_gene_expr_recon_loss: 90913.4427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169560.7396; val_optim_loss: 169560.7396
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 3352.8201; train_edge_recon_loss: 76284.0108; train_gene_expr_recon_loss: 90137.8227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169774.6526; train_optim_loss: 169774.6526; val_kl_reg_loss: 3298.5109; val_edge_recon_loss: 75637.3698; val_gene_expr_recon_loss: 90803.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169739.8125; val_optim_loss: 169739.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 3360.6142; train_edge_recon_loss: 76912.5541; train_gene_expr_recon_loss: 90053.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170326.7656; train_optim_loss: 170326.7656; val_kl_reg_loss: 3294.4180; val_edge_recon_loss: 75583.7057; val_gene_expr_recon_loss: 90582.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169460.2865; val_optim_loss: 169460.2865
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9980; val_auprc_score: 0.9976; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 3351.4219; train_edge_recon_loss: 76396.2587; train_gene_expr_recon_loss: 89975.8068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169723.4862; train_optim_loss: 169723.4862; val_kl_reg_loss: 3301.7365; val_edge_recon_loss: 74871.6927; val_gene_expr_recon_loss: 90478.0885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168651.5208; val_optim_loss: 168651.5208
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 3352.1495; train_edge_recon_loss: 76707.1926; train_gene_expr_recon_loss: 90007.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170067.0685; train_optim_loss: 170067.0685; val_kl_reg_loss: 3279.4915; val_edge_recon_loss: 74756.1562; val_gene_expr_recon_loss: 90611.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168646.9740; val_optim_loss: 168646.9740
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 3355.2709; train_edge_recon_loss: 76637.2248; train_gene_expr_recon_loss: 89916.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169909.0529; train_optim_loss: 169909.0529; val_kl_reg_loss: 3293.6181; val_edge_recon_loss: 76456.4427; val_gene_expr_recon_loss: 90714.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170464.1667; val_optim_loss: 170464.1667
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 3346.8321; train_edge_recon_loss: 76200.1578; train_gene_expr_recon_loss: 90090.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169637.8516; train_optim_loss: 169637.8516; val_kl_reg_loss: 3290.1750; val_edge_recon_loss: 76479.6406; val_gene_expr_recon_loss: 90429.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170199.5781; val_optim_loss: 170199.5781
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 3349.5483; train_edge_recon_loss: 76792.9459; train_gene_expr_recon_loss: 89821.7641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169964.2578; train_optim_loss: 169964.2578; val_kl_reg_loss: 3288.6723; val_edge_recon_loss: 76443.0547; val_gene_expr_recon_loss: 90556.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170288.4688; val_optim_loss: 170288.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 3343.8349; train_edge_recon_loss: 76693.7154; train_gene_expr_recon_loss: 89952.1656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169989.7163; train_optim_loss: 169989.7163; val_kl_reg_loss: 3290.0920; val_edge_recon_loss: 76944.0964; val_gene_expr_recon_loss: 90569.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170804.0156; val_optim_loss: 170804.0156
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9824; val_best_f1_score: 0.9825; train_kl_reg_loss: 3347.2999; train_edge_recon_loss: 76329.6866; train_gene_expr_recon_loss: 89937.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169614.2145; train_optim_loss: 169614.2145; val_kl_reg_loss: 3292.2665; val_edge_recon_loss: 75242.2943; val_gene_expr_recon_loss: 90546.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169080.7344; val_optim_loss: 169080.7344
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 3348.2140; train_edge_recon_loss: 76671.1475; train_gene_expr_recon_loss: 89873.4624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169892.8233; train_optim_loss: 169892.8233; val_kl_reg_loss: 3294.9149; val_edge_recon_loss: 77962.3385; val_gene_expr_recon_loss: 90607.5521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171864.8073; val_optim_loss: 171864.8073

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 56 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9978
Val AUPRC score: 0.9970
Val best accuracy score: 0.9822
Val best F1 score: 0.9823
Val gene expr MSE score: 1.0302
Duration of model training in run 7: 0 hours, 26 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9739; val_auprc_score: 0.9750; val_best_acc_score: 0.9088; val_best_f1_score: 0.9115; train_kl_reg_loss: 670.1074; train_edge_recon_loss: 102615.1016; train_gene_expr_recon_loss: 129229.2115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232514.4207; train_optim_loss: 232514.4207; val_kl_reg_loss: 1027.9084; val_edge_recon_loss: 109284.0339; val_gene_expr_recon_loss: 121087.1510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231399.0885; val_optim_loss: 231399.0885
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9424; val_auprc_score: 0.9420; val_best_acc_score: 0.8620; val_best_f1_score: 0.8653; train_kl_reg_loss: 3117.3918; train_edge_recon_loss: 90846.3621; train_gene_expr_recon_loss: 119279.2404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213242.9964; train_optim_loss: 213242.9964; val_kl_reg_loss: 4326.0540; val_edge_recon_loss: 83897.6042; val_gene_expr_recon_loss: 115345.3776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 203569.0365; val_optim_loss: 203569.0365
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9666; val_auprc_score: 0.9665; val_best_acc_score: 0.8997; val_best_f1_score: 0.9007; train_kl_reg_loss: 4454.3727; train_edge_recon_loss: 83935.9366; train_gene_expr_recon_loss: 113546.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201937.0757; train_optim_loss: 201937.0757; val_kl_reg_loss: 4305.4624; val_edge_recon_loss: 81241.5521; val_gene_expr_recon_loss: 110644.7682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196191.7865; val_optim_loss: 196191.7865
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9810; val_auprc_score: 0.9796; val_best_acc_score: 0.9284; val_best_f1_score: 0.9293; train_kl_reg_loss: 4417.8585; train_edge_recon_loss: 81379.6920; train_gene_expr_recon_loss: 109147.0691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194944.6214; train_optim_loss: 194944.6214; val_kl_reg_loss: 4400.6110; val_edge_recon_loss: 81057.5547; val_gene_expr_recon_loss: 106370.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191828.4375; val_optim_loss: 191828.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9867; val_auprc_score: 0.9854; val_best_acc_score: 0.9412; val_best_f1_score: 0.9419; train_kl_reg_loss: 4583.3584; train_edge_recon_loss: 80444.6671; train_gene_expr_recon_loss: 105922.9985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190951.0228; train_optim_loss: 190951.0228; val_kl_reg_loss: 4566.7087; val_edge_recon_loss: 79637.3099; val_gene_expr_recon_loss: 103800.3464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188004.3646; val_optim_loss: 188004.3646
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9899; val_auprc_score: 0.9887; val_best_acc_score: 0.9503; val_best_f1_score: 0.9507; train_kl_reg_loss: 4574.7692; train_edge_recon_loss: 80119.4402; train_gene_expr_recon_loss: 103239.0433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 187933.2518; train_optim_loss: 187933.2518; val_kl_reg_loss: 4537.6807; val_edge_recon_loss: 79184.0182; val_gene_expr_recon_loss: 102280.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186002.1510; val_optim_loss: 186002.1510
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9915; val_auprc_score: 0.9908; val_best_acc_score: 0.9542; val_best_f1_score: 0.9547; train_kl_reg_loss: 4498.0220; train_edge_recon_loss: 79809.7215; train_gene_expr_recon_loss: 101698.8119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186006.5547; train_optim_loss: 186006.5547; val_kl_reg_loss: 4368.2578; val_edge_recon_loss: 80388.4896; val_gene_expr_recon_loss: 100617.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185374.7031; val_optim_loss: 185374.7031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9930; val_auprc_score: 0.9920; val_best_acc_score: 0.9593; val_best_f1_score: 0.9597; train_kl_reg_loss: 4395.3989; train_edge_recon_loss: 79022.4270; train_gene_expr_recon_loss: 100343.3230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183761.1490; train_optim_loss: 183761.1490; val_kl_reg_loss: 4324.7843; val_edge_recon_loss: 79103.1120; val_gene_expr_recon_loss: 99434.7474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182862.6458; val_optim_loss: 182862.6458
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9938; val_auprc_score: 0.9931; val_best_acc_score: 0.9628; val_best_f1_score: 0.9631; train_kl_reg_loss: 4340.9116; train_edge_recon_loss: 78914.2133; train_gene_expr_recon_loss: 99327.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182582.2169; train_optim_loss: 182582.2169; val_kl_reg_loss: 4301.0065; val_edge_recon_loss: 78710.4922; val_gene_expr_recon_loss: 98601.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 181613.3958; val_optim_loss: 181613.3958
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9942; val_auprc_score: 0.9932; val_best_acc_score: 0.9652; val_best_f1_score: 0.9655; train_kl_reg_loss: 4277.6107; train_edge_recon_loss: 78944.7329; train_gene_expr_recon_loss: 98482.1980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181704.5403; train_optim_loss: 181704.5403; val_kl_reg_loss: 4154.6536; val_edge_recon_loss: 78130.6901; val_gene_expr_recon_loss: 97777.3932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180062.7396; val_optim_loss: 180062.7396
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9946; val_auprc_score: 0.9937; val_best_acc_score: 0.9665; val_best_f1_score: 0.9669; train_kl_reg_loss: 4205.3301; train_edge_recon_loss: 78615.9474; train_gene_expr_recon_loss: 97644.0258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180465.3029; train_optim_loss: 180465.3029; val_kl_reg_loss: 4166.1447; val_edge_recon_loss: 77885.4948; val_gene_expr_recon_loss: 96886.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178938.2656; val_optim_loss: 178938.2656
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9945; val_best_acc_score: 0.9681; val_best_f1_score: 0.9684; train_kl_reg_loss: 4165.3899; train_edge_recon_loss: 78416.8113; train_gene_expr_recon_loss: 97035.7386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179617.9405; train_optim_loss: 179617.9405; val_kl_reg_loss: 4062.0884; val_edge_recon_loss: 77180.3594; val_gene_expr_recon_loss: 96350.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177593.2500; val_optim_loss: 177593.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9955; val_auprc_score: 0.9948; val_best_acc_score: 0.9696; val_best_f1_score: 0.9698; train_kl_reg_loss: 4118.1554; train_edge_recon_loss: 77770.6701; train_gene_expr_recon_loss: 96395.0535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178283.8792; train_optim_loss: 178283.8792; val_kl_reg_loss: 4033.2265; val_edge_recon_loss: 77902.4375; val_gene_expr_recon_loss: 95585.7682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177521.4323; val_optim_loss: 177521.4323
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9959; val_auprc_score: 0.9952; val_best_acc_score: 0.9714; val_best_f1_score: 0.9716; train_kl_reg_loss: 4100.7250; train_edge_recon_loss: 78330.6878; train_gene_expr_recon_loss: 95875.9423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178307.3546; train_optim_loss: 178307.3546; val_kl_reg_loss: 4057.5504; val_edge_recon_loss: 76878.5833; val_gene_expr_recon_loss: 95241.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176177.8750; val_optim_loss: 176177.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9960; val_auprc_score: 0.9953; val_best_acc_score: 0.9721; val_best_f1_score: 0.9723; train_kl_reg_loss: 4062.9019; train_edge_recon_loss: 77942.5718; train_gene_expr_recon_loss: 95147.6487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177153.1232; train_optim_loss: 177153.1232; val_kl_reg_loss: 4048.3623; val_edge_recon_loss: 76782.1172; val_gene_expr_recon_loss: 94461.1276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175291.6042; val_optim_loss: 175291.6042
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9956; val_best_acc_score: 0.9738; val_best_f1_score: 0.9739; train_kl_reg_loss: 4041.1553; train_edge_recon_loss: 77876.4564; train_gene_expr_recon_loss: 94833.8498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176751.4615; train_optim_loss: 176751.4615; val_kl_reg_loss: 3960.0592; val_edge_recon_loss: 76812.3594; val_gene_expr_recon_loss: 94097.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174870.2812; val_optim_loss: 174870.2812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9965; val_auprc_score: 0.9957; val_best_acc_score: 0.9737; val_best_f1_score: 0.9740; train_kl_reg_loss: 4028.7822; train_edge_recon_loss: 77740.7157; train_gene_expr_recon_loss: 94386.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176155.7284; train_optim_loss: 176155.7284; val_kl_reg_loss: 3962.3674; val_edge_recon_loss: 76580.1797; val_gene_expr_recon_loss: 93698.9557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174241.5052; val_optim_loss: 174241.5052
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9753; val_best_f1_score: 0.9755; train_kl_reg_loss: 4022.7316; train_edge_recon_loss: 77978.6689; train_gene_expr_recon_loss: 94031.9537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176033.3516; train_optim_loss: 176033.3516; val_kl_reg_loss: 3933.3748; val_edge_recon_loss: 76611.3906; val_gene_expr_recon_loss: 93259.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173804.6146; val_optim_loss: 173804.6146
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9968; val_auprc_score: 0.9962; val_best_acc_score: 0.9752; val_best_f1_score: 0.9754; train_kl_reg_loss: 4000.1199; train_edge_recon_loss: 77387.2094; train_gene_expr_recon_loss: 93636.0210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175023.3504; train_optim_loss: 175023.3504; val_kl_reg_loss: 3918.3180; val_edge_recon_loss: 76864.0052; val_gene_expr_recon_loss: 93037.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173820.0938; val_optim_loss: 173820.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9770; val_best_f1_score: 0.9771; train_kl_reg_loss: 3984.5767; train_edge_recon_loss: 77647.4814; train_gene_expr_recon_loss: 93198.3561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174830.4147; train_optim_loss: 174830.4147; val_kl_reg_loss: 3934.3984; val_edge_recon_loss: 75711.3802; val_gene_expr_recon_loss: 92429.1693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172074.9479; val_optim_loss: 172074.9479
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9764; val_best_f1_score: 0.9766; train_kl_reg_loss: 3974.5126; train_edge_recon_loss: 77850.6004; train_gene_expr_recon_loss: 92944.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174769.4886; train_optim_loss: 174769.4886; val_kl_reg_loss: 3974.5261; val_edge_recon_loss: 76321.6250; val_gene_expr_recon_loss: 92382.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172678.8542; val_optim_loss: 172678.8542
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 3967.2600; train_edge_recon_loss: 77237.4691; train_gene_expr_recon_loss: 92578.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173783.4459; train_optim_loss: 173783.4459; val_kl_reg_loss: 3932.7959; val_edge_recon_loss: 76912.1615; val_gene_expr_recon_loss: 91988.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172833.5052; val_optim_loss: 172833.5052
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9974; val_auprc_score: 0.9969; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 3961.1888; train_edge_recon_loss: 77657.2215; train_gene_expr_recon_loss: 92194.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173812.9772; train_optim_loss: 173812.9772; val_kl_reg_loss: 3880.3426; val_edge_recon_loss: 75603.3047; val_gene_expr_recon_loss: 91631.0130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171114.6615; val_optim_loss: 171114.6615
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9787; val_best_f1_score: 0.9788; train_kl_reg_loss: 3960.5328; train_edge_recon_loss: 77377.6578; train_gene_expr_recon_loss: 91849.4477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173187.6370; train_optim_loss: 173187.6370; val_kl_reg_loss: 3879.5431; val_edge_recon_loss: 76016.6745; val_gene_expr_recon_loss: 91530.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171427.1719; val_optim_loss: 171427.1719
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9783; val_best_f1_score: 0.9784; train_kl_reg_loss: 3957.5637; train_edge_recon_loss: 77512.4606; train_gene_expr_recon_loss: 91556.7984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173026.8227; train_optim_loss: 173026.8227; val_kl_reg_loss: 3914.0221; val_edge_recon_loss: 76836.5651; val_gene_expr_recon_loss: 91199.6068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171950.1979; val_optim_loss: 171950.1979
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 3879.5626; train_edge_recon_loss: 76943.3927; train_gene_expr_recon_loss: 91421.5316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172244.4886; train_optim_loss: 172244.4886; val_kl_reg_loss: 3738.4033; val_edge_recon_loss: 76402.7995; val_gene_expr_recon_loss: 90907.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171048.8073; val_optim_loss: 171048.8073
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9976; val_auprc_score: 0.9972; val_best_acc_score: 0.9793; val_best_f1_score: 0.9794; train_kl_reg_loss: 3833.0627; train_edge_recon_loss: 77194.8194; train_gene_expr_recon_loss: 91055.9017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172083.7843; train_optim_loss: 172083.7843; val_kl_reg_loss: 3732.9798; val_edge_recon_loss: 76944.4922; val_gene_expr_recon_loss: 90484.1354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171161.6042; val_optim_loss: 171161.6042
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9977; val_auprc_score: 0.9973; val_best_acc_score: 0.9801; val_best_f1_score: 0.9803; train_kl_reg_loss: 3801.5317; train_edge_recon_loss: 77057.4132; train_gene_expr_recon_loss: 90902.3179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171761.2638; train_optim_loss: 171761.2638; val_kl_reg_loss: 3664.5563; val_edge_recon_loss: 75174.3099; val_gene_expr_recon_loss: 90411.2135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169250.0781; val_optim_loss: 169250.0781
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 3780.7845; train_edge_recon_loss: 77042.8176; train_gene_expr_recon_loss: 90668.2302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171491.8329; train_optim_loss: 171491.8329; val_kl_reg_loss: 3703.4544; val_edge_recon_loss: 76147.0495; val_gene_expr_recon_loss: 90244.3307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170094.8333; val_optim_loss: 170094.8333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9977; val_auprc_score: 0.9974; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 3767.9100; train_edge_recon_loss: 76800.7846; train_gene_expr_recon_loss: 90523.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171092.2043; train_optim_loss: 171092.2043; val_kl_reg_loss: 3713.8446; val_edge_recon_loss: 75250.0104; val_gene_expr_recon_loss: 89876.3776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168840.2344; val_optim_loss: 168840.2344
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 3769.0848; train_edge_recon_loss: 76870.6214; train_gene_expr_recon_loss: 90326.3855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170966.0919; train_optim_loss: 170966.0919; val_kl_reg_loss: 3742.0816; val_edge_recon_loss: 77287.2292; val_gene_expr_recon_loss: 89560.8255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170590.1406; val_optim_loss: 170590.1406
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 3754.7128; train_edge_recon_loss: 76758.7972; train_gene_expr_recon_loss: 90038.2452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170551.7548; train_optim_loss: 170551.7548; val_kl_reg_loss: 3716.2164; val_edge_recon_loss: 76801.0339; val_gene_expr_recon_loss: 89680.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170198.0833; val_optim_loss: 170198.0833
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 3740.5156; train_edge_recon_loss: 76630.6827; train_gene_expr_recon_loss: 89937.3960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170308.5968; train_optim_loss: 170308.5968; val_kl_reg_loss: 3644.0033; val_edge_recon_loss: 74978.6901; val_gene_expr_recon_loss: 89330.0052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167952.6979; val_optim_loss: 167952.6979
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 3736.5074; train_edge_recon_loss: 77167.0150; train_gene_expr_recon_loss: 89710.4059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170613.9267; train_optim_loss: 170613.9267; val_kl_reg_loss: 3685.9224; val_edge_recon_loss: 76889.8099; val_gene_expr_recon_loss: 89152.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169728.6823; val_optim_loss: 169728.6823
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9979; val_auprc_score: 0.9976; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 3719.8493; train_edge_recon_loss: 76609.9402; train_gene_expr_recon_loss: 89428.3329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169758.1238; train_optim_loss: 169758.1238; val_kl_reg_loss: 3657.0262; val_edge_recon_loss: 75706.0052; val_gene_expr_recon_loss: 89205.4401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168568.4740; val_optim_loss: 168568.4740
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 3718.6791; train_edge_recon_loss: 76771.0922; train_gene_expr_recon_loss: 89437.3248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169927.0956; train_optim_loss: 169927.0956; val_kl_reg_loss: 3666.2333; val_edge_recon_loss: 74898.1302; val_gene_expr_recon_loss: 88992.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167556.5312; val_optim_loss: 167556.5312
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9824; val_best_f1_score: 0.9824; train_kl_reg_loss: 3702.4325; train_edge_recon_loss: 76506.8861; train_gene_expr_recon_loss: 89031.1929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169240.5120; train_optim_loss: 169240.5120; val_kl_reg_loss: 3603.0122; val_edge_recon_loss: 74860.0234; val_gene_expr_recon_loss: 88846.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167309.9531; val_optim_loss: 167309.9531
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9982; val_auprc_score: 0.9979; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 3707.1643; train_edge_recon_loss: 76583.6863; train_gene_expr_recon_loss: 89036.3143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169327.1653; train_optim_loss: 169327.1653; val_kl_reg_loss: 3649.9648; val_edge_recon_loss: 76772.7839; val_gene_expr_recon_loss: 88639.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169062.4635; val_optim_loss: 169062.4635
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9981; val_auprc_score: 0.9977; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 3700.3293; train_edge_recon_loss: 76638.8413; train_gene_expr_recon_loss: 88942.5346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169281.7067; train_optim_loss: 169281.7067; val_kl_reg_loss: 3669.1847; val_edge_recon_loss: 75947.4271; val_gene_expr_recon_loss: 88425.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168041.6667; val_optim_loss: 168041.6667
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 3703.4408; train_edge_recon_loss: 76591.9044; train_gene_expr_recon_loss: 88753.4231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169048.7680; train_optim_loss: 169048.7680; val_kl_reg_loss: 3643.4116; val_edge_recon_loss: 74627.5703; val_gene_expr_recon_loss: 88275.1849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166546.1667; val_optim_loss: 166546.1667
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9836; val_best_f1_score: 0.9836; train_kl_reg_loss: 3702.1680; train_edge_recon_loss: 76964.9973; train_gene_expr_recon_loss: 88611.5105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169278.6761; train_optim_loss: 169278.6761; val_kl_reg_loss: 3675.2325; val_edge_recon_loss: 76052.6458; val_gene_expr_recon_loss: 88212.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167940.2500; val_optim_loss: 167940.2500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3699.8128; train_edge_recon_loss: 76797.9357; train_gene_expr_recon_loss: 88634.3377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169132.0865; train_optim_loss: 169132.0865; val_kl_reg_loss: 3622.9653; val_edge_recon_loss: 74643.1797; val_gene_expr_recon_loss: 88118.8854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166385.0312; val_optim_loss: 166385.0312
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9833; val_best_f1_score: 0.9833; train_kl_reg_loss: 3694.1907; train_edge_recon_loss: 76518.6463; train_gene_expr_recon_loss: 88313.6608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168526.4988; train_optim_loss: 168526.4988; val_kl_reg_loss: 3630.8999; val_edge_recon_loss: 76337.5312; val_gene_expr_recon_loss: 88088.9193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168057.3490; val_optim_loss: 168057.3490
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3692.8414; train_edge_recon_loss: 76759.6022; train_gene_expr_recon_loss: 88335.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168788.2278; train_optim_loss: 168788.2278; val_kl_reg_loss: 3626.6366; val_edge_recon_loss: 76525.0964; val_gene_expr_recon_loss: 87918.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168069.8125; val_optim_loss: 168069.8125
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 3683.4494; train_edge_recon_loss: 76493.6115; train_gene_expr_recon_loss: 88155.7861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168332.8468; train_optim_loss: 168332.8468; val_kl_reg_loss: 3672.6968; val_edge_recon_loss: 75308.1927; val_gene_expr_recon_loss: 87702.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166683.2604; val_optim_loss: 166683.2604

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 3690.3642; train_edge_recon_loss: 76758.4898; train_gene_expr_recon_loss: 88015.8380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168464.6917; train_optim_loss: 168464.6917; val_kl_reg_loss: 3628.4750; val_edge_recon_loss: 76102.6406; val_gene_expr_recon_loss: 87756.3490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167487.4635; val_optim_loss: 167487.4635
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9983; val_auprc_score: 0.9980; val_best_acc_score: 0.9840; val_best_f1_score: 0.9840; train_kl_reg_loss: 3686.1705; train_edge_recon_loss: 76456.2368; train_gene_expr_recon_loss: 87929.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168072.3203; train_optim_loss: 168072.3203; val_kl_reg_loss: 3638.4083; val_edge_recon_loss: 75944.9375; val_gene_expr_recon_loss: 87544.2005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167127.5469; val_optim_loss: 167127.5469
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3680.4590; train_edge_recon_loss: 76361.5886; train_gene_expr_recon_loss: 87853.2575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167895.3047; train_optim_loss: 167895.3047; val_kl_reg_loss: 3635.7436; val_edge_recon_loss: 75592.5990; val_gene_expr_recon_loss: 87690.6745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166919.0156; val_optim_loss: 166919.0156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 7 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9982
Val AUPRC score: 0.9975
Val best accuracy score: 0.9839
Val best F1 score: 0.9840
Val gene expr MSE score: 0.9339
Duration of model training in run 8: 0 hours, 29 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9470; val_auprc_score: 0.9465; val_best_acc_score: 0.8707; val_best_f1_score: 0.8735; train_kl_reg_loss: 703.4577; train_edge_recon_loss: 101249.9609; train_gene_expr_recon_loss: 129583.5857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231537.0043; train_optim_loss: 231537.0043; val_kl_reg_loss: 1617.7157; val_edge_recon_loss: 92865.7480; val_gene_expr_recon_loss: 121944.3691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216427.8281; val_optim_loss: 216427.8281
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9552; val_auprc_score: 0.9549; val_best_acc_score: 0.8819; val_best_f1_score: 0.8826; train_kl_reg_loss: 4055.8184; train_edge_recon_loss: 86411.0582; train_gene_expr_recon_loss: 118912.5166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209379.3920; train_optim_loss: 209379.3920; val_kl_reg_loss: 4520.1659; val_edge_recon_loss: 81960.7285; val_gene_expr_recon_loss: 114154.0293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200634.9219; val_optim_loss: 200634.9219
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9796; val_auprc_score: 0.9787; val_best_acc_score: 0.9250; val_best_f1_score: 0.9259; train_kl_reg_loss: 4493.6712; train_edge_recon_loss: 82267.5170; train_gene_expr_recon_loss: 111661.5537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198422.7443; train_optim_loss: 198422.7443; val_kl_reg_loss: 4469.1639; val_edge_recon_loss: 80238.2949; val_gene_expr_recon_loss: 108322.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193030.2734; val_optim_loss: 193030.2734
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9877; val_auprc_score: 0.9868; val_best_acc_score: 0.9440; val_best_f1_score: 0.9446; train_kl_reg_loss: 4650.2402; train_edge_recon_loss: 80958.6515; train_gene_expr_recon_loss: 106511.5218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192120.4148; train_optim_loss: 192120.4148; val_kl_reg_loss: 4725.6812; val_edge_recon_loss: 80288.6309; val_gene_expr_recon_loss: 104085.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 189099.3828; val_optim_loss: 189099.3828
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9912; val_auprc_score: 0.9903; val_best_acc_score: 0.9538; val_best_f1_score: 0.9543; train_kl_reg_loss: 4679.8089; train_edge_recon_loss: 80309.4500; train_gene_expr_recon_loss: 103275.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 188264.2713; train_optim_loss: 188264.2713; val_kl_reg_loss: 4444.5813; val_edge_recon_loss: 79024.6953; val_gene_expr_recon_loss: 101665.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 185134.9766; val_optim_loss: 185134.9766
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9927; val_auprc_score: 0.9918; val_best_acc_score: 0.9597; val_best_f1_score: 0.9602; train_kl_reg_loss: 4524.2746; train_edge_recon_loss: 79161.4709; train_gene_expr_recon_loss: 101175.3719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184861.1160; train_optim_loss: 184861.1160; val_kl_reg_loss: 4443.1036; val_edge_recon_loss: 78275.0566; val_gene_expr_recon_loss: 100104.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182822.8945; val_optim_loss: 182822.8945
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9934; val_auprc_score: 0.9926; val_best_acc_score: 0.9628; val_best_f1_score: 0.9631; train_kl_reg_loss: 4415.7771; train_edge_recon_loss: 79372.3549; train_gene_expr_recon_loss: 99683.2699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183471.4006; train_optim_loss: 183471.4006; val_kl_reg_loss: 4337.2826; val_edge_recon_loss: 79520.2266; val_gene_expr_recon_loss: 98353.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 182210.6016; val_optim_loss: 182210.6016
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9944; val_auprc_score: 0.9937; val_best_acc_score: 0.9656; val_best_f1_score: 0.9659; train_kl_reg_loss: 4313.0546; train_edge_recon_loss: 78985.5329; train_gene_expr_recon_loss: 98431.2846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181729.8722; train_optim_loss: 181729.8722; val_kl_reg_loss: 4233.9298; val_edge_recon_loss: 78478.8848; val_gene_expr_recon_loss: 97367.1230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180079.9375; val_optim_loss: 180079.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9951; val_auprc_score: 0.9944; val_best_acc_score: 0.9680; val_best_f1_score: 0.9682; train_kl_reg_loss: 4236.2975; train_edge_recon_loss: 78481.0464; train_gene_expr_recon_loss: 97341.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180059.0985; train_optim_loss: 180059.0985; val_kl_reg_loss: 4134.4260; val_edge_recon_loss: 76661.2871; val_gene_expr_recon_loss: 96388.8184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177184.5312; val_optim_loss: 177184.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9955; val_auprc_score: 0.9946; val_best_acc_score: 0.9703; val_best_f1_score: 0.9704; train_kl_reg_loss: 4162.4005; train_edge_recon_loss: 78433.2159; train_gene_expr_recon_loss: 96475.1648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179070.7817; train_optim_loss: 179070.7817; val_kl_reg_loss: 4077.1493; val_edge_recon_loss: 77862.7832; val_gene_expr_recon_loss: 95771.3887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 177711.3203; val_optim_loss: 177711.3203
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9957; val_auprc_score: 0.9950; val_best_acc_score: 0.9706; val_best_f1_score: 0.9709; train_kl_reg_loss: 4104.4374; train_edge_recon_loss: 78334.9515; train_gene_expr_recon_loss: 95757.5251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178196.9138; train_optim_loss: 178196.9138; val_kl_reg_loss: 4078.0690; val_edge_recon_loss: 77953.9141; val_gene_expr_recon_loss: 94907.5176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 176939.5078; val_optim_loss: 176939.5078
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9723; val_best_f1_score: 0.9724; train_kl_reg_loss: 4071.6140; train_edge_recon_loss: 78222.1503; train_gene_expr_recon_loss: 95012.0185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 177305.7827; train_optim_loss: 177305.7827; val_kl_reg_loss: 4053.8687; val_edge_recon_loss: 76830.2871; val_gene_expr_recon_loss: 94358.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175242.6289; val_optim_loss: 175242.6289
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9964; val_auprc_score: 0.9955; val_best_acc_score: 0.9735; val_best_f1_score: 0.9737; train_kl_reg_loss: 4040.8443; train_edge_recon_loss: 77872.3454; train_gene_expr_recon_loss: 94377.9354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176291.1255; train_optim_loss: 176291.1255; val_kl_reg_loss: 3963.1294; val_edge_recon_loss: 76694.2715; val_gene_expr_recon_loss: 94051.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174708.5312; val_optim_loss: 174708.5312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9751; val_best_f1_score: 0.9752; train_kl_reg_loss: 4010.1283; train_edge_recon_loss: 77816.6046; train_gene_expr_recon_loss: 93825.4470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175652.1795; train_optim_loss: 175652.1795; val_kl_reg_loss: 3977.1353; val_edge_recon_loss: 76463.5879; val_gene_expr_recon_loss: 93255.4648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173696.1875; val_optim_loss: 173696.1875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9960; val_best_acc_score: 0.9752; val_best_f1_score: 0.9753; train_kl_reg_loss: 3986.9187; train_edge_recon_loss: 77593.3094; train_gene_expr_recon_loss: 93336.4979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174916.7263; train_optim_loss: 174916.7263; val_kl_reg_loss: 3912.2053; val_edge_recon_loss: 76130.9121; val_gene_expr_recon_loss: 92827.5605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172870.6797; val_optim_loss: 172870.6797
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9761; val_best_f1_score: 0.9763; train_kl_reg_loss: 3978.3653; train_edge_recon_loss: 77462.8655; train_gene_expr_recon_loss: 92838.9209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174280.1520; train_optim_loss: 174280.1520; val_kl_reg_loss: 3904.6472; val_edge_recon_loss: 77090.7324; val_gene_expr_recon_loss: 92423.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173418.7305; val_optim_loss: 173418.7305
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9771; val_best_f1_score: 0.9773; train_kl_reg_loss: 3965.9015; train_edge_recon_loss: 77629.2041; train_gene_expr_recon_loss: 92405.6676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174000.7718; train_optim_loss: 174000.7718; val_kl_reg_loss: 3931.1212; val_edge_recon_loss: 75662.1543; val_gene_expr_recon_loss: 91890.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171483.5312; val_optim_loss: 171483.5312
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9782; val_best_f1_score: 0.9783; train_kl_reg_loss: 3953.1431; train_edge_recon_loss: 77918.0322; train_gene_expr_recon_loss: 92047.4569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173918.6326; train_optim_loss: 173918.6326; val_kl_reg_loss: 3944.4902; val_edge_recon_loss: 75546.0605; val_gene_expr_recon_loss: 91473.0723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170963.6250; val_optim_loss: 170963.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9790; val_best_f1_score: 0.9791; train_kl_reg_loss: 3939.0398; train_edge_recon_loss: 77163.3989; train_gene_expr_recon_loss: 91739.0334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172841.4721; train_optim_loss: 172841.4721; val_kl_reg_loss: 3927.6026; val_edge_recon_loss: 77110.8242; val_gene_expr_recon_loss: 91139.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 172178.3242; val_optim_loss: 172178.3242
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9784; val_best_f1_score: 0.9786; train_kl_reg_loss: 3932.6701; train_edge_recon_loss: 77109.4962; train_gene_expr_recon_loss: 91376.0232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172418.1913; train_optim_loss: 172418.1913; val_kl_reg_loss: 3874.8522; val_edge_recon_loss: 77161.3008; val_gene_expr_recon_loss: 90942.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171979.1328; val_optim_loss: 171979.1328
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 3933.5465; train_edge_recon_loss: 77420.7715; train_gene_expr_recon_loss: 91050.2746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172404.5919; train_optim_loss: 172404.5919; val_kl_reg_loss: 3906.7696; val_edge_recon_loss: 75046.5918; val_gene_expr_recon_loss: 90646.5098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169599.8750; val_optim_loss: 169599.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 3939.3689; train_edge_recon_loss: 77525.6761; train_gene_expr_recon_loss: 90750.0919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172215.1368; train_optim_loss: 172215.1368; val_kl_reg_loss: 3891.2502; val_edge_recon_loss: 76365.8965; val_gene_expr_recon_loss: 90297.5293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170554.6797; val_optim_loss: 170554.6797
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 3925.8126; train_edge_recon_loss: 76937.3203; train_gene_expr_recon_loss: 90448.3563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171311.4910; train_optim_loss: 171311.4910; val_kl_reg_loss: 3898.6482; val_edge_recon_loss: 75654.8398; val_gene_expr_recon_loss: 90098.9473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169652.4375; val_optim_loss: 169652.4375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9975; val_auprc_score: 0.9969; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 3928.1130; train_edge_recon_loss: 77160.7441; train_gene_expr_recon_loss: 90236.8572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171325.7150; train_optim_loss: 171325.7150; val_kl_reg_loss: 3859.2472; val_edge_recon_loss: 76659.6348; val_gene_expr_recon_loss: 89841.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170360.7734; val_optim_loss: 170360.7734

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9804; val_best_f1_score: 0.9805; train_kl_reg_loss: 3920.9305; train_edge_recon_loss: 77121.2966; train_gene_expr_recon_loss: 90069.1435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171111.3693; train_optim_loss: 171111.3693; val_kl_reg_loss: 3887.9149; val_edge_recon_loss: 76477.0332; val_gene_expr_recon_loss: 89607.2207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169972.1680; val_optim_loss: 169972.1680
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9803; val_best_f1_score: 0.9804; train_kl_reg_loss: 3848.5926; train_edge_recon_loss: 76633.8511; train_gene_expr_recon_loss: 90021.1560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170503.5994; train_optim_loss: 170503.5994; val_kl_reg_loss: 3747.1885; val_edge_recon_loss: 77294.8242; val_gene_expr_recon_loss: 89864.4512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170906.4609; val_optim_loss: 170906.4609
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 3831.4403; train_edge_recon_loss: 77058.3153; train_gene_expr_recon_loss: 89968.8849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170858.6420; train_optim_loss: 170858.6420; val_kl_reg_loss: 3719.7017; val_edge_recon_loss: 74717.3516; val_gene_expr_recon_loss: 89836.0684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168273.1250; val_optim_loss: 168273.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 3810.0922; train_edge_recon_loss: 76620.1958; train_gene_expr_recon_loss: 90010.9155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170441.2036; train_optim_loss: 170441.2036; val_kl_reg_loss: 3720.4772; val_edge_recon_loss: 76125.7188; val_gene_expr_recon_loss: 89817.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169663.7383; val_optim_loss: 169663.7383
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 3818.4719; train_edge_recon_loss: 77116.3497; train_gene_expr_recon_loss: 89926.1200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170860.9418; train_optim_loss: 170860.9418; val_kl_reg_loss: 3719.8992; val_edge_recon_loss: 75714.7871; val_gene_expr_recon_loss: 89763.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169198.1211; val_optim_loss: 169198.1211
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 3810.8424; train_edge_recon_loss: 76941.2330; train_gene_expr_recon_loss: 89946.4664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170698.5398; train_optim_loss: 170698.5398; val_kl_reg_loss: 3725.5040; val_edge_recon_loss: 75322.8809; val_gene_expr_recon_loss: 89743.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168791.4766; val_optim_loss: 168791.4766

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 3809.2129; train_edge_recon_loss: 77044.9562; train_gene_expr_recon_loss: 89917.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170771.5601; train_optim_loss: 170771.5601; val_kl_reg_loss: 3716.0378; val_edge_recon_loss: 77293.2441; val_gene_expr_recon_loss: 89696.4629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170705.7461; val_optim_loss: 170705.7461
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 3802.8287; train_edge_recon_loss: 76720.4962; train_gene_expr_recon_loss: 89899.2211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170422.5464; train_optim_loss: 170422.5464; val_kl_reg_loss: 3719.0677; val_edge_recon_loss: 76270.6855; val_gene_expr_recon_loss: 89887.1309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169876.8828; val_optim_loss: 169876.8828
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9977; val_auprc_score: 0.9972; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 3803.5512; train_edge_recon_loss: 77137.7225; train_gene_expr_recon_loss: 89875.8319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170817.1042; train_optim_loss: 170817.1042; val_kl_reg_loss: 3716.2482; val_edge_recon_loss: 74788.7734; val_gene_expr_recon_loss: 89546.4355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168051.4609; val_optim_loss: 168051.4609
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9975; val_auprc_score: 0.9964; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 3804.8874; train_edge_recon_loss: 76897.8639; train_gene_expr_recon_loss: 89881.3146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170584.0668; train_optim_loss: 170584.0668; val_kl_reg_loss: 3715.3616; val_edge_recon_loss: 76306.3965; val_gene_expr_recon_loss: 89666.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169688.5000; val_optim_loss: 169688.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9809; val_best_f1_score: 0.9810; train_kl_reg_loss: 3801.7472; train_edge_recon_loss: 77279.2850; train_gene_expr_recon_loss: 89890.1558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170971.1875; train_optim_loss: 170971.1875; val_kl_reg_loss: 3715.2946; val_edge_recon_loss: 75798.9590; val_gene_expr_recon_loss: 89808.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169322.8789; val_optim_loss: 169322.8789
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 3803.4165; train_edge_recon_loss: 76749.9214; train_gene_expr_recon_loss: 89897.0708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170450.4091; train_optim_loss: 170450.4091; val_kl_reg_loss: 3717.0485; val_edge_recon_loss: 76000.4414; val_gene_expr_recon_loss: 89618.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169335.7461; val_optim_loss: 169335.7461

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9976; val_auprc_score: 0.9971; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 3804.9127; train_edge_recon_loss: 76992.8111; train_gene_expr_recon_loss: 89910.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170708.1321; train_optim_loss: 170708.1321; val_kl_reg_loss: 3719.2761; val_edge_recon_loss: 75048.3281; val_gene_expr_recon_loss: 89628.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168395.6328; val_optim_loss: 168395.6328
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 3805.0006; train_edge_recon_loss: 77231.5178; train_gene_expr_recon_loss: 89857.7069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170894.2268; train_optim_loss: 170894.2268; val_kl_reg_loss: 3718.9774; val_edge_recon_loss: 76059.4902; val_gene_expr_recon_loss: 89660.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169439.3672; val_optim_loss: 169439.3672
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9977; val_auprc_score: 0.9970; val_best_acc_score: 0.9814; val_best_f1_score: 0.9815; train_kl_reg_loss: 3804.9476; train_edge_recon_loss: 77088.4545; train_gene_expr_recon_loss: 89927.6771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170821.0810; train_optim_loss: 170821.0810; val_kl_reg_loss: 3717.8154; val_edge_recon_loss: 76540.0918; val_gene_expr_recon_loss: 89622.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169880.4023; val_optim_loss: 169880.4023

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 56 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9977
Val AUPRC score: 0.9972
Val best accuracy score: 0.9805
Val best F1 score: 0.9807
Val gene expr MSE score: 0.9952
Duration of model training in run 9: 0 hours, 32 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9495; val_auprc_score: 0.9489; val_best_acc_score: 0.8734; val_best_f1_score: 0.8757; train_kl_reg_loss: 692.6818; train_edge_recon_loss: 100575.4657; train_gene_expr_recon_loss: 127502.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228770.9167; train_optim_loss: 228770.9167; val_kl_reg_loss: 1501.3202; val_edge_recon_loss: 93580.3359; val_gene_expr_recon_loss: 120938.0020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216019.6602; val_optim_loss: 216019.6602
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9559; val_auprc_score: 0.9563; val_best_acc_score: 0.8834; val_best_f1_score: 0.8840; train_kl_reg_loss: 4051.5973; train_edge_recon_loss: 85592.3272; train_gene_expr_recon_loss: 118367.0772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208011.0014; train_optim_loss: 208011.0014; val_kl_reg_loss: 4394.9923; val_edge_recon_loss: 82742.7930; val_gene_expr_recon_loss: 114638.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201775.8125; val_optim_loss: 201775.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9793; val_auprc_score: 0.9784; val_best_acc_score: 0.9242; val_best_f1_score: 0.9248; train_kl_reg_loss: 4406.2917; train_edge_recon_loss: 82677.4960; train_gene_expr_recon_loss: 112269.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199352.7869; train_optim_loss: 199352.7869; val_kl_reg_loss: 4504.7767; val_edge_recon_loss: 81787.2930; val_gene_expr_recon_loss: 109046.2910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195338.3555; val_optim_loss: 195338.3555
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9870; val_auprc_score: 0.9863; val_best_acc_score: 0.9413; val_best_f1_score: 0.9420; train_kl_reg_loss: 4636.8284; train_edge_recon_loss: 80703.6896; train_gene_expr_recon_loss: 107346.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192687.0587; train_optim_loss: 192687.0587; val_kl_reg_loss: 4619.1157; val_edge_recon_loss: 79295.9062; val_gene_expr_recon_loss: 105028.1152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 188943.1406; val_optim_loss: 188943.1406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9908; val_auprc_score: 0.9899; val_best_acc_score: 0.9524; val_best_f1_score: 0.9528; train_kl_reg_loss: 4654.5763; train_edge_recon_loss: 80139.2143; train_gene_expr_recon_loss: 104322.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 189116.6383; train_optim_loss: 189116.6383; val_kl_reg_loss: 4536.3179; val_edge_recon_loss: 77506.4395; val_gene_expr_recon_loss: 102822.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184865.4844; val_optim_loss: 184865.4844
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9925; val_auprc_score: 0.9918; val_best_acc_score: 0.9573; val_best_f1_score: 0.9578; train_kl_reg_loss: 4564.1492; train_edge_recon_loss: 79367.5111; train_gene_expr_recon_loss: 102371.8139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186303.4725; train_optim_loss: 186303.4725; val_kl_reg_loss: 4442.1216; val_edge_recon_loss: 78274.3867; val_gene_expr_recon_loss: 101062.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 183779.4844; val_optim_loss: 183779.4844
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9936; val_auprc_score: 0.9928; val_best_acc_score: 0.9621; val_best_f1_score: 0.9625; train_kl_reg_loss: 4450.7110; train_edge_recon_loss: 79400.0147; train_gene_expr_recon_loss: 100900.8518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 184751.5767; train_optim_loss: 184751.5767; val_kl_reg_loss: 4357.4882; val_edge_recon_loss: 79677.7520; val_gene_expr_recon_loss: 99993.2129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 184028.4531; val_optim_loss: 184028.4531
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9945; val_auprc_score: 0.9936; val_best_acc_score: 0.9650; val_best_f1_score: 0.9653; train_kl_reg_loss: 4387.0747; train_edge_recon_loss: 79264.3007; train_gene_expr_recon_loss: 99705.9138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 183357.2888; train_optim_loss: 183357.2888; val_kl_reg_loss: 4288.0496; val_edge_recon_loss: 77578.4648; val_gene_expr_recon_loss: 99015.8496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 180882.3672; val_optim_loss: 180882.3672
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9948; val_auprc_score: 0.9938; val_best_acc_score: 0.9665; val_best_f1_score: 0.9667; train_kl_reg_loss: 4320.2898; train_edge_recon_loss: 78813.7718; train_gene_expr_recon_loss: 98660.2249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 181794.2860; train_optim_loss: 181794.2860; val_kl_reg_loss: 4301.7957; val_edge_recon_loss: 78033.8164; val_gene_expr_recon_loss: 97615.8008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 179951.4102; val_optim_loss: 179951.4102
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9952; val_auprc_score: 0.9946; val_best_acc_score: 0.9685; val_best_f1_score: 0.9688; train_kl_reg_loss: 4261.7383; train_edge_recon_loss: 78970.4896; train_gene_expr_recon_loss: 97728.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180960.2311; train_optim_loss: 180960.2311; val_kl_reg_loss: 4187.5074; val_edge_recon_loss: 77734.2930; val_gene_expr_recon_loss: 96813.7910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178735.5898; val_optim_loss: 178735.5898
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9949; val_best_acc_score: 0.9698; val_best_f1_score: 0.9701; train_kl_reg_loss: 4200.9152; train_edge_recon_loss: 78563.0488; train_gene_expr_recon_loss: 96956.2924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 179720.2566; train_optim_loss: 179720.2566; val_kl_reg_loss: 4120.7318; val_edge_recon_loss: 78537.7188; val_gene_expr_recon_loss: 95966.8809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 178625.3320; val_optim_loss: 178625.3320
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9958; val_auprc_score: 0.9951; val_best_acc_score: 0.9711; val_best_f1_score: 0.9713; train_kl_reg_loss: 4154.3621; train_edge_recon_loss: 78492.7083; train_gene_expr_recon_loss: 96189.4162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178836.4867; train_optim_loss: 178836.4867; val_kl_reg_loss: 4152.1934; val_edge_recon_loss: 76430.1328; val_gene_expr_recon_loss: 95378.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175960.3281; val_optim_loss: 175960.3281
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 4117.2990; train_edge_recon_loss: 78517.1442; train_gene_expr_recon_loss: 95382.9983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178017.4427; train_optim_loss: 178017.4427; val_kl_reg_loss: 4035.8105; val_edge_recon_loss: 77349.3496; val_gene_expr_recon_loss: 94516.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175901.9375; val_optim_loss: 175901.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9958; val_best_acc_score: 0.9737; val_best_f1_score: 0.9739; train_kl_reg_loss: 4075.8893; train_edge_recon_loss: 78170.4018; train_gene_expr_recon_loss: 94749.3132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 176995.6042; train_optim_loss: 176995.6042; val_kl_reg_loss: 4005.2551; val_edge_recon_loss: 77451.0586; val_gene_expr_recon_loss: 94210.8887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 175667.2031; val_optim_loss: 175667.2031
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9966; val_auprc_score: 0.9959; val_best_acc_score: 0.9744; val_best_f1_score: 0.9746; train_kl_reg_loss: 4047.3915; train_edge_recon_loss: 77577.1884; train_gene_expr_recon_loss: 94132.1657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175756.7448; train_optim_loss: 175756.7448; val_kl_reg_loss: 3997.0441; val_edge_recon_loss: 76436.0332; val_gene_expr_recon_loss: 93422.6934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173855.7734; val_optim_loss: 173855.7734
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9967; val_auprc_score: 0.9961; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 4008.1817; train_edge_recon_loss: 77403.3082; train_gene_expr_recon_loss: 93664.0350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175075.5251; train_optim_loss: 175075.5251; val_kl_reg_loss: 3977.1034; val_edge_recon_loss: 76765.1914; val_gene_expr_recon_loss: 93097.4395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 173839.7344; val_optim_loss: 173839.7344
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9761; val_best_f1_score: 0.9762; train_kl_reg_loss: 3988.2638; train_edge_recon_loss: 77777.3954; train_gene_expr_recon_loss: 93080.3873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174846.0459; train_optim_loss: 174846.0459; val_kl_reg_loss: 3930.5491; val_edge_recon_loss: 78090.6348; val_gene_expr_recon_loss: 92469.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 174490.8906; val_optim_loss: 174490.8906
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9970; val_auprc_score: 0.9964; val_best_acc_score: 0.9768; val_best_f1_score: 0.9770; train_kl_reg_loss: 3972.9297; train_edge_recon_loss: 77544.4425; train_gene_expr_recon_loss: 92681.2460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174198.6198; train_optim_loss: 174198.6198; val_kl_reg_loss: 3915.5853; val_edge_recon_loss: 75636.3262; val_gene_expr_recon_loss: 92289.5449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171841.4531; val_optim_loss: 171841.4531
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9779; val_best_f1_score: 0.9780; train_kl_reg_loss: 3972.8874; train_edge_recon_loss: 77722.3447; train_gene_expr_recon_loss: 92318.1851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 174013.4186; train_optim_loss: 174013.4186; val_kl_reg_loss: 3907.6642; val_edge_recon_loss: 76004.0684; val_gene_expr_recon_loss: 91796.7129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 171708.4453; val_optim_loss: 171708.4453
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 3950.6790; train_edge_recon_loss: 77239.9522; train_gene_expr_recon_loss: 91889.2379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173079.8688; train_optim_loss: 173079.8688; val_kl_reg_loss: 3934.2740; val_edge_recon_loss: 74884.1328; val_gene_expr_recon_loss: 91260.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170078.8359; val_optim_loss: 170078.8359
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 3953.0779; train_edge_recon_loss: 76989.0009; train_gene_expr_recon_loss: 91604.4053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172546.4834; train_optim_loss: 172546.4834; val_kl_reg_loss: 3936.4980; val_edge_recon_loss: 75866.3125; val_gene_expr_recon_loss: 91089.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170892.2070; val_optim_loss: 170892.2070
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9970; val_best_acc_score: 0.9794; val_best_f1_score: 0.9795; train_kl_reg_loss: 3951.0838; train_edge_recon_loss: 76979.1738; train_gene_expr_recon_loss: 91306.2929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 172236.5497; train_optim_loss: 172236.5497; val_kl_reg_loss: 3959.1871; val_edge_recon_loss: 75270.5547; val_gene_expr_recon_loss: 90736.5879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169966.3281; val_optim_loss: 169966.3281
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 3950.9020; train_edge_recon_loss: 77004.6158; train_gene_expr_recon_loss: 91026.6037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171982.1198; train_optim_loss: 171982.1198; val_kl_reg_loss: 3885.0770; val_edge_recon_loss: 76494.0020; val_gene_expr_recon_loss: 90487.6738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170866.7500; val_optim_loss: 170866.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9977; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9800; train_kl_reg_loss: 3943.5004; train_edge_recon_loss: 77000.0642; train_gene_expr_recon_loss: 90710.9304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171654.4953; train_optim_loss: 171654.4953; val_kl_reg_loss: 3910.5975; val_edge_recon_loss: 75220.7949; val_gene_expr_recon_loss: 90258.2793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169389.6719; val_optim_loss: 169389.6719
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 3941.1258; train_edge_recon_loss: 77206.2417; train_gene_expr_recon_loss: 90456.0424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171603.4115; train_optim_loss: 171603.4115; val_kl_reg_loss: 3869.6065; val_edge_recon_loss: 76417.2227; val_gene_expr_recon_loss: 90176.0918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 170462.9258; val_optim_loss: 170462.9258
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 3602.1673; train_edge_recon_loss: 76806.4988; train_gene_expr_recon_loss: 90294.3842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170703.0492; train_optim_loss: 170703.0492; val_kl_reg_loss: 3248.1783; val_edge_recon_loss: 75098.6855; val_gene_expr_recon_loss: 89635.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167982.3906; val_optim_loss: 167982.3906
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9977; val_auprc_score: 0.9967; val_best_acc_score: 0.9811; val_best_f1_score: 0.9812; train_kl_reg_loss: 3440.9381; train_edge_recon_loss: 76627.4543; train_gene_expr_recon_loss: 90043.3537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 170111.7448; train_optim_loss: 170111.7448; val_kl_reg_loss: 3232.9257; val_edge_recon_loss: 74954.9121; val_gene_expr_recon_loss: 89600.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167788.1953; val_optim_loss: 167788.1953
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 3397.2748; train_edge_recon_loss: 76443.1378; train_gene_expr_recon_loss: 89813.0956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169653.5071; train_optim_loss: 169653.5071; val_kl_reg_loss: 3280.1673; val_edge_recon_loss: 76728.1758; val_gene_expr_recon_loss: 89397.0039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 169405.3477; val_optim_loss: 169405.3477
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9817; train_kl_reg_loss: 3376.2216; train_edge_recon_loss: 76807.9441; train_gene_expr_recon_loss: 89613.1759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169797.3423; train_optim_loss: 169797.3423; val_kl_reg_loss: 3295.3202; val_edge_recon_loss: 74769.8418; val_gene_expr_recon_loss: 89216.9277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167282.0898; val_optim_loss: 167282.0898
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9979; val_auprc_score: 0.9975; val_best_acc_score: 0.9825; val_best_f1_score: 0.9826; train_kl_reg_loss: 3359.4570; train_edge_recon_loss: 76565.6882; train_gene_expr_recon_loss: 89469.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169394.1657; train_optim_loss: 169394.1657; val_kl_reg_loss: 3317.1032; val_edge_recon_loss: 75470.9590; val_gene_expr_recon_loss: 88840.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167628.7891; val_optim_loss: 167628.7891
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 3344.9132; train_edge_recon_loss: 76493.4690; train_gene_expr_recon_loss: 89214.8248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 169053.2045; train_optim_loss: 169053.2045; val_kl_reg_loss: 3281.1587; val_edge_recon_loss: 76225.6582; val_gene_expr_recon_loss: 88919.2598; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168426.0742; val_optim_loss: 168426.0742
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 3332.1604; train_edge_recon_loss: 76440.8113; train_gene_expr_recon_loss: 89079.2867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168852.2576; train_optim_loss: 168852.2576; val_kl_reg_loss: 3265.3105; val_edge_recon_loss: 75459.6484; val_gene_expr_recon_loss: 88459.2520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167184.2109; val_optim_loss: 167184.2109
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3333.7615; train_edge_recon_loss: 76537.9446; train_gene_expr_recon_loss: 88880.5677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168752.2732; train_optim_loss: 168752.2732; val_kl_reg_loss: 3291.9987; val_edge_recon_loss: 75803.8301; val_gene_expr_recon_loss: 88620.3066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167716.1328; val_optim_loss: 167716.1328
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 3328.4262; train_edge_recon_loss: 76319.6205; train_gene_expr_recon_loss: 88702.2391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168350.2879; train_optim_loss: 168350.2879; val_kl_reg_loss: 3288.9031; val_edge_recon_loss: 75139.3301; val_gene_expr_recon_loss: 88347.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166776.0352; val_optim_loss: 166776.0352
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3328.2022; train_edge_recon_loss: 76546.7285; train_gene_expr_recon_loss: 88538.1264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168413.0578; train_optim_loss: 168413.0578; val_kl_reg_loss: 3291.5502; val_edge_recon_loss: 76596.3633; val_gene_expr_recon_loss: 88321.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 168209.1133; val_optim_loss: 168209.1133
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 3321.2995; train_edge_recon_loss: 76525.9292; train_gene_expr_recon_loss: 88415.9370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168263.1652; train_optim_loss: 168263.1652; val_kl_reg_loss: 3278.1884; val_edge_recon_loss: 76263.2383; val_gene_expr_recon_loss: 88104.3379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167645.7656; val_optim_loss: 167645.7656
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 3322.2451; train_edge_recon_loss: 76713.1754; train_gene_expr_recon_loss: 88276.6837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168312.1042; train_optim_loss: 168312.1042; val_kl_reg_loss: 3266.5180; val_edge_recon_loss: 76074.4805; val_gene_expr_recon_loss: 87737.5488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167078.5508; val_optim_loss: 167078.5508

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 3319.3237; train_edge_recon_loss: 76377.5630; train_gene_expr_recon_loss: 88149.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167845.8982; train_optim_loss: 167845.8982; val_kl_reg_loss: 3286.7307; val_edge_recon_loss: 76198.4199; val_gene_expr_recon_loss: 87726.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167211.1562; val_optim_loss: 167211.1562
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 3316.3401; train_edge_recon_loss: 76208.3146; train_gene_expr_recon_loss: 88120.2483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167644.9010; train_optim_loss: 167644.9010; val_kl_reg_loss: 3276.3304; val_edge_recon_loss: 75578.3848; val_gene_expr_recon_loss: 87867.8809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166722.5938; val_optim_loss: 166722.5938
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3319.8987; train_edge_recon_loss: 76241.9164; train_gene_expr_recon_loss: 88110.4702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167672.2855; train_optim_loss: 167672.2855; val_kl_reg_loss: 3262.2516; val_edge_recon_loss: 75613.8750; val_gene_expr_recon_loss: 87804.2910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166680.4180; val_optim_loss: 166680.4180
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3316.9887; train_edge_recon_loss: 76344.9403; train_gene_expr_recon_loss: 88024.8679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167686.7973; train_optim_loss: 167686.7973; val_kl_reg_loss: 3272.3782; val_edge_recon_loss: 75865.1055; val_gene_expr_recon_loss: 87893.1738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167030.6562; val_optim_loss: 167030.6562
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3319.4690; train_edge_recon_loss: 76352.3149; train_gene_expr_recon_loss: 88057.8113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167729.5956; train_optim_loss: 167729.5956; val_kl_reg_loss: 3260.4397; val_edge_recon_loss: 75946.9316; val_gene_expr_recon_loss: 87774.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166981.4062; val_optim_loss: 166981.4062
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 3313.4200; train_edge_recon_loss: 76798.3298; train_gene_expr_recon_loss: 88053.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168165.5194; train_optim_loss: 168165.5194; val_kl_reg_loss: 3267.8497; val_edge_recon_loss: 75737.0020; val_gene_expr_recon_loss: 87740.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166745.4883; val_optim_loss: 166745.4883

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 3313.8592; train_edge_recon_loss: 76530.5964; train_gene_expr_recon_loss: 88057.5336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167901.9877; train_optim_loss: 167901.9877; val_kl_reg_loss: 3272.4788; val_edge_recon_loss: 75220.3672; val_gene_expr_recon_loss: 87789.1699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166282.0156; val_optim_loss: 166282.0156
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 3315.0088; train_edge_recon_loss: 76375.9081; train_gene_expr_recon_loss: 88064.5895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167755.5080; train_optim_loss: 167755.5080; val_kl_reg_loss: 3274.2429; val_edge_recon_loss: 75609.6094; val_gene_expr_recon_loss: 87549.2246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166433.0781; val_optim_loss: 166433.0781
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 3318.7339; train_edge_recon_loss: 76715.5391; train_gene_expr_recon_loss: 87994.0836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168028.3565; train_optim_loss: 168028.3565; val_kl_reg_loss: 3278.6194; val_edge_recon_loss: 75641.5605; val_gene_expr_recon_loss: 87798.2715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166718.4531; val_optim_loss: 166718.4531
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 3321.1161; train_edge_recon_loss: 76457.9162; train_gene_expr_recon_loss: 87999.3949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167778.4261; train_optim_loss: 167778.4261; val_kl_reg_loss: 3278.8038; val_edge_recon_loss: 75030.4492; val_gene_expr_recon_loss: 87744.3184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166053.5703; val_optim_loss: 166053.5703
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 3323.4243; train_edge_recon_loss: 76270.3464; train_gene_expr_recon_loss: 88008.8963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167602.6667; train_optim_loss: 167602.6667; val_kl_reg_loss: 3278.2640; val_edge_recon_loss: 75437.0117; val_gene_expr_recon_loss: 87750.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166465.8281; val_optim_loss: 166465.8281
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 3318.1657; train_edge_recon_loss: 76061.9231; train_gene_expr_recon_loss: 88000.7379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167380.8272; train_optim_loss: 167380.8272; val_kl_reg_loss: 3272.8508; val_edge_recon_loss: 75256.3105; val_gene_expr_recon_loss: 87508.1035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166037.2695; val_optim_loss: 166037.2695
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3315.2358; train_edge_recon_loss: 76284.2746; train_gene_expr_recon_loss: 88011.2467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167610.7590; train_optim_loss: 167610.7590; val_kl_reg_loss: 3273.9094; val_edge_recon_loss: 76215.8340; val_gene_expr_recon_loss: 87795.8301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167285.5703; val_optim_loss: 167285.5703
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 3315.7611; train_edge_recon_loss: 76279.1117; train_gene_expr_recon_loss: 88021.2119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167616.0852; train_optim_loss: 167616.0852; val_kl_reg_loss: 3271.0586; val_edge_recon_loss: 75784.1016; val_gene_expr_recon_loss: 87668.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166723.5977; val_optim_loss: 166723.5977
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3313.0703; train_edge_recon_loss: 76516.3250; train_gene_expr_recon_loss: 88017.2746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167846.6700; train_optim_loss: 167846.6700; val_kl_reg_loss: 3272.4819; val_edge_recon_loss: 76293.4336; val_gene_expr_recon_loss: 87825.4238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167391.3398; val_optim_loss: 167391.3398

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 3315.5339; train_edge_recon_loss: 76236.4349; train_gene_expr_recon_loss: 88027.1813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167579.1525; train_optim_loss: 167579.1525; val_kl_reg_loss: 3273.3987; val_edge_recon_loss: 76409.8613; val_gene_expr_recon_loss: 87753.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167437.0586; val_optim_loss: 167437.0586
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 3315.5903; train_edge_recon_loss: 76714.9003; train_gene_expr_recon_loss: 88041.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 168071.6752; train_optim_loss: 168071.6752; val_kl_reg_loss: 3273.9351; val_edge_recon_loss: 74014.6621; val_gene_expr_recon_loss: 87517.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 164805.6367; val_optim_loss: 164805.6367
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9982; val_auprc_score: 0.9973; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 3315.7256; train_edge_recon_loss: 76220.2959; train_gene_expr_recon_loss: 88032.3487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167568.3703; train_optim_loss: 167568.3703; val_kl_reg_loss: 3272.0535; val_edge_recon_loss: 75970.0195; val_gene_expr_recon_loss: 87743.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166985.2734; val_optim_loss: 166985.2734
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 3316.1454; train_edge_recon_loss: 76250.4233; train_gene_expr_recon_loss: 87974.9025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167541.4716; train_optim_loss: 167541.4716; val_kl_reg_loss: 3272.3569; val_edge_recon_loss: 76353.4258; val_gene_expr_recon_loss: 87789.5664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167415.3477; val_optim_loss: 167415.3477
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9980; val_auprc_score: 0.9969; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 3315.4851; train_edge_recon_loss: 76294.0786; train_gene_expr_recon_loss: 87991.3002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167600.8651; train_optim_loss: 167600.8651; val_kl_reg_loss: 3272.2402; val_edge_recon_loss: 75889.3887; val_gene_expr_recon_loss: 87542.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 166704.0156; val_optim_loss: 166704.0156

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 3315.4898; train_edge_recon_loss: 76128.0431; train_gene_expr_recon_loss: 87975.0961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167418.6293; train_optim_loss: 167418.6293; val_kl_reg_loss: 3272.4993; val_edge_recon_loss: 76579.3711; val_gene_expr_recon_loss: 87643.8340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 167495.7109; val_optim_loss: 167495.7109
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 3315.4857; train_edge_recon_loss: 76640.0440; train_gene_expr_recon_loss: 88031.3016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167986.8333; train_optim_loss: 167986.8333; val_kl_reg_loss: 3271.9869; val_edge_recon_loss: 74594.2656; val_gene_expr_recon_loss: 87662.2480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165528.4961; val_optim_loss: 165528.4961
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9983; val_auprc_score: 0.9979; val_best_acc_score: 0.9842; val_best_f1_score: 0.9843; train_kl_reg_loss: 3315.7782; train_edge_recon_loss: 76369.0777; train_gene_expr_recon_loss: 87953.6075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 167638.4626; train_optim_loss: 167638.4626; val_kl_reg_loss: 3272.4033; val_edge_recon_loss: 74733.9863; val_gene_expr_recon_loss: 87674.6035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 165680.9922; val_optim_loss: 165680.9922

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 15 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
Val AUROC score: 0.9984
Val AUPRC score: 0.9981
Val best accuracy score: 0.9848
Val best F1 score: 0.9849
Val gene expr MSE score: 0.9614
Duration of model training in run 10: 0 hours, 50 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
