Run timestamp: 31082023_194404_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9411; val_auprc_score: 0.9764; val_best_acc_score: 0.8047; val_best_f1_score: 0.8841; train_kl_reg_loss: 145.1972; train_edge_recon_loss: 1721515.6667; train_cat_covariates_contrastive_loss: 646968.7708; train_gene_expr_recon_loss: 3568794.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5937424.0000; train_optim_loss: 5937424.0000; val_kl_reg_loss: 785.8154; val_edge_recon_loss: 1983965.7500; val_cat_covariates_contrastive_loss: 314030.1562; val_gene_expr_recon_loss: 3556224.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5855006.0000; val_optim_loss: 5855006.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9324; val_auprc_score: 0.9730; val_best_acc_score: 0.7947; val_best_f1_score: 0.8796; train_kl_reg_loss: 1276.4987; train_edge_recon_loss: 1773449.4167; train_cat_covariates_contrastive_loss: 467319.8958; train_gene_expr_recon_loss: 3480761.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5722807.8333; train_optim_loss: 5722807.8333; val_kl_reg_loss: 2289.0500; val_edge_recon_loss: 2025106.5000; val_cat_covariates_contrastive_loss: 313539.0000; val_gene_expr_recon_loss: 3470002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5810936.5000; val_optim_loss: 5810936.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9281; val_auprc_score: 0.9709; val_best_acc_score: 0.7881; val_best_f1_score: 0.8747; train_kl_reg_loss: 2470.7650; train_edge_recon_loss: 1879853.8750; train_cat_covariates_contrastive_loss: 360393.2396; train_gene_expr_recon_loss: 3428776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5671493.6667; train_optim_loss: 5671493.6667; val_kl_reg_loss: 2508.3176; val_edge_recon_loss: 2089102.1250; val_cat_covariates_contrastive_loss: 313503.1250; val_gene_expr_recon_loss: 3449103.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5854217.0000; val_optim_loss: 5854217.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9146; val_auprc_score: 0.9661; val_best_acc_score: 0.7877; val_best_f1_score: 0.8739; train_kl_reg_loss: 2201.5962; train_edge_recon_loss: 1869069.8333; train_cat_covariates_contrastive_loss: 358599.9792; train_gene_expr_recon_loss: 3401117.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5630989.1667; train_optim_loss: 5630989.1667; val_kl_reg_loss: 1726.7965; val_edge_recon_loss: 2061956.8750; val_cat_covariates_contrastive_loss: 313585.5938; val_gene_expr_recon_loss: 3424834.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5802104.0000; val_optim_loss: 5802104.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9053; val_auprc_score: 0.9645; val_best_acc_score: 0.7975; val_best_f1_score: 0.8792; train_kl_reg_loss: 1498.7863; train_edge_recon_loss: 1806204.6250; train_cat_covariates_contrastive_loss: 387097.8125; train_gene_expr_recon_loss: 3371282.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5566083.5000; train_optim_loss: 5566083.5000; val_kl_reg_loss: 1439.3383; val_edge_recon_loss: 1966452.5000; val_cat_covariates_contrastive_loss: 313597.6875; val_gene_expr_recon_loss: 3394238.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5675728.0000; val_optim_loss: 5675728.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8867; val_auprc_score: 0.9576; val_best_acc_score: 0.7866; val_best_f1_score: 0.8751; train_kl_reg_loss: 1445.9120; train_edge_recon_loss: 1788349.5000; train_cat_covariates_contrastive_loss: 390597.3750; train_gene_expr_recon_loss: 3350502.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5530895.1667; train_optim_loss: 5530895.1667; val_kl_reg_loss: 1680.7275; val_edge_recon_loss: 2041854.3750; val_cat_covariates_contrastive_loss: 313612.5625; val_gene_expr_recon_loss: 3376717.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5733865.5000; val_optim_loss: 5733865.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8676; val_auprc_score: 0.9489; val_best_acc_score: 0.7878; val_best_f1_score: 0.8754; train_kl_reg_loss: 1632.5600; train_edge_recon_loss: 1805389.6667; train_cat_covariates_contrastive_loss: 385292.4167; train_gene_expr_recon_loss: 3323456.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5515771.0000; train_optim_loss: 5515771.0000; val_kl_reg_loss: 1973.3777; val_edge_recon_loss: 2034287.6250; val_cat_covariates_contrastive_loss: 313628.9688; val_gene_expr_recon_loss: 3335610.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5685500.5000; val_optim_loss: 5685500.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8495; val_auprc_score: 0.9428; val_best_acc_score: 0.7978; val_best_f1_score: 0.8804; train_kl_reg_loss: 1996.6392; train_edge_recon_loss: 1812925.2917; train_cat_covariates_contrastive_loss: 368480.1875; train_gene_expr_recon_loss: 3283658.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5467060.6667; train_optim_loss: 5467060.6667; val_kl_reg_loss: 2482.2129; val_edge_recon_loss: 2017377.6250; val_cat_covariates_contrastive_loss: 313582.7188; val_gene_expr_recon_loss: 3302957.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5636400.0000; val_optim_loss: 5636400.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8180; val_auprc_score: 0.9316; val_best_acc_score: 0.8097; val_best_f1_score: 0.8879; train_kl_reg_loss: 2396.6428; train_edge_recon_loss: 1802515.4167; train_cat_covariates_contrastive_loss: 360721.7812; train_gene_expr_recon_loss: 3251570.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5417203.8333; train_optim_loss: 5417203.8333; val_kl_reg_loss: 2761.7769; val_edge_recon_loss: 1900644.0000; val_cat_covariates_contrastive_loss: 313609.5625; val_gene_expr_recon_loss: 3269459.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5486475.0000; val_optim_loss: 5486475.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8068; val_auprc_score: 0.9197; val_best_acc_score: 0.7935; val_best_f1_score: 0.8761; train_kl_reg_loss: 2698.4246; train_edge_recon_loss: 1777606.3333; train_cat_covariates_contrastive_loss: 370448.4479; train_gene_expr_recon_loss: 3224899.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5375652.3333; train_optim_loss: 5375652.3333; val_kl_reg_loss: 3357.1875; val_edge_recon_loss: 2068000.6250; val_cat_covariates_contrastive_loss: 313626.6875; val_gene_expr_recon_loss: 3239484.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5624469.0000; val_optim_loss: 5624469.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7988; val_auprc_score: 0.9156; val_best_acc_score: 0.8047; val_best_f1_score: 0.8828; train_kl_reg_loss: 3473.4215; train_edge_recon_loss: 1748526.7500; train_cat_covariates_contrastive_loss: 369690.1562; train_gene_expr_recon_loss: 3190140.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5311831.1667; train_optim_loss: 5311831.1667; val_kl_reg_loss: 4521.6533; val_edge_recon_loss: 1957030.7500; val_cat_covariates_contrastive_loss: 313561.9375; val_gene_expr_recon_loss: 3208909.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484023.5000; val_optim_loss: 5484023.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7961; val_auprc_score: 0.9107; val_best_acc_score: 0.8127; val_best_f1_score: 0.8875; train_kl_reg_loss: 4524.9875; train_edge_recon_loss: 1776506.6250; train_cat_covariates_contrastive_loss: 357095.5208; train_gene_expr_recon_loss: 3159645.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5297772.5000; train_optim_loss: 5297772.5000; val_kl_reg_loss: 5577.8594; val_edge_recon_loss: 1921877.2500; val_cat_covariates_contrastive_loss: 313628.6562; val_gene_expr_recon_loss: 3173546.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5414630.0000; val_optim_loss: 5414630.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7753; val_auprc_score: 0.8926; val_best_acc_score: 0.7997; val_best_f1_score: 0.8770; train_kl_reg_loss: 5818.3766; train_edge_recon_loss: 1769639.2500; train_cat_covariates_contrastive_loss: 350386.5312; train_gene_expr_recon_loss: 3134720.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5260564.5000; train_optim_loss: 5260564.5000; val_kl_reg_loss: 7544.1758; val_edge_recon_loss: 2032273.2500; val_cat_covariates_contrastive_loss: 313645.5312; val_gene_expr_recon_loss: 3143490.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5496953.0000; val_optim_loss: 5496953.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7894; val_auprc_score: 0.9075; val_best_acc_score: 0.8148; val_best_f1_score: 0.8848; train_kl_reg_loss: 8087.3701; train_edge_recon_loss: 1741623.9167; train_cat_covariates_contrastive_loss: 347105.5312; train_gene_expr_recon_loss: 3103462.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5200279.3333; train_optim_loss: 5200279.3333; val_kl_reg_loss: 10412.8701; val_edge_recon_loss: 1983378.5000; val_cat_covariates_contrastive_loss: 313718.6562; val_gene_expr_recon_loss: 3102037.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5409547.0000; val_optim_loss: 5409547.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7624; val_auprc_score: 0.8814; val_best_acc_score: 0.8079; val_best_f1_score: 0.8810; train_kl_reg_loss: 11590.9642; train_edge_recon_loss: 1732358.8333; train_cat_covariates_contrastive_loss: 341092.7812; train_gene_expr_recon_loss: 3067827.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5152869.6667; train_optim_loss: 5152869.6667; val_kl_reg_loss: 16171.0605; val_edge_recon_loss: 1985287.8750; val_cat_covariates_contrastive_loss: 313749.5625; val_gene_expr_recon_loss: 3067564.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5382773.0000; val_optim_loss: 5382773.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7855; val_auprc_score: 0.9026; val_best_acc_score: 0.8182; val_best_f1_score: 0.8892; train_kl_reg_loss: 17609.4076; train_edge_recon_loss: 1756124.2083; train_cat_covariates_contrastive_loss: 339994.7083; train_gene_expr_recon_loss: 3028698.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5142426.5000; train_optim_loss: 5142426.5000; val_kl_reg_loss: 21143.2012; val_edge_recon_loss: 1916364.1250; val_cat_covariates_contrastive_loss: 313714.3750; val_gene_expr_recon_loss: 3025643.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5276865.0000; val_optim_loss: 5276865.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7986; val_auprc_score: 0.9052; val_best_acc_score: 0.8270; val_best_f1_score: 0.8930; train_kl_reg_loss: 23290.3724; train_edge_recon_loss: 1768485.8750; train_cat_covariates_contrastive_loss: 334162.4688; train_gene_expr_recon_loss: 2986376.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5112315.3333; train_optim_loss: 5112315.3333; val_kl_reg_loss: 31364.0469; val_edge_recon_loss: 1911220.0000; val_cat_covariates_contrastive_loss: 313754.3438; val_gene_expr_recon_loss: 2994532.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5250871.0000; val_optim_loss: 5250871.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8019; val_auprc_score: 0.9069; val_best_acc_score: 0.8181; val_best_f1_score: 0.8866; train_kl_reg_loss: 28308.1204; train_edge_recon_loss: 1749142.8750; train_cat_covariates_contrastive_loss: 333377.4271; train_gene_expr_recon_loss: 2948108.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5058936.3333; train_optim_loss: 5058936.3333; val_kl_reg_loss: 33583.0938; val_edge_recon_loss: 1964246.5000; val_cat_covariates_contrastive_loss: 313795.4375; val_gene_expr_recon_loss: 2958159.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5269784.0000; val_optim_loss: 5269784.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7866; val_auprc_score: 0.8975; val_best_acc_score: 0.8159; val_best_f1_score: 0.8873; train_kl_reg_loss: 33518.1549; train_edge_recon_loss: 1750850.5000; train_cat_covariates_contrastive_loss: 333875.5000; train_gene_expr_recon_loss: 2908967.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5027212.1667; train_optim_loss: 5027212.1667; val_kl_reg_loss: 39412.1055; val_edge_recon_loss: 1903778.1250; val_cat_covariates_contrastive_loss: 313760.5000; val_gene_expr_recon_loss: 2932777.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5189728.0000; val_optim_loss: 5189728.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7813; val_auprc_score: 0.8923; val_best_acc_score: 0.8116; val_best_f1_score: 0.8853; train_kl_reg_loss: 36556.8464; train_edge_recon_loss: 1767654.8333; train_cat_covariates_contrastive_loss: 331233.8333; train_gene_expr_recon_loss: 2876422.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5011868.0000; train_optim_loss: 5011868.0000; val_kl_reg_loss: 38806.3984; val_edge_recon_loss: 1916742.0000; val_cat_covariates_contrastive_loss: 313836.9062; val_gene_expr_recon_loss: 2897812.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5167198.0000; val_optim_loss: 5167198.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7705; val_auprc_score: 0.8911; val_best_acc_score: 0.8095; val_best_f1_score: 0.8847; train_kl_reg_loss: 38243.4857; train_edge_recon_loss: 1736410.9583; train_cat_covariates_contrastive_loss: 332029.5208; train_gene_expr_recon_loss: 2847701.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4954385.6667; train_optim_loss: 4954385.6667; val_kl_reg_loss: 40311.5078; val_edge_recon_loss: 1865507.2500; val_cat_covariates_contrastive_loss: 313954.4375; val_gene_expr_recon_loss: 2871898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5091671.0000; val_optim_loss: 5091671.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7717; val_auprc_score: 0.8924; val_best_acc_score: 0.8132; val_best_f1_score: 0.8868; train_kl_reg_loss: 36002.2409; train_edge_recon_loss: 1727026.4167; train_cat_covariates_contrastive_loss: 331037.4792; train_gene_expr_recon_loss: 2828545.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4922611.3333; train_optim_loss: 4922611.3333; val_kl_reg_loss: 39665.7578; val_edge_recon_loss: 1819073.0000; val_cat_covariates_contrastive_loss: 313863.7812; val_gene_expr_recon_loss: 2852896.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5025499.0000; val_optim_loss: 5025499.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7820; val_auprc_score: 0.9044; val_best_acc_score: 0.8226; val_best_f1_score: 0.8940; train_kl_reg_loss: 38053.9466; train_edge_recon_loss: 1704030.6667; train_cat_covariates_contrastive_loss: 331538.8021; train_gene_expr_recon_loss: 2809947.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883571.1667; train_optim_loss: 4883571.1667; val_kl_reg_loss: 38546.4414; val_edge_recon_loss: 1716683.7500; val_cat_covariates_contrastive_loss: 313885.6250; val_gene_expr_recon_loss: 2835936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4905052.0000; val_optim_loss: 4905052.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7647; val_auprc_score: 0.8926; val_best_acc_score: 0.8057; val_best_f1_score: 0.8845; train_kl_reg_loss: 34247.1706; train_edge_recon_loss: 1707410.1667; train_cat_covariates_contrastive_loss: 333433.0104; train_gene_expr_recon_loss: 2799761.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4874851.5000; train_optim_loss: 4874851.5000; val_kl_reg_loss: 35204.2031; val_edge_recon_loss: 1747837.1250; val_cat_covariates_contrastive_loss: 313721.8125; val_gene_expr_recon_loss: 2827597.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4924360.0000; val_optim_loss: 4924360.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7728; val_auprc_score: 0.8970; val_best_acc_score: 0.8076; val_best_f1_score: 0.8833; train_kl_reg_loss: 35047.6654; train_edge_recon_loss: 1692751.3750; train_cat_covariates_contrastive_loss: 331064.8229; train_gene_expr_recon_loss: 2784743.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843607.0000; train_optim_loss: 4843607.0000; val_kl_reg_loss: 37632.8477; val_edge_recon_loss: 1777198.6250; val_cat_covariates_contrastive_loss: 313824.2812; val_gene_expr_recon_loss: 2813891.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4942547.0000; val_optim_loss: 4942547.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7596; val_auprc_score: 0.8843; val_best_acc_score: 0.8033; val_best_f1_score: 0.8799; train_kl_reg_loss: 35216.1146; train_edge_recon_loss: 1697217.7500; train_cat_covariates_contrastive_loss: 327631.2708; train_gene_expr_recon_loss: 2775759.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4835824.1667; train_optim_loss: 4835824.1667; val_kl_reg_loss: 38478.3125; val_edge_recon_loss: 1811927.2500; val_cat_covariates_contrastive_loss: 313809.1250; val_gene_expr_recon_loss: 2803611.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4967826.0000; val_optim_loss: 4967826.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7632; val_auprc_score: 0.8857; val_best_acc_score: 0.8065; val_best_f1_score: 0.8834; train_kl_reg_loss: 36074.8164; train_edge_recon_loss: 1655405.0000; train_cat_covariates_contrastive_loss: 329784.0729; train_gene_expr_recon_loss: 2762139.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4783403.0000; train_optim_loss: 4783403.0000; val_kl_reg_loss: 37932.3125; val_edge_recon_loss: 1735534.3750; val_cat_covariates_contrastive_loss: 313866.3750; val_gene_expr_recon_loss: 2789424.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4876757.5000; val_optim_loss: 4876757.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7700; val_auprc_score: 0.8953; val_best_acc_score: 0.8179; val_best_f1_score: 0.8903; train_kl_reg_loss: 36022.7917; train_edge_recon_loss: 1665200.6250; train_cat_covariates_contrastive_loss: 325217.8125; train_gene_expr_recon_loss: 2748470.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4774912.0000; train_optim_loss: 4774912.0000; val_kl_reg_loss: 41886.7891; val_edge_recon_loss: 1638894.3750; val_cat_covariates_contrastive_loss: 313813.6875; val_gene_expr_recon_loss: 2785175.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779770.0000; val_optim_loss: 4779770.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7534; val_auprc_score: 0.8903; val_best_acc_score: 0.7994; val_best_f1_score: 0.8800; train_kl_reg_loss: 38950.6667; train_edge_recon_loss: 1648889.5000; train_cat_covariates_contrastive_loss: 326690.9792; train_gene_expr_recon_loss: 2743097.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4757628.8333; train_optim_loss: 4757628.8333; val_kl_reg_loss: 40997.0039; val_edge_recon_loss: 1723314.2500; val_cat_covariates_contrastive_loss: 313755.3125; val_gene_expr_recon_loss: 2768181.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846247.5000; val_optim_loss: 4846247.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7629; val_auprc_score: 0.8873; val_best_acc_score: 0.8068; val_best_f1_score: 0.8844; train_kl_reg_loss: 39064.3385; train_edge_recon_loss: 1661123.7917; train_cat_covariates_contrastive_loss: 323579.6354; train_gene_expr_recon_loss: 2733239.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4757007.1667; train_optim_loss: 4757007.1667; val_kl_reg_loss: 43146.6094; val_edge_recon_loss: 1686875.6250; val_cat_covariates_contrastive_loss: 313704.2500; val_gene_expr_recon_loss: 2762964.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806691.0000; val_optim_loss: 4806691.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7684; val_auprc_score: 0.8895; val_best_acc_score: 0.8070; val_best_f1_score: 0.8827; train_kl_reg_loss: 40218.4323; train_edge_recon_loss: 1661704.9167; train_cat_covariates_contrastive_loss: 323286.8750; train_gene_expr_recon_loss: 2723147.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4748357.5000; train_optim_loss: 4748357.5000; val_kl_reg_loss: 44546.2969; val_edge_recon_loss: 1711093.8750; val_cat_covariates_contrastive_loss: 313818.6875; val_gene_expr_recon_loss: 2754731.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4824190.0000; val_optim_loss: 4824190.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7750; val_auprc_score: 0.9028; val_best_acc_score: 0.8129; val_best_f1_score: 0.8873; train_kl_reg_loss: 41172.2461; train_edge_recon_loss: 1624158.9583; train_cat_covariates_contrastive_loss: 321729.9792; train_gene_expr_recon_loss: 2715721.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4702783.1667; train_optim_loss: 4702783.1667; val_kl_reg_loss: 44530.7148; val_edge_recon_loss: 1617491.5000; val_cat_covariates_contrastive_loss: 313878.9062; val_gene_expr_recon_loss: 2745732.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721633.5000; val_optim_loss: 4721633.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7727; val_auprc_score: 0.9012; val_best_acc_score: 0.8101; val_best_f1_score: 0.8863; train_kl_reg_loss: 41599.1263; train_edge_recon_loss: 1606336.7917; train_cat_covariates_contrastive_loss: 322945.1771; train_gene_expr_recon_loss: 2706417.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4677299.0000; train_optim_loss: 4677299.0000; val_kl_reg_loss: 44073.1836; val_edge_recon_loss: 1631156.7500; val_cat_covariates_contrastive_loss: 313863.5312; val_gene_expr_recon_loss: 2733679.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722772.5000; val_optim_loss: 4722772.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7468; val_auprc_score: 0.8808; val_best_acc_score: 0.8085; val_best_f1_score: 0.8843; train_kl_reg_loss: 41069.8372; train_edge_recon_loss: 1609330.2500; train_cat_covariates_contrastive_loss: 320701.4375; train_gene_expr_recon_loss: 2699460.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4670561.8333; train_optim_loss: 4670561.8333; val_kl_reg_loss: 43977.2422; val_edge_recon_loss: 1666086.1250; val_cat_covariates_contrastive_loss: 314037.4062; val_gene_expr_recon_loss: 2730316.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4754417.5000; val_optim_loss: 4754417.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7445; val_auprc_score: 0.8818; val_best_acc_score: 0.8021; val_best_f1_score: 0.8818; train_kl_reg_loss: 41710.6615; train_edge_recon_loss: 1619516.8333; train_cat_covariates_contrastive_loss: 321813.4688; train_gene_expr_recon_loss: 2693485.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4676526.5000; train_optim_loss: 4676526.5000; val_kl_reg_loss: 44881.6406; val_edge_recon_loss: 1644944.7500; val_cat_covariates_contrastive_loss: 314053.5312; val_gene_expr_recon_loss: 2730874.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4734754.0000; val_optim_loss: 4734754.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7694; val_auprc_score: 0.8885; val_best_acc_score: 0.8078; val_best_f1_score: 0.8831; train_kl_reg_loss: 41948.3620; train_edge_recon_loss: 1610388.2083; train_cat_covariates_contrastive_loss: 320902.9375; train_gene_expr_recon_loss: 2689667.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4662907.0000; train_optim_loss: 4662907.0000; val_kl_reg_loss: 43912.2812; val_edge_recon_loss: 1640430.5000; val_cat_covariates_contrastive_loss: 314242.4688; val_gene_expr_recon_loss: 2717634.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4716219.5000; val_optim_loss: 4716219.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7704; val_auprc_score: 0.8974; val_best_acc_score: 0.8052; val_best_f1_score: 0.8808; train_kl_reg_loss: 41102.8008; train_edge_recon_loss: 1617933.8750; train_cat_covariates_contrastive_loss: 320121.4479; train_gene_expr_recon_loss: 2677800.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4656958.3333; train_optim_loss: 4656958.3333; val_kl_reg_loss: 43662.8594; val_edge_recon_loss: 1662880.8750; val_cat_covariates_contrastive_loss: 314179.1250; val_gene_expr_recon_loss: 2710039.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4730762.5000; val_optim_loss: 4730762.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7521; val_auprc_score: 0.8940; val_best_acc_score: 0.8077; val_best_f1_score: 0.8852; train_kl_reg_loss: 41558.6263; train_edge_recon_loss: 1582412.9167; train_cat_covariates_contrastive_loss: 320393.0104; train_gene_expr_recon_loss: 2673598.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4617962.6667; train_optim_loss: 4617962.6667; val_kl_reg_loss: 42925.1680; val_edge_recon_loss: 1612985.6250; val_cat_covariates_contrastive_loss: 314262.5938; val_gene_expr_recon_loss: 2697776.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4667950.0000; val_optim_loss: 4667950.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7605; val_auprc_score: 0.8925; val_best_acc_score: 0.8063; val_best_f1_score: 0.8822; train_kl_reg_loss: 40538.0234; train_edge_recon_loss: 1599349.4167; train_cat_covariates_contrastive_loss: 320429.0000; train_gene_expr_recon_loss: 2665761.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4626078.3333; train_optim_loss: 4626078.3333; val_kl_reg_loss: 41368.6680; val_edge_recon_loss: 1641205.5000; val_cat_covariates_contrastive_loss: 314358.3125; val_gene_expr_recon_loss: 2691601.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4688534.0000; val_optim_loss: 4688534.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7546; val_auprc_score: 0.8887; val_best_acc_score: 0.8093; val_best_f1_score: 0.8854; train_kl_reg_loss: 40187.2031; train_edge_recon_loss: 1587267.5833; train_cat_covariates_contrastive_loss: 320736.2292; train_gene_expr_recon_loss: 2663712.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4611903.5000; train_optim_loss: 4611903.5000; val_kl_reg_loss: 42017.1172; val_edge_recon_loss: 1604675.0000; val_cat_covariates_contrastive_loss: 314383.8438; val_gene_expr_recon_loss: 2694757.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4655834.0000; val_optim_loss: 4655834.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7713; val_auprc_score: 0.8970; val_best_acc_score: 0.8075; val_best_f1_score: 0.8833; train_kl_reg_loss: 40040.4883; train_edge_recon_loss: 1571896.3750; train_cat_covariates_contrastive_loss: 319471.0729; train_gene_expr_recon_loss: 2656916.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4588324.8333; train_optim_loss: 4588324.8333; val_kl_reg_loss: 41264.9609; val_edge_recon_loss: 1615343.3750; val_cat_covariates_contrastive_loss: 314404.6562; val_gene_expr_recon_loss: 2683521.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4654534.5000; val_optim_loss: 4654534.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7708; val_auprc_score: 0.8966; val_best_acc_score: 0.8099; val_best_f1_score: 0.8845; train_kl_reg_loss: 40649.4440; train_edge_recon_loss: 1577238.5417; train_cat_covariates_contrastive_loss: 319358.6354; train_gene_expr_recon_loss: 2651805.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4589052.6667; train_optim_loss: 4589052.6667; val_kl_reg_loss: 42356.3594; val_edge_recon_loss: 1622364.1250; val_cat_covariates_contrastive_loss: 314327.2188; val_gene_expr_recon_loss: 2688604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4667652.0000; val_optim_loss: 4667652.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7701; val_auprc_score: 0.8996; val_best_acc_score: 0.8149; val_best_f1_score: 0.8871; train_kl_reg_loss: 39926.7161; train_edge_recon_loss: 1574894.9167; train_cat_covariates_contrastive_loss: 319895.6979; train_gene_expr_recon_loss: 2643304.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4578022.1667; train_optim_loss: 4578022.1667; val_kl_reg_loss: 40099.5312; val_edge_recon_loss: 1588735.2500; val_cat_covariates_contrastive_loss: 314478.5000; val_gene_expr_recon_loss: 2670185.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4613498.0000; val_optim_loss: 4613498.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.7719; val_auprc_score: 0.9069; val_best_acc_score: 0.8260; val_best_f1_score: 0.8952; train_kl_reg_loss: 39375.9961; train_edge_recon_loss: 1567369.7917; train_cat_covariates_contrastive_loss: 319817.7396; train_gene_expr_recon_loss: 2640876.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4567439.8333; train_optim_loss: 4567439.8333; val_kl_reg_loss: 40322.3203; val_edge_recon_loss: 1487396.7500; val_cat_covariates_contrastive_loss: 314679.3750; val_gene_expr_recon_loss: 2668890.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4511289.0000; val_optim_loss: 4511289.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7786; val_auprc_score: 0.9017; val_best_acc_score: 0.8166; val_best_f1_score: 0.8896; train_kl_reg_loss: 39875.2721; train_edge_recon_loss: 1544837.9167; train_cat_covariates_contrastive_loss: 318971.8542; train_gene_expr_recon_loss: 2634425.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4538110.5000; train_optim_loss: 4538110.5000; val_kl_reg_loss: 41451.2930; val_edge_recon_loss: 1550427.8750; val_cat_covariates_contrastive_loss: 314447.6562; val_gene_expr_recon_loss: 2671072.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4577399.0000; val_optim_loss: 4577399.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7891; val_auprc_score: 0.9068; val_best_acc_score: 0.8173; val_best_f1_score: 0.8890; train_kl_reg_loss: 40228.6823; train_edge_recon_loss: 1559586.4167; train_cat_covariates_contrastive_loss: 319251.0625; train_gene_expr_recon_loss: 2629636.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4548702.6667; train_optim_loss: 4548702.6667; val_kl_reg_loss: 42316.8672; val_edge_recon_loss: 1569680.1250; val_cat_covariates_contrastive_loss: 314388.6250; val_gene_expr_recon_loss: 2658441.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4584827.5000; val_optim_loss: 4584827.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.7813; val_auprc_score: 0.9072; val_best_acc_score: 0.8232; val_best_f1_score: 0.8937; train_kl_reg_loss: 40998.8724; train_edge_recon_loss: 1566740.7917; train_cat_covariates_contrastive_loss: 319809.9792; train_gene_expr_recon_loss: 2627988.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4555538.3333; train_optim_loss: 4555538.3333; val_kl_reg_loss: 42478.0664; val_edge_recon_loss: 1510823.1250; val_cat_covariates_contrastive_loss: 314983.3750; val_gene_expr_recon_loss: 2659443.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527728.0000; val_optim_loss: 4527728.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.7856; val_auprc_score: 0.8996; val_best_acc_score: 0.8137; val_best_f1_score: 0.8861; train_kl_reg_loss: 41470.3633; train_edge_recon_loss: 1541536.6667; train_cat_covariates_contrastive_loss: 319370.0521; train_gene_expr_recon_loss: 2618336.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4520714.0000; train_optim_loss: 4520714.0000; val_kl_reg_loss: 42810.4688; val_edge_recon_loss: 1616841.1250; val_cat_covariates_contrastive_loss: 314775.0938; val_gene_expr_recon_loss: 2659649.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4634076.0000; val_optim_loss: 4634076.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7828; val_auprc_score: 0.8972; val_best_acc_score: 0.8185; val_best_f1_score: 0.8892; train_kl_reg_loss: 40819.9453; train_edge_recon_loss: 1555002.5833; train_cat_covariates_contrastive_loss: 319478.1042; train_gene_expr_recon_loss: 2617483.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4532784.0000; train_optim_loss: 4532784.0000; val_kl_reg_loss: 42102.6719; val_edge_recon_loss: 1573548.8750; val_cat_covariates_contrastive_loss: 314805.9688; val_gene_expr_recon_loss: 2661482.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4591940.0000; val_optim_loss: 4591940.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.7794; val_auprc_score: 0.9001; val_best_acc_score: 0.8129; val_best_f1_score: 0.8870; train_kl_reg_loss: 40969.0951; train_edge_recon_loss: 1554670.6250; train_cat_covariates_contrastive_loss: 319173.6458; train_gene_expr_recon_loss: 2616613.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4531427.1667; train_optim_loss: 4531427.1667; val_kl_reg_loss: 41480.0859; val_edge_recon_loss: 1579617.2500; val_cat_covariates_contrastive_loss: 314787.4062; val_gene_expr_recon_loss: 2647382.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4583267.0000; val_optim_loss: 4583267.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.7986; val_auprc_score: 0.9101; val_best_acc_score: 0.8186; val_best_f1_score: 0.8886; train_kl_reg_loss: 40616.9036; train_edge_recon_loss: 1557755.5000; train_cat_covariates_contrastive_loss: 319342.8438; train_gene_expr_recon_loss: 2614480.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4532195.5000; train_optim_loss: 4532195.5000; val_kl_reg_loss: 41518.3945; val_edge_recon_loss: 1582105.2500; val_cat_covariates_contrastive_loss: 314942.1875; val_gene_expr_recon_loss: 2650949.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4589515.0000; val_optim_loss: 4589515.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.7792; val_auprc_score: 0.9022; val_best_acc_score: 0.8103; val_best_f1_score: 0.8850; train_kl_reg_loss: 40637.5156; train_edge_recon_loss: 1547050.9167; train_cat_covariates_contrastive_loss: 319693.9896; train_gene_expr_recon_loss: 2616519.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4523902.3333; train_optim_loss: 4523902.3333; val_kl_reg_loss: 41345.8047; val_edge_recon_loss: 1607974.5000; val_cat_covariates_contrastive_loss: 314852.4062; val_gene_expr_recon_loss: 2655454.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4619627.0000; val_optim_loss: 4619627.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 3 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.7763
val AUPRC score: 0.8959
val best accuracy score: 0.8196
val best F1 score: 0.8887
val target rna MSE score: 0.8890
val source rna MSE score: 0.3986
Val cat covariate0 mean sim diff: 0.0182
Duration of model training in run 8: 0 hours, 1 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9435; val_auprc_score: 0.9773; val_best_acc_score: 0.8120; val_best_f1_score: 0.8882; train_kl_reg_loss: 165.3717; train_edge_recon_loss: 1727476.8750; train_cat_covariates_contrastive_loss: 643847.3958; train_gene_expr_recon_loss: 3771925.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6143415.0000; train_optim_loss: 6143415.0000; val_kl_reg_loss: 852.2885; val_edge_recon_loss: 1994786.1250; val_cat_covariates_contrastive_loss: 313999.1875; val_gene_expr_recon_loss: 3833764.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6143402.0000; val_optim_loss: 6143402.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9337; val_auprc_score: 0.9736; val_best_acc_score: 0.7808; val_best_f1_score: 0.8708; train_kl_reg_loss: 1372.5907; train_edge_recon_loss: 1780973.5000; train_cat_covariates_contrastive_loss: 456725.3646; train_gene_expr_recon_loss: 3671671.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5910743.0000; train_optim_loss: 5910743.0000; val_kl_reg_loss: 2398.2947; val_edge_recon_loss: 2110051.2500; val_cat_covariates_contrastive_loss: 313534.5000; val_gene_expr_recon_loss: 3741715.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6167699.0000; val_optim_loss: 6167699.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9237; val_auprc_score: 0.9648; val_best_acc_score: 0.7957; val_best_f1_score: 0.8807; train_kl_reg_loss: 2546.9413; train_edge_recon_loss: 1866503.4167; train_cat_covariates_contrastive_loss: 356008.9688; train_gene_expr_recon_loss: 3613141.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5838200.5000; train_optim_loss: 5838200.5000; val_kl_reg_loss: 2571.0093; val_edge_recon_loss: 1986402.2500; val_cat_covariates_contrastive_loss: 313503.6562; val_gene_expr_recon_loss: 3685130.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5987607.5000; val_optim_loss: 5987607.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9307; val_auprc_score: 0.9759; val_best_acc_score: 0.7949; val_best_f1_score: 0.8782; train_kl_reg_loss: 2262.4631; train_edge_recon_loss: 1882957.3750; train_cat_covariates_contrastive_loss: 355535.9896; train_gene_expr_recon_loss: 3579758.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5820514.0000; train_optim_loss: 5820514.0000; val_kl_reg_loss: 1708.2417; val_edge_recon_loss: 2062269.8750; val_cat_covariates_contrastive_loss: 313579.7188; val_gene_expr_recon_loss: 3661654.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6039212.0000; val_optim_loss: 6039212.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9097; val_auprc_score: 0.9609; val_best_acc_score: 0.8001; val_best_f1_score: 0.8807; train_kl_reg_loss: 1476.8167; train_edge_recon_loss: 1791297.0833; train_cat_covariates_contrastive_loss: 391706.4792; train_gene_expr_recon_loss: 3543707.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5728187.8333; train_optim_loss: 5728187.8333; val_kl_reg_loss: 1464.5027; val_edge_recon_loss: 2020472.3750; val_cat_covariates_contrastive_loss: 313607.0312; val_gene_expr_recon_loss: 3627658.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5963202.0000; val_optim_loss: 5963202.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8973; val_auprc_score: 0.9588; val_best_acc_score: 0.8038; val_best_f1_score: 0.8832; train_kl_reg_loss: 1505.7384; train_edge_recon_loss: 1794897.4167; train_cat_covariates_contrastive_loss: 388491.1354; train_gene_expr_recon_loss: 3508789.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5693683.1667; train_optim_loss: 5693683.1667; val_kl_reg_loss: 1814.6021; val_edge_recon_loss: 1935997.0000; val_cat_covariates_contrastive_loss: 313567.0625; val_gene_expr_recon_loss: 3588077.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5839456.0000; val_optim_loss: 5839456.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8832; val_auprc_score: 0.9546; val_best_acc_score: 0.7938; val_best_f1_score: 0.8763; train_kl_reg_loss: 1777.8241; train_edge_recon_loss: 1797423.3750; train_cat_covariates_contrastive_loss: 379102.1146; train_gene_expr_recon_loss: 3472664.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5650968.1667; train_optim_loss: 5650968.1667; val_kl_reg_loss: 2069.0410; val_edge_recon_loss: 2057758.3750; val_cat_covariates_contrastive_loss: 313562.1250; val_gene_expr_recon_loss: 3540982.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5914372.0000; val_optim_loss: 5914372.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8578; val_auprc_score: 0.9449; val_best_acc_score: 0.7904; val_best_f1_score: 0.8714; train_kl_reg_loss: 2078.9917; train_edge_recon_loss: 1796015.2083; train_cat_covariates_contrastive_loss: 371025.4167; train_gene_expr_recon_loss: 3433127.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5602247.0000; train_optim_loss: 5602247.0000; val_kl_reg_loss: 2489.3652; val_edge_recon_loss: 2103994.7500; val_cat_covariates_contrastive_loss: 313551.8438; val_gene_expr_recon_loss: 3495013.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5915049.5000; val_optim_loss: 5915049.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8354; val_auprc_score: 0.9377; val_best_acc_score: 0.8045; val_best_f1_score: 0.8803; train_kl_reg_loss: 2544.5828; train_edge_recon_loss: 1795593.2917; train_cat_covariates_contrastive_loss: 366123.7292; train_gene_expr_recon_loss: 3392630.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5556892.0000; train_optim_loss: 5556892.0000; val_kl_reg_loss: 3044.1072; val_edge_recon_loss: 2008357.6250; val_cat_covariates_contrastive_loss: 313531.9062; val_gene_expr_recon_loss: 3443782.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5768716.0000; val_optim_loss: 5768716.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8146; val_auprc_score: 0.9184; val_best_acc_score: 0.8003; val_best_f1_score: 0.8798; train_kl_reg_loss: 3142.1029; train_edge_recon_loss: 1789341.7083; train_cat_covariates_contrastive_loss: 368538.5417; train_gene_expr_recon_loss: 3351126.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5512148.5000; train_optim_loss: 5512148.5000; val_kl_reg_loss: 3940.3223; val_edge_recon_loss: 2036250.3750; val_cat_covariates_contrastive_loss: 313559.2500; val_gene_expr_recon_loss: 3412723.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5766473.0000; val_optim_loss: 5766473.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8041; val_auprc_score: 0.9192; val_best_acc_score: 0.8001; val_best_f1_score: 0.8794; train_kl_reg_loss: 4118.5600; train_edge_recon_loss: 1782286.7083; train_cat_covariates_contrastive_loss: 375526.6771; train_gene_expr_recon_loss: 3306095.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5468027.0000; train_optim_loss: 5468027.0000; val_kl_reg_loss: 5307.9878; val_edge_recon_loss: 2042794.2500; val_cat_covariates_contrastive_loss: 313512.0625; val_gene_expr_recon_loss: 3370721.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5732335.0000; val_optim_loss: 5732335.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7984; val_auprc_score: 0.9096; val_best_acc_score: 0.8141; val_best_f1_score: 0.8875; train_kl_reg_loss: 5566.9344; train_edge_recon_loss: 1787653.6667; train_cat_covariates_contrastive_loss: 360475.6042; train_gene_expr_recon_loss: 3268746.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5422442.5000; train_optim_loss: 5422442.5000; val_kl_reg_loss: 7157.2812; val_edge_recon_loss: 1974167.5000; val_cat_covariates_contrastive_loss: 313601.6562; val_gene_expr_recon_loss: 3320924.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5615851.0000; val_optim_loss: 5615851.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8035; val_auprc_score: 0.9186; val_best_acc_score: 0.8224; val_best_f1_score: 0.8916; train_kl_reg_loss: 7922.4334; train_edge_recon_loss: 1789300.4583; train_cat_covariates_contrastive_loss: 355633.4896; train_gene_expr_recon_loss: 3228031.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5380887.6667; train_optim_loss: 5380887.6667; val_kl_reg_loss: 10955.9414; val_edge_recon_loss: 1915414.6250; val_cat_covariates_contrastive_loss: 313609.8438; val_gene_expr_recon_loss: 3267671.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5507652.0000; val_optim_loss: 5507652.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7834; val_auprc_score: 0.9052; val_best_acc_score: 0.8197; val_best_f1_score: 0.8883; train_kl_reg_loss: 12237.0013; train_edge_recon_loss: 1760160.4167; train_cat_covariates_contrastive_loss: 350094.4479; train_gene_expr_recon_loss: 3182026.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5304518.6667; train_optim_loss: 5304518.6667; val_kl_reg_loss: 17698.8730; val_edge_recon_loss: 1956608.6250; val_cat_covariates_contrastive_loss: 313570.9688; val_gene_expr_recon_loss: 3224061.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5511940.0000; val_optim_loss: 5511940.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7954; val_auprc_score: 0.9004; val_best_acc_score: 0.8197; val_best_f1_score: 0.8875; train_kl_reg_loss: 21175.7793; train_edge_recon_loss: 1765267.0417; train_cat_covariates_contrastive_loss: 344164.3438; train_gene_expr_recon_loss: 3133387.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5263994.6667; train_optim_loss: 5263994.6667; val_kl_reg_loss: 27518.0332; val_edge_recon_loss: 1995041.5000; val_cat_covariates_contrastive_loss: 313724.6562; val_gene_expr_recon_loss: 3174545.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5510829.5000; val_optim_loss: 5510829.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8056; val_auprc_score: 0.9103; val_best_acc_score: 0.8282; val_best_f1_score: 0.8946; train_kl_reg_loss: 29486.2682; train_edge_recon_loss: 1754201.5417; train_cat_covariates_contrastive_loss: 334497.3333; train_gene_expr_recon_loss: 3077640.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195825.3333; train_optim_loss: 5195825.3333; val_kl_reg_loss: 36849.8047; val_edge_recon_loss: 1965332.0000; val_cat_covariates_contrastive_loss: 313601.7812; val_gene_expr_recon_loss: 3131283.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5447067.0000; val_optim_loss: 5447067.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7840; val_auprc_score: 0.9016; val_best_acc_score: 0.8162; val_best_f1_score: 0.8871; train_kl_reg_loss: 38162.1406; train_edge_recon_loss: 1767809.0000; train_cat_covariates_contrastive_loss: 330786.2917; train_gene_expr_recon_loss: 3035503.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5172261.3333; train_optim_loss: 5172261.3333; val_kl_reg_loss: 45969.9883; val_edge_recon_loss: 1981391.8750; val_cat_covariates_contrastive_loss: 313603.5625; val_gene_expr_recon_loss: 3068017.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5408983.0000; val_optim_loss: 5408983.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7914; val_auprc_score: 0.9051; val_best_acc_score: 0.8152; val_best_f1_score: 0.8871; train_kl_reg_loss: 42731.2409; train_edge_recon_loss: 1750378.8333; train_cat_covariates_contrastive_loss: 329453.1875; train_gene_expr_recon_loss: 2994544.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5117107.5000; train_optim_loss: 5117107.5000; val_kl_reg_loss: 52346.2773; val_edge_recon_loss: 1993589.0000; val_cat_covariates_contrastive_loss: 313694.1562; val_gene_expr_recon_loss: 3040084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5399713.5000; val_optim_loss: 5399713.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7902; val_auprc_score: 0.9048; val_best_acc_score: 0.8247; val_best_f1_score: 0.8924; train_kl_reg_loss: 46303.5234; train_edge_recon_loss: 1779331.6250; train_cat_covariates_contrastive_loss: 330468.9479; train_gene_expr_recon_loss: 2957088.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5113192.1667; train_optim_loss: 5113192.1667; val_kl_reg_loss: 50049.7109; val_edge_recon_loss: 1860313.6250; val_cat_covariates_contrastive_loss: 313733.9375; val_gene_expr_recon_loss: 3005567.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5229664.5000; val_optim_loss: 5229664.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7845; val_auprc_score: 0.9020; val_best_acc_score: 0.8192; val_best_f1_score: 0.8880; train_kl_reg_loss: 46960.5833; train_edge_recon_loss: 1775406.8750; train_cat_covariates_contrastive_loss: 332117.8021; train_gene_expr_recon_loss: 2926418.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5080903.8333; train_optim_loss: 5080903.8333; val_kl_reg_loss: 45233.0273; val_edge_recon_loss: 1934655.5000; val_cat_covariates_contrastive_loss: 313813.0938; val_gene_expr_recon_loss: 2987201.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5280902.5000; val_optim_loss: 5280902.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7882; val_auprc_score: 0.9014; val_best_acc_score: 0.8189; val_best_f1_score: 0.8889; train_kl_reg_loss: 43452.0794; train_edge_recon_loss: 1740312.9167; train_cat_covariates_contrastive_loss: 332880.1979; train_gene_expr_recon_loss: 2898310.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5014956.1667; train_optim_loss: 5014956.1667; val_kl_reg_loss: 41750.5625; val_edge_recon_loss: 1865159.1250; val_cat_covariates_contrastive_loss: 313909.1875; val_gene_expr_recon_loss: 2955309.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5176128.5000; val_optim_loss: 5176128.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7828; val_auprc_score: 0.8978; val_best_acc_score: 0.8148; val_best_f1_score: 0.8852; train_kl_reg_loss: 41626.2253; train_edge_recon_loss: 1754127.7500; train_cat_covariates_contrastive_loss: 333234.2812; train_gene_expr_recon_loss: 2883247.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5012236.3333; train_optim_loss: 5012236.3333; val_kl_reg_loss: 44897.9922; val_edge_recon_loss: 1866023.2500; val_cat_covariates_contrastive_loss: 313942.5938; val_gene_expr_recon_loss: 2945610.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5170474.0000; val_optim_loss: 5170474.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7872; val_auprc_score: 0.8957; val_best_acc_score: 0.8175; val_best_f1_score: 0.8850; train_kl_reg_loss: 40222.7943; train_edge_recon_loss: 1730112.3333; train_cat_covariates_contrastive_loss: 332363.2708; train_gene_expr_recon_loss: 2862414.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4965113.3333; train_optim_loss: 4965113.3333; val_kl_reg_loss: 38825.9453; val_edge_recon_loss: 1914813.5000; val_cat_covariates_contrastive_loss: 313864.0938; val_gene_expr_recon_loss: 2918465.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5185968.5000; val_optim_loss: 5185968.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7713; val_auprc_score: 0.9000; val_best_acc_score: 0.8184; val_best_f1_score: 0.8918; train_kl_reg_loss: 38630.7227; train_edge_recon_loss: 1693702.5833; train_cat_covariates_contrastive_loss: 334567.4896; train_gene_expr_recon_loss: 2844231.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4911131.8333; train_optim_loss: 4911131.8333; val_kl_reg_loss: 37456.2578; val_edge_recon_loss: 1735938.0000; val_cat_covariates_contrastive_loss: 314155.6250; val_gene_expr_recon_loss: 2901972.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4989522.5000; val_optim_loss: 4989522.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7679; val_auprc_score: 0.8912; val_best_acc_score: 0.8044; val_best_f1_score: 0.8804; train_kl_reg_loss: 36471.8568; train_edge_recon_loss: 1724340.6250; train_cat_covariates_contrastive_loss: 333141.0625; train_gene_expr_recon_loss: 2831166.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4925119.8333; train_optim_loss: 4925119.8333; val_kl_reg_loss: 42783.3047; val_edge_recon_loss: 1837109.3750; val_cat_covariates_contrastive_loss: 313949.9062; val_gene_expr_recon_loss: 2894518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5088360.5000; val_optim_loss: 5088360.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7805; val_auprc_score: 0.9015; val_best_acc_score: 0.8142; val_best_f1_score: 0.8867; train_kl_reg_loss: 38492.2161; train_edge_recon_loss: 1691412.0833; train_cat_covariates_contrastive_loss: 332912.3333; train_gene_expr_recon_loss: 2815630.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4878446.8333; train_optim_loss: 4878446.8333; val_kl_reg_loss: 36902.3594; val_edge_recon_loss: 1755989.3750; val_cat_covariates_contrastive_loss: 314080.3750; val_gene_expr_recon_loss: 2869303.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4976275.5000; val_optim_loss: 4976275.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7714; val_auprc_score: 0.8917; val_best_acc_score: 0.8094; val_best_f1_score: 0.8833; train_kl_reg_loss: 36887.5365; train_edge_recon_loss: 1698572.0417; train_cat_covariates_contrastive_loss: 330447.1771; train_gene_expr_recon_loss: 2804465.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4870372.3333; train_optim_loss: 4870372.3333; val_kl_reg_loss: 43797.3984; val_edge_recon_loss: 1787924.5000; val_cat_covariates_contrastive_loss: 314106.7500; val_gene_expr_recon_loss: 2863090.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5008919.0000; val_optim_loss: 5008919.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7774; val_auprc_score: 0.8971; val_best_acc_score: 0.8067; val_best_f1_score: 0.8832; train_kl_reg_loss: 39607.4193; train_edge_recon_loss: 1691713.2917; train_cat_covariates_contrastive_loss: 330056.0104; train_gene_expr_recon_loss: 2792086.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4853463.3333; train_optim_loss: 4853463.3333; val_kl_reg_loss: 40837.3438; val_edge_recon_loss: 1773408.7500; val_cat_covariates_contrastive_loss: 314140.4688; val_gene_expr_recon_loss: 2847654.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4976041.0000; val_optim_loss: 4976041.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7676; val_auprc_score: 0.8942; val_best_acc_score: 0.8018; val_best_f1_score: 0.8801; train_kl_reg_loss: 39667.8529; train_edge_recon_loss: 1681704.1667; train_cat_covariates_contrastive_loss: 329449.7292; train_gene_expr_recon_loss: 2774598.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825420.0000; train_optim_loss: 4825420.0000; val_kl_reg_loss: 45435.8398; val_edge_recon_loss: 1766929.0000; val_cat_covariates_contrastive_loss: 314383.9688; val_gene_expr_recon_loss: 2836223.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4962972.0000; val_optim_loss: 4962972.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7809; val_auprc_score: 0.8997; val_best_acc_score: 0.8098; val_best_f1_score: 0.8851; train_kl_reg_loss: 41439.8086; train_edge_recon_loss: 1695789.3333; train_cat_covariates_contrastive_loss: 328955.3958; train_gene_expr_recon_loss: 2765363.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4831548.5000; train_optim_loss: 4831548.5000; val_kl_reg_loss: 42140.7500; val_edge_recon_loss: 1695094.2500; val_cat_covariates_contrastive_loss: 314258.5625; val_gene_expr_recon_loss: 2821472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4872965.5000; val_optim_loss: 4872965.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7689; val_auprc_score: 0.9013; val_best_acc_score: 0.8131; val_best_f1_score: 0.8879; train_kl_reg_loss: 40723.0885; train_edge_recon_loss: 1678494.1250; train_cat_covariates_contrastive_loss: 327714.5833; train_gene_expr_recon_loss: 2751977.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4798909.5000; train_optim_loss: 4798909.5000; val_kl_reg_loss: 46557.6094; val_edge_recon_loss: 1650842.3750; val_cat_covariates_contrastive_loss: 314439.3750; val_gene_expr_recon_loss: 2814378.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4826218.0000; val_optim_loss: 4826218.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7667; val_auprc_score: 0.8876; val_best_acc_score: 0.8132; val_best_f1_score: 0.8862; train_kl_reg_loss: 44040.0326; train_edge_recon_loss: 1651344.3333; train_cat_covariates_contrastive_loss: 328553.6146; train_gene_expr_recon_loss: 2743796.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4767734.3333; train_optim_loss: 4767734.3333; val_kl_reg_loss: 43879.5703; val_edge_recon_loss: 1684403.2500; val_cat_covariates_contrastive_loss: 314813.4375; val_gene_expr_recon_loss: 2806142.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849239.0000; val_optim_loss: 4849239.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7653; val_auprc_score: 0.8947; val_best_acc_score: 0.8085; val_best_f1_score: 0.8845; train_kl_reg_loss: 41164.2500; train_edge_recon_loss: 1660697.6667; train_cat_covariates_contrastive_loss: 326405.7604; train_gene_expr_recon_loss: 2735474.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4763742.1667; train_optim_loss: 4763742.1667; val_kl_reg_loss: 44815.1328; val_edge_recon_loss: 1667052.6250; val_cat_covariates_contrastive_loss: 314497.1250; val_gene_expr_recon_loss: 2798644.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825009.5000; val_optim_loss: 4825009.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7769; val_auprc_score: 0.8970; val_best_acc_score: 0.8126; val_best_f1_score: 0.8859; train_kl_reg_loss: 42840.8555; train_edge_recon_loss: 1645002.7083; train_cat_covariates_contrastive_loss: 326639.2396; train_gene_expr_recon_loss: 2730553.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4745036.1667; train_optim_loss: 4745036.1667; val_kl_reg_loss: 46026.3828; val_edge_recon_loss: 1677209.8750; val_cat_covariates_contrastive_loss: 314670.2812; val_gene_expr_recon_loss: 2782608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820514.5000; val_optim_loss: 4820514.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7706; val_auprc_score: 0.8957; val_best_acc_score: 0.8165; val_best_f1_score: 0.8872; train_kl_reg_loss: 44009.5807; train_edge_recon_loss: 1654358.1667; train_cat_covariates_contrastive_loss: 325213.4896; train_gene_expr_recon_loss: 2722485.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4746066.3333; train_optim_loss: 4746066.3333; val_kl_reg_loss: 47706.4844; val_edge_recon_loss: 1638149.6250; val_cat_covariates_contrastive_loss: 314289.6562; val_gene_expr_recon_loss: 2783104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4783250.0000; val_optim_loss: 4783250.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7749; val_auprc_score: 0.9050; val_best_acc_score: 0.8117; val_best_f1_score: 0.8875; train_kl_reg_loss: 44463.0547; train_edge_recon_loss: 1641263.3750; train_cat_covariates_contrastive_loss: 323378.4167; train_gene_expr_recon_loss: 2712880.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721985.5000; train_optim_loss: 4721985.5000; val_kl_reg_loss: 48023.5156; val_edge_recon_loss: 1605665.1250; val_cat_covariates_contrastive_loss: 314655.8750; val_gene_expr_recon_loss: 2779607.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747951.5000; val_optim_loss: 4747951.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7732; val_auprc_score: 0.9000; val_best_acc_score: 0.8103; val_best_f1_score: 0.8857; train_kl_reg_loss: 43604.5247; train_edge_recon_loss: 1631861.0417; train_cat_covariates_contrastive_loss: 322658.1562; train_gene_expr_recon_loss: 2708602.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4706726.5000; train_optim_loss: 4706726.5000; val_kl_reg_loss: 46653.0859; val_edge_recon_loss: 1639168.5000; val_cat_covariates_contrastive_loss: 315152.2812; val_gene_expr_recon_loss: 2767305.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768279.0000; val_optim_loss: 4768279.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7613; val_auprc_score: 0.8941; val_best_acc_score: 0.8036; val_best_f1_score: 0.8826; train_kl_reg_loss: 42859.8750; train_edge_recon_loss: 1623638.0000; train_cat_covariates_contrastive_loss: 322189.3646; train_gene_expr_recon_loss: 2703247.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4691935.1667; train_optim_loss: 4691935.1667; val_kl_reg_loss: 46196.6211; val_edge_recon_loss: 1658272.2500; val_cat_covariates_contrastive_loss: 315022.5625; val_gene_expr_recon_loss: 2769867.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789358.5000; val_optim_loss: 4789358.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7659; val_auprc_score: 0.9016; val_best_acc_score: 0.8230; val_best_f1_score: 0.8937; train_kl_reg_loss: 42917.4193; train_edge_recon_loss: 1600355.2500; train_cat_covariates_contrastive_loss: 322778.5104; train_gene_expr_recon_loss: 2693543.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4659594.3333; train_optim_loss: 4659594.3333; val_kl_reg_loss: 46370.5469; val_edge_recon_loss: 1536809.7500; val_cat_covariates_contrastive_loss: 315041.4375; val_gene_expr_recon_loss: 2753632.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4651854.0000; val_optim_loss: 4651854.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7640; val_auprc_score: 0.8902; val_best_acc_score: 0.8015; val_best_f1_score: 0.8786; train_kl_reg_loss: 43319.6602; train_edge_recon_loss: 1612413.0000; train_cat_covariates_contrastive_loss: 321839.6979; train_gene_expr_recon_loss: 2690419.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4667991.8333; train_optim_loss: 4667991.8333; val_kl_reg_loss: 46422.0312; val_edge_recon_loss: 1655690.5000; val_cat_covariates_contrastive_loss: 315419.4062; val_gene_expr_recon_loss: 2748795.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4766327.0000; val_optim_loss: 4766327.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7744; val_auprc_score: 0.8937; val_best_acc_score: 0.8139; val_best_f1_score: 0.8847; train_kl_reg_loss: 42615.7318; train_edge_recon_loss: 1566475.2500; train_cat_covariates_contrastive_loss: 320381.6146; train_gene_expr_recon_loss: 2684162.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4613635.3333; train_optim_loss: 4613635.3333; val_kl_reg_loss: 44393.7891; val_edge_recon_loss: 1631639.2500; val_cat_covariates_contrastive_loss: 315325.5938; val_gene_expr_recon_loss: 2740053.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731411.5000; val_optim_loss: 4731411.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7687; val_auprc_score: 0.8985; val_best_acc_score: 0.8118; val_best_f1_score: 0.8867; train_kl_reg_loss: 41310.3346; train_edge_recon_loss: 1588757.4583; train_cat_covariates_contrastive_loss: 321094.8229; train_gene_expr_recon_loss: 2676526.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4627689.3333; train_optim_loss: 4627689.3333; val_kl_reg_loss: 44796.8320; val_edge_recon_loss: 1583008.7500; val_cat_covariates_contrastive_loss: 315483.8125; val_gene_expr_recon_loss: 2734039.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4677329.0000; val_optim_loss: 4677329.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7766; val_auprc_score: 0.9077; val_best_acc_score: 0.8291; val_best_f1_score: 0.8971; train_kl_reg_loss: 42134.1693; train_edge_recon_loss: 1590700.5000; train_cat_covariates_contrastive_loss: 321462.9479; train_gene_expr_recon_loss: 2669812.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4624110.1667; train_optim_loss: 4624110.1667; val_kl_reg_loss: 45803.0234; val_edge_recon_loss: 1497046.5000; val_cat_covariates_contrastive_loss: 316019.0938; val_gene_expr_recon_loss: 2731475.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4590344.0000; val_optim_loss: 4590344.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.7947; val_auprc_score: 0.9080; val_best_acc_score: 0.8197; val_best_f1_score: 0.8906; train_kl_reg_loss: 42477.6224; train_edge_recon_loss: 1597190.9167; train_cat_covariates_contrastive_loss: 319872.9375; train_gene_expr_recon_loss: 2661575.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4621117.0000; train_optim_loss: 4621117.0000; val_kl_reg_loss: 45999.6953; val_edge_recon_loss: 1549527.0000; val_cat_covariates_contrastive_loss: 315627.1562; val_gene_expr_recon_loss: 2720635.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4631789.0000; val_optim_loss: 4631789.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7827; val_auprc_score: 0.9034; val_best_acc_score: 0.8124; val_best_f1_score: 0.8846; train_kl_reg_loss: 41864.3698; train_edge_recon_loss: 1590738.1667; train_cat_covariates_contrastive_loss: 321379.2708; train_gene_expr_recon_loss: 2657402.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4611384.5000; train_optim_loss: 4611384.5000; val_kl_reg_loss: 44390.3359; val_edge_recon_loss: 1626580.7500; val_cat_covariates_contrastive_loss: 315550.4062; val_gene_expr_recon_loss: 2718414.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4704936.0000; val_optim_loss: 4704936.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7778; val_auprc_score: 0.8991; val_best_acc_score: 0.8157; val_best_f1_score: 0.8875; train_kl_reg_loss: 42018.5547; train_edge_recon_loss: 1581982.4583; train_cat_covariates_contrastive_loss: 321324.6562; train_gene_expr_recon_loss: 2653340.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4598665.8333; train_optim_loss: 4598665.8333; val_kl_reg_loss: 45252.9609; val_edge_recon_loss: 1601536.7500; val_cat_covariates_contrastive_loss: 316003.5000; val_gene_expr_recon_loss: 2702315.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4665108.0000; val_optim_loss: 4665108.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.7831; val_auprc_score: 0.9032; val_best_acc_score: 0.8144; val_best_f1_score: 0.8863; train_kl_reg_loss: 42929.9688; train_edge_recon_loss: 1564855.4167; train_cat_covariates_contrastive_loss: 320281.9583; train_gene_expr_recon_loss: 2648253.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4576320.8333; train_optim_loss: 4576320.8333; val_kl_reg_loss: 47004.8906; val_edge_recon_loss: 1597295.0000; val_cat_covariates_contrastive_loss: 316304.5312; val_gene_expr_recon_loss: 2715102.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4675707.0000; val_optim_loss: 4675707.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.7855; val_auprc_score: 0.8998; val_best_acc_score: 0.8100; val_best_f1_score: 0.8854; train_kl_reg_loss: 42770.1107; train_edge_recon_loss: 1573863.8333; train_cat_covariates_contrastive_loss: 320675.7917; train_gene_expr_recon_loss: 2643473.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4580783.3333; train_optim_loss: 4580783.3333; val_kl_reg_loss: 45716.5469; val_edge_recon_loss: 1609353.8750; val_cat_covariates_contrastive_loss: 315761.1875; val_gene_expr_recon_loss: 2701201.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4672032.5000; val_optim_loss: 4672032.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7849; val_auprc_score: 0.9040; val_best_acc_score: 0.8172; val_best_f1_score: 0.8903; train_kl_reg_loss: 42705.8008; train_edge_recon_loss: 1604975.6667; train_cat_covariates_contrastive_loss: 320617.3333; train_gene_expr_recon_loss: 2640589.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4608888.0000; train_optim_loss: 4608888.0000; val_kl_reg_loss: 44740.5156; val_edge_recon_loss: 1552833.0000; val_cat_covariates_contrastive_loss: 315998.9062; val_gene_expr_recon_loss: 2702028.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4615601.0000; val_optim_loss: 4615601.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.7724; val_auprc_score: 0.8931; val_best_acc_score: 0.8093; val_best_f1_score: 0.8834; train_kl_reg_loss: 42595.3750; train_edge_recon_loss: 1563698.5833; train_cat_covariates_contrastive_loss: 320422.0938; train_gene_expr_recon_loss: 2636280.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4562996.5000; train_optim_loss: 4562996.5000; val_kl_reg_loss: 45487.2422; val_edge_recon_loss: 1671729.8750; val_cat_covariates_contrastive_loss: 315894.8438; val_gene_expr_recon_loss: 2706741.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739853.0000; val_optim_loss: 4739853.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.7913; val_auprc_score: 0.9028; val_best_acc_score: 0.8195; val_best_f1_score: 0.8902; train_kl_reg_loss: 42416.6328; train_edge_recon_loss: 1559115.7500; train_cat_covariates_contrastive_loss: 320870.2292; train_gene_expr_recon_loss: 2639535.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561938.1667; train_optim_loss: 4561938.1667; val_kl_reg_loss: 45003.5312; val_edge_recon_loss: 1563530.1250; val_cat_covariates_contrastive_loss: 315845.5938; val_gene_expr_recon_loss: 2697754.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4622134.0000; val_optim_loss: 4622134.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 0 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.7823
val AUPRC score: 0.9047
val best accuracy score: 0.8200
val best F1 score: 0.8900
val target rna MSE score: 0.8771
val source rna MSE score: 0.2763
Val cat covariate0 mean sim diff: 0.0023
Duration of model training in run 7: 0 hours, 1 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9395; val_auprc_score: 0.9737; val_best_acc_score: 0.8186; val_best_f1_score: 0.8892; train_kl_reg_loss: 162.0565; train_edge_recon_loss: 1733922.8750; train_cat_covariates_contrastive_loss: 645697.5208; train_gene_expr_recon_loss: 3599208.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5978990.5000; train_optim_loss: 5978990.5000; val_kl_reg_loss: 871.8422; val_edge_recon_loss: 2109978.5000; val_cat_covariates_contrastive_loss: 314183.3125; val_gene_expr_recon_loss: 3574647.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5999681.0000; val_optim_loss: 5999681.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9316; val_auprc_score: 0.9724; val_best_acc_score: 0.7934; val_best_f1_score: 0.8781; train_kl_reg_loss: 1078.2311; train_edge_recon_loss: 1776077.9167; train_cat_covariates_contrastive_loss: 487066.4062; train_gene_expr_recon_loss: 3531471.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5795694.1667; train_optim_loss: 5795694.1667; val_kl_reg_loss: 1751.3630; val_edge_recon_loss: 2055605.6250; val_cat_covariates_contrastive_loss: 313710.8750; val_gene_expr_recon_loss: 3460784.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5831852.0000; val_optim_loss: 5831852.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9294; val_auprc_score: 0.9733; val_best_acc_score: 0.7946; val_best_f1_score: 0.8801; train_kl_reg_loss: 2135.6505; train_edge_recon_loss: 1858677.0000; train_cat_covariates_contrastive_loss: 373649.3021; train_gene_expr_recon_loss: 3470130.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5704592.8333; train_optim_loss: 5704592.8333; val_kl_reg_loss: 2415.4702; val_edge_recon_loss: 1988858.3750; val_cat_covariates_contrastive_loss: 313585.7500; val_gene_expr_recon_loss: 3448466.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5753326.0000; val_optim_loss: 5753326.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9104; val_auprc_score: 0.9677; val_best_acc_score: 0.8053; val_best_f1_score: 0.8868; train_kl_reg_loss: 2247.8038; train_edge_recon_loss: 1849892.9167; train_cat_covariates_contrastive_loss: 355440.0104; train_gene_expr_recon_loss: 3448599.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5656180.3333; train_optim_loss: 5656180.3333; val_kl_reg_loss: 1740.9250; val_edge_recon_loss: 1878206.0000; val_cat_covariates_contrastive_loss: 313684.0625; val_gene_expr_recon_loss: 3423879.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5617510.0000; val_optim_loss: 5617510.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9100; val_auprc_score: 0.9632; val_best_acc_score: 0.7934; val_best_f1_score: 0.8757; train_kl_reg_loss: 1565.7490; train_edge_recon_loss: 1802732.0000; train_cat_covariates_contrastive_loss: 377433.1250; train_gene_expr_recon_loss: 3417278.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5599009.3333; train_optim_loss: 5599009.3333; val_kl_reg_loss: 1342.1622; val_edge_recon_loss: 2096454.6250; val_cat_covariates_contrastive_loss: 313793.6562; val_gene_expr_recon_loss: 3378975.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5790566.0000; val_optim_loss: 5790566.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9005; val_auprc_score: 0.9602; val_best_acc_score: 0.7942; val_best_f1_score: 0.8765; train_kl_reg_loss: 1462.3253; train_edge_recon_loss: 1784458.7917; train_cat_covariates_contrastive_loss: 382777.9375; train_gene_expr_recon_loss: 3399691.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5568390.5000; train_optim_loss: 5568390.5000; val_kl_reg_loss: 1665.2905; val_edge_recon_loss: 2041077.6250; val_cat_covariates_contrastive_loss: 313712.7500; val_gene_expr_recon_loss: 3357606.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5714062.0000; val_optim_loss: 5714062.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8835; val_auprc_score: 0.9568; val_best_acc_score: 0.7983; val_best_f1_score: 0.8759; train_kl_reg_loss: 1770.6783; train_edge_recon_loss: 1798055.1250; train_cat_covariates_contrastive_loss: 367839.9896; train_gene_expr_recon_loss: 3369051.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5536717.1667; train_optim_loss: 5536717.1667; val_kl_reg_loss: 1716.2374; val_edge_recon_loss: 2057680.8750; val_cat_covariates_contrastive_loss: 313713.6562; val_gene_expr_recon_loss: 3322905.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5696016.0000; val_optim_loss: 5696016.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8646; val_auprc_score: 0.9488; val_best_acc_score: 0.8057; val_best_f1_score: 0.8794; train_kl_reg_loss: 1744.3570; train_edge_recon_loss: 1756559.8750; train_cat_covariates_contrastive_loss: 372732.0417; train_gene_expr_recon_loss: 3340719.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5471755.8333; train_optim_loss: 5471755.8333; val_kl_reg_loss: 1856.1948; val_edge_recon_loss: 2034471.1250; val_cat_covariates_contrastive_loss: 313780.8438; val_gene_expr_recon_loss: 3298303.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5648412.0000; val_optim_loss: 5648412.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8631; val_auprc_score: 0.9495; val_best_acc_score: 0.8143; val_best_f1_score: 0.8827; train_kl_reg_loss: 1876.7984; train_edge_recon_loss: 1796288.7083; train_cat_covariates_contrastive_loss: 366144.7292; train_gene_expr_recon_loss: 3308314.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5472625.0000; train_optim_loss: 5472625.0000; val_kl_reg_loss: 1861.4958; val_edge_recon_loss: 1956937.1250; val_cat_covariates_contrastive_loss: 313780.9688; val_gene_expr_recon_loss: 3298164.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5570744.0000; val_optim_loss: 5570744.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8515; val_auprc_score: 0.9429; val_best_acc_score: 0.7950; val_best_f1_score: 0.8727; train_kl_reg_loss: 1942.8043; train_edge_recon_loss: 1791141.4583; train_cat_covariates_contrastive_loss: 365078.7604; train_gene_expr_recon_loss: 3308297.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5466460.5000; train_optim_loss: 5466460.5000; val_kl_reg_loss: 1954.2207; val_edge_recon_loss: 2077100.3750; val_cat_covariates_contrastive_loss: 313746.6250; val_gene_expr_recon_loss: 3292563.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5685364.0000; val_optim_loss: 5685364.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8407; val_auprc_score: 0.9325; val_best_acc_score: 0.7933; val_best_f1_score: 0.8748; train_kl_reg_loss: 1990.0825; train_edge_recon_loss: 1778756.1250; train_cat_covariates_contrastive_loss: 363926.4167; train_gene_expr_recon_loss: 3304682.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5449354.6667; train_optim_loss: 5449354.6667; val_kl_reg_loss: 2017.3864; val_edge_recon_loss: 2070973.3750; val_cat_covariates_contrastive_loss: 313796.5000; val_gene_expr_recon_loss: 3287567.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5674354.0000; val_optim_loss: 5674354.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8533; val_auprc_score: 0.9404; val_best_acc_score: 0.7977; val_best_f1_score: 0.8765; train_kl_reg_loss: 2079.4664; train_edge_recon_loss: 1801611.4167; train_cat_covariates_contrastive_loss: 360705.7604; train_gene_expr_recon_loss: 3298387.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5462784.1667; train_optim_loss: 5462784.1667; val_kl_reg_loss: 2064.2231; val_edge_recon_loss: 2022709.7500; val_cat_covariates_contrastive_loss: 313734.6875; val_gene_expr_recon_loss: 3272647.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5611156.0000; val_optim_loss: 5611156.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8443; val_auprc_score: 0.9413; val_best_acc_score: 0.8022; val_best_f1_score: 0.8832; train_kl_reg_loss: 2115.0196; train_edge_recon_loss: 1808448.9167; train_cat_covariates_contrastive_loss: 358952.4271; train_gene_expr_recon_loss: 3298466.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5467983.1667; train_optim_loss: 5467983.1667; val_kl_reg_loss: 2127.6328; val_edge_recon_loss: 1960656.0000; val_cat_covariates_contrastive_loss: 313716.9688; val_gene_expr_recon_loss: 3276376.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5552877.0000; val_optim_loss: 5552877.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8445; val_auprc_score: 0.9388; val_best_acc_score: 0.7980; val_best_f1_score: 0.8801; train_kl_reg_loss: 2169.1982; train_edge_recon_loss: 1790657.4583; train_cat_covariates_contrastive_loss: 359624.8542; train_gene_expr_recon_loss: 3289078.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5441530.3333; train_optim_loss: 5441530.3333; val_kl_reg_loss: 2149.2139; val_edge_recon_loss: 2006101.0000; val_cat_covariates_contrastive_loss: 313730.0312; val_gene_expr_recon_loss: 3280571.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5602551.5000; val_optim_loss: 5602551.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8435; val_auprc_score: 0.9418; val_best_acc_score: 0.8043; val_best_f1_score: 0.8838; train_kl_reg_loss: 2172.9594; train_edge_recon_loss: 1738993.7917; train_cat_covariates_contrastive_loss: 354473.0312; train_gene_expr_recon_loss: 3287526.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5383166.1667; train_optim_loss: 5383166.1667; val_kl_reg_loss: 2111.8843; val_edge_recon_loss: 1960894.6250; val_cat_covariates_contrastive_loss: 313739.0000; val_gene_expr_recon_loss: 3269435.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5546181.0000; val_optim_loss: 5546181.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8363; val_auprc_score: 0.9349; val_best_acc_score: 0.7957; val_best_f1_score: 0.8777; train_kl_reg_loss: 2179.9169; train_edge_recon_loss: 1807317.5833; train_cat_covariates_contrastive_loss: 360814.7396; train_gene_expr_recon_loss: 3280389.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5450701.6667; train_optim_loss: 5450701.6667; val_kl_reg_loss: 2158.9492; val_edge_recon_loss: 2045303.7500; val_cat_covariates_contrastive_loss: 313773.8750; val_gene_expr_recon_loss: 3263783.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5625019.5000; val_optim_loss: 5625019.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8287; val_auprc_score: 0.9343; val_best_acc_score: 0.8057; val_best_f1_score: 0.8840; train_kl_reg_loss: 2179.9772; train_edge_recon_loss: 1794910.3333; train_cat_covariates_contrastive_loss: 364117.1562; train_gene_expr_recon_loss: 3280045.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5441253.0000; train_optim_loss: 5441253.0000; val_kl_reg_loss: 2154.7512; val_edge_recon_loss: 1977122.7500; val_cat_covariates_contrastive_loss: 313710.8750; val_gene_expr_recon_loss: 3257210.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5550199.0000; val_optim_loss: 5550199.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8142; val_auprc_score: 0.9178; val_best_acc_score: 0.7929; val_best_f1_score: 0.8765; train_kl_reg_loss: 2181.6264; train_edge_recon_loss: 1763065.1250; train_cat_covariates_contrastive_loss: 361678.3021; train_gene_expr_recon_loss: 3269731.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5396656.6667; train_optim_loss: 5396656.6667; val_kl_reg_loss: 2187.1763; val_edge_recon_loss: 2006260.1250; val_cat_covariates_contrastive_loss: 313768.0312; val_gene_expr_recon_loss: 3256586.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5578802.0000; val_optim_loss: 5578802.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8227; val_auprc_score: 0.9326; val_best_acc_score: 0.8040; val_best_f1_score: 0.8839; train_kl_reg_loss: 2248.3769; train_edge_recon_loss: 1760891.5833; train_cat_covariates_contrastive_loss: 362987.6875; train_gene_expr_recon_loss: 3270669.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5396797.3333; train_optim_loss: 5396797.3333; val_kl_reg_loss: 2256.8672; val_edge_recon_loss: 1913061.2500; val_cat_covariates_contrastive_loss: 313701.0000; val_gene_expr_recon_loss: 3250900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5479919.0000; val_optim_loss: 5479919.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8286; val_auprc_score: 0.9317; val_best_acc_score: 0.7923; val_best_f1_score: 0.8762; train_kl_reg_loss: 2272.0983; train_edge_recon_loss: 1806664.4583; train_cat_covariates_contrastive_loss: 358005.5104; train_gene_expr_recon_loss: 3273179.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5440122.0000; train_optim_loss: 5440122.0000; val_kl_reg_loss: 2267.1755; val_edge_recon_loss: 1999107.2500; val_cat_covariates_contrastive_loss: 313771.0938; val_gene_expr_recon_loss: 3244335.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5559481.0000; val_optim_loss: 5559481.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8302; val_auprc_score: 0.9300; val_best_acc_score: 0.7988; val_best_f1_score: 0.8793; train_kl_reg_loss: 2353.9712; train_edge_recon_loss: 1785039.3750; train_cat_covariates_contrastive_loss: 353663.9896; train_gene_expr_recon_loss: 3268686.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5409744.0000; train_optim_loss: 5409744.0000; val_kl_reg_loss: 2286.6196; val_edge_recon_loss: 2005900.6250; val_cat_covariates_contrastive_loss: 313749.9062; val_gene_expr_recon_loss: 3242673.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5564610.0000; val_optim_loss: 5564610.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8016; val_auprc_score: 0.9161; val_best_acc_score: 0.7891; val_best_f1_score: 0.8731; train_kl_reg_loss: 2357.5200; train_edge_recon_loss: 1766762.6250; train_cat_covariates_contrastive_loss: 364490.4583; train_gene_expr_recon_loss: 3261927.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5395537.6667; train_optim_loss: 5395537.6667; val_kl_reg_loss: 2348.0200; val_edge_recon_loss: 2046988.1250; val_cat_covariates_contrastive_loss: 313750.7500; val_gene_expr_recon_loss: 3243124.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5606211.5000; val_optim_loss: 5606211.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8069; val_auprc_score: 0.9209; val_best_acc_score: 0.7913; val_best_f1_score: 0.8743; train_kl_reg_loss: 2421.4887; train_edge_recon_loss: 1785782.0417; train_cat_covariates_contrastive_loss: 357472.6042; train_gene_expr_recon_loss: 3250714.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5396390.3333; train_optim_loss: 5396390.3333; val_kl_reg_loss: 2418.4058; val_edge_recon_loss: 2034814.5000; val_cat_covariates_contrastive_loss: 313830.7188; val_gene_expr_recon_loss: 3238187.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5589250.5000; val_optim_loss: 5589250.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7966; val_auprc_score: 0.9146; val_best_acc_score: 0.7931; val_best_f1_score: 0.8768; train_kl_reg_loss: 2461.1860; train_edge_recon_loss: 1784821.1667; train_cat_covariates_contrastive_loss: 361167.6562; train_gene_expr_recon_loss: 3257211.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5405661.6667; train_optim_loss: 5405661.6667; val_kl_reg_loss: 2388.4131; val_edge_recon_loss: 1973968.7500; val_cat_covariates_contrastive_loss: 313727.2188; val_gene_expr_recon_loss: 3229407.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5519491.0000; val_optim_loss: 5519491.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8097; val_auprc_score: 0.9207; val_best_acc_score: 0.8039; val_best_f1_score: 0.8817; train_kl_reg_loss: 2467.3177; train_edge_recon_loss: 1775244.5000; train_cat_covariates_contrastive_loss: 361741.1875; train_gene_expr_recon_loss: 3256100.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5395553.8333; train_optim_loss: 5395553.8333; val_kl_reg_loss: 2455.4600; val_edge_recon_loss: 1983134.6250; val_cat_covariates_contrastive_loss: 313733.8750; val_gene_expr_recon_loss: 3238691.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5538015.5000; val_optim_loss: 5538015.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8128; val_auprc_score: 0.9202; val_best_acc_score: 0.8009; val_best_f1_score: 0.8797; train_kl_reg_loss: 2478.1227; train_edge_recon_loss: 1779237.7083; train_cat_covariates_contrastive_loss: 361800.0521; train_gene_expr_recon_loss: 3258020.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5401536.3333; train_optim_loss: 5401536.3333; val_kl_reg_loss: 2451.9119; val_edge_recon_loss: 2010108.1250; val_cat_covariates_contrastive_loss: 313735.7500; val_gene_expr_recon_loss: 3241598.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5567894.0000; val_optim_loss: 5567894.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8214; val_auprc_score: 0.9294; val_best_acc_score: 0.7962; val_best_f1_score: 0.8763; train_kl_reg_loss: 2513.9308; train_edge_recon_loss: 1737230.0833; train_cat_covariates_contrastive_loss: 357480.8021; train_gene_expr_recon_loss: 3260463.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5357688.0000; train_optim_loss: 5357688.0000; val_kl_reg_loss: 2443.5063; val_edge_recon_loss: 2058092.6250; val_cat_covariates_contrastive_loss: 313787.0000; val_gene_expr_recon_loss: 3231379.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5605702.5000; val_optim_loss: 5605702.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.8214
val AUPRC score: 0.9297
val best accuracy score: 0.7950
val best F1 score: 0.8774
val target rna MSE score: 1.2371
val source rna MSE score: 0.5632
Val cat covariate0 mean sim diff: -0.0017
Duration of model training in run 6: 0 hours, 0 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9405; val_auprc_score: 0.9686; val_best_acc_score: 0.8117; val_best_f1_score: 0.8870; train_kl_reg_loss: 170.9786; train_edge_recon_loss: 1773705.0833; train_cat_covariates_contrastive_loss: 643486.1667; train_gene_expr_recon_loss: 3642025.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6059388.1667; train_optim_loss: 6059388.1667; val_kl_reg_loss: 905.1483; val_edge_recon_loss: 2070339.0000; val_cat_covariates_contrastive_loss: 314086.2812; val_gene_expr_recon_loss: 3671821.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6057151.5000; val_optim_loss: 6057151.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9424; val_auprc_score: 0.9793; val_best_acc_score: 0.8061; val_best_f1_score: 0.8870; train_kl_reg_loss: 1112.7825; train_edge_recon_loss: 1778233.7083; train_cat_covariates_contrastive_loss: 482602.9271; train_gene_expr_recon_loss: 3580408.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5842357.5000; train_optim_loss: 5842357.5000; val_kl_reg_loss: 1807.4187; val_edge_recon_loss: 1929459.0000; val_cat_covariates_contrastive_loss: 313667.0938; val_gene_expr_recon_loss: 3536827.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5781760.5000; val_optim_loss: 5781760.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9374; val_auprc_score: 0.9768; val_best_acc_score: 0.7933; val_best_f1_score: 0.8798; train_kl_reg_loss: 2143.4476; train_edge_recon_loss: 1831833.7500; train_cat_covariates_contrastive_loss: 373141.2917; train_gene_expr_recon_loss: 3511904.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5719023.1667; train_optim_loss: 5719023.1667; val_kl_reg_loss: 2508.5356; val_edge_recon_loss: 1975132.5000; val_cat_covariates_contrastive_loss: 313536.0000; val_gene_expr_recon_loss: 3499789.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5790966.5000; val_optim_loss: 5790966.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9356; val_auprc_score: 0.9724; val_best_acc_score: 0.8018; val_best_f1_score: 0.8840; train_kl_reg_loss: 2367.7410; train_edge_recon_loss: 1851980.2083; train_cat_covariates_contrastive_loss: 350384.6875; train_gene_expr_recon_loss: 3473560.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5678293.3333; train_optim_loss: 5678293.3333; val_kl_reg_loss: 2004.6385; val_edge_recon_loss: 1964959.0000; val_cat_covariates_contrastive_loss: 313601.8125; val_gene_expr_recon_loss: 3466526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5747091.5000; val_optim_loss: 5747091.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9253; val_auprc_score: 0.9668; val_best_acc_score: 0.7845; val_best_f1_score: 0.8712; train_kl_reg_loss: 1757.9287; train_edge_recon_loss: 1820933.9167; train_cat_covariates_contrastive_loss: 368519.4896; train_gene_expr_recon_loss: 3447804.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5639015.3333; train_optim_loss: 5639015.3333; val_kl_reg_loss: 1501.5970; val_edge_recon_loss: 2111230.2500; val_cat_covariates_contrastive_loss: 313696.4688; val_gene_expr_recon_loss: 3451831.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5878260.0000; val_optim_loss: 5878260.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9125; val_auprc_score: 0.9609; val_best_acc_score: 0.7904; val_best_f1_score: 0.8744; train_kl_reg_loss: 1455.7755; train_edge_recon_loss: 1778348.8333; train_cat_covariates_contrastive_loss: 388068.5312; train_gene_expr_recon_loss: 3424816.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5592689.3333; train_optim_loss: 5592689.3333; val_kl_reg_loss: 1639.6526; val_edge_recon_loss: 2053055.1250; val_cat_covariates_contrastive_loss: 313661.1250; val_gene_expr_recon_loss: 3431601.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5799957.0000; val_optim_loss: 5799957.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8952; val_auprc_score: 0.9566; val_best_acc_score: 0.7988; val_best_f1_score: 0.8785; train_kl_reg_loss: 1637.2063; train_edge_recon_loss: 1790828.9167; train_cat_covariates_contrastive_loss: 379896.3125; train_gene_expr_recon_loss: 3390433.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5562796.0000; train_optim_loss: 5562796.0000; val_kl_reg_loss: 1817.3267; val_edge_recon_loss: 2018799.1250; val_cat_covariates_contrastive_loss: 313656.4375; val_gene_expr_recon_loss: 3392442.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5726715.5000; val_optim_loss: 5726715.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8679; val_auprc_score: 0.9469; val_best_acc_score: 0.8031; val_best_f1_score: 0.8788; train_kl_reg_loss: 1788.7112; train_edge_recon_loss: 1791161.1250; train_cat_covariates_contrastive_loss: 378890.9688; train_gene_expr_recon_loss: 3357665.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5529506.6667; train_optim_loss: 5529506.6667; val_kl_reg_loss: 2067.8772; val_edge_recon_loss: 2043230.1250; val_cat_covariates_contrastive_loss: 313646.1562; val_gene_expr_recon_loss: 3362748.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5721693.0000; val_optim_loss: 5721693.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8518; val_auprc_score: 0.9387; val_best_acc_score: 0.8094; val_best_f1_score: 0.8798; train_kl_reg_loss: 2088.1386; train_edge_recon_loss: 1814844.2083; train_cat_covariates_contrastive_loss: 364634.3750; train_gene_expr_recon_loss: 3323999.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5505565.6667; train_optim_loss: 5505565.6667; val_kl_reg_loss: 2398.7998; val_edge_recon_loss: 2054548.0000; val_cat_covariates_contrastive_loss: 313644.1562; val_gene_expr_recon_loss: 3310148.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5680739.0000; val_optim_loss: 5680739.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8332; val_auprc_score: 0.9306; val_best_acc_score: 0.8015; val_best_f1_score: 0.8823; train_kl_reg_loss: 2337.2653; train_edge_recon_loss: 1778313.7083; train_cat_covariates_contrastive_loss: 361778.6875; train_gene_expr_recon_loss: 3282249.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5424679.3333; train_optim_loss: 5424679.3333; val_kl_reg_loss: 2523.9258; val_edge_recon_loss: 1990559.3750; val_cat_covariates_contrastive_loss: 313657.3125; val_gene_expr_recon_loss: 3290055.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5596795.5000; val_optim_loss: 5596795.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8043; val_auprc_score: 0.9247; val_best_acc_score: 0.8024; val_best_f1_score: 0.8811; train_kl_reg_loss: 2513.9746; train_edge_recon_loss: 1792678.0833; train_cat_covariates_contrastive_loss: 360720.0104; train_gene_expr_recon_loss: 3255233.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5411146.0000; train_optim_loss: 5411146.0000; val_kl_reg_loss: 2740.7322; val_edge_recon_loss: 1972489.0000; val_cat_covariates_contrastive_loss: 313647.9375; val_gene_expr_recon_loss: 3258510.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5547388.0000; val_optim_loss: 5547388.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7974; val_auprc_score: 0.9121; val_best_acc_score: 0.8051; val_best_f1_score: 0.8808; train_kl_reg_loss: 2841.0673; train_edge_recon_loss: 1789654.4583; train_cat_covariates_contrastive_loss: 369573.1667; train_gene_expr_recon_loss: 3227568.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5389636.6667; train_optim_loss: 5389636.6667; val_kl_reg_loss: 3336.6997; val_edge_recon_loss: 2012728.2500; val_cat_covariates_contrastive_loss: 313648.0000; val_gene_expr_recon_loss: 3221718.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5551431.5000; val_optim_loss: 5551431.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8042; val_auprc_score: 0.9153; val_best_acc_score: 0.8217; val_best_f1_score: 0.8915; train_kl_reg_loss: 3471.5640; train_edge_recon_loss: 1776685.3333; train_cat_covariates_contrastive_loss: 365824.3646; train_gene_expr_recon_loss: 3196877.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5342858.6667; train_optim_loss: 5342858.6667; val_kl_reg_loss: 4254.9092; val_edge_recon_loss: 1917391.8750; val_cat_covariates_contrastive_loss: 313750.8438; val_gene_expr_recon_loss: 3199953.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5435351.0000; val_optim_loss: 5435351.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7962; val_auprc_score: 0.9073; val_best_acc_score: 0.8118; val_best_f1_score: 0.8837; train_kl_reg_loss: 4339.4032; train_edge_recon_loss: 1779757.9583; train_cat_covariates_contrastive_loss: 352432.2292; train_gene_expr_recon_loss: 3163561.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5300091.6667; train_optim_loss: 5300091.6667; val_kl_reg_loss: 5155.0972; val_edge_recon_loss: 2009389.5000; val_cat_covariates_contrastive_loss: 313877.7188; val_gene_expr_recon_loss: 3170224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5498646.0000; val_optim_loss: 5498646.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8052; val_auprc_score: 0.9203; val_best_acc_score: 0.8306; val_best_f1_score: 0.8967; train_kl_reg_loss: 5448.2033; train_edge_recon_loss: 1760378.8333; train_cat_covariates_contrastive_loss: 352679.9271; train_gene_expr_recon_loss: 3139060.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5257567.3333; train_optim_loss: 5257567.3333; val_kl_reg_loss: 6677.5664; val_edge_recon_loss: 1847084.1250; val_cat_covariates_contrastive_loss: 313981.7188; val_gene_expr_recon_loss: 3135141.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5302885.0000; val_optim_loss: 5302885.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7938; val_auprc_score: 0.9048; val_best_acc_score: 0.8160; val_best_f1_score: 0.8854; train_kl_reg_loss: 7087.3254; train_edge_recon_loss: 1752154.6667; train_cat_covariates_contrastive_loss: 343126.8438; train_gene_expr_recon_loss: 3105303.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207672.1667; train_optim_loss: 5207672.1667; val_kl_reg_loss: 8647.6680; val_edge_recon_loss: 1947592.7500; val_cat_covariates_contrastive_loss: 313934.0312; val_gene_expr_recon_loss: 3092994.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5363168.5000; val_optim_loss: 5363168.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7713; val_auprc_score: 0.8964; val_best_acc_score: 0.8102; val_best_f1_score: 0.8839; train_kl_reg_loss: 9925.2965; train_edge_recon_loss: 1762752.5417; train_cat_covariates_contrastive_loss: 340218.4479; train_gene_expr_recon_loss: 3070776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5183672.1667; train_optim_loss: 5183672.1667; val_kl_reg_loss: 12436.9414; val_edge_recon_loss: 1902992.1250; val_cat_covariates_contrastive_loss: 314024.0938; val_gene_expr_recon_loss: 3063512.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5292966.0000; val_optim_loss: 5292966.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7908; val_auprc_score: 0.9076; val_best_acc_score: 0.8198; val_best_f1_score: 0.8883; train_kl_reg_loss: 14613.3555; train_edge_recon_loss: 1734415.0417; train_cat_covariates_contrastive_loss: 332290.4271; train_gene_expr_recon_loss: 3029845.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5111164.5000; train_optim_loss: 5111164.5000; val_kl_reg_loss: 18885.2383; val_edge_recon_loss: 1879319.3750; val_cat_covariates_contrastive_loss: 313918.8750; val_gene_expr_recon_loss: 3028150.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5240274.0000; val_optim_loss: 5240274.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7846; val_auprc_score: 0.9026; val_best_acc_score: 0.8277; val_best_f1_score: 0.8929; train_kl_reg_loss: 21171.7734; train_edge_recon_loss: 1752782.1250; train_cat_covariates_contrastive_loss: 332342.9375; train_gene_expr_recon_loss: 2986658.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5092955.0000; train_optim_loss: 5092955.0000; val_kl_reg_loss: 22806.3672; val_edge_recon_loss: 1811630.1250; val_cat_covariates_contrastive_loss: 314124.3750; val_gene_expr_recon_loss: 2985376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5133937.0000; val_optim_loss: 5133937.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7930; val_auprc_score: 0.9049; val_best_acc_score: 0.8126; val_best_f1_score: 0.8834; train_kl_reg_loss: 25007.4785; train_edge_recon_loss: 1761331.7917; train_cat_covariates_contrastive_loss: 329328.9271; train_gene_expr_recon_loss: 2957703.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5073371.5000; train_optim_loss: 5073371.5000; val_kl_reg_loss: 28111.8438; val_edge_recon_loss: 1916379.1250; val_cat_covariates_contrastive_loss: 314035.0000; val_gene_expr_recon_loss: 2954581.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5213107.0000; val_optim_loss: 5213107.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7641; val_auprc_score: 0.8890; val_best_acc_score: 0.8155; val_best_f1_score: 0.8863; train_kl_reg_loss: 30448.2799; train_edge_recon_loss: 1704005.3750; train_cat_covariates_contrastive_loss: 328157.5938; train_gene_expr_recon_loss: 2909269.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4971880.3333; train_optim_loss: 4971880.3333; val_kl_reg_loss: 27932.3027; val_edge_recon_loss: 1809995.5000; val_cat_covariates_contrastive_loss: 314081.9375; val_gene_expr_recon_loss: 2927519.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5079529.0000; val_optim_loss: 5079529.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7799; val_auprc_score: 0.9003; val_best_acc_score: 0.8156; val_best_f1_score: 0.8893; train_kl_reg_loss: 28665.3242; train_edge_recon_loss: 1710017.1667; train_cat_covariates_contrastive_loss: 327119.5000; train_gene_expr_recon_loss: 2888162.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4953964.6667; train_optim_loss: 4953964.6667; val_kl_reg_loss: 30008.0996; val_edge_recon_loss: 1753159.3750; val_cat_covariates_contrastive_loss: 314085.9688; val_gene_expr_recon_loss: 2897762.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4995016.0000; val_optim_loss: 4995016.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7849; val_auprc_score: 0.9002; val_best_acc_score: 0.8105; val_best_f1_score: 0.8815; train_kl_reg_loss: 31251.7539; train_edge_recon_loss: 1727664.4167; train_cat_covariates_contrastive_loss: 331787.9375; train_gene_expr_recon_loss: 2855649.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4946353.1667; train_optim_loss: 4946353.1667; val_kl_reg_loss: 29812.8477; val_edge_recon_loss: 1838399.8750; val_cat_covariates_contrastive_loss: 314041.6875; val_gene_expr_recon_loss: 2872677.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5054931.5000; val_optim_loss: 5054931.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7536; val_auprc_score: 0.8906; val_best_acc_score: 0.8017; val_best_f1_score: 0.8799; train_kl_reg_loss: 30194.5130; train_edge_recon_loss: 1706963.7083; train_cat_covariates_contrastive_loss: 327300.2188; train_gene_expr_recon_loss: 2842018.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4906476.6667; train_optim_loss: 4906476.6667; val_kl_reg_loss: 31317.8750; val_edge_recon_loss: 1800456.5000; val_cat_covariates_contrastive_loss: 314389.3125; val_gene_expr_recon_loss: 2862216.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5008380.0000; val_optim_loss: 5008380.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7599; val_auprc_score: 0.8845; val_best_acc_score: 0.8033; val_best_f1_score: 0.8779; train_kl_reg_loss: 31337.5638; train_edge_recon_loss: 1706890.1250; train_cat_covariates_contrastive_loss: 329088.5729; train_gene_expr_recon_loss: 2824047.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4891363.1667; train_optim_loss: 4891363.1667; val_kl_reg_loss: 30192.3828; val_edge_recon_loss: 1808868.6250; val_cat_covariates_contrastive_loss: 314262.3750; val_gene_expr_recon_loss: 2849144.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5002468.0000; val_optim_loss: 5002468.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7673; val_auprc_score: 0.8949; val_best_acc_score: 0.8152; val_best_f1_score: 0.8893; train_kl_reg_loss: 30350.9707; train_edge_recon_loss: 1657985.2083; train_cat_covariates_contrastive_loss: 328459.1042; train_gene_expr_recon_loss: 2803164.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819960.0000; train_optim_loss: 4819960.0000; val_kl_reg_loss: 31133.8828; val_edge_recon_loss: 1668917.6250; val_cat_covariates_contrastive_loss: 314169.1562; val_gene_expr_recon_loss: 2835668.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849888.5000; val_optim_loss: 4849888.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7856; val_auprc_score: 0.9071; val_best_acc_score: 0.8261; val_best_f1_score: 0.8933; train_kl_reg_loss: 31057.6569; train_edge_recon_loss: 1677486.1250; train_cat_covariates_contrastive_loss: 328857.2083; train_gene_expr_recon_loss: 2796393.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4833794.1667; train_optim_loss: 4833794.1667; val_kl_reg_loss: 31001.8301; val_edge_recon_loss: 1622594.5000; val_cat_covariates_contrastive_loss: 314311.6250; val_gene_expr_recon_loss: 2816177.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4784085.5000; val_optim_loss: 4784085.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7775; val_auprc_score: 0.9006; val_best_acc_score: 0.8115; val_best_f1_score: 0.8852; train_kl_reg_loss: 31234.3418; train_edge_recon_loss: 1683086.3750; train_cat_covariates_contrastive_loss: 326874.7604; train_gene_expr_recon_loss: 2784768.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4825963.6667; train_optim_loss: 4825963.6667; val_kl_reg_loss: 33131.3086; val_edge_recon_loss: 1688386.7500; val_cat_covariates_contrastive_loss: 314438.8125; val_gene_expr_recon_loss: 2817359.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4853316.0000; val_optim_loss: 4853316.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7611; val_auprc_score: 0.8944; val_best_acc_score: 0.8102; val_best_f1_score: 0.8862; train_kl_reg_loss: 33489.8190; train_edge_recon_loss: 1627866.2083; train_cat_covariates_contrastive_loss: 327612.4479; train_gene_expr_recon_loss: 2774222.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4763190.6667; train_optim_loss: 4763190.6667; val_kl_reg_loss: 33269.5664; val_edge_recon_loss: 1638926.6250; val_cat_covariates_contrastive_loss: 314286.9688; val_gene_expr_recon_loss: 2795103.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781587.0000; val_optim_loss: 4781587.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7862; val_auprc_score: 0.8937; val_best_acc_score: 0.8069; val_best_f1_score: 0.8798; train_kl_reg_loss: 33700.9102; train_edge_recon_loss: 1645462.7500; train_cat_covariates_contrastive_loss: 324483.9271; train_gene_expr_recon_loss: 2762135.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4765782.6667; train_optim_loss: 4765782.6667; val_kl_reg_loss: 35638.6445; val_edge_recon_loss: 1734447.8750; val_cat_covariates_contrastive_loss: 314436.8438; val_gene_expr_recon_loss: 2781316.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865840.0000; val_optim_loss: 4865840.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7506; val_auprc_score: 0.8829; val_best_acc_score: 0.8066; val_best_f1_score: 0.8814; train_kl_reg_loss: 36298.2930; train_edge_recon_loss: 1599163.5417; train_cat_covariates_contrastive_loss: 322930.4583; train_gene_expr_recon_loss: 2749224.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4707616.5000; train_optim_loss: 4707616.5000; val_kl_reg_loss: 38500.4609; val_edge_recon_loss: 1662760.3750; val_cat_covariates_contrastive_loss: 314447.6562; val_gene_expr_recon_loss: 2782609.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4798318.0000; val_optim_loss: 4798318.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7597; val_auprc_score: 0.8954; val_best_acc_score: 0.8126; val_best_f1_score: 0.8870; train_kl_reg_loss: 38653.7656; train_edge_recon_loss: 1623130.1667; train_cat_covariates_contrastive_loss: 324517.9688; train_gene_expr_recon_loss: 2742096.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728398.6667; train_optim_loss: 4728398.6667; val_kl_reg_loss: 39590.8711; val_edge_recon_loss: 1578530.2500; val_cat_covariates_contrastive_loss: 314348.1562; val_gene_expr_recon_loss: 2771993.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4704462.0000; val_optim_loss: 4704462.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7669; val_auprc_score: 0.8991; val_best_acc_score: 0.8018; val_best_f1_score: 0.8809; train_kl_reg_loss: 39101.3385; train_edge_recon_loss: 1615714.1667; train_cat_covariates_contrastive_loss: 323889.5000; train_gene_expr_recon_loss: 2726903.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4705608.8333; train_optim_loss: 4705608.8333; val_kl_reg_loss: 40460.6953; val_edge_recon_loss: 1626499.6250; val_cat_covariates_contrastive_loss: 314686.4688; val_gene_expr_recon_loss: 2763422.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745069.0000; val_optim_loss: 4745069.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7542; val_auprc_score: 0.8861; val_best_acc_score: 0.7971; val_best_f1_score: 0.8778; train_kl_reg_loss: 39798.3255; train_edge_recon_loss: 1569605.6250; train_cat_covariates_contrastive_loss: 321250.7083; train_gene_expr_recon_loss: 2717848.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4648503.1667; train_optim_loss: 4648503.1667; val_kl_reg_loss: 40256.7422; val_edge_recon_loss: 1676044.1250; val_cat_covariates_contrastive_loss: 314636.3750; val_gene_expr_recon_loss: 2751592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4782529.0000; val_optim_loss: 4782529.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7641; val_auprc_score: 0.9010; val_best_acc_score: 0.8072; val_best_f1_score: 0.8859; train_kl_reg_loss: 40731.7292; train_edge_recon_loss: 1635719.0417; train_cat_covariates_contrastive_loss: 319337.2708; train_gene_expr_recon_loss: 2711693.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4707481.3333; train_optim_loss: 4707481.3333; val_kl_reg_loss: 41528.4688; val_edge_recon_loss: 1575137.8750; val_cat_covariates_contrastive_loss: 314755.3750; val_gene_expr_recon_loss: 2734124.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4665546.5000; val_optim_loss: 4665546.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7682; val_auprc_score: 0.8991; val_best_acc_score: 0.8097; val_best_f1_score: 0.8834; train_kl_reg_loss: 42271.0807; train_edge_recon_loss: 1585279.5417; train_cat_covariates_contrastive_loss: 322629.9583; train_gene_expr_recon_loss: 2703851.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4654031.6667; train_optim_loss: 4654031.6667; val_kl_reg_loss: 42406.9883; val_edge_recon_loss: 1631805.1250; val_cat_covariates_contrastive_loss: 314441.6875; val_gene_expr_recon_loss: 2738212.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4726866.0000; val_optim_loss: 4726866.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7520; val_auprc_score: 0.8772; val_best_acc_score: 0.7952; val_best_f1_score: 0.8735; train_kl_reg_loss: 41529.9180; train_edge_recon_loss: 1613607.6250; train_cat_covariates_contrastive_loss: 320940.8125; train_gene_expr_recon_loss: 2695651.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4671729.3333; train_optim_loss: 4671729.3333; val_kl_reg_loss: 41737.6836; val_edge_recon_loss: 1712356.0000; val_cat_covariates_contrastive_loss: 314605.5938; val_gene_expr_recon_loss: 2724624.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4793324.0000; val_optim_loss: 4793324.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7660; val_auprc_score: 0.9037; val_best_acc_score: 0.8162; val_best_f1_score: 0.8900; train_kl_reg_loss: 41350.0729; train_edge_recon_loss: 1585558.7083; train_cat_covariates_contrastive_loss: 320853.7917; train_gene_expr_recon_loss: 2691648.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4639411.1667; train_optim_loss: 4639411.1667; val_kl_reg_loss: 40154.8203; val_edge_recon_loss: 1549166.6250; val_cat_covariates_contrastive_loss: 314747.2500; val_gene_expr_recon_loss: 2717457.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4621526.0000; val_optim_loss: 4621526.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7509; val_auprc_score: 0.8908; val_best_acc_score: 0.7964; val_best_f1_score: 0.8794; train_kl_reg_loss: 40039.0221; train_edge_recon_loss: 1603353.2917; train_cat_covariates_contrastive_loss: 320033.9792; train_gene_expr_recon_loss: 2683044.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4646470.5000; train_optim_loss: 4646470.5000; val_kl_reg_loss: 41346.6094; val_edge_recon_loss: 1664665.2500; val_cat_covariates_contrastive_loss: 315066.9062; val_gene_expr_recon_loss: 2715196.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736275.0000; val_optim_loss: 4736275.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7535; val_auprc_score: 0.8868; val_best_acc_score: 0.7983; val_best_f1_score: 0.8788; train_kl_reg_loss: 42320.7240; train_edge_recon_loss: 1596273.5000; train_cat_covariates_contrastive_loss: 320534.8229; train_gene_expr_recon_loss: 2677489.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4636618.6667; train_optim_loss: 4636618.6667; val_kl_reg_loss: 42162.2383; val_edge_recon_loss: 1647976.7500; val_cat_covariates_contrastive_loss: 315190.4688; val_gene_expr_recon_loss: 2705754.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4711084.0000; val_optim_loss: 4711084.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7634; val_auprc_score: 0.8959; val_best_acc_score: 0.7980; val_best_f1_score: 0.8785; train_kl_reg_loss: 42237.7461; train_edge_recon_loss: 1597310.9167; train_cat_covariates_contrastive_loss: 318624.4271; train_gene_expr_recon_loss: 2672891.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4631064.8333; train_optim_loss: 4631064.8333; val_kl_reg_loss: 39708.9141; val_edge_recon_loss: 1656258.0000; val_cat_covariates_contrastive_loss: 314836.1250; val_gene_expr_recon_loss: 2705989.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4716792.0000; val_optim_loss: 4716792.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7667; val_auprc_score: 0.9012; val_best_acc_score: 0.8109; val_best_f1_score: 0.8866; train_kl_reg_loss: 40440.0872; train_edge_recon_loss: 1544751.6667; train_cat_covariates_contrastive_loss: 321170.7917; train_gene_expr_recon_loss: 2672098.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4578461.0000; train_optim_loss: 4578461.0000; val_kl_reg_loss: 38633.9805; val_edge_recon_loss: 1576588.2500; val_cat_covariates_contrastive_loss: 314636.8125; val_gene_expr_recon_loss: 2697735.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4627594.5000; val_optim_loss: 4627594.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7651; val_auprc_score: 0.8891; val_best_acc_score: 0.8041; val_best_f1_score: 0.8800; train_kl_reg_loss: 39742.8646; train_edge_recon_loss: 1557125.8333; train_cat_covariates_contrastive_loss: 320914.5729; train_gene_expr_recon_loss: 2661234.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4579017.8333; train_optim_loss: 4579017.8333; val_kl_reg_loss: 38503.8047; val_edge_recon_loss: 1646438.0000; val_cat_covariates_contrastive_loss: 314937.0000; val_gene_expr_recon_loss: 2691215.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4691094.0000; val_optim_loss: 4691094.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.7570; val_auprc_score: 0.8830; val_best_acc_score: 0.7963; val_best_f1_score: 0.8750; train_kl_reg_loss: 39944.5312; train_edge_recon_loss: 1570339.2083; train_cat_covariates_contrastive_loss: 319823.4167; train_gene_expr_recon_loss: 2669327.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4599434.1667; train_optim_loss: 4599434.1667; val_kl_reg_loss: 39502.4609; val_edge_recon_loss: 1690785.6250; val_cat_covariates_contrastive_loss: 314526.0000; val_gene_expr_recon_loss: 2698976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4743790.0000; val_optim_loss: 4743790.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7863; val_auprc_score: 0.9013; val_best_acc_score: 0.8084; val_best_f1_score: 0.8820; train_kl_reg_loss: 39931.7565; train_edge_recon_loss: 1575478.6250; train_cat_covariates_contrastive_loss: 319409.7604; train_gene_expr_recon_loss: 2656903.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4591723.5000; train_optim_loss: 4591723.5000; val_kl_reg_loss: 39884.4141; val_edge_recon_loss: 1623149.1250; val_cat_covariates_contrastive_loss: 315204.4062; val_gene_expr_recon_loss: 2702151.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4680389.0000; val_optim_loss: 4680389.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7627; val_auprc_score: 0.8971; val_best_acc_score: 0.8037; val_best_f1_score: 0.8816; train_kl_reg_loss: 40495.1133; train_edge_recon_loss: 1589669.2917; train_cat_covariates_contrastive_loss: 319841.0000; train_gene_expr_recon_loss: 2661061.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4611066.3333; train_optim_loss: 4611066.3333; val_kl_reg_loss: 39217.0078; val_edge_recon_loss: 1627387.3750; val_cat_covariates_contrastive_loss: 315000.2812; val_gene_expr_recon_loss: 2690118.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4671723.0000; val_optim_loss: 4671723.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 47 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.7635
val AUPRC score: 0.8956
val best accuracy score: 0.8049
val best F1 score: 0.8810
val target rna MSE score: 0.8853
val source rna MSE score: 0.2915
Val cat covariate0 mean sim diff: -0.0124
Duration of model training in run 5: 0 hours, 0 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9300; val_auprc_score: 0.9768; val_best_acc_score: 0.7880; val_best_f1_score: 0.8767; train_kl_reg_loss: 87.2034; train_edge_recon_loss: 1749584.3125; train_cat_covariates_contrastive_loss: 658249.7812; train_gene_expr_recon_loss: 3641522.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6049443.5000; train_optim_loss: 6049443.5000; val_kl_reg_loss: 369.7478; val_edge_recon_loss: 1983507.8750; val_cat_covariates_contrastive_loss: 316106.7812; val_gene_expr_recon_loss: 3650681.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5950666.0000; val_optim_loss: 5950666.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9266; val_auprc_score: 0.9759; val_best_acc_score: 0.8368; val_best_f1_score: 0.9005; train_kl_reg_loss: 651.2147; train_edge_recon_loss: 1734393.5000; train_cat_covariates_contrastive_loss: 558709.0938; train_gene_expr_recon_loss: 3611137.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5904891.5000; train_optim_loss: 5904891.5000; val_kl_reg_loss: 977.2274; val_edge_recon_loss: 1927939.7500; val_cat_covariates_contrastive_loss: 314313.4375; val_gene_expr_recon_loss: 3618293.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5861524.0000; val_optim_loss: 5861524.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9199; val_auprc_score: 0.9708; val_best_acc_score: 0.8094; val_best_f1_score: 0.8864; train_kl_reg_loss: 1081.9566; train_edge_recon_loss: 1722707.1875; train_cat_covariates_contrastive_loss: 470982.4219; train_gene_expr_recon_loss: 3531975.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5726746.5000; train_optim_loss: 5726746.5000; val_kl_reg_loss: 1520.1992; val_edge_recon_loss: 2043975.5000; val_cat_covariates_contrastive_loss: 313906.5938; val_gene_expr_recon_loss: 3591424.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5950827.0000; val_optim_loss: 5950827.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9187; val_auprc_score: 0.9657; val_best_acc_score: 0.7953; val_best_f1_score: 0.8774; train_kl_reg_loss: 1740.6795; train_edge_recon_loss: 1812674.5000; train_cat_covariates_contrastive_loss: 396711.6562; train_gene_expr_recon_loss: 3517514.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5728640.5000; train_optim_loss: 5728640.5000; val_kl_reg_loss: 2280.0723; val_edge_recon_loss: 2155779.5000; val_cat_covariates_contrastive_loss: 313698.1250; val_gene_expr_recon_loss: 3575678.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6047435.5000; val_optim_loss: 6047435.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9218; val_auprc_score: 0.9709; val_best_acc_score: 0.7944; val_best_f1_score: 0.8779; train_kl_reg_loss: 2352.3701; train_edge_recon_loss: 1843473.9375; train_cat_covariates_contrastive_loss: 357754.2344; train_gene_expr_recon_loss: 3467903.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5671483.5000; train_optim_loss: 5671483.5000; val_kl_reg_loss: 2437.3345; val_edge_recon_loss: 2099255.7500; val_cat_covariates_contrastive_loss: 313657.7188; val_gene_expr_recon_loss: 3541925.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5957276.5000; val_optim_loss: 5957276.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9147; val_auprc_score: 0.9685; val_best_acc_score: 0.8023; val_best_f1_score: 0.8836; train_kl_reg_loss: 2387.5798; train_edge_recon_loss: 1887953.8750; train_cat_covariates_contrastive_loss: 350018.0781; train_gene_expr_recon_loss: 3472459.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5712818.5000; train_optim_loss: 5712818.5000; val_kl_reg_loss: 2067.5991; val_edge_recon_loss: 1996572.7500; val_cat_covariates_contrastive_loss: 313703.5000; val_gene_expr_recon_loss: 3534649.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5846993.5000; val_optim_loss: 5846993.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8933; val_auprc_score: 0.9564; val_best_acc_score: 0.7843; val_best_f1_score: 0.8729; train_kl_reg_loss: 1918.1565; train_edge_recon_loss: 1824468.1250; train_cat_covariates_contrastive_loss: 363578.3594; train_gene_expr_recon_loss: 3445369.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5635333.5000; train_optim_loss: 5635333.5000; val_kl_reg_loss: 1532.9929; val_edge_recon_loss: 2047710.7500; val_cat_covariates_contrastive_loss: 313820.6562; val_gene_expr_recon_loss: 3511879.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5874943.5000; val_optim_loss: 5874943.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9103; val_auprc_score: 0.9660; val_best_acc_score: 0.8073; val_best_f1_score: 0.8837; train_kl_reg_loss: 1443.8906; train_edge_recon_loss: 1827317.3125; train_cat_covariates_contrastive_loss: 385126.4219; train_gene_expr_recon_loss: 3443760.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5657648.0000; train_optim_loss: 5657648.0000; val_kl_reg_loss: 1273.8113; val_edge_recon_loss: 2079541.5000; val_cat_covariates_contrastive_loss: 313897.7500; val_gene_expr_recon_loss: 3509801.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5904514.0000; val_optim_loss: 5904514.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8995; val_auprc_score: 0.9474; val_best_acc_score: 0.8135; val_best_f1_score: 0.8864; train_kl_reg_loss: 1262.7411; train_edge_recon_loss: 1768608.6875; train_cat_covariates_contrastive_loss: 394709.8594; train_gene_expr_recon_loss: 3419929.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5584510.5000; train_optim_loss: 5584510.5000; val_kl_reg_loss: 1374.2083; val_edge_recon_loss: 2098478.7500; val_cat_covariates_contrastive_loss: 313932.6875; val_gene_expr_recon_loss: 3468162.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5881948.0000; val_optim_loss: 5881948.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8844; val_auprc_score: 0.9502; val_best_acc_score: 0.8092; val_best_f1_score: 0.8849; train_kl_reg_loss: 1456.9053; train_edge_recon_loss: 1786141.0625; train_cat_covariates_contrastive_loss: 378561.9844; train_gene_expr_recon_loss: 3416664.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5582824.0000; train_optim_loss: 5582824.0000; val_kl_reg_loss: 1688.6742; val_edge_recon_loss: 2034682.8750; val_cat_covariates_contrastive_loss: 313870.7812; val_gene_expr_recon_loss: 3449203.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5799446.0000; val_optim_loss: 5799446.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8725; val_auprc_score: 0.9439; val_best_acc_score: 0.8079; val_best_f1_score: 0.8839; train_kl_reg_loss: 1709.5506; train_edge_recon_loss: 1818796.3750; train_cat_covariates_contrastive_loss: 367523.8125; train_gene_expr_recon_loss: 3370636.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5558666.0000; train_optim_loss: 5558666.0000; val_kl_reg_loss: 1873.2811; val_edge_recon_loss: 1992380.1250; val_cat_covariates_contrastive_loss: 313893.5000; val_gene_expr_recon_loss: 3442434.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5750581.5000; val_optim_loss: 5750581.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8613; val_auprc_score: 0.9458; val_best_acc_score: 0.8157; val_best_f1_score: 0.8843; train_kl_reg_loss: 1823.2151; train_edge_recon_loss: 1776416.8750; train_cat_covariates_contrastive_loss: 359247.4375; train_gene_expr_recon_loss: 3348363.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5485851.2500; train_optim_loss: 5485851.2500; val_kl_reg_loss: 1792.3110; val_edge_recon_loss: 2002881.5000; val_cat_covariates_contrastive_loss: 313892.5000; val_gene_expr_recon_loss: 3417981.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5736548.0000; val_optim_loss: 5736548.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8662; val_auprc_score: 0.9419; val_best_acc_score: 0.8114; val_best_f1_score: 0.8779; train_kl_reg_loss: 1768.9759; train_edge_recon_loss: 1781369.6250; train_cat_covariates_contrastive_loss: 363744.5312; train_gene_expr_recon_loss: 3354806.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5501689.7500; train_optim_loss: 5501689.7500; val_kl_reg_loss: 1680.5115; val_edge_recon_loss: 2089672.0000; val_cat_covariates_contrastive_loss: 313995.5938; val_gene_expr_recon_loss: 3389367.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5794715.5000; val_optim_loss: 5794715.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8326; val_auprc_score: 0.9303; val_best_acc_score: 0.8185; val_best_f1_score: 0.8930; train_kl_reg_loss: 1681.6395; train_edge_recon_loss: 1747990.2500; train_cat_covariates_contrastive_loss: 366767.8281; train_gene_expr_recon_loss: 3313035.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5429475.5000; train_optim_loss: 5429475.5000; val_kl_reg_loss: 1880.8313; val_edge_recon_loss: 1892358.7500; val_cat_covariates_contrastive_loss: 313916.5938; val_gene_expr_recon_loss: 3378038.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5586195.0000; val_optim_loss: 5586195.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8026; val_auprc_score: 0.9089; val_best_acc_score: 0.8102; val_best_f1_score: 0.8860; train_kl_reg_loss: 1891.5477; train_edge_recon_loss: 1782474.3125; train_cat_covariates_contrastive_loss: 362320.7500; train_gene_expr_recon_loss: 3299486.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5446172.7500; train_optim_loss: 5446172.7500; val_kl_reg_loss: 2200.4536; val_edge_recon_loss: 2010141.3750; val_cat_covariates_contrastive_loss: 313905.0625; val_gene_expr_recon_loss: 3352021.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5678268.0000; val_optim_loss: 5678268.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8075; val_auprc_score: 0.9197; val_best_acc_score: 0.8017; val_best_f1_score: 0.8793; train_kl_reg_loss: 2269.1554; train_edge_recon_loss: 1785739.1250; train_cat_covariates_contrastive_loss: 356590.2656; train_gene_expr_recon_loss: 3276789.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5421387.7500; train_optim_loss: 5421387.7500; val_kl_reg_loss: 2494.0166; val_edge_recon_loss: 2051970.7500; val_cat_covariates_contrastive_loss: 313916.3438; val_gene_expr_recon_loss: 3330432.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5698813.5000; val_optim_loss: 5698813.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8189; val_auprc_score: 0.9223; val_best_acc_score: 0.8181; val_best_f1_score: 0.8898; train_kl_reg_loss: 2528.5227; train_edge_recon_loss: 1782807.7500; train_cat_covariates_contrastive_loss: 352333.3594; train_gene_expr_recon_loss: 3260388.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5398058.0000; train_optim_loss: 5398058.0000; val_kl_reg_loss: 2712.9993; val_edge_recon_loss: 2002872.1250; val_cat_covariates_contrastive_loss: 313940.1875; val_gene_expr_recon_loss: 3315060.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5634586.0000; val_optim_loss: 5634586.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8014; val_auprc_score: 0.9124; val_best_acc_score: 0.8154; val_best_f1_score: 0.8872; train_kl_reg_loss: 2672.2531; train_edge_recon_loss: 1769719.6250; train_cat_covariates_contrastive_loss: 351721.7188; train_gene_expr_recon_loss: 3233138.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5357252.5000; train_optim_loss: 5357252.5000; val_kl_reg_loss: 2730.9766; val_edge_recon_loss: 1969113.6250; val_cat_covariates_contrastive_loss: 313992.3438; val_gene_expr_recon_loss: 3290806.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5576644.0000; val_optim_loss: 5576644.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7943; val_auprc_score: 0.9191; val_best_acc_score: 0.8221; val_best_f1_score: 0.8943; train_kl_reg_loss: 2705.1965; train_edge_recon_loss: 1755034.6875; train_cat_covariates_contrastive_loss: 355028.7031; train_gene_expr_recon_loss: 3223457.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5336226.2500; train_optim_loss: 5336226.2500; val_kl_reg_loss: 2973.1912; val_edge_recon_loss: 1834020.6250; val_cat_covariates_contrastive_loss: 314153.6562; val_gene_expr_recon_loss: 3274366.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5425514.0000; val_optim_loss: 5425514.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7780; val_auprc_score: 0.8971; val_best_acc_score: 0.7966; val_best_f1_score: 0.8756; train_kl_reg_loss: 2978.7485; train_edge_recon_loss: 1755404.8125; train_cat_covariates_contrastive_loss: 354414.6406; train_gene_expr_recon_loss: 3201383.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5314181.7500; train_optim_loss: 5314181.7500; val_kl_reg_loss: 3415.6177; val_edge_recon_loss: 2033223.7500; val_cat_covariates_contrastive_loss: 313956.8125; val_gene_expr_recon_loss: 3258463.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5609059.0000; val_optim_loss: 5609059.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7789; val_auprc_score: 0.9072; val_best_acc_score: 0.8104; val_best_f1_score: 0.8868; train_kl_reg_loss: 3564.1986; train_edge_recon_loss: 1782364.2500; train_cat_covariates_contrastive_loss: 349882.5000; train_gene_expr_recon_loss: 3181284.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5317095.5000; train_optim_loss: 5317095.5000; val_kl_reg_loss: 3989.2852; val_edge_recon_loss: 1875145.8750; val_cat_covariates_contrastive_loss: 314166.5312; val_gene_expr_recon_loss: 3231245.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5424547.0000; val_optim_loss: 5424547.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7712; val_auprc_score: 0.8955; val_best_acc_score: 0.8048; val_best_f1_score: 0.8799; train_kl_reg_loss: 4014.8197; train_edge_recon_loss: 1753886.8750; train_cat_covariates_contrastive_loss: 337585.7969; train_gene_expr_recon_loss: 3152015.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247503.0000; train_optim_loss: 5247503.0000; val_kl_reg_loss: 4619.4785; val_edge_recon_loss: 1913407.8750; val_cat_covariates_contrastive_loss: 314118.2500; val_gene_expr_recon_loss: 3209142.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5441287.5000; val_optim_loss: 5441287.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7771; val_auprc_score: 0.9013; val_best_acc_score: 0.8010; val_best_f1_score: 0.8818; train_kl_reg_loss: 4616.2468; train_edge_recon_loss: 1752773.8750; train_cat_covariates_contrastive_loss: 337393.7656; train_gene_expr_recon_loss: 3139038.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5233822.5000; train_optim_loss: 5233822.5000; val_kl_reg_loss: 5215.8691; val_edge_recon_loss: 1873057.8750; val_cat_covariates_contrastive_loss: 314165.5312; val_gene_expr_recon_loss: 3189786.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5382225.0000; val_optim_loss: 5382225.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7682; val_auprc_score: 0.8977; val_best_acc_score: 0.8065; val_best_f1_score: 0.8847; train_kl_reg_loss: 5332.3081; train_edge_recon_loss: 1718362.7500; train_cat_covariates_contrastive_loss: 339548.3750; train_gene_expr_recon_loss: 3129367.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5192610.5000; train_optim_loss: 5192610.5000; val_kl_reg_loss: 6059.4365; val_edge_recon_loss: 1810838.7500; val_cat_covariates_contrastive_loss: 314268.1250; val_gene_expr_recon_loss: 3174182.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5305349.0000; val_optim_loss: 5305349.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7661; val_auprc_score: 0.8979; val_best_acc_score: 0.8068; val_best_f1_score: 0.8822; train_kl_reg_loss: 6166.2375; train_edge_recon_loss: 1731479.7500; train_cat_covariates_contrastive_loss: 330074.4062; train_gene_expr_recon_loss: 3099312.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5167033.2500; train_optim_loss: 5167033.2500; val_kl_reg_loss: 7184.2510; val_edge_recon_loss: 1812687.5000; val_cat_covariates_contrastive_loss: 314115.2500; val_gene_expr_recon_loss: 3143880.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5277867.0000; val_optim_loss: 5277867.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7779; val_auprc_score: 0.9055; val_best_acc_score: 0.8106; val_best_f1_score: 0.8851; train_kl_reg_loss: 7254.1519; train_edge_recon_loss: 1717146.0625; train_cat_covariates_contrastive_loss: 331625.0938; train_gene_expr_recon_loss: 3076137.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5132163.0000; train_optim_loss: 5132163.0000; val_kl_reg_loss: 8841.3516; val_edge_recon_loss: 1787191.5000; val_cat_covariates_contrastive_loss: 314459.2188; val_gene_expr_recon_loss: 3129526.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5240018.0000; val_optim_loss: 5240018.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7663; val_auprc_score: 0.9039; val_best_acc_score: 0.8055; val_best_f1_score: 0.8843; train_kl_reg_loss: 8667.9404; train_edge_recon_loss: 1708677.0000; train_cat_covariates_contrastive_loss: 328669.4375; train_gene_expr_recon_loss: 3052727.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5098741.2500; train_optim_loss: 5098741.2500; val_kl_reg_loss: 10283.6953; val_edge_recon_loss: 1773119.0000; val_cat_covariates_contrastive_loss: 314202.6562; val_gene_expr_recon_loss: 3106234.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5203840.0000; val_optim_loss: 5203840.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7761; val_auprc_score: 0.9007; val_best_acc_score: 0.8023; val_best_f1_score: 0.8809; train_kl_reg_loss: 10278.0742; train_edge_recon_loss: 1716578.8750; train_cat_covariates_contrastive_loss: 328708.7656; train_gene_expr_recon_loss: 3029295.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5084861.0000; train_optim_loss: 5084861.0000; val_kl_reg_loss: 12181.6758; val_edge_recon_loss: 1745937.6250; val_cat_covariates_contrastive_loss: 314332.3750; val_gene_expr_recon_loss: 3095899.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5168351.0000; val_optim_loss: 5168351.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7611; val_auprc_score: 0.8925; val_best_acc_score: 0.8142; val_best_f1_score: 0.8890; train_kl_reg_loss: 11708.1709; train_edge_recon_loss: 1677065.5000; train_cat_covariates_contrastive_loss: 327906.3594; train_gene_expr_recon_loss: 3024441.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5041121.7500; train_optim_loss: 5041121.7500; val_kl_reg_loss: 13201.2959; val_edge_recon_loss: 1699912.0000; val_cat_covariates_contrastive_loss: 314296.9375; val_gene_expr_recon_loss: 3060261.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5087671.0000; val_optim_loss: 5087671.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7661; val_auprc_score: 0.9000; val_best_acc_score: 0.8057; val_best_f1_score: 0.8835; train_kl_reg_loss: 12828.4590; train_edge_recon_loss: 1675575.5000; train_cat_covariates_contrastive_loss: 324836.1875; train_gene_expr_recon_loss: 3006116.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5019357.0000; train_optim_loss: 5019357.0000; val_kl_reg_loss: 14230.1543; val_edge_recon_loss: 1716793.7500; val_cat_covariates_contrastive_loss: 314418.9375; val_gene_expr_recon_loss: 3044128.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5089571.0000; val_optim_loss: 5089571.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7751; val_auprc_score: 0.8958; val_best_acc_score: 0.8195; val_best_f1_score: 0.8894; train_kl_reg_loss: 13714.1318; train_edge_recon_loss: 1663106.0625; train_cat_covariates_contrastive_loss: 325804.3906; train_gene_expr_recon_loss: 2991872.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4994497.2500; train_optim_loss: 4994497.2500; val_kl_reg_loss: 14810.0850; val_edge_recon_loss: 1660070.1250; val_cat_covariates_contrastive_loss: 314141.5000; val_gene_expr_recon_loss: 3024992.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5014014.5000; val_optim_loss: 5014014.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7583; val_auprc_score: 0.8949; val_best_acc_score: 0.8140; val_best_f1_score: 0.8890; train_kl_reg_loss: 14518.8408; train_edge_recon_loss: 1660688.0625; train_cat_covariates_contrastive_loss: 325891.0781; train_gene_expr_recon_loss: 2950137.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4951235.5000; train_optim_loss: 4951235.5000; val_kl_reg_loss: 15999.5449; val_edge_recon_loss: 1637421.8750; val_cat_covariates_contrastive_loss: 313900.1562; val_gene_expr_recon_loss: 3013442.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4980764.0000; val_optim_loss: 4980764.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7556; val_auprc_score: 0.8950; val_best_acc_score: 0.8013; val_best_f1_score: 0.8790; train_kl_reg_loss: 15064.1899; train_edge_recon_loss: 1626055.8125; train_cat_covariates_contrastive_loss: 323467.9062; train_gene_expr_recon_loss: 2934078.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4898666.2500; train_optim_loss: 4898666.2500; val_kl_reg_loss: 17000.1504; val_edge_recon_loss: 1731917.7500; val_cat_covariates_contrastive_loss: 314077.3438; val_gene_expr_recon_loss: 2993861.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5056856.0000; val_optim_loss: 5056856.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7589; val_auprc_score: 0.8910; val_best_acc_score: 0.8143; val_best_f1_score: 0.8868; train_kl_reg_loss: 16976.5430; train_edge_recon_loss: 1680064.1250; train_cat_covariates_contrastive_loss: 325537.7812; train_gene_expr_recon_loss: 2934279.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4956858.0000; train_optim_loss: 4956858.0000; val_kl_reg_loss: 18569.7539; val_edge_recon_loss: 1649990.3750; val_cat_covariates_contrastive_loss: 314101.0938; val_gene_expr_recon_loss: 2986315.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4968976.0000; val_optim_loss: 4968976.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7534; val_auprc_score: 0.8807; val_best_acc_score: 0.7990; val_best_f1_score: 0.8779; train_kl_reg_loss: 18219.9688; train_edge_recon_loss: 1647458.1250; train_cat_covariates_contrastive_loss: 322261.0156; train_gene_expr_recon_loss: 2909146.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4897086.0000; train_optim_loss: 4897086.0000; val_kl_reg_loss: 19923.7500; val_edge_recon_loss: 1723457.1250; val_cat_covariates_contrastive_loss: 314023.3750; val_gene_expr_recon_loss: 2973686.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5031091.0000; val_optim_loss: 5031091.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7591; val_auprc_score: 0.8963; val_best_acc_score: 0.8007; val_best_f1_score: 0.8799; train_kl_reg_loss: 19880.4004; train_edge_recon_loss: 1606168.1875; train_cat_covariates_contrastive_loss: 322920.0938; train_gene_expr_recon_loss: 2909356.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4858324.7500; train_optim_loss: 4858324.7500; val_kl_reg_loss: 21851.9023; val_edge_recon_loss: 1664775.0000; val_cat_covariates_contrastive_loss: 314154.3125; val_gene_expr_recon_loss: 2967820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4968601.0000; val_optim_loss: 4968601.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7565; val_auprc_score: 0.9036; val_best_acc_score: 0.8060; val_best_f1_score: 0.8841; train_kl_reg_loss: 21634.8965; train_edge_recon_loss: 1621118.6875; train_cat_covariates_contrastive_loss: 322592.6406; train_gene_expr_recon_loss: 2891157.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4856504.0000; train_optim_loss: 4856504.0000; val_kl_reg_loss: 22973.7812; val_edge_recon_loss: 1593011.3750; val_cat_covariates_contrastive_loss: 313896.9062; val_gene_expr_recon_loss: 2940889.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870772.0000; val_optim_loss: 4870772.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7343; val_auprc_score: 0.8786; val_best_acc_score: 0.7994; val_best_f1_score: 0.8798; train_kl_reg_loss: 22785.9492; train_edge_recon_loss: 1611724.2500; train_cat_covariates_contrastive_loss: 321039.9062; train_gene_expr_recon_loss: 2873195.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4828745.2500; train_optim_loss: 4828745.2500; val_kl_reg_loss: 25142.3086; val_edge_recon_loss: 1675517.0000; val_cat_covariates_contrastive_loss: 313984.4062; val_gene_expr_recon_loss: 2931563.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4946206.5000; val_optim_loss: 4946206.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7428; val_auprc_score: 0.8781; val_best_acc_score: 0.8070; val_best_f1_score: 0.8827; train_kl_reg_loss: 25088.2168; train_edge_recon_loss: 1602482.1250; train_cat_covariates_contrastive_loss: 320093.4375; train_gene_expr_recon_loss: 2865464.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813128.0000; train_optim_loss: 4813128.0000; val_kl_reg_loss: 26668.4180; val_edge_recon_loss: 1646174.7500; val_cat_covariates_contrastive_loss: 314089.9688; val_gene_expr_recon_loss: 2921066.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4907999.5000; val_optim_loss: 4907999.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7615; val_auprc_score: 0.8977; val_best_acc_score: 0.8014; val_best_f1_score: 0.8804; train_kl_reg_loss: 25980.5723; train_edge_recon_loss: 1601974.0000; train_cat_covariates_contrastive_loss: 320359.5156; train_gene_expr_recon_loss: 2854574.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802889.0000; train_optim_loss: 4802889.0000; val_kl_reg_loss: 27454.5312; val_edge_recon_loss: 1640634.0000; val_cat_covariates_contrastive_loss: 313837.0625; val_gene_expr_recon_loss: 2909269.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4891195.0000; val_optim_loss: 4891195.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7533; val_auprc_score: 0.8971; val_best_acc_score: 0.8119; val_best_f1_score: 0.8861; train_kl_reg_loss: 26936.4082; train_edge_recon_loss: 1566991.4375; train_cat_covariates_contrastive_loss: 318841.7969; train_gene_expr_recon_loss: 2835886.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4748656.5000; train_optim_loss: 4748656.5000; val_kl_reg_loss: 29054.5996; val_edge_recon_loss: 1597375.0000; val_cat_covariates_contrastive_loss: 313973.8125; val_gene_expr_recon_loss: 2897751.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4838154.5000; val_optim_loss: 4838154.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7373; val_auprc_score: 0.8704; val_best_acc_score: 0.8029; val_best_f1_score: 0.8795; train_kl_reg_loss: 28438.8066; train_edge_recon_loss: 1602530.3750; train_cat_covariates_contrastive_loss: 319786.0781; train_gene_expr_recon_loss: 2818906.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4769662.0000; train_optim_loss: 4769662.0000; val_kl_reg_loss: 30541.4961; val_edge_recon_loss: 1697589.8750; val_cat_covariates_contrastive_loss: 314044.8750; val_gene_expr_recon_loss: 2879666.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4921842.0000; val_optim_loss: 4921842.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7403; val_auprc_score: 0.8791; val_best_acc_score: 0.7952; val_best_f1_score: 0.8759; train_kl_reg_loss: 29593.0420; train_edge_recon_loss: 1568478.7500; train_cat_covariates_contrastive_loss: 320018.1406; train_gene_expr_recon_loss: 2817745.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735835.5000; train_optim_loss: 4735835.5000; val_kl_reg_loss: 32049.6445; val_edge_recon_loss: 1694557.1250; val_cat_covariates_contrastive_loss: 313746.0000; val_gene_expr_recon_loss: 2869932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4910285.0000; val_optim_loss: 4910285.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.7299; val_auprc_score: 0.8755; val_best_acc_score: 0.8064; val_best_f1_score: 0.8840; train_kl_reg_loss: 32137.6484; train_edge_recon_loss: 1604061.2500; train_cat_covariates_contrastive_loss: 318906.3750; train_gene_expr_recon_loss: 2794655.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4749760.7500; train_optim_loss: 4749760.7500; val_kl_reg_loss: 34010.9609; val_edge_recon_loss: 1631786.6250; val_cat_covariates_contrastive_loss: 313997.9062; val_gene_expr_recon_loss: 2854211.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4834007.0000; val_optim_loss: 4834007.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7687; val_auprc_score: 0.8929; val_best_acc_score: 0.8110; val_best_f1_score: 0.8846; train_kl_reg_loss: 33060.3965; train_edge_recon_loss: 1562630.6250; train_cat_covariates_contrastive_loss: 318006.9219; train_gene_expr_recon_loss: 2784007.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4697705.2500; train_optim_loss: 4697705.2500; val_kl_reg_loss: 35424.3828; val_edge_recon_loss: 1610586.6250; val_cat_covariates_contrastive_loss: 313947.8750; val_gene_expr_recon_loss: 2844678.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804637.0000; val_optim_loss: 4804637.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7551; val_auprc_score: 0.8937; val_best_acc_score: 0.8063; val_best_f1_score: 0.8829; train_kl_reg_loss: 35476.9453; train_edge_recon_loss: 1575727.5000; train_cat_covariates_contrastive_loss: 319644.6094; train_gene_expr_recon_loss: 2791712.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4722561.7500; train_optim_loss: 4722561.7500; val_kl_reg_loss: 35917.6172; val_edge_recon_loss: 1637042.6250; val_cat_covariates_contrastive_loss: 313946.0625; val_gene_expr_recon_loss: 2833727.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820633.0000; val_optim_loss: 4820633.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.7552; val_auprc_score: 0.8890; val_best_acc_score: 0.8017; val_best_f1_score: 0.8802; train_kl_reg_loss: 35213.5312; train_edge_recon_loss: 1603890.8750; train_cat_covariates_contrastive_loss: 320740.5625; train_gene_expr_recon_loss: 2763688.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4723533.7500; train_optim_loss: 4723533.7500; val_kl_reg_loss: 35360.0625; val_edge_recon_loss: 1633540.2500; val_cat_covariates_contrastive_loss: 314140.2812; val_gene_expr_recon_loss: 2820888.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4803929.0000; val_optim_loss: 4803929.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.7746; val_auprc_score: 0.9043; val_best_acc_score: 0.8140; val_best_f1_score: 0.8864; train_kl_reg_loss: 34982.7539; train_edge_recon_loss: 1540142.0000; train_cat_covariates_contrastive_loss: 320339.8438; train_gene_expr_recon_loss: 2756184.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4651649.0000; train_optim_loss: 4651649.0000; val_kl_reg_loss: 35715.0156; val_edge_recon_loss: 1569439.0000; val_cat_covariates_contrastive_loss: 314224.8750; val_gene_expr_recon_loss: 2806295.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4725674.5000; val_optim_loss: 4725674.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7278; val_auprc_score: 0.8819; val_best_acc_score: 0.7965; val_best_f1_score: 0.8791; train_kl_reg_loss: 35702.2207; train_edge_recon_loss: 1582624.5625; train_cat_covariates_contrastive_loss: 319759.3438; train_gene_expr_recon_loss: 2743863.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4681949.5000; train_optim_loss: 4681949.5000; val_kl_reg_loss: 37797.0234; val_edge_recon_loss: 1674575.5000; val_cat_covariates_contrastive_loss: 314132.4062; val_gene_expr_recon_loss: 2808808.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4835313.5000; val_optim_loss: 4835313.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.7474; val_auprc_score: 0.8841; val_best_acc_score: 0.7933; val_best_f1_score: 0.8755; train_kl_reg_loss: 36983.6797; train_edge_recon_loss: 1601089.1875; train_cat_covariates_contrastive_loss: 319070.2500; train_gene_expr_recon_loss: 2743035.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4700178.7500; train_optim_loss: 4700178.7500; val_kl_reg_loss: 39771.8438; val_edge_recon_loss: 1687412.8750; val_cat_covariates_contrastive_loss: 314250.1250; val_gene_expr_recon_loss: 2794600.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4836035.5000; val_optim_loss: 4836035.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.7800; val_auprc_score: 0.8971; val_best_acc_score: 0.8101; val_best_f1_score: 0.8852; train_kl_reg_loss: 38598.9023; train_edge_recon_loss: 1584316.4375; train_cat_covariates_contrastive_loss: 319520.7031; train_gene_expr_recon_loss: 2711349.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4653785.2500; train_optim_loss: 4653785.2500; val_kl_reg_loss: 40049.1797; val_edge_recon_loss: 1594139.0000; val_cat_covariates_contrastive_loss: 314026.3438; val_gene_expr_recon_loss: 2792444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740658.5000; val_optim_loss: 4740658.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.7453; val_auprc_score: 0.8864; val_best_acc_score: 0.7967; val_best_f1_score: 0.8785; train_kl_reg_loss: 38808.6602; train_edge_recon_loss: 1596250.8125; train_cat_covariates_contrastive_loss: 320281.8906; train_gene_expr_recon_loss: 2726218.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4681560.0000; train_optim_loss: 4681560.0000; val_kl_reg_loss: 38927.1562; val_edge_recon_loss: 1640897.5000; val_cat_covariates_contrastive_loss: 314286.2188; val_gene_expr_recon_loss: 2785488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4779599.0000; val_optim_loss: 4779599.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.7678; val_auprc_score: 0.8926; val_best_acc_score: 0.8077; val_best_f1_score: 0.8842; train_kl_reg_loss: 38269.5273; train_edge_recon_loss: 1577330.1250; train_cat_covariates_contrastive_loss: 318453.4375; train_gene_expr_recon_loss: 2725920.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4659973.5000; train_optim_loss: 4659973.5000; val_kl_reg_loss: 38538.3672; val_edge_recon_loss: 1616020.0000; val_cat_covariates_contrastive_loss: 314274.5938; val_gene_expr_recon_loss: 2786505.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4755338.0000; val_optim_loss: 4755338.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.7465; val_auprc_score: 0.8890; val_best_acc_score: 0.7974; val_best_f1_score: 0.8779; train_kl_reg_loss: 37839.0391; train_edge_recon_loss: 1563182.5625; train_cat_covariates_contrastive_loss: 320246.2344; train_gene_expr_recon_loss: 2718722.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4639989.7500; train_optim_loss: 4639989.7500; val_kl_reg_loss: 38425.3516; val_edge_recon_loss: 1650797.2500; val_cat_covariates_contrastive_loss: 314313.8750; val_gene_expr_recon_loss: 2776669.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4780206.0000; val_optim_loss: 4780206.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.7572; val_auprc_score: 0.8881; val_best_acc_score: 0.7932; val_best_f1_score: 0.8755; train_kl_reg_loss: 37114.4297; train_edge_recon_loss: 1590726.3125; train_cat_covariates_contrastive_loss: 318844.2344; train_gene_expr_recon_loss: 2690379.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4637064.5000; train_optim_loss: 4637064.5000; val_kl_reg_loss: 38479.2734; val_edge_recon_loss: 1670848.8750; val_cat_covariates_contrastive_loss: 314444.7188; val_gene_expr_recon_loss: 2776070.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4799843.5000; val_optim_loss: 4799843.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.7234; val_auprc_score: 0.8692; val_best_acc_score: 0.7897; val_best_f1_score: 0.8748; train_kl_reg_loss: 37557.3164; train_edge_recon_loss: 1579435.7500; train_cat_covariates_contrastive_loss: 319712.2969; train_gene_expr_recon_loss: 2713017.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4649722.7500; train_optim_loss: 4649722.7500; val_kl_reg_loss: 38450.0000; val_edge_recon_loss: 1708375.2500; val_cat_covariates_contrastive_loss: 314017.2500; val_gene_expr_recon_loss: 2775426.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4836269.0000; val_optim_loss: 4836269.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 45 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.7449
val AUPRC score: 0.8870
val best accuracy score: 0.8071
val best F1 score: 0.8851
val target rna MSE score: 0.9819
val source rna MSE score: 0.5534
Val cat covariate0 mean sim diff: 0.0023
Duration of model training in run 4: 0 hours, 0 minutes and 46 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9411; val_auprc_score: 0.9747; val_best_acc_score: 0.7973; val_best_f1_score: 0.8803; train_kl_reg_loss: 78.2664; train_edge_recon_loss: 1727135.3750; train_cat_covariates_contrastive_loss: 659144.2500; train_gene_expr_recon_loss: 3729815.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6116173.2500; train_optim_loss: 6116173.2500; val_kl_reg_loss: 334.8694; val_edge_recon_loss: 2038578.5000; val_cat_covariates_contrastive_loss: 316559.2500; val_gene_expr_recon_loss: 3637433.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5992906.0000; val_optim_loss: 5992906.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9270; val_auprc_score: 0.9672; val_best_acc_score: 0.8556; val_best_f1_score: 0.9101; train_kl_reg_loss: 600.6190; train_edge_recon_loss: 1732247.1250; train_cat_covariates_contrastive_loss: 566559.2656; train_gene_expr_recon_loss: 3678492.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5977899.5000; train_optim_loss: 5977899.5000; val_kl_reg_loss: 901.4076; val_edge_recon_loss: 1972826.8750; val_cat_covariates_contrastive_loss: 314370.4688; val_gene_expr_recon_loss: 3610262.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5898361.0000; val_optim_loss: 5898361.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9198; val_auprc_score: 0.9685; val_best_acc_score: 0.8053; val_best_f1_score: 0.8838; train_kl_reg_loss: 1010.8634; train_edge_recon_loss: 1733502.6875; train_cat_covariates_contrastive_loss: 478156.1875; train_gene_expr_recon_loss: 3600303.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5812973.0000; train_optim_loss: 5812973.0000; val_kl_reg_loss: 1482.6061; val_edge_recon_loss: 2053960.5000; val_cat_covariates_contrastive_loss: 313970.0000; val_gene_expr_recon_loss: 3591756.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5961170.0000; val_optim_loss: 5961170.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9150; val_auprc_score: 0.9633; val_best_acc_score: 0.7913; val_best_f1_score: 0.8774; train_kl_reg_loss: 1717.2758; train_edge_recon_loss: 1841863.0625; train_cat_covariates_contrastive_loss: 393046.4219; train_gene_expr_recon_loss: 3583210.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5819837.0000; train_optim_loss: 5819837.0000; val_kl_reg_loss: 2199.7002; val_edge_recon_loss: 2024301.5000; val_cat_covariates_contrastive_loss: 313748.0312; val_gene_expr_recon_loss: 3569903.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5910153.0000; val_optim_loss: 5910153.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9128; val_auprc_score: 0.9619; val_best_acc_score: 0.7970; val_best_f1_score: 0.8802; train_kl_reg_loss: 2287.5178; train_edge_recon_loss: 1839305.5000; train_cat_covariates_contrastive_loss: 356220.7812; train_gene_expr_recon_loss: 3580392.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5778206.5000; train_optim_loss: 5778206.5000; val_kl_reg_loss: 2299.6475; val_edge_recon_loss: 2023917.3750; val_cat_covariates_contrastive_loss: 313709.2500; val_gene_expr_recon_loss: 3556051.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5895977.0000; val_optim_loss: 5895977.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9214; val_auprc_score: 0.9614; val_best_acc_score: 0.7890; val_best_f1_score: 0.8740; train_kl_reg_loss: 2252.7781; train_edge_recon_loss: 1854930.6875; train_cat_covariates_contrastive_loss: 352426.8906; train_gene_expr_recon_loss: 3576890.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5786501.0000; train_optim_loss: 5786501.0000; val_kl_reg_loss: 1903.7939; val_edge_recon_loss: 2117556.2500; val_cat_covariates_contrastive_loss: 313808.0938; val_gene_expr_recon_loss: 3538567.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5971835.0000; val_optim_loss: 5971835.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9124; val_auprc_score: 0.9652; val_best_acc_score: 0.8165; val_best_f1_score: 0.8899; train_kl_reg_loss: 1802.4965; train_edge_recon_loss: 1848382.3125; train_cat_covariates_contrastive_loss: 367662.9219; train_gene_expr_recon_loss: 3534215.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5752063.5000; train_optim_loss: 5752063.5000; val_kl_reg_loss: 1483.4961; val_edge_recon_loss: 2013708.6250; val_cat_covariates_contrastive_loss: 313874.9688; val_gene_expr_recon_loss: 3519410.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5848477.5000; val_optim_loss: 5848477.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9028; val_auprc_score: 0.9612; val_best_acc_score: 0.8124; val_best_f1_score: 0.8862; train_kl_reg_loss: 1446.6852; train_edge_recon_loss: 1783003.3750; train_cat_covariates_contrastive_loss: 382161.7031; train_gene_expr_recon_loss: 3483924.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5650536.5000; train_optim_loss: 5650536.5000; val_kl_reg_loss: 1333.8191; val_edge_recon_loss: 2026301.8750; val_cat_covariates_contrastive_loss: 313935.5000; val_gene_expr_recon_loss: 3493612.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5835184.0000; val_optim_loss: 5835184.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8894; val_auprc_score: 0.9567; val_best_acc_score: 0.8181; val_best_f1_score: 0.8889; train_kl_reg_loss: 1418.2135; train_edge_recon_loss: 1800606.1875; train_cat_covariates_contrastive_loss: 384409.0781; train_gene_expr_recon_loss: 3501297.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5687731.0000; train_optim_loss: 5687731.0000; val_kl_reg_loss: 1511.3138; val_edge_recon_loss: 1969223.6250; val_cat_covariates_contrastive_loss: 313896.0625; val_gene_expr_recon_loss: 3464106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5748737.0000; val_optim_loss: 5748737.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8729; val_auprc_score: 0.9394; val_best_acc_score: 0.8160; val_best_f1_score: 0.8858; train_kl_reg_loss: 1626.6271; train_edge_recon_loss: 1777322.2500; train_cat_covariates_contrastive_loss: 378584.4375; train_gene_expr_recon_loss: 3466706.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5624240.0000; train_optim_loss: 5624240.0000; val_kl_reg_loss: 1758.1168; val_edge_recon_loss: 2028604.8750; val_cat_covariates_contrastive_loss: 313867.2188; val_gene_expr_recon_loss: 3449062.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5793292.5000; val_optim_loss: 5793292.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8581; val_auprc_score: 0.9371; val_best_acc_score: 0.8083; val_best_f1_score: 0.8779; train_kl_reg_loss: 1872.4125; train_edge_recon_loss: 1798734.2500; train_cat_covariates_contrastive_loss: 370112.9844; train_gene_expr_recon_loss: 3456113.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5626833.5000; train_optim_loss: 5626833.5000; val_kl_reg_loss: 1734.3107; val_edge_recon_loss: 2016165.3750; val_cat_covariates_contrastive_loss: 313918.3438; val_gene_expr_recon_loss: 3424242.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5756060.0000; val_optim_loss: 5756060.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8558; val_auprc_score: 0.9486; val_best_acc_score: 0.7998; val_best_f1_score: 0.8819; train_kl_reg_loss: 1814.0940; train_edge_recon_loss: 1810881.6250; train_cat_covariates_contrastive_loss: 372934.3438; train_gene_expr_recon_loss: 3440620.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5626250.7500; train_optim_loss: 5626250.7500; val_kl_reg_loss: 1702.0046; val_edge_recon_loss: 1989941.6250; val_cat_covariates_contrastive_loss: 314084.1562; val_gene_expr_recon_loss: 3407955.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5713683.0000; val_optim_loss: 5713683.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8435; val_auprc_score: 0.9401; val_best_acc_score: 0.8172; val_best_f1_score: 0.8913; train_kl_reg_loss: 1807.9886; train_edge_recon_loss: 1768494.1875; train_cat_covariates_contrastive_loss: 373443.2969; train_gene_expr_recon_loss: 3371968.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5515714.2500; train_optim_loss: 5515714.2500; val_kl_reg_loss: 1901.9658; val_edge_recon_loss: 1940466.1250; val_cat_covariates_contrastive_loss: 314049.5625; val_gene_expr_recon_loss: 3372253.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5628671.0000; val_optim_loss: 5628671.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8356; val_auprc_score: 0.9376; val_best_acc_score: 0.8166; val_best_f1_score: 0.8894; train_kl_reg_loss: 2039.4371; train_edge_recon_loss: 1809775.0000; train_cat_covariates_contrastive_loss: 368946.3281; train_gene_expr_recon_loss: 3364047.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5544807.5000; train_optim_loss: 5544807.5000; val_kl_reg_loss: 2207.6060; val_edge_recon_loss: 1971510.0000; val_cat_covariates_contrastive_loss: 313927.5312; val_gene_expr_recon_loss: 3339780.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5627426.0000; val_optim_loss: 5627426.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8262; val_auprc_score: 0.9273; val_best_acc_score: 0.8252; val_best_f1_score: 0.8951; train_kl_reg_loss: 2419.4447; train_edge_recon_loss: 1788970.7500; train_cat_covariates_contrastive_loss: 354304.8281; train_gene_expr_recon_loss: 3343515.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5489210.2500; train_optim_loss: 5489210.2500; val_kl_reg_loss: 2506.1382; val_edge_recon_loss: 1905509.2500; val_cat_covariates_contrastive_loss: 313967.0625; val_gene_expr_recon_loss: 3333409.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5555392.0000; val_optim_loss: 5555392.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8107; val_auprc_score: 0.9163; val_best_acc_score: 0.8155; val_best_f1_score: 0.8891; train_kl_reg_loss: 2550.2721; train_edge_recon_loss: 1792332.0625; train_cat_covariates_contrastive_loss: 351659.7188; train_gene_expr_recon_loss: 3306434.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5452976.5000; train_optim_loss: 5452976.5000; val_kl_reg_loss: 2542.8586; val_edge_recon_loss: 1979719.5000; val_cat_covariates_contrastive_loss: 313924.9688; val_gene_expr_recon_loss: 3317824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5614011.0000; val_optim_loss: 5614011.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8142; val_auprc_score: 0.9246; val_best_acc_score: 0.8243; val_best_f1_score: 0.8925; train_kl_reg_loss: 2623.7493; train_edge_recon_loss: 1768747.3125; train_cat_covariates_contrastive_loss: 354847.1406; train_gene_expr_recon_loss: 3306205.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5432423.2500; train_optim_loss: 5432423.2500; val_kl_reg_loss: 2624.8372; val_edge_recon_loss: 1877915.3750; val_cat_covariates_contrastive_loss: 314096.9062; val_gene_expr_recon_loss: 3304400.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5499037.5000; val_optim_loss: 5499037.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7929; val_auprc_score: 0.9081; val_best_acc_score: 0.8156; val_best_f1_score: 0.8881; train_kl_reg_loss: 2828.1222; train_edge_recon_loss: 1736708.2500; train_cat_covariates_contrastive_loss: 355221.5781; train_gene_expr_recon_loss: 3286004.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5380762.0000; train_optim_loss: 5380762.0000; val_kl_reg_loss: 3035.4434; val_edge_recon_loss: 1934263.2500; val_cat_covariates_contrastive_loss: 314133.5312; val_gene_expr_recon_loss: 3280671.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5532104.0000; val_optim_loss: 5532104.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7635; val_auprc_score: 0.8893; val_best_acc_score: 0.8038; val_best_f1_score: 0.8822; train_kl_reg_loss: 3235.4873; train_edge_recon_loss: 1740366.6875; train_cat_covariates_contrastive_loss: 350400.0000; train_gene_expr_recon_loss: 3266920.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5360922.0000; train_optim_loss: 5360922.0000; val_kl_reg_loss: 3525.5210; val_edge_recon_loss: 1947993.0000; val_cat_covariates_contrastive_loss: 313997.0312; val_gene_expr_recon_loss: 3252564.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5518080.0000; val_optim_loss: 5518080.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7780; val_auprc_score: 0.9017; val_best_acc_score: 0.8067; val_best_f1_score: 0.8848; train_kl_reg_loss: 3833.4359; train_edge_recon_loss: 1734378.9375; train_cat_covariates_contrastive_loss: 343230.9531; train_gene_expr_recon_loss: 3241913.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5323357.0000; train_optim_loss: 5323357.0000; val_kl_reg_loss: 4124.0869; val_edge_recon_loss: 1866550.8750; val_cat_covariates_contrastive_loss: 314202.5000; val_gene_expr_recon_loss: 3234960.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5419838.0000; val_optim_loss: 5419838.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7630; val_auprc_score: 0.8975; val_best_acc_score: 0.8172; val_best_f1_score: 0.8911; train_kl_reg_loss: 4421.1323; train_edge_recon_loss: 1725062.5000; train_cat_covariates_contrastive_loss: 336125.5312; train_gene_expr_recon_loss: 3234652.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5300261.0000; train_optim_loss: 5300261.0000; val_kl_reg_loss: 4881.9795; val_edge_recon_loss: 1792085.6250; val_cat_covariates_contrastive_loss: 313938.9688; val_gene_expr_recon_loss: 3219516.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5330423.0000; val_optim_loss: 5330423.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7703; val_auprc_score: 0.8946; val_best_acc_score: 0.8066; val_best_f1_score: 0.8830; train_kl_reg_loss: 5161.9851; train_edge_recon_loss: 1699431.1250; train_cat_covariates_contrastive_loss: 335855.6406; train_gene_expr_recon_loss: 3219915.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5260364.5000; train_optim_loss: 5260364.5000; val_kl_reg_loss: 5766.3057; val_edge_recon_loss: 1841261.0000; val_cat_covariates_contrastive_loss: 314023.7812; val_gene_expr_recon_loss: 3195091.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5356142.0000; val_optim_loss: 5356142.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7670; val_auprc_score: 0.8939; val_best_acc_score: 0.8202; val_best_f1_score: 0.8917; train_kl_reg_loss: 5937.9141; train_edge_recon_loss: 1696739.8125; train_cat_covariates_contrastive_loss: 334056.5312; train_gene_expr_recon_loss: 3178665.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5215400.2500; train_optim_loss: 5215400.2500; val_kl_reg_loss: 6839.4053; val_edge_recon_loss: 1774625.3750; val_cat_covariates_contrastive_loss: 314092.6250; val_gene_expr_recon_loss: 3177457.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5273014.5000; val_optim_loss: 5273014.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7742; val_auprc_score: 0.8996; val_best_acc_score: 0.8178; val_best_f1_score: 0.8898; train_kl_reg_loss: 7130.5994; train_edge_recon_loss: 1696722.1250; train_cat_covariates_contrastive_loss: 329114.7812; train_gene_expr_recon_loss: 3153786.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5186753.7500; train_optim_loss: 5186753.7500; val_kl_reg_loss: 8009.6885; val_edge_recon_loss: 1781801.6250; val_cat_covariates_contrastive_loss: 313927.7188; val_gene_expr_recon_loss: 3144298.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5248037.5000; val_optim_loss: 5248037.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7639; val_auprc_score: 0.8911; val_best_acc_score: 0.7982; val_best_f1_score: 0.8784; train_kl_reg_loss: 8359.6880; train_edge_recon_loss: 1663718.6250; train_cat_covariates_contrastive_loss: 326171.6562; train_gene_expr_recon_loss: 3141532.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5139782.0000; train_optim_loss: 5139782.0000; val_kl_reg_loss: 9190.1406; val_edge_recon_loss: 1846361.2500; val_cat_covariates_contrastive_loss: 313885.3750; val_gene_expr_recon_loss: 3126965.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5296402.0000; val_optim_loss: 5296402.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7599; val_auprc_score: 0.8888; val_best_acc_score: 0.8050; val_best_f1_score: 0.8815; train_kl_reg_loss: 9502.1982; train_edge_recon_loss: 1666997.1250; train_cat_covariates_contrastive_loss: 325023.0312; train_gene_expr_recon_loss: 3114113.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5115635.7500; train_optim_loss: 5115635.7500; val_kl_reg_loss: 10409.5176; val_edge_recon_loss: 1784221.3750; val_cat_covariates_contrastive_loss: 314029.5312; val_gene_expr_recon_loss: 3100484.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5209145.0000; val_optim_loss: 5209145.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7632; val_auprc_score: 0.8933; val_best_acc_score: 0.8012; val_best_f1_score: 0.8802; train_kl_reg_loss: 10803.6597; train_edge_recon_loss: 1707935.8750; train_cat_covariates_contrastive_loss: 322339.2188; train_gene_expr_recon_loss: 3096334.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5137413.5000; train_optim_loss: 5137413.5000; val_kl_reg_loss: 11944.8096; val_edge_recon_loss: 1811914.6250; val_cat_covariates_contrastive_loss: 314061.8750; val_gene_expr_recon_loss: 3082078.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5219999.0000; val_optim_loss: 5219999.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7653; val_auprc_score: 0.8881; val_best_acc_score: 0.7998; val_best_f1_score: 0.8784; train_kl_reg_loss: 12249.1260; train_edge_recon_loss: 1653642.1875; train_cat_covariates_contrastive_loss: 327379.1406; train_gene_expr_recon_loss: 3076401.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5069671.7500; train_optim_loss: 5069671.7500; val_kl_reg_loss: 13347.3594; val_edge_recon_loss: 1782052.2500; val_cat_covariates_contrastive_loss: 313801.5312; val_gene_expr_recon_loss: 3069212.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5178414.0000; val_optim_loss: 5178414.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7733; val_auprc_score: 0.8991; val_best_acc_score: 0.8143; val_best_f1_score: 0.8887; train_kl_reg_loss: 13402.5991; train_edge_recon_loss: 1630015.0625; train_cat_covariates_contrastive_loss: 323315.9844; train_gene_expr_recon_loss: 3055814.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5022547.7500; train_optim_loss: 5022547.7500; val_kl_reg_loss: 14522.4912; val_edge_recon_loss: 1657301.0000; val_cat_covariates_contrastive_loss: 313719.4688; val_gene_expr_recon_loss: 3044320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5029863.0000; val_optim_loss: 5029863.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7647; val_auprc_score: 0.8995; val_best_acc_score: 0.8167; val_best_f1_score: 0.8911; train_kl_reg_loss: 14577.3555; train_edge_recon_loss: 1671154.5000; train_cat_covariates_contrastive_loss: 323561.4219; train_gene_expr_recon_loss: 3031495.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5040788.5000; train_optim_loss: 5040788.5000; val_kl_reg_loss: 15889.0146; val_edge_recon_loss: 1619039.3750; val_cat_covariates_contrastive_loss: 313857.1562; val_gene_expr_recon_loss: 3019400.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4968186.0000; val_optim_loss: 4968186.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7540; val_auprc_score: 0.8825; val_best_acc_score: 0.7998; val_best_f1_score: 0.8790; train_kl_reg_loss: 16720.7075; train_edge_recon_loss: 1637411.8750; train_cat_covariates_contrastive_loss: 321294.7812; train_gene_expr_recon_loss: 3023383.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4998810.5000; train_optim_loss: 4998810.5000; val_kl_reg_loss: 18133.4219; val_edge_recon_loss: 1740261.8750; val_cat_covariates_contrastive_loss: 313934.0938; val_gene_expr_recon_loss: 3005051.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5077381.0000; val_optim_loss: 5077381.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7736; val_auprc_score: 0.8942; val_best_acc_score: 0.8093; val_best_f1_score: 0.8854; train_kl_reg_loss: 18856.8418; train_edge_recon_loss: 1607460.9375; train_cat_covariates_contrastive_loss: 321364.6250; train_gene_expr_recon_loss: 2974421.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4922104.2500; train_optim_loss: 4922104.2500; val_kl_reg_loss: 20449.8203; val_edge_recon_loss: 1657684.6250; val_cat_covariates_contrastive_loss: 313890.6562; val_gene_expr_recon_loss: 2980667.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4972693.0000; val_optim_loss: 4972693.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7771; val_auprc_score: 0.9009; val_best_acc_score: 0.8116; val_best_f1_score: 0.8865; train_kl_reg_loss: 21873.6465; train_edge_recon_loss: 1641792.6250; train_cat_covariates_contrastive_loss: 322140.6875; train_gene_expr_recon_loss: 2980041.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4965848.2500; train_optim_loss: 4965848.2500; val_kl_reg_loss: 23180.7383; val_edge_recon_loss: 1653047.2500; val_cat_covariates_contrastive_loss: 313828.1250; val_gene_expr_recon_loss: 2961186.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4951243.0000; val_optim_loss: 4951243.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7581; val_auprc_score: 0.8946; val_best_acc_score: 0.8037; val_best_f1_score: 0.8829; train_kl_reg_loss: 24374.0566; train_edge_recon_loss: 1655319.3750; train_cat_covariates_contrastive_loss: 322030.9062; train_gene_expr_recon_loss: 2937913.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4939637.7500; train_optim_loss: 4939637.7500; val_kl_reg_loss: 26489.2305; val_edge_recon_loss: 1657913.6250; val_cat_covariates_contrastive_loss: 313990.9375; val_gene_expr_recon_loss: 2950776.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4949170.5000; val_optim_loss: 4949170.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7663; val_auprc_score: 0.8897; val_best_acc_score: 0.8056; val_best_f1_score: 0.8833; train_kl_reg_loss: 26296.0088; train_edge_recon_loss: 1616104.0625; train_cat_covariates_contrastive_loss: 321976.9062; train_gene_expr_recon_loss: 2923500.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4887877.5000; train_optim_loss: 4887877.5000; val_kl_reg_loss: 28523.5820; val_edge_recon_loss: 1665923.5000; val_cat_covariates_contrastive_loss: 313875.8125; val_gene_expr_recon_loss: 2929783.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4938106.0000; val_optim_loss: 4938106.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7564; val_auprc_score: 0.8909; val_best_acc_score: 0.8083; val_best_f1_score: 0.8853; train_kl_reg_loss: 28763.0049; train_edge_recon_loss: 1634925.0625; train_cat_covariates_contrastive_loss: 319934.1094; train_gene_expr_recon_loss: 2903780.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4887402.5000; train_optim_loss: 4887402.5000; val_kl_reg_loss: 29985.2344; val_edge_recon_loss: 1645851.3750; val_cat_covariates_contrastive_loss: 313862.8750; val_gene_expr_recon_loss: 2907378.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4897078.0000; val_optim_loss: 4897078.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7704; val_auprc_score: 0.9014; val_best_acc_score: 0.8118; val_best_f1_score: 0.8862; train_kl_reg_loss: 31087.5566; train_edge_recon_loss: 1615096.1875; train_cat_covariates_contrastive_loss: 319202.0156; train_gene_expr_recon_loss: 2878717.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844103.2500; train_optim_loss: 4844103.2500; val_kl_reg_loss: 31195.7930; val_edge_recon_loss: 1613924.2500; val_cat_covariates_contrastive_loss: 313797.6250; val_gene_expr_recon_loss: 2887474.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4846392.0000; val_optim_loss: 4846392.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7656; val_auprc_score: 0.8974; val_best_acc_score: 0.8000; val_best_f1_score: 0.8798; train_kl_reg_loss: 32004.2207; train_edge_recon_loss: 1618768.2500; train_cat_covariates_contrastive_loss: 320789.1094; train_gene_expr_recon_loss: 2858109.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4829670.7500; train_optim_loss: 4829670.7500; val_kl_reg_loss: 32806.0352; val_edge_recon_loss: 1693630.2500; val_cat_covariates_contrastive_loss: 314068.5312; val_gene_expr_recon_loss: 2879404.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4919909.0000; val_optim_loss: 4919909.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7543; val_auprc_score: 0.8812; val_best_acc_score: 0.7999; val_best_f1_score: 0.8797; train_kl_reg_loss: 33196.9922; train_edge_recon_loss: 1581191.9375; train_cat_covariates_contrastive_loss: 319059.9688; train_gene_expr_recon_loss: 2865967.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4799416.2500; train_optim_loss: 4799416.2500; val_kl_reg_loss: 35739.5547; val_edge_recon_loss: 1676047.5000; val_cat_covariates_contrastive_loss: 313905.3438; val_gene_expr_recon_loss: 2865449.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4891142.0000; val_optim_loss: 4891142.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7682; val_auprc_score: 0.9004; val_best_acc_score: 0.8125; val_best_f1_score: 0.8889; train_kl_reg_loss: 36477.0410; train_edge_recon_loss: 1607620.8750; train_cat_covariates_contrastive_loss: 319066.1250; train_gene_expr_recon_loss: 2851303.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814467.0000; train_optim_loss: 4814467.0000; val_kl_reg_loss: 38005.3789; val_edge_recon_loss: 1555447.6250; val_cat_covariates_contrastive_loss: 314065.5000; val_gene_expr_recon_loss: 2847813.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4755331.5000; val_optim_loss: 4755331.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7872; val_auprc_score: 0.9098; val_best_acc_score: 0.8160; val_best_f1_score: 0.8899; train_kl_reg_loss: 38626.7461; train_edge_recon_loss: 1618746.0000; train_cat_covariates_contrastive_loss: 318887.7656; train_gene_expr_recon_loss: 2823975.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4800236.2500; train_optim_loss: 4800236.2500; val_kl_reg_loss: 38662.8828; val_edge_recon_loss: 1541768.1250; val_cat_covariates_contrastive_loss: 314016.0625; val_gene_expr_recon_loss: 2835256.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4729703.0000; val_optim_loss: 4729703.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7718; val_auprc_score: 0.8950; val_best_acc_score: 0.8037; val_best_f1_score: 0.8806; train_kl_reg_loss: 39252.7793; train_edge_recon_loss: 1624069.5000; train_cat_covariates_contrastive_loss: 319340.7031; train_gene_expr_recon_loss: 2810043.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792706.5000; train_optim_loss: 4792706.5000; val_kl_reg_loss: 40054.9922; val_edge_recon_loss: 1651504.8750; val_cat_covariates_contrastive_loss: 313928.4375; val_gene_expr_recon_loss: 2827899.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4833388.0000; val_optim_loss: 4833388.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7790; val_auprc_score: 0.9117; val_best_acc_score: 0.8084; val_best_f1_score: 0.8855; train_kl_reg_loss: 39372.5371; train_edge_recon_loss: 1607787.6875; train_cat_covariates_contrastive_loss: 319713.3594; train_gene_expr_recon_loss: 2803703.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4770576.7500; train_optim_loss: 4770576.7500; val_kl_reg_loss: 38775.0078; val_edge_recon_loss: 1575263.2500; val_cat_covariates_contrastive_loss: 313950.5938; val_gene_expr_recon_loss: 2802342.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4730331.5000; val_optim_loss: 4730331.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.7540; val_auprc_score: 0.9002; val_best_acc_score: 0.8155; val_best_f1_score: 0.8909; train_kl_reg_loss: 38807.4980; train_edge_recon_loss: 1592659.3750; train_cat_covariates_contrastive_loss: 318969.8125; train_gene_expr_recon_loss: 2773738.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4724174.5000; train_optim_loss: 4724174.5000; val_kl_reg_loss: 39365.3008; val_edge_recon_loss: 1543198.8750; val_cat_covariates_contrastive_loss: 314258.2500; val_gene_expr_recon_loss: 2795547.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4692369.5000; val_optim_loss: 4692369.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7543; val_auprc_score: 0.8949; val_best_acc_score: 0.8123; val_best_f1_score: 0.8873; train_kl_reg_loss: 40035.6973; train_edge_recon_loss: 1618480.4375; train_cat_covariates_contrastive_loss: 319549.0781; train_gene_expr_recon_loss: 2778943.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4757009.0000; train_optim_loss: 4757009.0000; val_kl_reg_loss: 41171.5156; val_edge_recon_loss: 1587606.1250; val_cat_covariates_contrastive_loss: 314199.5938; val_gene_expr_recon_loss: 2786559.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4729536.0000; val_optim_loss: 4729536.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7741; val_auprc_score: 0.8982; val_best_acc_score: 0.8048; val_best_f1_score: 0.8805; train_kl_reg_loss: 41754.5039; train_edge_recon_loss: 1585252.5625; train_cat_covariates_contrastive_loss: 317881.0625; train_gene_expr_recon_loss: 2775686.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4720574.7500; train_optim_loss: 4720574.7500; val_kl_reg_loss: 42328.3984; val_edge_recon_loss: 1683033.0000; val_cat_covariates_contrastive_loss: 313927.7812; val_gene_expr_recon_loss: 2784408.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4823697.5000; val_optim_loss: 4823697.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.7572; val_auprc_score: 0.8853; val_best_acc_score: 0.7959; val_best_f1_score: 0.8776; train_kl_reg_loss: 42650.8242; train_edge_recon_loss: 1594290.7500; train_cat_covariates_contrastive_loss: 318957.1250; train_gene_expr_recon_loss: 2761765.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4717664.2500; train_optim_loss: 4717664.2500; val_kl_reg_loss: 42104.1875; val_edge_recon_loss: 1693612.2500; val_cat_covariates_contrastive_loss: 314170.7812; val_gene_expr_recon_loss: 2763924.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813812.0000; val_optim_loss: 4813812.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.7696; val_auprc_score: 0.8919; val_best_acc_score: 0.7987; val_best_f1_score: 0.8784; train_kl_reg_loss: 42243.5996; train_edge_recon_loss: 1562420.4375; train_cat_covariates_contrastive_loss: 317546.8594; train_gene_expr_recon_loss: 2738121.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4660332.0000; train_optim_loss: 4660332.0000; val_kl_reg_loss: 42500.7188; val_edge_recon_loss: 1692703.2500; val_cat_covariates_contrastive_loss: 313977.3750; val_gene_expr_recon_loss: 2757665.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4806846.5000; val_optim_loss: 4806846.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7684; val_auprc_score: 0.9074; val_best_acc_score: 0.8165; val_best_f1_score: 0.8920; train_kl_reg_loss: 42189.8730; train_edge_recon_loss: 1588493.6875; train_cat_covariates_contrastive_loss: 318806.1875; train_gene_expr_recon_loss: 2744047.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4693536.5000; train_optim_loss: 4693536.5000; val_kl_reg_loss: 41836.7930; val_edge_recon_loss: 1493007.2500; val_cat_covariates_contrastive_loss: 314057.8125; val_gene_expr_recon_loss: 2753603.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4602505.0000; val_optim_loss: 4602505.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.7756; val_auprc_score: 0.9087; val_best_acc_score: 0.8184; val_best_f1_score: 0.8918; train_kl_reg_loss: 43145.7695; train_edge_recon_loss: 1591057.6875; train_cat_covariates_contrastive_loss: 318990.4844; train_gene_expr_recon_loss: 2760923.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4714117.0000; train_optim_loss: 4714117.0000; val_kl_reg_loss: 43293.1172; val_edge_recon_loss: 1502528.8750; val_cat_covariates_contrastive_loss: 314047.8438; val_gene_expr_recon_loss: 2765766.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4625636.5000; val_optim_loss: 4625636.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.7591; val_auprc_score: 0.8869; val_best_acc_score: 0.8048; val_best_f1_score: 0.8822; train_kl_reg_loss: 42852.9043; train_edge_recon_loss: 1552592.1250; train_cat_covariates_contrastive_loss: 318476.2031; train_gene_expr_recon_loss: 2764187.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4678109.0000; train_optim_loss: 4678109.0000; val_kl_reg_loss: 41802.2500; val_edge_recon_loss: 1616416.2500; val_cat_covariates_contrastive_loss: 313968.8750; val_gene_expr_recon_loss: 2747747.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4719935.0000; val_optim_loss: 4719935.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.7651; val_auprc_score: 0.8892; val_best_acc_score: 0.8022; val_best_f1_score: 0.8809; train_kl_reg_loss: 42460.3457; train_edge_recon_loss: 1606055.5625; train_cat_covariates_contrastive_loss: 317211.3125; train_gene_expr_recon_loss: 2739775.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4705502.7500; train_optim_loss: 4705502.7500; val_kl_reg_loss: 42360.9062; val_edge_recon_loss: 1649980.1250; val_cat_covariates_contrastive_loss: 314167.5312; val_gene_expr_recon_loss: 2756763.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763272.0000; val_optim_loss: 4763272.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.7725; val_auprc_score: 0.9051; val_best_acc_score: 0.8075; val_best_f1_score: 0.8847; train_kl_reg_loss: 42732.9062; train_edge_recon_loss: 1579845.1875; train_cat_covariates_contrastive_loss: 318226.5000; train_gene_expr_recon_loss: 2749401.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4690206.2500; train_optim_loss: 4690206.2500; val_kl_reg_loss: 43270.2383; val_edge_recon_loss: 1598438.3750; val_cat_covariates_contrastive_loss: 314082.2812; val_gene_expr_recon_loss: 2755633.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4711424.5000; val_optim_loss: 4711424.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.7670; val_auprc_score: 0.9027; val_best_acc_score: 0.8155; val_best_f1_score: 0.8895; train_kl_reg_loss: 43282.4160; train_edge_recon_loss: 1575108.9375; train_cat_covariates_contrastive_loss: 319336.7656; train_gene_expr_recon_loss: 2728245.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4665973.2500; train_optim_loss: 4665973.2500; val_kl_reg_loss: 42840.7734; val_edge_recon_loss: 1546068.3750; val_cat_covariates_contrastive_loss: 314169.0312; val_gene_expr_recon_loss: 2752446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4655524.0000; val_optim_loss: 4655524.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.7733; val_auprc_score: 0.9056; val_best_acc_score: 0.8065; val_best_f1_score: 0.8840; train_kl_reg_loss: 43467.5059; train_edge_recon_loss: 1569216.3125; train_cat_covariates_contrastive_loss: 319060.4844; train_gene_expr_recon_loss: 2743813.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4675557.7500; train_optim_loss: 4675557.7500; val_kl_reg_loss: 42318.8398; val_edge_recon_loss: 1612149.1250; val_cat_covariates_contrastive_loss: 314132.4062; val_gene_expr_recon_loss: 2749992.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4718593.0000; val_optim_loss: 4718593.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.7502; val_auprc_score: 0.8917; val_best_acc_score: 0.8032; val_best_f1_score: 0.8823; train_kl_reg_loss: 43211.6016; train_edge_recon_loss: 1586562.6250; train_cat_covariates_contrastive_loss: 317992.4531; train_gene_expr_recon_loss: 2745519.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4693285.7500; train_optim_loss: 4693285.7500; val_kl_reg_loss: 43152.7344; val_edge_recon_loss: 1635560.1250; val_cat_covariates_contrastive_loss: 314035.6250; val_gene_expr_recon_loss: 2751491.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4744240.0000; val_optim_loss: 4744240.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.7654; val_auprc_score: 0.9076; val_best_acc_score: 0.8068; val_best_f1_score: 0.8851; train_kl_reg_loss: 43327.8652; train_edge_recon_loss: 1619261.4375; train_cat_covariates_contrastive_loss: 318287.7969; train_gene_expr_recon_loss: 2754866.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4735743.5000; train_optim_loss: 4735743.5000; val_kl_reg_loss: 42885.2383; val_edge_recon_loss: 1574996.5000; val_cat_covariates_contrastive_loss: 314074.9375; val_gene_expr_recon_loss: 2756863.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4688820.0000; val_optim_loss: 4688820.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 46 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.7764
val AUPRC score: 0.9127
val best accuracy score: 0.8194
val best F1 score: 0.8925
val target rna MSE score: 1.0184
val source rna MSE score: 0.3494
Val cat covariate0 mean sim diff: 0.0113
Duration of model training in run 3: 0 hours, 0 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8514; val_auprc_score: 0.9414; val_best_acc_score: 0.8026; val_best_f1_score: 0.8741; train_kl_reg_loss: 51.4212; train_edge_recon_loss: 1752733.5000; train_cat_covariates_contrastive_loss: 664299.3750; train_gene_expr_recon_loss: 3627606.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6044690.0000; train_optim_loss: 6044690.0000; val_kl_reg_loss: 117.8045; val_edge_recon_loss: 2049664.0000; val_cat_covariates_contrastive_loss: 327630.5312; val_gene_expr_recon_loss: 3573870.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5951282.0000; val_optim_loss: 5951282.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8106; val_auprc_score: 0.9344; val_best_acc_score: 0.7918; val_best_f1_score: 0.8751; train_kl_reg_loss: 119.1264; train_edge_recon_loss: 1704155.7500; train_cat_covariates_contrastive_loss: 652866.5000; train_gene_expr_recon_loss: 3551478.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5908619.5000; train_optim_loss: 5908619.5000; val_kl_reg_loss: 366.6585; val_edge_recon_loss: 1929593.5000; val_cat_covariates_contrastive_loss: 317912.7500; val_gene_expr_recon_loss: 3551852.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5799725.5000; val_optim_loss: 5799725.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8060; val_auprc_score: 0.9249; val_best_acc_score: 0.7424; val_best_f1_score: 0.8522; train_kl_reg_loss: 371.6138; train_edge_recon_loss: 1744895.2500; train_cat_covariates_contrastive_loss: 605344.4375; train_gene_expr_recon_loss: 3517857.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5868468.0000; train_optim_loss: 5868468.0000; val_kl_reg_loss: 923.3350; val_edge_recon_loss: 2087457.3750; val_cat_covariates_contrastive_loss: 315065.3125; val_gene_expr_recon_loss: 3568049.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5971496.0000; val_optim_loss: 5971496.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8112; val_auprc_score: 0.9288; val_best_acc_score: 0.7489; val_best_f1_score: 0.8564; train_kl_reg_loss: 939.7999; train_edge_recon_loss: 1740778.8750; train_cat_covariates_contrastive_loss: 497725.7188; train_gene_expr_recon_loss: 3534589.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5774033.0000; train_optim_loss: 5774033.0000; val_kl_reg_loss: 1334.4009; val_edge_recon_loss: 2036560.3750; val_cat_covariates_contrastive_loss: 314391.0938; val_gene_expr_recon_loss: 3506881.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5859167.0000; val_optim_loss: 5859167.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8102; val_auprc_score: 0.9265; val_best_acc_score: 0.7938; val_best_f1_score: 0.8707; train_kl_reg_loss: 1360.5574; train_edge_recon_loss: 1798749.0000; train_cat_covariates_contrastive_loss: 436599.9375; train_gene_expr_recon_loss: 3475168.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5711878.0000; train_optim_loss: 5711878.0000; val_kl_reg_loss: 1884.3403; val_edge_recon_loss: 1970353.6250; val_cat_covariates_contrastive_loss: 314118.0000; val_gene_expr_recon_loss: 3484773.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5771130.0000; val_optim_loss: 5771130.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8187; val_auprc_score: 0.9365; val_best_acc_score: 0.7987; val_best_f1_score: 0.8792; train_kl_reg_loss: 1918.8175; train_edge_recon_loss: 1827711.1250; train_cat_covariates_contrastive_loss: 385374.5312; train_gene_expr_recon_loss: 3449733.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5664738.0000; train_optim_loss: 5664738.0000; val_kl_reg_loss: 2370.1421; val_edge_recon_loss: 1915982.3750; val_cat_covariates_contrastive_loss: 313965.2500; val_gene_expr_recon_loss: 3479336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5711654.0000; val_optim_loss: 5711654.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8111; val_auprc_score: 0.9307; val_best_acc_score: 0.7960; val_best_f1_score: 0.8783; train_kl_reg_loss: 2403.4692; train_edge_recon_loss: 1859476.8750; train_cat_covariates_contrastive_loss: 357262.4375; train_gene_expr_recon_loss: 3437739.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5656882.0000; train_optim_loss: 5656882.0000; val_kl_reg_loss: 2582.1328; val_edge_recon_loss: 1971219.6250; val_cat_covariates_contrastive_loss: 313897.2188; val_gene_expr_recon_loss: 3461181.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5748880.0000; val_optim_loss: 5748880.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7936; val_auprc_score: 0.9120; val_best_acc_score: 0.7874; val_best_f1_score: 0.8721; train_kl_reg_loss: 2635.5808; train_edge_recon_loss: 1899714.1250; train_cat_covariates_contrastive_loss: 346091.9375; train_gene_expr_recon_loss: 3429879.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5678321.0000; train_optim_loss: 5678321.0000; val_kl_reg_loss: 2579.6711; val_edge_recon_loss: 2071837.8750; val_cat_covariates_contrastive_loss: 313880.2500; val_gene_expr_recon_loss: 3458079.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5846377.0000; val_optim_loss: 5846377.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8004; val_auprc_score: 0.9268; val_best_acc_score: 0.7887; val_best_f1_score: 0.8738; train_kl_reg_loss: 2607.0425; train_edge_recon_loss: 1917177.5000; train_cat_covariates_contrastive_loss: 343511.4688; train_gene_expr_recon_loss: 3420520.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5683816.5000; train_optim_loss: 5683816.5000; val_kl_reg_loss: 2378.4507; val_edge_recon_loss: 1984648.5000; val_cat_covariates_contrastive_loss: 313913.9375; val_gene_expr_recon_loss: 3446434.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5747375.5000; val_optim_loss: 5747375.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8000; val_auprc_score: 0.9172; val_best_acc_score: 0.7742; val_best_f1_score: 0.8621; train_kl_reg_loss: 2396.4648; train_edge_recon_loss: 1815037.2500; train_cat_covariates_contrastive_loss: 347440.1250; train_gene_expr_recon_loss: 3410409.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5575283.0000; train_optim_loss: 5575283.0000; val_kl_reg_loss: 2094.0854; val_edge_recon_loss: 2097486.7500; val_cat_covariates_contrastive_loss: 313932.6250; val_gene_expr_recon_loss: 3434127.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5847641.0000; val_optim_loss: 5847641.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8102; val_auprc_score: 0.9165; val_best_acc_score: 0.7874; val_best_f1_score: 0.8688; train_kl_reg_loss: 2104.2983; train_edge_recon_loss: 1805746.7500; train_cat_covariates_contrastive_loss: 351284.0625; train_gene_expr_recon_loss: 3399410.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5558546.0000; train_optim_loss: 5558546.0000; val_kl_reg_loss: 2047.2466; val_edge_recon_loss: 2103763.0000; val_cat_covariates_contrastive_loss: 313969.2188; val_gene_expr_recon_loss: 3435530.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5855310.0000; val_optim_loss: 5855310.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7849; val_auprc_score: 0.9176; val_best_acc_score: 0.7810; val_best_f1_score: 0.8675; train_kl_reg_loss: 2071.3198; train_edge_recon_loss: 1865873.2500; train_cat_covariates_contrastive_loss: 353890.5000; train_gene_expr_recon_loss: 3397999.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5619834.0000; train_optim_loss: 5619834.0000; val_kl_reg_loss: 2013.0964; val_edge_recon_loss: 1984204.3750; val_cat_covariates_contrastive_loss: 313965.0938; val_gene_expr_recon_loss: 3433872.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5734055.0000; val_optim_loss: 5734055.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8341; val_auprc_score: 0.9379; val_best_acc_score: 0.8198; val_best_f1_score: 0.8886; train_kl_reg_loss: 2029.6729; train_edge_recon_loss: 1870350.0000; train_cat_covariates_contrastive_loss: 356192.1562; train_gene_expr_recon_loss: 3396712.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5625284.0000; train_optim_loss: 5625284.0000; val_kl_reg_loss: 1966.9363; val_edge_recon_loss: 1949340.2500; val_cat_covariates_contrastive_loss: 313976.0938; val_gene_expr_recon_loss: 3431039.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5696322.0000; val_optim_loss: 5696322.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8158; val_auprc_score: 0.9280; val_best_acc_score: 0.7906; val_best_f1_score: 0.8707; train_kl_reg_loss: 1984.1748; train_edge_recon_loss: 1834785.2500; train_cat_covariates_contrastive_loss: 355959.4688; train_gene_expr_recon_loss: 3394836.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5587565.0000; train_optim_loss: 5587565.0000; val_kl_reg_loss: 1907.8595; val_edge_recon_loss: 2037312.3750; val_cat_covariates_contrastive_loss: 314044.4062; val_gene_expr_recon_loss: 3424938.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5778203.0000; val_optim_loss: 5778203.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8100; val_auprc_score: 0.9263; val_best_acc_score: 0.7882; val_best_f1_score: 0.8682; train_kl_reg_loss: 1940.7061; train_edge_recon_loss: 1802414.0000; train_cat_covariates_contrastive_loss: 359214.4688; train_gene_expr_recon_loss: 3393620.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5557189.0000; train_optim_loss: 5557189.0000; val_kl_reg_loss: 1882.2393; val_edge_recon_loss: 2063995.6250; val_cat_covariates_contrastive_loss: 314030.1562; val_gene_expr_recon_loss: 3427048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806956.0000; val_optim_loss: 5806956.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8003; val_auprc_score: 0.9094; val_best_acc_score: 0.7752; val_best_f1_score: 0.8612; train_kl_reg_loss: 1895.0519; train_edge_recon_loss: 1793598.8750; train_cat_covariates_contrastive_loss: 358595.0625; train_gene_expr_recon_loss: 3392070.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5546159.0000; train_optim_loss: 5546159.0000; val_kl_reg_loss: 1829.0597; val_edge_recon_loss: 2037790.1250; val_cat_covariates_contrastive_loss: 314044.2812; val_gene_expr_recon_loss: 3427097.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5780760.5000; val_optim_loss: 5780760.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7993; val_auprc_score: 0.9038; val_best_acc_score: 0.7904; val_best_f1_score: 0.8683; train_kl_reg_loss: 1850.6165; train_edge_recon_loss: 1848119.0000; train_cat_covariates_contrastive_loss: 362778.4375; train_gene_expr_recon_loss: 3390481.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5603229.0000; train_optim_loss: 5603229.0000; val_kl_reg_loss: 1793.5989; val_edge_recon_loss: 2063815.6250; val_cat_covariates_contrastive_loss: 314103.7500; val_gene_expr_recon_loss: 3424592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5804305.0000; val_optim_loss: 5804305.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8374; val_auprc_score: 0.9429; val_best_acc_score: 0.8110; val_best_f1_score: 0.8822; train_kl_reg_loss: 1800.6366; train_edge_recon_loss: 1816262.6250; train_cat_covariates_contrastive_loss: 363169.9375; train_gene_expr_recon_loss: 3388746.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5569979.0000; train_optim_loss: 5569979.0000; val_kl_reg_loss: 1784.8035; val_edge_recon_loss: 1914738.3750; val_cat_covariates_contrastive_loss: 314072.0312; val_gene_expr_recon_loss: 3426774.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5657370.0000; val_optim_loss: 5657370.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8307; val_auprc_score: 0.9270; val_best_acc_score: 0.8020; val_best_f1_score: 0.8743; train_kl_reg_loss: 1799.5721; train_edge_recon_loss: 1874307.0000; train_cat_covariates_contrastive_loss: 364433.2500; train_gene_expr_recon_loss: 3387987.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5628527.0000; train_optim_loss: 5628527.0000; val_kl_reg_loss: 1772.0950; val_edge_recon_loss: 2083307.5000; val_cat_covariates_contrastive_loss: 313987.7188; val_gene_expr_recon_loss: 3421029.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820097.0000; val_optim_loss: 5820097.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8171; val_auprc_score: 0.9219; val_best_acc_score: 0.7916; val_best_f1_score: 0.8677; train_kl_reg_loss: 1795.3044; train_edge_recon_loss: 1836050.7500; train_cat_covariates_contrastive_loss: 365221.5000; train_gene_expr_recon_loss: 3388489.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5591557.0000; train_optim_loss: 5591557.0000; val_kl_reg_loss: 1764.8528; val_edge_recon_loss: 2128729.7500; val_cat_covariates_contrastive_loss: 314088.9062; val_gene_expr_recon_loss: 3416341.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5860925.0000; val_optim_loss: 5860925.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8219; val_auprc_score: 0.9268; val_best_acc_score: 0.8031; val_best_f1_score: 0.8773; train_kl_reg_loss: 1791.3357; train_edge_recon_loss: 1812869.0000; train_cat_covariates_contrastive_loss: 363550.7188; train_gene_expr_recon_loss: 3388417.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5566628.0000; train_optim_loss: 5566628.0000; val_kl_reg_loss: 1775.2351; val_edge_recon_loss: 1949177.8750; val_cat_covariates_contrastive_loss: 314053.1875; val_gene_expr_recon_loss: 3421134.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5686141.0000; val_optim_loss: 5686141.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8150; val_auprc_score: 0.9365; val_best_acc_score: 0.8076; val_best_f1_score: 0.8810; train_kl_reg_loss: 1788.1367; train_edge_recon_loss: 1838218.6250; train_cat_covariates_contrastive_loss: 362064.0625; train_gene_expr_recon_loss: 3388049.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5590120.0000; train_optim_loss: 5590120.0000; val_kl_reg_loss: 1772.3723; val_edge_recon_loss: 1880010.1250; val_cat_covariates_contrastive_loss: 314035.5000; val_gene_expr_recon_loss: 3425963.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5621782.0000; val_optim_loss: 5621782.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8038; val_auprc_score: 0.9311; val_best_acc_score: 0.7858; val_best_f1_score: 0.8677; train_kl_reg_loss: 1786.5596; train_edge_recon_loss: 1876396.8750; train_cat_covariates_contrastive_loss: 363280.5312; train_gene_expr_recon_loss: 3388060.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5629525.0000; train_optim_loss: 5629525.0000; val_kl_reg_loss: 1747.0664; val_edge_recon_loss: 1963267.3750; val_cat_covariates_contrastive_loss: 314119.2188; val_gene_expr_recon_loss: 3420861.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5699995.0000; val_optim_loss: 5699995.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8015; val_auprc_score: 0.9164; val_best_acc_score: 0.7902; val_best_f1_score: 0.8675; train_kl_reg_loss: 1781.4739; train_edge_recon_loss: 1787702.0000; train_cat_covariates_contrastive_loss: 362972.1250; train_gene_expr_recon_loss: 3387539.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5539995.0000; train_optim_loss: 5539995.0000; val_kl_reg_loss: 1734.9697; val_edge_recon_loss: 2090022.1250; val_cat_covariates_contrastive_loss: 314101.0312; val_gene_expr_recon_loss: 3416825.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5822684.0000; val_optim_loss: 5822684.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8131; val_auprc_score: 0.9315; val_best_acc_score: 0.7833; val_best_f1_score: 0.8652; train_kl_reg_loss: 1774.0974; train_edge_recon_loss: 1812624.3750; train_cat_covariates_contrastive_loss: 363554.5000; train_gene_expr_recon_loss: 3387202.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5565155.0000; train_optim_loss: 5565155.0000; val_kl_reg_loss: 1749.7375; val_edge_recon_loss: 2017315.8750; val_cat_covariates_contrastive_loss: 314142.2500; val_gene_expr_recon_loss: 3418152.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5751361.0000; val_optim_loss: 5751361.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8093; val_auprc_score: 0.9215; val_best_acc_score: 0.7922; val_best_f1_score: 0.8687; train_kl_reg_loss: 1773.8442; train_edge_recon_loss: 1840379.3750; train_cat_covariates_contrastive_loss: 364128.4688; train_gene_expr_recon_loss: 3387532.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5593814.0000; train_optim_loss: 5593814.0000; val_kl_reg_loss: 1768.3666; val_edge_recon_loss: 2083480.5000; val_cat_covariates_contrastive_loss: 313946.5312; val_gene_expr_recon_loss: 3421265.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820461.0000; val_optim_loss: 5820461.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7950; val_auprc_score: 0.9120; val_best_acc_score: 0.7926; val_best_f1_score: 0.8693; train_kl_reg_loss: 1768.0863; train_edge_recon_loss: 1855644.6250; train_cat_covariates_contrastive_loss: 364970.6562; train_gene_expr_recon_loss: 3387266.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5609649.5000; train_optim_loss: 5609649.5000; val_kl_reg_loss: 1747.9827; val_edge_recon_loss: 2064023.3750; val_cat_covariates_contrastive_loss: 314063.5938; val_gene_expr_recon_loss: 3413409.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5793244.5000; val_optim_loss: 5793244.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8092; val_auprc_score: 0.9178; val_best_acc_score: 0.7851; val_best_f1_score: 0.8640; train_kl_reg_loss: 1769.9153; train_edge_recon_loss: 1834253.3750; train_cat_covariates_contrastive_loss: 360856.0938; train_gene_expr_recon_loss: 3387173.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5584053.0000; train_optim_loss: 5584053.0000; val_kl_reg_loss: 1731.3220; val_edge_recon_loss: 2128934.5000; val_cat_covariates_contrastive_loss: 314072.3438; val_gene_expr_recon_loss: 3421094.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5865832.0000; val_optim_loss: 5865832.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8069; val_auprc_score: 0.9347; val_best_acc_score: 0.8041; val_best_f1_score: 0.8808; train_kl_reg_loss: 1763.2249; train_edge_recon_loss: 1843124.8750; train_cat_covariates_contrastive_loss: 364635.5312; train_gene_expr_recon_loss: 3386811.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5596335.0000; train_optim_loss: 5596335.0000; val_kl_reg_loss: 1747.6152; val_edge_recon_loss: 1765666.5000; val_cat_covariates_contrastive_loss: 314090.7812; val_gene_expr_recon_loss: 3421214.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5502719.5000; val_optim_loss: 5502719.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8208; val_auprc_score: 0.9312; val_best_acc_score: 0.7931; val_best_f1_score: 0.8717; train_kl_reg_loss: 1761.1814; train_edge_recon_loss: 1838675.1250; train_cat_covariates_contrastive_loss: 365702.6562; train_gene_expr_recon_loss: 3387300.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5593439.5000; train_optim_loss: 5593439.5000; val_kl_reg_loss: 1760.3567; val_edge_recon_loss: 1949064.0000; val_cat_covariates_contrastive_loss: 314101.2500; val_gene_expr_recon_loss: 3420271.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5685197.0000; val_optim_loss: 5685197.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8081; val_auprc_score: 0.9054; val_best_acc_score: 0.7825; val_best_f1_score: 0.8628; train_kl_reg_loss: 1768.6641; train_edge_recon_loss: 1863716.0000; train_cat_covariates_contrastive_loss: 363701.4688; train_gene_expr_recon_loss: 3387295.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5616481.0000; train_optim_loss: 5616481.0000; val_kl_reg_loss: 1756.3735; val_edge_recon_loss: 2116006.2500; val_cat_covariates_contrastive_loss: 314023.3750; val_gene_expr_recon_loss: 3426130.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5857917.0000; val_optim_loss: 5857917.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8263; val_auprc_score: 0.9390; val_best_acc_score: 0.8043; val_best_f1_score: 0.8784; train_kl_reg_loss: 1768.4481; train_edge_recon_loss: 1829106.3750; train_cat_covariates_contrastive_loss: 363758.4375; train_gene_expr_recon_loss: 3387291.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5581925.0000; train_optim_loss: 5581925.0000; val_kl_reg_loss: 1754.6429; val_edge_recon_loss: 1914722.3750; val_cat_covariates_contrastive_loss: 314059.9688; val_gene_expr_recon_loss: 3424676.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5655213.5000; val_optim_loss: 5655213.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8161; val_auprc_score: 0.9307; val_best_acc_score: 0.7927; val_best_f1_score: 0.8705; train_kl_reg_loss: 1766.3613; train_edge_recon_loss: 1848203.3750; train_cat_covariates_contrastive_loss: 363837.7188; train_gene_expr_recon_loss: 3387312.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5601120.0000; train_optim_loss: 5601120.0000; val_kl_reg_loss: 1742.3044; val_edge_recon_loss: 2003825.2500; val_cat_covariates_contrastive_loss: 314119.7812; val_gene_expr_recon_loss: 3421227.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5740914.0000; val_optim_loss: 5740914.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8194; val_auprc_score: 0.9250; val_best_acc_score: 0.7928; val_best_f1_score: 0.8699; train_kl_reg_loss: 1767.3759; train_edge_recon_loss: 1799458.1250; train_cat_covariates_contrastive_loss: 364738.7812; train_gene_expr_recon_loss: 3387112.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5553077.0000; train_optim_loss: 5553077.0000; val_kl_reg_loss: 1739.8822; val_edge_recon_loss: 2036770.0000; val_cat_covariates_contrastive_loss: 314090.5312; val_gene_expr_recon_loss: 3416788.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5769388.5000; val_optim_loss: 5769388.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8197; val_auprc_score: 0.9252; val_best_acc_score: 0.7989; val_best_f1_score: 0.8735; train_kl_reg_loss: 1765.7239; train_edge_recon_loss: 1846082.6250; train_cat_covariates_contrastive_loss: 364676.2812; train_gene_expr_recon_loss: 3386803.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5599328.0000; train_optim_loss: 5599328.0000; val_kl_reg_loss: 1737.7957; val_edge_recon_loss: 2023413.1250; val_cat_covariates_contrastive_loss: 314112.3750; val_gene_expr_recon_loss: 3420189.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5759452.0000; val_optim_loss: 5759452.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8234; val_auprc_score: 0.9348; val_best_acc_score: 0.8031; val_best_f1_score: 0.8760; train_kl_reg_loss: 1761.1763; train_edge_recon_loss: 1838713.2500; train_cat_covariates_contrastive_loss: 365051.4688; train_gene_expr_recon_loss: 3386852.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5592378.0000; train_optim_loss: 5592378.0000; val_kl_reg_loss: 1736.3586; val_edge_recon_loss: 2017051.7500; val_cat_covariates_contrastive_loss: 314102.4375; val_gene_expr_recon_loss: 3418603.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5751494.0000; val_optim_loss: 5751494.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8010; val_auprc_score: 0.9142; val_best_acc_score: 0.7772; val_best_f1_score: 0.8593; train_kl_reg_loss: 1769.0577; train_edge_recon_loss: 1825307.2500; train_cat_covariates_contrastive_loss: 361773.0938; train_gene_expr_recon_loss: 3387250.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5576099.0000; train_optim_loss: 5576099.0000; val_kl_reg_loss: 1741.8977; val_edge_recon_loss: 2148347.5000; val_cat_covariates_contrastive_loss: 314068.2812; val_gene_expr_recon_loss: 3416878.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5881036.0000; val_optim_loss: 5881036.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 19 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.8242
val AUPRC score: 0.9331
val best accuracy score: 0.7951
val best F1 score: 0.8723
val target rna MSE score: 1.2996
val source rna MSE score: 0.7162
Val cat covariate0 mean sim diff: -0.0003
Duration of model training in run 2: 0 hours, 0 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8344; val_auprc_score: 0.9275; val_best_acc_score: 0.7787; val_best_f1_score: 0.8596; train_kl_reg_loss: 50.4022; train_edge_recon_loss: 1729575.2500; train_cat_covariates_contrastive_loss: 663970.5625; train_gene_expr_recon_loss: 3662165.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6055761.0000; train_optim_loss: 6055761.0000; val_kl_reg_loss: 122.2882; val_edge_recon_loss: 2164487.5000; val_cat_covariates_contrastive_loss: 327730.4062; val_gene_expr_recon_loss: 3562789.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6055130.0000; val_optim_loss: 6055130.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8295; val_auprc_score: 0.9363; val_best_acc_score: 0.7845; val_best_f1_score: 0.8684; train_kl_reg_loss: 125.4081; train_edge_recon_loss: 1738394.2500; train_cat_covariates_contrastive_loss: 652910.1250; train_gene_expr_recon_loss: 3585890.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5977320.0000; train_optim_loss: 5977320.0000; val_kl_reg_loss: 378.4239; val_edge_recon_loss: 2036680.2500; val_cat_covariates_contrastive_loss: 317570.2500; val_gene_expr_recon_loss: 3530306.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5884935.0000; val_optim_loss: 5884935.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8214; val_auprc_score: 0.9233; val_best_acc_score: 0.7368; val_best_f1_score: 0.8484; train_kl_reg_loss: 388.9299; train_edge_recon_loss: 1701221.3750; train_cat_covariates_contrastive_loss: 602826.6250; train_gene_expr_recon_loss: 3549688.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5854125.5000; train_optim_loss: 5854125.5000; val_kl_reg_loss: 933.0706; val_edge_recon_loss: 2132921.0000; val_cat_covariates_contrastive_loss: 314909.6562; val_gene_expr_recon_loss: 3620938.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6069702.5000; val_optim_loss: 6069702.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8100; val_auprc_score: 0.9300; val_best_acc_score: 0.7726; val_best_f1_score: 0.8717; train_kl_reg_loss: 958.1476; train_edge_recon_loss: 1774737.5000; train_cat_covariates_contrastive_loss: 499969.2188; train_gene_expr_recon_loss: 3633542.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5909207.0000; train_optim_loss: 5909207.0000; val_kl_reg_loss: 975.5410; val_edge_recon_loss: 1842593.5000; val_cat_covariates_contrastive_loss: 314911.6875; val_gene_expr_recon_loss: 3494879.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5653360.0000; val_optim_loss: 5653360.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8108; val_auprc_score: 0.9219; val_best_acc_score: 0.7344; val_best_f1_score: 0.8469; train_kl_reg_loss: 1004.3411; train_edge_recon_loss: 1766810.0000; train_cat_covariates_contrastive_loss: 475215.0625; train_gene_expr_recon_loss: 3506188.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5749218.0000; train_optim_loss: 5749218.0000; val_kl_reg_loss: 1164.3617; val_edge_recon_loss: 2153233.2500; val_cat_covariates_contrastive_loss: 314622.1562; val_gene_expr_recon_loss: 3474160.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5943180.0000; val_optim_loss: 5943180.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8316; val_auprc_score: 0.9358; val_best_acc_score: 0.7775; val_best_f1_score: 0.8490; train_kl_reg_loss: 1197.8770; train_edge_recon_loss: 1751698.1250; train_cat_covariates_contrastive_loss: 443008.7188; train_gene_expr_recon_loss: 3488005.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5683910.0000; train_optim_loss: 5683910.0000; val_kl_reg_loss: 1492.2169; val_edge_recon_loss: 2128803.7500; val_cat_covariates_contrastive_loss: 314394.1250; val_gene_expr_recon_loss: 3474474.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5919164.0000; val_optim_loss: 5919164.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8211; val_auprc_score: 0.9336; val_best_acc_score: 0.7834; val_best_f1_score: 0.8649; train_kl_reg_loss: 1535.5571; train_edge_recon_loss: 1731445.0000; train_cat_covariates_contrastive_loss: 401022.0938; train_gene_expr_recon_loss: 3482479.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5616481.5000; train_optim_loss: 5616481.5000; val_kl_reg_loss: 1867.1221; val_edge_recon_loss: 2051208.0000; val_cat_covariates_contrastive_loss: 314112.1562; val_gene_expr_recon_loss: 3472122.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5839310.0000; val_optim_loss: 5839310.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8216; val_auprc_score: 0.9323; val_best_acc_score: 0.7953; val_best_f1_score: 0.8764; train_kl_reg_loss: 1928.1139; train_edge_recon_loss: 1821933.0000; train_cat_covariates_contrastive_loss: 371474.5312; train_gene_expr_recon_loss: 3477681.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5673017.0000; train_optim_loss: 5673017.0000; val_kl_reg_loss: 2164.0815; val_edge_recon_loss: 1915872.7500; val_cat_covariates_contrastive_loss: 313986.2188; val_gene_expr_recon_loss: 3464667.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5696690.5000; val_optim_loss: 5696690.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8226; val_auprc_score: 0.9304; val_best_acc_score: 0.7855; val_best_f1_score: 0.8694; train_kl_reg_loss: 2224.8901; train_edge_recon_loss: 1885638.6250; train_cat_covariates_contrastive_loss: 355657.0000; train_gene_expr_recon_loss: 3470567.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5714088.0000; train_optim_loss: 5714088.0000; val_kl_reg_loss: 2169.4934; val_edge_recon_loss: 2018218.5000; val_cat_covariates_contrastive_loss: 314050.0312; val_gene_expr_recon_loss: 3459684.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5794122.5000; val_optim_loss: 5794122.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8242; val_auprc_score: 0.9302; val_best_acc_score: 0.7803; val_best_f1_score: 0.8648; train_kl_reg_loss: 2236.3750; train_edge_recon_loss: 1839016.8750; train_cat_covariates_contrastive_loss: 354227.1875; train_gene_expr_recon_loss: 3469504.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5664985.0000; train_optim_loss: 5664985.0000; val_kl_reg_loss: 2167.1296; val_edge_recon_loss: 2117256.0000; val_cat_covariates_contrastive_loss: 314018.5000; val_gene_expr_recon_loss: 3469282.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5902724.0000; val_optim_loss: 5902724.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8224; val_auprc_score: 0.9341; val_best_acc_score: 0.7825; val_best_f1_score: 0.8688; train_kl_reg_loss: 2231.4971; train_edge_recon_loss: 1901094.5000; train_cat_covariates_contrastive_loss: 355792.5000; train_gene_expr_recon_loss: 3467620.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5726738.5000; train_optim_loss: 5726738.5000; val_kl_reg_loss: 2133.1929; val_edge_recon_loss: 1964125.6250; val_cat_covariates_contrastive_loss: 314023.3438; val_gene_expr_recon_loss: 3450019.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5730302.0000; val_optim_loss: 5730302.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8203; val_auprc_score: 0.9357; val_best_acc_score: 0.7796; val_best_f1_score: 0.8657; train_kl_reg_loss: 2217.3052; train_edge_recon_loss: 1883131.3750; train_cat_covariates_contrastive_loss: 354380.0625; train_gene_expr_recon_loss: 3466066.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5705795.0000; train_optim_loss: 5705795.0000; val_kl_reg_loss: 2133.1826; val_edge_recon_loss: 2038321.2500; val_cat_covariates_contrastive_loss: 314023.0000; val_gene_expr_recon_loss: 3462357.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5816835.0000; val_optim_loss: 5816835.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.8151
val AUPRC score: 0.9378
val best accuracy score: 0.7564
val best F1 score: 0.8613
val target rna MSE score: 2.4268
val source rna MSE score: 0.7256
Val cat covariate0 mean sim diff: -0.0004
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
