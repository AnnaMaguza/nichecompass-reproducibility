Run timestamp: 02092023_232258_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9465; val_auprc_score: 0.9767; val_best_acc_score: 0.7879; val_best_f1_score: 0.8764; train_kl_reg_loss: 687.9839; train_edge_recon_loss: 1758023.8958; train_cat_covariates_contrastive_loss: 1114149.2396; train_gene_expr_recon_loss: 3675369.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6548230.2500; train_optim_loss: 6548230.2500; val_kl_reg_loss: 2041.9222; val_edge_recon_loss: 2011332.6250; val_cat_covariates_contrastive_loss: 627128.8125; val_gene_expr_recon_loss: 3498066.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6138570.0000; val_optim_loss: 6138570.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9449; val_auprc_score: 0.9757; val_best_acc_score: 0.7488; val_best_f1_score: 0.8563; train_kl_reg_loss: 3977.0505; train_edge_recon_loss: 1939235.9167; train_cat_covariates_contrastive_loss: 675356.0208; train_gene_expr_recon_loss: 3459645.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6078214.5000; train_optim_loss: 6078214.5000; val_kl_reg_loss: 5727.3618; val_edge_recon_loss: 2042197.0000; val_cat_covariates_contrastive_loss: 626745.6250; val_gene_expr_recon_loss: 3354031.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6028702.0000; val_optim_loss: 6028702.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9281; val_auprc_score: 0.9678; val_best_acc_score: 0.7522; val_best_f1_score: 0.8586; train_kl_reg_loss: 5961.7874; train_edge_recon_loss: 2013123.6250; train_cat_covariates_contrastive_loss: 635117.3542; train_gene_expr_recon_loss: 3305472.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5959675.4167; train_optim_loss: 5959675.4167; val_kl_reg_loss: 5205.5259; val_edge_recon_loss: 2014067.6250; val_cat_covariates_contrastive_loss: 626739.7500; val_gene_expr_recon_loss: 3223552.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5869566.0000; val_optim_loss: 5869566.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9138; val_auprc_score: 0.9619; val_best_acc_score: 0.7886; val_best_f1_score: 0.8753; train_kl_reg_loss: 4023.0898; train_edge_recon_loss: 1926895.0833; train_cat_covariates_contrastive_loss: 659086.8021; train_gene_expr_recon_loss: 3206897.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5796902.5000; train_optim_loss: 5796902.5000; val_kl_reg_loss: 2259.4849; val_edge_recon_loss: 2080554.8750; val_cat_covariates_contrastive_loss: 626948.5000; val_gene_expr_recon_loss: 3157160.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5866923.5000; val_optim_loss: 5866923.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8892; val_auprc_score: 0.9588; val_best_acc_score: 0.8065; val_best_f1_score: 0.8838; train_kl_reg_loss: 2313.9231; train_edge_recon_loss: 1843744.0833; train_cat_covariates_contrastive_loss: 707736.5625; train_gene_expr_recon_loss: 3136018.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5689812.5833; train_optim_loss: 5689812.5833; val_kl_reg_loss: 2657.6719; val_edge_recon_loss: 2040823.5000; val_cat_covariates_contrastive_loss: 626920.8125; val_gene_expr_recon_loss: 3064886.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5735288.5000; val_optim_loss: 5735288.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8420; val_auprc_score: 0.9382; val_best_acc_score: 0.7989; val_best_f1_score: 0.8777; train_kl_reg_loss: 2858.5332; train_edge_recon_loss: 1833251.1875; train_cat_covariates_contrastive_loss: 679590.0208; train_gene_expr_recon_loss: 3051134.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5566834.4167; train_optim_loss: 5566834.4167; val_kl_reg_loss: 2500.5259; val_edge_recon_loss: 2016931.0000; val_cat_covariates_contrastive_loss: 627105.9375; val_gene_expr_recon_loss: 2986934.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5633472.0000; val_optim_loss: 5633472.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7960; val_auprc_score: 0.9207; val_best_acc_score: 0.7973; val_best_f1_score: 0.8793; train_kl_reg_loss: 2953.0022; train_edge_recon_loss: 1814687.5208; train_cat_covariates_contrastive_loss: 679871.2083; train_gene_expr_recon_loss: 2983833.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5481345.1667; train_optim_loss: 5481345.1667; val_kl_reg_loss: 3305.2185; val_edge_recon_loss: 1919879.5000; val_cat_covariates_contrastive_loss: 627203.3750; val_gene_expr_recon_loss: 2920471.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5470859.0000; val_optim_loss: 5470859.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7964; val_auprc_score: 0.9125; val_best_acc_score: 0.7989; val_best_f1_score: 0.8776; train_kl_reg_loss: 3913.9314; train_edge_recon_loss: 1804554.7083; train_cat_covariates_contrastive_loss: 660386.0938; train_gene_expr_recon_loss: 2916151.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5385005.8333; train_optim_loss: 5385005.8333; val_kl_reg_loss: 4179.7783; val_edge_recon_loss: 1963793.8750; val_cat_covariates_contrastive_loss: 627346.8125; val_gene_expr_recon_loss: 2869082.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5464403.0000; val_optim_loss: 5464403.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7921; val_auprc_score: 0.9123; val_best_acc_score: 0.7985; val_best_f1_score: 0.8752; train_kl_reg_loss: 5106.6687; train_edge_recon_loss: 1776681.6250; train_cat_covariates_contrastive_loss: 659350.6562; train_gene_expr_recon_loss: 2868424.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5309563.0833; train_optim_loss: 5309563.0833; val_kl_reg_loss: 5865.6348; val_edge_recon_loss: 1951440.3750; val_cat_covariates_contrastive_loss: 627592.2500; val_gene_expr_recon_loss: 2807017.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5391915.0000; val_optim_loss: 5391915.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7827; val_auprc_score: 0.9015; val_best_acc_score: 0.8109; val_best_f1_score: 0.8824; train_kl_reg_loss: 7295.3698; train_edge_recon_loss: 1781927.9167; train_cat_covariates_contrastive_loss: 647655.4167; train_gene_expr_recon_loss: 2810481.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247360.5833; train_optim_loss: 5247360.5833; val_kl_reg_loss: 8391.5488; val_edge_recon_loss: 1858879.6250; val_cat_covariates_contrastive_loss: 627279.8750; val_gene_expr_recon_loss: 2766808.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5261359.0000; val_optim_loss: 5261359.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8006; val_auprc_score: 0.9054; val_best_acc_score: 0.8118; val_best_f1_score: 0.8808; train_kl_reg_loss: 9589.1608; train_edge_recon_loss: 1769946.8125; train_cat_covariates_contrastive_loss: 656342.3750; train_gene_expr_recon_loss: 2767370.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203248.8333; train_optim_loss: 5203248.8333; val_kl_reg_loss: 9974.8936; val_edge_recon_loss: 1911295.5000; val_cat_covariates_contrastive_loss: 627451.3125; val_gene_expr_recon_loss: 2733038.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5281760.0000; val_optim_loss: 5281760.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7699; val_auprc_score: 0.8930; val_best_acc_score: 0.8047; val_best_f1_score: 0.8802; train_kl_reg_loss: 11117.9583; train_edge_recon_loss: 1742947.2500; train_cat_covariates_contrastive_loss: 652203.3750; train_gene_expr_recon_loss: 2726802.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5133070.4167; train_optim_loss: 5133070.4167; val_kl_reg_loss: 11704.3467; val_edge_recon_loss: 1845382.2500; val_cat_covariates_contrastive_loss: 627518.8125; val_gene_expr_recon_loss: 2702341.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5186946.5000; val_optim_loss: 5186946.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7896; val_auprc_score: 0.9057; val_best_acc_score: 0.8156; val_best_f1_score: 0.8871; train_kl_reg_loss: 12403.1888; train_edge_recon_loss: 1707483.6667; train_cat_covariates_contrastive_loss: 650171.9167; train_gene_expr_recon_loss: 2704850.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5074909.1667; train_optim_loss: 5074909.1667; val_kl_reg_loss: 11746.1230; val_edge_recon_loss: 1722238.1250; val_cat_covariates_contrastive_loss: 627169.3750; val_gene_expr_recon_loss: 2684003.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5045156.5000; val_optim_loss: 5045156.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7509; val_auprc_score: 0.8890; val_best_acc_score: 0.8085; val_best_f1_score: 0.8843; train_kl_reg_loss: 12777.6541; train_edge_recon_loss: 1663036.9792; train_cat_covariates_contrastive_loss: 642390.7917; train_gene_expr_recon_loss: 2694414.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5012619.9167; train_optim_loss: 5012619.9167; val_kl_reg_loss: 12450.4902; val_edge_recon_loss: 1673815.5000; val_cat_covariates_contrastive_loss: 627211.3750; val_gene_expr_recon_loss: 2677674.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4991152.0000; val_optim_loss: 4991152.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7773; val_auprc_score: 0.9018; val_best_acc_score: 0.8093; val_best_f1_score: 0.8855; train_kl_reg_loss: 14381.4585; train_edge_recon_loss: 1610764.8958; train_cat_covariates_contrastive_loss: 637891.8229; train_gene_expr_recon_loss: 2691733.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4954771.7500; train_optim_loss: 4954771.7500; val_kl_reg_loss: 14736.7012; val_edge_recon_loss: 1581698.3750; val_cat_covariates_contrastive_loss: 627037.8750; val_gene_expr_recon_loss: 2668526.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4891999.5000; val_optim_loss: 4891999.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7618; val_auprc_score: 0.8948; val_best_acc_score: 0.8164; val_best_f1_score: 0.8897; train_kl_reg_loss: 16441.0775; train_edge_recon_loss: 1588960.5417; train_cat_covariates_contrastive_loss: 633453.0417; train_gene_expr_recon_loss: 2675159.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4914014.2500; train_optim_loss: 4914014.2500; val_kl_reg_loss: 16464.7109; val_edge_recon_loss: 1529542.7500; val_cat_covariates_contrastive_loss: 627054.6875; val_gene_expr_recon_loss: 2659715.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4832777.5000; val_optim_loss: 4832777.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7769; val_auprc_score: 0.8955; val_best_acc_score: 0.8059; val_best_f1_score: 0.8808; train_kl_reg_loss: 18497.5788; train_edge_recon_loss: 1560097.1875; train_cat_covariates_contrastive_loss: 631591.3333; train_gene_expr_recon_loss: 2662753.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4872939.3333; train_optim_loss: 4872939.3333; val_kl_reg_loss: 18178.9668; val_edge_recon_loss: 1596161.6250; val_cat_covariates_contrastive_loss: 626891.5625; val_gene_expr_recon_loss: 2638681.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4879914.0000; val_optim_loss: 4879914.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7716; val_auprc_score: 0.8973; val_best_acc_score: 0.8086; val_best_f1_score: 0.8832; train_kl_reg_loss: 18968.0075; train_edge_recon_loss: 1562371.9375; train_cat_covariates_contrastive_loss: 630995.3438; train_gene_expr_recon_loss: 2643553.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855888.7500; train_optim_loss: 4855888.7500; val_kl_reg_loss: 18084.1836; val_edge_recon_loss: 1603898.2500; val_cat_covariates_contrastive_loss: 626931.6875; val_gene_expr_recon_loss: 2621826.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870740.5000; val_optim_loss: 4870740.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7797; val_auprc_score: 0.9029; val_best_acc_score: 0.8169; val_best_f1_score: 0.8902; train_kl_reg_loss: 19103.8320; train_edge_recon_loss: 1539925.3958; train_cat_covariates_contrastive_loss: 630592.6458; train_gene_expr_recon_loss: 2628932.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4818554.8333; train_optim_loss: 4818554.8333; val_kl_reg_loss: 18224.9766; val_edge_recon_loss: 1499806.6250; val_cat_covariates_contrastive_loss: 627043.5625; val_gene_expr_recon_loss: 2612209.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4757284.0000; val_optim_loss: 4757284.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7799; val_auprc_score: 0.9038; val_best_acc_score: 0.8179; val_best_f1_score: 0.8899; train_kl_reg_loss: 18910.8506; train_edge_recon_loss: 1555168.7292; train_cat_covariates_contrastive_loss: 630257.6146; train_gene_expr_recon_loss: 2620078.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824416.0000; train_optim_loss: 4824416.0000; val_kl_reg_loss: 17235.3320; val_edge_recon_loss: 1527196.7500; val_cat_covariates_contrastive_loss: 626963.6250; val_gene_expr_recon_loss: 2603590.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4774986.0000; val_optim_loss: 4774986.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7975; val_auprc_score: 0.9164; val_best_acc_score: 0.8207; val_best_f1_score: 0.8918; train_kl_reg_loss: 18162.9808; train_edge_recon_loss: 1531845.9375; train_cat_covariates_contrastive_loss: 630839.1042; train_gene_expr_recon_loss: 2609102.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4789950.8333; train_optim_loss: 4789950.8333; val_kl_reg_loss: 17497.2500; val_edge_recon_loss: 1496245.1250; val_cat_covariates_contrastive_loss: 627026.0000; val_gene_expr_recon_loss: 2598608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739376.5000; val_optim_loss: 4739376.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8089; val_auprc_score: 0.9171; val_best_acc_score: 0.8192; val_best_f1_score: 0.8902; train_kl_reg_loss: 17743.3483; train_edge_recon_loss: 1530375.7917; train_cat_covariates_contrastive_loss: 630566.0417; train_gene_expr_recon_loss: 2602084.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4780769.7500; train_optim_loss: 4780769.7500; val_kl_reg_loss: 17068.9219; val_edge_recon_loss: 1540734.0000; val_cat_covariates_contrastive_loss: 627215.5000; val_gene_expr_recon_loss: 2584165.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4769184.0000; val_optim_loss: 4769184.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8098; val_auprc_score: 0.9166; val_best_acc_score: 0.8247; val_best_f1_score: 0.8930; train_kl_reg_loss: 17241.6011; train_edge_recon_loss: 1526726.4792; train_cat_covariates_contrastive_loss: 630883.5417; train_gene_expr_recon_loss: 2597518.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4772369.7500; train_optim_loss: 4772369.7500; val_kl_reg_loss: 16531.8105; val_edge_recon_loss: 1530971.8750; val_cat_covariates_contrastive_loss: 627056.4375; val_gene_expr_recon_loss: 2580818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4755378.0000; val_optim_loss: 4755378.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8030; val_auprc_score: 0.9086; val_best_acc_score: 0.8295; val_best_f1_score: 0.8959; train_kl_reg_loss: 17156.7292; train_edge_recon_loss: 1506863.0000; train_cat_covariates_contrastive_loss: 630358.3021; train_gene_expr_recon_loss: 2589231.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4743609.3333; train_optim_loss: 4743609.3333; val_kl_reg_loss: 17049.8418; val_edge_recon_loss: 1519344.8750; val_cat_covariates_contrastive_loss: 627084.3125; val_gene_expr_recon_loss: 2574693.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4738172.0000; val_optim_loss: 4738172.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8239; val_auprc_score: 0.9215; val_best_acc_score: 0.8309; val_best_f1_score: 0.8961; train_kl_reg_loss: 17036.6781; train_edge_recon_loss: 1487827.6667; train_cat_covariates_contrastive_loss: 630497.3646; train_gene_expr_recon_loss: 2583282.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4718643.9167; train_optim_loss: 4718643.9167; val_kl_reg_loss: 15508.7920; val_edge_recon_loss: 1514802.2500; val_cat_covariates_contrastive_loss: 627033.8750; val_gene_expr_recon_loss: 2567543.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4724889.0000; val_optim_loss: 4724889.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8189; val_auprc_score: 0.9198; val_best_acc_score: 0.8317; val_best_f1_score: 0.8973; train_kl_reg_loss: 16774.0130; train_edge_recon_loss: 1486542.5000; train_cat_covariates_contrastive_loss: 630489.1875; train_gene_expr_recon_loss: 2577216.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4711021.5000; train_optim_loss: 4711021.5000; val_kl_reg_loss: 15788.1055; val_edge_recon_loss: 1511204.5000; val_cat_covariates_contrastive_loss: 627385.2500; val_gene_expr_recon_loss: 2559698.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4714076.5000; val_optim_loss: 4714076.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8345; val_auprc_score: 0.9232; val_best_acc_score: 0.8346; val_best_f1_score: 0.8977; train_kl_reg_loss: 15486.8647; train_edge_recon_loss: 1499297.2083; train_cat_covariates_contrastive_loss: 630756.6562; train_gene_expr_recon_loss: 2573534.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719075.4167; train_optim_loss: 4719075.4167; val_kl_reg_loss: 14660.3730; val_edge_recon_loss: 1521953.3750; val_cat_covariates_contrastive_loss: 627182.3125; val_gene_expr_recon_loss: 2559054.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4722851.0000; val_optim_loss: 4722851.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8567; val_auprc_score: 0.9357; val_best_acc_score: 0.8486; val_best_f1_score: 0.9063; train_kl_reg_loss: 14814.1821; train_edge_recon_loss: 1475392.0000; train_cat_covariates_contrastive_loss: 631000.1875; train_gene_expr_recon_loss: 2569043.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4690250.2500; train_optim_loss: 4690250.2500; val_kl_reg_loss: 14252.3652; val_edge_recon_loss: 1454437.6250; val_cat_covariates_contrastive_loss: 627292.6250; val_gene_expr_recon_loss: 2559917.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4655900.0000; val_optim_loss: 4655900.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8528; val_auprc_score: 0.9318; val_best_acc_score: 0.8436; val_best_f1_score: 0.9029; train_kl_reg_loss: 14048.1022; train_edge_recon_loss: 1467727.6667; train_cat_covariates_contrastive_loss: 631308.4167; train_gene_expr_recon_loss: 2565308.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4678392.1667; train_optim_loss: 4678392.1667; val_kl_reg_loss: 13694.0605; val_edge_recon_loss: 1486497.5000; val_cat_covariates_contrastive_loss: 627638.8750; val_gene_expr_recon_loss: 2554936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4682766.5000; val_optim_loss: 4682766.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8586; val_auprc_score: 0.9352; val_best_acc_score: 0.8517; val_best_f1_score: 0.9079; train_kl_reg_loss: 14025.8200; train_edge_recon_loss: 1442089.6250; train_cat_covariates_contrastive_loss: 630730.7292; train_gene_expr_recon_loss: 2566054.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4652900.3333; train_optim_loss: 4652900.3333; val_kl_reg_loss: 13267.7979; val_edge_recon_loss: 1450764.6250; val_cat_covariates_contrastive_loss: 627829.5000; val_gene_expr_recon_loss: 2548699.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4640561.0000; val_optim_loss: 4640561.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8576; val_auprc_score: 0.9322; val_best_acc_score: 0.8573; val_best_f1_score: 0.9104; train_kl_reg_loss: 13993.4019; train_edge_recon_loss: 1429786.8750; train_cat_covariates_contrastive_loss: 630526.9375; train_gene_expr_recon_loss: 2563851.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4638158.6667; train_optim_loss: 4638158.6667; val_kl_reg_loss: 14069.9961; val_edge_recon_loss: 1425430.6250; val_cat_covariates_contrastive_loss: 629089.8750; val_gene_expr_recon_loss: 2551223.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4619814.0000; val_optim_loss: 4619814.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8612; val_auprc_score: 0.9396; val_best_acc_score: 0.8659; val_best_f1_score: 0.9166; train_kl_reg_loss: 14420.9198; train_edge_recon_loss: 1419431.0417; train_cat_covariates_contrastive_loss: 630199.6979; train_gene_expr_recon_loss: 2558290.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4622341.7500; train_optim_loss: 4622341.7500; val_kl_reg_loss: 15603.1592; val_edge_recon_loss: 1392155.2500; val_cat_covariates_contrastive_loss: 628720.1875; val_gene_expr_recon_loss: 2550173.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4586651.5000; val_optim_loss: 4586651.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8676; val_auprc_score: 0.9373; val_best_acc_score: 0.8705; val_best_f1_score: 0.9170; train_kl_reg_loss: 15433.3521; train_edge_recon_loss: 1414750.6667; train_cat_covariates_contrastive_loss: 630086.1979; train_gene_expr_recon_loss: 2557305.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4617575.7500; train_optim_loss: 4617575.7500; val_kl_reg_loss: 15064.3555; val_edge_recon_loss: 1452305.5000; val_cat_covariates_contrastive_loss: 628908.1250; val_gene_expr_recon_loss: 2538136.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4634414.5000; val_optim_loss: 4634414.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8704; val_auprc_score: 0.9454; val_best_acc_score: 0.8738; val_best_f1_score: 0.9215; train_kl_reg_loss: 15594.7140; train_edge_recon_loss: 1412244.6042; train_cat_covariates_contrastive_loss: 630254.2604; train_gene_expr_recon_loss: 2545395.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4603489.2500; train_optim_loss: 4603489.2500; val_kl_reg_loss: 14727.9023; val_edge_recon_loss: 1360054.8750; val_cat_covariates_contrastive_loss: 628962.0000; val_gene_expr_recon_loss: 2542629.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4546374.0000; val_optim_loss: 4546374.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8781; val_auprc_score: 0.9388; val_best_acc_score: 0.8701; val_best_f1_score: 0.9176; train_kl_reg_loss: 15085.8618; train_edge_recon_loss: 1415671.1250; train_cat_covariates_contrastive_loss: 630474.7812; train_gene_expr_recon_loss: 2542460.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4603692.1667; train_optim_loss: 4603692.1667; val_kl_reg_loss: 15185.3564; val_edge_recon_loss: 1447461.0000; val_cat_covariates_contrastive_loss: 628565.8750; val_gene_expr_recon_loss: 2537323.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4628535.0000; val_optim_loss: 4628535.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8690; val_auprc_score: 0.9418; val_best_acc_score: 0.8741; val_best_f1_score: 0.9208; train_kl_reg_loss: 15119.1704; train_edge_recon_loss: 1394969.6042; train_cat_covariates_contrastive_loss: 630773.0521; train_gene_expr_recon_loss: 2538963.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4579825.0000; train_optim_loss: 4579825.0000; val_kl_reg_loss: 15136.8711; val_edge_recon_loss: 1398170.0000; val_cat_covariates_contrastive_loss: 628921.1875; val_gene_expr_recon_loss: 2532066.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4574294.0000; val_optim_loss: 4574294.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8736; val_auprc_score: 0.9328; val_best_acc_score: 0.8768; val_best_f1_score: 0.9222; train_kl_reg_loss: 15249.4943; train_edge_recon_loss: 1376520.7500; train_cat_covariates_contrastive_loss: 630841.3958; train_gene_expr_recon_loss: 2535148.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4557759.7500; train_optim_loss: 4557759.7500; val_kl_reg_loss: 14484.2695; val_edge_recon_loss: 1392853.2500; val_cat_covariates_contrastive_loss: 629329.1875; val_gene_expr_recon_loss: 2524603.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4561270.0000; val_optim_loss: 4561270.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8644; val_auprc_score: 0.9313; val_best_acc_score: 0.8688; val_best_f1_score: 0.9168; train_kl_reg_loss: 15418.2757; train_edge_recon_loss: 1384331.2708; train_cat_covariates_contrastive_loss: 630832.2812; train_gene_expr_recon_loss: 2531976.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4562558.6667; train_optim_loss: 4562558.6667; val_kl_reg_loss: 15221.3750; val_edge_recon_loss: 1454800.8750; val_cat_covariates_contrastive_loss: 629851.5000; val_gene_expr_recon_loss: 2527262.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4627136.0000; val_optim_loss: 4627136.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8808; val_auprc_score: 0.9429; val_best_acc_score: 0.8840; val_best_f1_score: 0.9270; train_kl_reg_loss: 15448.5117; train_edge_recon_loss: 1410824.2500; train_cat_covariates_contrastive_loss: 630555.3333; train_gene_expr_recon_loss: 2530793.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4587621.4167; train_optim_loss: 4587621.4167; val_kl_reg_loss: 15203.7559; val_edge_recon_loss: 1372259.7500; val_cat_covariates_contrastive_loss: 629136.6250; val_gene_expr_recon_loss: 2528055.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4544655.5000; val_optim_loss: 4544655.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8767; val_auprc_score: 0.9402; val_best_acc_score: 0.8789; val_best_f1_score: 0.9244; train_kl_reg_loss: 15328.6815; train_edge_recon_loss: 1390280.3542; train_cat_covariates_contrastive_loss: 630939.6250; train_gene_expr_recon_loss: 2529033.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4565581.8333; train_optim_loss: 4565581.8333; val_kl_reg_loss: 14978.2871; val_edge_recon_loss: 1366276.8750; val_cat_covariates_contrastive_loss: 629961.3125; val_gene_expr_recon_loss: 2524616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4535832.5000; val_optim_loss: 4535832.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8802; val_auprc_score: 0.9460; val_best_acc_score: 0.8782; val_best_f1_score: 0.9230; train_kl_reg_loss: 15277.7132; train_edge_recon_loss: 1385080.3125; train_cat_covariates_contrastive_loss: 630950.4688; train_gene_expr_recon_loss: 2527066.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558374.5833; train_optim_loss: 4558374.5833; val_kl_reg_loss: 14934.1719; val_edge_recon_loss: 1362753.7500; val_cat_covariates_contrastive_loss: 629644.3750; val_gene_expr_recon_loss: 2519608.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4526941.0000; val_optim_loss: 4526941.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8824; val_auprc_score: 0.9430; val_best_acc_score: 0.8860; val_best_f1_score: 0.9278; train_kl_reg_loss: 15439.7142; train_edge_recon_loss: 1380210.7917; train_cat_covariates_contrastive_loss: 631010.4583; train_gene_expr_recon_loss: 2534335.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560996.0833; train_optim_loss: 4560996.0833; val_kl_reg_loss: 15318.0615; val_edge_recon_loss: 1366601.8750; val_cat_covariates_contrastive_loss: 628734.6250; val_gene_expr_recon_loss: 2522206.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4532861.0000; val_optim_loss: 4532861.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8867; val_auprc_score: 0.9434; val_best_acc_score: 0.8850; val_best_f1_score: 0.9268; train_kl_reg_loss: 15503.6579; train_edge_recon_loss: 1383396.8750; train_cat_covariates_contrastive_loss: 630831.3333; train_gene_expr_recon_loss: 2531658.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4561390.5000; train_optim_loss: 4561390.5000; val_kl_reg_loss: 15318.5137; val_edge_recon_loss: 1375992.8750; val_cat_covariates_contrastive_loss: 629846.1250; val_gene_expr_recon_loss: 2522010.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4543168.0000; val_optim_loss: 4543168.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8817; val_auprc_score: 0.9415; val_best_acc_score: 0.8773; val_best_f1_score: 0.9214; train_kl_reg_loss: 15505.1532; train_edge_recon_loss: 1387312.6875; train_cat_covariates_contrastive_loss: 630825.7396; train_gene_expr_recon_loss: 2530802.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4564445.9167; train_optim_loss: 4564445.9167; val_kl_reg_loss: 15038.1133; val_edge_recon_loss: 1419262.6250; val_cat_covariates_contrastive_loss: 629090.3750; val_gene_expr_recon_loss: 2514510.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4577901.5000; val_optim_loss: 4577901.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8794; val_auprc_score: 0.9397; val_best_acc_score: 0.8807; val_best_f1_score: 0.9235; train_kl_reg_loss: 15385.9723; train_edge_recon_loss: 1391409.3542; train_cat_covariates_contrastive_loss: 630792.4167; train_gene_expr_recon_loss: 2525222.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4562810.0833; train_optim_loss: 4562810.0833; val_kl_reg_loss: 15012.2598; val_edge_recon_loss: 1410003.6250; val_cat_covariates_contrastive_loss: 629233.6875; val_gene_expr_recon_loss: 2516810.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4571060.0000; val_optim_loss: 4571060.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8794; val_auprc_score: 0.9420; val_best_acc_score: 0.8858; val_best_f1_score: 0.9272; train_kl_reg_loss: 15364.2188; train_edge_recon_loss: 1381513.2708; train_cat_covariates_contrastive_loss: 630973.6667; train_gene_expr_recon_loss: 2523561.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4551412.7500; train_optim_loss: 4551412.7500; val_kl_reg_loss: 15157.0176; val_edge_recon_loss: 1383410.3750; val_cat_covariates_contrastive_loss: 629394.6250; val_gene_expr_recon_loss: 2523063.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4551025.5000; val_optim_loss: 4551025.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8904; val_auprc_score: 0.9508; val_best_acc_score: 0.8914; val_best_f1_score: 0.9319; train_kl_reg_loss: 15377.7590; train_edge_recon_loss: 1395206.7083; train_cat_covariates_contrastive_loss: 630863.1250; train_gene_expr_recon_loss: 2524482.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4565929.9167; train_optim_loss: 4565929.9167; val_kl_reg_loss: 14876.2129; val_edge_recon_loss: 1342757.3750; val_cat_covariates_contrastive_loss: 628946.8125; val_gene_expr_recon_loss: 2515885.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4502466.0000; val_optim_loss: 4502466.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8729; val_auprc_score: 0.9333; val_best_acc_score: 0.8829; val_best_f1_score: 0.9252; train_kl_reg_loss: 15329.0889; train_edge_recon_loss: 1406214.7708; train_cat_covariates_contrastive_loss: 631012.7917; train_gene_expr_recon_loss: 2527223.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4579780.5000; train_optim_loss: 4579780.5000; val_kl_reg_loss: 15033.9912; val_edge_recon_loss: 1400978.3750; val_cat_covariates_contrastive_loss: 630234.1875; val_gene_expr_recon_loss: 2518989.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4565236.0000; val_optim_loss: 4565236.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8790; val_auprc_score: 0.9426; val_best_acc_score: 0.8765; val_best_f1_score: 0.9216; train_kl_reg_loss: 15372.3428; train_edge_recon_loss: 1406998.8958; train_cat_covariates_contrastive_loss: 631204.4688; train_gene_expr_recon_loss: 2524173.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4577749.2500; train_optim_loss: 4577749.2500; val_kl_reg_loss: 15102.8945; val_edge_recon_loss: 1417595.0000; val_cat_covariates_contrastive_loss: 629693.9375; val_gene_expr_recon_loss: 2519954.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582346.0000; val_optim_loss: 4582346.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8773; val_auprc_score: 0.9398; val_best_acc_score: 0.8725; val_best_f1_score: 0.9189; train_kl_reg_loss: 15450.0112; train_edge_recon_loss: 1382424.8750; train_cat_covariates_contrastive_loss: 630776.7188; train_gene_expr_recon_loss: 2524019.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4552671.5833; train_optim_loss: 4552671.5833; val_kl_reg_loss: 15085.8789; val_edge_recon_loss: 1455715.2500; val_cat_covariates_contrastive_loss: 629108.3125; val_gene_expr_recon_loss: 2516083.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4615992.5000; val_optim_loss: 4615992.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8724; val_auprc_score: 0.9382; val_best_acc_score: 0.8778; val_best_f1_score: 0.9229; train_kl_reg_loss: 15466.5859; train_edge_recon_loss: 1403801.3958; train_cat_covariates_contrastive_loss: 630804.6562; train_gene_expr_recon_loss: 2524177.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4574250.6667; train_optim_loss: 4574250.6667; val_kl_reg_loss: 15153.8750; val_edge_recon_loss: 1395355.3750; val_cat_covariates_contrastive_loss: 629354.8125; val_gene_expr_recon_loss: 2524986.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4564850.0000; val_optim_loss: 4564850.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8862; val_auprc_score: 0.9477; val_best_acc_score: 0.8854; val_best_f1_score: 0.9278; train_kl_reg_loss: 15463.6841; train_edge_recon_loss: 1407819.4167; train_cat_covariates_contrastive_loss: 630961.5417; train_gene_expr_recon_loss: 2528765.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4583010.5000; train_optim_loss: 4583010.5000; val_kl_reg_loss: 15096.4785; val_edge_recon_loss: 1360853.3750; val_cat_covariates_contrastive_loss: 629203.0625; val_gene_expr_recon_loss: 2523415.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528568.5000; val_optim_loss: 4528568.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8978; val_auprc_score: 0.9486; val_best_acc_score: 0.8851; val_best_f1_score: 0.9252; train_kl_reg_loss: 15457.2342; train_edge_recon_loss: 1392592.5833; train_cat_covariates_contrastive_loss: 630735.6250; train_gene_expr_recon_loss: 2524326.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4563111.9167; train_optim_loss: 4563111.9167; val_kl_reg_loss: 15261.2725; val_edge_recon_loss: 1423723.7500; val_cat_covariates_contrastive_loss: 630017.0625; val_gene_expr_recon_loss: 2529230.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4598232.0000; val_optim_loss: 4598232.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8775; val_auprc_score: 0.9368; val_best_acc_score: 0.8810; val_best_f1_score: 0.9238; train_kl_reg_loss: 15470.0640; train_edge_recon_loss: 1400329.8333; train_cat_covariates_contrastive_loss: 630731.0938; train_gene_expr_recon_loss: 2523960.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4570491.3333; train_optim_loss: 4570491.3333; val_kl_reg_loss: 15210.8037; val_edge_recon_loss: 1418360.8750; val_cat_covariates_contrastive_loss: 629860.0625; val_gene_expr_recon_loss: 2524804.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4588236.0000; val_optim_loss: 4588236.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8775; val_auprc_score: 0.9448; val_best_acc_score: 0.8838; val_best_f1_score: 0.9262; train_kl_reg_loss: 15460.1748; train_edge_recon_loss: 1420177.1458; train_cat_covariates_contrastive_loss: 630979.3958; train_gene_expr_recon_loss: 2526891.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4593508.5000; train_optim_loss: 4593508.5000; val_kl_reg_loss: 15006.9482; val_edge_recon_loss: 1387085.7500; val_cat_covariates_contrastive_loss: 629522.1250; val_gene_expr_recon_loss: 2518673.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4550288.5000; val_optim_loss: 4550288.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 55 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.8805
val AUPRC score: 0.9412
val best accuracy score: 0.8871
val best F1 score: 0.9297
val target rna MSE score: 0.8045
val source rna MSE score: 0.1075
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0004
Duration of model training in run 8: 0 hours, 2 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 23503
Number of validation edges: 2611
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9396; val_auprc_score: 0.9758; val_best_acc_score: 0.7496; val_best_f1_score: 0.8569; train_kl_reg_loss: 1094.0799; train_edge_recon_loss: 1741152.4583; train_cat_covariates_contrastive_loss: 1084102.9896; train_gene_expr_recon_loss: 3574714.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6401064.0000; train_optim_loss: 6401064.0000; val_kl_reg_loss: 3375.8613; val_edge_recon_loss: 2034995.5000; val_cat_covariates_contrastive_loss: 626906.6250; val_gene_expr_recon_loss: 3457463.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6122741.0000; val_optim_loss: 6122741.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9313; val_auprc_score: 0.9700; val_best_acc_score: 0.7471; val_best_f1_score: 0.8552; train_kl_reg_loss: 4301.1460; train_edge_recon_loss: 1955320.3750; train_cat_covariates_contrastive_loss: 662914.7708; train_gene_expr_recon_loss: 3358902.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5981438.1667; train_optim_loss: 5981438.1667; val_kl_reg_loss: 4590.7959; val_edge_recon_loss: 2056100.1250; val_cat_covariates_contrastive_loss: 626779.1250; val_gene_expr_recon_loss: 3335963.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6023433.5000; val_optim_loss: 6023433.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9244; val_auprc_score: 0.9686; val_best_acc_score: 0.7827; val_best_f1_score: 0.8732; train_kl_reg_loss: 3699.0233; train_edge_recon_loss: 1962735.2083; train_cat_covariates_contrastive_loss: 659606.8750; train_gene_expr_recon_loss: 3223341.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5849382.2500; train_optim_loss: 5849382.2500; val_kl_reg_loss: 2369.8511; val_edge_recon_loss: 2043058.7500; val_cat_covariates_contrastive_loss: 626929.0625; val_gene_expr_recon_loss: 3189647.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5862005.0000; val_optim_loss: 5862005.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9048; val_auprc_score: 0.9625; val_best_acc_score: 0.7979; val_best_f1_score: 0.8805; train_kl_reg_loss: 2124.7529; train_edge_recon_loss: 1819958.5208; train_cat_covariates_contrastive_loss: 708057.8438; train_gene_expr_recon_loss: 3127482.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5657623.2500; train_optim_loss: 5657623.2500; val_kl_reg_loss: 2256.4536; val_edge_recon_loss: 2033201.1250; val_cat_covariates_contrastive_loss: 627024.3750; val_gene_expr_recon_loss: 3110539.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5773021.0000; val_optim_loss: 5773021.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8708; val_auprc_score: 0.9479; val_best_acc_score: 0.8030; val_best_f1_score: 0.8823; train_kl_reg_loss: 2399.5675; train_edge_recon_loss: 1797050.1042; train_cat_covariates_contrastive_loss: 690077.2292; train_gene_expr_recon_loss: 3039999.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5529526.2500; train_optim_loss: 5529526.2500; val_kl_reg_loss: 2612.3474; val_edge_recon_loss: 2029746.1250; val_cat_covariates_contrastive_loss: 627120.7500; val_gene_expr_recon_loss: 3032419.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5691898.5000; val_optim_loss: 5691898.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8401; val_auprc_score: 0.9349; val_best_acc_score: 0.8072; val_best_f1_score: 0.8803; train_kl_reg_loss: 2655.8942; train_edge_recon_loss: 1835397.8125; train_cat_covariates_contrastive_loss: 671506.7188; train_gene_expr_recon_loss: 2970597.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5480158.2500; train_optim_loss: 5480158.2500; val_kl_reg_loss: 2859.8540; val_edge_recon_loss: 2020054.2500; val_cat_covariates_contrastive_loss: 627395.8125; val_gene_expr_recon_loss: 2970674.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5620984.0000; val_optim_loss: 5620984.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8092; val_auprc_score: 0.9197; val_best_acc_score: 0.7938; val_best_f1_score: 0.8781; train_kl_reg_loss: 2902.4675; train_edge_recon_loss: 1824455.0000; train_cat_covariates_contrastive_loss: 658215.0104; train_gene_expr_recon_loss: 2908899.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5394471.9167; train_optim_loss: 5394471.9167; val_kl_reg_loss: 2821.7268; val_edge_recon_loss: 1944071.2500; val_cat_covariates_contrastive_loss: 627578.5000; val_gene_expr_recon_loss: 2910142.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484614.0000; val_optim_loss: 5484614.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8052; val_auprc_score: 0.9196; val_best_acc_score: 0.7983; val_best_f1_score: 0.8773; train_kl_reg_loss: 2998.4137; train_edge_recon_loss: 1795106.9792; train_cat_covariates_contrastive_loss: 659475.0312; train_gene_expr_recon_loss: 2852731.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5310311.5833; train_optim_loss: 5310311.5833; val_kl_reg_loss: 3208.8657; val_edge_recon_loss: 1985072.5000; val_cat_covariates_contrastive_loss: 627516.5000; val_gene_expr_recon_loss: 2855586.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5471384.0000; val_optim_loss: 5471384.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7889; val_auprc_score: 0.9076; val_best_acc_score: 0.7963; val_best_f1_score: 0.8756; train_kl_reg_loss: 3387.7979; train_edge_recon_loss: 1774728.2083; train_cat_covariates_contrastive_loss: 656512.2188; train_gene_expr_recon_loss: 2802175.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5236803.5000; train_optim_loss: 5236803.5000; val_kl_reg_loss: 3711.8794; val_edge_recon_loss: 1958831.2500; val_cat_covariates_contrastive_loss: 627558.5000; val_gene_expr_recon_loss: 2806899.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5397001.0000; val_optim_loss: 5397001.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7678; val_auprc_score: 0.8918; val_best_acc_score: 0.7976; val_best_f1_score: 0.8767; train_kl_reg_loss: 4234.2316; train_edge_recon_loss: 1767875.2083; train_cat_covariates_contrastive_loss: 657742.9167; train_gene_expr_recon_loss: 2765496.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195348.7500; train_optim_loss: 5195348.7500; val_kl_reg_loss: 5155.2471; val_edge_recon_loss: 1892226.8750; val_cat_covariates_contrastive_loss: 627741.2500; val_gene_expr_recon_loss: 2771718.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5296842.0000; val_optim_loss: 5296842.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7688; val_auprc_score: 0.9022; val_best_acc_score: 0.8020; val_best_f1_score: 0.8822; train_kl_reg_loss: 5261.8886; train_edge_recon_loss: 1719959.6042; train_cat_covariates_contrastive_loss: 653241.3125; train_gene_expr_recon_loss: 2729724.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5108187.4167; train_optim_loss: 5108187.4167; val_kl_reg_loss: 6126.8438; val_edge_recon_loss: 1780032.2500; val_cat_covariates_contrastive_loss: 627263.8750; val_gene_expr_recon_loss: 2754399.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5167822.0000; val_optim_loss: 5167822.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7587; val_auprc_score: 0.8968; val_best_acc_score: 0.8146; val_best_f1_score: 0.8891; train_kl_reg_loss: 6896.6929; train_edge_recon_loss: 1700965.1042; train_cat_covariates_contrastive_loss: 646778.6458; train_gene_expr_recon_loss: 2706687.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5061328.1667; train_optim_loss: 5061328.1667; val_kl_reg_loss: 7929.1816; val_edge_recon_loss: 1664402.3750; val_cat_covariates_contrastive_loss: 627106.8750; val_gene_expr_recon_loss: 2728884.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5028322.5000; val_optim_loss: 5028322.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7712; val_auprc_score: 0.9008; val_best_acc_score: 0.8107; val_best_f1_score: 0.8858; train_kl_reg_loss: 8897.4663; train_edge_recon_loss: 1620200.4167; train_cat_covariates_contrastive_loss: 641318.9375; train_gene_expr_recon_loss: 2690442.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4960859.4167; train_optim_loss: 4960859.4167; val_kl_reg_loss: 11368.3027; val_edge_recon_loss: 1628453.1250; val_cat_covariates_contrastive_loss: 626931.3125; val_gene_expr_recon_loss: 2713367.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4980120.0000; val_optim_loss: 4980120.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7634; val_auprc_score: 0.8989; val_best_acc_score: 0.8105; val_best_f1_score: 0.8857; train_kl_reg_loss: 12059.2983; train_edge_recon_loss: 1576740.8750; train_cat_covariates_contrastive_loss: 632415.2812; train_gene_expr_recon_loss: 2681102.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4902317.7500; train_optim_loss: 4902317.7500; val_kl_reg_loss: 13180.3740; val_edge_recon_loss: 1580706.3750; val_cat_covariates_contrastive_loss: 626817.0625; val_gene_expr_recon_loss: 2688556.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4909260.0000; val_optim_loss: 4909260.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7614; val_auprc_score: 0.8977; val_best_acc_score: 0.8020; val_best_f1_score: 0.8797; train_kl_reg_loss: 14277.4500; train_edge_recon_loss: 1556533.9792; train_cat_covariates_contrastive_loss: 630201.4479; train_gene_expr_recon_loss: 2655770.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4856783.5833; train_optim_loss: 4856783.5833; val_kl_reg_loss: 15037.7598; val_edge_recon_loss: 1588582.7500; val_cat_covariates_contrastive_loss: 626905.7500; val_gene_expr_recon_loss: 2690452.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4920979.0000; val_optim_loss: 4920979.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7597; val_auprc_score: 0.8925; val_best_acc_score: 0.8092; val_best_f1_score: 0.8856; train_kl_reg_loss: 15082.0275; train_edge_recon_loss: 1554363.5000; train_cat_covariates_contrastive_loss: 629489.7604; train_gene_expr_recon_loss: 2643767.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842702.3333; train_optim_loss: 4842702.3333; val_kl_reg_loss: 14578.3633; val_edge_recon_loss: 1542123.5000; val_cat_covariates_contrastive_loss: 626977.1875; val_gene_expr_recon_loss: 2664776.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848455.5000; val_optim_loss: 4848455.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7855; val_auprc_score: 0.9117; val_best_acc_score: 0.8076; val_best_f1_score: 0.8841; train_kl_reg_loss: 15060.9048; train_edge_recon_loss: 1547345.6250; train_cat_covariates_contrastive_loss: 630256.5625; train_gene_expr_recon_loss: 2627100.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819763.0833; train_optim_loss: 4819763.0833; val_kl_reg_loss: 14870.5439; val_edge_recon_loss: 1538472.6250; val_cat_covariates_contrastive_loss: 627057.6875; val_gene_expr_recon_loss: 2647562.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4827963.0000; val_optim_loss: 4827963.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7799; val_auprc_score: 0.9099; val_best_acc_score: 0.8263; val_best_f1_score: 0.8957; train_kl_reg_loss: 14139.9611; train_edge_recon_loss: 1535555.8750; train_cat_covariates_contrastive_loss: 629127.4271; train_gene_expr_recon_loss: 2615615.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4794438.5000; train_optim_loss: 4794438.5000; val_kl_reg_loss: 13062.5996; val_edge_recon_loss: 1459558.5000; val_cat_covariates_contrastive_loss: 626943.8750; val_gene_expr_recon_loss: 2642528.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4742093.0000; val_optim_loss: 4742093.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7985; val_auprc_score: 0.9096; val_best_acc_score: 0.8202; val_best_f1_score: 0.8901; train_kl_reg_loss: 13169.6006; train_edge_recon_loss: 1521196.1875; train_cat_covariates_contrastive_loss: 629631.6979; train_gene_expr_recon_loss: 2610025.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4774023.1667; train_optim_loss: 4774023.1667; val_kl_reg_loss: 12644.0801; val_edge_recon_loss: 1541531.5000; val_cat_covariates_contrastive_loss: 627030.9375; val_gene_expr_recon_loss: 2627303.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4808509.5000; val_optim_loss: 4808509.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7967; val_auprc_score: 0.9127; val_best_acc_score: 0.8236; val_best_f1_score: 0.8919; train_kl_reg_loss: 12387.6634; train_edge_recon_loss: 1501575.5625; train_cat_covariates_contrastive_loss: 630117.3021; train_gene_expr_recon_loss: 2594448.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738529.0833; train_optim_loss: 4738529.0833; val_kl_reg_loss: 12667.5996; val_edge_recon_loss: 1521948.0000; val_cat_covariates_contrastive_loss: 627158.6875; val_gene_expr_recon_loss: 2627678.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4789452.0000; val_optim_loss: 4789452.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8177; val_auprc_score: 0.9187; val_best_acc_score: 0.8256; val_best_f1_score: 0.8925; train_kl_reg_loss: 11897.8953; train_edge_recon_loss: 1509421.5625; train_cat_covariates_contrastive_loss: 629971.7292; train_gene_expr_recon_loss: 2591868.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4743159.8333; train_optim_loss: 4743159.8333; val_kl_reg_loss: 12855.6875; val_edge_recon_loss: 1548998.6250; val_cat_covariates_contrastive_loss: 627087.1875; val_gene_expr_recon_loss: 2614027.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4802968.5000; val_optim_loss: 4802968.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8322; val_auprc_score: 0.9272; val_best_acc_score: 0.8390; val_best_f1_score: 0.9005; train_kl_reg_loss: 11967.5461; train_edge_recon_loss: 1502334.1250; train_cat_covariates_contrastive_loss: 629775.3854; train_gene_expr_recon_loss: 2583947.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728024.3333; train_optim_loss: 4728024.3333; val_kl_reg_loss: 11366.4473; val_edge_recon_loss: 1474081.2500; val_cat_covariates_contrastive_loss: 626945.6875; val_gene_expr_recon_loss: 2609363.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4721757.0000; val_optim_loss: 4721757.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8333; val_auprc_score: 0.9230; val_best_acc_score: 0.8338; val_best_f1_score: 0.8967; train_kl_reg_loss: 12087.3003; train_edge_recon_loss: 1488404.0000; train_cat_covariates_contrastive_loss: 629680.3229; train_gene_expr_recon_loss: 2578705.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4708877.0000; train_optim_loss: 4708877.0000; val_kl_reg_loss: 11782.4355; val_edge_recon_loss: 1506448.3750; val_cat_covariates_contrastive_loss: 627188.6250; val_gene_expr_recon_loss: 2607777.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4753197.0000; val_optim_loss: 4753197.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8290; val_auprc_score: 0.9255; val_best_acc_score: 0.8408; val_best_f1_score: 0.9021; train_kl_reg_loss: 11541.1893; train_edge_recon_loss: 1471772.7083; train_cat_covariates_contrastive_loss: 630303.0208; train_gene_expr_recon_loss: 2568734.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4682351.7500; train_optim_loss: 4682351.7500; val_kl_reg_loss: 11990.9590; val_edge_recon_loss: 1454916.6250; val_cat_covariates_contrastive_loss: 627243.5625; val_gene_expr_recon_loss: 2604125.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4698276.0000; val_optim_loss: 4698276.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8409; val_auprc_score: 0.9267; val_best_acc_score: 0.8382; val_best_f1_score: 0.8992; train_kl_reg_loss: 11586.1851; train_edge_recon_loss: 1468538.4792; train_cat_covariates_contrastive_loss: 630229.0938; train_gene_expr_recon_loss: 2569784.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4680137.7500; train_optim_loss: 4680137.7500; val_kl_reg_loss: 11053.1650; val_edge_recon_loss: 1491851.3750; val_cat_covariates_contrastive_loss: 627158.3750; val_gene_expr_recon_loss: 2596735.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4726798.0000; val_optim_loss: 4726798.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8576; val_auprc_score: 0.9341; val_best_acc_score: 0.8501; val_best_f1_score: 0.9067; train_kl_reg_loss: 11637.6906; train_edge_recon_loss: 1453983.5000; train_cat_covariates_contrastive_loss: 630719.2917; train_gene_expr_recon_loss: 2563325.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4659665.8333; train_optim_loss: 4659665.8333; val_kl_reg_loss: 11575.1133; val_edge_recon_loss: 1447948.1250; val_cat_covariates_contrastive_loss: 627412.3750; val_gene_expr_recon_loss: 2595341.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4682277.0000; val_optim_loss: 4682277.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8748; val_auprc_score: 0.9444; val_best_acc_score: 0.8555; val_best_f1_score: 0.9108; train_kl_reg_loss: 11425.4160; train_edge_recon_loss: 1452842.1042; train_cat_covariates_contrastive_loss: 631266.0625; train_gene_expr_recon_loss: 2555846.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4651380.2500; train_optim_loss: 4651380.2500; val_kl_reg_loss: 12155.7598; val_edge_recon_loss: 1428847.3750; val_cat_covariates_contrastive_loss: 628047.1250; val_gene_expr_recon_loss: 2593188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4662238.0000; val_optim_loss: 4662238.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8734; val_auprc_score: 0.9343; val_best_acc_score: 0.8603; val_best_f1_score: 0.9107; train_kl_reg_loss: 11315.4276; train_edge_recon_loss: 1442639.9375; train_cat_covariates_contrastive_loss: 631389.8542; train_gene_expr_recon_loss: 2556014.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4641359.8333; train_optim_loss: 4641359.8333; val_kl_reg_loss: 10893.1680; val_edge_recon_loss: 1417220.6250; val_cat_covariates_contrastive_loss: 628232.6250; val_gene_expr_recon_loss: 2592242.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4648588.5000; val_optim_loss: 4648588.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8854; val_auprc_score: 0.9441; val_best_acc_score: 0.8707; val_best_f1_score: 0.9183; train_kl_reg_loss: 11077.3997; train_edge_recon_loss: 1425749.7708; train_cat_covariates_contrastive_loss: 631408.2083; train_gene_expr_recon_loss: 2556268.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4624504.2500; train_optim_loss: 4624504.2500; val_kl_reg_loss: 11884.5195; val_edge_recon_loss: 1389044.1250; val_cat_covariates_contrastive_loss: 628818.4375; val_gene_expr_recon_loss: 2577400.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4607147.5000; val_optim_loss: 4607147.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8897; val_auprc_score: 0.9478; val_best_acc_score: 0.8828; val_best_f1_score: 0.9256; train_kl_reg_loss: 11911.1193; train_edge_recon_loss: 1400059.4375; train_cat_covariates_contrastive_loss: 631293.3021; train_gene_expr_recon_loss: 2549766.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4593030.6667; train_optim_loss: 4593030.6667; val_kl_reg_loss: 12361.8574; val_edge_recon_loss: 1401354.3750; val_cat_covariates_contrastive_loss: 629429.1875; val_gene_expr_recon_loss: 2580915.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4624060.5000; val_optim_loss: 4624060.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8839; val_auprc_score: 0.9479; val_best_acc_score: 0.8786; val_best_f1_score: 0.9239; train_kl_reg_loss: 13055.6520; train_edge_recon_loss: 1386264.8125; train_cat_covariates_contrastive_loss: 631380.0104; train_gene_expr_recon_loss: 2549634.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4580334.8333; train_optim_loss: 4580334.8333; val_kl_reg_loss: 12734.3535; val_edge_recon_loss: 1373497.0000; val_cat_covariates_contrastive_loss: 629726.0000; val_gene_expr_recon_loss: 2576062.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4592019.5000; val_optim_loss: 4592019.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8642; val_auprc_score: 0.9284; val_best_acc_score: 0.8643; val_best_f1_score: 0.9154; train_kl_reg_loss: 13399.7381; train_edge_recon_loss: 1401360.4792; train_cat_covariates_contrastive_loss: 631327.2396; train_gene_expr_recon_loss: 2539772.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4585860.3333; train_optim_loss: 4585860.3333; val_kl_reg_loss: 13245.4785; val_edge_recon_loss: 1459707.1250; val_cat_covariates_contrastive_loss: 629611.0000; val_gene_expr_recon_loss: 2572208.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4674772.0000; val_optim_loss: 4674772.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8961; val_auprc_score: 0.9528; val_best_acc_score: 0.8856; val_best_f1_score: 0.9270; train_kl_reg_loss: 13246.3491; train_edge_recon_loss: 1389175.3958; train_cat_covariates_contrastive_loss: 631463.1458; train_gene_expr_recon_loss: 2535795.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4569680.0833; train_optim_loss: 4569680.0833; val_kl_reg_loss: 13466.2090; val_edge_recon_loss: 1409095.6250; val_cat_covariates_contrastive_loss: 630827.4375; val_gene_expr_recon_loss: 2567345.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4620735.0000; val_optim_loss: 4620735.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9046; val_auprc_score: 0.9514; val_best_acc_score: 0.9014; val_best_f1_score: 0.9362; train_kl_reg_loss: 13159.6419; train_edge_recon_loss: 1377821.3750; train_cat_covariates_contrastive_loss: 631708.8750; train_gene_expr_recon_loss: 2536680.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4559370.7500; train_optim_loss: 4559370.7500; val_kl_reg_loss: 12795.8477; val_edge_recon_loss: 1382243.8750; val_cat_covariates_contrastive_loss: 630100.1250; val_gene_expr_recon_loss: 2567936.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4593076.5000; val_optim_loss: 4593076.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9091; val_auprc_score: 0.9600; val_best_acc_score: 0.8988; val_best_f1_score: 0.9358; train_kl_reg_loss: 12962.5239; train_edge_recon_loss: 1368023.5000; train_cat_covariates_contrastive_loss: 631520.9167; train_gene_expr_recon_loss: 2527102.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4539609.6667; train_optim_loss: 4539609.6667; val_kl_reg_loss: 12509.4551; val_edge_recon_loss: 1325035.0000; val_cat_covariates_contrastive_loss: 629741.7500; val_gene_expr_recon_loss: 2560089.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4527375.0000; val_optim_loss: 4527375.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9125; val_auprc_score: 0.9595; val_best_acc_score: 0.9005; val_best_f1_score: 0.9357; train_kl_reg_loss: 12628.9318; train_edge_recon_loss: 1388056.2708; train_cat_covariates_contrastive_loss: 632018.0729; train_gene_expr_recon_loss: 2528082.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4560786.0833; train_optim_loss: 4560786.0833; val_kl_reg_loss: 12899.2666; val_edge_recon_loss: 1385844.6250; val_cat_covariates_contrastive_loss: 630623.2500; val_gene_expr_recon_loss: 2558502.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4587870.0000; val_optim_loss: 4587870.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9091; val_auprc_score: 0.9526; val_best_acc_score: 0.9073; val_best_f1_score: 0.9410; train_kl_reg_loss: 12500.4673; train_edge_recon_loss: 1366974.2083; train_cat_covariates_contrastive_loss: 632516.9167; train_gene_expr_recon_loss: 2521972.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4533964.2500; train_optim_loss: 4533964.2500; val_kl_reg_loss: 12471.8682; val_edge_recon_loss: 1313925.8750; val_cat_covariates_contrastive_loss: 630562.5625; val_gene_expr_recon_loss: 2551279.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4508239.5000; val_optim_loss: 4508239.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9001; val_auprc_score: 0.9460; val_best_acc_score: 0.8926; val_best_f1_score: 0.9318; train_kl_reg_loss: 12579.8325; train_edge_recon_loss: 1359533.5625; train_cat_covariates_contrastive_loss: 632086.3021; train_gene_expr_recon_loss: 2519663.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4523863.4167; train_optim_loss: 4523863.4167; val_kl_reg_loss: 12361.5781; val_edge_recon_loss: 1403281.5000; val_cat_covariates_contrastive_loss: 631088.6875; val_gene_expr_recon_loss: 2547329.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4594061.0000; val_optim_loss: 4594061.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9160; val_auprc_score: 0.9578; val_best_acc_score: 0.9058; val_best_f1_score: 0.9396; train_kl_reg_loss: 12332.1517; train_edge_recon_loss: 1352620.2292; train_cat_covariates_contrastive_loss: 632418.2708; train_gene_expr_recon_loss: 2518552.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4515922.7500; train_optim_loss: 4515922.7500; val_kl_reg_loss: 12247.8203; val_edge_recon_loss: 1368223.7500; val_cat_covariates_contrastive_loss: 630376.0000; val_gene_expr_recon_loss: 2544287.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4555135.0000; val_optim_loss: 4555135.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9149; val_auprc_score: 0.9580; val_best_acc_score: 0.9057; val_best_f1_score: 0.9398; train_kl_reg_loss: 12296.8032; train_edge_recon_loss: 1347725.8125; train_cat_covariates_contrastive_loss: 632122.7812; train_gene_expr_recon_loss: 2517643.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4509788.5833; train_optim_loss: 4509788.5833; val_kl_reg_loss: 12210.7832; val_edge_recon_loss: 1372692.8750; val_cat_covariates_contrastive_loss: 629970.9375; val_gene_expr_recon_loss: 2544639.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4559514.0000; val_optim_loss: 4559514.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9094; val_auprc_score: 0.9582; val_best_acc_score: 0.9049; val_best_f1_score: 0.9400; train_kl_reg_loss: 11990.8247; train_edge_recon_loss: 1380685.7083; train_cat_covariates_contrastive_loss: 632157.6979; train_gene_expr_recon_loss: 2513251.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4538085.6667; train_optim_loss: 4538085.6667; val_kl_reg_loss: 12071.3516; val_edge_recon_loss: 1333434.0000; val_cat_covariates_contrastive_loss: 631809.4375; val_gene_expr_recon_loss: 2546437.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4523752.0000; val_optim_loss: 4523752.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9069; val_auprc_score: 0.9567; val_best_acc_score: 0.9051; val_best_f1_score: 0.9399; train_kl_reg_loss: 12144.3828; train_edge_recon_loss: 1373195.7083; train_cat_covariates_contrastive_loss: 632058.9375; train_gene_expr_recon_loss: 2509935.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4527334.3333; train_optim_loss: 4527334.3333; val_kl_reg_loss: 11993.6455; val_edge_recon_loss: 1349554.2500; val_cat_covariates_contrastive_loss: 630842.0625; val_gene_expr_recon_loss: 2537304.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529694.5000; val_optim_loss: 4529694.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9139; val_auprc_score: 0.9520; val_best_acc_score: 0.9061; val_best_f1_score: 0.9405; train_kl_reg_loss: 11975.1353; train_edge_recon_loss: 1349384.3333; train_cat_covariates_contrastive_loss: 632429.3854; train_gene_expr_recon_loss: 2510847.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4504636.1667; train_optim_loss: 4504636.1667; val_kl_reg_loss: 11884.0615; val_edge_recon_loss: 1329855.0000; val_cat_covariates_contrastive_loss: 630403.2500; val_gene_expr_recon_loss: 2546125.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4518267.0000; val_optim_loss: 4518267.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9145; val_auprc_score: 0.9568; val_best_acc_score: 0.9003; val_best_f1_score: 0.9359; train_kl_reg_loss: 11842.5016; train_edge_recon_loss: 1364517.7500; train_cat_covariates_contrastive_loss: 632424.7812; train_gene_expr_recon_loss: 2511383.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4520168.3333; train_optim_loss: 4520168.3333; val_kl_reg_loss: 11804.3203; val_edge_recon_loss: 1400457.1250; val_cat_covariates_contrastive_loss: 631116.8750; val_gene_expr_recon_loss: 2539566.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582944.5000; val_optim_loss: 4582944.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9117; val_auprc_score: 0.9565; val_best_acc_score: 0.9080; val_best_f1_score: 0.9418; train_kl_reg_loss: 11785.5667; train_edge_recon_loss: 1360028.2083; train_cat_covariates_contrastive_loss: 632580.0938; train_gene_expr_recon_loss: 2504450.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4508844.5833; train_optim_loss: 4508844.5833; val_kl_reg_loss: 11803.0293; val_edge_recon_loss: 1303041.8750; val_cat_covariates_contrastive_loss: 631653.1250; val_gene_expr_recon_loss: 2538451.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4484949.5000; val_optim_loss: 4484949.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9033; val_auprc_score: 0.9502; val_best_acc_score: 0.9057; val_best_f1_score: 0.9399; train_kl_reg_loss: 11927.5257; train_edge_recon_loss: 1352567.3125; train_cat_covariates_contrastive_loss: 632530.4896; train_gene_expr_recon_loss: 2511050.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4508075.8333; train_optim_loss: 4508075.8333; val_kl_reg_loss: 11888.5996; val_edge_recon_loss: 1347788.0000; val_cat_covariates_contrastive_loss: 630508.1250; val_gene_expr_recon_loss: 2534007.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4524192.0000; val_optim_loss: 4524192.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9064; val_auprc_score: 0.9488; val_best_acc_score: 0.9058; val_best_f1_score: 0.9404; train_kl_reg_loss: 11949.1393; train_edge_recon_loss: 1360613.2292; train_cat_covariates_contrastive_loss: 632595.5104; train_gene_expr_recon_loss: 2511799.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4516957.0833; train_optim_loss: 4516957.0833; val_kl_reg_loss: 11862.1582; val_edge_recon_loss: 1323663.2500; val_cat_covariates_contrastive_loss: 630849.5000; val_gene_expr_recon_loss: 2539480.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4505855.5000; val_optim_loss: 4505855.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9199; val_auprc_score: 0.9609; val_best_acc_score: 0.9123; val_best_f1_score: 0.9442; train_kl_reg_loss: 11922.4976; train_edge_recon_loss: 1347732.7292; train_cat_covariates_contrastive_loss: 632642.5000; train_gene_expr_recon_loss: 2509927.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4502225.5833; train_optim_loss: 4502225.5833; val_kl_reg_loss: 11913.6387; val_edge_recon_loss: 1299578.0000; val_cat_covariates_contrastive_loss: 631121.5000; val_gene_expr_recon_loss: 2542800.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4485413.5000; val_optim_loss: 4485413.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9215; val_auprc_score: 0.9598; val_best_acc_score: 0.9117; val_best_f1_score: 0.9427; train_kl_reg_loss: 11978.3582; train_edge_recon_loss: 1363189.9583; train_cat_covariates_contrastive_loss: 632736.4583; train_gene_expr_recon_loss: 2508405.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4516310.0833; train_optim_loss: 4516310.0833; val_kl_reg_loss: 11927.4785; val_edge_recon_loss: 1345935.6250; val_cat_covariates_contrastive_loss: 631180.7500; val_gene_expr_recon_loss: 2533161.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4522205.5000; val_optim_loss: 4522205.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9068; val_auprc_score: 0.9453; val_best_acc_score: 0.9030; val_best_f1_score: 0.9374; train_kl_reg_loss: 12020.0264; train_edge_recon_loss: 1355867.4583; train_cat_covariates_contrastive_loss: 632341.4062; train_gene_expr_recon_loss: 2512114.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512342.9167; train_optim_loss: 4512342.9167; val_kl_reg_loss: 11979.0098; val_edge_recon_loss: 1395844.5000; val_cat_covariates_contrastive_loss: 631734.1875; val_gene_expr_recon_loss: 2543081.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582639.0000; val_optim_loss: 4582639.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9070; val_auprc_score: 0.9499; val_best_acc_score: 0.9014; val_best_f1_score: 0.9376; train_kl_reg_loss: 11963.4621; train_edge_recon_loss: 1354895.4583; train_cat_covariates_contrastive_loss: 632257.2292; train_gene_expr_recon_loss: 2508506.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4507622.5833; train_optim_loss: 4507622.5833; val_kl_reg_loss: 11931.4727; val_edge_recon_loss: 1349395.6250; val_cat_covariates_contrastive_loss: 631207.6875; val_gene_expr_recon_loss: 2537183.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4529718.0000; val_optim_loss: 4529718.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9116; val_auprc_score: 0.9564; val_best_acc_score: 0.9093; val_best_f1_score: 0.9427; train_kl_reg_loss: 11972.7135; train_edge_recon_loss: 1331604.6667; train_cat_covariates_contrastive_loss: 632063.8542; train_gene_expr_recon_loss: 2505595.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4481237.0000; train_optim_loss: 4481237.0000; val_kl_reg_loss: 11917.6260; val_edge_recon_loss: 1344232.5000; val_cat_covariates_contrastive_loss: 630814.0000; val_gene_expr_recon_loss: 2541119.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528084.0000; val_optim_loss: 4528084.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9150; val_auprc_score: 0.9605; val_best_acc_score: 0.9019; val_best_f1_score: 0.9381; train_kl_reg_loss: 11949.0758; train_edge_recon_loss: 1351515.3333; train_cat_covariates_contrastive_loss: 632484.5104; train_gene_expr_recon_loss: 2508656.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4504605.3333; train_optim_loss: 4504605.3333; val_kl_reg_loss: 11825.2070; val_edge_recon_loss: 1343637.5000; val_cat_covariates_contrastive_loss: 630989.0000; val_gene_expr_recon_loss: 2535646.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4522098.0000; val_optim_loss: 4522098.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 50 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9141
val AUPRC score: 0.9608
val best accuracy score: 0.9068
val best F1 score: 0.9412
val target rna MSE score: 0.9101
val source rna MSE score: 0.0969
Val cat covariate0 mean sim diff: -0.0149
Val cat covariate1 mean sim diff: -0.0149
Duration of model training in run 7: 0 hours, 1 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9384; val_auprc_score: 0.9705; val_best_acc_score: 0.7512; val_best_f1_score: 0.8570; train_kl_reg_loss: 790.3547; train_edge_recon_loss: 1728306.7500; train_cat_covariates_contrastive_loss: 1130859.4375; train_gene_expr_recon_loss: 3670036.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6529993.0000; train_optim_loss: 6529993.0000; val_kl_reg_loss: 2818.4409; val_edge_recon_loss: 2070722.2500; val_cat_covariates_contrastive_loss: 627066.1250; val_gene_expr_recon_loss: 3564710.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6265317.5000; val_optim_loss: 6265317.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9296; val_auprc_score: 0.9653; val_best_acc_score: 0.7480; val_best_f1_score: 0.8558; train_kl_reg_loss: 3550.3187; train_edge_recon_loss: 1915790.5500; train_cat_covariates_contrastive_loss: 683461.7000; train_gene_expr_recon_loss: 3475647.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6078450.0000; train_optim_loss: 6078450.0000; val_kl_reg_loss: 4074.9043; val_edge_recon_loss: 2048189.2500; val_cat_covariates_contrastive_loss: 626876.3750; val_gene_expr_recon_loss: 3420968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6100108.5000; val_optim_loss: 6100108.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9196; val_auprc_score: 0.9594; val_best_acc_score: 0.7810; val_best_f1_score: 0.8728; train_kl_reg_loss: 3950.7583; train_edge_recon_loss: 1924785.4750; train_cat_covariates_contrastive_loss: 651411.1125; train_gene_expr_recon_loss: 3371310.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5951457.9000; train_optim_loss: 5951457.9000; val_kl_reg_loss: 3171.0239; val_edge_recon_loss: 2017605.5000; val_cat_covariates_contrastive_loss: 626942.7500; val_gene_expr_recon_loss: 3306352.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5954072.0000; val_optim_loss: 5954072.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9043; val_auprc_score: 0.9516; val_best_acc_score: 0.7926; val_best_f1_score: 0.8768; train_kl_reg_loss: 2593.4788; train_edge_recon_loss: 1879932.1500; train_cat_covariates_contrastive_loss: 688143.7500; train_gene_expr_recon_loss: 3274479.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5845149.1000; train_optim_loss: 5845149.1000; val_kl_reg_loss: 1902.6625; val_edge_recon_loss: 2087423.3750; val_cat_covariates_contrastive_loss: 627124.6875; val_gene_expr_recon_loss: 3211183.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5927634.0000; val_optim_loss: 5927634.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8914; val_auprc_score: 0.9560; val_best_acc_score: 0.7958; val_best_f1_score: 0.8795; train_kl_reg_loss: 2146.3939; train_edge_recon_loss: 1822216.4000; train_cat_covariates_contrastive_loss: 707732.9250; train_gene_expr_recon_loss: 3180654.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5712750.2000; train_optim_loss: 5712750.2000; val_kl_reg_loss: 2570.3281; val_edge_recon_loss: 1989931.1250; val_cat_covariates_contrastive_loss: 627057.5625; val_gene_expr_recon_loss: 3154568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5774127.0000; val_optim_loss: 5774127.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8579; val_auprc_score: 0.9420; val_best_acc_score: 0.8102; val_best_f1_score: 0.8851; train_kl_reg_loss: 2685.8624; train_edge_recon_loss: 1818466.8500; train_cat_covariates_contrastive_loss: 683686.9375; train_gene_expr_recon_loss: 3107373.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5612212.8000; train_optim_loss: 5612212.8000; val_kl_reg_loss: 2471.6809; val_edge_recon_loss: 1981166.7500; val_cat_covariates_contrastive_loss: 627277.1875; val_gene_expr_recon_loss: 3078369.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5689285.0000; val_optim_loss: 5689285.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8268; val_auprc_score: 0.9247; val_best_acc_score: 0.8019; val_best_f1_score: 0.8737; train_kl_reg_loss: 2634.6982; train_edge_recon_loss: 1806169.6500; train_cat_covariates_contrastive_loss: 678903.6875; train_gene_expr_recon_loss: 3039547.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5527256.0000; train_optim_loss: 5527256.0000; val_kl_reg_loss: 2925.2856; val_edge_recon_loss: 2048586.0000; val_cat_covariates_contrastive_loss: 627468.3750; val_gene_expr_recon_loss: 3023412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5702391.5000; val_optim_loss: 5702391.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8049; val_auprc_score: 0.9166; val_best_acc_score: 0.8102; val_best_f1_score: 0.8849; train_kl_reg_loss: 3120.7087; train_edge_recon_loss: 1849696.9500; train_cat_covariates_contrastive_loss: 663689.1375; train_gene_expr_recon_loss: 2990309.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5506816.6000; train_optim_loss: 5506816.6000; val_kl_reg_loss: 2957.5625; val_edge_recon_loss: 1966045.0000; val_cat_covariates_contrastive_loss: 627770.9375; val_gene_expr_recon_loss: 2962836.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5559610.0000; val_optim_loss: 5559610.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7977; val_auprc_score: 0.9096; val_best_acc_score: 0.8178; val_best_f1_score: 0.8875; train_kl_reg_loss: 3145.8329; train_edge_recon_loss: 1779047.9500; train_cat_covariates_contrastive_loss: 675342.7875; train_gene_expr_recon_loss: 2942892.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5400428.9000; train_optim_loss: 5400428.9000; val_kl_reg_loss: 3475.0874; val_edge_recon_loss: 1945063.1250; val_cat_covariates_contrastive_loss: 627745.6875; val_gene_expr_recon_loss: 2908101.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5484385.5000; val_optim_loss: 5484385.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7956; val_auprc_score: 0.9156; val_best_acc_score: 0.8139; val_best_f1_score: 0.8865; train_kl_reg_loss: 4058.3696; train_edge_recon_loss: 1787068.0250; train_cat_covariates_contrastive_loss: 657570.9250; train_gene_expr_recon_loss: 2895182.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5343879.5000; train_optim_loss: 5343879.5000; val_kl_reg_loss: 4107.3438; val_edge_recon_loss: 1873402.0000; val_cat_covariates_contrastive_loss: 627948.7500; val_gene_expr_recon_loss: 2869107.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5374565.0000; val_optim_loss: 5374565.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7759; val_auprc_score: 0.8939; val_best_acc_score: 0.7984; val_best_f1_score: 0.8775; train_kl_reg_loss: 4522.6412; train_edge_recon_loss: 1727983.5750; train_cat_covariates_contrastive_loss: 660094.2750; train_gene_expr_recon_loss: 2843425.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5236025.7000; train_optim_loss: 5236025.7000; val_kl_reg_loss: 5023.8428; val_edge_recon_loss: 1951059.8750; val_cat_covariates_contrastive_loss: 627636.1250; val_gene_expr_recon_loss: 2822944.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5406664.5000; val_optim_loss: 5406664.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7655; val_auprc_score: 0.8900; val_best_acc_score: 0.8180; val_best_f1_score: 0.8894; train_kl_reg_loss: 5931.1462; train_edge_recon_loss: 1715947.2750; train_cat_covariates_contrastive_loss: 650040.9750; train_gene_expr_recon_loss: 2810445.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5182364.7000; train_optim_loss: 5182364.7000; val_kl_reg_loss: 6433.4946; val_edge_recon_loss: 1765070.5000; val_cat_covariates_contrastive_loss: 627530.1875; val_gene_expr_recon_loss: 2787080.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5186115.0000; val_optim_loss: 5186115.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7652; val_auprc_score: 0.8884; val_best_acc_score: 0.8001; val_best_f1_score: 0.8776; train_kl_reg_loss: 7075.6421; train_edge_recon_loss: 1718868.7000; train_cat_covariates_contrastive_loss: 648650.9750; train_gene_expr_recon_loss: 2781707.3000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5156302.5000; train_optim_loss: 5156302.5000; val_kl_reg_loss: 7617.8604; val_edge_recon_loss: 1780082.2500; val_cat_covariates_contrastive_loss: 627325.8750; val_gene_expr_recon_loss: 2774651.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5189677.5000; val_optim_loss: 5189677.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7554; val_auprc_score: 0.8867; val_best_acc_score: 0.8126; val_best_f1_score: 0.8861; train_kl_reg_loss: 8425.1234; train_edge_recon_loss: 1631888.5250; train_cat_covariates_contrastive_loss: 644039.8875; train_gene_expr_recon_loss: 2755367.1000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5039720.6000; train_optim_loss: 5039720.6000; val_kl_reg_loss: 9512.4766; val_edge_recon_loss: 1636858.0000; val_cat_covariates_contrastive_loss: 627091.4375; val_gene_expr_recon_loss: 2756553.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5030015.5000; val_optim_loss: 5030015.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7739; val_auprc_score: 0.9069; val_best_acc_score: 0.8098; val_best_f1_score: 0.8854; train_kl_reg_loss: 11007.6525; train_edge_recon_loss: 1594416.0250; train_cat_covariates_contrastive_loss: 634948.7625; train_gene_expr_recon_loss: 2726458.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966831.3000; train_optim_loss: 4966831.3000; val_kl_reg_loss: 12246.4561; val_edge_recon_loss: 1589669.1250; val_cat_covariates_contrastive_loss: 627025.6250; val_gene_expr_recon_loss: 2735324.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4964266.0000; val_optim_loss: 4964266.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7433; val_auprc_score: 0.8868; val_best_acc_score: 0.8040; val_best_f1_score: 0.8827; train_kl_reg_loss: 13633.3227; train_edge_recon_loss: 1545529.5500; train_cat_covariates_contrastive_loss: 631056.1875; train_gene_expr_recon_loss: 2718084.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4908303.5000; train_optim_loss: 4908303.5000; val_kl_reg_loss: 14531.2832; val_edge_recon_loss: 1605788.1250; val_cat_covariates_contrastive_loss: 627099.1875; val_gene_expr_recon_loss: 2722830.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4970249.0000; val_optim_loss: 4970249.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7675; val_auprc_score: 0.8989; val_best_acc_score: 0.8037; val_best_f1_score: 0.8817; train_kl_reg_loss: 15480.1205; train_edge_recon_loss: 1568100.1500; train_cat_covariates_contrastive_loss: 630543.9000; train_gene_expr_recon_loss: 2692303.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4906427.3000; train_optim_loss: 4906427.3000; val_kl_reg_loss: 16028.6953; val_edge_recon_loss: 1574013.8750; val_cat_covariates_contrastive_loss: 626957.3750; val_gene_expr_recon_loss: 2699763.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916763.0000; val_optim_loss: 4916763.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7360; val_auprc_score: 0.8815; val_best_acc_score: 0.8008; val_best_f1_score: 0.8808; train_kl_reg_loss: 16714.1633; train_edge_recon_loss: 1570082.9000; train_cat_covariates_contrastive_loss: 629518.3625; train_gene_expr_recon_loss: 2675414.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4891730.0000; train_optim_loss: 4891730.0000; val_kl_reg_loss: 15977.9453; val_edge_recon_loss: 1580160.1250; val_cat_covariates_contrastive_loss: 626833.2500; val_gene_expr_recon_loss: 2685238.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4908210.0000; val_optim_loss: 4908210.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7543; val_auprc_score: 0.8934; val_best_acc_score: 0.8005; val_best_f1_score: 0.8802; train_kl_reg_loss: 16633.9688; train_edge_recon_loss: 1569307.2250; train_cat_covariates_contrastive_loss: 631120.3750; train_gene_expr_recon_loss: 2660309.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4877371.1000; train_optim_loss: 4877371.1000; val_kl_reg_loss: 17075.4609; val_edge_recon_loss: 1616994.2500; val_cat_covariates_contrastive_loss: 626996.4375; val_gene_expr_recon_loss: 2664289.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4925355.0000; val_optim_loss: 4925355.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7598; val_auprc_score: 0.8939; val_best_acc_score: 0.8058; val_best_f1_score: 0.8833; train_kl_reg_loss: 17792.7852; train_edge_recon_loss: 1540403.6750; train_cat_covariates_contrastive_loss: 629405.5125; train_gene_expr_recon_loss: 2645676.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4833278.3000; train_optim_loss: 4833278.3000; val_kl_reg_loss: 16896.1992; val_edge_recon_loss: 1559304.1250; val_cat_covariates_contrastive_loss: 626953.6875; val_gene_expr_recon_loss: 2652498.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855652.5000; val_optim_loss: 4855652.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7795; val_auprc_score: 0.9041; val_best_acc_score: 0.8219; val_best_f1_score: 0.8927; train_kl_reg_loss: 16991.8816; train_edge_recon_loss: 1547129.2000; train_cat_covariates_contrastive_loss: 630908.8250; train_gene_expr_recon_loss: 2635437.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4830467.2000; train_optim_loss: 4830467.2000; val_kl_reg_loss: 16575.4180; val_edge_recon_loss: 1464518.1250; val_cat_covariates_contrastive_loss: 626896.6875; val_gene_expr_recon_loss: 2638112.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746102.0000; val_optim_loss: 4746102.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7747; val_auprc_score: 0.9039; val_best_acc_score: 0.8067; val_best_f1_score: 0.8841; train_kl_reg_loss: 17761.8770; train_edge_recon_loss: 1531030.9500; train_cat_covariates_contrastive_loss: 630471.0750; train_gene_expr_recon_loss: 2622365.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4801629.6000; train_optim_loss: 4801629.6000; val_kl_reg_loss: 17086.5078; val_edge_recon_loss: 1565515.8750; val_cat_covariates_contrastive_loss: 626965.2500; val_gene_expr_recon_loss: 2633867.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4843435.0000; val_optim_loss: 4843435.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7741; val_auprc_score: 0.8960; val_best_acc_score: 0.8038; val_best_f1_score: 0.8809; train_kl_reg_loss: 17195.3773; train_edge_recon_loss: 1546563.2750; train_cat_covariates_contrastive_loss: 631596.0500; train_gene_expr_recon_loss: 2609746.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4805101.3000; train_optim_loss: 4805101.3000; val_kl_reg_loss: 16856.3867; val_edge_recon_loss: 1604700.6250; val_cat_covariates_contrastive_loss: 627032.4375; val_gene_expr_recon_loss: 2619751.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868341.0000; val_optim_loss: 4868341.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7480; val_auprc_score: 0.8880; val_best_acc_score: 0.8005; val_best_f1_score: 0.8795; train_kl_reg_loss: 17564.4070; train_edge_recon_loss: 1535856.8250; train_cat_covariates_contrastive_loss: 630058.4000; train_gene_expr_recon_loss: 2594241.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4777721.1000; train_optim_loss: 4777721.1000; val_kl_reg_loss: 16536.4863; val_edge_recon_loss: 1628923.0000; val_cat_covariates_contrastive_loss: 627019.0000; val_gene_expr_recon_loss: 2618319.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4890798.0000; val_optim_loss: 4890798.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7736; val_auprc_score: 0.9040; val_best_acc_score: 0.8166; val_best_f1_score: 0.8894; train_kl_reg_loss: 16547.5023; train_edge_recon_loss: 1542551.2250; train_cat_covariates_contrastive_loss: 630959.0750; train_gene_expr_recon_loss: 2591202.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4781260.3000; train_optim_loss: 4781260.3000; val_kl_reg_loss: 16589.1719; val_edge_recon_loss: 1530426.0000; val_cat_covariates_contrastive_loss: 627054.1875; val_gene_expr_recon_loss: 2607443.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781512.0000; val_optim_loss: 4781512.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7874; val_auprc_score: 0.9026; val_best_acc_score: 0.8131; val_best_f1_score: 0.8848; train_kl_reg_loss: 16804.1564; train_edge_recon_loss: 1515412.0250; train_cat_covariates_contrastive_loss: 631242.2000; train_gene_expr_recon_loss: 2587371.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4750829.3000; train_optim_loss: 4750829.3000; val_kl_reg_loss: 16081.8457; val_edge_recon_loss: 1571627.7500; val_cat_covariates_contrastive_loss: 627155.5000; val_gene_expr_recon_loss: 2607503.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4822368.5000; val_optim_loss: 4822368.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7881; val_auprc_score: 0.9074; val_best_acc_score: 0.8127; val_best_f1_score: 0.8857; train_kl_reg_loss: 16545.8137; train_edge_recon_loss: 1499609.2500; train_cat_covariates_contrastive_loss: 631183.0375; train_gene_expr_recon_loss: 2592714.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740052.9000; train_optim_loss: 4740052.9000; val_kl_reg_loss: 15796.1201; val_edge_recon_loss: 1552152.7500; val_cat_covariates_contrastive_loss: 627021.5000; val_gene_expr_recon_loss: 2606356.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4801327.0000; val_optim_loss: 4801327.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7989; val_auprc_score: 0.9149; val_best_acc_score: 0.8250; val_best_f1_score: 0.8943; train_kl_reg_loss: 16255.9674; train_edge_recon_loss: 1509246.4000; train_cat_covariates_contrastive_loss: 631141.0625; train_gene_expr_recon_loss: 2584098.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740741.7000; train_optim_loss: 4740741.7000; val_kl_reg_loss: 15722.3145; val_edge_recon_loss: 1464602.7500; val_cat_covariates_contrastive_loss: 627190.0625; val_gene_expr_recon_loss: 2604891.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4712406.0000; val_optim_loss: 4712406.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7808; val_auprc_score: 0.9003; val_best_acc_score: 0.8125; val_best_f1_score: 0.8846; train_kl_reg_loss: 16044.6479; train_edge_recon_loss: 1504259.8500; train_cat_covariates_contrastive_loss: 631551.9000; train_gene_expr_recon_loss: 2587287.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4739143.6000; train_optim_loss: 4739143.6000; val_kl_reg_loss: 15768.6641; val_edge_recon_loss: 1584639.2500; val_cat_covariates_contrastive_loss: 627198.3125; val_gene_expr_recon_loss: 2613452.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841059.0000; val_optim_loss: 4841059.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7878; val_auprc_score: 0.9089; val_best_acc_score: 0.8166; val_best_f1_score: 0.8876; train_kl_reg_loss: 16066.6680; train_edge_recon_loss: 1534561.5000; train_cat_covariates_contrastive_loss: 631347.9250; train_gene_expr_recon_loss: 2590639.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4772615.4000; train_optim_loss: 4772615.4000; val_kl_reg_loss: 15648.4609; val_edge_recon_loss: 1522806.3750; val_cat_covariates_contrastive_loss: 627065.2500; val_gene_expr_recon_loss: 2611608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4777128.0000; val_optim_loss: 4777128.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7751; val_auprc_score: 0.9039; val_best_acc_score: 0.8201; val_best_f1_score: 0.8910; train_kl_reg_loss: 15935.6027; train_edge_recon_loss: 1501459.0750; train_cat_covariates_contrastive_loss: 632079.5125; train_gene_expr_recon_loss: 2586706.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736180.6000; train_optim_loss: 4736180.6000; val_kl_reg_loss: 15818.0312; val_edge_recon_loss: 1510531.5000; val_cat_covariates_contrastive_loss: 627084.6250; val_gene_expr_recon_loss: 2606977.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4760411.5000; val_optim_loss: 4760411.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7967; val_auprc_score: 0.9138; val_best_acc_score: 0.8207; val_best_f1_score: 0.8904; train_kl_reg_loss: 16102.3738; train_edge_recon_loss: 1530584.6250; train_cat_covariates_contrastive_loss: 631194.0000; train_gene_expr_recon_loss: 2591389.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4769270.6000; train_optim_loss: 4769270.6000; val_kl_reg_loss: 15624.6543; val_edge_recon_loss: 1496984.1250; val_cat_covariates_contrastive_loss: 627132.8125; val_gene_expr_recon_loss: 2606976.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746718.0000; val_optim_loss: 4746718.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7968; val_auprc_score: 0.9167; val_best_acc_score: 0.8219; val_best_f1_score: 0.8912; train_kl_reg_loss: 15954.9672; train_edge_recon_loss: 1507687.4500; train_cat_covariates_contrastive_loss: 631837.2625; train_gene_expr_recon_loss: 2586987.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4742467.3000; train_optim_loss: 4742467.3000; val_kl_reg_loss: 15157.1680; val_edge_recon_loss: 1499769.3750; val_cat_covariates_contrastive_loss: 627070.0000; val_gene_expr_recon_loss: 2605745.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747742.0000; val_optim_loss: 4747742.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7834; val_auprc_score: 0.9046; val_best_acc_score: 0.8097; val_best_f1_score: 0.8825; train_kl_reg_loss: 15828.4242; train_edge_recon_loss: 1510905.8750; train_cat_covariates_contrastive_loss: 631435.3250; train_gene_expr_recon_loss: 2585053.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4743222.9000; train_optim_loss: 4743222.9000; val_kl_reg_loss: 15576.9316; val_edge_recon_loss: 1593640.1250; val_cat_covariates_contrastive_loss: 627063.0625; val_gene_expr_recon_loss: 2604722.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4841002.5000; val_optim_loss: 4841002.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7891; val_auprc_score: 0.9123; val_best_acc_score: 0.8128; val_best_f1_score: 0.8868; train_kl_reg_loss: 15816.5279; train_edge_recon_loss: 1512924.2500; train_cat_covariates_contrastive_loss: 631208.8500; train_gene_expr_recon_loss: 2593233.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4753183.1000; train_optim_loss: 4753183.1000; val_kl_reg_loss: 15336.5537; val_edge_recon_loss: 1528873.0000; val_cat_covariates_contrastive_loss: 626985.3750; val_gene_expr_recon_loss: 2604041.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4775236.5000; val_optim_loss: 4775236.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8035; val_auprc_score: 0.9186; val_best_acc_score: 0.8233; val_best_f1_score: 0.8914; train_kl_reg_loss: 15746.2664; train_edge_recon_loss: 1520166.5000; train_cat_covariates_contrastive_loss: 631751.7500; train_gene_expr_recon_loss: 2581915.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4749580.4000; train_optim_loss: 4749580.4000; val_kl_reg_loss: 15352.1670; val_edge_recon_loss: 1503264.7500; val_cat_covariates_contrastive_loss: 627159.8750; val_gene_expr_recon_loss: 2600777.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746554.0000; val_optim_loss: 4746554.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 57 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.7810
val AUPRC score: 0.9043
val best accuracy score: 0.8136
val best F1 score: 0.8876
val target rna MSE score: 0.8400
val source rna MSE score: 0.1652
Val cat covariate0 mean sim diff: -0.0062
Val cat covariate1 mean sim diff: -0.0062
Duration of model training in run 6: 0 hours, 0 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 17774
Number of validation edges: 1974
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9272; val_auprc_score: 0.9640; val_best_acc_score: 0.7640; val_best_f1_score: 0.8650; train_kl_reg_loss: 661.4094; train_edge_recon_loss: 1755739.4500; train_cat_covariates_contrastive_loss: 1150236.4500; train_gene_expr_recon_loss: 3577489.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6484127.2000; train_optim_loss: 6484127.2000; val_kl_reg_loss: 2505.6243; val_edge_recon_loss: 1980257.8750; val_cat_covariates_contrastive_loss: 627123.8750; val_gene_expr_recon_loss: 3435096.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6044984.0000; val_optim_loss: 6044984.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9208; val_auprc_score: 0.9636; val_best_acc_score: 0.7549; val_best_f1_score: 0.8603; train_kl_reg_loss: 4259.7229; train_edge_recon_loss: 1900760.1000; train_cat_covariates_contrastive_loss: 680400.8000; train_gene_expr_recon_loss: 3398930.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5984351.3000; train_optim_loss: 5984351.3000; val_kl_reg_loss: 6055.0928; val_edge_recon_loss: 1992691.6250; val_cat_covariates_contrastive_loss: 626765.1875; val_gene_expr_recon_loss: 3327240.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5952752.0000; val_optim_loss: 5952752.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9102; val_auprc_score: 0.9575; val_best_acc_score: 0.7485; val_best_f1_score: 0.8558; train_kl_reg_loss: 6417.2430; train_edge_recon_loss: 2003565.9000; train_cat_covariates_contrastive_loss: 635571.2000; train_gene_expr_recon_loss: 3283536.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5929091.3000; train_optim_loss: 5929091.3000; val_kl_reg_loss: 5872.9609; val_edge_recon_loss: 2059859.3750; val_cat_covariates_contrastive_loss: 626762.8125; val_gene_expr_recon_loss: 3210551.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5903046.0000; val_optim_loss: 5903046.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9127; val_auprc_score: 0.9667; val_best_acc_score: 0.7873; val_best_f1_score: 0.8741; train_kl_reg_loss: 4843.3387; train_edge_recon_loss: 1962712.6250; train_cat_covariates_contrastive_loss: 653368.3000; train_gene_expr_recon_loss: 3201434.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5822359.0000; train_optim_loss: 5822359.0000; val_kl_reg_loss: 3045.0208; val_edge_recon_loss: 2108687.2500; val_cat_covariates_contrastive_loss: 626887.5000; val_gene_expr_recon_loss: 3164212.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5902832.0000; val_optim_loss: 5902832.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8798; val_auprc_score: 0.9510; val_best_acc_score: 0.7935; val_best_f1_score: 0.8775; train_kl_reg_loss: 2676.9269; train_edge_recon_loss: 1843766.3000; train_cat_covariates_contrastive_loss: 710477.1375; train_gene_expr_recon_loss: 3156761.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5713681.6000; train_optim_loss: 5713681.6000; val_kl_reg_loss: 2680.1221; val_edge_recon_loss: 2000510.2500; val_cat_covariates_contrastive_loss: 626956.9375; val_gene_expr_recon_loss: 3090855.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5721003.0000; val_optim_loss: 5721003.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8625; val_auprc_score: 0.9477; val_best_acc_score: 0.8015; val_best_f1_score: 0.8786; train_kl_reg_loss: 3105.9686; train_edge_recon_loss: 1829672.3000; train_cat_covariates_contrastive_loss: 692134.3000; train_gene_expr_recon_loss: 3078323.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5603235.7000; train_optim_loss: 5603235.7000; val_kl_reg_loss: 3273.5193; val_edge_recon_loss: 2029736.0000; val_cat_covariates_contrastive_loss: 627020.1250; val_gene_expr_recon_loss: 3022174.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5682203.5000; val_optim_loss: 5682203.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8222; val_auprc_score: 0.9302; val_best_acc_score: 0.7966; val_best_f1_score: 0.8785; train_kl_reg_loss: 3335.7733; train_edge_recon_loss: 1816311.3000; train_cat_covariates_contrastive_loss: 688168.7875; train_gene_expr_recon_loss: 3021528.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5529344.6000; train_optim_loss: 5529344.6000; val_kl_reg_loss: 3465.2119; val_edge_recon_loss: 2004407.0000; val_cat_covariates_contrastive_loss: 627228.0000; val_gene_expr_recon_loss: 2980298.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5615398.0000; val_optim_loss: 5615398.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7762; val_auprc_score: 0.8989; val_best_acc_score: 0.7830; val_best_f1_score: 0.8672; train_kl_reg_loss: 3900.0416; train_edge_recon_loss: 1822905.3750; train_cat_covariates_contrastive_loss: 675641.1375; train_gene_expr_recon_loss: 2968368.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5470815.1000; train_optim_loss: 5470815.1000; val_kl_reg_loss: 4425.1436; val_edge_recon_loss: 2057140.0000; val_cat_covariates_contrastive_loss: 627380.8750; val_gene_expr_recon_loss: 2915913.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5604859.5000; val_optim_loss: 5604859.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7738; val_auprc_score: 0.8962; val_best_acc_score: 0.7846; val_best_f1_score: 0.8704; train_kl_reg_loss: 5077.2714; train_edge_recon_loss: 1796604.1750; train_cat_covariates_contrastive_loss: 659786.4000; train_gene_expr_recon_loss: 2907678.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5369146.5000; train_optim_loss: 5369146.5000; val_kl_reg_loss: 5846.8848; val_edge_recon_loss: 1974713.7500; val_cat_covariates_contrastive_loss: 627843.1875; val_gene_expr_recon_loss: 2861882.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5470286.0000; val_optim_loss: 5470286.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7715; val_auprc_score: 0.8996; val_best_acc_score: 0.7981; val_best_f1_score: 0.8797; train_kl_reg_loss: 6780.5987; train_edge_recon_loss: 1814452.5250; train_cat_covariates_contrastive_loss: 656338.7500; train_gene_expr_recon_loss: 2868363.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5345935.2000; train_optim_loss: 5345935.2000; val_kl_reg_loss: 7850.0615; val_edge_recon_loss: 1873489.6250; val_cat_covariates_contrastive_loss: 627842.8125; val_gene_expr_recon_loss: 2828973.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5338156.0000; val_optim_loss: 5338156.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7842; val_auprc_score: 0.9054; val_best_acc_score: 0.8089; val_best_f1_score: 0.8826; train_kl_reg_loss: 8281.0686; train_edge_recon_loss: 1754324.8500; train_cat_covariates_contrastive_loss: 647745.5750; train_gene_expr_recon_loss: 2822069.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5232421.4000; train_optim_loss: 5232421.4000; val_kl_reg_loss: 9114.4639; val_edge_recon_loss: 1816602.2500; val_cat_covariates_contrastive_loss: 627482.5625; val_gene_expr_recon_loss: 2791199.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5244398.0000; val_optim_loss: 5244398.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7460; val_auprc_score: 0.8747; val_best_acc_score: 0.7963; val_best_f1_score: 0.8773; train_kl_reg_loss: 9410.6654; train_edge_recon_loss: 1702065.0000; train_cat_covariates_contrastive_loss: 654292.4625; train_gene_expr_recon_loss: 2784625.3500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5150393.5000; train_optim_loss: 5150393.5000; val_kl_reg_loss: 9351.8555; val_edge_recon_loss: 1853016.5000; val_cat_covariates_contrastive_loss: 627746.1875; val_gene_expr_recon_loss: 2749151.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5239266.0000; val_optim_loss: 5239266.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7630; val_auprc_score: 0.8929; val_best_acc_score: 0.8083; val_best_f1_score: 0.8844; train_kl_reg_loss: 10128.3633; train_edge_recon_loss: 1729992.9750; train_cat_covariates_contrastive_loss: 647359.4000; train_gene_expr_recon_loss: 2757221.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5144702.6000; train_optim_loss: 5144702.6000; val_kl_reg_loss: 10565.9746; val_edge_recon_loss: 1703300.5000; val_cat_covariates_contrastive_loss: 627391.2500; val_gene_expr_recon_loss: 2735341.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5076599.0000; val_optim_loss: 5076599.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7372; val_auprc_score: 0.8759; val_best_acc_score: 0.8022; val_best_f1_score: 0.8814; train_kl_reg_loss: 11174.9701; train_edge_recon_loss: 1635492.1250; train_cat_covariates_contrastive_loss: 644424.2500; train_gene_expr_recon_loss: 2739048.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5030139.8000; train_optim_loss: 5030139.8000; val_kl_reg_loss: 12091.8691; val_edge_recon_loss: 1688580.1250; val_cat_covariates_contrastive_loss: 627220.8125; val_gene_expr_recon_loss: 2720128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5048021.0000; val_optim_loss: 5048021.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7579; val_auprc_score: 0.8975; val_best_acc_score: 0.8085; val_best_f1_score: 0.8850; train_kl_reg_loss: 13165.2006; train_edge_recon_loss: 1595962.9500; train_cat_covariates_contrastive_loss: 638721.5000; train_gene_expr_recon_loss: 2717636.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4965485.8000; train_optim_loss: 4965485.8000; val_kl_reg_loss: 15162.8770; val_edge_recon_loss: 1590127.7500; val_cat_covariates_contrastive_loss: 626989.2500; val_gene_expr_recon_loss: 2708235.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4940515.0000; val_optim_loss: 4940515.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7636; val_auprc_score: 0.8998; val_best_acc_score: 0.8098; val_best_f1_score: 0.8847; train_kl_reg_loss: 16328.2857; train_edge_recon_loss: 1588830.4750; train_cat_covariates_contrastive_loss: 631033.5250; train_gene_expr_recon_loss: 2710142.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4946334.3000; train_optim_loss: 4946334.3000; val_kl_reg_loss: 17426.5391; val_edge_recon_loss: 1537112.1250; val_cat_covariates_contrastive_loss: 626922.8750; val_gene_expr_recon_loss: 2695219.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4876681.0000; val_optim_loss: 4876681.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7438; val_auprc_score: 0.8837; val_best_acc_score: 0.7974; val_best_f1_score: 0.8781; train_kl_reg_loss: 18043.8402; train_edge_recon_loss: 1576210.8000; train_cat_covariates_contrastive_loss: 631545.5250; train_gene_expr_recon_loss: 2687035.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4912836.0000; train_optim_loss: 4912836.0000; val_kl_reg_loss: 17555.9844; val_edge_recon_loss: 1651517.2500; val_cat_covariates_contrastive_loss: 626955.5000; val_gene_expr_recon_loss: 2677813.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4973842.0000; val_optim_loss: 4973842.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7537; val_auprc_score: 0.8876; val_best_acc_score: 0.7939; val_best_f1_score: 0.8748; train_kl_reg_loss: 18343.1008; train_edge_recon_loss: 1548292.5000; train_cat_covariates_contrastive_loss: 632614.6625; train_gene_expr_recon_loss: 2683491.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4882741.6000; train_optim_loss: 4882741.6000; val_kl_reg_loss: 20266.0371; val_edge_recon_loss: 1611671.8750; val_cat_covariates_contrastive_loss: 626981.0625; val_gene_expr_recon_loss: 2658082.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4917001.0000; val_optim_loss: 4917001.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7511; val_auprc_score: 0.8878; val_best_acc_score: 0.7902; val_best_f1_score: 0.8740; train_kl_reg_loss: 20697.4176; train_edge_recon_loss: 1565770.3750; train_cat_covariates_contrastive_loss: 629567.2375; train_gene_expr_recon_loss: 2658467.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4874502.8000; train_optim_loss: 4874502.8000; val_kl_reg_loss: 19542.2539; val_edge_recon_loss: 1660013.0000; val_cat_covariates_contrastive_loss: 626951.3750; val_gene_expr_recon_loss: 2648312.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4954819.0000; val_optim_loss: 4954819.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7531; val_auprc_score: 0.8868; val_best_acc_score: 0.7913; val_best_f1_score: 0.8735; train_kl_reg_loss: 19733.8152; train_edge_recon_loss: 1556611.6000; train_cat_covariates_contrastive_loss: 631268.5500; train_gene_expr_recon_loss: 2651449.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4859063.6000; train_optim_loss: 4859063.6000; val_kl_reg_loss: 19718.2070; val_edge_recon_loss: 1644478.5000; val_cat_covariates_contrastive_loss: 627027.7500; val_gene_expr_recon_loss: 2630984.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4922209.0000; val_optim_loss: 4922209.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7557; val_auprc_score: 0.8879; val_best_acc_score: 0.7960; val_best_f1_score: 0.8763; train_kl_reg_loss: 20264.2363; train_edge_recon_loss: 1579674.8500; train_cat_covariates_contrastive_loss: 630154.7125; train_gene_expr_recon_loss: 2633663.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4863757.6000; train_optim_loss: 4863757.6000; val_kl_reg_loss: 19689.9062; val_edge_recon_loss: 1652544.1250; val_cat_covariates_contrastive_loss: 627067.5625; val_gene_expr_recon_loss: 2629926.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4929228.0000; val_optim_loss: 4929228.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7566; val_auprc_score: 0.8978; val_best_acc_score: 0.8048; val_best_f1_score: 0.8825; train_kl_reg_loss: 20025.6758; train_edge_recon_loss: 1559976.1500; train_cat_covariates_contrastive_loss: 629975.4750; train_gene_expr_recon_loss: 2632506.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842484.0000; train_optim_loss: 4842484.0000; val_kl_reg_loss: 19361.4375; val_edge_recon_loss: 1547221.8750; val_cat_covariates_contrastive_loss: 627077.0625; val_gene_expr_recon_loss: 2634131.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4827792.0000; val_optim_loss: 4827792.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7474; val_auprc_score: 0.8843; val_best_acc_score: 0.7937; val_best_f1_score: 0.8762; train_kl_reg_loss: 19568.5797; train_edge_recon_loss: 1548092.3500; train_cat_covariates_contrastive_loss: 631120.8250; train_gene_expr_recon_loss: 2625942.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4824724.3000; train_optim_loss: 4824724.3000; val_kl_reg_loss: 19491.5156; val_edge_recon_loss: 1632939.6250; val_cat_covariates_contrastive_loss: 627006.7500; val_gene_expr_recon_loss: 2631623.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4911061.0000; val_optim_loss: 4911061.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7687; val_auprc_score: 0.8994; val_best_acc_score: 0.8059; val_best_f1_score: 0.8808; train_kl_reg_loss: 19581.5887; train_edge_recon_loss: 1572458.6500; train_cat_covariates_contrastive_loss: 630821.3750; train_gene_expr_recon_loss: 2633052.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4855914.7000; train_optim_loss: 4855914.7000; val_kl_reg_loss: 19099.7754; val_edge_recon_loss: 1575761.1250; val_cat_covariates_contrastive_loss: 626955.6875; val_gene_expr_recon_loss: 2635721.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4857538.0000; val_optim_loss: 4857538.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7554; val_auprc_score: 0.8945; val_best_acc_score: 0.8038; val_best_f1_score: 0.8842; train_kl_reg_loss: 19318.4836; train_edge_recon_loss: 1536673.9250; train_cat_covariates_contrastive_loss: 631285.9000; train_gene_expr_recon_loss: 2625041.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4812320.0000; train_optim_loss: 4812320.0000; val_kl_reg_loss: 19206.5977; val_edge_recon_loss: 1539095.3750; val_cat_covariates_contrastive_loss: 627037.8750; val_gene_expr_recon_loss: 2628540.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4813881.0000; val_optim_loss: 4813881.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7511; val_auprc_score: 0.8908; val_best_acc_score: 0.7990; val_best_f1_score: 0.8790; train_kl_reg_loss: 19477.9840; train_edge_recon_loss: 1561742.1750; train_cat_covariates_contrastive_loss: 630152.9875; train_gene_expr_recon_loss: 2625956.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4837330.0000; train_optim_loss: 4837330.0000; val_kl_reg_loss: 18996.3320; val_edge_recon_loss: 1624718.6250; val_cat_covariates_contrastive_loss: 627093.6250; val_gene_expr_recon_loss: 2616278.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887087.0000; val_optim_loss: 4887087.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7504; val_auprc_score: 0.8932; val_best_acc_score: 0.8064; val_best_f1_score: 0.8840; train_kl_reg_loss: 19514.8539; train_edge_recon_loss: 1534796.3000; train_cat_covariates_contrastive_loss: 630200.5375; train_gene_expr_recon_loss: 2631659.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816170.7000; train_optim_loss: 4816170.7000; val_kl_reg_loss: 18907.8750; val_edge_recon_loss: 1564602.0000; val_cat_covariates_contrastive_loss: 627068.0625; val_gene_expr_recon_loss: 2616349.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4826927.5000; val_optim_loss: 4826927.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7565; val_auprc_score: 0.8856; val_best_acc_score: 0.7927; val_best_f1_score: 0.8739; train_kl_reg_loss: 19669.0613; train_edge_recon_loss: 1539061.1000; train_cat_covariates_contrastive_loss: 629510.0000; train_gene_expr_recon_loss: 2628724.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816964.2000; train_optim_loss: 4816964.2000; val_kl_reg_loss: 19096.4082; val_edge_recon_loss: 1648839.8750; val_cat_covariates_contrastive_loss: 627002.5000; val_gene_expr_recon_loss: 2617367.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912306.0000; val_optim_loss: 4912306.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7564; val_auprc_score: 0.8849; val_best_acc_score: 0.7980; val_best_f1_score: 0.8759; train_kl_reg_loss: 19228.6348; train_edge_recon_loss: 1528707.7750; train_cat_covariates_contrastive_loss: 630557.3875; train_gene_expr_recon_loss: 2625445.9500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803939.8000; train_optim_loss: 4803939.8000; val_kl_reg_loss: 19085.3887; val_edge_recon_loss: 1670306.6250; val_cat_covariates_contrastive_loss: 627121.9375; val_gene_expr_recon_loss: 2619963.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4936477.0000; val_optim_loss: 4936477.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7580; val_auprc_score: 0.8915; val_best_acc_score: 0.7988; val_best_f1_score: 0.8776; train_kl_reg_loss: 19381.4363; train_edge_recon_loss: 1548472.2250; train_cat_covariates_contrastive_loss: 629924.8125; train_gene_expr_recon_loss: 2628408.8500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4826187.3000; train_optim_loss: 4826187.3000; val_kl_reg_loss: 18939.1250; val_edge_recon_loss: 1628962.0000; val_cat_covariates_contrastive_loss: 627256.7500; val_gene_expr_recon_loss: 2631350.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4906509.0000; val_optim_loss: 4906509.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7481; val_auprc_score: 0.8863; val_best_acc_score: 0.7950; val_best_f1_score: 0.8756; train_kl_reg_loss: 19088.8234; train_edge_recon_loss: 1525175.2750; train_cat_covariates_contrastive_loss: 630355.0500; train_gene_expr_recon_loss: 2633166.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4807785.9000; train_optim_loss: 4807785.9000; val_kl_reg_loss: 18857.9629; val_edge_recon_loss: 1651560.5000; val_cat_covariates_contrastive_loss: 626953.2500; val_gene_expr_recon_loss: 2619416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4916788.0000; val_optim_loss: 4916788.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7331; val_auprc_score: 0.8769; val_best_acc_score: 0.7915; val_best_f1_score: 0.8732; train_kl_reg_loss: 19010.0117; train_edge_recon_loss: 1561071.7500; train_cat_covariates_contrastive_loss: 630976.9750; train_gene_expr_recon_loss: 2621934.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832992.8000; train_optim_loss: 4832992.8000; val_kl_reg_loss: 18837.9238; val_edge_recon_loss: 1681358.5000; val_cat_covariates_contrastive_loss: 627090.1250; val_gene_expr_recon_loss: 2622916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950202.5000; val_optim_loss: 4950202.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7635; val_auprc_score: 0.8935; val_best_acc_score: 0.8055; val_best_f1_score: 0.8821; train_kl_reg_loss: 19110.9238; train_edge_recon_loss: 1540516.7500; train_cat_covariates_contrastive_loss: 630814.9125; train_gene_expr_recon_loss: 2619639.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810081.9000; train_optim_loss: 4810081.9000; val_kl_reg_loss: 19010.4727; val_edge_recon_loss: 1589305.5000; val_cat_covariates_contrastive_loss: 627157.1875; val_gene_expr_recon_loss: 2630162.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865635.5000; val_optim_loss: 4865635.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 50 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.7567
val AUPRC score: 0.8902
val best accuracy score: 0.8087
val best F1 score: 0.8835
val target rna MSE score: 0.8140
val source rna MSE score: 0.2933
Val cat covariate0 mean sim diff: 0.0166
Val cat covariate1 mean sim diff: 0.0166
Duration of model training in run 5: 0 hours, 0 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9073; val_auprc_score: 0.9643; val_best_acc_score: 0.8434; val_best_f1_score: 0.9031; train_kl_reg_loss: 172.2836; train_edge_recon_loss: 1743585.1667; train_cat_covariates_contrastive_loss: 1287510.2083; train_gene_expr_recon_loss: 3656847.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6688115.3333; train_optim_loss: 6688115.3333; val_kl_reg_loss: 893.5803; val_edge_recon_loss: 1987571.2500; val_cat_covariates_contrastive_loss: 628736.3750; val_gene_expr_recon_loss: 3515858.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6133059.5000; val_optim_loss: 6133059.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9176; val_auprc_score: 0.9713; val_best_acc_score: 0.7739; val_best_f1_score: 0.8688; train_kl_reg_loss: 1725.8037; train_edge_recon_loss: 1801333.7917; train_cat_covariates_contrastive_loss: 883541.6458; train_gene_expr_recon_loss: 3535033.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6221634.8333; train_optim_loss: 6221634.8333; val_kl_reg_loss: 3083.6953; val_edge_recon_loss: 2042695.0000; val_cat_covariates_contrastive_loss: 627200.9375; val_gene_expr_recon_loss: 3387463.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6060443.0000; val_optim_loss: 6060443.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9101; val_auprc_score: 0.9630; val_best_acc_score: 0.7593; val_best_f1_score: 0.8615; train_kl_reg_loss: 3686.6264; train_edge_recon_loss: 1930421.7500; train_cat_covariates_contrastive_loss: 674075.9167; train_gene_expr_recon_loss: 3436760.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6044944.6667; train_optim_loss: 6044944.6667; val_kl_reg_loss: 4341.1357; val_edge_recon_loss: 2043064.6250; val_cat_covariates_contrastive_loss: 627000.0625; val_gene_expr_recon_loss: 3348103.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6022509.0000; val_optim_loss: 6022509.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9122; val_auprc_score: 0.9681; val_best_acc_score: 0.7678; val_best_f1_score: 0.8674; train_kl_reg_loss: 4508.7257; train_edge_recon_loss: 1987379.1250; train_cat_covariates_contrastive_loss: 645486.7292; train_gene_expr_recon_loss: 3366253.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6003627.6667; train_optim_loss: 6003627.6667; val_kl_reg_loss: 4311.9600; val_edge_recon_loss: 1956304.2500; val_cat_covariates_contrastive_loss: 626978.1250; val_gene_expr_recon_loss: 3271480.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5859075.0000; val_optim_loss: 5859075.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9046; val_auprc_score: 0.9632; val_best_acc_score: 0.7822; val_best_f1_score: 0.8736; train_kl_reg_loss: 4168.6903; train_edge_recon_loss: 1932406.0833; train_cat_covariates_contrastive_loss: 647001.6875; train_gene_expr_recon_loss: 3298657.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5882234.1667; train_optim_loss: 5882234.1667; val_kl_reg_loss: 3408.5486; val_edge_recon_loss: 2008372.0000; val_cat_covariates_contrastive_loss: 627016.7500; val_gene_expr_recon_loss: 3213446.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5852244.0000; val_optim_loss: 5852244.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9159; val_auprc_score: 0.9655; val_best_acc_score: 0.7874; val_best_f1_score: 0.8734; train_kl_reg_loss: 3070.4343; train_edge_recon_loss: 1921290.4583; train_cat_covariates_contrastive_loss: 669156.9583; train_gene_expr_recon_loss: 3245689.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5839206.8333; train_optim_loss: 5839206.8333; val_kl_reg_loss: 2197.2974; val_edge_recon_loss: 2152514.5000; val_cat_covariates_contrastive_loss: 627248.5625; val_gene_expr_recon_loss: 3177397.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5959357.0000; val_optim_loss: 5959357.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8983; val_auprc_score: 0.9609; val_best_acc_score: 0.8064; val_best_f1_score: 0.8862; train_kl_reg_loss: 2072.1760; train_edge_recon_loss: 1814763.0417; train_cat_covariates_contrastive_loss: 712945.1250; train_gene_expr_recon_loss: 3207554.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5737334.5000; train_optim_loss: 5737334.5000; val_kl_reg_loss: 1874.4302; val_edge_recon_loss: 1964664.6250; val_cat_covariates_contrastive_loss: 627287.0000; val_gene_expr_recon_loss: 3119041.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5712867.5000; val_optim_loss: 5712867.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8793; val_auprc_score: 0.9496; val_best_acc_score: 0.7951; val_best_f1_score: 0.8781; train_kl_reg_loss: 2140.1549; train_edge_recon_loss: 1827327.2500; train_cat_covariates_contrastive_loss: 704404.0833; train_gene_expr_recon_loss: 3159853.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5693724.5000; train_optim_loss: 5693724.5000; val_kl_reg_loss: 2467.3538; val_edge_recon_loss: 2084607.0000; val_cat_covariates_contrastive_loss: 627324.3750; val_gene_expr_recon_loss: 3087373.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5801772.0000; val_optim_loss: 5801772.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8748; val_auprc_score: 0.9520; val_best_acc_score: 0.8183; val_best_f1_score: 0.8899; train_kl_reg_loss: 2637.2848; train_edge_recon_loss: 1848226.5000; train_cat_covariates_contrastive_loss: 676212.2292; train_gene_expr_recon_loss: 3103586.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5630662.5000; train_optim_loss: 5630662.5000; val_kl_reg_loss: 2512.4478; val_edge_recon_loss: 1999641.0000; val_cat_covariates_contrastive_loss: 627380.2500; val_gene_expr_recon_loss: 3046156.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5675690.0000; val_optim_loss: 5675690.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8436; val_auprc_score: 0.9338; val_best_acc_score: 0.8088; val_best_f1_score: 0.8778; train_kl_reg_loss: 2503.5555; train_edge_recon_loss: 1800124.5000; train_cat_covariates_contrastive_loss: 686528.4583; train_gene_expr_recon_loss: 3076337.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5565493.6667; train_optim_loss: 5565493.6667; val_kl_reg_loss: 2404.8198; val_edge_recon_loss: 1999353.3750; val_cat_covariates_contrastive_loss: 627425.5625; val_gene_expr_recon_loss: 3017106.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5646290.0000; val_optim_loss: 5646290.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8305; val_auprc_score: 0.9307; val_best_acc_score: 0.7993; val_best_f1_score: 0.8809; train_kl_reg_loss: 2564.2599; train_edge_recon_loss: 1815843.9583; train_cat_covariates_contrastive_loss: 678172.3958; train_gene_expr_recon_loss: 3034353.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5530933.6667; train_optim_loss: 5530933.6667; val_kl_reg_loss: 2733.8254; val_edge_recon_loss: 2010719.5000; val_cat_covariates_contrastive_loss: 627906.5625; val_gene_expr_recon_loss: 2962571.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5603931.0000; val_optim_loss: 5603931.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8057; val_auprc_score: 0.9214; val_best_acc_score: 0.8213; val_best_f1_score: 0.8929; train_kl_reg_loss: 2868.0049; train_edge_recon_loss: 1787155.7917; train_cat_covariates_contrastive_loss: 666753.0417; train_gene_expr_recon_loss: 2993920.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5450697.6667; train_optim_loss: 5450697.6667; val_kl_reg_loss: 2821.5693; val_edge_recon_loss: 1914933.3750; val_cat_covariates_contrastive_loss: 627796.8750; val_gene_expr_recon_loss: 2940529.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5486081.5000; val_optim_loss: 5486081.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7790; val_auprc_score: 0.9048; val_best_acc_score: 0.8011; val_best_f1_score: 0.8798; train_kl_reg_loss: 2814.3547; train_edge_recon_loss: 1784579.3750; train_cat_covariates_contrastive_loss: 669962.4167; train_gene_expr_recon_loss: 2962917.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5420274.0000; train_optim_loss: 5420274.0000; val_kl_reg_loss: 2737.7554; val_edge_recon_loss: 1977060.0000; val_cat_covariates_contrastive_loss: 628522.6250; val_gene_expr_recon_loss: 2904265.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5512586.0000; val_optim_loss: 5512586.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7658; val_auprc_score: 0.8961; val_best_acc_score: 0.7889; val_best_f1_score: 0.8744; train_kl_reg_loss: 2940.9712; train_edge_recon_loss: 1730242.0417; train_cat_covariates_contrastive_loss: 671656.2500; train_gene_expr_recon_loss: 2933789.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5338628.1667; train_optim_loss: 5338628.1667; val_kl_reg_loss: 3205.0571; val_edge_recon_loss: 1909079.8750; val_cat_covariates_contrastive_loss: 628245.6250; val_gene_expr_recon_loss: 2872418.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5412949.0000; val_optim_loss: 5412949.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7669; val_auprc_score: 0.8869; val_best_acc_score: 0.7917; val_best_f1_score: 0.8739; train_kl_reg_loss: 3529.7297; train_edge_recon_loss: 1737778.8750; train_cat_covariates_contrastive_loss: 666122.1458; train_gene_expr_recon_loss: 2901969.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5309400.3333; train_optim_loss: 5309400.3333; val_kl_reg_loss: 3891.6904; val_edge_recon_loss: 1919646.8750; val_cat_covariates_contrastive_loss: 628804.6250; val_gene_expr_recon_loss: 2843655.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5395999.0000; val_optim_loss: 5395999.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7764; val_auprc_score: 0.9007; val_best_acc_score: 0.7990; val_best_f1_score: 0.8760; train_kl_reg_loss: 4100.0003; train_edge_recon_loss: 1701844.5417; train_cat_covariates_contrastive_loss: 652944.8333; train_gene_expr_recon_loss: 2873065.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231954.6667; train_optim_loss: 5231954.6667; val_kl_reg_loss: 4392.2466; val_edge_recon_loss: 1846059.8750; val_cat_covariates_contrastive_loss: 628269.5000; val_gene_expr_recon_loss: 2829454.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5308176.0000; val_optim_loss: 5308176.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7314; val_auprc_score: 0.8733; val_best_acc_score: 0.7851; val_best_f1_score: 0.8698; train_kl_reg_loss: 4724.8122; train_edge_recon_loss: 1723454.4167; train_cat_covariates_contrastive_loss: 660245.0208; train_gene_expr_recon_loss: 2855423.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5243847.6667; train_optim_loss: 5243847.6667; val_kl_reg_loss: 5299.7612; val_edge_recon_loss: 1817662.6250; val_cat_covariates_contrastive_loss: 628225.0625; val_gene_expr_recon_loss: 2798341.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5249529.0000; val_optim_loss: 5249529.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7584; val_auprc_score: 0.8868; val_best_acc_score: 0.7910; val_best_f1_score: 0.8737; train_kl_reg_loss: 5693.3926; train_edge_recon_loss: 1683141.0833; train_cat_covariates_contrastive_loss: 641948.9375; train_gene_expr_recon_loss: 2832476.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5163260.0000; train_optim_loss: 5163260.0000; val_kl_reg_loss: 6054.3916; val_edge_recon_loss: 1735592.3750; val_cat_covariates_contrastive_loss: 628203.2500; val_gene_expr_recon_loss: 2779925.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5149775.0000; val_optim_loss: 5149775.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7346; val_auprc_score: 0.8846; val_best_acc_score: 0.7971; val_best_f1_score: 0.8780; train_kl_reg_loss: 6368.1546; train_edge_recon_loss: 1663465.2500; train_cat_covariates_contrastive_loss: 642593.0417; train_gene_expr_recon_loss: 2813714.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5126140.6667; train_optim_loss: 5126140.6667; val_kl_reg_loss: 6842.2344; val_edge_recon_loss: 1671215.1250; val_cat_covariates_contrastive_loss: 627706.4375; val_gene_expr_recon_loss: 2763387.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5069151.0000; val_optim_loss: 5069151.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7280; val_auprc_score: 0.8731; val_best_acc_score: 0.7886; val_best_f1_score: 0.8746; train_kl_reg_loss: 7286.5513; train_edge_recon_loss: 1616057.7917; train_cat_covariates_contrastive_loss: 643297.8333; train_gene_expr_recon_loss: 2792413.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5059055.6667; train_optim_loss: 5059055.6667; val_kl_reg_loss: 8300.4414; val_edge_recon_loss: 1676296.5000; val_cat_covariates_contrastive_loss: 627140.6250; val_gene_expr_recon_loss: 2748932.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5060670.0000; val_optim_loss: 5060670.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7490; val_auprc_score: 0.8901; val_best_acc_score: 0.7968; val_best_f1_score: 0.8782; train_kl_reg_loss: 8968.0423; train_edge_recon_loss: 1582154.2917; train_cat_covariates_contrastive_loss: 632264.5000; train_gene_expr_recon_loss: 2783217.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5006604.1667; train_optim_loss: 5006604.1667; val_kl_reg_loss: 9837.8242; val_edge_recon_loss: 1612171.3750; val_cat_covariates_contrastive_loss: 627317.1875; val_gene_expr_recon_loss: 2729656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4978982.5000; val_optim_loss: 4978982.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7465; val_auprc_score: 0.8780; val_best_acc_score: 0.7879; val_best_f1_score: 0.8711; train_kl_reg_loss: 10367.5111; train_edge_recon_loss: 1590752.4167; train_cat_covariates_contrastive_loss: 632728.3125; train_gene_expr_recon_loss: 2757964.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4991812.6667; train_optim_loss: 4991812.6667; val_kl_reg_loss: 11622.1533; val_edge_recon_loss: 1675819.5000; val_cat_covariates_contrastive_loss: 627279.5000; val_gene_expr_recon_loss: 2716215.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5030936.0000; val_optim_loss: 5030936.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7290; val_auprc_score: 0.8865; val_best_acc_score: 0.7912; val_best_f1_score: 0.8750; train_kl_reg_loss: 12619.0192; train_edge_recon_loss: 1584572.5000; train_cat_covariates_contrastive_loss: 631350.1250; train_gene_expr_recon_loss: 2752270.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4980812.3333; train_optim_loss: 4980812.3333; val_kl_reg_loss: 14035.4414; val_edge_recon_loss: 1607323.7500; val_cat_covariates_contrastive_loss: 627085.3750; val_gene_expr_recon_loss: 2702628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4951072.5000; val_optim_loss: 4951072.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7287; val_auprc_score: 0.8889; val_best_acc_score: 0.7888; val_best_f1_score: 0.8757; train_kl_reg_loss: 14534.2861; train_edge_recon_loss: 1559207.3750; train_cat_covariates_contrastive_loss: 629387.7708; train_gene_expr_recon_loss: 2734527.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4937656.5000; train_optim_loss: 4937656.5000; val_kl_reg_loss: 14666.9121; val_edge_recon_loss: 1619584.0000; val_cat_covariates_contrastive_loss: 627047.7500; val_gene_expr_recon_loss: 2681767.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4943066.0000; val_optim_loss: 4943066.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7398; val_auprc_score: 0.8855; val_best_acc_score: 0.7980; val_best_f1_score: 0.8789; train_kl_reg_loss: 15531.1898; train_edge_recon_loss: 1537724.0417; train_cat_covariates_contrastive_loss: 629425.3542; train_gene_expr_recon_loss: 2721040.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4903720.8333; train_optim_loss: 4903720.8333; val_kl_reg_loss: 16344.4512; val_edge_recon_loss: 1591705.2500; val_cat_covariates_contrastive_loss: 627026.7500; val_gene_expr_recon_loss: 2682259.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4917336.0000; val_optim_loss: 4917336.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7485; val_auprc_score: 0.8825; val_best_acc_score: 0.7971; val_best_f1_score: 0.8749; train_kl_reg_loss: 16750.0586; train_edge_recon_loss: 1546326.5000; train_cat_covariates_contrastive_loss: 629765.5417; train_gene_expr_recon_loss: 2704515.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4897357.5000; train_optim_loss: 4897357.5000; val_kl_reg_loss: 17419.5703; val_edge_recon_loss: 1576132.5000; val_cat_covariates_contrastive_loss: 627092.3125; val_gene_expr_recon_loss: 2658882.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4879527.0000; val_optim_loss: 4879527.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7386; val_auprc_score: 0.8923; val_best_acc_score: 0.8049; val_best_f1_score: 0.8835; train_kl_reg_loss: 17352.8620; train_edge_recon_loss: 1569891.1667; train_cat_covariates_contrastive_loss: 629854.3125; train_gene_expr_recon_loss: 2692983.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4910082.3333; train_optim_loss: 4910082.3333; val_kl_reg_loss: 16752.4883; val_edge_recon_loss: 1555090.0000; val_cat_covariates_contrastive_loss: 627244.7500; val_gene_expr_recon_loss: 2649100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848187.0000; val_optim_loss: 4848187.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7595; val_auprc_score: 0.8997; val_best_acc_score: 0.8099; val_best_f1_score: 0.8842; train_kl_reg_loss: 16733.4801; train_edge_recon_loss: 1562934.9583; train_cat_covariates_contrastive_loss: 630126.8542; train_gene_expr_recon_loss: 2680224.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4890019.3333; train_optim_loss: 4890019.3333; val_kl_reg_loss: 16400.5352; val_edge_recon_loss: 1493458.6250; val_cat_covariates_contrastive_loss: 626985.0000; val_gene_expr_recon_loss: 2647958.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4784802.0000; val_optim_loss: 4784802.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7422; val_auprc_score: 0.8850; val_best_acc_score: 0.7912; val_best_f1_score: 0.8734; train_kl_reg_loss: 16588.6478; train_edge_recon_loss: 1563780.7917; train_cat_covariates_contrastive_loss: 630757.1458; train_gene_expr_recon_loss: 2672164.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883291.3333; train_optim_loss: 4883291.3333; val_kl_reg_loss: 17115.6250; val_edge_recon_loss: 1624789.1250; val_cat_covariates_contrastive_loss: 627092.0000; val_gene_expr_recon_loss: 2628932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4897929.0000; val_optim_loss: 4897929.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7401; val_auprc_score: 0.8882; val_best_acc_score: 0.7791; val_best_f1_score: 0.8666; train_kl_reg_loss: 17566.6491; train_edge_recon_loss: 1555055.0000; train_cat_covariates_contrastive_loss: 629710.7500; train_gene_expr_recon_loss: 2662716.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4865049.1667; train_optim_loss: 4865049.1667; val_kl_reg_loss: 16996.5742; val_edge_recon_loss: 1696081.5000; val_cat_covariates_contrastive_loss: 627267.0000; val_gene_expr_recon_loss: 2618456.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4958801.0000; val_optim_loss: 4958801.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7246; val_auprc_score: 0.8678; val_best_acc_score: 0.7852; val_best_f1_score: 0.8715; train_kl_reg_loss: 17919.3053; train_edge_recon_loss: 1523395.0000; train_cat_covariates_contrastive_loss: 629803.6667; train_gene_expr_recon_loss: 2650719.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821837.5000; train_optim_loss: 4821837.5000; val_kl_reg_loss: 16725.9297; val_edge_recon_loss: 1683865.6250; val_cat_covariates_contrastive_loss: 627054.1875; val_gene_expr_recon_loss: 2614215.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4941861.0000; val_optim_loss: 4941861.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7492; val_auprc_score: 0.8910; val_best_acc_score: 0.7957; val_best_f1_score: 0.8769; train_kl_reg_loss: 16483.8288; train_edge_recon_loss: 1552083.9167; train_cat_covariates_contrastive_loss: 630631.6875; train_gene_expr_recon_loss: 2644968.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4844167.5000; train_optim_loss: 4844167.5000; val_kl_reg_loss: 15759.0850; val_edge_recon_loss: 1605803.2500; val_cat_covariates_contrastive_loss: 627059.8125; val_gene_expr_recon_loss: 2599041.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4847663.0000; val_optim_loss: 4847663.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7456; val_auprc_score: 0.8898; val_best_acc_score: 0.7942; val_best_f1_score: 0.8757; train_kl_reg_loss: 16667.9762; train_edge_recon_loss: 1530775.0000; train_cat_covariates_contrastive_loss: 630439.1458; train_gene_expr_recon_loss: 2643147.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4821029.5000; train_optim_loss: 4821029.5000; val_kl_reg_loss: 16430.5078; val_edge_recon_loss: 1614969.6250; val_cat_covariates_contrastive_loss: 627257.7500; val_gene_expr_recon_loss: 2612262.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870920.5000; val_optim_loss: 4870920.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7536; val_auprc_score: 0.8914; val_best_acc_score: 0.7912; val_best_f1_score: 0.8740; train_kl_reg_loss: 16824.9740; train_edge_recon_loss: 1524265.0833; train_cat_covariates_contrastive_loss: 630806.3958; train_gene_expr_recon_loss: 2640693.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4812589.8333; train_optim_loss: 4812589.8333; val_kl_reg_loss: 16352.6680; val_edge_recon_loss: 1607601.0000; val_cat_covariates_contrastive_loss: 627147.6875; val_gene_expr_recon_loss: 2604865.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4855967.0000; val_optim_loss: 4855967.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7498; val_auprc_score: 0.8884; val_best_acc_score: 0.7952; val_best_f1_score: 0.8765; train_kl_reg_loss: 16745.0833; train_edge_recon_loss: 1558169.7917; train_cat_covariates_contrastive_loss: 630661.3333; train_gene_expr_recon_loss: 2636382.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841958.3333; train_optim_loss: 4841958.3333; val_kl_reg_loss: 16837.5234; val_edge_recon_loss: 1607966.1250; val_cat_covariates_contrastive_loss: 627261.0625; val_gene_expr_recon_loss: 2601362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4853427.0000; val_optim_loss: 4853427.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7401; val_auprc_score: 0.8807; val_best_acc_score: 0.7928; val_best_f1_score: 0.8747; train_kl_reg_loss: 17027.7871; train_edge_recon_loss: 1548131.5833; train_cat_covariates_contrastive_loss: 630720.5833; train_gene_expr_recon_loss: 2638824.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834705.0000; train_optim_loss: 4834705.0000; val_kl_reg_loss: 17063.6328; val_edge_recon_loss: 1599644.1250; val_cat_covariates_contrastive_loss: 627155.7500; val_gene_expr_recon_loss: 2599975.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4843839.0000; val_optim_loss: 4843839.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 40 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.7511
val AUPRC score: 0.8925
val best accuracy score: 0.7861
val best F1 score: 0.8714
val target rna MSE score: 0.8872
val source rna MSE score: 0.5274
Val cat covariate0 mean sim diff: -0.0014
Val cat covariate1 mean sim diff: -0.0014
Duration of model training in run 4: 0 hours, 0 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 11980
Number of validation edges: 1331
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9231; val_auprc_score: 0.9696; val_best_acc_score: 0.8274; val_best_f1_score: 0.8940; train_kl_reg_loss: 210.7790; train_edge_recon_loss: 1723817.6250; train_cat_covariates_contrastive_loss: 1277492.6250; train_gene_expr_recon_loss: 3611896.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6613417.3333; train_optim_loss: 6613417.3333; val_kl_reg_loss: 1130.1113; val_edge_recon_loss: 2022652.8750; val_cat_covariates_contrastive_loss: 628479.3125; val_gene_expr_recon_loss: 3603808.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6256071.0000; val_optim_loss: 6256071.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9054; val_auprc_score: 0.9634; val_best_acc_score: 0.7572; val_best_f1_score: 0.8601; train_kl_reg_loss: 1816.9303; train_edge_recon_loss: 1797130.1250; train_cat_covariates_contrastive_loss: 871055.0208; train_gene_expr_recon_loss: 3490422.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6160425.0000; train_optim_loss: 6160425.0000; val_kl_reg_loss: 3626.7585; val_edge_recon_loss: 2059958.3750; val_cat_covariates_contrastive_loss: 627128.3125; val_gene_expr_recon_loss: 3450679.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6141392.5000; val_optim_loss: 6141392.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9128; val_auprc_score: 0.9685; val_best_acc_score: 0.7507; val_best_f1_score: 0.8576; train_kl_reg_loss: 4446.9229; train_edge_recon_loss: 1960792.1667; train_cat_covariates_contrastive_loss: 660147.4792; train_gene_expr_recon_loss: 3373007.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5998394.1667; train_optim_loss: 5998394.1667; val_kl_reg_loss: 5914.5488; val_edge_recon_loss: 2026325.0000; val_cat_covariates_contrastive_loss: 626884.8125; val_gene_expr_recon_loss: 3379759.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6038884.0000; val_optim_loss: 6038884.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8943; val_auprc_score: 0.9572; val_best_acc_score: 0.7494; val_best_f1_score: 0.8568; train_kl_reg_loss: 6129.7726; train_edge_recon_loss: 1998249.2083; train_cat_covariates_contrastive_loss: 636346.2083; train_gene_expr_recon_loss: 3307506.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5948231.1667; train_optim_loss: 5948231.1667; val_kl_reg_loss: 6399.0225; val_edge_recon_loss: 2036745.3750; val_cat_covariates_contrastive_loss: 626835.5625; val_gene_expr_recon_loss: 3277035.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5947015.5000; val_optim_loss: 5947015.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8979; val_auprc_score: 0.9624; val_best_acc_score: 0.7548; val_best_f1_score: 0.8601; train_kl_reg_loss: 6125.2985; train_edge_recon_loss: 1972568.0833; train_cat_covariates_contrastive_loss: 636015.5417; train_gene_expr_recon_loss: 3223443.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5838152.8333; train_optim_loss: 5838152.8333; val_kl_reg_loss: 5482.6460; val_edge_recon_loss: 2002131.3750; val_cat_covariates_contrastive_loss: 626876.5625; val_gene_expr_recon_loss: 3215775.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5850265.5000; val_optim_loss: 5850265.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8923; val_auprc_score: 0.9572; val_best_acc_score: 0.7837; val_best_f1_score: 0.8743; train_kl_reg_loss: 4762.2183; train_edge_recon_loss: 1973964.5417; train_cat_covariates_contrastive_loss: 648748.3125; train_gene_expr_recon_loss: 3156833.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784308.3333; train_optim_loss: 5784308.3333; val_kl_reg_loss: 3538.1948; val_edge_recon_loss: 2001526.0000; val_cat_covariates_contrastive_loss: 626969.6250; val_gene_expr_recon_loss: 3174126.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806160.5000; val_optim_loss: 5806160.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8912; val_auprc_score: 0.9553; val_best_acc_score: 0.7809; val_best_f1_score: 0.8694; train_kl_reg_loss: 2958.7660; train_edge_recon_loss: 1922162.6667; train_cat_covariates_contrastive_loss: 688067.1667; train_gene_expr_recon_loss: 3134865.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5748054.1667; train_optim_loss: 5748054.1667; val_kl_reg_loss: 2241.3457; val_edge_recon_loss: 2155721.2500; val_cat_covariates_contrastive_loss: 627206.6250; val_gene_expr_recon_loss: 3140854.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5926023.5000; val_optim_loss: 5926023.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8859; val_auprc_score: 0.9590; val_best_acc_score: 0.8097; val_best_f1_score: 0.8866; train_kl_reg_loss: 2152.5730; train_edge_recon_loss: 1793096.6250; train_cat_covariates_contrastive_loss: 719471.7083; train_gene_expr_recon_loss: 3097597.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5612318.3333; train_optim_loss: 5612318.3333; val_kl_reg_loss: 2375.5054; val_edge_recon_loss: 1998381.1250; val_cat_covariates_contrastive_loss: 627178.3125; val_gene_expr_recon_loss: 3089391.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5717326.5000; val_optim_loss: 5717326.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8759; val_auprc_score: 0.9556; val_best_acc_score: 0.8213; val_best_f1_score: 0.8925; train_kl_reg_loss: 2549.3272; train_edge_recon_loss: 1810845.2500; train_cat_covariates_contrastive_loss: 699285.3333; train_gene_expr_recon_loss: 3053160.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5565839.8333; train_optim_loss: 5565839.8333; val_kl_reg_loss: 3141.6797; val_edge_recon_loss: 1965191.6250; val_cat_covariates_contrastive_loss: 627183.9375; val_gene_expr_recon_loss: 3054460.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5649978.0000; val_optim_loss: 5649978.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8405; val_auprc_score: 0.9346; val_best_acc_score: 0.8109; val_best_f1_score: 0.8798; train_kl_reg_loss: 3080.8548; train_edge_recon_loss: 1840763.2083; train_cat_covariates_contrastive_loss: 681250.5417; train_gene_expr_recon_loss: 3006512.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5531607.6667; train_optim_loss: 5531607.6667; val_kl_reg_loss: 3139.1541; val_edge_recon_loss: 2064198.0000; val_cat_covariates_contrastive_loss: 627232.6250; val_gene_expr_recon_loss: 3013857.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5708427.0000; val_optim_loss: 5708427.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8347; val_auprc_score: 0.9257; val_best_acc_score: 0.8056; val_best_f1_score: 0.8817; train_kl_reg_loss: 2932.5171; train_edge_recon_loss: 1797616.2917; train_cat_covariates_contrastive_loss: 685796.9167; train_gene_expr_recon_loss: 2973326.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5459672.6667; train_optim_loss: 5459672.6667; val_kl_reg_loss: 3009.3972; val_edge_recon_loss: 2074846.1250; val_cat_covariates_contrastive_loss: 627630.5625; val_gene_expr_recon_loss: 2984715.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5690201.0000; val_optim_loss: 5690201.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8072; val_auprc_score: 0.9209; val_best_acc_score: 0.8049; val_best_f1_score: 0.8824; train_kl_reg_loss: 2930.9347; train_edge_recon_loss: 1784151.2917; train_cat_covariates_contrastive_loss: 691799.4167; train_gene_expr_recon_loss: 2946735.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5425617.0000; train_optim_loss: 5425617.0000; val_kl_reg_loss: 3456.5991; val_edge_recon_loss: 1966524.0000; val_cat_covariates_contrastive_loss: 627843.7500; val_gene_expr_recon_loss: 2953562.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5551386.5000; val_optim_loss: 5551386.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7852; val_auprc_score: 0.9112; val_best_acc_score: 0.8006; val_best_f1_score: 0.8779; train_kl_reg_loss: 3422.4404; train_edge_recon_loss: 1797201.8750; train_cat_covariates_contrastive_loss: 669371.7708; train_gene_expr_recon_loss: 2903852.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5373849.0000; train_optim_loss: 5373849.0000; val_kl_reg_loss: 3708.7524; val_edge_recon_loss: 1932983.7500; val_cat_covariates_contrastive_loss: 628107.9375; val_gene_expr_recon_loss: 2915796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5480596.5000; val_optim_loss: 5480596.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7883; val_auprc_score: 0.9112; val_best_acc_score: 0.7973; val_best_f1_score: 0.8761; train_kl_reg_loss: 3529.5143; train_edge_recon_loss: 1788823.2083; train_cat_covariates_contrastive_loss: 675418.4792; train_gene_expr_recon_loss: 2881424.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5349195.3333; train_optim_loss: 5349195.3333; val_kl_reg_loss: 3878.7893; val_edge_recon_loss: 1905432.2500; val_cat_covariates_contrastive_loss: 628774.0625; val_gene_expr_recon_loss: 2894614.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5432699.0000; val_optim_loss: 5432699.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7592; val_auprc_score: 0.8915; val_best_acc_score: 0.7832; val_best_f1_score: 0.8714; train_kl_reg_loss: 3921.7808; train_edge_recon_loss: 1734772.4583; train_cat_covariates_contrastive_loss: 664790.5833; train_gene_expr_recon_loss: 2847865.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5251350.1667; train_optim_loss: 5251350.1667; val_kl_reg_loss: 4758.6943; val_edge_recon_loss: 1845775.8750; val_cat_covariates_contrastive_loss: 628831.0000; val_gene_expr_recon_loss: 2872865.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5352231.0000; val_optim_loss: 5352231.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7699; val_auprc_score: 0.9068; val_best_acc_score: 0.8018; val_best_f1_score: 0.8820; train_kl_reg_loss: 4812.0130; train_edge_recon_loss: 1714877.7083; train_cat_covariates_contrastive_loss: 653749.9583; train_gene_expr_recon_loss: 2830077.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203517.0000; train_optim_loss: 5203517.0000; val_kl_reg_loss: 5642.1133; val_edge_recon_loss: 1729777.0000; val_cat_covariates_contrastive_loss: 628314.3750; val_gene_expr_recon_loss: 2844652.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5208386.0000; val_optim_loss: 5208386.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7710; val_auprc_score: 0.8942; val_best_acc_score: 0.8068; val_best_f1_score: 0.8837; train_kl_reg_loss: 5465.6058; train_edge_recon_loss: 1727464.8750; train_cat_covariates_contrastive_loss: 651695.2917; train_gene_expr_recon_loss: 2814451.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5199077.0000; train_optim_loss: 5199077.0000; val_kl_reg_loss: 6273.8262; val_edge_recon_loss: 1675436.2500; val_cat_covariates_contrastive_loss: 627980.4375; val_gene_expr_recon_loss: 2822219.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5131910.0000; val_optim_loss: 5131910.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7488; val_auprc_score: 0.8864; val_best_acc_score: 0.7959; val_best_f1_score: 0.8792; train_kl_reg_loss: 6337.8477; train_edge_recon_loss: 1646757.2500; train_cat_covariates_contrastive_loss: 644316.7500; train_gene_expr_recon_loss: 2796892.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5094304.6667; train_optim_loss: 5094304.6667; val_kl_reg_loss: 7274.8770; val_edge_recon_loss: 1677749.1250; val_cat_covariates_contrastive_loss: 628232.6875; val_gene_expr_recon_loss: 2802280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5115537.0000; val_optim_loss: 5115537.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7352; val_auprc_score: 0.8919; val_best_acc_score: 0.7999; val_best_f1_score: 0.8816; train_kl_reg_loss: 7415.1553; train_edge_recon_loss: 1656307.9167; train_cat_covariates_contrastive_loss: 637283.1042; train_gene_expr_recon_loss: 2770031.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5071037.5000; train_optim_loss: 5071037.5000; val_kl_reg_loss: 8516.7451; val_edge_recon_loss: 1589796.2500; val_cat_covariates_contrastive_loss: 627804.8125; val_gene_expr_recon_loss: 2787356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5013474.0000; val_optim_loss: 5013474.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7559; val_auprc_score: 0.8995; val_best_acc_score: 0.7977; val_best_f1_score: 0.8793; train_kl_reg_loss: 8794.3965; train_edge_recon_loss: 1597313.0833; train_cat_covariates_contrastive_loss: 639256.1042; train_gene_expr_recon_loss: 2754545.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4999909.0000; train_optim_loss: 4999909.0000; val_kl_reg_loss: 10662.5830; val_edge_recon_loss: 1615780.1250; val_cat_covariates_contrastive_loss: 627547.5625; val_gene_expr_recon_loss: 2778020.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5032010.0000; val_optim_loss: 5032010.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7556; val_auprc_score: 0.8919; val_best_acc_score: 0.8050; val_best_f1_score: 0.8830; train_kl_reg_loss: 10802.9736; train_edge_recon_loss: 1576599.2500; train_cat_covariates_contrastive_loss: 631786.1667; train_gene_expr_recon_loss: 2737886.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4957074.8333; train_optim_loss: 4957074.8333; val_kl_reg_loss: 12709.7314; val_edge_recon_loss: 1577499.0000; val_cat_covariates_contrastive_loss: 627269.2500; val_gene_expr_recon_loss: 2756447.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4973925.0000; val_optim_loss: 4973925.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7621; val_auprc_score: 0.8992; val_best_acc_score: 0.7943; val_best_f1_score: 0.8767; train_kl_reg_loss: 12690.9049; train_edge_recon_loss: 1573129.4583; train_cat_covariates_contrastive_loss: 630371.0833; train_gene_expr_recon_loss: 2722024.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4938215.6667; train_optim_loss: 4938215.6667; val_kl_reg_loss: 14268.6484; val_edge_recon_loss: 1605520.2500; val_cat_covariates_contrastive_loss: 627330.1250; val_gene_expr_recon_loss: 2740634.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4987753.0000; val_optim_loss: 4987753.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7447; val_auprc_score: 0.8798; val_best_acc_score: 0.7932; val_best_f1_score: 0.8738; train_kl_reg_loss: 14716.1328; train_edge_recon_loss: 1587838.3750; train_cat_covariates_contrastive_loss: 630152.8958; train_gene_expr_recon_loss: 2711825.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4944533.0000; train_optim_loss: 4944533.0000; val_kl_reg_loss: 16845.9668; val_edge_recon_loss: 1609039.5000; val_cat_covariates_contrastive_loss: 627067.5000; val_gene_expr_recon_loss: 2724412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4977365.0000; val_optim_loss: 4977365.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7607; val_auprc_score: 0.8967; val_best_acc_score: 0.7968; val_best_f1_score: 0.8796; train_kl_reg_loss: 16399.1354; train_edge_recon_loss: 1590276.6667; train_cat_covariates_contrastive_loss: 628724.7292; train_gene_expr_recon_loss: 2687127.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4922527.6667; train_optim_loss: 4922527.6667; val_kl_reg_loss: 18221.1094; val_edge_recon_loss: 1562447.8750; val_cat_covariates_contrastive_loss: 627104.4375; val_gene_expr_recon_loss: 2713448.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4921222.0000; val_optim_loss: 4921222.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7445; val_auprc_score: 0.8979; val_best_acc_score: 0.8029; val_best_f1_score: 0.8842; train_kl_reg_loss: 17845.9056; train_edge_recon_loss: 1594470.6667; train_cat_covariates_contrastive_loss: 628325.4375; train_gene_expr_recon_loss: 2673550.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4914192.6667; train_optim_loss: 4914192.6667; val_kl_reg_loss: 19110.3164; val_edge_recon_loss: 1519907.6250; val_cat_covariates_contrastive_loss: 627107.5625; val_gene_expr_recon_loss: 2700589.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4866715.0000; val_optim_loss: 4866715.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7252; val_auprc_score: 0.8832; val_best_acc_score: 0.7877; val_best_f1_score: 0.8748; train_kl_reg_loss: 17821.8776; train_edge_recon_loss: 1538794.2083; train_cat_covariates_contrastive_loss: 628967.5833; train_gene_expr_recon_loss: 2666563.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4852146.8333; train_optim_loss: 4852146.8333; val_kl_reg_loss: 18074.1543; val_edge_recon_loss: 1619987.0000; val_cat_covariates_contrastive_loss: 627200.8125; val_gene_expr_recon_loss: 2691221.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4956483.0000; val_optim_loss: 4956483.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7399; val_auprc_score: 0.8848; val_best_acc_score: 0.7934; val_best_f1_score: 0.8777; train_kl_reg_loss: 17383.0801; train_edge_recon_loss: 1574415.5000; train_cat_covariates_contrastive_loss: 629800.6667; train_gene_expr_recon_loss: 2656777.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4878376.3333; train_optim_loss: 4878376.3333; val_kl_reg_loss: 18129.9805; val_edge_recon_loss: 1585841.6250; val_cat_covariates_contrastive_loss: 627049.0625; val_gene_expr_recon_loss: 2680989.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912010.0000; val_optim_loss: 4912010.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7670; val_auprc_score: 0.9018; val_best_acc_score: 0.8069; val_best_f1_score: 0.8843; train_kl_reg_loss: 17449.3242; train_edge_recon_loss: 1546974.5000; train_cat_covariates_contrastive_loss: 629365.8125; train_gene_expr_recon_loss: 2648738.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842528.5000; train_optim_loss: 4842528.5000; val_kl_reg_loss: 18495.8418; val_edge_recon_loss: 1566174.1250; val_cat_covariates_contrastive_loss: 627170.8125; val_gene_expr_recon_loss: 2673444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4885285.0000; val_optim_loss: 4885285.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7481; val_auprc_score: 0.8931; val_best_acc_score: 0.7853; val_best_f1_score: 0.8714; train_kl_reg_loss: 18174.0814; train_edge_recon_loss: 1585212.1667; train_cat_covariates_contrastive_loss: 628549.6042; train_gene_expr_recon_loss: 2634119.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4866055.3333; train_optim_loss: 4866055.3333; val_kl_reg_loss: 19127.5977; val_edge_recon_loss: 1622321.6250; val_cat_covariates_contrastive_loss: 627212.3125; val_gene_expr_recon_loss: 2668728.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4937390.0000; val_optim_loss: 4937390.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7548; val_auprc_score: 0.8959; val_best_acc_score: 0.7946; val_best_f1_score: 0.8779; train_kl_reg_loss: 18054.5423; train_edge_recon_loss: 1527612.2083; train_cat_covariates_contrastive_loss: 629311.0208; train_gene_expr_recon_loss: 2634488.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4809466.5000; train_optim_loss: 4809466.5000; val_kl_reg_loss: 19033.8477; val_edge_recon_loss: 1575199.6250; val_cat_covariates_contrastive_loss: 627105.0000; val_gene_expr_recon_loss: 2666432.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4887771.0000; val_optim_loss: 4887771.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7530; val_auprc_score: 0.8986; val_best_acc_score: 0.8011; val_best_f1_score: 0.8818; train_kl_reg_loss: 17944.2676; train_edge_recon_loss: 1567387.1250; train_cat_covariates_contrastive_loss: 628841.8750; train_gene_expr_recon_loss: 2628765.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842939.3333; train_optim_loss: 4842939.3333; val_kl_reg_loss: 18609.9141; val_edge_recon_loss: 1510246.3750; val_cat_covariates_contrastive_loss: 627140.4375; val_gene_expr_recon_loss: 2668905.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4824902.0000; val_optim_loss: 4824902.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7579; val_auprc_score: 0.8917; val_best_acc_score: 0.8002; val_best_f1_score: 0.8807; train_kl_reg_loss: 17464.8737; train_edge_recon_loss: 1560392.6667; train_cat_covariates_contrastive_loss: 629368.0833; train_gene_expr_recon_loss: 2627487.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4834713.3333; train_optim_loss: 4834713.3333; val_kl_reg_loss: 18137.8672; val_edge_recon_loss: 1576335.3750; val_cat_covariates_contrastive_loss: 627067.5625; val_gene_expr_recon_loss: 2663096.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4884637.0000; val_optim_loss: 4884637.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7496; val_auprc_score: 0.8975; val_best_acc_score: 0.8038; val_best_f1_score: 0.8837; train_kl_reg_loss: 17408.5944; train_edge_recon_loss: 1562828.7500; train_cat_covariates_contrastive_loss: 629929.0417; train_gene_expr_recon_loss: 2632874.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4843041.0000; train_optim_loss: 4843041.0000; val_kl_reg_loss: 18081.2422; val_edge_recon_loss: 1542105.3750; val_cat_covariates_contrastive_loss: 627230.4375; val_gene_expr_recon_loss: 2662937.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4850354.0000; val_optim_loss: 4850354.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7622; val_auprc_score: 0.9012; val_best_acc_score: 0.8026; val_best_f1_score: 0.8801; train_kl_reg_loss: 17531.0547; train_edge_recon_loss: 1548062.0833; train_cat_covariates_contrastive_loss: 629239.1458; train_gene_expr_recon_loss: 2619800.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814632.5000; train_optim_loss: 4814632.5000; val_kl_reg_loss: 18189.2695; val_edge_recon_loss: 1552203.6250; val_cat_covariates_contrastive_loss: 627316.6250; val_gene_expr_recon_loss: 2660823.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4858533.0000; val_optim_loss: 4858533.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7463; val_auprc_score: 0.8934; val_best_acc_score: 0.8058; val_best_f1_score: 0.8826; train_kl_reg_loss: 17190.2614; train_edge_recon_loss: 1586223.0833; train_cat_covariates_contrastive_loss: 629550.7083; train_gene_expr_recon_loss: 2633130.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4866094.3333; train_optim_loss: 4866094.3333; val_kl_reg_loss: 18118.2109; val_edge_recon_loss: 1543049.7500; val_cat_covariates_contrastive_loss: 627134.0000; val_gene_expr_recon_loss: 2663933.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4852235.5000; val_optim_loss: 4852235.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7397; val_auprc_score: 0.8856; val_best_acc_score: 0.7976; val_best_f1_score: 0.8798; train_kl_reg_loss: 17401.5072; train_edge_recon_loss: 1546174.6250; train_cat_covariates_contrastive_loss: 629551.0000; train_gene_expr_recon_loss: 2620965.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814092.0000; train_optim_loss: 4814092.0000; val_kl_reg_loss: 18456.1309; val_edge_recon_loss: 1616212.8750; val_cat_covariates_contrastive_loss: 627217.5000; val_gene_expr_recon_loss: 2659436.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4921323.0000; val_optim_loss: 4921323.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7555; val_auprc_score: 0.8940; val_best_acc_score: 0.7836; val_best_f1_score: 0.8676; train_kl_reg_loss: 17524.2526; train_edge_recon_loss: 1547064.5417; train_cat_covariates_contrastive_loss: 628903.1042; train_gene_expr_recon_loss: 2625642.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4819134.3333; train_optim_loss: 4819134.3333; val_kl_reg_loss: 18371.9297; val_edge_recon_loss: 1704455.7500; val_cat_covariates_contrastive_loss: 627089.1250; val_gene_expr_recon_loss: 2659041.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5008958.5000; val_optim_loss: 5008958.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7461; val_auprc_score: 0.8899; val_best_acc_score: 0.7816; val_best_f1_score: 0.8696; train_kl_reg_loss: 17494.6400; train_edge_recon_loss: 1521734.5833; train_cat_covariates_contrastive_loss: 629753.9583; train_gene_expr_recon_loss: 2627509.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796492.5000; train_optim_loss: 4796492.5000; val_kl_reg_loss: 18434.4688; val_edge_recon_loss: 1708078.2500; val_cat_covariates_contrastive_loss: 627222.3750; val_gene_expr_recon_loss: 2659732.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5013467.5000; val_optim_loss: 5013467.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7796; val_auprc_score: 0.9051; val_best_acc_score: 0.8063; val_best_f1_score: 0.8800; train_kl_reg_loss: 17288.7572; train_edge_recon_loss: 1532519.2917; train_cat_covariates_contrastive_loss: 629556.0833; train_gene_expr_recon_loss: 2621171.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4800535.5000; train_optim_loss: 4800535.5000; val_kl_reg_loss: 18794.1309; val_edge_recon_loss: 1554944.2500; val_cat_covariates_contrastive_loss: 627285.5000; val_gene_expr_recon_loss: 2665719.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4866743.0000; val_optim_loss: 4866743.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 45 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.7390
val AUPRC score: 0.8776
val best accuracy score: 0.7915
val best F1 score: 0.8741
val target rna MSE score: 0.8398
val source rna MSE score: 0.4420
Val cat covariate0 mean sim diff: -0.0062
Val cat covariate1 mean sim diff: -0.0062
Duration of model training in run 3: 0 hours, 0 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8337; val_auprc_score: 0.9372; val_best_acc_score: 0.7985; val_best_f1_score: 0.8782; train_kl_reg_loss: 83.6923; train_edge_recon_loss: 1754110.8750; train_cat_covariates_contrastive_loss: 1317521.6250; train_gene_expr_recon_loss: 3650253.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6721969.2500; train_optim_loss: 6721969.2500; val_kl_reg_loss: 357.9602; val_edge_recon_loss: 2062522.7500; val_cat_covariates_contrastive_loss: 635918.5000; val_gene_expr_recon_loss: 3608928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6307727.0000; val_optim_loss: 6307727.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7993; val_auprc_score: 0.9253; val_best_acc_score: 0.7456; val_best_f1_score: 0.8543; train_kl_reg_loss: 654.1507; train_edge_recon_loss: 1748194.3750; train_cat_covariates_contrastive_loss: 1121346.5000; train_gene_expr_recon_loss: 3574035.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6444230.0000; train_optim_loss: 6444230.0000; val_kl_reg_loss: 1324.9171; val_edge_recon_loss: 2063764.8750; val_cat_covariates_contrastive_loss: 628838.6875; val_gene_expr_recon_loss: 3551428.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6245356.5000; val_optim_loss: 6245356.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7946; val_auprc_score: 0.9163; val_best_acc_score: 0.7745; val_best_f1_score: 0.8681; train_kl_reg_loss: 1687.9527; train_edge_recon_loss: 1827847.9375; train_cat_covariates_contrastive_loss: 838000.8125; train_gene_expr_recon_loss: 3452549.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6120085.5000; train_optim_loss: 6120085.5000; val_kl_reg_loss: 2878.7234; val_edge_recon_loss: 2079499.1250; val_cat_covariates_contrastive_loss: 627578.6250; val_gene_expr_recon_loss: 3502002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6211958.5000; val_optim_loss: 6211958.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8097; val_auprc_score: 0.9332; val_best_acc_score: 0.7674; val_best_f1_score: 0.8668; train_kl_reg_loss: 3308.7253; train_edge_recon_loss: 1935156.6875; train_cat_covariates_contrastive_loss: 684591.5625; train_gene_expr_recon_loss: 3390854.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6013911.0000; train_optim_loss: 6013911.0000; val_kl_reg_loss: 4205.6162; val_edge_recon_loss: 1979653.2500; val_cat_covariates_contrastive_loss: 627243.3125; val_gene_expr_recon_loss: 3446516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6057618.0000; val_optim_loss: 6057618.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7949; val_auprc_score: 0.9202; val_best_acc_score: 0.7503; val_best_f1_score: 0.8564; train_kl_reg_loss: 4457.8521; train_edge_recon_loss: 1941422.2500; train_cat_covariates_contrastive_loss: 649245.1250; train_gene_expr_recon_loss: 3368767.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5963892.7500; train_optim_loss: 5963892.7500; val_kl_reg_loss: 4809.0146; val_edge_recon_loss: 2073706.6250; val_cat_covariates_contrastive_loss: 627144.0000; val_gene_expr_recon_loss: 3407824.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6113484.0000; val_optim_loss: 6113484.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7854; val_auprc_score: 0.9079; val_best_acc_score: 0.7419; val_best_f1_score: 0.8511; train_kl_reg_loss: 4900.1135; train_edge_recon_loss: 2051995.5625; train_cat_covariates_contrastive_loss: 641258.4688; train_gene_expr_recon_loss: 3320766.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6018921.0000; train_optim_loss: 6018921.0000; val_kl_reg_loss: 4728.2051; val_edge_recon_loss: 2132660.5000; val_cat_covariates_contrastive_loss: 627122.5000; val_gene_expr_recon_loss: 3356805.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6121316.5000; val_optim_loss: 6121316.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8191; val_auprc_score: 0.9303; val_best_acc_score: 0.7607; val_best_f1_score: 0.8624; train_kl_reg_loss: 4760.6526; train_edge_recon_loss: 1932864.8750; train_cat_covariates_contrastive_loss: 641246.4062; train_gene_expr_recon_loss: 3280377.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5859249.5000; train_optim_loss: 5859249.5000; val_kl_reg_loss: 4319.0361; val_edge_recon_loss: 2033613.7500; val_cat_covariates_contrastive_loss: 627127.5000; val_gene_expr_recon_loss: 3311552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5976612.0000; val_optim_loss: 5976612.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8245; val_auprc_score: 0.9329; val_best_acc_score: 0.7713; val_best_f1_score: 0.8673; train_kl_reg_loss: 4190.8894; train_edge_recon_loss: 1908096.0625; train_cat_covariates_contrastive_loss: 646124.1250; train_gene_expr_recon_loss: 3236353.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5794764.2500; train_optim_loss: 5794764.2500; val_kl_reg_loss: 3540.2756; val_edge_recon_loss: 2053341.6250; val_cat_covariates_contrastive_loss: 627253.4375; val_gene_expr_recon_loss: 3273911.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5958046.0000; val_optim_loss: 5958046.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8308; val_auprc_score: 0.9398; val_best_acc_score: 0.8002; val_best_f1_score: 0.8833; train_kl_reg_loss: 3360.2665; train_edge_recon_loss: 1925488.0625; train_cat_covariates_contrastive_loss: 660748.2812; train_gene_expr_recon_loss: 3189676.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5779272.5000; train_optim_loss: 5779272.5000; val_kl_reg_loss: 2678.2014; val_edge_recon_loss: 1965210.8750; val_cat_covariates_contrastive_loss: 627313.6875; val_gene_expr_recon_loss: 3256065.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5851268.0000; val_optim_loss: 5851268.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8298; val_auprc_score: 0.9284; val_best_acc_score: 0.8028; val_best_f1_score: 0.8796; train_kl_reg_loss: 2537.6698; train_edge_recon_loss: 1909008.9375; train_cat_covariates_contrastive_loss: 685016.7812; train_gene_expr_recon_loss: 3207061.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5803625.0000; train_optim_loss: 5803625.0000; val_kl_reg_loss: 1956.1692; val_edge_recon_loss: 2175007.5000; val_cat_covariates_contrastive_loss: 627507.0000; val_gene_expr_recon_loss: 3217794.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6022265.0000; val_optim_loss: 6022265.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8258; val_auprc_score: 0.9348; val_best_acc_score: 0.7998; val_best_f1_score: 0.8772; train_kl_reg_loss: 1906.5707; train_edge_recon_loss: 1823608.0000; train_cat_covariates_contrastive_loss: 718498.1250; train_gene_expr_recon_loss: 3157930.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5701943.0000; train_optim_loss: 5701943.0000; val_kl_reg_loss: 1785.5483; val_edge_recon_loss: 2083736.5000; val_cat_covariates_contrastive_loss: 627749.3750; val_gene_expr_recon_loss: 3202192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5915463.5000; val_optim_loss: 5915463.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7965; val_auprc_score: 0.9209; val_best_acc_score: 0.8119; val_best_f1_score: 0.8860; train_kl_reg_loss: 1856.3156; train_edge_recon_loss: 1812994.6875; train_cat_covariates_contrastive_loss: 719176.3125; train_gene_expr_recon_loss: 3125307.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5659335.0000; train_optim_loss: 5659335.0000; val_kl_reg_loss: 2146.0044; val_edge_recon_loss: 1907919.3750; val_cat_covariates_contrastive_loss: 627581.2500; val_gene_expr_recon_loss: 3166317.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5703964.0000; val_optim_loss: 5703964.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8015; val_auprc_score: 0.9146; val_best_acc_score: 0.7922; val_best_f1_score: 0.8702; train_kl_reg_loss: 2286.8530; train_edge_recon_loss: 1868608.8125; train_cat_covariates_contrastive_loss: 689385.4688; train_gene_expr_recon_loss: 3119796.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5680077.5000; train_optim_loss: 5680077.5000; val_kl_reg_loss: 2495.6035; val_edge_recon_loss: 2082655.7500; val_cat_covariates_contrastive_loss: 627439.6875; val_gene_expr_recon_loss: 3138204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5850795.0000; val_optim_loss: 5850795.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7944; val_auprc_score: 0.9107; val_best_acc_score: 0.7732; val_best_f1_score: 0.8527; train_kl_reg_loss: 2493.6646; train_edge_recon_loss: 1839235.7500; train_cat_covariates_contrastive_loss: 676541.5938; train_gene_expr_recon_loss: 3087820.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5606091.0000; train_optim_loss: 5606091.0000; val_kl_reg_loss: 2438.2847; val_edge_recon_loss: 2126875.2500; val_cat_covariates_contrastive_loss: 627530.2500; val_gene_expr_recon_loss: 3111591.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5868435.0000; val_optim_loss: 5868435.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8241; val_auprc_score: 0.9268; val_best_acc_score: 0.7914; val_best_f1_score: 0.8777; train_kl_reg_loss: 2482.1367; train_edge_recon_loss: 1858921.1250; train_cat_covariates_contrastive_loss: 675840.3438; train_gene_expr_recon_loss: 3058814.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5596057.7500; train_optim_loss: 5596057.7500; val_kl_reg_loss: 2359.0518; val_edge_recon_loss: 2023341.0000; val_cat_covariates_contrastive_loss: 627948.3750; val_gene_expr_recon_loss: 3094441.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5748090.0000; val_optim_loss: 5748090.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7636; val_auprc_score: 0.8912; val_best_acc_score: 0.7938; val_best_f1_score: 0.8787; train_kl_reg_loss: 2403.4073; train_edge_recon_loss: 1804139.0000; train_cat_covariates_contrastive_loss: 680102.5625; train_gene_expr_recon_loss: 3024909.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5511554.0000; train_optim_loss: 5511554.0000; val_kl_reg_loss: 2394.3921; val_edge_recon_loss: 1960003.1250; val_cat_covariates_contrastive_loss: 627836.0000; val_gene_expr_recon_loss: 3071508.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5661742.0000; val_optim_loss: 5661742.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7793; val_auprc_score: 0.9000; val_best_acc_score: 0.8055; val_best_f1_score: 0.8821; train_kl_reg_loss: 2428.7856; train_edge_recon_loss: 1775481.3750; train_cat_covariates_contrastive_loss: 685238.1250; train_gene_expr_recon_loss: 3012918.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5476066.5000; train_optim_loss: 5476066.5000; val_kl_reg_loss: 2652.1924; val_edge_recon_loss: 2039380.5000; val_cat_covariates_contrastive_loss: 628151.6250; val_gene_expr_recon_loss: 3043357.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5713541.5000; val_optim_loss: 5713541.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7861; val_auprc_score: 0.9147; val_best_acc_score: 0.8069; val_best_f1_score: 0.8849; train_kl_reg_loss: 2711.1499; train_edge_recon_loss: 1784084.5625; train_cat_covariates_contrastive_loss: 667609.9062; train_gene_expr_recon_loss: 2976726.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5431131.7500; train_optim_loss: 5431131.7500; val_kl_reg_loss: 2924.5532; val_edge_recon_loss: 1933658.1250; val_cat_covariates_contrastive_loss: 627829.5000; val_gene_expr_recon_loss: 3018986.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5583399.0000; val_optim_loss: 5583399.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7594; val_auprc_score: 0.8984; val_best_acc_score: 0.7951; val_best_f1_score: 0.8770; train_kl_reg_loss: 2960.8378; train_edge_recon_loss: 1790934.1250; train_cat_covariates_contrastive_loss: 662518.6875; train_gene_expr_recon_loss: 2960617.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5417031.0000; train_optim_loss: 5417031.0000; val_kl_reg_loss: 2885.4746; val_edge_recon_loss: 1931568.6250; val_cat_covariates_contrastive_loss: 627963.3750; val_gene_expr_recon_loss: 2994479.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5556897.0000; val_optim_loss: 5556897.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7644; val_auprc_score: 0.9011; val_best_acc_score: 0.7900; val_best_f1_score: 0.8733; train_kl_reg_loss: 2797.6313; train_edge_recon_loss: 1788410.5000; train_cat_covariates_contrastive_loss: 671056.2500; train_gene_expr_recon_loss: 2931255.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5393519.5000; train_optim_loss: 5393519.5000; val_kl_reg_loss: 2745.2041; val_edge_recon_loss: 1882223.2500; val_cat_covariates_contrastive_loss: 628599.7500; val_gene_expr_recon_loss: 2980616.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5494184.5000; val_optim_loss: 5494184.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7559; val_auprc_score: 0.8995; val_best_acc_score: 0.7931; val_best_f1_score: 0.8752; train_kl_reg_loss: 2802.2013; train_edge_recon_loss: 1739412.6250; train_cat_covariates_contrastive_loss: 670931.0938; train_gene_expr_recon_loss: 2931293.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5344439.5000; train_optim_loss: 5344439.5000; val_kl_reg_loss: 2863.5867; val_edge_recon_loss: 1837855.8750; val_cat_covariates_contrastive_loss: 628881.8750; val_gene_expr_recon_loss: 2959569.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5429170.5000; val_optim_loss: 5429170.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7200; val_auprc_score: 0.8757; val_best_acc_score: 0.7840; val_best_f1_score: 0.8707; train_kl_reg_loss: 2927.5862; train_edge_recon_loss: 1756740.7500; train_cat_covariates_contrastive_loss: 676465.1250; train_gene_expr_recon_loss: 2908123.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5344257.2500; train_optim_loss: 5344257.2500; val_kl_reg_loss: 3296.9944; val_edge_recon_loss: 1890180.1250; val_cat_covariates_contrastive_loss: 629071.6875; val_gene_expr_recon_loss: 2946181.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5468730.0000; val_optim_loss: 5468730.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7398; val_auprc_score: 0.8901; val_best_acc_score: 0.7820; val_best_f1_score: 0.8695; train_kl_reg_loss: 3415.2153; train_edge_recon_loss: 1736592.6250; train_cat_covariates_contrastive_loss: 661551.0938; train_gene_expr_recon_loss: 2891807.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5293366.5000; train_optim_loss: 5293366.5000; val_kl_reg_loss: 3856.8164; val_edge_recon_loss: 1863753.0000; val_cat_covariates_contrastive_loss: 629645.8125; val_gene_expr_recon_loss: 2916848.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5414104.0000; val_optim_loss: 5414104.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7622; val_auprc_score: 0.8982; val_best_acc_score: 0.7878; val_best_f1_score: 0.8700; train_kl_reg_loss: 3882.1963; train_edge_recon_loss: 1711498.6250; train_cat_covariates_contrastive_loss: 648908.0938; train_gene_expr_recon_loss: 2848563.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5212852.2500; train_optim_loss: 5212852.2500; val_kl_reg_loss: 4168.8193; val_edge_recon_loss: 1839880.2500; val_cat_covariates_contrastive_loss: 628937.2500; val_gene_expr_recon_loss: 2910481.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5383467.5000; val_optim_loss: 5383467.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7323; val_auprc_score: 0.8896; val_best_acc_score: 0.7982; val_best_f1_score: 0.8781; train_kl_reg_loss: 4276.5483; train_edge_recon_loss: 1682867.4375; train_cat_covariates_contrastive_loss: 649787.7500; train_gene_expr_recon_loss: 2845207.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5182139.0000; train_optim_loss: 5182139.0000; val_kl_reg_loss: 4494.3667; val_edge_recon_loss: 1672459.2500; val_cat_covariates_contrastive_loss: 628372.5000; val_gene_expr_recon_loss: 2900596.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5205922.5000; val_optim_loss: 5205922.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7294; val_auprc_score: 0.8828; val_best_acc_score: 0.7909; val_best_f1_score: 0.8751; train_kl_reg_loss: 4528.4939; train_edge_recon_loss: 1664138.1875; train_cat_covariates_contrastive_loss: 645774.7500; train_gene_expr_recon_loss: 2844320.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5158762.0000; train_optim_loss: 5158762.0000; val_kl_reg_loss: 4741.8213; val_edge_recon_loss: 1684530.6250; val_cat_covariates_contrastive_loss: 627846.5625; val_gene_expr_recon_loss: 2884867.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5201986.0000; val_optim_loss: 5201986.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7201; val_auprc_score: 0.8786; val_best_acc_score: 0.7938; val_best_f1_score: 0.8785; train_kl_reg_loss: 4947.9622; train_edge_recon_loss: 1679020.2500; train_cat_covariates_contrastive_loss: 645099.9688; train_gene_expr_recon_loss: 2824457.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5153526.0000; train_optim_loss: 5153526.0000; val_kl_reg_loss: 5400.9751; val_edge_recon_loss: 1684274.2500; val_cat_covariates_contrastive_loss: 628381.9375; val_gene_expr_recon_loss: 2867783.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5185841.0000; val_optim_loss: 5185841.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7491; val_auprc_score: 0.9031; val_best_acc_score: 0.8054; val_best_f1_score: 0.8858; train_kl_reg_loss: 5610.4299; train_edge_recon_loss: 1654474.6250; train_cat_covariates_contrastive_loss: 646178.0000; train_gene_expr_recon_loss: 2819466.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5125729.0000; train_optim_loss: 5125729.0000; val_kl_reg_loss: 6415.1797; val_edge_recon_loss: 1534251.6250; val_cat_covariates_contrastive_loss: 627344.8125; val_gene_expr_recon_loss: 2856364.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5024376.0000; val_optim_loss: 5024376.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.6898; val_auprc_score: 0.8758; val_best_acc_score: 0.8065; val_best_f1_score: 0.8866; train_kl_reg_loss: 6723.5881; train_edge_recon_loss: 1618098.2500; train_cat_covariates_contrastive_loss: 634010.9062; train_gene_expr_recon_loss: 2807886.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5066719.5000; train_optim_loss: 5066719.5000; val_kl_reg_loss: 7291.9570; val_edge_recon_loss: 1612920.6250; val_cat_covariates_contrastive_loss: 627597.1250; val_gene_expr_recon_loss: 2839683.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5087493.5000; val_optim_loss: 5087493.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7107; val_auprc_score: 0.8741; val_best_acc_score: 0.7875; val_best_f1_score: 0.8748; train_kl_reg_loss: 7553.9966; train_edge_recon_loss: 1593425.3750; train_cat_covariates_contrastive_loss: 633410.7812; train_gene_expr_recon_loss: 2774370.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5008760.2500; train_optim_loss: 5008760.2500; val_kl_reg_loss: 8419.3555; val_edge_recon_loss: 1694104.6250; val_cat_covariates_contrastive_loss: 627311.0000; val_gene_expr_recon_loss: 2831662.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5161497.5000; val_optim_loss: 5161497.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7028; val_auprc_score: 0.8845; val_best_acc_score: 0.7871; val_best_f1_score: 0.8761; train_kl_reg_loss: 8545.3955; train_edge_recon_loss: 1590775.3750; train_cat_covariates_contrastive_loss: 633177.0312; train_gene_expr_recon_loss: 2764976.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4997474.7500; train_optim_loss: 4997474.7500; val_kl_reg_loss: 9385.6631; val_edge_recon_loss: 1661872.6250; val_cat_covariates_contrastive_loss: 627121.1250; val_gene_expr_recon_loss: 2819162.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5117542.0000; val_optim_loss: 5117542.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7179; val_auprc_score: 0.8896; val_best_acc_score: 0.8066; val_best_f1_score: 0.8870; train_kl_reg_loss: 9853.8081; train_edge_recon_loss: 1565609.9375; train_cat_covariates_contrastive_loss: 632072.1562; train_gene_expr_recon_loss: 2759309.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966845.5000; train_optim_loss: 4966845.5000; val_kl_reg_loss: 10418.1143; val_edge_recon_loss: 1511566.0000; val_cat_covariates_contrastive_loss: 627390.5625; val_gene_expr_recon_loss: 2807859.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4957234.0000; val_optim_loss: 4957234.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.6951; val_auprc_score: 0.8584; val_best_acc_score: 0.7810; val_best_f1_score: 0.8683; train_kl_reg_loss: 10951.6699; train_edge_recon_loss: 1581039.7500; train_cat_covariates_contrastive_loss: 631561.9062; train_gene_expr_recon_loss: 2753072.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4976625.5000; train_optim_loss: 4976625.5000; val_kl_reg_loss: 11645.0146; val_edge_recon_loss: 1769967.2500; val_cat_covariates_contrastive_loss: 627344.4375; val_gene_expr_recon_loss: 2794295.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5203252.0000; val_optim_loss: 5203252.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.6984; val_auprc_score: 0.8723; val_best_acc_score: 0.7717; val_best_f1_score: 0.8672; train_kl_reg_loss: 11953.6230; train_edge_recon_loss: 1568605.4375; train_cat_covariates_contrastive_loss: 629324.1875; train_gene_expr_recon_loss: 2751880.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4961763.5000; train_optim_loss: 4961763.5000; val_kl_reg_loss: 12896.4316; val_edge_recon_loss: 1686556.3750; val_cat_covariates_contrastive_loss: 627068.2500; val_gene_expr_recon_loss: 2787565.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5114086.5000; val_optim_loss: 5114086.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7144; val_auprc_score: 0.8765; val_best_acc_score: 0.8035; val_best_f1_score: 0.8826; train_kl_reg_loss: 13264.5713; train_edge_recon_loss: 1594531.7500; train_cat_covariates_contrastive_loss: 629396.5000; train_gene_expr_recon_loss: 2714121.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4951314.7500; train_optim_loss: 4951314.7500; val_kl_reg_loss: 14640.7939; val_edge_recon_loss: 1592293.3750; val_cat_covariates_contrastive_loss: 627433.6875; val_gene_expr_recon_loss: 2765275.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4999643.0000; val_optim_loss: 4999643.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7508; val_auprc_score: 0.8951; val_best_acc_score: 0.8020; val_best_f1_score: 0.8805; train_kl_reg_loss: 14827.0454; train_edge_recon_loss: 1608094.5625; train_cat_covariates_contrastive_loss: 628494.1875; train_gene_expr_recon_loss: 2700166.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4951582.2500; train_optim_loss: 4951582.2500; val_kl_reg_loss: 15579.0000; val_edge_recon_loss: 1548566.6250; val_cat_covariates_contrastive_loss: 627393.6875; val_gene_expr_recon_loss: 2758850.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950390.0000; val_optim_loss: 4950390.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7144; val_auprc_score: 0.8782; val_best_acc_score: 0.7774; val_best_f1_score: 0.8654; train_kl_reg_loss: 15717.8154; train_edge_recon_loss: 1571648.9375; train_cat_covariates_contrastive_loss: 628085.0938; train_gene_expr_recon_loss: 2700502.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4915954.2500; train_optim_loss: 4915954.2500; val_kl_reg_loss: 16445.0586; val_edge_recon_loss: 1706831.1250; val_cat_covariates_contrastive_loss: 627281.6250; val_gene_expr_recon_loss: 2747834.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5098392.0000; val_optim_loss: 5098392.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.7176; val_auprc_score: 0.8646; val_best_acc_score: 0.7705; val_best_f1_score: 0.8596; train_kl_reg_loss: 16394.7202; train_edge_recon_loss: 1505811.6250; train_cat_covariates_contrastive_loss: 628230.3750; train_gene_expr_recon_loss: 2687615.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4838052.2500; train_optim_loss: 4838052.2500; val_kl_reg_loss: 16010.1260; val_edge_recon_loss: 1788422.1250; val_cat_covariates_contrastive_loss: 627089.1875; val_gene_expr_recon_loss: 2742091.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5173613.0000; val_optim_loss: 5173613.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7316; val_auprc_score: 0.8907; val_best_acc_score: 0.7829; val_best_f1_score: 0.8692; train_kl_reg_loss: 16077.0420; train_edge_recon_loss: 1569575.7500; train_cat_covariates_contrastive_loss: 629313.2812; train_gene_expr_recon_loss: 2683099.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4898065.0000; train_optim_loss: 4898065.0000; val_kl_reg_loss: 15888.1016; val_edge_recon_loss: 1637247.3750; val_cat_covariates_contrastive_loss: 626952.5625; val_gene_expr_recon_loss: 2730887.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5010975.5000; val_optim_loss: 5010975.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7097; val_auprc_score: 0.8813; val_best_acc_score: 0.7923; val_best_f1_score: 0.8760; train_kl_reg_loss: 16387.9043; train_edge_recon_loss: 1493975.8125; train_cat_covariates_contrastive_loss: 628976.9062; train_gene_expr_recon_loss: 2684255.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4823596.0000; train_optim_loss: 4823596.0000; val_kl_reg_loss: 16459.0742; val_edge_recon_loss: 1618356.5000; val_cat_covariates_contrastive_loss: 627216.3125; val_gene_expr_recon_loss: 2720964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4982996.0000; val_optim_loss: 4982996.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7278; val_auprc_score: 0.8901; val_best_acc_score: 0.7967; val_best_f1_score: 0.8799; train_kl_reg_loss: 16584.1533; train_edge_recon_loss: 1549037.3125; train_cat_covariates_contrastive_loss: 629386.9375; train_gene_expr_recon_loss: 2658795.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4853804.0000; train_optim_loss: 4853804.0000; val_kl_reg_loss: 16749.6973; val_edge_recon_loss: 1595055.6250; val_cat_covariates_contrastive_loss: 627268.6250; val_gene_expr_recon_loss: 2721341.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4960415.5000; val_optim_loss: 4960415.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7098; val_auprc_score: 0.8816; val_best_acc_score: 0.7911; val_best_f1_score: 0.8770; train_kl_reg_loss: 16721.5752; train_edge_recon_loss: 1508271.6250; train_cat_covariates_contrastive_loss: 628559.4062; train_gene_expr_recon_loss: 2654105.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4807658.2500; train_optim_loss: 4807658.2500; val_kl_reg_loss: 17020.9180; val_edge_recon_loss: 1593748.1250; val_cat_covariates_contrastive_loss: 626939.6250; val_gene_expr_recon_loss: 2712513.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4950222.0000; val_optim_loss: 4950222.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7041; val_auprc_score: 0.8605; val_best_acc_score: 0.7774; val_best_f1_score: 0.8645; train_kl_reg_loss: 16861.9072; train_edge_recon_loss: 1560823.3125; train_cat_covariates_contrastive_loss: 629351.2812; train_gene_expr_recon_loss: 2668898.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4875934.5000; train_optim_loss: 4875934.5000; val_kl_reg_loss: 17373.9668; val_edge_recon_loss: 1746677.8750; val_cat_covariates_contrastive_loss: 626939.5625; val_gene_expr_recon_loss: 2716805.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5107796.5000; val_optim_loss: 5107796.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.7179; val_auprc_score: 0.8874; val_best_acc_score: 0.7872; val_best_f1_score: 0.8740; train_kl_reg_loss: 16804.5898; train_edge_recon_loss: 1519000.7500; train_cat_covariates_contrastive_loss: 629208.2812; train_gene_expr_recon_loss: 2648751.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813765.0000; train_optim_loss: 4813765.0000; val_kl_reg_loss: 17040.7188; val_edge_recon_loss: 1637223.7500; val_cat_covariates_contrastive_loss: 627084.6875; val_gene_expr_recon_loss: 2712567.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4993917.0000; val_optim_loss: 4993917.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.7280; val_auprc_score: 0.8887; val_best_acc_score: 0.7958; val_best_f1_score: 0.8774; train_kl_reg_loss: 17265.5430; train_edge_recon_loss: 1572090.1875; train_cat_covariates_contrastive_loss: 628612.8438; train_gene_expr_recon_loss: 2651652.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4869621.0000; train_optim_loss: 4869621.0000; val_kl_reg_loss: 17441.8164; val_edge_recon_loss: 1549555.6250; val_cat_covariates_contrastive_loss: 627237.3750; val_gene_expr_recon_loss: 2712890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4907125.0000; val_optim_loss: 4907125.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.7290; val_auprc_score: 0.8796; val_best_acc_score: 0.7861; val_best_f1_score: 0.8700; train_kl_reg_loss: 16997.2578; train_edge_recon_loss: 1532608.6875; train_cat_covariates_contrastive_loss: 629032.9688; train_gene_expr_recon_loss: 2654320.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4832959.7500; train_optim_loss: 4832959.7500; val_kl_reg_loss: 17288.0547; val_edge_recon_loss: 1672079.1250; val_cat_covariates_contrastive_loss: 627029.8750; val_gene_expr_recon_loss: 2709189.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5025586.5000; val_optim_loss: 5025586.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.7391; val_auprc_score: 0.8955; val_best_acc_score: 0.7883; val_best_f1_score: 0.8746; train_kl_reg_loss: 17749.6006; train_edge_recon_loss: 1502337.0625; train_cat_covariates_contrastive_loss: 628559.5625; train_gene_expr_recon_loss: 2665456.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4814102.5000; train_optim_loss: 4814102.5000; val_kl_reg_loss: 17326.9707; val_edge_recon_loss: 1603450.7500; val_cat_covariates_contrastive_loss: 627299.5000; val_gene_expr_recon_loss: 2711385.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4959462.0000; val_optim_loss: 4959462.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.7251; val_auprc_score: 0.8771; val_best_acc_score: 0.7821; val_best_f1_score: 0.8707; train_kl_reg_loss: 17621.9580; train_edge_recon_loss: 1545883.7500; train_cat_covariates_contrastive_loss: 629048.6250; train_gene_expr_recon_loss: 2649195.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4841750.0000; train_optim_loss: 4841750.0000; val_kl_reg_loss: 17474.8633; val_edge_recon_loss: 1585384.7500; val_cat_covariates_contrastive_loss: 627181.8750; val_gene_expr_recon_loss: 2709537.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4939579.0000; val_optim_loss: 4939579.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.7128; val_auprc_score: 0.8819; val_best_acc_score: 0.7842; val_best_f1_score: 0.8705; train_kl_reg_loss: 17733.1914; train_edge_recon_loss: 1547679.6250; train_cat_covariates_contrastive_loss: 628315.2812; train_gene_expr_recon_loss: 2673712.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867440.2500; train_optim_loss: 4867440.2500; val_kl_reg_loss: 17653.5723; val_edge_recon_loss: 1684088.3750; val_cat_covariates_contrastive_loss: 627289.5000; val_gene_expr_recon_loss: 2710584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5039615.5000; val_optim_loss: 5039615.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.7340; val_auprc_score: 0.8880; val_best_acc_score: 0.7927; val_best_f1_score: 0.8762; train_kl_reg_loss: 17652.8516; train_edge_recon_loss: 1508490.6250; train_cat_covariates_contrastive_loss: 628247.2812; train_gene_expr_recon_loss: 2648321.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4802712.5000; train_optim_loss: 4802712.5000; val_kl_reg_loss: 17787.2363; val_edge_recon_loss: 1575109.5000; val_cat_covariates_contrastive_loss: 627216.6250; val_gene_expr_recon_loss: 2708383.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4928497.0000; val_optim_loss: 4928497.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.7236; val_auprc_score: 0.8839; val_best_acc_score: 0.7868; val_best_f1_score: 0.8728; train_kl_reg_loss: 17909.7256; train_edge_recon_loss: 1555070.1875; train_cat_covariates_contrastive_loss: 628367.1562; train_gene_expr_recon_loss: 2666413.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4867760.2500; train_optim_loss: 4867760.2500; val_kl_reg_loss: 17550.6543; val_edge_recon_loss: 1617147.5000; val_cat_covariates_contrastive_loss: 627055.0625; val_gene_expr_recon_loss: 2713863.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4975616.0000; val_optim_loss: 4975616.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.7013; val_auprc_score: 0.8644; val_best_acc_score: 0.7873; val_best_f1_score: 0.8728; train_kl_reg_loss: 17367.8711; train_edge_recon_loss: 1572781.1250; train_cat_covariates_contrastive_loss: 629023.8750; train_gene_expr_recon_loss: 2646877.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4866050.7500; train_optim_loss: 4866050.7500; val_kl_reg_loss: 17241.2812; val_edge_recon_loss: 1660255.0000; val_cat_covariates_contrastive_loss: 627173.7500; val_gene_expr_recon_loss: 2709787.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5014458.0000; val_optim_loss: 5014458.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.7016; val_auprc_score: 0.8726; val_best_acc_score: 0.7953; val_best_f1_score: 0.8791; train_kl_reg_loss: 17377.5840; train_edge_recon_loss: 1592433.4375; train_cat_covariates_contrastive_loss: 628838.6250; train_gene_expr_recon_loss: 2644934.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883584.2500; train_optim_loss: 4883584.2500; val_kl_reg_loss: 17233.6250; val_edge_recon_loss: 1594582.7500; val_cat_covariates_contrastive_loss: 627367.3125; val_gene_expr_recon_loss: 2709336.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4948520.0000; val_optim_loss: 4948520.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 47 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.7072
val AUPRC score: 0.8624
val best accuracy score: 0.7814
val best F1 score: 0.8700
val target rna MSE score: 0.9504
val source rna MSE score: 0.4126
Val cat covariate0 mean sim diff: -0.0075
Val cat covariate1 mean sim diff: -0.0075
Duration of model training in run 2: 0 hours, 0 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 2540
Number of validation nodes: 282
Number of training edges: 6148
Number of validation edges: 683
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8115; val_auprc_score: 0.9408; val_best_acc_score: 0.7849; val_best_f1_score: 0.8710; train_kl_reg_loss: 86.6612; train_edge_recon_loss: 1726659.5625; train_cat_covariates_contrastive_loss: 1317320.9375; train_gene_expr_recon_loss: 3609789.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6653856.2500; train_optim_loss: 6653856.2500; val_kl_reg_loss: 365.5745; val_edge_recon_loss: 1860722.2500; val_cat_covariates_contrastive_loss: 634945.0625; val_gene_expr_recon_loss: 3477147.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5973180.0000; val_optim_loss: 5973180.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7966; val_auprc_score: 0.9276; val_best_acc_score: 0.7489; val_best_f1_score: 0.8564; train_kl_reg_loss: 661.9884; train_edge_recon_loss: 1778455.6875; train_cat_covariates_contrastive_loss: 1124534.2188; train_gene_expr_recon_loss: 3520739.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6424391.0000; train_optim_loss: 6424391.0000; val_kl_reg_loss: 1322.4355; val_edge_recon_loss: 2037157.7500; val_cat_covariates_contrastive_loss: 628727.7500; val_gene_expr_recon_loss: 3440726.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6107934.0000; val_optim_loss: 6107934.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7640; val_auprc_score: 0.9085; val_best_acc_score: 0.7514; val_best_f1_score: 0.8540; train_kl_reg_loss: 1712.8557; train_edge_recon_loss: 1769910.8125; train_cat_covariates_contrastive_loss: 844872.2188; train_gene_expr_recon_loss: 3427386.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6043882.2500; train_optim_loss: 6043882.2500; val_kl_reg_loss: 2923.3997; val_edge_recon_loss: 2099417.5000; val_cat_covariates_contrastive_loss: 627495.5000; val_gene_expr_recon_loss: 3354354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6084190.5000; val_optim_loss: 6084190.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7958; val_auprc_score: 0.9294; val_best_acc_score: 0.7617; val_best_f1_score: 0.8642; train_kl_reg_loss: 3543.4282; train_edge_recon_loss: 1885568.8750; train_cat_covariates_contrastive_loss: 680725.9688; train_gene_expr_recon_loss: 3357591.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5927430.0000; train_optim_loss: 5927430.0000; val_kl_reg_loss: 4755.1592; val_edge_recon_loss: 1945628.8750; val_cat_covariates_contrastive_loss: 627168.0625; val_gene_expr_recon_loss: 3319037.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5896589.0000; val_optim_loss: 5896589.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7937; val_auprc_score: 0.9199; val_best_acc_score: 0.7505; val_best_f1_score: 0.8575; train_kl_reg_loss: 5320.4517; train_edge_recon_loss: 1975894.0000; train_cat_covariates_contrastive_loss: 642869.5938; train_gene_expr_recon_loss: 3362648.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5986732.2500; train_optim_loss: 5986732.2500; val_kl_reg_loss: 5895.0649; val_edge_recon_loss: 2027451.8750; val_cat_covariates_contrastive_loss: 627012.0625; val_gene_expr_recon_loss: 3268728.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5929087.5000; val_optim_loss: 5929087.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8035; val_auprc_score: 0.9270; val_best_acc_score: 0.7525; val_best_f1_score: 0.8586; train_kl_reg_loss: 6177.8816; train_edge_recon_loss: 2015215.5625; train_cat_covariates_contrastive_loss: 635291.5000; train_gene_expr_recon_loss: 3259829.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5916514.0000; train_optim_loss: 5916514.0000; val_kl_reg_loss: 6214.9990; val_edge_recon_loss: 2020749.0000; val_cat_covariates_contrastive_loss: 626966.5000; val_gene_expr_recon_loss: 3211076.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5865007.0000; val_optim_loss: 5865007.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7799; val_auprc_score: 0.9184; val_best_acc_score: 0.7525; val_best_f1_score: 0.8586; train_kl_reg_loss: 6297.4285; train_edge_recon_loss: 2033033.1250; train_cat_covariates_contrastive_loss: 634209.0938; train_gene_expr_recon_loss: 3200568.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5874108.0000; train_optim_loss: 5874108.0000; val_kl_reg_loss: 5830.5352; val_edge_recon_loss: 2020778.6250; val_cat_covariates_contrastive_loss: 627023.6250; val_gene_expr_recon_loss: 3180075.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5833708.0000; val_optim_loss: 5833708.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8165; val_auprc_score: 0.9343; val_best_acc_score: 0.7552; val_best_f1_score: 0.8593; train_kl_reg_loss: 5807.9890; train_edge_recon_loss: 1952319.6875; train_cat_covariates_contrastive_loss: 636735.3750; train_gene_expr_recon_loss: 3182587.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5777450.5000; train_optim_loss: 5777450.5000; val_kl_reg_loss: 4798.7607; val_edge_recon_loss: 2033910.7500; val_cat_covariates_contrastive_loss: 627043.1875; val_gene_expr_recon_loss: 3147322.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5813075.0000; val_optim_loss: 5813075.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8188; val_auprc_score: 0.9330; val_best_acc_score: 0.7937; val_best_f1_score: 0.8805; train_kl_reg_loss: 4617.2966; train_edge_recon_loss: 1962268.6875; train_cat_covariates_contrastive_loss: 645549.9375; train_gene_expr_recon_loss: 3159187.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5771623.2500; train_optim_loss: 5771623.2500; val_kl_reg_loss: 3415.5186; val_edge_recon_loss: 1903403.1250; val_cat_covariates_contrastive_loss: 627200.3750; val_gene_expr_recon_loss: 3119895.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5653915.0000; val_optim_loss: 5653915.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8063; val_auprc_score: 0.9264; val_best_acc_score: 0.7856; val_best_f1_score: 0.8717; train_kl_reg_loss: 3208.4706; train_edge_recon_loss: 1885163.2500; train_cat_covariates_contrastive_loss: 670791.9375; train_gene_expr_recon_loss: 3130536.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5689700.0000; train_optim_loss: 5689700.0000; val_kl_reg_loss: 2340.6716; val_edge_recon_loss: 2085182.6250; val_cat_covariates_contrastive_loss: 627477.4375; val_gene_expr_recon_loss: 3096305.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5811306.0000; val_optim_loss: 5811306.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7924; val_auprc_score: 0.9187; val_best_acc_score: 0.7823; val_best_f1_score: 0.8700; train_kl_reg_loss: 2272.6073; train_edge_recon_loss: 1839678.9375; train_cat_covariates_contrastive_loss: 705986.1875; train_gene_expr_recon_loss: 3104920.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5652858.0000; train_optim_loss: 5652858.0000; val_kl_reg_loss: 1927.6169; val_edge_recon_loss: 1991065.8750; val_cat_covariates_contrastive_loss: 627596.0625; val_gene_expr_recon_loss: 3071256.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5691846.0000; val_optim_loss: 5691846.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8113; val_auprc_score: 0.9318; val_best_acc_score: 0.7833; val_best_f1_score: 0.8693; train_kl_reg_loss: 2007.3925; train_edge_recon_loss: 1781707.5625; train_cat_covariates_contrastive_loss: 721761.6250; train_gene_expr_recon_loss: 3068001.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5573478.2500; train_optim_loss: 5573478.2500; val_kl_reg_loss: 2117.0381; val_edge_recon_loss: 2017083.3750; val_cat_covariates_contrastive_loss: 627525.6250; val_gene_expr_recon_loss: 3041428.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5688154.0000; val_optim_loss: 5688154.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8045; val_auprc_score: 0.9181; val_best_acc_score: 0.7833; val_best_f1_score: 0.8697; train_kl_reg_loss: 2291.4114; train_edge_recon_loss: 1797265.6250; train_cat_covariates_contrastive_loss: 704544.1562; train_gene_expr_recon_loss: 3050799.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5554901.0000; train_optim_loss: 5554901.0000; val_kl_reg_loss: 2567.3311; val_edge_recon_loss: 1955702.5000; val_cat_covariates_contrastive_loss: 627499.6875; val_gene_expr_recon_loss: 3027568.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5613338.0000; val_optim_loss: 5613338.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8208; val_auprc_score: 0.9223; val_best_acc_score: 0.7985; val_best_f1_score: 0.8736; train_kl_reg_loss: 2704.3163; train_edge_recon_loss: 1838404.1875; train_cat_covariates_contrastive_loss: 681024.5000; train_gene_expr_recon_loss: 3016783.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5538916.2500; train_optim_loss: 5538916.2500; val_kl_reg_loss: 2795.9604; val_edge_recon_loss: 2040912.0000; val_cat_covariates_contrastive_loss: 627451.0000; val_gene_expr_recon_loss: 2999721.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5670880.5000; val_optim_loss: 5670880.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7771; val_auprc_score: 0.9150; val_best_acc_score: 0.7788; val_best_f1_score: 0.8721; train_kl_reg_loss: 2800.7897; train_edge_recon_loss: 1838837.8750; train_cat_covariates_contrastive_loss: 681201.2812; train_gene_expr_recon_loss: 2986535.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5509375.0000; train_optim_loss: 5509375.0000; val_kl_reg_loss: 2643.5850; val_edge_recon_loss: 1979985.2500; val_cat_covariates_contrastive_loss: 627786.0000; val_gene_expr_recon_loss: 2968085.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5578500.0000; val_optim_loss: 5578500.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7934; val_auprc_score: 0.9062; val_best_acc_score: 0.7998; val_best_f1_score: 0.8835; train_kl_reg_loss: 2661.1912; train_edge_recon_loss: 1798580.2500; train_cat_covariates_contrastive_loss: 685770.5000; train_gene_expr_recon_loss: 2968461.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5455473.2500; train_optim_loss: 5455473.2500; val_kl_reg_loss: 2637.5869; val_edge_recon_loss: 1907535.3750; val_cat_covariates_contrastive_loss: 627757.8750; val_gene_expr_recon_loss: 2952473.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5490404.0000; val_optim_loss: 5490404.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7954; val_auprc_score: 0.9112; val_best_acc_score: 0.7803; val_best_f1_score: 0.8695; train_kl_reg_loss: 2631.9668; train_edge_recon_loss: 1826033.8125; train_cat_covariates_contrastive_loss: 683005.1875; train_gene_expr_recon_loss: 2978305.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5489976.2500; train_optim_loss: 5489976.2500; val_kl_reg_loss: 2610.8770; val_edge_recon_loss: 2105788.2500; val_cat_covariates_contrastive_loss: 628074.3125; val_gene_expr_recon_loss: 2932875.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5669348.5000; val_optim_loss: 5669348.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8016; val_auprc_score: 0.9150; val_best_acc_score: 0.7935; val_best_f1_score: 0.8740; train_kl_reg_loss: 2670.4890; train_edge_recon_loss: 1773997.5000; train_cat_covariates_contrastive_loss: 678003.8750; train_gene_expr_recon_loss: 2912000.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5366672.5000; train_optim_loss: 5366672.5000; val_kl_reg_loss: 2836.6260; val_edge_recon_loss: 2070101.7500; val_cat_covariates_contrastive_loss: 628203.1250; val_gene_expr_recon_loss: 2908398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5609539.5000; val_optim_loss: 5609539.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7996; val_auprc_score: 0.9184; val_best_acc_score: 0.7905; val_best_f1_score: 0.8737; train_kl_reg_loss: 2894.2668; train_edge_recon_loss: 1816087.5625; train_cat_covariates_contrastive_loss: 677408.5938; train_gene_expr_recon_loss: 2918810.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5415201.0000; train_optim_loss: 5415201.0000; val_kl_reg_loss: 2928.4976; val_edge_recon_loss: 2090822.0000; val_cat_covariates_contrastive_loss: 628163.1250; val_gene_expr_recon_loss: 2888299.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5610212.5000; val_optim_loss: 5610212.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8000; val_auprc_score: 0.9223; val_best_acc_score: 0.8105; val_best_f1_score: 0.8867; train_kl_reg_loss: 3060.9706; train_edge_recon_loss: 1776525.3750; train_cat_covariates_contrastive_loss: 678898.2812; train_gene_expr_recon_loss: 2888411.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5346895.7500; train_optim_loss: 5346895.7500; val_kl_reg_loss: 3134.7869; val_edge_recon_loss: 1875040.5000; val_cat_covariates_contrastive_loss: 628465.5625; val_gene_expr_recon_loss: 2870726.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5377367.0000; val_optim_loss: 5377367.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7571; val_auprc_score: 0.8819; val_best_acc_score: 0.7902; val_best_f1_score: 0.8729; train_kl_reg_loss: 3205.6367; train_edge_recon_loss: 1754134.0000; train_cat_covariates_contrastive_loss: 671404.3125; train_gene_expr_recon_loss: 2886920.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5315664.5000; train_optim_loss: 5315664.5000; val_kl_reg_loss: 3426.0635; val_edge_recon_loss: 1968196.8750; val_cat_covariates_contrastive_loss: 628165.8125; val_gene_expr_recon_loss: 2855193.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5454982.0000; val_optim_loss: 5454982.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7635; val_auprc_score: 0.9142; val_best_acc_score: 0.8105; val_best_f1_score: 0.8880; train_kl_reg_loss: 3415.0165; train_edge_recon_loss: 1717897.6250; train_cat_covariates_contrastive_loss: 673724.3750; train_gene_expr_recon_loss: 2857627.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5252664.5000; train_optim_loss: 5252664.5000; val_kl_reg_loss: 3667.8428; val_edge_recon_loss: 1686348.7500; val_cat_covariates_contrastive_loss: 628994.3750; val_gene_expr_recon_loss: 2831999.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5151010.0000; val_optim_loss: 5151010.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7539; val_auprc_score: 0.8945; val_best_acc_score: 0.7934; val_best_f1_score: 0.8743; train_kl_reg_loss: 3729.0999; train_edge_recon_loss: 1707003.8750; train_cat_covariates_contrastive_loss: 663184.3438; train_gene_expr_recon_loss: 2815578.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5189496.2500; train_optim_loss: 5189496.2500; val_kl_reg_loss: 4162.5928; val_edge_recon_loss: 1868806.6250; val_cat_covariates_contrastive_loss: 628699.8750; val_gene_expr_recon_loss: 2824808.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5326478.0000; val_optim_loss: 5326478.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7624; val_auprc_score: 0.9010; val_best_acc_score: 0.7859; val_best_f1_score: 0.8735; train_kl_reg_loss: 4162.9116; train_edge_recon_loss: 1712697.3750; train_cat_covariates_contrastive_loss: 654029.2500; train_gene_expr_recon_loss: 2819878.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5190768.0000; train_optim_loss: 5190768.0000; val_kl_reg_loss: 4381.9443; val_edge_recon_loss: 1819848.2500; val_cat_covariates_contrastive_loss: 628986.4375; val_gene_expr_recon_loss: 2810040.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5263257.0000; val_optim_loss: 5263257.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7495; val_auprc_score: 0.8913; val_best_acc_score: 0.7910; val_best_f1_score: 0.8755; train_kl_reg_loss: 4539.3174; train_edge_recon_loss: 1694329.6250; train_cat_covariates_contrastive_loss: 657212.8750; train_gene_expr_recon_loss: 2807910.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5163992.5000; train_optim_loss: 5163992.5000; val_kl_reg_loss: 4910.4102; val_edge_recon_loss: 1759715.3750; val_cat_covariates_contrastive_loss: 628420.7500; val_gene_expr_recon_loss: 2791527.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5184574.0000; val_optim_loss: 5184574.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7402; val_auprc_score: 0.8959; val_best_acc_score: 0.7861; val_best_f1_score: 0.8740; train_kl_reg_loss: 4959.3462; train_edge_recon_loss: 1715821.8125; train_cat_covariates_contrastive_loss: 643928.7500; train_gene_expr_recon_loss: 2793791.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5158501.7500; train_optim_loss: 5158501.7500; val_kl_reg_loss: 5330.4082; val_edge_recon_loss: 1731784.2500; val_cat_covariates_contrastive_loss: 628279.8750; val_gene_expr_recon_loss: 2785075.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5150469.5000; val_optim_loss: 5150469.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7590; val_auprc_score: 0.9058; val_best_acc_score: 0.8123; val_best_f1_score: 0.8886; train_kl_reg_loss: 5594.4739; train_edge_recon_loss: 1712408.4375; train_cat_covariates_contrastive_loss: 647969.1875; train_gene_expr_recon_loss: 2790348.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5156320.5000; train_optim_loss: 5156320.5000; val_kl_reg_loss: 5854.6646; val_edge_recon_loss: 1585235.0000; val_cat_covariates_contrastive_loss: 627917.8750; val_gene_expr_recon_loss: 2770173.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4989181.0000; val_optim_loss: 4989181.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7762; val_auprc_score: 0.9036; val_best_acc_score: 0.7969; val_best_f1_score: 0.8775; train_kl_reg_loss: 6098.2190; train_edge_recon_loss: 1620388.1250; train_cat_covariates_contrastive_loss: 637878.5938; train_gene_expr_recon_loss: 2755070.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5019435.5000; train_optim_loss: 5019435.5000; val_kl_reg_loss: 6684.2422; val_edge_recon_loss: 1643324.0000; val_cat_covariates_contrastive_loss: 627815.0000; val_gene_expr_recon_loss: 2759284.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5037107.5000; val_optim_loss: 5037107.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7493; val_auprc_score: 0.8872; val_best_acc_score: 0.7919; val_best_f1_score: 0.8737; train_kl_reg_loss: 6905.0269; train_edge_recon_loss: 1601851.5625; train_cat_covariates_contrastive_loss: 639309.2500; train_gene_expr_recon_loss: 2758812.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5006878.0000; train_optim_loss: 5006878.0000; val_kl_reg_loss: 7638.2822; val_edge_recon_loss: 1675519.7500; val_cat_covariates_contrastive_loss: 627640.6875; val_gene_expr_recon_loss: 2747852.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5058651.5000; val_optim_loss: 5058651.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7491; val_auprc_score: 0.8777; val_best_acc_score: 0.7859; val_best_f1_score: 0.8692; train_kl_reg_loss: 7774.4463; train_edge_recon_loss: 1585423.5000; train_cat_covariates_contrastive_loss: 635213.3438; train_gene_expr_recon_loss: 2738157.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4966569.0000; train_optim_loss: 4966569.0000; val_kl_reg_loss: 8879.2461; val_edge_recon_loss: 1771241.6250; val_cat_covariates_contrastive_loss: 627562.6875; val_gene_expr_recon_loss: 2740243.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5147927.0000; val_optim_loss: 5147927.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7199; val_auprc_score: 0.8788; val_best_acc_score: 0.7980; val_best_f1_score: 0.8792; train_kl_reg_loss: 9217.7549; train_edge_recon_loss: 1572860.0000; train_cat_covariates_contrastive_loss: 632571.3438; train_gene_expr_recon_loss: 2735089.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4949739.0000; train_optim_loss: 4949739.0000; val_kl_reg_loss: 10414.0859; val_edge_recon_loss: 1630687.7500; val_cat_covariates_contrastive_loss: 627261.2500; val_gene_expr_recon_loss: 2727271.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4995634.5000; val_optim_loss: 4995634.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.7208; val_auprc_score: 0.8819; val_best_acc_score: 0.7856; val_best_f1_score: 0.8735; train_kl_reg_loss: 10447.8354; train_edge_recon_loss: 1528956.1250; train_cat_covariates_contrastive_loss: 630269.1562; train_gene_expr_recon_loss: 2721866.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4891539.2500; train_optim_loss: 4891539.2500; val_kl_reg_loss: 10385.7832; val_edge_recon_loss: 1653390.3750; val_cat_covariates_contrastive_loss: 627460.7500; val_gene_expr_recon_loss: 2726571.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5017808.0000; val_optim_loss: 5017808.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7505; val_auprc_score: 0.8913; val_best_acc_score: 0.8125; val_best_f1_score: 0.8872; train_kl_reg_loss: 10516.3779; train_edge_recon_loss: 1546154.2500; train_cat_covariates_contrastive_loss: 631095.5000; train_gene_expr_recon_loss: 2710025.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4897791.2500; train_optim_loss: 4897791.2500; val_kl_reg_loss: 10711.5059; val_edge_recon_loss: 1502050.6250; val_cat_covariates_contrastive_loss: 627206.6875; val_gene_expr_recon_loss: 2728994.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868963.0000; val_optim_loss: 4868963.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7264; val_auprc_score: 0.8899; val_best_acc_score: 0.7898; val_best_f1_score: 0.8746; train_kl_reg_loss: 10727.1719; train_edge_recon_loss: 1532437.3750; train_cat_covariates_contrastive_loss: 631343.7500; train_gene_expr_recon_loss: 2729232.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4903741.0000; train_optim_loss: 4903741.0000; val_kl_reg_loss: 10581.6504; val_edge_recon_loss: 1632475.2500; val_cat_covariates_contrastive_loss: 627165.3750; val_gene_expr_recon_loss: 2722054.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4992277.0000; val_optim_loss: 4992277.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7273; val_auprc_score: 0.8818; val_best_acc_score: 0.7963; val_best_f1_score: 0.8787; train_kl_reg_loss: 10776.5747; train_edge_recon_loss: 1565025.3750; train_cat_covariates_contrastive_loss: 630547.8438; train_gene_expr_recon_loss: 2725033.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4931383.5000; train_optim_loss: 4931383.5000; val_kl_reg_loss: 10773.8740; val_edge_recon_loss: 1652962.6250; val_cat_covariates_contrastive_loss: 627236.6250; val_gene_expr_recon_loss: 2719173.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5010146.0000; val_optim_loss: 5010146.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.7455; val_auprc_score: 0.8931; val_best_acc_score: 0.8002; val_best_f1_score: 0.8791; train_kl_reg_loss: 10880.3994; train_edge_recon_loss: 1589467.8125; train_cat_covariates_contrastive_loss: 631360.9062; train_gene_expr_recon_loss: 2724808.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4956518.0000; train_optim_loss: 4956518.0000; val_kl_reg_loss: 10790.5391; val_edge_recon_loss: 1594128.5000; val_cat_covariates_contrastive_loss: 627222.9375; val_gene_expr_recon_loss: 2720521.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4952663.5000; val_optim_loss: 4952663.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7163; val_auprc_score: 0.8848; val_best_acc_score: 0.8027; val_best_f1_score: 0.8835; train_kl_reg_loss: 10917.5410; train_edge_recon_loss: 1527414.1250; train_cat_covariates_contrastive_loss: 629774.6562; train_gene_expr_recon_loss: 2718218.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4886325.2500; train_optim_loss: 4886325.2500; val_kl_reg_loss: 10900.1387; val_edge_recon_loss: 1601604.1250; val_cat_covariates_contrastive_loss: 627157.8750; val_gene_expr_recon_loss: 2715349.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4955011.0000; val_optim_loss: 4955011.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.6861; val_auprc_score: 0.8695; val_best_acc_score: 0.7815; val_best_f1_score: 0.8715; train_kl_reg_loss: 11103.3716; train_edge_recon_loss: 1578863.0625; train_cat_covariates_contrastive_loss: 629656.7812; train_gene_expr_recon_loss: 2735879.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4955502.7500; train_optim_loss: 4955502.7500; val_kl_reg_loss: 10878.0801; val_edge_recon_loss: 1699347.2500; val_cat_covariates_contrastive_loss: 627419.6875; val_gene_expr_recon_loss: 2719554.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5057199.5000; val_optim_loss: 5057199.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.7352; val_auprc_score: 0.8905; val_best_acc_score: 0.7889; val_best_f1_score: 0.8750; train_kl_reg_loss: 11058.7148; train_edge_recon_loss: 1565512.3750; train_cat_covariates_contrastive_loss: 631961.5625; train_gene_expr_recon_loss: 2703433.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4911966.2500; train_optim_loss: 4911966.2500; val_kl_reg_loss: 11016.0605; val_edge_recon_loss: 1602202.0000; val_cat_covariates_contrastive_loss: 627333.9375; val_gene_expr_recon_loss: 2718815.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4959367.5000; val_optim_loss: 4959367.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.7523; val_auprc_score: 0.8939; val_best_acc_score: 0.8026; val_best_f1_score: 0.8817; train_kl_reg_loss: 11059.6934; train_edge_recon_loss: 1579994.1250; train_cat_covariates_contrastive_loss: 630452.5000; train_gene_expr_recon_loss: 2735077.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4956584.2500; train_optim_loss: 4956584.2500; val_kl_reg_loss: 10980.6406; val_edge_recon_loss: 1619339.2500; val_cat_covariates_contrastive_loss: 627376.8750; val_gene_expr_recon_loss: 2716234.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4973931.0000; val_optim_loss: 4973931.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7346; val_auprc_score: 0.8811; val_best_acc_score: 0.7969; val_best_f1_score: 0.8783; train_kl_reg_loss: 10940.3955; train_edge_recon_loss: 1600512.4375; train_cat_covariates_contrastive_loss: 630412.2500; train_gene_expr_recon_loss: 2721253.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4963118.0000; train_optim_loss: 4963118.0000; val_kl_reg_loss: 11048.5625; val_edge_recon_loss: 1652996.2500; val_cat_covariates_contrastive_loss: 627196.3750; val_gene_expr_recon_loss: 2716500.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5007741.5000; val_optim_loss: 5007741.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 34 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.7622
val AUPRC score: 0.9078
val best accuracy score: 0.8114
val best F1 score: 0.8865
val target rna MSE score: 1.0687
val source rna MSE score: 0.4405
Val cat covariate0 mean sim diff: 0.0109
Val cat covariate1 mean sim diff: 0.0109
Duration of model training in run 1: 0 hours, 0 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
