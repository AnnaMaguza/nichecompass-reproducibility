Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9314; val_auprc_score: 0.9603; val_best_acc_score: 0.9014; val_best_f1_score: 0.9306; train_kl_reg_loss: 26644.4440; train_edge_recon_loss: 1792782.3588; train_cat_covariates_contrastive_loss: 1907888.8101; train_gene_expr_recon_loss: 26950756.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30678072.4580; train_optim_loss: 30678072.4580; val_kl_reg_loss: 25980.6333; val_edge_recon_loss: 1787237.7000; val_cat_covariates_contrastive_loss: 1908891.2500; val_gene_expr_recon_loss: 26822454.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30544564.0000; val_optim_loss: 30544564.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9392; val_auprc_score: 0.9663; val_best_acc_score: 0.9043; val_best_f1_score: 0.9325; train_kl_reg_loss: 26041.9386; train_edge_recon_loss: 1801387.5611; train_cat_covariates_contrastive_loss: 1906410.9132; train_gene_expr_recon_loss: 26944396.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30678236.5496; train_optim_loss: 30678236.5496; val_kl_reg_loss: 27167.8743; val_edge_recon_loss: 1810784.7000; val_cat_covariates_contrastive_loss: 1908056.8167; val_gene_expr_recon_loss: 26816440.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30562450.2667; val_optim_loss: 30562450.2667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9332; val_auprc_score: 0.9625; val_best_acc_score: 0.9007; val_best_f1_score: 0.9306; train_kl_reg_loss: 26793.8676; train_edge_recon_loss: 1789537.1021; train_cat_covariates_contrastive_loss: 1905528.2605; train_gene_expr_recon_loss: 26910952.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30632811.5878; train_optim_loss: 30632811.5878; val_kl_reg_loss: 26272.7010; val_edge_recon_loss: 1788901.4083; val_cat_covariates_contrastive_loss: 1911447.3167; val_gene_expr_recon_loss: 26872067.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30598688.9333; val_optim_loss: 30598688.9333
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9367; val_auprc_score: 0.9635; val_best_acc_score: 0.9052; val_best_f1_score: 0.9330; train_kl_reg_loss: 26376.6683; train_edge_recon_loss: 1800707.4380; train_cat_covariates_contrastive_loss: 1906473.7996; train_gene_expr_recon_loss: 26886267.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30619824.9771; train_optim_loss: 30619824.9771; val_kl_reg_loss: 25292.7615; val_edge_recon_loss: 1792183.3083; val_cat_covariates_contrastive_loss: 1916845.0000; val_gene_expr_recon_loss: 26751500.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30485822.0000; val_optim_loss: 30485822.0000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9264; val_auprc_score: 0.9582; val_best_acc_score: 0.9003; val_best_f1_score: 0.9304; train_kl_reg_loss: 26635.3508; train_edge_recon_loss: 1801759.7300; train_cat_covariates_contrastive_loss: 1905065.2252; train_gene_expr_recon_loss: 26880779.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30614240.1985; train_optim_loss: 30614240.1985; val_kl_reg_loss: 28025.7158; val_edge_recon_loss: 1795947.1000; val_cat_covariates_contrastive_loss: 1898229.3500; val_gene_expr_recon_loss: 26843242.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30565444.8000; val_optim_loss: 30565444.8000
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9336; val_auprc_score: 0.9623; val_best_acc_score: 0.9056; val_best_f1_score: 0.9333; train_kl_reg_loss: 26617.2588; train_edge_recon_loss: 1810205.1336; train_cat_covariates_contrastive_loss: 1905821.8445; train_gene_expr_recon_loss: 26872414.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30615058.4427; train_optim_loss: 30615058.4427; val_kl_reg_loss: 26265.4188; val_edge_recon_loss: 1819290.7500; val_cat_covariates_contrastive_loss: 1905742.2333; val_gene_expr_recon_loss: 26680491.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30431789.7333; val_optim_loss: 30431789.7333
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9414; val_auprc_score: 0.9664; val_best_acc_score: 0.9034; val_best_f1_score: 0.9309; train_kl_reg_loss: 26686.1685; train_edge_recon_loss: 1801472.7347; train_cat_covariates_contrastive_loss: 1906084.9179; train_gene_expr_recon_loss: 26865449.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30599693.3893; train_optim_loss: 30599693.3893; val_kl_reg_loss: 23422.9988; val_edge_recon_loss: 1798530.6333; val_cat_covariates_contrastive_loss: 1925391.9500; val_gene_expr_recon_loss: 26701031.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30448376.5333; val_optim_loss: 30448376.5333
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9430; val_auprc_score: 0.9692; val_best_acc_score: 0.9013; val_best_f1_score: 0.9297; train_kl_reg_loss: 26235.1663; train_edge_recon_loss: 1808896.7700; train_cat_covariates_contrastive_loss: 1904360.2719; train_gene_expr_recon_loss: 26866336.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30605828.8092; train_optim_loss: 30605828.8092; val_kl_reg_loss: 26720.8241; val_edge_recon_loss: 1812778.8917; val_cat_covariates_contrastive_loss: 1901045.2083; val_gene_expr_recon_loss: 26749277.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30489822.4000; val_optim_loss: 30489822.4000
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9397; val_auprc_score: 0.9653; val_best_acc_score: 0.9058; val_best_f1_score: 0.9337; train_kl_reg_loss: 26482.4502; train_edge_recon_loss: 1791225.7710; train_cat_covariates_contrastive_loss: 1904380.7863; train_gene_expr_recon_loss: 26825502.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30547591.6031; train_optim_loss: 30547591.6031; val_kl_reg_loss: 25569.4263; val_edge_recon_loss: 1799270.0333; val_cat_covariates_contrastive_loss: 1904374.0417; val_gene_expr_recon_loss: 26846816.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30576030.4000; val_optim_loss: 30576030.4000
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9292; val_auprc_score: 0.9579; val_best_acc_score: 0.9052; val_best_f1_score: 0.9332; train_kl_reg_loss: 26585.3361; train_edge_recon_loss: 1787418.2968; train_cat_covariates_contrastive_loss: 1904856.1317; train_gene_expr_recon_loss: 26818830.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30537689.7710; train_optim_loss: 30537689.7710; val_kl_reg_loss: 27240.9784; val_edge_recon_loss: 1829520.6417; val_cat_covariates_contrastive_loss: 1912149.4333; val_gene_expr_recon_loss: 26751332.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30520244.0000; val_optim_loss: 30520244.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9246; val_auprc_score: 0.9530; val_best_acc_score: 0.8998; val_best_f1_score: 0.9298; train_kl_reg_loss: 27085.7337; train_edge_recon_loss: 1808422.6794; train_cat_covariates_contrastive_loss: 1904113.5334; train_gene_expr_recon_loss: 26767447.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30507069.6794; train_optim_loss: 30507069.6794; val_kl_reg_loss: 27705.9786; val_edge_recon_loss: 1822015.5667; val_cat_covariates_contrastive_loss: 1898398.5500; val_gene_expr_recon_loss: 26667500.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30415619.8667; val_optim_loss: 30415619.8667
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9299; val_auprc_score: 0.9618; val_best_acc_score: 0.9033; val_best_f1_score: 0.9323; train_kl_reg_loss: 27474.2743; train_edge_recon_loss: 1799406.0792; train_cat_covariates_contrastive_loss: 1903840.5334; train_gene_expr_recon_loss: 26755192.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30485913.0687; train_optim_loss: 30485913.0687; val_kl_reg_loss: 26821.8297; val_edge_recon_loss: 1791700.0333; val_cat_covariates_contrastive_loss: 1915012.5583; val_gene_expr_recon_loss: 26716530.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30450064.5333; val_optim_loss: 30450064.5333
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.9301; val_auprc_score: 0.9592; val_best_acc_score: 0.9030; val_best_f1_score: 0.9318; train_kl_reg_loss: 27202.9296; train_edge_recon_loss: 1782469.6937; train_cat_covariates_contrastive_loss: 1903440.2471; train_gene_expr_recon_loss: 26758566.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30471679.4046; train_optim_loss: 30471679.4046; val_kl_reg_loss: 26861.0083; val_edge_recon_loss: 1788327.0667; val_cat_covariates_contrastive_loss: 1905680.6083; val_gene_expr_recon_loss: 26724342.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30445210.5333; val_optim_loss: 30445210.5333
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9317; val_auprc_score: 0.9598; val_best_acc_score: 0.9064; val_best_f1_score: 0.9350; train_kl_reg_loss: 27470.2341; train_edge_recon_loss: 1790940.9914; train_cat_covariates_contrastive_loss: 1904207.3387; train_gene_expr_recon_loss: 26751035.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30473654.3511; train_optim_loss: 30473654.3511; val_kl_reg_loss: 27663.6204; val_edge_recon_loss: 1777490.7667; val_cat_covariates_contrastive_loss: 1900551.5000; val_gene_expr_recon_loss: 26623719.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30329424.9333; val_optim_loss: 30329424.9333
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9339; val_auprc_score: 0.9625; val_best_acc_score: 0.9022; val_best_f1_score: 0.9310; train_kl_reg_loss: 27529.5720; train_edge_recon_loss: 1784709.7147; train_cat_covariates_contrastive_loss: 1902223.6823; train_gene_expr_recon_loss: 26753439.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30467902.3206; train_optim_loss: 30467902.3206; val_kl_reg_loss: 26689.9607; val_edge_recon_loss: 1835812.8417; val_cat_covariates_contrastive_loss: 1900928.5750; val_gene_expr_recon_loss: 26483635.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30247067.2000; val_optim_loss: 30247067.2000
Epoch 75/400 |███-----------------| 18.8% val_auroc_score: 0.9407; val_auprc_score: 0.9663; val_best_acc_score: 0.9133; val_best_f1_score: 0.9393; train_kl_reg_loss: 27329.1036; train_edge_recon_loss: 1789096.2166; train_cat_covariates_contrastive_loss: 1904913.2204; train_gene_expr_recon_loss: 26749202.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30470541.5115; train_optim_loss: 30470541.5115; val_kl_reg_loss: 27260.6962; val_edge_recon_loss: 1759661.6583; val_cat_covariates_contrastive_loss: 1901907.0750; val_gene_expr_recon_loss: 26639822.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30328651.7333; val_optim_loss: 30328651.7333
Epoch 76/400 |███-----------------| 19.0% val_auroc_score: 0.9348; val_auprc_score: 0.9623; val_best_acc_score: 0.9071; val_best_f1_score: 0.9343; train_kl_reg_loss: 27654.6273; train_edge_recon_loss: 1803086.9857; train_cat_covariates_contrastive_loss: 1904292.2882; train_gene_expr_recon_loss: 26747645.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30482679.7405; train_optim_loss: 30482679.7405; val_kl_reg_loss: 27826.1324; val_edge_recon_loss: 1794079.2583; val_cat_covariates_contrastive_loss: 1910166.3417; val_gene_expr_recon_loss: 26620754.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30352826.1333; val_optim_loss: 30352826.1333
Epoch 77/400 |███-----------------| 19.2% val_auroc_score: 0.9294; val_auprc_score: 0.9581; val_best_acc_score: 0.9017; val_best_f1_score: 0.9309; train_kl_reg_loss: 27218.7469; train_edge_recon_loss: 1792952.0878; train_cat_covariates_contrastive_loss: 1902328.6527; train_gene_expr_recon_loss: 26748570.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30471070.5038; train_optim_loss: 30471070.5038; val_kl_reg_loss: 27212.4845; val_edge_recon_loss: 1855951.3000; val_cat_covariates_contrastive_loss: 1901037.9000; val_gene_expr_recon_loss: 26595703.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30379905.7333; val_optim_loss: 30379905.7333
Epoch 78/400 |███-----------------| 19.5% val_auroc_score: 0.9348; val_auprc_score: 0.9630; val_best_acc_score: 0.9045; val_best_f1_score: 0.9324; train_kl_reg_loss: 27008.1351; train_edge_recon_loss: 1807386.9246; train_cat_covariates_contrastive_loss: 1905762.0830; train_gene_expr_recon_loss: 26761470.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30501627.4198; train_optim_loss: 30501627.4198; val_kl_reg_loss: 26591.1457; val_edge_recon_loss: 1841442.2500; val_cat_covariates_contrastive_loss: 1904099.3917; val_gene_expr_recon_loss: 26669651.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30441784.1333; val_optim_loss: 30441784.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 79/400 |███-----------------| 19.8% val_auroc_score: 0.9409; val_auprc_score: 0.9683; val_best_acc_score: 0.9098; val_best_f1_score: 0.9366; train_kl_reg_loss: 26851.1640; train_edge_recon_loss: 1796328.2328; train_cat_covariates_contrastive_loss: 1905543.8387; train_gene_expr_recon_loss: 26729060.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30457783.5878; train_optim_loss: 30457783.5878; val_kl_reg_loss: 27061.1143; val_edge_recon_loss: 1787898.9750; val_cat_covariates_contrastive_loss: 1910659.2167; val_gene_expr_recon_loss: 26699109.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30424728.5333; val_optim_loss: 30424728.5333
Epoch 80/400 |████----------------| 20.0% val_auroc_score: 0.9323; val_auprc_score: 0.9624; val_best_acc_score: 0.9023; val_best_f1_score: 0.9316; train_kl_reg_loss: 27199.5300; train_edge_recon_loss: 1796054.4714; train_cat_covariates_contrastive_loss: 1907458.0143; train_gene_expr_recon_loss: 26746286.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30476998.7634; train_optim_loss: 30476998.7634; val_kl_reg_loss: 27034.0281; val_edge_recon_loss: 1819997.6000; val_cat_covariates_contrastive_loss: 1900288.4917; val_gene_expr_recon_loss: 26664752.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30412072.5333; val_optim_loss: 30412072.5333
Run timestamp: 30082023_125614_26.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '6', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--n_svg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'visium_mouse_brain', '--reference_batches', 'batch1', 'batch2', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'data', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_fc_layers_encoder', '2', '--n_hidden_encoder', '6000', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '3000000', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '3', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 32285, n_cat_covariates_embed_input: 0, n_hidden: 6000, n_latent: 1808, n_addon_latent: 10, n_fc_layers: 2, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1808, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 32285
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1808, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 32285

--- INITIALIZING TRAINER ---
Number of training nodes: 10948
Number of validation nodes: 1216
Number of training edges: 33527
Number of validation edges: 3725
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 81/400 |████----------------| 20.2% val_auroc_score: 0.9371; val_auprc_score: 0.9646; val_best_acc_score: 0.9056; val_best_f1_score: 0.9340; train_kl_reg_loss: 27312.5087; train_edge_recon_loss: 1783079.8368; train_cat_covariates_contrastive_loss: 1905191.5448; train_gene_expr_recon_loss: 26740277.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30455861.7863; train_optim_loss: 30455861.7863; val_kl_reg_loss: 27338.2556; val_edge_recon_loss: 1812434.0083; val_cat_covariates_contrastive_loss: 1905107.7250; val_gene_expr_recon_loss: 26723554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30468434.1333; val_optim_loss: 30468434.1333
Epoch 82/400 |████----------------| 20.5% val_auroc_score: 0.9387; val_auprc_score: 0.9649; val_best_acc_score: 0.9078; val_best_f1_score: 0.9350; train_kl_reg_loss: 27177.2655; train_edge_recon_loss: 1789059.6059; train_cat_covariates_contrastive_loss: 1903833.9494; train_gene_expr_recon_loss: 26730641.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30450712.4275; train_optim_loss: 30450712.4275; val_kl_reg_loss: 27185.0909; val_edge_recon_loss: 1808624.3333; val_cat_covariates_contrastive_loss: 1907886.2667; val_gene_expr_recon_loss: 26613477.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30357173.4667; val_optim_loss: 30357173.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 59 min 29 sec.
Using best model state, which was in epoch 74.

--- MODEL EVALUATION ---
val AUROC score: 0.9044
val AUPRC score: 0.9419
val best accuracy score: 0.8828
val best F1 score: 0.9170
val target rna MSE score: 267.6961
val source rna MSE score: 101.2713
Val cat covariate0 mean sim diff: -0.0022
Val cat covariate1 mean sim diff: -0.0510
Duration of model training in run 2: 0 hours, 59 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
