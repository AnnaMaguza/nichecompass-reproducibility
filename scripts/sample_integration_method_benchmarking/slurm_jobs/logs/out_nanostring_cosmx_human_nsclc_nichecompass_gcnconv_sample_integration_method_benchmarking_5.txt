Run timestamp: 02092023_193219_5.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '8', '--edge_batch_size_list', '4096', '4096', '--node_batch_size_list', 'None', 'None', '--seeds', '3', '2', '--run_index', '4', '3', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9492; val_auprc_score: 0.9824; val_best_acc_score: 0.9068; val_best_f1_score: 0.9405; train_kl_reg_loss: 25828.5271; train_edge_recon_loss: 1501774.8310; train_cat_covariates_contrastive_loss: 646651.7302; train_gene_expr_recon_loss: 3263039.2553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5437294.3609; train_optim_loss: 5437294.3609; val_kl_reg_loss: 25453.0707; val_edge_recon_loss: 1381316.0000; val_cat_covariates_contrastive_loss: 637559.6016; val_gene_expr_recon_loss: 2959649.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5003977.7344; val_optim_loss: 5003977.7344
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9679; val_auprc_score: 0.9884; val_best_acc_score: 0.9337; val_best_f1_score: 0.9574; train_kl_reg_loss: 20356.2153; train_edge_recon_loss: 1343862.2830; train_cat_covariates_contrastive_loss: 638954.2392; train_gene_expr_recon_loss: 2898415.7456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4901588.4947; train_optim_loss: 4901588.4947; val_kl_reg_loss: 16301.3400; val_edge_recon_loss: 1340599.1250; val_cat_covariates_contrastive_loss: 638517.6445; val_gene_expr_recon_loss: 2844445.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4839863.0938; val_optim_loss: 4839863.0938
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9736; val_auprc_score: 0.9902; val_best_acc_score: 0.9406; val_best_f1_score: 0.9617; train_kl_reg_loss: 14957.3827; train_edge_recon_loss: 1322489.1888; train_cat_covariates_contrastive_loss: 639426.7304; train_gene_expr_recon_loss: 2814360.6470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4791233.9577; train_optim_loss: 4791233.9577; val_kl_reg_loss: 13836.2679; val_edge_recon_loss: 1337254.7266; val_cat_covariates_contrastive_loss: 639439.1152; val_gene_expr_recon_loss: 2778168.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768698.4062; val_optim_loss: 4768698.4062
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9756; val_auprc_score: 0.9908; val_best_acc_score: 0.9454; val_best_f1_score: 0.9647; train_kl_reg_loss: 13738.6374; train_edge_recon_loss: 1315892.9107; train_cat_covariates_contrastive_loss: 638489.5889; train_gene_expr_recon_loss: 2760169.4754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4728290.6144; train_optim_loss: 4728290.6144; val_kl_reg_loss: 13151.3418; val_edge_recon_loss: 1327463.5039; val_cat_covariates_contrastive_loss: 638172.8750; val_gene_expr_recon_loss: 2734941.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4713728.9062; val_optim_loss: 4713728.9062
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9765; val_auprc_score: 0.9912; val_best_acc_score: 0.9473; val_best_f1_score: 0.9660; train_kl_reg_loss: 13476.2957; train_edge_recon_loss: 1316127.7812; train_cat_covariates_contrastive_loss: 637970.3233; train_gene_expr_recon_loss: 2717671.7350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4685246.1408; train_optim_loss: 4685246.1408; val_kl_reg_loss: 13339.6757; val_edge_recon_loss: 1323480.7734; val_cat_covariates_contrastive_loss: 637101.3633; val_gene_expr_recon_loss: 2697283.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4671205.8281; val_optim_loss: 4671205.8281
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9757; val_auprc_score: 0.9909; val_best_acc_score: 0.9473; val_best_f1_score: 0.9660; train_kl_reg_loss: 13472.7252; train_edge_recon_loss: 1311358.3385; train_cat_covariates_contrastive_loss: 637261.8352; train_gene_expr_recon_loss: 2680877.0528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4642969.9507; train_optim_loss: 4642969.9507; val_kl_reg_loss: 13349.9754; val_edge_recon_loss: 1331549.4336; val_cat_covariates_contrastive_loss: 636283.6035; val_gene_expr_recon_loss: 2659851.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4641034.8125; val_optim_loss: 4641034.8125
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9767; val_auprc_score: 0.9912; val_best_acc_score: 0.9497; val_best_f1_score: 0.9676; train_kl_reg_loss: 13592.4054; train_edge_recon_loss: 1311433.1408; train_cat_covariates_contrastive_loss: 636845.0368; train_gene_expr_recon_loss: 2650971.7711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4612842.3574; train_optim_loss: 4612842.3574; val_kl_reg_loss: 13504.4008; val_edge_recon_loss: 1327122.3867; val_cat_covariates_contrastive_loss: 636032.6445; val_gene_expr_recon_loss: 2636419.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4613079.4219; val_optim_loss: 4613079.4219
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9776; val_auprc_score: 0.9915; val_best_acc_score: 0.9505; val_best_f1_score: 0.9679; train_kl_reg_loss: 13826.6228; train_edge_recon_loss: 1312311.2117; train_cat_covariates_contrastive_loss: 636473.6347; train_gene_expr_recon_loss: 2625161.1954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4587772.6532; train_optim_loss: 4587772.6532; val_kl_reg_loss: 13841.6659; val_edge_recon_loss: 1325615.6055; val_cat_covariates_contrastive_loss: 636304.7520; val_gene_expr_recon_loss: 2611940.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4587702.7031; val_optim_loss: 4587702.7031
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9775; val_auprc_score: 0.9914; val_best_acc_score: 0.9509; val_best_f1_score: 0.9682; train_kl_reg_loss: 13961.3540; train_edge_recon_loss: 1310231.6312; train_cat_covariates_contrastive_loss: 636150.7606; train_gene_expr_recon_loss: 2602042.2808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4562386.0229; train_optim_loss: 4562386.0229; val_kl_reg_loss: 14073.5487; val_edge_recon_loss: 1314887.7070; val_cat_covariates_contrastive_loss: 635323.6680; val_gene_expr_recon_loss: 2593510.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4557795.7656; val_optim_loss: 4557795.7656
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9773; val_auprc_score: 0.9911; val_best_acc_score: 0.9523; val_best_f1_score: 0.9691; train_kl_reg_loss: 14151.7707; train_edge_recon_loss: 1311665.0585; train_cat_covariates_contrastive_loss: 636013.7735; train_gene_expr_recon_loss: 2584367.5669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4546198.1673; train_optim_loss: 4546198.1673; val_kl_reg_loss: 14086.2872; val_edge_recon_loss: 1324247.1133; val_cat_covariates_contrastive_loss: 635157.6855; val_gene_expr_recon_loss: 2574767.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4548258.5156; val_optim_loss: 4548258.5156
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9798; val_auprc_score: 0.9922; val_best_acc_score: 0.9543; val_best_f1_score: 0.9703; train_kl_reg_loss: 14286.4853; train_edge_recon_loss: 1312203.8622; train_cat_covariates_contrastive_loss: 635884.6948; train_gene_expr_recon_loss: 2566864.9604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4529240.0070; train_optim_loss: 4529240.0070; val_kl_reg_loss: 14257.1221; val_edge_recon_loss: 1324343.7422; val_cat_covariates_contrastive_loss: 635550.6289; val_gene_expr_recon_loss: 2559619.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4533771.0156; val_optim_loss: 4533771.0156
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9797; val_auprc_score: 0.9922; val_best_acc_score: 0.9539; val_best_f1_score: 0.9701; train_kl_reg_loss: 14533.3098; train_edge_recon_loss: 1310884.0761; train_cat_covariates_contrastive_loss: 635675.5830; train_gene_expr_recon_loss: 2552358.3046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4513451.2782; train_optim_loss: 4513451.2782; val_kl_reg_loss: 13965.3996; val_edge_recon_loss: 1321918.3320; val_cat_covariates_contrastive_loss: 636522.5547; val_gene_expr_recon_loss: 2547742.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520148.3281; val_optim_loss: 4520148.3281
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9797; val_auprc_score: 0.9921; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 14633.1067; train_edge_recon_loss: 1309437.4010; train_cat_covariates_contrastive_loss: 635516.7524; train_gene_expr_recon_loss: 2541355.9754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4500943.2271; train_optim_loss: 4500943.2271; val_kl_reg_loss: 14293.7795; val_edge_recon_loss: 1314013.3789; val_cat_covariates_contrastive_loss: 635924.3945; val_gene_expr_recon_loss: 2538216.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4502447.5312; val_optim_loss: 4502447.5312
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9793; val_auprc_score: 0.9919; val_best_acc_score: 0.9554; val_best_f1_score: 0.9710; train_kl_reg_loss: 14735.2145; train_edge_recon_loss: 1311162.1967; train_cat_covariates_contrastive_loss: 635450.5420; train_gene_expr_recon_loss: 2530824.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4492172.7077; train_optim_loss: 4492172.7077; val_kl_reg_loss: 14777.0650; val_edge_recon_loss: 1325348.5469; val_cat_covariates_contrastive_loss: 635263.1113; val_gene_expr_recon_loss: 2527604.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4502993.4688; val_optim_loss: 4502993.4688
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9801; val_auprc_score: 0.9922; val_best_acc_score: 0.9560; val_best_f1_score: 0.9714; train_kl_reg_loss: 14828.1099; train_edge_recon_loss: 1308028.5150; train_cat_covariates_contrastive_loss: 635185.4364; train_gene_expr_recon_loss: 2522302.8468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4480344.9032; train_optim_loss: 4480344.9032; val_kl_reg_loss: 14701.4966; val_edge_recon_loss: 1320530.6758; val_cat_covariates_contrastive_loss: 635373.9121; val_gene_expr_recon_loss: 2518787.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4489394.0312; val_optim_loss: 4489394.0312
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9802; val_auprc_score: 0.9923; val_best_acc_score: 0.9564; val_best_f1_score: 0.9716; train_kl_reg_loss: 14937.0701; train_edge_recon_loss: 1308723.8983; train_cat_covariates_contrastive_loss: 635240.8713; train_gene_expr_recon_loss: 2513477.7095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4472379.5440; train_optim_loss: 4472379.5440; val_kl_reg_loss: 14760.4886; val_edge_recon_loss: 1314353.9766; val_cat_covariates_contrastive_loss: 635040.5781; val_gene_expr_recon_loss: 2514529.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4478684.5000; val_optim_loss: 4478684.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9796; val_auprc_score: 0.9919; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 15019.5901; train_edge_recon_loss: 1303745.9564; train_cat_covariates_contrastive_loss: 635035.0460; train_gene_expr_recon_loss: 2507018.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4460819.0018; train_optim_loss: 4460819.0018; val_kl_reg_loss: 14636.3806; val_edge_recon_loss: 1315452.6172; val_cat_covariates_contrastive_loss: 635118.3691; val_gene_expr_recon_loss: 2506805.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4472012.6250; val_optim_loss: 4472012.6250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9787; val_auprc_score: 0.9916; val_best_acc_score: 0.9560; val_best_f1_score: 0.9714; train_kl_reg_loss: 15074.5393; train_edge_recon_loss: 1307690.8737; train_cat_covariates_contrastive_loss: 635021.5882; train_gene_expr_recon_loss: 2500920.0484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4458707.0493; train_optim_loss: 4458707.0493; val_kl_reg_loss: 15005.6709; val_edge_recon_loss: 1317267.4883; val_cat_covariates_contrastive_loss: 634297.6289; val_gene_expr_recon_loss: 2501365.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4467936.6562; val_optim_loss: 4467936.6562
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9791; val_auprc_score: 0.9916; val_best_acc_score: 0.9568; val_best_f1_score: 0.9720; train_kl_reg_loss: 15169.0881; train_edge_recon_loss: 1308117.9688; train_cat_covariates_contrastive_loss: 635009.2892; train_gene_expr_recon_loss: 2494128.0819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4452424.4296; train_optim_loss: 4452424.4296; val_kl_reg_loss: 15092.4531; val_edge_recon_loss: 1317423.3398; val_cat_covariates_contrastive_loss: 634568.3496; val_gene_expr_recon_loss: 2497258.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4464342.8438; val_optim_loss: 4464342.8438
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9792; val_auprc_score: 0.9917; val_best_acc_score: 0.9566; val_best_f1_score: 0.9719; train_kl_reg_loss: 15188.5041; train_edge_recon_loss: 1304580.5268; train_cat_covariates_contrastive_loss: 634834.1805; train_gene_expr_recon_loss: 2490134.6188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4444737.8257; train_optim_loss: 4444737.8257; val_kl_reg_loss: 15166.6366; val_edge_recon_loss: 1314874.2930; val_cat_covariates_contrastive_loss: 634344.2441; val_gene_expr_recon_loss: 2494303.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4458688.9219; val_optim_loss: 4458688.9219
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9798; val_auprc_score: 0.9921; val_best_acc_score: 0.9575; val_best_f1_score: 0.9725; train_kl_reg_loss: 15210.9703; train_edge_recon_loss: 1306720.7408; train_cat_covariates_contrastive_loss: 634839.5629; train_gene_expr_recon_loss: 2484274.2738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4441045.5370; train_optim_loss: 4441045.5370; val_kl_reg_loss: 15317.3337; val_edge_recon_loss: 1312237.9531; val_cat_covariates_contrastive_loss: 634292.3398; val_gene_expr_recon_loss: 2488622.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4450470.5000; val_optim_loss: 4450470.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9798; val_auprc_score: 0.9920; val_best_acc_score: 0.9571; val_best_f1_score: 0.9721; train_kl_reg_loss: 15276.4397; train_edge_recon_loss: 1305338.3301; train_cat_covariates_contrastive_loss: 634741.2923; train_gene_expr_recon_loss: 2481207.7993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4436563.8556; train_optim_loss: 4436563.8556; val_kl_reg_loss: 15191.2876; val_edge_recon_loss: 1319645.7500; val_cat_covariates_contrastive_loss: 634510.3672; val_gene_expr_recon_loss: 2486396.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4455743.8438; val_optim_loss: 4455743.8438
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9800; val_auprc_score: 0.9920; val_best_acc_score: 0.9585; val_best_f1_score: 0.9730; train_kl_reg_loss: 15324.6957; train_edge_recon_loss: 1308288.6250; train_cat_covariates_contrastive_loss: 634751.8581; train_gene_expr_recon_loss: 2477416.0827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4435781.2729; train_optim_loss: 4435781.2729; val_kl_reg_loss: 15087.9392; val_edge_recon_loss: 1322893.9141; val_cat_covariates_contrastive_loss: 634474.7891; val_gene_expr_recon_loss: 2483691.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4456148.0312; val_optim_loss: 4456148.0312
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9805; val_auprc_score: 0.9922; val_best_acc_score: 0.9581; val_best_f1_score: 0.9729; train_kl_reg_loss: 15379.8590; train_edge_recon_loss: 1304817.3354; train_cat_covariates_contrastive_loss: 634522.0900; train_gene_expr_recon_loss: 2474008.4692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428727.7658; train_optim_loss: 4428727.7658; val_kl_reg_loss: 15151.5088; val_edge_recon_loss: 1320852.7227; val_cat_covariates_contrastive_loss: 634942.1270; val_gene_expr_recon_loss: 2480833.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4451779.6250; val_optim_loss: 4451779.6250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9798; val_auprc_score: 0.9919; val_best_acc_score: 0.9564; val_best_f1_score: 0.9717; train_kl_reg_loss: 15413.8137; train_edge_recon_loss: 1307768.6065; train_cat_covariates_contrastive_loss: 634590.5383; train_gene_expr_recon_loss: 2471421.9445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4429194.8996; train_optim_loss: 4429194.8996; val_kl_reg_loss: 15163.4708; val_edge_recon_loss: 1317109.5859; val_cat_covariates_contrastive_loss: 634543.7891; val_gene_expr_recon_loss: 2477241.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4444058.6875; val_optim_loss: 4444058.6875
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9796; val_auprc_score: 0.9919; val_best_acc_score: 0.9588; val_best_f1_score: 0.9733; train_kl_reg_loss: 15364.9726; train_edge_recon_loss: 1307575.8077; train_cat_covariates_contrastive_loss: 634481.9012; train_gene_expr_recon_loss: 2469178.4067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4426601.1056; train_optim_loss: 4426601.1056; val_kl_reg_loss: 15216.1421; val_edge_recon_loss: 1314019.2461; val_cat_covariates_contrastive_loss: 633740.0430; val_gene_expr_recon_loss: 2473997.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4436972.5156; val_optim_loss: 4436972.5156
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9810; val_auprc_score: 0.9925; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 15390.2370; train_edge_recon_loss: 1306216.2324; train_cat_covariates_contrastive_loss: 634370.1294; train_gene_expr_recon_loss: 2466547.0246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4422523.6215; train_optim_loss: 4422523.6215; val_kl_reg_loss: 15265.7624; val_edge_recon_loss: 1309975.4297; val_cat_covariates_contrastive_loss: 634507.2129; val_gene_expr_recon_loss: 2472906.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4432654.7344; val_optim_loss: 4432654.7344
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9807; val_auprc_score: 0.9924; val_best_acc_score: 0.9576; val_best_f1_score: 0.9725; train_kl_reg_loss: 15466.9678; train_edge_recon_loss: 1305684.9938; train_cat_covariates_contrastive_loss: 634356.7520; train_gene_expr_recon_loss: 2464211.1408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4419719.8556; train_optim_loss: 4419719.8556; val_kl_reg_loss: 15057.7362; val_edge_recon_loss: 1317859.0352; val_cat_covariates_contrastive_loss: 634492.3809; val_gene_expr_recon_loss: 2468809.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4436218.2969; val_optim_loss: 4436218.2969
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9805; val_auprc_score: 0.9923; val_best_acc_score: 0.9584; val_best_f1_score: 0.9730; train_kl_reg_loss: 15392.6516; train_edge_recon_loss: 1305627.9547; train_cat_covariates_contrastive_loss: 634334.4232; train_gene_expr_recon_loss: 2461987.8609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4417342.9014; train_optim_loss: 4417342.9014; val_kl_reg_loss: 15091.8310; val_edge_recon_loss: 1318254.7969; val_cat_covariates_contrastive_loss: 634641.5234; val_gene_expr_recon_loss: 2471234.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4439222.3438; val_optim_loss: 4439222.3438
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9800; val_auprc_score: 0.9921; val_best_acc_score: 0.9590; val_best_f1_score: 0.9734; train_kl_reg_loss: 15417.0647; train_edge_recon_loss: 1306382.8737; train_cat_covariates_contrastive_loss: 634230.0088; train_gene_expr_recon_loss: 2460212.5722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4416242.5282; train_optim_loss: 4416242.5282; val_kl_reg_loss: 15429.9489; val_edge_recon_loss: 1309374.2891; val_cat_covariates_contrastive_loss: 633774.5059; val_gene_expr_recon_loss: 2466694.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4425273.2031; val_optim_loss: 4425273.2031
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9803; val_auprc_score: 0.9922; val_best_acc_score: 0.9582; val_best_f1_score: 0.9729; train_kl_reg_loss: 15436.7381; train_edge_recon_loss: 1306017.9397; train_cat_covariates_contrastive_loss: 634133.1226; train_gene_expr_recon_loss: 2458052.7007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4413640.5018; train_optim_loss: 4413640.5018; val_kl_reg_loss: 15114.0124; val_edge_recon_loss: 1314850.7227; val_cat_covariates_contrastive_loss: 634160.1836; val_gene_expr_recon_loss: 2466541.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4430666.6562; val_optim_loss: 4430666.6562
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9802; val_auprc_score: 0.9920; val_best_acc_score: 0.9606; val_best_f1_score: 0.9744; train_kl_reg_loss: 15467.7683; train_edge_recon_loss: 1305437.4652; train_cat_covariates_contrastive_loss: 634071.7775; train_gene_expr_recon_loss: 2456852.4481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4411829.4701; train_optim_loss: 4411829.4701; val_kl_reg_loss: 15313.8974; val_edge_recon_loss: 1315602.1602; val_cat_covariates_contrastive_loss: 633611.0488; val_gene_expr_recon_loss: 2463779.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4428306.7812; val_optim_loss: 4428306.7812
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9810; val_auprc_score: 0.9924; val_best_acc_score: 0.9601; val_best_f1_score: 0.9742; train_kl_reg_loss: 15453.4511; train_edge_recon_loss: 1306939.6593; train_cat_covariates_contrastive_loss: 634121.9905; train_gene_expr_recon_loss: 2454973.2095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4411488.3151; train_optim_loss: 4411488.3151; val_kl_reg_loss: 14992.7741; val_edge_recon_loss: 1313393.6680; val_cat_covariates_contrastive_loss: 634738.0566; val_gene_expr_recon_loss: 2464301.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427425.7031; val_optim_loss: 4427425.7031
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9801; val_auprc_score: 0.9919; val_best_acc_score: 0.9598; val_best_f1_score: 0.9740; train_kl_reg_loss: 15436.6905; train_edge_recon_loss: 1305364.8121; train_cat_covariates_contrastive_loss: 634031.9195; train_gene_expr_recon_loss: 2453650.1197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4408483.5458; train_optim_loss: 4408483.5458; val_kl_reg_loss: 15466.8208; val_edge_recon_loss: 1314962.3086; val_cat_covariates_contrastive_loss: 633645.9062; val_gene_expr_recon_loss: 2463445.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427520.9062; val_optim_loss: 4427520.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9806; val_auprc_score: 0.9923; val_best_acc_score: 0.9603; val_best_f1_score: 0.9743; train_kl_reg_loss: 15378.5444; train_edge_recon_loss: 1303799.4243; train_cat_covariates_contrastive_loss: 634136.5002; train_gene_expr_recon_loss: 2446306.9692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399621.4401; train_optim_loss: 4399621.4401; val_kl_reg_loss: 15196.8958; val_edge_recon_loss: 1307488.5430; val_cat_covariates_contrastive_loss: 633977.3203; val_gene_expr_recon_loss: 2457018.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4413681.3438; val_optim_loss: 4413681.3438
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9804; val_auprc_score: 0.9922; val_best_acc_score: 0.9600; val_best_f1_score: 0.9740; train_kl_reg_loss: 15362.6393; train_edge_recon_loss: 1306414.2262; train_cat_covariates_contrastive_loss: 634098.6063; train_gene_expr_recon_loss: 2445304.3239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4401179.7729; train_optim_loss: 4401179.7729; val_kl_reg_loss: 15189.0214; val_edge_recon_loss: 1316356.0156; val_cat_covariates_contrastive_loss: 634331.4453; val_gene_expr_recon_loss: 2454695.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4420572.0469; val_optim_loss: 4420572.0469
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9810; val_auprc_score: 0.9925; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 15344.1318; train_edge_recon_loss: 1304826.2909; train_cat_covariates_contrastive_loss: 634153.5390; train_gene_expr_recon_loss: 2444568.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4398892.7887; train_optim_loss: 4398892.7887; val_kl_reg_loss: 15032.7626; val_edge_recon_loss: 1314258.5312; val_cat_covariates_contrastive_loss: 634130.7441; val_gene_expr_recon_loss: 2454887.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4418309.2812; val_optim_loss: 4418309.2812
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9818; val_auprc_score: 0.9927; val_best_acc_score: 0.9602; val_best_f1_score: 0.9742; train_kl_reg_loss: 15366.1424; train_edge_recon_loss: 1301982.4789; train_cat_covariates_contrastive_loss: 633977.5438; train_gene_expr_recon_loss: 2444117.7210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4395443.8838; train_optim_loss: 4395443.8838; val_kl_reg_loss: 14995.8130; val_edge_recon_loss: 1320775.8203; val_cat_covariates_contrastive_loss: 634331.2773; val_gene_expr_recon_loss: 2456243.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4426346.1094; val_optim_loss: 4426346.1094
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9800; val_auprc_score: 0.9920; val_best_acc_score: 0.9592; val_best_f1_score: 0.9736; train_kl_reg_loss: 15392.2723; train_edge_recon_loss: 1303143.3710; train_cat_covariates_contrastive_loss: 634089.8614; train_gene_expr_recon_loss: 2442777.0290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4395402.5317; train_optim_loss: 4395402.5317; val_kl_reg_loss: 15116.1985; val_edge_recon_loss: 1314210.2539; val_cat_covariates_contrastive_loss: 633992.2129; val_gene_expr_recon_loss: 2453665.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4416984.3906; val_optim_loss: 4416984.3906

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9800; val_auprc_score: 0.9917; val_best_acc_score: 0.9603; val_best_f1_score: 0.9742; train_kl_reg_loss: 15334.2061; train_edge_recon_loss: 1305306.9652; train_cat_covariates_contrastive_loss: 634148.0152; train_gene_expr_recon_loss: 2442095.6805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4396884.8627; train_optim_loss: 4396884.8627; val_kl_reg_loss: 15124.9161; val_edge_recon_loss: 1319761.5703; val_cat_covariates_contrastive_loss: 633912.6504; val_gene_expr_recon_loss: 2454518.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4423317.7969; val_optim_loss: 4423317.7969
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9810; val_auprc_score: 0.9925; val_best_acc_score: 0.9602; val_best_f1_score: 0.9742; train_kl_reg_loss: 15339.9689; train_edge_recon_loss: 1303838.7619; train_cat_covariates_contrastive_loss: 634023.4051; train_gene_expr_recon_loss: 2441618.4014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4394820.5475; train_optim_loss: 4394820.5475; val_kl_reg_loss: 15099.6108; val_edge_recon_loss: 1315602.6719; val_cat_covariates_contrastive_loss: 634180.0039; val_gene_expr_recon_loss: 2449344.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4414226.3750; val_optim_loss: 4414226.3750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9810; val_auprc_score: 0.9923; val_best_acc_score: 0.9604; val_best_f1_score: 0.9743; train_kl_reg_loss: 15324.6843; train_edge_recon_loss: 1303408.3085; train_cat_covariates_contrastive_loss: 634140.8468; train_gene_expr_recon_loss: 2441418.4613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4394292.3028; train_optim_loss: 4394292.3028; val_kl_reg_loss: 15102.8046; val_edge_recon_loss: 1310295.1602; val_cat_covariates_contrastive_loss: 633904.3184; val_gene_expr_recon_loss: 2455482.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4414784.8906; val_optim_loss: 4414784.8906
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9813; val_auprc_score: 0.9925; val_best_acc_score: 0.9608; val_best_f1_score: 0.9745; train_kl_reg_loss: 15341.5372; train_edge_recon_loss: 1302890.9952; train_cat_covariates_contrastive_loss: 634064.8297; train_gene_expr_recon_loss: 2441980.4498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4394277.8081; train_optim_loss: 4394277.8081; val_kl_reg_loss: 15082.3880; val_edge_recon_loss: 1318139.6094; val_cat_covariates_contrastive_loss: 634217.3379; val_gene_expr_recon_loss: 2453656.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4421096.2969; val_optim_loss: 4421096.2969

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 298 min 28 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9437
val AUPRC score: 0.9702
val best accuracy score: 0.9470
val best F1 score: 0.9654
val target rna MSE score: 1.0750
val source rna MSE score: 0.1436
Val cat covariate0 mean sim diff: 0.0004
Val cat covariate1 mean sim diff: -0.1083
Duration of model training in run 4: 4 hours, 59 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9555; val_auprc_score: 0.9845; val_best_acc_score: 0.9144; val_best_f1_score: 0.9452; train_kl_reg_loss: 21986.6791; train_edge_recon_loss: 1483387.8988; train_cat_covariates_contrastive_loss: 646390.8195; train_gene_expr_recon_loss: 3255693.7887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5407459.1989; train_optim_loss: 5407459.1989; val_kl_reg_loss: 20615.8061; val_edge_recon_loss: 1369523.1719; val_cat_covariates_contrastive_loss: 638244.1738; val_gene_expr_recon_loss: 2982913.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5011296.3906; val_optim_loss: 5011296.3906
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9722; val_auprc_score: 0.9899; val_best_acc_score: 0.9386; val_best_f1_score: 0.9605; train_kl_reg_loss: 17292.9749; train_edge_recon_loss: 1333100.4635; train_cat_covariates_contrastive_loss: 639555.9577; train_gene_expr_recon_loss: 2917426.7324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4907376.1127; train_optim_loss: 4907376.1127; val_kl_reg_loss: 14721.8892; val_edge_recon_loss: 1340149.1445; val_cat_covariates_contrastive_loss: 639117.7676; val_gene_expr_recon_loss: 2871162.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4865151.3438; val_optim_loss: 4865151.3438
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9745; val_auprc_score: 0.9905; val_best_acc_score: 0.9424; val_best_f1_score: 0.9628; train_kl_reg_loss: 14097.4826; train_edge_recon_loss: 1320703.6408; train_cat_covariates_contrastive_loss: 639216.3860; train_gene_expr_recon_loss: 2832519.4613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4806536.9947; train_optim_loss: 4806536.9947; val_kl_reg_loss: 13173.3629; val_edge_recon_loss: 1339385.7656; val_cat_covariates_contrastive_loss: 638361.3945; val_gene_expr_recon_loss: 2804312.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4795233.0938; val_optim_loss: 4795233.0938
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9757; val_auprc_score: 0.9908; val_best_acc_score: 0.9456; val_best_f1_score: 0.9649; train_kl_reg_loss: 13366.2740; train_edge_recon_loss: 1314657.8116; train_cat_covariates_contrastive_loss: 638141.0277; train_gene_expr_recon_loss: 2775472.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4741637.3979; train_optim_loss: 4741637.3979; val_kl_reg_loss: 13254.3672; val_edge_recon_loss: 1330721.9141; val_cat_covariates_contrastive_loss: 637031.0781; val_gene_expr_recon_loss: 2754547.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4735554.5000; val_optim_loss: 4735554.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9757; val_auprc_score: 0.9909; val_best_acc_score: 0.9465; val_best_f1_score: 0.9656; train_kl_reg_loss: 13216.0789; train_edge_recon_loss: 1318002.3085; train_cat_covariates_contrastive_loss: 637486.4076; train_gene_expr_recon_loss: 2730232.1708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4698936.9754; train_optim_loss: 4698936.9754; val_kl_reg_loss: 13154.8679; val_edge_recon_loss: 1322813.4844; val_cat_covariates_contrastive_loss: 636608.2754; val_gene_expr_recon_loss: 2712752.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4685329.0312; val_optim_loss: 4685329.0312
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9771; val_auprc_score: 0.9913; val_best_acc_score: 0.9493; val_best_f1_score: 0.9673; train_kl_reg_loss: 13314.2402; train_edge_recon_loss: 1313227.4459; train_cat_covariates_contrastive_loss: 637044.6921; train_gene_expr_recon_loss: 2691575.7069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4655162.0669; train_optim_loss: 4655162.0669; val_kl_reg_loss: 13254.0032; val_edge_recon_loss: 1321944.4805; val_cat_covariates_contrastive_loss: 636536.2480; val_gene_expr_recon_loss: 2679039.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4650774.2188; val_optim_loss: 4650774.2188
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9781; val_auprc_score: 0.9918; val_best_acc_score: 0.9499; val_best_f1_score: 0.9676; train_kl_reg_loss: 13538.5479; train_edge_recon_loss: 1311947.8116; train_cat_covariates_contrastive_loss: 636597.8847; train_gene_expr_recon_loss: 2661243.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4623328.0264; train_optim_loss: 4623328.0264; val_kl_reg_loss: 13376.7710; val_edge_recon_loss: 1329118.5391; val_cat_covariates_contrastive_loss: 636770.5117; val_gene_expr_recon_loss: 2648852.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4628117.9688; val_optim_loss: 4628117.9688
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9777; val_auprc_score: 0.9915; val_best_acc_score: 0.9510; val_best_f1_score: 0.9683; train_kl_reg_loss: 13777.2609; train_edge_recon_loss: 1312946.6505; train_cat_covariates_contrastive_loss: 636270.3647; train_gene_expr_recon_loss: 2632480.0343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4595474.3046; train_optim_loss: 4595474.3046; val_kl_reg_loss: 13807.6580; val_edge_recon_loss: 1310149.3594; val_cat_covariates_contrastive_loss: 635611.7148; val_gene_expr_recon_loss: 2624932.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4584501.2344; val_optim_loss: 4584501.2344
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9775; val_auprc_score: 0.9912; val_best_acc_score: 0.9516; val_best_f1_score: 0.9687; train_kl_reg_loss: 14002.5177; train_edge_recon_loss: 1311034.9758; train_cat_covariates_contrastive_loss: 636120.3464; train_gene_expr_recon_loss: 2609088.1329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4570245.9806; train_optim_loss: 4570245.9806; val_kl_reg_loss: 14105.1526; val_edge_recon_loss: 1324239.7930; val_cat_covariates_contrastive_loss: 635518.5703; val_gene_expr_recon_loss: 2604081.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4577944.8438; val_optim_loss: 4577944.8438
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9787; val_auprc_score: 0.9916; val_best_acc_score: 0.9535; val_best_f1_score: 0.9699; train_kl_reg_loss: 14228.9701; train_edge_recon_loss: 1310597.2117; train_cat_covariates_contrastive_loss: 635938.1888; train_gene_expr_recon_loss: 2588334.0519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4549098.4208; train_optim_loss: 4549098.4208; val_kl_reg_loss: 14161.4359; val_edge_recon_loss: 1321440.9844; val_cat_covariates_contrastive_loss: 635581.6152; val_gene_expr_recon_loss: 2583590.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4554774.1094; val_optim_loss: 4554774.1094
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9793; val_auprc_score: 0.9919; val_best_acc_score: 0.9549; val_best_f1_score: 0.9708; train_kl_reg_loss: 14406.8797; train_edge_recon_loss: 1311249.7962; train_cat_covariates_contrastive_loss: 635841.6043; train_gene_expr_recon_loss: 2572224.3539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4533722.6373; train_optim_loss: 4533722.6373; val_kl_reg_loss: 14325.7700; val_edge_recon_loss: 1324454.7891; val_cat_covariates_contrastive_loss: 635066.6602; val_gene_expr_recon_loss: 2570577.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4544424.5000; val_optim_loss: 4544424.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9790; val_auprc_score: 0.9919; val_best_acc_score: 0.9548; val_best_f1_score: 0.9707; train_kl_reg_loss: 14512.4220; train_edge_recon_loss: 1305854.0123; train_cat_covariates_contrastive_loss: 635608.6941; train_gene_expr_recon_loss: 2556376.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512351.5845; train_optim_loss: 4512351.5845; val_kl_reg_loss: 14386.8427; val_edge_recon_loss: 1318215.3164; val_cat_covariates_contrastive_loss: 635075.1523; val_gene_expr_recon_loss: 2556571.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4524248.4062; val_optim_loss: 4524248.4062
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9794; val_auprc_score: 0.9918; val_best_acc_score: 0.9548; val_best_f1_score: 0.9706; train_kl_reg_loss: 14691.7206; train_edge_recon_loss: 1309019.2121; train_cat_covariates_contrastive_loss: 635425.4527; train_gene_expr_recon_loss: 2544245.8195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4503382.1954; train_optim_loss: 4503382.1954; val_kl_reg_loss: 14582.2594; val_edge_recon_loss: 1332903.1250; val_cat_covariates_contrastive_loss: 635081.9102; val_gene_expr_recon_loss: 2545657.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4528225.0312; val_optim_loss: 4528225.0312
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9794; val_auprc_score: 0.9919; val_best_acc_score: 0.9545; val_best_f1_score: 0.9706; train_kl_reg_loss: 14712.9534; train_edge_recon_loss: 1309769.3869; train_cat_covariates_contrastive_loss: 635365.3950; train_gene_expr_recon_loss: 2533726.3134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4493574.0352; train_optim_loss: 4493574.0352; val_kl_reg_loss: 14494.0957; val_edge_recon_loss: 1316564.1172; val_cat_covariates_contrastive_loss: 635540.5879; val_gene_expr_recon_loss: 2538038.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4504637.8281; val_optim_loss: 4504637.8281
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9802; val_auprc_score: 0.9922; val_best_acc_score: 0.9557; val_best_f1_score: 0.9713; train_kl_reg_loss: 14883.5985; train_edge_recon_loss: 1309532.0876; train_cat_covariates_contrastive_loss: 635221.6184; train_gene_expr_recon_loss: 2524695.9903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4484333.2905; train_optim_loss: 4484333.2905; val_kl_reg_loss: 14589.4304; val_edge_recon_loss: 1317150.1992; val_cat_covariates_contrastive_loss: 635673.2871; val_gene_expr_recon_loss: 2528903.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4496316.0469; val_optim_loss: 4496316.0469
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9793; val_auprc_score: 0.9918; val_best_acc_score: 0.9564; val_best_f1_score: 0.9718; train_kl_reg_loss: 14918.0011; train_edge_recon_loss: 1309131.3798; train_cat_covariates_contrastive_loss: 635156.2665; train_gene_expr_recon_loss: 2516334.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4475540.1479; train_optim_loss: 4475540.1479; val_kl_reg_loss: 14873.5070; val_edge_recon_loss: 1316460.2812; val_cat_covariates_contrastive_loss: 634491.2422; val_gene_expr_recon_loss: 2519855.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4485680.3125; val_optim_loss: 4485680.3125
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9791; val_auprc_score: 0.9918; val_best_acc_score: 0.9557; val_best_f1_score: 0.9714; train_kl_reg_loss: 14966.5708; train_edge_recon_loss: 1310126.0370; train_cat_covariates_contrastive_loss: 635131.1199; train_gene_expr_recon_loss: 2509666.6162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4469890.3327; train_optim_loss: 4469890.3327; val_kl_reg_loss: 15208.4349; val_edge_recon_loss: 1316434.1445; val_cat_covariates_contrastive_loss: 634794.3203; val_gene_expr_recon_loss: 2515065.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4481502.1094; val_optim_loss: 4481502.1094
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9801; val_auprc_score: 0.9921; val_best_acc_score: 0.9566; val_best_f1_score: 0.9718; train_kl_reg_loss: 15040.1601; train_edge_recon_loss: 1307748.4665; train_cat_covariates_contrastive_loss: 635045.0931; train_gene_expr_recon_loss: 2503588.5211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4461422.2377; train_optim_loss: 4461422.2377; val_kl_reg_loss: 14854.7511; val_edge_recon_loss: 1319010.3359; val_cat_covariates_contrastive_loss: 634699.1289; val_gene_expr_recon_loss: 2508185.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4476749.9688; val_optim_loss: 4476749.9688
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9794; val_auprc_score: 0.9918; val_best_acc_score: 0.9568; val_best_f1_score: 0.9720; train_kl_reg_loss: 15121.8761; train_edge_recon_loss: 1306395.3539; train_cat_covariates_contrastive_loss: 634837.9798; train_gene_expr_recon_loss: 2496661.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4453016.3187; train_optim_loss: 4453016.3187; val_kl_reg_loss: 14960.1555; val_edge_recon_loss: 1317383.6367; val_cat_covariates_contrastive_loss: 634374.9414; val_gene_expr_recon_loss: 2504914.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4471633.6250; val_optim_loss: 4471633.6250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9802; val_auprc_score: 0.9921; val_best_acc_score: 0.9583; val_best_f1_score: 0.9730; train_kl_reg_loss: 15174.3276; train_edge_recon_loss: 1308409.8019; train_cat_covariates_contrastive_loss: 634732.2055; train_gene_expr_recon_loss: 2492036.6681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4450353.0088; train_optim_loss: 4450353.0088; val_kl_reg_loss: 15024.6556; val_edge_recon_loss: 1316179.4531; val_cat_covariates_contrastive_loss: 634439.3945; val_gene_expr_recon_loss: 2499548.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4465191.7188; val_optim_loss: 4465191.7188
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9819; val_auprc_score: 0.9929; val_best_acc_score: 0.9580; val_best_f1_score: 0.9727; train_kl_reg_loss: 15219.6021; train_edge_recon_loss: 1306726.0621; train_cat_covariates_contrastive_loss: 634742.1129; train_gene_expr_recon_loss: 2487427.1540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4444114.9437; train_optim_loss: 4444114.9437; val_kl_reg_loss: 14968.8770; val_edge_recon_loss: 1317737.9141; val_cat_covariates_contrastive_loss: 635183.1406; val_gene_expr_recon_loss: 2493504.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4461394.3281; val_optim_loss: 4461394.3281
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9808; val_auprc_score: 0.9922; val_best_acc_score: 0.9589; val_best_f1_score: 0.9733; train_kl_reg_loss: 15206.8111; train_edge_recon_loss: 1307348.2923; train_cat_covariates_contrastive_loss: 634630.9718; train_gene_expr_recon_loss: 2483061.9877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4440248.0599; train_optim_loss: 4440248.0599; val_kl_reg_loss: 15179.1913; val_edge_recon_loss: 1316201.8164; val_cat_covariates_contrastive_loss: 634699.2012; val_gene_expr_recon_loss: 2495277.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4461357.5000; val_optim_loss: 4461357.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9804; val_auprc_score: 0.9922; val_best_acc_score: 0.9586; val_best_f1_score: 0.9731; train_kl_reg_loss: 15281.2676; train_edge_recon_loss: 1309102.6426; train_cat_covariates_contrastive_loss: 634580.6895; train_gene_expr_recon_loss: 2480324.6065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4439289.1919; train_optim_loss: 4439289.1919; val_kl_reg_loss: 15185.6885; val_edge_recon_loss: 1319276.4531; val_cat_covariates_contrastive_loss: 634087.6777; val_gene_expr_recon_loss: 2488332.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4456881.9219; val_optim_loss: 4456881.9219
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9794; val_auprc_score: 0.9918; val_best_acc_score: 0.9583; val_best_f1_score: 0.9730; train_kl_reg_loss: 15295.9198; train_edge_recon_loss: 1304698.4516; train_cat_covariates_contrastive_loss: 634579.1386; train_gene_expr_recon_loss: 2476198.7623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4430772.2623; train_optim_loss: 4430772.2623; val_kl_reg_loss: 15282.3200; val_edge_recon_loss: 1313333.3594; val_cat_covariates_contrastive_loss: 633964.4102; val_gene_expr_recon_loss: 2484738.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4447318.1094; val_optim_loss: 4447318.1094
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9812; val_auprc_score: 0.9926; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 15302.9713; train_edge_recon_loss: 1305335.6677; train_cat_covariates_contrastive_loss: 634533.0297; train_gene_expr_recon_loss: 2471611.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4426783.1849; train_optim_loss: 4426783.1849; val_kl_reg_loss: 15534.7166; val_edge_recon_loss: 1315097.1836; val_cat_covariates_contrastive_loss: 634262.7246; val_gene_expr_recon_loss: 2484536.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4449430.9375; val_optim_loss: 4449430.9375
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9790; val_auprc_score: 0.9916; val_best_acc_score: 0.9585; val_best_f1_score: 0.9731; train_kl_reg_loss: 15378.8920; train_edge_recon_loss: 1306823.7258; train_cat_covariates_contrastive_loss: 634389.1635; train_gene_expr_recon_loss: 2470632.5405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4427224.3257; train_optim_loss: 4427224.3257; val_kl_reg_loss: 15386.7749; val_edge_recon_loss: 1318717.3945; val_cat_covariates_contrastive_loss: 633837.4219; val_gene_expr_recon_loss: 2480959.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4448900.8594; val_optim_loss: 4448900.8594
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9803; val_auprc_score: 0.9922; val_best_acc_score: 0.9601; val_best_f1_score: 0.9742; train_kl_reg_loss: 15365.5852; train_edge_recon_loss: 1307608.8873; train_cat_covariates_contrastive_loss: 634335.6466; train_gene_expr_recon_loss: 2467337.7095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4424647.8134; train_optim_loss: 4424647.8134; val_kl_reg_loss: 15098.4117; val_edge_recon_loss: 1308463.7578; val_cat_covariates_contrastive_loss: 634183.3281; val_gene_expr_recon_loss: 2476338.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4434084.1719; val_optim_loss: 4434084.1719
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9810; val_auprc_score: 0.9922; val_best_acc_score: 0.9603; val_best_f1_score: 0.9743; train_kl_reg_loss: 15418.6708; train_edge_recon_loss: 1303800.0590; train_cat_covariates_contrastive_loss: 634319.4382; train_gene_expr_recon_loss: 2464106.3583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4417644.4982; train_optim_loss: 4417644.4982; val_kl_reg_loss: 15342.4743; val_edge_recon_loss: 1315237.7656; val_cat_covariates_contrastive_loss: 633940.0254; val_gene_expr_recon_loss: 2475913.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4440433.5312; val_optim_loss: 4440433.5312
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9798; val_auprc_score: 0.9918; val_best_acc_score: 0.9600; val_best_f1_score: 0.9742; train_kl_reg_loss: 15426.1468; train_edge_recon_loss: 1306073.7936; train_cat_covariates_contrastive_loss: 634431.3858; train_gene_expr_recon_loss: 2462425.4657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418356.7641; train_optim_loss: 4418356.7641; val_kl_reg_loss: 15046.1981; val_edge_recon_loss: 1314021.3438; val_cat_covariates_contrastive_loss: 634341.4590; val_gene_expr_recon_loss: 2474970.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4438379.5156; val_optim_loss: 4438379.5156
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9806; val_auprc_score: 0.9923; val_best_acc_score: 0.9587; val_best_f1_score: 0.9732; train_kl_reg_loss: 15441.9358; train_edge_recon_loss: 1306990.6325; train_cat_covariates_contrastive_loss: 634239.7676; train_gene_expr_recon_loss: 2460868.7069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4417541.0458; train_optim_loss: 4417541.0458; val_kl_reg_loss: 15082.2462; val_edge_recon_loss: 1314978.4180; val_cat_covariates_contrastive_loss: 634473.2852; val_gene_expr_recon_loss: 2472087.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4436621.2500; val_optim_loss: 4436621.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9804; val_auprc_score: 0.9921; val_best_acc_score: 0.9604; val_best_f1_score: 0.9743; train_kl_reg_loss: 15457.7663; train_edge_recon_loss: 1304239.4952; train_cat_covariates_contrastive_loss: 634149.4155; train_gene_expr_recon_loss: 2457370.2033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4411216.8803; train_optim_loss: 4411216.8803; val_kl_reg_loss: 15043.2332; val_edge_recon_loss: 1311284.7852; val_cat_covariates_contrastive_loss: 634319.4141; val_gene_expr_recon_loss: 2473753.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4434400.5938; val_optim_loss: 4434400.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9808; val_auprc_score: 0.9923; val_best_acc_score: 0.9602; val_best_f1_score: 0.9742; train_kl_reg_loss: 15294.3395; train_edge_recon_loss: 1305492.1567; train_cat_covariates_contrastive_loss: 634232.7700; train_gene_expr_recon_loss: 2449715.6320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4404734.8750; train_optim_loss: 4404734.8750; val_kl_reg_loss: 15246.0793; val_edge_recon_loss: 1316528.1953; val_cat_covariates_contrastive_loss: 634038.6602; val_gene_expr_recon_loss: 2462159.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427972.0469; val_optim_loss: 4427972.0469
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9812; val_auprc_score: 0.9925; val_best_acc_score: 0.9603; val_best_f1_score: 0.9742; train_kl_reg_loss: 15379.8399; train_edge_recon_loss: 1303697.1703; train_cat_covariates_contrastive_loss: 634225.0185; train_gene_expr_recon_loss: 2448949.1989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4402251.2271; train_optim_loss: 4402251.2271; val_kl_reg_loss: 15209.0516; val_edge_recon_loss: 1311435.1602; val_cat_covariates_contrastive_loss: 634334.7383; val_gene_expr_recon_loss: 2465723.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4426702.7344; val_optim_loss: 4426702.7344
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9804; val_auprc_score: 0.9922; val_best_acc_score: 0.9600; val_best_f1_score: 0.9740; train_kl_reg_loss: 15368.1532; train_edge_recon_loss: 1304923.9327; train_cat_covariates_contrastive_loss: 634273.6952; train_gene_expr_recon_loss: 2448358.3283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4402924.1039; train_optim_loss: 4402924.1039; val_kl_reg_loss: 15178.5055; val_edge_recon_loss: 1314828.4258; val_cat_covariates_contrastive_loss: 634184.6953; val_gene_expr_recon_loss: 2466373.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4430564.6250; val_optim_loss: 4430564.6250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9800; val_auprc_score: 0.9920; val_best_acc_score: 0.9598; val_best_f1_score: 0.9740; train_kl_reg_loss: 15302.9666; train_edge_recon_loss: 1301513.8389; train_cat_covariates_contrastive_loss: 634223.7599; train_gene_expr_recon_loss: 2447632.3345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4398672.8785; train_optim_loss: 4398672.8785; val_kl_reg_loss: 15236.7763; val_edge_recon_loss: 1316467.9141; val_cat_covariates_contrastive_loss: 633920.0234; val_gene_expr_recon_loss: 2462626.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4428251.2812; val_optim_loss: 4428251.2812
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9816; val_auprc_score: 0.9927; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 15363.8835; train_edge_recon_loss: 1302707.0119; train_cat_covariates_contrastive_loss: 634154.3710; train_gene_expr_recon_loss: 2446878.3592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399103.6180; train_optim_loss: 4399103.6180; val_kl_reg_loss: 15185.3356; val_edge_recon_loss: 1311712.1992; val_cat_covariates_contrastive_loss: 634177.8184; val_gene_expr_recon_loss: 2463077.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4424153.0312; val_optim_loss: 4424153.0312
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9815; val_auprc_score: 0.9927; val_best_acc_score: 0.9606; val_best_f1_score: 0.9744; train_kl_reg_loss: 15337.6145; train_edge_recon_loss: 1305793.2658; train_cat_covariates_contrastive_loss: 634197.8442; train_gene_expr_recon_loss: 2446889.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4402218.4824; train_optim_loss: 4402218.4824; val_kl_reg_loss: 15013.6963; val_edge_recon_loss: 1312854.7266; val_cat_covariates_contrastive_loss: 634365.5703; val_gene_expr_recon_loss: 2462932.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4425166.7031; val_optim_loss: 4425166.7031
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9812; val_auprc_score: 0.9925; val_best_acc_score: 0.9606; val_best_f1_score: 0.9744; train_kl_reg_loss: 15328.9232; train_edge_recon_loss: 1302341.4987; train_cat_covariates_contrastive_loss: 634233.4021; train_gene_expr_recon_loss: 2447344.0246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399247.8768; train_optim_loss: 4399247.8768; val_kl_reg_loss: 15135.2294; val_edge_recon_loss: 1316310.6445; val_cat_covariates_contrastive_loss: 634433.1074; val_gene_expr_recon_loss: 2460260.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4426139.9375; val_optim_loss: 4426139.9375
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9802; val_auprc_score: 0.9920; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 15318.5735; train_edge_recon_loss: 1305711.7676; train_cat_covariates_contrastive_loss: 634276.5858; train_gene_expr_recon_loss: 2446199.8283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4401506.7606; train_optim_loss: 4401506.7606; val_kl_reg_loss: 15267.5401; val_edge_recon_loss: 1311242.9922; val_cat_covariates_contrastive_loss: 633667.0664; val_gene_expr_recon_loss: 2460434.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4420611.8438; val_optim_loss: 4420611.8438
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9806; val_auprc_score: 0.9921; val_best_acc_score: 0.9604; val_best_f1_score: 0.9743; train_kl_reg_loss: 15342.4484; train_edge_recon_loss: 1303698.7777; train_cat_covariates_contrastive_loss: 634177.1345; train_gene_expr_recon_loss: 2446263.8019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399482.1637; train_optim_loss: 4399482.1637; val_kl_reg_loss: 15185.6369; val_edge_recon_loss: 1318958.7070; val_cat_covariates_contrastive_loss: 634002.2305; val_gene_expr_recon_loss: 2459138.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4427285.0156; val_optim_loss: 4427285.0156
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9796; val_auprc_score: 0.9918; val_best_acc_score: 0.9595; val_best_f1_score: 0.9737; train_kl_reg_loss: 15322.8284; train_edge_recon_loss: 1303626.9551; train_cat_covariates_contrastive_loss: 634008.2403; train_gene_expr_recon_loss: 2446353.5141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399311.5387; train_optim_loss: 4399311.5387; val_kl_reg_loss: 15075.5981; val_edge_recon_loss: 1315935.1133; val_cat_covariates_contrastive_loss: 633942.6426; val_gene_expr_recon_loss: 2460651.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4425605.2031; val_optim_loss: 4425605.2031
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9811; val_auprc_score: 0.9925; val_best_acc_score: 0.9608; val_best_f1_score: 0.9746; train_kl_reg_loss: 15269.9858; train_edge_recon_loss: 1303714.2601; train_cat_covariates_contrastive_loss: 634119.2025; train_gene_expr_recon_loss: 2445974.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399077.5405; train_optim_loss: 4399077.5405; val_kl_reg_loss: 15083.1242; val_edge_recon_loss: 1312086.1641; val_cat_covariates_contrastive_loss: 634187.5762; val_gene_expr_recon_loss: 2460672.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4422029.2344; val_optim_loss: 4422029.2344
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9803; val_auprc_score: 0.9922; val_best_acc_score: 0.9607; val_best_f1_score: 0.9746; train_kl_reg_loss: 15241.6461; train_edge_recon_loss: 1304192.7121; train_cat_covariates_contrastive_loss: 634153.8757; train_gene_expr_recon_loss: 2444856.4164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4398444.6514; train_optim_loss: 4398444.6514; val_kl_reg_loss: 15070.7978; val_edge_recon_loss: 1302309.1602; val_cat_covariates_contrastive_loss: 634140.4375; val_gene_expr_recon_loss: 2460686.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4412206.9531; val_optim_loss: 4412206.9531
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9812; val_auprc_score: 0.9925; val_best_acc_score: 0.9604; val_best_f1_score: 0.9744; train_kl_reg_loss: 15265.4878; train_edge_recon_loss: 1306035.9996; train_cat_covariates_contrastive_loss: 634005.8873; train_gene_expr_recon_loss: 2445021.4208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4400328.7835; train_optim_loss: 4400328.7835; val_kl_reg_loss: 14974.1775; val_edge_recon_loss: 1308661.2930; val_cat_covariates_contrastive_loss: 634308.8223; val_gene_expr_recon_loss: 2460866.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4418811.2500; val_optim_loss: 4418811.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9806; val_auprc_score: 0.9921; val_best_acc_score: 0.9604; val_best_f1_score: 0.9743; train_kl_reg_loss: 15309.1130; train_edge_recon_loss: 1304053.8873; train_cat_covariates_contrastive_loss: 634058.4676; train_gene_expr_recon_loss: 2445898.7667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4399320.2412; train_optim_loss: 4399320.2412; val_kl_reg_loss: 15052.5298; val_edge_recon_loss: 1315151.6992; val_cat_covariates_contrastive_loss: 633947.0977; val_gene_expr_recon_loss: 2460769.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4424920.9062; val_optim_loss: 4424920.9062
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9809; val_auprc_score: 0.9924; val_best_acc_score: 0.9601; val_best_f1_score: 0.9741; train_kl_reg_loss: 15295.4813; train_edge_recon_loss: 1302457.8323; train_cat_covariates_contrastive_loss: 634096.1373; train_gene_expr_recon_loss: 2444361.8952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4396211.3627; train_optim_loss: 4396211.3627; val_kl_reg_loss: 15115.2388; val_edge_recon_loss: 1320981.3828; val_cat_covariates_contrastive_loss: 633805.9512; val_gene_expr_recon_loss: 2458797.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4428699.8594; val_optim_loss: 4428699.8594
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9812; val_auprc_score: 0.9925; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 15264.2945; train_edge_recon_loss: 1304685.9767; train_cat_covariates_contrastive_loss: 634006.7779; train_gene_expr_recon_loss: 2445001.8785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4398958.9278; train_optim_loss: 4398958.9278; val_kl_reg_loss: 15028.1607; val_edge_recon_loss: 1311199.5898; val_cat_covariates_contrastive_loss: 634103.5566; val_gene_expr_recon_loss: 2463871.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4424202.2969; val_optim_loss: 4424202.2969

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9811; val_auprc_score: 0.9925; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 15225.7276; train_edge_recon_loss: 1304690.3842; train_cat_covariates_contrastive_loss: 633993.7586; train_gene_expr_recon_loss: 2442649.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4396559.0986; train_optim_loss: 4396559.0986; val_kl_reg_loss: 15012.1592; val_edge_recon_loss: 1314809.7109; val_cat_covariates_contrastive_loss: 633902.7637; val_gene_expr_recon_loss: 2458543.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4422268.5312; val_optim_loss: 4422268.5312
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9809; val_auprc_score: 0.9924; val_best_acc_score: 0.9603; val_best_f1_score: 0.9743; train_kl_reg_loss: 15216.1237; train_edge_recon_loss: 1302274.7901; train_cat_covariates_contrastive_loss: 634054.9776; train_gene_expr_recon_loss: 2442032.2553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4393578.1479; train_optim_loss: 4393578.1479; val_kl_reg_loss: 14999.5108; val_edge_recon_loss: 1315158.4414; val_cat_covariates_contrastive_loss: 634081.5762; val_gene_expr_recon_loss: 2459534.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4423774.1406; val_optim_loss: 4423774.1406
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9808; val_auprc_score: 0.9922; val_best_acc_score: 0.9612; val_best_f1_score: 0.9748; train_kl_reg_loss: 15209.2353; train_edge_recon_loss: 1303544.7236; train_cat_covariates_contrastive_loss: 634100.1158; train_gene_expr_recon_loss: 2442691.5511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4395545.6320; train_optim_loss: 4395545.6320; val_kl_reg_loss: 15020.3826; val_edge_recon_loss: 1312075.7031; val_cat_covariates_contrastive_loss: 634118.0098; val_gene_expr_recon_loss: 2460518.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4421732.6562; val_optim_loss: 4421732.6562
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9802; val_auprc_score: 0.9919; val_best_acc_score: 0.9606; val_best_f1_score: 0.9744; train_kl_reg_loss: 15234.3674; train_edge_recon_loss: 1306436.9798; train_cat_covariates_contrastive_loss: 634138.6160; train_gene_expr_recon_loss: 2441918.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4397728.1989; train_optim_loss: 4397728.1989; val_kl_reg_loss: 15035.4713; val_edge_recon_loss: 1314056.7500; val_cat_covariates_contrastive_loss: 633847.2598; val_gene_expr_recon_loss: 2456916.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4419856.0938; val_optim_loss: 4419856.0938

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 370 min 48 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9428
val AUPRC score: 0.9692
val best accuracy score: 0.9473
val best F1 score: 0.9655
val target rna MSE score: 1.0629
val source rna MSE score: 0.1348
Val cat covariate0 mean sim diff: -0.0002
Val cat covariate1 mean sim diff: -0.1034
Duration of model training in run 3: 6 hours, 12 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
