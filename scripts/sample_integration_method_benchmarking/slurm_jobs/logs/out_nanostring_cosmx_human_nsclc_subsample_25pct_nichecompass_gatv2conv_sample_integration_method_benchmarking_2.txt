Run timestamp: 04092023_094021_2.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '--edge_batch_size_list', '256', '256', '--node_batch_size_list', 'None', 'None', '--seeds', '1', '0', '--run_index', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_25pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 150986
Number of validation edges: 16776
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9179; val_auprc_score: 0.9670; val_best_acc_score: 0.8943; val_best_f1_score: 0.9334; train_kl_reg_loss: 15921.1065; train_edge_recon_loss: 1454897.9314; train_cat_covariates_contrastive_loss: 638366.9448; train_gene_expr_recon_loss: 3181157.0182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5290343.0051; train_optim_loss: 5290343.0051; val_kl_reg_loss: 12920.4370; val_edge_recon_loss: 1391156.9110; val_cat_covariates_contrastive_loss: 631067.1780; val_gene_expr_recon_loss: 2966006.2689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5001150.7955; val_optim_loss: 5001150.7955
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9350; val_auprc_score: 0.9731; val_best_acc_score: 0.9061; val_best_f1_score: 0.9403; train_kl_reg_loss: 11697.7178; train_edge_recon_loss: 1349866.5258; train_cat_covariates_contrastive_loss: 633202.5539; train_gene_expr_recon_loss: 2906176.1174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4900942.9093; train_optim_loss: 4900942.9093; val_kl_reg_loss: 11329.7669; val_edge_recon_loss: 1370061.4564; val_cat_covariates_contrastive_loss: 634270.3125; val_gene_expr_recon_loss: 2852905.3788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4868566.9318; val_optim_loss: 4868566.9318
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9455; val_auprc_score: 0.9767; val_best_acc_score: 0.9213; val_best_f1_score: 0.9496; train_kl_reg_loss: 11675.7234; train_edge_recon_loss: 1336450.5387; train_cat_covariates_contrastive_loss: 634701.4706; train_gene_expr_recon_loss: 2806368.8195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4789196.5424; train_optim_loss: 4789196.5424; val_kl_reg_loss: 12191.3292; val_edge_recon_loss: 1376301.0492; val_cat_covariates_contrastive_loss: 633205.1383; val_gene_expr_recon_loss: 2760265.6818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4781963.1818; val_optim_loss: 4781963.1818
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9444; val_auprc_score: 0.9763; val_best_acc_score: 0.9195; val_best_f1_score: 0.9487; train_kl_reg_loss: 13152.8848; train_edge_recon_loss: 1331497.4968; train_cat_covariates_contrastive_loss: 635229.7605; train_gene_expr_recon_loss: 2707266.9720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4687147.1068; train_optim_loss: 4687147.1068; val_kl_reg_loss: 13958.4455; val_edge_recon_loss: 1367668.9697; val_cat_covariates_contrastive_loss: 637534.9583; val_gene_expr_recon_loss: 2649581.2992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4668743.6818; val_optim_loss: 4668743.6818
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9458; val_auprc_score: 0.9756; val_best_acc_score: 0.9250; val_best_f1_score: 0.9518; train_kl_reg_loss: 15372.8288; train_edge_recon_loss: 1328395.4542; train_cat_covariates_contrastive_loss: 636623.6878; train_gene_expr_recon_loss: 2573068.1987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4553460.1708; train_optim_loss: 4553460.1708; val_kl_reg_loss: 17636.2261; val_edge_recon_loss: 1353668.4621; val_cat_covariates_contrastive_loss: 636564.0341; val_gene_expr_recon_loss: 2514065.1970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4521933.9167; val_optim_loss: 4521933.9167
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9529; val_auprc_score: 0.9789; val_best_acc_score: 0.9325; val_best_f1_score: 0.9567; train_kl_reg_loss: 17406.3702; train_edge_recon_loss: 1329202.3161; train_cat_covariates_contrastive_loss: 637449.3034; train_gene_expr_recon_loss: 2451505.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4435563.1314; train_optim_loss: 4435563.1314; val_kl_reg_loss: 17620.8132; val_edge_recon_loss: 1347882.8845; val_cat_covariates_contrastive_loss: 638905.4242; val_gene_expr_recon_loss: 2409298.6970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4413707.7803; val_optim_loss: 4413707.7803
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9452; val_auprc_score: 0.9755; val_best_acc_score: 0.9277; val_best_f1_score: 0.9538; train_kl_reg_loss: 19016.4931; train_edge_recon_loss: 1329751.7604; train_cat_covariates_contrastive_loss: 636912.6804; train_gene_expr_recon_loss: 2366255.6462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4351936.5771; train_optim_loss: 4351936.5771; val_kl_reg_loss: 20243.1120; val_edge_recon_loss: 1345922.4110; val_cat_covariates_contrastive_loss: 636498.5246; val_gene_expr_recon_loss: 2338705.3258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4341369.3902; val_optim_loss: 4341369.3902
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9479; val_auprc_score: 0.9769; val_best_acc_score: 0.9266; val_best_f1_score: 0.9526; train_kl_reg_loss: 20062.5418; train_edge_recon_loss: 1323219.7690; train_cat_covariates_contrastive_loss: 637762.5713; train_gene_expr_recon_loss: 2303110.0867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4284154.9758; train_optim_loss: 4284154.9758; val_kl_reg_loss: 20755.3622; val_edge_recon_loss: 1356754.1894; val_cat_covariates_contrastive_loss: 636746.4081; val_gene_expr_recon_loss: 2293066.4394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4307322.3977; val_optim_loss: 4307322.3977
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9543; val_auprc_score: 0.9794; val_best_acc_score: 0.9324; val_best_f1_score: 0.9563; train_kl_reg_loss: 21124.8835; train_edge_recon_loss: 1331000.0989; train_cat_covariates_contrastive_loss: 637919.4997; train_gene_expr_recon_loss: 2254208.2002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4244252.6873; train_optim_loss: 4244252.6873; val_kl_reg_loss: 21795.8631; val_edge_recon_loss: 1361248.9659; val_cat_covariates_contrastive_loss: 638942.5578; val_gene_expr_recon_loss: 2253228.9148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4275216.3106; val_optim_loss: 4275216.3106
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9494; val_auprc_score: 0.9759; val_best_acc_score: 0.9307; val_best_f1_score: 0.9553; train_kl_reg_loss: 21689.4536; train_edge_recon_loss: 1321790.3910; train_cat_covariates_contrastive_loss: 637562.2993; train_gene_expr_recon_loss: 2216580.5064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4197622.6525; train_optim_loss: 4197622.6525; val_kl_reg_loss: 22490.7472; val_edge_recon_loss: 1357767.5852; val_cat_covariates_contrastive_loss: 637900.7121; val_gene_expr_recon_loss: 2221270.9489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4239430.0152; val_optim_loss: 4239430.0152
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9492; val_auprc_score: 0.9758; val_best_acc_score: 0.9327; val_best_f1_score: 0.9569; train_kl_reg_loss: 22227.0301; train_edge_recon_loss: 1324206.3052; train_cat_covariates_contrastive_loss: 637857.0782; train_gene_expr_recon_loss: 2183113.3593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4167403.7695; train_optim_loss: 4167403.7695; val_kl_reg_loss: 23942.7404; val_edge_recon_loss: 1373827.7652; val_cat_covariates_contrastive_loss: 635582.4470; val_gene_expr_recon_loss: 2194196.3788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4227549.3106; val_optim_loss: 4227549.3106
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9486; val_auprc_score: 0.9759; val_best_acc_score: 0.9323; val_best_f1_score: 0.9566; train_kl_reg_loss: 22626.5808; train_edge_recon_loss: 1323179.5022; train_cat_covariates_contrastive_loss: 637946.6699; train_gene_expr_recon_loss: 2167263.9803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4151016.7343; train_optim_loss: 4151016.7343; val_kl_reg_loss: 22606.6392; val_edge_recon_loss: 1336264.1042; val_cat_covariates_contrastive_loss: 638831.8920; val_gene_expr_recon_loss: 2194816.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4192519.2917; val_optim_loss: 4192519.2917
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9524; val_auprc_score: 0.9779; val_best_acc_score: 0.9354; val_best_f1_score: 0.9583; train_kl_reg_loss: 23226.8271; train_edge_recon_loss: 1327625.9158; train_cat_covariates_contrastive_loss: 637752.2654; train_gene_expr_recon_loss: 2148956.9229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4137561.9271; train_optim_loss: 4137561.9271; val_kl_reg_loss: 23699.0412; val_edge_recon_loss: 1349119.7519; val_cat_covariates_contrastive_loss: 636369.5928; val_gene_expr_recon_loss: 2171843.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4181031.9924; val_optim_loss: 4181031.9924
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9530; val_auprc_score: 0.9788; val_best_acc_score: 0.9335; val_best_f1_score: 0.9570; train_kl_reg_loss: 23532.6221; train_edge_recon_loss: 1323090.6621; train_cat_covariates_contrastive_loss: 637919.6758; train_gene_expr_recon_loss: 2126025.5881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4110568.5555; train_optim_loss: 4110568.5555; val_kl_reg_loss: 23612.2670; val_edge_recon_loss: 1344881.6383; val_cat_covariates_contrastive_loss: 638153.4290; val_gene_expr_recon_loss: 2156022.7576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4162670.1326; val_optim_loss: 4162670.1326
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9479; val_auprc_score: 0.9758; val_best_acc_score: 0.9344; val_best_f1_score: 0.9580; train_kl_reg_loss: 23675.4801; train_edge_recon_loss: 1326850.7943; train_cat_covariates_contrastive_loss: 638128.9198; train_gene_expr_recon_loss: 2115751.7782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4104406.9758; train_optim_loss: 4104406.9758; val_kl_reg_loss: 23794.6448; val_edge_recon_loss: 1314722.8902; val_cat_covariates_contrastive_loss: 637394.8494; val_gene_expr_recon_loss: 2150831.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4126743.5644; val_optim_loss: 4126743.5644
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9510; val_auprc_score: 0.9773; val_best_acc_score: 0.9317; val_best_f1_score: 0.9559; train_kl_reg_loss: 23937.3245; train_edge_recon_loss: 1324791.7637; train_cat_covariates_contrastive_loss: 637937.1528; train_gene_expr_recon_loss: 2106510.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4093176.3267; train_optim_loss: 4093176.3267; val_kl_reg_loss: 23763.6525; val_edge_recon_loss: 1363389.7803; val_cat_covariates_contrastive_loss: 639068.2557; val_gene_expr_recon_loss: 2149077.4432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4175299.1402; val_optim_loss: 4175299.1402
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9504; val_auprc_score: 0.9774; val_best_acc_score: 0.9323; val_best_f1_score: 0.9565; train_kl_reg_loss: 24089.5815; train_edge_recon_loss: 1325814.8964; train_cat_covariates_contrastive_loss: 638117.4746; train_gene_expr_recon_loss: 2091731.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4079753.1047; train_optim_loss: 4079753.1047; val_kl_reg_loss: 23957.9996; val_edge_recon_loss: 1350277.1439; val_cat_covariates_contrastive_loss: 638811.7888; val_gene_expr_recon_loss: 2137327.4527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4150374.3902; val_optim_loss: 4150374.3902
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9539; val_auprc_score: 0.9790; val_best_acc_score: 0.9361; val_best_f1_score: 0.9590; train_kl_reg_loss: 24361.3091; train_edge_recon_loss: 1318950.5924; train_cat_covariates_contrastive_loss: 638612.4014; train_gene_expr_recon_loss: 2089940.0485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4071864.3508; train_optim_loss: 4071864.3508; val_kl_reg_loss: 25011.2667; val_edge_recon_loss: 1348707.2803; val_cat_covariates_contrastive_loss: 637072.3892; val_gene_expr_recon_loss: 2129461.2008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4140252.1250; val_optim_loss: 4140252.1250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9539; val_auprc_score: 0.9786; val_best_acc_score: 0.9372; val_best_f1_score: 0.9595; train_kl_reg_loss: 24461.9149; train_edge_recon_loss: 1327487.5854; train_cat_covariates_contrastive_loss: 637579.0210; train_gene_expr_recon_loss: 2077342.0811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4066870.6004; train_optim_loss: 4066870.6004; val_kl_reg_loss: 24128.2763; val_edge_recon_loss: 1369392.3977; val_cat_covariates_contrastive_loss: 637881.3438; val_gene_expr_recon_loss: 2124817.2538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4156219.2614; val_optim_loss: 4156219.2614

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9531; val_auprc_score: 0.9771; val_best_acc_score: 0.9370; val_best_f1_score: 0.9594; train_kl_reg_loss: 24245.0841; train_edge_recon_loss: 1317395.3624; train_cat_covariates_contrastive_loss: 638064.7610; train_gene_expr_recon_loss: 2041910.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4021615.6415; train_optim_loss: 4021615.6415; val_kl_reg_loss: 24362.7020; val_edge_recon_loss: 1354403.8134; val_cat_covariates_contrastive_loss: 637213.9375; val_gene_expr_recon_loss: 2098462.9034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4114443.3371; val_optim_loss: 4114443.3371
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9526; val_auprc_score: 0.9781; val_best_acc_score: 0.9362; val_best_f1_score: 0.9592; train_kl_reg_loss: 24473.7384; train_edge_recon_loss: 1326180.8739; train_cat_covariates_contrastive_loss: 638062.7755; train_gene_expr_recon_loss: 2035330.7521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4024048.1411; train_optim_loss: 4024048.1411; val_kl_reg_loss: 24450.1391; val_edge_recon_loss: 1338991.7917; val_cat_covariates_contrastive_loss: 635847.3002; val_gene_expr_recon_loss: 2090909.4148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4090198.6326; val_optim_loss: 4090198.6326
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9548; val_auprc_score: 0.9790; val_best_acc_score: 0.9396; val_best_f1_score: 0.9611; train_kl_reg_loss: 24314.7573; train_edge_recon_loss: 1319797.7632; train_cat_covariates_contrastive_loss: 638152.8391; train_gene_expr_recon_loss: 2031623.0394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4013888.3996; train_optim_loss: 4013888.3996; val_kl_reg_loss: 24449.5218; val_edge_recon_loss: 1342690.9261; val_cat_covariates_contrastive_loss: 636800.0426; val_gene_expr_recon_loss: 2097687.0379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4101627.5265; val_optim_loss: 4101627.5265
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9543; val_auprc_score: 0.9786; val_best_acc_score: 0.9395; val_best_f1_score: 0.9611; train_kl_reg_loss: 24384.3448; train_edge_recon_loss: 1316530.9677; train_cat_covariates_contrastive_loss: 638150.3743; train_gene_expr_recon_loss: 2029915.9178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4008981.6008; train_optim_loss: 4008981.6008; val_kl_reg_loss: 24319.3125; val_edge_recon_loss: 1347278.1875; val_cat_covariates_contrastive_loss: 637547.4545; val_gene_expr_recon_loss: 2103425.2235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4112570.2008; val_optim_loss: 4112570.2008
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9532; val_auprc_score: 0.9791; val_best_acc_score: 0.9388; val_best_f1_score: 0.9610; train_kl_reg_loss: 24305.1525; train_edge_recon_loss: 1330949.0427; train_cat_covariates_contrastive_loss: 637801.3650; train_gene_expr_recon_loss: 2030386.9155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4023442.4839; train_optim_loss: 4023442.4839; val_kl_reg_loss: 24174.6364; val_edge_recon_loss: 1309078.9697; val_cat_covariates_contrastive_loss: 636922.3807; val_gene_expr_recon_loss: 2094095.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4064271.1818; val_optim_loss: 4064271.1818
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9511; val_auprc_score: 0.9768; val_best_acc_score: 0.9372; val_best_f1_score: 0.9596; train_kl_reg_loss: 24264.7157; train_edge_recon_loss: 1317328.5778; train_cat_covariates_contrastive_loss: 638138.7836; train_gene_expr_recon_loss: 2026538.2462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006270.3250; train_optim_loss: 4006270.3250; val_kl_reg_loss: 24365.9015; val_edge_recon_loss: 1340796.7159; val_cat_covariates_contrastive_loss: 637860.6080; val_gene_expr_recon_loss: 2085425.6155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088448.8409; val_optim_loss: 4088448.8409
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9503; val_auprc_score: 0.9758; val_best_acc_score: 0.9374; val_best_f1_score: 0.9596; train_kl_reg_loss: 24168.2749; train_edge_recon_loss: 1320049.7484; train_cat_covariates_contrastive_loss: 637904.9916; train_gene_expr_recon_loss: 2025862.7790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4007985.7996; train_optim_loss: 4007985.7996; val_kl_reg_loss: 24984.2357; val_edge_recon_loss: 1345101.4545; val_cat_covariates_contrastive_loss: 636984.5152; val_gene_expr_recon_loss: 2095649.3636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4102719.5455; val_optim_loss: 4102719.5455
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9559; val_auprc_score: 0.9792; val_best_acc_score: 0.9392; val_best_f1_score: 0.9609; train_kl_reg_loss: 24328.1332; train_edge_recon_loss: 1319307.9925; train_cat_covariates_contrastive_loss: 637757.0464; train_gene_expr_recon_loss: 2025205.0907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006598.2653; train_optim_loss: 4006598.2653; val_kl_reg_loss: 24046.2031; val_edge_recon_loss: 1338252.4091; val_cat_covariates_contrastive_loss: 640001.3816; val_gene_expr_recon_loss: 2090937.1117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093237.0947; val_optim_loss: 4093237.0947
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9555; val_auprc_score: 0.9789; val_best_acc_score: 0.9391; val_best_f1_score: 0.9607; train_kl_reg_loss: 24086.8224; train_edge_recon_loss: 1325931.1875; train_cat_covariates_contrastive_loss: 637734.5308; train_gene_expr_recon_loss: 2023270.9856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4011023.5148; train_optim_loss: 4011023.5148; val_kl_reg_loss: 24389.6278; val_edge_recon_loss: 1343376.1894; val_cat_covariates_contrastive_loss: 637225.0521; val_gene_expr_recon_loss: 2090228.8277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4095219.6894; val_optim_loss: 4095219.6894

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9511; val_auprc_score: 0.9769; val_best_acc_score: 0.9384; val_best_f1_score: 0.9606; train_kl_reg_loss: 24363.0482; train_edge_recon_loss: 1315389.6183; train_cat_covariates_contrastive_loss: 637886.7619; train_gene_expr_recon_loss: 2017185.6638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3994825.0877; train_optim_loss: 3994825.0877; val_kl_reg_loss: 24282.4042; val_edge_recon_loss: 1340280.7481; val_cat_covariates_contrastive_loss: 638084.2860; val_gene_expr_recon_loss: 2085976.9754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4088624.3902; val_optim_loss: 4088624.3902
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9570; val_auprc_score: 0.9797; val_best_acc_score: 0.9372; val_best_f1_score: 0.9597; train_kl_reg_loss: 24167.4961; train_edge_recon_loss: 1313077.4233; train_cat_covariates_contrastive_loss: 637336.6540; train_gene_expr_recon_loss: 2019668.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3994249.9008; train_optim_loss: 3994249.9008; val_kl_reg_loss: 24195.9203; val_edge_recon_loss: 1340002.2822; val_cat_covariates_contrastive_loss: 638810.6212; val_gene_expr_recon_loss: 2084200.7197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087209.5530; val_optim_loss: 4087209.5530
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9535; val_auprc_score: 0.9782; val_best_acc_score: 0.9394; val_best_f1_score: 0.9610; train_kl_reg_loss: 24168.5882; train_edge_recon_loss: 1327189.2140; train_cat_covariates_contrastive_loss: 637559.8975; train_gene_expr_recon_loss: 2017146.2896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4006064.0021; train_optim_loss: 4006064.0021; val_kl_reg_loss: 24229.0730; val_edge_recon_loss: 1331433.3996; val_cat_covariates_contrastive_loss: 637745.2945; val_gene_expr_recon_loss: 2092913.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086321.0417; val_optim_loss: 4086321.0417
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9551; val_auprc_score: 0.9798; val_best_acc_score: 0.9414; val_best_f1_score: 0.9625; train_kl_reg_loss: 24153.7644; train_edge_recon_loss: 1312790.5744; train_cat_covariates_contrastive_loss: 637575.3504; train_gene_expr_recon_loss: 2017583.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3992103.3691; train_optim_loss: 3992103.3691; val_kl_reg_loss: 24169.5836; val_edge_recon_loss: 1308609.2955; val_cat_covariates_contrastive_loss: 637550.1165; val_gene_expr_recon_loss: 2091406.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4061735.5492; val_optim_loss: 4061735.5492
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9534; val_auprc_score: 0.9779; val_best_acc_score: 0.9387; val_best_f1_score: 0.9604; train_kl_reg_loss: 24143.3156; train_edge_recon_loss: 1323402.9268; train_cat_covariates_contrastive_loss: 638157.1985; train_gene_expr_recon_loss: 2017387.6104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4003091.0470; train_optim_loss: 4003091.0470; val_kl_reg_loss: 24074.3519; val_edge_recon_loss: 1346313.8295; val_cat_covariates_contrastive_loss: 637853.3598; val_gene_expr_recon_loss: 2085635.0057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093876.5455; val_optim_loss: 4093876.5455
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9556; val_auprc_score: 0.9790; val_best_acc_score: 0.9388; val_best_f1_score: 0.9607; train_kl_reg_loss: 24095.2312; train_edge_recon_loss: 1319718.8191; train_cat_covariates_contrastive_loss: 637659.2918; train_gene_expr_recon_loss: 2017287.2040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3998760.5500; train_optim_loss: 3998760.5500; val_kl_reg_loss: 24297.1425; val_edge_recon_loss: 1353680.3466; val_cat_covariates_contrastive_loss: 638328.1316; val_gene_expr_recon_loss: 2095295.8826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4111601.5076; val_optim_loss: 4111601.5076
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9555; val_auprc_score: 0.9796; val_best_acc_score: 0.9382; val_best_f1_score: 0.9603; train_kl_reg_loss: 24098.5912; train_edge_recon_loss: 1318351.6328; train_cat_covariates_contrastive_loss: 637667.8569; train_gene_expr_recon_loss: 2017452.6267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3997570.7038; train_optim_loss: 3997570.7038; val_kl_reg_loss: 24142.5188; val_edge_recon_loss: 1346683.3788; val_cat_covariates_contrastive_loss: 637381.6117; val_gene_expr_recon_loss: 2086276.8845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4094484.3826; val_optim_loss: 4094484.3826
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9558; val_auprc_score: 0.9795; val_best_acc_score: 0.9407; val_best_f1_score: 0.9619; train_kl_reg_loss: 24132.0371; train_edge_recon_loss: 1315424.3252; train_cat_covariates_contrastive_loss: 637911.8879; train_gene_expr_recon_loss: 2016551.0051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3994019.2542; train_optim_loss: 3994019.2542; val_kl_reg_loss: 24218.4167; val_edge_recon_loss: 1334050.3144; val_cat_covariates_contrastive_loss: 636377.6695; val_gene_expr_recon_loss: 2080564.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4075210.9545; val_optim_loss: 4075210.9545

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9568; val_auprc_score: 0.9790; val_best_acc_score: 0.9398; val_best_f1_score: 0.9612; train_kl_reg_loss: 24202.8738; train_edge_recon_loss: 1313316.3559; train_cat_covariates_contrastive_loss: 637312.5210; train_gene_expr_recon_loss: 2018659.8540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3993491.6000; train_optim_loss: 3993491.6000; val_kl_reg_loss: 24254.1719; val_edge_recon_loss: 1352356.9299; val_cat_covariates_contrastive_loss: 636809.3125; val_gene_expr_recon_loss: 2089245.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4102666.2083; val_optim_loss: 4102666.2083
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9548; val_auprc_score: 0.9790; val_best_acc_score: 0.9384; val_best_f1_score: 0.9604; train_kl_reg_loss: 24144.6912; train_edge_recon_loss: 1320982.0428; train_cat_covariates_contrastive_loss: 637556.1803; train_gene_expr_recon_loss: 2015940.8845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3998623.7953; train_optim_loss: 3998623.7953; val_kl_reg_loss: 24184.2311; val_edge_recon_loss: 1345190.7822; val_cat_covariates_contrastive_loss: 636417.3362; val_gene_expr_recon_loss: 2087734.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4093527.3295; val_optim_loss: 4093527.3295
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9548; val_auprc_score: 0.9789; val_best_acc_score: 0.9403; val_best_f1_score: 0.9616; train_kl_reg_loss: 24111.8735; train_edge_recon_loss: 1326170.5686; train_cat_covariates_contrastive_loss: 637623.6649; train_gene_expr_recon_loss: 2014358.8911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4002264.9949; train_optim_loss: 4002264.9949; val_kl_reg_loss: 24171.5255; val_edge_recon_loss: 1333108.2737; val_cat_covariates_contrastive_loss: 637368.5578; val_gene_expr_recon_loss: 2087593.1970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4082241.5530; val_optim_loss: 4082241.5530
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9547; val_auprc_score: 0.9782; val_best_acc_score: 0.9388; val_best_f1_score: 0.9608; train_kl_reg_loss: 24143.4431; train_edge_recon_loss: 1320148.4369; train_cat_covariates_contrastive_loss: 637710.8338; train_gene_expr_recon_loss: 2015620.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3997622.8746; train_optim_loss: 3997622.8746; val_kl_reg_loss: 24179.9243; val_edge_recon_loss: 1337878.8920; val_cat_covariates_contrastive_loss: 637456.2405; val_gene_expr_recon_loss: 2083733.6629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4083248.7159; val_optim_loss: 4083248.7159

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 109 min 20 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9134
val AUPRC score: 0.9491
val best accuracy score: 0.9242
val best F1 score: 0.9512
val target rna MSE score: 1.2014
val source rna MSE score: 0.1245
Val cat covariate0 mean sim diff: -0.0046
Val cat covariate1 mean sim diff: -0.0653
Duration of model training in run 2: 1 hours, 50 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 63535
Number of validation nodes: 7059
Number of training edges: 150986
Number of validation edges: 16776
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9072; val_auprc_score: 0.9632; val_best_acc_score: 0.8847; val_best_f1_score: 0.9272; train_kl_reg_loss: 15082.6164; train_edge_recon_loss: 1463959.2667; train_cat_covariates_contrastive_loss: 641806.2984; train_gene_expr_recon_loss: 3176613.6695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5297461.8500; train_optim_loss: 5297461.8500; val_kl_reg_loss: 12629.7809; val_edge_recon_loss: 1401080.1818; val_cat_covariates_contrastive_loss: 629952.3409; val_gene_expr_recon_loss: 2959601.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5003263.5076; val_optim_loss: 5003263.5076
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9240; val_auprc_score: 0.9688; val_best_acc_score: 0.9041; val_best_f1_score: 0.9395; train_kl_reg_loss: 11756.0676; train_edge_recon_loss: 1353632.5405; train_cat_covariates_contrastive_loss: 632176.9950; train_gene_expr_recon_loss: 2891038.0949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4888603.6983; train_optim_loss: 4888603.6983; val_kl_reg_loss: 11370.3420; val_edge_recon_loss: 1369690.3428; val_cat_covariates_contrastive_loss: 630780.4403; val_gene_expr_recon_loss: 2836867.1364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4848708.2652; val_optim_loss: 4848708.2652
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9428; val_auprc_score: 0.9762; val_best_acc_score: 0.9150; val_best_f1_score: 0.9457; train_kl_reg_loss: 11555.8374; train_edge_recon_loss: 1337141.8408; train_cat_covariates_contrastive_loss: 633392.0512; train_gene_expr_recon_loss: 2791623.4975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773713.2212; train_optim_loss: 4773713.2212; val_kl_reg_loss: 11792.4776; val_edge_recon_loss: 1361094.3030; val_cat_covariates_contrastive_loss: 634235.7784; val_gene_expr_recon_loss: 2752497.7689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4759620.3333; val_optim_loss: 4759620.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9403; val_auprc_score: 0.9740; val_best_acc_score: 0.9178; val_best_f1_score: 0.9473; train_kl_reg_loss: 12772.4918; train_edge_recon_loss: 1335382.4742; train_cat_covariates_contrastive_loss: 634911.9142; train_gene_expr_recon_loss: 2698292.5619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4681359.4339; train_optim_loss: 4681359.4339; val_kl_reg_loss: 14152.6199; val_edge_recon_loss: 1368092.8958; val_cat_covariates_contrastive_loss: 635430.5161; val_gene_expr_recon_loss: 2646698.5682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4664374.6136; val_optim_loss: 4664374.6136
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9438; val_auprc_score: 0.9752; val_best_acc_score: 0.9222; val_best_f1_score: 0.9505; train_kl_reg_loss: 15005.1776; train_edge_recon_loss: 1330159.3340; train_cat_covariates_contrastive_loss: 635864.8409; train_gene_expr_recon_loss: 2571417.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4552446.6258; train_optim_loss: 4552446.6258; val_kl_reg_loss: 15846.6588; val_edge_recon_loss: 1369768.3561; val_cat_covariates_contrastive_loss: 637780.7339; val_gene_expr_recon_loss: 2518688.1288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4542083.8939; val_optim_loss: 4542083.8939
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9440; val_auprc_score: 0.9747; val_best_acc_score: 0.9227; val_best_f1_score: 0.9501; train_kl_reg_loss: 16852.4316; train_edge_recon_loss: 1332281.4766; train_cat_covariates_contrastive_loss: 636863.7605; train_gene_expr_recon_loss: 2452908.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4438906.1131; train_optim_loss: 4438906.1131; val_kl_reg_loss: 18379.9571; val_edge_recon_loss: 1390140.0890; val_cat_covariates_contrastive_loss: 635742.7330; val_gene_expr_recon_loss: 2423452.6023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4467715.3636; val_optim_loss: 4467715.3636
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9496; val_auprc_score: 0.9776; val_best_acc_score: 0.9303; val_best_f1_score: 0.9553; train_kl_reg_loss: 18705.4992; train_edge_recon_loss: 1335482.3805; train_cat_covariates_contrastive_loss: 637604.0238; train_gene_expr_recon_loss: 2362129.2254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4353921.1258; train_optim_loss: 4353921.1258; val_kl_reg_loss: 19192.3896; val_edge_recon_loss: 1343865.3030; val_cat_covariates_contrastive_loss: 637753.9451; val_gene_expr_recon_loss: 2340588.1705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4341399.8144; val_optim_loss: 4341399.8144
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9513; val_auprc_score: 0.9787; val_best_acc_score: 0.9327; val_best_f1_score: 0.9570; train_kl_reg_loss: 19797.0097; train_edge_recon_loss: 1333250.6514; train_cat_covariates_contrastive_loss: 637846.6703; train_gene_expr_recon_loss: 2295452.6314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4286346.9665; train_optim_loss: 4286346.9665; val_kl_reg_loss: 20022.8477; val_edge_recon_loss: 1321137.1402; val_cat_covariates_contrastive_loss: 638954.4432; val_gene_expr_recon_loss: 2284388.8902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4264503.3447; val_optim_loss: 4264503.3447
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9515; val_auprc_score: 0.9783; val_best_acc_score: 0.9297; val_best_f1_score: 0.9546; train_kl_reg_loss: 20793.8257; train_edge_recon_loss: 1325827.7686; train_cat_covariates_contrastive_loss: 637928.7196; train_gene_expr_recon_loss: 2244620.3799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4229170.6924; train_optim_loss: 4229170.6924; val_kl_reg_loss: 20507.0919; val_edge_recon_loss: 1356248.5814; val_cat_covariates_contrastive_loss: 640824.0994; val_gene_expr_recon_loss: 2249410.3485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4266990.1212; val_optim_loss: 4266990.1212
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9467; val_auprc_score: 0.9750; val_best_acc_score: 0.9320; val_best_f1_score: 0.9561; train_kl_reg_loss: 21391.1998; train_edge_recon_loss: 1328845.6513; train_cat_covariates_contrastive_loss: 637647.3228; train_gene_expr_recon_loss: 2209279.9044; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4197164.0847; train_optim_loss: 4197164.0847; val_kl_reg_loss: 22274.3041; val_edge_recon_loss: 1362162.3371; val_cat_covariates_contrastive_loss: 635544.9337; val_gene_expr_recon_loss: 2219177.9867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4239159.5568; val_optim_loss: 4239159.5568
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9506; val_auprc_score: 0.9768; val_best_acc_score: 0.9334; val_best_f1_score: 0.9572; train_kl_reg_loss: 22097.1658; train_edge_recon_loss: 1325931.1166; train_cat_covariates_contrastive_loss: 637549.1142; train_gene_expr_recon_loss: 2172634.6439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4158212.0449; train_optim_loss: 4158212.0449; val_kl_reg_loss: 22717.2741; val_edge_recon_loss: 1343532.0170; val_cat_covariates_contrastive_loss: 636553.4763; val_gene_expr_recon_loss: 2198835.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4201638.6818; val_optim_loss: 4201638.6818
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9525; val_auprc_score: 0.9773; val_best_acc_score: 0.9325; val_best_f1_score: 0.9563; train_kl_reg_loss: 22333.7478; train_edge_recon_loss: 1330884.3810; train_cat_covariates_contrastive_loss: 637883.3767; train_gene_expr_recon_loss: 2156976.3038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4148077.8114; train_optim_loss: 4148077.8114; val_kl_reg_loss: 22278.1323; val_edge_recon_loss: 1377691.6610; val_cat_covariates_contrastive_loss: 639740.2462; val_gene_expr_recon_loss: 2187343.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4227053.4318; val_optim_loss: 4227053.4318
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9528; val_auprc_score: 0.9784; val_best_acc_score: 0.9363; val_best_f1_score: 0.9590; train_kl_reg_loss: 22979.6740; train_edge_recon_loss: 1322675.8233; train_cat_covariates_contrastive_loss: 637465.7821; train_gene_expr_recon_loss: 2133032.3623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4116153.6432; train_optim_loss: 4116153.6432; val_kl_reg_loss: 22392.3322; val_edge_recon_loss: 1344806.4735; val_cat_covariates_contrastive_loss: 638507.3333; val_gene_expr_recon_loss: 2164210.4053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4169916.5530; val_optim_loss: 4169916.5530
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9498; val_auprc_score: 0.9769; val_best_acc_score: 0.9353; val_best_f1_score: 0.9583; train_kl_reg_loss: 23219.4291; train_edge_recon_loss: 1321902.9787; train_cat_covariates_contrastive_loss: 637914.4197; train_gene_expr_recon_loss: 2122398.2513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4105435.0771; train_optim_loss: 4105435.0771; val_kl_reg_loss: 24209.6862; val_edge_recon_loss: 1364288.4848; val_cat_covariates_contrastive_loss: 636887.4583; val_gene_expr_recon_loss: 2155067.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4180453.3447; val_optim_loss: 4180453.3447
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9502; val_auprc_score: 0.9766; val_best_acc_score: 0.9334; val_best_f1_score: 0.9570; train_kl_reg_loss: 23741.0562; train_edge_recon_loss: 1324124.7679; train_cat_covariates_contrastive_loss: 638550.7732; train_gene_expr_recon_loss: 2104495.6008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4090912.1983; train_optim_loss: 4090912.1983; val_kl_reg_loss: 23466.6283; val_edge_recon_loss: 1355306.5530; val_cat_covariates_contrastive_loss: 636879.4214; val_gene_expr_recon_loss: 2153392.1345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4169044.7197; val_optim_loss: 4169044.7197
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9487; val_auprc_score: 0.9757; val_best_acc_score: 0.9344; val_best_f1_score: 0.9579; train_kl_reg_loss: 23698.6179; train_edge_recon_loss: 1321948.6576; train_cat_covariates_contrastive_loss: 637735.4400; train_gene_expr_recon_loss: 2092284.1398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4075666.8513; train_optim_loss: 4075666.8513; val_kl_reg_loss: 24559.8119; val_edge_recon_loss: 1347364.0606; val_cat_covariates_contrastive_loss: 635784.5417; val_gene_expr_recon_loss: 2143762.2519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4151470.6364; val_optim_loss: 4151470.6364
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9488; val_auprc_score: 0.9753; val_best_acc_score: 0.9343; val_best_f1_score: 0.9579; train_kl_reg_loss: 23897.7807; train_edge_recon_loss: 1327451.8126; train_cat_covariates_contrastive_loss: 637953.6212; train_gene_expr_recon_loss: 2090177.6917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4079480.9038; train_optim_loss: 4079480.9038; val_kl_reg_loss: 25026.9764; val_edge_recon_loss: 1344086.8239; val_cat_covariates_contrastive_loss: 636229.5331; val_gene_expr_recon_loss: 2124078.5568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4129421.9129; val_optim_loss: 4129421.9129
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9502; val_auprc_score: 0.9771; val_best_acc_score: 0.9370; val_best_f1_score: 0.9596; train_kl_reg_loss: 24257.6985; train_edge_recon_loss: 1320287.1428; train_cat_covariates_contrastive_loss: 638098.6249; train_gene_expr_recon_loss: 2074942.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4057585.6263; train_optim_loss: 4057585.6263; val_kl_reg_loss: 24608.4280; val_edge_recon_loss: 1336498.3125; val_cat_covariates_contrastive_loss: 637054.6761; val_gene_expr_recon_loss: 2130694.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4128855.7045; val_optim_loss: 4128855.7045
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9514; val_auprc_score: 0.9772; val_best_acc_score: 0.9368; val_best_f1_score: 0.9593; train_kl_reg_loss: 24160.6885; train_edge_recon_loss: 1319831.5733; train_cat_covariates_contrastive_loss: 638283.3025; train_gene_expr_recon_loss: 2075565.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4057841.3424; train_optim_loss: 4057841.3424; val_kl_reg_loss: 24642.4558; val_edge_recon_loss: 1352141.9962; val_cat_covariates_contrastive_loss: 636999.0985; val_gene_expr_recon_loss: 2129847.5095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4143631.0568; val_optim_loss: 4143631.0568
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9522; val_auprc_score: 0.9778; val_best_acc_score: 0.9348; val_best_f1_score: 0.9580; train_kl_reg_loss: 24551.6101; train_edge_recon_loss: 1329537.0525; train_cat_covariates_contrastive_loss: 637666.1320; train_gene_expr_recon_loss: 2067269.5682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4059024.3636; train_optim_loss: 4059024.3636; val_kl_reg_loss: 24590.5349; val_edge_recon_loss: 1341503.1667; val_cat_covariates_contrastive_loss: 639290.4053; val_gene_expr_recon_loss: 2119915.7367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4125299.8258; val_optim_loss: 4125299.8258
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9534; val_auprc_score: 0.9781; val_best_acc_score: 0.9364; val_best_f1_score: 0.9591; train_kl_reg_loss: 24773.8288; train_edge_recon_loss: 1328902.8177; train_cat_covariates_contrastive_loss: 638195.2162; train_gene_expr_recon_loss: 2052551.5129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4044423.3831; train_optim_loss: 4044423.3831; val_kl_reg_loss: 24176.2147; val_edge_recon_loss: 1345293.7689; val_cat_covariates_contrastive_loss: 639052.8210; val_gene_expr_recon_loss: 2113172.3485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4121695.1364; val_optim_loss: 4121695.1364
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9553; val_auprc_score: 0.9792; val_best_acc_score: 0.9387; val_best_f1_score: 0.9605; train_kl_reg_loss: 24803.2733; train_edge_recon_loss: 1318118.2188; train_cat_covariates_contrastive_loss: 637635.9048; train_gene_expr_recon_loss: 2059503.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4040060.6436; train_optim_loss: 4040060.6436; val_kl_reg_loss: 25378.0444; val_edge_recon_loss: 1341058.9830; val_cat_covariates_contrastive_loss: 637368.6146; val_gene_expr_recon_loss: 2114345.8277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4118151.4697; val_optim_loss: 4118151.4697
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9532; val_auprc_score: 0.9778; val_best_acc_score: 0.9389; val_best_f1_score: 0.9604; train_kl_reg_loss: 24984.6614; train_edge_recon_loss: 1323625.7399; train_cat_covariates_contrastive_loss: 638004.8668; train_gene_expr_recon_loss: 2047206.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4033821.4008; train_optim_loss: 4033821.4008; val_kl_reg_loss: 25447.8451; val_edge_recon_loss: 1348135.6970; val_cat_covariates_contrastive_loss: 637905.4309; val_gene_expr_recon_loss: 2106304.5985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4117793.5758; val_optim_loss: 4117793.5758
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9570; val_auprc_score: 0.9800; val_best_acc_score: 0.9363; val_best_f1_score: 0.9589; train_kl_reg_loss: 24981.1408; train_edge_recon_loss: 1322597.1389; train_cat_covariates_contrastive_loss: 637788.8952; train_gene_expr_recon_loss: 2045360.8428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4030728.0140; train_optim_loss: 4030728.0140; val_kl_reg_loss: 24339.4516; val_edge_recon_loss: 1338344.7481; val_cat_covariates_contrastive_loss: 641557.9119; val_gene_expr_recon_loss: 2117406.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4121648.5758; val_optim_loss: 4121648.5758
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9507; val_auprc_score: 0.9773; val_best_acc_score: 0.9375; val_best_f1_score: 0.9599; train_kl_reg_loss: 25324.3478; train_edge_recon_loss: 1316780.6474; train_cat_covariates_contrastive_loss: 638112.0526; train_gene_expr_recon_loss: 2038875.1280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4019092.1792; train_optim_loss: 4019092.1792; val_kl_reg_loss: 24933.6390; val_edge_recon_loss: 1328970.9261; val_cat_covariates_contrastive_loss: 637944.0644; val_gene_expr_recon_loss: 2119326.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4111175.6023; val_optim_loss: 4111175.6023
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9521; val_auprc_score: 0.9780; val_best_acc_score: 0.9384; val_best_f1_score: 0.9603; train_kl_reg_loss: 25389.8089; train_edge_recon_loss: 1316916.6326; train_cat_covariates_contrastive_loss: 638233.1860; train_gene_expr_recon_loss: 2036422.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4016962.2127; train_optim_loss: 4016962.2127; val_kl_reg_loss: 26256.9848; val_edge_recon_loss: 1338655.8144; val_cat_covariates_contrastive_loss: 636705.3741; val_gene_expr_recon_loss: 2102773.0303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4104391.2159; val_optim_loss: 4104391.2159
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9540; val_auprc_score: 0.9787; val_best_acc_score: 0.9389; val_best_f1_score: 0.9606; train_kl_reg_loss: 25420.7784; train_edge_recon_loss: 1322414.0838; train_cat_covariates_contrastive_loss: 637615.3975; train_gene_expr_recon_loss: 2027416.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4012866.3822; train_optim_loss: 4012866.3822; val_kl_reg_loss: 24886.4453; val_edge_recon_loss: 1355331.7036; val_cat_covariates_contrastive_loss: 637997.0057; val_gene_expr_recon_loss: 2097861.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4116076.9470; val_optim_loss: 4116076.9470
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9563; val_auprc_score: 0.9800; val_best_acc_score: 0.9399; val_best_f1_score: 0.9614; train_kl_reg_loss: 25380.6066; train_edge_recon_loss: 1324201.6722; train_cat_covariates_contrastive_loss: 638210.6365; train_gene_expr_recon_loss: 2032150.5424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4019943.4631; train_optim_loss: 4019943.4631; val_kl_reg_loss: 25274.2371; val_edge_recon_loss: 1336842.7178; val_cat_covariates_contrastive_loss: 640267.3523; val_gene_expr_recon_loss: 2117765.5398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4120149.8864; val_optim_loss: 4120149.8864
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9549; val_auprc_score: 0.9792; val_best_acc_score: 0.9395; val_best_f1_score: 0.9610; train_kl_reg_loss: 25873.9887; train_edge_recon_loss: 1317050.2176; train_cat_covariates_contrastive_loss: 638080.5112; train_gene_expr_recon_loss: 2033458.9212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4014463.6373; train_optim_loss: 4014463.6373; val_kl_reg_loss: 26440.7515; val_edge_recon_loss: 1347136.4242; val_cat_covariates_contrastive_loss: 637914.6250; val_gene_expr_recon_loss: 2133866.1989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4145358.0076; val_optim_loss: 4145358.0076
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9525; val_auprc_score: 0.9770; val_best_acc_score: 0.9392; val_best_f1_score: 0.9610; train_kl_reg_loss: 26150.3307; train_edge_recon_loss: 1323210.0639; train_cat_covariates_contrastive_loss: 638043.6704; train_gene_expr_recon_loss: 2023292.5773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4010696.6441; train_optim_loss: 4010696.6441; val_kl_reg_loss: 26603.0589; val_edge_recon_loss: 1343943.0303; val_cat_covariates_contrastive_loss: 638646.3314; val_gene_expr_recon_loss: 2099100.7955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4108293.2538; val_optim_loss: 4108293.2538

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9544; val_auprc_score: 0.9787; val_best_acc_score: 0.9396; val_best_f1_score: 0.9610; train_kl_reg_loss: 25851.3909; train_edge_recon_loss: 1322556.3676; train_cat_covariates_contrastive_loss: 637629.4286; train_gene_expr_recon_loss: 1987635.9765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3973673.1669; train_optim_loss: 3973673.1669; val_kl_reg_loss: 26142.1630; val_edge_recon_loss: 1348438.4091; val_cat_covariates_contrastive_loss: 637904.8570; val_gene_expr_recon_loss: 2075360.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4087845.9508; val_optim_loss: 4087845.9508
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9546; val_auprc_score: 0.9784; val_best_acc_score: 0.9407; val_best_f1_score: 0.9617; train_kl_reg_loss: 25674.6529; train_edge_recon_loss: 1318386.6095; train_cat_covariates_contrastive_loss: 638200.0962; train_gene_expr_recon_loss: 1980686.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3962947.5000; train_optim_loss: 3962947.5000; val_kl_reg_loss: 25719.3131; val_edge_recon_loss: 1343764.8239; val_cat_covariates_contrastive_loss: 638488.4337; val_gene_expr_recon_loss: 2078134.4527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086107.0417; val_optim_loss: 4086107.0417
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9579; val_auprc_score: 0.9803; val_best_acc_score: 0.9431; val_best_f1_score: 0.9634; train_kl_reg_loss: 25753.0513; train_edge_recon_loss: 1322253.9326; train_cat_covariates_contrastive_loss: 638018.5457; train_gene_expr_recon_loss: 1978806.3108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964831.8386; train_optim_loss: 3964831.8386; val_kl_reg_loss: 26048.8974; val_edge_recon_loss: 1321757.2273; val_cat_covariates_contrastive_loss: 637994.9091; val_gene_expr_recon_loss: 2074285.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4060086.3295; val_optim_loss: 4060086.3295
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9585; val_auprc_score: 0.9808; val_best_acc_score: 0.9419; val_best_f1_score: 0.9625; train_kl_reg_loss: 25641.4672; train_edge_recon_loss: 1322890.2090; train_cat_covariates_contrastive_loss: 637675.8030; train_gene_expr_recon_loss: 1980058.9019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3966266.3754; train_optim_loss: 3966266.3754; val_kl_reg_loss: 25570.0143; val_edge_recon_loss: 1332761.7405; val_cat_covariates_contrastive_loss: 637445.5720; val_gene_expr_recon_loss: 2074010.8390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4069788.1818; val_optim_loss: 4069788.1818
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9573; val_auprc_score: 0.9799; val_best_acc_score: 0.9429; val_best_f1_score: 0.9632; train_kl_reg_loss: 25535.2254; train_edge_recon_loss: 1323559.4737; train_cat_covariates_contrastive_loss: 637864.0793; train_gene_expr_recon_loss: 1977309.7867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3964268.5597; train_optim_loss: 3964268.5597; val_kl_reg_loss: 25839.5962; val_edge_recon_loss: 1334984.0303; val_cat_covariates_contrastive_loss: 636466.8731; val_gene_expr_recon_loss: 2071778.7633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4069069.2500; val_optim_loss: 4069069.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9496; val_auprc_score: 0.9758; val_best_acc_score: 0.9396; val_best_f1_score: 0.9612; train_kl_reg_loss: 25557.7295; train_edge_recon_loss: 1318632.3269; train_cat_covariates_contrastive_loss: 637931.9820; train_gene_expr_recon_loss: 1976214.4314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3958336.4712; train_optim_loss: 3958336.4712; val_kl_reg_loss: 25739.3244; val_edge_recon_loss: 1338459.8693; val_cat_covariates_contrastive_loss: 637196.9943; val_gene_expr_recon_loss: 2071095.8883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4072492.0871; val_optim_loss: 4072492.0871
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9563; val_auprc_score: 0.9793; val_best_acc_score: 0.9413; val_best_f1_score: 0.9619; train_kl_reg_loss: 25414.5847; train_edge_recon_loss: 1320126.7478; train_cat_covariates_contrastive_loss: 638192.9779; train_gene_expr_recon_loss: 1973146.5585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3956880.8669; train_optim_loss: 3956880.8669; val_kl_reg_loss: 25310.7056; val_edge_recon_loss: 1339072.1875; val_cat_covariates_contrastive_loss: 638742.4375; val_gene_expr_recon_loss: 2069641.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4072766.9280; val_optim_loss: 4072766.9280

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9562; val_auprc_score: 0.9796; val_best_acc_score: 0.9418; val_best_f1_score: 0.9625; train_kl_reg_loss: 25350.3933; train_edge_recon_loss: 1313617.6979; train_cat_covariates_contrastive_loss: 637769.2297; train_gene_expr_recon_loss: 1969138.7890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3945876.1203; train_optim_loss: 3945876.1203; val_kl_reg_loss: 25226.4118; val_edge_recon_loss: 1327199.2670; val_cat_covariates_contrastive_loss: 637848.7841; val_gene_expr_recon_loss: 2065013.0398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4055287.4924; val_optim_loss: 4055287.4924
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9542; val_auprc_score: 0.9787; val_best_acc_score: 0.9415; val_best_f1_score: 0.9622; train_kl_reg_loss: 25272.0583; train_edge_recon_loss: 1317813.0624; train_cat_covariates_contrastive_loss: 638118.0483; train_gene_expr_recon_loss: 1969784.2811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3950987.4475; train_optim_loss: 3950987.4475; val_kl_reg_loss: 25551.1206; val_edge_recon_loss: 1334505.3295; val_cat_covariates_contrastive_loss: 637141.5417; val_gene_expr_recon_loss: 2065512.1591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4062710.1629; val_optim_loss: 4062710.1629
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9567; val_auprc_score: 0.9785; val_best_acc_score: 0.9425; val_best_f1_score: 0.9628; train_kl_reg_loss: 25367.2493; train_edge_recon_loss: 1316141.4525; train_cat_covariates_contrastive_loss: 638109.6463; train_gene_expr_recon_loss: 1969105.5862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948723.9335; train_optim_loss: 3948723.9335; val_kl_reg_loss: 25378.5215; val_edge_recon_loss: 1345672.6174; val_cat_covariates_contrastive_loss: 636901.1136; val_gene_expr_recon_loss: 2072007.5095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4079959.7765; val_optim_loss: 4079959.7765
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9568; val_auprc_score: 0.9796; val_best_acc_score: 0.9418; val_best_f1_score: 0.9623; train_kl_reg_loss: 25364.0268; train_edge_recon_loss: 1323983.0048; train_cat_covariates_contrastive_loss: 637632.0871; train_gene_expr_recon_loss: 1967454.2085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3954433.3331; train_optim_loss: 3954433.3331; val_kl_reg_loss: 25259.5086; val_edge_recon_loss: 1344997.5341; val_cat_covariates_contrastive_loss: 637772.6780; val_gene_expr_recon_loss: 2066484.1098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4074513.8523; val_optim_loss: 4074513.8523
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9538; val_auprc_score: 0.9782; val_best_acc_score: 0.9424; val_best_f1_score: 0.9630; train_kl_reg_loss: 25245.3511; train_edge_recon_loss: 1319493.2401; train_cat_covariates_contrastive_loss: 637986.0811; train_gene_expr_recon_loss: 1968055.5244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3950780.1907; train_optim_loss: 3950780.1907; val_kl_reg_loss: 25381.3755; val_edge_recon_loss: 1316170.2462; val_cat_covariates_contrastive_loss: 638230.7983; val_gene_expr_recon_loss: 2074502.4413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4054284.8447; val_optim_loss: 4054284.8447
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9536; val_auprc_score: 0.9785; val_best_acc_score: 0.9395; val_best_f1_score: 0.9609; train_kl_reg_loss: 25300.4942; train_edge_recon_loss: 1317574.9103; train_cat_covariates_contrastive_loss: 638012.0888; train_gene_expr_recon_loss: 1967609.5331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948497.0326; train_optim_loss: 3948497.0326; val_kl_reg_loss: 25306.7147; val_edge_recon_loss: 1353679.7670; val_cat_covariates_contrastive_loss: 638286.5606; val_gene_expr_recon_loss: 2069489.8049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4086762.8409; val_optim_loss: 4086762.8409
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9531; val_auprc_score: 0.9768; val_best_acc_score: 0.9417; val_best_f1_score: 0.9624; train_kl_reg_loss: 25286.9999; train_edge_recon_loss: 1320039.2571; train_cat_covariates_contrastive_loss: 638178.0658; train_gene_expr_recon_loss: 1967982.7195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3951487.0508; train_optim_loss: 3951487.0508; val_kl_reg_loss: 25293.9042; val_edge_recon_loss: 1341644.0530; val_cat_covariates_contrastive_loss: 638230.0814; val_gene_expr_recon_loss: 2065670.4034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4070838.4470; val_optim_loss: 4070838.4470
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9558; val_auprc_score: 0.9793; val_best_acc_score: 0.9418; val_best_f1_score: 0.9624; train_kl_reg_loss: 25278.5881; train_edge_recon_loss: 1317022.4290; train_cat_covariates_contrastive_loss: 637818.9313; train_gene_expr_recon_loss: 1967982.4663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948102.4161; train_optim_loss: 3948102.4161; val_kl_reg_loss: 25340.6104; val_edge_recon_loss: 1339068.1080; val_cat_covariates_contrastive_loss: 638377.7699; val_gene_expr_recon_loss: 2076349.1174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4079135.5947; val_optim_loss: 4079135.5947
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9569; val_auprc_score: 0.9798; val_best_acc_score: 0.9438; val_best_f1_score: 0.9637; train_kl_reg_loss: 25239.4530; train_edge_recon_loss: 1317799.2898; train_cat_covariates_contrastive_loss: 638041.1099; train_gene_expr_recon_loss: 1967189.6648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948269.5208; train_optim_loss: 3948269.5208; val_kl_reg_loss: 25358.3615; val_edge_recon_loss: 1323757.1307; val_cat_covariates_contrastive_loss: 637765.8987; val_gene_expr_recon_loss: 2072007.6515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4058889.0227; val_optim_loss: 4058889.0227

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9598; val_auprc_score: 0.9809; val_best_acc_score: 0.9431; val_best_f1_score: 0.9629; train_kl_reg_loss: 25286.4670; train_edge_recon_loss: 1320789.0251; train_cat_covariates_contrastive_loss: 637742.1076; train_gene_expr_recon_loss: 1967469.7229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3951287.3186; train_optim_loss: 3951287.3186; val_kl_reg_loss: 25360.8509; val_edge_recon_loss: 1366277.8731; val_cat_covariates_contrastive_loss: 637963.4176; val_gene_expr_recon_loss: 2073181.1629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4102783.2992; val_optim_loss: 4102783.2992
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9544; val_auprc_score: 0.9769; val_best_acc_score: 0.9433; val_best_f1_score: 0.9634; train_kl_reg_loss: 25289.3208; train_edge_recon_loss: 1319876.2680; train_cat_covariates_contrastive_loss: 637548.6434; train_gene_expr_recon_loss: 1968825.3631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3951539.5949; train_optim_loss: 3951539.5949; val_kl_reg_loss: 25321.8526; val_edge_recon_loss: 1338894.3958; val_cat_covariates_contrastive_loss: 639184.5038; val_gene_expr_recon_loss: 2070582.9451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4073983.7008; val_optim_loss: 4073983.7008
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9554; val_auprc_score: 0.9774; val_best_acc_score: 0.9405; val_best_f1_score: 0.9613; train_kl_reg_loss: 25268.6152; train_edge_recon_loss: 1319897.4992; train_cat_covariates_contrastive_loss: 637740.7117; train_gene_expr_recon_loss: 1965534.2706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3948441.0962; train_optim_loss: 3948441.0962; val_kl_reg_loss: 25339.3196; val_edge_recon_loss: 1364629.6155; val_cat_covariates_contrastive_loss: 637763.0814; val_gene_expr_recon_loss: 2071116.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4098848.5152; val_optim_loss: 4098848.5152
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9555; val_auprc_score: 0.9795; val_best_acc_score: 0.9416; val_best_f1_score: 0.9623; train_kl_reg_loss: 25261.2976; train_edge_recon_loss: 1325323.0610; train_cat_covariates_contrastive_loss: 638089.4033; train_gene_expr_recon_loss: 1966400.9506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3955074.7106; train_optim_loss: 3955074.7106; val_kl_reg_loss: 25385.3772; val_edge_recon_loss: 1332941.6610; val_cat_covariates_contrastive_loss: 637955.4735; val_gene_expr_recon_loss: 2069013.7860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4065296.2917; val_optim_loss: 4065296.2917

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 149 min 39 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9101
val AUPRC score: 0.9458
val best accuracy score: 0.9276
val best F1 score: 0.9530
val target rna MSE score: 1.5385
val source rna MSE score: 0.1199
Val cat covariate0 mean sim diff: -0.0025
Val cat covariate1 mean sim diff: -0.0660
Duration of model training in run 1: 2 hours, 30 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
