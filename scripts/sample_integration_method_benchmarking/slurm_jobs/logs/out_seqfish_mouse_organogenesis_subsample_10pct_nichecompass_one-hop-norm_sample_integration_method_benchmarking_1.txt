Run timestamp: 26062023_181557_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '6', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9644; val_auprc_score: 0.9563; val_best_acc_score: 0.9020; val_best_f1_score: 0.9067; train_kl_reg_loss: 71.3126; train_edge_recon_loss: 104545.0547; train_gene_expr_recon_loss: 142434.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 247050.8750; train_optim_loss: 247050.8750; val_kl_reg_loss: 70.0592; val_edge_recon_loss: 119662.3828; val_gene_expr_recon_loss: 139360.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259093.3125; val_optim_loss: 259093.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9677; val_auprc_score: 0.9668; val_best_acc_score: 0.9012; val_best_f1_score: 0.9061; train_kl_reg_loss: 74.1469; train_edge_recon_loss: 102431.3750; train_gene_expr_recon_loss: 141469.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243975.0625; train_optim_loss: 243975.0625; val_kl_reg_loss: 107.8213; val_edge_recon_loss: 110071.5234; val_gene_expr_recon_loss: 138467.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248646.7188; val_optim_loss: 248646.7188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9651; val_auprc_score: 0.9538; val_best_acc_score: 0.8725; val_best_f1_score: 0.8843; train_kl_reg_loss: 115.2051; train_edge_recon_loss: 99350.7891; train_gene_expr_recon_loss: 140513.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239979.6562; train_optim_loss: 239979.6562; val_kl_reg_loss: 187.1046; val_edge_recon_loss: 116703.8516; val_gene_expr_recon_loss: 137616.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254507.1406; val_optim_loss: 254507.1406
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9648; val_auprc_score: 0.9625; val_best_acc_score: 0.9004; val_best_f1_score: 0.9043; train_kl_reg_loss: 199.6481; train_edge_recon_loss: 100377.9531; train_gene_expr_recon_loss: 139604.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240181.9375; train_optim_loss: 240181.9375; val_kl_reg_loss: 285.5873; val_edge_recon_loss: 119254.9922; val_gene_expr_recon_loss: 136748.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256289.4375; val_optim_loss: 256289.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9632; val_auprc_score: 0.9600; val_best_acc_score: 0.8738; val_best_f1_score: 0.8850; train_kl_reg_loss: 305.2047; train_edge_recon_loss: 101450.0000; train_gene_expr_recon_loss: 138703.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240459.1719; train_optim_loss: 240459.1719; val_kl_reg_loss: 364.8944; val_edge_recon_loss: 109614.1953; val_gene_expr_recon_loss: 135712.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245691.7500; val_optim_loss: 245691.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9640; val_auprc_score: 0.9613; val_best_acc_score: 0.8451; val_best_f1_score: 0.8638; train_kl_reg_loss: 388.2250; train_edge_recon_loss: 103678.9922; train_gene_expr_recon_loss: 137596.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241663.8594; train_optim_loss: 241663.8594; val_kl_reg_loss: 422.3728; val_edge_recon_loss: 123102.8203; val_gene_expr_recon_loss: 134738.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258263.8438; val_optim_loss: 258263.8438
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9595; val_auprc_score: 0.9524; val_best_acc_score: 0.8270; val_best_f1_score: 0.8511; train_kl_reg_loss: 451.2700; train_edge_recon_loss: 103968.0391; train_gene_expr_recon_loss: 136560.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240980.0625; train_optim_loss: 240980.0625; val_kl_reg_loss: 474.2850; val_edge_recon_loss: 113627.7031; val_gene_expr_recon_loss: 133927.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248029.7656; val_optim_loss: 248029.7656
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9639; val_auprc_score: 0.9570; val_best_acc_score: 0.8135; val_best_f1_score: 0.8415; train_kl_reg_loss: 506.3097; train_edge_recon_loss: 104002.2031; train_gene_expr_recon_loss: 135730.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240238.5781; train_optim_loss: 240238.5781; val_kl_reg_loss: 518.5421; val_edge_recon_loss: 108242.9922; val_gene_expr_recon_loss: 133164.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241926.3906; val_optim_loss: 241926.3906
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9604; val_auprc_score: 0.9566; val_best_acc_score: 0.8143; val_best_f1_score: 0.8420; train_kl_reg_loss: 554.2107; train_edge_recon_loss: 104305.0312; train_gene_expr_recon_loss: 134971.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239830.7812; train_optim_loss: 239830.7812; val_kl_reg_loss: 559.9784; val_edge_recon_loss: 117414.9922; val_gene_expr_recon_loss: 132357.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250332.4219; val_optim_loss: 250332.4219
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9585; val_auprc_score: 0.9490; val_best_acc_score: 0.8119; val_best_f1_score: 0.8401; train_kl_reg_loss: 596.9797; train_edge_recon_loss: 99901.5547; train_gene_expr_recon_loss: 134146.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234644.9375; train_optim_loss: 234644.9375; val_kl_reg_loss: 607.0032; val_edge_recon_loss: 122461.6406; val_gene_expr_recon_loss: 131509.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254578.0469; val_optim_loss: 254578.0469
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9589; val_auprc_score: 0.9552; val_best_acc_score: 0.8340; val_best_f1_score: 0.8561; train_kl_reg_loss: 654.3861; train_edge_recon_loss: 101954.7422; train_gene_expr_recon_loss: 133295.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235905.0781; train_optim_loss: 235905.0781; val_kl_reg_loss: 695.7833; val_edge_recon_loss: 109750.8359; val_gene_expr_recon_loss: 130660.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241106.8594; val_optim_loss: 241106.8594
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9607; val_auprc_score: 0.9536; val_best_acc_score: 0.8299; val_best_f1_score: 0.8530; train_kl_reg_loss: 742.6938; train_edge_recon_loss: 104100.6797; train_gene_expr_recon_loss: 132442.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237286.1406; train_optim_loss: 237286.1406; val_kl_reg_loss: 806.1207; val_edge_recon_loss: 118287.3828; val_gene_expr_recon_loss: 129828.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248921.8750; val_optim_loss: 248921.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9565; val_auprc_score: 0.9453; val_best_acc_score: 0.8455; val_best_f1_score: 0.8643; train_kl_reg_loss: 861.1014; train_edge_recon_loss: 104277.7500; train_gene_expr_recon_loss: 131630.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236769.3125; train_optim_loss: 236769.3125; val_kl_reg_loss: 923.5748; val_edge_recon_loss: 108469.4297; val_gene_expr_recon_loss: 129024.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238417.0625; val_optim_loss: 238417.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9614; val_auprc_score: 0.9604; val_best_acc_score: 0.8459; val_best_f1_score: 0.8641; train_kl_reg_loss: 995.7715; train_edge_recon_loss: 102014.2344; train_gene_expr_recon_loss: 130866.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233876.9688; train_optim_loss: 233876.9688; val_kl_reg_loss: 1035.7893; val_edge_recon_loss: 110092.0859; val_gene_expr_recon_loss: 128220.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239347.9375; val_optim_loss: 239347.9375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9446; val_auprc_score: 0.9336; val_best_acc_score: 0.8270; val_best_f1_score: 0.8495; train_kl_reg_loss: 1114.5051; train_edge_recon_loss: 99915.5625; train_gene_expr_recon_loss: 130079.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231109.2500; train_optim_loss: 231109.2500; val_kl_reg_loss: 1125.0977; val_edge_recon_loss: 116023.4688; val_gene_expr_recon_loss: 127426.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244575.4688; val_optim_loss: 244575.4688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9523; val_auprc_score: 0.9502; val_best_acc_score: 0.8500; val_best_f1_score: 0.8661; train_kl_reg_loss: 1208.6753; train_edge_recon_loss: 99412.8203; train_gene_expr_recon_loss: 129276.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229897.8594; train_optim_loss: 229897.8594; val_kl_reg_loss: 1190.1113; val_edge_recon_loss: 113674.7188; val_gene_expr_recon_loss: 126663.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241528.0312; val_optim_loss: 241528.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9487; val_auprc_score: 0.9468; val_best_acc_score: 0.8381; val_best_f1_score: 0.8570; train_kl_reg_loss: 1274.7666; train_edge_recon_loss: 102309.5078; train_gene_expr_recon_loss: 128488.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232072.7656; train_optim_loss: 232072.7656; val_kl_reg_loss: 1183.4150; val_edge_recon_loss: 113683.6328; val_gene_expr_recon_loss: 126588.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241456.0312; val_optim_loss: 241456.0312
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9493; val_auprc_score: 0.9439; val_best_acc_score: 0.8418; val_best_f1_score: 0.8595; train_kl_reg_loss: 1281.3960; train_edge_recon_loss: 103368.9531; train_gene_expr_recon_loss: 128419.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233069.6406; train_optim_loss: 233069.6406; val_kl_reg_loss: 1189.0024; val_edge_recon_loss: 119970.2188; val_gene_expr_recon_loss: 126514.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247673.7344; val_optim_loss: 247673.7344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9551; val_auprc_score: 0.9518; val_best_acc_score: 0.8471; val_best_f1_score: 0.8636; train_kl_reg_loss: 1279.4882; train_edge_recon_loss: 101482.3359; train_gene_expr_recon_loss: 128374.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231136.3438; train_optim_loss: 231136.3438; val_kl_reg_loss: 1183.4354; val_edge_recon_loss: 112131.6641; val_gene_expr_recon_loss: 126440.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239755.2031; val_optim_loss: 239755.2031

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 10 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9557
Val AUPRC score: 0.9488
Val best accuracy score: 0.8275
Val best F1 score: 0.8509
Val gene expr MSE score: 2.3723
Duration of model training in run 1: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 10989
Number of validation edges: 1220
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9661; val_auprc_score: 0.9645; val_best_acc_score: 0.9066; val_best_f1_score: 0.9106; train_kl_reg_loss: 71.5715; train_edge_recon_loss: 103023.3516; train_gene_expr_recon_loss: 141004.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244099.6406; train_optim_loss: 244099.6406; val_kl_reg_loss: 72.7522; val_edge_recon_loss: 113391.3594; val_gene_expr_recon_loss: 142221.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255686.0312; val_optim_loss: 255686.0312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9632; val_auprc_score: 0.9597; val_best_acc_score: 0.8992; val_best_f1_score: 0.9044; train_kl_reg_loss: 75.2326; train_edge_recon_loss: 101364.1016; train_gene_expr_recon_loss: 139849.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241288.7188; train_optim_loss: 241288.7188; val_kl_reg_loss: 115.2076; val_edge_recon_loss: 110573.2734; val_gene_expr_recon_loss: 141199.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251888.2188; val_optim_loss: 251888.2188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9633; val_auprc_score: 0.9585; val_best_acc_score: 0.8631; val_best_f1_score: 0.8768; train_kl_reg_loss: 119.3743; train_edge_recon_loss: 103699.4141; train_gene_expr_recon_loss: 138802.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242621.1562; train_optim_loss: 242621.1562; val_kl_reg_loss: 198.9236; val_edge_recon_loss: 119474.1250; val_gene_expr_recon_loss: 140544.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260217.6875; val_optim_loss: 260217.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9610; val_auprc_score: 0.9536; val_best_acc_score: 0.8951; val_best_f1_score: 0.8947; train_kl_reg_loss: 204.6320; train_edge_recon_loss: 104588.7656; train_gene_expr_recon_loss: 138109.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242902.6250; train_optim_loss: 242902.6250; val_kl_reg_loss: 254.6624; val_edge_recon_loss: 121475.5938; val_gene_expr_recon_loss: 139685.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261415.7188; val_optim_loss: 261415.7188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9625; val_auprc_score: 0.9561; val_best_acc_score: 0.9070; val_best_f1_score: 0.9097; train_kl_reg_loss: 263.1127; train_edge_recon_loss: 102060.6094; train_gene_expr_recon_loss: 137204.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239528.1719; train_optim_loss: 239528.1719; val_kl_reg_loss: 295.1662; val_edge_recon_loss: 117752.5312; val_gene_expr_recon_loss: 138672.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256719.7188; val_optim_loss: 256719.7188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9641; val_auprc_score: 0.9569; val_best_acc_score: 0.8885; val_best_f1_score: 0.8967; train_kl_reg_loss: 304.4717; train_edge_recon_loss: 102488.8125; train_gene_expr_recon_loss: 136216.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239009.6719; train_optim_loss: 239009.6719; val_kl_reg_loss: 343.0829; val_edge_recon_loss: 115532.2734; val_gene_expr_recon_loss: 137807.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253682.7812; val_optim_loss: 253682.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9653; val_auprc_score: 0.9600; val_best_acc_score: 0.8844; val_best_f1_score: 0.8935; train_kl_reg_loss: 355.4277; train_edge_recon_loss: 100587.9453; train_gene_expr_recon_loss: 135364.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236308.2188; train_optim_loss: 236308.2188; val_kl_reg_loss: 349.8297; val_edge_recon_loss: 113585.1172; val_gene_expr_recon_loss: 137719.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251654.3438; val_optim_loss: 251654.3438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9628; val_auprc_score: 0.9576; val_best_acc_score: 0.8795; val_best_f1_score: 0.8896; train_kl_reg_loss: 362.3346; train_edge_recon_loss: 101770.7578; train_gene_expr_recon_loss: 135289.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237422.8906; train_optim_loss: 237422.8906; val_kl_reg_loss: 357.3528; val_edge_recon_loss: 120489.0312; val_gene_expr_recon_loss: 137622.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258469.2812; val_optim_loss: 258469.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9598; val_auprc_score: 0.9559; val_best_acc_score: 0.8865; val_best_f1_score: 0.8953; train_kl_reg_loss: 368.5248; train_edge_recon_loss: 105683.0625; train_gene_expr_recon_loss: 135206.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241257.7812; train_optim_loss: 241257.7812; val_kl_reg_loss: 362.6948; val_edge_recon_loss: 124598.1016; val_gene_expr_recon_loss: 137520.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262481.0625; val_optim_loss: 262481.0625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9605; val_auprc_score: 0.9534; val_best_acc_score: 0.8758; val_best_f1_score: 0.8866; train_kl_reg_loss: 374.0581; train_edge_recon_loss: 99901.4062; train_gene_expr_recon_loss: 135102.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235378.2500; train_optim_loss: 235378.2500; val_kl_reg_loss: 371.3936; val_edge_recon_loss: 105547.0391; val_gene_expr_recon_loss: 137412.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243331.2500; val_optim_loss: 243331.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9603; val_auprc_score: 0.9533; val_best_acc_score: 0.8742; val_best_f1_score: 0.8855; train_kl_reg_loss: 380.8797; train_edge_recon_loss: 100235.1406; train_gene_expr_recon_loss: 134997.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235613.3438; train_optim_loss: 235613.3438; val_kl_reg_loss: 372.8960; val_edge_recon_loss: 105427.1250; val_gene_expr_recon_loss: 137302.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243102.4688; val_optim_loss: 243102.4688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9654; val_auprc_score: 0.9644; val_best_acc_score: 0.8758; val_best_f1_score: 0.8870; train_kl_reg_loss: 386.4696; train_edge_recon_loss: 100233.1797; train_gene_expr_recon_loss: 134884.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235503.9375; train_optim_loss: 235503.9375; val_kl_reg_loss: 377.4402; val_edge_recon_loss: 117042.9688; val_gene_expr_recon_loss: 137189.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254609.6719; val_optim_loss: 254609.6719
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9609; val_auprc_score: 0.9517; val_best_acc_score: 0.8754; val_best_f1_score: 0.8869; train_kl_reg_loss: 391.8651; train_edge_recon_loss: 102854.3516; train_gene_expr_recon_loss: 134762.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238008.9531; train_optim_loss: 238008.9531; val_kl_reg_loss: 383.7531; val_edge_recon_loss: 120885.7969; val_gene_expr_recon_loss: 137076.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258345.9375; val_optim_loss: 258345.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9582; val_auprc_score: 0.9524; val_best_acc_score: 0.8730; val_best_f1_score: 0.8849; train_kl_reg_loss: 396.6632; train_edge_recon_loss: 102552.0000; train_gene_expr_recon_loss: 134655.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237604.0000; train_optim_loss: 237604.0000; val_kl_reg_loss: 387.9181; val_edge_recon_loss: 119956.6172; val_gene_expr_recon_loss: 136962.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257307.1875; val_optim_loss: 257307.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9613; val_auprc_score: 0.9529; val_best_acc_score: 0.8725; val_best_f1_score: 0.8846; train_kl_reg_loss: 402.7032; train_edge_recon_loss: 102106.3828; train_gene_expr_recon_loss: 134528.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237037.5938; train_optim_loss: 237037.5938; val_kl_reg_loss: 390.7457; val_edge_recon_loss: 106890.3828; val_gene_expr_recon_loss: 136951.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244232.3281; val_optim_loss: 244232.3281
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9620; val_auprc_score: 0.9597; val_best_acc_score: 0.8574; val_best_f1_score: 0.8726; train_kl_reg_loss: 403.4061; train_edge_recon_loss: 101235.1406; train_gene_expr_recon_loss: 134530.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236169.0312; train_optim_loss: 236169.0312; val_kl_reg_loss: 392.2523; val_edge_recon_loss: 118059.7031; val_gene_expr_recon_loss: 136939.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255391.7031; val_optim_loss: 255391.7031
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9629; val_auprc_score: 0.9596; val_best_acc_score: 0.8648; val_best_f1_score: 0.8784; train_kl_reg_loss: 403.4781; train_edge_recon_loss: 100873.9219; train_gene_expr_recon_loss: 134521.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235799.1875; train_optim_loss: 235799.1875; val_kl_reg_loss: 390.9655; val_edge_recon_loss: 116180.7344; val_gene_expr_recon_loss: 136928.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253500.0156; val_optim_loss: 253500.0156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 8 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9635
Val AUPRC score: 0.9612
Val best accuracy score: 0.8779
Val best F1 score: 0.8885
Val gene expr MSE score: 2.7108
Duration of model training in run 2: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9888; val_auprc_score: 0.9855; val_best_acc_score: 0.9410; val_best_f1_score: 0.9391; train_kl_reg_loss: 68.1760; train_edge_recon_loss: 101858.2734; train_gene_expr_recon_loss: 144671.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246597.5938; train_optim_loss: 246597.5938; val_kl_reg_loss: 116.2424; val_edge_recon_loss: 112563.5156; val_gene_expr_recon_loss: 143860.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256540.3438; val_optim_loss: 256540.3438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9866; val_auprc_score: 0.9793; val_best_acc_score: 0.9148; val_best_f1_score: 0.9210; train_kl_reg_loss: 157.4081; train_edge_recon_loss: 101668.2695; train_gene_expr_recon_loss: 142177.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244003.3594; train_optim_loss: 244003.3594; val_kl_reg_loss: 222.1825; val_edge_recon_loss: 119022.8203; val_gene_expr_recon_loss: 142305.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261550.3750; val_optim_loss: 261550.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9871; val_auprc_score: 0.9853; val_best_acc_score: 0.8617; val_best_f1_score: 0.8782; train_kl_reg_loss: 239.8574; train_edge_recon_loss: 104084.0547; train_gene_expr_recon_loss: 141812.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246136.2812; train_optim_loss: 246136.2812; val_kl_reg_loss: 288.4995; val_edge_recon_loss: 121223.9375; val_gene_expr_recon_loss: 140779.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262291.6250; val_optim_loss: 262291.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9867; val_auprc_score: 0.9829; val_best_acc_score: 0.8650; val_best_f1_score: 0.8456; train_kl_reg_loss: 329.8935; train_edge_recon_loss: 100328.6211; train_gene_expr_recon_loss: 141000.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241658.5156; train_optim_loss: 241658.5156; val_kl_reg_loss: 438.8383; val_edge_recon_loss: 120694.2500; val_gene_expr_recon_loss: 138899.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260032.9688; val_optim_loss: 260032.9688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9850; val_auprc_score: 0.9825; val_best_acc_score: 0.9140; val_best_f1_score: 0.9082; train_kl_reg_loss: 488.8831; train_edge_recon_loss: 103212.2383; train_gene_expr_recon_loss: 137591.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241292.4297; train_optim_loss: 241292.4297; val_kl_reg_loss: 600.5098; val_edge_recon_loss: 117695.5391; val_gene_expr_recon_loss: 136975.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255272.0156; val_optim_loss: 255272.0156
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9826; val_auprc_score: 0.9784; val_best_acc_score: 0.9154; val_best_f1_score: 0.9104; train_kl_reg_loss: 636.3864; train_edge_recon_loss: 104152.4258; train_gene_expr_recon_loss: 135695.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240484.2109; train_optim_loss: 240484.2109; val_kl_reg_loss: 678.3572; val_edge_recon_loss: 112391.8359; val_gene_expr_recon_loss: 135341.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248412.0000; val_optim_loss: 248412.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9778; val_auprc_score: 0.9750; val_best_acc_score: 0.9102; val_best_f1_score: 0.9051; train_kl_reg_loss: 723.9544; train_edge_recon_loss: 101623.0039; train_gene_expr_recon_loss: 135089.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237436.3047; train_optim_loss: 237436.3047; val_kl_reg_loss: 822.1762; val_edge_recon_loss: 124902.9375; val_gene_expr_recon_loss: 133742.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259467.3438; val_optim_loss: 259467.3438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9785; val_auprc_score: 0.9765; val_best_acc_score: 0.9165; val_best_f1_score: 0.9124; train_kl_reg_loss: 914.1645; train_edge_recon_loss: 102430.0195; train_gene_expr_recon_loss: 133441.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236786.1094; train_optim_loss: 236786.1094; val_kl_reg_loss: 1137.3184; val_edge_recon_loss: 114485.6250; val_gene_expr_recon_loss: 131823.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247446.7812; val_optim_loss: 247446.7812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9724; val_auprc_score: 0.9720; val_best_acc_score: 0.9060; val_best_f1_score: 0.9027; train_kl_reg_loss: 1259.7901; train_edge_recon_loss: 100072.3164; train_gene_expr_recon_loss: 131482.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232814.8750; train_optim_loss: 232814.8750; val_kl_reg_loss: 1450.1874; val_edge_recon_loss: 123546.1172; val_gene_expr_recon_loss: 129938.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254935.2500; val_optim_loss: 254935.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9703; val_auprc_score: 0.9684; val_best_acc_score: 0.9010; val_best_f1_score: 0.8961; train_kl_reg_loss: 1515.9446; train_edge_recon_loss: 102937.3242; train_gene_expr_recon_loss: 128809.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233263.1562; train_optim_loss: 233263.1562; val_kl_reg_loss: 1546.8362; val_edge_recon_loss: 107088.6875; val_gene_expr_recon_loss: 128391.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237026.9375; val_optim_loss: 237026.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9664; val_auprc_score: 0.9605; val_best_acc_score: 0.8850; val_best_f1_score: 0.8769; train_kl_reg_loss: 1582.4429; train_edge_recon_loss: 103899.3242; train_gene_expr_recon_loss: 129183.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234665.6016; train_optim_loss: 234665.6016; val_kl_reg_loss: 1558.6593; val_edge_recon_loss: 114114.9922; val_gene_expr_recon_loss: 127090.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 242763.8594; val_optim_loss: 242763.8594
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9605; val_auprc_score: 0.9577; val_best_acc_score: 0.8638; val_best_f1_score: 0.8658; train_kl_reg_loss: 1591.5175; train_edge_recon_loss: 103622.9688; train_gene_expr_recon_loss: 127290.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 232504.6172; train_optim_loss: 232504.6172; val_kl_reg_loss: 1530.4006; val_edge_recon_loss: 112252.6016; val_gene_expr_recon_loss: 126070.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239853.6250; val_optim_loss: 239853.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9592; val_auprc_score: 0.9541; val_best_acc_score: 0.8696; val_best_f1_score: 0.8801; train_kl_reg_loss: 1542.4795; train_edge_recon_loss: 102291.2109; train_gene_expr_recon_loss: 125886.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229719.7969; train_optim_loss: 229719.7969; val_kl_reg_loss: 1501.8938; val_edge_recon_loss: 117004.8594; val_gene_expr_recon_loss: 125175.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243682.3438; val_optim_loss: 243682.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9560; val_auprc_score: 0.9534; val_best_acc_score: 0.8629; val_best_f1_score: 0.8746; train_kl_reg_loss: 1543.8986; train_edge_recon_loss: 101860.5000; train_gene_expr_recon_loss: 124859.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228264.0469; train_optim_loss: 228264.0469; val_kl_reg_loss: 1508.8947; val_edge_recon_loss: 107851.9766; val_gene_expr_recon_loss: 125077.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234438.1250; val_optim_loss: 234438.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9545; val_auprc_score: 0.9457; val_best_acc_score: 0.8650; val_best_f1_score: 0.8761; train_kl_reg_loss: 1541.4980; train_edge_recon_loss: 101163.0234; train_gene_expr_recon_loss: 125086.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227790.8984; train_optim_loss: 227790.8984; val_kl_reg_loss: 1507.0115; val_edge_recon_loss: 113626.1719; val_gene_expr_recon_loss: 124967.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240100.5000; val_optim_loss: 240100.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9539; val_auprc_score: 0.9500; val_best_acc_score: 0.8654; val_best_f1_score: 0.8762; train_kl_reg_loss: 1543.7770; train_edge_recon_loss: 100832.9805; train_gene_expr_recon_loss: 124710.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227087.5000; train_optim_loss: 227087.5000; val_kl_reg_loss: 1510.5457; val_edge_recon_loss: 113654.6953; val_gene_expr_recon_loss: 124849.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240014.9062; val_optim_loss: 240014.9062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9537; val_auprc_score: 0.9500; val_best_acc_score: 0.8627; val_best_f1_score: 0.8737; train_kl_reg_loss: 1546.9071; train_edge_recon_loss: 101690.3945; train_gene_expr_recon_loss: 124403.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227640.9609; train_optim_loss: 227640.9609; val_kl_reg_loss: 1520.3389; val_edge_recon_loss: 119808.2812; val_gene_expr_recon_loss: 124728.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246057.1875; val_optim_loss: 246057.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9565; val_auprc_score: 0.9555; val_best_acc_score: 0.8658; val_best_f1_score: 0.8762; train_kl_reg_loss: 1551.1853; train_edge_recon_loss: 99210.8906; train_gene_expr_recon_loss: 124654.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225416.9844; train_optim_loss: 225416.9844; val_kl_reg_loss: 1523.8434; val_edge_recon_loss: 110965.6250; val_gene_expr_recon_loss: 124716.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237205.7344; val_optim_loss: 237205.7344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9576; val_auprc_score: 0.9542; val_best_acc_score: 0.8665; val_best_f1_score: 0.8767; train_kl_reg_loss: 1559.5172; train_edge_recon_loss: 99362.7500; train_gene_expr_recon_loss: 124791.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225714.0000; train_optim_loss: 225714.0000; val_kl_reg_loss: 1523.6876; val_edge_recon_loss: 113158.2266; val_gene_expr_recon_loss: 124703.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 239385.6250; val_optim_loss: 239385.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9520; val_auprc_score: 0.9454; val_best_acc_score: 0.8627; val_best_f1_score: 0.8736; train_kl_reg_loss: 1560.6087; train_edge_recon_loss: 101757.9102; train_gene_expr_recon_loss: 125322.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228640.5391; train_optim_loss: 228640.5391; val_kl_reg_loss: 1526.9550; val_edge_recon_loss: 109608.8047; val_gene_expr_recon_loss: 124690.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235826.7188; val_optim_loss: 235826.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 16 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9543
Val AUPRC score: 0.9520
Val best accuracy score: 0.8606
Val best F1 score: 0.8728
Val gene expr MSE score: 2.2833
Duration of model training in run 3: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 21600
Number of validation edges: 2400
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9882; val_auprc_score: 0.9808; val_best_acc_score: 0.9390; val_best_f1_score: 0.9418; train_kl_reg_loss: 66.1213; train_edge_recon_loss: 99688.3359; train_gene_expr_recon_loss: 138933.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238687.9609; train_optim_loss: 238687.9609; val_kl_reg_loss: 103.9158; val_edge_recon_loss: 116709.5156; val_gene_expr_recon_loss: 138324.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255137.7500; val_optim_loss: 255137.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9873; val_auprc_score: 0.9844; val_best_acc_score: 0.9085; val_best_f1_score: 0.9157; train_kl_reg_loss: 143.3381; train_edge_recon_loss: 101638.1641; train_gene_expr_recon_loss: 137242.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239023.5312; train_optim_loss: 239023.5312; val_kl_reg_loss: 223.1656; val_edge_recon_loss: 115255.1641; val_gene_expr_recon_loss: 136801.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252280.0938; val_optim_loss: 252280.0938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9902; val_auprc_score: 0.9901; val_best_acc_score: 0.8550; val_best_f1_score: 0.8729; train_kl_reg_loss: 248.1358; train_edge_recon_loss: 102347.5195; train_gene_expr_recon_loss: 134666.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237262.3906; train_optim_loss: 237262.3906; val_kl_reg_loss: 308.0087; val_edge_recon_loss: 112795.4375; val_gene_expr_recon_loss: 135330.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248433.4688; val_optim_loss: 248433.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9861; val_auprc_score: 0.9818; val_best_acc_score: 0.8577; val_best_f1_score: 0.8370; train_kl_reg_loss: 341.0580; train_edge_recon_loss: 102723.9219; train_gene_expr_recon_loss: 132526.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235591.3906; train_optim_loss: 235591.3906; val_kl_reg_loss: 431.0493; val_edge_recon_loss: 114555.3438; val_gene_expr_recon_loss: 133763.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248750.2344; val_optim_loss: 248750.2344
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9850; val_auprc_score: 0.9797; val_best_acc_score: 0.8929; val_best_f1_score: 0.8816; train_kl_reg_loss: 468.6345; train_edge_recon_loss: 102276.1289; train_gene_expr_recon_loss: 132663.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235408.1562; train_optim_loss: 235408.1562; val_kl_reg_loss: 508.4990; val_edge_recon_loss: 123297.6250; val_gene_expr_recon_loss: 132394.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256200.6094; val_optim_loss: 256200.6094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9809; val_auprc_score: 0.9756; val_best_acc_score: 0.8821; val_best_f1_score: 0.8681; train_kl_reg_loss: 525.9447; train_edge_recon_loss: 104881.7383; train_gene_expr_recon_loss: 131837.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237245.5781; train_optim_loss: 237245.5781; val_kl_reg_loss: 518.2866; val_edge_recon_loss: 115030.3672; val_gene_expr_recon_loss: 131192.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246740.9375; val_optim_loss: 246740.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9743; val_auprc_score: 0.9733; val_best_acc_score: 0.8752; val_best_f1_score: 0.8609; train_kl_reg_loss: 536.3713; train_edge_recon_loss: 101030.0898; train_gene_expr_recon_loss: 129868.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231435.2812; train_optim_loss: 231435.2812; val_kl_reg_loss: 590.9231; val_edge_recon_loss: 120856.2031; val_gene_expr_recon_loss: 129933.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251381.0625; val_optim_loss: 251381.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9743; val_auprc_score: 0.9722; val_best_acc_score: 0.8840; val_best_f1_score: 0.8719; train_kl_reg_loss: 640.3060; train_edge_recon_loss: 99747.8672; train_gene_expr_recon_loss: 128540.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228928.5078; train_optim_loss: 228928.5078; val_kl_reg_loss: 757.9503; val_edge_recon_loss: 114202.3516; val_gene_expr_recon_loss: 128451.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243411.3750; val_optim_loss: 243411.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9685; val_auprc_score: 0.9679; val_best_acc_score: 0.8760; val_best_f1_score: 0.8634; train_kl_reg_loss: 827.6362; train_edge_recon_loss: 100269.2773; train_gene_expr_recon_loss: 126798.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227895.0156; train_optim_loss: 227895.0156; val_kl_reg_loss: 941.4410; val_edge_recon_loss: 118028.2422; val_gene_expr_recon_loss: 127040.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246010.4688; val_optim_loss: 246010.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9599; val_auprc_score: 0.9572; val_best_acc_score: 0.8610; val_best_f1_score: 0.8613; train_kl_reg_loss: 996.7822; train_edge_recon_loss: 102191.6328; train_gene_expr_recon_loss: 125793.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228981.4844; train_optim_loss: 228981.4844; val_kl_reg_loss: 1063.2074; val_edge_recon_loss: 116125.5625; val_gene_expr_recon_loss: 125829.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243018.3281; val_optim_loss: 243018.3281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9588; val_auprc_score: 0.9570; val_best_acc_score: 0.8590; val_best_f1_score: 0.8719; train_kl_reg_loss: 1126.7659; train_edge_recon_loss: 102899.9805; train_gene_expr_recon_loss: 124870.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228896.9219; train_optim_loss: 228896.9219; val_kl_reg_loss: 1165.5398; val_edge_recon_loss: 103480.1562; val_gene_expr_recon_loss: 124691.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229336.8125; val_optim_loss: 229336.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9537; val_auprc_score: 0.9493; val_best_acc_score: 0.8600; val_best_f1_score: 0.8704; train_kl_reg_loss: 1224.1090; train_edge_recon_loss: 101206.3867; train_gene_expr_recon_loss: 123624.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226055.2500; train_optim_loss: 226055.2500; val_kl_reg_loss: 1235.3486; val_edge_recon_loss: 111574.0703; val_gene_expr_recon_loss: 123732.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 236542.2500; val_optim_loss: 236542.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9435; val_auprc_score: 0.9368; val_best_acc_score: 0.8640; val_best_f1_score: 0.8716; train_kl_reg_loss: 1306.7150; train_edge_recon_loss: 100629.4414; train_gene_expr_recon_loss: 123011.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224947.4375; train_optim_loss: 224947.4375; val_kl_reg_loss: 1287.5302; val_edge_recon_loss: 107338.7812; val_gene_expr_recon_loss: 122990.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231617.1562; val_optim_loss: 231617.1562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9378; val_auprc_score: 0.9318; val_best_acc_score: 0.8538; val_best_f1_score: 0.8594; train_kl_reg_loss: 1375.4133; train_edge_recon_loss: 101990.5977; train_gene_expr_recon_loss: 122056.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225422.6797; train_optim_loss: 225422.6797; val_kl_reg_loss: 1387.2985; val_edge_recon_loss: 104357.3359; val_gene_expr_recon_loss: 122415.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228159.8125; val_optim_loss: 228159.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9345; val_auprc_score: 0.9310; val_best_acc_score: 0.8519; val_best_f1_score: 0.8620; train_kl_reg_loss: 1504.2347; train_edge_recon_loss: 97053.5547; train_gene_expr_recon_loss: 120741.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219298.9766; train_optim_loss: 219298.9766; val_kl_reg_loss: 1577.1354; val_edge_recon_loss: 102065.0078; val_gene_expr_recon_loss: 121781.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225423.5625; val_optim_loss: 225423.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9285; val_auprc_score: 0.9187; val_best_acc_score: 0.8479; val_best_f1_score: 0.8581; train_kl_reg_loss: 1697.0012; train_edge_recon_loss: 97475.4258; train_gene_expr_recon_loss: 119892.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219065.4062; train_optim_loss: 219065.4062; val_kl_reg_loss: 1833.4341; val_edge_recon_loss: 102453.3672; val_gene_expr_recon_loss: 121045.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225332.7500; val_optim_loss: 225332.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9190; val_auprc_score: 0.9144; val_best_acc_score: 0.8331; val_best_f1_score: 0.8461; train_kl_reg_loss: 2004.1868; train_edge_recon_loss: 100286.3594; train_gene_expr_recon_loss: 120519.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222810.1406; train_optim_loss: 222810.1406; val_kl_reg_loss: 2120.6621; val_edge_recon_loss: 102035.8984; val_gene_expr_recon_loss: 120367.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224523.9062; val_optim_loss: 224523.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9171; val_auprc_score: 0.9129; val_best_acc_score: 0.8304; val_best_f1_score: 0.8418; train_kl_reg_loss: 2254.6553; train_edge_recon_loss: 97190.8164; train_gene_expr_recon_loss: 119841.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219286.7656; train_optim_loss: 219286.7656; val_kl_reg_loss: 2349.7563; val_edge_recon_loss: 106506.6484; val_gene_expr_recon_loss: 119728.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228584.7188; val_optim_loss: 228584.7188
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9167; val_auprc_score: 0.9145; val_best_acc_score: 0.8283; val_best_f1_score: 0.8389; train_kl_reg_loss: 2531.3960; train_edge_recon_loss: 93201.9062; train_gene_expr_recon_loss: 117362.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213095.9141; train_optim_loss: 213095.9141; val_kl_reg_loss: 2500.9097; val_edge_recon_loss: 105119.0234; val_gene_expr_recon_loss: 119108.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226728.4844; val_optim_loss: 226728.4844
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9157; val_auprc_score: 0.9140; val_best_acc_score: 0.8252; val_best_f1_score: 0.8352; train_kl_reg_loss: 2669.6055; train_edge_recon_loss: 92954.8633; train_gene_expr_recon_loss: 117487.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213112.3125; train_optim_loss: 213112.3125; val_kl_reg_loss: 2672.9111; val_edge_recon_loss: 101033.8359; val_gene_expr_recon_loss: 118431.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222137.8125; val_optim_loss: 222137.8125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9155; val_auprc_score: 0.9159; val_best_acc_score: 0.8256; val_best_f1_score: 0.8286; train_kl_reg_loss: 2852.5017; train_edge_recon_loss: 95510.4609; train_gene_expr_recon_loss: 118134.9883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216497.9531; train_optim_loss: 216497.9531; val_kl_reg_loss: 2792.2505; val_edge_recon_loss: 101551.7500; val_gene_expr_recon_loss: 117794.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222138.3594; val_optim_loss: 222138.3594
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9105; val_auprc_score: 0.9111; val_best_acc_score: 0.8208; val_best_f1_score: 0.8242; train_kl_reg_loss: 2961.1646; train_edge_recon_loss: 94472.1328; train_gene_expr_recon_loss: 116213.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213646.9219; train_optim_loss: 213646.9219; val_kl_reg_loss: 2840.6030; val_edge_recon_loss: 94094.5156; val_gene_expr_recon_loss: 117363.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214299.0469; val_optim_loss: 214299.0469
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9147; val_auprc_score: 0.9123; val_best_acc_score: 0.8287; val_best_f1_score: 0.8286; train_kl_reg_loss: 3002.8849; train_edge_recon_loss: 95332.8555; train_gene_expr_recon_loss: 115792.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214128.2109; train_optim_loss: 214128.2109; val_kl_reg_loss: 2870.5066; val_edge_recon_loss: 98410.8906; val_gene_expr_recon_loss: 116906.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218188.2812; val_optim_loss: 218188.2812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9136; val_auprc_score: 0.9136; val_best_acc_score: 0.8279; val_best_f1_score: 0.8291; train_kl_reg_loss: 2990.6770; train_edge_recon_loss: 95760.0977; train_gene_expr_recon_loss: 115425.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214175.9375; train_optim_loss: 214175.9375; val_kl_reg_loss: 2868.2397; val_edge_recon_loss: 96587.6875; val_gene_expr_recon_loss: 116448.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215904.4375; val_optim_loss: 215904.4375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9223; val_auprc_score: 0.9273; val_best_acc_score: 0.8346; val_best_f1_score: 0.8366; train_kl_reg_loss: 2980.1527; train_edge_recon_loss: 93693.5625; train_gene_expr_recon_loss: 113993.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210667.4844; train_optim_loss: 210667.4844; val_kl_reg_loss: 2832.6331; val_edge_recon_loss: 98004.6875; val_gene_expr_recon_loss: 116024.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216862.2500; val_optim_loss: 216862.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9191; val_auprc_score: 0.9197; val_best_acc_score: 0.8367; val_best_f1_score: 0.8337; train_kl_reg_loss: 2935.8221; train_edge_recon_loss: 94102.4609; train_gene_expr_recon_loss: 114731.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211770.2656; train_optim_loss: 211770.2656; val_kl_reg_loss: 2794.6724; val_edge_recon_loss: 94976.1016; val_gene_expr_recon_loss: 115982.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213753.1406; val_optim_loss: 213753.1406
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9185; val_auprc_score: 0.9191; val_best_acc_score: 0.8335; val_best_f1_score: 0.8350; train_kl_reg_loss: 2971.5146; train_edge_recon_loss: 94546.9805; train_gene_expr_recon_loss: 114637.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212156.0625; train_optim_loss: 212156.0625; val_kl_reg_loss: 2798.7332; val_edge_recon_loss: 94608.8203; val_gene_expr_recon_loss: 115935.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213343.1562; val_optim_loss: 213343.1562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9214; val_auprc_score: 0.9261; val_best_acc_score: 0.8321; val_best_f1_score: 0.8367; train_kl_reg_loss: 3010.0012; train_edge_recon_loss: 92011.9727; train_gene_expr_recon_loss: 115685.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210707.5781; train_optim_loss: 210707.5781; val_kl_reg_loss: 2789.3040; val_edge_recon_loss: 95111.9141; val_gene_expr_recon_loss: 115897.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213798.5781; val_optim_loss: 213798.5781
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9114; val_auprc_score: 0.9087; val_best_acc_score: 0.8240; val_best_f1_score: 0.8280; train_kl_reg_loss: 2955.3767; train_edge_recon_loss: 90940.8750; train_gene_expr_recon_loss: 115186.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209082.5312; train_optim_loss: 209082.5312; val_kl_reg_loss: 2810.7649; val_edge_recon_loss: 93462.8125; val_gene_expr_recon_loss: 115855.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212129.0312; val_optim_loss: 212129.0312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9132; val_auprc_score: 0.9154; val_best_acc_score: 0.8277; val_best_f1_score: 0.8285; train_kl_reg_loss: 3004.6331; train_edge_recon_loss: 92223.7344; train_gene_expr_recon_loss: 114217.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209446.3125; train_optim_loss: 209446.3125; val_kl_reg_loss: 2812.2329; val_edge_recon_loss: 89272.3828; val_gene_expr_recon_loss: 115809.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207894.2812; val_optim_loss: 207894.2812
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9141; val_auprc_score: 0.9116; val_best_acc_score: 0.8269; val_best_f1_score: 0.8284; train_kl_reg_loss: 2964.6367; train_edge_recon_loss: 95810.8164; train_gene_expr_recon_loss: 114827.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213602.6172; train_optim_loss: 213602.6172; val_kl_reg_loss: 2800.7393; val_edge_recon_loss: 97349.8281; val_gene_expr_recon_loss: 115771.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215921.9688; val_optim_loss: 215921.9688
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9169; val_auprc_score: 0.9176; val_best_acc_score: 0.8313; val_best_f1_score: 0.8326; train_kl_reg_loss: 3002.1050; train_edge_recon_loss: 93194.7695; train_gene_expr_recon_loss: 115019.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211216.4922; train_optim_loss: 211216.4922; val_kl_reg_loss: 2799.5483; val_edge_recon_loss: 98443.4766; val_gene_expr_recon_loss: 115731.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216974.7344; val_optim_loss: 216974.7344
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9228; val_auprc_score: 0.9206; val_best_acc_score: 0.8381; val_best_f1_score: 0.8373; train_kl_reg_loss: 2956.3962; train_edge_recon_loss: 95253.6484; train_gene_expr_recon_loss: 114696.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212906.5234; train_optim_loss: 212906.5234; val_kl_reg_loss: 2792.3618; val_edge_recon_loss: 92419.1016; val_gene_expr_recon_loss: 115694.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210905.8438; val_optim_loss: 210905.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9206; val_auprc_score: 0.9196; val_best_acc_score: 0.8363; val_best_f1_score: 0.8386; train_kl_reg_loss: 3020.8143; train_edge_recon_loss: 93361.6523; train_gene_expr_recon_loss: 113752.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210135.1719; train_optim_loss: 210135.1719; val_kl_reg_loss: 2796.9814; val_edge_recon_loss: 95951.2188; val_gene_expr_recon_loss: 115691.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214439.2500; val_optim_loss: 214439.2500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9194; val_auprc_score: 0.9219; val_best_acc_score: 0.8337; val_best_f1_score: 0.8350; train_kl_reg_loss: 2990.9315; train_edge_recon_loss: 93143.8555; train_gene_expr_recon_loss: 114274.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210409.6875; train_optim_loss: 210409.6875; val_kl_reg_loss: 2802.6777; val_edge_recon_loss: 97107.8203; val_gene_expr_recon_loss: 115687.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215598.3750; val_optim_loss: 215598.3750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9201; val_auprc_score: 0.9231; val_best_acc_score: 0.8369; val_best_f1_score: 0.8361; train_kl_reg_loss: 2987.1487; train_edge_recon_loss: 93368.1055; train_gene_expr_recon_loss: 114150.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210505.3594; train_optim_loss: 210505.3594; val_kl_reg_loss: 2811.2417; val_edge_recon_loss: 99137.9375; val_gene_expr_recon_loss: 115684.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217633.6875; val_optim_loss: 217633.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 33 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9215
Val AUPRC score: 0.9257
Val best accuracy score: 0.8300
Val best F1 score: 0.8347
Val gene expr MSE score: 2.0343
Duration of model training in run 4: 0 hours, 0 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9917; val_auprc_score: 0.9886; val_best_acc_score: 0.9544; val_best_f1_score: 0.9534; train_kl_reg_loss: 59.5862; train_edge_recon_loss: 101121.2344; train_gene_expr_recon_loss: 142280.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243461.6562; train_optim_loss: 243461.6562; val_kl_reg_loss: 94.7225; val_edge_recon_loss: 119020.6641; val_gene_expr_recon_loss: 142354.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261470.2500; val_optim_loss: 261470.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9898; val_best_acc_score: 0.8660; val_best_f1_score: 0.8816; train_kl_reg_loss: 133.3505; train_edge_recon_loss: 99520.5625; train_gene_expr_recon_loss: 140366.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240020.5547; train_optim_loss: 240020.5547; val_kl_reg_loss: 281.7761; val_edge_recon_loss: 119010.2109; val_gene_expr_recon_loss: 140492.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259784.4688; val_optim_loss: 259784.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9894; val_auprc_score: 0.9877; val_best_acc_score: 0.9133; val_best_f1_score: 0.9063; train_kl_reg_loss: 324.6008; train_edge_recon_loss: 103827.8750; train_gene_expr_recon_loss: 138651.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242803.7031; train_optim_loss: 242803.7031; val_kl_reg_loss: 411.6739; val_edge_recon_loss: 117431.5078; val_gene_expr_recon_loss: 138419.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256262.6250; val_optim_loss: 256262.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9869; val_auprc_score: 0.9851; val_best_acc_score: 0.9260; val_best_f1_score: 0.9219; train_kl_reg_loss: 432.7059; train_edge_recon_loss: 102508.9180; train_gene_expr_recon_loss: 136549.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239491.1875; train_optim_loss: 239491.1875; val_kl_reg_loss: 472.8321; val_edge_recon_loss: 117488.4297; val_gene_expr_recon_loss: 136990.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254951.8594; val_optim_loss: 254951.8594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9851; val_auprc_score: 0.9826; val_best_acc_score: 0.9279; val_best_f1_score: 0.9242; train_kl_reg_loss: 496.5258; train_edge_recon_loss: 100546.8281; train_gene_expr_recon_loss: 135138.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236181.6094; train_optim_loss: 236181.6094; val_kl_reg_loss: 565.9900; val_edge_recon_loss: 115363.3672; val_gene_expr_recon_loss: 135386.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251316.0156; val_optim_loss: 251316.0156
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9809; val_auprc_score: 0.9776; val_best_acc_score: 0.9258; val_best_f1_score: 0.9228; train_kl_reg_loss: 619.3326; train_edge_recon_loss: 102318.5820; train_gene_expr_recon_loss: 133627.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236565.0234; train_optim_loss: 236565.0234; val_kl_reg_loss: 766.8000; val_edge_recon_loss: 124822.3516; val_gene_expr_recon_loss: 133568.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259158.0938; val_optim_loss: 259158.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9756; val_auprc_score: 0.9707; val_best_acc_score: 0.9142; val_best_f1_score: 0.9107; train_kl_reg_loss: 839.5500; train_edge_recon_loss: 103086.3086; train_gene_expr_recon_loss: 131959.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235885.5938; train_optim_loss: 235885.5938; val_kl_reg_loss: 984.5640; val_edge_recon_loss: 116233.3906; val_gene_expr_recon_loss: 131988.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249206.5781; val_optim_loss: 249206.5781
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9731; val_auprc_score: 0.9708; val_best_acc_score: 0.9017; val_best_f1_score: 0.8960; train_kl_reg_loss: 1030.9008; train_edge_recon_loss: 101946.2383; train_gene_expr_recon_loss: 130494.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233471.5938; train_optim_loss: 233471.5938; val_kl_reg_loss: 1079.6779; val_edge_recon_loss: 109502.2734; val_gene_expr_recon_loss: 130569.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 241151.1250; val_optim_loss: 241151.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9679; val_auprc_score: 0.9651; val_best_acc_score: 0.8871; val_best_f1_score: 0.8784; train_kl_reg_loss: 1111.2005; train_edge_recon_loss: 102766.2383; train_gene_expr_recon_loss: 129238.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233115.9766; train_optim_loss: 233115.9766; val_kl_reg_loss: 1128.8318; val_edge_recon_loss: 114029.6406; val_gene_expr_recon_loss: 129276.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244434.8125; val_optim_loss: 244434.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9607; val_auprc_score: 0.9578; val_best_acc_score: 0.8667; val_best_f1_score: 0.8739; train_kl_reg_loss: 1170.4009; train_edge_recon_loss: 101819.7109; train_gene_expr_recon_loss: 127720.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230711.0938; train_optim_loss: 230711.0938; val_kl_reg_loss: 1218.9126; val_edge_recon_loss: 116717.2656; val_gene_expr_recon_loss: 127946.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 245883.0469; val_optim_loss: 245883.0469
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9516; val_auprc_score: 0.9458; val_best_acc_score: 0.8632; val_best_f1_score: 0.8744; train_kl_reg_loss: 1270.0476; train_edge_recon_loss: 101426.1602; train_gene_expr_recon_loss: 126537.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229233.6875; train_optim_loss: 229233.6875; val_kl_reg_loss: 1327.1157; val_edge_recon_loss: 112488.7344; val_gene_expr_recon_loss: 126840.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240655.9062; val_optim_loss: 240655.9062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9462; val_auprc_score: 0.9395; val_best_acc_score: 0.8643; val_best_f1_score: 0.8724; train_kl_reg_loss: 1382.2672; train_edge_recon_loss: 101033.9023; train_gene_expr_recon_loss: 125365.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227781.5859; train_optim_loss: 227781.5859; val_kl_reg_loss: 1449.6208; val_edge_recon_loss: 106822.7578; val_gene_expr_recon_loss: 126014.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234286.6719; val_optim_loss: 234286.6719
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9395; val_auprc_score: 0.9328; val_best_acc_score: 0.8578; val_best_f1_score: 0.8634; train_kl_reg_loss: 1516.1833; train_edge_recon_loss: 98481.5625; train_gene_expr_recon_loss: 124694.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224692.7109; train_optim_loss: 224692.7109; val_kl_reg_loss: 1623.9181; val_edge_recon_loss: 103721.9141; val_gene_expr_recon_loss: 125305.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230651.2188; val_optim_loss: 230651.2188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9304; val_auprc_score: 0.9241; val_best_acc_score: 0.8486; val_best_f1_score: 0.8578; train_kl_reg_loss: 1720.9296; train_edge_recon_loss: 98639.4219; train_gene_expr_recon_loss: 123876.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224237.2188; train_optim_loss: 224237.2188; val_kl_reg_loss: 1901.8105; val_edge_recon_loss: 105744.4531; val_gene_expr_recon_loss: 124468.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232114.8125; val_optim_loss: 232114.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9289; val_auprc_score: 0.9237; val_best_acc_score: 0.8458; val_best_f1_score: 0.8533; train_kl_reg_loss: 2026.8992; train_edge_recon_loss: 98282.6914; train_gene_expr_recon_loss: 122900.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223209.7031; train_optim_loss: 223209.7031; val_kl_reg_loss: 2254.1941; val_edge_recon_loss: 104726.6250; val_gene_expr_recon_loss: 123552.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230533.0938; val_optim_loss: 230533.0938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9213; val_auprc_score: 0.9149; val_best_acc_score: 0.8367; val_best_f1_score: 0.8490; train_kl_reg_loss: 2384.5253; train_edge_recon_loss: 98558.9688; train_gene_expr_recon_loss: 122091.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223035.3750; train_optim_loss: 223035.3750; val_kl_reg_loss: 2566.8618; val_edge_recon_loss: 108274.1250; val_gene_expr_recon_loss: 122676.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233517.3438; val_optim_loss: 233517.3438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9206; val_auprc_score: 0.9161; val_best_acc_score: 0.8332; val_best_f1_score: 0.8430; train_kl_reg_loss: 2676.9205; train_edge_recon_loss: 96645.0898; train_gene_expr_recon_loss: 121089.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220411.6875; train_optim_loss: 220411.6875; val_kl_reg_loss: 2795.4424; val_edge_recon_loss: 99471.6562; val_gene_expr_recon_loss: 121888.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224155.4688; val_optim_loss: 224155.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9225; val_auprc_score: 0.9200; val_best_acc_score: 0.8356; val_best_f1_score: 0.8417; train_kl_reg_loss: 2891.0612; train_edge_recon_loss: 95503.1250; train_gene_expr_recon_loss: 120408.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218802.4141; train_optim_loss: 218802.4141; val_kl_reg_loss: 2960.8916; val_edge_recon_loss: 99279.2969; val_gene_expr_recon_loss: 121166.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223407.0000; val_optim_loss: 223407.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9220; val_auprc_score: 0.9189; val_best_acc_score: 0.8318; val_best_f1_score: 0.8420; train_kl_reg_loss: 3020.6270; train_edge_recon_loss: 96345.8984; train_gene_expr_recon_loss: 119797.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219163.8438; train_optim_loss: 219163.8438; val_kl_reg_loss: 3051.1528; val_edge_recon_loss: 100512.4297; val_gene_expr_recon_loss: 120520.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224084.2188; val_optim_loss: 224084.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9192; val_auprc_score: 0.9179; val_best_acc_score: 0.8304; val_best_f1_score: 0.8344; train_kl_reg_loss: 3104.4639; train_edge_recon_loss: 93513.4609; train_gene_expr_recon_loss: 119062.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215680.7109; train_optim_loss: 215680.7109; val_kl_reg_loss: 3109.2893; val_edge_recon_loss: 99288.4922; val_gene_expr_recon_loss: 119905.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222303.2188; val_optim_loss: 222303.2188
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9234; val_auprc_score: 0.9219; val_best_acc_score: 0.8375; val_best_f1_score: 0.8425; train_kl_reg_loss: 3145.5789; train_edge_recon_loss: 96018.2852; train_gene_expr_recon_loss: 118623.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217787.5938; train_optim_loss: 217787.5938; val_kl_reg_loss: 3089.4514; val_edge_recon_loss: 94896.2891; val_gene_expr_recon_loss: 119457.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217443.2812; val_optim_loss: 217443.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9239; val_auprc_score: 0.9203; val_best_acc_score: 0.8382; val_best_f1_score: 0.8431; train_kl_reg_loss: 3127.9283; train_edge_recon_loss: 94224.7578; train_gene_expr_recon_loss: 118172.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215525.4922; train_optim_loss: 215525.4922; val_kl_reg_loss: 3042.4907; val_edge_recon_loss: 91854.3359; val_gene_expr_recon_loss: 119005.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213901.9062; val_optim_loss: 213901.9062
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9304; val_auprc_score: 0.9300; val_best_acc_score: 0.8502; val_best_f1_score: 0.8528; train_kl_reg_loss: 3059.6182; train_edge_recon_loss: 95006.0234; train_gene_expr_recon_loss: 117772.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215837.8906; train_optim_loss: 215837.8906; val_kl_reg_loss: 2979.7356; val_edge_recon_loss: 99308.0859; val_gene_expr_recon_loss: 118573.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220861.5625; val_optim_loss: 220861.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9339; val_auprc_score: 0.9313; val_best_acc_score: 0.8563; val_best_f1_score: 0.8580; train_kl_reg_loss: 3004.7085; train_edge_recon_loss: 93475.1641; train_gene_expr_recon_loss: 117256.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213735.8906; train_optim_loss: 213735.8906; val_kl_reg_loss: 2941.5518; val_edge_recon_loss: 89671.2969; val_gene_expr_recon_loss: 118245.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210857.8594; val_optim_loss: 210857.8594
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9338; val_auprc_score: 0.9338; val_best_acc_score: 0.8511; val_best_f1_score: 0.8556; train_kl_reg_loss: 2981.3259; train_edge_recon_loss: 93621.0195; train_gene_expr_recon_loss: 116837.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213439.6719; train_optim_loss: 213439.6719; val_kl_reg_loss: 2927.8340; val_edge_recon_loss: 87859.0547; val_gene_expr_recon_loss: 117917.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208704.6875; val_optim_loss: 208704.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9364; val_auprc_score: 0.9348; val_best_acc_score: 0.8572; val_best_f1_score: 0.8595; train_kl_reg_loss: 3012.5809; train_edge_recon_loss: 92519.2656; train_gene_expr_recon_loss: 116475.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212007.8125; train_optim_loss: 212007.8125; val_kl_reg_loss: 3046.0364; val_edge_recon_loss: 86177.2344; val_gene_expr_recon_loss: 117514.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206737.7188; val_optim_loss: 206737.7188
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9355; val_auprc_score: 0.9354; val_best_acc_score: 0.8589; val_best_f1_score: 0.8601; train_kl_reg_loss: 3152.3079; train_edge_recon_loss: 92423.3359; train_gene_expr_recon_loss: 116075.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211651.5547; train_optim_loss: 211651.5547; val_kl_reg_loss: 3189.6833; val_edge_recon_loss: 97145.9297; val_gene_expr_recon_loss: 117291.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217627.2812; val_optim_loss: 217627.2812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9384; val_auprc_score: 0.9326; val_best_acc_score: 0.8622; val_best_f1_score: 0.8665; train_kl_reg_loss: 3287.6953; train_edge_recon_loss: 91153.5234; train_gene_expr_recon_loss: 115943.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210384.7500; train_optim_loss: 210384.7500; val_kl_reg_loss: 3323.6128; val_edge_recon_loss: 90896.6094; val_gene_expr_recon_loss: 116898.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211118.6250; val_optim_loss: 211118.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9394; val_auprc_score: 0.9370; val_best_acc_score: 0.8673; val_best_f1_score: 0.8684; train_kl_reg_loss: 3475.3025; train_edge_recon_loss: 89560.5625; train_gene_expr_recon_loss: 115412.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208448.6562; train_optim_loss: 208448.6562; val_kl_reg_loss: 3552.6221; val_edge_recon_loss: 92977.7969; val_gene_expr_recon_loss: 116379.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212909.8125; val_optim_loss: 212909.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9437; val_auprc_score: 0.9402; val_best_acc_score: 0.8742; val_best_f1_score: 0.8768; train_kl_reg_loss: 3628.7959; train_edge_recon_loss: 89750.5703; train_gene_expr_recon_loss: 115180.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208559.9375; train_optim_loss: 208559.9375; val_kl_reg_loss: 3560.0200; val_edge_recon_loss: 90417.5859; val_gene_expr_recon_loss: 116345.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210323.5312; val_optim_loss: 210323.5312
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9444; val_auprc_score: 0.9427; val_best_acc_score: 0.8735; val_best_f1_score: 0.8756; train_kl_reg_loss: 3629.4719; train_edge_recon_loss: 90035.8750; train_gene_expr_recon_loss: 115089.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208754.3594; train_optim_loss: 208754.3594; val_kl_reg_loss: 3525.8496; val_edge_recon_loss: 89512.8203; val_gene_expr_recon_loss: 116319.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209358.2188; val_optim_loss: 209358.2188
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9390; val_auprc_score: 0.9355; val_best_acc_score: 0.8682; val_best_f1_score: 0.8719; train_kl_reg_loss: 3617.7572; train_edge_recon_loss: 88800.3711; train_gene_expr_recon_loss: 114986.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207404.6250; train_optim_loss: 207404.6250; val_kl_reg_loss: 3518.6372; val_edge_recon_loss: 90851.4844; val_gene_expr_recon_loss: 116301.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210671.9688; val_optim_loss: 210671.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 38 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9339
Val AUPRC score: 0.9323
Val best accuracy score: 0.8585
Val best F1 score: 0.8593
Val gene expr MSE score: 2.0318
Duration of model training in run 5: 0 hours, 0 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 32379
Number of validation edges: 3597
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9904; val_auprc_score: 0.9869; val_best_acc_score: 0.9568; val_best_f1_score: 0.9573; train_kl_reg_loss: 65.0183; train_edge_recon_loss: 103320.9883; train_gene_expr_recon_loss: 149433.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 252819.3750; train_optim_loss: 252819.3750; val_kl_reg_loss: 112.6788; val_edge_recon_loss: 120155.1094; val_gene_expr_recon_loss: 146930.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 267198.6562; val_optim_loss: 267198.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9913; val_auprc_score: 0.9876; val_best_acc_score: 0.8586; val_best_f1_score: 0.8523; train_kl_reg_loss: 157.6824; train_edge_recon_loss: 103459.0156; train_gene_expr_recon_loss: 146757.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 250373.9688; train_optim_loss: 250373.9688; val_kl_reg_loss: 285.2788; val_edge_recon_loss: 114429.9531; val_gene_expr_recon_loss: 145174.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259889.5312; val_optim_loss: 259889.5312
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9903; val_auprc_score: 0.9887; val_best_acc_score: 0.8927; val_best_f1_score: 0.8809; train_kl_reg_loss: 292.4514; train_edge_recon_loss: 102130.0078; train_gene_expr_recon_loss: 144958.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 247381.1250; train_optim_loss: 247381.1250; val_kl_reg_loss: 302.6340; val_edge_recon_loss: 120180.2734; val_gene_expr_recon_loss: 143043.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263526.8750; val_optim_loss: 263526.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9899; val_auprc_score: 0.9869; val_best_acc_score: 0.9347; val_best_f1_score: 0.9313; train_kl_reg_loss: 317.3016; train_edge_recon_loss: 103332.7930; train_gene_expr_recon_loss: 142982.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246632.5938; train_optim_loss: 246632.5938; val_kl_reg_loss: 386.0299; val_edge_recon_loss: 114825.2422; val_gene_expr_recon_loss: 141478.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256690.0000; val_optim_loss: 256690.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9879; val_auprc_score: 0.9874; val_best_acc_score: 0.9472; val_best_f1_score: 0.9468; train_kl_reg_loss: 428.7489; train_edge_recon_loss: 100407.4336; train_gene_expr_recon_loss: 141152.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241988.5859; train_optim_loss: 241988.5859; val_kl_reg_loss: 566.6404; val_edge_recon_loss: 118450.2734; val_gene_expr_recon_loss: 139431.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258448.4062; val_optim_loss: 258448.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9861; val_auprc_score: 0.9821; val_best_acc_score: 0.9422; val_best_f1_score: 0.9429; train_kl_reg_loss: 615.9271; train_edge_recon_loss: 101492.7891; train_gene_expr_recon_loss: 138996.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241104.8984; train_optim_loss: 241104.8984; val_kl_reg_loss: 763.5950; val_edge_recon_loss: 119748.5938; val_gene_expr_recon_loss: 137391.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257903.6094; val_optim_loss: 257903.6094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9847; val_auprc_score: 0.9820; val_best_acc_score: 0.9388; val_best_f1_score: 0.9392; train_kl_reg_loss: 814.9680; train_edge_recon_loss: 104395.5586; train_gene_expr_recon_loss: 137375.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242586.5078; train_optim_loss: 242586.5078; val_kl_reg_loss: 934.2310; val_edge_recon_loss: 126925.3672; val_gene_expr_recon_loss: 135678.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263537.6562; val_optim_loss: 263537.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9834; val_auprc_score: 0.9777; val_best_acc_score: 0.9370; val_best_f1_score: 0.9373; train_kl_reg_loss: 944.1196; train_edge_recon_loss: 102424.1133; train_gene_expr_recon_loss: 136030.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239398.5625; train_optim_loss: 239398.5625; val_kl_reg_loss: 940.3596; val_edge_recon_loss: 114625.4141; val_gene_expr_recon_loss: 135512.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251077.9375; val_optim_loss: 251077.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9821; val_auprc_score: 0.9750; val_best_acc_score: 0.9344; val_best_f1_score: 0.9347; train_kl_reg_loss: 947.6942; train_edge_recon_loss: 102158.1914; train_gene_expr_recon_loss: 135802.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238908.2891; train_optim_loss: 238908.2891; val_kl_reg_loss: 939.1063; val_edge_recon_loss: 124508.6797; val_gene_expr_recon_loss: 135341.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260788.8125; val_optim_loss: 260788.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9830; val_auprc_score: 0.9818; val_best_acc_score: 0.9341; val_best_f1_score: 0.9343; train_kl_reg_loss: 945.8376; train_edge_recon_loss: 102697.5547; train_gene_expr_recon_loss: 135900.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239543.6797; train_optim_loss: 239543.6797; val_kl_reg_loss: 934.0743; val_edge_recon_loss: 117921.7344; val_gene_expr_recon_loss: 135166.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254022.4531; val_optim_loss: 254022.4531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9835; val_auprc_score: 0.9789; val_best_acc_score: 0.9337; val_best_f1_score: 0.9338; train_kl_reg_loss: 940.2665; train_edge_recon_loss: 99908.0469; train_gene_expr_recon_loss: 135540.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236388.9219; train_optim_loss: 236388.9219; val_kl_reg_loss: 931.2480; val_edge_recon_loss: 113891.1953; val_gene_expr_recon_loss: 134983.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 249805.6875; val_optim_loss: 249805.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9825; val_auprc_score: 0.9823; val_best_acc_score: 0.9312; val_best_f1_score: 0.9313; train_kl_reg_loss: 936.2175; train_edge_recon_loss: 101545.8633; train_gene_expr_recon_loss: 135275.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237757.9844; train_optim_loss: 237757.9844; val_kl_reg_loss: 930.0083; val_edge_recon_loss: 118138.3828; val_gene_expr_recon_loss: 134787.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253855.4062; val_optim_loss: 253855.4062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9817; val_auprc_score: 0.9790; val_best_acc_score: 0.9315; val_best_f1_score: 0.9315; train_kl_reg_loss: 939.7946; train_edge_recon_loss: 102564.0391; train_gene_expr_recon_loss: 135344.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238848.2266; train_optim_loss: 238848.2266; val_kl_reg_loss: 934.1102; val_edge_recon_loss: 122247.4297; val_gene_expr_recon_loss: 134571.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257753.0312; val_optim_loss: 257753.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9824; val_auprc_score: 0.9790; val_best_acc_score: 0.9295; val_best_f1_score: 0.9297; train_kl_reg_loss: 945.7415; train_edge_recon_loss: 102050.0039; train_gene_expr_recon_loss: 135028.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238024.3828; train_optim_loss: 238024.3828; val_kl_reg_loss: 946.6722; val_edge_recon_loss: 111455.0938; val_gene_expr_recon_loss: 134336.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246738.3594; val_optim_loss: 246738.3594
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9805; val_auprc_score: 0.9737; val_best_acc_score: 0.9320; val_best_f1_score: 0.9321; train_kl_reg_loss: 958.5071; train_edge_recon_loss: 102813.0742; train_gene_expr_recon_loss: 134615.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238387.3594; train_optim_loss: 238387.3594; val_kl_reg_loss: 964.4158; val_edge_recon_loss: 117318.0391; val_gene_expr_recon_loss: 134083.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252365.5938; val_optim_loss: 252365.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9820; val_auprc_score: 0.9800; val_best_acc_score: 0.9291; val_best_f1_score: 0.9293; train_kl_reg_loss: 977.3873; train_edge_recon_loss: 101023.0469; train_gene_expr_recon_loss: 134513.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236514.2656; train_optim_loss: 236514.2656; val_kl_reg_loss: 982.8096; val_edge_recon_loss: 122214.9062; val_gene_expr_recon_loss: 133818.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257016.5469; val_optim_loss: 257016.5469
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9816; val_auprc_score: 0.9772; val_best_acc_score: 0.9292; val_best_f1_score: 0.9294; train_kl_reg_loss: 998.8793; train_edge_recon_loss: 103044.8555; train_gene_expr_recon_loss: 134159.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 238202.8906; train_optim_loss: 238202.8906; val_kl_reg_loss: 1009.5681; val_edge_recon_loss: 116277.5312; val_gene_expr_recon_loss: 133548.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250835.7188; val_optim_loss: 250835.7188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9824; val_auprc_score: 0.9803; val_best_acc_score: 0.9311; val_best_f1_score: 0.9311; train_kl_reg_loss: 1017.9211; train_edge_recon_loss: 102326.5625; train_gene_expr_recon_loss: 133828.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237172.6641; train_optim_loss: 237172.6641; val_kl_reg_loss: 1012.7792; val_edge_recon_loss: 111797.3906; val_gene_expr_recon_loss: 133521.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 246331.7344; val_optim_loss: 246331.7344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9820; val_auprc_score: 0.9812; val_best_acc_score: 0.9288; val_best_f1_score: 0.9290; train_kl_reg_loss: 1020.5926; train_edge_recon_loss: 102722.0664; train_gene_expr_recon_loss: 133917.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237660.3594; train_optim_loss: 237660.3594; val_kl_reg_loss: 1017.3272; val_edge_recon_loss: 121711.9922; val_gene_expr_recon_loss: 133494.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256223.9375; val_optim_loss: 256223.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9813; val_auprc_score: 0.9808; val_best_acc_score: 0.9260; val_best_f1_score: 0.9264; train_kl_reg_loss: 1023.4503; train_edge_recon_loss: 102894.3242; train_gene_expr_recon_loss: 133864.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237782.6406; train_optim_loss: 237782.6406; val_kl_reg_loss: 1018.6696; val_edge_recon_loss: 120057.9375; val_gene_expr_recon_loss: 133467.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254544.3906; val_optim_loss: 254544.3906
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9822; val_auprc_score: 0.9811; val_best_acc_score: 0.9327; val_best_f1_score: 0.9326; train_kl_reg_loss: 1026.4047; train_edge_recon_loss: 102571.1680; train_gene_expr_recon_loss: 133854.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237452.0391; train_optim_loss: 237452.0391; val_kl_reg_loss: 1019.3523; val_edge_recon_loss: 118391.8125; val_gene_expr_recon_loss: 133441.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252852.4375; val_optim_loss: 252852.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9804; val_auprc_score: 0.9783; val_best_acc_score: 0.9242; val_best_f1_score: 0.9248; train_kl_reg_loss: 1027.8624; train_edge_recon_loss: 104342.5664; train_gene_expr_recon_loss: 133693.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239063.5781; train_optim_loss: 239063.5781; val_kl_reg_loss: 1022.0764; val_edge_recon_loss: 117998.1953; val_gene_expr_recon_loss: 133438.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252458.9375; val_optim_loss: 252458.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9803; val_auprc_score: 0.9779; val_best_acc_score: 0.9276; val_best_f1_score: 0.9279; train_kl_reg_loss: 1029.6642; train_edge_recon_loss: 101009.9688; train_gene_expr_recon_loss: 133866.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235906.5078; train_optim_loss: 235906.5078; val_kl_reg_loss: 1023.2688; val_edge_recon_loss: 116474.5781; val_gene_expr_recon_loss: 133436.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250933.8906; val_optim_loss: 250933.8906
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9811; val_auprc_score: 0.9785; val_best_acc_score: 0.9288; val_best_f1_score: 0.9290; train_kl_reg_loss: 1030.0480; train_edge_recon_loss: 102549.8672; train_gene_expr_recon_loss: 133857.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237437.8438; train_optim_loss: 237437.8438; val_kl_reg_loss: 1023.5304; val_edge_recon_loss: 117979.5391; val_gene_expr_recon_loss: 133433.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252436.5000; val_optim_loss: 252436.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9808
Val AUPRC score: 0.9784
Val best accuracy score: 0.9269
Val best F1 score: 0.9272
Val gene expr MSE score: 2.2722
Duration of model training in run 6: 0 hours, 0 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9922; val_auprc_score: 0.9902; val_best_acc_score: 0.9051; val_best_f1_score: 0.9130; train_kl_reg_loss: 88.4304; train_edge_recon_loss: 101857.8906; train_gene_expr_recon_loss: 144135.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246082.1562; train_optim_loss: 246082.1562; val_kl_reg_loss: 191.7470; val_edge_recon_loss: 118175.9453; val_gene_expr_recon_loss: 141570.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259938.2500; val_optim_loss: 259938.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9881; val_auprc_score: 0.9818; val_best_acc_score: 0.9115; val_best_f1_score: 0.9042; train_kl_reg_loss: 230.0778; train_edge_recon_loss: 101717.7734; train_gene_expr_recon_loss: 141280.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243228.6094; train_optim_loss: 243228.6094; val_kl_reg_loss: 268.6330; val_edge_recon_loss: 119988.5234; val_gene_expr_recon_loss: 139311.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259569.0469; val_optim_loss: 259569.0469
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9863; val_auprc_score: 0.9840; val_best_acc_score: 0.9415; val_best_f1_score: 0.9408; train_kl_reg_loss: 334.5989; train_edge_recon_loss: 100858.1068; train_gene_expr_recon_loss: 138782.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239975.0729; train_optim_loss: 239975.0729; val_kl_reg_loss: 482.3828; val_edge_recon_loss: 123295.2031; val_gene_expr_recon_loss: 136768.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260546.0312; val_optim_loss: 260546.0312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9822; val_auprc_score: 0.9813; val_best_acc_score: 0.9320; val_best_f1_score: 0.9317; train_kl_reg_loss: 575.1779; train_edge_recon_loss: 102351.5052; train_gene_expr_recon_loss: 136214.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239140.7500; train_optim_loss: 239140.7500; val_kl_reg_loss: 654.8951; val_edge_recon_loss: 121018.3984; val_gene_expr_recon_loss: 134450.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256123.5625; val_optim_loss: 256123.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9768; val_auprc_score: 0.9755; val_best_acc_score: 0.9209; val_best_f1_score: 0.9181; train_kl_reg_loss: 701.0409; train_edge_recon_loss: 101895.8177; train_gene_expr_recon_loss: 134418.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237015.8073; train_optim_loss: 237015.8073; val_kl_reg_loss: 757.7754; val_edge_recon_loss: 115162.3516; val_gene_expr_recon_loss: 132740.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248660.6094; val_optim_loss: 248660.6094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9704; val_auprc_score: 0.9681; val_best_acc_score: 0.9057; val_best_f1_score: 0.9019; train_kl_reg_loss: 866.3265; train_edge_recon_loss: 103023.4193; train_gene_expr_recon_loss: 132501.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236391.6250; train_optim_loss: 236391.6250; val_kl_reg_loss: 1017.2085; val_edge_recon_loss: 116878.8438; val_gene_expr_recon_loss: 130516.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248413.0156; val_optim_loss: 248413.0156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9637; val_auprc_score: 0.9635; val_best_acc_score: 0.8902; val_best_f1_score: 0.8840; train_kl_reg_loss: 1130.2154; train_edge_recon_loss: 102822.5052; train_gene_expr_recon_loss: 130164.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234117.3438; train_optim_loss: 234117.3438; val_kl_reg_loss: 1214.2756; val_edge_recon_loss: 115399.4453; val_gene_expr_recon_loss: 128289.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244903.0469; val_optim_loss: 244903.0469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9583; val_auprc_score: 0.9535; val_best_acc_score: 0.8682; val_best_f1_score: 0.8710; train_kl_reg_loss: 1276.6621; train_edge_recon_loss: 102357.1536; train_gene_expr_recon_loss: 128152.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231786.3958; train_optim_loss: 231786.3958; val_kl_reg_loss: 1269.3468; val_edge_recon_loss: 104187.6562; val_gene_expr_recon_loss: 126723.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 232180.8281; val_optim_loss: 232180.8281
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9467; val_auprc_score: 0.9449; val_best_acc_score: 0.8559; val_best_f1_score: 0.8661; train_kl_reg_loss: 1343.0415; train_edge_recon_loss: 102036.2865; train_gene_expr_recon_loss: 126614.4193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229993.7500; train_optim_loss: 229993.7500; val_kl_reg_loss: 1400.9617; val_edge_recon_loss: 106479.2891; val_gene_expr_recon_loss: 125457.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 233337.4062; val_optim_loss: 233337.4062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9399; val_auprc_score: 0.9340; val_best_acc_score: 0.8561; val_best_f1_score: 0.8624; train_kl_reg_loss: 1537.1447; train_edge_recon_loss: 99152.8411; train_gene_expr_recon_loss: 125439.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226129.8958; train_optim_loss: 226129.8958; val_kl_reg_loss: 1696.2169; val_edge_recon_loss: 109184.7109; val_gene_expr_recon_loss: 124206.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 235086.9375; val_optim_loss: 235086.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9316; val_auprc_score: 0.9237; val_best_acc_score: 0.8474; val_best_f1_score: 0.8592; train_kl_reg_loss: 1899.3936; train_edge_recon_loss: 98540.9896; train_gene_expr_recon_loss: 124279.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224720.2760; train_optim_loss: 224720.2760; val_kl_reg_loss: 2120.7324; val_edge_recon_loss: 103230.7656; val_gene_expr_recon_loss: 122962.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228314.1250; val_optim_loss: 228314.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9266; val_auprc_score: 0.9170; val_best_acc_score: 0.8452; val_best_f1_score: 0.8539; train_kl_reg_loss: 2347.6891; train_edge_recon_loss: 98125.2812; train_gene_expr_recon_loss: 122717.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 223190.3542; train_optim_loss: 223190.3542; val_kl_reg_loss: 2556.6265; val_edge_recon_loss: 104483.9531; val_gene_expr_recon_loss: 121795.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228836.5312; val_optim_loss: 228836.5312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9252; val_auprc_score: 0.9193; val_best_acc_score: 0.8447; val_best_f1_score: 0.8527; train_kl_reg_loss: 2720.9947; train_edge_recon_loss: 98322.5469; train_gene_expr_recon_loss: 121865.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222909.2708; train_optim_loss: 222909.2708; val_kl_reg_loss: 2783.1533; val_edge_recon_loss: 104234.5078; val_gene_expr_recon_loss: 120799.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227816.7188; val_optim_loss: 227816.7188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9225; val_auprc_score: 0.9142; val_best_acc_score: 0.8387; val_best_f1_score: 0.8468; train_kl_reg_loss: 2917.4098; train_edge_recon_loss: 96891.9036; train_gene_expr_recon_loss: 120459.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220269.0729; train_optim_loss: 220269.0729; val_kl_reg_loss: 2912.2959; val_edge_recon_loss: 104799.7656; val_gene_expr_recon_loss: 119733.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227445.4688; val_optim_loss: 227445.4688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9254; val_auprc_score: 0.9234; val_best_acc_score: 0.8420; val_best_f1_score: 0.8475; train_kl_reg_loss: 2990.0318; train_edge_recon_loss: 96124.8880; train_gene_expr_recon_loss: 119698.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218813.5208; train_optim_loss: 218813.5208; val_kl_reg_loss: 2909.5264; val_edge_recon_loss: 101988.6562; val_gene_expr_recon_loss: 118882.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223781.0625; val_optim_loss: 223781.0625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9323; val_auprc_score: 0.9272; val_best_acc_score: 0.8524; val_best_f1_score: 0.8565; train_kl_reg_loss: 2960.5681; train_edge_recon_loss: 96310.6198; train_gene_expr_recon_loss: 118751.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218022.3021; train_optim_loss: 218022.3021; val_kl_reg_loss: 2877.5325; val_edge_recon_loss: 97886.2266; val_gene_expr_recon_loss: 118164.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218927.7812; val_optim_loss: 218927.7812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9322; val_auprc_score: 0.9311; val_best_acc_score: 0.8485; val_best_f1_score: 0.8543; train_kl_reg_loss: 2943.3281; train_edge_recon_loss: 94193.1562; train_gene_expr_recon_loss: 117889.4661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215025.9479; train_optim_loss: 215025.9479; val_kl_reg_loss: 2874.9170; val_edge_recon_loss: 101165.3281; val_gene_expr_recon_loss: 117534.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221574.3750; val_optim_loss: 221574.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9321; val_auprc_score: 0.9293; val_best_acc_score: 0.8510; val_best_f1_score: 0.8546; train_kl_reg_loss: 2935.5977; train_edge_recon_loss: 95548.0521; train_gene_expr_recon_loss: 117565.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216049.1406; train_optim_loss: 216049.1406; val_kl_reg_loss: 2881.3359; val_edge_recon_loss: 101492.2500; val_gene_expr_recon_loss: 117069.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221443.4062; val_optim_loss: 221443.4062
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9342; val_auprc_score: 0.9318; val_best_acc_score: 0.8579; val_best_f1_score: 0.8564; train_kl_reg_loss: 2966.8774; train_edge_recon_loss: 92485.3828; train_gene_expr_recon_loss: 117069.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212521.8750; train_optim_loss: 212521.8750; val_kl_reg_loss: 3003.9917; val_edge_recon_loss: 94184.6719; val_gene_expr_recon_loss: 116539.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213728.0938; val_optim_loss: 213728.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9368; val_auprc_score: 0.9377; val_best_acc_score: 0.8619; val_best_f1_score: 0.8590; train_kl_reg_loss: 3124.3016; train_edge_recon_loss: 92070.7526; train_gene_expr_recon_loss: 116222.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211417.6875; train_optim_loss: 211417.6875; val_kl_reg_loss: 3197.6130; val_edge_recon_loss: 93148.7344; val_gene_expr_recon_loss: 116039.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212385.4531; val_optim_loss: 212385.4531
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9351; val_auprc_score: 0.9344; val_best_acc_score: 0.8597; val_best_f1_score: 0.8587; train_kl_reg_loss: 3313.0037; train_edge_recon_loss: 92079.7734; train_gene_expr_recon_loss: 115795.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211188.2083; train_optim_loss: 211188.2083; val_kl_reg_loss: 3407.5542; val_edge_recon_loss: 88084.2656; val_gene_expr_recon_loss: 115626.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207118.5000; val_optim_loss: 207118.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9364; val_auprc_score: 0.9358; val_best_acc_score: 0.8596; val_best_f1_score: 0.8634; train_kl_reg_loss: 3520.3042; train_edge_recon_loss: 90566.3854; train_gene_expr_recon_loss: 115116.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209203.4635; train_optim_loss: 209203.4635; val_kl_reg_loss: 3564.4595; val_edge_recon_loss: 89600.8125; val_gene_expr_recon_loss: 115140.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208305.6562; val_optim_loss: 208305.6562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9414; val_auprc_score: 0.9412; val_best_acc_score: 0.8724; val_best_f1_score: 0.8703; train_kl_reg_loss: 3659.8190; train_edge_recon_loss: 90462.0234; train_gene_expr_recon_loss: 114716.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 208838.0781; train_optim_loss: 208838.0781; val_kl_reg_loss: 3702.8608; val_edge_recon_loss: 90567.3750; val_gene_expr_recon_loss: 114517.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208787.8125; val_optim_loss: 208787.8125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9416; val_auprc_score: 0.9417; val_best_acc_score: 0.8698; val_best_f1_score: 0.8687; train_kl_reg_loss: 3794.6052; train_edge_recon_loss: 88941.8021; train_gene_expr_recon_loss: 114113.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206849.9531; train_optim_loss: 206849.9531; val_kl_reg_loss: 3795.3096; val_edge_recon_loss: 90169.9531; val_gene_expr_recon_loss: 113921.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207886.8750; val_optim_loss: 207886.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9443; val_auprc_score: 0.9461; val_best_acc_score: 0.8739; val_best_f1_score: 0.8734; train_kl_reg_loss: 3843.1912; train_edge_recon_loss: 88993.7370; train_gene_expr_recon_loss: 113749.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206586.5729; train_optim_loss: 206586.5729; val_kl_reg_loss: 3781.9617; val_edge_recon_loss: 93826.3750; val_gene_expr_recon_loss: 113820.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 211429.2969; val_optim_loss: 211429.2969
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9470; val_auprc_score: 0.9448; val_best_acc_score: 0.8788; val_best_f1_score: 0.8790; train_kl_reg_loss: 3856.1844; train_edge_recon_loss: 88225.9505; train_gene_expr_recon_loss: 113758.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205841.0365; train_optim_loss: 205841.0365; val_kl_reg_loss: 3761.2917; val_edge_recon_loss: 91439.6094; val_gene_expr_recon_loss: 113712.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208913.6875; val_optim_loss: 208913.6875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9450; val_auprc_score: 0.9412; val_best_acc_score: 0.8772; val_best_f1_score: 0.8776; train_kl_reg_loss: 3863.2080; train_edge_recon_loss: 89300.1458; train_gene_expr_recon_loss: 113389.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206552.5312; train_optim_loss: 206552.5312; val_kl_reg_loss: 3776.5725; val_edge_recon_loss: 88808.2031; val_gene_expr_recon_loss: 113653.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206238.4375; val_optim_loss: 206238.4375
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9455; val_auprc_score: 0.9440; val_best_acc_score: 0.8778; val_best_f1_score: 0.8775; train_kl_reg_loss: 3870.4679; train_edge_recon_loss: 88918.7057; train_gene_expr_recon_loss: 113515.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206304.3958; train_optim_loss: 206304.3958; val_kl_reg_loss: 3766.5186; val_edge_recon_loss: 89226.2734; val_gene_expr_recon_loss: 113620.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206612.8281; val_optim_loss: 206612.8281
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9447; val_auprc_score: 0.9405; val_best_acc_score: 0.8778; val_best_f1_score: 0.8779; train_kl_reg_loss: 3867.9581; train_edge_recon_loss: 88244.8203; train_gene_expr_recon_loss: 113415.5339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205528.3021; train_optim_loss: 205528.3021; val_kl_reg_loss: 3765.1941; val_edge_recon_loss: 90148.3359; val_gene_expr_recon_loss: 113582.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207496.1406; val_optim_loss: 207496.1406
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9453; val_auprc_score: 0.9456; val_best_acc_score: 0.8755; val_best_f1_score: 0.8786; train_kl_reg_loss: 3878.8909; train_edge_recon_loss: 89781.8125; train_gene_expr_recon_loss: 113117.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206778.4375; train_optim_loss: 206778.4375; val_kl_reg_loss: 3778.8940; val_edge_recon_loss: 92564.2969; val_gene_expr_recon_loss: 113522.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209865.5625; val_optim_loss: 209865.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9472; val_auprc_score: 0.9446; val_best_acc_score: 0.8802; val_best_f1_score: 0.8804; train_kl_reg_loss: 3886.2956; train_edge_recon_loss: 86721.1484; train_gene_expr_recon_loss: 113453.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204060.8906; train_optim_loss: 204060.8906; val_kl_reg_loss: 3783.9824; val_edge_recon_loss: 84656.3438; val_gene_expr_recon_loss: 113512.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201953.0938; val_optim_loss: 201953.0938
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9486; val_auprc_score: 0.9487; val_best_acc_score: 0.8802; val_best_f1_score: 0.8821; train_kl_reg_loss: 3895.7440; train_edge_recon_loss: 87590.8385; train_gene_expr_recon_loss: 113486.1432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204972.7240; train_optim_loss: 204972.7240; val_kl_reg_loss: 3773.5981; val_edge_recon_loss: 84766.0234; val_gene_expr_recon_loss: 113500.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202040.3125; val_optim_loss: 202040.3125
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9473; val_auprc_score: 0.9478; val_best_acc_score: 0.8801; val_best_f1_score: 0.8814; train_kl_reg_loss: 3884.4210; train_edge_recon_loss: 87750.5469; train_gene_expr_recon_loss: 113223.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204858.2604; train_optim_loss: 204858.2604; val_kl_reg_loss: 3783.6431; val_edge_recon_loss: 85430.4375; val_gene_expr_recon_loss: 113489.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202703.4531; val_optim_loss: 202703.4531
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9471; val_auprc_score: 0.9484; val_best_acc_score: 0.8771; val_best_f1_score: 0.8773; train_kl_reg_loss: 3886.5053; train_edge_recon_loss: 89348.1615; train_gene_expr_recon_loss: 113235.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 206469.9375; train_optim_loss: 206469.9375; val_kl_reg_loss: 3779.9668; val_edge_recon_loss: 87593.0312; val_gene_expr_recon_loss: 113479.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204852.0469; val_optim_loss: 204852.0469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9475; val_auprc_score: 0.9456; val_best_acc_score: 0.8793; val_best_f1_score: 0.8796; train_kl_reg_loss: 3887.4413; train_edge_recon_loss: 88067.3177; train_gene_expr_recon_loss: 113286.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205241.4948; train_optim_loss: 205241.4948; val_kl_reg_loss: 3776.7954; val_edge_recon_loss: 85040.9297; val_gene_expr_recon_loss: 113478.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202295.8594; val_optim_loss: 202295.8594
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9459; val_auprc_score: 0.9447; val_best_acc_score: 0.8783; val_best_f1_score: 0.8790; train_kl_reg_loss: 3882.9332; train_edge_recon_loss: 88379.5755; train_gene_expr_recon_loss: 113332.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205595.3021; train_optim_loss: 205595.3021; val_kl_reg_loss: 3787.2271; val_edge_recon_loss: 91259.1094; val_gene_expr_recon_loss: 113477.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208523.5312; val_optim_loss: 208523.5312
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9446; val_auprc_score: 0.9446; val_best_acc_score: 0.8773; val_best_f1_score: 0.8794; train_kl_reg_loss: 3886.6038; train_edge_recon_loss: 88169.8568; train_gene_expr_recon_loss: 113339.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205395.6458; train_optim_loss: 205395.6458; val_kl_reg_loss: 3779.8274; val_edge_recon_loss: 92318.6641; val_gene_expr_recon_loss: 113476.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209574.8125; val_optim_loss: 209574.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 58 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9462
Val AUPRC score: 0.9428
Val best accuracy score: 0.8777
Val best F1 score: 0.8785
Val gene expr MSE score: 1.9048
Duration of model training in run 7: 0 hours, 1 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 43113
Number of validation edges: 4790
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9210; val_best_f1_score: 0.9262; train_kl_reg_loss: 71.4658; train_edge_recon_loss: 100749.7057; train_gene_expr_recon_loss: 145884.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246706.0000; train_optim_loss: 246706.0000; val_kl_reg_loss: 163.8437; val_edge_recon_loss: 118012.6172; val_gene_expr_recon_loss: 140901.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259077.5625; val_optim_loss: 259077.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9890; val_auprc_score: 0.9839; val_best_acc_score: 0.9441; val_best_f1_score: 0.9422; train_kl_reg_loss: 257.1963; train_edge_recon_loss: 101602.3542; train_gene_expr_recon_loss: 142739.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244599.0104; train_optim_loss: 244599.0104; val_kl_reg_loss: 392.0811; val_edge_recon_loss: 116042.3203; val_gene_expr_recon_loss: 138147.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 254581.6562; val_optim_loss: 254581.6562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9863; val_auprc_score: 0.9800; val_best_acc_score: 0.9457; val_best_f1_score: 0.9451; train_kl_reg_loss: 429.6516; train_edge_recon_loss: 102255.6771; train_gene_expr_recon_loss: 140255.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242940.5885; train_optim_loss: 242940.5885; val_kl_reg_loss: 499.8936; val_edge_recon_loss: 115683.3125; val_gene_expr_recon_loss: 135795.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 251978.4062; val_optim_loss: 251978.4062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9817; val_auprc_score: 0.9781; val_best_acc_score: 0.9350; val_best_f1_score: 0.9345; train_kl_reg_loss: 568.0278; train_edge_recon_loss: 103148.2917; train_gene_expr_recon_loss: 137587.3490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 241303.6719; train_optim_loss: 241303.6719; val_kl_reg_loss: 719.0685; val_edge_recon_loss: 118709.0547; val_gene_expr_recon_loss: 133245.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252673.7656; val_optim_loss: 252673.7656
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9763; val_auprc_score: 0.9752; val_best_acc_score: 0.9191; val_best_f1_score: 0.9185; train_kl_reg_loss: 837.7728; train_edge_recon_loss: 103982.7318; train_gene_expr_recon_loss: 135097.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239918.4583; train_optim_loss: 239918.4583; val_kl_reg_loss: 1081.3517; val_edge_recon_loss: 123360.4453; val_gene_expr_recon_loss: 130657.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255099.0938; val_optim_loss: 255099.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9726; val_auprc_score: 0.9726; val_best_acc_score: 0.9117; val_best_f1_score: 0.9101; train_kl_reg_loss: 1207.7897; train_edge_recon_loss: 101424.0495; train_gene_expr_recon_loss: 132672.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 235304.3177; train_optim_loss: 235304.3177; val_kl_reg_loss: 1367.4448; val_edge_recon_loss: 114859.7734; val_gene_expr_recon_loss: 128108.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 244335.7812; val_optim_loss: 244335.7812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9648; val_auprc_score: 0.9630; val_best_acc_score: 0.8930; val_best_f1_score: 0.8884; train_kl_reg_loss: 1400.9231; train_edge_recon_loss: 102920.7917; train_gene_expr_recon_loss: 130348.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234669.9167; train_optim_loss: 234669.9167; val_kl_reg_loss: 1419.5925; val_edge_recon_loss: 110905.5234; val_gene_expr_recon_loss: 126185.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238510.2031; val_optim_loss: 238510.2031
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9597; val_auprc_score: 0.9570; val_best_acc_score: 0.8729; val_best_f1_score: 0.8756; train_kl_reg_loss: 1454.7955; train_edge_recon_loss: 101100.7917; train_gene_expr_recon_loss: 128052.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 230607.6615; train_optim_loss: 230607.6615; val_kl_reg_loss: 1544.7834; val_edge_recon_loss: 112518.6797; val_gene_expr_recon_loss: 124589.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238653.1406; val_optim_loss: 238653.1406
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9533; val_auprc_score: 0.9524; val_best_acc_score: 0.8682; val_best_f1_score: 0.8757; train_kl_reg_loss: 1604.6231; train_edge_recon_loss: 100880.4766; train_gene_expr_recon_loss: 126829.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229314.9062; train_optim_loss: 229314.9062; val_kl_reg_loss: 1693.0825; val_edge_recon_loss: 105109.3594; val_gene_expr_recon_loss: 123328.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230130.9375; val_optim_loss: 230130.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9426; val_auprc_score: 0.9379; val_best_acc_score: 0.8634; val_best_f1_score: 0.8687; train_kl_reg_loss: 1782.0398; train_edge_recon_loss: 98301.6146; train_gene_expr_recon_loss: 125127.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225211.5365; train_optim_loss: 225211.5365; val_kl_reg_loss: 1990.4675; val_edge_recon_loss: 97782.6953; val_gene_expr_recon_loss: 122012.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221785.5625; val_optim_loss: 221785.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9351; val_auprc_score: 0.9280; val_best_acc_score: 0.8549; val_best_f1_score: 0.8622; train_kl_reg_loss: 2160.5259; train_edge_recon_loss: 98018.5964; train_gene_expr_recon_loss: 123895.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224074.8802; train_optim_loss: 224074.8802; val_kl_reg_loss: 2472.7048; val_edge_recon_loss: 102516.4141; val_gene_expr_recon_loss: 120608.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225598.0781; val_optim_loss: 225598.0781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9279; val_auprc_score: 0.9249; val_best_acc_score: 0.8436; val_best_f1_score: 0.8536; train_kl_reg_loss: 2600.6719; train_edge_recon_loss: 99417.3151; train_gene_expr_recon_loss: 122503.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224521.0260; train_optim_loss: 224521.0260; val_kl_reg_loss: 2788.4697; val_edge_recon_loss: 104785.7500; val_gene_expr_recon_loss: 119485.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227059.2500; val_optim_loss: 227059.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9280; val_auprc_score: 0.9224; val_best_acc_score: 0.8439; val_best_f1_score: 0.8520; train_kl_reg_loss: 2904.5826; train_edge_recon_loss: 97086.5286; train_gene_expr_recon_loss: 121236.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221227.7812; train_optim_loss: 221227.7812; val_kl_reg_loss: 3012.8989; val_edge_recon_loss: 100504.1562; val_gene_expr_recon_loss: 118388.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221905.4375; val_optim_loss: 221905.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9270; val_auprc_score: 0.9223; val_best_acc_score: 0.8431; val_best_f1_score: 0.8508; train_kl_reg_loss: 3052.9891; train_edge_recon_loss: 95423.2161; train_gene_expr_recon_loss: 120567.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219043.9740; train_optim_loss: 219043.9740; val_kl_reg_loss: 3029.5620; val_edge_recon_loss: 99456.0391; val_gene_expr_recon_loss: 118271.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220757.0469; val_optim_loss: 220757.0469
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9296; val_auprc_score: 0.9249; val_best_acc_score: 0.8474; val_best_f1_score: 0.8533; train_kl_reg_loss: 3050.2281; train_edge_recon_loss: 96943.3672; train_gene_expr_recon_loss: 120338.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220332.0833; train_optim_loss: 220332.0833; val_kl_reg_loss: 3026.6069; val_edge_recon_loss: 99985.5781; val_gene_expr_recon_loss: 118161.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221173.8281; val_optim_loss: 221173.8281
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9266; val_auprc_score: 0.9224; val_best_acc_score: 0.8451; val_best_f1_score: 0.8528; train_kl_reg_loss: 3046.0251; train_edge_recon_loss: 96599.9375; train_gene_expr_recon_loss: 120236.5755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219882.5365; train_optim_loss: 219882.5365; val_kl_reg_loss: 3004.1172; val_edge_recon_loss: 102271.1172; val_gene_expr_recon_loss: 118068.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223343.4375; val_optim_loss: 223343.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9277; val_auprc_score: 0.9229; val_best_acc_score: 0.8441; val_best_f1_score: 0.8516; train_kl_reg_loss: 3024.9272; train_edge_recon_loss: 95263.5234; train_gene_expr_recon_loss: 120328.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218616.5781; train_optim_loss: 218616.5781; val_kl_reg_loss: 2972.4629; val_edge_recon_loss: 97789.2188; val_gene_expr_recon_loss: 117980.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218741.7344; val_optim_loss: 218741.7344
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9301; val_auprc_score: 0.9261; val_best_acc_score: 0.8484; val_best_f1_score: 0.8516; train_kl_reg_loss: 3001.9027; train_edge_recon_loss: 96270.9635; train_gene_expr_recon_loss: 120270.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219542.9896; train_optim_loss: 219542.9896; val_kl_reg_loss: 2948.5659; val_edge_recon_loss: 96501.8672; val_gene_expr_recon_loss: 117896.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217347.3906; val_optim_loss: 217347.3906
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9295; val_auprc_score: 0.9236; val_best_acc_score: 0.8466; val_best_f1_score: 0.8500; train_kl_reg_loss: 2972.9246; train_edge_recon_loss: 96427.7734; train_gene_expr_recon_loss: 120098.9245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219499.6250; train_optim_loss: 219499.6250; val_kl_reg_loss: 2927.6479; val_edge_recon_loss: 96301.9688; val_gene_expr_recon_loss: 117808.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217038.5156; val_optim_loss: 217038.5156
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9287; val_auprc_score: 0.9253; val_best_acc_score: 0.8470; val_best_f1_score: 0.8506; train_kl_reg_loss: 2954.0713; train_edge_recon_loss: 96041.4896; train_gene_expr_recon_loss: 119884.8099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218880.3698; train_optim_loss: 218880.3698; val_kl_reg_loss: 2899.7876; val_edge_recon_loss: 96911.7500; val_gene_expr_recon_loss: 117722.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217534.5156; val_optim_loss: 217534.5156
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9290; val_auprc_score: 0.9217; val_best_acc_score: 0.8471; val_best_f1_score: 0.8515; train_kl_reg_loss: 2927.3571; train_edge_recon_loss: 97111.6354; train_gene_expr_recon_loss: 119766.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219805.7969; train_optim_loss: 219805.7969; val_kl_reg_loss: 2890.8037; val_edge_recon_loss: 101178.3047; val_gene_expr_recon_loss: 117640.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221709.2656; val_optim_loss: 221709.2656
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9304; val_auprc_score: 0.9260; val_best_acc_score: 0.8491; val_best_f1_score: 0.8533; train_kl_reg_loss: 2917.0551; train_edge_recon_loss: 95240.9089; train_gene_expr_recon_loss: 119806.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217964.7500; train_optim_loss: 217964.7500; val_kl_reg_loss: 2863.5503; val_edge_recon_loss: 102309.4062; val_gene_expr_recon_loss: 117563.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222736.6094; val_optim_loss: 222736.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9310; val_auprc_score: 0.9278; val_best_acc_score: 0.8485; val_best_f1_score: 0.8519; train_kl_reg_loss: 2905.4096; train_edge_recon_loss: 93244.4818; train_gene_expr_recon_loss: 119696.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215846.2760; train_optim_loss: 215846.2760; val_kl_reg_loss: 2865.2778; val_edge_recon_loss: 102953.6719; val_gene_expr_recon_loss: 117555.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223374.7500; val_optim_loss: 223374.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9272; val_auprc_score: 0.9213; val_best_acc_score: 0.8446; val_best_f1_score: 0.8504; train_kl_reg_loss: 2911.9557; train_edge_recon_loss: 96656.2865; train_gene_expr_recon_loss: 119723.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219291.2865; train_optim_loss: 219291.2865; val_kl_reg_loss: 2874.3267; val_edge_recon_loss: 99193.2500; val_gene_expr_recon_loss: 117548.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219616.1875; val_optim_loss: 219616.1875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9314; val_auprc_score: 0.9310; val_best_acc_score: 0.8467; val_best_f1_score: 0.8529; train_kl_reg_loss: 2908.4996; train_edge_recon_loss: 94853.7656; train_gene_expr_recon_loss: 119712.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217474.9844; train_optim_loss: 217474.9844; val_kl_reg_loss: 2866.1348; val_edge_recon_loss: 101715.8594; val_gene_expr_recon_loss: 117541.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 222123.5469; val_optim_loss: 222123.5469

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 36 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9325
Val AUPRC score: 0.9299
Val best accuracy score: 0.8520
Val best F1 score: 0.8518
Val gene expr MSE score: 1.8509
Duration of model training in run 8: 0 hours, 0 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9899; val_auprc_score: 0.9855; val_best_acc_score: 0.9192; val_best_f1_score: 0.9130; train_kl_reg_loss: 102.7306; train_edge_recon_loss: 101529.2891; train_gene_expr_recon_loss: 144559.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 246191.5820; train_optim_loss: 246191.5820; val_kl_reg_loss: 254.7926; val_edge_recon_loss: 116724.6094; val_gene_expr_recon_loss: 141415.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258395.1562; val_optim_loss: 258395.1562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9861; val_auprc_score: 0.9823; val_best_acc_score: 0.9486; val_best_f1_score: 0.9478; train_kl_reg_loss: 307.9564; train_edge_recon_loss: 102865.2324; train_gene_expr_recon_loss: 141083.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 244257.1523; train_optim_loss: 244257.1523; val_kl_reg_loss: 445.3003; val_edge_recon_loss: 120542.8594; val_gene_expr_recon_loss: 138061.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259049.7188; val_optim_loss: 259049.7188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9807; val_auprc_score: 0.9767; val_best_acc_score: 0.9366; val_best_f1_score: 0.9363; train_kl_reg_loss: 530.2037; train_edge_recon_loss: 102684.9766; train_gene_expr_recon_loss: 137460.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 240675.5156; train_optim_loss: 240675.5156; val_kl_reg_loss: 655.6757; val_edge_recon_loss: 117752.8984; val_gene_expr_recon_loss: 135188.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253596.8750; val_optim_loss: 253596.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9720; val_auprc_score: 0.9681; val_best_acc_score: 0.9130; val_best_f1_score: 0.9108; train_kl_reg_loss: 725.3865; train_edge_recon_loss: 101085.0938; train_gene_expr_recon_loss: 135664.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237475.2852; train_optim_loss: 237475.2852; val_kl_reg_loss: 880.1729; val_edge_recon_loss: 116987.1953; val_gene_expr_recon_loss: 132629.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250497.2500; val_optim_loss: 250497.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9631; val_auprc_score: 0.9600; val_best_acc_score: 0.8902; val_best_f1_score: 0.8867; train_kl_reg_loss: 1037.1500; train_edge_recon_loss: 100322.8379; train_gene_expr_recon_loss: 132516.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233876.3047; train_optim_loss: 233876.3047; val_kl_reg_loss: 1327.9592; val_edge_recon_loss: 112939.1953; val_gene_expr_recon_loss: 129569.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243836.8125; val_optim_loss: 243836.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9575; val_auprc_score: 0.9569; val_best_acc_score: 0.8661; val_best_f1_score: 0.8722; train_kl_reg_loss: 1395.4062; train_edge_recon_loss: 103144.7246; train_gene_expr_recon_loss: 129435.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233976.1055; train_optim_loss: 233976.1055; val_kl_reg_loss: 1473.6851; val_edge_recon_loss: 108547.6172; val_gene_expr_recon_loss: 127568.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 237589.8750; val_optim_loss: 237589.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9417; val_auprc_score: 0.9377; val_best_acc_score: 0.8560; val_best_f1_score: 0.8649; train_kl_reg_loss: 1551.4826; train_edge_recon_loss: 99518.4336; train_gene_expr_recon_loss: 128249.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229319.2656; train_optim_loss: 229319.2656; val_kl_reg_loss: 1774.6830; val_edge_recon_loss: 106541.9453; val_gene_expr_recon_loss: 126011.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234327.6562; val_optim_loss: 234327.6562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9378; val_auprc_score: 0.9331; val_best_acc_score: 0.8580; val_best_f1_score: 0.8623; train_kl_reg_loss: 1961.8285; train_edge_recon_loss: 98565.9902; train_gene_expr_recon_loss: 126048.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226576.4336; train_optim_loss: 226576.4336; val_kl_reg_loss: 2361.3926; val_edge_recon_loss: 104105.8984; val_gene_expr_recon_loss: 124276.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 230744.1875; val_optim_loss: 230744.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9300; val_auprc_score: 0.9221; val_best_acc_score: 0.8510; val_best_f1_score: 0.8550; train_kl_reg_loss: 2514.4758; train_edge_recon_loss: 98866.2227; train_gene_expr_recon_loss: 124733.2988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226113.9961; train_optim_loss: 226113.9961; val_kl_reg_loss: 2811.8828; val_edge_recon_loss: 104257.7578; val_gene_expr_recon_loss: 122911.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229981.0156; val_optim_loss: 229981.0156
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9332; val_auprc_score: 0.9287; val_best_acc_score: 0.8557; val_best_f1_score: 0.8569; train_kl_reg_loss: 2799.6846; train_edge_recon_loss: 96626.9492; train_gene_expr_recon_loss: 123280.5117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222707.1484; train_optim_loss: 222707.1484; val_kl_reg_loss: 2885.0767; val_edge_recon_loss: 101601.8594; val_gene_expr_recon_loss: 121786.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 226273.8281; val_optim_loss: 226273.8281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9334; val_auprc_score: 0.9278; val_best_acc_score: 0.8548; val_best_f1_score: 0.8589; train_kl_reg_loss: 2847.0641; train_edge_recon_loss: 94656.0352; train_gene_expr_recon_loss: 121832.4258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219335.5234; train_optim_loss: 219335.5234; val_kl_reg_loss: 2992.9995; val_edge_recon_loss: 95779.9375; val_gene_expr_recon_loss: 120526.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219299.4062; val_optim_loss: 219299.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9347; val_auprc_score: 0.9311; val_best_acc_score: 0.8541; val_best_f1_score: 0.8592; train_kl_reg_loss: 2890.6257; train_edge_recon_loss: 96177.2656; train_gene_expr_recon_loss: 121033.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220101.3359; train_optim_loss: 220101.3359; val_kl_reg_loss: 2913.2368; val_edge_recon_loss: 97928.6953; val_gene_expr_recon_loss: 119751.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220593.6875; val_optim_loss: 220593.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9373; val_auprc_score: 0.9361; val_best_acc_score: 0.8595; val_best_f1_score: 0.8588; train_kl_reg_loss: 2854.0032; train_edge_recon_loss: 91773.7109; train_gene_expr_recon_loss: 120041.6543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214669.3750; train_optim_loss: 214669.3750; val_kl_reg_loss: 2986.9883; val_edge_recon_loss: 93864.5234; val_gene_expr_recon_loss: 118957.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215808.5938; val_optim_loss: 215808.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9382; val_auprc_score: 0.9341; val_best_acc_score: 0.8640; val_best_f1_score: 0.8659; train_kl_reg_loss: 3031.9775; train_edge_recon_loss: 93372.0059; train_gene_expr_recon_loss: 119350.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215754.7031; train_optim_loss: 215754.7031; val_kl_reg_loss: 3141.5171; val_edge_recon_loss: 95989.5781; val_gene_expr_recon_loss: 118388.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217519.5000; val_optim_loss: 217519.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9439; val_auprc_score: 0.9429; val_best_acc_score: 0.8724; val_best_f1_score: 0.8733; train_kl_reg_loss: 3142.3151; train_edge_recon_loss: 91748.9629; train_gene_expr_recon_loss: 118329.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213221.2266; train_optim_loss: 213221.2266; val_kl_reg_loss: 3370.2793; val_edge_recon_loss: 88256.5547; val_gene_expr_recon_loss: 117725.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209352.6719; val_optim_loss: 209352.6719
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9423; val_auprc_score: 0.9440; val_best_acc_score: 0.8722; val_best_f1_score: 0.8731; train_kl_reg_loss: 3470.8793; train_edge_recon_loss: 89951.6582; train_gene_expr_recon_loss: 117314.0723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 210736.6094; train_optim_loss: 210736.6094; val_kl_reg_loss: 3895.5068; val_edge_recon_loss: 93310.7500; val_gene_expr_recon_loss: 116694.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213900.5938; val_optim_loss: 213900.5938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9448; val_auprc_score: 0.9468; val_best_acc_score: 0.8747; val_best_f1_score: 0.8749; train_kl_reg_loss: 3915.3225; train_edge_recon_loss: 89896.1543; train_gene_expr_recon_loss: 117192.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211003.9219; train_optim_loss: 211003.9219; val_kl_reg_loss: 4213.1719; val_edge_recon_loss: 90938.4766; val_gene_expr_recon_loss: 115657.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 210808.9062; val_optim_loss: 210808.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9470; val_auprc_score: 0.9450; val_best_acc_score: 0.8795; val_best_f1_score: 0.8789; train_kl_reg_loss: 4179.3762; train_edge_recon_loss: 89821.5312; train_gene_expr_recon_loss: 115479.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209480.6758; train_optim_loss: 209480.6758; val_kl_reg_loss: 4292.9487; val_edge_recon_loss: 87251.8906; val_gene_expr_recon_loss: 114604.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206149.7344; val_optim_loss: 206149.7344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9536; val_auprc_score: 0.9541; val_best_acc_score: 0.8904; val_best_f1_score: 0.8885; train_kl_reg_loss: 4246.6832; train_edge_recon_loss: 88228.0898; train_gene_expr_recon_loss: 114792.9902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207267.7617; train_optim_loss: 207267.7617; val_kl_reg_loss: 4273.2578; val_edge_recon_loss: 87692.5781; val_gene_expr_recon_loss: 113689.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205655.3438; val_optim_loss: 205655.3438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9528; val_auprc_score: 0.9490; val_best_acc_score: 0.8870; val_best_f1_score: 0.8882; train_kl_reg_loss: 4213.7173; train_edge_recon_loss: 87737.9297; train_gene_expr_recon_loss: 113772.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205723.9219; train_optim_loss: 205723.9219; val_kl_reg_loss: 4284.7246; val_edge_recon_loss: 87678.7109; val_gene_expr_recon_loss: 112833.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204796.7188; val_optim_loss: 204796.7188
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9580; val_auprc_score: 0.9554; val_best_acc_score: 0.8976; val_best_f1_score: 0.8974; train_kl_reg_loss: 4287.2620; train_edge_recon_loss: 87128.9629; train_gene_expr_recon_loss: 112959.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204375.4336; train_optim_loss: 204375.4336; val_kl_reg_loss: 4394.6846; val_edge_recon_loss: 88973.2734; val_gene_expr_recon_loss: 111835.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 205203.9062; val_optim_loss: 205203.9062
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9640; val_auprc_score: 0.9620; val_best_acc_score: 0.9037; val_best_f1_score: 0.9044; train_kl_reg_loss: 4257.7181; train_edge_recon_loss: 87250.7070; train_gene_expr_recon_loss: 112253.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 203762.1797; train_optim_loss: 203762.1797; val_kl_reg_loss: 4361.5449; val_edge_recon_loss: 86023.4062; val_gene_expr_recon_loss: 111351.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201736.3438; val_optim_loss: 201736.3438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9657; val_auprc_score: 0.9621; val_best_acc_score: 0.9107; val_best_f1_score: 0.9112; train_kl_reg_loss: 4379.9489; train_edge_recon_loss: 86317.7363; train_gene_expr_recon_loss: 111947.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202645.4648; train_optim_loss: 202645.4648; val_kl_reg_loss: 4580.4756; val_edge_recon_loss: 91328.3594; val_gene_expr_recon_loss: 110586.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206495.5938; val_optim_loss: 206495.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9701; val_auprc_score: 0.9671; val_best_acc_score: 0.9172; val_best_f1_score: 0.9187; train_kl_reg_loss: 4577.0465; train_edge_recon_loss: 86359.4727; train_gene_expr_recon_loss: 111306.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202242.5781; train_optim_loss: 202242.5781; val_kl_reg_loss: 4655.5576; val_edge_recon_loss: 83246.0859; val_gene_expr_recon_loss: 110074.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197976.1250; val_optim_loss: 197976.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9706; val_auprc_score: 0.9674; val_best_acc_score: 0.9178; val_best_f1_score: 0.9190; train_kl_reg_loss: 4591.7256; train_edge_recon_loss: 85529.4043; train_gene_expr_recon_loss: 110755.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200876.7148; train_optim_loss: 200876.7148; val_kl_reg_loss: 4680.5947; val_edge_recon_loss: 86422.6484; val_gene_expr_recon_loss: 109538.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200641.5938; val_optim_loss: 200641.5938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9731; val_auprc_score: 0.9696; val_best_acc_score: 0.9215; val_best_f1_score: 0.9222; train_kl_reg_loss: 4677.5251; train_edge_recon_loss: 85088.6484; train_gene_expr_recon_loss: 109792.2793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199558.4492; train_optim_loss: 199558.4492; val_kl_reg_loss: 4773.6348; val_edge_recon_loss: 82626.5312; val_gene_expr_recon_loss: 108769.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196169.4062; val_optim_loss: 196169.4062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9725; val_auprc_score: 0.9676; val_best_acc_score: 0.9238; val_best_f1_score: 0.9250; train_kl_reg_loss: 4810.6787; train_edge_recon_loss: 84857.3125; train_gene_expr_recon_loss: 109516.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199184.8984; train_optim_loss: 199184.8984; val_kl_reg_loss: 4974.9873; val_edge_recon_loss: 85089.8828; val_gene_expr_recon_loss: 108124.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 198189.6250; val_optim_loss: 198189.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9760; val_auprc_score: 0.9713; val_best_acc_score: 0.9284; val_best_f1_score: 0.9286; train_kl_reg_loss: 4992.6923; train_edge_recon_loss: 84258.3203; train_gene_expr_recon_loss: 109087.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198338.7070; train_optim_loss: 198338.7070; val_kl_reg_loss: 5079.1904; val_edge_recon_loss: 78960.5547; val_gene_expr_recon_loss: 107693.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191733.4531; val_optim_loss: 191733.4531
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9760; val_auprc_score: 0.9696; val_best_acc_score: 0.9299; val_best_f1_score: 0.9307; train_kl_reg_loss: 5094.8994; train_edge_recon_loss: 83375.9453; train_gene_expr_recon_loss: 108413.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196884.3242; train_optim_loss: 196884.3242; val_kl_reg_loss: 5129.1128; val_edge_recon_loss: 82553.7500; val_gene_expr_recon_loss: 107046.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194729.6250; val_optim_loss: 194729.6250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9759; val_auprc_score: 0.9716; val_best_acc_score: 0.9299; val_best_f1_score: 0.9307; train_kl_reg_loss: 5043.7191; train_edge_recon_loss: 83691.1250; train_gene_expr_recon_loss: 108058.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196792.9531; train_optim_loss: 196792.9531; val_kl_reg_loss: 4975.0693; val_edge_recon_loss: 83192.3047; val_gene_expr_recon_loss: 106643.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194810.9375; val_optim_loss: 194810.9375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9770; val_auprc_score: 0.9716; val_best_acc_score: 0.9349; val_best_f1_score: 0.9353; train_kl_reg_loss: 5008.3484; train_edge_recon_loss: 82828.1328; train_gene_expr_recon_loss: 107718.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195555.3633; train_optim_loss: 195555.3633; val_kl_reg_loss: 5066.7554; val_edge_recon_loss: 81217.1094; val_gene_expr_recon_loss: 106197.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 192481.7500; val_optim_loss: 192481.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9774; val_auprc_score: 0.9736; val_best_acc_score: 0.9333; val_best_f1_score: 0.9339; train_kl_reg_loss: 5058.7252; train_edge_recon_loss: 82633.0723; train_gene_expr_recon_loss: 106756.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 194448.0586; train_optim_loss: 194448.0586; val_kl_reg_loss: 5071.2441; val_edge_recon_loss: 81951.1094; val_gene_expr_recon_loss: 106122.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193144.4062; val_optim_loss: 193144.4062
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9754; val_auprc_score: 0.9664; val_best_acc_score: 0.9320; val_best_f1_score: 0.9327; train_kl_reg_loss: 5088.1272; train_edge_recon_loss: 84206.8848; train_gene_expr_recon_loss: 107031.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196326.4453; train_optim_loss: 196326.4453; val_kl_reg_loss: 5066.6104; val_edge_recon_loss: 82190.4688; val_gene_expr_recon_loss: 106051.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 193308.7812; val_optim_loss: 193308.7812
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9762; val_auprc_score: 0.9725; val_best_acc_score: 0.9323; val_best_f1_score: 0.9329; train_kl_reg_loss: 5058.3048; train_edge_recon_loss: 82364.3965; train_gene_expr_recon_loss: 106239.6973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 193662.3984; train_optim_loss: 193662.3984; val_kl_reg_loss: 5053.8096; val_edge_recon_loss: 84093.6250; val_gene_expr_recon_loss: 106039.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195186.7500; val_optim_loss: 195186.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 4 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9757
Val AUPRC score: 0.9698
Val best accuracy score: 0.9284
Val best F1 score: 0.9289
Val gene expr MSE score: 1.6252
Duration of model training in run 9: 0 hours, 1 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cat_covariates_embed_input: 6, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4729
Number of validation nodes: 525
Number of training edges: 53901
Number of validation edges: 5988
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9915; val_auprc_score: 0.9872; val_best_acc_score: 0.9254; val_best_f1_score: 0.9204; train_kl_reg_loss: 112.2438; train_edge_recon_loss: 100744.5645; train_gene_expr_recon_loss: 141899.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 242756.4727; train_optim_loss: 242756.4727; val_kl_reg_loss: 247.7147; val_edge_recon_loss: 117343.2422; val_gene_expr_recon_loss: 139484.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257075.7188; val_optim_loss: 257075.7188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9902; val_auprc_score: 0.9867; val_best_acc_score: 0.9541; val_best_f1_score: 0.9536; train_kl_reg_loss: 281.3358; train_edge_recon_loss: 101480.8047; train_gene_expr_recon_loss: 137857.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 239619.2969; train_optim_loss: 239619.2969; val_kl_reg_loss: 389.9912; val_edge_recon_loss: 116179.0469; val_gene_expr_recon_loss: 136535.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 253104.2188; val_optim_loss: 253104.2188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9861; val_auprc_score: 0.9827; val_best_acc_score: 0.9420; val_best_f1_score: 0.9432; train_kl_reg_loss: 522.8894; train_edge_recon_loss: 102865.9043; train_gene_expr_recon_loss: 134188.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 237577.3555; train_optim_loss: 237577.3555; val_kl_reg_loss: 704.0312; val_edge_recon_loss: 119192.4297; val_gene_expr_recon_loss: 133062.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 252958.6875; val_optim_loss: 252958.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9803; val_auprc_score: 0.9746; val_best_acc_score: 0.9324; val_best_f1_score: 0.9328; train_kl_reg_loss: 775.7297; train_edge_recon_loss: 101296.7598; train_gene_expr_recon_loss: 132039.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234112.2734; train_optim_loss: 234112.2734; val_kl_reg_loss: 971.5477; val_edge_recon_loss: 117455.8438; val_gene_expr_recon_loss: 130395.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 248823.2500; val_optim_loss: 248823.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9748; val_auprc_score: 0.9710; val_best_acc_score: 0.9186; val_best_f1_score: 0.9191; train_kl_reg_loss: 1160.4565; train_edge_recon_loss: 102492.2949; train_gene_expr_recon_loss: 129916.9590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 233569.7070; train_optim_loss: 233569.7070; val_kl_reg_loss: 1445.6025; val_edge_recon_loss: 112136.1406; val_gene_expr_recon_loss: 127060.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240642.6875; val_optim_loss: 240642.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9689; val_auprc_score: 0.9659; val_best_acc_score: 0.9016; val_best_f1_score: 0.8987; train_kl_reg_loss: 1512.8282; train_edge_recon_loss: 103742.3887; train_gene_expr_recon_loss: 126663.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231918.8867; train_optim_loss: 231918.8867; val_kl_reg_loss: 1549.0972; val_edge_recon_loss: 117151.7969; val_gene_expr_recon_loss: 124590.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 243291.3906; val_optim_loss: 243291.3906
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9596; val_auprc_score: 0.9554; val_best_acc_score: 0.8697; val_best_f1_score: 0.8795; train_kl_reg_loss: 1586.1535; train_edge_recon_loss: 102371.0762; train_gene_expr_recon_loss: 124278.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 228235.3203; train_optim_loss: 228235.3203; val_kl_reg_loss: 1669.5083; val_edge_recon_loss: 109742.8906; val_gene_expr_recon_loss: 122761.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234174.0781; val_optim_loss: 234174.0781
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9515; val_auprc_score: 0.9490; val_best_acc_score: 0.8703; val_best_f1_score: 0.8779; train_kl_reg_loss: 1747.0053; train_edge_recon_loss: 101073.8223; train_gene_expr_recon_loss: 122613.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 225433.9062; train_optim_loss: 225433.9062; val_kl_reg_loss: 1974.7441; val_edge_recon_loss: 108712.1953; val_gene_expr_recon_loss: 121203.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231890.1875; val_optim_loss: 231890.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9413; val_auprc_score: 0.9322; val_best_acc_score: 0.8611; val_best_f1_score: 0.8683; train_kl_reg_loss: 2165.5871; train_edge_recon_loss: 97827.0918; train_gene_expr_recon_loss: 120882.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220875.4844; train_optim_loss: 220875.4844; val_kl_reg_loss: 2516.2100; val_edge_recon_loss: 105411.4531; val_gene_expr_recon_loss: 119766.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 227694.3750; val_optim_loss: 227694.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9385; val_auprc_score: 0.9345; val_best_acc_score: 0.8586; val_best_f1_score: 0.8640; train_kl_reg_loss: 2707.9880; train_edge_recon_loss: 97159.9805; train_gene_expr_recon_loss: 119132.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219000.1094; train_optim_loss: 219000.1094; val_kl_reg_loss: 2914.6270; val_edge_recon_loss: 99920.2344; val_gene_expr_recon_loss: 118561.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221396.2031; val_optim_loss: 221396.2031
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9318; val_auprc_score: 0.9271; val_best_acc_score: 0.8530; val_best_f1_score: 0.8585; train_kl_reg_loss: 3036.6799; train_edge_recon_loss: 97319.6133; train_gene_expr_recon_loss: 118443.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218799.3516; train_optim_loss: 218799.3516; val_kl_reg_loss: 3181.2319; val_edge_recon_loss: 100105.5547; val_gene_expr_recon_loss: 117431.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220718.7812; val_optim_loss: 220718.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9365; val_auprc_score: 0.9295; val_best_acc_score: 0.8541; val_best_f1_score: 0.8601; train_kl_reg_loss: 3201.7654; train_edge_recon_loss: 96838.9258; train_gene_expr_recon_loss: 116791.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216832.0859; train_optim_loss: 216832.0859; val_kl_reg_loss: 3177.9805; val_edge_recon_loss: 96581.6094; val_gene_expr_recon_loss: 116626.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216385.9375; val_optim_loss: 216385.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9378; val_auprc_score: 0.9334; val_best_acc_score: 0.8579; val_best_f1_score: 0.8639; train_kl_reg_loss: 3137.0955; train_edge_recon_loss: 96079.3887; train_gene_expr_recon_loss: 115997.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215213.5703; train_optim_loss: 215213.5703; val_kl_reg_loss: 3094.3345; val_edge_recon_loss: 98397.4375; val_gene_expr_recon_loss: 115989.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217481.5938; val_optim_loss: 217481.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9382; val_auprc_score: 0.9352; val_best_acc_score: 0.8615; val_best_f1_score: 0.8661; train_kl_reg_loss: 3110.3904; train_edge_recon_loss: 93911.8301; train_gene_expr_recon_loss: 115253.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212275.9922; train_optim_loss: 212275.9922; val_kl_reg_loss: 3208.1597; val_edge_recon_loss: 93748.9609; val_gene_expr_recon_loss: 115422.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 212379.3125; val_optim_loss: 212379.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9400; val_auprc_score: 0.9370; val_best_acc_score: 0.8672; val_best_f1_score: 0.8680; train_kl_reg_loss: 3245.1301; train_edge_recon_loss: 93744.4727; train_gene_expr_recon_loss: 114980.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 211970.1641; train_optim_loss: 211970.1641; val_kl_reg_loss: 3354.4951; val_edge_recon_loss: 95248.9922; val_gene_expr_recon_loss: 115074.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213678.2344; val_optim_loss: 213678.2344
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9443; val_auprc_score: 0.9428; val_best_acc_score: 0.8737; val_best_f1_score: 0.8756; train_kl_reg_loss: 3438.1348; train_edge_recon_loss: 91229.5645; train_gene_expr_recon_loss: 114586.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 209254.2695; train_optim_loss: 209254.2695; val_kl_reg_loss: 3553.0583; val_edge_recon_loss: 90575.2188; val_gene_expr_recon_loss: 114637.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208766.0938; val_optim_loss: 208766.0938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9456; val_auprc_score: 0.9442; val_best_acc_score: 0.8771; val_best_f1_score: 0.8786; train_kl_reg_loss: 3650.6721; train_edge_recon_loss: 89882.2832; train_gene_expr_recon_loss: 114176.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 207709.5664; train_optim_loss: 207709.5664; val_kl_reg_loss: 3895.6301; val_edge_recon_loss: 89121.3438; val_gene_expr_recon_loss: 113831.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 206848.2188; val_optim_loss: 206848.2188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9477; val_auprc_score: 0.9434; val_best_acc_score: 0.8811; val_best_f1_score: 0.8820; train_kl_reg_loss: 4078.7319; train_edge_recon_loss: 87917.4336; train_gene_expr_recon_loss: 113630.8691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 205627.0352; train_optim_loss: 205627.0352; val_kl_reg_loss: 4240.7017; val_edge_recon_loss: 90837.8516; val_gene_expr_recon_loss: 113003.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 208081.6875; val_optim_loss: 208081.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9533; val_auprc_score: 0.9487; val_best_acc_score: 0.8893; val_best_f1_score: 0.8913; train_kl_reg_loss: 4270.6884; train_edge_recon_loss: 87899.6172; train_gene_expr_recon_loss: 112349.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204520.1211; train_optim_loss: 204520.1211; val_kl_reg_loss: 4279.4248; val_edge_recon_loss: 86094.8281; val_gene_expr_recon_loss: 112283.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 202657.5781; val_optim_loss: 202657.5781
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9566; val_auprc_score: 0.9525; val_best_acc_score: 0.8970; val_best_f1_score: 0.8993; train_kl_reg_loss: 4297.2289; train_edge_recon_loss: 88399.5312; train_gene_expr_recon_loss: 112209.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 204906.4766; train_optim_loss: 204906.4766; val_kl_reg_loss: 4355.2295; val_edge_recon_loss: 91421.1953; val_gene_expr_recon_loss: 111463.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 207240.1562; val_optim_loss: 207240.1562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9627; val_auprc_score: 0.9590; val_best_acc_score: 0.9054; val_best_f1_score: 0.9065; train_kl_reg_loss: 4351.4697; train_edge_recon_loss: 87498.2031; train_gene_expr_recon_loss: 110341.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 202191.6133; train_optim_loss: 202191.6133; val_kl_reg_loss: 4329.1216; val_edge_recon_loss: 89732.3906; val_gene_expr_recon_loss: 110877.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 204938.9844; val_optim_loss: 204938.9844
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9656; val_auprc_score: 0.9566; val_best_acc_score: 0.9102; val_best_f1_score: 0.9120; train_kl_reg_loss: 4287.7361; train_edge_recon_loss: 86460.1074; train_gene_expr_recon_loss: 110336.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 201083.8750; train_optim_loss: 201083.8750; val_kl_reg_loss: 4292.7314; val_edge_recon_loss: 86595.5625; val_gene_expr_recon_loss: 110313.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 201201.8438; val_optim_loss: 201201.8438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9708; val_auprc_score: 0.9644; val_best_acc_score: 0.9224; val_best_f1_score: 0.9233; train_kl_reg_loss: 4318.1445; train_edge_recon_loss: 87119.6445; train_gene_expr_recon_loss: 109231.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 200669.5977; train_optim_loss: 200669.5977; val_kl_reg_loss: 4349.7646; val_edge_recon_loss: 83213.0859; val_gene_expr_recon_loss: 109794.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197357.6562; val_optim_loss: 197357.6562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9731; val_auprc_score: 0.9683; val_best_acc_score: 0.9259; val_best_f1_score: 0.9271; train_kl_reg_loss: 4366.1785; train_edge_recon_loss: 85392.2051; train_gene_expr_recon_loss: 109398.2715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199156.6562; train_optim_loss: 199156.6562; val_kl_reg_loss: 4406.2861; val_edge_recon_loss: 86001.6562; val_gene_expr_recon_loss: 109388.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199796.4062; val_optim_loss: 199796.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9736; val_auprc_score: 0.9678; val_best_acc_score: 0.9279; val_best_f1_score: 0.9287; train_kl_reg_loss: 4486.3391; train_edge_recon_loss: 86942.1992; train_gene_expr_recon_loss: 108081.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 199510.1484; train_optim_loss: 199510.1484; val_kl_reg_loss: 4530.6362; val_edge_recon_loss: 86899.7734; val_gene_expr_recon_loss: 108914.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200344.9375; val_optim_loss: 200344.9375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9742; val_auprc_score: 0.9697; val_best_acc_score: 0.9269; val_best_f1_score: 0.9290; train_kl_reg_loss: 4622.8280; train_edge_recon_loss: 84953.1035; train_gene_expr_recon_loss: 108466.4004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 198042.3320; train_optim_loss: 198042.3320; val_kl_reg_loss: 4732.4365; val_edge_recon_loss: 87646.5000; val_gene_expr_recon_loss: 108267.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 200646.2656; val_optim_loss: 200646.2656

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9740; val_auprc_score: 0.9672; val_best_acc_score: 0.9306; val_best_f1_score: 0.9318; train_kl_reg_loss: 4789.8405; train_edge_recon_loss: 84059.1621; train_gene_expr_recon_loss: 107656.7988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196505.8008; train_optim_loss: 196505.8008; val_kl_reg_loss: 4733.2754; val_edge_recon_loss: 81928.4062; val_gene_expr_recon_loss: 108235.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 194896.7969; val_optim_loss: 194896.7969
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9746; val_auprc_score: 0.9685; val_best_acc_score: 0.9267; val_best_f1_score: 0.9285; train_kl_reg_loss: 4804.0566; train_edge_recon_loss: 84548.2500; train_gene_expr_recon_loss: 107583.8691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196936.1758; train_optim_loss: 196936.1758; val_kl_reg_loss: 4709.7998; val_edge_recon_loss: 82073.0469; val_gene_expr_recon_loss: 108234.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195017.8438; val_optim_loss: 195017.8438
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9761; val_auprc_score: 0.9722; val_best_acc_score: 0.9280; val_best_f1_score: 0.9293; train_kl_reg_loss: 4765.2277; train_edge_recon_loss: 84741.1465; train_gene_expr_recon_loss: 107065.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 196571.5742; train_optim_loss: 196571.5742; val_kl_reg_loss: 4687.7075; val_edge_recon_loss: 85027.3359; val_gene_expr_recon_loss: 108201.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 197917.0312; val_optim_loss: 197917.0312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9759; val_auprc_score: 0.9692; val_best_acc_score: 0.9295; val_best_f1_score: 0.9308; train_kl_reg_loss: 4739.1556; train_edge_recon_loss: 85158.5312; train_gene_expr_recon_loss: 107268.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197165.9141; train_optim_loss: 197165.9141; val_kl_reg_loss: 4657.1729; val_edge_recon_loss: 78831.9141; val_gene_expr_recon_loss: 108128.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191617.6719; val_optim_loss: 191617.6719
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9743; val_auprc_score: 0.9687; val_best_acc_score: 0.9271; val_best_f1_score: 0.9285; train_kl_reg_loss: 4710.7294; train_edge_recon_loss: 84472.1055; train_gene_expr_recon_loss: 107828.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197010.9688; train_optim_loss: 197010.9688; val_kl_reg_loss: 4651.9282; val_edge_recon_loss: 83220.7031; val_gene_expr_recon_loss: 108059.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195932.1719; val_optim_loss: 195932.1719
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9753; val_auprc_score: 0.9693; val_best_acc_score: 0.9295; val_best_f1_score: 0.9310; train_kl_reg_loss: 4734.4564; train_edge_recon_loss: 85709.5000; train_gene_expr_recon_loss: 107502.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197946.7812; train_optim_loss: 197946.7812; val_kl_reg_loss: 4651.1191; val_edge_recon_loss: 82980.3125; val_gene_expr_recon_loss: 108008.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 195640.0625; val_optim_loss: 195640.0625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9755; val_auprc_score: 0.9709; val_best_acc_score: 0.9308; val_best_f1_score: 0.9326; train_kl_reg_loss: 4750.5597; train_edge_recon_loss: 84325.0879; train_gene_expr_recon_loss: 108247.7871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 197323.4297; train_optim_loss: 197323.4297; val_kl_reg_loss: 4656.8457; val_edge_recon_loss: 86820.6172; val_gene_expr_recon_loss: 107977.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199455.1875; val_optim_loss: 199455.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9742; val_auprc_score: 0.9654; val_best_acc_score: 0.9319; val_best_f1_score: 0.9328; train_kl_reg_loss: 4703.0656; train_edge_recon_loss: 83792.5078; train_gene_expr_recon_loss: 107088.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195583.6523; train_optim_loss: 195583.6523; val_kl_reg_loss: 4660.1406; val_edge_recon_loss: 87328.4375; val_gene_expr_recon_loss: 107973.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 199961.8438; val_optim_loss: 199961.8438
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9755; val_auprc_score: 0.9679; val_best_acc_score: 0.9310; val_best_f1_score: 0.9323; train_kl_reg_loss: 4723.3549; train_edge_recon_loss: 83059.8340; train_gene_expr_recon_loss: 107341.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195124.6211; train_optim_loss: 195124.6211; val_kl_reg_loss: 4654.3477; val_edge_recon_loss: 84251.9062; val_gene_expr_recon_loss: 107963.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196869.5625; val_optim_loss: 196869.5625
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9746; val_auprc_score: 0.9684; val_best_acc_score: 0.9314; val_best_f1_score: 0.9324; train_kl_reg_loss: 4738.0619; train_edge_recon_loss: 83748.3633; train_gene_expr_recon_loss: 107252.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 195738.6836; train_optim_loss: 195738.6836; val_kl_reg_loss: 4652.6821; val_edge_recon_loss: 84195.1875; val_gene_expr_recon_loss: 107952.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 196800.3750; val_optim_loss: 196800.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 9 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9764
Val AUPRC score: 0.9703
Val best accuracy score: 0.9301
Val best F1 score: 0.9320
Val gene expr MSE score: 1.7068
Duration of model training in run 10: 0 hours, 1 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
