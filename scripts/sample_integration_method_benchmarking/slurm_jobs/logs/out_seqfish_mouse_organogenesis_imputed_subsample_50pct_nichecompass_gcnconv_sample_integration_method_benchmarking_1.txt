Run timestamp: 26082023_183218_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '2048', '2048', '2048', '2048', '2048', '2048', '2048', '2048', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--filter_genes', '--n_svg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1487, n_latent: 1477, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9384; val_auprc_score: 0.9864; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 1266995.1793; train_edge_recon_loss: 1178265.7897; train_gene_expr_recon_loss: 108218045.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 110663306.5385; train_optim_loss: 110663306.5385; val_kl_reg_loss: 438576.9401; val_edge_recon_loss: 1208090.3125; val_gene_expr_recon_loss: 51533631.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53180298.3333; val_optim_loss: 53180298.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9290; val_auprc_score: 0.9843; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 413417.0246; train_edge_recon_loss: 1194560.9087; train_gene_expr_recon_loss: 48769736.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50377714.5000; train_optim_loss: 50377714.5000; val_kl_reg_loss: 433297.0964; val_edge_recon_loss: 1205404.8333; val_gene_expr_recon_loss: 44259700.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45898402.6667; val_optim_loss: 45898402.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8985; val_auprc_score: 0.9726; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 18617875.8846; train_edge_recon_loss: 1172641.4784; train_gene_expr_recon_loss: 115975201.2692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 135765719.4615; train_optim_loss: 135765719.4615; val_kl_reg_loss: 2132375.1042; val_edge_recon_loss: 1192231.1875; val_gene_expr_recon_loss: 60281531.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63606138.0000; val_optim_loss: 63606138.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9011; val_auprc_score: 0.9742; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 2430537.0577; train_edge_recon_loss: 1191950.8990; train_gene_expr_recon_loss: 79915148.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 83537635.9615; train_optim_loss: 83537635.9615; val_kl_reg_loss: 1950564.9375; val_edge_recon_loss: 1187673.1146; val_gene_expr_recon_loss: 53838581.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56976819.3333; val_optim_loss: 56976819.3333
Run timestamp: 26082023_183432_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--filter_genes', '--n_svg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1487, n_latent: 1477, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9530; val_auprc_score: 0.9892; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 649203.2948; train_edge_recon_loss: 1131205.0048; train_gene_expr_recon_loss: 132203049.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 133983459.0769; train_optim_loss: 133983459.0769; val_kl_reg_loss: 427922.5417; val_edge_recon_loss: 1212373.8333; val_gene_expr_recon_loss: 58325032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59965328.0000; val_optim_loss: 59965328.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9534; val_auprc_score: 0.9893; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 474365.3702; train_edge_recon_loss: 1192862.3942; train_gene_expr_recon_loss: 56063198.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57730426.6154; train_optim_loss: 57730426.6154; val_kl_reg_loss: 477499.1875; val_edge_recon_loss: 1195523.3750; val_gene_expr_recon_loss: 54556970.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56229992.0000; val_optim_loss: 56229992.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8999; val_auprc_score: 0.9734; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 15175126983.7825; train_edge_recon_loss: 1191417.9225; train_gene_expr_recon_loss: 110783721.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15287101918.3462; train_optim_loss: 15287101918.3462; val_kl_reg_loss: 2753130.2083; val_edge_recon_loss: 1184588.7708; val_gene_expr_recon_loss: 54561243.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58498961.3333; val_optim_loss: 58498961.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9532; val_auprc_score: 0.9895; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 469094.8197; train_edge_recon_loss: 1201714.3510; train_gene_expr_recon_loss: 53382230.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55053040.1538; train_optim_loss: 55053040.1538; val_kl_reg_loss: 450370.2083; val_edge_recon_loss: 1185818.0417; val_gene_expr_recon_loss: 52269749.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53905938.6667; val_optim_loss: 53905938.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9038; val_auprc_score: 0.9767; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 1880906.7019; train_edge_recon_loss: 1192005.9567; train_gene_expr_recon_loss: 53790478.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56863391.4231; train_optim_loss: 56863391.4231; val_kl_reg_loss: 1235026.8438; val_edge_recon_loss: 1191484.1354; val_gene_expr_recon_loss: 53325150.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55751661.6667; val_optim_loss: 55751661.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9498; val_auprc_score: 0.9888; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 439839.0337; train_edge_recon_loss: 1193979.1250; train_gene_expr_recon_loss: 50866534.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52500352.9231; train_optim_loss: 52500352.9231; val_kl_reg_loss: 417471.7708; val_edge_recon_loss: 1162455.2083; val_gene_expr_recon_loss: 49403272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50983198.6667; val_optim_loss: 50983198.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9483; val_auprc_score: 0.9882; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 404322.6731; train_edge_recon_loss: 1193792.9519; train_gene_expr_recon_loss: 47787536.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49385652.1538; train_optim_loss: 49385652.1538; val_kl_reg_loss: 380424.0417; val_edge_recon_loss: 1200417.2083; val_gene_expr_recon_loss: 46227538.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47808380.0000; val_optim_loss: 47808380.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8951; val_auprc_score: 0.9733; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 3903802213.8245; train_edge_recon_loss: 1185382.3101; train_gene_expr_recon_loss: 110003587.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4014991167.1923; train_optim_loss: 4014991167.1923; val_kl_reg_loss: 1678239.9062; val_edge_recon_loss: 1196780.0938; val_gene_expr_recon_loss: 54545730.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57420749.6667; val_optim_loss: 57420749.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9455; val_auprc_score: 0.9876; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 13422650.8930; train_edge_recon_loss: 1177180.0120; train_gene_expr_recon_loss: 156214382.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 170814215.6923; train_optim_loss: 170814215.6923; val_kl_reg_loss: 660898.7917; val_edge_recon_loss: 1212100.4583; val_gene_expr_recon_loss: 68006861.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69879861.3333; val_optim_loss: 69879861.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9262; val_auprc_score: 0.9814; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 701511.0036; train_edge_recon_loss: 1184207.7067; train_gene_expr_recon_loss: 69711413.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71597131.8462; train_optim_loss: 71597131.8462; val_kl_reg_loss: 1077400.6667; val_edge_recon_loss: 1202468.8333; val_gene_expr_recon_loss: 48427717.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50707586.6667; val_optim_loss: 50707586.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8504; val_auprc_score: 0.9545; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 15282575959.3101; train_edge_recon_loss: 1190182.1779; train_gene_expr_recon_loss: 159603488.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 15443369892.3462; train_optim_loss: 15443369892.3462; val_kl_reg_loss: 8201250.5833; val_edge_recon_loss: 1179693.6875; val_gene_expr_recon_loss: 59700559.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69081502.6667; val_optim_loss: 69081502.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9193; val_auprc_score: 0.9786; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 1468254.3942; train_edge_recon_loss: 1198965.2115; train_gene_expr_recon_loss: 49362976.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52030195.6923; train_optim_loss: 52030195.6923; val_kl_reg_loss: 1569395.2500; val_edge_recon_loss: 1167998.4167; val_gene_expr_recon_loss: 46838581.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49575974.6667; val_optim_loss: 49575974.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9208; val_auprc_score: 0.9793; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 1447878.7019; train_edge_recon_loss: 1196589.6298; train_gene_expr_recon_loss: 46473115.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49117583.6923; train_optim_loss: 49117583.6923; val_kl_reg_loss: 1274135.9167; val_edge_recon_loss: 1194498.4167; val_gene_expr_recon_loss: 46367966.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48836601.3333; val_optim_loss: 48836601.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8525; val_auprc_score: 0.9540; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 8209613.1971; train_edge_recon_loss: 1192304.2212; train_gene_expr_recon_loss: 57452220.8077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66854138.0769; train_optim_loss: 66854138.0769; val_kl_reg_loss: 7966756.2083; val_edge_recon_loss: 1202650.8438; val_gene_expr_recon_loss: 56498931.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65668338.0000; val_optim_loss: 65668338.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9209; val_auprc_score: 0.9794; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 1271697.7500; train_edge_recon_loss: 1192942.6779; train_gene_expr_recon_loss: 46142740.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48607381.3846; train_optim_loss: 48607381.3846; val_kl_reg_loss: 1246030.9583; val_edge_recon_loss: 1191105.9167; val_gene_expr_recon_loss: 46097882.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48535018.6667; val_optim_loss: 48535018.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9236; val_auprc_score: 0.9804; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 1240805.7019; train_edge_recon_loss: 1192181.7452; train_gene_expr_recon_loss: 46037306.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48470294.1538; train_optim_loss: 48470294.1538; val_kl_reg_loss: 1215976.5833; val_edge_recon_loss: 1193256.2500; val_gene_expr_recon_loss: 46050150.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48459384.0000; val_optim_loss: 48459384.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8533; val_auprc_score: 0.9546; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 7951345.6058; train_edge_recon_loss: 1192507.6779; train_gene_expr_recon_loss: 55970006.1923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65113859.3077; train_optim_loss: 65113859.3077; val_kl_reg_loss: 7705066.8333; val_edge_recon_loss: 1198422.9583; val_gene_expr_recon_loss: 55474846.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64378335.3333; val_optim_loss: 64378335.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9194; val_auprc_score: 0.9789; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1208791.8413; train_edge_recon_loss: 1191636.8365; train_gene_expr_recon_loss: 45980698.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48381126.4615; train_optim_loss: 48381126.4615; val_kl_reg_loss: 1181176.5417; val_edge_recon_loss: 1201039.5000; val_gene_expr_recon_loss: 45994064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48376280.0000; val_optim_loss: 48376280.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9206; val_auprc_score: 0.9793; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 1178109.8029; train_edge_recon_loss: 1199176.2692; train_gene_expr_recon_loss: 45948066.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48325352.7692; train_optim_loss: 48325352.7692; val_kl_reg_loss: 1152437.7500; val_edge_recon_loss: 1199890.9167; val_gene_expr_recon_loss: 45990168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48342497.3333; val_optim_loss: 48342497.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 2 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
val AUROC score: 0.9275
val AUPRC score: 0.9841
val best accuracy score: 0.8527
val best F1 score: 0.9205
val target rna MSE score: 43.2104
val source rna MSE score: 68.9137
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 8 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1487, n_latent: 1477, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9314; val_auprc_score: 0.9856; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 748141.1802; train_edge_recon_loss: 1178405.9790; train_gene_expr_recon_loss: 97246938.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 99173484.6154; train_optim_loss: 99173484.6154; val_kl_reg_loss: 334036.8906; val_edge_recon_loss: 1187608.6354; val_gene_expr_recon_loss: 51899227.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53420873.0000; val_optim_loss: 53420873.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 36 sec.
Using best model state, which was in epoch 5.

--- MODEL EVALUATION ---
val AUROC score: 0.9490
val AUPRC score: 0.9888
val best accuracy score: 0.8583
val best F1 score: 0.9238
val target rna MSE score: 43.4626
val source rna MSE score: 98.2513
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 5 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1487, n_latent: 1477, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9461; val_auprc_score: 0.9883; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 363462.0000; train_edge_recon_loss: 1142327.3173; train_gene_expr_recon_loss: 82963562.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 84469350.7692; train_optim_loss: 84469350.7692; val_kl_reg_loss: 532559.6875; val_edge_recon_loss: 1171398.6667; val_gene_expr_recon_loss: 58004980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59708937.3333; val_optim_loss: 59708937.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9215; val_auprc_score: 0.9835; val_best_acc_score: 0.8487; val_best_f1_score: 0.9181; train_kl_reg_loss: 310309.1764; train_edge_recon_loss: 1185675.3960; train_gene_expr_recon_loss: 47144296.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48640280.5385; train_optim_loss: 48640280.5385; val_kl_reg_loss: 272905.1615; val_edge_recon_loss: 1229211.1875; val_gene_expr_recon_loss: 43273968.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44776084.6667; val_optim_loss: 44776084.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9433; val_auprc_score: 0.9869; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 676427.5481; train_edge_recon_loss: 1195565.2548; train_gene_expr_recon_loss: 56667051.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58539044.1538; train_optim_loss: 58539044.1538; val_kl_reg_loss: 773024.8958; val_edge_recon_loss: 1205710.9167; val_gene_expr_recon_loss: 55167933.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57146668.0000; val_optim_loss: 57146668.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9412; val_auprc_score: 0.9861; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 796480.5048; train_edge_recon_loss: 1198913.6827; train_gene_expr_recon_loss: 54071743.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56067137.3846; train_optim_loss: 56067137.3846; val_kl_reg_loss: 779806.9583; val_edge_recon_loss: 1210965.2500; val_gene_expr_recon_loss: 53096828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55087600.0000; val_optim_loss: 55087600.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9115; val_auprc_score: 0.9813; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 296819.8008; train_edge_recon_loss: 1196996.2428; train_gene_expr_recon_loss: 42802387.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44296203.0000; train_optim_loss: 44296203.0000; val_kl_reg_loss: 299168.2161; val_edge_recon_loss: 1205509.9583; val_gene_expr_recon_loss: 41848850.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43353528.0000; val_optim_loss: 43353528.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9421; val_auprc_score: 0.9870; val_best_acc_score: 0.8559; val_best_f1_score: 0.9223; train_kl_reg_loss: 765243.7476; train_edge_recon_loss: 1198495.7644; train_gene_expr_recon_loss: 51872018.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53835757.8462; train_optim_loss: 53835757.8462; val_kl_reg_loss: 732747.8958; val_edge_recon_loss: 1170565.0417; val_gene_expr_recon_loss: 50616556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52519869.3333; val_optim_loss: 52519869.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9390; val_auprc_score: 0.9862; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 715308.8942; train_edge_recon_loss: 1198553.3221; train_gene_expr_recon_loss: 49102411.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51016273.3846; train_optim_loss: 51016273.3846; val_kl_reg_loss: 680383.9167; val_edge_recon_loss: 1188740.3750; val_gene_expr_recon_loss: 47666197.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49535322.6667; val_optim_loss: 49535322.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8820; val_auprc_score: 0.9656; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 62034656.9992; train_edge_recon_loss: 1184086.2764; train_gene_expr_recon_loss: 109447166.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 172665910.5769; train_optim_loss: 172665910.5769; val_kl_reg_loss: 2125142.3958; val_edge_recon_loss: 1193824.1146; val_gene_expr_recon_loss: 61163129.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64482095.6667; val_optim_loss: 64482095.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9359; val_auprc_score: 0.9851; val_best_acc_score: 0.8502; val_best_f1_score: 0.9191; train_kl_reg_loss: 663331.1466; train_edge_recon_loss: 1201352.8942; train_gene_expr_recon_loss: 46294851.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48159535.5385; train_optim_loss: 48159535.5385; val_kl_reg_loss: 629968.5208; val_edge_recon_loss: 1217783.5833; val_gene_expr_recon_loss: 45149476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46997228.0000; val_optim_loss: 46997228.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9337; val_auprc_score: 0.9853; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 613017.5649; train_edge_recon_loss: 1195517.5288; train_gene_expr_recon_loss: 44209252.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46017787.5385; train_optim_loss: 46017787.5385; val_kl_reg_loss: 580456.3958; val_edge_recon_loss: 1200245.1250; val_gene_expr_recon_loss: 43503897.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45284600.0000; val_optim_loss: 45284600.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8878; val_auprc_score: 0.9694; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 1726630.8630; train_edge_recon_loss: 1202082.6983; train_gene_expr_recon_loss: 54022157.2692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56950870.6538; train_optim_loss: 56950870.6538; val_kl_reg_loss: 1292621.8333; val_edge_recon_loss: 1187100.4375; val_gene_expr_recon_loss: 52009254.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54488977.3333; val_optim_loss: 54488977.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9303; val_auprc_score: 0.9849; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 565794.1562; train_edge_recon_loss: 1191767.0481; train_gene_expr_recon_loss: 42990676.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44748237.3846; train_optim_loss: 44748237.3846; val_kl_reg_loss: 535497.9375; val_edge_recon_loss: 1199295.2083; val_gene_expr_recon_loss: 42681350.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44416144.0000; val_optim_loss: 44416144.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9258; val_auprc_score: 0.9838; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 521407.1154; train_edge_recon_loss: 1196752.1538; train_gene_expr_recon_loss: 42339354.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44057513.0769; train_optim_loss: 44057513.0769; val_kl_reg_loss: 494502.5417; val_edge_recon_loss: 1214943.2500; val_gene_expr_recon_loss: 42200054.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43909500.0000; val_optim_loss: 43909500.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9006; val_auprc_score: 0.9740; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 2188425780.8269; train_edge_recon_loss: 1200192.2692; train_gene_expr_recon_loss: 89651363.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2279277390.9231; train_optim_loss: 2279277390.9231; val_kl_reg_loss: 968409.0833; val_edge_recon_loss: 1199942.9688; val_gene_expr_recon_loss: 61534226.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63702578.3333; val_optim_loss: 63702578.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9240; val_auprc_score: 0.9840; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 480331.7945; train_edge_recon_loss: 1192218.6683; train_gene_expr_recon_loss: 41953164.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43625715.0769; train_optim_loss: 43625715.0769; val_kl_reg_loss: 453076.8958; val_edge_recon_loss: 1198707.7500; val_gene_expr_recon_loss: 41824169.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43475954.6667; val_optim_loss: 43475954.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8971; val_auprc_score: 0.9728; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 1177424.6154; train_edge_recon_loss: 1199714.3846; train_gene_expr_recon_loss: 713562452.3462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 715939591.1538; train_optim_loss: 715939591.1538; val_kl_reg_loss: 829209.5052; val_edge_recon_loss: 1207748.5833; val_gene_expr_recon_loss: 758973722.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 761010682.6667; val_optim_loss: 761010682.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9189; val_auprc_score: 0.9833; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 497368.3377; train_edge_recon_loss: 1175865.3750; train_gene_expr_recon_loss: 58096303.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59769537.3846; train_optim_loss: 59769537.3846; val_kl_reg_loss: 476806.1042; val_edge_recon_loss: 1189386.4583; val_gene_expr_recon_loss: 45348977.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47015169.3333; val_optim_loss: 47015169.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8315; val_auprc_score: 0.9490; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 2256241312.1406; train_edge_recon_loss: 1134277.1442; train_gene_expr_recon_loss: 573386654.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2830762272.7692; train_optim_loss: 2830762272.7692; val_kl_reg_loss: 106013072.0000; val_edge_recon_loss: 1179190.3333; val_gene_expr_recon_loss: 190700592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 297892853.3333; val_optim_loss: 297892853.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8078; val_auprc_score: 0.9403; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 12695987.5282; train_edge_recon_loss: 1189265.7188; train_gene_expr_recon_loss: 483085796.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 496971048.6538; train_optim_loss: 496971048.6538; val_kl_reg_loss: 4351215.7917; val_edge_recon_loss: 1201599.3958; val_gene_expr_recon_loss: 56603886.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62156702.0000; val_optim_loss: 62156702.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7506; val_auprc_score: 0.9223; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 24357521614.7500; train_edge_recon_loss: 1162867.7452; train_gene_expr_recon_loss: 554507195.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 24913191777.2308; train_optim_loss: 24913191777.2308; val_kl_reg_loss: 8640817.3333; val_edge_recon_loss: 1192895.1667; val_gene_expr_recon_loss: 165225274.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 175058986.6667; val_optim_loss: 175058986.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7517; val_auprc_score: 0.9230; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 8656566.6731; train_edge_recon_loss: 1195442.1779; train_gene_expr_recon_loss: 158745058.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 168597067.3846; train_optim_loss: 168597067.3846; val_kl_reg_loss: 7901915.5000; val_edge_recon_loss: 1190638.3750; val_gene_expr_recon_loss: 90660232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 99752786.6667; val_optim_loss: 99752786.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8143; val_auprc_score: 0.9438; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 4381736.0288; train_edge_recon_loss: 1206581.5361; train_gene_expr_recon_loss: 55730767.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61319085.0769; train_optim_loss: 61319085.0769; val_kl_reg_loss: 4314665.7500; val_edge_recon_loss: 1177800.4896; val_gene_expr_recon_loss: 55240398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60732864.3333; val_optim_loss: 60732864.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7533; val_auprc_score: 0.9252; val_best_acc_score: 0.8566; val_best_f1_score: 0.9228; train_kl_reg_loss: 7832100.4808; train_edge_recon_loss: 1202841.8558; train_gene_expr_recon_loss: 90623923.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 99658865.5385; train_optim_loss: 99658865.5385; val_kl_reg_loss: 7672433.3333; val_edge_recon_loss: 1165614.2083; val_gene_expr_recon_loss: 85471973.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 94310021.3333; val_optim_loss: 94310021.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7616; val_auprc_score: 0.9268; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 7611479.9808; train_edge_recon_loss: 1195872.9038; train_gene_expr_recon_loss: 83577264.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 92384616.3077; train_optim_loss: 92384616.3077; val_kl_reg_loss: 7434657.6667; val_edge_recon_loss: 1177562.2917; val_gene_expr_recon_loss: 82318458.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 90930680.0000; val_optim_loss: 90930680.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8121; val_auprc_score: 0.9414; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 4335234.4135; train_edge_recon_loss: 1189305.4712; train_gene_expr_recon_loss: 54923227.0769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60447767.0769; train_optim_loss: 60447767.0769; val_kl_reg_loss: 4264704.5417; val_edge_recon_loss: 1214494.6562; val_gene_expr_recon_loss: 54736920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60216119.6667; val_optim_loss: 60216119.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7662; val_auprc_score: 0.9271; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 7395061.2885; train_edge_recon_loss: 1187392.9135; train_gene_expr_recon_loss: 80843571.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 89426025.8462; train_optim_loss: 89426025.8462; val_kl_reg_loss: 7217015.5000; val_edge_recon_loss: 1195263.0833; val_gene_expr_recon_loss: 79786528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88198808.0000; val_optim_loss: 88198808.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7712; val_auprc_score: 0.9281; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 7192025.0000; train_edge_recon_loss: 1195093.4038; train_gene_expr_recon_loss: 78519360.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86906478.7692; train_optim_loss: 86906478.7692; val_kl_reg_loss: 7022432.5000; val_edge_recon_loss: 1204387.3333; val_gene_expr_recon_loss: 77552578.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 85779397.3333; val_optim_loss: 85779397.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8195; val_auprc_score: 0.9451; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 4277839.1106; train_edge_recon_loss: 1205451.1587; train_gene_expr_recon_loss: 53864415.1154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59347705.3846; train_optim_loss: 59347705.3846; val_kl_reg_loss: 4206084.4583; val_edge_recon_loss: 1192594.0521; val_gene_expr_recon_loss: 53648408.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59047086.6667; val_optim_loss: 59047086.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 58 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
val AUROC score: 0.9244
val AUPRC score: 0.9847
val best accuracy score: 0.8546
val best F1 score: 0.9216
val target rna MSE score: 20.4018
val source rna MSE score: 18.8343
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 7: 0 hours, 8 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9492; val_auprc_score: 0.9887; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 427118.5317; train_edge_recon_loss: 1118008.3719; train_gene_expr_recon_loss: 117637832.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 119182958.6000; train_optim_loss: 119182958.6000; val_kl_reg_loss: 418409.5312; val_edge_recon_loss: 1194571.2083; val_gene_expr_recon_loss: 60651912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62264893.3333; val_optim_loss: 62264893.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 7 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9118
val AUPRC score: 0.9819
val best accuracy score: 0.8556
val best F1 score: 0.9222
val target rna MSE score: 20.1106
val source rna MSE score: 24.0292
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 7: 0 hours, 9 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9375; val_auprc_score: 0.9866; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 614208.7776; train_edge_recon_loss: 1170950.4715; train_gene_expr_recon_loss: 96973406.3797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 98758564.7595; train_optim_loss: 98758564.7595; val_kl_reg_loss: 394653.4688; val_edge_recon_loss: 1198342.4306; val_gene_expr_recon_loss: 50575061.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52168057.3333; val_optim_loss: 52168057.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9498; val_auprc_score: 0.9886; val_best_acc_score: 0.8523; val_best_f1_score: 0.9202; train_kl_reg_loss: 505510.6875; train_edge_recon_loss: 1197112.9750; train_gene_expr_recon_loss: 55831466.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57534089.8000; train_optim_loss: 57534089.8000; val_kl_reg_loss: 541985.9792; val_edge_recon_loss: 1235947.3750; val_gene_expr_recon_loss: 53702853.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55480786.6667; val_optim_loss: 55480786.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9474; val_auprc_score: 0.9878; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 559877.8531; train_edge_recon_loss: 1203948.3875; train_gene_expr_recon_loss: 53037273.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54801099.6000; train_optim_loss: 54801099.6000; val_kl_reg_loss: 547459.6042; val_edge_recon_loss: 1212871.2083; val_gene_expr_recon_loss: 52273312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54033642.6667; val_optim_loss: 54033642.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9302; val_auprc_score: 0.9855; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 373047.4442; train_edge_recon_loss: 1191990.4153; train_gene_expr_recon_loss: 48025450.0253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49590487.8987; train_optim_loss: 49590487.8987; val_kl_reg_loss: 333946.3472; val_edge_recon_loss: 1194643.2361; val_gene_expr_recon_loss: 45043952.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46572542.6667; val_optim_loss: 46572542.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9498; val_auprc_score: 0.9888; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 545917.7906; train_edge_recon_loss: 1195250.0625; train_gene_expr_recon_loss: 51718057.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53459225.4000; train_optim_loss: 53459225.4000; val_kl_reg_loss: 522321.2812; val_edge_recon_loss: 1185325.4583; val_gene_expr_recon_loss: 51094345.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52801992.0000; val_optim_loss: 52801992.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9463; val_auprc_score: 0.9878; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 518753.5297; train_edge_recon_loss: 1196666.6438; train_gene_expr_recon_loss: 50476066.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52191486.8000; train_optim_loss: 52191486.8000; val_kl_reg_loss: 495444.5208; val_edge_recon_loss: 1226398.9167; val_gene_expr_recon_loss: 49765573.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51487417.3333; val_optim_loss: 51487417.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9207; val_auprc_score: 0.9842; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 312934.9691; train_edge_recon_loss: 1194790.6756; train_gene_expr_recon_loss: 42504474.3291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44012200.0506; train_optim_loss: 44012200.0506; val_kl_reg_loss: 274444.6389; val_edge_recon_loss: 1182432.3194; val_gene_expr_recon_loss: 40581524.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42038401.7778; val_optim_loss: 42038401.7778
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9474; val_auprc_score: 0.9881; val_best_acc_score: 0.8497; val_best_f1_score: 0.9187; train_kl_reg_loss: 490327.5781; train_edge_recon_loss: 1193532.2937; train_gene_expr_recon_loss: 48977623.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50661483.8000; train_optim_loss: 50661483.8000; val_kl_reg_loss: 466392.0833; val_edge_recon_loss: 1213661.2917; val_gene_expr_recon_loss: 48117950.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49798002.6667; val_optim_loss: 49798002.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9082; val_auprc_score: 0.9809; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 312523.0123; train_edge_recon_loss: 1191815.2832; train_gene_expr_recon_loss: 40921472.3544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42425810.7342; train_optim_loss: 42425810.7342; val_kl_reg_loss: 264958.3194; val_edge_recon_loss: 1194639.7639; val_gene_expr_recon_loss: 39056180.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40515778.6667; val_optim_loss: 40515778.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9456; val_auprc_score: 0.9886; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 460917.0984; train_edge_recon_loss: 1195177.5562; train_gene_expr_recon_loss: 47226866.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48882960.2000; train_optim_loss: 48882960.2000; val_kl_reg_loss: 437250.5938; val_edge_recon_loss: 1182178.2083; val_gene_expr_recon_loss: 46265096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47884525.3333; val_optim_loss: 47884525.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9410; val_auprc_score: 0.9872; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 431384.8906; train_edge_recon_loss: 1183680.7563; train_gene_expr_recon_loss: 45386968.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47002034.0000; train_optim_loss: 47002034.0000; val_kl_reg_loss: 408719.5312; val_edge_recon_loss: 1203132.5000; val_gene_expr_recon_loss: 44466813.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46078665.3333; val_optim_loss: 46078665.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8922; val_auprc_score: 0.9713; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 4516462.8285; train_edge_recon_loss: 1177849.6772; train_gene_expr_recon_loss: 149323954.3797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 155018267.3418; train_optim_loss: 155018267.3418; val_kl_reg_loss: 1950991.0139; val_edge_recon_loss: 1218253.5833; val_gene_expr_recon_loss: 69341543.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72510788.4444; val_optim_loss: 72510788.4444
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9375; val_auprc_score: 0.9870; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 402340.3875; train_edge_recon_loss: 1201824.3687; train_gene_expr_recon_loss: 43710372.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45314537.0000; train_optim_loss: 45314537.0000; val_kl_reg_loss: 380012.6042; val_edge_recon_loss: 1171816.9167; val_gene_expr_recon_loss: 42989513.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44541342.6667; val_optim_loss: 44541342.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9358; val_auprc_score: 0.9864; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 374203.7641; train_edge_recon_loss: 1189052.1250; train_gene_expr_recon_loss: 42445992.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44009248.2000; train_optim_loss: 44009248.2000; val_kl_reg_loss: 353746.5208; val_edge_recon_loss: 1237803.1250; val_gene_expr_recon_loss: 41957280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43548830.6667; val_optim_loss: 43548830.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8890; val_auprc_score: 0.9715; val_best_acc_score: 0.8492; val_best_f1_score: 0.9185; train_kl_reg_loss: 1892900.6408; train_edge_recon_loss: 1186213.8149; train_gene_expr_recon_loss: 56197192.9114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59276307.4430; train_optim_loss: 59276307.4430; val_kl_reg_loss: 1538853.1528; val_edge_recon_loss: 1224371.7500; val_gene_expr_recon_loss: 52276009.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55039234.6667; val_optim_loss: 55039234.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9326; val_auprc_score: 0.9865; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 348208.6500; train_edge_recon_loss: 1200884.5688; train_gene_expr_recon_loss: 41588126.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43137219.8000; train_optim_loss: 43137219.8000; val_kl_reg_loss: 328735.7292; val_edge_recon_loss: 1228235.4167; val_gene_expr_recon_loss: 41265073.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42822045.3333; val_optim_loss: 42822045.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9283; val_auprc_score: 0.9860; val_best_acc_score: 0.8569; val_best_f1_score: 0.9229; train_kl_reg_loss: 324396.7094; train_edge_recon_loss: 1191186.1187; train_gene_expr_recon_loss: 41036903.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42552486.2000; train_optim_loss: 42552486.2000; val_kl_reg_loss: 319499.8229; val_edge_recon_loss: 1178510.0417; val_gene_expr_recon_loss: 40833677.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42331686.6667; val_optim_loss: 42331686.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8958; val_auprc_score: 0.9752; val_best_acc_score: 0.8476; val_best_f1_score: 0.9175; train_kl_reg_loss: 1279944.9976; train_edge_recon_loss: 1194572.0744; train_gene_expr_recon_loss: 51871463.9494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54345981.0127; train_optim_loss: 54345981.0127; val_kl_reg_loss: 1013472.6458; val_edge_recon_loss: 1235311.4306; val_gene_expr_recon_loss: 51551931.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53800715.5556; val_optim_loss: 53800715.5556
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9278; val_auprc_score: 0.9861; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 389699.1078; train_edge_recon_loss: 1184692.1250; train_gene_expr_recon_loss: 40690177.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42264569.2000; train_optim_loss: 42264569.2000; val_kl_reg_loss: 285369.6458; val_edge_recon_loss: 1151637.5000; val_gene_expr_recon_loss: 40564880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42001888.0000; val_optim_loss: 42001888.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8941; val_auprc_score: 0.9731; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 13862796.2310; train_edge_recon_loss: 1183055.9383; train_gene_expr_recon_loss: 109231501.6203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 124277354.0253; train_optim_loss: 124277354.0253; val_kl_reg_loss: 1647657.5417; val_edge_recon_loss: 1204201.8333; val_gene_expr_recon_loss: 63457552.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66309411.5556; val_optim_loss: 66309411.5556
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9248; val_auprc_score: 0.9845; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 291810.4734; train_edge_recon_loss: 1188893.5375; train_gene_expr_recon_loss: 41325096.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42805801.0000; train_optim_loss: 42805801.0000; val_kl_reg_loss: 295615.6458; val_edge_recon_loss: 1200389.0833; val_gene_expr_recon_loss: 40855129.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42351133.3333; val_optim_loss: 42351133.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9242; val_auprc_score: 0.9846; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 321870.9125; train_edge_recon_loss: 1201137.0063; train_gene_expr_recon_loss: 40436309.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41959318.0000; train_optim_loss: 41959318.0000; val_kl_reg_loss: 318438.2292; val_edge_recon_loss: 1163598.0000; val_gene_expr_recon_loss: 40252784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41734820.0000; val_optim_loss: 41734820.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8939; val_auprc_score: 0.9729; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 1571378.2057; train_edge_recon_loss: 1205614.5854; train_gene_expr_recon_loss: 56043002.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58819995.7468; train_optim_loss: 58819995.7468; val_kl_reg_loss: 1461920.9306; val_edge_recon_loss: 1212939.8611; val_gene_expr_recon_loss: 54069928.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56744788.8889; val_optim_loss: 56744788.8889
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9181; val_auprc_score: 0.9839; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 318393.9813; train_edge_recon_loss: 1185943.6500; train_gene_expr_recon_loss: 40145283.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41649621.8000; train_optim_loss: 41649621.8000; val_kl_reg_loss: 291634.0000; val_edge_recon_loss: 1162820.7500; val_gene_expr_recon_loss: 40052733.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41507189.3333; val_optim_loss: 41507189.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9223; val_auprc_score: 0.9830; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 45013782.2109; train_edge_recon_loss: 1160672.8344; train_gene_expr_recon_loss: 266256749.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 312431196.2000; train_optim_loss: 312431196.2000; val_kl_reg_loss: 2151867264.0000; val_edge_recon_loss: 1197754.8750; val_gene_expr_recon_loss: 134981114.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2288046080.0000; val_optim_loss: 2288046080.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8950; val_auprc_score: 0.9739; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 1435279.7627; train_edge_recon_loss: 1196010.1582; train_gene_expr_recon_loss: 53606769.2658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56238059.3418; train_optim_loss: 56238059.3418; val_kl_reg_loss: 1365536.9167; val_edge_recon_loss: 1207693.3194; val_gene_expr_recon_loss: 53332097.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55905327.5556; val_optim_loss: 55905327.5556
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8638; val_auprc_score: 0.9576; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 36287816913.4875; train_edge_recon_loss: 1149645.4500; train_gene_expr_recon_loss: 542871302.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36831839133.2000; train_optim_loss: 36831839133.2000; val_kl_reg_loss: 3225108.5000; val_edge_recon_loss: 1218530.5000; val_gene_expr_recon_loss: 89923554.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 94367194.6667; val_optim_loss: 94367194.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7897; val_auprc_score: 0.9325; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 50546885411.4625; train_edge_recon_loss: 1171950.8313; train_gene_expr_recon_loss: 330565250.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50878622993.2000; train_optim_loss: 50878622993.2000; val_kl_reg_loss: 6747787.1667; val_edge_recon_loss: 1237966.1250; val_gene_expr_recon_loss: 91364981.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 99350736.0000; val_optim_loss: 99350736.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8987; val_auprc_score: 0.9754; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 1350870.5427; train_edge_recon_loss: 1201395.5886; train_gene_expr_recon_loss: 53147446.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55699713.2152; train_optim_loss: 55699713.2152; val_kl_reg_loss: 1296235.6111; val_edge_recon_loss: 1194431.3194; val_gene_expr_recon_loss: 53082307.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55572974.2222; val_optim_loss: 55572974.2222
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8074; val_auprc_score: 0.9391; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 6561141.6500; train_edge_recon_loss: 1198192.9000; train_gene_expr_recon_loss: 71999906.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79759240.0000; train_optim_loss: 79759240.0000; val_kl_reg_loss: 6048587.1667; val_edge_recon_loss: 1190632.0833; val_gene_expr_recon_loss: 62571236.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69810456.0000; val_optim_loss: 69810456.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8954; val_auprc_score: 0.9736; val_best_acc_score: 0.8492; val_best_f1_score: 0.9184; train_kl_reg_loss: 1279154.0380; train_edge_recon_loss: 1206867.4130; train_gene_expr_recon_loss: 52953899.1899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55439920.6076; train_optim_loss: 55439920.6076; val_kl_reg_loss: 1225991.8472; val_edge_recon_loss: 1224056.8472; val_gene_expr_recon_loss: 52885609.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55335658.2222; val_optim_loss: 55335658.2222

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8000; val_auprc_score: 0.9377; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 6110454.8750; train_edge_recon_loss: 1208349.4812; train_gene_expr_recon_loss: 61884312.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69203117.2000; train_optim_loss: 69203117.2000; val_kl_reg_loss: 5963447.6667; val_edge_recon_loss: 1157779.8750; val_gene_expr_recon_loss: 61288802.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68410029.3333; val_optim_loss: 68410029.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8024; val_auprc_score: 0.9371; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 6030542.2000; train_edge_recon_loss: 1208634.3438; train_gene_expr_recon_loss: 61001485.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68240660.8000; train_optim_loss: 68240660.8000; val_kl_reg_loss: 5887050.0000; val_edge_recon_loss: 1241975.7083; val_gene_expr_recon_loss: 60651893.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67780920.0000; val_optim_loss: 67780920.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8063; val_auprc_score: 0.9406; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 5947662.1500; train_edge_recon_loss: 1196929.5312; train_gene_expr_recon_loss: 60509320.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67653911.2000; train_optim_loss: 67653911.2000; val_kl_reg_loss: 5813300.8333; val_edge_recon_loss: 1159259.9583; val_gene_expr_recon_loss: 60255622.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67228184.0000; val_optim_loss: 67228184.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8120; val_auprc_score: 0.9415; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 5877874.7750; train_edge_recon_loss: 1209211.0000; train_gene_expr_recon_loss: 60207820.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67294906.2000; train_optim_loss: 67294906.2000; val_kl_reg_loss: 5731478.8333; val_edge_recon_loss: 1173748.8333; val_gene_expr_recon_loss: 60035600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66940828.0000; val_optim_loss: 66940828.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 17 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9072
val AUPRC score: 0.9805
val best accuracy score: 0.8517
val best F1 score: 0.9199
val target rna MSE score: 28.7761
val source rna MSE score: 62.6256
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 0 hours, 7 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9372; val_auprc_score: 0.9865; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 415489.9154; train_edge_recon_loss: 1177419.9399; train_gene_expr_recon_loss: 74943005.3671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 76535914.9367; train_optim_loss: 76535914.9367; val_kl_reg_loss: 404718.6493; val_edge_recon_loss: 1172614.1250; val_gene_expr_recon_loss: 50736130.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52313463.5556; val_optim_loss: 52313463.5556
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9318; val_auprc_score: 0.9856; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 375438.1428; train_edge_recon_loss: 1200442.2326; train_gene_expr_recon_loss: 45853712.0506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47429592.5063; train_optim_loss: 47429592.5063; val_kl_reg_loss: 338371.0521; val_edge_recon_loss: 1190411.0278; val_gene_expr_recon_loss: 41763352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43292133.7778; val_optim_loss: 43292133.7778

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 18 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9189
val AUPRC score: 0.9831
val best accuracy score: 0.8501
val best F1 score: 0.9190
val target rna MSE score: 18.4209
val source rna MSE score: 14.3174
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 0 hours, 8 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9502; val_auprc_score: 0.9893; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 331247.9243; train_edge_recon_loss: 1117796.9500; train_gene_expr_recon_loss: 102174760.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103623804.6000; train_optim_loss: 103623804.6000; val_kl_reg_loss: 392644.0938; val_edge_recon_loss: 1224388.3333; val_gene_expr_recon_loss: 57029962.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58646994.6667; val_optim_loss: 58646994.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9182; val_auprc_score: 0.9832; val_best_acc_score: 0.8502; val_best_f1_score: 0.9191; train_kl_reg_loss: 332501.2921; train_edge_recon_loss: 1188155.8339; train_gene_expr_recon_loss: 40723914.5823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42244571.6456; train_optim_loss: 42244571.6456; val_kl_reg_loss: 255292.9705; val_edge_recon_loss: 1215262.1528; val_gene_expr_recon_loss: 40135532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41606086.6667; val_optim_loss: 41606086.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9420; val_auprc_score: 0.9866; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 499664.5297; train_edge_recon_loss: 1195168.6250; train_gene_expr_recon_loss: 54348561.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56043394.2000; train_optim_loss: 56043394.2000; val_kl_reg_loss: 551795.7500; val_edge_recon_loss: 1220539.6250; val_gene_expr_recon_loss: 52181909.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53954245.3333; val_optim_loss: 53954245.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9468; val_auprc_score: 0.9882; val_best_acc_score: 0.8547; val_best_f1_score: 0.9216; train_kl_reg_loss: 569071.8219; train_edge_recon_loss: 1194436.0000; train_gene_expr_recon_loss: 51428653.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53192161.8000; train_optim_loss: 53192161.8000; val_kl_reg_loss: 553629.2500; val_edge_recon_loss: 1190708.9167; val_gene_expr_recon_loss: 50672377.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52416714.6667; val_optim_loss: 52416714.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8571; val_auprc_score: 0.9580; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 100738905.4142; train_edge_recon_loss: 1181087.3117; train_gene_expr_recon_loss: 189023929.6203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 290943920.4051; train_optim_loss: 290943920.4051; val_kl_reg_loss: 2985683.4167; val_edge_recon_loss: 1167181.7778; val_gene_expr_recon_loss: 75025237.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 79178103.1111; val_optim_loss: 79178103.1111
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9409; val_auprc_score: 0.9870; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 552969.8375; train_edge_recon_loss: 1190931.9875; train_gene_expr_recon_loss: 50082509.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51826411.4000; train_optim_loss: 51826411.4000; val_kl_reg_loss: 530342.8333; val_edge_recon_loss: 1128840.2917; val_gene_expr_recon_loss: 49582332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51241514.6667; val_optim_loss: 51241514.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8579; val_auprc_score: 0.9565; val_best_acc_score: 0.8487; val_best_f1_score: 0.9182; train_kl_reg_loss: 3341523.4209; train_edge_recon_loss: 1189402.7785; train_gene_expr_recon_loss: 59349495.6962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63880422.1772; train_optim_loss: 63880422.1772; val_kl_reg_loss: 2928628.5556; val_edge_recon_loss: 1228808.0833; val_gene_expr_recon_loss: 261635491.5556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265792931.5556; val_optim_loss: 265792931.5556
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9427; val_auprc_score: 0.9874; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 529767.4922; train_edge_recon_loss: 1196307.8062; train_gene_expr_recon_loss: 49011521.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50737597.2000; train_optim_loss: 50737597.2000; val_kl_reg_loss: 509108.3542; val_edge_recon_loss: 1171814.8333; val_gene_expr_recon_loss: 48360694.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50041617.3333; val_optim_loss: 50041617.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9390; val_auprc_score: 0.9863; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 504275.3250; train_edge_recon_loss: 1197165.3438; train_gene_expr_recon_loss: 47595363.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49296804.6000; train_optim_loss: 49296804.6000; val_kl_reg_loss: 480354.4271; val_edge_recon_loss: 1199117.0417; val_gene_expr_recon_loss: 46703732.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48383202.6667; val_optim_loss: 48383202.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8498; val_auprc_score: 0.9566; val_best_acc_score: 0.8540; val_best_f1_score: 0.9213; train_kl_reg_loss: 7599684196.9620; train_edge_recon_loss: 1186429.0103; train_gene_expr_recon_loss: 151162839.6962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7752033172.8608; train_optim_loss: 7752033172.8608; val_kl_reg_loss: 3295016.0833; val_edge_recon_loss: 1186134.3472; val_gene_expr_recon_loss: 55626945.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60108096.0000; val_optim_loss: 60108096.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9409; val_auprc_score: 0.9875; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 475108.2531; train_edge_recon_loss: 1191169.5312; train_gene_expr_recon_loss: 45721529.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47387807.0000; train_optim_loss: 47387807.0000; val_kl_reg_loss: 451361.9271; val_edge_recon_loss: 1159866.5833; val_gene_expr_recon_loss: 44628144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46239372.0000; val_optim_loss: 46239372.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9394; val_auprc_score: 0.9868; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 446978.7953; train_edge_recon_loss: 1198746.4375; train_gene_expr_recon_loss: 43639116.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45284841.2000; train_optim_loss: 45284841.2000; val_kl_reg_loss: 423913.4062; val_edge_recon_loss: 1208546.8750; val_gene_expr_recon_loss: 42641173.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44273633.3333; val_optim_loss: 44273633.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8599; val_auprc_score: 0.9615; val_best_acc_score: 0.8567; val_best_f1_score: 0.9228; train_kl_reg_loss: 3145502.6234; train_edge_recon_loss: 1200860.7025; train_gene_expr_recon_loss: 54927998.8861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59274362.3797; train_optim_loss: 59274362.3797; val_kl_reg_loss: 12197833.1111; val_edge_recon_loss: 1164961.0556; val_gene_expr_recon_loss: 54377129.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67739925.3333; val_optim_loss: 67739925.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9367; val_auprc_score: 0.9865; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 419603.0281; train_edge_recon_loss: 1196334.3687; train_gene_expr_recon_loss: 41824705.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43440643.4000; train_optim_loss: 43440643.4000; val_kl_reg_loss: 398759.0729; val_edge_recon_loss: 1195181.1667; val_gene_expr_recon_loss: 41066680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42660620.0000; val_optim_loss: 42660620.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9363; val_auprc_score: 0.9868; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 393861.7047; train_edge_recon_loss: 1194816.9812; train_gene_expr_recon_loss: 40534484.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42123163.4000; train_optim_loss: 42123163.4000; val_kl_reg_loss: 372606.8958; val_edge_recon_loss: 1200172.5000; val_gene_expr_recon_loss: 40072874.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41645654.6667; val_optim_loss: 41645654.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8508; val_auprc_score: 0.9585; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 3474039.0095; train_edge_recon_loss: 1185385.2753; train_gene_expr_recon_loss: 81544975.2405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 86204399.8987; train_optim_loss: 86204399.8987; val_kl_reg_loss: 2870904.4167; val_edge_recon_loss: 1180524.2222; val_gene_expr_recon_loss: 54693212.8889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58744641.3333; val_optim_loss: 58744641.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9302; val_auprc_score: 0.9859; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 369074.9375; train_edge_recon_loss: 1196777.8313; train_gene_expr_recon_loss: 39718805.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41284658.0000; train_optim_loss: 41284658.0000; val_kl_reg_loss: 349653.4896; val_edge_recon_loss: 1217330.5000; val_gene_expr_recon_loss: 39451305.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41018289.3333; val_optim_loss: 41018289.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9258; val_auprc_score: 0.9851; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 346500.6125; train_edge_recon_loss: 1195153.9500; train_gene_expr_recon_loss: 39220482.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40762136.8000; train_optim_loss: 40762136.8000; val_kl_reg_loss: 328910.6146; val_edge_recon_loss: 1193953.7083; val_gene_expr_recon_loss: 39063004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40585869.3333; val_optim_loss: 40585869.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8599; val_auprc_score: 0.9613; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 2898318.4525; train_edge_recon_loss: 1181477.7547; train_gene_expr_recon_loss: 54677789.2658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58757585.3671; train_optim_loss: 58757585.3671; val_kl_reg_loss: 2834141.7500; val_edge_recon_loss: 1188803.0833; val_gene_expr_recon_loss: 54615844.4444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58638789.3333; val_optim_loss: 58638789.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9202; val_auprc_score: 0.9842; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 325994.9531; train_edge_recon_loss: 1205114.7375; train_gene_expr_recon_loss: 38882831.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40413941.2000; train_optim_loss: 40413941.2000; val_kl_reg_loss: 309821.3854; val_edge_recon_loss: 1200334.1667; val_gene_expr_recon_loss: 38760986.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40271142.6667; val_optim_loss: 40271142.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8536; val_auprc_score: 0.9586; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 2859226.6139; train_edge_recon_loss: 1194310.7136; train_gene_expr_recon_loss: 54608939.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58662476.7595; train_optim_loss: 58662476.7595; val_kl_reg_loss: 2796319.0556; val_edge_recon_loss: 1193502.1667; val_gene_expr_recon_loss: 54586292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58576112.8889; val_optim_loss: 58576112.8889
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9210; val_auprc_score: 0.9845; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 307808.8641; train_edge_recon_loss: 1192446.3562; train_gene_expr_recon_loss: 38940782.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40441037.8000; train_optim_loss: 40441037.8000; val_kl_reg_loss: 295521.2083; val_edge_recon_loss: 1157994.7917; val_gene_expr_recon_loss: 38720012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40173528.0000; val_optim_loss: 40173528.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9181; val_auprc_score: 0.9830; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 308928.4422; train_edge_recon_loss: 1178877.9125; train_gene_expr_recon_loss: 38568915.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40056721.0000; train_optim_loss: 40056721.0000; val_kl_reg_loss: 305512.5833; val_edge_recon_loss: 1217518.6250; val_gene_expr_recon_loss: 38469240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39992272.0000; val_optim_loss: 39992272.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8532; val_auprc_score: 0.9574; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 2819834.7532; train_edge_recon_loss: 1198511.3908; train_gene_expr_recon_loss: 54558657.5696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58577003.7468; train_optim_loss: 58577003.7468; val_kl_reg_loss: 2750718.8889; val_edge_recon_loss: 1226542.7778; val_gene_expr_recon_loss: 54472674.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58449936.8889; val_optim_loss: 58449936.8889
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9164; val_auprc_score: 0.9831; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 306127.7234; train_edge_recon_loss: 1191197.4625; train_gene_expr_recon_loss: 38347833.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39845158.8000; train_optim_loss: 39845158.8000; val_kl_reg_loss: 281501.0417; val_edge_recon_loss: 1185521.8750; val_gene_expr_recon_loss: 38295898.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39762921.3333; val_optim_loss: 39762921.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9219; val_auprc_score: 0.9830; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 375401.6641; train_edge_recon_loss: 1194601.1375; train_gene_expr_recon_loss: 48808770.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50378773.2000; train_optim_loss: 50378773.2000; val_kl_reg_loss: 406633.2396; val_edge_recon_loss: 1177541.5000; val_gene_expr_recon_loss: 39360889.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40945064.0000; val_optim_loss: 40945064.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9173; val_auprc_score: 0.9821; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 442811.6594; train_edge_recon_loss: 1189539.5312; train_gene_expr_recon_loss: 38802925.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40435276.6000; train_optim_loss: 40435276.6000; val_kl_reg_loss: 415132.5729; val_edge_recon_loss: 1227924.1250; val_gene_expr_recon_loss: 38293973.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39937029.3333; val_optim_loss: 39937029.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8954; val_auprc_score: 0.9708; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 640702850897.3500; train_edge_recon_loss: 1161148.1938; train_gene_expr_recon_loss: 467729982.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 641171734978.0000; train_optim_loss: 641171734978.0000; val_kl_reg_loss: 377377898.6667; val_edge_recon_loss: 1207295.2083; val_gene_expr_recon_loss: 791474688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1170059861.3333; val_optim_loss: 1170059861.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8213; val_auprc_score: 0.9452; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 25196523.4250; train_edge_recon_loss: 1192478.5063; train_gene_expr_recon_loss: 779397142.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 805786140.8000; train_optim_loss: 805786140.8000; val_kl_reg_loss: 6294986.6667; val_edge_recon_loss: 1191861.3333; val_gene_expr_recon_loss: 771656277.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 779143125.3333; val_optim_loss: 779143125.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 39 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9198
val AUPRC score: 0.9835
val best accuracy score: 0.8515
val best F1 score: 0.9198
val target rna MSE score: 19.7134
val source rna MSE score: 19.0793
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 5: 0 hours, 6 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9355; val_auprc_score: 0.9858; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 441576.1481; train_edge_recon_loss: 1162441.4705; train_gene_expr_recon_loss: 80088367.2453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 81692385.1321; train_optim_loss: 81692385.1321; val_kl_reg_loss: 509604.7031; val_edge_recon_loss: 1193632.4792; val_gene_expr_recon_loss: 49413783.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51117020.0000; val_optim_loss: 51117020.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8152; val_auprc_score: 0.9405; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 6388775.6500; train_edge_recon_loss: 1194432.6562; train_gene_expr_recon_loss: 770057814.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 777641024.0000; train_optim_loss: 777641024.0000; val_kl_reg_loss: 6221130.8333; val_edge_recon_loss: 1240833.0833; val_gene_expr_recon_loss: 768864725.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 776326698.6667; val_optim_loss: 776326698.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9284; val_auprc_score: 0.9838; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 493533.3880; train_edge_recon_loss: 1188518.5236; train_gene_expr_recon_loss: 47942949.7358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49625001.5849; train_optim_loss: 49625001.5849; val_kl_reg_loss: 452867.3281; val_edge_recon_loss: 1174756.0208; val_gene_expr_recon_loss: 46612653.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48240277.3333; val_optim_loss: 48240277.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8215; val_auprc_score: 0.9452; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 6250011.6250; train_edge_recon_loss: 1197036.6375; train_gene_expr_recon_loss: 769125875.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 776572921.6000; train_optim_loss: 776572921.6000; val_kl_reg_loss: 6050866.3333; val_edge_recon_loss: 1140611.9792; val_gene_expr_recon_loss: 769082048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 776273536.0000; val_optim_loss: 776273536.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9346; val_auprc_score: 0.9863; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 429824.7700; train_edge_recon_loss: 1185342.0731; train_gene_expr_recon_loss: 44359806.5660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45974973.5094; train_optim_loss: 45974973.5094; val_kl_reg_loss: 388340.1510; val_edge_recon_loss: 1194370.9792; val_gene_expr_recon_loss: 41658121.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43240831.3333; val_optim_loss: 43240831.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8264; val_auprc_score: 0.9441; val_best_acc_score: 0.8487; val_best_f1_score: 0.9182; train_kl_reg_loss: 6085554.6250; train_edge_recon_loss: 1192564.5750; train_gene_expr_recon_loss: 768821238.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 776099366.4000; train_optim_loss: 776099366.4000; val_kl_reg_loss: 5890980.5000; val_edge_recon_loss: 1245363.7083; val_gene_expr_recon_loss: 768485504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 775621845.3333; val_optim_loss: 775621845.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9294; val_auprc_score: 0.9859; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 366292.3956; train_edge_recon_loss: 1209561.0849; train_gene_expr_recon_loss: 39349504.9057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40925358.4906; train_optim_loss: 40925358.4906; val_kl_reg_loss: 329655.8281; val_edge_recon_loss: 1175739.4583; val_gene_expr_recon_loss: 37654082.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39159478.0000; val_optim_loss: 39159478.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8245; val_auprc_score: 0.9448; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 5925476.1000; train_edge_recon_loss: 1191043.3438; train_gene_expr_recon_loss: 768488534.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 775605056.0000; train_optim_loss: 775605056.0000; val_kl_reg_loss: 5751943.6667; val_edge_recon_loss: 1211548.0417; val_gene_expr_recon_loss: 768162197.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 775125696.0000; val_optim_loss: 775125696.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9235; val_auprc_score: 0.9854; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 314184.1108; train_edge_recon_loss: 1190344.0071; train_gene_expr_recon_loss: 37013586.1887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38518114.6415; train_optim_loss: 38518114.6415; val_kl_reg_loss: 292446.4010; val_edge_recon_loss: 1179569.7292; val_gene_expr_recon_loss: 36515966.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37987984.0000; val_optim_loss: 37987984.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8489; val_auprc_score: 0.9531; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 132371328.6763; train_edge_recon_loss: 1162429.5554; train_gene_expr_recon_loss: 329441118.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 462974880.6038; train_optim_loss: 462974880.6038; val_kl_reg_loss: 43038308.0000; val_edge_recon_loss: 1211835.4167; val_gene_expr_recon_loss: 76133650.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 120383793.3333; val_optim_loss: 120383793.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8336; val_auprc_score: 0.9489; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 9257415896.7547; train_edge_recon_loss: 1178986.5472; train_gene_expr_recon_loss: 192416861.3585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 9451011761.9623; train_optim_loss: 9451011761.9623; val_kl_reg_loss: 6435470.9167; val_edge_recon_loss: 1165331.6875; val_gene_expr_recon_loss: 79268589.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86869393.3333; val_optim_loss: 86869393.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8448; val_auprc_score: 0.9499; val_best_acc_score: 0.8497; val_best_f1_score: 0.9188; train_kl_reg_loss: 6825698.0000; train_edge_recon_loss: 1183396.7476; train_gene_expr_recon_loss: 66944267.6226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74953362.4151; train_optim_loss: 74953362.4151; val_kl_reg_loss: 6275144.8333; val_edge_recon_loss: 1221020.8333; val_gene_expr_recon_loss: 57735894.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65232060.6667; val_optim_loss: 65232060.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 15 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9156
val AUPRC score: 0.9827
val best accuracy score: 0.8501
val best F1 score: 0.9190
val target rna MSE score: 22.6053
val source rna MSE score: 19.9296
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 5: 0 hours, 8 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9453; val_auprc_score: 0.9882; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 231136.8181; train_edge_recon_loss: 1102348.8259; train_gene_expr_recon_loss: 117976982.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 119310468.5714; train_optim_loss: 119310468.5714; val_kl_reg_loss: 286846.1719; val_edge_recon_loss: 1223798.5000; val_gene_expr_recon_loss: 63330516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64841160.0000; val_optim_loss: 64841160.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8387; val_auprc_score: 0.9495; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 20273000.2736; train_edge_recon_loss: 1179007.8691; train_gene_expr_recon_loss: 87256973.2075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 108708980.9811; train_optim_loss: 108708980.9811; val_kl_reg_loss: 5845167.7500; val_edge_recon_loss: 1192449.7500; val_gene_expr_recon_loss: 58614776.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65652394.0000; val_optim_loss: 65652394.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9442; val_auprc_score: 0.9876; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 431759.3237; train_edge_recon_loss: 1195471.4286; train_gene_expr_recon_loss: 60313485.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61940716.0000; train_optim_loss: 61940716.0000; val_kl_reg_loss: 524584.0000; val_edge_recon_loss: 1209216.2500; val_gene_expr_recon_loss: 57797852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59531652.0000; val_optim_loss: 59531652.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9387; val_auprc_score: 0.9864; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 557740.1071; train_edge_recon_loss: 1196556.8304; train_gene_expr_recon_loss: 56468423.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58222720.0000; train_optim_loss: 58222720.0000; val_kl_reg_loss: 567899.0000; val_edge_recon_loss: 1177075.6250; val_gene_expr_recon_loss: 55497722.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57242696.0000; val_optim_loss: 57242696.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8463; val_auprc_score: 0.9513; val_best_acc_score: 0.8514; val_best_f1_score: 0.9198; train_kl_reg_loss: 5916147.1698; train_edge_recon_loss: 1197548.0566; train_gene_expr_recon_loss: 57380017.9623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64493712.9811; train_optim_loss: 64493712.9811; val_kl_reg_loss: 5754540.0833; val_edge_recon_loss: 1207153.2292; val_gene_expr_recon_loss: 57198528.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64160222.0000; val_optim_loss: 64160222.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9444; val_auprc_score: 0.9871; val_best_acc_score: 0.8457; val_best_f1_score: 0.9164; train_kl_reg_loss: 577712.3795; train_edge_recon_loss: 1195680.6161; train_gene_expr_recon_loss: 54620444.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56393837.7143; train_optim_loss: 56393837.7143; val_kl_reg_loss: 568309.5938; val_edge_recon_loss: 1262303.7500; val_gene_expr_recon_loss: 53985180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55815794.0000; val_optim_loss: 55815794.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9379; val_auprc_score: 0.9865; val_best_acc_score: 0.8594; val_best_f1_score: 0.9244; train_kl_reg_loss: 565267.6384; train_edge_recon_loss: 1204297.7768; train_gene_expr_recon_loss: 53338119.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55107685.1429; train_optim_loss: 55107685.1429; val_kl_reg_loss: 547478.9375; val_edge_recon_loss: 1127414.7500; val_gene_expr_recon_loss: 52758332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54433226.0000; val_optim_loss: 54433226.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8454; val_auprc_score: 0.9497; val_best_acc_score: 0.8479; val_best_f1_score: 0.9177; train_kl_reg_loss: 5814215.4717; train_edge_recon_loss: 1198281.0472; train_gene_expr_recon_loss: 56962472.3774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63974968.8302; train_optim_loss: 63974968.8302; val_kl_reg_loss: 5666874.5000; val_edge_recon_loss: 1236893.6875; val_gene_expr_recon_loss: 57032210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63935978.0000; val_optim_loss: 63935978.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9377; val_auprc_score: 0.9862; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 543402.5714; train_edge_recon_loss: 1207393.7143; train_gene_expr_recon_loss: 52068482.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53819279.1429; train_optim_loss: 53819279.1429; val_kl_reg_loss: 526146.8438; val_edge_recon_loss: 1221414.5000; val_gene_expr_recon_loss: 51435882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53183444.0000; val_optim_loss: 53183444.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8447; val_auprc_score: 0.9522; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 5715396.3679; train_edge_recon_loss: 1187367.1887; train_gene_expr_recon_loss: 56792894.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63695658.3396; train_optim_loss: 63695658.3396; val_kl_reg_loss: 5559278.3333; val_edge_recon_loss: 1175281.2292; val_gene_expr_recon_loss: 56844134.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63578694.0000; val_optim_loss: 63578694.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9368; val_auprc_score: 0.9858; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 522464.6518; train_edge_recon_loss: 1179008.3214; train_gene_expr_recon_loss: 50683716.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52385189.7143; train_optim_loss: 52385189.7143; val_kl_reg_loss: 505818.1250; val_edge_recon_loss: 1206699.3125; val_gene_expr_recon_loss: 49897190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51609708.0000; val_optim_loss: 51609708.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9400; val_auprc_score: 0.9869; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 501404.0625; train_edge_recon_loss: 1206996.8929; train_gene_expr_recon_loss: 49121530.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50829931.4286; train_optim_loss: 50829931.4286; val_kl_reg_loss: 482599.5000; val_edge_recon_loss: 1201868.3125; val_gene_expr_recon_loss: 48255016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49939484.0000; val_optim_loss: 49939484.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8496; val_auprc_score: 0.9534; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 5614168.8962; train_edge_recon_loss: 1194300.1887; train_gene_expr_recon_loss: 56654893.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63463363.3208; train_optim_loss: 63463363.3208; val_kl_reg_loss: 5449134.8333; val_edge_recon_loss: 1187754.6667; val_gene_expr_recon_loss: 56668641.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63305530.0000; val_optim_loss: 63305530.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9341; val_auprc_score: 0.9858; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 479247.5513; train_edge_recon_loss: 1190895.9643; train_gene_expr_recon_loss: 47444260.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49114403.7143; train_optim_loss: 49114403.7143; val_kl_reg_loss: 460239.1562; val_edge_recon_loss: 1199182.8125; val_gene_expr_recon_loss: 46591060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48250482.0000; val_optim_loss: 48250482.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9331; val_auprc_score: 0.9858; val_best_acc_score: 0.8530; val_best_f1_score: 0.9206; train_kl_reg_loss: 457611.3393; train_edge_recon_loss: 1194988.9196; train_gene_expr_recon_loss: 45766983.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47419584.0000; train_optim_loss: 47419584.0000; val_kl_reg_loss: 440145.1875; val_edge_recon_loss: 1164269.6250; val_gene_expr_recon_loss: 44964182.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46568596.0000; val_optim_loss: 46568596.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9297; val_auprc_score: 0.9854; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 436148.4286; train_edge_recon_loss: 1185794.5000; train_gene_expr_recon_loss: 44261478.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45883421.7143; train_optim_loss: 45883421.7143; val_kl_reg_loss: 419785.5938; val_edge_recon_loss: 1154578.8750; val_gene_expr_recon_loss: 43623720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45198084.0000; val_optim_loss: 45198084.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9216; val_auprc_score: 0.9830; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 415106.1116; train_edge_recon_loss: 1180698.9911; train_gene_expr_recon_loss: 43048004.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44643809.7143; train_optim_loss: 44643809.7143; val_kl_reg_loss: 398186.6719; val_edge_recon_loss: 1171997.1875; val_gene_expr_recon_loss: 42578652.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44148836.0000; val_optim_loss: 44148836.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9250; val_auprc_score: 0.9845; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 394633.4263; train_edge_recon_loss: 1201360.5536; train_gene_expr_recon_loss: 42133537.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43729531.1429; train_optim_loss: 43729531.1429; val_kl_reg_loss: 379644.8125; val_edge_recon_loss: 1215026.3125; val_gene_expr_recon_loss: 41832620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43427290.0000; val_optim_loss: 43427290.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9247; val_auprc_score: 0.9847; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 375648.7232; train_edge_recon_loss: 1184468.9286; train_gene_expr_recon_loss: 41494142.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43054260.0000; train_optim_loss: 43054260.0000; val_kl_reg_loss: 360459.0625; val_edge_recon_loss: 1165596.2500; val_gene_expr_recon_loss: 41296890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42822944.0000; val_optim_loss: 42822944.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9216; val_auprc_score: 0.9841; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 356678.5134; train_edge_recon_loss: 1196432.8125; train_gene_expr_recon_loss: 41047258.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42600369.4286; train_optim_loss: 42600369.4286; val_kl_reg_loss: 1662467.6250; val_edge_recon_loss: 1192756.0625; val_gene_expr_recon_loss: 40915848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43771070.0000; val_optim_loss: 43771070.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 10 sec.
Using best model state, which was in epoch 5.

--- MODEL EVALUATION ---
val AUROC score: 0.9209
val AUPRC score: 0.9845
val best accuracy score: 0.8534
val best F1 score: 0.9209
val target rna MSE score: 27.8558
val source rna MSE score: 31.1162
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 4: 0 hours, 5 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9402; val_auprc_score: 0.9856; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 14030164.6214; train_edge_recon_loss: 1172155.0000; train_gene_expr_recon_loss: 121527138.4906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 136729457.2075; train_optim_loss: 136729457.2075; val_kl_reg_loss: 1168427.5417; val_edge_recon_loss: 1174804.6250; val_gene_expr_recon_loss: 59363333.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61706565.3333; val_optim_loss: 61706565.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9143; val_auprc_score: 0.9822; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 457193.2522; train_edge_recon_loss: 1183288.6518; train_gene_expr_recon_loss: 41765946.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43406428.0000; train_optim_loss: 43406428.0000; val_kl_reg_loss: 394445.2500; val_edge_recon_loss: 1215462.9375; val_gene_expr_recon_loss: 40774028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42383936.0000; val_optim_loss: 42383936.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9181; val_auprc_score: 0.9816; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 495535.6094; train_edge_recon_loss: 1194161.2768; train_gene_expr_recon_loss: 66506493.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68196190.0000; train_optim_loss: 68196190.0000; val_kl_reg_loss: 594167.1875; val_edge_recon_loss: 1221766.6875; val_gene_expr_recon_loss: 42441836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44257770.0000; val_optim_loss: 44257770.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9356; val_auprc_score: 0.9836; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 1292399.4363; train_edge_recon_loss: 1201130.2524; train_gene_expr_recon_loss: 57548450.1887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60041979.9245; train_optim_loss: 60041979.9245; val_kl_reg_loss: 1227087.3125; val_edge_recon_loss: 1177571.5833; val_gene_expr_recon_loss: 55433713.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57838372.0000; val_optim_loss: 57838372.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9133; val_auprc_score: 0.9814; val_best_acc_score: 0.8589; val_best_f1_score: 0.9241; train_kl_reg_loss: 637288.8259; train_edge_recon_loss: 1209914.5536; train_gene_expr_recon_loss: 41863936.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43711138.8571; train_optim_loss: 43711138.8571; val_kl_reg_loss: 613076.6875; val_edge_recon_loss: 1143850.0625; val_gene_expr_recon_loss: 41020820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42777746.0000; val_optim_loss: 42777746.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9368; val_auprc_score: 0.9842; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 1167873.4929; train_edge_recon_loss: 1190998.1462; train_gene_expr_recon_loss: 53112768.9811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55471640.6792; train_optim_loss: 55471640.6792; val_kl_reg_loss: 1055367.3333; val_edge_recon_loss: 1209622.2500; val_gene_expr_recon_loss: 50249062.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52514051.3333; val_optim_loss: 52514051.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9108; val_auprc_score: 0.9804; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 575804.3705; train_edge_recon_loss: 1201627.6607; train_gene_expr_recon_loss: 40674650.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42452083.1429; train_optim_loss: 42452083.1429; val_kl_reg_loss: 512931.1406; val_edge_recon_loss: 1198255.0000; val_gene_expr_recon_loss: 40388794.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42099980.0000; val_optim_loss: 42099980.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9128; val_auprc_score: 0.9820; val_best_acc_score: 0.8564; val_best_f1_score: 0.9226; train_kl_reg_loss: 482688.5179; train_edge_recon_loss: 1195956.9375; train_gene_expr_recon_loss: 40242191.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41920836.8571; train_optim_loss: 41920836.8571; val_kl_reg_loss: 436603.6875; val_edge_recon_loss: 1172586.1875; val_gene_expr_recon_loss: 40138112.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41747302.0000; val_optim_loss: 41747302.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9337; val_auprc_score: 0.9843; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 999270.5248; train_edge_recon_loss: 1210510.5802; train_gene_expr_recon_loss: 48181232.9057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50391014.2642; train_optim_loss: 50391014.2642; val_kl_reg_loss: 898279.6146; val_edge_recon_loss: 1202408.7708; val_gene_expr_recon_loss: 46278752.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48379441.3333; val_optim_loss: 48379441.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9075; val_auprc_score: 0.9809; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 410980.4442; train_edge_recon_loss: 1193167.4107; train_gene_expr_recon_loss: 40016822.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41620970.5714; train_optim_loss: 41620970.5714; val_kl_reg_loss: 449591840.0000; val_edge_recon_loss: 1172217.1875; val_gene_expr_recon_loss: 40005950.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 490770016.0000; val_optim_loss: 490770016.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9089; val_auprc_score: 0.9800; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 29196628.3482; train_edge_recon_loss: 1203144.4107; train_gene_expr_recon_loss: 57201196.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 87600970.5714; train_optim_loss: 87600970.5714; val_kl_reg_loss: 419307.8438; val_edge_recon_loss: 1193095.9375; val_gene_expr_recon_loss: 41987030.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43599434.0000; val_optim_loss: 43599434.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8673; val_auprc_score: 0.9641; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 2873814462.8031; train_edge_recon_loss: 1172727.8550; train_gene_expr_recon_loss: 247416862.2642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3122404063.0189; train_optim_loss: 3122404063.0189; val_kl_reg_loss: 3234356.1250; val_edge_recon_loss: 1166581.4583; val_gene_expr_recon_loss: 180980400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 185381338.6667; val_optim_loss: 185381338.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9022; val_auprc_score: 0.9792; val_best_acc_score: 0.8566; val_best_f1_score: 0.9227; train_kl_reg_loss: 414922.7143; train_edge_recon_loss: 1212169.5625; train_gene_expr_recon_loss: 40627316.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42254408.2857; train_optim_loss: 42254408.2857; val_kl_reg_loss: 381334.1406; val_edge_recon_loss: 1158662.9375; val_gene_expr_recon_loss: 39790638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41330636.0000; val_optim_loss: 41330636.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8439; val_auprc_score: 0.9568; val_best_acc_score: 0.8582; val_best_f1_score: 0.9237; train_kl_reg_loss: 473006776.1792; train_edge_recon_loss: 1190363.6061; train_gene_expr_recon_loss: 714520059.9245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1188717206.6415; train_optim_loss: 1188717206.6415; val_kl_reg_loss: 5432898.0833; val_edge_recon_loss: 1155534.9792; val_gene_expr_recon_loss: 764228821.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 770817248.0000; val_optim_loss: 770817248.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8145; val_auprc_score: 0.9444; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 316725850263.8460; train_edge_recon_loss: 1148010.6920; train_gene_expr_recon_loss: 798816041.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 317525809972.5714; train_optim_loss: 317525809972.5714; val_kl_reg_loss: 5917400.5000; val_edge_recon_loss: 1158819.7500; val_gene_expr_recon_loss: 785024576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 792100800.0000; val_optim_loss: 792100800.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7818; val_auprc_score: 0.9343; val_best_acc_score: 0.8578; val_best_f1_score: 0.9235; train_kl_reg_loss: 7866384.8214; train_edge_recon_loss: 1183534.9196; train_gene_expr_recon_loss: 773559044.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 782608969.1429; train_optim_loss: 782608969.1429; val_kl_reg_loss: 9029260.5000; val_edge_recon_loss: 1137319.6875; val_gene_expr_recon_loss: 767880768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 778047328.0000; val_optim_loss: 778047328.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8663; val_auprc_score: 0.9625; val_best_acc_score: 0.8481; val_best_f1_score: 0.9178; train_kl_reg_loss: 4516561.3396; train_edge_recon_loss: 1191326.3019; train_gene_expr_recon_loss: 762284186.5660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 767992072.4528; train_optim_loss: 767992072.4528; val_kl_reg_loss: 3574553.8750; val_edge_recon_loss: 1233701.1042; val_gene_expr_recon_loss: 760675434.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 765483690.6667; val_optim_loss: 765483690.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7898; val_auprc_score: 0.9336; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 9323874.7143; train_edge_recon_loss: 1203931.8750; train_gene_expr_recon_loss: 766689490.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 777217293.7143; train_optim_loss: 777217293.7143; val_kl_reg_loss: 9205268.0000; val_edge_recon_loss: 1225202.2500; val_gene_expr_recon_loss: 765439968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 775870432.0000; val_optim_loss: 775870432.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8771; val_auprc_score: 0.9682; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 3045216.6462; train_edge_recon_loss: 1202215.6580; train_gene_expr_recon_loss: 759329465.9623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 763576905.6604; train_optim_loss: 763576905.6604; val_kl_reg_loss: 2473411.6667; val_edge_recon_loss: 1210022.0417; val_gene_expr_recon_loss: 757641226.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 761324661.3333; val_optim_loss: 761324661.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8000; val_auprc_score: 0.9371; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 9079976.5714; train_edge_recon_loss: 1199759.0804; train_gene_expr_recon_loss: 764342098.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 774621833.1429; train_optim_loss: 774621833.1429; val_kl_reg_loss: 8682343.0000; val_edge_recon_loss: 1212312.1875; val_gene_expr_recon_loss: 763177568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 773072224.0000; val_optim_loss: 773072224.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7976; val_auprc_score: 0.9380; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 8746342.0714; train_edge_recon_loss: 1202258.6161; train_gene_expr_recon_loss: 763540397.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 773489005.7143; train_optim_loss: 773489005.7143; val_kl_reg_loss: 8589383.5000; val_edge_recon_loss: 1176965.6875; val_gene_expr_recon_loss: 763211520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 772977888.0000; val_optim_loss: 772977888.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8698; val_auprc_score: 0.9660; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 2476979.7123; train_edge_recon_loss: 1199686.2358; train_gene_expr_recon_loss: 757708220.3774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 761384889.9623; train_optim_loss: 761384889.9623; val_kl_reg_loss: 2379486.6250; val_edge_recon_loss: 1205904.8542; val_gene_expr_recon_loss: 757393664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 760979072.0000; val_optim_loss: 760979072.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7851; val_auprc_score: 0.9335; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 8670656.6429; train_edge_recon_loss: 1193698.8661; train_gene_expr_recon_loss: 763361133.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 773225494.8571; train_optim_loss: 773225494.8571; val_kl_reg_loss: 8552087.5000; val_edge_recon_loss: 1186257.8750; val_gene_expr_recon_loss: 761928832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 771667168.0000; val_optim_loss: 771667168.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8731; val_auprc_score: 0.9674; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 2392142.0189; train_edge_recon_loss: 1188780.0071; train_gene_expr_recon_loss: 757582640.3019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 761163561.0566; train_optim_loss: 761163561.0566; val_kl_reg_loss: 2298552.1667; val_edge_recon_loss: 1194054.1042; val_gene_expr_recon_loss: 756543861.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 760036458.6667; val_optim_loss: 760036458.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7862; val_auprc_score: 0.9360; val_best_acc_score: 0.8583; val_best_f1_score: 0.9238; train_kl_reg_loss: 8610175.7143; train_edge_recon_loss: 1197931.9464; train_gene_expr_recon_loss: 763198806.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 773006912.0000; train_optim_loss: 773006912.0000; val_kl_reg_loss: 8477709.2500; val_edge_recon_loss: 1156896.3125; val_gene_expr_recon_loss: 763005344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 772639968.0000; val_optim_loss: 772639968.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7906; val_auprc_score: 0.9354; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 8542396.0714; train_edge_recon_loss: 1199679.3393; train_gene_expr_recon_loss: 763072649.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 772814729.1429; train_optim_loss: 772814729.1429; val_kl_reg_loss: 8402558.5000; val_edge_recon_loss: 1184370.6250; val_gene_expr_recon_loss: 762281376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 771868288.0000; val_optim_loss: 771868288.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8810; val_auprc_score: 0.9705; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 2302801.0896; train_edge_recon_loss: 1199976.5425; train_gene_expr_recon_loss: 757361261.8868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 760864037.4340; train_optim_loss: 760864037.4340; val_kl_reg_loss: 2218485.7917; val_edge_recon_loss: 1184854.7917; val_gene_expr_recon_loss: 756012938.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 759416277.3333; val_optim_loss: 759416277.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8817; val_auprc_score: 0.9710; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 2213845.2028; train_edge_recon_loss: 1194379.5354; train_gene_expr_recon_loss: 757020621.2830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 760428842.2642; train_optim_loss: 760428842.2642; val_kl_reg_loss: 2126151.8750; val_edge_recon_loss: 1185982.2917; val_gene_expr_recon_loss: 756513589.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 759825717.3333; val_optim_loss: 759825717.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 33 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9025
val AUPRC score: 0.9788
val best accuracy score: 0.8533
val best F1 score: 0.9208
val target rna MSE score: 41.6598
val source rna MSE score: 33.0721
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 4: 0 hours, 7 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9471; val_auprc_score: 0.9883; val_best_acc_score: 0.8465; val_best_f1_score: 0.9169; train_kl_reg_loss: 222595.1432; train_edge_recon_loss: 1096033.7188; train_gene_expr_recon_loss: 113502398.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 114821028.0000; train_optim_loss: 114821028.0000; val_kl_reg_loss: 299442.0938; val_edge_recon_loss: 1255549.8125; val_gene_expr_recon_loss: 59441272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60996264.0000; val_optim_loss: 60996264.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 44 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9359
val AUPRC score: 0.9846
val best accuracy score: 0.8522
val best F1 score: 0.9202
val target rna MSE score: 58.8691
val source rna MSE score: 65.4913
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 3: 0 hours, 4 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9078; val_auprc_score: 0.9795; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 331415.2133; train_edge_recon_loss: 1128865.8426; train_gene_expr_recon_loss: 124666616.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 126126896.7407; train_optim_loss: 126126896.7407; val_kl_reg_loss: 350548.8021; val_edge_recon_loss: 1198711.7083; val_gene_expr_recon_loss: 57525940.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59075200.0000; val_optim_loss: 59075200.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9374; val_auprc_score: 0.9858; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 454117.4062; train_edge_recon_loss: 1201776.6875; train_gene_expr_recon_loss: 56910495.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58566389.7143; train_optim_loss: 58566389.7143; val_kl_reg_loss: 538304.2188; val_edge_recon_loss: 1189063.9375; val_gene_expr_recon_loss: 54378138.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56105506.0000; val_optim_loss: 56105506.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9106; val_auprc_score: 0.9815; val_best_acc_score: 0.8571; val_best_f1_score: 0.9231; train_kl_reg_loss: 384248.5787; train_edge_recon_loss: 1176186.4583; train_gene_expr_recon_loss: 54902803.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56463238.3704; train_optim_loss: 56463238.3704; val_kl_reg_loss: 385601.4167; val_edge_recon_loss: 1162125.2083; val_gene_expr_recon_loss: 53073229.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54620957.3333; val_optim_loss: 54620957.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9376; val_auprc_score: 0.9857; val_best_acc_score: 0.8562; val_best_f1_score: 0.9225; train_kl_reg_loss: 574995.9286; train_edge_recon_loss: 1189367.3571; train_gene_expr_recon_loss: 54621524.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56385887.1429; train_optim_loss: 56385887.1429; val_kl_reg_loss: 625609.3438; val_edge_recon_loss: 1168425.3750; val_gene_expr_recon_loss: 53909934.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55703968.0000; val_optim_loss: 55703968.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9132; val_auprc_score: 0.9819; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 392331.0324; train_edge_recon_loss: 1195766.9676; train_gene_expr_recon_loss: 52223264.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53811362.3704; train_optim_loss: 53811362.3704; val_kl_reg_loss: 370573.3021; val_edge_recon_loss: 1182670.8333; val_gene_expr_recon_loss: 51426970.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52980214.6667; val_optim_loss: 52980214.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9447; val_auprc_score: 0.9870; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 767041.9330; train_edge_recon_loss: 1196428.7321; train_gene_expr_recon_loss: 53309213.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55272684.2857; train_optim_loss: 55272684.2857; val_kl_reg_loss: 878961.8750; val_edge_recon_loss: 1191820.8750; val_gene_expr_recon_loss: 52764300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54835084.0000; val_optim_loss: 54835084.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9074; val_auprc_score: 0.9807; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 373951.9942; train_edge_recon_loss: 1190505.0139; train_gene_expr_recon_loss: 50751584.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52316041.3333; train_optim_loss: 52316041.3333; val_kl_reg_loss: 352106.0208; val_edge_recon_loss: 1195342.7500; val_gene_expr_recon_loss: 50003325.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51550774.6667; val_optim_loss: 51550774.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9376; val_auprc_score: 0.9847; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 943699.7545; train_edge_recon_loss: 1188080.1518; train_gene_expr_recon_loss: 52244948.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54376728.5714; train_optim_loss: 54376728.5714; val_kl_reg_loss: 964569.1250; val_edge_recon_loss: 1194193.8750; val_gene_expr_recon_loss: 51728894.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53887656.0000; val_optim_loss: 53887656.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8968; val_auprc_score: 0.9780; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 353611.4097; train_edge_recon_loss: 1187522.7685; train_gene_expr_recon_loss: 49213307.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50754441.6296; train_optim_loss: 50754441.6296; val_kl_reg_loss: 331262.6875; val_edge_recon_loss: 1188433.1250; val_gene_expr_recon_loss: 48314929.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49834625.3333; val_optim_loss: 49834625.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9376; val_auprc_score: 0.9851; val_best_acc_score: 0.8556; val_best_f1_score: 0.9222; train_kl_reg_loss: 985160.1875; train_edge_recon_loss: 1207691.1161; train_gene_expr_recon_loss: 51121664.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53314515.7143; train_optim_loss: 53314515.7143; val_kl_reg_loss: 966686.6875; val_edge_recon_loss: 1167166.1875; val_gene_expr_recon_loss: 50602036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52735888.0000; val_optim_loss: 52735888.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9026; val_auprc_score: 0.9770; val_best_acc_score: 0.8482; val_best_f1_score: 0.9178; train_kl_reg_loss: 409517.1366; train_edge_recon_loss: 1171487.0000; train_gene_expr_recon_loss: 52814142.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54395146.3704; train_optim_loss: 54395146.3704; val_kl_reg_loss: 426236.1042; val_edge_recon_loss: 1234648.4583; val_gene_expr_recon_loss: 47282922.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48943806.6667; val_optim_loss: 48943806.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9126; val_auprc_score: 0.9823; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 449734.1956; train_edge_recon_loss: 1215073.8889; train_gene_expr_recon_loss: 45797680.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47462488.0000; train_optim_loss: 47462488.0000; val_kl_reg_loss: 418549.6562; val_edge_recon_loss: 1162795.2083; val_gene_expr_recon_loss: 44404848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45986193.3333; val_optim_loss: 45986193.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9404; val_auprc_score: 0.9862; val_best_acc_score: 0.8574; val_best_f1_score: 0.9233; train_kl_reg_loss: 971233.3527; train_edge_recon_loss: 1196643.9196; train_gene_expr_recon_loss: 49872392.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52040270.2857; train_optim_loss: 52040270.2857; val_kl_reg_loss: 942681.5938; val_edge_recon_loss: 1157601.4375; val_gene_expr_recon_loss: 49195424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51295706.0000; val_optim_loss: 51295706.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9018; val_auprc_score: 0.9778; val_best_acc_score: 0.8479; val_best_f1_score: 0.9177; train_kl_reg_loss: 403745.9977; train_edge_recon_loss: 1197515.4537; train_gene_expr_recon_loss: 43376617.1852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44977878.8148; train_optim_loss: 44977878.8148; val_kl_reg_loss: 361251.6458; val_edge_recon_loss: 1236749.9583; val_gene_expr_recon_loss: 42427926.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44025928.0000; val_optim_loss: 44025928.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9363; val_auprc_score: 0.9847; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 942915.9955; train_edge_recon_loss: 1185820.3929; train_gene_expr_recon_loss: 48431086.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50559823.7143; train_optim_loss: 50559823.7143; val_kl_reg_loss: 912258.3438; val_edge_recon_loss: 1202779.9375; val_gene_expr_recon_loss: 47663472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49778510.0000; val_optim_loss: 49778510.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9091; val_auprc_score: 0.9808; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 2162079.6111; train_edge_recon_loss: 1199714.2963; train_gene_expr_recon_loss: 95742412.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 99104208.2963; train_optim_loss: 99104208.2963; val_kl_reg_loss: 1900714410.6667; val_edge_recon_loss: 1189328.6667; val_gene_expr_recon_loss: 49541378.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1951445162.6667; val_optim_loss: 1951445162.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9360; val_auprc_score: 0.9845; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 912880.3839; train_edge_recon_loss: 1198382.4732; train_gene_expr_recon_loss: 46882922.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48994185.1429; train_optim_loss: 48994185.1429; val_kl_reg_loss: 883720.2812; val_edge_recon_loss: 1205069.2500; val_gene_expr_recon_loss: 46107212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48196002.0000; val_optim_loss: 48196002.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8781; val_auprc_score: 0.9679; val_best_acc_score: 0.8543; val_best_f1_score: 0.9215; train_kl_reg_loss: 92400162.4352; train_edge_recon_loss: 1173582.7847; train_gene_expr_recon_loss: 219253753.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 312827502.3704; train_optim_loss: 312827502.3704; val_kl_reg_loss: 2220702.5000; val_edge_recon_loss: 1184706.0833; val_gene_expr_recon_loss: 56000361.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59405770.6667; val_optim_loss: 59405770.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9355; val_auprc_score: 0.9848; val_best_acc_score: 0.8530; val_best_f1_score: 0.9206; train_kl_reg_loss: 882942.4375; train_edge_recon_loss: 1200931.5089; train_gene_expr_recon_loss: 45321575.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47405449.1429; train_optim_loss: 47405449.1429; val_kl_reg_loss: 855652.0625; val_edge_recon_loss: 1199901.3125; val_gene_expr_recon_loss: 44597004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46652558.0000; val_optim_loss: 46652558.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8550; val_auprc_score: 0.9575; val_best_acc_score: 0.8497; val_best_f1_score: 0.9187; train_kl_reg_loss: 2813848.2037; train_edge_recon_loss: 1198197.5880; train_gene_expr_recon_loss: 91779125.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 95791170.2222; train_optim_loss: 95791170.2222; val_kl_reg_loss: 2828871.6667; val_edge_recon_loss: 1222233.6667; val_gene_expr_recon_loss: 54278230.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58329337.3333; val_optim_loss: 58329337.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9365; val_auprc_score: 0.9852; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 853911.0268; train_edge_recon_loss: 1195904.7411; train_gene_expr_recon_loss: 43917532.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45967348.0000; train_optim_loss: 45967348.0000; val_kl_reg_loss: 827712.1875; val_edge_recon_loss: 1191931.7500; val_gene_expr_recon_loss: 43345668.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45365312.0000; val_optim_loss: 45365312.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8563; val_auprc_score: 0.9592; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 2811005.4722; train_edge_recon_loss: 1204142.4861; train_gene_expr_recon_loss: 53470825.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57485974.0741; train_optim_loss: 57485974.0741; val_kl_reg_loss: 2567899.2500; val_edge_recon_loss: 1201126.4583; val_gene_expr_recon_loss: 52983193.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56752218.6667; val_optim_loss: 56752218.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8538; val_auprc_score: 0.9572; val_best_acc_score: 0.8492; val_best_f1_score: 0.9185; train_kl_reg_loss: 2633774.4167; train_edge_recon_loss: 1195770.7454; train_gene_expr_recon_loss: 52894866.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56724411.5556; train_optim_loss: 56724411.5556; val_kl_reg_loss: 2535111.3333; val_edge_recon_loss: 1225829.5000; val_gene_expr_recon_loss: 52966470.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56727412.0000; val_optim_loss: 56727412.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9324; val_auprc_score: 0.9839; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 825871.6652; train_edge_recon_loss: 1202567.9107; train_gene_expr_recon_loss: 42774644.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44803084.2857; train_optim_loss: 44803084.2857; val_kl_reg_loss: 798160.0000; val_edge_recon_loss: 1209871.7500; val_gene_expr_recon_loss: 42317444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44325476.0000; val_optim_loss: 44325476.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8553; val_auprc_score: 0.9603; val_best_acc_score: 0.8573; val_best_f1_score: 0.9232; train_kl_reg_loss: 2603513.0463; train_edge_recon_loss: 1199616.9213; train_gene_expr_recon_loss: 52863398.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56666528.0000; train_optim_loss: 56666528.0000; val_kl_reg_loss: 2504963.1667; val_edge_recon_loss: 1160020.3750; val_gene_expr_recon_loss: 52858700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56523684.0000; val_optim_loss: 56523684.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9272; val_auprc_score: 0.9830; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 799202.5000; train_edge_recon_loss: 1194075.5000; train_gene_expr_recon_loss: 41928261.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43921539.1429; train_optim_loss: 43921539.1429; val_kl_reg_loss: 772690.3125; val_edge_recon_loss: 1201634.3125; val_gene_expr_recon_loss: 41621868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43596192.0000; val_optim_loss: 43596192.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8572; val_auprc_score: 0.9605; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 2569699.3981; train_edge_recon_loss: 1186261.9676; train_gene_expr_recon_loss: 52791201.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56547162.8148; train_optim_loss: 56547162.8148; val_kl_reg_loss: 2464364.5000; val_edge_recon_loss: 1179559.6667; val_gene_expr_recon_loss: 52804848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56448772.0000; val_optim_loss: 56448772.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9254; val_auprc_score: 0.9829; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 772026.7857; train_edge_recon_loss: 1186173.4152; train_gene_expr_recon_loss: 41310640.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43268840.5714; train_optim_loss: 43268840.5714; val_kl_reg_loss: 746587.5312; val_edge_recon_loss: 1193856.8750; val_gene_expr_recon_loss: 41159938.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43100382.0000; val_optim_loss: 43100382.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8588; val_auprc_score: 0.9593; val_best_acc_score: 0.8476; val_best_f1_score: 0.9175; train_kl_reg_loss: 2535287.5833; train_edge_recon_loss: 1186791.1389; train_gene_expr_recon_loss: 52753000.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56475078.5185; train_optim_loss: 56475078.5185; val_kl_reg_loss: 2435814.4167; val_edge_recon_loss: 1239660.9167; val_gene_expr_recon_loss: 52749105.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56424581.3333; val_optim_loss: 56424581.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9261; val_auprc_score: 0.9834; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 747465.1830; train_edge_recon_loss: 1208799.3036; train_gene_expr_recon_loss: 40887936.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42844200.2857; train_optim_loss: 42844200.2857; val_kl_reg_loss: 724144.1250; val_edge_recon_loss: 1194961.1250; val_gene_expr_recon_loss: 40801642.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42720746.0000; val_optim_loss: 42720746.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9222; val_auprc_score: 0.9828; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 722800.1518; train_edge_recon_loss: 1208678.5714; train_gene_expr_recon_loss: 40576649.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42508128.0000; train_optim_loss: 42508128.0000; val_kl_reg_loss: 698523.4375; val_edge_recon_loss: 1190735.5000; val_gene_expr_recon_loss: 40499124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42388382.0000; val_optim_loss: 42388382.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9209; val_auprc_score: 0.9831; val_best_acc_score: 0.8547; val_best_f1_score: 0.9216; train_kl_reg_loss: 699842.2589; train_edge_recon_loss: 1197661.6607; train_gene_expr_recon_loss: 40344274.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42241777.7143; train_optim_loss: 42241777.7143; val_kl_reg_loss: 679347.7812; val_edge_recon_loss: 1182775.5625; val_gene_expr_recon_loss: 40335828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42197950.0000; val_optim_loss: 42197950.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9102; val_auprc_score: 0.9805; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 677556.5357; train_edge_recon_loss: 1191980.5000; train_gene_expr_recon_loss: 40155406.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42024943.7143; train_optim_loss: 42024943.7143; val_kl_reg_loss: 656555.5312; val_edge_recon_loss: 1177157.2500; val_gene_expr_recon_loss: 40099850.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41933562.0000; val_optim_loss: 41933562.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9097; val_auprc_score: 0.9809; val_best_acc_score: 0.8545; val_best_f1_score: 0.9216; train_kl_reg_loss: 656061.8750; train_edge_recon_loss: 1183347.7500; train_gene_expr_recon_loss: 40001532.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41840942.5714; train_optim_loss: 41840942.5714; val_kl_reg_loss: 635992.9062; val_edge_recon_loss: 1188719.3125; val_gene_expr_recon_loss: 39969084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41793796.0000; val_optim_loss: 41793796.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9009; val_auprc_score: 0.9782; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 635990.6116; train_edge_recon_loss: 1190988.6161; train_gene_expr_recon_loss: 39866016.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41692996.0000; train_optim_loss: 41692996.0000; val_kl_reg_loss: 616870.7188; val_edge_recon_loss: 1216038.9375; val_gene_expr_recon_loss: 39875378.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41708288.0000; val_optim_loss: 41708288.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 10 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
val AUROC score: 0.8962
val AUPRC score: 0.9768
val best accuracy score: 0.8455
val best F1 score: 0.9163
val target rna MSE score: 50.8418
val source rna MSE score: 77.3162
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 2: 0 hours, 3 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9163; val_auprc_score: 0.9826; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 415965.6564; train_edge_recon_loss: 1145364.3056; train_gene_expr_recon_loss: 128018312.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 129579644.8889; train_optim_loss: 129579644.8889; val_kl_reg_loss: 328848.6146; val_edge_recon_loss: 1177706.0417; val_gene_expr_recon_loss: 54311492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55818046.6667; val_optim_loss: 55818046.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9051; val_auprc_score: 0.9801; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 615857.5134; train_edge_recon_loss: 1198358.7500; train_gene_expr_recon_loss: 39745842.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41560058.8571; train_optim_loss: 41560058.8571; val_kl_reg_loss: 595635.0000; val_edge_recon_loss: 1200912.6250; val_gene_expr_recon_loss: 39722680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41519228.0000; val_optim_loss: 41519228.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9069; val_auprc_score: 0.9791; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 375839.3681; train_edge_recon_loss: 1189502.3796; train_gene_expr_recon_loss: 50333860.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51899202.2222; train_optim_loss: 51899202.2222; val_kl_reg_loss: 379400.2604; val_edge_recon_loss: 1215942.7500; val_gene_expr_recon_loss: 48692144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50287486.6667; val_optim_loss: 50287486.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8998; val_auprc_score: 0.9797; val_best_acc_score: 0.8556; val_best_f1_score: 0.9222; train_kl_reg_loss: 596573.8839; train_edge_recon_loss: 1204757.8839; train_gene_expr_recon_loss: 39636774.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41438106.0000; train_optim_loss: 41438106.0000; val_kl_reg_loss: 577333.5625; val_edge_recon_loss: 1172460.2500; val_gene_expr_recon_loss: 39599964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41349758.0000; val_optim_loss: 41349758.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9100; val_auprc_score: 0.9813; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 386956.1644; train_edge_recon_loss: 1187700.8194; train_gene_expr_recon_loss: 47947076.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49521732.7407; train_optim_loss: 49521732.7407; val_kl_reg_loss: 368662.5833; val_edge_recon_loss: 1158823.3750; val_gene_expr_recon_loss: 47380509.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48907996.0000; val_optim_loss: 48907996.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8939; val_auprc_score: 0.9772; val_best_acc_score: 0.8481; val_best_f1_score: 0.9178; train_kl_reg_loss: 577858.4420; train_edge_recon_loss: 1187486.5893; train_gene_expr_recon_loss: 39535852.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41301197.1429; train_optim_loss: 41301197.1429; val_kl_reg_loss: 559555.2812; val_edge_recon_loss: 1239829.8750; val_gene_expr_recon_loss: 39575168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41374554.0000; val_optim_loss: 41374554.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9146; val_auprc_score: 0.9821; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 373296.7373; train_edge_recon_loss: 1194746.6435; train_gene_expr_recon_loss: 46959165.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48527209.6296; train_optim_loss: 48527209.6296; val_kl_reg_loss: 351770.4583; val_edge_recon_loss: 1178821.6667; val_gene_expr_recon_loss: 46576328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48106920.0000; val_optim_loss: 48106920.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9112; val_auprc_score: 0.9807; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 353401.0694; train_edge_recon_loss: 1193791.5741; train_gene_expr_recon_loss: 46147356.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47694549.0370; train_optim_loss: 47694549.0370; val_kl_reg_loss: 332294.9792; val_edge_recon_loss: 1200951.2500; val_gene_expr_recon_loss: 45723421.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47256668.0000; val_optim_loss: 47256668.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8888; val_auprc_score: 0.9772; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 559910.4464; train_edge_recon_loss: 1198569.6518; train_gene_expr_recon_loss: 39436457.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41194938.0000; train_optim_loss: 41194938.0000; val_kl_reg_loss: 542935.6875; val_edge_recon_loss: 1187393.8125; val_gene_expr_recon_loss: 39451248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41181578.0000; val_optim_loss: 41181578.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9051; val_auprc_score: 0.9799; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 332248.9491; train_edge_recon_loss: 1199807.7083; train_gene_expr_recon_loss: 45152967.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46685024.5926; train_optim_loss: 46685024.5926; val_kl_reg_loss: 310713.7292; val_edge_recon_loss: 1203908.6250; val_gene_expr_recon_loss: 44561817.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46076440.0000; val_optim_loss: 46076440.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8920; val_auprc_score: 0.9772; val_best_acc_score: 0.8481; val_best_f1_score: 0.9178; train_kl_reg_loss: 542677.1875; train_edge_recon_loss: 1199003.0446; train_gene_expr_recon_loss: 39358639.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41100320.5714; train_optim_loss: 41100320.5714; val_kl_reg_loss: 526572.8281; val_edge_recon_loss: 1221079.0625; val_gene_expr_recon_loss: 39386998.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41134650.0000; val_optim_loss: 41134650.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9047; val_auprc_score: 0.9803; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 315431.9850; train_edge_recon_loss: 1208856.2731; train_gene_expr_recon_loss: 43844390.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45368678.8148; train_optim_loss: 45368678.8148; val_kl_reg_loss: 291104.1458; val_edge_recon_loss: 1215195.1250; val_gene_expr_recon_loss: 42943268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44449566.6667; val_optim_loss: 44449566.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8814; val_auprc_score: 0.9763; val_best_acc_score: 0.8566; val_best_f1_score: 0.9227; train_kl_reg_loss: 526063.6853; train_edge_recon_loss: 1177793.3125; train_gene_expr_recon_loss: 39272336.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40976192.5714; train_optim_loss: 40976192.5714; val_kl_reg_loss: 510848.6094; val_edge_recon_loss: 1175740.9375; val_gene_expr_recon_loss: 39272538.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40959126.0000; val_optim_loss: 40959126.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8934; val_auprc_score: 0.9781; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 319838.5382; train_edge_recon_loss: 1202584.0278; train_gene_expr_recon_loss: 42010111.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43532534.2222; train_optim_loss: 43532534.2222; val_kl_reg_loss: 267262.1979; val_edge_recon_loss: 1187190.3333; val_gene_expr_recon_loss: 40998413.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42452866.6667; val_optim_loss: 42452866.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8916; val_auprc_score: 0.9779; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 392949.5613; train_edge_recon_loss: 1193789.7500; train_gene_expr_recon_loss: 45535161.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47121901.0370; train_optim_loss: 47121901.0370; val_kl_reg_loss: 247733.9688; val_edge_recon_loss: 1217107.2083; val_gene_expr_recon_loss: 56164249.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57629090.6667; val_optim_loss: 57629090.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8782; val_auprc_score: 0.9759; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 509536.3661; train_edge_recon_loss: 1191585.0625; train_gene_expr_recon_loss: 39180145.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40881266.5714; train_optim_loss: 40881266.5714; val_kl_reg_loss: 494710.3594; val_edge_recon_loss: 1155109.8125; val_gene_expr_recon_loss: 39193308.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40843128.0000; val_optim_loss: 40843128.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8875; val_auprc_score: 0.9751; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 320548.0816; train_edge_recon_loss: 1204043.4306; train_gene_expr_recon_loss: 42493932.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44018524.4444; train_optim_loss: 44018524.4444; val_kl_reg_loss: 320497.6875; val_edge_recon_loss: 1197252.8333; val_gene_expr_recon_loss: 38334481.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39852232.0000; val_optim_loss: 39852232.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8798; val_auprc_score: 0.9758; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 493941.0246; train_edge_recon_loss: 1173926.7455; train_gene_expr_recon_loss: 39112240.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40780108.0000; train_optim_loss: 40780108.0000; val_kl_reg_loss: 479065.4375; val_edge_recon_loss: 1193788.9375; val_gene_expr_recon_loss: 39133368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40806222.0000; val_optim_loss: 40806222.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8708; val_auprc_score: 0.9661; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 200121163.1933; train_edge_recon_loss: 1168437.6273; train_gene_expr_recon_loss: 296801406.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 498091001.9259; train_optim_loss: 498091001.9259; val_kl_reg_loss: 636886656.0000; val_edge_recon_loss: 1170860.3750; val_gene_expr_recon_loss: 169335552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 807393088.0000; val_optim_loss: 807393088.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8803; val_auprc_score: 0.9760; val_best_acc_score: 0.8566; val_best_f1_score: 0.9226; train_kl_reg_loss: 478840.6205; train_edge_recon_loss: 1192148.5893; train_gene_expr_recon_loss: 39027355.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40698344.5714; train_optim_loss: 40698344.5714; val_kl_reg_loss: 463087.6875; val_edge_recon_loss: 1181655.9375; val_gene_expr_recon_loss: 39032586.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40677328.0000; val_optim_loss: 40677328.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8424; val_auprc_score: 0.9537; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 40809210.7963; train_edge_recon_loss: 1167382.9167; train_gene_expr_recon_loss: 244645089.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 286621685.0370; train_optim_loss: 286621685.0370; val_kl_reg_loss: 3458302.0833; val_edge_recon_loss: 1169925.5000; val_gene_expr_recon_loss: 61694769.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66322997.3333; val_optim_loss: 66322997.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8712; val_auprc_score: 0.9739; val_best_acc_score: 0.8584; val_best_f1_score: 0.9236; train_kl_reg_loss: 464257.4955; train_edge_recon_loss: 1188710.4732; train_gene_expr_recon_loss: 38965804.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40618772.5714; train_optim_loss: 40618772.5714; val_kl_reg_loss: 450629.2500; val_edge_recon_loss: 1183402.3125; val_gene_expr_recon_loss: 38991332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40625364.0000; val_optim_loss: 40625364.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8472; val_auprc_score: 0.9561; val_best_acc_score: 0.8576; val_best_f1_score: 0.9233; train_kl_reg_loss: 3580561.5463; train_edge_recon_loss: 1196984.4259; train_gene_expr_recon_loss: 59543497.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64321043.1111; train_optim_loss: 64321043.1111; val_kl_reg_loss: 3341258.9167; val_edge_recon_loss: 1157465.2917; val_gene_expr_recon_loss: 57009002.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61507726.6667; val_optim_loss: 61507726.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8523; val_auprc_score: 0.9563; val_best_acc_score: 0.8511; val_best_f1_score: 0.9196; train_kl_reg_loss: 350448185.9167; train_edge_recon_loss: 1199106.4560; train_gene_expr_recon_loss: 142730133.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 494377427.8519; train_optim_loss: 494377427.8519; val_kl_reg_loss: 88981242.6667; val_edge_recon_loss: 1210716.2917; val_gene_expr_recon_loss: 73148101.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 163340064.0000; val_optim_loss: 163340064.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8644; val_auprc_score: 0.9724; val_best_acc_score: 0.8575; val_best_f1_score: 0.9229; train_kl_reg_loss: 449843.4933; train_edge_recon_loss: 1198125.7589; train_gene_expr_recon_loss: 38880754.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40528723.1429; train_optim_loss: 40528723.1429; val_kl_reg_loss: 435210.1094; val_edge_recon_loss: 1184618.3750; val_gene_expr_recon_loss: 38687254.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40307082.0000; val_optim_loss: 40307082.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8452; val_auprc_score: 0.9539; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 7690392.9074; train_edge_recon_loss: 1165639.3056; train_gene_expr_recon_loss: 132579771.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 141435802.8148; train_optim_loss: 141435802.8148; val_kl_reg_loss: 2893974.7500; val_edge_recon_loss: 1194628.2083; val_gene_expr_recon_loss: 57295781.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61384384.0000; val_optim_loss: 61384384.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8544; val_auprc_score: 0.9592; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 95834814647.5290; train_edge_recon_loss: 1110555.1607; train_gene_expr_recon_loss: 1014734895.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 96850659032.5714; train_optim_loss: 96850659032.5714; val_kl_reg_loss: 5019209.0000; val_edge_recon_loss: 1194325.7500; val_gene_expr_recon_loss: 912794304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 919007840.0000; val_optim_loss: 919007840.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8591; val_auprc_score: 0.9582; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 2968890.9815; train_edge_recon_loss: 1184710.5833; train_gene_expr_recon_loss: 56688110.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60841712.0000; train_optim_loss: 60841712.0000; val_kl_reg_loss: 2853912.5833; val_edge_recon_loss: 1215832.1250; val_gene_expr_recon_loss: 56318105.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60387852.0000; val_optim_loss: 60387852.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8518; val_auprc_score: 0.9574; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 4952997185.7500; train_edge_recon_loss: 1179390.8304; train_gene_expr_recon_loss: 1046581408.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6000758176.0000; train_optim_loss: 6000758176.0000; val_kl_reg_loss: 9019047.0000; val_edge_recon_loss: 1191991.8125; val_gene_expr_recon_loss: 806429728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 816640768.0000; val_optim_loss: 816640768.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8523; val_auprc_score: 0.9572; val_best_acc_score: 0.8543; val_best_f1_score: 0.9215; train_kl_reg_loss: 2930958.1574; train_edge_recon_loss: 1193668.9630; train_gene_expr_recon_loss: 56196843.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60321470.0741; train_optim_loss: 60321470.0741; val_kl_reg_loss: 2817767.6667; val_edge_recon_loss: 1183909.4583; val_gene_expr_recon_loss: 56059829.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60061506.6667; val_optim_loss: 60061506.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8526; val_auprc_score: 0.9569; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 2891343.3241; train_edge_recon_loss: 1214456.5602; train_gene_expr_recon_loss: 56020301.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60126101.1852; train_optim_loss: 60126101.1852; val_kl_reg_loss: 2780986.2500; val_edge_recon_loss: 1189875.6250; val_gene_expr_recon_loss: 55932156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59903017.3333; val_optim_loss: 59903017.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8346; val_auprc_score: 0.9503; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 9190220.5714; train_edge_recon_loss: 1193718.0357; train_gene_expr_recon_loss: 800385536.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 810769472.0000; train_optim_loss: 810769472.0000; val_kl_reg_loss: 8792230.0000; val_edge_recon_loss: 1220879.0625; val_gene_expr_recon_loss: 775118496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 785131616.0000; val_optim_loss: 785131616.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8396; val_auprc_score: 0.9557; val_best_acc_score: 0.8598; val_best_f1_score: 0.9246; train_kl_reg_loss: 8531237.3214; train_edge_recon_loss: 1188832.7232; train_gene_expr_recon_loss: 779729851.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 789449920.0000; train_optim_loss: 789449920.0000; val_kl_reg_loss: 7916204.7500; val_edge_recon_loss: 1145449.2500; val_gene_expr_recon_loss: 769342688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 778404320.0000; val_optim_loss: 778404320.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 35 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
val AUROC score: 0.8978
val AUPRC score: 0.9787
val best accuracy score: 0.8545
val best F1 score: 0.9215
val target rna MSE score: 37.8407
val source rna MSE score: 64.1375
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 1: 0 hours, 3 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8426; val_auprc_score: 0.9551; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 7967103.3571; train_edge_recon_loss: 1191908.1964; train_gene_expr_recon_loss: 767816566.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 776975584.0000; train_optim_loss: 776975584.0000; val_kl_reg_loss: 7783630.7500; val_edge_recon_loss: 1185667.1875; val_gene_expr_recon_loss: 768876992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 777846272.0000; val_optim_loss: 777846272.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8441; val_auprc_score: 0.9549; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 7838747.1786; train_edge_recon_loss: 1205082.0357; train_gene_expr_recon_loss: 767118189.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 776162016.0000; train_optim_loss: 776162016.0000; val_kl_reg_loss: 7651345.5000; val_edge_recon_loss: 1191187.5000; val_gene_expr_recon_loss: 768532896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 777375456.0000; val_optim_loss: 777375456.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8418; val_auprc_score: 0.9545; val_best_acc_score: 0.8545; val_best_f1_score: 0.9216; train_kl_reg_loss: 7715848.5000; train_edge_recon_loss: 1204173.7054; train_gene_expr_recon_loss: 766861472.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 775781494.8571; train_optim_loss: 775781494.8571; val_kl_reg_loss: 7553561.5000; val_edge_recon_loss: 1192190.0000; val_gene_expr_recon_loss: 768052512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 776798272.0000; val_optim_loss: 776798272.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8299; val_auprc_score: 0.9510; val_best_acc_score: 0.8549; val_best_f1_score: 0.9217; train_kl_reg_loss: 7600379.5000; train_edge_recon_loss: 1194288.0357; train_gene_expr_recon_loss: 766640324.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 775434985.1429; train_optim_loss: 775434985.1429; val_kl_reg_loss: 7429435.5000; val_edge_recon_loss: 1170158.1875; val_gene_expr_recon_loss: 767930080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 776529664.0000; val_optim_loss: 776529664.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 38 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.8671
val AUPRC score: 0.9729
val best accuracy score: 0.8625
val best F1 score: 0.9258
val target rna MSE score: 18.6047
val source rna MSE score: 12.2994
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 3: 0 hours, 9 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9279; val_auprc_score: 0.9840; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 2816873.3643; train_edge_recon_loss: 1064239.8036; train_gene_expr_recon_loss: 231711384.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 235592496.5714; train_optim_loss: 235592496.5714; val_kl_reg_loss: 158932.5625; val_edge_recon_loss: 1223259.0000; val_gene_expr_recon_loss: 71014960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72397152.0000; val_optim_loss: 72397152.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9239; val_auprc_score: 0.9839; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 318298.9241; train_edge_recon_loss: 1147221.8929; train_gene_expr_recon_loss: 67021469.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68486991.4286; train_optim_loss: 68486991.4286; val_kl_reg_loss: 316621.8750; val_edge_recon_loss: 1194292.6250; val_gene_expr_recon_loss: 62994964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64505880.0000; val_optim_loss: 64505880.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9224; val_auprc_score: 0.9818; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 408219.1964; train_edge_recon_loss: 1207783.8929; train_gene_expr_recon_loss: 60326616.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61942619.4286; train_optim_loss: 61942619.4286; val_kl_reg_loss: 484248.2500; val_edge_recon_loss: 1211718.1250; val_gene_expr_recon_loss: 58603948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60299916.0000; val_optim_loss: 60299916.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9260; val_auprc_score: 0.9835; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 540487.2946; train_edge_recon_loss: 1196052.3750; train_gene_expr_recon_loss: 57174192.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58910732.0000; train_optim_loss: 58910732.0000; val_kl_reg_loss: 569064.1250; val_edge_recon_loss: 1191383.3750; val_gene_expr_recon_loss: 56005336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57765784.0000; val_optim_loss: 57765784.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9301; val_auprc_score: 0.9850; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 607357.0804; train_edge_recon_loss: 1180454.9643; train_gene_expr_recon_loss: 55169430.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56957242.2857; train_optim_loss: 56957242.2857; val_kl_reg_loss: 614374.8750; val_edge_recon_loss: 1192355.0000; val_gene_expr_recon_loss: 54401228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56207956.0000; val_optim_loss: 56207956.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9241; val_auprc_score: 0.9829; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 640072.5714; train_edge_recon_loss: 1192008.4464; train_gene_expr_recon_loss: 53910882.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55742964.0000; train_optim_loss: 55742964.0000; val_kl_reg_loss: 627123.2500; val_edge_recon_loss: 1185552.1250; val_gene_expr_recon_loss: 53456048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55268724.0000; val_optim_loss: 55268724.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9236; val_auprc_score: 0.9831; val_best_acc_score: 0.8601; val_best_f1_score: 0.9248; train_kl_reg_loss: 662018.3214; train_edge_recon_loss: 1178254.5000; train_gene_expr_recon_loss: 53551796.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55392069.7143; train_optim_loss: 55392069.7143; val_kl_reg_loss: 688169.6250; val_edge_recon_loss: 1137553.8750; val_gene_expr_recon_loss: 52866496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54692220.0000; val_optim_loss: 54692220.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9228; val_auprc_score: 0.9815; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 754692.4375; train_edge_recon_loss: 1200358.6429; train_gene_expr_recon_loss: 52513851.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54468902.2857; train_optim_loss: 54468902.2857; val_kl_reg_loss: 785400.2500; val_edge_recon_loss: 1228095.5000; val_gene_expr_recon_loss: 51853260.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53866756.0000; val_optim_loss: 53866756.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9194; val_auprc_score: 0.9809; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 839128.8125; train_edge_recon_loss: 1199146.7679; train_gene_expr_recon_loss: 51557798.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53596073.7143; train_optim_loss: 53596073.7143; val_kl_reg_loss: 844835.1875; val_edge_recon_loss: 1169952.7500; val_gene_expr_recon_loss: 54981568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56996356.0000; val_optim_loss: 56996356.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9223; val_auprc_score: 0.9810; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 920276.4911; train_edge_recon_loss: 1184537.8571; train_gene_expr_recon_loss: 52090118.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54194932.5714; train_optim_loss: 54194932.5714; val_kl_reg_loss: 986088.3750; val_edge_recon_loss: 1216545.3750; val_gene_expr_recon_loss: 51560408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53763040.0000; val_optim_loss: 53763040.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9149; val_auprc_score: 0.9772; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 1082782.4196; train_edge_recon_loss: 1176851.0357; train_gene_expr_recon_loss: 51244957.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53504590.2857; train_optim_loss: 53504590.2857; val_kl_reg_loss: 1133780.2500; val_edge_recon_loss: 1229057.2500; val_gene_expr_recon_loss: 50985256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53348092.0000; val_optim_loss: 53348092.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9199; val_auprc_score: 0.9796; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 1209316.3036; train_edge_recon_loss: 1191014.6071; train_gene_expr_recon_loss: 50663880.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53064211.4286; train_optim_loss: 53064211.4286; val_kl_reg_loss: 1217708.1250; val_edge_recon_loss: 1203021.0000; val_gene_expr_recon_loss: 50371788.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52792516.0000; val_optim_loss: 52792516.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9144; val_auprc_score: 0.9783; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 1271855.1071; train_edge_recon_loss: 1194338.9821; train_gene_expr_recon_loss: 50012559.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52478753.1429; train_optim_loss: 52478753.1429; val_kl_reg_loss: 1254073.0000; val_edge_recon_loss: 1182634.0000; val_gene_expr_recon_loss: 49675192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52111900.0000; val_optim_loss: 52111900.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9195; val_auprc_score: 0.9790; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 1292157.7679; train_edge_recon_loss: 1178063.4821; train_gene_expr_recon_loss: 49285259.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51755480.5714; train_optim_loss: 51755480.5714; val_kl_reg_loss: 1256214.5000; val_edge_recon_loss: 1194298.3750; val_gene_expr_recon_loss: 48902080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51352592.0000; val_optim_loss: 51352592.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9180; val_auprc_score: 0.9799; val_best_acc_score: 0.8586; val_best_f1_score: 0.9239; train_kl_reg_loss: 1290417.7143; train_edge_recon_loss: 1210186.9107; train_gene_expr_recon_loss: 48509650.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51010254.8571; train_optim_loss: 51010254.8571; val_kl_reg_loss: 1248521.2500; val_edge_recon_loss: 1150354.1250; val_gene_expr_recon_loss: 48125992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50524868.0000; val_optim_loss: 50524868.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9155; val_auprc_score: 0.9773; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 1276849.1786; train_edge_recon_loss: 1204179.2321; train_gene_expr_recon_loss: 47726162.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50207190.2857; train_optim_loss: 50207190.2857; val_kl_reg_loss: 1229523.5000; val_edge_recon_loss: 1228096.3750; val_gene_expr_recon_loss: 47320520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49778140.0000; val_optim_loss: 49778140.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9194; val_auprc_score: 0.9790; val_best_acc_score: 0.8475; val_best_f1_score: 0.9174; train_kl_reg_loss: 1256268.5357; train_edge_recon_loss: 1196110.8393; train_gene_expr_recon_loss: 46913066.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49365446.8571; train_optim_loss: 49365446.8571; val_kl_reg_loss: 1209859.6250; val_edge_recon_loss: 1240566.5000; val_gene_expr_recon_loss: 46501720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48952144.0000; val_optim_loss: 48952144.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9231; val_auprc_score: 0.9799; val_best_acc_score: 0.8462; val_best_f1_score: 0.9167; train_kl_reg_loss: 1234688.8571; train_edge_recon_loss: 1182625.9464; train_gene_expr_recon_loss: 46101890.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48519206.2857; train_optim_loss: 48519206.2857; val_kl_reg_loss: 1185159.7500; val_edge_recon_loss: 1251082.6250; val_gene_expr_recon_loss: 45687892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48124136.0000; val_optim_loss: 48124136.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9159; val_auprc_score: 0.9783; val_best_acc_score: 0.8473; val_best_f1_score: 0.9174; train_kl_reg_loss: 1210943.1786; train_edge_recon_loss: 1194729.5357; train_gene_expr_recon_loss: 45306418.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47712091.4286; train_optim_loss: 47712091.4286; val_kl_reg_loss: 1163774.5000; val_edge_recon_loss: 1241523.6250; val_gene_expr_recon_loss: 44924036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47329336.0000; val_optim_loss: 47329336.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9203; val_auprc_score: 0.9793; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 1186861.7321; train_edge_recon_loss: 1194516.2321; train_gene_expr_recon_loss: 44543253.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46924631.4286; train_optim_loss: 46924631.4286; val_kl_reg_loss: 1140194.1250; val_edge_recon_loss: 1230977.6250; val_gene_expr_recon_loss: 44177656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46548828.0000; val_optim_loss: 46548828.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9114; val_auprc_score: 0.9771; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 1162862.8750; train_edge_recon_loss: 1196608.0893; train_gene_expr_recon_loss: 43843080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46202551.4286; train_optim_loss: 46202551.4286; val_kl_reg_loss: 1116702.3750; val_edge_recon_loss: 1223287.5000; val_gene_expr_recon_loss: 43514776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45854768.0000; val_optim_loss: 45854768.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9108; val_auprc_score: 0.9771; val_best_acc_score: 0.8497; val_best_f1_score: 0.9187; train_kl_reg_loss: 1138818.2857; train_edge_recon_loss: 1189074.2321; train_gene_expr_recon_loss: 43207160.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45535053.1429; train_optim_loss: 45535053.1429; val_kl_reg_loss: 1093074.6250; val_edge_recon_loss: 1222325.2500; val_gene_expr_recon_loss: 42907360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45222760.0000; val_optim_loss: 45222760.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9148; val_auprc_score: 0.9795; val_best_acc_score: 0.8565; val_best_f1_score: 0.9227; train_kl_reg_loss: 1115433.7321; train_edge_recon_loss: 1199616.8571; train_gene_expr_recon_loss: 42637352.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44952402.8571; train_optim_loss: 44952402.8571; val_kl_reg_loss: 1070912.3750; val_edge_recon_loss: 1167019.3750; val_gene_expr_recon_loss: 42391588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44629520.0000; val_optim_loss: 44629520.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9127; val_auprc_score: 0.9768; val_best_acc_score: 0.8410; val_best_f1_score: 0.9137; train_kl_reg_loss: 1091921.9286; train_edge_recon_loss: 1192227.3750; train_gene_expr_recon_loss: 42149985.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44434134.2857; train_optim_loss: 44434134.2857; val_kl_reg_loss: 1048109.6875; val_edge_recon_loss: 1292827.7500; val_gene_expr_recon_loss: 41930512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44271448.0000; val_optim_loss: 44271448.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9118; val_auprc_score: 0.9796; val_best_acc_score: 0.8595; val_best_f1_score: 0.9245; train_kl_reg_loss: 1069203.6250; train_edge_recon_loss: 1191112.0000; train_gene_expr_recon_loss: 41718359.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43978674.8571; train_optim_loss: 43978674.8571; val_kl_reg_loss: 1027454.1250; val_edge_recon_loss: 1142481.7500; val_gene_expr_recon_loss: 41554976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43724912.0000; val_optim_loss: 43724912.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9144; val_auprc_score: 0.9796; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 1047130.6518; train_edge_recon_loss: 1212103.0357; train_gene_expr_recon_loss: 41373856.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43633090.8571; train_optim_loss: 43633090.8571; val_kl_reg_loss: 1004885.6875; val_edge_recon_loss: 1203985.7500; val_gene_expr_recon_loss: 41229052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43437924.0000; val_optim_loss: 43437924.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9103; val_auprc_score: 0.9796; val_best_acc_score: 0.8566; val_best_f1_score: 0.9228; train_kl_reg_loss: 1024477.5982; train_edge_recon_loss: 1195770.1250; train_gene_expr_recon_loss: 41073884.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43294132.0000; train_optim_loss: 43294132.0000; val_kl_reg_loss: 983702.0000; val_edge_recon_loss: 1166039.5000; val_gene_expr_recon_loss: 40955072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43104812.0000; val_optim_loss: 43104812.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9128; val_auprc_score: 0.9789; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 1002417.9196; train_edge_recon_loss: 1184346.8036; train_gene_expr_recon_loss: 40821156.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43007921.1429; train_optim_loss: 43007921.1429; val_kl_reg_loss: 961602.1250; val_edge_recon_loss: 1205919.6250; val_gene_expr_recon_loss: 40729640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42897160.0000; val_optim_loss: 42897160.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9076; val_auprc_score: 0.9785; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 981275.0446; train_edge_recon_loss: 1197849.6786; train_gene_expr_recon_loss: 40617070.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42796195.4286; train_optim_loss: 42796195.4286; val_kl_reg_loss: 944234.5000; val_edge_recon_loss: 1190410.5000; val_gene_expr_recon_loss: 40555024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42689668.0000; val_optim_loss: 42689668.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9171; val_auprc_score: 0.9812; val_best_acc_score: 0.8495; val_best_f1_score: 0.9186; train_kl_reg_loss: 960504.7679; train_edge_recon_loss: 1185922.5357; train_gene_expr_recon_loss: 40437620.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42584047.4286; train_optim_loss: 42584047.4286; val_kl_reg_loss: 920638.0000; val_edge_recon_loss: 1224245.0000; val_gene_expr_recon_loss: 40376396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42521280.0000; val_optim_loss: 42521280.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9046; val_auprc_score: 0.9775; val_best_acc_score: 0.8495; val_best_f1_score: 0.9186; train_kl_reg_loss: 939867.5446; train_edge_recon_loss: 1197819.0714; train_gene_expr_recon_loss: 40297936.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42435622.2857; train_optim_loss: 42435622.2857; val_kl_reg_loss: 899629.0000; val_edge_recon_loss: 1224244.6250; val_gene_expr_recon_loss: 40230472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42354344.0000; val_optim_loss: 42354344.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8956; val_auprc_score: 0.9743; val_best_acc_score: 0.8482; val_best_f1_score: 0.9178; train_kl_reg_loss: 919257.1161; train_edge_recon_loss: 1200994.4643; train_gene_expr_recon_loss: 40163404.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42283657.1429; train_optim_loss: 42283657.1429; val_kl_reg_loss: 881704.1875; val_edge_recon_loss: 1234810.7500; val_gene_expr_recon_loss: 40122308.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42238824.0000; val_optim_loss: 42238824.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9047; val_auprc_score: 0.9781; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 899350.3304; train_edge_recon_loss: 1175768.5536; train_gene_expr_recon_loss: 40043428.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42118548.0000; train_optim_loss: 42118548.0000; val_kl_reg_loss: 863447.3750; val_edge_recon_loss: 1181651.6250; val_gene_expr_recon_loss: 40019432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42064532.0000; val_optim_loss: 42064532.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9043; val_auprc_score: 0.9790; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 879978.2768; train_edge_recon_loss: 1190944.8214; train_gene_expr_recon_loss: 39950754.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42021676.5714; train_optim_loss: 42021676.5714; val_kl_reg_loss: 845207.8750; val_edge_recon_loss: 1191377.0000; val_gene_expr_recon_loss: 39927388.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41963972.0000; val_optim_loss: 41963972.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8943; val_auprc_score: 0.9773; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 860434.8304; train_edge_recon_loss: 1193026.6071; train_gene_expr_recon_loss: 39850782.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41904244.5714; train_optim_loss: 41904244.5714; val_kl_reg_loss: 826011.5000; val_edge_recon_loss: 1181651.2500; val_gene_expr_recon_loss: 39840040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41847704.0000; val_optim_loss: 41847704.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8964; val_auprc_score: 0.9773; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 841788.0625; train_edge_recon_loss: 1197967.8750; train_gene_expr_recon_loss: 39778754.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41818511.4286; train_optim_loss: 41818511.4286; val_kl_reg_loss: 806736.5000; val_edge_recon_loss: 1182622.0000; val_gene_expr_recon_loss: 39753304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41742664.0000; val_optim_loss: 41742664.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8989; val_auprc_score: 0.9775; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 823227.9196; train_edge_recon_loss: 1208965.6250; train_gene_expr_recon_loss: 39717247.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41749440.5714; train_optim_loss: 41749440.5714; val_kl_reg_loss: 790109.7500; val_edge_recon_loss: 1215569.2500; val_gene_expr_recon_loss: 39690156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41695836.0000; val_optim_loss: 41695836.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8921; val_auprc_score: 0.9778; val_best_acc_score: 0.8576; val_best_f1_score: 0.9233; train_kl_reg_loss: 804887.9286; train_edge_recon_loss: 1199153.6964; train_gene_expr_recon_loss: 39643636.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41647677.7143; train_optim_loss: 41647677.7143; val_kl_reg_loss: 771202.3125; val_edge_recon_loss: 1158194.3750; val_gene_expr_recon_loss: 39617528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41546924.0000; val_optim_loss: 41546924.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8956; val_auprc_score: 0.9772; val_best_acc_score: 0.8497; val_best_f1_score: 0.9187; train_kl_reg_loss: 786876.6339; train_edge_recon_loss: 1192871.7679; train_gene_expr_recon_loss: 39577246.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41556994.8571; train_optim_loss: 41556994.8571; val_kl_reg_loss: 755400.5000; val_edge_recon_loss: 1222308.3750; val_gene_expr_recon_loss: 39565288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41542996.0000; val_optim_loss: 41542996.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8859; val_auprc_score: 0.9749; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 769750.5357; train_edge_recon_loss: 1194863.4643; train_gene_expr_recon_loss: 39516154.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41480769.1429; train_optim_loss: 41480769.1429; val_kl_reg_loss: 738051.5625; val_edge_recon_loss: 1218454.1250; val_gene_expr_recon_loss: 39509160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41465664.0000; val_optim_loss: 41465664.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8917; val_auprc_score: 0.9770; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 752661.9107; train_edge_recon_loss: 1200497.1607; train_gene_expr_recon_loss: 39463362.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41416521.7143; train_optim_loss: 41416521.7143; val_kl_reg_loss: 721972.5000; val_edge_recon_loss: 1201061.7500; val_gene_expr_recon_loss: 39454232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41377268.0000; val_optim_loss: 41377268.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8773; val_auprc_score: 0.9741; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 735664.7232; train_edge_recon_loss: 1205773.6786; train_gene_expr_recon_loss: 39405120.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41346558.8571; train_optim_loss: 41346558.8571; val_kl_reg_loss: 704805.5000; val_edge_recon_loss: 1161121.0000; val_gene_expr_recon_loss: 39396252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41262180.0000; val_optim_loss: 41262180.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8867; val_auprc_score: 0.9754; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 719327.0268; train_edge_recon_loss: 1193581.2500; train_gene_expr_recon_loss: 39360297.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41273205.1429; train_optim_loss: 41273205.1429; val_kl_reg_loss: 690883.5000; val_edge_recon_loss: 1188441.8750; val_gene_expr_recon_loss: 39359152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41238476.0000; val_optim_loss: 41238476.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8811; val_auprc_score: 0.9760; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 703458.8214; train_edge_recon_loss: 1195318.1964; train_gene_expr_recon_loss: 39314194.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41212970.8571; train_optim_loss: 41212970.8571; val_kl_reg_loss: 675148.1250; val_edge_recon_loss: 1168944.8750; val_gene_expr_recon_loss: 39310332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41154424.0000; val_optim_loss: 41154424.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8819; val_auprc_score: 0.9740; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 687565.1607; train_edge_recon_loss: 1198918.4464; train_gene_expr_recon_loss: 39264609.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41151093.1429; train_optim_loss: 41151093.1429; val_kl_reg_loss: 659421.3125; val_edge_recon_loss: 1208784.3750; val_gene_expr_recon_loss: 39264636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41132840.0000; val_optim_loss: 41132840.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8827; val_auprc_score: 0.9751; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 672262.8036; train_edge_recon_loss: 1197735.4107; train_gene_expr_recon_loss: 39224117.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41094115.4286; train_optim_loss: 41094115.4286; val_kl_reg_loss: 643945.1250; val_edge_recon_loss: 1216502.7500; val_gene_expr_recon_loss: 39214448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41074896.0000; val_optim_loss: 41074896.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8736; val_auprc_score: 0.9728; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 657053.1429; train_edge_recon_loss: 1201144.0536; train_gene_expr_recon_loss: 39177909.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41036106.8571; train_optim_loss: 41036106.8571; val_kl_reg_loss: 630159.8750; val_edge_recon_loss: 1227089.7500; val_gene_expr_recon_loss: 39167988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41025236.0000; val_optim_loss: 41025236.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8757; val_auprc_score: 0.9728; val_best_acc_score: 0.8482; val_best_f1_score: 0.9178; train_kl_reg_loss: 642603.9643; train_edge_recon_loss: 1199916.6607; train_gene_expr_recon_loss: 39137726.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40980248.0000; train_optim_loss: 40980248.0000; val_kl_reg_loss: 616809.8750; val_edge_recon_loss: 1234764.8750; val_gene_expr_recon_loss: 39136492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40988068.0000; val_optim_loss: 40988068.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8719; val_auprc_score: 0.9718; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 628069.7411; train_edge_recon_loss: 1191714.1071; train_gene_expr_recon_loss: 39089176.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40908959.4286; train_optim_loss: 40908959.4286; val_kl_reg_loss: 602077.0000; val_edge_recon_loss: 1232844.7500; val_gene_expr_recon_loss: 39080720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40915640.0000; val_optim_loss: 40915640.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8696; val_auprc_score: 0.9726; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 614372.8839; train_edge_recon_loss: 1210871.1786; train_gene_expr_recon_loss: 39050524.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40875769.1429; train_optim_loss: 40875769.1429; val_kl_reg_loss: 589905.2500; val_edge_recon_loss: 1191317.3750; val_gene_expr_recon_loss: 39057556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40838780.0000; val_optim_loss: 40838780.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8635; val_auprc_score: 0.9720; val_best_acc_score: 0.8593; val_best_f1_score: 0.9243; train_kl_reg_loss: 600083.7232; train_edge_recon_loss: 1195474.9643; train_gene_expr_recon_loss: 39014093.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40809652.0000; train_optim_loss: 40809652.0000; val_kl_reg_loss: 575953.0000; val_edge_recon_loss: 1144387.1250; val_gene_expr_recon_loss: 39012252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40732592.0000; val_optim_loss: 40732592.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8714; val_auprc_score: 0.9719; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 587089.3125; train_edge_recon_loss: 1182912.2679; train_gene_expr_recon_loss: 38979744.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40749745.7143; train_optim_loss: 40749745.7143; val_kl_reg_loss: 562133.5625; val_edge_recon_loss: 1201962.5000; val_gene_expr_recon_loss: 38972232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40736328.0000; val_optim_loss: 40736328.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8680; val_auprc_score: 0.9735; val_best_acc_score: 0.8609; val_best_f1_score: 0.9252; train_kl_reg_loss: 573922.1518; train_edge_recon_loss: 1193216.7321; train_gene_expr_recon_loss: 38932178.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40699317.1429; train_optim_loss: 40699317.1429; val_kl_reg_loss: 551023.5625; val_edge_recon_loss: 1131549.0000; val_gene_expr_recon_loss: 38937640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40620212.0000; val_optim_loss: 40620212.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8691; val_auprc_score: 0.9732; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 560876.0446; train_edge_recon_loss: 1194118.3571; train_gene_expr_recon_loss: 38903142.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40658137.1429; train_optim_loss: 40658137.1429; val_kl_reg_loss: 537175.3125; val_edge_recon_loss: 1187380.1250; val_gene_expr_recon_loss: 38893836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40618392.0000; val_optim_loss: 40618392.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8630; val_auprc_score: 0.9712; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 548605.6429; train_edge_recon_loss: 1200264.7321; train_gene_expr_recon_loss: 38864848.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40613719.4286; train_optim_loss: 40613719.4286; val_kl_reg_loss: 525939.4375; val_edge_recon_loss: 1203884.0000; val_gene_expr_recon_loss: 38860564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40590388.0000; val_optim_loss: 40590388.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8585; val_auprc_score: 0.9702; val_best_acc_score: 0.8582; val_best_f1_score: 0.9237; train_kl_reg_loss: 536139.8393; train_edge_recon_loss: 1195043.5179; train_gene_expr_recon_loss: 38823262.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40554445.7143; train_optim_loss: 40554445.7143; val_kl_reg_loss: 514025.8438; val_edge_recon_loss: 1153169.3750; val_gene_expr_recon_loss: 38820716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40487912.0000; val_optim_loss: 40487912.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8649; val_auprc_score: 0.9724; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 524211.7188; train_edge_recon_loss: 1193629.2143; train_gene_expr_recon_loss: 38787888.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40505729.7143; train_optim_loss: 40505729.7143; val_kl_reg_loss: 502851.5938; val_edge_recon_loss: 1192232.8750; val_gene_expr_recon_loss: 38770584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40465668.0000; val_optim_loss: 40465668.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8621; val_auprc_score: 0.9713; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 512675.9286; train_edge_recon_loss: 1215633.3393; train_gene_expr_recon_loss: 38746580.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40474889.1429; train_optim_loss: 40474889.1429; val_kl_reg_loss: 491803.9375; val_edge_recon_loss: 1179572.7500; val_gene_expr_recon_loss: 38743104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40414480.0000; val_optim_loss: 40414480.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8613; val_auprc_score: 0.9714; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 501069.3393; train_edge_recon_loss: 1184473.5714; train_gene_expr_recon_loss: 38709303.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40394846.8571; train_optim_loss: 40394846.8571; val_kl_reg_loss: 480331.0625; val_edge_recon_loss: 1170757.5000; val_gene_expr_recon_loss: 38703588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40354676.0000; val_optim_loss: 40354676.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8557; val_auprc_score: 0.9686; val_best_acc_score: 0.8518; val_best_f1_score: 0.9199; train_kl_reg_loss: 490021.4598; train_edge_recon_loss: 1200832.8929; train_gene_expr_recon_loss: 38670037.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40360891.4286; train_optim_loss: 40360891.4286; val_kl_reg_loss: 470318.5000; val_edge_recon_loss: 1210563.2500; val_gene_expr_recon_loss: 38677404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40358284.0000; val_optim_loss: 40358284.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8653; val_auprc_score: 0.9730; val_best_acc_score: 0.8586; val_best_f1_score: 0.9238; train_kl_reg_loss: 478974.7946; train_edge_recon_loss: 1205250.6071; train_gene_expr_recon_loss: 38638825.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40323051.4286; train_optim_loss: 40323051.4286; val_kl_reg_loss: 459874.5000; val_edge_recon_loss: 1160945.1250; val_gene_expr_recon_loss: 38639692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40260512.0000; val_optim_loss: 40260512.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8616; val_auprc_score: 0.9698; val_best_acc_score: 0.8552; val_best_f1_score: 0.9218; train_kl_reg_loss: 468063.6518; train_edge_recon_loss: 1160997.1250; train_gene_expr_recon_loss: 38600500.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40229560.5714; train_optim_loss: 40229560.5714; val_kl_reg_loss: 449159.4375; val_edge_recon_loss: 1194054.8750; val_gene_expr_recon_loss: 38608820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40252036.0000; val_optim_loss: 40252036.0000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.8522; val_auprc_score: 0.9685; val_best_acc_score: 0.8530; val_best_f1_score: 0.9205; train_kl_reg_loss: 457597.9821; train_edge_recon_loss: 1196566.4821; train_gene_expr_recon_loss: 38565300.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40219464.0000; train_optim_loss: 40219464.0000; val_kl_reg_loss: 439159.6875; val_edge_recon_loss: 1211490.8750; val_gene_expr_recon_loss: 38564312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40214964.0000; val_optim_loss: 40214964.0000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.8517; val_auprc_score: 0.9684; val_best_acc_score: 0.8571; val_best_f1_score: 0.9228; train_kl_reg_loss: 447809.3884; train_edge_recon_loss: 1183643.4821; train_gene_expr_recon_loss: 38536421.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40167874.8571; train_optim_loss: 40167874.8571; val_kl_reg_loss: 429275.8125; val_edge_recon_loss: 1180436.6250; val_gene_expr_recon_loss: 38536544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40146256.0000; val_optim_loss: 40146256.0000
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.8554; val_auprc_score: 0.9701; val_best_acc_score: 0.8572; val_best_f1_score: 0.9229; train_kl_reg_loss: 437903.3438; train_edge_recon_loss: 1208945.1250; train_gene_expr_recon_loss: 38502628.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40149477.1429; train_optim_loss: 40149477.1429; val_kl_reg_loss: 420004.9375; val_edge_recon_loss: 1182361.3750; val_gene_expr_recon_loss: 38511008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40113376.0000; val_optim_loss: 40113376.0000
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.8574; val_auprc_score: 0.9672; val_best_acc_score: 0.8497; val_best_f1_score: 0.9185; train_kl_reg_loss: 428320.4286; train_edge_recon_loss: 1201529.5714; train_gene_expr_recon_loss: 38476309.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40106159.4286; train_optim_loss: 40106159.4286; val_kl_reg_loss: 410737.4375; val_edge_recon_loss: 1246978.5000; val_gene_expr_recon_loss: 38472192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40129908.0000; val_optim_loss: 40129908.0000
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.8557; val_auprc_score: 0.9689; val_best_acc_score: 0.8514; val_best_f1_score: 0.9194; train_kl_reg_loss: 418727.5536; train_edge_recon_loss: 1191637.4464; train_gene_expr_recon_loss: 38441376.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40051740.5714; train_optim_loss: 40051740.5714; val_kl_reg_loss: 401000.7188; val_edge_recon_loss: 1243117.1250; val_gene_expr_recon_loss: 38438724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40082840.0000; val_optim_loss: 40082840.0000
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.8514; val_auprc_score: 0.9692; val_best_acc_score: 0.8622; val_best_f1_score: 0.9255; train_kl_reg_loss: 409577.3616; train_edge_recon_loss: 1194737.9821; train_gene_expr_recon_loss: 38408298.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40012613.7143; train_optim_loss: 40012613.7143; val_kl_reg_loss: 392627.8125; val_edge_recon_loss: 1172500.1250; val_gene_expr_recon_loss: 38405448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39970576.0000; val_optim_loss: 39970576.0000
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.8556; val_auprc_score: 0.9692; val_best_acc_score: 0.8559; val_best_f1_score: 0.9219; train_kl_reg_loss: 400461.3036; train_edge_recon_loss: 1185396.9107; train_gene_expr_recon_loss: 38379148.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39965006.2857; train_optim_loss: 39965006.2857; val_kl_reg_loss: 383986.8750; val_edge_recon_loss: 1219025.2500; val_gene_expr_recon_loss: 38371200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39974212.0000; val_optim_loss: 39974212.0000
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.8576; val_auprc_score: 0.9709; val_best_acc_score: 0.8624; val_best_f1_score: 0.9255; train_kl_reg_loss: 391874.1696; train_edge_recon_loss: 1175512.2679; train_gene_expr_recon_loss: 38342792.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39910177.7143; train_optim_loss: 39910177.7143; val_kl_reg_loss: 375092.7500; val_edge_recon_loss: 1183153.1250; val_gene_expr_recon_loss: 38338436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39896680.0000; val_optim_loss: 39896680.0000
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.8607; val_auprc_score: 0.9710; val_best_acc_score: 0.8627; val_best_f1_score: 0.9258; train_kl_reg_loss: 383221.9598; train_edge_recon_loss: 1191981.4643; train_gene_expr_recon_loss: 38320553.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39895756.5714; train_optim_loss: 39895756.5714; val_kl_reg_loss: 367907.9688; val_edge_recon_loss: 1167523.5000; val_gene_expr_recon_loss: 38320784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39856216.0000; val_optim_loss: 39856216.0000
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.8495; val_auprc_score: 0.9691; val_best_acc_score: 0.8634; val_best_f1_score: 0.9261; train_kl_reg_loss: 375035.6875; train_edge_recon_loss: 1189778.2321; train_gene_expr_recon_loss: 38284221.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39849036.5714; train_optim_loss: 39849036.5714; val_kl_reg_loss: 359996.9375; val_edge_recon_loss: 1174337.7500; val_gene_expr_recon_loss: 38287360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39821696.0000; val_optim_loss: 39821696.0000
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.8488; val_auprc_score: 0.9670; val_best_acc_score: 0.8618; val_best_f1_score: 0.9251; train_kl_reg_loss: 366755.7634; train_edge_recon_loss: 1197411.4286; train_gene_expr_recon_loss: 38234467.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39798634.8571; train_optim_loss: 39798634.8571; val_kl_reg_loss: 351287.7500; val_edge_recon_loss: 1194718.1250; val_gene_expr_recon_loss: 37967476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39513480.0000; val_optim_loss: 39513480.0000
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.8616; val_auprc_score: 0.9691; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 779914104565.3973; train_edge_recon_loss: 1150094.5000; train_gene_expr_recon_loss: 706160336.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 780621414172.0000; train_optim_loss: 780621414172.0000; val_kl_reg_loss: 77802913792.0000; val_edge_recon_loss: 1191311.5000; val_gene_expr_recon_loss: 187612160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 77991714816.0000; val_optim_loss: 77991714816.0000
Epoch 75/400 |███-----------------| 18.8% val_auroc_score: 0.8562; val_auprc_score: 0.9603; val_best_acc_score: 0.8499; val_best_f1_score: 0.9189; train_kl_reg_loss: 80567839721.3929; train_edge_recon_loss: 1121911.3036; train_gene_expr_recon_loss: 1157952658.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 81726916809.1429; train_optim_loss: 81726916809.1429; val_kl_reg_loss: 920759042048.0000; val_edge_recon_loss: 1220397.6250; val_gene_expr_recon_loss: 1019701632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 921779961856.0000; val_optim_loss: 921779961856.0000
Epoch 76/400 |███-----------------| 19.0% val_auroc_score: 0.8297; val_auprc_score: 0.9488; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 59675427248463688.0000; train_edge_recon_loss: 1172982.8214; train_gene_expr_recon_loss: 1226909129.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59675428453896616.0000; train_optim_loss: 59675428453896616.0000; val_kl_reg_loss: 72096304.0000; val_edge_recon_loss: 1223288.0000; val_gene_expr_recon_loss: 919646656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 992966272.0000; val_optim_loss: 992966272.0000
Epoch 77/400 |███-----------------| 19.2% val_auroc_score: 0.8326; val_auprc_score: 0.9499; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 3658191909426.5713; train_edge_recon_loss: 1161279.2857; train_gene_expr_recon_loss: 1022208822.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3659215478390.8569; train_optim_loss: 3659215478390.8569; val_kl_reg_loss: 2814347837440.0000; val_edge_recon_loss: 1209789.8750; val_gene_expr_recon_loss: 814519616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2815163629568.0000; val_optim_loss: 2815163629568.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 78/400 |███-----------------| 19.5% val_auroc_score: 0.8380; val_auprc_score: 0.9516; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 494905439841.2857; train_edge_recon_loss: 1149890.5000; train_gene_expr_recon_loss: 927674075.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 495834286464.0000; train_optim_loss: 495834286464.0000; val_kl_reg_loss: 9786758.0000; val_edge_recon_loss: 1203988.3750; val_gene_expr_recon_loss: 794043968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 805034688.0000; val_optim_loss: 805034688.0000
Epoch 79/400 |███-----------------| 19.8% val_auroc_score: 0.8166; val_auprc_score: 0.9419; val_best_acc_score: 0.8448; val_best_f1_score: 0.9158; train_kl_reg_loss: 8663816.8571; train_edge_recon_loss: 1201669.5893; train_gene_expr_recon_loss: 790885147.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 800750628.5714; train_optim_loss: 800750628.5714; val_kl_reg_loss: 7957197.0000; val_edge_recon_loss: 1262518.7500; val_gene_expr_recon_loss: 786965568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 796185280.0000; val_optim_loss: 796185280.0000
Epoch 80/400 |████----------------| 20.0% val_auroc_score: 0.8409; val_auprc_score: 0.9536; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 8132504.5000; train_edge_recon_loss: 1174910.4107; train_gene_expr_recon_loss: 784581284.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 793888694.8571; train_optim_loss: 793888694.8571; val_kl_reg_loss: 7804196.0000; val_edge_recon_loss: 1186526.1250; val_gene_expr_recon_loss: 780033280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 789024000.0000; val_optim_loss: 789024000.0000
Epoch 81/400 |████----------------| 20.2% val_auroc_score: 0.8310; val_auprc_score: 0.9501; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 7952149.9286; train_edge_recon_loss: 1197660.5536; train_gene_expr_recon_loss: 778156836.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 787306642.2857; train_optim_loss: 787306642.2857; val_kl_reg_loss: 7628474.5000; val_edge_recon_loss: 1189442.6250; val_gene_expr_recon_loss: 774987840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 783805760.0000; val_optim_loss: 783805760.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 4 sec.
Using best model state, which was in epoch 73.

--- MODEL EVALUATION ---
val AUROC score: 0.8688
val AUPRC score: 0.9728
val best accuracy score: 0.8609
val best F1 score: 0.9247
val target rna MSE score: 13.8780
val source rna MSE score: 11.5529
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 2: 0 hours, 11 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9106; val_auprc_score: 0.9807; val_best_acc_score: 0.8470; val_best_f1_score: 0.9172; train_kl_reg_loss: 225152.1124; train_edge_recon_loss: 1069287.4375; train_gene_expr_recon_loss: 112178638.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 113473077.1429; train_optim_loss: 113473077.1429; val_kl_reg_loss: 180665.7969; val_edge_recon_loss: 1244338.8750; val_gene_expr_recon_loss: 73278016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74703024.0000; val_optim_loss: 74703024.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9074; val_auprc_score: 0.9810; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 200083.6641; train_edge_recon_loss: 1144887.4107; train_gene_expr_recon_loss: 63181683.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64526654.8571; train_optim_loss: 64526654.8571; val_kl_reg_loss: 261099.5938; val_edge_recon_loss: 1195251.0000; val_gene_expr_recon_loss: 55896616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57352968.0000; val_optim_loss: 57352968.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9021; val_auprc_score: 0.9792; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 334804.1696; train_edge_recon_loss: 1182361.6250; train_gene_expr_recon_loss: 55665890.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57183057.1429; train_optim_loss: 57183057.1429; val_kl_reg_loss: 391666.3125; val_edge_recon_loss: 1194285.8750; val_gene_expr_recon_loss: 52465088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54051040.0000; val_optim_loss: 54051040.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8955; val_auprc_score: 0.9781; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 432515.0045; train_edge_recon_loss: 1189601.6964; train_gene_expr_recon_loss: 52754559.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54376676.0000; train_optim_loss: 54376676.0000; val_kl_reg_loss: 443630.6250; val_edge_recon_loss: 1193315.6250; val_gene_expr_recon_loss: 51143896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52780844.0000; val_optim_loss: 52780844.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9042; val_auprc_score: 0.9790; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 464998.7946; train_edge_recon_loss: 1203391.1607; train_gene_expr_recon_loss: 51084478.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52752868.5714; train_optim_loss: 52752868.5714; val_kl_reg_loss: 457687.8750; val_edge_recon_loss: 1208810.3750; val_gene_expr_recon_loss: 50334284.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52000784.0000; val_optim_loss: 52000784.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9014; val_auprc_score: 0.9789; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 479321.6205; train_edge_recon_loss: 1192993.7500; train_gene_expr_recon_loss: 50066386.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51738701.7143; train_optim_loss: 51738701.7143; val_kl_reg_loss: 472365.9375; val_edge_recon_loss: 1191372.8750; val_gene_expr_recon_loss: 49722472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51386212.0000; val_optim_loss: 51386212.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9006; val_auprc_score: 0.9787; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 486207.9732; train_edge_recon_loss: 1194287.1071; train_gene_expr_recon_loss: 49377362.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51057857.1429; train_optim_loss: 51057857.1429; val_kl_reg_loss: 467407.9375; val_edge_recon_loss: 1187485.3750; val_gene_expr_recon_loss: 49162312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50817204.0000; val_optim_loss: 50817204.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8949; val_auprc_score: 0.9778; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 478828.8750; train_edge_recon_loss: 1198254.4821; train_gene_expr_recon_loss: 48863017.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50540101.1429; train_optim_loss: 50540101.1429; val_kl_reg_loss: 459242.3750; val_edge_recon_loss: 1192343.2500; val_gene_expr_recon_loss: 48686876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50338460.0000; val_optim_loss: 50338460.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9017; val_auprc_score: 0.9782; val_best_acc_score: 0.8434; val_best_f1_score: 0.9150; train_kl_reg_loss: 468256.2321; train_edge_recon_loss: 1179560.9643; train_gene_expr_recon_loss: 48453789.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50101606.2857; train_optim_loss: 50101606.2857; val_kl_reg_loss: 448465.4062; val_edge_recon_loss: 1273900.2500; val_gene_expr_recon_loss: 48269212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49991576.0000; val_optim_loss: 49991576.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8826; val_auprc_score: 0.9747; val_best_acc_score: 0.8576; val_best_f1_score: 0.9233; train_kl_reg_loss: 457969.1027; train_edge_recon_loss: 1198049.4464; train_gene_expr_recon_loss: 48098739.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49754758.2857; train_optim_loss: 49754758.2857; val_kl_reg_loss: 437960.0000; val_edge_recon_loss: 1158193.8750; val_gene_expr_recon_loss: 47925552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49521704.0000; val_optim_loss: 49521704.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8911; val_auprc_score: 0.9768; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 446393.2188; train_edge_recon_loss: 1184141.1964; train_gene_expr_recon_loss: 47756849.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49387383.4286; train_optim_loss: 49387383.4286; val_kl_reg_loss: 426649.0938; val_edge_recon_loss: 1196220.8750; val_gene_expr_recon_loss: 47588416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49211288.0000; val_optim_loss: 49211288.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8963; val_auprc_score: 0.9783; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 434971.5223; train_edge_recon_loss: 1184534.7143; train_gene_expr_recon_loss: 47398085.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49017592.0000; train_optim_loss: 49017592.0000; val_kl_reg_loss: 415859.4375; val_edge_recon_loss: 1203970.7500; val_gene_expr_recon_loss: 47212564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48832396.0000; val_optim_loss: 48832396.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8851; val_auprc_score: 0.9767; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 424468.4866; train_edge_recon_loss: 1188737.5179; train_gene_expr_recon_loss: 47010974.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48624179.4286; train_optim_loss: 48624179.4286; val_kl_reg_loss: 405596.7500; val_edge_recon_loss: 1157209.6250; val_gene_expr_recon_loss: 46788072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48350880.0000; val_optim_loss: 48350880.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8842; val_auprc_score: 0.9759; val_best_acc_score: 0.8575; val_best_f1_score: 0.9233; train_kl_reg_loss: 413774.3214; train_edge_recon_loss: 1199162.6786; train_gene_expr_recon_loss: 46570430.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48183368.0000; train_optim_loss: 48183368.0000; val_kl_reg_loss: 395219.6875; val_edge_recon_loss: 1159166.0000; val_gene_expr_recon_loss: 46328392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47882776.0000; val_optim_loss: 47882776.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8856; val_auprc_score: 0.9765; val_best_acc_score: 0.8584; val_best_f1_score: 0.9238; train_kl_reg_loss: 403337.4062; train_edge_recon_loss: 1183192.2679; train_gene_expr_recon_loss: 46092191.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47678721.7143; train_optim_loss: 47678721.7143; val_kl_reg_loss: 385185.8125; val_edge_recon_loss: 1151316.3750; val_gene_expr_recon_loss: 45816020.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47352524.0000; val_optim_loss: 47352524.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8883; val_auprc_score: 0.9767; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 392944.6518; train_edge_recon_loss: 1193187.0536; train_gene_expr_recon_loss: 45546477.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47132609.7143; train_optim_loss: 47132609.7143; val_kl_reg_loss: 375794.0000; val_edge_recon_loss: 1200088.6250; val_gene_expr_recon_loss: 45239952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46815836.0000; val_optim_loss: 46815836.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8939; val_auprc_score: 0.9778; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 383066.9554; train_edge_recon_loss: 1190287.9286; train_gene_expr_recon_loss: 44945294.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46518648.5714; train_optim_loss: 46518648.5714; val_kl_reg_loss: 366023.8750; val_edge_recon_loss: 1229027.7500; val_gene_expr_recon_loss: 44606048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46201100.0000; val_optim_loss: 46201100.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8770; val_auprc_score: 0.9739; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 373043.0134; train_edge_recon_loss: 1207670.3929; train_gene_expr_recon_loss: 44293126.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45873840.5714; train_optim_loss: 45873840.5714; val_kl_reg_loss: 356971.1250; val_edge_recon_loss: 1182603.1250; val_gene_expr_recon_loss: 43928992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45468568.0000; val_optim_loss: 45468568.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8746; val_auprc_score: 0.9740; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 363712.2991; train_edge_recon_loss: 1205883.1429; train_gene_expr_recon_loss: 43593622.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45163217.7143; train_optim_loss: 45163217.7143; val_kl_reg_loss: 347298.3750; val_edge_recon_loss: 1171873.0000; val_gene_expr_recon_loss: 43200520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44719692.0000; val_optim_loss: 44719692.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8818; val_auprc_score: 0.9760; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 354615.3125; train_edge_recon_loss: 1194546.4464; train_gene_expr_recon_loss: 42878069.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44427232.0000; train_optim_loss: 44427232.0000; val_kl_reg_loss: 338517.1875; val_edge_recon_loss: 1177724.1250; val_gene_expr_recon_loss: 42473664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43989904.0000; val_optim_loss: 43989904.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8743; val_auprc_score: 0.9737; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 345589.2411; train_edge_recon_loss: 1197557.5893; train_gene_expr_recon_loss: 42145006.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43688152.5714; train_optim_loss: 43688152.5714; val_kl_reg_loss: 330271.6562; val_edge_recon_loss: 1198130.5000; val_gene_expr_recon_loss: 41749544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43277948.0000; val_optim_loss: 43277948.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8714; val_auprc_score: 0.9732; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 337092.4688; train_edge_recon_loss: 1169029.5000; train_gene_expr_recon_loss: 41427067.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42933189.7143; train_optim_loss: 42933189.7143; val_kl_reg_loss: 321779.3750; val_edge_recon_loss: 1203933.0000; val_gene_expr_recon_loss: 41033244.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42558956.0000; val_optim_loss: 42558956.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8739; val_auprc_score: 0.9746; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 328670.2054; train_edge_recon_loss: 1204866.2679; train_gene_expr_recon_loss: 40726360.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42259896.5714; train_optim_loss: 42259896.5714; val_kl_reg_loss: 314177.9688; val_edge_recon_loss: 1177691.1250; val_gene_expr_recon_loss: 40368088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41859956.0000; val_optim_loss: 41859956.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8695; val_auprc_score: 0.9721; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 320917.0670; train_edge_recon_loss: 1181867.2857; train_gene_expr_recon_loss: 40079482.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41582267.4286; train_optim_loss: 41582267.4286; val_kl_reg_loss: 322998.2500; val_edge_recon_loss: 1221281.3750; val_gene_expr_recon_loss: 39745984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41290264.0000; val_optim_loss: 41290264.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8711; val_auprc_score: 0.9739; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 315088.6607; train_edge_recon_loss: 1192416.1250; train_gene_expr_recon_loss: 39492458.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40999964.0000; train_optim_loss: 40999964.0000; val_kl_reg_loss: 299470.5938; val_edge_recon_loss: 1204868.5000; val_gene_expr_recon_loss: 39204340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40708680.0000; val_optim_loss: 40708680.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8587; val_auprc_score: 0.9706; val_best_acc_score: 0.8569; val_best_f1_score: 0.9229; train_kl_reg_loss: 306862.6607; train_edge_recon_loss: 1195421.3571; train_gene_expr_recon_loss: 38973934.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40476218.2857; train_optim_loss: 40476218.2857; val_kl_reg_loss: 306372.0625; val_edge_recon_loss: 1163982.1250; val_gene_expr_recon_loss: 38724544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40194900.0000; val_optim_loss: 40194900.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8607; val_auprc_score: 0.9712; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 300543.9330; train_edge_recon_loss: 1191693.0179; train_gene_expr_recon_loss: 38522725.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40014961.7143; train_optim_loss: 40014961.7143; val_kl_reg_loss: 286686.1875; val_edge_recon_loss: 1192241.2500; val_gene_expr_recon_loss: 38318168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39797096.0000; val_optim_loss: 39797096.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8709; val_auprc_score: 0.9743; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 1053286.3973; train_edge_recon_loss: 1170578.3571; train_gene_expr_recon_loss: 40442403.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42666268.5714; train_optim_loss: 42666268.5714; val_kl_reg_loss: 295388.0625; val_edge_recon_loss: 1187426.3750; val_gene_expr_recon_loss: 39203584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40686400.0000; val_optim_loss: 40686400.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8673; val_auprc_score: 0.9715; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 321008.5491; train_edge_recon_loss: 1175738.4107; train_gene_expr_recon_loss: 38718400.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40215146.8571; train_optim_loss: 40215146.8571; val_kl_reg_loss: 332438.3438; val_edge_recon_loss: 1206818.5000; val_gene_expr_recon_loss: 38372496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39911752.0000; val_optim_loss: 39911752.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8680; val_auprc_score: 0.9700; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 11587043.8750; train_edge_recon_loss: 1152511.7321; train_gene_expr_recon_loss: 386458113.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 399197660.0000; train_optim_loss: 399197660.0000; val_kl_reg_loss: 4858444.5000; val_edge_recon_loss: 1205896.3750; val_gene_expr_recon_loss: 219840960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 225905296.0000; val_optim_loss: 225905296.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8643; val_auprc_score: 0.9688; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 2534742.6875; train_edge_recon_loss: 1155783.5357; train_gene_expr_recon_loss: 341852460.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 345542990.8571; train_optim_loss: 345542990.8571; val_kl_reg_loss: 1196850.6250; val_edge_recon_loss: 1195260.5000; val_gene_expr_recon_loss: 83833104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86225216.0000; val_optim_loss: 86225216.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8637; val_auprc_score: 0.9667; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 1240490.5714; train_edge_recon_loss: 1183865.1071; train_gene_expr_recon_loss: 76621380.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79045737.1429; train_optim_loss: 79045737.1429; val_kl_reg_loss: 1202108.2500; val_edge_recon_loss: 1228088.1250; val_gene_expr_recon_loss: 64864932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67295128.0000; val_optim_loss: 67295128.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8600; val_auprc_score: 0.9657; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 1233508.1964; train_edge_recon_loss: 1203162.8929; train_gene_expr_recon_loss: 59805722.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62242393.1429; train_optim_loss: 62242393.1429; val_kl_reg_loss: 1186196.1250; val_edge_recon_loss: 1230969.3750; val_gene_expr_recon_loss: 56252552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58669716.0000; val_optim_loss: 58669716.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8642; val_auprc_score: 0.9679; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 1217607.4107; train_edge_recon_loss: 1197181.5179; train_gene_expr_recon_loss: 55455430.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57870218.2857; train_optim_loss: 57870218.2857; val_kl_reg_loss: 1171480.2500; val_edge_recon_loss: 1201076.5000; val_gene_expr_recon_loss: 54797348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57169904.0000; val_optim_loss: 57169904.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8621; val_auprc_score: 0.9668; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 1201366.9286; train_edge_recon_loss: 1179539.1429; train_gene_expr_recon_loss: 54120564.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56501470.8571; train_optim_loss: 56501470.8571; val_kl_reg_loss: 1155367.0000; val_edge_recon_loss: 1211712.6250; val_gene_expr_recon_loss: 53367272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55734352.0000; val_optim_loss: 55734352.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 34 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
val AUROC score: 0.8623
val AUPRC score: 0.9704
val best accuracy score: 0.8475
val best F1 score: 0.9174
val target rna MSE score: 42.9154
val source rna MSE score: 51.9619
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 1: 0 hours, 4 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
