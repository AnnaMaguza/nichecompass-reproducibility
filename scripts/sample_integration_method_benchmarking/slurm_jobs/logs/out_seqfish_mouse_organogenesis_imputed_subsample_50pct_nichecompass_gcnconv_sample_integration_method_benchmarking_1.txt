Run timestamp: 28082023_172642_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--filter_genes', '--n_svg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1487, n_latent: 1477, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9489; val_auprc_score: 0.9881; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 667770.3342; train_edge_recon_loss: 1146558.0697; train_gene_expr_recon_loss: 140322017.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 142136344.9231; train_optim_loss: 142136344.9231; val_kl_reg_loss: 812724.7292; val_edge_recon_loss: 1184262.6667; val_gene_expr_recon_loss: 58347697.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60344684.0000; val_optim_loss: 60344684.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9491; val_auprc_score: 0.9877; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 927869.5745; train_edge_recon_loss: 1197882.6106; train_gene_expr_recon_loss: 56574586.7692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58700338.7692; train_optim_loss: 58700338.7692; val_kl_reg_loss: 949006.4583; val_edge_recon_loss: 1198746.7917; val_gene_expr_recon_loss: 55156768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57304521.3333; val_optim_loss: 57304521.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9488; val_auprc_score: 0.9878; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 928829.1250; train_edge_recon_loss: 1195534.7596; train_gene_expr_recon_loss: 54471486.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56595850.0000; train_optim_loss: 56595850.0000; val_kl_reg_loss: 871294.0833; val_edge_recon_loss: 1205642.1667; val_gene_expr_recon_loss: 53574118.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55651054.6667; val_optim_loss: 55651054.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9446; val_auprc_score: 0.9873; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 833069.5649; train_edge_recon_loss: 1198951.9760; train_gene_expr_recon_loss: 52638510.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54670532.7692; train_optim_loss: 54670532.7692; val_kl_reg_loss: 773816.7917; val_edge_recon_loss: 1181366.5417; val_gene_expr_recon_loss: 51339549.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53294732.0000; val_optim_loss: 53294732.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9469; val_auprc_score: 0.9879; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 735785.2885; train_edge_recon_loss: 1200496.4712; train_gene_expr_recon_loss: 49799190.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51735472.0000; train_optim_loss: 51735472.0000; val_kl_reg_loss: 678503.8542; val_edge_recon_loss: 1199698.1250; val_gene_expr_recon_loss: 47969312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49847514.6667; val_optim_loss: 49847514.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9484; val_auprc_score: 0.9888; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 645346.2332; train_edge_recon_loss: 1195482.3317; train_gene_expr_recon_loss: 46503501.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48344330.1538; train_optim_loss: 48344330.1538; val_kl_reg_loss: 595069.2917; val_edge_recon_loss: 1186490.3750; val_gene_expr_recon_loss: 45056265.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46837825.3333; val_optim_loss: 46837825.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9408; val_auprc_score: 0.9874; val_best_acc_score: 0.8540; val_best_f1_score: 0.9213; train_kl_reg_loss: 562980.3822; train_edge_recon_loss: 1188726.4327; train_gene_expr_recon_loss: 44256265.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46007972.3077; train_optim_loss: 46007972.3077; val_kl_reg_loss: 517232.8854; val_edge_recon_loss: 1187368.1667; val_gene_expr_recon_loss: 43501565.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45206165.3333; val_optim_loss: 45206165.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9364; val_auprc_score: 0.9864; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 488719.5637; train_edge_recon_loss: 1202539.4808; train_gene_expr_recon_loss: 43151150.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44842409.2308; train_optim_loss: 44842409.2308; val_kl_reg_loss: 449909.4583; val_edge_recon_loss: 1212009.7083; val_gene_expr_recon_loss: 42744228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44406146.6667; val_optim_loss: 44406146.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9253; val_auprc_score: 0.9794; val_best_acc_score: 0.8539; val_best_f1_score: 0.9212; train_kl_reg_loss: 991427939.1418; train_edge_recon_loss: 1159337.8942; train_gene_expr_recon_loss: 264002125.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1256589423.2308; train_optim_loss: 1256589423.2308; val_kl_reg_loss: 2077967.0833; val_edge_recon_loss: 1186965.2083; val_gene_expr_recon_loss: 155204586.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 158469520.0000; val_optim_loss: 158469520.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8556; val_auprc_score: 0.9545; val_best_acc_score: 0.8538; val_best_f1_score: 0.9212; train_kl_reg_loss: 153539724984.0769; train_edge_recon_loss: 1180912.5385; train_gene_expr_recon_loss: 353293433.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 153894194379.3846; train_optim_loss: 153894194379.3846; val_kl_reg_loss: 6253236.5000; val_edge_recon_loss: 1189605.5417; val_gene_expr_recon_loss: 102176456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 109619298.6667; val_optim_loss: 109619298.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8084; val_auprc_score: 0.9379; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 74328474799.9615; train_edge_recon_loss: 1182915.9327; train_gene_expr_recon_loss: 271111341.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74600767859.0769; train_optim_loss: 74600767859.0769; val_kl_reg_loss: 8854810.0000; val_edge_recon_loss: 1214918.9167; val_gene_expr_recon_loss: 65188278.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75258008.0000; val_optim_loss: 75258008.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8296; val_auprc_score: 0.9469; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 8472616.9231; train_edge_recon_loss: 1193943.9615; train_gene_expr_recon_loss: 61768813.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71435373.8462; train_optim_loss: 71435373.8462; val_kl_reg_loss: 7509685.8333; val_edge_recon_loss: 1187176.0000; val_gene_expr_recon_loss: 59575348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68272208.0000; val_optim_loss: 68272208.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8380; val_auprc_score: 0.9489; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 7493982.2115; train_edge_recon_loss: 1196580.6154; train_gene_expr_recon_loss: 59441464.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68132028.0000; train_optim_loss: 68132028.0000; val_kl_reg_loss: 7313358.5000; val_edge_recon_loss: 1201118.3333; val_gene_expr_recon_loss: 59270657.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67785136.0000; val_optim_loss: 67785136.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8418; val_auprc_score: 0.9500; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 7294934.5000; train_edge_recon_loss: 1190299.1683; train_gene_expr_recon_loss: 59207208.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67692441.5385; train_optim_loss: 67692441.5385; val_kl_reg_loss: 7115306.3333; val_edge_recon_loss: 1205490.0833; val_gene_expr_recon_loss: 59104274.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67425072.0000; val_optim_loss: 67425072.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8421; val_auprc_score: 0.9502; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 7099262.7308; train_edge_recon_loss: 1198387.0817; train_gene_expr_recon_loss: 59080542.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67378192.0000; train_optim_loss: 67378192.0000; val_kl_reg_loss: 6923176.0000; val_edge_recon_loss: 1201158.1250; val_gene_expr_recon_loss: 59013093.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67137429.3333; val_optim_loss: 67137429.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8433; val_auprc_score: 0.9516; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 6896764.5577; train_edge_recon_loss: 1191722.5048; train_gene_expr_recon_loss: 58999302.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67087789.3846; train_optim_loss: 67087789.3846; val_kl_reg_loss: 6723109.6667; val_edge_recon_loss: 1178060.7500; val_gene_expr_recon_loss: 58889789.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66790960.0000; val_optim_loss: 66790960.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 23 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
val AUROC score: 0.9376
val AUPRC score: 0.9871
val best accuracy score: 0.8549
val best F1 score: 0.9218
val target rna MSE score: 31.8160
val source rna MSE score: 35.5996
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 8: 0 hours, 5 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1487, n_latent: 1477, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1477, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 212411
Number of validation edges: 23601
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9483; val_auprc_score: 0.9882; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 440895.0247; train_edge_recon_loss: 1132069.1899; train_gene_expr_recon_loss: 103147324.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104720288.0000; train_optim_loss: 104720288.0000; val_kl_reg_loss: 476680.4062; val_edge_recon_loss: 1202881.7917; val_gene_expr_recon_loss: 56996612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58676173.3333; val_optim_loss: 58676173.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9458; val_auprc_score: 0.9875; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 524718.0986; train_edge_recon_loss: 1185015.1923; train_gene_expr_recon_loss: 55216490.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56926223.5385; train_optim_loss: 56926223.5385; val_kl_reg_loss: 530690.5833; val_edge_recon_loss: 1192962.1250; val_gene_expr_recon_loss: 53591389.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55315041.3333; val_optim_loss: 55315041.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9474; val_auprc_score: 0.9877; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 525761.7933; train_edge_recon_loss: 1197914.2308; train_gene_expr_recon_loss: 52696082.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54419758.1538; train_optim_loss: 54419758.1538; val_kl_reg_loss: 501717.0938; val_edge_recon_loss: 1229839.2083; val_gene_expr_recon_loss: 51534645.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53266202.6667; val_optim_loss: 53266202.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9480; val_auprc_score: 0.9883; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 490873.4916; train_edge_recon_loss: 1191751.7404; train_gene_expr_recon_loss: 50297805.5385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51980430.6154; train_optim_loss: 51980430.6154; val_kl_reg_loss: 463467.9896; val_edge_recon_loss: 1203266.2917; val_gene_expr_recon_loss: 48679620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50346353.3333; val_optim_loss: 50346353.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9432; val_auprc_score: 0.9874; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 452094.3714; train_edge_recon_loss: 1196423.6779; train_gene_expr_recon_loss: 47184703.3846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48833221.0769; train_optim_loss: 48833221.0769; val_kl_reg_loss: 425422.8958; val_edge_recon_loss: 1196757.5000; val_gene_expr_recon_loss: 45538034.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47160214.6667; val_optim_loss: 47160214.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9396; val_auprc_score: 0.9867; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 412099.5421; train_edge_recon_loss: 1190982.4423; train_gene_expr_recon_loss: 44440152.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46043234.4615; train_optim_loss: 46043234.4615; val_kl_reg_loss: 386798.2083; val_edge_recon_loss: 1203031.2500; val_gene_expr_recon_loss: 43386121.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44975950.6667; val_optim_loss: 44975950.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9396; val_auprc_score: 0.9872; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 374334.4243; train_edge_recon_loss: 1186144.2115; train_gene_expr_recon_loss: 42855804.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44416283.5385; train_optim_loss: 44416283.5385; val_kl_reg_loss: 349997.2708; val_edge_recon_loss: 1212565.5000; val_gene_expr_recon_loss: 42277596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43840160.0000; val_optim_loss: 43840160.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9368; val_auprc_score: 0.9869; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 341458.8101; train_edge_recon_loss: 1199281.2212; train_gene_expr_recon_loss: 42069183.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43609923.2308; train_optim_loss: 43609923.2308; val_kl_reg_loss: 318030.2396; val_edge_recon_loss: 1214413.9583; val_gene_expr_recon_loss: 41751809.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43284254.6667; val_optim_loss: 43284254.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9324; val_auprc_score: 0.9862; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 407470.7548; train_edge_recon_loss: 1198882.6779; train_gene_expr_recon_loss: 41645400.6154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43251754.0000; train_optim_loss: 43251754.0000; val_kl_reg_loss: 288487.1042; val_edge_recon_loss: 1207757.6667; val_gene_expr_recon_loss: 41446722.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42942966.6667; val_optim_loss: 42942966.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9258; val_auprc_score: 0.9829; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 96619205.8125; train_edge_recon_loss: 1161016.5361; train_gene_expr_recon_loss: 216146599.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 313926816.7692; train_optim_loss: 313926816.7692; val_kl_reg_loss: 25340876800.0000; val_edge_recon_loss: 1191838.2500; val_gene_expr_recon_loss: 206981392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25549049856.0000; val_optim_loss: 25549049856.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8487; val_auprc_score: 0.9528; val_best_acc_score: 0.8509; val_best_f1_score: 0.9195; train_kl_reg_loss: 1150035353.5745; train_edge_recon_loss: 1184200.6058; train_gene_expr_recon_loss: 189277877.8462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1340497415.6923; train_optim_loss: 1340497415.6923; val_kl_reg_loss: 3352915.0833; val_edge_recon_loss: 1211442.8333; val_gene_expr_recon_loss: 59585920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64150278.6667; val_optim_loss: 64150278.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8553; val_auprc_score: 0.9552; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 3428273.8269; train_edge_recon_loss: 1194968.3173; train_gene_expr_recon_loss: 90348940.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 94972183.8462; train_optim_loss: 94972183.8462; val_kl_reg_loss: 3258480.9167; val_edge_recon_loss: 1204435.6667; val_gene_expr_recon_loss: 57183724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61646640.0000; val_optim_loss: 61646640.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8729; val_auprc_score: 0.9619; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 2956872.3365; train_edge_recon_loss: 1193506.7933; train_gene_expr_recon_loss: 55719101.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59869481.2308; train_optim_loss: 59869481.2308; val_kl_reg_loss: 2604388.0833; val_edge_recon_loss: 1193381.5833; val_gene_expr_recon_loss: 54888286.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58686056.0000; val_optim_loss: 58686056.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8693; val_auprc_score: 0.9604; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 2615261.0385; train_edge_recon_loss: 1197733.6202; train_gene_expr_recon_loss: 54348369.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58161364.3077; train_optim_loss: 58161364.3077; val_kl_reg_loss: 2557836.1667; val_edge_recon_loss: 1205532.0417; val_gene_expr_recon_loss: 54227545.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57990914.6667; val_optim_loss: 57990914.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8741; val_auprc_score: 0.9621; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 2560026.3077; train_edge_recon_loss: 1194120.7644; train_gene_expr_recon_loss: 54234542.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57988689.5385; train_optim_loss: 57988689.5385; val_kl_reg_loss: 2502691.0833; val_edge_recon_loss: 1203234.0417; val_gene_expr_recon_loss: 54110950.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57816877.3333; val_optim_loss: 57816877.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8740; val_auprc_score: 0.9623; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 2510687.6827; train_edge_recon_loss: 1200145.2548; train_gene_expr_recon_loss: 54151126.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57861958.4615; train_optim_loss: 57861958.4615; val_kl_reg_loss: 2452188.0833; val_edge_recon_loss: 1197899.3333; val_gene_expr_recon_loss: 53994828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57644916.0000; val_optim_loss: 57644916.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8738; val_auprc_score: 0.9622; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 2457151.0962; train_edge_recon_loss: 1189614.2644; train_gene_expr_recon_loss: 54052427.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57699193.2308; train_optim_loss: 57699193.2308; val_kl_reg_loss: 2404131.0000; val_edge_recon_loss: 1196847.8750; val_gene_expr_recon_loss: 53937800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57538778.6667; val_optim_loss: 57538778.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 49 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
val AUROC score: 0.9309
val AUPRC score: 0.9854
val best accuracy score: 0.8506
val best F1 score: 0.9193
val target rna MSE score: 25.8825
val source rna MSE score: 25.7423
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 7: 0 hours, 5 minutes and 56 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9469; val_auprc_score: 0.9884; val_best_acc_score: 0.8506; val_best_f1_score: 0.9192; train_kl_reg_loss: 234046.2739; train_edge_recon_loss: 1118230.0219; train_gene_expr_recon_loss: 99045458.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 100397734.8000; train_optim_loss: 100397734.8000; val_kl_reg_loss: 347196.3333; val_edge_recon_loss: 1229917.9583; val_gene_expr_recon_loss: 57925694.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59502808.0000; val_optim_loss: 59502808.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9418; val_auprc_score: 0.9870; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 440641.2641; train_edge_recon_loss: 1190022.9000; train_gene_expr_recon_loss: 54842597.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56473261.0000; train_optim_loss: 56473261.0000; val_kl_reg_loss: 477262.0417; val_edge_recon_loss: 1184029.2500; val_gene_expr_recon_loss: 52749434.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54410726.6667; val_optim_loss: 54410726.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9416; val_auprc_score: 0.9871; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 489765.0672; train_edge_recon_loss: 1198566.5375; train_gene_expr_recon_loss: 51777272.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53465603.6000; train_optim_loss: 53465603.6000; val_kl_reg_loss: 479165.0833; val_edge_recon_loss: 1173039.1250; val_gene_expr_recon_loss: 50707448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52359652.0000; val_optim_loss: 52359652.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9419; val_auprc_score: 0.9870; val_best_acc_score: 0.8554; val_best_f1_score: 0.9220; train_kl_reg_loss: 479851.7344; train_edge_recon_loss: 1196128.5188; train_gene_expr_recon_loss: 49831027.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51507007.6000; train_optim_loss: 51507007.6000; val_kl_reg_loss: 460564.6354; val_edge_recon_loss: 1184199.6667; val_gene_expr_recon_loss: 48790002.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50434766.6667; val_optim_loss: 50434766.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9423; val_auprc_score: 0.9872; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 458875.9891; train_edge_recon_loss: 1193210.1250; train_gene_expr_recon_loss: 47745315.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49397401.2000; train_optim_loss: 49397401.2000; val_kl_reg_loss: 439143.3750; val_edge_recon_loss: 1204644.7083; val_gene_expr_recon_loss: 46515676.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48159464.0000; val_optim_loss: 48159464.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9378; val_auprc_score: 0.9864; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 436806.1375; train_edge_recon_loss: 1181865.3687; train_gene_expr_recon_loss: 45445097.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47063769.0000; train_optim_loss: 47063769.0000; val_kl_reg_loss: 417319.9792; val_edge_recon_loss: 1187176.4167; val_gene_expr_recon_loss: 44268093.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45872590.6667; val_optim_loss: 45872590.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9392; val_auprc_score: 0.9873; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 414193.4313; train_edge_recon_loss: 1191780.0562; train_gene_expr_recon_loss: 43275479.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44881453.4000; train_optim_loss: 44881453.4000; val_kl_reg_loss: 395020.9375; val_edge_recon_loss: 1180960.4167; val_gene_expr_recon_loss: 42289453.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43865434.6667; val_optim_loss: 43865434.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9311; val_auprc_score: 0.9848; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 391765.4688; train_edge_recon_loss: 1183072.2000; train_gene_expr_recon_loss: 41501615.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43076453.4000; train_optim_loss: 43076453.4000; val_kl_reg_loss: 373088.5521; val_edge_recon_loss: 1207143.2917; val_gene_expr_recon_loss: 40831629.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42411861.3333; val_optim_loss: 42411861.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9333; val_auprc_score: 0.9862; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 379134.0203; train_edge_recon_loss: 1192953.0500; train_gene_expr_recon_loss: 40327821.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41899908.4000; train_optim_loss: 41899908.4000; val_kl_reg_loss: 368079.1771; val_edge_recon_loss: 1179763.5833; val_gene_expr_recon_loss: 39839132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41386974.6667; val_optim_loss: 41386974.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9282; val_auprc_score: 0.9853; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 367144.5141; train_edge_recon_loss: 1200499.4312; train_gene_expr_recon_loss: 39507046.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41074691.0000; train_optim_loss: 41074691.0000; val_kl_reg_loss: 350721.3958; val_edge_recon_loss: 1209896.7500; val_gene_expr_recon_loss: 39198877.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40759494.6667; val_optim_loss: 40759494.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9241; val_auprc_score: 0.9843; val_best_acc_score: 0.8494; val_best_f1_score: 0.9186; train_kl_reg_loss: 349110.5438; train_edge_recon_loss: 1191155.5625; train_gene_expr_recon_loss: 39052380.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40592646.4000; train_optim_loss: 40592646.4000; val_kl_reg_loss: 334232.9271; val_edge_recon_loss: 1251608.3750; val_gene_expr_recon_loss: 38822577.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40408418.6667; val_optim_loss: 40408418.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9179; val_auprc_score: 0.9833; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 342143.6406; train_edge_recon_loss: 1195935.5688; train_gene_expr_recon_loss: 38659437.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40197516.4000; train_optim_loss: 40197516.4000; val_kl_reg_loss: 332280.0729; val_edge_recon_loss: 1203867.8333; val_gene_expr_recon_loss: 38493272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40029418.6667; val_optim_loss: 40029418.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9149; val_auprc_score: 0.9824; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 330763.8469; train_edge_recon_loss: 1194859.2937; train_gene_expr_recon_loss: 38400673.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39926297.0000; train_optim_loss: 39926297.0000; val_kl_reg_loss: 314375.8750; val_edge_recon_loss: 1224512.5000; val_gene_expr_recon_loss: 38281870.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39820760.0000; val_optim_loss: 39820760.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9096; val_auprc_score: 0.9815; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 377303.6250; train_edge_recon_loss: 1190657.2812; train_gene_expr_recon_loss: 38722382.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40290343.8000; train_optim_loss: 40290343.8000; val_kl_reg_loss: 329497.0729; val_edge_recon_loss: 1189071.8333; val_gene_expr_recon_loss: 38257544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39776112.0000; val_optim_loss: 39776112.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9064; val_auprc_score: 0.9802; val_best_acc_score: 0.8509; val_best_f1_score: 0.9195; train_kl_reg_loss: 333544.9094; train_edge_recon_loss: 1198794.1812; train_gene_expr_recon_loss: 38086922.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39619261.4000; train_optim_loss: 39619261.4000; val_kl_reg_loss: 316392.1562; val_edge_recon_loss: 1206611.2500; val_gene_expr_recon_loss: 37957176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39480178.6667; val_optim_loss: 39480178.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9025; val_auprc_score: 0.9807; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 311304.1469; train_edge_recon_loss: 1189831.3938; train_gene_expr_recon_loss: 37881582.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39382718.4000; train_optim_loss: 39382718.4000; val_kl_reg_loss: 288407.7708; val_edge_recon_loss: 1159373.7917; val_gene_expr_recon_loss: 37763302.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39211084.0000; val_optim_loss: 39211084.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8977; val_auprc_score: 0.9797; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 314883.4969; train_edge_recon_loss: 1180086.3500; train_gene_expr_recon_loss: 37745279.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39240249.8000; train_optim_loss: 39240249.8000; val_kl_reg_loss: 275333.8646; val_edge_recon_loss: 1173837.7083; val_gene_expr_recon_loss: 37678445.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39127617.3333; val_optim_loss: 39127617.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8960; val_auprc_score: 0.9789; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 277211.1094; train_edge_recon_loss: 1187209.7750; train_gene_expr_recon_loss: 37627322.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39091743.0000; train_optim_loss: 39091743.0000; val_kl_reg_loss: 264783.4583; val_edge_recon_loss: 1181335.2083; val_gene_expr_recon_loss: 37549396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38995516.0000; val_optim_loss: 38995516.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8917; val_auprc_score: 0.9709; val_best_acc_score: 0.8568; val_best_f1_score: 0.9229; train_kl_reg_loss: 1205957964.8773; train_edge_recon_loss: 1138058.0031; train_gene_expr_recon_loss: 694225183.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1901321203.4000; train_optim_loss: 1901321203.4000; val_kl_reg_loss: 6433147.6667; val_edge_recon_loss: 1151725.0000; val_gene_expr_recon_loss: 261050778.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 268635653.3333; val_optim_loss: 268635653.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8523; val_auprc_score: 0.9562; val_best_acc_score: 0.8526; val_best_f1_score: 0.9205; train_kl_reg_loss: 11970495.3375; train_edge_recon_loss: 1164102.9812; train_gene_expr_recon_loss: 365058507.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 378193109.2000; train_optim_loss: 378193109.2000; val_kl_reg_loss: 3910724.6667; val_edge_recon_loss: 1203714.0417; val_gene_expr_recon_loss: 80013152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 85127589.3333; val_optim_loss: 85127589.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8448; val_auprc_score: 0.9548; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 28337932.6750; train_edge_recon_loss: 1188401.4312; train_gene_expr_recon_loss: 130875548.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 160401887.2000; train_optim_loss: 160401887.2000; val_kl_reg_loss: 4349280.6667; val_edge_recon_loss: 1169059.5000; val_gene_expr_recon_loss: 64038980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69557320.0000; val_optim_loss: 69557320.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8421; val_auprc_score: 0.9516; val_best_acc_score: 0.8485; val_best_f1_score: 0.9180; train_kl_reg_loss: 4369255.0500; train_edge_recon_loss: 1192432.9688; train_gene_expr_recon_loss: 60723457.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66285145.0000; train_optim_loss: 66285145.0000; val_kl_reg_loss: 4160826.5833; val_edge_recon_loss: 1210434.1250; val_gene_expr_recon_loss: 59638512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65009770.6667; val_optim_loss: 65009770.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8533; val_auprc_score: 0.9561; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 4211229.9750; train_edge_recon_loss: 1200644.9937; train_gene_expr_recon_loss: 57846256.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63258131.2000; train_optim_loss: 63258131.2000; val_kl_reg_loss: 4112874.2500; val_edge_recon_loss: 1219813.9167; val_gene_expr_recon_loss: 57660180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62992869.3333; val_optim_loss: 62992869.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8560; val_auprc_score: 0.9589; val_best_acc_score: 0.8571; val_best_f1_score: 0.9230; train_kl_reg_loss: 4173633.6750; train_edge_recon_loss: 1194766.3062; train_gene_expr_recon_loss: 57526055.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62894455.0000; train_optim_loss: 62894455.0000; val_kl_reg_loss: 4072332.1667; val_edge_recon_loss: 1150013.9583; val_gene_expr_recon_loss: 57365704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62588050.6667; val_optim_loss: 62588050.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8475; val_auprc_score: 0.9544; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 4128545.8250; train_edge_recon_loss: 1195091.0000; train_gene_expr_recon_loss: 57265160.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62588797.0000; train_optim_loss: 62588797.0000; val_kl_reg_loss: 4045260.0000; val_edge_recon_loss: 1223324.7083; val_gene_expr_recon_loss: 57190548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62459133.3333; val_optim_loss: 62459133.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8529; val_auprc_score: 0.9561; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 4090290.8500; train_edge_recon_loss: 1189232.2625; train_gene_expr_recon_loss: 57126162.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62405685.6000; train_optim_loss: 62405685.6000; val_kl_reg_loss: 3992938.4167; val_edge_recon_loss: 1192976.2083; val_gene_expr_recon_loss: 57078693.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62264608.0000; val_optim_loss: 62264608.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 59 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
val AUROC score: 0.8942
val AUPRC score: 0.9786
val best accuracy score: 0.8518
val best F1 score: 0.9199
val target rna MSE score: 22.7570
val source rna MSE score: 19.3417
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 6: 0 hours, 7 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1490, n_latent: 1480, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1480, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 159885
Number of validation edges: 17764
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9483; val_auprc_score: 0.9888; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 263783.3875; train_edge_recon_loss: 1124969.1281; train_gene_expr_recon_loss: 90431152.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 91819904.6000; train_optim_loss: 91819904.6000; val_kl_reg_loss: 413137.8125; val_edge_recon_loss: 1165734.8333; val_gene_expr_recon_loss: 58368872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59947744.0000; val_optim_loss: 59947744.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9499; val_auprc_score: 0.9887; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 554862.5391; train_edge_recon_loss: 1198960.0312; train_gene_expr_recon_loss: 56513027.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58266849.4000; train_optim_loss: 58266849.4000; val_kl_reg_loss: 633407.1875; val_edge_recon_loss: 1177348.1667; val_gene_expr_recon_loss: 54709026.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56519782.6667; val_optim_loss: 56519782.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9438; val_auprc_score: 0.9866; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 666499.7594; train_edge_recon_loss: 1185630.0750; train_gene_expr_recon_loss: 53720513.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55572642.8000; train_optim_loss: 55572642.8000; val_kl_reg_loss: 664546.5208; val_edge_recon_loss: 1184214.2083; val_gene_expr_recon_loss: 52997818.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54846578.6667; val_optim_loss: 54846578.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9451; val_auprc_score: 0.9873; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 667422.8375; train_edge_recon_loss: 1200579.7063; train_gene_expr_recon_loss: 52381460.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54249463.0000; train_optim_loss: 54249463.0000; val_kl_reg_loss: 643360.4375; val_edge_recon_loss: 1201319.1667; val_gene_expr_recon_loss: 51822416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53667094.6667; val_optim_loss: 53667094.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9427; val_auprc_score: 0.9867; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 640813.0000; train_edge_recon_loss: 1185228.0938; train_gene_expr_recon_loss: 51160235.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52986276.6000; train_optim_loss: 52986276.6000; val_kl_reg_loss: 614041.3125; val_edge_recon_loss: 1214513.9583; val_gene_expr_recon_loss: 50488770.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52317325.3333; val_optim_loss: 52317325.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9442; val_auprc_score: 0.9876; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 610835.3656; train_edge_recon_loss: 1196812.8313; train_gene_expr_recon_loss: 49633100.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51440748.8000; train_optim_loss: 51440748.8000; val_kl_reg_loss: 583802.2500; val_edge_recon_loss: 1179505.4583; val_gene_expr_recon_loss: 48750953.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50514261.3333; val_optim_loss: 50514261.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9413; val_auprc_score: 0.9869; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 580087.6844; train_edge_recon_loss: 1198130.4500; train_gene_expr_recon_loss: 47796639.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49574858.0000; train_optim_loss: 49574858.0000; val_kl_reg_loss: 554118.0833; val_edge_recon_loss: 1157157.9583; val_gene_expr_recon_loss: 46801069.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48512345.3333; val_optim_loss: 48512345.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9362; val_auprc_score: 0.9857; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 550644.2031; train_edge_recon_loss: 1203134.4125; train_gene_expr_recon_loss: 45830281.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47584060.0000; train_optim_loss: 47584060.0000; val_kl_reg_loss: 526587.7292; val_edge_recon_loss: 1199709.8333; val_gene_expr_recon_loss: 44851324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46577621.3333; val_optim_loss: 46577621.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9359; val_auprc_score: 0.9863; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 521714.5375; train_edge_recon_loss: 1197581.0188; train_gene_expr_recon_loss: 44056797.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45776092.6000; train_optim_loss: 45776092.6000; val_kl_reg_loss: 498675.2083; val_edge_recon_loss: 1187637.6250; val_gene_expr_recon_loss: 43286717.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44973029.3333; val_optim_loss: 44973029.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9321; val_auprc_score: 0.9851; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 494561.8750; train_edge_recon_loss: 1199590.1313; train_gene_expr_recon_loss: 42686401.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44380553.4000; train_optim_loss: 44380553.4000; val_kl_reg_loss: 472336.0625; val_edge_recon_loss: 1244951.0000; val_gene_expr_recon_loss: 42146954.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43864242.6667; val_optim_loss: 43864242.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9255; val_auprc_score: 0.9842; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 469050.8828; train_edge_recon_loss: 1192976.6062; train_gene_expr_recon_loss: 41766107.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43428134.6000; train_optim_loss: 43428134.6000; val_kl_reg_loss: 448947.1042; val_edge_recon_loss: 1213996.7917; val_gene_expr_recon_loss: 41406894.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43069840.0000; val_optim_loss: 43069840.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9207; val_auprc_score: 0.9834; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 445662.1188; train_edge_recon_loss: 1192487.4438; train_gene_expr_recon_loss: 41182267.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42820416.4000; train_optim_loss: 42820416.4000; val_kl_reg_loss: 426146.1354; val_edge_recon_loss: 1204838.9583; val_gene_expr_recon_loss: 40965966.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42596952.0000; val_optim_loss: 42596952.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9147; val_auprc_score: 0.9826; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 423143.5563; train_edge_recon_loss: 1196936.3750; train_gene_expr_recon_loss: 40795588.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42415668.8000; train_optim_loss: 42415668.8000; val_kl_reg_loss: 404891.3333; val_edge_recon_loss: 1160656.0833; val_gene_expr_recon_loss: 40640808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42206356.0000; val_optim_loss: 42206356.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9106; val_auprc_score: 0.9814; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 402301.6406; train_edge_recon_loss: 1201901.8438; train_gene_expr_recon_loss: 40531186.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42135390.4000; train_optim_loss: 42135390.4000; val_kl_reg_loss: 384397.5417; val_edge_recon_loss: 1185001.5000; val_gene_expr_recon_loss: 40418580.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41987978.6667; val_optim_loss: 41987978.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9091; val_auprc_score: 0.9814; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 381958.1672; train_edge_recon_loss: 1189174.1125; train_gene_expr_recon_loss: 40318943.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41890075.8000; train_optim_loss: 41890075.8000; val_kl_reg_loss: 365191.1875; val_edge_recon_loss: 1197645.3333; val_gene_expr_recon_loss: 40213186.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41776022.6667; val_optim_loss: 41776022.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8745; val_auprc_score: 0.9613; val_best_acc_score: 0.8514; val_best_f1_score: 0.9197; train_kl_reg_loss: 181666418241.7469; train_edge_recon_loss: 1151070.2531; train_gene_expr_recon_loss: 501829760.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 182169401968.8000; train_optim_loss: 182169401968.8000; val_kl_reg_loss: 3275136.4167; val_edge_recon_loss: 1208561.3333; val_gene_expr_recon_loss: 158708208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 163191904.0000; val_optim_loss: 163191904.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7757; val_auprc_score: 0.9307; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 6675677373.0750; train_edge_recon_loss: 1182087.4688; train_gene_expr_recon_loss: 450282624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7127141926.4000; train_optim_loss: 7127141926.4000; val_kl_reg_loss: 8529077930.6667; val_edge_recon_loss: 1179524.7500; val_gene_expr_recon_loss: 148225797.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8678483114.6667; val_optim_loss: 8678483114.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7989; val_auprc_score: 0.9348; val_best_acc_score: 0.8484; val_best_f1_score: 0.9180; train_kl_reg_loss: 1224697580.8500; train_edge_recon_loss: 1188927.9438; train_gene_expr_recon_loss: 264619173.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1490505695.2000; train_optim_loss: 1490505695.2000; val_kl_reg_loss: 10906293.3333; val_edge_recon_loss: 1226345.9167; val_gene_expr_recon_loss: 80131653.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 92264290.6667; val_optim_loss: 92264290.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8304; val_auprc_score: 0.9451; val_best_acc_score: 0.8490; val_best_f1_score: 0.9183; train_kl_reg_loss: 10489995.6000; train_edge_recon_loss: 1190183.2688; train_gene_expr_recon_loss: 70723187.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82403366.8000; train_optim_loss: 82403366.8000; val_kl_reg_loss: 9578178.0000; val_edge_recon_loss: 1229701.7917; val_gene_expr_recon_loss: 65051033.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75858914.6667; val_optim_loss: 75858914.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8225; val_auprc_score: 0.9456; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 9707443.6500; train_edge_recon_loss: 1194020.9250; train_gene_expr_recon_loss: 65879262.2000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 76780726.8000; train_optim_loss: 76780726.8000; val_kl_reg_loss: 9547988.3333; val_edge_recon_loss: 1168662.8750; val_gene_expr_recon_loss: 64571377.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75288029.3333; val_optim_loss: 75288029.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8291; val_auprc_score: 0.9459; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 9716210.1000; train_edge_recon_loss: 1196770.5000; train_gene_expr_recon_loss: 64367438.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 75280418.8000; train_optim_loss: 75280418.8000; val_kl_reg_loss: 9569434.0000; val_edge_recon_loss: 1200860.2500; val_gene_expr_recon_loss: 64075856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74846149.3333; val_optim_loss: 74846149.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8278; val_auprc_score: 0.9459; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 9685090.3000; train_edge_recon_loss: 1193036.7937; train_gene_expr_recon_loss: 63753383.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74631510.4000; train_optim_loss: 74631510.4000; val_kl_reg_loss: 9488823.3333; val_edge_recon_loss: 1166350.2917; val_gene_expr_recon_loss: 63493176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74148349.3333; val_optim_loss: 74148349.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8374; val_auprc_score: 0.9492; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 9623624.0000; train_edge_recon_loss: 1203602.3438; train_gene_expr_recon_loss: 63336819.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74164046.0000; train_optim_loss: 74164046.0000; val_kl_reg_loss: 9442832.3333; val_edge_recon_loss: 1169288.7083; val_gene_expr_recon_loss: 63244272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73856394.6667; val_optim_loss: 73856394.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 7 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
val AUROC score: 0.9105
val AUPRC score: 0.9818
val best accuracy score: 0.8513
val best F1 score: 0.9197
val target rna MSE score: 21.9851
val source rna MSE score: 20.8439
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 5: 0 hours, 6 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9428; val_auprc_score: 0.9879; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 280280.0278; train_edge_recon_loss: 1084927.6607; train_gene_expr_recon_loss: 123407358.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 124772565.7143; train_optim_loss: 124772565.7143; val_kl_reg_loss: 205374.4844; val_edge_recon_loss: 1194679.0625; val_gene_expr_recon_loss: 63415836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64815890.0000; val_optim_loss: 64815890.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9421; val_auprc_score: 0.9879; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 318580.7935; train_edge_recon_loss: 1196823.7321; train_gene_expr_recon_loss: 58305357.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59820761.4286; train_optim_loss: 59820761.4286; val_kl_reg_loss: 385359.9531; val_edge_recon_loss: 1192869.7500; val_gene_expr_recon_loss: 54500924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56079154.0000; val_optim_loss: 56079154.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9449; val_auprc_score: 0.9888; val_best_acc_score: 0.8542; val_best_f1_score: 0.9214; train_kl_reg_loss: 412196.9062; train_edge_recon_loss: 1168133.2991; train_gene_expr_recon_loss: 53315077.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54895408.0000; train_optim_loss: 54895408.0000; val_kl_reg_loss: 421097.7031; val_edge_recon_loss: 1176816.7500; val_gene_expr_recon_loss: 51923846.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53521760.0000; val_optim_loss: 53521760.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9435; val_auprc_score: 0.9877; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 427139.6161; train_edge_recon_loss: 1191967.8214; train_gene_expr_recon_loss: 51364744.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52983852.0000; train_optim_loss: 52983852.0000; val_kl_reg_loss: 420400.0781; val_edge_recon_loss: 1213198.9375; val_gene_expr_recon_loss: 50802852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52436450.0000; val_optim_loss: 52436450.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9410; val_auprc_score: 0.9877; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 423244.3638; train_edge_recon_loss: 1195681.5179; train_gene_expr_recon_loss: 50427381.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52046307.4286; train_optim_loss: 52046307.4286; val_kl_reg_loss: 413066.0625; val_edge_recon_loss: 1172680.4375; val_gene_expr_recon_loss: 50071392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51657138.0000; val_optim_loss: 51657138.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9385; val_auprc_score: 0.9869; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 412891.0290; train_edge_recon_loss: 1191992.2143; train_gene_expr_recon_loss: 49759404.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51364287.4286; train_optim_loss: 51364287.4286; val_kl_reg_loss: 399375.2031; val_edge_recon_loss: 1190843.1875; val_gene_expr_recon_loss: 49437426.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51027644.0000; val_optim_loss: 51027644.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9390; val_auprc_score: 0.9874; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 399443.6049; train_edge_recon_loss: 1189548.0089; train_gene_expr_recon_loss: 49143640.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50732631.4286; train_optim_loss: 50732631.4286; val_kl_reg_loss: 386278.6250; val_edge_recon_loss: 1205815.5000; val_gene_expr_recon_loss: 48823646.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50415740.0000; val_optim_loss: 50415740.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9390; val_auprc_score: 0.9877; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 384903.4754; train_edge_recon_loss: 1209916.9196; train_gene_expr_recon_loss: 48454602.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50049422.8571; train_optim_loss: 50049422.8571; val_kl_reg_loss: 373094.2188; val_edge_recon_loss: 1184156.5000; val_gene_expr_recon_loss: 48079436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49636686.0000; val_optim_loss: 49636686.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9359; val_auprc_score: 0.9866; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 370548.4487; train_edge_recon_loss: 1202547.6429; train_gene_expr_recon_loss: 47638422.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49211518.8571; train_optim_loss: 49211518.8571; val_kl_reg_loss: 359067.0000; val_edge_recon_loss: 1196489.6250; val_gene_expr_recon_loss: 47231494.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48787052.0000; val_optim_loss: 48787052.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9313; val_auprc_score: 0.9859; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 355227.6049; train_edge_recon_loss: 1196292.7143; train_gene_expr_recon_loss: 46683264.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48234784.8571; train_optim_loss: 48234784.8571; val_kl_reg_loss: 343074.6562; val_edge_recon_loss: 1185042.5000; val_gene_expr_recon_loss: 46158348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47686466.0000; val_optim_loss: 47686466.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9328; val_auprc_score: 0.9862; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 339351.0312; train_edge_recon_loss: 1180857.0804; train_gene_expr_recon_loss: 45578750.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47098958.2857; train_optim_loss: 47098958.2857; val_kl_reg_loss: 326714.5000; val_edge_recon_loss: 1221220.2500; val_gene_expr_recon_loss: 44972640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46520574.0000; val_optim_loss: 46520574.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9305; val_auprc_score: 0.9858; val_best_acc_score: 0.8547; val_best_f1_score: 0.9216; train_kl_reg_loss: 324238.9464; train_edge_recon_loss: 1198013.9911; train_gene_expr_recon_loss: 44391690.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45913943.1429; train_optim_loss: 45913943.1429; val_kl_reg_loss: 310616.0000; val_edge_recon_loss: 1179695.2500; val_gene_expr_recon_loss: 43773624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45263936.0000; val_optim_loss: 45263936.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9299; val_auprc_score: 0.9865; val_best_acc_score: 0.8580; val_best_f1_score: 0.9236; train_kl_reg_loss: 345008.4085; train_edge_recon_loss: 1205853.6786; train_gene_expr_recon_loss: 43205364.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44756226.2857; train_optim_loss: 44756226.2857; val_kl_reg_loss: 295484.6562; val_edge_recon_loss: 1158268.4375; val_gene_expr_recon_loss: 42608080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44061832.0000; val_optim_loss: 44061832.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9238; val_auprc_score: 0.9839; val_best_acc_score: 0.8492; val_best_f1_score: 0.9185; train_kl_reg_loss: 442033.7299; train_edge_recon_loss: 1174486.3661; train_gene_expr_recon_loss: 42111271.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43727791.7143; train_optim_loss: 43727791.7143; val_kl_reg_loss: 281545.3281; val_edge_recon_loss: 1230049.0625; val_gene_expr_recon_loss: 41542212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43053806.0000; val_optim_loss: 43053806.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9254; val_auprc_score: 0.9849; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 377190.7924; train_edge_recon_loss: 1192224.3571; train_gene_expr_recon_loss: 41158578.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42727993.1429; train_optim_loss: 42727993.1429; val_kl_reg_loss: 272771.0781; val_edge_recon_loss: 1192766.3125; val_gene_expr_recon_loss: 40699098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42164634.0000; val_optim_loss: 42164634.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9265; val_auprc_score: 0.9862; val_best_acc_score: 0.8554; val_best_f1_score: 0.9221; train_kl_reg_loss: 277535.6562; train_edge_recon_loss: 1186311.6696; train_gene_expr_recon_loss: 41024915.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42488763.1429; train_optim_loss: 42488763.1429; val_kl_reg_loss: 386708.1719; val_edge_recon_loss: 1174890.2500; val_gene_expr_recon_loss: 40114196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41675796.0000; val_optim_loss: 41675796.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9181; val_auprc_score: 0.9804; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 32649392.9955; train_edge_recon_loss: 1120974.1920; train_gene_expr_recon_loss: 468836325.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 502606692.8571; train_optim_loss: 502606692.8571; val_kl_reg_loss: 862427.1875; val_edge_recon_loss: 1184805.4375; val_gene_expr_recon_loss: 61996632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64043866.0000; val_optim_loss: 64043866.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8852; val_auprc_score: 0.9680; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1280471.3795; train_edge_recon_loss: 1196758.1071; train_gene_expr_recon_loss: 59699146.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62176375.4286; train_optim_loss: 62176375.4286; val_kl_reg_loss: 1705442.6250; val_edge_recon_loss: 1191725.1250; val_gene_expr_recon_loss: 54002688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56899856.0000; val_optim_loss: 56899856.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8829; val_auprc_score: 0.9675; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 1926379.2589; train_edge_recon_loss: 1182903.5000; train_gene_expr_recon_loss: 52694498.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55803780.8571; train_optim_loss: 55803780.8571; val_kl_reg_loss: 2035832.9375; val_edge_recon_loss: 1196792.9375; val_gene_expr_recon_loss: 51057920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54290546.0000; val_optim_loss: 54290546.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8863; val_auprc_score: 0.9679; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 2077786.7679; train_edge_recon_loss: 1195509.7143; train_gene_expr_recon_loss: 50639185.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53912481.7143; train_optim_loss: 53912481.7143; val_kl_reg_loss: 2040510.0625; val_edge_recon_loss: 1214115.6875; val_gene_expr_recon_loss: 50107538.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53362164.0000; val_optim_loss: 53362164.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8821; val_auprc_score: 0.9669; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 2065088.7411; train_edge_recon_loss: 1196555.9018; train_gene_expr_recon_loss: 50047494.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53309139.4286; train_optim_loss: 53309139.4286; val_kl_reg_loss: 2032220.7500; val_edge_recon_loss: 1197867.3750; val_gene_expr_recon_loss: 49876470.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53106558.0000; val_optim_loss: 53106558.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8877; val_auprc_score: 0.9690; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 2056564.8571; train_edge_recon_loss: 1185878.6786; train_gene_expr_recon_loss: 49920866.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53163310.2857; train_optim_loss: 53163310.2857; val_kl_reg_loss: 2025744.0625; val_edge_recon_loss: 1182133.7500; val_gene_expr_recon_loss: 49868170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53076046.0000; val_optim_loss: 53076046.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8822; val_auprc_score: 0.9680; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 2047024.2589; train_edge_recon_loss: 1193683.9643; train_gene_expr_recon_loss: 49849883.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53090592.5714; train_optim_loss: 53090592.5714; val_kl_reg_loss: 2018248.6250; val_edge_recon_loss: 1188118.4375; val_gene_expr_recon_loss: 49795838.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53002204.0000; val_optim_loss: 53002204.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8846; val_auprc_score: 0.9673; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 2036506.7143; train_edge_recon_loss: 1192228.4107; train_gene_expr_recon_loss: 49801636.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53030370.8571; train_optim_loss: 53030370.8571; val_kl_reg_loss: 2006334.4375; val_edge_recon_loss: 1227546.6250; val_gene_expr_recon_loss: 49726586.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52960468.0000; val_optim_loss: 52960468.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 24 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9211
val AUPRC score: 0.9840
val best accuracy score: 0.8533
val best F1 score: 0.9209
val target rna MSE score: 39.9368
val source rna MSE score: 58.9289
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 4: 0 hours, 4 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 107073
Number of validation edges: 11897
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9465; val_auprc_score: 0.9885; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 1135465.3955; train_edge_recon_loss: 1113084.0312; train_gene_expr_recon_loss: 129109539.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 131358089.1429; train_optim_loss: 131358089.1429; val_kl_reg_loss: 321880.5781; val_edge_recon_loss: 1212372.7500; val_gene_expr_recon_loss: 62377570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63911824.0000; val_optim_loss: 63911824.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9446; val_auprc_score: 0.9877; val_best_acc_score: 0.8587; val_best_f1_score: 0.9240; train_kl_reg_loss: 476055.7433; train_edge_recon_loss: 1181798.0714; train_gene_expr_recon_loss: 59849582.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61507436.0000; train_optim_loss: 61507436.0000; val_kl_reg_loss: 608195.0938; val_edge_recon_loss: 1147710.0625; val_gene_expr_recon_loss: 56175992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57931898.0000; val_optim_loss: 57931898.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9385; val_auprc_score: 0.9848; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 692248.6696; train_edge_recon_loss: 1192166.5357; train_gene_expr_recon_loss: 54928080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56812495.1429; train_optim_loss: 56812495.1429; val_kl_reg_loss: 749240.6875; val_edge_recon_loss: 1218648.9375; val_gene_expr_recon_loss: 53680412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55648302.0000; val_optim_loss: 55648302.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9389; val_auprc_score: 0.9853; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 782931.4911; train_edge_recon_loss: 1189012.5089; train_gene_expr_recon_loss: 53126856.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55098800.8571; train_optim_loss: 55098800.8571; val_kl_reg_loss: 783535.8750; val_edge_recon_loss: 1188581.2500; val_gene_expr_recon_loss: 52776288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54748406.0000; val_optim_loss: 54748406.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9385; val_auprc_score: 0.9853; val_best_acc_score: 0.8552; val_best_f1_score: 0.9220; train_kl_reg_loss: 793791.9196; train_edge_recon_loss: 1204310.9107; train_gene_expr_recon_loss: 52205786.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54203888.2857; train_optim_loss: 54203888.2857; val_kl_reg_loss: 778379.4062; val_edge_recon_loss: 1163023.5625; val_gene_expr_recon_loss: 51887620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53829024.0000; val_optim_loss: 53829024.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9410; val_auprc_score: 0.9857; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 777984.6295; train_edge_recon_loss: 1210148.1429; train_gene_expr_recon_loss: 51464766.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53452899.7143; train_optim_loss: 53452899.7143; val_kl_reg_loss: 754440.1875; val_edge_recon_loss: 1219185.1250; val_gene_expr_recon_loss: 51185546.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53159172.0000; val_optim_loss: 53159172.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9363; val_auprc_score: 0.9839; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 754012.2679; train_edge_recon_loss: 1196900.8036; train_gene_expr_recon_loss: 50768404.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52719317.7143; train_optim_loss: 52719317.7143; val_kl_reg_loss: 732486.2188; val_edge_recon_loss: 1224441.9375; val_gene_expr_recon_loss: 50484022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52440950.0000; val_optim_loss: 52440950.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9399; val_auprc_score: 0.9856; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 726855.5000; train_edge_recon_loss: 1207304.1696; train_gene_expr_recon_loss: 49999299.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51933458.8571; train_optim_loss: 51933458.8571; val_kl_reg_loss: 702547.2500; val_edge_recon_loss: 1206836.9375; val_gene_expr_recon_loss: 49612390.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51521774.0000; val_optim_loss: 51521774.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9386; val_auprc_score: 0.9856; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 699758.3839; train_edge_recon_loss: 1197655.8929; train_gene_expr_recon_loss: 49097122.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50994537.4286; train_optim_loss: 50994537.4286; val_kl_reg_loss: 676051.5000; val_edge_recon_loss: 1184129.5000; val_gene_expr_recon_loss: 48648040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50508220.0000; val_optim_loss: 50508220.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9389; val_auprc_score: 0.9860; val_best_acc_score: 0.8530; val_best_f1_score: 0.9206; train_kl_reg_loss: 673503.7411; train_edge_recon_loss: 1180343.7366; train_gene_expr_recon_loss: 48028401.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49882248.5714; train_optim_loss: 49882248.5714; val_kl_reg_loss: 649382.4062; val_edge_recon_loss: 1201630.9375; val_gene_expr_recon_loss: 47483738.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49334752.0000; val_optim_loss: 49334752.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9391; val_auprc_score: 0.9857; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 647760.0000; train_edge_recon_loss: 1203107.3571; train_gene_expr_recon_loss: 46840482.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48691348.8571; train_optim_loss: 48691348.8571; val_kl_reg_loss: 624683.8438; val_edge_recon_loss: 1195336.5625; val_gene_expr_recon_loss: 46234072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48054092.0000; val_optim_loss: 48054092.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9331; val_auprc_score: 0.9841; val_best_acc_score: 0.8486; val_best_f1_score: 0.9181; train_kl_reg_loss: 622073.8214; train_edge_recon_loss: 1179829.4866; train_gene_expr_recon_loss: 45601134.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47403037.7143; train_optim_loss: 47403037.7143; val_kl_reg_loss: 601709.0625; val_edge_recon_loss: 1237509.3750; val_gene_expr_recon_loss: 45035486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46874704.0000; val_optim_loss: 46874704.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9348; val_auprc_score: 0.9848; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 598023.3884; train_edge_recon_loss: 1199805.2411; train_gene_expr_recon_loss: 44406846.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46204674.8571; train_optim_loss: 46204674.8571; val_kl_reg_loss: 577234.6562; val_edge_recon_loss: 1216386.7500; val_gene_expr_recon_loss: 43880488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45674110.0000; val_optim_loss: 45674110.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9342; val_auprc_score: 0.9859; val_best_acc_score: 0.8571; val_best_f1_score: 0.9231; train_kl_reg_loss: 574564.0580; train_edge_recon_loss: 1192067.8571; train_gene_expr_recon_loss: 43357559.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45124191.4286; train_optim_loss: 45124191.4286; val_kl_reg_loss: 553933.3750; val_edge_recon_loss: 1154057.4375; val_gene_expr_recon_loss: 42908574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44616564.0000; val_optim_loss: 44616564.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9305; val_auprc_score: 0.9820; val_best_acc_score: 0.8511; val_best_f1_score: 0.9195; train_kl_reg_loss: 79554676.7991; train_edge_recon_loss: 1130341.8571; train_gene_expr_recon_loss: 496999260.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 577684276.0000; train_optim_loss: 577684276.0000; val_kl_reg_loss: 1260957.8125; val_edge_recon_loss: 1211954.4375; val_gene_expr_recon_loss: 126859192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 129332104.0000; val_optim_loss: 129332104.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9035; val_auprc_score: 0.9730; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 1743597.1696; train_edge_recon_loss: 1189239.8304; train_gene_expr_recon_loss: 86446006.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 89378843.1429; train_optim_loss: 89378843.1429; val_kl_reg_loss: 2176746.8750; val_edge_recon_loss: 1209148.9375; val_gene_expr_recon_loss: 63458468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66844362.0000; val_optim_loss: 66844362.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8953; val_auprc_score: 0.9705; val_best_acc_score: 0.8530; val_best_f1_score: 0.9206; train_kl_reg_loss: 2389054.6071; train_edge_recon_loss: 1189447.2232; train_gene_expr_recon_loss: 58503586.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62082088.2857; train_optim_loss: 62082088.2857; val_kl_reg_loss: 2464851.1250; val_edge_recon_loss: 1206780.0625; val_gene_expr_recon_loss: 56565156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60236788.0000; val_optim_loss: 60236788.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8992; val_auprc_score: 0.9718; val_best_acc_score: 0.8526; val_best_f1_score: 0.9205; train_kl_reg_loss: 2468350.4286; train_edge_recon_loss: 1191728.0268; train_gene_expr_recon_loss: 55077951.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58738030.5714; train_optim_loss: 58738030.5714; val_kl_reg_loss: 2368816.1250; val_edge_recon_loss: 1223259.5625; val_gene_expr_recon_loss: 54491236.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58083312.0000; val_optim_loss: 58083312.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8979; val_auprc_score: 0.9705; val_best_acc_score: 0.8491; val_best_f1_score: 0.9184; train_kl_reg_loss: 2392502.1786; train_edge_recon_loss: 1194867.7768; train_gene_expr_recon_loss: 54239334.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57826704.8571; train_optim_loss: 57826704.8571; val_kl_reg_loss: 2351615.0000; val_edge_recon_loss: 1224219.6875; val_gene_expr_recon_loss: 54217968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57793802.0000; val_optim_loss: 57793802.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8955; val_auprc_score: 0.9698; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 2372843.2679; train_edge_recon_loss: 1189560.4286; train_gene_expr_recon_loss: 54056647.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57619051.1429; train_optim_loss: 57619051.1429; val_kl_reg_loss: 2324482.5000; val_edge_recon_loss: 1223399.5625; val_gene_expr_recon_loss: 54044084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57591966.0000; val_optim_loss: 57591966.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8985; val_auprc_score: 0.9716; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 2350719.0536; train_edge_recon_loss: 1186401.1786; train_gene_expr_recon_loss: 53993293.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57530414.0000; train_optim_loss: 57530414.0000; val_kl_reg_loss: 2306646.2500; val_edge_recon_loss: 1192092.3750; val_gene_expr_recon_loss: 54080238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57578976.0000; val_optim_loss: 57578976.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8921; val_auprc_score: 0.9703; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 2326959.8571; train_edge_recon_loss: 1179133.1161; train_gene_expr_recon_loss: 53931421.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57437514.2857; train_optim_loss: 57437514.2857; val_kl_reg_loss: 2284243.3750; val_edge_recon_loss: 1176827.0625; val_gene_expr_recon_loss: 53974696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57435766.0000; val_optim_loss: 57435766.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 59 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
val AUROC score: 0.9382
val AUPRC score: 0.9866
val best accuracy score: 0.8557
val best F1 score: 0.9222
val target rna MSE score: 99.0732
val source rna MSE score: 103.0921
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 3: 0 hours, 4 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9212; val_auprc_score: 0.9848; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 505523.5057; train_edge_recon_loss: 1075743.8839; train_gene_expr_recon_loss: 135001892.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 136583162.8571; train_optim_loss: 136583162.8571; val_kl_reg_loss: 105312.3438; val_edge_recon_loss: 1169918.7500; val_gene_expr_recon_loss: 67184392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68459624.0000; val_optim_loss: 68459624.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9227; val_auprc_score: 0.9839; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 231974.0234; train_edge_recon_loss: 1139806.5357; train_gene_expr_recon_loss: 64147700.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65519481.1429; train_optim_loss: 65519481.1429; val_kl_reg_loss: 333139.0000; val_edge_recon_loss: 1211714.6250; val_gene_expr_recon_loss: 64906596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66451448.0000; val_optim_loss: 66451448.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9173; val_auprc_score: 0.9817; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 421504.6473; train_edge_recon_loss: 1178369.0536; train_gene_expr_recon_loss: 58996283.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60596156.5714; train_optim_loss: 60596156.5714; val_kl_reg_loss: 496804.1250; val_edge_recon_loss: 1204952.1250; val_gene_expr_recon_loss: 56687724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58389480.0000; val_optim_loss: 58389480.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9162; val_auprc_score: 0.9818; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 549872.9911; train_edge_recon_loss: 1177703.1429; train_gene_expr_recon_loss: 55261097.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56988674.8571; train_optim_loss: 56988674.8571; val_kl_reg_loss: 569457.0000; val_edge_recon_loss: 1201081.2500; val_gene_expr_recon_loss: 53869496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55640036.0000; val_optim_loss: 55640036.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9146; val_auprc_score: 0.9814; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 605683.1786; train_edge_recon_loss: 1204851.8214; train_gene_expr_recon_loss: 53612667.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55423202.2857; train_optim_loss: 55423202.2857; val_kl_reg_loss: 606397.6250; val_edge_recon_loss: 1198175.1250; val_gene_expr_recon_loss: 52685028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54489600.0000; val_optim_loss: 54489600.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9147; val_auprc_score: 0.9804; val_best_acc_score: 0.8530; val_best_f1_score: 0.9207; train_kl_reg_loss: 628996.7054; train_edge_recon_loss: 1189630.1786; train_gene_expr_recon_loss: 52342394.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54161021.7143; train_optim_loss: 54161021.7143; val_kl_reg_loss: 614526.5000; val_edge_recon_loss: 1195265.5000; val_gene_expr_recon_loss: 51976848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53786640.0000; val_optim_loss: 53786640.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9173; val_auprc_score: 0.9823; val_best_acc_score: 0.8586; val_best_f1_score: 0.9239; train_kl_reg_loss: 633959.3304; train_edge_recon_loss: 1191536.5536; train_gene_expr_recon_loss: 51528874.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53354369.7143; train_optim_loss: 53354369.7143; val_kl_reg_loss: 614961.6250; val_edge_recon_loss: 1150351.1250; val_gene_expr_recon_loss: 51363896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53129208.0000; val_optim_loss: 53129208.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9172; val_auprc_score: 0.9821; val_best_acc_score: 0.8588; val_best_f1_score: 0.9240; train_kl_reg_loss: 629553.3750; train_edge_recon_loss: 1193077.7143; train_gene_expr_recon_loss: 50910126.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52732757.7143; train_optim_loss: 52732757.7143; val_kl_reg_loss: 606907.3750; val_edge_recon_loss: 1148385.2500; val_gene_expr_recon_loss: 50681008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52436300.0000; val_optim_loss: 52436300.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9121; val_auprc_score: 0.9811; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 621277.3839; train_edge_recon_loss: 1176887.9464; train_gene_expr_recon_loss: 50336748.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52134912.5714; train_optim_loss: 52134912.5714; val_kl_reg_loss: 597571.0000; val_edge_recon_loss: 1174832.7500; val_gene_expr_recon_loss: 50159536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51931940.0000; val_optim_loss: 51931940.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9170; val_auprc_score: 0.9809; val_best_acc_score: 0.8476; val_best_f1_score: 0.9175; train_kl_reg_loss: 611266.6875; train_edge_recon_loss: 1200037.4464; train_gene_expr_recon_loss: 49861368.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51672672.0000; train_optim_loss: 51672672.0000; val_kl_reg_loss: 585451.1250; val_edge_recon_loss: 1239605.3750; val_gene_expr_recon_loss: 49684288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51509344.0000; val_optim_loss: 51509344.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9147; val_auprc_score: 0.9814; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 597094.3304; train_edge_recon_loss: 1195285.5893; train_gene_expr_recon_loss: 49362671.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51155050.8571; train_optim_loss: 51155050.8571; val_kl_reg_loss: 571425.0000; val_edge_recon_loss: 1202049.6250; val_gene_expr_recon_loss: 49185428.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50958904.0000; val_optim_loss: 50958904.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9191; val_auprc_score: 0.9826; val_best_acc_score: 0.8492; val_best_f1_score: 0.9185; train_kl_reg_loss: 582433.0625; train_edge_recon_loss: 1185277.3214; train_gene_expr_recon_loss: 48855028.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50622738.8571; train_optim_loss: 50622738.8571; val_kl_reg_loss: 556054.2500; val_edge_recon_loss: 1226170.2500; val_gene_expr_recon_loss: 48648064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50430288.0000; val_optim_loss: 50430288.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9167; val_auprc_score: 0.9826; val_best_acc_score: 0.8559; val_best_f1_score: 0.9224; train_kl_reg_loss: 567304.1339; train_edge_recon_loss: 1188184.3036; train_gene_expr_recon_loss: 48298804.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50054292.5714; train_optim_loss: 50054292.5714; val_kl_reg_loss: 541370.7500; val_edge_recon_loss: 1171903.7500; val_gene_expr_recon_loss: 48070240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49783516.0000; val_optim_loss: 49783516.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9066; val_auprc_score: 0.9791; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 552830.1518; train_edge_recon_loss: 1215812.7679; train_gene_expr_recon_loss: 47710230.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49478873.1429; train_optim_loss: 49478873.1429; val_kl_reg_loss: 528245.2500; val_edge_recon_loss: 1213648.0000; val_gene_expr_recon_loss: 47444784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49186676.0000; val_optim_loss: 49186676.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9148; val_auprc_score: 0.9818; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 538728.9375; train_edge_recon_loss: 1198000.8571; train_gene_expr_recon_loss: 47060026.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48796757.1429; train_optim_loss: 48796757.1429; val_kl_reg_loss: 514645.0000; val_edge_recon_loss: 1212682.5000; val_gene_expr_recon_loss: 46780108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48507436.0000; val_optim_loss: 48507436.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9089; val_auprc_score: 0.9795; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 525147.7545; train_edge_recon_loss: 1208141.1607; train_gene_expr_recon_loss: 46377057.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48110346.2857; train_optim_loss: 48110346.2857; val_kl_reg_loss: 501803.0625; val_edge_recon_loss: 1201079.5000; val_gene_expr_recon_loss: 46074564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47777448.0000; val_optim_loss: 47777448.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9127; val_auprc_score: 0.9816; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 511673.2277; train_edge_recon_loss: 1197577.4643; train_gene_expr_recon_loss: 45654276.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47363527.4286; train_optim_loss: 47363527.4286; val_kl_reg_loss: 488196.8750; val_edge_recon_loss: 1200110.8750; val_gene_expr_recon_loss: 45341160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47029468.0000; val_optim_loss: 47029468.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9102; val_auprc_score: 0.9807; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 498104.6830; train_edge_recon_loss: 1197206.5000; train_gene_expr_recon_loss: 44924092.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46619403.4286; train_optim_loss: 46619403.4286; val_kl_reg_loss: 476219.0000; val_edge_recon_loss: 1202046.8750; val_gene_expr_recon_loss: 44600900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46279164.0000; val_optim_loss: 46279164.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9172; val_auprc_score: 0.9838; val_best_acc_score: 0.8582; val_best_f1_score: 0.9237; train_kl_reg_loss: 485371.4866; train_edge_recon_loss: 1196931.7143; train_gene_expr_recon_loss: 44184433.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45866736.0000; train_optim_loss: 45866736.0000; val_kl_reg_loss: 463784.6250; val_edge_recon_loss: 1153294.8750; val_gene_expr_recon_loss: 43871636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45488716.0000; val_optim_loss: 45488716.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9113; val_auprc_score: 0.9807; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 472453.6116; train_edge_recon_loss: 1200790.4643; train_gene_expr_recon_loss: 43465132.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45138376.5714; train_optim_loss: 45138376.5714; val_kl_reg_loss: 450746.0625; val_edge_recon_loss: 1221356.3750; val_gene_expr_recon_loss: 43157288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44829392.0000; val_optim_loss: 44829392.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9128; val_auprc_score: 0.9815; val_best_acc_score: 0.8493; val_best_f1_score: 0.9185; train_kl_reg_loss: 459630.1429; train_edge_recon_loss: 1213592.8214; train_gene_expr_recon_loss: 42765728.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44438950.8571; train_optim_loss: 44438950.8571; val_kl_reg_loss: 439748.3750; val_edge_recon_loss: 1225204.5000; val_gene_expr_recon_loss: 42498976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44163928.0000; val_optim_loss: 44163928.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9125; val_auprc_score: 0.9821; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 447545.7143; train_edge_recon_loss: 1182696.9107; train_gene_expr_recon_loss: 42119530.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43749773.1429; train_optim_loss: 43749773.1429; val_kl_reg_loss: 427333.2812; val_edge_recon_loss: 1199137.5000; val_gene_expr_recon_loss: 41872888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43499360.0000; val_optim_loss: 43499360.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9045; val_auprc_score: 0.9800; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 435290.6741; train_edge_recon_loss: 1205244.1607; train_gene_expr_recon_loss: 41525170.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43165705.1429; train_optim_loss: 43165705.1429; val_kl_reg_loss: 416206.5000; val_edge_recon_loss: 1180675.7500; val_gene_expr_recon_loss: 41318436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42915320.0000; val_optim_loss: 42915320.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9052; val_auprc_score: 0.9795; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 423850.0089; train_edge_recon_loss: 1211107.6964; train_gene_expr_recon_loss: 41001216.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42636173.1429; train_optim_loss: 42636173.1429; val_kl_reg_loss: 404318.3125; val_edge_recon_loss: 1215570.3750; val_gene_expr_recon_loss: 40823032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42442920.0000; val_optim_loss: 42442920.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8994; val_auprc_score: 0.9808; val_best_acc_score: 0.8624; val_best_f1_score: 0.9261; train_kl_reg_loss: 411872.6071; train_edge_recon_loss: 1185438.6250; train_gene_expr_recon_loss: 40529082.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42126393.7143; train_optim_loss: 42126393.7143; val_kl_reg_loss: 393650.0000; val_edge_recon_loss: 1118753.3750; val_gene_expr_recon_loss: 40386328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41898732.0000; val_optim_loss: 41898732.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8963; val_auprc_score: 0.9788; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 401075.4777; train_edge_recon_loss: 1192079.9821; train_gene_expr_recon_loss: 40121698.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41714853.1429; train_optim_loss: 41714853.1429; val_kl_reg_loss: 383425.0625; val_edge_recon_loss: 1204942.5000; val_gene_expr_recon_loss: 40016832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41605200.0000; val_optim_loss: 41605200.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8937; val_auprc_score: 0.9770; val_best_acc_score: 0.8497; val_best_f1_score: 0.9187; train_kl_reg_loss: 390589.6071; train_edge_recon_loss: 1191883.4286; train_gene_expr_recon_loss: 39773361.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41355834.8571; train_optim_loss: 41355834.8571; val_kl_reg_loss: 372540.2188; val_edge_recon_loss: 1222309.3750; val_gene_expr_recon_loss: 39693856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41288704.0000; val_optim_loss: 41288704.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8907; val_auprc_score: 0.9763; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 379804.2589; train_edge_recon_loss: 1199198.4286; train_gene_expr_recon_loss: 39468301.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41047304.5714; train_optim_loss: 41047304.5714; val_kl_reg_loss: 362553.0000; val_edge_recon_loss: 1207837.0000; val_gene_expr_recon_loss: 39433444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41003832.0000; val_optim_loss: 41003832.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8932; val_auprc_score: 0.9774; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 369663.1071; train_edge_recon_loss: 1201337.9286; train_gene_expr_recon_loss: 39207073.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40778074.2857; train_optim_loss: 40778074.2857; val_kl_reg_loss: 352765.0312; val_edge_recon_loss: 1212663.7500; val_gene_expr_recon_loss: 39175536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40740964.0000; val_optim_loss: 40740964.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8867; val_auprc_score: 0.9768; val_best_acc_score: 0.8533; val_best_f1_score: 0.9208; train_kl_reg_loss: 359686.3348; train_edge_recon_loss: 1177318.6429; train_gene_expr_recon_loss: 38979861.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40516866.2857; train_optim_loss: 40516866.2857; val_kl_reg_loss: 344190.2500; val_edge_recon_loss: 1193300.0000; val_gene_expr_recon_loss: 38974004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40511496.0000; val_optim_loss: 40511496.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8860; val_auprc_score: 0.9784; val_best_acc_score: 0.8628; val_best_f1_score: 0.9263; train_kl_reg_loss: 350490.3661; train_edge_recon_loss: 1193080.7321; train_gene_expr_recon_loss: 38792030.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40335601.7143; train_optim_loss: 40335601.7143; val_kl_reg_loss: 335482.3125; val_edge_recon_loss: 1115758.8750; val_gene_expr_recon_loss: 38799416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40250656.0000; val_optim_loss: 40250656.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8896; val_auprc_score: 0.9779; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 341746.8973; train_edge_recon_loss: 1201572.7679; train_gene_expr_recon_loss: 38634239.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40177559.4286; train_optim_loss: 40177559.4286; val_kl_reg_loss: 326709.3750; val_edge_recon_loss: 1170891.2500; val_gene_expr_recon_loss: 38647032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40144632.0000; val_optim_loss: 40144632.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8771; val_auprc_score: 0.9744; val_best_acc_score: 0.8569; val_best_f1_score: 0.9229; train_kl_reg_loss: 333181.1875; train_edge_recon_loss: 1207318.3571; train_gene_expr_recon_loss: 38492269.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40032768.5714; train_optim_loss: 40032768.5714; val_kl_reg_loss: 318113.6875; val_edge_recon_loss: 1164045.5000; val_gene_expr_recon_loss: 38514624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39996784.0000; val_optim_loss: 39996784.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8779; val_auprc_score: 0.9745; val_best_acc_score: 0.8453; val_best_f1_score: 0.9162; train_kl_reg_loss: 324588.2902; train_edge_recon_loss: 1202593.8750; train_gene_expr_recon_loss: 38370128.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39897310.2857; train_optim_loss: 39897310.2857; val_kl_reg_loss: 311993.0000; val_edge_recon_loss: 1257706.2500; val_gene_expr_recon_loss: 38392296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39961996.0000; val_optim_loss: 39961996.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8683; val_auprc_score: 0.9728; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 317886.0312; train_edge_recon_loss: 1189874.5536; train_gene_expr_recon_loss: 38245830.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39753591.4286; train_optim_loss: 39753591.4286; val_kl_reg_loss: 302238.3750; val_edge_recon_loss: 1217456.8750; val_gene_expr_recon_loss: 38278228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39797924.0000; val_optim_loss: 39797924.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8778; val_auprc_score: 0.9749; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 504935235.4821; train_edge_recon_loss: 1135623.1429; train_gene_expr_recon_loss: 446652182.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 952723032.5714; train_optim_loss: 952723032.5714; val_kl_reg_loss: 763906.5000; val_edge_recon_loss: 1177737.0000; val_gene_expr_recon_loss: 150076976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 152018624.0000; val_optim_loss: 152018624.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8726; val_auprc_score: 0.9691; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 5524348965.8214; train_edge_recon_loss: 1118917.9464; train_gene_expr_recon_loss: 921200246.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6446668150.8571; train_optim_loss: 6446668150.8571; val_kl_reg_loss: 1507044.5000; val_edge_recon_loss: 1213648.0000; val_gene_expr_recon_loss: 169883696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 172604384.0000; val_optim_loss: 172604384.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8607; val_auprc_score: 0.9649; val_best_acc_score: 0.8547; val_best_f1_score: 0.9217; train_kl_reg_loss: 1373463464.9107; train_edge_recon_loss: 1138722.4464; train_gene_expr_recon_loss: 697646372.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2072248502.8571; train_optim_loss: 2072248502.8571; val_kl_reg_loss: 2667751.5000; val_edge_recon_loss: 1181658.3750; val_gene_expr_recon_loss: 259447200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 263296608.0000; val_optim_loss: 263296608.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8557; val_auprc_score: 0.9595; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 392444322.1429; train_edge_recon_loss: 1118741.0000; train_gene_expr_recon_loss: 827848736.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1221411808.0000; train_optim_loss: 1221411808.0000; val_kl_reg_loss: 39338885120.0000; val_edge_recon_loss: 1173860.6250; val_gene_expr_recon_loss: 229382304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39569444864.0000; val_optim_loss: 39569444864.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8580; val_auprc_score: 0.9584; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 7624325920.7857; train_edge_recon_loss: 1161677.5000; train_gene_expr_recon_loss: 483850370.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8109337757.7143; train_optim_loss: 8109337757.7143; val_kl_reg_loss: 4047252.0000; val_edge_recon_loss: 1213652.3750; val_gene_expr_recon_loss: 167486160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 172747072.0000; val_optim_loss: 172747072.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8373; val_auprc_score: 0.9536; val_best_acc_score: 0.8560; val_best_f1_score: 0.9224; train_kl_reg_loss: 4147078.5000; train_edge_recon_loss: 1182190.2143; train_gene_expr_recon_loss: 147616125.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 152945396.5714; train_optim_loss: 152945396.5714; val_kl_reg_loss: 3992320.0000; val_edge_recon_loss: 1170931.1250; val_gene_expr_recon_loss: 127748080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 132911328.0000; val_optim_loss: 132911328.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8629; val_auprc_score: 0.9618; val_best_acc_score: 0.8564; val_best_f1_score: 0.9226; train_kl_reg_loss: 4069928.6786; train_edge_recon_loss: 1188753.1786; train_gene_expr_recon_loss: 114487713.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 119746396.5714; train_optim_loss: 119746396.5714; val_kl_reg_loss: 3893442.2500; val_edge_recon_loss: 1167998.6250; val_gene_expr_recon_loss: 102882896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 107944336.0000; val_optim_loss: 107944336.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8625; val_auprc_score: 0.9621; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 3970890.3214; train_edge_recon_loss: 1208850.3571; train_gene_expr_recon_loss: 96135770.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 101315510.8571; train_optim_loss: 101315510.8571; val_kl_reg_loss: 3794247.0000; val_edge_recon_loss: 1176787.8750; val_gene_expr_recon_loss: 88934864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 93905896.0000; val_optim_loss: 93905896.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 32 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.8799
val AUPRC score: 0.9750
val best accuracy score: 0.8491
val best F1 score: 0.9184
val target rna MSE score: 30.8440
val source rna MSE score: 26.2082
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 2: 0 hours, 4 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1493, n_latent: 1483, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1483, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 23655
Number of validation nodes: 2628
Number of training edges: 54907
Number of validation edges: 6100
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9157; val_auprc_score: 0.9819; val_best_acc_score: 0.8463; val_best_f1_score: 0.9167; train_kl_reg_loss: 256970.9821; train_edge_recon_loss: 1066959.6607; train_gene_expr_recon_loss: 78218980.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79542909.7143; train_optim_loss: 79542909.7143; val_kl_reg_loss: 233777.6562; val_edge_recon_loss: 1250100.0000; val_gene_expr_recon_loss: 60403008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61886884.0000; val_optim_loss: 61886884.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9189; val_auprc_score: 0.9840; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 390741.4754; train_edge_recon_loss: 1189487.5893; train_gene_expr_recon_loss: 61666365.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63246594.2857; train_optim_loss: 63246594.2857; val_kl_reg_loss: 564258.7500; val_edge_recon_loss: 1168967.0000; val_gene_expr_recon_loss: 58846332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60579556.0000; val_optim_loss: 60579556.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9116; val_auprc_score: 0.9809; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 707480.4286; train_edge_recon_loss: 1198131.8214; train_gene_expr_recon_loss: 57311384.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59216996.5714; train_optim_loss: 59216996.5714; val_kl_reg_loss: 827437.1875; val_edge_recon_loss: 1215575.6250; val_gene_expr_recon_loss: 55755064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 57798076.0000; val_optim_loss: 57798076.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9073; val_auprc_score: 0.9805; val_best_acc_score: 0.8566; val_best_f1_score: 0.9228; train_kl_reg_loss: 931661.5179; train_edge_recon_loss: 1182463.2500; train_gene_expr_recon_loss: 55309470.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57423596.0000; train_optim_loss: 57423596.0000; val_kl_reg_loss: 989413.7500; val_edge_recon_loss: 1166038.3750; val_gene_expr_recon_loss: 54493880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56649332.0000; val_optim_loss: 56649332.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9064; val_auprc_score: 0.9778; val_best_acc_score: 0.8456; val_best_f1_score: 0.9163; train_kl_reg_loss: 1071200.1607; train_edge_recon_loss: 1197486.9107; train_gene_expr_recon_loss: 54871057.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 57139743.4286; train_optim_loss: 57139743.4286; val_kl_reg_loss: 1096894.2500; val_edge_recon_loss: 1255848.5000; val_gene_expr_recon_loss: 54295808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 56648552.0000; val_optim_loss: 56648552.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9077; val_auprc_score: 0.9790; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 1171187.1429; train_edge_recon_loss: 1188102.2321; train_gene_expr_recon_loss: 53888586.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 56247876.0000; train_optim_loss: 56247876.0000; val_kl_reg_loss: 1178472.0000; val_edge_recon_loss: 1218469.7500; val_gene_expr_recon_loss: 53568456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55965396.0000; val_optim_loss: 55965396.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9134; val_auprc_score: 0.9807; val_best_acc_score: 0.8496; val_best_f1_score: 0.9187; train_kl_reg_loss: 1232957.9286; train_edge_recon_loss: 1190931.7321; train_gene_expr_recon_loss: 53203335.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55627225.7143; train_optim_loss: 55627225.7143; val_kl_reg_loss: 1213133.8750; val_edge_recon_loss: 1223284.8750; val_gene_expr_recon_loss: 52894528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 55330948.0000; val_optim_loss: 55330948.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9012; val_auprc_score: 0.9777; val_best_acc_score: 0.8572; val_best_f1_score: 0.9231; train_kl_reg_loss: 1257675.3393; train_edge_recon_loss: 1199187.5536; train_gene_expr_recon_loss: 52602476.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55059338.8571; train_optim_loss: 55059338.8571; val_kl_reg_loss: 1224019.2500; val_edge_recon_loss: 1161143.5000; val_gene_expr_recon_loss: 52294508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54679672.0000; val_optim_loss: 54679672.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9013; val_auprc_score: 0.9765; val_best_acc_score: 0.8459; val_best_f1_score: 0.9165; train_kl_reg_loss: 1257002.4286; train_edge_recon_loss: 1203734.6429; train_gene_expr_recon_loss: 52021225.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54481962.2857; train_optim_loss: 54481962.2857; val_kl_reg_loss: 1213487.7500; val_edge_recon_loss: 1252987.5000; val_gene_expr_recon_loss: 51723648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 54190124.0000; val_optim_loss: 54190124.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8984; val_auprc_score: 0.9780; val_best_acc_score: 0.8557; val_best_f1_score: 0.9222; train_kl_reg_loss: 1242789.1071; train_edge_recon_loss: 1206347.2857; train_gene_expr_recon_loss: 51464093.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53913229.7143; train_optim_loss: 53913229.7143; val_kl_reg_loss: 1192529.5000; val_edge_recon_loss: 1173856.1250; val_gene_expr_recon_loss: 51139616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53506000.0000; val_optim_loss: 53506000.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9019; val_auprc_score: 0.9782; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 1220332.5893; train_edge_recon_loss: 1201530.5357; train_gene_expr_recon_loss: 50860218.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 53282081.1429; train_optim_loss: 53282081.1429; val_kl_reg_loss: 1170089.2500; val_edge_recon_loss: 1191381.5000; val_gene_expr_recon_loss: 50508192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52869664.0000; val_optim_loss: 52869664.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9054; val_auprc_score: 0.9787; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 1194437.5536; train_edge_recon_loss: 1193127.5893; train_gene_expr_recon_loss: 50183453.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52571018.2857; train_optim_loss: 52571018.2857; val_kl_reg_loss: 1144206.0000; val_edge_recon_loss: 1203015.5000; val_gene_expr_recon_loss: 49793592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52140812.0000; val_optim_loss: 52140812.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9017; val_auprc_score: 0.9798; val_best_acc_score: 0.8581; val_best_f1_score: 0.9236; train_kl_reg_loss: 1168452.1071; train_edge_recon_loss: 1192970.9286; train_gene_expr_recon_loss: 49432815.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51794238.2857; train_optim_loss: 51794238.2857; val_kl_reg_loss: 1117856.5000; val_edge_recon_loss: 1154277.8750; val_gene_expr_recon_loss: 48976216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 51248352.0000; val_optim_loss: 51248352.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9001; val_auprc_score: 0.9778; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 1141482.1250; train_edge_recon_loss: 1180164.9643; train_gene_expr_recon_loss: 48586758.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50908406.2857; train_optim_loss: 50908406.2857; val_kl_reg_loss: 1092670.6250; val_edge_recon_loss: 1178731.0000; val_gene_expr_recon_loss: 48093264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50364664.0000; val_optim_loss: 50364664.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9006; val_auprc_score: 0.9788; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 1114160.7857; train_edge_recon_loss: 1184938.5357; train_gene_expr_recon_loss: 47665536.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49964635.4286; train_optim_loss: 49964635.4286; val_kl_reg_loss: 1065156.0000; val_edge_recon_loss: 1180679.7500; val_gene_expr_recon_loss: 47132204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49378040.0000; val_optim_loss: 49378040.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8973; val_auprc_score: 0.9769; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 1087050.6964; train_edge_recon_loss: 1177939.3929; train_gene_expr_recon_loss: 46691080.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48956070.2857; train_optim_loss: 48956070.2857; val_kl_reg_loss: 1038197.6875; val_edge_recon_loss: 1192347.1250; val_gene_expr_recon_loss: 46134852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48365396.0000; val_optim_loss: 48365396.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8980; val_auprc_score: 0.9772; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 1061290.9286; train_edge_recon_loss: 1204001.3393; train_gene_expr_recon_loss: 45705684.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47970975.4286; train_optim_loss: 47970975.4286; val_kl_reg_loss: 1013107.6250; val_edge_recon_loss: 1204945.1250; val_gene_expr_recon_loss: 45154160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47372212.0000; val_optim_loss: 47372212.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8965; val_auprc_score: 0.9765; val_best_acc_score: 0.8478; val_best_f1_score: 0.9176; train_kl_reg_loss: 1033635.1964; train_edge_recon_loss: 1189862.1250; train_gene_expr_recon_loss: 44731202.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46954700.0000; train_optim_loss: 46954700.0000; val_kl_reg_loss: 987841.5000; val_edge_recon_loss: 1237681.3750; val_gene_expr_recon_loss: 44218256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46443780.0000; val_optim_loss: 46443780.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8978; val_auprc_score: 0.9781; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 1008243.8125; train_edge_recon_loss: 1188555.7321; train_gene_expr_recon_loss: 43836742.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46033541.7143; train_optim_loss: 46033541.7143; val_kl_reg_loss: 964514.3750; val_edge_recon_loss: 1202040.5000; val_gene_expr_recon_loss: 43380584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45547140.0000; val_optim_loss: 45547140.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8996; val_auprc_score: 0.9786; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 983465.6250; train_edge_recon_loss: 1185214.6786; train_gene_expr_recon_loss: 43036202.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45204883.4286; train_optim_loss: 45204883.4286; val_kl_reg_loss: 939149.7500; val_edge_recon_loss: 1199131.1250; val_gene_expr_recon_loss: 42641736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44780016.0000; val_optim_loss: 44780016.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8915; val_auprc_score: 0.9767; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 958880.3661; train_edge_recon_loss: 1196717.4821; train_gene_expr_recon_loss: 42358005.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44513602.2857; train_optim_loss: 44513602.2857; val_kl_reg_loss: 915839.8750; val_edge_recon_loss: 1190397.2500; val_gene_expr_recon_loss: 42017052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44123288.0000; val_optim_loss: 44123288.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9014; val_auprc_score: 0.9803; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 935117.0804; train_edge_recon_loss: 1198960.5000; train_gene_expr_recon_loss: 41789474.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43923552.5714; train_optim_loss: 43923552.5714; val_kl_reg_loss: 893214.2500; val_edge_recon_loss: 1199126.7500; val_gene_expr_recon_loss: 41516736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43609076.0000; val_optim_loss: 43609076.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8852; val_auprc_score: 0.9756; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 911614.3661; train_edge_recon_loss: 1183415.0536; train_gene_expr_recon_loss: 41333012.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43428042.8571; train_optim_loss: 43428042.8571; val_kl_reg_loss: 870818.7500; val_edge_recon_loss: 1200092.0000; val_gene_expr_recon_loss: 41118044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43188956.0000; val_optim_loss: 43188956.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8858; val_auprc_score: 0.9758; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 888728.7321; train_edge_recon_loss: 1202059.7143; train_gene_expr_recon_loss: 40965880.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43056669.1429; train_optim_loss: 43056669.1429; val_kl_reg_loss: 846908.6250; val_edge_recon_loss: 1179684.0000; val_gene_expr_recon_loss: 40794844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42821436.0000; val_optim_loss: 42821436.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8874; val_auprc_score: 0.9768; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 865804.5357; train_edge_recon_loss: 1196143.3929; train_gene_expr_recon_loss: 40673822.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42735770.2857; train_optim_loss: 42735770.2857; val_kl_reg_loss: 827828.6250; val_edge_recon_loss: 1191349.1250; val_gene_expr_recon_loss: 40547000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42566176.0000; val_optim_loss: 42566176.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8870; val_auprc_score: 0.9771; val_best_acc_score: 0.8561; val_best_f1_score: 0.9225; train_kl_reg_loss: 844329.4911; train_edge_recon_loss: 1191497.6607; train_gene_expr_recon_loss: 40441818.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42477645.7143; train_optim_loss: 42477645.7143; val_kl_reg_loss: 807108.3125; val_edge_recon_loss: 1169915.2500; val_gene_expr_recon_loss: 40350552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42327576.0000; val_optim_loss: 42327576.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8839; val_auprc_score: 0.9778; val_best_acc_score: 0.8605; val_best_f1_score: 0.9250; train_kl_reg_loss: 822879.8214; train_edge_recon_loss: 1191906.8750; train_gene_expr_recon_loss: 40255223.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42270010.2857; train_optim_loss: 42270010.2857; val_kl_reg_loss: 785758.8750; val_edge_recon_loss: 1134561.1250; val_gene_expr_recon_loss: 40178596.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42098916.0000; val_optim_loss: 42098916.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8816; val_auprc_score: 0.9755; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 802502.5982; train_edge_recon_loss: 1192704.4464; train_gene_expr_recon_loss: 40112442.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42107650.2857; train_optim_loss: 42107650.2857; val_kl_reg_loss: 765097.7500; val_edge_recon_loss: 1212637.7500; val_gene_expr_recon_loss: 40042588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42020324.0000; val_optim_loss: 42020324.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8793; val_auprc_score: 0.9766; val_best_acc_score: 0.8577; val_best_f1_score: 0.9234; train_kl_reg_loss: 782252.9107; train_edge_recon_loss: 1204602.3214; train_gene_expr_recon_loss: 39987947.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41974802.2857; train_optim_loss: 41974802.2857; val_kl_reg_loss: 746801.7500; val_edge_recon_loss: 1157166.2500; val_gene_expr_recon_loss: 39933280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41837248.0000; val_optim_loss: 41837248.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8831; val_auprc_score: 0.9758; val_best_acc_score: 0.8504; val_best_f1_score: 0.9192; train_kl_reg_loss: 762460.0089; train_edge_recon_loss: 1180871.0536; train_gene_expr_recon_loss: 39881852.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41825183.4286; train_optim_loss: 41825183.4286; val_kl_reg_loss: 728517.1250; val_edge_recon_loss: 1216479.5000; val_gene_expr_recon_loss: 39831904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41776900.0000; val_optim_loss: 41776900.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8713; val_auprc_score: 0.9722; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 743556.0357; train_edge_recon_loss: 1188078.3393; train_gene_expr_recon_loss: 39789161.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41720795.4286; train_optim_loss: 41720795.4286; val_kl_reg_loss: 710667.5000; val_edge_recon_loss: 1205842.7500; val_gene_expr_recon_loss: 39745704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41662216.0000; val_optim_loss: 41662216.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8778; val_auprc_score: 0.9735; val_best_acc_score: 0.8436; val_best_f1_score: 0.9152; train_kl_reg_loss: 725556.4732; train_edge_recon_loss: 1201807.0000; train_gene_expr_recon_loss: 39697122.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41624485.1429; train_optim_loss: 41624485.1429; val_kl_reg_loss: 692035.1250; val_edge_recon_loss: 1271922.1250; val_gene_expr_recon_loss: 39663208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41627164.0000; val_optim_loss: 41627164.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8661; val_auprc_score: 0.9708; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 707392.5446; train_edge_recon_loss: 1188408.2143; train_gene_expr_recon_loss: 39624136.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41519936.5714; train_optim_loss: 41519936.5714; val_kl_reg_loss: 675472.8125; val_edge_recon_loss: 1218376.0000; val_gene_expr_recon_loss: 39594740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41488588.0000; val_optim_loss: 41488588.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8730; val_auprc_score: 0.9740; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 690180.6518; train_edge_recon_loss: 1185148.4643; train_gene_expr_recon_loss: 39550605.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41425934.8571; train_optim_loss: 41425934.8571; val_kl_reg_loss: 660187.8750; val_edge_recon_loss: 1191287.2500; val_gene_expr_recon_loss: 39529856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41381332.0000; val_optim_loss: 41381332.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8603; val_auprc_score: 0.9715; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 673804.9821; train_edge_recon_loss: 1193782.8750; train_gene_expr_recon_loss: 39491742.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41359329.7143; train_optim_loss: 41359329.7143; val_kl_reg_loss: 643582.1250; val_edge_recon_loss: 1178627.7500; val_gene_expr_recon_loss: 39461908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41284116.0000; val_optim_loss: 41284116.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8675; val_auprc_score: 0.9712; val_best_acc_score: 0.8464; val_best_f1_score: 0.9168; train_kl_reg_loss: 657154.8393; train_edge_recon_loss: 1187891.6964; train_gene_expr_recon_loss: 39430994.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41276041.1429; train_optim_loss: 41276041.1429; val_kl_reg_loss: 628762.7500; val_edge_recon_loss: 1249013.7500; val_gene_expr_recon_loss: 39411816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41289592.0000; val_optim_loss: 41289592.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8686; val_auprc_score: 0.9732; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 641662.0268; train_edge_recon_loss: 1192173.3750; train_gene_expr_recon_loss: 39370941.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41204776.0000; train_optim_loss: 41204776.0000; val_kl_reg_loss: 614283.2500; val_edge_recon_loss: 1199980.1250; val_gene_expr_recon_loss: 39351148.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41165412.0000; val_optim_loss: 41165412.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8625; val_auprc_score: 0.9714; val_best_acc_score: 0.8559; val_best_f1_score: 0.9223; train_kl_reg_loss: 626889.5804; train_edge_recon_loss: 1197743.1429; train_gene_expr_recon_loss: 39308271.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41132904.0000; train_optim_loss: 41132904.0000; val_kl_reg_loss: 599793.7500; val_edge_recon_loss: 1176618.6250; val_gene_expr_recon_loss: 39303684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41080096.0000; val_optim_loss: 41080096.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8648; val_auprc_score: 0.9714; val_best_acc_score: 0.8536; val_best_f1_score: 0.9208; train_kl_reg_loss: 611642.3929; train_edge_recon_loss: 1213375.1964; train_gene_expr_recon_loss: 39264724.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41089742.2857; train_optim_loss: 41089742.2857; val_kl_reg_loss: 585070.2500; val_edge_recon_loss: 1207640.2500; val_gene_expr_recon_loss: 39239096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41031808.0000; val_optim_loss: 41031808.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8616; val_auprc_score: 0.9716; val_best_acc_score: 0.8549; val_best_f1_score: 0.9217; train_kl_reg_loss: 597613.7232; train_edge_recon_loss: 1210775.4107; train_gene_expr_recon_loss: 39215217.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41023606.8571; train_optim_loss: 41023606.8571; val_kl_reg_loss: 571275.2500; val_edge_recon_loss: 1193106.7500; val_gene_expr_recon_loss: 39193528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40957912.0000; val_optim_loss: 40957912.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8668; val_auprc_score: 0.9713; val_best_acc_score: 0.8484; val_best_f1_score: 0.9176; train_kl_reg_loss: 583927.7589; train_edge_recon_loss: 1212690.7500; train_gene_expr_recon_loss: 39159065.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40955684.0000; train_optim_loss: 40955684.0000; val_kl_reg_loss: 558728.8750; val_edge_recon_loss: 1263181.6250; val_gene_expr_recon_loss: 39143364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40965276.0000; val_optim_loss: 40965276.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8582; val_auprc_score: 0.9692; val_best_acc_score: 0.8533; val_best_f1_score: 0.9205; train_kl_reg_loss: 570481.4018; train_edge_recon_loss: 1214090.7500; train_gene_expr_recon_loss: 39109611.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40894182.8571; train_optim_loss: 40894182.8571; val_kl_reg_loss: 546518.7500; val_edge_recon_loss: 1227798.0000; val_gene_expr_recon_loss: 39094640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40868956.0000; val_optim_loss: 40868956.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8521; val_auprc_score: 0.9681; val_best_acc_score: 0.8579; val_best_f1_score: 0.9231; train_kl_reg_loss: 557571.1696; train_edge_recon_loss: 1198643.4286; train_gene_expr_recon_loss: 39058256.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40814470.8571; train_optim_loss: 40814470.8571; val_kl_reg_loss: 533747.3125; val_edge_recon_loss: 1193969.6250; val_gene_expr_recon_loss: 39053048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40780764.0000; val_optim_loss: 40780764.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8511; val_auprc_score: 0.9691; val_best_acc_score: 0.8608; val_best_f1_score: 0.9247; train_kl_reg_loss: 544760.4554; train_edge_recon_loss: 1193113.8571; train_gene_expr_recon_loss: 38975386.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40713260.5714; train_optim_loss: 40713260.5714; val_kl_reg_loss: 520158.6875; val_edge_recon_loss: 1179342.6250; val_gene_expr_recon_loss: 38636048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40335548.0000; val_optim_loss: 40335548.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8587; val_auprc_score: 0.9685; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 552501745568.6250; train_edge_recon_loss: 1138075.7857; train_gene_expr_recon_loss: 845505121.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 553348368130.8572; train_optim_loss: 553348368130.8572; val_kl_reg_loss: 65767563264.0000; val_edge_recon_loss: 1228996.1250; val_gene_expr_recon_loss: 526427776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66295218176.0000; val_optim_loss: 66295218176.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8586; val_auprc_score: 0.9650; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 9491779900448.1074; train_edge_recon_loss: 1173317.0179; train_gene_expr_recon_loss: 1076078541.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 9492857424484.5723; train_optim_loss: 9492857424484.5723; val_kl_reg_loss: 3239740.7500; val_edge_recon_loss: 1204950.3750; val_gene_expr_recon_loss: 643466880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 647911552.0000; val_optim_loss: 647911552.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8338; val_auprc_score: 0.9528; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 284531927152.8571; train_edge_recon_loss: 1170657.1786; train_gene_expr_recon_loss: 828483776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 285361591158.8571; train_optim_loss: 285361591158.8571; val_kl_reg_loss: 3056677376.0000; val_edge_recon_loss: 1207855.3750; val_gene_expr_recon_loss: 757373696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3815258880.0000; val_optim_loss: 3815258880.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8133; val_auprc_score: 0.9439; val_best_acc_score: 0.8501; val_best_f1_score: 0.9190; train_kl_reg_loss: 1258942467.4286; train_edge_recon_loss: 1150398.3393; train_gene_expr_recon_loss: 1091315218.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2351408109.7143; train_optim_loss: 2351408109.7143; val_kl_reg_loss: 231210254336.0000; val_edge_recon_loss: 1219437.2500; val_gene_expr_recon_loss: 755141888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 231966605312.0000; val_optim_loss: 231966605312.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8072; val_auprc_score: 0.9420; val_best_acc_score: 0.8503; val_best_f1_score: 0.9191; train_kl_reg_loss: 53449490264.5714; train_edge_recon_loss: 1118051.2857; train_gene_expr_recon_loss: 779242020.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54229851492.5714; train_optim_loss: 54229851492.5714; val_kl_reg_loss: 11059000.0000; val_edge_recon_loss: 1217509.8750; val_gene_expr_recon_loss: 733198464.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 745474944.0000; val_optim_loss: 745474944.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8200; val_auprc_score: 0.9471; val_best_acc_score: 0.8523; val_best_f1_score: 0.9203; train_kl_reg_loss: 10957650.4286; train_edge_recon_loss: 1196753.9464; train_gene_expr_recon_loss: 727603309.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 739757714.2857; train_optim_loss: 739757714.2857; val_kl_reg_loss: 10475300.0000; val_edge_recon_loss: 1201084.5000; val_gene_expr_recon_loss: 717014976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 728691328.0000; val_optim_loss: 728691328.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8193; val_auprc_score: 0.9472; val_best_acc_score: 0.8531; val_best_f1_score: 0.9208; train_kl_reg_loss: 10802475.0000; train_edge_recon_loss: 1199732.5893; train_gene_expr_recon_loss: 712951140.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 724953353.1429; train_optim_loss: 724953353.1429; val_kl_reg_loss: 10421201.0000; val_edge_recon_loss: 1194298.3750; val_gene_expr_recon_loss: 706627712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 718243200.0000; val_optim_loss: 718243200.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8058; val_auprc_score: 0.9419; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 10731977.2857; train_edge_recon_loss: 1203352.4643; train_gene_expr_recon_loss: 703391570.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 715326893.7143; train_optim_loss: 715326893.7143; val_kl_reg_loss: 10353690.0000; val_edge_recon_loss: 1209789.6250; val_gene_expr_recon_loss: 698617216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 710180672.0000; val_optim_loss: 710180672.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 32 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.8662
val AUPRC score: 0.9726
val best accuracy score: 0.8572
val best F1 score: 0.9226
val target rna MSE score: 22.3082
val source rna MSE score: 17.7567
Val cat covariate0 mean sim diff: 0.0000
Duration of model training in run 1: 0 hours, 5 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
