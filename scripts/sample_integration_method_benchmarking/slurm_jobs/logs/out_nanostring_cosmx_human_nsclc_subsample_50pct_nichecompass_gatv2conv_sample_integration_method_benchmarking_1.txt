Run timestamp: 26082023_181316_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '12', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '5', '--run_index', '6', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_50pct', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 127072
Number of validation nodes: 14119
Number of training edges: 863288
Number of validation edges: 95920
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9391; val_auprc_score: 0.9730; val_best_acc_score: 0.9172; val_best_f1_score: 0.9466; train_kl_reg_loss: 25677.8715; train_edge_recon_loss: 1409656.0035; train_gene_expr_recon_loss: 3047126.9877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4482460.8594; train_optim_loss: 4482460.8594; val_kl_reg_loss: 18652.4548; val_edge_recon_loss: 1359282.3032; val_gene_expr_recon_loss: 2744115.5293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4122050.2872; val_optim_loss: 4122050.2872
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9644; val_auprc_score: 0.9844; val_best_acc_score: 0.9379; val_best_f1_score: 0.9594; train_kl_reg_loss: 17309.0364; train_edge_recon_loss: 1334800.7666; train_gene_expr_recon_loss: 2571684.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3923794.0840; train_optim_loss: 3923794.0840; val_kl_reg_loss: 18022.4104; val_edge_recon_loss: 1336220.4182; val_gene_expr_recon_loss: 2431511.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3785754.6729; val_optim_loss: 3785754.6729
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9675; val_auprc_score: 0.9859; val_best_acc_score: 0.9395; val_best_f1_score: 0.9604; train_kl_reg_loss: 18489.1290; train_edge_recon_loss: 1326988.7874; train_gene_expr_recon_loss: 2348721.2869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3694199.2094; train_optim_loss: 3694199.2094; val_kl_reg_loss: 19266.3879; val_edge_recon_loss: 1339211.4860; val_gene_expr_recon_loss: 2281131.9262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3639609.8045; val_optim_loss: 3639609.8045
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9704; val_auprc_score: 0.9874; val_best_acc_score: 0.9425; val_best_f1_score: 0.9624; train_kl_reg_loss: 19780.6284; train_edge_recon_loss: 1323945.7559; train_gene_expr_recon_loss: 2242713.0098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3586439.3932; train_optim_loss: 3586439.3932; val_kl_reg_loss: 20028.1144; val_edge_recon_loss: 1334186.3863; val_gene_expr_recon_loss: 2212770.2068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3566984.6995; val_optim_loss: 3566984.6995
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9742; val_auprc_score: 0.9888; val_best_acc_score: 0.9460; val_best_f1_score: 0.9646; train_kl_reg_loss: 20592.7712; train_edge_recon_loss: 1324209.5969; train_gene_expr_recon_loss: 2185847.6299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3530649.9941; train_optim_loss: 3530649.9941; val_kl_reg_loss: 20571.3385; val_edge_recon_loss: 1339254.7586; val_gene_expr_recon_loss: 2168817.0053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3528643.1130; val_optim_loss: 3528643.1130
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9737; val_auprc_score: 0.9885; val_best_acc_score: 0.9460; val_best_f1_score: 0.9645; train_kl_reg_loss: 21009.7334; train_edge_recon_loss: 1321594.0322; train_gene_expr_recon_loss: 2156294.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3498898.5236; train_optim_loss: 3498898.5236; val_kl_reg_loss: 22208.7324; val_edge_recon_loss: 1340639.3610; val_gene_expr_recon_loss: 2153870.1237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3516718.2221; val_optim_loss: 3516718.2221
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9740; val_auprc_score: 0.9887; val_best_acc_score: 0.9486; val_best_f1_score: 0.9662; train_kl_reg_loss: 21569.9602; train_edge_recon_loss: 1323451.2934; train_gene_expr_recon_loss: 2133600.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3478621.5637; train_optim_loss: 3478621.5637; val_kl_reg_loss: 21680.9214; val_edge_recon_loss: 1340863.3225; val_gene_expr_recon_loss: 2134512.2693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3497056.5186; val_optim_loss: 3497056.5186
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9767; val_auprc_score: 0.9901; val_best_acc_score: 0.9499; val_best_f1_score: 0.9672; train_kl_reg_loss: 22202.7284; train_edge_recon_loss: 1324411.1941; train_gene_expr_recon_loss: 2121908.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3468522.6924; train_optim_loss: 3468522.6924; val_kl_reg_loss: 22015.8148; val_edge_recon_loss: 1327004.8557; val_gene_expr_recon_loss: 2120351.8896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3469372.5572; val_optim_loss: 3469372.5572
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9762; val_auprc_score: 0.9901; val_best_acc_score: 0.9501; val_best_f1_score: 0.9673; train_kl_reg_loss: 22334.5279; train_edge_recon_loss: 1319136.2536; train_gene_expr_recon_loss: 2112428.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3453899.7750; train_optim_loss: 3453899.7750; val_kl_reg_loss: 22914.7692; val_edge_recon_loss: 1338215.7254; val_gene_expr_recon_loss: 2138906.6941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3500037.1902; val_optim_loss: 3500037.1902
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9776; val_auprc_score: 0.9903; val_best_acc_score: 0.9515; val_best_f1_score: 0.9681; train_kl_reg_loss: 22781.7063; train_edge_recon_loss: 1322179.8817; train_gene_expr_recon_loss: 2102119.6891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3447081.2755; train_optim_loss: 3447081.2755; val_kl_reg_loss: 22864.5621; val_edge_recon_loss: 1337564.8491; val_gene_expr_recon_loss: 2115799.1476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3476228.5585; val_optim_loss: 3476228.5585
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9793; val_auprc_score: 0.9914; val_best_acc_score: 0.9494; val_best_f1_score: 0.9668; train_kl_reg_loss: 23041.7565; train_edge_recon_loss: 1324575.9676; train_gene_expr_recon_loss: 2095338.9255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3442956.6498; train_optim_loss: 3442956.6498; val_kl_reg_loss: 22756.5110; val_edge_recon_loss: 1330692.7566; val_gene_expr_recon_loss: 2099439.4973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3452888.7660; val_optim_loss: 3452888.7660
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9809; val_auprc_score: 0.9921; val_best_acc_score: 0.9549; val_best_f1_score: 0.9704; train_kl_reg_loss: 23217.6427; train_edge_recon_loss: 1317474.1318; train_gene_expr_recon_loss: 2094291.8843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3434983.6546; train_optim_loss: 3434983.6546; val_kl_reg_loss: 23057.2292; val_edge_recon_loss: 1327035.0898; val_gene_expr_recon_loss: 2097350.5997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3447442.9162; val_optim_loss: 3447442.9162
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9811; val_auprc_score: 0.9922; val_best_acc_score: 0.9532; val_best_f1_score: 0.9691; train_kl_reg_loss: 23773.9345; train_edge_recon_loss: 1323283.4415; train_gene_expr_recon_loss: 2087790.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3434847.7888; train_optim_loss: 3434847.7888; val_kl_reg_loss: 23796.0305; val_edge_recon_loss: 1339050.1549; val_gene_expr_recon_loss: 2098527.0186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3461373.2008; val_optim_loss: 3461373.2008
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9798; val_auprc_score: 0.9914; val_best_acc_score: 0.9541; val_best_f1_score: 0.9698; train_kl_reg_loss: 24027.7166; train_edge_recon_loss: 1321661.3227; train_gene_expr_recon_loss: 2083936.4597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3429625.5000; train_optim_loss: 3429625.5000; val_kl_reg_loss: 24112.3322; val_edge_recon_loss: 1336910.1496; val_gene_expr_recon_loss: 2098443.8517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3459466.3391; val_optim_loss: 3459466.3391
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9801; val_auprc_score: 0.9916; val_best_acc_score: 0.9537; val_best_f1_score: 0.9696; train_kl_reg_loss: 24027.2514; train_edge_recon_loss: 1318470.5847; train_gene_expr_recon_loss: 2073780.0777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3416277.9124; train_optim_loss: 3416277.9124; val_kl_reg_loss: 25256.4225; val_edge_recon_loss: 1321368.7886; val_gene_expr_recon_loss: 2096635.6210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3443260.8391; val_optim_loss: 3443260.8391
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9806; val_auprc_score: 0.9919; val_best_acc_score: 0.9532; val_best_f1_score: 0.9693; train_kl_reg_loss: 24484.8063; train_edge_recon_loss: 1317837.0529; train_gene_expr_recon_loss: 2072713.1278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3415034.9844; train_optim_loss: 3415034.9844; val_kl_reg_loss: 24735.7138; val_edge_recon_loss: 1338020.7906; val_gene_expr_recon_loss: 2084950.5452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3447707.0479; val_optim_loss: 3447707.0479
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9817; val_auprc_score: 0.9923; val_best_acc_score: 0.9560; val_best_f1_score: 0.9711; train_kl_reg_loss: 24596.5998; train_edge_recon_loss: 1323446.9442; train_gene_expr_recon_loss: 2072644.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3420688.2045; train_optim_loss: 3420688.2045; val_kl_reg_loss: 24560.8854; val_edge_recon_loss: 1329559.7560; val_gene_expr_recon_loss: 2084228.9907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3438349.6316; val_optim_loss: 3438349.6316
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9816; val_auprc_score: 0.9924; val_best_acc_score: 0.9538; val_best_f1_score: 0.9696; train_kl_reg_loss: 24657.4780; train_edge_recon_loss: 1322534.8778; train_gene_expr_recon_loss: 2059238.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3406431.2211; train_optim_loss: 3406431.2211; val_kl_reg_loss: 25182.4275; val_edge_recon_loss: 1332634.2487; val_gene_expr_recon_loss: 2220369.9914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3578186.6609; val_optim_loss: 3578186.6609
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9828; val_auprc_score: 0.9924; val_best_acc_score: 0.9599; val_best_f1_score: 0.9736; train_kl_reg_loss: 25242.7243; train_edge_recon_loss: 1320910.3112; train_gene_expr_recon_loss: 2075828.8786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3421981.9183; train_optim_loss: 3421981.9183; val_kl_reg_loss: 25497.9478; val_edge_recon_loss: 1329059.2566; val_gene_expr_recon_loss: 2085706.2041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3440263.4016; val_optim_loss: 3440263.4016
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9816; val_auprc_score: 0.9923; val_best_acc_score: 0.9559; val_best_f1_score: 0.9709; train_kl_reg_loss: 25345.6790; train_edge_recon_loss: 1320924.0146; train_gene_expr_recon_loss: 2063546.4655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3409816.1599; train_optim_loss: 3409816.1599; val_kl_reg_loss: 26424.8465; val_edge_recon_loss: 1334395.1084; val_gene_expr_recon_loss: 2083113.8398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3443933.7926; val_optim_loss: 3443933.7926
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9826; val_auprc_score: 0.9927; val_best_acc_score: 0.9580; val_best_f1_score: 0.9723; train_kl_reg_loss: 25815.9707; train_edge_recon_loss: 1317950.1432; train_gene_expr_recon_loss: 2056670.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3400437.0953; train_optim_loss: 3400437.0953; val_kl_reg_loss: 25926.3903; val_edge_recon_loss: 1338765.1629; val_gene_expr_recon_loss: 2082779.7693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3447471.3324; val_optim_loss: 3447471.3324

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9851; val_auprc_score: 0.9939; val_best_acc_score: 0.9598; val_best_f1_score: 0.9735; train_kl_reg_loss: 24425.4973; train_edge_recon_loss: 1314694.3790; train_gene_expr_recon_loss: 2016987.5931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3356107.4707; train_optim_loss: 3356107.4707; val_kl_reg_loss: 24507.6132; val_edge_recon_loss: 1323879.1762; val_gene_expr_recon_loss: 2042974.8916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3391361.6888; val_optim_loss: 3391361.6888
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9848; val_auprc_score: 0.9938; val_best_acc_score: 0.9590; val_best_f1_score: 0.9730; train_kl_reg_loss: 24308.0859; train_edge_recon_loss: 1316306.8238; train_gene_expr_recon_loss: 2008376.7244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3348991.6343; train_optim_loss: 3348991.6343; val_kl_reg_loss: 24326.0016; val_edge_recon_loss: 1332118.2174; val_gene_expr_recon_loss: 2038598.2354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3395042.4641; val_optim_loss: 3395042.4641
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9846; val_auprc_score: 0.9938; val_best_acc_score: 0.9585; val_best_f1_score: 0.9726; train_kl_reg_loss: 24197.6178; train_edge_recon_loss: 1316484.9703; train_gene_expr_recon_loss: 2005146.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345829.2848; train_optim_loss: 3345829.2848; val_kl_reg_loss: 24162.9458; val_edge_recon_loss: 1332031.4129; val_gene_expr_recon_loss: 2039215.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3395409.8271; val_optim_loss: 3395409.8271
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9861; val_auprc_score: 0.9941; val_best_acc_score: 0.9616; val_best_f1_score: 0.9747; train_kl_reg_loss: 24041.4120; train_edge_recon_loss: 1315955.7324; train_gene_expr_recon_loss: 2002664.8408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3342661.9850; train_optim_loss: 3342661.9850; val_kl_reg_loss: 23929.3221; val_edge_recon_loss: 1326207.2985; val_gene_expr_recon_loss: 2035264.0426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3385400.6649; val_optim_loss: 3385400.6649
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9853; val_auprc_score: 0.9938; val_best_acc_score: 0.9617; val_best_f1_score: 0.9747; train_kl_reg_loss: 23977.5417; train_edge_recon_loss: 1316914.5825; train_gene_expr_recon_loss: 2001267.1508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3342159.2742; train_optim_loss: 3342159.2742; val_kl_reg_loss: 23995.3693; val_edge_recon_loss: 1319959.2467; val_gene_expr_recon_loss: 2030935.3517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3374889.9707; val_optim_loss: 3374889.9707
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9845; val_auprc_score: 0.9935; val_best_acc_score: 0.9594; val_best_f1_score: 0.9732; train_kl_reg_loss: 23839.9944; train_edge_recon_loss: 1314702.8952; train_gene_expr_recon_loss: 1999441.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3337984.2106; train_optim_loss: 3337984.2106; val_kl_reg_loss: 23711.5416; val_edge_recon_loss: 1331758.9794; val_gene_expr_recon_loss: 2034124.6031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3389595.1250; val_optim_loss: 3389595.1250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9840; val_auprc_score: 0.9932; val_best_acc_score: 0.9604; val_best_f1_score: 0.9740; train_kl_reg_loss: 23694.6534; train_edge_recon_loss: 1316664.0422; train_gene_expr_recon_loss: 1998781.3861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339140.0833; train_optim_loss: 3339140.0833; val_kl_reg_loss: 23592.4360; val_edge_recon_loss: 1326782.2580; val_gene_expr_recon_loss: 2029428.7420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3379803.4495; val_optim_loss: 3379803.4495
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9851; val_auprc_score: 0.9935; val_best_acc_score: 0.9619; val_best_f1_score: 0.9748; train_kl_reg_loss: 23595.3864; train_edge_recon_loss: 1316344.1041; train_gene_expr_recon_loss: 1997313.6025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3337253.0917; train_optim_loss: 3337253.0917; val_kl_reg_loss: 23397.1116; val_edge_recon_loss: 1323382.0120; val_gene_expr_recon_loss: 2028800.0279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375579.1543; val_optim_loss: 3375579.1543
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9857; val_auprc_score: 0.9941; val_best_acc_score: 0.9611; val_best_f1_score: 0.9744; train_kl_reg_loss: 23479.2271; train_edge_recon_loss: 1314324.5092; train_gene_expr_recon_loss: 1994354.8676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3332158.6063; train_optim_loss: 3332158.6063; val_kl_reg_loss: 23486.8844; val_edge_recon_loss: 1313844.8551; val_gene_expr_recon_loss: 2029497.4275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366829.1636; val_optim_loss: 3366829.1636
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9854; val_auprc_score: 0.9940; val_best_acc_score: 0.9611; val_best_f1_score: 0.9744; train_kl_reg_loss: 23466.2772; train_edge_recon_loss: 1316422.9378; train_gene_expr_recon_loss: 1995551.2253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3335440.4403; train_optim_loss: 3335440.4403; val_kl_reg_loss: 23517.1763; val_edge_recon_loss: 1322700.0798; val_gene_expr_recon_loss: 2029685.0047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375902.2566; val_optim_loss: 3375902.2566
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9854; val_auprc_score: 0.9941; val_best_acc_score: 0.9602; val_best_f1_score: 0.9738; train_kl_reg_loss: 23394.0008; train_edge_recon_loss: 1313031.9987; train_gene_expr_recon_loss: 1993493.0661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329919.0652; train_optim_loss: 3329919.0652; val_kl_reg_loss: 23414.1041; val_edge_recon_loss: 1318443.2387; val_gene_expr_recon_loss: 2026692.1283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368549.4681; val_optim_loss: 3368549.4681
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9857; val_auprc_score: 0.9941; val_best_acc_score: 0.9626; val_best_f1_score: 0.9753; train_kl_reg_loss: 23279.7532; train_edge_recon_loss: 1312538.2888; train_gene_expr_recon_loss: 1992818.1487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3328636.1921; train_optim_loss: 3328636.1921; val_kl_reg_loss: 23357.6370; val_edge_recon_loss: 1328645.0824; val_gene_expr_recon_loss: 2031258.6868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3383261.4109; val_optim_loss: 3383261.4109
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9852; val_auprc_score: 0.9939; val_best_acc_score: 0.9608; val_best_f1_score: 0.9742; train_kl_reg_loss: 23117.7501; train_edge_recon_loss: 1312372.2958; train_gene_expr_recon_loss: 1991772.7272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3327262.7707; train_optim_loss: 3327262.7707; val_kl_reg_loss: 23212.1734; val_edge_recon_loss: 1320938.3398; val_gene_expr_recon_loss: 2030262.1124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3374412.6210; val_optim_loss: 3374412.6210

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9865; val_auprc_score: 0.9944; val_best_acc_score: 0.9617; val_best_f1_score: 0.9747; train_kl_reg_loss: 22930.2309; train_edge_recon_loss: 1314575.9119; train_gene_expr_recon_loss: 1985815.3032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3323321.4447; train_optim_loss: 3323321.4447; val_kl_reg_loss: 22942.1068; val_edge_recon_loss: 1322516.0738; val_gene_expr_recon_loss: 2022260.9774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367719.1436; val_optim_loss: 3367719.1436
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9856; val_auprc_score: 0.9939; val_best_acc_score: 0.9615; val_best_f1_score: 0.9746; train_kl_reg_loss: 22871.6520; train_edge_recon_loss: 1315618.0070; train_gene_expr_recon_loss: 1986071.8872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3324561.5461; train_optim_loss: 3324561.5461; val_kl_reg_loss: 22904.6982; val_edge_recon_loss: 1324026.8484; val_gene_expr_recon_loss: 2023368.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3370299.7327; val_optim_loss: 3370299.7327
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9854; val_auprc_score: 0.9939; val_best_acc_score: 0.9619; val_best_f1_score: 0.9749; train_kl_reg_loss: 22910.5422; train_edge_recon_loss: 1314610.6915; train_gene_expr_recon_loss: 1985765.6092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3323286.8440; train_optim_loss: 3323286.8440; val_kl_reg_loss: 22920.5884; val_edge_recon_loss: 1323655.2241; val_gene_expr_recon_loss: 2025102.9102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3371678.7207; val_optim_loss: 3371678.7207
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9856; val_auprc_score: 0.9939; val_best_acc_score: 0.9618; val_best_f1_score: 0.9748; train_kl_reg_loss: 22899.1962; train_edge_recon_loss: 1316379.5133; train_gene_expr_recon_loss: 1985715.9904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3324994.6980; train_optim_loss: 3324994.6980; val_kl_reg_loss: 22881.1370; val_edge_recon_loss: 1323732.5406; val_gene_expr_recon_loss: 2022208.8145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368822.5093; val_optim_loss: 3368822.5093

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 639 min 3 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9857
val AUPRC score: 0.9941
val best accuracy score: 0.9611
val best F1 score: 0.9744
val target rna MSE score: 0.8637
val source rna MSE score: 0.0852
Val cat covariate0 mean sim diff: -0.0000
Duration of model training in run 6: 10 hours, 42 minutes and 2 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
