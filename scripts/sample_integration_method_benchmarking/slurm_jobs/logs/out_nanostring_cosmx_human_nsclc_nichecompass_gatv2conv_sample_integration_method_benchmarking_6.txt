Run timestamp: 28082023_201738_6.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '10000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 1162586
Number of validation edges: 129176
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9892; val_auprc_score: 0.9963; val_best_acc_score: 0.9611; val_best_f1_score: 0.9750; train_kl_reg_loss: 16593.1517; train_edge_recon_loss: 1367784.1318; train_cat_covariates_contrastive_loss: 7326.4650; train_gene_expr_recon_loss: 2750473.9147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4142177.6619; train_optim_loss: 4142177.6619; val_kl_reg_loss: 14611.0624; val_edge_recon_loss: 1343217.5128; val_cat_covariates_contrastive_loss: 7465.8355; val_gene_expr_recon_loss: 2447760.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3813054.8399; val_optim_loss: 3813054.8399
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9928; val_auprc_score: 0.9973; val_best_acc_score: 0.9728; val_best_f1_score: 0.9824; train_kl_reg_loss: 16049.6855; train_edge_recon_loss: 1319496.1356; train_cat_covariates_contrastive_loss: 7573.7674; train_gene_expr_recon_loss: 2277326.7944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3620446.3849; train_optim_loss: 3620446.3849; val_kl_reg_loss: 17603.7493; val_edge_recon_loss: 1336078.5440; val_cat_covariates_contrastive_loss: 7675.6702; val_gene_expr_recon_loss: 2167157.7144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3528515.6887; val_optim_loss: 3528515.6887
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9934; val_auprc_score: 0.9976; val_best_acc_score: 0.9743; val_best_f1_score: 0.9834; train_kl_reg_loss: 18509.8126; train_edge_recon_loss: 1317566.1508; train_cat_covariates_contrastive_loss: 7659.3798; train_gene_expr_recon_loss: 2103724.2655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3447459.6092; train_optim_loss: 3447459.6092; val_kl_reg_loss: 19507.6047; val_edge_recon_loss: 1329237.4965; val_cat_covariates_contrastive_loss: 7722.1912; val_gene_expr_recon_loss: 2063692.8829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3420160.1719; val_optim_loss: 3420160.1719
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9943; val_auprc_score: 0.9979; val_best_acc_score: 0.9776; val_best_f1_score: 0.9856; train_kl_reg_loss: 19667.7535; train_edge_recon_loss: 1316358.0374; train_cat_covariates_contrastive_loss: 7724.1091; train_gene_expr_recon_loss: 2036982.9373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3380732.8362; train_optim_loss: 3380732.8362; val_kl_reg_loss: 20098.7449; val_edge_recon_loss: 1324579.5697; val_cat_covariates_contrastive_loss: 7812.1584; val_gene_expr_recon_loss: 2024439.9056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3376930.3824; val_optim_loss: 3376930.3824
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9936; val_auprc_score: 0.9975; val_best_acc_score: 0.9777; val_best_f1_score: 0.9856; train_kl_reg_loss: 20445.8251; train_edge_recon_loss: 1315908.7670; train_cat_covariates_contrastive_loss: 7767.4000; train_gene_expr_recon_loss: 2005276.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3349398.0111; train_optim_loss: 3349398.0111; val_kl_reg_loss: 21137.5653; val_edge_recon_loss: 1332807.8340; val_cat_covariates_contrastive_loss: 7780.6196; val_gene_expr_recon_loss: 2001562.4027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3363288.4130; val_optim_loss: 3363288.4130
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9939; val_auprc_score: 0.9977; val_best_acc_score: 0.9780; val_best_f1_score: 0.9858; train_kl_reg_loss: 21062.3903; train_edge_recon_loss: 1313531.5603; train_cat_covariates_contrastive_loss: 7791.8497; train_gene_expr_recon_loss: 1984790.0518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3327175.8520; train_optim_loss: 3327175.8520; val_kl_reg_loss: 21370.3671; val_edge_recon_loss: 1325303.6759; val_cat_covariates_contrastive_loss: 7757.0012; val_gene_expr_recon_loss: 1980499.6976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3334930.7372; val_optim_loss: 3334930.7372
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9942; val_auprc_score: 0.9978; val_best_acc_score: 0.9785; val_best_f1_score: 0.9861; train_kl_reg_loss: 21527.5916; train_edge_recon_loss: 1313150.7103; train_cat_covariates_contrastive_loss: 7804.4670; train_gene_expr_recon_loss: 1972386.2223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3314868.9886; train_optim_loss: 3314868.9886; val_kl_reg_loss: 22186.8928; val_edge_recon_loss: 1335528.4086; val_cat_covariates_contrastive_loss: 7779.2333; val_gene_expr_recon_loss: 1968728.5158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3334223.0543; val_optim_loss: 3334223.0543
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9944; val_auprc_score: 0.9977; val_best_acc_score: 0.9801; val_best_f1_score: 0.9872; train_kl_reg_loss: 21919.4247; train_edge_recon_loss: 1315001.8546; train_cat_covariates_contrastive_loss: 7831.2008; train_gene_expr_recon_loss: 1960285.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3305037.6128; train_optim_loss: 3305037.6128; val_kl_reg_loss: 22015.0698; val_edge_recon_loss: 1325100.5672; val_cat_covariates_contrastive_loss: 7885.4877; val_gene_expr_recon_loss: 1963707.3706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318708.4911; val_optim_loss: 3318708.4911
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9947; val_auprc_score: 0.9980; val_best_acc_score: 0.9809; val_best_f1_score: 0.9876; train_kl_reg_loss: 22282.5388; train_edge_recon_loss: 1314824.3573; train_cat_covariates_contrastive_loss: 7850.1517; train_gene_expr_recon_loss: 1952809.9874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3297767.0365; train_optim_loss: 3297767.0365; val_kl_reg_loss: 22716.5552; val_edge_recon_loss: 1330050.5746; val_cat_covariates_contrastive_loss: 7882.5554; val_gene_expr_recon_loss: 1957368.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318018.1097; val_optim_loss: 3318018.1097
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9949; val_auprc_score: 0.9981; val_best_acc_score: 0.9811; val_best_f1_score: 0.9878; train_kl_reg_loss: 22794.7865; train_edge_recon_loss: 1314739.6514; train_cat_covariates_contrastive_loss: 7852.3743; train_gene_expr_recon_loss: 1943887.8742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3289274.6864; train_optim_loss: 3289274.6864; val_kl_reg_loss: 22733.0210; val_edge_recon_loss: 1330634.2737; val_cat_covariates_contrastive_loss: 7891.8869; val_gene_expr_recon_loss: 1952417.9990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3313677.1828; val_optim_loss: 3313677.1828
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9946; val_auprc_score: 0.9978; val_best_acc_score: 0.9818; val_best_f1_score: 0.9882; train_kl_reg_loss: 23168.6364; train_edge_recon_loss: 1314576.2245; train_cat_covariates_contrastive_loss: 7882.0686; train_gene_expr_recon_loss: 1937897.6467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3283524.5766; train_optim_loss: 3283524.5766; val_kl_reg_loss: 23897.4196; val_edge_recon_loss: 1335876.2777; val_cat_covariates_contrastive_loss: 7915.9905; val_gene_expr_recon_loss: 1942849.2564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3310538.9457; val_optim_loss: 3310538.9457
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9951; val_auprc_score: 0.9981; val_best_acc_score: 0.9826; val_best_f1_score: 0.9887; train_kl_reg_loss: 23499.4002; train_edge_recon_loss: 1316380.7968; train_cat_covariates_contrastive_loss: 7898.0850; train_gene_expr_recon_loss: 1931485.4222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3279263.7045; train_optim_loss: 3279263.7045; val_kl_reg_loss: 23535.0924; val_edge_recon_loss: 1326024.8365; val_cat_covariates_contrastive_loss: 7923.7267; val_gene_expr_recon_loss: 1945565.2905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303048.9397; val_optim_loss: 3303048.9397
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9943; val_auprc_score: 0.9976; val_best_acc_score: 0.9814; val_best_f1_score: 0.9880; train_kl_reg_loss: 23785.7092; train_edge_recon_loss: 1315885.7545; train_cat_covariates_contrastive_loss: 7919.2251; train_gene_expr_recon_loss: 1925418.7096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3273009.4013; train_optim_loss: 3273009.4013; val_kl_reg_loss: 24562.2548; val_edge_recon_loss: 1322206.3340; val_cat_covariates_contrastive_loss: 7904.6310; val_gene_expr_recon_loss: 1928181.6131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3282854.8429; val_optim_loss: 3282854.8429
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9943; val_auprc_score: 0.9978; val_best_acc_score: 0.9808; val_best_f1_score: 0.9876; train_kl_reg_loss: 24109.3477; train_edge_recon_loss: 1315873.7586; train_cat_covariates_contrastive_loss: 7947.0597; train_gene_expr_recon_loss: 1922909.3753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3270839.5400; train_optim_loss: 3270839.5400; val_kl_reg_loss: 24788.2982; val_edge_recon_loss: 1337402.7638; val_cat_covariates_contrastive_loss: 7916.6256; val_gene_expr_recon_loss: 1947383.2752; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3317490.9605; val_optim_loss: 3317490.9605
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9945; val_auprc_score: 0.9978; val_best_acc_score: 0.9823; val_best_f1_score: 0.9886; train_kl_reg_loss: 24386.5229; train_edge_recon_loss: 1316786.2485; train_cat_covariates_contrastive_loss: 7962.9152; train_gene_expr_recon_loss: 1916743.0138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3265878.7005; train_optim_loss: 3265878.7005; val_kl_reg_loss: 25343.3296; val_edge_recon_loss: 1329073.3103; val_cat_covariates_contrastive_loss: 7987.1534; val_gene_expr_recon_loss: 1927663.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3290066.8014; val_optim_loss: 3290066.8014
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9949; val_auprc_score: 0.9980; val_best_acc_score: 0.9819; val_best_f1_score: 0.9883; train_kl_reg_loss: 24798.4460; train_edge_recon_loss: 1314760.3017; train_cat_covariates_contrastive_loss: 7950.6864; train_gene_expr_recon_loss: 1912723.3126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3260232.7465; train_optim_loss: 3260232.7465; val_kl_reg_loss: 25185.0690; val_edge_recon_loss: 1334542.5119; val_cat_covariates_contrastive_loss: 7974.9611; val_gene_expr_recon_loss: 1916354.5336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3284057.0711; val_optim_loss: 3284057.0711
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9947; val_auprc_score: 0.9977; val_best_acc_score: 0.9824; val_best_f1_score: 0.9886; train_kl_reg_loss: 25024.8759; train_edge_recon_loss: 1314808.9755; train_cat_covariates_contrastive_loss: 7985.4530; train_gene_expr_recon_loss: 1908741.8300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3256561.1354; train_optim_loss: 3256561.1354; val_kl_reg_loss: 25457.1743; val_edge_recon_loss: 1337598.3617; val_cat_covariates_contrastive_loss: 7993.7692; val_gene_expr_recon_loss: 1915971.0543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3287020.3626; val_optim_loss: 3287020.3626

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9952; val_auprc_score: 0.9982; val_best_acc_score: 0.9842; val_best_f1_score: 0.9898; train_kl_reg_loss: 24383.6299; train_edge_recon_loss: 1314084.9630; train_cat_covariates_contrastive_loss: 8016.7654; train_gene_expr_recon_loss: 1870389.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3216874.9220; train_optim_loss: 3216874.9220; val_kl_reg_loss: 24530.7627; val_edge_recon_loss: 1320793.8557; val_cat_covariates_contrastive_loss: 8048.1586; val_gene_expr_recon_loss: 1883975.4442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3237348.2233; val_optim_loss: 3237348.2233
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9949; val_auprc_score: 0.9980; val_best_acc_score: 0.9839; val_best_f1_score: 0.9896; train_kl_reg_loss: 24239.1156; train_edge_recon_loss: 1311798.1308; train_cat_covariates_contrastive_loss: 8029.1169; train_gene_expr_recon_loss: 1863291.0092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3207357.3735; train_optim_loss: 3207357.3735; val_kl_reg_loss: 24127.9122; val_edge_recon_loss: 1330192.1961; val_cat_covariates_contrastive_loss: 8059.9875; val_gene_expr_recon_loss: 1879411.2134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3241791.2984; val_optim_loss: 3241791.2984
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9955; val_auprc_score: 0.9983; val_best_acc_score: 0.9844; val_best_f1_score: 0.9899; train_kl_reg_loss: 24023.9551; train_edge_recon_loss: 1314359.8126; train_cat_covariates_contrastive_loss: 8053.5825; train_gene_expr_recon_loss: 1860185.4874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3206622.8380; train_optim_loss: 3206622.8380; val_kl_reg_loss: 23902.2294; val_edge_recon_loss: 1326725.1003; val_cat_covariates_contrastive_loss: 8040.7626; val_gene_expr_recon_loss: 1874533.4911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3233201.5771; val_optim_loss: 3233201.5771
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9958; val_auprc_score: 0.9985; val_best_acc_score: 0.9845; val_best_f1_score: 0.9900; train_kl_reg_loss: 23884.8554; train_edge_recon_loss: 1313252.0178; train_cat_covariates_contrastive_loss: 8039.4112; train_gene_expr_recon_loss: 1858093.8067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3203270.0899; train_optim_loss: 3203270.0899; val_kl_reg_loss: 23842.3746; val_edge_recon_loss: 1324735.9807; val_cat_covariates_contrastive_loss: 8029.0322; val_gene_expr_recon_loss: 1873367.9555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3229975.3458; val_optim_loss: 3229975.3458
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9953; val_auprc_score: 0.9982; val_best_acc_score: 0.9842; val_best_f1_score: 0.9898; train_kl_reg_loss: 23642.3005; train_edge_recon_loss: 1312233.5970; train_cat_covariates_contrastive_loss: 8050.2611; train_gene_expr_recon_loss: 1856946.5359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3200872.6925; train_optim_loss: 3200872.6925; val_kl_reg_loss: 23547.7329; val_edge_recon_loss: 1326689.3780; val_cat_covariates_contrastive_loss: 8064.5161; val_gene_expr_recon_loss: 1874032.6709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3232334.2984; val_optim_loss: 3232334.2984
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9949; val_auprc_score: 0.9980; val_best_acc_score: 0.9843; val_best_f1_score: 0.9899; train_kl_reg_loss: 23505.5004; train_edge_recon_loss: 1310558.4939; train_cat_covariates_contrastive_loss: 8033.6844; train_gene_expr_recon_loss: 1854791.7541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3196889.4336; train_optim_loss: 3196889.4336; val_kl_reg_loss: 23451.2627; val_edge_recon_loss: 1322330.3631; val_cat_covariates_contrastive_loss: 8038.2163; val_gene_expr_recon_loss: 1874433.4056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3228253.2470; val_optim_loss: 3228253.2470
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9950; val_auprc_score: 0.9980; val_best_acc_score: 0.9846; val_best_f1_score: 0.9901; train_kl_reg_loss: 23331.7682; train_edge_recon_loss: 1310716.8488; train_cat_covariates_contrastive_loss: 8041.1270; train_gene_expr_recon_loss: 1853818.4208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3195908.1658; train_optim_loss: 3195908.1658; val_kl_reg_loss: 23416.6742; val_edge_recon_loss: 1322928.7895; val_cat_covariates_contrastive_loss: 8051.7689; val_gene_expr_recon_loss: 1874836.3325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3229233.5692; val_optim_loss: 3229233.5692
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9952; val_auprc_score: 0.9981; val_best_acc_score: 0.9849; val_best_f1_score: 0.9902; train_kl_reg_loss: 23177.5090; train_edge_recon_loss: 1312232.2455; train_cat_covariates_contrastive_loss: 8044.6421; train_gene_expr_recon_loss: 1852218.1813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3195672.5768; train_optim_loss: 3195672.5768; val_kl_reg_loss: 23299.6608; val_edge_recon_loss: 1328415.3004; val_cat_covariates_contrastive_loss: 8025.2378; val_gene_expr_recon_loss: 1868907.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3228647.9970; val_optim_loss: 3228647.9970
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9951; val_auprc_score: 0.9979; val_best_acc_score: 0.9847; val_best_f1_score: 0.9901; train_kl_reg_loss: 23158.3375; train_edge_recon_loss: 1311059.5834; train_cat_covariates_contrastive_loss: 8026.6376; train_gene_expr_recon_loss: 1850518.6404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3192763.1987; train_optim_loss: 3192763.1987; val_kl_reg_loss: 22904.9480; val_edge_recon_loss: 1322076.9481; val_cat_covariates_contrastive_loss: 8047.0363; val_gene_expr_recon_loss: 1869780.2920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3222809.2223; val_optim_loss: 3222809.2223
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9951; val_auprc_score: 0.9981; val_best_acc_score: 0.9848; val_best_f1_score: 0.9902; train_kl_reg_loss: 22907.6737; train_edge_recon_loss: 1310767.7244; train_cat_covariates_contrastive_loss: 8037.7054; train_gene_expr_recon_loss: 1850456.4858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3192169.5910; train_optim_loss: 3192169.5910; val_kl_reg_loss: 22986.4814; val_edge_recon_loss: 1320408.4620; val_cat_covariates_contrastive_loss: 8074.2334; val_gene_expr_recon_loss: 1868770.1581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3220239.3449; val_optim_loss: 3220239.3449
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9953; val_auprc_score: 0.9981; val_best_acc_score: 0.9852; val_best_f1_score: 0.9905; train_kl_reg_loss: 22845.2837; train_edge_recon_loss: 1311046.2823; train_cat_covariates_contrastive_loss: 8030.7471; train_gene_expr_recon_loss: 1849625.6318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3191547.9431; train_optim_loss: 3191547.9431; val_kl_reg_loss: 22959.9129; val_edge_recon_loss: 1313417.8849; val_cat_covariates_contrastive_loss: 8050.9441; val_gene_expr_recon_loss: 1867774.6571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3212203.3953; val_optim_loss: 3212203.3953
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9949; val_auprc_score: 0.9979; val_best_acc_score: 0.9846; val_best_f1_score: 0.9901; train_kl_reg_loss: 22782.5622; train_edge_recon_loss: 1309744.8411; train_cat_covariates_contrastive_loss: 8042.3816; train_gene_expr_recon_loss: 1848656.8625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3189226.6485; train_optim_loss: 3189226.6485; val_kl_reg_loss: 22675.0093; val_edge_recon_loss: 1324082.5049; val_cat_covariates_contrastive_loss: 8044.2214; val_gene_expr_recon_loss: 1864269.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3219071.6709; val_optim_loss: 3219071.6709
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9951; val_auprc_score: 0.9980; val_best_acc_score: 0.9846; val_best_f1_score: 0.9901; train_kl_reg_loss: 22670.0258; train_edge_recon_loss: 1309378.7275; train_cat_covariates_contrastive_loss: 8051.3331; train_gene_expr_recon_loss: 1847827.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3187927.2417; train_optim_loss: 3187927.2417; val_kl_reg_loss: 22695.5898; val_edge_recon_loss: 1319112.4452; val_cat_covariates_contrastive_loss: 8066.0837; val_gene_expr_recon_loss: 1866707.8775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3216581.9931; val_optim_loss: 3216581.9931
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9957; val_auprc_score: 0.9983; val_best_acc_score: 0.9856; val_best_f1_score: 0.9907; train_kl_reg_loss: 22548.9096; train_edge_recon_loss: 1308521.4815; train_cat_covariates_contrastive_loss: 8050.6322; train_gene_expr_recon_loss: 1846343.7211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3185464.7441; train_optim_loss: 3185464.7441; val_kl_reg_loss: 22648.0846; val_edge_recon_loss: 1317432.0375; val_cat_covariates_contrastive_loss: 8028.2280; val_gene_expr_recon_loss: 1865687.4995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213795.8429; val_optim_loss: 3213795.8429
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9952; val_auprc_score: 0.9982; val_best_acc_score: 0.9847; val_best_f1_score: 0.9901; train_kl_reg_loss: 22482.9584; train_edge_recon_loss: 1310517.9084; train_cat_covariates_contrastive_loss: 8040.5283; train_gene_expr_recon_loss: 1845668.4042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3186709.7972; train_optim_loss: 3186709.7972; val_kl_reg_loss: 22564.8986; val_edge_recon_loss: 1324373.4600; val_cat_covariates_contrastive_loss: 8069.0021; val_gene_expr_recon_loss: 1865852.5776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3220859.9308; val_optim_loss: 3220859.9308

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9957; val_auprc_score: 0.9984; val_best_acc_score: 0.9855; val_best_f1_score: 0.9906; train_kl_reg_loss: 22373.0505; train_edge_recon_loss: 1311786.3180; train_cat_covariates_contrastive_loss: 8039.8647; train_gene_expr_recon_loss: 1841606.9548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3183806.1869; train_optim_loss: 3183806.1869; val_kl_reg_loss: 22407.6418; val_edge_recon_loss: 1315391.7638; val_cat_covariates_contrastive_loss: 8052.7348; val_gene_expr_recon_loss: 1861545.3691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3207397.5109; val_optim_loss: 3207397.5109
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9951; val_auprc_score: 0.9981; val_best_acc_score: 0.9850; val_best_f1_score: 0.9903; train_kl_reg_loss: 22292.4649; train_edge_recon_loss: 1309763.6377; train_cat_covariates_contrastive_loss: 8055.6745; train_gene_expr_recon_loss: 1841055.6655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181167.4393; train_optim_loss: 3181167.4393; val_kl_reg_loss: 22368.3216; val_edge_recon_loss: 1320934.8888; val_cat_covariates_contrastive_loss: 8040.4440; val_gene_expr_recon_loss: 1862394.7228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213738.3785; val_optim_loss: 3213738.3785
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9955; val_auprc_score: 0.9982; val_best_acc_score: 0.9851; val_best_f1_score: 0.9904; train_kl_reg_loss: 22332.9089; train_edge_recon_loss: 1309537.0220; train_cat_covariates_contrastive_loss: 8047.0503; train_gene_expr_recon_loss: 1841547.9193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181464.8980; train_optim_loss: 3181464.8980; val_kl_reg_loss: 22367.5583; val_edge_recon_loss: 1325536.3508; val_cat_covariates_contrastive_loss: 8054.3385; val_gene_expr_recon_loss: 1862697.0479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3218655.2875; val_optim_loss: 3218655.2875
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9950; val_auprc_score: 0.9980; val_best_acc_score: 0.9854; val_best_f1_score: 0.9906; train_kl_reg_loss: 22298.1463; train_edge_recon_loss: 1307484.6531; train_cat_covariates_contrastive_loss: 8050.6190; train_gene_expr_recon_loss: 1841157.4822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3178990.9019; train_optim_loss: 3178990.9019; val_kl_reg_loss: 22354.1158; val_edge_recon_loss: 1323528.5682; val_cat_covariates_contrastive_loss: 8063.7889; val_gene_expr_recon_loss: 1862657.8404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3216604.3103; val_optim_loss: 3216604.3103
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9956; val_auprc_score: 0.9983; val_best_acc_score: 0.9858; val_best_f1_score: 0.9909; train_kl_reg_loss: 22281.5027; train_edge_recon_loss: 1310414.7623; train_cat_covariates_contrastive_loss: 8054.1019; train_gene_expr_recon_loss: 1841156.4652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181906.8307; train_optim_loss: 3181906.8307; val_kl_reg_loss: 22296.4790; val_edge_recon_loss: 1316726.9264; val_cat_covariates_contrastive_loss: 8070.3284; val_gene_expr_recon_loss: 1861173.2367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3208266.9704; val_optim_loss: 3208266.9704

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9953; val_auprc_score: 0.9981; val_best_acc_score: 0.9848; val_best_f1_score: 0.9902; train_kl_reg_loss: 22238.8121; train_edge_recon_loss: 1310064.5084; train_cat_covariates_contrastive_loss: 8061.9359; train_gene_expr_recon_loss: 1840823.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181188.6197; train_optim_loss: 3181188.6197; val_kl_reg_loss: 22291.9875; val_edge_recon_loss: 1318017.5776; val_cat_covariates_contrastive_loss: 8066.9719; val_gene_expr_recon_loss: 1861030.6334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3209407.1709; val_optim_loss: 3209407.1709
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9953; val_auprc_score: 0.9981; val_best_acc_score: 0.9849; val_best_f1_score: 0.9902; train_kl_reg_loss: 22240.5521; train_edge_recon_loss: 1308209.4929; train_cat_covariates_contrastive_loss: 8048.2318; train_gene_expr_recon_loss: 1840307.9788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3178806.2541; train_optim_loss: 3178806.2541; val_kl_reg_loss: 22298.6356; val_edge_recon_loss: 1321634.5677; val_cat_covariates_contrastive_loss: 8075.4737; val_gene_expr_recon_loss: 1861954.3286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213963.0079; val_optim_loss: 3213963.0079
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9982; val_best_acc_score: 0.9855; val_best_f1_score: 0.9906; train_kl_reg_loss: 22241.4183; train_edge_recon_loss: 1308173.2028; train_cat_covariates_contrastive_loss: 8054.1165; train_gene_expr_recon_loss: 1839533.6850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3178002.4186; train_optim_loss: 3178002.4186; val_kl_reg_loss: 22285.1693; val_edge_recon_loss: 1315858.4066; val_cat_covariates_contrastive_loss: 8063.9394; val_gene_expr_recon_loss: 1860895.2964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3207102.8182; val_optim_loss: 3207102.8182
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9954; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9905; train_kl_reg_loss: 22240.3389; train_edge_recon_loss: 1310298.7891; train_cat_covariates_contrastive_loss: 8047.6497; train_gene_expr_recon_loss: 1839965.9807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3180552.7597; train_optim_loss: 3180552.7597; val_kl_reg_loss: 22294.7124; val_edge_recon_loss: 1320968.2050; val_cat_covariates_contrastive_loss: 8070.5388; val_gene_expr_recon_loss: 1859929.3987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3211262.8557; val_optim_loss: 3211262.8557
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9950; val_auprc_score: 0.9980; val_best_acc_score: 0.9853; val_best_f1_score: 0.9905; train_kl_reg_loss: 22247.2166; train_edge_recon_loss: 1310596.1352; train_cat_covariates_contrastive_loss: 8053.5514; train_gene_expr_recon_loss: 1840354.4630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181251.3651; train_optim_loss: 3181251.3651; val_kl_reg_loss: 22309.3325; val_edge_recon_loss: 1324865.2915; val_cat_covariates_contrastive_loss: 8073.8067; val_gene_expr_recon_loss: 1863302.1843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3218550.6245; val_optim_loss: 3218550.6245
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9955; val_auprc_score: 0.9983; val_best_acc_score: 0.9854; val_best_f1_score: 0.9906; train_kl_reg_loss: 22257.0186; train_edge_recon_loss: 1311970.1736; train_cat_covariates_contrastive_loss: 8050.2583; train_gene_expr_recon_loss: 1840979.9188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3183257.3678; train_optim_loss: 3183257.3678; val_kl_reg_loss: 22301.6034; val_edge_recon_loss: 1324224.9615; val_cat_covariates_contrastive_loss: 8072.7091; val_gene_expr_recon_loss: 1862487.8533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3217087.1196; val_optim_loss: 3217087.1196
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9953; val_auprc_score: 0.9981; val_best_acc_score: 0.9853; val_best_f1_score: 0.9905; train_kl_reg_loss: 22249.4822; train_edge_recon_loss: 1311506.4962; train_cat_covariates_contrastive_loss: 8055.7244; train_gene_expr_recon_loss: 1840073.1273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181884.8299; train_optim_loss: 3181884.8299; val_kl_reg_loss: 22312.9845; val_edge_recon_loss: 1319801.9526; val_cat_covariates_contrastive_loss: 8053.8981; val_gene_expr_recon_loss: 1863365.4916; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213534.3300; val_optim_loss: 3213534.3300

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9950; val_auprc_score: 0.9980; val_best_acc_score: 0.9852; val_best_f1_score: 0.9904; train_kl_reg_loss: 22247.3684; train_edge_recon_loss: 1309372.4275; train_cat_covariates_contrastive_loss: 8053.1677; train_gene_expr_recon_loss: 1840301.1846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3179974.1495; train_optim_loss: 3179974.1495; val_kl_reg_loss: 22297.0062; val_edge_recon_loss: 1320643.3286; val_cat_covariates_contrastive_loss: 8062.8440; val_gene_expr_recon_loss: 1861503.7757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3212506.9654; val_optim_loss: 3212506.9654
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9951; val_auprc_score: 0.9981; val_best_acc_score: 0.9851; val_best_f1_score: 0.9904; train_kl_reg_loss: 22251.1042; train_edge_recon_loss: 1310639.2324; train_cat_covariates_contrastive_loss: 8058.0851; train_gene_expr_recon_loss: 1839644.2975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3180592.7165; train_optim_loss: 3180592.7165; val_kl_reg_loss: 22298.3174; val_edge_recon_loss: 1320573.2041; val_cat_covariates_contrastive_loss: 8056.2238; val_gene_expr_recon_loss: 1862068.7184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3212996.4486; val_optim_loss: 3212996.4486
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9954; val_auprc_score: 0.9982; val_best_acc_score: 0.9853; val_best_f1_score: 0.9905; train_kl_reg_loss: 22243.9204; train_edge_recon_loss: 1308172.4788; train_cat_covariates_contrastive_loss: 8058.1346; train_gene_expr_recon_loss: 1839785.9911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3178260.5259; train_optim_loss: 3178260.5259; val_kl_reg_loss: 22312.1934; val_edge_recon_loss: 1323412.7915; val_cat_covariates_contrastive_loss: 8066.6715; val_gene_expr_recon_loss: 1859729.1522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213520.8221; val_optim_loss: 3213520.8221
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9949; val_auprc_score: 0.9980; val_best_acc_score: 0.9847; val_best_f1_score: 0.9901; train_kl_reg_loss: 22248.0440; train_edge_recon_loss: 1310853.7607; train_cat_covariates_contrastive_loss: 8054.1602; train_gene_expr_recon_loss: 1840791.2785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181947.2431; train_optim_loss: 3181947.2431; val_kl_reg_loss: 22307.3458; val_edge_recon_loss: 1322264.2564; val_cat_covariates_contrastive_loss: 8057.8771; val_gene_expr_recon_loss: 1860838.6606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213468.1374; val_optim_loss: 3213468.1374

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 960 min 46 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9835
val AUPRC score: 0.9930
val best accuracy score: 0.9620
val best F1 score: 0.9750
val target rna MSE score: 0.6404
val source rna MSE score: 0.0857
Val cat covariate0 mean sim diff: -0.0009
Val cat covariate1 mean sim diff: -0.0975
Duration of model training in run 2: 16 hours, 5 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
