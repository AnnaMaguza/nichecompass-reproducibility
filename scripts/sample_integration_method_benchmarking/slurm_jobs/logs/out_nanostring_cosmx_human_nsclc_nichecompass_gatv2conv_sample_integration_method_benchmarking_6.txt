Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9580; val_auprc_score: 0.9812; val_best_acc_score: 0.9315; val_best_f1_score: 0.9553; train_kl_reg_loss: 16988.1810; train_edge_recon_loss: 1323001.7261; train_gene_expr_recon_loss: 2123471.6729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3463461.5852; train_optim_loss: 3463461.5852; val_kl_reg_loss: 17860.0182; val_edge_recon_loss: 1346879.0983; val_gene_expr_recon_loss: 2076735.1851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3441474.3111; val_optim_loss: 3441474.3111
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9599; val_auprc_score: 0.9822; val_best_acc_score: 0.9331; val_best_f1_score: 0.9563; train_kl_reg_loss: 17910.8911; train_edge_recon_loss: 1318025.7279; train_gene_expr_recon_loss: 2051782.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3387719.1453; train_optim_loss: 3387719.1453; val_kl_reg_loss: 18117.9876; val_edge_recon_loss: 1345495.7805; val_gene_expr_recon_loss: 2026842.8884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3390456.6622; val_optim_loss: 3390456.6622
Run timestamp: 23082023_210907_6.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '--edge_batch_size_list', '256', '256', '--node_batch_size_list', 'None', 'None', '--seeds', '1', '0', '--run_index', '2', '1', '--cell_type_key', 'cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 602179
Number of validation edges: 66908
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9394; val_auprc_score: 0.9733; val_best_acc_score: 0.9109; val_best_f1_score: 0.9421; train_kl_reg_loss: 14202.3415; train_edge_recon_loss: 1369114.7286; train_gene_expr_recon_loss: 2728251.1456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4111568.2184; train_optim_loss: 4111568.2184; val_kl_reg_loss: 14397.8227; val_edge_recon_loss: 1375231.3349; val_gene_expr_recon_loss: 2461929.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3851558.4113; val_optim_loss: 3851558.4113
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9631; val_auprc_score: 0.9837; val_best_acc_score: 0.9343; val_best_f1_score: 0.9570; train_kl_reg_loss: 18596.2174; train_edge_recon_loss: 1318177.6566; train_gene_expr_recon_loss: 2008246.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3345020.7513; train_optim_loss: 3345020.7513; val_kl_reg_loss: 18819.4591; val_edge_recon_loss: 1358908.0534; val_gene_expr_recon_loss: 1991048.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368775.9771; val_optim_loss: 3368775.9771
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9624; val_auprc_score: 0.9831; val_best_acc_score: 0.9365; val_best_f1_score: 0.9583; train_kl_reg_loss: 18998.5727; train_edge_recon_loss: 1317337.3626; train_gene_expr_recon_loss: 1977277.9337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3313613.8636; train_optim_loss: 3313613.8636; val_kl_reg_loss: 19481.4812; val_edge_recon_loss: 1352289.2748; val_gene_expr_recon_loss: 1970017.7729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3341788.5305; val_optim_loss: 3341788.5305
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9508; val_auprc_score: 0.9783; val_best_acc_score: 0.9231; val_best_f1_score: 0.9499; train_kl_reg_loss: 16195.8205; train_edge_recon_loss: 1331913.0813; train_gene_expr_recon_loss: 2305965.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3654073.9088; train_optim_loss: 3654073.9088; val_kl_reg_loss: 17352.5117; val_edge_recon_loss: 1364850.3459; val_gene_expr_recon_loss: 2193961.1159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576163.9742; val_optim_loss: 3576163.9742
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9640; val_auprc_score: 0.9841; val_best_acc_score: 0.9370; val_best_f1_score: 0.9586; train_kl_reg_loss: 19446.2829; train_edge_recon_loss: 1318064.0819; train_gene_expr_recon_loss: 1961572.3133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3299082.6740; train_optim_loss: 3299082.6740; val_kl_reg_loss: 19652.5894; val_edge_recon_loss: 1359360.7052; val_gene_expr_recon_loss: 1954481.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3333495.1469; val_optim_loss: 3333495.1469
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9574; val_auprc_score: 0.9808; val_best_acc_score: 0.9307; val_best_f1_score: 0.9548; train_kl_reg_loss: 17923.5721; train_edge_recon_loss: 1324636.9611; train_gene_expr_recon_loss: 2121921.7225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3464482.2565; train_optim_loss: 3464482.2565; val_kl_reg_loss: 18939.3868; val_edge_recon_loss: 1355484.4547; val_gene_expr_recon_loss: 2075991.3693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3450415.2156; val_optim_loss: 3450415.2156
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9648; val_auprc_score: 0.9848; val_best_acc_score: 0.9359; val_best_f1_score: 0.9581; train_kl_reg_loss: 19643.8643; train_edge_recon_loss: 1313309.7105; train_gene_expr_recon_loss: 1945187.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278141.2857; train_optim_loss: 3278141.2857; val_kl_reg_loss: 19672.3213; val_edge_recon_loss: 1348171.4532; val_gene_expr_recon_loss: 1948026.1317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315869.9008; val_optim_loss: 3315869.9008
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9640; val_auprc_score: 0.9838; val_best_acc_score: 0.9384; val_best_f1_score: 0.9598; train_kl_reg_loss: 19967.7316; train_edge_recon_loss: 1316635.7174; train_gene_expr_recon_loss: 1933228.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269832.3668; train_optim_loss: 3269832.3668; val_kl_reg_loss: 19904.4247; val_edge_recon_loss: 1351639.9962; val_gene_expr_recon_loss: 1935674.7910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3307219.2156; val_optim_loss: 3307219.2156
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9599; val_auprc_score: 0.9818; val_best_acc_score: 0.9336; val_best_f1_score: 0.9565; train_kl_reg_loss: 19387.1736; train_edge_recon_loss: 1321711.4761; train_gene_expr_recon_loss: 2040742.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3381841.0738; train_optim_loss: 3381841.0738; val_kl_reg_loss: 20100.7867; val_edge_recon_loss: 1350847.9828; val_gene_expr_recon_loss: 2027757.9442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3398706.7052; val_optim_loss: 3398706.7052
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9634; val_auprc_score: 0.9835; val_best_acc_score: 0.9374; val_best_f1_score: 0.9589; train_kl_reg_loss: 20068.8402; train_edge_recon_loss: 1317937.1059; train_gene_expr_recon_loss: 1923904.1018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3261910.0506; train_optim_loss: 3261910.0506; val_kl_reg_loss: 20620.4658; val_edge_recon_loss: 1354193.0716; val_gene_expr_recon_loss: 1927070.3521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3301883.8950; val_optim_loss: 3301883.8950
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9595; val_auprc_score: 0.9818; val_best_acc_score: 0.9334; val_best_f1_score: 0.9564; train_kl_reg_loss: 20417.4689; train_edge_recon_loss: 1317943.1378; train_gene_expr_recon_loss: 1999005.5079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3337366.1138; train_optim_loss: 3337366.1138; val_kl_reg_loss: 20908.8333; val_edge_recon_loss: 1354044.1904; val_gene_expr_recon_loss: 1990418.9633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3365372.0010; val_optim_loss: 3365372.0010
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9632; val_auprc_score: 0.9833; val_best_acc_score: 0.9375; val_best_f1_score: 0.9589; train_kl_reg_loss: 20350.7266; train_edge_recon_loss: 1315979.4363; train_gene_expr_recon_loss: 1915303.9365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3251634.0981; train_optim_loss: 3251634.0981; val_kl_reg_loss: 20745.8258; val_edge_recon_loss: 1364350.2643; val_gene_expr_recon_loss: 1915879.3330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3300975.4256; val_optim_loss: 3300975.4256
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9596; val_auprc_score: 0.9812; val_best_acc_score: 0.9355; val_best_f1_score: 0.9579; train_kl_reg_loss: 21040.0090; train_edge_recon_loss: 1321095.4190; train_gene_expr_recon_loss: 1977456.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3319592.2516; train_optim_loss: 3319592.2516; val_kl_reg_loss: 22357.9468; val_edge_recon_loss: 1345126.8521; val_gene_expr_recon_loss: 1975528.1708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3343012.9704; val_optim_loss: 3343012.9704
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9644; val_auprc_score: 0.9840; val_best_acc_score: 0.9389; val_best_f1_score: 0.9599; train_kl_reg_loss: 20359.6144; train_edge_recon_loss: 1317305.4320; train_gene_expr_recon_loss: 1908526.6849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3246191.7315; train_optim_loss: 3246191.7315; val_kl_reg_loss: 20870.2934; val_edge_recon_loss: 1355318.0792; val_gene_expr_recon_loss: 1914136.8645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3290325.2519; val_optim_loss: 3290325.2519
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9647; val_auprc_score: 0.9840; val_best_acc_score: 0.9391; val_best_f1_score: 0.9601; train_kl_reg_loss: 20740.7410; train_edge_recon_loss: 1318528.7993; train_gene_expr_recon_loss: 1900651.0020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3239920.5412; train_optim_loss: 3239920.5412; val_kl_reg_loss: 20611.7016; val_edge_recon_loss: 1346398.6880; val_gene_expr_recon_loss: 1902416.5802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3269426.9676; val_optim_loss: 3269426.9676
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9635; val_auprc_score: 0.9837; val_best_acc_score: 0.9368; val_best_f1_score: 0.9588; train_kl_reg_loss: 21559.1394; train_edge_recon_loss: 1321602.3207; train_gene_expr_recon_loss: 1959001.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3302163.4448; train_optim_loss: 3302163.4448; val_kl_reg_loss: 22391.5792; val_edge_recon_loss: 1346446.7598; val_gene_expr_recon_loss: 1966009.7257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3334848.0611; val_optim_loss: 3334848.0611
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9655; val_auprc_score: 0.9846; val_best_acc_score: 0.9384; val_best_f1_score: 0.9596; train_kl_reg_loss: 20674.0534; train_edge_recon_loss: 1315382.5777; train_gene_expr_recon_loss: 1895374.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231430.6829; train_optim_loss: 3231430.6829; val_kl_reg_loss: 21326.3678; val_edge_recon_loss: 1352244.1365; val_gene_expr_recon_loss: 1898850.2185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272420.7290; val_optim_loss: 3272420.7290
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9630; val_auprc_score: 0.9828; val_best_acc_score: 0.9388; val_best_f1_score: 0.9600; train_kl_reg_loss: 22086.9922; train_edge_recon_loss: 1318370.2138; train_gene_expr_recon_loss: 1945707.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3286165.1187; train_optim_loss: 3286165.1187; val_kl_reg_loss: 22407.3722; val_edge_recon_loss: 1351607.3469; val_gene_expr_recon_loss: 1950184.0677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3324198.7805; val_optim_loss: 3324198.7805
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9658; val_auprc_score: 0.9846; val_best_acc_score: 0.9417; val_best_f1_score: 0.9618; train_kl_reg_loss: 21035.7977; train_edge_recon_loss: 1317032.2927; train_gene_expr_recon_loss: 1893625.4226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3231693.5142; train_optim_loss: 3231693.5142; val_kl_reg_loss: 21548.5142; val_edge_recon_loss: 1344775.6336; val_gene_expr_recon_loss: 1895945.7844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3262269.9370; val_optim_loss: 3262269.9370
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9657; val_auprc_score: 0.9851; val_best_acc_score: 0.9380; val_best_f1_score: 0.9593; train_kl_reg_loss: 21128.2583; train_edge_recon_loss: 1314480.2418; train_gene_expr_recon_loss: 1883243.2466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3218851.7419; train_optim_loss: 3218851.7419; val_kl_reg_loss: 21249.9999; val_edge_recon_loss: 1350705.3540; val_gene_expr_recon_loss: 1903911.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3275866.8989; val_optim_loss: 3275866.8989
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9647; val_auprc_score: 0.9838; val_best_acc_score: 0.9400; val_best_f1_score: 0.9606; train_kl_reg_loss: 22503.7945; train_edge_recon_loss: 1316609.3124; train_gene_expr_recon_loss: 1935592.5776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274705.6830; train_optim_loss: 3274705.6830; val_kl_reg_loss: 22954.2960; val_edge_recon_loss: 1356790.1365; val_gene_expr_recon_loss: 1939090.8340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318835.2710; val_optim_loss: 3318835.2710
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9680; val_auprc_score: 0.9857; val_best_acc_score: 0.9429; val_best_f1_score: 0.9625; train_kl_reg_loss: 21332.6704; train_edge_recon_loss: 1316379.3496; train_gene_expr_recon_loss: 1882913.5194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3220625.5382; train_optim_loss: 3220625.5382; val_kl_reg_loss: 21788.0392; val_edge_recon_loss: 1337817.2195; val_gene_expr_recon_loss: 1889242.4876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3248847.7347; val_optim_loss: 3248847.7347
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9656; val_auprc_score: 0.9849; val_best_acc_score: 0.9409; val_best_f1_score: 0.9614; train_kl_reg_loss: 22847.5916; train_edge_recon_loss: 1318828.0778; train_gene_expr_recon_loss: 1926560.5104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3268236.1769; train_optim_loss: 3268236.1769; val_kl_reg_loss: 23264.6261; val_edge_recon_loss: 1339376.7727; val_gene_expr_recon_loss: 1938389.2586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3301030.6679; val_optim_loss: 3301030.6679
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9686; val_auprc_score: 0.9864; val_best_acc_score: 0.9417; val_best_f1_score: 0.9617; train_kl_reg_loss: 21623.9948; train_edge_recon_loss: 1315305.6512; train_gene_expr_recon_loss: 1876216.9080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3213146.5514; train_optim_loss: 3213146.5514; val_kl_reg_loss: 21379.0602; val_edge_recon_loss: 1356488.6374; val_gene_expr_recon_loss: 1880592.2385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258459.9561; val_optim_loss: 3258459.9561
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9657; val_auprc_score: 0.9844; val_best_acc_score: 0.9414; val_best_f1_score: 0.9616; train_kl_reg_loss: 21673.3719; train_edge_recon_loss: 1317237.1931; train_gene_expr_recon_loss: 1874793.9782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3213704.5408; train_optim_loss: 3213704.5408; val_kl_reg_loss: 21724.5489; val_edge_recon_loss: 1357280.5248; val_gene_expr_recon_loss: 1877723.9704; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3256729.0592; val_optim_loss: 3256729.0592
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9627; val_auprc_score: 0.9829; val_best_acc_score: 0.9391; val_best_f1_score: 0.9601; train_kl_reg_loss: 23229.6121; train_edge_recon_loss: 1316934.6018; train_gene_expr_recon_loss: 1920771.9150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3260936.1308; train_optim_loss: 3260936.1308; val_kl_reg_loss: 23391.4338; val_edge_recon_loss: 1345853.6016; val_gene_expr_recon_loss: 1928527.4699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3297772.5067; val_optim_loss: 3297772.5067
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9682; val_auprc_score: 0.9858; val_best_acc_score: 0.9435; val_best_f1_score: 0.9630; train_kl_reg_loss: 21779.6224; train_edge_recon_loss: 1318469.3189; train_gene_expr_recon_loss: 1869501.0725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3209750.0142; train_optim_loss: 3209750.0142; val_kl_reg_loss: 21543.2121; val_edge_recon_loss: 1350069.2147; val_gene_expr_recon_loss: 1876570.7977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3248183.2214; val_optim_loss: 3248183.2214
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9647; val_auprc_score: 0.9842; val_best_acc_score: 0.9405; val_best_f1_score: 0.9611; train_kl_reg_loss: 23546.4177; train_edge_recon_loss: 1319641.5785; train_gene_expr_recon_loss: 1913279.9472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3256467.9427; train_optim_loss: 3256467.9427; val_kl_reg_loss: 24057.4160; val_edge_recon_loss: 1343859.0620; val_gene_expr_recon_loss: 1925775.0644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3293691.5401; val_optim_loss: 3293691.5401
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9699; val_auprc_score: 0.9867; val_best_acc_score: 0.9434; val_best_f1_score: 0.9629; train_kl_reg_loss: 21906.5300; train_edge_recon_loss: 1319106.9312; train_gene_expr_recon_loss: 1864579.6971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3205593.1574; train_optim_loss: 3205593.1574; val_kl_reg_loss: 21623.3657; val_edge_recon_loss: 1353638.5802; val_gene_expr_recon_loss: 1875510.9485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3250772.8836; val_optim_loss: 3250772.8836
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9681; val_auprc_score: 0.9862; val_best_acc_score: 0.9441; val_best_f1_score: 0.9634; train_kl_reg_loss: 22056.2236; train_edge_recon_loss: 1314132.9239; train_gene_expr_recon_loss: 1865084.3045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3201273.4501; train_optim_loss: 3201273.4501; val_kl_reg_loss: 22053.0720; val_edge_recon_loss: 1339557.1632; val_gene_expr_recon_loss: 1866995.9885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3228606.2176; val_optim_loss: 3228606.2176
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9656; val_auprc_score: 0.9846; val_best_acc_score: 0.9420; val_best_f1_score: 0.9621; train_kl_reg_loss: 23910.8763; train_edge_recon_loss: 1319867.1174; train_gene_expr_recon_loss: 1906469.6856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3250247.6801; train_optim_loss: 3250247.6801; val_kl_reg_loss: 24323.4341; val_edge_recon_loss: 1345273.2037; val_gene_expr_recon_loss: 1921377.2395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3290973.8922; val_optim_loss: 3290973.8922
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9664; val_auprc_score: 0.9847; val_best_acc_score: 0.9430; val_best_f1_score: 0.9626; train_kl_reg_loss: 22037.2971; train_edge_recon_loss: 1314626.4772; train_gene_expr_recon_loss: 1860204.2614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3196868.0376; train_optim_loss: 3196868.0376; val_kl_reg_loss: 22836.0726; val_edge_recon_loss: 1353448.5887; val_gene_expr_recon_loss: 1869171.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3245455.9656; val_optim_loss: 3245455.9656
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9651; val_auprc_score: 0.9838; val_best_acc_score: 0.9411; val_best_f1_score: 0.9614; train_kl_reg_loss: 24059.2648; train_edge_recon_loss: 1316800.4370; train_gene_expr_recon_loss: 1900868.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3241728.4847; train_optim_loss: 3241728.4847; val_kl_reg_loss: 25063.4688; val_edge_recon_loss: 1355055.2743; val_gene_expr_recon_loss: 1918046.8349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3298165.5763; val_optim_loss: 3298165.5763
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9700; val_auprc_score: 0.9868; val_best_acc_score: 0.9425; val_best_f1_score: 0.9622; train_kl_reg_loss: 22216.4092; train_edge_recon_loss: 1314025.8919; train_gene_expr_recon_loss: 1856845.8104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3193088.1136; train_optim_loss: 3193088.1136; val_kl_reg_loss: 22503.8376; val_edge_recon_loss: 1355992.9475; val_gene_expr_recon_loss: 1867665.7338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3246162.5172; val_optim_loss: 3246162.5172
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9681; val_auprc_score: 0.9858; val_best_acc_score: 0.9438; val_best_f1_score: 0.9632; train_kl_reg_loss: 24369.3816; train_edge_recon_loss: 1313637.4976; train_gene_expr_recon_loss: 1896947.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234954.7062; train_optim_loss: 3234954.7062; val_kl_reg_loss: 24435.3312; val_edge_recon_loss: 1352432.5969; val_gene_expr_recon_loss: 1917878.6283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3294746.5592; val_optim_loss: 3294746.5592
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9702; val_auprc_score: 0.9871; val_best_acc_score: 0.9436; val_best_f1_score: 0.9630; train_kl_reg_loss: 22289.3306; train_edge_recon_loss: 1315738.5164; train_gene_expr_recon_loss: 1855523.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3193551.1580; train_optim_loss: 3193551.1580; val_kl_reg_loss: 22302.2678; val_edge_recon_loss: 1357721.7195; val_gene_expr_recon_loss: 1858972.6517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3238996.6374; val_optim_loss: 3238996.6374
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9673; val_auprc_score: 0.9857; val_best_acc_score: 0.9417; val_best_f1_score: 0.9619; train_kl_reg_loss: 22360.2044; train_edge_recon_loss: 1315172.6626; train_gene_expr_recon_loss: 1853305.0868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3190837.9526; train_optim_loss: 3190837.9526; val_kl_reg_loss: 23171.6885; val_edge_recon_loss: 1341953.3349; val_gene_expr_recon_loss: 1863543.1078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3228668.1412; val_optim_loss: 3228668.1412
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9679; val_auprc_score: 0.9857; val_best_acc_score: 0.9431; val_best_f1_score: 0.9627; train_kl_reg_loss: 24747.0815; train_edge_recon_loss: 1318367.7625; train_gene_expr_recon_loss: 1889185.5931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3232300.4359; train_optim_loss: 3232300.4359; val_kl_reg_loss: 25332.8090; val_edge_recon_loss: 1343033.7094; val_gene_expr_recon_loss: 1897452.6231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265819.1469; val_optim_loss: 3265819.1469

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9704; val_auprc_score: 0.9867; val_best_acc_score: 0.9453; val_best_f1_score: 0.9641; train_kl_reg_loss: 22193.4433; train_edge_recon_loss: 1312294.5246; train_gene_expr_recon_loss: 1827133.8130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3161621.7844; train_optim_loss: 3161621.7844; val_kl_reg_loss: 22215.6819; val_edge_recon_loss: 1352659.9160; val_gene_expr_recon_loss: 1839467.1365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3214342.7156; val_optim_loss: 3214342.7156
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9680; val_auprc_score: 0.9857; val_best_acc_score: 0.9424; val_best_f1_score: 0.9622; train_kl_reg_loss: 25424.3077; train_edge_recon_loss: 1318683.2466; train_gene_expr_recon_loss: 1889556.0624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3233663.6194; train_optim_loss: 3233663.6194; val_kl_reg_loss: 25387.0316; val_edge_recon_loss: 1359086.6980; val_gene_expr_recon_loss: 1899288.6865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3283762.4132; val_optim_loss: 3283762.4132
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9713; val_auprc_score: 0.9875; val_best_acc_score: 0.9459; val_best_f1_score: 0.9646; train_kl_reg_loss: 22088.8737; train_edge_recon_loss: 1313065.2871; train_gene_expr_recon_loss: 1822359.4094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157513.5705; train_optim_loss: 3157513.5705; val_kl_reg_loss: 22023.2114; val_edge_recon_loss: 1338977.1632; val_gene_expr_recon_loss: 1837386.4885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3198386.8569; val_optim_loss: 3198386.8569
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9681; val_auprc_score: 0.9856; val_best_acc_score: 0.9434; val_best_f1_score: 0.9629; train_kl_reg_loss: 25276.3143; train_edge_recon_loss: 1319529.7693; train_gene_expr_recon_loss: 1884245.1360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3229051.2214; train_optim_loss: 3229051.2214; val_kl_reg_loss: 25855.6686; val_edge_recon_loss: 1351424.5916; val_gene_expr_recon_loss: 1900213.7696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3277494.0248; val_optim_loss: 3277494.0248
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9715; val_auprc_score: 0.9875; val_best_acc_score: 0.9466; val_best_f1_score: 0.9649; train_kl_reg_loss: 21975.0799; train_edge_recon_loss: 1309890.2381; train_gene_expr_recon_loss: 1820069.7906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3151935.1083; train_optim_loss: 3151935.1083; val_kl_reg_loss: 22084.4053; val_edge_recon_loss: 1345670.8655; val_gene_expr_recon_loss: 1833136.6832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200891.9561; val_optim_loss: 3200891.9561
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9709; val_auprc_score: 0.9871; val_best_acc_score: 0.9464; val_best_f1_score: 0.9648; train_kl_reg_loss: 25496.8294; train_edge_recon_loss: 1320030.8820; train_gene_expr_recon_loss: 1880708.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3226236.4048; train_optim_loss: 3226236.4048; val_kl_reg_loss: 25746.1681; val_edge_recon_loss: 1347265.8764; val_gene_expr_recon_loss: 1889737.9504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3262749.9981; val_optim_loss: 3262749.9981
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9714; val_auprc_score: 0.9873; val_best_acc_score: 0.9472; val_best_f1_score: 0.9654; train_kl_reg_loss: 21780.3290; train_edge_recon_loss: 1312949.8370; train_gene_expr_recon_loss: 1818069.1279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3152799.2935; train_optim_loss: 3152799.2935; val_kl_reg_loss: 21682.2983; val_edge_recon_loss: 1330698.8378; val_gene_expr_recon_loss: 1834599.1708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3186980.2958; val_optim_loss: 3186980.2958
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9702; val_auprc_score: 0.9871; val_best_acc_score: 0.9428; val_best_f1_score: 0.9624; train_kl_reg_loss: 25385.9485; train_edge_recon_loss: 1318516.7797; train_gene_expr_recon_loss: 2033782.4063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3377685.1371; train_optim_loss: 3377685.1371; val_kl_reg_loss: 26130.9816; val_edge_recon_loss: 1354034.3531; val_gene_expr_recon_loss: 1953248.9919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3333414.3273; val_optim_loss: 3333414.3273
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9711; val_auprc_score: 0.9873; val_best_acc_score: 0.9462; val_best_f1_score: 0.9646; train_kl_reg_loss: 21711.5873; train_edge_recon_loss: 1312415.9652; train_gene_expr_recon_loss: 1817099.3841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3151226.9418; train_optim_loss: 3151226.9418; val_kl_reg_loss: 21660.4444; val_edge_recon_loss: 1347741.9523; val_gene_expr_recon_loss: 1832207.5697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3201609.9637; val_optim_loss: 3201609.9637
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9725; val_auprc_score: 0.9881; val_best_acc_score: 0.9454; val_best_f1_score: 0.9642; train_kl_reg_loss: 26291.1978; train_edge_recon_loss: 1320900.1736; train_gene_expr_recon_loss: 1911673.1543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3258864.5227; train_optim_loss: 3258864.5227; val_kl_reg_loss: 26023.8940; val_edge_recon_loss: 1341644.7123; val_gene_expr_recon_loss: 1901087.2739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3268755.8683; val_optim_loss: 3268755.8683
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9712; val_auprc_score: 0.9873; val_best_acc_score: 0.9451; val_best_f1_score: 0.9639; train_kl_reg_loss: 21678.4039; train_edge_recon_loss: 1309595.7644; train_gene_expr_recon_loss: 1816443.9647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3147718.1349; train_optim_loss: 3147718.1349; val_kl_reg_loss: 21665.6177; val_edge_recon_loss: 1349735.9103; val_gene_expr_recon_loss: 1831765.7691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3203167.2863; val_optim_loss: 3203167.2863
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9701; val_auprc_score: 0.9866; val_best_acc_score: 0.9449; val_best_f1_score: 0.9638; train_kl_reg_loss: 26098.0552; train_edge_recon_loss: 1315035.8571; train_gene_expr_recon_loss: 1881956.3347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223090.2460; train_optim_loss: 3223090.2460; val_kl_reg_loss: 27753.2237; val_edge_recon_loss: 1362589.0940; val_gene_expr_recon_loss: 1896566.3907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3286908.7166; val_optim_loss: 3286908.7166
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9716; val_auprc_score: 0.9876; val_best_acc_score: 0.9470; val_best_f1_score: 0.9653; train_kl_reg_loss: 21505.3144; train_edge_recon_loss: 1312179.1766; train_gene_expr_recon_loss: 1814870.7453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3148555.2326; train_optim_loss: 3148555.2326; val_kl_reg_loss: 21634.8207; val_edge_recon_loss: 1338512.1307; val_gene_expr_recon_loss: 1830264.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3190411.1832; val_optim_loss: 3190411.1832
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9663; val_auprc_score: 0.9847; val_best_acc_score: 0.9422; val_best_f1_score: 0.9622; train_kl_reg_loss: 24105955.2408; train_edge_recon_loss: 1330092.8063; train_gene_expr_recon_loss: 2275935.4106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 27711983.7684; train_optim_loss: 27711983.7684; val_kl_reg_loss: 32685.6643; val_edge_recon_loss: 1348256.7371; val_gene_expr_recon_loss: 2004169.3621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3385111.7786; val_optim_loss: 3385111.7786
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9717; val_auprc_score: 0.9878; val_best_acc_score: 0.9471; val_best_f1_score: 0.9653; train_kl_reg_loss: 21468.1197; train_edge_recon_loss: 1310801.4894; train_gene_expr_recon_loss: 1814516.5641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146786.1746; train_optim_loss: 3146786.1746; val_kl_reg_loss: 21584.6495; val_edge_recon_loss: 1337776.0515; val_gene_expr_recon_loss: 1831619.5964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3190980.3034; val_optim_loss: 3190980.3034

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9707; val_auprc_score: 0.9872; val_best_acc_score: 0.9453; val_best_f1_score: 0.9642; train_kl_reg_loss: 30467.0458; train_edge_recon_loss: 1321794.7664; train_gene_expr_recon_loss: 1945899.0249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3298160.8327; train_optim_loss: 3298160.8327; val_kl_reg_loss: 30216.5451; val_edge_recon_loss: 1349173.8292; val_gene_expr_recon_loss: 1946930.0849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3326320.4599; val_optim_loss: 3326320.4599

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9728; val_auprc_score: 0.9881; val_best_acc_score: 0.9482; val_best_f1_score: 0.9660; train_kl_reg_loss: 21413.8895; train_edge_recon_loss: 1310893.7288; train_gene_expr_recon_loss: 1811196.6081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3143504.2249; train_optim_loss: 3143504.2249; val_kl_reg_loss: 21465.0165; val_edge_recon_loss: 1343085.9561; val_gene_expr_recon_loss: 1828633.0735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3193184.0496; val_optim_loss: 3193184.0496
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9718; val_auprc_score: 0.9877; val_best_acc_score: 0.9462; val_best_f1_score: 0.9648; train_kl_reg_loss: 29720.5089; train_edge_recon_loss: 1318817.3466; train_gene_expr_recon_loss: 1915987.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3264525.0342; train_optim_loss: 3264525.0342; val_kl_reg_loss: 29716.9150; val_edge_recon_loss: 1339479.4385; val_gene_expr_recon_loss: 1918507.5740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3287703.9284; val_optim_loss: 3287703.9284
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9711; val_auprc_score: 0.9872; val_best_acc_score: 0.9461; val_best_f1_score: 0.9647; train_kl_reg_loss: 21380.4474; train_edge_recon_loss: 1314358.8889; train_gene_expr_recon_loss: 1809681.8803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3145421.2152; train_optim_loss: 3145421.2152; val_kl_reg_loss: 21450.5908; val_edge_recon_loss: 1342845.8855; val_gene_expr_recon_loss: 1828436.5191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3192732.9924; val_optim_loss: 3192732.9924
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9712; val_auprc_score: 0.9871; val_best_acc_score: 0.9471; val_best_f1_score: 0.9654; train_kl_reg_loss: 21376.1212; train_edge_recon_loss: 1308853.0240; train_gene_expr_recon_loss: 1810749.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3140978.8749; train_optim_loss: 3140978.8749; val_kl_reg_loss: 21437.4869; val_edge_recon_loss: 1335761.0954; val_gene_expr_recon_loss: 1828693.6422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3185892.2099; val_optim_loss: 3185892.2099
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9726; val_auprc_score: 0.9883; val_best_acc_score: 0.9468; val_best_f1_score: 0.9651; train_kl_reg_loss: 29480.5155; train_edge_recon_loss: 1314799.8071; train_gene_expr_recon_loss: 1891337.3599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3235617.6800; train_optim_loss: 3235617.6800; val_kl_reg_loss: 29270.9340; val_edge_recon_loss: 1346577.0272; val_gene_expr_recon_loss: 1898254.6350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3274102.5964; val_optim_loss: 3274102.5964
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9708; val_auprc_score: 0.9872; val_best_acc_score: 0.9464; val_best_f1_score: 0.9649; train_kl_reg_loss: 21367.1630; train_edge_recon_loss: 1314449.0936; train_gene_expr_recon_loss: 1810392.9834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146209.2460; train_optim_loss: 3146209.2460; val_kl_reg_loss: 21411.6265; val_edge_recon_loss: 1338920.3206; val_gene_expr_recon_loss: 1827948.7328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3188280.6718; val_optim_loss: 3188280.6718
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9722; val_auprc_score: 0.9878; val_best_acc_score: 0.9477; val_best_f1_score: 0.9656; train_kl_reg_loss: 21340.5931; train_edge_recon_loss: 1312481.0968; train_gene_expr_recon_loss: 1809744.7237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3143566.4116; train_optim_loss: 3143566.4116; val_kl_reg_loss: 21436.5122; val_edge_recon_loss: 1347171.5840; val_gene_expr_recon_loss: 1829110.8044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3197718.9179; val_optim_loss: 3197718.9179
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9735; val_auprc_score: 0.9886; val_best_acc_score: 0.9476; val_best_f1_score: 0.9656; train_kl_reg_loss: 29058.1810; train_edge_recon_loss: 1319623.6196; train_gene_expr_recon_loss: 1871180.1288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3219861.9298; train_optim_loss: 3219861.9298; val_kl_reg_loss: 28965.1227; val_edge_recon_loss: 1343459.8788; val_gene_expr_recon_loss: 1885650.1737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3258075.1870; val_optim_loss: 3258075.1870
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9720; val_auprc_score: 0.9878; val_best_acc_score: 0.9459; val_best_f1_score: 0.9644; train_kl_reg_loss: 21349.1688; train_edge_recon_loss: 1310777.8491; train_gene_expr_recon_loss: 1810903.0883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3143030.1058; train_optim_loss: 3143030.1058; val_kl_reg_loss: 21426.7951; val_edge_recon_loss: 1344866.2729; val_gene_expr_recon_loss: 1827795.8588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3194088.9141; val_optim_loss: 3194088.9141
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9733; val_auprc_score: 0.9887; val_best_acc_score: 0.9462; val_best_f1_score: 0.9647; train_kl_reg_loss: 28796.6455; train_edge_recon_loss: 1318902.7256; train_gene_expr_recon_loss: 1858339.5135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3206038.8832; train_optim_loss: 3206038.8832; val_kl_reg_loss: 28714.9829; val_edge_recon_loss: 1354330.1694; val_gene_expr_recon_loss: 1871977.3745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3255022.5248; val_optim_loss: 3255022.5248
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9733; val_auprc_score: 0.9883; val_best_acc_score: 0.9476; val_best_f1_score: 0.9656; train_kl_reg_loss: 21335.0970; train_edge_recon_loss: 1312997.3792; train_gene_expr_recon_loss: 1808798.0776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3143130.5546; train_optim_loss: 3143130.5546; val_kl_reg_loss: 21369.5942; val_edge_recon_loss: 1339011.6097; val_gene_expr_recon_loss: 1829977.6508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3190358.8626; val_optim_loss: 3190358.8626

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9705; val_auprc_score: 0.9868; val_best_acc_score: 0.9467; val_best_f1_score: 0.9651; train_kl_reg_loss: 21303.6625; train_edge_recon_loss: 1312738.7015; train_gene_expr_recon_loss: 1809350.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3143393.3520; train_optim_loss: 3143393.3520; val_kl_reg_loss: 21370.6295; val_edge_recon_loss: 1341273.7309; val_gene_expr_recon_loss: 1828578.2281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3191222.5802; val_optim_loss: 3191222.5802
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9745; val_auprc_score: 0.9892; val_best_acc_score: 0.9470; val_best_f1_score: 0.9653; train_kl_reg_loss: 28300.1982; train_edge_recon_loss: 1314901.4632; train_gene_expr_recon_loss: 1848930.0316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3192131.6910; train_optim_loss: 3192131.6910; val_kl_reg_loss: 28035.9887; val_edge_recon_loss: 1347639.6152; val_gene_expr_recon_loss: 1864500.7548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3240176.3645; val_optim_loss: 3240176.3645
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9721; val_auprc_score: 0.9878; val_best_acc_score: 0.9472; val_best_f1_score: 0.9654; train_kl_reg_loss: 21301.9534; train_edge_recon_loss: 1309984.7477; train_gene_expr_recon_loss: 1809779.0860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141065.7916; train_optim_loss: 3141065.7916; val_kl_reg_loss: 21357.5230; val_edge_recon_loss: 1344182.9656; val_gene_expr_recon_loss: 1827931.0668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3193471.5573; val_optim_loss: 3193471.5573
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9714; val_auprc_score: 0.9874; val_best_acc_score: 0.9469; val_best_f1_score: 0.9652; train_kl_reg_loss: 21299.7804; train_edge_recon_loss: 1309947.7319; train_gene_expr_recon_loss: 1809839.0118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141086.5217; train_optim_loss: 3141086.5217; val_kl_reg_loss: 21372.6396; val_edge_recon_loss: 1335044.2586; val_gene_expr_recon_loss: 1824291.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3180708.8244; val_optim_loss: 3180708.8244
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9745; val_auprc_score: 0.9888; val_best_acc_score: 0.9488; val_best_f1_score: 0.9664; train_kl_reg_loss: 27844.7634; train_edge_recon_loss: 1317273.1720; train_gene_expr_recon_loss: 1843241.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3188359.1557; train_optim_loss: 3188359.1557; val_kl_reg_loss: 27593.1003; val_edge_recon_loss: 1350819.6102; val_gene_expr_recon_loss: 1859587.4785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3238000.1918; val_optim_loss: 3238000.1918
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9707; val_auprc_score: 0.9871; val_best_acc_score: 0.9462; val_best_f1_score: 0.9647; train_kl_reg_loss: 21307.3423; train_edge_recon_loss: 1312515.3051; train_gene_expr_recon_loss: 1810163.5227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3143986.1748; train_optim_loss: 3143986.1748; val_kl_reg_loss: 21380.3626; val_edge_recon_loss: 1337191.7948; val_gene_expr_recon_loss: 1828316.6317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3186888.8015; val_optim_loss: 3186888.8015
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9731; val_auprc_score: 0.9882; val_best_acc_score: 0.9484; val_best_f1_score: 0.9661; train_kl_reg_loss: 27463.8050; train_edge_recon_loss: 1318560.8214; train_gene_expr_recon_loss: 1837903.7983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3183928.4207; train_optim_loss: 3183928.4207; val_kl_reg_loss: 27628.0196; val_edge_recon_loss: 1351066.8993; val_gene_expr_recon_loss: 1853906.5344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3232601.4609; val_optim_loss: 3232601.4609
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9726; val_auprc_score: 0.9880; val_best_acc_score: 0.9474; val_best_f1_score: 0.9654; train_kl_reg_loss: 21299.2945; train_edge_recon_loss: 1311178.8347; train_gene_expr_recon_loss: 1810327.0097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3142805.1402; train_optim_loss: 3142805.1402; val_kl_reg_loss: 21357.6710; val_edge_recon_loss: 1342657.6889; val_gene_expr_recon_loss: 1828826.2948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3192841.6565; val_optim_loss: 3192841.6565
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9723; val_auprc_score: 0.9878; val_best_acc_score: 0.9471; val_best_f1_score: 0.9653; train_kl_reg_loss: 21293.7994; train_edge_recon_loss: 1310954.1945; train_gene_expr_recon_loss: 1809649.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141897.0854; train_optim_loss: 3141897.0854; val_kl_reg_loss: 21354.8516; val_edge_recon_loss: 1337982.3034; val_gene_expr_recon_loss: 1825990.7977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3185327.9504; val_optim_loss: 3185327.9504
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9735; val_auprc_score: 0.9883; val_best_acc_score: 0.9478; val_best_f1_score: 0.9656; train_kl_reg_loss: 27112.2485; train_edge_recon_loss: 1316413.6956; train_gene_expr_recon_loss: 1832955.4027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3176481.3475; train_optim_loss: 3176481.3475; val_kl_reg_loss: 26962.2941; val_edge_recon_loss: 1355572.1765; val_gene_expr_recon_loss: 1850361.6498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3232896.1183; val_optim_loss: 3232896.1183
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9719; val_auprc_score: 0.9877; val_best_acc_score: 0.9471; val_best_f1_score: 0.9653; train_kl_reg_loss: 21296.2425; train_edge_recon_loss: 1306970.8772; train_gene_expr_recon_loss: 1809469.8567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3137736.9785; train_optim_loss: 3137736.9785; val_kl_reg_loss: 21356.2295; val_edge_recon_loss: 1338294.1450; val_gene_expr_recon_loss: 1826905.8454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3186556.2137; val_optim_loss: 3186556.2137

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9725; val_auprc_score: 0.9879; val_best_acc_score: 0.9471; val_best_f1_score: 0.9653; train_kl_reg_loss: 21291.1579; train_edge_recon_loss: 1310404.4798; train_gene_expr_recon_loss: 1809591.0126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141286.6480; train_optim_loss: 3141286.6480; val_kl_reg_loss: 21345.0821; val_edge_recon_loss: 1334564.9141; val_gene_expr_recon_loss: 1827309.5153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3183219.5191; val_optim_loss: 3183219.5191
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9737; val_auprc_score: 0.9886; val_best_acc_score: 0.9483; val_best_f1_score: 0.9661; train_kl_reg_loss: 26938.4967; train_edge_recon_loss: 1314523.9488; train_gene_expr_recon_loss: 1829274.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3170737.1703; train_optim_loss: 3170737.1703; val_kl_reg_loss: 26854.5598; val_edge_recon_loss: 1344274.0100; val_gene_expr_recon_loss: 1848215.7634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3219344.3311; val_optim_loss: 3219344.3311
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9715; val_auprc_score: 0.9874; val_best_acc_score: 0.9467; val_best_f1_score: 0.9649; train_kl_reg_loss: 21289.2519; train_edge_recon_loss: 1310569.6262; train_gene_expr_recon_loss: 1809203.3225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141062.2001; train_optim_loss: 3141062.2001; val_kl_reg_loss: 21355.9849; val_edge_recon_loss: 1344258.4828; val_gene_expr_recon_loss: 1826774.6899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3192389.1527; val_optim_loss: 3192389.1527
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9741; val_auprc_score: 0.9889; val_best_acc_score: 0.9485; val_best_f1_score: 0.9662; train_kl_reg_loss: 26641.4498; train_edge_recon_loss: 1314087.6546; train_gene_expr_recon_loss: 1825761.3760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166490.4780; train_optim_loss: 3166490.4780; val_kl_reg_loss: 26360.1265; val_edge_recon_loss: 1339105.5666; val_gene_expr_recon_loss: 1847938.9055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3213404.5916; val_optim_loss: 3213404.5916
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9717; val_auprc_score: 0.9876; val_best_acc_score: 0.9470; val_best_f1_score: 0.9653; train_kl_reg_loss: 21286.5005; train_edge_recon_loss: 1311640.5277; train_gene_expr_recon_loss: 1808446.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141374.0011; train_optim_loss: 3141374.0011; val_kl_reg_loss: 21358.6270; val_edge_recon_loss: 1331894.0305; val_gene_expr_recon_loss: 1830255.1861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3183507.8397; val_optim_loss: 3183507.8397
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9724; val_auprc_score: 0.9880; val_best_acc_score: 0.9469; val_best_f1_score: 0.9650; train_kl_reg_loss: 21289.0421; train_edge_recon_loss: 1310860.2165; train_gene_expr_recon_loss: 1809103.7533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3141253.0106; train_optim_loss: 3141253.0106; val_kl_reg_loss: 21336.4262; val_edge_recon_loss: 1351518.0496; val_gene_expr_recon_loss: 1827283.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200138.4084; val_optim_loss: 3200138.4084
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9741; val_auprc_score: 0.9886; val_best_acc_score: 0.9490; val_best_f1_score: 0.9665; train_kl_reg_loss: 26389.4020; train_edge_recon_loss: 1315150.9247; train_gene_expr_recon_loss: 1825424.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166965.2298; train_optim_loss: 3166965.2298; val_kl_reg_loss: 26511.6442; val_edge_recon_loss: 1337206.3142; val_gene_expr_recon_loss: 1843971.9962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3207689.9561; val_optim_loss: 3207689.9561

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 387 min 49 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9718
val AUPRC score: 0.9877
val best accuracy score: 0.9469
val best F1 score: 0.9653
val target rna MSE score: 0.6148
val source rna MSE score: 0.1123
Val cat covariate0 mean sim diff: -0.0011
Val cat covariate1 mean sim diff: -0.0843
Duration of model training in run 2: 6 hours, 29 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 602179
Number of validation edges: 66908
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9373; val_auprc_score: 0.9723; val_best_acc_score: 0.9103; val_best_f1_score: 0.9421; train_kl_reg_loss: 17097.9204; train_edge_recon_loss: 1391526.1527; train_gene_expr_recon_loss: 2867183.9936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4275808.0665; train_optim_loss: 4275808.0665; val_kl_reg_loss: 12898.5493; val_edge_recon_loss: 1360006.3721; val_gene_expr_recon_loss: 2632256.1813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4005161.1050; val_optim_loss: 4005161.1050
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9732; val_auprc_score: 0.9882; val_best_acc_score: 0.9485; val_best_f1_score: 0.9662; train_kl_reg_loss: 26319.6763; train_edge_recon_loss: 1314482.6417; train_gene_expr_recon_loss: 1821729.8174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3162532.1337; train_optim_loss: 3162532.1337; val_kl_reg_loss: 26369.9164; val_edge_recon_loss: 1351804.9919; val_gene_expr_recon_loss: 1841351.7996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3219526.7004; val_optim_loss: 3219526.7004
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9544; val_auprc_score: 0.9799; val_best_acc_score: 0.9265; val_best_f1_score: 0.9521; train_kl_reg_loss: 13461.3035; train_edge_recon_loss: 1331952.1486; train_gene_expr_recon_loss: 2494268.3728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3839681.8309; train_optim_loss: 3839681.8309; val_kl_reg_loss: 13930.8057; val_edge_recon_loss: 1356281.5172; val_gene_expr_recon_loss: 2354951.2137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3725163.5267; val_optim_loss: 3725163.5267
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9549; val_auprc_score: 0.9787; val_best_acc_score: 0.9306; val_best_f1_score: 0.9546; train_kl_reg_loss: 15179.4351; train_edge_recon_loss: 1321980.6859; train_gene_expr_recon_loss: 2254752.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3591913.0166; train_optim_loss: 3591913.0166; val_kl_reg_loss: 16481.5438; val_edge_recon_loss: 1362279.0725; val_gene_expr_recon_loss: 2170980.0372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3549740.6584; val_optim_loss: 3549740.6584
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9738; val_auprc_score: 0.9885; val_best_acc_score: 0.9487; val_best_f1_score: 0.9663; train_kl_reg_loss: 26011.1755; train_edge_recon_loss: 1316723.9894; train_gene_expr_recon_loss: 1820267.4501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3163002.6151; train_optim_loss: 3163002.6151; val_kl_reg_loss: 26075.0342; val_edge_recon_loss: 1345161.5372; val_gene_expr_recon_loss: 1840349.8736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3211586.4427; val_optim_loss: 3211586.4427
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9577; val_auprc_score: 0.9803; val_best_acc_score: 0.9315; val_best_f1_score: 0.9551; train_kl_reg_loss: 16883.1685; train_edge_recon_loss: 1322857.6317; train_gene_expr_recon_loss: 2120947.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3460688.3828; train_optim_loss: 3460688.3828; val_kl_reg_loss: 18024.1029; val_edge_recon_loss: 1367218.4618; val_gene_expr_recon_loss: 2078963.4828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3464206.0496; val_optim_loss: 3464206.0496
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9590; val_auprc_score: 0.9812; val_best_acc_score: 0.9341; val_best_f1_score: 0.9568; train_kl_reg_loss: 17832.7287; train_edge_recon_loss: 1320419.5100; train_gene_expr_recon_loss: 2047597.3135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3385849.5501; train_optim_loss: 3385849.5501; val_kl_reg_loss: 18523.6336; val_edge_recon_loss: 1352331.3931; val_gene_expr_recon_loss: 2021480.1765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3392335.2023; val_optim_loss: 3392335.2023
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9741; val_auprc_score: 0.9881; val_best_acc_score: 0.9494; val_best_f1_score: 0.9667; train_kl_reg_loss: 25832.8187; train_edge_recon_loss: 1313507.0406; train_gene_expr_recon_loss: 1818606.9192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157946.7806; train_optim_loss: 3157946.7806; val_kl_reg_loss: 25968.9427; val_edge_recon_loss: 1352956.6004; val_gene_expr_recon_loss: 1840148.7385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3219074.2824; val_optim_loss: 3219074.2824
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9597; val_auprc_score: 0.9814; val_best_acc_score: 0.9357; val_best_f1_score: 0.9580; train_kl_reg_loss: 18432.8830; train_edge_recon_loss: 1318915.5424; train_gene_expr_recon_loss: 2006126.9051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3343475.3369; train_optim_loss: 3343475.3369; val_kl_reg_loss: 18995.6361; val_edge_recon_loss: 1347530.0573; val_gene_expr_recon_loss: 1993108.1861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3359633.8855; val_optim_loss: 3359633.8855
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9637; val_auprc_score: 0.9840; val_best_acc_score: 0.9378; val_best_f1_score: 0.9593; train_kl_reg_loss: 18882.6278; train_edge_recon_loss: 1319563.5606; train_gene_expr_recon_loss: 1976807.7297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3315253.9189; train_optim_loss: 3315253.9189; val_kl_reg_loss: 18881.4330; val_edge_recon_loss: 1344663.8616; val_gene_expr_recon_loss: 1970899.3931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3334444.6985; val_optim_loss: 3334444.6985
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9739; val_auprc_score: 0.9884; val_best_acc_score: 0.9495; val_best_f1_score: 0.9667; train_kl_reg_loss: 25691.9680; train_edge_recon_loss: 1313377.2723; train_gene_expr_recon_loss: 1818186.8430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3157256.0805; train_optim_loss: 3157256.0805; val_kl_reg_loss: 25524.0394; val_edge_recon_loss: 1347747.9647; val_gene_expr_recon_loss: 1838600.0997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3211872.1078; val_optim_loss: 3211872.1078
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9637; val_auprc_score: 0.9829; val_best_acc_score: 0.9379; val_best_f1_score: 0.9593; train_kl_reg_loss: 19267.8402; train_edge_recon_loss: 1316427.0856; train_gene_expr_recon_loss: 1960807.3901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3296502.3129; train_optim_loss: 3296502.3129; val_kl_reg_loss: 19774.0253; val_edge_recon_loss: 1353378.0248; val_gene_expr_recon_loss: 1959534.3826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3332686.4237; val_optim_loss: 3332686.4237
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9649; val_auprc_score: 0.9841; val_best_acc_score: 0.9400; val_best_f1_score: 0.9607; train_kl_reg_loss: 19482.2627; train_edge_recon_loss: 1318028.7662; train_gene_expr_recon_loss: 1944075.9079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3281586.9342; train_optim_loss: 3281586.9342; val_kl_reg_loss: 19599.8225; val_edge_recon_loss: 1348884.6155; val_gene_expr_recon_loss: 1948093.8044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316578.2595; val_optim_loss: 3316578.2595
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9639; val_auprc_score: 0.9833; val_best_acc_score: 0.9390; val_best_f1_score: 0.9601; train_kl_reg_loss: 19688.6639; train_edge_recon_loss: 1317414.3738; train_gene_expr_recon_loss: 1932072.7258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269175.7627; train_optim_loss: 3269175.7627; val_kl_reg_loss: 19997.1325; val_edge_recon_loss: 1351853.7739; val_gene_expr_recon_loss: 1940457.0363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3312307.9351; val_optim_loss: 3312307.9351

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9738; val_auprc_score: 0.9885; val_best_acc_score: 0.9493; val_best_f1_score: 0.9667; train_kl_reg_loss: 25355.9684; train_edge_recon_loss: 1311127.4444; train_gene_expr_recon_loss: 1812498.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3148982.0663; train_optim_loss: 3148982.0663; val_kl_reg_loss: 25503.6039; val_edge_recon_loss: 1342856.2693; val_gene_expr_recon_loss: 1834811.5906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3203171.4628; val_optim_loss: 3203171.4628
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9649; val_auprc_score: 0.9841; val_best_acc_score: 0.9399; val_best_f1_score: 0.9607; train_kl_reg_loss: 19933.1761; train_edge_recon_loss: 1318325.9151; train_gene_expr_recon_loss: 1925658.9468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3263918.0412; train_optim_loss: 3263918.0412; val_kl_reg_loss: 20153.8211; val_edge_recon_loss: 1352072.1269; val_gene_expr_recon_loss: 1931340.3321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303566.2824; val_optim_loss: 3303566.2824
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9506; val_auprc_score: 0.9768; val_best_acc_score: 0.9260; val_best_f1_score: 0.9518; train_kl_reg_loss: 18782.3956; train_edge_recon_loss: 1326483.6602; train_gene_expr_recon_loss: 2151503.0858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3496769.1402; train_optim_loss: 3496769.1402; val_kl_reg_loss: 14706.2022; val_edge_recon_loss: 1351671.1393; val_gene_expr_recon_loss: 2438851.9962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3805229.3282; val_optim_loss: 3805229.3282
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9744; val_auprc_score: 0.9887; val_best_acc_score: 0.9488; val_best_f1_score: 0.9664; train_kl_reg_loss: 25327.8343; train_edge_recon_loss: 1312554.7507; train_gene_expr_recon_loss: 1811930.7963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3149813.3837; train_optim_loss: 3149813.3837; val_kl_reg_loss: 25442.9741; val_edge_recon_loss: 1348196.8039; val_gene_expr_recon_loss: 1835213.9924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3208853.7710; val_optim_loss: 3208853.7710
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9602; val_auprc_score: 0.9821; val_best_acc_score: 0.9353; val_best_f1_score: 0.9579; train_kl_reg_loss: 17180.5409; train_edge_recon_loss: 1317052.8372; train_gene_expr_recon_loss: 2235554.9261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3569788.3014; train_optim_loss: 3569788.3014; val_kl_reg_loss: 19082.0004; val_edge_recon_loss: 1352582.3025; val_gene_expr_recon_loss: 2137067.8683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3508732.1679; val_optim_loss: 3508732.1679
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9665; val_auprc_score: 0.9854; val_best_acc_score: 0.9390; val_best_f1_score: 0.9601; train_kl_reg_loss: 19388.3272; train_edge_recon_loss: 1315156.7192; train_gene_expr_recon_loss: 2086275.8634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3420820.9102; train_optim_loss: 3420820.9102; val_kl_reg_loss: 19522.9777; val_edge_recon_loss: 1348870.5191; val_gene_expr_recon_loss: 2053553.4380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3421946.9237; val_optim_loss: 3421946.9237
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9747; val_auprc_score: 0.9889; val_best_acc_score: 0.9494; val_best_f1_score: 0.9667; train_kl_reg_loss: 25298.8412; train_edge_recon_loss: 1312315.7949; train_gene_expr_recon_loss: 1811940.2840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3149554.9239; train_optim_loss: 3149554.9239; val_kl_reg_loss: 25375.6388; val_edge_recon_loss: 1342408.0549; val_gene_expr_recon_loss: 1834673.8507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3202457.5391; val_optim_loss: 3202457.5391
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9653; val_auprc_score: 0.9849; val_best_acc_score: 0.9380; val_best_f1_score: 0.9593; train_kl_reg_loss: 19755.4769; train_edge_recon_loss: 1313814.0485; train_gene_expr_recon_loss: 2022127.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3355697.3828; train_optim_loss: 3355697.3828; val_kl_reg_loss: 19955.8901; val_edge_recon_loss: 1357837.6031; val_gene_expr_recon_loss: 2005034.0601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3382827.5534; val_optim_loss: 3382827.5534

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9677; val_auprc_score: 0.9861; val_best_acc_score: 0.9404; val_best_f1_score: 0.9610; train_kl_reg_loss: 19493.7134; train_edge_recon_loss: 1312524.7393; train_gene_expr_recon_loss: 1976752.2387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3308770.6905; train_optim_loss: 3308770.6905; val_kl_reg_loss: 19572.8751; val_edge_recon_loss: 1344236.2557; val_gene_expr_recon_loss: 1984963.5945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3348772.7347; val_optim_loss: 3348772.7347
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9738; val_auprc_score: 0.9883; val_best_acc_score: 0.9487; val_best_f1_score: 0.9663; train_kl_reg_loss: 25270.4998; train_edge_recon_loss: 1313742.0308; train_gene_expr_recon_loss: 1810875.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3149888.2345; train_optim_loss: 3149888.2345; val_kl_reg_loss: 25353.4374; val_edge_recon_loss: 1351526.6684; val_gene_expr_recon_loss: 1832957.7581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3209837.8760; val_optim_loss: 3209837.8760
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9685; val_auprc_score: 0.9863; val_best_acc_score: 0.9416; val_best_f1_score: 0.9616; train_kl_reg_loss: 19430.0822; train_edge_recon_loss: 1313731.4693; train_gene_expr_recon_loss: 1968451.0780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3301612.6283; train_optim_loss: 3301612.6283; val_kl_reg_loss: 19538.8740; val_edge_recon_loss: 1341886.4580; val_gene_expr_recon_loss: 1976923.6708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3338348.9962; val_optim_loss: 3338348.9962
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9675; val_auprc_score: 0.9857; val_best_acc_score: 0.9414; val_best_f1_score: 0.9615; train_kl_reg_loss: 19485.7395; train_edge_recon_loss: 1313372.6429; train_gene_expr_recon_loss: 1961451.2772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3294309.6568; train_optim_loss: 3294309.6568; val_kl_reg_loss: 19590.5861; val_edge_recon_loss: 1348787.9055; val_gene_expr_recon_loss: 1967860.2338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3336238.7271; val_optim_loss: 3336238.7271
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9733; val_auprc_score: 0.9883; val_best_acc_score: 0.9488; val_best_f1_score: 0.9664; train_kl_reg_loss: 25248.4838; train_edge_recon_loss: 1314508.4895; train_gene_expr_recon_loss: 1812429.3483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3152186.3247; train_optim_loss: 3152186.3247; val_kl_reg_loss: 25340.3355; val_edge_recon_loss: 1337264.2648; val_gene_expr_recon_loss: 1833167.4265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3195772.0219; val_optim_loss: 3195772.0219
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9673; val_auprc_score: 0.9856; val_best_acc_score: 0.9421; val_best_f1_score: 0.9621; train_kl_reg_loss: 19532.4272; train_edge_recon_loss: 1310846.0290; train_gene_expr_recon_loss: 1954100.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3284478.5376; train_optim_loss: 3284478.5376; val_kl_reg_loss: 19569.4952; val_edge_recon_loss: 1341017.9962; val_gene_expr_recon_loss: 1962030.3645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3322617.8664; val_optim_loss: 3322617.8664

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 118 min 9 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
val AUROC score: 0.9663
val AUPRC score: 0.9851
val best accuracy score: 0.9413
val best F1 score: 0.9616
val target rna MSE score: 0.7654
val source rna MSE score: 0.1280
Val cat covariate0 mean sim diff: 0.0007
Val cat covariate1 mean sim diff: -0.0787
Duration of model training in run 1: 2 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9750; val_auprc_score: 0.9891; val_best_acc_score: 0.9503; val_best_f1_score: 0.9673; train_kl_reg_loss: 25205.8789; train_edge_recon_loss: 1313544.5461; train_gene_expr_recon_loss: 1810909.6417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3149660.0679; train_optim_loss: 3149660.0679; val_kl_reg_loss: 25321.1819; val_edge_recon_loss: 1347793.5911; val_gene_expr_recon_loss: 1831718.5162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3204833.2824; val_optim_loss: 3204833.2824
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9741; val_auprc_score: 0.9886; val_best_acc_score: 0.9498; val_best_f1_score: 0.9670; train_kl_reg_loss: 25202.2789; train_edge_recon_loss: 1314127.4297; train_gene_expr_recon_loss: 1810784.7603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3150114.4691; train_optim_loss: 3150114.4691; val_kl_reg_loss: 25326.0201; val_edge_recon_loss: 1338374.7538; val_gene_expr_recon_loss: 1834002.4823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3197703.2519; val_optim_loss: 3197703.2519
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9741; val_auprc_score: 0.9886; val_best_acc_score: 0.9490; val_best_f1_score: 0.9665; train_kl_reg_loss: 25193.9138; train_edge_recon_loss: 1314700.2285; train_gene_expr_recon_loss: 1810620.4997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3150514.6397; train_optim_loss: 3150514.6397; val_kl_reg_loss: 25278.7289; val_edge_recon_loss: 1343633.7600; val_gene_expr_recon_loss: 1834102.3573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3203014.8483; val_optim_loss: 3203014.8483
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9743; val_auprc_score: 0.9888; val_best_acc_score: 0.9498; val_best_f1_score: 0.9671; train_kl_reg_loss: 25162.8136; train_edge_recon_loss: 1316227.9402; train_gene_expr_recon_loss: 1810183.9059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3151574.6584; train_optim_loss: 3151574.6584; val_kl_reg_loss: 25277.2364; val_edge_recon_loss: 1335509.7777; val_gene_expr_recon_loss: 1833355.1827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3194142.1918; val_optim_loss: 3194142.1918
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9746; val_auprc_score: 0.9890; val_best_acc_score: 0.9490; val_best_f1_score: 0.9665; train_kl_reg_loss: 25186.0327; train_edge_recon_loss: 1316644.6842; train_gene_expr_recon_loss: 1811890.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3153720.8503; train_optim_loss: 3153720.8503; val_kl_reg_loss: 25322.8905; val_edge_recon_loss: 1346248.7958; val_gene_expr_recon_loss: 1831979.2719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3203550.9523; val_optim_loss: 3203550.9523
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9739; val_auprc_score: 0.9886; val_best_acc_score: 0.9493; val_best_f1_score: 0.9666; train_kl_reg_loss: 25130.0287; train_edge_recon_loss: 1315579.9259; train_gene_expr_recon_loss: 1810188.1581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3150898.1119; train_optim_loss: 3150898.1119; val_kl_reg_loss: 25209.9247; val_edge_recon_loss: 1345204.5081; val_gene_expr_recon_loss: 1833682.4318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3204096.8702; val_optim_loss: 3204096.8702
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9748; val_auprc_score: 0.9890; val_best_acc_score: 0.9500; val_best_f1_score: 0.9671; train_kl_reg_loss: 25079.3543; train_edge_recon_loss: 1312897.1592; train_gene_expr_recon_loss: 1810196.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3148173.3751; train_optim_loss: 3148173.3751; val_kl_reg_loss: 25163.5444; val_edge_recon_loss: 1346052.6846; val_gene_expr_recon_loss: 1832464.9666; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3203681.1994; val_optim_loss: 3203681.1994
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9747; val_auprc_score: 0.9890; val_best_acc_score: 0.9501; val_best_f1_score: 0.9673; train_kl_reg_loss: 25011.6054; train_edge_recon_loss: 1311623.4187; train_gene_expr_recon_loss: 1809735.7332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146370.7599; train_optim_loss: 3146370.7599; val_kl_reg_loss: 25133.8140; val_edge_recon_loss: 1332423.1002; val_gene_expr_recon_loss: 1832515.3421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3190072.2519; val_optim_loss: 3190072.2519
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9743; val_auprc_score: 0.9885; val_best_acc_score: 0.9497; val_best_f1_score: 0.9669; train_kl_reg_loss: 24979.1609; train_edge_recon_loss: 1313695.5691; train_gene_expr_recon_loss: 1809573.6847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3148248.4168; train_optim_loss: 3148248.4168; val_kl_reg_loss: 25156.2905; val_edge_recon_loss: 1344291.0687; val_gene_expr_recon_loss: 1832694.3998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3202141.7595; val_optim_loss: 3202141.7595
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9748; val_auprc_score: 0.9891; val_best_acc_score: 0.9496; val_best_f1_score: 0.9669; train_kl_reg_loss: 24979.4276; train_edge_recon_loss: 1312532.1745; train_gene_expr_recon_loss: 1809642.0006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3147153.6043; train_optim_loss: 3147153.6043; val_kl_reg_loss: 25057.1736; val_edge_recon_loss: 1340875.9590; val_gene_expr_recon_loss: 1831471.4055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3197404.5429; val_optim_loss: 3197404.5429
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9742; val_auprc_score: 0.9886; val_best_acc_score: 0.9491; val_best_f1_score: 0.9666; train_kl_reg_loss: 24999.4099; train_edge_recon_loss: 1315367.8686; train_gene_expr_recon_loss: 1809531.7181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3149898.9955; train_optim_loss: 3149898.9955; val_kl_reg_loss: 25130.2725; val_edge_recon_loss: 1334183.3822; val_gene_expr_recon_loss: 1833027.6651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3192341.3311; val_optim_loss: 3192341.3311
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9741; val_auprc_score: 0.9887; val_best_acc_score: 0.9497; val_best_f1_score: 0.9670; train_kl_reg_loss: 24981.1423; train_edge_recon_loss: 1314047.7226; train_gene_expr_recon_loss: 1809247.3455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3148276.2109; train_optim_loss: 3148276.2109; val_kl_reg_loss: 25087.5424; val_edge_recon_loss: 1341415.5959; val_gene_expr_recon_loss: 1832244.8144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3198747.9389; val_optim_loss: 3198747.9389

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9739; val_auprc_score: 0.9886; val_best_acc_score: 0.9491; val_best_f1_score: 0.9666; train_kl_reg_loss: 24952.6654; train_edge_recon_loss: 1311445.5574; train_gene_expr_recon_loss: 1809318.5101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3145716.7318; train_optim_loss: 3145716.7318; val_kl_reg_loss: 25050.6102; val_edge_recon_loss: 1341567.1260; val_gene_expr_recon_loss: 1833088.4351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3199706.1708; val_optim_loss: 3199706.1708
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9751; val_auprc_score: 0.9891; val_best_acc_score: 0.9503; val_best_f1_score: 0.9674; train_kl_reg_loss: 24939.8569; train_edge_recon_loss: 1313543.6330; train_gene_expr_recon_loss: 1808439.8200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146923.3092; train_optim_loss: 3146923.3092; val_kl_reg_loss: 25052.6333; val_edge_recon_loss: 1343148.4427; val_gene_expr_recon_loss: 1831717.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3199918.8511; val_optim_loss: 3199918.8511
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9745; val_auprc_score: 0.9889; val_best_acc_score: 0.9497; val_best_f1_score: 0.9669; train_kl_reg_loss: 24934.9120; train_edge_recon_loss: 1311817.5978; train_gene_expr_recon_loss: 1808730.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3145482.5571; train_optim_loss: 3145482.5571; val_kl_reg_loss: 25057.4849; val_edge_recon_loss: 1340954.3430; val_gene_expr_recon_loss: 1829242.7075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3195254.5420; val_optim_loss: 3195254.5420
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9753; val_auprc_score: 0.9894; val_best_acc_score: 0.9503; val_best_f1_score: 0.9674; train_kl_reg_loss: 24934.9978; train_edge_recon_loss: 1311945.3380; train_gene_expr_recon_loss: 1809257.5295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3146137.8679; train_optim_loss: 3146137.8679; val_kl_reg_loss: 25049.2529; val_edge_recon_loss: 1334913.9933; val_gene_expr_recon_loss: 1830448.5248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3190411.7719; val_optim_loss: 3190411.7719

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 706 min 10 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9737
val AUPRC score: 0.9883
val best accuracy score: 0.9489
val best F1 score: 0.9664
val target rna MSE score: 0.5924
val source rna MSE score: 0.1124
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0854
Duration of model training in run 2: 11 hours, 50 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 254146
Number of validation nodes: 28238
Number of training edges: 602179
Number of validation edges: 66908
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9410; val_auprc_score: 0.9733; val_best_acc_score: 0.9140; val_best_f1_score: 0.9440; train_kl_reg_loss: 15013.4046; train_edge_recon_loss: 1370012.6112; train_gene_expr_recon_loss: 2729475.2042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4114501.2206; train_optim_loss: 4114501.2206; val_kl_reg_loss: 14482.8644; val_edge_recon_loss: 1379894.3392; val_gene_expr_recon_loss: 2461727.7319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3856104.9370; val_optim_loss: 3856104.9370
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9487; val_auprc_score: 0.9773; val_best_acc_score: 0.9226; val_best_f1_score: 0.9496; train_kl_reg_loss: 15929.1935; train_edge_recon_loss: 1327185.5677; train_gene_expr_recon_loss: 2307348.0082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3650462.7691; train_optim_loss: 3650462.7691; val_kl_reg_loss: 17239.0537; val_edge_recon_loss: 1365525.4761; val_gene_expr_recon_loss: 2192584.7595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3575349.2872; val_optim_loss: 3575349.2872
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9589; val_auprc_score: 0.9822; val_best_acc_score: 0.9291; val_best_f1_score: 0.9536; train_kl_reg_loss: 18092.4164; train_edge_recon_loss: 1326961.8767; train_gene_expr_recon_loss: 2117753.2152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3462807.5079; train_optim_loss: 3462807.5079; val_kl_reg_loss: 19183.8273; val_edge_recon_loss: 1362957.8073; val_gene_expr_recon_loss: 2071742.8201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3453884.4523; val_optim_loss: 3453884.4523
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9589; val_auprc_score: 0.9815; val_best_acc_score: 0.9323; val_best_f1_score: 0.9558; train_kl_reg_loss: 19680.6988; train_edge_recon_loss: 1323020.0347; train_gene_expr_recon_loss: 2035968.5126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3378669.2455; train_optim_loss: 3378669.2455; val_kl_reg_loss: 20768.0306; val_edge_recon_loss: 1356072.0401; val_gene_expr_recon_loss: 2022515.1565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3399355.2281; val_optim_loss: 3399355.2281
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9612; val_auprc_score: 0.9825; val_best_acc_score: 0.9350; val_best_f1_score: 0.9573; train_kl_reg_loss: 20562.0543; train_edge_recon_loss: 1317900.8441; train_gene_expr_recon_loss: 1995971.0812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3334433.9820; train_optim_loss: 3334433.9820; val_kl_reg_loss: 21239.0720; val_edge_recon_loss: 1359242.1174; val_gene_expr_recon_loss: 2005299.8173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3385781.0048; val_optim_loss: 3385781.0048
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9595; val_auprc_score: 0.9812; val_best_acc_score: 0.9355; val_best_f1_score: 0.9579; train_kl_reg_loss: 21263.3281; train_edge_recon_loss: 1321902.4915; train_gene_expr_recon_loss: 1973903.2472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3317069.0680; train_optim_loss: 3317069.0680; val_kl_reg_loss: 21851.5092; val_edge_recon_loss: 1349016.0391; val_gene_expr_recon_loss: 1982149.7156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3353017.2643; val_optim_loss: 3353017.2643
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9650; val_auprc_score: 0.9849; val_best_acc_score: 0.9356; val_best_f1_score: 0.9578; train_kl_reg_loss: 21820.1939; train_edge_recon_loss: 1317700.8753; train_gene_expr_recon_loss: 1957461.2014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3296982.2682; train_optim_loss: 3296982.2682; val_kl_reg_loss: 22067.4698; val_edge_recon_loss: 1360412.2047; val_gene_expr_recon_loss: 1962997.2228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3345476.8979; val_optim_loss: 3345476.8979
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9635; val_auprc_score: 0.9832; val_best_acc_score: 0.9388; val_best_f1_score: 0.9599; train_kl_reg_loss: 22226.8764; train_edge_recon_loss: 1321199.0136; train_gene_expr_recon_loss: 1944838.7676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3288264.6566; train_optim_loss: 3288264.6566; val_kl_reg_loss: 22453.6114; val_edge_recon_loss: 1357841.8845; val_gene_expr_recon_loss: 1955729.3888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3336024.8874; val_optim_loss: 3336024.8874
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9654; val_auprc_score: 0.9843; val_best_acc_score: 0.9406; val_best_f1_score: 0.9612; train_kl_reg_loss: 22766.3720; train_edge_recon_loss: 1321984.5656; train_gene_expr_recon_loss: 1936650.4712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3281401.4091; train_optim_loss: 3281401.4091; val_kl_reg_loss: 22939.6421; val_edge_recon_loss: 1348656.4847; val_gene_expr_recon_loss: 1944021.5134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315617.6479; val_optim_loss: 3315617.6479
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9648; val_auprc_score: 0.9838; val_best_acc_score: 0.9410; val_best_f1_score: 0.9614; train_kl_reg_loss: 23026.0901; train_edge_recon_loss: 1317165.5933; train_gene_expr_recon_loss: 1925728.7831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3265920.4661; train_optim_loss: 3265920.4661; val_kl_reg_loss: 24097.0928; val_edge_recon_loss: 1345650.1489; val_gene_expr_recon_loss: 1941460.0615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3311207.3101; val_optim_loss: 3311207.3101
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9666; val_auprc_score: 0.9850; val_best_acc_score: 0.9418; val_best_f1_score: 0.9618; train_kl_reg_loss: 23350.0490; train_edge_recon_loss: 1317975.6830; train_gene_expr_recon_loss: 1920332.0636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3261657.7924; train_optim_loss: 3261657.7924; val_kl_reg_loss: 24049.9400; val_edge_recon_loss: 1347489.2791; val_gene_expr_recon_loss: 1931742.1269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3303281.3397; val_optim_loss: 3303281.3397
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9667; val_auprc_score: 0.9855; val_best_acc_score: 0.9410; val_best_f1_score: 0.9614; train_kl_reg_loss: 23667.3529; train_edge_recon_loss: 1320824.2230; train_gene_expr_recon_loss: 1912677.1681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3257168.7473; train_optim_loss: 3257168.7473; val_kl_reg_loss: 23906.9240; val_edge_recon_loss: 1347926.7362; val_gene_expr_recon_loss: 1926943.2662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3298776.9323; val_optim_loss: 3298776.9323
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9661; val_auprc_score: 0.9850; val_best_acc_score: 0.9412; val_best_f1_score: 0.9614; train_kl_reg_loss: 24195.9356; train_edge_recon_loss: 1316102.6878; train_gene_expr_recon_loss: 1905999.3695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3246297.9945; train_optim_loss: 3246297.9945; val_kl_reg_loss: 24104.0987; val_edge_recon_loss: 1356597.1028; val_gene_expr_recon_loss: 1937018.9041; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3317720.1011; val_optim_loss: 3317720.1011
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9656; val_auprc_score: 0.9845; val_best_acc_score: 0.9410; val_best_f1_score: 0.9614; train_kl_reg_loss: 24654.5428; train_edge_recon_loss: 1318115.6650; train_gene_expr_recon_loss: 1902568.8025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3245339.0126; train_optim_loss: 3245339.0126; val_kl_reg_loss: 25302.7617; val_edge_recon_loss: 1346866.3216; val_gene_expr_recon_loss: 1928407.1956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3300576.2824; val_optim_loss: 3300576.2824
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9657; val_auprc_score: 0.9845; val_best_acc_score: 0.9401; val_best_f1_score: 0.9607; train_kl_reg_loss: 25126.5159; train_edge_recon_loss: 1322100.4013; train_gene_expr_recon_loss: 1895468.2103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3242695.1303; train_optim_loss: 3242695.1303; val_kl_reg_loss: 25769.5418; val_edge_recon_loss: 1348117.9299; val_gene_expr_recon_loss: 1926584.7362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3300472.2109; val_optim_loss: 3300472.2109
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9660; val_auprc_score: 0.9849; val_best_acc_score: 0.9412; val_best_f1_score: 0.9617; train_kl_reg_loss: 25360.8333; train_edge_recon_loss: 1316202.1763; train_gene_expr_recon_loss: 1893214.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3234777.6920; train_optim_loss: 3234777.6920; val_kl_reg_loss: 25827.1453; val_edge_recon_loss: 1339230.2505; val_gene_expr_recon_loss: 1914534.1503; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3279591.5582; val_optim_loss: 3279591.5582
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9689; val_auprc_score: 0.9861; val_best_acc_score: 0.9436; val_best_f1_score: 0.9629; train_kl_reg_loss: 25525.4090; train_edge_recon_loss: 1316166.6191; train_gene_expr_recon_loss: 1887389.8878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3229081.9140; train_optim_loss: 3229081.9140; val_kl_reg_loss: 26296.8383; val_edge_recon_loss: 1345272.9008; val_gene_expr_recon_loss: 1899410.3430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3270980.0802; val_optim_loss: 3270980.0802
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9684; val_auprc_score: 0.9863; val_best_acc_score: 0.9424; val_best_f1_score: 0.9624; train_kl_reg_loss: 25689.7741; train_edge_recon_loss: 1317862.2972; train_gene_expr_recon_loss: 1880421.7485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3223973.8204; train_optim_loss: 3223973.8204; val_kl_reg_loss: 25433.7346; val_edge_recon_loss: 1348516.3588; val_gene_expr_recon_loss: 1890123.0849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3264073.1775; val_optim_loss: 3264073.1775
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9700; val_auprc_score: 0.9870; val_best_acc_score: 0.9446; val_best_f1_score: 0.9637; train_kl_reg_loss: 25762.2567; train_edge_recon_loss: 1318041.8484; train_gene_expr_recon_loss: 1880284.1670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3224088.2714; train_optim_loss: 3224088.2714; val_kl_reg_loss: 25723.9381; val_edge_recon_loss: 1346154.3607; val_gene_expr_recon_loss: 1900155.2171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3272033.5191; val_optim_loss: 3272033.5191
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9695; val_auprc_score: 0.9863; val_best_acc_score: 0.9441; val_best_f1_score: 0.9634; train_kl_reg_loss: 26100.7588; train_edge_recon_loss: 1319727.8496; train_gene_expr_recon_loss: 1873917.9674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3219746.5758; train_optim_loss: 3219746.5758; val_kl_reg_loss: 26105.8171; val_edge_recon_loss: 1347963.7042; val_gene_expr_recon_loss: 1896535.5992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3270605.1212; val_optim_loss: 3270605.1212
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9693; val_auprc_score: 0.9866; val_best_acc_score: 0.9431; val_best_f1_score: 0.9628; train_kl_reg_loss: 26219.0335; train_edge_recon_loss: 1320549.6371; train_gene_expr_recon_loss: 1875962.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3222730.8129; train_optim_loss: 3222730.8129; val_kl_reg_loss: 26793.4959; val_edge_recon_loss: 1352029.2424; val_gene_expr_recon_loss: 1886562.4604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3265385.1975; val_optim_loss: 3265385.1975
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9403; val_auprc_score: 0.9723; val_best_acc_score: 0.9148; val_best_f1_score: 0.9443; train_kl_reg_loss: 26065.0417; train_edge_recon_loss: 1326275.9011; train_gene_expr_recon_loss: 1977203.1824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329544.1263; train_optim_loss: 3329544.1263; val_kl_reg_loss: 12518.7542; val_edge_recon_loss: 1377889.7123; val_gene_expr_recon_loss: 2673456.7796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4063865.2471; val_optim_loss: 4063865.2471

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9607; val_auprc_score: 0.9822; val_best_acc_score: 0.9343; val_best_f1_score: 0.9570; train_kl_reg_loss: 16235.5044; train_edge_recon_loss: 1321669.8356; train_gene_expr_recon_loss: 2524160.1784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3862065.5175; train_optim_loss: 3862065.5175; val_kl_reg_loss: 18039.5516; val_edge_recon_loss: 1345160.1784; val_gene_expr_recon_loss: 2398131.9590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3761331.6880; val_optim_loss: 3761331.6880
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9669; val_auprc_score: 0.9857; val_best_acc_score: 0.9408; val_best_f1_score: 0.9612; train_kl_reg_loss: 20033.4401; train_edge_recon_loss: 1312210.2727; train_gene_expr_recon_loss: 2273520.2845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3605763.9995; train_optim_loss: 3605763.9995; val_kl_reg_loss: 22660.7660; val_edge_recon_loss: 1344297.3063; val_gene_expr_recon_loss: 2175131.3135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3542089.3884; val_optim_loss: 3542089.3884
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9706; val_auprc_score: 0.9869; val_best_acc_score: 0.9444; val_best_f1_score: 0.9635; train_kl_reg_loss: 24126.8628; train_edge_recon_loss: 1309402.2118; train_gene_expr_recon_loss: 2081817.1115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3415346.1875; train_optim_loss: 3415346.1875; val_kl_reg_loss: 25291.9125; val_edge_recon_loss: 1346886.5701; val_gene_expr_recon_loss: 2028199.2385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3400377.7080; val_optim_loss: 3400377.7080
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9706; val_auprc_score: 0.9870; val_best_acc_score: 0.9459; val_best_f1_score: 0.9645; train_kl_reg_loss: 25511.5906; train_edge_recon_loss: 1311495.7055; train_gene_expr_recon_loss: 1968678.0913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3305685.3853; train_optim_loss: 3305685.3853; val_kl_reg_loss: 25933.6720; val_edge_recon_loss: 1342330.2104; val_gene_expr_recon_loss: 1949957.1718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318221.0582; val_optim_loss: 3318221.0582

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 242 min 54 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
val AUROC score: 0.9690
val AUPRC score: 0.9862
val best accuracy score: 0.9427
val best F1 score: 0.9625
val target rna MSE score: 0.6336
val source rna MSE score: 0.1198
Val cat covariate0 mean sim diff: 0.0001
Val cat covariate1 mean sim diff: -0.0834
Duration of model training in run 1: 4 hours, 7 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
