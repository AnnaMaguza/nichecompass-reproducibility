Run timestamp: 30082023_124855_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '--edge_batch_size_list', '512', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'Main_molecular_cell_type', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 380406
Number of validation nodes: 42267
Number of training edges: 914339
Number of validation edges: 101593
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9357; val_auprc_score: 0.9610; val_best_acc_score: 0.9371; val_best_f1_score: 0.9580; train_kl_reg_loss: 16889.8958; train_edge_recon_loss: 1468766.3638; train_cat_covariates_contrastive_loss: 323132.8488; train_gene_expr_recon_loss: 1741656.8874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3550445.9937; train_optim_loss: 3550445.9937; val_kl_reg_loss: 17591.2953; val_edge_recon_loss: 1444614.7023; val_cat_covariates_contrastive_loss: 321299.0273; val_gene_expr_recon_loss: 1531859.4284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315364.4573; val_optim_loss: 3315364.4573
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9354; val_auprc_score: 0.9590; val_best_acc_score: 0.9422; val_best_f1_score: 0.9613; train_kl_reg_loss: 17354.4956; train_edge_recon_loss: 1428421.1746; train_cat_covariates_contrastive_loss: 322663.1013; train_gene_expr_recon_loss: 1432943.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3201381.8040; train_optim_loss: 3201381.8040; val_kl_reg_loss: 18272.4397; val_edge_recon_loss: 1439052.7946; val_cat_covariates_contrastive_loss: 320872.8227; val_gene_expr_recon_loss: 1371567.5465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3149765.6143; val_optim_loss: 3149765.6143
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9390; val_auprc_score: 0.9605; val_best_acc_score: 0.9443; val_best_f1_score: 0.9627; train_kl_reg_loss: 18334.5171; train_edge_recon_loss: 1422363.8280; train_cat_covariates_contrastive_loss: 321935.7089; train_gene_expr_recon_loss: 1328908.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3091542.5099; train_optim_loss: 3091542.5099; val_kl_reg_loss: 18110.8454; val_edge_recon_loss: 1439824.6853; val_cat_covariates_contrastive_loss: 322370.3623; val_gene_expr_recon_loss: 1305050.8354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3085356.7337; val_optim_loss: 3085356.7337
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9404; val_auprc_score: 0.9612; val_best_acc_score: 0.9480; val_best_f1_score: 0.9651; train_kl_reg_loss: 18736.4820; train_edge_recon_loss: 1419345.1043; train_cat_covariates_contrastive_loss: 321535.2016; train_gene_expr_recon_loss: 1283005.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3042622.3165; train_optim_loss: 3042622.3165; val_kl_reg_loss: 18805.5557; val_edge_recon_loss: 1427913.9340; val_cat_covariates_contrastive_loss: 321431.7666; val_gene_expr_recon_loss: 1275944.5119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3044095.7764; val_optim_loss: 3044095.7764
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9425; val_auprc_score: 0.9631; val_best_acc_score: 0.9483; val_best_f1_score: 0.9652; train_kl_reg_loss: 18871.7967; train_edge_recon_loss: 1421823.4034; train_cat_covariates_contrastive_loss: 321120.2651; train_gene_expr_recon_loss: 1257075.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3018891.3239; train_optim_loss: 3018891.3239; val_kl_reg_loss: 18719.7509; val_edge_recon_loss: 1428138.8279; val_cat_covariates_contrastive_loss: 322003.5887; val_gene_expr_recon_loss: 1258104.7198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3026966.8844; val_optim_loss: 3026966.8844
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9392; val_auprc_score: 0.9610; val_best_acc_score: 0.9478; val_best_f1_score: 0.9650; train_kl_reg_loss: 19036.8950; train_edge_recon_loss: 1419821.3163; train_cat_covariates_contrastive_loss: 321181.0398; train_gene_expr_recon_loss: 1239785.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2999825.2345; train_optim_loss: 2999825.2345; val_kl_reg_loss: 19338.0332; val_edge_recon_loss: 1433544.1910; val_cat_covariates_contrastive_loss: 320570.4497; val_gene_expr_recon_loss: 1242483.8838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3015936.5641; val_optim_loss: 3015936.5641
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9376; val_auprc_score: 0.9588; val_best_acc_score: 0.9490; val_best_f1_score: 0.9657; train_kl_reg_loss: 19169.4067; train_edge_recon_loss: 1417109.4637; train_cat_covariates_contrastive_loss: 320871.0856; train_gene_expr_recon_loss: 1226647.1703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2983797.1246; train_optim_loss: 2983797.1246; val_kl_reg_loss: 19577.4758; val_edge_recon_loss: 1429840.1036; val_cat_covariates_contrastive_loss: 320038.9596; val_gene_expr_recon_loss: 1229653.3857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2999109.9183; val_optim_loss: 2999109.9183
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9403; val_auprc_score: 0.9602; val_best_acc_score: 0.9494; val_best_f1_score: 0.9660; train_kl_reg_loss: 19235.3691; train_edge_recon_loss: 1418341.5421; train_cat_covariates_contrastive_loss: 320841.6210; train_gene_expr_recon_loss: 1217723.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2976141.5927; train_optim_loss: 2976141.5927; val_kl_reg_loss: 19606.2032; val_edge_recon_loss: 1432955.3109; val_cat_covariates_contrastive_loss: 320670.8708; val_gene_expr_recon_loss: 1222184.3825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2995416.7714; val_optim_loss: 2995416.7714
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9410; val_auprc_score: 0.9610; val_best_acc_score: 0.9514; val_best_f1_score: 0.9673; train_kl_reg_loss: 19317.8964; train_edge_recon_loss: 1416136.9404; train_cat_covariates_contrastive_loss: 320758.5138; train_gene_expr_recon_loss: 1208981.8089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2965195.1646; train_optim_loss: 2965195.1646; val_kl_reg_loss: 19800.0047; val_edge_recon_loss: 1426745.3737; val_cat_covariates_contrastive_loss: 319824.5722; val_gene_expr_recon_loss: 1215116.7192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2981486.6558; val_optim_loss: 2981486.6558
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9414; val_auprc_score: 0.9614; val_best_acc_score: 0.9515; val_best_f1_score: 0.9674; train_kl_reg_loss: 19376.8209; train_edge_recon_loss: 1414232.2193; train_cat_covariates_contrastive_loss: 320721.1915; train_gene_expr_recon_loss: 1202996.1876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2957326.4160; train_optim_loss: 2957326.4160; val_kl_reg_loss: 19471.2780; val_edge_recon_loss: 1424282.1300; val_cat_covariates_contrastive_loss: 320843.7734; val_gene_expr_recon_loss: 1210575.6124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2975172.8003; val_optim_loss: 2975172.8003
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9397; val_auprc_score: 0.9602; val_best_acc_score: 0.9508; val_best_f1_score: 0.9670; train_kl_reg_loss: 19397.5172; train_edge_recon_loss: 1416442.2916; train_cat_covariates_contrastive_loss: 320674.6844; train_gene_expr_recon_loss: 1197727.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2954241.6962; train_optim_loss: 2954241.6962; val_kl_reg_loss: 19220.1752; val_edge_recon_loss: 1429954.4077; val_cat_covariates_contrastive_loss: 320884.9147; val_gene_expr_recon_loss: 1205968.4786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2976027.9774; val_optim_loss: 2976027.9774
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9383; val_auprc_score: 0.9587; val_best_acc_score: 0.9513; val_best_f1_score: 0.9673; train_kl_reg_loss: 19482.7329; train_edge_recon_loss: 1416532.4346; train_cat_covariates_contrastive_loss: 320590.2386; train_gene_expr_recon_loss: 1192422.1174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2949027.5242; train_optim_loss: 2949027.5242; val_kl_reg_loss: 20038.5800; val_edge_recon_loss: 1429003.1759; val_cat_covariates_contrastive_loss: 319293.9080; val_gene_expr_recon_loss: 1200128.7330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2968464.3995; val_optim_loss: 2968464.3995
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9405; val_auprc_score: 0.9607; val_best_acc_score: 0.9521; val_best_f1_score: 0.9678; train_kl_reg_loss: 19455.9620; train_edge_recon_loss: 1416497.4348; train_cat_covariates_contrastive_loss: 320729.8319; train_gene_expr_recon_loss: 1188109.4072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2944792.6355; train_optim_loss: 2944792.6355; val_kl_reg_loss: 19437.4068; val_edge_recon_loss: 1427552.1307; val_cat_covariates_contrastive_loss: 320339.5842; val_gene_expr_recon_loss: 1195639.5314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2962968.6533; val_optim_loss: 2962968.6533
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9407; val_auprc_score: 0.9610; val_best_acc_score: 0.9527; val_best_f1_score: 0.9683; train_kl_reg_loss: 19530.5775; train_edge_recon_loss: 1416592.3476; train_cat_covariates_contrastive_loss: 320813.3387; train_gene_expr_recon_loss: 1185540.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2942476.7371; train_optim_loss: 2942476.7371; val_kl_reg_loss: 19656.1949; val_edge_recon_loss: 1420715.7280; val_cat_covariates_contrastive_loss: 320951.2546; val_gene_expr_recon_loss: 1192353.7814; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2953676.9535; val_optim_loss: 2953676.9535
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9411; val_auprc_score: 0.9604; val_best_acc_score: 0.9526; val_best_f1_score: 0.9681; train_kl_reg_loss: 19470.7630; train_edge_recon_loss: 1413692.8660; train_cat_covariates_contrastive_loss: 320583.6975; train_gene_expr_recon_loss: 1181530.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2935277.8982; train_optim_loss: 2935277.8982; val_kl_reg_loss: 20059.7835; val_edge_recon_loss: 1429853.1809; val_cat_covariates_contrastive_loss: 319919.2304; val_gene_expr_recon_loss: 1193319.3606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2963151.5641; val_optim_loss: 2963151.5641
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9424; val_auprc_score: 0.9622; val_best_acc_score: 0.9542; val_best_f1_score: 0.9692; train_kl_reg_loss: 19501.0576; train_edge_recon_loss: 1411870.3324; train_cat_covariates_contrastive_loss: 320482.2779; train_gene_expr_recon_loss: 1177510.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2929363.6748; train_optim_loss: 2929363.6748; val_kl_reg_loss: 19466.2491; val_edge_recon_loss: 1423352.1055; val_cat_covariates_contrastive_loss: 320423.4719; val_gene_expr_recon_loss: 1184535.0446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2947776.8656; val_optim_loss: 2947776.8656
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9384; val_auprc_score: 0.9584; val_best_acc_score: 0.9540; val_best_f1_score: 0.9692; train_kl_reg_loss: 19381.7232; train_edge_recon_loss: 1410507.5901; train_cat_covariates_contrastive_loss: 320504.7203; train_gene_expr_recon_loss: 1174342.1883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2924736.2191; train_optim_loss: 2924736.2191; val_kl_reg_loss: 19885.6292; val_edge_recon_loss: 1420504.7858; val_cat_covariates_contrastive_loss: 319695.1639; val_gene_expr_recon_loss: 1186442.2299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2946527.8015; val_optim_loss: 2946527.8015
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9412; val_auprc_score: 0.9612; val_best_acc_score: 0.9549; val_best_f1_score: 0.9697; train_kl_reg_loss: 19519.3272; train_edge_recon_loss: 1413726.6455; train_cat_covariates_contrastive_loss: 320544.7008; train_gene_expr_recon_loss: 1171634.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2925424.7749; train_optim_loss: 2925424.7749; val_kl_reg_loss: 19791.9166; val_edge_recon_loss: 1422762.1093; val_cat_covariates_contrastive_loss: 319639.3111; val_gene_expr_recon_loss: 1180650.3775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2942843.7048; val_optim_loss: 2942843.7048
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9400; val_auprc_score: 0.9595; val_best_acc_score: 0.9548; val_best_f1_score: 0.9696; train_kl_reg_loss: 19500.7887; train_edge_recon_loss: 1414647.3663; train_cat_covariates_contrastive_loss: 320338.0605; train_gene_expr_recon_loss: 1169435.5971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2923921.8123; train_optim_loss: 2923921.8123; val_kl_reg_loss: 19816.6101; val_edge_recon_loss: 1422851.7142; val_cat_covariates_contrastive_loss: 319424.0116; val_gene_expr_recon_loss: 1179146.4158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2941238.7651; val_optim_loss: 2941238.7651
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9397; val_auprc_score: 0.9595; val_best_acc_score: 0.9551; val_best_f1_score: 0.9699; train_kl_reg_loss: 19376.2448; train_edge_recon_loss: 1412367.0575; train_cat_covariates_contrastive_loss: 320193.4657; train_gene_expr_recon_loss: 1165329.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2917266.4258; train_optim_loss: 2917266.4258; val_kl_reg_loss: 19873.4723; val_edge_recon_loss: 1414671.0377; val_cat_covariates_contrastive_loss: 319863.5322; val_gene_expr_recon_loss: 1178549.7092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2932957.7525; val_optim_loss: 2932957.7525
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9422; val_auprc_score: 0.9618; val_best_acc_score: 0.9554; val_best_f1_score: 0.9700; train_kl_reg_loss: 19400.8594; train_edge_recon_loss: 1412435.6589; train_cat_covariates_contrastive_loss: 320251.2277; train_gene_expr_recon_loss: 1165712.9158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2917800.6604; train_optim_loss: 2917800.6604; val_kl_reg_loss: 19268.5880; val_edge_recon_loss: 1419304.2067; val_cat_covariates_contrastive_loss: 320124.8538; val_gene_expr_recon_loss: 1170388.5094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2929086.1558; val_optim_loss: 2929086.1558
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9416; val_auprc_score: 0.9610; val_best_acc_score: 0.9556; val_best_f1_score: 0.9702; train_kl_reg_loss: 19393.7799; train_edge_recon_loss: 1411464.9120; train_cat_covariates_contrastive_loss: 320190.0014; train_gene_expr_recon_loss: 1163883.2564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2914931.9486; train_optim_loss: 2914931.9486; val_kl_reg_loss: 19267.3132; val_edge_recon_loss: 1419187.6344; val_cat_covariates_contrastive_loss: 320084.7882; val_gene_expr_recon_loss: 1173393.8788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2931933.6093; val_optim_loss: 2931933.6093
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9409; val_auprc_score: 0.9611; val_best_acc_score: 0.9552; val_best_f1_score: 0.9699; train_kl_reg_loss: 19241.9167; train_edge_recon_loss: 1412155.4257; train_cat_covariates_contrastive_loss: 320108.9431; train_gene_expr_recon_loss: 1159748.8644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2911255.1460; train_optim_loss: 2911255.1460; val_kl_reg_loss: 18651.0751; val_edge_recon_loss: 1426481.2594; val_cat_covariates_contrastive_loss: 320439.3216; val_gene_expr_recon_loss: 1172990.7217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2938562.3769; val_optim_loss: 2938562.3769
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9399; val_auprc_score: 0.9594; val_best_acc_score: 0.9549; val_best_f1_score: 0.9698; train_kl_reg_loss: 19296.7569; train_edge_recon_loss: 1408428.7039; train_cat_covariates_contrastive_loss: 320124.2494; train_gene_expr_recon_loss: 1160350.6377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2908200.3417; train_optim_loss: 2908200.3417; val_kl_reg_loss: 19481.2552; val_edge_recon_loss: 1423426.3907; val_cat_covariates_contrastive_loss: 319577.8116; val_gene_expr_recon_loss: 1168551.0842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2931036.5440; val_optim_loss: 2931036.5440
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9406; val_auprc_score: 0.9601; val_best_acc_score: 0.9558; val_best_f1_score: 0.9703; train_kl_reg_loss: 19172.0831; train_edge_recon_loss: 1412079.7896; train_cat_covariates_contrastive_loss: 319937.1872; train_gene_expr_recon_loss: 1155536.8793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2906725.9351; train_optim_loss: 2906725.9351; val_kl_reg_loss: 18856.5922; val_edge_recon_loss: 1422821.4824; val_cat_covariates_contrastive_loss: 319374.5512; val_gene_expr_recon_loss: 1165453.1476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2926505.7714; val_optim_loss: 2926505.7714
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9402; val_auprc_score: 0.9599; val_best_acc_score: 0.9553; val_best_f1_score: 0.9700; train_kl_reg_loss: 19214.3209; train_edge_recon_loss: 1412352.0047; train_cat_covariates_contrastive_loss: 319973.0137; train_gene_expr_recon_loss: 1159047.0404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2910586.3796; train_optim_loss: 2910586.3796; val_kl_reg_loss: 19261.9354; val_edge_recon_loss: 1413499.6997; val_cat_covariates_contrastive_loss: 320243.8266; val_gene_expr_recon_loss: 1167450.7739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2920456.2337; val_optim_loss: 2920456.2337
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9411; val_auprc_score: 0.9608; val_best_acc_score: 0.9561; val_best_f1_score: 0.9705; train_kl_reg_loss: 19264.5868; train_edge_recon_loss: 1410128.1137; train_cat_covariates_contrastive_loss: 319925.5760; train_gene_expr_recon_loss: 1155498.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2904816.5792; train_optim_loss: 2904816.5792; val_kl_reg_loss: 19136.0190; val_edge_recon_loss: 1420989.1432; val_cat_covariates_contrastive_loss: 319694.6435; val_gene_expr_recon_loss: 1162356.5421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2922176.3405; val_optim_loss: 2922176.3405
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9420; val_auprc_score: 0.9610; val_best_acc_score: 0.9572; val_best_f1_score: 0.9712; train_kl_reg_loss: 19142.2964; train_edge_recon_loss: 1410623.3297; train_cat_covariates_contrastive_loss: 319820.5178; train_gene_expr_recon_loss: 1154461.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2904048.0479; train_optim_loss: 2904048.0479; val_kl_reg_loss: 18874.2189; val_edge_recon_loss: 1421368.5396; val_cat_covariates_contrastive_loss: 320022.9213; val_gene_expr_recon_loss: 1163322.3700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2923588.0515; val_optim_loss: 2923588.0515
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9391; val_auprc_score: 0.9588; val_best_acc_score: 0.9556; val_best_f1_score: 0.9702; train_kl_reg_loss: 19094.9674; train_edge_recon_loss: 1416092.1778; train_cat_covariates_contrastive_loss: 319877.0680; train_gene_expr_recon_loss: 1152060.4064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2907124.6230; train_optim_loss: 2907124.6230; val_kl_reg_loss: 19548.4197; val_edge_recon_loss: 1426333.3448; val_cat_covariates_contrastive_loss: 319143.4805; val_gene_expr_recon_loss: 1160496.1363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2925521.3706; val_optim_loss: 2925521.3706
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9393; val_auprc_score: 0.9588; val_best_acc_score: 0.9567; val_best_f1_score: 0.9709; train_kl_reg_loss: 19423.4517; train_edge_recon_loss: 1408150.1371; train_cat_covariates_contrastive_loss: 319961.7816; train_gene_expr_recon_loss: 1157830.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2905365.6452; train_optim_loss: 2905365.6452; val_kl_reg_loss: 20047.3620; val_edge_recon_loss: 1422358.8216; val_cat_covariates_contrastive_loss: 319152.8045; val_gene_expr_recon_loss: 1172139.4881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2933698.4799; val_optim_loss: 2933698.4799

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9425; val_auprc_score: 0.9613; val_best_acc_score: 0.9576; val_best_f1_score: 0.9715; train_kl_reg_loss: 19772.0351; train_edge_recon_loss: 1410172.5525; train_cat_covariates_contrastive_loss: 320065.4806; train_gene_expr_recon_loss: 1144285.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2894295.2870; train_optim_loss: 2894295.2870; val_kl_reg_loss: 19686.7713; val_edge_recon_loss: 1417277.1206; val_cat_covariates_contrastive_loss: 319511.7264; val_gene_expr_recon_loss: 1152937.4008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2909413.0302; val_optim_loss: 2909413.0302
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9428; val_auprc_score: 0.9614; val_best_acc_score: 0.9581; val_best_f1_score: 0.9718; train_kl_reg_loss: 19744.2435; train_edge_recon_loss: 1409465.8384; train_cat_covariates_contrastive_loss: 319874.7698; train_gene_expr_recon_loss: 1138892.0711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2887976.9247; train_optim_loss: 2887976.9247; val_kl_reg_loss: 19768.5018; val_edge_recon_loss: 1415594.6702; val_cat_covariates_contrastive_loss: 319338.5705; val_gene_expr_recon_loss: 1149397.4296; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2904099.1771; val_optim_loss: 2904099.1771
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9412; val_auprc_score: 0.9607; val_best_acc_score: 0.9568; val_best_f1_score: 0.9710; train_kl_reg_loss: 19604.8772; train_edge_recon_loss: 1410550.4422; train_cat_covariates_contrastive_loss: 319774.0244; train_gene_expr_recon_loss: 1136264.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2886194.2832; train_optim_loss: 2886194.2832; val_kl_reg_loss: 19254.9654; val_edge_recon_loss: 1417105.3411; val_cat_covariates_contrastive_loss: 320025.2092; val_gene_expr_recon_loss: 1148981.8763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2905367.3957; val_optim_loss: 2905367.3957
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9388; val_auprc_score: 0.9585; val_best_acc_score: 0.9569; val_best_f1_score: 0.9710; train_kl_reg_loss: 19330.2997; train_edge_recon_loss: 1408752.1018; train_cat_covariates_contrastive_loss: 319841.8793; train_gene_expr_recon_loss: 1134540.8253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2882465.1029; train_optim_loss: 2882465.1029; val_kl_reg_loss: 19174.7473; val_edge_recon_loss: 1419789.5942; val_cat_covariates_contrastive_loss: 319681.3725; val_gene_expr_recon_loss: 1146072.2557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2904717.9636; val_optim_loss: 2904717.9636
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9418; val_auprc_score: 0.9605; val_best_acc_score: 0.9577; val_best_f1_score: 0.9715; train_kl_reg_loss: 19177.4181; train_edge_recon_loss: 1408718.9396; train_cat_covariates_contrastive_loss: 319577.0788; train_gene_expr_recon_loss: 1133634.8012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2881108.2359; train_optim_loss: 2881108.2359; val_kl_reg_loss: 19142.5403; val_edge_recon_loss: 1423381.6470; val_cat_covariates_contrastive_loss: 319537.1999; val_gene_expr_recon_loss: 1146702.7029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2908764.0754; val_optim_loss: 2908764.0754
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9420; val_auprc_score: 0.9611; val_best_acc_score: 0.9578; val_best_f1_score: 0.9716; train_kl_reg_loss: 19078.3742; train_edge_recon_loss: 1408337.8015; train_cat_covariates_contrastive_loss: 319624.2473; train_gene_expr_recon_loss: 1132849.8692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2879890.2885; train_optim_loss: 2879890.2885; val_kl_reg_loss: 19045.3438; val_edge_recon_loss: 1417425.1030; val_cat_covariates_contrastive_loss: 319407.3585; val_gene_expr_recon_loss: 1144570.5628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2900448.3656; val_optim_loss: 2900448.3656
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9419; val_auprc_score: 0.9617; val_best_acc_score: 0.9576; val_best_f1_score: 0.9716; train_kl_reg_loss: 18958.1049; train_edge_recon_loss: 1406539.4054; train_cat_covariates_contrastive_loss: 319639.9332; train_gene_expr_recon_loss: 1132079.1720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2877216.6146; train_optim_loss: 2877216.6146; val_kl_reg_loss: 18830.1597; val_edge_recon_loss: 1409964.6834; val_cat_covariates_contrastive_loss: 319288.6539; val_gene_expr_recon_loss: 1144396.8191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2892480.3065; val_optim_loss: 2892480.3065
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9404; val_auprc_score: 0.9601; val_best_acc_score: 0.9568; val_best_f1_score: 0.9710; train_kl_reg_loss: 18847.4078; train_edge_recon_loss: 1409858.7407; train_cat_covariates_contrastive_loss: 319580.1794; train_gene_expr_recon_loss: 1132220.6443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2880506.9733; train_optim_loss: 2880506.9733; val_kl_reg_loss: 18761.8469; val_edge_recon_loss: 1416370.8524; val_cat_covariates_contrastive_loss: 319119.6212; val_gene_expr_recon_loss: 1142793.1244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2897045.4460; val_optim_loss: 2897045.4460
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9424; val_auprc_score: 0.9615; val_best_acc_score: 0.9581; val_best_f1_score: 0.9718; train_kl_reg_loss: 18745.6848; train_edge_recon_loss: 1411250.9020; train_cat_covariates_contrastive_loss: 319545.7040; train_gene_expr_recon_loss: 1131664.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2881207.1204; train_optim_loss: 2881207.1204; val_kl_reg_loss: 18815.6825; val_edge_recon_loss: 1410736.9560; val_cat_covariates_contrastive_loss: 319018.7145; val_gene_expr_recon_loss: 1144213.3480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2892784.7060; val_optim_loss: 2892784.7060
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9397; val_auprc_score: 0.9595; val_best_acc_score: 0.9574; val_best_f1_score: 0.9714; train_kl_reg_loss: 18671.9464; train_edge_recon_loss: 1408524.0828; train_cat_covariates_contrastive_loss: 319549.4995; train_gene_expr_recon_loss: 1131230.3439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2877975.8730; train_optim_loss: 2877975.8730; val_kl_reg_loss: 18747.7357; val_edge_recon_loss: 1414539.1457; val_cat_covariates_contrastive_loss: 319236.3949; val_gene_expr_recon_loss: 1144676.0421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2897199.3128; val_optim_loss: 2897199.3128
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9410; val_auprc_score: 0.9601; val_best_acc_score: 0.9583; val_best_f1_score: 0.9719; train_kl_reg_loss: 18619.3066; train_edge_recon_loss: 1405198.5095; train_cat_covariates_contrastive_loss: 319488.6193; train_gene_expr_recon_loss: 1130768.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2874075.2230; train_optim_loss: 2874075.2230; val_kl_reg_loss: 18857.7171; val_edge_recon_loss: 1418608.2889; val_cat_covariates_contrastive_loss: 319077.3018; val_gene_expr_recon_loss: 1142575.1049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2899118.4070; val_optim_loss: 2899118.4070

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9413; val_auprc_score: 0.9607; val_best_acc_score: 0.9579; val_best_f1_score: 0.9717; train_kl_reg_loss: 18612.2196; train_edge_recon_loss: 1408295.2363; train_cat_covariates_contrastive_loss: 319399.9056; train_gene_expr_recon_loss: 1129385.2850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2875692.6440; train_optim_loss: 2875692.6440; val_kl_reg_loss: 18596.3414; val_edge_recon_loss: 1415373.9548; val_cat_covariates_contrastive_loss: 318970.0179; val_gene_expr_recon_loss: 1142434.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2895374.3907; val_optim_loss: 2895374.3907
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9399; val_auprc_score: 0.9599; val_best_acc_score: 0.9567; val_best_f1_score: 0.9709; train_kl_reg_loss: 18559.6979; train_edge_recon_loss: 1407816.4689; train_cat_covariates_contrastive_loss: 319508.9385; train_gene_expr_recon_loss: 1129442.3547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2875327.4591; train_optim_loss: 2875327.4591; val_kl_reg_loss: 18601.3008; val_edge_recon_loss: 1415008.8405; val_cat_covariates_contrastive_loss: 319124.5972; val_gene_expr_recon_loss: 1141565.4246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2894300.1671; val_optim_loss: 2894300.1671
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9405; val_auprc_score: 0.9600; val_best_acc_score: 0.9577; val_best_f1_score: 0.9716; train_kl_reg_loss: 18544.7418; train_edge_recon_loss: 1406444.1226; train_cat_covariates_contrastive_loss: 319377.7466; train_gene_expr_recon_loss: 1128816.9384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2873183.5533; train_optim_loss: 2873183.5533; val_kl_reg_loss: 18553.9273; val_edge_recon_loss: 1417632.7035; val_cat_covariates_contrastive_loss: 318962.3328; val_gene_expr_recon_loss: 1142290.8668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2897439.8417; val_optim_loss: 2897439.8417
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9391; val_auprc_score: 0.9590; val_best_acc_score: 0.9572; val_best_f1_score: 0.9713; train_kl_reg_loss: 18509.9155; train_edge_recon_loss: 1406601.7395; train_cat_covariates_contrastive_loss: 319488.8595; train_gene_expr_recon_loss: 1129244.1013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2873844.6135; train_optim_loss: 2873844.6135; val_kl_reg_loss: 18582.3239; val_edge_recon_loss: 1415306.4673; val_cat_covariates_contrastive_loss: 319130.9727; val_gene_expr_recon_loss: 1142662.7274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2895682.4887; val_optim_loss: 2895682.4887

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 529 min 23 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9397
val AUPRC score: 0.9596
val best accuracy score: 0.9569
val best F1 score: 0.9711
val target rna MSE score: 0.1771
val source rna MSE score: 0.0704
Val cat covariate0 mean sim diff: -0.0023
Duration of model training in run 2: 8 hours, 53 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
