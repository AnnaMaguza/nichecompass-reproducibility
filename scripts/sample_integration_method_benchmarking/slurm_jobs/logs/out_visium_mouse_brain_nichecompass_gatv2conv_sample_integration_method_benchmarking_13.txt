Run timestamp: 29082023_213533_13.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '6', '--edge_batch_size_list', '256', '--node_batch_size_list', 'None', '--seeds', '1', '--run_index', '2', '--cell_type_key', 'cell_type', '--filter_genes', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'visium_mouse_brain', '--reference_batches', 'batch1', 'batch2', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'data', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '6', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...


Filtering genes...
Starting with 32285 genes.
Keeping 32285 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1530, n_latent: 1520, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1520, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 10948
Number of validation nodes: 1216
Number of training edges: 33527
Number of validation edges: 3725
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8532; val_auprc_score: 0.9170; val_best_acc_score: 0.7870; val_best_f1_score: 0.8594; train_kl_reg_loss: 63211.3470; train_edge_recon_loss: 2464860.1927; train_cat_covariates_contrastive_loss: 749517.5935; train_gene_expr_recon_loss: 74122811.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77400400.7939; train_optim_loss: 77400400.7939; val_kl_reg_loss: 95558.9229; val_edge_recon_loss: 2680145.9667; val_cat_covariates_contrastive_loss: 626593.9458; val_gene_expr_recon_loss: 56120829.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59523128.2667; val_optim_loss: 59523128.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8666; val_auprc_score: 0.9254; val_best_acc_score: 0.8052; val_best_f1_score: 0.8581; train_kl_reg_loss: 109514.4034; train_edge_recon_loss: 2455712.1584; train_cat_covariates_contrastive_loss: 653311.7824; train_gene_expr_recon_loss: 52338356.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55556894.7176; train_optim_loss: 55556894.7176; val_kl_reg_loss: 103801.4979; val_edge_recon_loss: 2659595.6000; val_cat_covariates_contrastive_loss: 626659.7833; val_gene_expr_recon_loss: 50141091.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 53531148.8000; val_optim_loss: 53531148.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8685; val_auprc_score: 0.9236; val_best_acc_score: 0.8172; val_best_f1_score: 0.8725; train_kl_reg_loss: 101096.4166; train_edge_recon_loss: 2420698.5639; train_cat_covariates_contrastive_loss: 645994.2376; train_gene_expr_recon_loss: 49571349.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 52739138.6260; train_optim_loss: 52739138.6260; val_kl_reg_loss: 93091.3693; val_edge_recon_loss: 2599413.6000; val_cat_covariates_contrastive_loss: 626740.2625; val_gene_expr_recon_loss: 48713905.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52033150.4000; val_optim_loss: 52033150.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8600; val_auprc_score: 0.9182; val_best_acc_score: 0.8071; val_best_f1_score: 0.8710; train_kl_reg_loss: 76898.4290; train_edge_recon_loss: 2298413.3340; train_cat_covariates_contrastive_loss: 634590.6331; train_gene_expr_recon_loss: 48625873.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 51635776.2748; train_optim_loss: 51635776.2748; val_kl_reg_loss: 79148.3104; val_edge_recon_loss: 2188489.1583; val_cat_covariates_contrastive_loss: 626790.5417; val_gene_expr_recon_loss: 47850816.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50745244.2667; val_optim_loss: 50745244.2667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8653; val_auprc_score: 0.9216; val_best_acc_score: 0.8089; val_best_f1_score: 0.8730; train_kl_reg_loss: 83697.8683; train_edge_recon_loss: 2083153.4962; train_cat_covariates_contrastive_loss: 627685.3087; train_gene_expr_recon_loss: 47918804.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50713340.5802; train_optim_loss: 50713340.5802; val_kl_reg_loss: 90575.3672; val_edge_recon_loss: 2050255.9667; val_cat_covariates_contrastive_loss: 626749.0833; val_gene_expr_recon_loss: 47400877.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 50168458.1333; val_optim_loss: 50168458.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8678; val_auprc_score: 0.9225; val_best_acc_score: 0.8166; val_best_f1_score: 0.8769; train_kl_reg_loss: 89352.3496; train_edge_recon_loss: 2000246.0496; train_cat_covariates_contrastive_loss: 627347.9227; train_gene_expr_recon_loss: 47239057.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49956003.7557; train_optim_loss: 49956003.7557; val_kl_reg_loss: 90779.4563; val_edge_recon_loss: 2003896.9917; val_cat_covariates_contrastive_loss: 626908.3500; val_gene_expr_recon_loss: 46806052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 49527637.0667; val_optim_loss: 49527637.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8691; val_auprc_score: 0.9238; val_best_acc_score: 0.8149; val_best_f1_score: 0.8779; train_kl_reg_loss: 87392.9442; train_edge_recon_loss: 1996988.8683; train_cat_covariates_contrastive_loss: 627315.0644; train_gene_expr_recon_loss: 46693832.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49405529.6794; train_optim_loss: 49405529.6794; val_kl_reg_loss: 87305.2385; val_edge_recon_loss: 1970886.0250; val_cat_covariates_contrastive_loss: 626943.8750; val_gene_expr_recon_loss: 46207000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48892135.2000; val_optim_loss: 48892135.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8734; val_auprc_score: 0.9235; val_best_acc_score: 0.8205; val_best_f1_score: 0.8795; train_kl_reg_loss: 81455.5279; train_edge_recon_loss: 1975064.2824; train_cat_covariates_contrastive_loss: 627581.4418; train_gene_expr_recon_loss: 46132335.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48816436.9160; train_optim_loss: 48816436.9160; val_kl_reg_loss: 81136.1484; val_edge_recon_loss: 1983797.3250; val_cat_covariates_contrastive_loss: 627129.4000; val_gene_expr_recon_loss: 45604320.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48296383.7333; val_optim_loss: 48296383.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8830; val_auprc_score: 0.9327; val_best_acc_score: 0.8224; val_best_f1_score: 0.8797; train_kl_reg_loss: 76359.6357; train_edge_recon_loss: 1975727.7118; train_cat_covariates_contrastive_loss: 627797.2700; train_gene_expr_recon_loss: 45653741.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48333626.4122; train_optim_loss: 48333626.4122; val_kl_reg_loss: 73922.5542; val_edge_recon_loss: 1960510.2833; val_cat_covariates_contrastive_loss: 627606.8542; val_gene_expr_recon_loss: 45130874.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47792914.6667; val_optim_loss: 47792914.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8931; val_auprc_score: 0.9373; val_best_acc_score: 0.8342; val_best_f1_score: 0.8842; train_kl_reg_loss: 72029.3672; train_edge_recon_loss: 1960394.6613; train_cat_covariates_contrastive_loss: 628076.6923; train_gene_expr_recon_loss: 45162599.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47823099.9389; train_optim_loss: 47823099.9389; val_kl_reg_loss: 69786.8302; val_edge_recon_loss: 1972504.2000; val_cat_covariates_contrastive_loss: 628143.6375; val_gene_expr_recon_loss: 44743259.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47413694.1333; val_optim_loss: 47413694.1333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8963; val_auprc_score: 0.9388; val_best_acc_score: 0.8359; val_best_f1_score: 0.8877; train_kl_reg_loss: 67459.5053; train_edge_recon_loss: 1941834.1269; train_cat_covariates_contrastive_loss: 628902.9986; train_gene_expr_recon_loss: 44716642.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47354838.9618; train_optim_loss: 47354838.9618; val_kl_reg_loss: 64927.9852; val_edge_recon_loss: 1943305.9917; val_cat_covariates_contrastive_loss: 628534.5542; val_gene_expr_recon_loss: 43941666.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46578435.2000; val_optim_loss: 46578435.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9104; val_auprc_score: 0.9506; val_best_acc_score: 0.8456; val_best_f1_score: 0.8934; train_kl_reg_loss: 63125.9373; train_edge_recon_loss: 1914745.3578; train_cat_covariates_contrastive_loss: 629654.1331; train_gene_expr_recon_loss: 44278320.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46885845.3740; train_optim_loss: 46885845.3740; val_kl_reg_loss: 60427.0997; val_edge_recon_loss: 1938235.3333; val_cat_covariates_contrastive_loss: 629850.8708; val_gene_expr_recon_loss: 43833303.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46461816.8000; val_optim_loss: 46461816.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9226; val_auprc_score: 0.9535; val_best_acc_score: 0.8665; val_best_f1_score: 0.9051; train_kl_reg_loss: 59588.4200; train_edge_recon_loss: 1893057.1555; train_cat_covariates_contrastive_loss: 630562.9170; train_gene_expr_recon_loss: 43907413.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46490622.3817; train_optim_loss: 46490622.3817; val_kl_reg_loss: 58220.1573; val_edge_recon_loss: 1883778.0333; val_cat_covariates_contrastive_loss: 630308.1208; val_gene_expr_recon_loss: 43516298.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 46088604.5333; val_optim_loss: 46088604.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9257; val_auprc_score: 0.9558; val_best_acc_score: 0.8691; val_best_f1_score: 0.9057; train_kl_reg_loss: 56278.4709; train_edge_recon_loss: 1894545.0420; train_cat_covariates_contrastive_loss: 631972.9680; train_gene_expr_recon_loss: 43573938.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46156734.9313; train_optim_loss: 46156734.9313; val_kl_reg_loss: 55850.7333; val_edge_recon_loss: 1896080.2083; val_cat_covariates_contrastive_loss: 631871.5750; val_gene_expr_recon_loss: 43295839.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45879641.6000; val_optim_loss: 45879641.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9416; val_auprc_score: 0.9657; val_best_acc_score: 0.8882; val_best_f1_score: 0.9182; train_kl_reg_loss: 53150.2477; train_edge_recon_loss: 1873533.0057; train_cat_covariates_contrastive_loss: 634219.9728; train_gene_expr_recon_loss: 43250780.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45811684.2443; train_optim_loss: 45811684.2443; val_kl_reg_loss: 51331.1362; val_edge_recon_loss: 1877387.5750; val_cat_covariates_contrastive_loss: 634640.1167; val_gene_expr_recon_loss: 42919163.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45482521.6000; val_optim_loss: 45482521.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9411; val_auprc_score: 0.9646; val_best_acc_score: 0.8913; val_best_f1_score: 0.9220; train_kl_reg_loss: 51107.9877; train_edge_recon_loss: 1841636.1746; train_cat_covariates_contrastive_loss: 634990.4222; train_gene_expr_recon_loss: 42963647.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45491381.7405; train_optim_loss: 45491381.7405; val_kl_reg_loss: 48711.0622; val_edge_recon_loss: 1815378.5250; val_cat_covariates_contrastive_loss: 637648.2333; val_gene_expr_recon_loss: 42570981.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45072719.2000; val_optim_loss: 45072719.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9417; val_auprc_score: 0.9645; val_best_acc_score: 0.8928; val_best_f1_score: 0.9209; train_kl_reg_loss: 49116.7001; train_edge_recon_loss: 1853367.2700; train_cat_covariates_contrastive_loss: 636795.0401; train_gene_expr_recon_loss: 42651155.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45190434.7786; train_optim_loss: 45190434.7786; val_kl_reg_loss: 47673.6846; val_edge_recon_loss: 1891035.3000; val_cat_covariates_contrastive_loss: 637992.5250; val_gene_expr_recon_loss: 42547820.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 45124522.1333; val_optim_loss: 45124522.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9489; val_auprc_score: 0.9653; val_best_acc_score: 0.9038; val_best_f1_score: 0.9296; train_kl_reg_loss: 47216.2531; train_edge_recon_loss: 1830037.1641; train_cat_covariates_contrastive_loss: 638984.7910; train_gene_expr_recon_loss: 42409330.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44925568.5191; train_optim_loss: 44925568.5191; val_kl_reg_loss: 46453.9219; val_edge_recon_loss: 1848914.0667; val_cat_covariates_contrastive_loss: 642509.7125; val_gene_expr_recon_loss: 42299029.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44836907.2000; val_optim_loss: 44836907.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9531; val_auprc_score: 0.9713; val_best_acc_score: 0.9087; val_best_f1_score: 0.9337; train_kl_reg_loss: 45329.7162; train_edge_recon_loss: 1830202.3664; train_cat_covariates_contrastive_loss: 638628.3831; train_gene_expr_recon_loss: 42154942.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44669103.3588; train_optim_loss: 44669103.3588; val_kl_reg_loss: 44883.6432; val_edge_recon_loss: 1828634.5833; val_cat_covariates_contrastive_loss: 641535.1750; val_gene_expr_recon_loss: 41891166.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44406220.5333; val_optim_loss: 44406220.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9604; val_auprc_score: 0.9748; val_best_acc_score: 0.9183; val_best_f1_score: 0.9405; train_kl_reg_loss: 43692.0979; train_edge_recon_loss: 1816541.1508; train_cat_covariates_contrastive_loss: 639514.1307; train_gene_expr_recon_loss: 41931768.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44431515.6947; train_optim_loss: 44431515.6947; val_kl_reg_loss: 42810.1128; val_edge_recon_loss: 1799583.2083; val_cat_covariates_contrastive_loss: 639715.8167; val_gene_expr_recon_loss: 41613434.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44095543.2000; val_optim_loss: 44095543.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9530; val_auprc_score: 0.9682; val_best_acc_score: 0.9168; val_best_f1_score: 0.9390; train_kl_reg_loss: 42312.1282; train_edge_recon_loss: 1804641.1050; train_cat_covariates_contrastive_loss: 637977.0787; train_gene_expr_recon_loss: 41712767.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44197698.2901; train_optim_loss: 44197698.2901; val_kl_reg_loss: 41027.5826; val_edge_recon_loss: 1810025.9083; val_cat_covariates_contrastive_loss: 635101.3167; val_gene_expr_recon_loss: 41442567.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43928722.1333; val_optim_loss: 43928722.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9563; val_auprc_score: 0.9700; val_best_acc_score: 0.9221; val_best_f1_score: 0.9432; train_kl_reg_loss: 40869.7473; train_edge_recon_loss: 1806379.2071; train_cat_covariates_contrastive_loss: 637368.2266; train_gene_expr_recon_loss: 41508080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43992697.0687; train_optim_loss: 43992697.0687; val_kl_reg_loss: 39733.5768; val_edge_recon_loss: 1817253.2250; val_cat_covariates_contrastive_loss: 635711.7125; val_gene_expr_recon_loss: 41185343.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43678042.1333; val_optim_loss: 43678042.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9577; val_auprc_score: 0.9730; val_best_acc_score: 0.9213; val_best_f1_score: 0.9435; train_kl_reg_loss: 39408.4893; train_edge_recon_loss: 1785482.6489; train_cat_covariates_contrastive_loss: 639441.7562; train_gene_expr_recon_loss: 41332453.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43796785.8931; train_optim_loss: 43796785.8931; val_kl_reg_loss: 39576.7107; val_edge_recon_loss: 1794184.7250; val_cat_covariates_contrastive_loss: 635190.1875; val_gene_expr_recon_loss: 41001358.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43470309.3333; val_optim_loss: 43470309.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9561; val_auprc_score: 0.9689; val_best_acc_score: 0.9222; val_best_f1_score: 0.9433; train_kl_reg_loss: 37717.9836; train_edge_recon_loss: 1797408.3435; train_cat_covariates_contrastive_loss: 637709.7996; train_gene_expr_recon_loss: 41135826.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43608662.6870; train_optim_loss: 43608662.6870; val_kl_reg_loss: 36786.4133; val_edge_recon_loss: 1826738.0917; val_cat_covariates_contrastive_loss: 641129.9375; val_gene_expr_recon_loss: 41034279.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43538933.3333; val_optim_loss: 43538933.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9577; val_auprc_score: 0.9711; val_best_acc_score: 0.9235; val_best_f1_score: 0.9454; train_kl_reg_loss: 36536.1138; train_edge_recon_loss: 1789757.1450; train_cat_covariates_contrastive_loss: 636296.6374; train_gene_expr_recon_loss: 40960884.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43423474.2290; train_optim_loss: 43423474.2290; val_kl_reg_loss: 35838.7122; val_edge_recon_loss: 1775814.5917; val_cat_covariates_contrastive_loss: 639748.0083; val_gene_expr_recon_loss: 40773816.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43225218.1333; val_optim_loss: 43225218.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9594; val_auprc_score: 0.9727; val_best_acc_score: 0.9282; val_best_f1_score: 0.9480; train_kl_reg_loss: 35307.3394; train_edge_recon_loss: 1786933.0706; train_cat_covariates_contrastive_loss: 638170.7510; train_gene_expr_recon_loss: 40802877.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43263288.4885; train_optim_loss: 43263288.4885; val_kl_reg_loss: 34910.2523; val_edge_recon_loss: 1794541.5583; val_cat_covariates_contrastive_loss: 640226.5125; val_gene_expr_recon_loss: 40592865.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43062544.2667; val_optim_loss: 43062544.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9567; val_auprc_score: 0.9693; val_best_acc_score: 0.9259; val_best_f1_score: 0.9465; train_kl_reg_loss: 34426.9917; train_edge_recon_loss: 1781293.8225; train_cat_covariates_contrastive_loss: 638126.2896; train_gene_expr_recon_loss: 40636685.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43090532.1221; train_optim_loss: 43090532.1221; val_kl_reg_loss: 33868.8161; val_edge_recon_loss: 1781406.4583; val_cat_covariates_contrastive_loss: 634802.0708; val_gene_expr_recon_loss: 40323154.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42773231.7333; val_optim_loss: 42773231.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9658; val_auprc_score: 0.9774; val_best_acc_score: 0.9373; val_best_f1_score: 0.9544; train_kl_reg_loss: 33451.7176; train_edge_recon_loss: 1781952.5830; train_cat_covariates_contrastive_loss: 638095.5033; train_gene_expr_recon_loss: 40516849.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42970349.2824; train_optim_loss: 42970349.2824; val_kl_reg_loss: 32972.3797; val_edge_recon_loss: 1771425.2250; val_cat_covariates_contrastive_loss: 634527.6792; val_gene_expr_recon_loss: 40153088.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42592014.1333; val_optim_loss: 42592014.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9603; val_auprc_score: 0.9749; val_best_acc_score: 0.9262; val_best_f1_score: 0.9470; train_kl_reg_loss: 32479.2921; train_edge_recon_loss: 1780475.2433; train_cat_covariates_contrastive_loss: 638105.5134; train_gene_expr_recon_loss: 40391320.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42842380.5802; train_optim_loss: 42842380.5802; val_kl_reg_loss: 32463.2357; val_edge_recon_loss: 1765001.3000; val_cat_covariates_contrastive_loss: 632153.3708; val_gene_expr_recon_loss: 40182105.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42611723.4667; val_optim_loss: 42611723.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9608; val_auprc_score: 0.9732; val_best_acc_score: 0.9318; val_best_f1_score: 0.9503; train_kl_reg_loss: 31577.1340; train_edge_recon_loss: 1780101.9466; train_cat_covariates_contrastive_loss: 636397.1670; train_gene_expr_recon_loss: 40261670.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42709747.1756; train_optim_loss: 42709747.1756; val_kl_reg_loss: 31952.8642; val_edge_recon_loss: 1794658.5583; val_cat_covariates_contrastive_loss: 633677.9792; val_gene_expr_recon_loss: 40062120.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42522410.1333; val_optim_loss: 42522410.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9632; val_auprc_score: 0.9749; val_best_acc_score: 0.9342; val_best_f1_score: 0.9526; train_kl_reg_loss: 30954.4791; train_edge_recon_loss: 1775986.8950; train_cat_covariates_contrastive_loss: 635860.4986; train_gene_expr_recon_loss: 40159134.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42601936.6718; train_optim_loss: 42601936.6718; val_kl_reg_loss: 30674.1057; val_edge_recon_loss: 1752916.2500; val_cat_covariates_contrastive_loss: 637568.9083; val_gene_expr_recon_loss: 39905281.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42326440.8000; val_optim_loss: 42326440.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9582; val_auprc_score: 0.9708; val_best_acc_score: 0.9345; val_best_f1_score: 0.9526; train_kl_reg_loss: 30090.3982; train_edge_recon_loss: 1770270.5725; train_cat_covariates_contrastive_loss: 636237.8115; train_gene_expr_recon_loss: 40017513.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42454112.2137; train_optim_loss: 42454112.2137; val_kl_reg_loss: 29681.0741; val_edge_recon_loss: 1799270.1833; val_cat_covariates_contrastive_loss: 636082.4625; val_gene_expr_recon_loss: 39835834.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42300868.5333; val_optim_loss: 42300868.5333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9627; val_auprc_score: 0.9731; val_best_acc_score: 0.9398; val_best_f1_score: 0.9563; train_kl_reg_loss: 29407.3223; train_edge_recon_loss: 1769084.4275; train_cat_covariates_contrastive_loss: 635933.1326; train_gene_expr_recon_loss: 39926790.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42361215.3893; train_optim_loss: 42361215.3893; val_kl_reg_loss: 28923.0837; val_edge_recon_loss: 1779073.7417; val_cat_covariates_contrastive_loss: 638084.2042; val_gene_expr_recon_loss: 39702323.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42148404.2667; val_optim_loss: 42148404.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9661; val_auprc_score: 0.9768; val_best_acc_score: 0.9339; val_best_f1_score: 0.9512; train_kl_reg_loss: 28625.5129; train_edge_recon_loss: 1757084.5716; train_cat_covariates_contrastive_loss: 636451.9976; train_gene_expr_recon_loss: 39810960.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42233122.1985; train_optim_loss: 42233122.1985; val_kl_reg_loss: 28807.1121; val_edge_recon_loss: 1830687.8583; val_cat_covariates_contrastive_loss: 636494.7833; val_gene_expr_recon_loss: 39699822.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42195812.2667; val_optim_loss: 42195812.2667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9615; val_auprc_score: 0.9745; val_best_acc_score: 0.9364; val_best_f1_score: 0.9538; train_kl_reg_loss: 27993.4493; train_edge_recon_loss: 1766555.4103; train_cat_covariates_contrastive_loss: 636211.8941; train_gene_expr_recon_loss: 39725434.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42156195.2977; train_optim_loss: 42156195.2977; val_kl_reg_loss: 27940.2589; val_edge_recon_loss: 1768020.4083; val_cat_covariates_contrastive_loss: 640997.0458; val_gene_expr_recon_loss: 39453109.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41890066.9333; val_optim_loss: 41890066.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9649; val_auprc_score: 0.9771; val_best_acc_score: 0.9378; val_best_f1_score: 0.9549; train_kl_reg_loss: 27359.3525; train_edge_recon_loss: 1750028.9685; train_cat_covariates_contrastive_loss: 636190.5344; train_gene_expr_recon_loss: 39646056.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42059635.1450; train_optim_loss: 42059635.1450; val_kl_reg_loss: 27538.9436; val_edge_recon_loss: 1753593.3667; val_cat_covariates_contrastive_loss: 638364.4125; val_gene_expr_recon_loss: 39484013.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41903509.6000; val_optim_loss: 41903509.6000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9607; val_auprc_score: 0.9700; val_best_acc_score: 0.9382; val_best_f1_score: 0.9554; train_kl_reg_loss: 26922.1353; train_edge_recon_loss: 1765664.3130; train_cat_covariates_contrastive_loss: 637449.0043; train_gene_expr_recon_loss: 39580528.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42010563.7863; train_optim_loss: 42010563.7863; val_kl_reg_loss: 27005.0805; val_edge_recon_loss: 1782441.6250; val_cat_covariates_contrastive_loss: 635257.7750; val_gene_expr_recon_loss: 39257751.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41702456.2667; val_optim_loss: 41702456.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9617; val_auprc_score: 0.9729; val_best_acc_score: 0.9387; val_best_f1_score: 0.9559; train_kl_reg_loss: 26519.2315; train_edge_recon_loss: 1760050.6498; train_cat_covariates_contrastive_loss: 635539.3931; train_gene_expr_recon_loss: 39490011.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41912120.3664; train_optim_loss: 41912120.3664; val_kl_reg_loss: 26294.1763; val_edge_recon_loss: 1765445.7833; val_cat_covariates_contrastive_loss: 635026.9000; val_gene_expr_recon_loss: 39337198.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41763964.8000; val_optim_loss: 41763964.8000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9693; val_auprc_score: 0.9801; val_best_acc_score: 0.9419; val_best_f1_score: 0.9577; train_kl_reg_loss: 25866.2852; train_edge_recon_loss: 1761154.4733; train_cat_covariates_contrastive_loss: 636298.6112; train_gene_expr_recon_loss: 39395832.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41819151.3588; train_optim_loss: 41819151.3588; val_kl_reg_loss: 25623.3477; val_edge_recon_loss: 1760265.0000; val_cat_covariates_contrastive_loss: 635419.3000; val_gene_expr_recon_loss: 39180459.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41601766.9333; val_optim_loss: 41601766.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9575; val_auprc_score: 0.9680; val_best_acc_score: 0.9337; val_best_f1_score: 0.9516; train_kl_reg_loss: 25660.5963; train_edge_recon_loss: 1756473.9399; train_cat_covariates_contrastive_loss: 637424.1713; train_gene_expr_recon_loss: 39359467.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41779026.6870; train_optim_loss: 41779026.6870; val_kl_reg_loss: 25203.7482; val_edge_recon_loss: 1786039.5083; val_cat_covariates_contrastive_loss: 632571.6708; val_gene_expr_recon_loss: 39047811.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41491626.9333; val_optim_loss: 41491626.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9643; val_auprc_score: 0.9768; val_best_acc_score: 0.9404; val_best_f1_score: 0.9571; train_kl_reg_loss: 25119.9413; train_edge_recon_loss: 1756387.1784; train_cat_covariates_contrastive_loss: 634992.0544; train_gene_expr_recon_loss: 39285948.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41702447.6336; train_optim_loss: 41702447.6336; val_kl_reg_loss: 24788.8887; val_edge_recon_loss: 1744368.1333; val_cat_covariates_contrastive_loss: 633409.3583; val_gene_expr_recon_loss: 39120774.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41523340.8000; val_optim_loss: 41523340.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9635; val_auprc_score: 0.9726; val_best_acc_score: 0.9420; val_best_f1_score: 0.9580; train_kl_reg_loss: 24653.5096; train_edge_recon_loss: 1758429.7767; train_cat_covariates_contrastive_loss: 637113.0062; train_gene_expr_recon_loss: 39246300.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41666496.6412; train_optim_loss: 41666496.6412; val_kl_reg_loss: 24345.0924; val_edge_recon_loss: 1759316.7750; val_cat_covariates_contrastive_loss: 636747.1542; val_gene_expr_recon_loss: 38985007.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41405416.8000; val_optim_loss: 41405416.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9659; val_auprc_score: 0.9770; val_best_acc_score: 0.9434; val_best_f1_score: 0.9595; train_kl_reg_loss: 24367.3313; train_edge_recon_loss: 1759721.8464; train_cat_covariates_contrastive_loss: 637555.3430; train_gene_expr_recon_loss: 39174752.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41596397.4656; train_optim_loss: 41596397.4656; val_kl_reg_loss: 23923.7428; val_edge_recon_loss: 1730872.6250; val_cat_covariates_contrastive_loss: 640267.3417; val_gene_expr_recon_loss: 38835995.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41231059.4667; val_optim_loss: 41231059.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9674; val_auprc_score: 0.9765; val_best_acc_score: 0.9460; val_best_f1_score: 0.9607; train_kl_reg_loss: 24157.7490; train_edge_recon_loss: 1756023.5954; train_cat_covariates_contrastive_loss: 637145.0706; train_gene_expr_recon_loss: 39123436.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41540763.0840; train_optim_loss: 41540763.0840; val_kl_reg_loss: 23780.8590; val_edge_recon_loss: 1769112.3333; val_cat_covariates_contrastive_loss: 639715.9417; val_gene_expr_recon_loss: 39009174.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41441783.7333; val_optim_loss: 41441783.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9648; val_auprc_score: 0.9748; val_best_acc_score: 0.9422; val_best_f1_score: 0.9582; train_kl_reg_loss: 23766.8071; train_edge_recon_loss: 1759171.2032; train_cat_covariates_contrastive_loss: 637876.3149; train_gene_expr_recon_loss: 39070538.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41491352.4885; train_optim_loss: 41491352.4885; val_kl_reg_loss: 23507.6796; val_edge_recon_loss: 1745473.8667; val_cat_covariates_contrastive_loss: 640361.3000; val_gene_expr_recon_loss: 38719602.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41128944.5333; val_optim_loss: 41128944.5333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9655; val_auprc_score: 0.9745; val_best_acc_score: 0.9445; val_best_f1_score: 0.9591; train_kl_reg_loss: 23428.4810; train_edge_recon_loss: 1752890.4074; train_cat_covariates_contrastive_loss: 636402.4437; train_gene_expr_recon_loss: 39008095.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41420816.4885; train_optim_loss: 41420816.4885; val_kl_reg_loss: 23227.5935; val_edge_recon_loss: 1797996.6083; val_cat_covariates_contrastive_loss: 638129.0667; val_gene_expr_recon_loss: 38801629.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41260983.4667; val_optim_loss: 41260983.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9631; val_auprc_score: 0.9742; val_best_acc_score: 0.9454; val_best_f1_score: 0.9607; train_kl_reg_loss: 23257.0310; train_edge_recon_loss: 1752134.1632; train_cat_covariates_contrastive_loss: 637490.0668; train_gene_expr_recon_loss: 38962973.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41375854.2901; train_optim_loss: 41375854.2901; val_kl_reg_loss: 23023.6095; val_edge_recon_loss: 1753636.2417; val_cat_covariates_contrastive_loss: 637480.4833; val_gene_expr_recon_loss: 38845005.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41259145.8667; val_optim_loss: 41259145.8667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9703; val_auprc_score: 0.9794; val_best_acc_score: 0.9473; val_best_f1_score: 0.9620; train_kl_reg_loss: 22927.1283; train_edge_recon_loss: 1754573.5811; train_cat_covariates_contrastive_loss: 636741.5506; train_gene_expr_recon_loss: 38926797.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41341039.4504; train_optim_loss: 41341039.4504; val_kl_reg_loss: 22986.8332; val_edge_recon_loss: 1708067.1333; val_cat_covariates_contrastive_loss: 643538.2958; val_gene_expr_recon_loss: 38548082.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40922675.2000; val_optim_loss: 40922675.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9662; val_auprc_score: 0.9769; val_best_acc_score: 0.9470; val_best_f1_score: 0.9620; train_kl_reg_loss: 22810.5733; train_edge_recon_loss: 1757252.6135; train_cat_covariates_contrastive_loss: 636067.6155; train_gene_expr_recon_loss: 38881368.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41297499.0840; train_optim_loss: 41297499.0840; val_kl_reg_loss: 22949.2725; val_edge_recon_loss: 1759382.1250; val_cat_covariates_contrastive_loss: 639864.6375; val_gene_expr_recon_loss: 38683886.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41106083.2000; val_optim_loss: 41106083.2000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9635; val_auprc_score: 0.9711; val_best_acc_score: 0.9417; val_best_f1_score: 0.9579; train_kl_reg_loss: 22611.4530; train_edge_recon_loss: 1750827.0525; train_cat_covariates_contrastive_loss: 636501.2028; train_gene_expr_recon_loss: 38885314.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41295253.9847; train_optim_loss: 41295253.9847; val_kl_reg_loss: 22585.3871; val_edge_recon_loss: 1775054.2750; val_cat_covariates_contrastive_loss: 635435.0208; val_gene_expr_recon_loss: 38801796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41234870.4000; val_optim_loss: 41234870.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9667; val_auprc_score: 0.9762; val_best_acc_score: 0.9463; val_best_f1_score: 0.9609; train_kl_reg_loss: 22455.0390; train_edge_recon_loss: 1742223.9685; train_cat_covariates_contrastive_loss: 637239.1131; train_gene_expr_recon_loss: 38827624.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41229542.9008; train_optim_loss: 41229542.9008; val_kl_reg_loss: 22216.6866; val_edge_recon_loss: 1742765.5750; val_cat_covariates_contrastive_loss: 638097.3458; val_gene_expr_recon_loss: 38664826.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41067905.6000; val_optim_loss: 41067905.6000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9675; val_auprc_score: 0.9766; val_best_acc_score: 0.9435; val_best_f1_score: 0.9596; train_kl_reg_loss: 22328.7122; train_edge_recon_loss: 1736793.5448; train_cat_covariates_contrastive_loss: 637306.0057; train_gene_expr_recon_loss: 38794401.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41190830.1374; train_optim_loss: 41190830.1374; val_kl_reg_loss: 22370.7052; val_edge_recon_loss: 1753136.5667; val_cat_covariates_contrastive_loss: 639485.8042; val_gene_expr_recon_loss: 38643618.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41058612.0000; val_optim_loss: 41058612.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9594; val_auprc_score: 0.9716; val_best_acc_score: 0.9442; val_best_f1_score: 0.9598; train_kl_reg_loss: 22398.8238; train_edge_recon_loss: 1741635.2920; train_cat_covariates_contrastive_loss: 636922.8669; train_gene_expr_recon_loss: 38732481.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41133438.3206; train_optim_loss: 41133438.3206; val_kl_reg_loss: 22404.9062; val_edge_recon_loss: 1751137.1500; val_cat_covariates_contrastive_loss: 642221.3125; val_gene_expr_recon_loss: 38752934.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41168697.6000; val_optim_loss: 41168697.6000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9715; val_auprc_score: 0.9793; val_best_acc_score: 0.9493; val_best_f1_score: 0.9628; train_kl_reg_loss: 22401.5799; train_edge_recon_loss: 1746686.6937; train_cat_covariates_contrastive_loss: 637392.1326; train_gene_expr_recon_loss: 38729459.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41135939.9695; train_optim_loss: 41135939.9695; val_kl_reg_loss: 22444.7652; val_edge_recon_loss: 1776976.3583; val_cat_covariates_contrastive_loss: 637884.7125; val_gene_expr_recon_loss: 38844052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41281357.8667; val_optim_loss: 41281357.8667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9662; val_auprc_score: 0.9767; val_best_acc_score: 0.9437; val_best_f1_score: 0.9592; train_kl_reg_loss: 22400.7936; train_edge_recon_loss: 1751867.4847; train_cat_covariates_contrastive_loss: 637090.8989; train_gene_expr_recon_loss: 38718903.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41130262.5038; train_optim_loss: 41130262.5038; val_kl_reg_loss: 22368.7277; val_edge_recon_loss: 1750977.0500; val_cat_covariates_contrastive_loss: 637833.6375; val_gene_expr_recon_loss: 38470667.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40881846.9333; val_optim_loss: 40881846.9333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9711; val_auprc_score: 0.9812; val_best_acc_score: 0.9504; val_best_f1_score: 0.9641; train_kl_reg_loss: 22323.2238; train_edge_recon_loss: 1757524.3979; train_cat_covariates_contrastive_loss: 635534.8998; train_gene_expr_recon_loss: 38694860.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41110242.8702; train_optim_loss: 41110242.8702; val_kl_reg_loss: 22360.2668; val_edge_recon_loss: 1694965.3167; val_cat_covariates_contrastive_loss: 634383.4375; val_gene_expr_recon_loss: 38689372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41041080.8000; val_optim_loss: 41041080.8000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9634; val_auprc_score: 0.9722; val_best_acc_score: 0.9436; val_best_f1_score: 0.9590; train_kl_reg_loss: 22329.3204; train_edge_recon_loss: 1741346.6412; train_cat_covariates_contrastive_loss: 636585.2066; train_gene_expr_recon_loss: 38731972.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41132233.2824; train_optim_loss: 41132233.2824; val_kl_reg_loss: 22258.3400; val_edge_recon_loss: 1771144.8667; val_cat_covariates_contrastive_loss: 636097.8125; val_gene_expr_recon_loss: 38469159.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40898660.2667; val_optim_loss: 40898660.2667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9644; val_auprc_score: 0.9740; val_best_acc_score: 0.9429; val_best_f1_score: 0.9587; train_kl_reg_loss: 22333.9137; train_edge_recon_loss: 1753488.8368; train_cat_covariates_contrastive_loss: 637782.5157; train_gene_expr_recon_loss: 38713922.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41127527.6641; train_optim_loss: 41127527.6641; val_kl_reg_loss: 22402.9435; val_edge_recon_loss: 1754606.3500; val_cat_covariates_contrastive_loss: 640858.1542; val_gene_expr_recon_loss: 38676969.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41094836.5333; val_optim_loss: 41094836.5333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9613; val_auprc_score: 0.9735; val_best_acc_score: 0.9437; val_best_f1_score: 0.9593; train_kl_reg_loss: 22309.9080; train_edge_recon_loss: 1754436.6813; train_cat_covariates_contrastive_loss: 637619.7257; train_gene_expr_recon_loss: 38715113.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41129479.8473; train_optim_loss: 41129479.8473; val_kl_reg_loss: 22337.7587; val_edge_recon_loss: 1763453.5333; val_cat_covariates_contrastive_loss: 633928.1375; val_gene_expr_recon_loss: 38638948.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41058668.0000; val_optim_loss: 41058668.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9668; val_auprc_score: 0.9770; val_best_acc_score: 0.9497; val_best_f1_score: 0.9637; train_kl_reg_loss: 22290.6480; train_edge_recon_loss: 1757646.6135; train_cat_covariates_contrastive_loss: 637349.1694; train_gene_expr_recon_loss: 38708807.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41126093.5878; train_optim_loss: 41126093.5878; val_kl_reg_loss: 22259.0318; val_edge_recon_loss: 1737326.5167; val_cat_covariates_contrastive_loss: 642950.8875; val_gene_expr_recon_loss: 38515458.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40917994.4000; val_optim_loss: 40917994.4000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9663; val_auprc_score: 0.9765; val_best_acc_score: 0.9489; val_best_f1_score: 0.9626; train_kl_reg_loss: 22289.8716; train_edge_recon_loss: 1744610.1498; train_cat_covariates_contrastive_loss: 637422.2739; train_gene_expr_recon_loss: 38698563.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41102885.4351; train_optim_loss: 41102885.4351; val_kl_reg_loss: 22305.5947; val_edge_recon_loss: 1770137.4750; val_cat_covariates_contrastive_loss: 638522.2167; val_gene_expr_recon_loss: 38559626.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40990592.2667; val_optim_loss: 40990592.2667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9613; val_auprc_score: 0.9711; val_best_acc_score: 0.9442; val_best_f1_score: 0.9595; train_kl_reg_loss: 22308.5322; train_edge_recon_loss: 1742799.4504; train_cat_covariates_contrastive_loss: 637520.8798; train_gene_expr_recon_loss: 38700388.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41103017.3130; train_optim_loss: 41103017.3130; val_kl_reg_loss: 22294.2560; val_edge_recon_loss: 1768111.0500; val_cat_covariates_contrastive_loss: 638120.3958; val_gene_expr_recon_loss: 38492209.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40920735.2000; val_optim_loss: 40920735.2000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9652; val_auprc_score: 0.9729; val_best_acc_score: 0.9460; val_best_f1_score: 0.9608; train_kl_reg_loss: 22316.4668; train_edge_recon_loss: 1743182.2462; train_cat_covariates_contrastive_loss: 636853.2586; train_gene_expr_recon_loss: 38700917.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41103269.7405; train_optim_loss: 41103269.7405; val_kl_reg_loss: 22376.6121; val_edge_recon_loss: 1785477.4250; val_cat_covariates_contrastive_loss: 635983.7333; val_gene_expr_recon_loss: 38549489.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40993327.7333; val_optim_loss: 40993327.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 22 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9545
val AUPRC score: 0.9670
val best accuracy score: 0.9365
val best F1 score: 0.9534
val target rna MSE score: 247.4873
val source rna MSE score: 133.7529
Val cat covariate0 mean sim diff: 0.0015
Val cat covariate1 mean sim diff: -0.0348
Duration of model training in run 2: 0 hours, 54 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
