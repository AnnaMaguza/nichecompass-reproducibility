First script finished. Launching follow up script.
Run timestamp: 02062023_065414.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9680; val_auprc_score: 0.9964; val_best_acc_score: 0.9768; val_best_f1_score: 0.9875; train_kl_reg_loss: 2042.4595; train_edge_recon_loss: 40834.7012; train_gene_expr_recon_loss: 99373.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142250.5495; train_optim_loss: 142250.5495; val_kl_reg_loss: 2055.4522; val_edge_recon_loss: 40431.1407; val_gene_expr_recon_loss: 95540.9579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138027.5512; val_optim_loss: 138027.5512
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9706; val_auprc_score: 0.9968; val_best_acc_score: 0.9793; val_best_f1_score: 0.9889; train_kl_reg_loss: 2167.4539; train_edge_recon_loss: 39935.9626; train_gene_expr_recon_loss: 94095.7766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136199.1929; train_optim_loss: 136199.1929; val_kl_reg_loss: 2120.8726; val_edge_recon_loss: 41005.0238; val_gene_expr_recon_loss: 92687.1323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135813.0285; val_optim_loss: 135813.0285
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9735; val_auprc_score: 0.9972; val_best_acc_score: 0.9802; val_best_f1_score: 0.9893; train_kl_reg_loss: 2259.0234; train_edge_recon_loss: 40108.2943; train_gene_expr_recon_loss: 92058.5864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134425.9039; train_optim_loss: 134425.9039; val_kl_reg_loss: 2193.7122; val_edge_recon_loss: 40592.6112; val_gene_expr_recon_loss: 91188.1876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133974.5112; val_optim_loss: 133974.5112
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9740; val_auprc_score: 0.9973; val_best_acc_score: 0.9802; val_best_f1_score: 0.9894; train_kl_reg_loss: 2335.6798; train_edge_recon_loss: 40004.8343; train_gene_expr_recon_loss: 90817.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133158.1391; train_optim_loss: 133158.1391; val_kl_reg_loss: 2315.5731; val_edge_recon_loss: 40770.1304; val_gene_expr_recon_loss: 90274.7265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133360.4291; val_optim_loss: 133360.4291
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9733; val_auprc_score: 0.9971; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2389.5883; train_edge_recon_loss: 40057.0993; train_gene_expr_recon_loss: 89951.6101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132398.2976; train_optim_loss: 132398.2976; val_kl_reg_loss: 2369.8721; val_edge_recon_loss: 41458.1590; val_gene_expr_recon_loss: 89477.1299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133305.1599; val_optim_loss: 133305.1599
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9755; val_auprc_score: 0.9974; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2429.4661; train_edge_recon_loss: 39981.2274; train_gene_expr_recon_loss: 89338.2825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131748.9759; train_optim_loss: 131748.9759; val_kl_reg_loss: 2349.0523; val_edge_recon_loss: 41687.1383; val_gene_expr_recon_loss: 89055.2918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133091.4830; val_optim_loss: 133091.4830
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9745; val_auprc_score: 0.9974; val_best_acc_score: 0.9809; val_best_f1_score: 0.9897; train_kl_reg_loss: 2461.8884; train_edge_recon_loss: 39935.7317; train_gene_expr_recon_loss: 88893.2200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131290.8401; train_optim_loss: 131290.8401; val_kl_reg_loss: 2418.5133; val_edge_recon_loss: 40830.1345; val_gene_expr_recon_loss: 88631.7519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131880.3996; val_optim_loss: 131880.3996
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9761; val_auprc_score: 0.9974; val_best_acc_score: 0.9809; val_best_f1_score: 0.9897; train_kl_reg_loss: 2490.6231; train_edge_recon_loss: 39953.0329; train_gene_expr_recon_loss: 88547.4876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130991.1437; train_optim_loss: 130991.1437; val_kl_reg_loss: 2421.3618; val_edge_recon_loss: 40957.3837; val_gene_expr_recon_loss: 88257.6790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131636.4252; val_optim_loss: 131636.4252
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9758; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9901; train_kl_reg_loss: 2514.7245; train_edge_recon_loss: 39988.2076; train_gene_expr_recon_loss: 88250.6241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130753.5562; train_optim_loss: 130753.5562; val_kl_reg_loss: 2467.0227; val_edge_recon_loss: 41125.2418; val_gene_expr_recon_loss: 88097.5978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131689.8626; val_optim_loss: 131689.8626
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9768; val_auprc_score: 0.9976; val_best_acc_score: 0.9817; val_best_f1_score: 0.9902; train_kl_reg_loss: 2532.1827; train_edge_recon_loss: 39985.5430; train_gene_expr_recon_loss: 88024.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130542.5364; train_optim_loss: 130542.5364; val_kl_reg_loss: 2499.0744; val_edge_recon_loss: 40556.0061; val_gene_expr_recon_loss: 87962.1656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131017.2466; val_optim_loss: 131017.2466
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9756; val_auprc_score: 0.9975; val_best_acc_score: 0.9816; val_best_f1_score: 0.9901; train_kl_reg_loss: 2543.2490; train_edge_recon_loss: 39944.8319; train_gene_expr_recon_loss: 87825.7892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130313.8700; train_optim_loss: 130313.8700; val_kl_reg_loss: 2481.9827; val_edge_recon_loss: 40995.6996; val_gene_expr_recon_loss: 87801.4310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131279.1129; val_optim_loss: 131279.1129
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9769; val_auprc_score: 0.9975; val_best_acc_score: 0.9813; val_best_f1_score: 0.9899; train_kl_reg_loss: 2553.0572; train_edge_recon_loss: 39813.1177; train_gene_expr_recon_loss: 87694.9150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130061.0900; train_optim_loss: 130061.0900; val_kl_reg_loss: 2476.9797; val_edge_recon_loss: 41152.5182; val_gene_expr_recon_loss: 87644.9025; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131274.4003; val_optim_loss: 131274.4003
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9754; val_auprc_score: 0.9974; val_best_acc_score: 0.9812; val_best_f1_score: 0.9899; train_kl_reg_loss: 2564.1778; train_edge_recon_loss: 39837.9011; train_gene_expr_recon_loss: 87524.8090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129926.8880; train_optim_loss: 129926.8880; val_kl_reg_loss: 2536.4541; val_edge_recon_loss: 41026.6348; val_gene_expr_recon_loss: 87609.9092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131172.9975; val_optim_loss: 131172.9975

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9771; val_auprc_score: 0.9976; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2533.9903; train_edge_recon_loss: 39746.7705; train_gene_expr_recon_loss: 87172.2334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129452.9944; train_optim_loss: 129452.9944; val_kl_reg_loss: 2471.5186; val_edge_recon_loss: 41126.2203; val_gene_expr_recon_loss: 87300.0918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130897.8311; val_optim_loss: 130897.8311
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9773; val_auprc_score: 0.9976; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2536.2149; train_edge_recon_loss: 39911.1699; train_gene_expr_recon_loss: 87143.9938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129591.3786; train_optim_loss: 129591.3786; val_kl_reg_loss: 2488.3525; val_edge_recon_loss: 41186.1829; val_gene_expr_recon_loss: 87193.8524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130868.3878; val_optim_loss: 130868.3878
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9773; val_auprc_score: 0.9976; val_best_acc_score: 0.9829; val_best_f1_score: 0.9908; train_kl_reg_loss: 2536.5996; train_edge_recon_loss: 39899.3515; train_gene_expr_recon_loss: 87084.7399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129520.6910; train_optim_loss: 129520.6910; val_kl_reg_loss: 2487.6397; val_edge_recon_loss: 40481.2184; val_gene_expr_recon_loss: 87237.9112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130206.7692; val_optim_loss: 130206.7692
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9768; val_auprc_score: 0.9976; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2531.3545; train_edge_recon_loss: 39695.8036; train_gene_expr_recon_loss: 87018.3019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129245.4600; train_optim_loss: 129245.4600; val_kl_reg_loss: 2479.7309; val_edge_recon_loss: 40811.4312; val_gene_expr_recon_loss: 87161.6199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130452.7819; val_optim_loss: 130452.7819
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9782; val_auprc_score: 0.9977; val_best_acc_score: 0.9825; val_best_f1_score: 0.9906; train_kl_reg_loss: 2534.9943; train_edge_recon_loss: 39916.2426; train_gene_expr_recon_loss: 87045.5430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129496.7800; train_optim_loss: 129496.7800; val_kl_reg_loss: 2484.8947; val_edge_recon_loss: 41334.4952; val_gene_expr_recon_loss: 87166.4697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130985.8596; val_optim_loss: 130985.8596
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9776; val_auprc_score: 0.9977; val_best_acc_score: 0.9826; val_best_f1_score: 0.9907; train_kl_reg_loss: 2532.9773; train_edge_recon_loss: 39879.0229; train_gene_expr_recon_loss: 87009.5976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129421.5977; train_optim_loss: 129421.5977; val_kl_reg_loss: 2500.6155; val_edge_recon_loss: 40521.7967; val_gene_expr_recon_loss: 87191.4791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130213.8918; val_optim_loss: 130213.8918

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9774; val_auprc_score: 0.9976; val_best_acc_score: 0.9828; val_best_f1_score: 0.9907; train_kl_reg_loss: 2530.2234; train_edge_recon_loss: 39911.2711; train_gene_expr_recon_loss: 86973.2592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129414.7537; train_optim_loss: 129414.7537; val_kl_reg_loss: 2484.9189; val_edge_recon_loss: 40599.2990; val_gene_expr_recon_loss: 87141.7911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130226.0092; val_optim_loss: 130226.0092
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9778; val_auprc_score: 0.9976; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2528.7569; train_edge_recon_loss: 39795.8873; train_gene_expr_recon_loss: 86948.0310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129272.6751; train_optim_loss: 129272.6751; val_kl_reg_loss: 2481.1798; val_edge_recon_loss: 41083.4086; val_gene_expr_recon_loss: 87108.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130672.6194; val_optim_loss: 130672.6194
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9779; val_auprc_score: 0.9976; val_best_acc_score: 0.9829; val_best_f1_score: 0.9908; train_kl_reg_loss: 2529.7451; train_edge_recon_loss: 39799.4332; train_gene_expr_recon_loss: 86952.9095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129282.0880; train_optim_loss: 129282.0880; val_kl_reg_loss: 2483.4215; val_edge_recon_loss: 40975.5776; val_gene_expr_recon_loss: 87112.6793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130571.6784; val_optim_loss: 130571.6784

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 129 min 32 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9774
Val AUPRC score: 0.9975
Val best accuracy score: 0.9822
Val best F1 score: 0.9904
Val gene expr MSE score: 0.7748
Duration of model training in run 1: 2 hours, 11 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9661; val_auprc_score: 0.9962; val_best_acc_score: 0.9772; val_best_f1_score: 0.9878; train_kl_reg_loss: 2043.2078; train_edge_recon_loss: 40838.0415; train_gene_expr_recon_loss: 99206.7325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142087.9817; train_optim_loss: 142087.9817; val_kl_reg_loss: 2217.1039; val_edge_recon_loss: 40124.7720; val_gene_expr_recon_loss: 95550.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137892.2307; val_optim_loss: 137892.2307
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9713; val_auprc_score: 0.9969; val_best_acc_score: 0.9789; val_best_f1_score: 0.9886; train_kl_reg_loss: 2172.7301; train_edge_recon_loss: 40126.0881; train_gene_expr_recon_loss: 93930.1838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136229.0018; train_optim_loss: 136229.0018; val_kl_reg_loss: 2209.9341; val_edge_recon_loss: 40807.8308; val_gene_expr_recon_loss: 92701.1265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135718.8916; val_optim_loss: 135718.8916
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9722; val_auprc_score: 0.9970; val_best_acc_score: 0.9796; val_best_f1_score: 0.9890; train_kl_reg_loss: 2259.9485; train_edge_recon_loss: 39998.1732; train_gene_expr_recon_loss: 91903.1126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134161.2345; train_optim_loss: 134161.2345; val_kl_reg_loss: 2230.6789; val_edge_recon_loss: 40871.5416; val_gene_expr_recon_loss: 91309.2529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134411.4734; val_optim_loss: 134411.4734
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9740; val_auprc_score: 0.9973; val_best_acc_score: 0.9801; val_best_f1_score: 0.9893; train_kl_reg_loss: 2331.3478; train_edge_recon_loss: 40071.0546; train_gene_expr_recon_loss: 90768.0869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133170.4895; train_optim_loss: 133170.4895; val_kl_reg_loss: 2308.6066; val_edge_recon_loss: 40975.6949; val_gene_expr_recon_loss: 90244.5073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133528.8085; val_optim_loss: 133528.8085
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9733; val_auprc_score: 0.9971; val_best_acc_score: 0.9805; val_best_f1_score: 0.9895; train_kl_reg_loss: 2382.2942; train_edge_recon_loss: 39829.7222; train_gene_expr_recon_loss: 89896.1815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132108.1979; train_optim_loss: 132108.1979; val_kl_reg_loss: 2378.2130; val_edge_recon_loss: 41496.2953; val_gene_expr_recon_loss: 89602.3876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133476.8957; val_optim_loss: 133476.8957
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9752; val_auprc_score: 0.9974; val_best_acc_score: 0.9810; val_best_f1_score: 0.9898; train_kl_reg_loss: 2427.5082; train_edge_recon_loss: 40082.7502; train_gene_expr_recon_loss: 89315.9816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131826.2401; train_optim_loss: 131826.2401; val_kl_reg_loss: 2365.2806; val_edge_recon_loss: 40980.1132; val_gene_expr_recon_loss: 89155.0858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132500.4789; val_optim_loss: 132500.4789
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9760; val_auprc_score: 0.9974; val_best_acc_score: 0.9816; val_best_f1_score: 0.9901; train_kl_reg_loss: 2462.4420; train_edge_recon_loss: 40124.3075; train_gene_expr_recon_loss: 88847.3850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131434.1343; train_optim_loss: 131434.1343; val_kl_reg_loss: 2460.2492; val_edge_recon_loss: 40650.6371; val_gene_expr_recon_loss: 88765.5559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131876.4424; val_optim_loss: 131876.4424
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9765; val_auprc_score: 0.9976; val_best_acc_score: 0.9804; val_best_f1_score: 0.9894; train_kl_reg_loss: 2480.1940; train_edge_recon_loss: 39825.5357; train_gene_expr_recon_loss: 88526.3310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130832.0605; train_optim_loss: 130832.0605; val_kl_reg_loss: 2488.8762; val_edge_recon_loss: 41232.5017; val_gene_expr_recon_loss: 88495.1131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132216.4904; val_optim_loss: 132216.4904
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9765; val_auprc_score: 0.9976; val_best_acc_score: 0.9810; val_best_f1_score: 0.9898; train_kl_reg_loss: 2499.3435; train_edge_recon_loss: 39906.4086; train_gene_expr_recon_loss: 88256.2538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130662.0059; train_optim_loss: 130662.0059; val_kl_reg_loss: 2480.7349; val_edge_recon_loss: 40821.5245; val_gene_expr_recon_loss: 88204.3619; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131506.6207; val_optim_loss: 131506.6207
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9746; val_auprc_score: 0.9973; val_best_acc_score: 0.9812; val_best_f1_score: 0.9899; train_kl_reg_loss: 2524.8087; train_edge_recon_loss: 39876.4489; train_gene_expr_recon_loss: 88019.1503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130420.4079; train_optim_loss: 130420.4079; val_kl_reg_loss: 2458.7362; val_edge_recon_loss: 40858.4714; val_gene_expr_recon_loss: 87947.8113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131265.0187; val_optim_loss: 131265.0187
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9752; val_auprc_score: 0.9974; val_best_acc_score: 0.9811; val_best_f1_score: 0.9899; train_kl_reg_loss: 2533.0637; train_edge_recon_loss: 39864.3610; train_gene_expr_recon_loss: 87833.3063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130230.7311; train_optim_loss: 130230.7311; val_kl_reg_loss: 2497.4253; val_edge_recon_loss: 41378.1469; val_gene_expr_recon_loss: 87836.2197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131711.7921; val_optim_loss: 131711.7921
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9743; val_auprc_score: 0.9972; val_best_acc_score: 0.9817; val_best_f1_score: 0.9902; train_kl_reg_loss: 2547.7468; train_edge_recon_loss: 39825.0613; train_gene_expr_recon_loss: 87685.8893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130058.6973; train_optim_loss: 130058.6973; val_kl_reg_loss: 2506.6468; val_edge_recon_loss: 41097.3445; val_gene_expr_recon_loss: 87747.8541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131351.8448; val_optim_loss: 131351.8448
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9770; val_auprc_score: 0.9976; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2555.0229; train_edge_recon_loss: 39953.9157; train_gene_expr_recon_loss: 87558.6919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130067.6303; train_optim_loss: 130067.6303; val_kl_reg_loss: 2553.2882; val_edge_recon_loss: 41402.3220; val_gene_expr_recon_loss: 87569.4631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131525.0734; val_optim_loss: 131525.0734

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9771; val_auprc_score: 0.9977; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2528.8510; train_edge_recon_loss: 39871.6055; train_gene_expr_recon_loss: 87171.5997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129572.0563; train_optim_loss: 129572.0563; val_kl_reg_loss: 2499.7495; val_edge_recon_loss: 40340.9815; val_gene_expr_recon_loss: 87355.7158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130196.4469; val_optim_loss: 130196.4469
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9771; val_auprc_score: 0.9976; val_best_acc_score: 0.9824; val_best_f1_score: 0.9905; train_kl_reg_loss: 2523.9027; train_edge_recon_loss: 39774.4017; train_gene_expr_recon_loss: 87108.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129406.5317; train_optim_loss: 129406.5317; val_kl_reg_loss: 2487.4897; val_edge_recon_loss: 40966.2605; val_gene_expr_recon_loss: 87339.7111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130793.4612; val_optim_loss: 130793.4612
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9773; val_auprc_score: 0.9976; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2524.2644; train_edge_recon_loss: 39767.9673; train_gene_expr_recon_loss: 87101.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129393.6587; train_optim_loss: 129393.6587; val_kl_reg_loss: 2484.4695; val_edge_recon_loss: 41060.1212; val_gene_expr_recon_loss: 87294.4332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130839.0245; val_optim_loss: 130839.0245
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9772; val_auprc_score: 0.9976; val_best_acc_score: 0.9824; val_best_f1_score: 0.9905; train_kl_reg_loss: 2526.4515; train_edge_recon_loss: 39812.0716; train_gene_expr_recon_loss: 87051.5480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129390.0711; train_optim_loss: 129390.0711; val_kl_reg_loss: 2462.4394; val_edge_recon_loss: 41223.3982; val_gene_expr_recon_loss: 87348.4439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131034.2818; val_optim_loss: 131034.2818

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9781; val_auprc_score: 0.9977; val_best_acc_score: 0.9828; val_best_f1_score: 0.9907; train_kl_reg_loss: 2522.5879; train_edge_recon_loss: 39913.7294; train_gene_expr_recon_loss: 86991.6889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129428.0061; train_optim_loss: 129428.0061; val_kl_reg_loss: 2476.1972; val_edge_recon_loss: 40547.2486; val_gene_expr_recon_loss: 87229.0181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130252.4641; val_optim_loss: 130252.4641
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9775; val_auprc_score: 0.9977; val_best_acc_score: 0.9827; val_best_f1_score: 0.9907; train_kl_reg_loss: 2521.0272; train_edge_recon_loss: 39812.4248; train_gene_expr_recon_loss: 86991.2415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129324.6935; train_optim_loss: 129324.6935; val_kl_reg_loss: 2471.8397; val_edge_recon_loss: 40486.6770; val_gene_expr_recon_loss: 87250.6604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130209.1771; val_optim_loss: 130209.1771
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9762; val_auprc_score: 0.9975; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2520.7779; train_edge_recon_loss: 39711.7091; train_gene_expr_recon_loss: 86981.3864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129213.8735; train_optim_loss: 129213.8735; val_kl_reg_loss: 2471.5931; val_edge_recon_loss: 41389.5667; val_gene_expr_recon_loss: 87284.6731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131145.8331; val_optim_loss: 131145.8331
First script finished. Launching follow up script.
Run timestamp: 02062023_113507.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_1pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 23576
Number of validation edges: 2619
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8281; val_auprc_score: 0.9791; val_best_acc_score: 0.9371; val_best_f1_score: 0.9670; train_kl_reg_loss: 441.3220; train_edge_recon_loss: 51583.6296; train_gene_expr_recon_loss: 128734.2572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 180759.2109; train_optim_loss: 180759.2109; val_kl_reg_loss: 701.3585; val_edge_recon_loss: 59147.4004; val_gene_expr_recon_loss: 103812.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 163661.6875; val_optim_loss: 163661.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8434; val_auprc_score: 0.9830; val_best_acc_score: 0.9470; val_best_f1_score: 0.9722; train_kl_reg_loss: 478.1535; train_edge_recon_loss: 50500.9697; train_gene_expr_recon_loss: 104390.0202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 155369.1432; train_optim_loss: 155369.1432; val_kl_reg_loss: 340.8013; val_edge_recon_loss: 50749.1387; val_gene_expr_recon_loss: 97059.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148149.1562; val_optim_loss: 148149.1562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7521; val_auprc_score: 0.9639; val_best_acc_score: 0.9291; val_best_f1_score: 0.9626; train_kl_reg_loss: 565.4160; train_edge_recon_loss: 50553.0596; train_gene_expr_recon_loss: 101569.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152687.5990; train_optim_loss: 152687.5990; val_kl_reg_loss: 853.6070; val_edge_recon_loss: 56775.0254; val_gene_expr_recon_loss: 103412.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 161041.2422; val_optim_loss: 161041.2422
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7215; val_auprc_score: 0.9658; val_best_acc_score: 0.9379; val_best_f1_score: 0.9674; train_kl_reg_loss: 1390.6931; train_edge_recon_loss: 48068.0980; train_gene_expr_recon_loss: 99814.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149273.7370; train_optim_loss: 149273.7370; val_kl_reg_loss: 1788.3479; val_edge_recon_loss: 45355.2207; val_gene_expr_recon_loss: 102241.5508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149385.1172; val_optim_loss: 149385.1172
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7553; val_auprc_score: 0.9653; val_best_acc_score: 0.9355; val_best_f1_score: 0.9658; train_kl_reg_loss: 1709.2733; train_edge_recon_loss: 45434.1312; train_gene_expr_recon_loss: 99228.3757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146371.7786; train_optim_loss: 146371.7786; val_kl_reg_loss: 1535.3002; val_edge_recon_loss: 50463.8398; val_gene_expr_recon_loss: 98840.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150839.4453; val_optim_loss: 150839.4453
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7363; val_auprc_score: 0.9652; val_best_acc_score: 0.9443; val_best_f1_score: 0.9708; train_kl_reg_loss: 1466.1771; train_edge_recon_loss: 45891.6624; train_gene_expr_recon_loss: 98986.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146344.0990; train_optim_loss: 146344.0990; val_kl_reg_loss: 1514.8792; val_edge_recon_loss: 44980.1523; val_gene_expr_recon_loss: 99943.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146438.2188; val_optim_loss: 146438.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7121; val_auprc_score: 0.9539; val_best_acc_score: 0.9296; val_best_f1_score: 0.9631; train_kl_reg_loss: 1610.7789; train_edge_recon_loss: 44362.0482; train_gene_expr_recon_loss: 98190.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144163.0052; train_optim_loss: 144163.0052; val_kl_reg_loss: 1653.2324; val_edge_recon_loss: 46989.8770; val_gene_expr_recon_loss: 102497.0117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151140.1172; val_optim_loss: 151140.1172
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7702; val_auprc_score: 0.9622; val_best_acc_score: 0.9363; val_best_f1_score: 0.9663; train_kl_reg_loss: 1564.1738; train_edge_recon_loss: 42369.0345; train_gene_expr_recon_loss: 97577.2012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141510.4089; train_optim_loss: 141510.4089; val_kl_reg_loss: 1391.2826; val_edge_recon_loss: 48356.8027; val_gene_expr_recon_loss: 96651.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146399.4297; val_optim_loss: 146399.4297
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7711; val_auprc_score: 0.9624; val_best_acc_score: 0.9338; val_best_f1_score: 0.9650; train_kl_reg_loss: 1571.7004; train_edge_recon_loss: 43824.4756; train_gene_expr_recon_loss: 97405.7611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142801.9375; train_optim_loss: 142801.9375; val_kl_reg_loss: 1755.0338; val_edge_recon_loss: 42757.2930; val_gene_expr_recon_loss: 96094.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140606.7969; val_optim_loss: 140606.7969
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7454; val_auprc_score: 0.9621; val_best_acc_score: 0.9347; val_best_f1_score: 0.9654; train_kl_reg_loss: 1829.8144; train_edge_recon_loss: 45657.1325; train_gene_expr_recon_loss: 97117.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144604.0690; train_optim_loss: 144604.0690; val_kl_reg_loss: 1670.4987; val_edge_recon_loss: 42939.9727; val_gene_expr_recon_loss: 99407.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144018.0078; val_optim_loss: 144018.0078
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7501; val_auprc_score: 0.9659; val_best_acc_score: 0.9422; val_best_f1_score: 0.9699; train_kl_reg_loss: 1639.0076; train_edge_recon_loss: 44197.1370; train_gene_expr_recon_loss: 97109.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142945.1797; train_optim_loss: 142945.1797; val_kl_reg_loss: 1529.8712; val_edge_recon_loss: 37911.4062; val_gene_expr_recon_loss: 94426.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133868.1797; val_optim_loss: 133868.1797
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7595; val_auprc_score: 0.9708; val_best_acc_score: 0.9446; val_best_f1_score: 0.9712; train_kl_reg_loss: 1668.1111; train_edge_recon_loss: 45242.4727; train_gene_expr_recon_loss: 96718.9225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143629.5052; train_optim_loss: 143629.5052; val_kl_reg_loss: 1674.4390; val_edge_recon_loss: 40470.2500; val_gene_expr_recon_loss: 100535.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142680.2969; val_optim_loss: 142680.2969
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7577; val_auprc_score: 0.9619; val_best_acc_score: 0.9332; val_best_f1_score: 0.9648; train_kl_reg_loss: 1686.8571; train_edge_recon_loss: 45164.0153; train_gene_expr_recon_loss: 96786.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143637.7318; train_optim_loss: 143637.7318; val_kl_reg_loss: 1619.7087; val_edge_recon_loss: 50531.0430; val_gene_expr_recon_loss: 94256.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146406.9766; val_optim_loss: 146406.9766
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7766; val_auprc_score: 0.9620; val_best_acc_score: 0.9385; val_best_f1_score: 0.9673; train_kl_reg_loss: 1798.9687; train_edge_recon_loss: 44395.0342; train_gene_expr_recon_loss: 96728.8685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142922.8724; train_optim_loss: 142922.8724; val_kl_reg_loss: 1577.8248; val_edge_recon_loss: 41462.2793; val_gene_expr_recon_loss: 92760.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135800.5938; val_optim_loss: 135800.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7704; val_auprc_score: 0.9645; val_best_acc_score: 0.9397; val_best_f1_score: 0.9682; train_kl_reg_loss: 1640.6807; train_edge_recon_loss: 44025.3031; train_gene_expr_recon_loss: 95875.6322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141541.6133; train_optim_loss: 141541.6133; val_kl_reg_loss: 1606.8673; val_edge_recon_loss: 47762.0234; val_gene_expr_recon_loss: 100427.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149795.9922; val_optim_loss: 149795.9922
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7850; val_auprc_score: 0.9613; val_best_acc_score: 0.9275; val_best_f1_score: 0.9615; train_kl_reg_loss: 1672.3464; train_edge_recon_loss: 43569.7227; train_gene_expr_recon_loss: 96033.7943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141275.8633; train_optim_loss: 141275.8633; val_kl_reg_loss: 1653.8289; val_edge_recon_loss: 52063.8203; val_gene_expr_recon_loss: 96430.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 150147.6797; val_optim_loss: 150147.6797
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7587; val_auprc_score: 0.9694; val_best_acc_score: 0.9373; val_best_f1_score: 0.9671; train_kl_reg_loss: 1696.2617; train_edge_recon_loss: 44636.0947; train_gene_expr_recon_loss: 95852.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142184.6523; train_optim_loss: 142184.6523; val_kl_reg_loss: 1652.0107; val_edge_recon_loss: 44100.0801; val_gene_expr_recon_loss: 97052.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142804.4688; val_optim_loss: 142804.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 28 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.7310
Val AUPRC score: 0.9617
Val best accuracy score: 0.9359
Val best F1 score: 0.9663
Val gene expr MSE score: 0.8059
Duration of model training in run 1: 0 hours, 0 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 23576
Number of validation edges: 2619
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8289; val_auprc_score: 0.9822; val_best_acc_score: 0.9395; val_best_f1_score: 0.9683; train_kl_reg_loss: 380.5662; train_edge_recon_loss: 50883.3721; train_gene_expr_recon_loss: 122163.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173427.8724; train_optim_loss: 173427.8724; val_kl_reg_loss: 470.1935; val_edge_recon_loss: 53323.6719; val_gene_expr_recon_loss: 101944.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 155738.1484; val_optim_loss: 155738.1484
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8282; val_auprc_score: 0.9774; val_best_acc_score: 0.9370; val_best_f1_score: 0.9670; train_kl_reg_loss: 376.5482; train_edge_recon_loss: 47082.0488; train_gene_expr_recon_loss: 103015.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150473.6940; train_optim_loss: 150473.6940; val_kl_reg_loss: 467.8642; val_edge_recon_loss: 49888.1172; val_gene_expr_recon_loss: 98864.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149220.3828; val_optim_loss: 149220.3828
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7375; val_auprc_score: 0.9599; val_best_acc_score: 0.9268; val_best_f1_score: 0.9614; train_kl_reg_loss: 600.6332; train_edge_recon_loss: 48849.2090; train_gene_expr_recon_loss: 100994.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 150443.9297; train_optim_loss: 150443.9297; val_kl_reg_loss: 885.2742; val_edge_recon_loss: 55187.4102; val_gene_expr_recon_loss: 101753.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157825.9922; val_optim_loss: 157825.9922
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7735; val_auprc_score: 0.9701; val_best_acc_score: 0.9331; val_best_f1_score: 0.9648; train_kl_reg_loss: 1467.9470; train_edge_recon_loss: 45527.9342; train_gene_expr_recon_loss: 99725.8034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146721.6836; train_optim_loss: 146721.6836; val_kl_reg_loss: 1796.6500; val_edge_recon_loss: 45448.0039; val_gene_expr_recon_loss: 100511.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147756.0234; val_optim_loss: 147756.0234
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7587; val_auprc_score: 0.9668; val_best_acc_score: 0.9400; val_best_f1_score: 0.9682; train_kl_reg_loss: 1689.7804; train_edge_recon_loss: 45290.4391; train_gene_expr_recon_loss: 99056.7637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146036.9844; train_optim_loss: 146036.9844; val_kl_reg_loss: 1516.4048; val_edge_recon_loss: 44030.5391; val_gene_expr_recon_loss: 102329.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 147876.6172; val_optim_loss: 147876.6172
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7645; val_auprc_score: 0.9695; val_best_acc_score: 0.9429; val_best_f1_score: 0.9700; train_kl_reg_loss: 1524.2207; train_edge_recon_loss: 45348.7715; train_gene_expr_recon_loss: 98368.2116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145241.2031; train_optim_loss: 145241.2031; val_kl_reg_loss: 1298.7712; val_edge_recon_loss: 41558.9863; val_gene_expr_recon_loss: 96604.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139462.5000; val_optim_loss: 139462.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7814; val_auprc_score: 0.9669; val_best_acc_score: 0.9356; val_best_f1_score: 0.9660; train_kl_reg_loss: 1425.2559; train_edge_recon_loss: 44815.8363; train_gene_expr_recon_loss: 97948.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144189.5143; train_optim_loss: 144189.5143; val_kl_reg_loss: 1597.6686; val_edge_recon_loss: 47050.8223; val_gene_expr_recon_loss: 99800.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148448.7344; val_optim_loss: 148448.7344
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7536; val_auprc_score: 0.9611; val_best_acc_score: 0.9309; val_best_f1_score: 0.9636; train_kl_reg_loss: 1750.6583; train_edge_recon_loss: 43423.0775; train_gene_expr_recon_loss: 97960.5176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143134.2539; train_optim_loss: 143134.2539; val_kl_reg_loss: 1718.3148; val_edge_recon_loss: 48948.2090; val_gene_expr_recon_loss: 92060.1836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142726.7031; val_optim_loss: 142726.7031
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7754; val_auprc_score: 0.9687; val_best_acc_score: 0.9444; val_best_f1_score: 0.9706; train_kl_reg_loss: 1730.4951; train_edge_recon_loss: 44753.4385; train_gene_expr_recon_loss: 97552.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144036.5234; train_optim_loss: 144036.5234; val_kl_reg_loss: 1580.7603; val_edge_recon_loss: 43574.1035; val_gene_expr_recon_loss: 97438.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142593.1406; val_optim_loss: 142593.1406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7531; val_auprc_score: 0.9677; val_best_acc_score: 0.9449; val_best_f1_score: 0.9711; train_kl_reg_loss: 1629.7848; train_edge_recon_loss: 44970.5771; train_gene_expr_recon_loss: 96763.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143363.4844; train_optim_loss: 143363.4844; val_kl_reg_loss: 1508.1650; val_edge_recon_loss: 41173.3672; val_gene_expr_recon_loss: 98644.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141325.5469; val_optim_loss: 141325.5469
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7693; val_auprc_score: 0.9643; val_best_acc_score: 0.9376; val_best_f1_score: 0.9669; train_kl_reg_loss: 1621.9477; train_edge_recon_loss: 43312.1143; train_gene_expr_recon_loss: 97128.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142062.9453; train_optim_loss: 142062.9453; val_kl_reg_loss: 1599.9615; val_edge_recon_loss: 45127.9238; val_gene_expr_recon_loss: 93468.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140196.5547; val_optim_loss: 140196.5547
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7419; val_auprc_score: 0.9573; val_best_acc_score: 0.9358; val_best_f1_score: 0.9662; train_kl_reg_loss: 1669.5743; train_edge_recon_loss: 43431.7132; train_gene_expr_recon_loss: 96954.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142055.6901; train_optim_loss: 142055.6901; val_kl_reg_loss: 1611.4500; val_edge_recon_loss: 48140.5488; val_gene_expr_recon_loss: 103079.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 152831.5156; val_optim_loss: 152831.5156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 18 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.7472
Val AUPRC score: 0.9639
Val best accuracy score: 0.9470
Val best F1 score: 0.9722
Val gene expr MSE score: 1.0327
Duration of model training in run 2: 0 hours, 0 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 45787
Number of validation edges: 5087
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8056; val_auprc_score: 0.9751; val_best_acc_score: 0.9462; val_best_f1_score: 0.9718; train_kl_reg_loss: 499.4581; train_edge_recon_loss: 50733.6278; train_gene_expr_recon_loss: 108491.1703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159724.2549; train_optim_loss: 159724.2549; val_kl_reg_loss: 728.5351; val_edge_recon_loss: 47837.9289; val_gene_expr_recon_loss: 99621.9625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148188.4281; val_optim_loss: 148188.4281
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7841; val_auprc_score: 0.9695; val_best_acc_score: 0.9448; val_best_f1_score: 0.9709; train_kl_reg_loss: 1404.2073; train_edge_recon_loss: 47126.1247; train_gene_expr_recon_loss: 98096.6130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146626.9431; train_optim_loss: 146626.9431; val_kl_reg_loss: 1668.9311; val_edge_recon_loss: 45418.1867; val_gene_expr_recon_loss: 97804.1938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144891.3094; val_optim_loss: 144891.3094
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7736; val_auprc_score: 0.9690; val_best_acc_score: 0.9481; val_best_f1_score: 0.9728; train_kl_reg_loss: 1606.4453; train_edge_recon_loss: 44861.8694; train_gene_expr_recon_loss: 97117.6858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143585.9991; train_optim_loss: 143585.9991; val_kl_reg_loss: 1670.5985; val_edge_recon_loss: 42331.9195; val_gene_expr_recon_loss: 97181.1922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141183.7125; val_optim_loss: 141183.7125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7924; val_auprc_score: 0.9721; val_best_acc_score: 0.9443; val_best_f1_score: 0.9707; train_kl_reg_loss: 1632.2614; train_edge_recon_loss: 43919.8841; train_gene_expr_recon_loss: 96184.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141736.1681; train_optim_loss: 141736.1681; val_kl_reg_loss: 1580.0296; val_edge_recon_loss: 43968.4242; val_gene_expr_recon_loss: 96097.8391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141646.2938; val_optim_loss: 141646.2938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8147; val_auprc_score: 0.9765; val_best_acc_score: 0.9492; val_best_f1_score: 0.9733; train_kl_reg_loss: 1685.4423; train_edge_recon_loss: 43335.4733; train_gene_expr_recon_loss: 95544.2352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140565.1516; train_optim_loss: 140565.1516; val_kl_reg_loss: 1693.9777; val_edge_recon_loss: 41389.6641; val_gene_expr_recon_loss: 95843.6844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138927.3281; val_optim_loss: 138927.3281
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8308; val_auprc_score: 0.9807; val_best_acc_score: 0.9549; val_best_f1_score: 0.9763; train_kl_reg_loss: 1688.0228; train_edge_recon_loss: 44303.5526; train_gene_expr_recon_loss: 95328.8057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141320.3819; train_optim_loss: 141320.3819; val_kl_reg_loss: 1655.6518; val_edge_recon_loss: 38918.9695; val_gene_expr_recon_loss: 94961.0906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135535.7156; val_optim_loss: 135535.7156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8286; val_auprc_score: 0.9776; val_best_acc_score: 0.9437; val_best_f1_score: 0.9701; train_kl_reg_loss: 1747.6052; train_edge_recon_loss: 44114.1487; train_gene_expr_recon_loss: 95085.7892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140947.5424; train_optim_loss: 140947.5424; val_kl_reg_loss: 1795.3728; val_edge_recon_loss: 44439.2063; val_gene_expr_recon_loss: 96065.7047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142300.2812; val_optim_loss: 142300.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8461; val_auprc_score: 0.9775; val_best_acc_score: 0.9483; val_best_f1_score: 0.9725; train_kl_reg_loss: 1718.9811; train_edge_recon_loss: 43421.7863; train_gene_expr_recon_loss: 94845.9118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139986.6786; train_optim_loss: 139986.6786; val_kl_reg_loss: 1628.5797; val_edge_recon_loss: 44961.8383; val_gene_expr_recon_loss: 94926.1703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141516.5875; val_optim_loss: 141516.5875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8705; val_auprc_score: 0.9843; val_best_acc_score: 0.9523; val_best_f1_score: 0.9747; train_kl_reg_loss: 1720.6451; train_edge_recon_loss: 43542.6788; train_gene_expr_recon_loss: 94643.9872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139907.3108; train_optim_loss: 139907.3108; val_kl_reg_loss: 1637.2695; val_edge_recon_loss: 41174.0219; val_gene_expr_recon_loss: 95978.0719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138789.3625; val_optim_loss: 138789.3625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8591; val_auprc_score: 0.9816; val_best_acc_score: 0.9497; val_best_f1_score: 0.9733; train_kl_reg_loss: 1684.5414; train_edge_recon_loss: 42790.5332; train_gene_expr_recon_loss: 93822.6448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138297.7191; train_optim_loss: 138297.7191; val_kl_reg_loss: 1673.6630; val_edge_recon_loss: 43214.2195; val_gene_expr_recon_loss: 94851.8687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139739.7500; val_optim_loss: 139739.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8819; val_auprc_score: 0.9858; val_best_acc_score: 0.9532; val_best_f1_score: 0.9752; train_kl_reg_loss: 1729.1330; train_edge_recon_loss: 43004.5910; train_gene_expr_recon_loss: 93217.5135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137951.2368; train_optim_loss: 137951.2368; val_kl_reg_loss: 1696.5279; val_edge_recon_loss: 40978.9414; val_gene_expr_recon_loss: 94106.2906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136781.7625; val_optim_loss: 136781.7625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8626; val_auprc_score: 0.9810; val_best_acc_score: 0.9486; val_best_f1_score: 0.9727; train_kl_reg_loss: 1749.7064; train_edge_recon_loss: 41798.9197; train_gene_expr_recon_loss: 93296.7738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136845.4012; train_optim_loss: 136845.4012; val_kl_reg_loss: 1708.9250; val_edge_recon_loss: 43603.4883; val_gene_expr_recon_loss: 93963.5734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139275.9844; val_optim_loss: 139275.9844

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 51 sec.
Using best model state, which was in epoch 6.

--- MODEL EVALUATION ---
Val AUROC score: 0.8194
Val AUPRC score: 0.9759
Val best accuracy score: 0.9495
Val best F1 score: 0.9733
Val gene expr MSE score: 0.8158
Duration of model training in run 3: 0 hours, 0 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 45787
Number of validation edges: 5087
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7825; val_auprc_score: 0.9717; val_best_acc_score: 0.9445; val_best_f1_score: 0.9707; train_kl_reg_loss: 489.3482; train_edge_recon_loss: 50750.5411; train_gene_expr_recon_loss: 109034.9056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160274.7951; train_optim_loss: 160274.7951; val_kl_reg_loss: 704.2136; val_edge_recon_loss: 49520.4125; val_gene_expr_recon_loss: 101614.4172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151839.0438; val_optim_loss: 151839.0438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7450; val_auprc_score: 0.9653; val_best_acc_score: 0.9503; val_best_f1_score: 0.9739; train_kl_reg_loss: 1287.7363; train_edge_recon_loss: 47481.8773; train_gene_expr_recon_loss: 98453.1977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147222.8101; train_optim_loss: 147222.8101; val_kl_reg_loss: 1352.9015; val_edge_recon_loss: 43746.9086; val_gene_expr_recon_loss: 98185.9828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143285.7906; val_optim_loss: 143285.7906
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7922; val_auprc_score: 0.9714; val_best_acc_score: 0.9424; val_best_f1_score: 0.9695; train_kl_reg_loss: 1486.9627; train_edge_recon_loss: 44979.2216; train_gene_expr_recon_loss: 97331.1031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143797.2872; train_optim_loss: 143797.2872; val_kl_reg_loss: 1539.5613; val_edge_recon_loss: 47158.6086; val_gene_expr_recon_loss: 99504.5797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148202.7469; val_optim_loss: 148202.7469
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8050; val_auprc_score: 0.9738; val_best_acc_score: 0.9491; val_best_f1_score: 0.9732; train_kl_reg_loss: 1598.2385; train_edge_recon_loss: 44495.6272; train_gene_expr_recon_loss: 96546.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142640.2698; train_optim_loss: 142640.2698; val_kl_reg_loss: 1515.6493; val_edge_recon_loss: 42562.4406; val_gene_expr_recon_loss: 97797.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141875.7125; val_optim_loss: 141875.7125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8151; val_auprc_score: 0.9731; val_best_acc_score: 0.9472; val_best_f1_score: 0.9721; train_kl_reg_loss: 1590.1761; train_edge_recon_loss: 44987.3274; train_gene_expr_recon_loss: 96263.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142841.2128; train_optim_loss: 142841.2128; val_kl_reg_loss: 1765.1911; val_edge_recon_loss: 43471.6836; val_gene_expr_recon_loss: 97102.9469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142339.8219; val_optim_loss: 142339.8219
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8241; val_auprc_score: 0.9731; val_best_acc_score: 0.9471; val_best_f1_score: 0.9719; train_kl_reg_loss: 1696.6589; train_edge_recon_loss: 45076.8559; train_gene_expr_recon_loss: 95760.0753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142533.5885; train_optim_loss: 142533.5885; val_kl_reg_loss: 1698.8493; val_edge_recon_loss: 44713.0563; val_gene_expr_recon_loss: 97375.6703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143787.5812; val_optim_loss: 143787.5812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8163; val_auprc_score: 0.9723; val_best_acc_score: 0.9412; val_best_f1_score: 0.9688; train_kl_reg_loss: 1653.4470; train_edge_recon_loss: 41911.8882; train_gene_expr_recon_loss: 95229.7175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138795.0542; train_optim_loss: 138795.0542; val_kl_reg_loss: 1489.6021; val_edge_recon_loss: 48033.9062; val_gene_expr_recon_loss: 99409.3109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 148932.8156; val_optim_loss: 148932.8156

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8412; val_auprc_score: 0.9775; val_best_acc_score: 0.9475; val_best_f1_score: 0.9720; train_kl_reg_loss: 1619.2439; train_edge_recon_loss: 43481.7511; train_gene_expr_recon_loss: 94353.2531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139454.2483; train_optim_loss: 139454.2483; val_kl_reg_loss: 1711.5320; val_edge_recon_loss: 45109.0250; val_gene_expr_recon_loss: 98332.7594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145153.3125; val_optim_loss: 145153.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8682; val_auprc_score: 0.9843; val_best_acc_score: 0.9525; val_best_f1_score: 0.9749; train_kl_reg_loss: 1715.3009; train_edge_recon_loss: 42554.5690; train_gene_expr_recon_loss: 93897.9181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138167.7875; train_optim_loss: 138167.7875; val_kl_reg_loss: 1720.4540; val_edge_recon_loss: 39310.0078; val_gene_expr_recon_loss: 95840.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136870.5375; val_optim_loss: 136870.5375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8599; val_auprc_score: 0.9824; val_best_acc_score: 0.9514; val_best_f1_score: 0.9742; train_kl_reg_loss: 1710.6976; train_edge_recon_loss: 41466.4793; train_gene_expr_recon_loss: 93806.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136983.3306; train_optim_loss: 136983.3306; val_kl_reg_loss: 1732.3635; val_edge_recon_loss: 42246.1633; val_gene_expr_recon_loss: 97188.0953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141166.6250; val_optim_loss: 141166.6250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8536; val_auprc_score: 0.9787; val_best_acc_score: 0.9491; val_best_f1_score: 0.9731; train_kl_reg_loss: 1740.0252; train_edge_recon_loss: 43455.9203; train_gene_expr_recon_loss: 93857.3986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139053.3438; train_optim_loss: 139053.3438; val_kl_reg_loss: 1681.9184; val_edge_recon_loss: 42172.0414; val_gene_expr_recon_loss: 97921.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141775.9531; val_optim_loss: 141775.9531
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8345; val_auprc_score: 0.9770; val_best_acc_score: 0.9454; val_best_f1_score: 0.9710; train_kl_reg_loss: 1670.2094; train_edge_recon_loss: 42271.3622; train_gene_expr_recon_loss: 93835.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137777.5425; train_optim_loss: 137777.5425; val_kl_reg_loss: 1693.7165; val_edge_recon_loss: 44986.1203; val_gene_expr_recon_loss: 97134.1531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143813.9937; val_optim_loss: 143813.9937

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8485; val_auprc_score: 0.9799; val_best_acc_score: 0.9464; val_best_f1_score: 0.9715; train_kl_reg_loss: 1691.9859; train_edge_recon_loss: 43107.1648; train_gene_expr_recon_loss: 93899.8858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138699.0368; train_optim_loss: 138699.0368; val_kl_reg_loss: 1684.8865; val_edge_recon_loss: 45157.9281; val_gene_expr_recon_loss: 95920.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142763.0875; val_optim_loss: 142763.0875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8445; val_auprc_score: 0.9802; val_best_acc_score: 0.9523; val_best_f1_score: 0.9748; train_kl_reg_loss: 1687.0488; train_edge_recon_loss: 42853.2734; train_gene_expr_recon_loss: 93607.7040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138148.0267; train_optim_loss: 138148.0267; val_kl_reg_loss: 1683.6170; val_edge_recon_loss: 39673.2801; val_gene_expr_recon_loss: 96489.7391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137846.6375; val_optim_loss: 137846.6375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8597; val_auprc_score: 0.9801; val_best_acc_score: 0.9468; val_best_f1_score: 0.9716; train_kl_reg_loss: 1692.3542; train_edge_recon_loss: 42668.4007; train_gene_expr_recon_loss: 93506.3373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137867.0927; train_optim_loss: 137867.0927; val_kl_reg_loss: 1692.2454; val_edge_recon_loss: 44778.5508; val_gene_expr_recon_loss: 96970.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143441.7844; val_optim_loss: 143441.7844

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 5 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.8380
Val AUPRC score: 0.9764
Val best accuracy score: 0.9465
Val best F1 score: 0.9714
Val gene expr MSE score: 0.9453
Duration of model training in run 4: 0 hours, 1 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 67989
Number of validation edges: 7554
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7839; val_auprc_score: 0.9715; val_best_acc_score: 0.9460; val_best_f1_score: 0.9715; train_kl_reg_loss: 982.9543; train_edge_recon_loss: 48572.8861; train_gene_expr_recon_loss: 102592.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 152148.7911; train_optim_loss: 152148.7911; val_kl_reg_loss: 1295.5742; val_edge_recon_loss: 44936.0497; val_gene_expr_recon_loss: 95698.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141929.7687; val_optim_loss: 141929.7687
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8345; val_auprc_score: 0.9778; val_best_acc_score: 0.9445; val_best_f1_score: 0.9706; train_kl_reg_loss: 1543.4963; train_edge_recon_loss: 45867.1177; train_gene_expr_recon_loss: 96333.7262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143744.3403; train_optim_loss: 143744.3403; val_kl_reg_loss: 1563.5969; val_edge_recon_loss: 46034.7508; val_gene_expr_recon_loss: 94108.2755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141706.6234; val_optim_loss: 141706.6234
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8252; val_auprc_score: 0.9757; val_best_acc_score: 0.9491; val_best_f1_score: 0.9730; train_kl_reg_loss: 1656.5455; train_edge_recon_loss: 43365.9772; train_gene_expr_recon_loss: 95502.7945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140525.3163; train_optim_loss: 140525.3163; val_kl_reg_loss: 1647.8916; val_edge_recon_loss: 45365.2107; val_gene_expr_recon_loss: 94093.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141106.1708; val_optim_loss: 141106.1708
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8427; val_auprc_score: 0.9789; val_best_acc_score: 0.9504; val_best_f1_score: 0.9738; train_kl_reg_loss: 1673.1923; train_edge_recon_loss: 42565.5838; train_gene_expr_recon_loss: 94901.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139140.2247; train_optim_loss: 139140.2247; val_kl_reg_loss: 1735.6594; val_edge_recon_loss: 43749.4391; val_gene_expr_recon_loss: 91906.8130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137391.9104; val_optim_loss: 137391.9104
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8884; val_auprc_score: 0.9863; val_best_acc_score: 0.9563; val_best_f1_score: 0.9768; train_kl_reg_loss: 1719.0958; train_edge_recon_loss: 43582.5715; train_gene_expr_recon_loss: 94412.9380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139714.6049; train_optim_loss: 139714.6049; val_kl_reg_loss: 1809.2572; val_edge_recon_loss: 41241.6964; val_gene_expr_recon_loss: 92478.9490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135529.9010; val_optim_loss: 135529.9010
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9161; val_auprc_score: 0.9891; val_best_acc_score: 0.9594; val_best_f1_score: 0.9784; train_kl_reg_loss: 1818.8083; train_edge_recon_loss: 41977.7218; train_gene_expr_recon_loss: 93773.4207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137569.9515; train_optim_loss: 137569.9515; val_kl_reg_loss: 1800.3368; val_edge_recon_loss: 40673.8690; val_gene_expr_recon_loss: 92456.3188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134930.5234; val_optim_loss: 134930.5234
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9198; val_auprc_score: 0.9914; val_best_acc_score: 0.9614; val_best_f1_score: 0.9794; train_kl_reg_loss: 1820.8905; train_edge_recon_loss: 42081.0554; train_gene_expr_recon_loss: 93191.3564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137093.3020; train_optim_loss: 137093.3020; val_kl_reg_loss: 1846.1818; val_edge_recon_loss: 40241.5462; val_gene_expr_recon_loss: 92963.2177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135050.9469; val_optim_loss: 135050.9469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9220; val_auprc_score: 0.9912; val_best_acc_score: 0.9602; val_best_f1_score: 0.9789; train_kl_reg_loss: 1902.0717; train_edge_recon_loss: 41032.7389; train_gene_expr_recon_loss: 92841.5252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135776.3356; train_optim_loss: 135776.3356; val_kl_reg_loss: 1741.2397; val_edge_recon_loss: 39828.7090; val_gene_expr_recon_loss: 91319.8115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132889.7599; val_optim_loss: 132889.7599
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9310; val_auprc_score: 0.9912; val_best_acc_score: 0.9639; val_best_f1_score: 0.9807; train_kl_reg_loss: 1877.1838; train_edge_recon_loss: 41140.2669; train_gene_expr_recon_loss: 92532.8325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135550.2830; train_optim_loss: 135550.2830; val_kl_reg_loss: 1903.9601; val_edge_recon_loss: 43411.5437; val_gene_expr_recon_loss: 91300.2365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136615.7406; val_optim_loss: 136615.7406
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9405; val_auprc_score: 0.9914; val_best_acc_score: 0.9677; val_best_f1_score: 0.9827; train_kl_reg_loss: 1918.7233; train_edge_recon_loss: 40681.8993; train_gene_expr_recon_loss: 91950.2218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134550.8447; train_optim_loss: 134550.8447; val_kl_reg_loss: 1934.2090; val_edge_recon_loss: 40412.1061; val_gene_expr_recon_loss: 91266.3865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133612.7031; val_optim_loss: 133612.7031
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9427; val_auprc_score: 0.9930; val_best_acc_score: 0.9704; val_best_f1_score: 0.9841; train_kl_reg_loss: 1895.6973; train_edge_recon_loss: 41135.8033; train_gene_expr_recon_loss: 91714.0700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134745.5698; train_optim_loss: 134745.5698; val_kl_reg_loss: 1876.9378; val_edge_recon_loss: 40986.3777; val_gene_expr_recon_loss: 91916.4464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134779.7635; val_optim_loss: 134779.7635

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9326; val_auprc_score: 0.9917; val_best_acc_score: 0.9667; val_best_f1_score: 0.9823; train_kl_reg_loss: 1914.9567; train_edge_recon_loss: 39736.3018; train_gene_expr_recon_loss: 90686.5524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132337.8109; train_optim_loss: 132337.8109; val_kl_reg_loss: 1892.0983; val_edge_recon_loss: 39465.4777; val_gene_expr_recon_loss: 89533.4073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130890.9844; val_optim_loss: 130890.9844
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9503; val_auprc_score: 0.9942; val_best_acc_score: 0.9723; val_best_f1_score: 0.9851; train_kl_reg_loss: 1917.3127; train_edge_recon_loss: 40515.1354; train_gene_expr_recon_loss: 90041.9996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132474.4475; train_optim_loss: 132474.4475; val_kl_reg_loss: 1923.7670; val_edge_recon_loss: 38876.7299; val_gene_expr_recon_loss: 89944.6542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130745.1505; val_optim_loss: 130745.1505
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9513; val_auprc_score: 0.9944; val_best_acc_score: 0.9705; val_best_f1_score: 0.9842; train_kl_reg_loss: 1925.6905; train_edge_recon_loss: 41169.1783; train_gene_expr_recon_loss: 90355.2425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133450.1120; train_optim_loss: 133450.1120; val_kl_reg_loss: 1869.6707; val_edge_recon_loss: 39545.9094; val_gene_expr_recon_loss: 91118.2104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132533.7906; val_optim_loss: 132533.7906
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9454; val_auprc_score: 0.9932; val_best_acc_score: 0.9691; val_best_f1_score: 0.9835; train_kl_reg_loss: 1888.6611; train_edge_recon_loss: 40648.5437; train_gene_expr_recon_loss: 90063.3395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132600.5441; train_optim_loss: 132600.5441; val_kl_reg_loss: 1852.3521; val_edge_recon_loss: 39907.3187; val_gene_expr_recon_loss: 90460.8297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132220.5005; val_optim_loss: 132220.5005
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9409; val_auprc_score: 0.9932; val_best_acc_score: 0.9705; val_best_f1_score: 0.9842; train_kl_reg_loss: 1897.5662; train_edge_recon_loss: 40490.9309; train_gene_expr_recon_loss: 90041.6987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132430.1957; train_optim_loss: 132430.1957; val_kl_reg_loss: 1879.7452; val_edge_recon_loss: 40180.5531; val_gene_expr_recon_loss: 90101.5099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132161.8062; val_optim_loss: 132161.8062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9453; val_auprc_score: 0.9918; val_best_acc_score: 0.9711; val_best_f1_score: 0.9845; train_kl_reg_loss: 1898.7347; train_edge_recon_loss: 40110.2805; train_gene_expr_recon_loss: 89925.5253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131934.5405; train_optim_loss: 131934.5405; val_kl_reg_loss: 1871.4083; val_edge_recon_loss: 39349.1900; val_gene_expr_recon_loss: 90020.5302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131241.1276; val_optim_loss: 131241.1276
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9497; val_auprc_score: 0.9922; val_best_acc_score: 0.9728; val_best_f1_score: 0.9854; train_kl_reg_loss: 1899.6856; train_edge_recon_loss: 40954.2900; train_gene_expr_recon_loss: 89721.5513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132575.5266; train_optim_loss: 132575.5266; val_kl_reg_loss: 1881.0560; val_edge_recon_loss: 38872.1783; val_gene_expr_recon_loss: 90096.9198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130850.1547; val_optim_loss: 130850.1547
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9536; val_auprc_score: 0.9941; val_best_acc_score: 0.9731; val_best_f1_score: 0.9855; train_kl_reg_loss: 1905.4244; train_edge_recon_loss: 41398.5054; train_gene_expr_recon_loss: 89781.3821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133085.3110; train_optim_loss: 133085.3110; val_kl_reg_loss: 1882.5152; val_edge_recon_loss: 39720.9387; val_gene_expr_recon_loss: 89882.0359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131485.4891; val_optim_loss: 131485.4891

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 17 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9473
Val AUPRC score: 0.9940
Val best accuracy score: 0.9678
Val best F1 score: 0.9828
Val gene expr MSE score: 0.6369
Duration of model training in run 5: 0 hours, 3 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 67989
Number of validation edges: 7554
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7863; val_auprc_score: 0.9727; val_best_acc_score: 0.9518; val_best_f1_score: 0.9746; train_kl_reg_loss: 1030.3681; train_edge_recon_loss: 48490.1315; train_gene_expr_recon_loss: 101508.5720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 151029.0717; train_optim_loss: 151029.0717; val_kl_reg_loss: 1373.4196; val_edge_recon_loss: 42286.4559; val_gene_expr_recon_loss: 99501.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143161.2719; val_optim_loss: 143161.2719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8200; val_auprc_score: 0.9750; val_best_acc_score: 0.9465; val_best_f1_score: 0.9717; train_kl_reg_loss: 1516.3192; train_edge_recon_loss: 44420.7812; train_gene_expr_recon_loss: 95959.0583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141896.1582; train_optim_loss: 141896.1582; val_kl_reg_loss: 1760.6466; val_edge_recon_loss: 42790.8120; val_gene_expr_recon_loss: 98689.7625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143241.2229; val_optim_loss: 143241.2229
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8454; val_auprc_score: 0.9786; val_best_acc_score: 0.9502; val_best_f1_score: 0.9736; train_kl_reg_loss: 1634.6813; train_edge_recon_loss: 44998.7635; train_gene_expr_recon_loss: 94809.6626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141443.1083; train_optim_loss: 141443.1083; val_kl_reg_loss: 1460.9388; val_edge_recon_loss: 41852.4322; val_gene_expr_recon_loss: 97075.9031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140389.2729; val_optim_loss: 140389.2729
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8592; val_auprc_score: 0.9825; val_best_acc_score: 0.9532; val_best_f1_score: 0.9753; train_kl_reg_loss: 1676.4279; train_edge_recon_loss: 42850.5010; train_gene_expr_recon_loss: 94360.2599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138887.1890; train_optim_loss: 138887.1890; val_kl_reg_loss: 1573.6426; val_edge_recon_loss: 39522.3738; val_gene_expr_recon_loss: 96686.3062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137782.3229; val_optim_loss: 137782.3229
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8791; val_auprc_score: 0.9841; val_best_acc_score: 0.9543; val_best_f1_score: 0.9757; train_kl_reg_loss: 1767.7385; train_edge_recon_loss: 42981.2656; train_gene_expr_recon_loss: 93793.4154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138542.4198; train_optim_loss: 138542.4198; val_kl_reg_loss: 1652.1595; val_edge_recon_loss: 41878.2124; val_gene_expr_recon_loss: 96182.1729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139712.5438; val_optim_loss: 139712.5438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9118; val_auprc_score: 0.9897; val_best_acc_score: 0.9585; val_best_f1_score: 0.9780; train_kl_reg_loss: 1785.4916; train_edge_recon_loss: 42492.5006; train_gene_expr_recon_loss: 93375.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137653.9021; train_optim_loss: 137653.9021; val_kl_reg_loss: 1762.6745; val_edge_recon_loss: 39914.4314; val_gene_expr_recon_loss: 95920.7453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137597.8510; val_optim_loss: 137597.8510
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9168; val_auprc_score: 0.9901; val_best_acc_score: 0.9603; val_best_f1_score: 0.9789; train_kl_reg_loss: 1865.9826; train_edge_recon_loss: 42398.3952; train_gene_expr_recon_loss: 93194.5889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137458.9670; train_optim_loss: 137458.9670; val_kl_reg_loss: 1735.7555; val_edge_recon_loss: 38805.6671; val_gene_expr_recon_loss: 95773.4380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136314.8609; val_optim_loss: 136314.8609
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9149; val_auprc_score: 0.9878; val_best_acc_score: 0.9568; val_best_f1_score: 0.9769; train_kl_reg_loss: 1857.1127; train_edge_recon_loss: 41509.8957; train_gene_expr_recon_loss: 92430.3545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135797.3636; train_optim_loss: 135797.3636; val_kl_reg_loss: 1820.5181; val_edge_recon_loss: 44873.8333; val_gene_expr_recon_loss: 95970.2609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142664.6120; val_optim_loss: 142664.6120
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9251; val_auprc_score: 0.9885; val_best_acc_score: 0.9643; val_best_f1_score: 0.9809; train_kl_reg_loss: 1828.6311; train_edge_recon_loss: 41655.9551; train_gene_expr_recon_loss: 92117.3220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135601.9079; train_optim_loss: 135601.9079; val_kl_reg_loss: 1874.0739; val_edge_recon_loss: 41804.5818; val_gene_expr_recon_loss: 94339.5453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138018.1979; val_optim_loss: 138018.1979
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9352; val_auprc_score: 0.9933; val_best_acc_score: 0.9676; val_best_f1_score: 0.9828; train_kl_reg_loss: 1872.5383; train_edge_recon_loss: 40643.8825; train_gene_expr_recon_loss: 91875.6755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134392.0958; train_optim_loss: 134392.0958; val_kl_reg_loss: 1947.9846; val_edge_recon_loss: 37356.8100; val_gene_expr_recon_loss: 95318.5323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134623.3255; val_optim_loss: 134623.3255
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9461; val_auprc_score: 0.9941; val_best_acc_score: 0.9690; val_best_f1_score: 0.9834; train_kl_reg_loss: 1895.0283; train_edge_recon_loss: 41904.9236; train_gene_expr_recon_loss: 91494.1209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135294.0735; train_optim_loss: 135294.0735; val_kl_reg_loss: 1817.5368; val_edge_recon_loss: 39757.2017; val_gene_expr_recon_loss: 94680.6573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136255.3974; val_optim_loss: 136255.3974
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9551; val_auprc_score: 0.9953; val_best_acc_score: 0.9729; val_best_f1_score: 0.9855; train_kl_reg_loss: 1875.0294; train_edge_recon_loss: 40468.0359; train_gene_expr_recon_loss: 91114.4636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133457.5288; train_optim_loss: 133457.5288; val_kl_reg_loss: 1903.9964; val_edge_recon_loss: 38679.5436; val_gene_expr_recon_loss: 94235.2844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134818.8240; val_optim_loss: 134818.8240
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9423; val_auprc_score: 0.9913; val_best_acc_score: 0.9719; val_best_f1_score: 0.9850; train_kl_reg_loss: 1920.6835; train_edge_recon_loss: 40371.0834; train_gene_expr_recon_loss: 90690.6960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132982.4625; train_optim_loss: 132982.4625; val_kl_reg_loss: 1842.0400; val_edge_recon_loss: 38229.8333; val_gene_expr_recon_loss: 93775.5604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133847.4323; val_optim_loss: 133847.4323
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9557; val_auprc_score: 0.9945; val_best_acc_score: 0.9713; val_best_f1_score: 0.9846; train_kl_reg_loss: 1934.5569; train_edge_recon_loss: 39686.0385; train_gene_expr_recon_loss: 90385.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132006.3378; train_optim_loss: 132006.3378; val_kl_reg_loss: 1923.3053; val_edge_recon_loss: 40972.6523; val_gene_expr_recon_loss: 94255.4021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137151.3594; val_optim_loss: 137151.3594
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9569; val_auprc_score: 0.9936; val_best_acc_score: 0.9732; val_best_f1_score: 0.9856; train_kl_reg_loss: 1935.3436; train_edge_recon_loss: 40219.9204; train_gene_expr_recon_loss: 90142.8135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132298.0781; train_optim_loss: 132298.0781; val_kl_reg_loss: 1892.6410; val_edge_recon_loss: 40148.7977; val_gene_expr_recon_loss: 93589.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135631.3802; val_optim_loss: 135631.3802
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9614; val_auprc_score: 0.9946; val_best_acc_score: 0.9768; val_best_f1_score: 0.9875; train_kl_reg_loss: 1947.7546; train_edge_recon_loss: 40763.8512; train_gene_expr_recon_loss: 89639.7723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132351.3786; train_optim_loss: 132351.3786; val_kl_reg_loss: 2087.6350; val_edge_recon_loss: 38785.2582; val_gene_expr_recon_loss: 92394.7063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133267.6000; val_optim_loss: 133267.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9595; val_auprc_score: 0.9949; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 1960.3637; train_edge_recon_loss: 41048.0357; train_gene_expr_recon_loss: 89773.7916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132782.1912; train_optim_loss: 132782.1912; val_kl_reg_loss: 1975.4114; val_edge_recon_loss: 39825.6607; val_gene_expr_recon_loss: 93727.6151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135528.6875; val_optim_loss: 135528.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9630; val_auprc_score: 0.9961; val_best_acc_score: 0.9746; val_best_f1_score: 0.9864; train_kl_reg_loss: 1956.2858; train_edge_recon_loss: 41816.1614; train_gene_expr_recon_loss: 89573.0028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133345.4498; train_optim_loss: 133345.4498; val_kl_reg_loss: 1965.4782; val_edge_recon_loss: 39621.1453; val_gene_expr_recon_loss: 93141.3135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134727.9344; val_optim_loss: 134727.9344
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9536; val_auprc_score: 0.9943; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 1979.5092; train_edge_recon_loss: 40370.6068; train_gene_expr_recon_loss: 89104.7437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131454.8598; train_optim_loss: 131454.8598; val_kl_reg_loss: 1980.4505; val_edge_recon_loss: 40124.3672; val_gene_expr_recon_loss: 92939.1943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135044.0135; val_optim_loss: 135044.0135

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9595; val_auprc_score: 0.9939; val_best_acc_score: 0.9762; val_best_f1_score: 0.9873; train_kl_reg_loss: 1976.1070; train_edge_recon_loss: 41005.9208; train_gene_expr_recon_loss: 88188.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131170.3755; train_optim_loss: 131170.3755; val_kl_reg_loss: 1962.1129; val_edge_recon_loss: 39465.5802; val_gene_expr_recon_loss: 92014.2297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133441.9219; val_optim_loss: 133441.9219
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9699; val_auprc_score: 0.9960; val_best_acc_score: 0.9773; val_best_f1_score: 0.9879; train_kl_reg_loss: 1968.3150; train_edge_recon_loss: 40060.2981; train_gene_expr_recon_loss: 88021.9194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130050.5323; train_optim_loss: 130050.5323; val_kl_reg_loss: 1958.4263; val_edge_recon_loss: 36842.4862; val_gene_expr_recon_loss: 92430.7115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131231.6234; val_optim_loss: 131231.6234
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9591; val_auprc_score: 0.9952; val_best_acc_score: 0.9766; val_best_f1_score: 0.9875; train_kl_reg_loss: 1978.3933; train_edge_recon_loss: 40697.1315; train_gene_expr_recon_loss: 87614.5325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130290.0572; train_optim_loss: 130290.0572; val_kl_reg_loss: 1962.5452; val_edge_recon_loss: 37858.9471; val_gene_expr_recon_loss: 92008.9891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131830.4828; val_optim_loss: 131830.4828
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9554; val_auprc_score: 0.9936; val_best_acc_score: 0.9751; val_best_f1_score: 0.9866; train_kl_reg_loss: 1972.6463; train_edge_recon_loss: 39406.5233; train_gene_expr_recon_loss: 87626.5345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129005.7048; train_optim_loss: 129005.7048; val_kl_reg_loss: 1951.6121; val_edge_recon_loss: 41301.0336; val_gene_expr_recon_loss: 91561.5010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134814.1469; val_optim_loss: 134814.1469
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9451; val_auprc_score: 0.9905; val_best_acc_score: 0.9738; val_best_f1_score: 0.9860; train_kl_reg_loss: 1972.7299; train_edge_recon_loss: 40198.8082; train_gene_expr_recon_loss: 87727.1695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129898.7083; train_optim_loss: 129898.7083; val_kl_reg_loss: 1968.7523; val_edge_recon_loss: 40446.9449; val_gene_expr_recon_loss: 91557.1854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133972.8828; val_optim_loss: 133972.8828

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9579; val_auprc_score: 0.9950; val_best_acc_score: 0.9747; val_best_f1_score: 0.9864; train_kl_reg_loss: 1977.3164; train_edge_recon_loss: 39845.1620; train_gene_expr_recon_loss: 87486.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129309.0539; train_optim_loss: 129309.0539; val_kl_reg_loss: 1956.0741; val_edge_recon_loss: 40756.5432; val_gene_expr_recon_loss: 91727.9208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134440.5380; val_optim_loss: 134440.5380
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9588; val_auprc_score: 0.9941; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 1968.5872; train_edge_recon_loss: 39439.6483; train_gene_expr_recon_loss: 87710.1839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129118.4190; train_optim_loss: 129118.4190; val_kl_reg_loss: 1948.9925; val_edge_recon_loss: 40385.5721; val_gene_expr_recon_loss: 92477.0911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134811.6557; val_optim_loss: 134811.6557
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9642; val_auprc_score: 0.9962; val_best_acc_score: 0.9743; val_best_f1_score: 0.9862; train_kl_reg_loss: 1966.4490; train_edge_recon_loss: 40619.7124; train_gene_expr_recon_loss: 87697.2253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130283.3867; train_optim_loss: 130283.3867; val_kl_reg_loss: 1956.1567; val_edge_recon_loss: 40970.9802; val_gene_expr_recon_loss: 91639.2297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134566.3672; val_optim_loss: 134566.3672

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 55 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9664
Val AUPRC score: 0.9963
Val best accuracy score: 0.9744
Val best F1 score: 0.9863
Val gene expr MSE score: 0.7321
Duration of model training in run 6: 0 hours, 5 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 90373
Number of validation edges: 10041
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8170; val_auprc_score: 0.9764; val_best_acc_score: 0.9511; val_best_f1_score: 0.9742; train_kl_reg_loss: 1223.9932; train_edge_recon_loss: 47038.4951; train_gene_expr_recon_loss: 100525.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148787.7535; train_optim_loss: 148787.7535; val_kl_reg_loss: 1627.5216; val_edge_recon_loss: 42246.3979; val_gene_expr_recon_loss: 95336.5746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139210.4947; val_optim_loss: 139210.4947
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8488; val_auprc_score: 0.9781; val_best_acc_score: 0.9511; val_best_f1_score: 0.9740; train_kl_reg_loss: 1651.7839; train_edge_recon_loss: 43081.5358; train_gene_expr_recon_loss: 96359.7660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141093.0857; train_optim_loss: 141093.0857; val_kl_reg_loss: 1720.2841; val_edge_recon_loss: 43714.1678; val_gene_expr_recon_loss: 93761.0363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139195.4891; val_optim_loss: 139195.4891
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8845; val_auprc_score: 0.9848; val_best_acc_score: 0.9543; val_best_f1_score: 0.9756; train_kl_reg_loss: 1743.3776; train_edge_recon_loss: 42969.1434; train_gene_expr_recon_loss: 95062.1260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139774.6468; train_optim_loss: 139774.6468; val_kl_reg_loss: 1786.2872; val_edge_recon_loss: 44087.1489; val_gene_expr_recon_loss: 93260.5127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139133.9484; val_optim_loss: 139133.9484
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9134; val_auprc_score: 0.9897; val_best_acc_score: 0.9589; val_best_f1_score: 0.9782; train_kl_reg_loss: 1796.2871; train_edge_recon_loss: 42514.3437; train_gene_expr_recon_loss: 94172.5693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138483.2006; train_optim_loss: 138483.2006; val_kl_reg_loss: 2055.7226; val_edge_recon_loss: 38726.3345; val_gene_expr_recon_loss: 93134.1701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133916.2268; val_optim_loss: 133916.2268
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9211; val_auprc_score: 0.9891; val_best_acc_score: 0.9627; val_best_f1_score: 0.9801; train_kl_reg_loss: 1838.2113; train_edge_recon_loss: 42108.9433; train_gene_expr_recon_loss: 93405.2704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137352.4249; train_optim_loss: 137352.4249; val_kl_reg_loss: 1871.1504; val_edge_recon_loss: 41790.8548; val_gene_expr_recon_loss: 91457.9254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135119.9303; val_optim_loss: 135119.9303
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9322; val_auprc_score: 0.9910; val_best_acc_score: 0.9685; val_best_f1_score: 0.9832; train_kl_reg_loss: 1871.8276; train_edge_recon_loss: 41296.2340; train_gene_expr_recon_loss: 92741.9968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135910.0582; train_optim_loss: 135910.0582; val_kl_reg_loss: 1794.8627; val_edge_recon_loss: 38007.6751; val_gene_expr_recon_loss: 90879.5033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130682.0410; val_optim_loss: 130682.0410
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9481; val_auprc_score: 0.9928; val_best_acc_score: 0.9696; val_best_f1_score: 0.9837; train_kl_reg_loss: 1868.0023; train_edge_recon_loss: 40000.8309; train_gene_expr_recon_loss: 92032.0230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133900.8561; train_optim_loss: 133900.8561; val_kl_reg_loss: 1778.7326; val_edge_recon_loss: 41415.2332; val_gene_expr_recon_loss: 90485.1107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133679.0768; val_optim_loss: 133679.0768
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9540; val_auprc_score: 0.9951; val_best_acc_score: 0.9715; val_best_f1_score: 0.9847; train_kl_reg_loss: 1913.8640; train_edge_recon_loss: 40493.7951; train_gene_expr_recon_loss: 91486.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133893.9494; train_optim_loss: 133893.9494; val_kl_reg_loss: 1924.4707; val_edge_recon_loss: 40699.6319; val_gene_expr_recon_loss: 90404.7758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133028.8791; val_optim_loss: 133028.8791
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9424; val_auprc_score: 0.9916; val_best_acc_score: 0.9719; val_best_f1_score: 0.9850; train_kl_reg_loss: 1921.3601; train_edge_recon_loss: 40587.8649; train_gene_expr_recon_loss: 90981.8624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133491.0872; train_optim_loss: 133491.0872; val_kl_reg_loss: 2001.7993; val_edge_recon_loss: 39569.5019; val_gene_expr_recon_loss: 90148.1982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131719.4979; val_optim_loss: 131719.4979

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9417; val_auprc_score: 0.9916; val_best_acc_score: 0.9721; val_best_f1_score: 0.9850; train_kl_reg_loss: 1953.1709; train_edge_recon_loss: 39990.8117; train_gene_expr_recon_loss: 89317.9625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131261.9449; train_optim_loss: 131261.9449; val_kl_reg_loss: 1925.3695; val_edge_recon_loss: 40692.6113; val_gene_expr_recon_loss: 88797.2541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131415.2348; val_optim_loss: 131415.2348
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9541; val_auprc_score: 0.9929; val_best_acc_score: 0.9755; val_best_f1_score: 0.9869; train_kl_reg_loss: 1926.5174; train_edge_recon_loss: 40590.1574; train_gene_expr_recon_loss: 88920.9247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131437.5995; train_optim_loss: 131437.5995; val_kl_reg_loss: 1914.7585; val_edge_recon_loss: 39127.4644; val_gene_expr_recon_loss: 88517.6791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129559.9014; val_optim_loss: 129559.9014
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9502; val_auprc_score: 0.9941; val_best_acc_score: 0.9744; val_best_f1_score: 0.9863; train_kl_reg_loss: 1940.0196; train_edge_recon_loss: 40174.8345; train_gene_expr_recon_loss: 88728.1462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130843.0002; train_optim_loss: 130843.0002; val_kl_reg_loss: 1916.2411; val_edge_recon_loss: 39344.7427; val_gene_expr_recon_loss: 88365.2008; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129626.1838; val_optim_loss: 129626.1838
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9552; val_auprc_score: 0.9943; val_best_acc_score: 0.9740; val_best_f1_score: 0.9862; train_kl_reg_loss: 1925.6148; train_edge_recon_loss: 40657.7931; train_gene_expr_recon_loss: 88677.8355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131261.2433; train_optim_loss: 131261.2433; val_kl_reg_loss: 1871.7718; val_edge_recon_loss: 38014.0478; val_gene_expr_recon_loss: 88413.4105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128299.2301; val_optim_loss: 128299.2301
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9531; val_auprc_score: 0.9948; val_best_acc_score: 0.9736; val_best_f1_score: 0.9858; train_kl_reg_loss: 1912.8440; train_edge_recon_loss: 40145.2332; train_gene_expr_recon_loss: 88636.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130694.2508; train_optim_loss: 130694.2508; val_kl_reg_loss: 1881.5527; val_edge_recon_loss: 40563.2430; val_gene_expr_recon_loss: 88100.0289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130544.8240; val_optim_loss: 130544.8240
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9513; val_auprc_score: 0.9909; val_best_acc_score: 0.9735; val_best_f1_score: 0.9858; train_kl_reg_loss: 1947.0433; train_edge_recon_loss: 41620.8191; train_gene_expr_recon_loss: 88585.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132153.2133; train_optim_loss: 132153.2133; val_kl_reg_loss: 1934.3939; val_edge_recon_loss: 40549.9680; val_gene_expr_recon_loss: 88311.8970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130796.2586; val_optim_loss: 130796.2586
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9531; val_auprc_score: 0.9924; val_best_acc_score: 0.9766; val_best_f1_score: 0.9875; train_kl_reg_loss: 1914.5323; train_edge_recon_loss: 39844.2038; train_gene_expr_recon_loss: 88557.5366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130316.2728; train_optim_loss: 130316.2728; val_kl_reg_loss: 1873.6935; val_edge_recon_loss: 38518.5354; val_gene_expr_recon_loss: 88370.1994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128762.4291; val_optim_loss: 128762.4291

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9616; val_auprc_score: 0.9943; val_best_acc_score: 0.9746; val_best_f1_score: 0.9864; train_kl_reg_loss: 1906.2981; train_edge_recon_loss: 40664.3597; train_gene_expr_recon_loss: 88195.5080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130766.1657; train_optim_loss: 130766.1657; val_kl_reg_loss: 1909.4376; val_edge_recon_loss: 41197.6197; val_gene_expr_recon_loss: 88231.3508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131338.4076; val_optim_loss: 131338.4076
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9595; val_auprc_score: 0.9955; val_best_acc_score: 0.9781; val_best_f1_score: 0.9883; train_kl_reg_loss: 1927.3983; train_edge_recon_loss: 39742.9799; train_gene_expr_recon_loss: 88288.3818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129958.7602; train_optim_loss: 129958.7602; val_kl_reg_loss: 1911.7517; val_edge_recon_loss: 37369.8715; val_gene_expr_recon_loss: 88723.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128004.6313; val_optim_loss: 128004.6313
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9555; val_auprc_score: 0.9946; val_best_acc_score: 0.9770; val_best_f1_score: 0.9877; train_kl_reg_loss: 1922.7765; train_edge_recon_loss: 40064.0944; train_gene_expr_recon_loss: 88176.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130163.0075; train_optim_loss: 130163.0075; val_kl_reg_loss: 1905.5464; val_edge_recon_loss: 38541.8889; val_gene_expr_recon_loss: 87889.1850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128336.6201; val_optim_loss: 128336.6201
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9572; val_auprc_score: 0.9943; val_best_acc_score: 0.9749; val_best_f1_score: 0.9865; train_kl_reg_loss: 1922.4484; train_edge_recon_loss: 40943.7195; train_gene_expr_recon_loss: 88316.5165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131182.6843; train_optim_loss: 131182.6843; val_kl_reg_loss: 1911.2839; val_edge_recon_loss: 40181.0966; val_gene_expr_recon_loss: 88041.2092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130133.5900; val_optim_loss: 130133.5900
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9548; val_auprc_score: 0.9932; val_best_acc_score: 0.9744; val_best_f1_score: 0.9862; train_kl_reg_loss: 1926.1816; train_edge_recon_loss: 39719.3307; train_gene_expr_recon_loss: 88222.8810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129868.3933; train_optim_loss: 129868.3933; val_kl_reg_loss: 1909.6112; val_edge_recon_loss: 41964.1035; val_gene_expr_recon_loss: 88044.9930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131918.7074; val_optim_loss: 131918.7074

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9536; val_auprc_score: 0.9934; val_best_acc_score: 0.9740; val_best_f1_score: 0.9860; train_kl_reg_loss: 1924.3664; train_edge_recon_loss: 41301.4078; train_gene_expr_recon_loss: 88259.6248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131485.3989; train_optim_loss: 131485.3989; val_kl_reg_loss: 1907.9276; val_edge_recon_loss: 41259.8966; val_gene_expr_recon_loss: 88101.5963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131269.4219; val_optim_loss: 131269.4219
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9525; val_auprc_score: 0.9940; val_best_acc_score: 0.9727; val_best_f1_score: 0.9854; train_kl_reg_loss: 1925.0653; train_edge_recon_loss: 40397.0427; train_gene_expr_recon_loss: 88156.6352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130478.7430; train_optim_loss: 130478.7430; val_kl_reg_loss: 1911.0954; val_edge_recon_loss: 42629.8160; val_gene_expr_recon_loss: 88713.5020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133254.4143; val_optim_loss: 133254.4143
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9663; val_auprc_score: 0.9955; val_best_acc_score: 0.9757; val_best_f1_score: 0.9870; train_kl_reg_loss: 1927.2634; train_edge_recon_loss: 39634.8278; train_gene_expr_recon_loss: 88154.1131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129716.2042; train_optim_loss: 129716.2042; val_kl_reg_loss: 1911.4127; val_edge_recon_loss: 39901.7141; val_gene_expr_recon_loss: 88348.3596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130161.4863; val_optim_loss: 130161.4863

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 16 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9597
Val AUPRC score: 0.9952
Val best accuracy score: 0.9748
Val best F1 score: 0.9865
Val gene expr MSE score: 0.6756
Duration of model training in run 7: 0 hours, 9 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 90373
Number of validation edges: 10041
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8139; val_auprc_score: 0.9763; val_best_acc_score: 0.9468; val_best_f1_score: 0.9719; train_kl_reg_loss: 1253.5985; train_edge_recon_loss: 46486.6674; train_gene_expr_recon_loss: 99637.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147378.0472; train_optim_loss: 147378.0472; val_kl_reg_loss: 1654.1988; val_edge_recon_loss: 43755.1327; val_gene_expr_recon_loss: 97979.1334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143388.4643; val_optim_loss: 143388.4643
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8438; val_auprc_score: 0.9795; val_best_acc_score: 0.9463; val_best_f1_score: 0.9715; train_kl_reg_loss: 1596.9727; train_edge_recon_loss: 43170.0696; train_gene_expr_recon_loss: 95758.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140525.8661; train_optim_loss: 140525.8661; val_kl_reg_loss: 1825.7848; val_edge_recon_loss: 43563.1344; val_gene_expr_recon_loss: 96294.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141683.3824; val_optim_loss: 141683.3824
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8773; val_auprc_score: 0.9847; val_best_acc_score: 0.9532; val_best_f1_score: 0.9751; train_kl_reg_loss: 1749.9012; train_edge_recon_loss: 42177.9213; train_gene_expr_recon_loss: 94486.5709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138414.3935; train_optim_loss: 138414.3935; val_kl_reg_loss: 2023.3421; val_edge_recon_loss: 42797.4050; val_gene_expr_recon_loss: 95602.3873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140423.1355; val_optim_loss: 140423.1355
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9072; val_auprc_score: 0.9885; val_best_acc_score: 0.9576; val_best_f1_score: 0.9774; train_kl_reg_loss: 1799.6905; train_edge_recon_loss: 41135.2540; train_gene_expr_recon_loss: 93641.6043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136576.5486; train_optim_loss: 136576.5486; val_kl_reg_loss: 1864.1906; val_edge_recon_loss: 40438.7249; val_gene_expr_recon_loss: 94918.1439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137221.0578; val_optim_loss: 137221.0578
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9107; val_auprc_score: 0.9872; val_best_acc_score: 0.9569; val_best_f1_score: 0.9769; train_kl_reg_loss: 1825.1294; train_edge_recon_loss: 41350.3162; train_gene_expr_recon_loss: 92923.7162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136099.1616; train_optim_loss: 136099.1616; val_kl_reg_loss: 1994.1198; val_edge_recon_loss: 43031.2167; val_gene_expr_recon_loss: 94591.9900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139617.3268; val_optim_loss: 139617.3268
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9297; val_auprc_score: 0.9904; val_best_acc_score: 0.9628; val_best_f1_score: 0.9801; train_kl_reg_loss: 1872.5255; train_edge_recon_loss: 42278.9199; train_gene_expr_recon_loss: 92211.4984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136362.9437; train_optim_loss: 136362.9437; val_kl_reg_loss: 1844.8503; val_edge_recon_loss: 40682.1960; val_gene_expr_recon_loss: 93594.0377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136121.0838; val_optim_loss: 136121.0838
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9344; val_auprc_score: 0.9923; val_best_acc_score: 0.9637; val_best_f1_score: 0.9807; train_kl_reg_loss: 1879.8535; train_edge_recon_loss: 41015.3022; train_gene_expr_recon_loss: 91587.9652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134483.1211; train_optim_loss: 134483.1211; val_kl_reg_loss: 1863.5078; val_edge_recon_loss: 40873.0467; val_gene_expr_recon_loss: 93562.6525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136299.2066; val_optim_loss: 136299.2066
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9339; val_auprc_score: 0.9899; val_best_acc_score: 0.9688; val_best_f1_score: 0.9833; train_kl_reg_loss: 1896.1100; train_edge_recon_loss: 40784.5640; train_gene_expr_recon_loss: 91101.7114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133782.3854; train_optim_loss: 133782.3854; val_kl_reg_loss: 1961.0988; val_edge_recon_loss: 41983.7402; val_gene_expr_recon_loss: 92609.0457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136553.8850; val_optim_loss: 136553.8850
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9419; val_auprc_score: 0.9924; val_best_acc_score: 0.9668; val_best_f1_score: 0.9822; train_kl_reg_loss: 1900.6916; train_edge_recon_loss: 40067.9897; train_gene_expr_recon_loss: 90520.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132489.5425; train_optim_loss: 132489.5425; val_kl_reg_loss: 1840.8908; val_edge_recon_loss: 42939.0379; val_gene_expr_recon_loss: 92616.4209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137396.3500; val_optim_loss: 137396.3500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9496; val_auprc_score: 0.9941; val_best_acc_score: 0.9710; val_best_f1_score: 0.9845; train_kl_reg_loss: 1931.9127; train_edge_recon_loss: 40126.5334; train_gene_expr_recon_loss: 88937.2145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130995.6608; train_optim_loss: 130995.6608; val_kl_reg_loss: 1922.5365; val_edge_recon_loss: 41561.6588; val_gene_expr_recon_loss: 90987.3881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134471.5832; val_optim_loss: 134471.5832
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9520; val_auprc_score: 0.9934; val_best_acc_score: 0.9709; val_best_f1_score: 0.9844; train_kl_reg_loss: 1917.4284; train_edge_recon_loss: 40121.1363; train_gene_expr_recon_loss: 88420.6386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130459.2031; train_optim_loss: 130459.2031; val_kl_reg_loss: 1911.7819; val_edge_recon_loss: 41995.1921; val_gene_expr_recon_loss: 90671.9771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134578.9500; val_optim_loss: 134578.9500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9429; val_auprc_score: 0.9925; val_best_acc_score: 0.9713; val_best_f1_score: 0.9846; train_kl_reg_loss: 1941.1393; train_edge_recon_loss: 40379.5855; train_gene_expr_recon_loss: 88319.5073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130640.2321; train_optim_loss: 130640.2321; val_kl_reg_loss: 1976.4933; val_edge_recon_loss: 41536.7078; val_gene_expr_recon_loss: 90895.3957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134408.5963; val_optim_loss: 134408.5963
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9461; val_auprc_score: 0.9920; val_best_acc_score: 0.9708; val_best_f1_score: 0.9844; train_kl_reg_loss: 1938.7777; train_edge_recon_loss: 40115.0656; train_gene_expr_recon_loss: 88178.5127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130232.3558; train_optim_loss: 130232.3558; val_kl_reg_loss: 1924.8915; val_edge_recon_loss: 40878.6557; val_gene_expr_recon_loss: 90774.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133578.4609; val_optim_loss: 133578.4609
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9433; val_auprc_score: 0.9922; val_best_acc_score: 0.9720; val_best_f1_score: 0.9850; train_kl_reg_loss: 1932.8259; train_edge_recon_loss: 40084.8092; train_gene_expr_recon_loss: 88179.0892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130196.7246; train_optim_loss: 130196.7246; val_kl_reg_loss: 1916.9360; val_edge_recon_loss: 41272.9696; val_gene_expr_recon_loss: 91017.2078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134207.1129; val_optim_loss: 134207.1129
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9593; val_auprc_score: 0.9944; val_best_acc_score: 0.9741; val_best_f1_score: 0.9861; train_kl_reg_loss: 1913.8137; train_edge_recon_loss: 40543.8581; train_gene_expr_recon_loss: 88227.3068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130684.9788; train_optim_loss: 130684.9788; val_kl_reg_loss: 1962.2787; val_edge_recon_loss: 41159.9778; val_gene_expr_recon_loss: 90635.9035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133758.1607; val_optim_loss: 133758.1607
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9502; val_auprc_score: 0.9939; val_best_acc_score: 0.9735; val_best_f1_score: 0.9858; train_kl_reg_loss: 1953.4945; train_edge_recon_loss: 40607.4888; train_gene_expr_recon_loss: 88092.6372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130653.6204; train_optim_loss: 130653.6204; val_kl_reg_loss: 1946.3035; val_edge_recon_loss: 40110.6094; val_gene_expr_recon_loss: 90695.4672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132752.3813; val_optim_loss: 132752.3813
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9554; val_auprc_score: 0.9936; val_best_acc_score: 0.9732; val_best_f1_score: 0.9856; train_kl_reg_loss: 1923.6772; train_edge_recon_loss: 40923.6756; train_gene_expr_recon_loss: 87973.3016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130820.6543; train_optim_loss: 130820.6543; val_kl_reg_loss: 1942.6730; val_edge_recon_loss: 41357.8798; val_gene_expr_recon_loss: 90687.3674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133987.9193; val_optim_loss: 133987.9193
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9433; val_auprc_score: 0.9929; val_best_acc_score: 0.9726; val_best_f1_score: 0.9854; train_kl_reg_loss: 1932.2634; train_edge_recon_loss: 40198.4975; train_gene_expr_recon_loss: 88070.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130201.3592; train_optim_loss: 130201.3592; val_kl_reg_loss: 1915.7867; val_edge_recon_loss: 39659.5161; val_gene_expr_recon_loss: 90757.4475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132332.7504; val_optim_loss: 132332.7504
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9587; val_auprc_score: 0.9941; val_best_acc_score: 0.9741; val_best_f1_score: 0.9861; train_kl_reg_loss: 1912.8708; train_edge_recon_loss: 39788.2865; train_gene_expr_recon_loss: 87993.7438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129694.9009; train_optim_loss: 129694.9009; val_kl_reg_loss: 1903.9166; val_edge_recon_loss: 41666.9508; val_gene_expr_recon_loss: 90279.1314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133849.9984; val_optim_loss: 133849.9984
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9637; val_auprc_score: 0.9954; val_best_acc_score: 0.9748; val_best_f1_score: 0.9865; train_kl_reg_loss: 1924.1532; train_edge_recon_loss: 40323.6007; train_gene_expr_recon_loss: 87997.4041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130245.1580; train_optim_loss: 130245.1580; val_kl_reg_loss: 1948.9598; val_edge_recon_loss: 40048.4114; val_gene_expr_recon_loss: 90626.6434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132624.0148; val_optim_loss: 132624.0148
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9625; val_auprc_score: 0.9957; val_best_acc_score: 0.9761; val_best_f1_score: 0.9872; train_kl_reg_loss: 1934.8982; train_edge_recon_loss: 40347.2601; train_gene_expr_recon_loss: 87947.1006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130229.2588; train_optim_loss: 130229.2588; val_kl_reg_loss: 1910.7406; val_edge_recon_loss: 41085.6346; val_gene_expr_recon_loss: 90343.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133340.1373; val_optim_loss: 133340.1373

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9547; val_auprc_score: 0.9949; val_best_acc_score: 0.9751; val_best_f1_score: 0.9867; train_kl_reg_loss: 1922.8729; train_edge_recon_loss: 40282.3884; train_gene_expr_recon_loss: 87672.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129877.9431; train_optim_loss: 129877.9431; val_kl_reg_loss: 1913.1322; val_edge_recon_loss: 39737.6685; val_gene_expr_recon_loss: 90441.2221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132092.0227; val_optim_loss: 132092.0227
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9559; val_auprc_score: 0.9944; val_best_acc_score: 0.9745; val_best_f1_score: 0.9863; train_kl_reg_loss: 1932.2754; train_edge_recon_loss: 41196.7330; train_gene_expr_recon_loss: 87630.5504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130759.5588; train_optim_loss: 130759.5588; val_kl_reg_loss: 1927.0968; val_edge_recon_loss: 39751.5965; val_gene_expr_recon_loss: 90667.3189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132346.0129; val_optim_loss: 132346.0129
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9556; val_auprc_score: 0.9944; val_best_acc_score: 0.9744; val_best_f1_score: 0.9863; train_kl_reg_loss: 1938.8373; train_edge_recon_loss: 39688.9385; train_gene_expr_recon_loss: 87581.4214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129209.1970; train_optim_loss: 129209.1970; val_kl_reg_loss: 1928.4256; val_edge_recon_loss: 41081.4407; val_gene_expr_recon_loss: 90596.1963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133606.0623; val_optim_loss: 133606.0623
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9545; val_auprc_score: 0.9933; val_best_acc_score: 0.9751; val_best_f1_score: 0.9866; train_kl_reg_loss: 1941.4969; train_edge_recon_loss: 40399.7711; train_gene_expr_recon_loss: 87494.7583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129836.0262; train_optim_loss: 129836.0262; val_kl_reg_loss: 1934.7499; val_edge_recon_loss: 39999.5530; val_gene_expr_recon_loss: 90774.9316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132709.2348; val_optim_loss: 132709.2348

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9640; val_auprc_score: 0.9961; val_best_acc_score: 0.9778; val_best_f1_score: 0.9881; train_kl_reg_loss: 1941.5955; train_edge_recon_loss: 40141.4399; train_gene_expr_recon_loss: 87585.3101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129668.3453; train_optim_loss: 129668.3453; val_kl_reg_loss: 1934.3725; val_edge_recon_loss: 38902.0798; val_gene_expr_recon_loss: 90766.7287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131603.1816; val_optim_loss: 131603.1816
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9576; val_auprc_score: 0.9945; val_best_acc_score: 0.9763; val_best_f1_score: 0.9873; train_kl_reg_loss: 1939.7945; train_edge_recon_loss: 40641.2185; train_gene_expr_recon_loss: 87554.8885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130135.9015; train_optim_loss: 130135.9015; val_kl_reg_loss: 1932.4570; val_edge_recon_loss: 38731.8253; val_gene_expr_recon_loss: 90567.2523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131231.5357; val_optim_loss: 131231.5357
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9598; val_auprc_score: 0.9939; val_best_acc_score: 0.9768; val_best_f1_score: 0.9876; train_kl_reg_loss: 1938.4726; train_edge_recon_loss: 39700.7532; train_gene_expr_recon_loss: 87595.4108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129234.6368; train_optim_loss: 129234.6368; val_kl_reg_loss: 1930.4086; val_edge_recon_loss: 39598.3636; val_gene_expr_recon_loss: 90773.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132302.0496; val_optim_loss: 132302.0496
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9574; val_auprc_score: 0.9943; val_best_acc_score: 0.9758; val_best_f1_score: 0.9870; train_kl_reg_loss: 1937.8625; train_edge_recon_loss: 40315.8679; train_gene_expr_recon_loss: 87519.5452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129773.2754; train_optim_loss: 129773.2754; val_kl_reg_loss: 1930.7241; val_edge_recon_loss: 39493.6203; val_gene_expr_recon_loss: 90950.7113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132375.0559; val_optim_loss: 132375.0559
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9625; val_auprc_score: 0.9958; val_best_acc_score: 0.9774; val_best_f1_score: 0.9879; train_kl_reg_loss: 1938.2470; train_edge_recon_loss: 40393.9141; train_gene_expr_recon_loss: 87520.4654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129852.6265; train_optim_loss: 129852.6265; val_kl_reg_loss: 1931.3104; val_edge_recon_loss: 37254.8713; val_gene_expr_recon_loss: 90577.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129763.3082; val_optim_loss: 129763.3082
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9644; val_auprc_score: 0.9953; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 1937.3897; train_edge_recon_loss: 39132.8795; train_gene_expr_recon_loss: 87557.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128627.9108; train_optim_loss: 128627.9108; val_kl_reg_loss: 1929.3151; val_edge_recon_loss: 39672.5197; val_gene_expr_recon_loss: 90775.9510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132377.7855; val_optim_loss: 132377.7855
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9538; val_auprc_score: 0.9936; val_best_acc_score: 0.9748; val_best_f1_score: 0.9864; train_kl_reg_loss: 1936.8640; train_edge_recon_loss: 40839.7023; train_gene_expr_recon_loss: 87531.4131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130307.9797; train_optim_loss: 130307.9797; val_kl_reg_loss: 1930.2179; val_edge_recon_loss: 41584.2223; val_gene_expr_recon_loss: 90829.4580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134343.8982; val_optim_loss: 134343.8982
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9476; val_auprc_score: 0.9920; val_best_acc_score: 0.9742; val_best_f1_score: 0.9862; train_kl_reg_loss: 1936.7803; train_edge_recon_loss: 39595.8367; train_gene_expr_recon_loss: 87520.4566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129053.0739; train_optim_loss: 129053.0739; val_kl_reg_loss: 1928.8624; val_edge_recon_loss: 39598.1392; val_gene_expr_recon_loss: 89994.5021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131521.5033; val_optim_loss: 131521.5033

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9675; val_auprc_score: 0.9966; val_best_acc_score: 0.9777; val_best_f1_score: 0.9880; train_kl_reg_loss: 1936.7983; train_edge_recon_loss: 40225.0272; train_gene_expr_recon_loss: 87470.8569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129632.6824; train_optim_loss: 129632.6824; val_kl_reg_loss: 1930.3199; val_edge_recon_loss: 38837.7142; val_gene_expr_recon_loss: 90345.4725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131113.5055; val_optim_loss: 131113.5055
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9497; val_auprc_score: 0.9920; val_best_acc_score: 0.9748; val_best_f1_score: 0.9865; train_kl_reg_loss: 1936.5988; train_edge_recon_loss: 40024.8119; train_gene_expr_recon_loss: 87504.8497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129466.2605; train_optim_loss: 129466.2605; val_kl_reg_loss: 1930.0731; val_edge_recon_loss: 41591.7456; val_gene_expr_recon_loss: 90317.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133839.2107; val_optim_loss: 133839.2107
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9524; val_auprc_score: 0.9944; val_best_acc_score: 0.9742; val_best_f1_score: 0.9862; train_kl_reg_loss: 1936.7637; train_edge_recon_loss: 39699.6377; train_gene_expr_recon_loss: 87559.4832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129195.8847; train_optim_loss: 129195.8847; val_kl_reg_loss: 1930.6152; val_edge_recon_loss: 38913.8417; val_gene_expr_recon_loss: 90613.8354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131458.2916; val_optim_loss: 131458.2916

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 30 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9548
Val AUPRC score: 0.9932
Val best accuracy score: 0.9770
Val best F1 score: 0.9877
Val gene expr MSE score: 0.6696
Duration of model training in run 8: 0 hours, 17 minutes and 46 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 112803
Number of validation edges: 12533
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8382; val_auprc_score: 0.9795; val_best_acc_score: 0.9520; val_best_f1_score: 0.9746; train_kl_reg_loss: 1339.5413; train_edge_recon_loss: 46130.0444; train_gene_expr_recon_loss: 99979.9357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147449.5214; train_optim_loss: 147449.5214; val_kl_reg_loss: 1497.0012; val_edge_recon_loss: 41933.7020; val_gene_expr_recon_loss: 94928.7786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138359.4813; val_optim_loss: 138359.4813
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8951; val_auprc_score: 0.9862; val_best_acc_score: 0.9516; val_best_f1_score: 0.9742; train_kl_reg_loss: 1731.4515; train_edge_recon_loss: 42900.2801; train_gene_expr_recon_loss: 96047.6577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140679.3891; train_optim_loss: 140679.3891; val_kl_reg_loss: 1783.2828; val_edge_recon_loss: 41078.8865; val_gene_expr_recon_loss: 92566.8799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135429.0489; val_optim_loss: 135429.0489
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9299; val_auprc_score: 0.9913; val_best_acc_score: 0.9630; val_best_f1_score: 0.9801; train_kl_reg_loss: 1812.1446; train_edge_recon_loss: 41952.5178; train_gene_expr_recon_loss: 94252.4503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138017.1127; train_optim_loss: 138017.1127; val_kl_reg_loss: 1879.6733; val_edge_recon_loss: 42129.0566; val_gene_expr_recon_loss: 91349.5643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135358.2943; val_optim_loss: 135358.2943
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9384; val_auprc_score: 0.9901; val_best_acc_score: 0.9644; val_best_f1_score: 0.9808; train_kl_reg_loss: 1890.9948; train_edge_recon_loss: 40966.9365; train_gene_expr_recon_loss: 92931.8309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135789.7621; train_optim_loss: 135789.7621; val_kl_reg_loss: 1804.0826; val_edge_recon_loss: 44750.5842; val_gene_expr_recon_loss: 90672.8337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137227.5010; val_optim_loss: 137227.5010
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9510; val_auprc_score: 0.9942; val_best_acc_score: 0.9712; val_best_f1_score: 0.9846; train_kl_reg_loss: 1899.7702; train_edge_recon_loss: 40890.4538; train_gene_expr_recon_loss: 91969.3189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134759.5428; train_optim_loss: 134759.5428; val_kl_reg_loss: 1911.7945; val_edge_recon_loss: 39279.8903; val_gene_expr_recon_loss: 89615.2364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130806.9212; val_optim_loss: 130806.9212
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9485; val_auprc_score: 0.9915; val_best_acc_score: 0.9727; val_best_f1_score: 0.9854; train_kl_reg_loss: 1942.0792; train_edge_recon_loss: 40396.1439; train_gene_expr_recon_loss: 90897.1529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133235.3759; train_optim_loss: 133235.3759; val_kl_reg_loss: 1982.9103; val_edge_recon_loss: 38982.7083; val_gene_expr_recon_loss: 88758.6091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129724.2279; val_optim_loss: 129724.2279
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9572; val_auprc_score: 0.9938; val_best_acc_score: 0.9730; val_best_f1_score: 0.9855; train_kl_reg_loss: 1976.6412; train_edge_recon_loss: 40299.5010; train_gene_expr_recon_loss: 90170.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132446.5364; train_optim_loss: 132446.5364; val_kl_reg_loss: 2096.3352; val_edge_recon_loss: 40321.4277; val_gene_expr_recon_loss: 88294.0014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130711.7643; val_optim_loss: 130711.7643
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9564; val_auprc_score: 0.9932; val_best_acc_score: 0.9748; val_best_f1_score: 0.9865; train_kl_reg_loss: 1982.9855; train_edge_recon_loss: 40752.6929; train_gene_expr_recon_loss: 89379.3319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132115.0103; train_optim_loss: 132115.0103; val_kl_reg_loss: 2046.5053; val_edge_recon_loss: 41587.5737; val_gene_expr_recon_loss: 87309.2264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130943.3063; val_optim_loss: 130943.3063
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9577; val_auprc_score: 0.9933; val_best_acc_score: 0.9777; val_best_f1_score: 0.9881; train_kl_reg_loss: 1984.5103; train_edge_recon_loss: 40094.4008; train_gene_expr_recon_loss: 88603.2469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130682.1582; train_optim_loss: 130682.1582; val_kl_reg_loss: 1847.6692; val_edge_recon_loss: 40310.0116; val_gene_expr_recon_loss: 86998.5831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129156.2632; val_optim_loss: 129156.2632
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9663; val_auprc_score: 0.9947; val_best_acc_score: 0.9795; val_best_f1_score: 0.9890; train_kl_reg_loss: 2001.3158; train_edge_recon_loss: 39970.1812; train_gene_expr_recon_loss: 87965.1280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129936.6251; train_optim_loss: 129936.6251; val_kl_reg_loss: 1966.0764; val_edge_recon_loss: 38730.6931; val_gene_expr_recon_loss: 86391.2318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127088.0018; val_optim_loss: 127088.0018
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9655; val_auprc_score: 0.9941; val_best_acc_score: 0.9799; val_best_f1_score: 0.9892; train_kl_reg_loss: 2016.2051; train_edge_recon_loss: 40181.2032; train_gene_expr_recon_loss: 87434.6754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129632.0837; train_optim_loss: 129632.0837; val_kl_reg_loss: 2016.8384; val_edge_recon_loss: 40055.5929; val_gene_expr_recon_loss: 86384.0786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128456.5097; val_optim_loss: 128456.5097
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9708; val_auprc_score: 0.9951; val_best_acc_score: 0.9823; val_best_f1_score: 0.9905; train_kl_reg_loss: 2029.4772; train_edge_recon_loss: 40023.8828; train_gene_expr_recon_loss: 86996.3586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129049.7187; train_optim_loss: 129049.7187; val_kl_reg_loss: 2037.8593; val_edge_recon_loss: 38854.3052; val_gene_expr_recon_loss: 85872.9961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126765.1610; val_optim_loss: 126765.1610
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9721; val_auprc_score: 0.9951; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2025.4160; train_edge_recon_loss: 39786.6017; train_gene_expr_recon_loss: 86530.5827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128342.6005; train_optim_loss: 128342.6005; val_kl_reg_loss: 2138.6827; val_edge_recon_loss: 38283.7621; val_gene_expr_recon_loss: 85847.6146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126270.0592; val_optim_loss: 126270.0592
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9715; val_auprc_score: 0.9963; val_best_acc_score: 0.9820; val_best_f1_score: 0.9903; train_kl_reg_loss: 2069.9482; train_edge_recon_loss: 39909.5427; train_gene_expr_recon_loss: 86127.7329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128107.2238; train_optim_loss: 128107.2238; val_kl_reg_loss: 2049.0819; val_edge_recon_loss: 40411.5910; val_gene_expr_recon_loss: 85624.7427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128085.4155; val_optim_loss: 128085.4155
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9766; val_auprc_score: 0.9967; val_best_acc_score: 0.9845; val_best_f1_score: 0.9917; train_kl_reg_loss: 2070.7972; train_edge_recon_loss: 40342.2664; train_gene_expr_recon_loss: 85824.7150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128237.7786; train_optim_loss: 128237.7786; val_kl_reg_loss: 2089.2012; val_edge_recon_loss: 38071.6541; val_gene_expr_recon_loss: 85667.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125827.9864; val_optim_loss: 125827.9864
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9770; val_auprc_score: 0.9966; val_best_acc_score: 0.9842; val_best_f1_score: 0.9915; train_kl_reg_loss: 2068.1044; train_edge_recon_loss: 39941.9392; train_gene_expr_recon_loss: 85615.7914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127625.8351; train_optim_loss: 127625.8351; val_kl_reg_loss: 1982.9748; val_edge_recon_loss: 40619.1396; val_gene_expr_recon_loss: 85502.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128104.3119; val_optim_loss: 128104.3119
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9781; val_auprc_score: 0.9972; val_best_acc_score: 0.9843; val_best_f1_score: 0.9916; train_kl_reg_loss: 2094.5814; train_edge_recon_loss: 40003.3337; train_gene_expr_recon_loss: 85314.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127412.6302; train_optim_loss: 127412.6302; val_kl_reg_loss: 2031.9393; val_edge_recon_loss: 40677.5442; val_gene_expr_recon_loss: 85601.6340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128311.1179; val_optim_loss: 128311.1179
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9708; val_auprc_score: 0.9950; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2096.5825; train_edge_recon_loss: 39976.0873; train_gene_expr_recon_loss: 85091.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127164.2363; train_optim_loss: 127164.2363; val_kl_reg_loss: 2080.4577; val_edge_recon_loss: 42990.4869; val_gene_expr_recon_loss: 85387.0936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130458.0384; val_optim_loss: 130458.0384

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9726; val_auprc_score: 0.9949; val_best_acc_score: 0.9859; val_best_f1_score: 0.9925; train_kl_reg_loss: 2112.5023; train_edge_recon_loss: 39799.7592; train_gene_expr_recon_loss: 84180.6601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126092.9214; train_optim_loss: 126092.9214; val_kl_reg_loss: 2096.2168; val_edge_recon_loss: 38330.4363; val_gene_expr_recon_loss: 85262.1279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125688.7805; val_optim_loss: 125688.7805
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9783; val_auprc_score: 0.9965; val_best_acc_score: 0.9869; val_best_f1_score: 0.9929; train_kl_reg_loss: 2109.5229; train_edge_recon_loss: 39516.3994; train_gene_expr_recon_loss: 83984.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125610.9068; train_optim_loss: 125610.9068; val_kl_reg_loss: 2095.3094; val_edge_recon_loss: 40178.6066; val_gene_expr_recon_loss: 85291.2677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127565.1838; val_optim_loss: 127565.1838
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9732; val_auprc_score: 0.9957; val_best_acc_score: 0.9855; val_best_f1_score: 0.9922; train_kl_reg_loss: 2097.0520; train_edge_recon_loss: 39285.8299; train_gene_expr_recon_loss: 83860.5711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125243.4529; train_optim_loss: 125243.4529; val_kl_reg_loss: 2083.3652; val_edge_recon_loss: 39327.8393; val_gene_expr_recon_loss: 85250.2756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126661.4801; val_optim_loss: 126661.4801
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9722; val_auprc_score: 0.9954; val_best_acc_score: 0.9867; val_best_f1_score: 0.9929; train_kl_reg_loss: 2110.9433; train_edge_recon_loss: 39283.7929; train_gene_expr_recon_loss: 83739.6298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125134.3661; train_optim_loss: 125134.3661; val_kl_reg_loss: 2100.1414; val_edge_recon_loss: 39303.6591; val_gene_expr_recon_loss: 85104.1806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126507.9810; val_optim_loss: 126507.9810

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9717; val_auprc_score: 0.9949; val_best_acc_score: 0.9853; val_best_f1_score: 0.9921; train_kl_reg_loss: 2104.5669; train_edge_recon_loss: 39884.5635; train_gene_expr_recon_loss: 83627.9121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125617.0426; train_optim_loss: 125617.0426; val_kl_reg_loss: 2105.2312; val_edge_recon_loss: 38987.2652; val_gene_expr_recon_loss: 85190.8315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126283.3285; val_optim_loss: 126283.3285
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9808; val_auprc_score: 0.9965; val_best_acc_score: 0.9876; val_best_f1_score: 0.9933; train_kl_reg_loss: 2108.7294; train_edge_recon_loss: 39515.6739; train_gene_expr_recon_loss: 83577.3617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125201.7654; train_optim_loss: 125201.7654; val_kl_reg_loss: 2100.9950; val_edge_recon_loss: 40014.8904; val_gene_expr_recon_loss: 85406.7960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 127522.6814; val_optim_loss: 127522.6814
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9764; val_auprc_score: 0.9963; val_best_acc_score: 0.9866; val_best_f1_score: 0.9928; train_kl_reg_loss: 2107.3184; train_edge_recon_loss: 39746.9261; train_gene_expr_recon_loss: 83671.6747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125525.9191; train_optim_loss: 125525.9191; val_kl_reg_loss: 2108.6502; val_edge_recon_loss: 38878.6242; val_gene_expr_recon_loss: 85142.9074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 126130.1825; val_optim_loss: 126130.1825

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 28 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9793
Val AUPRC score: 0.9969
Val best accuracy score: 0.9868
Val best F1 score: 0.9929
Val gene expr MSE score: 0.7014
Duration of model training in run 9: 0 hours, 22 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 9813
Number of validation nodes: 1090
Number of training edges: 112803
Number of validation edges: 12533
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8230; val_auprc_score: 0.9762; val_best_acc_score: 0.9436; val_best_f1_score: 0.9700; train_kl_reg_loss: 1380.5908; train_edge_recon_loss: 45539.6441; train_gene_expr_recon_loss: 99075.2735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 145995.5082; train_optim_loss: 145995.5082; val_kl_reg_loss: 1763.8351; val_edge_recon_loss: 44756.4224; val_gene_expr_recon_loss: 97177.1114; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 143697.3693; val_optim_loss: 143697.3693
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8957; val_auprc_score: 0.9877; val_best_acc_score: 0.9547; val_best_f1_score: 0.9760; train_kl_reg_loss: 1705.8260; train_edge_recon_loss: 42834.3204; train_gene_expr_recon_loss: 95457.6149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139997.7615; train_optim_loss: 139997.7615; val_kl_reg_loss: 1872.4400; val_edge_recon_loss: 40417.7254; val_gene_expr_recon_loss: 95119.2430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137409.4089; val_optim_loss: 137409.4089
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9081; val_auprc_score: 0.9882; val_best_acc_score: 0.9627; val_best_f1_score: 0.9801; train_kl_reg_loss: 1775.4981; train_edge_recon_loss: 42343.6672; train_gene_expr_recon_loss: 93663.2967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137782.4618; train_optim_loss: 137782.4618; val_kl_reg_loss: 1949.8855; val_edge_recon_loss: 41920.8180; val_gene_expr_recon_loss: 94105.8997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137976.6036; val_optim_loss: 137976.6036
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9290; val_auprc_score: 0.9907; val_best_acc_score: 0.9689; val_best_f1_score: 0.9833; train_kl_reg_loss: 1851.1651; train_edge_recon_loss: 41294.1523; train_gene_expr_recon_loss: 92353.5274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135498.8449; train_optim_loss: 135498.8449; val_kl_reg_loss: 1890.6924; val_edge_recon_loss: 40921.1184; val_gene_expr_recon_loss: 93121.7272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135933.5387; val_optim_loss: 135933.5387
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9421; val_auprc_score: 0.9928; val_best_acc_score: 0.9668; val_best_f1_score: 0.9822; train_kl_reg_loss: 1902.3689; train_edge_recon_loss: 41215.9737; train_gene_expr_recon_loss: 91340.6197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134458.9622; train_optim_loss: 134458.9622; val_kl_reg_loss: 1941.7747; val_edge_recon_loss: 42734.9672; val_gene_expr_recon_loss: 92070.8450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136747.5869; val_optim_loss: 136747.5869
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9579; val_auprc_score: 0.9942; val_best_acc_score: 0.9722; val_best_f1_score: 0.9851; train_kl_reg_loss: 1918.8101; train_edge_recon_loss: 40107.3012; train_gene_expr_recon_loss: 90413.4111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132439.5223; train_optim_loss: 132439.5223; val_kl_reg_loss: 1857.0509; val_edge_recon_loss: 39851.5434; val_gene_expr_recon_loss: 91310.1069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133018.7011; val_optim_loss: 133018.7011
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9562; val_auprc_score: 0.9941; val_best_acc_score: 0.9767; val_best_f1_score: 0.9875; train_kl_reg_loss: 1959.6632; train_edge_recon_loss: 40090.3212; train_gene_expr_recon_loss: 89674.8495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131724.8340; train_optim_loss: 131724.8340; val_kl_reg_loss: 2012.9925; val_edge_recon_loss: 38822.1991; val_gene_expr_recon_loss: 90573.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131408.5884; val_optim_loss: 131408.5884
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9628; val_auprc_score: 0.9957; val_best_acc_score: 0.9756; val_best_f1_score: 0.9870; train_kl_reg_loss: 1977.7092; train_edge_recon_loss: 41060.1464; train_gene_expr_recon_loss: 88900.0790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131937.9347; train_optim_loss: 131937.9347; val_kl_reg_loss: 2005.3627; val_edge_recon_loss: 39890.7606; val_gene_expr_recon_loss: 90234.2471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132130.3707; val_optim_loss: 132130.3707
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9609; val_auprc_score: 0.9934; val_best_acc_score: 0.9788; val_best_f1_score: 0.9887; train_kl_reg_loss: 2003.9998; train_edge_recon_loss: 40334.5251; train_gene_expr_recon_loss: 88194.6235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130533.1484; train_optim_loss: 130533.1484; val_kl_reg_loss: 2005.8406; val_edge_recon_loss: 38065.6125; val_gene_expr_recon_loss: 89827.8467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129899.2999; val_optim_loss: 129899.2999
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9671; val_auprc_score: 0.9955; val_best_acc_score: 0.9798; val_best_f1_score: 0.9892; train_kl_reg_loss: 2010.6449; train_edge_recon_loss: 40466.6218; train_gene_expr_recon_loss: 87645.9016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130123.1685; train_optim_loss: 130123.1685; val_kl_reg_loss: 2024.2936; val_edge_recon_loss: 39799.7550; val_gene_expr_recon_loss: 89215.2048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131039.2532; val_optim_loss: 131039.2532
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9727; val_auprc_score: 0.9954; val_best_acc_score: 0.9834; val_best_f1_score: 0.9911; train_kl_reg_loss: 2039.0101; train_edge_recon_loss: 39938.8867; train_gene_expr_recon_loss: 87085.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129063.2864; train_optim_loss: 129063.2864; val_kl_reg_loss: 2000.3951; val_edge_recon_loss: 39255.5643; val_gene_expr_recon_loss: 89172.3712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130428.3308; val_optim_loss: 130428.3308
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9681; val_auprc_score: 0.9953; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2039.5170; train_edge_recon_loss: 39621.7016; train_gene_expr_recon_loss: 86617.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128278.9052; train_optim_loss: 128278.9052; val_kl_reg_loss: 1930.5512; val_edge_recon_loss: 39163.0501; val_gene_expr_recon_loss: 88590.4384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129684.0399; val_optim_loss: 129684.0399
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9753; val_auprc_score: 0.9959; val_best_acc_score: 0.9828; val_best_f1_score: 0.9908; train_kl_reg_loss: 2065.9381; train_edge_recon_loss: 40342.7226; train_gene_expr_recon_loss: 86254.2152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128662.8758; train_optim_loss: 128662.8758; val_kl_reg_loss: 2064.2724; val_edge_recon_loss: 39472.8951; val_gene_expr_recon_loss: 88642.4827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130179.6500; val_optim_loss: 130179.6500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9734; val_auprc_score: 0.9956; val_best_acc_score: 0.9851; val_best_f1_score: 0.9920; train_kl_reg_loss: 2067.9735; train_edge_recon_loss: 39941.6353; train_gene_expr_recon_loss: 85829.7628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127839.3713; train_optim_loss: 127839.3713; val_kl_reg_loss: 2062.4438; val_edge_recon_loss: 39985.3815; val_gene_expr_recon_loss: 88149.6382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130197.4637; val_optim_loss: 130197.4637
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9710; val_auprc_score: 0.9950; val_best_acc_score: 0.9854; val_best_f1_score: 0.9922; train_kl_reg_loss: 2077.1560; train_edge_recon_loss: 40278.8582; train_gene_expr_recon_loss: 85443.9886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127800.0028; train_optim_loss: 127800.0028; val_kl_reg_loss: 2034.3024; val_edge_recon_loss: 38835.6109; val_gene_expr_recon_loss: 88524.7380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129394.6511; val_optim_loss: 129394.6511
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9721; val_auprc_score: 0.9949; val_best_acc_score: 0.9859; val_best_f1_score: 0.9924; train_kl_reg_loss: 2065.8173; train_edge_recon_loss: 40004.6597; train_gene_expr_recon_loss: 85222.3489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127292.8258; train_optim_loss: 127292.8258; val_kl_reg_loss: 2018.6421; val_edge_recon_loss: 38493.8802; val_gene_expr_recon_loss: 88273.8577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128786.3800; val_optim_loss: 128786.3800
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9745; val_auprc_score: 0.9955; val_best_acc_score: 0.9851; val_best_f1_score: 0.9920; train_kl_reg_loss: 2086.3734; train_edge_recon_loss: 39405.7784; train_gene_expr_recon_loss: 85055.0421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126547.1939; train_optim_loss: 126547.1939; val_kl_reg_loss: 2079.7849; val_edge_recon_loss: 38794.1645; val_gene_expr_recon_loss: 88366.8072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129240.7562; val_optim_loss: 129240.7562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9717; val_auprc_score: 0.9940; val_best_acc_score: 0.9837; val_best_f1_score: 0.9913; train_kl_reg_loss: 2118.1746; train_edge_recon_loss: 40446.8751; train_gene_expr_recon_loss: 84864.7523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127429.8022; train_optim_loss: 127429.8022; val_kl_reg_loss: 2142.9277; val_edge_recon_loss: 38138.0629; val_gene_expr_recon_loss: 88098.1962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128379.1875; val_optim_loss: 128379.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9758; val_auprc_score: 0.9956; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2118.5701; train_edge_recon_loss: 39599.7408; train_gene_expr_recon_loss: 84558.5872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126276.8978; train_optim_loss: 126276.8978; val_kl_reg_loss: 2083.2661; val_edge_recon_loss: 40287.4543; val_gene_expr_recon_loss: 88198.1905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130568.9105; val_optim_loss: 130568.9105
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9767; val_auprc_score: 0.9952; val_best_acc_score: 0.9866; val_best_f1_score: 0.9928; train_kl_reg_loss: 2105.9352; train_edge_recon_loss: 39367.1897; train_gene_expr_recon_loss: 84446.6048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 125919.7298; train_optim_loss: 125919.7298; val_kl_reg_loss: 2170.3792; val_edge_recon_loss: 41776.3574; val_gene_expr_recon_loss: 88166.2234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132112.9605; val_optim_loss: 132112.9605
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9737; val_auprc_score: 0.9961; val_best_acc_score: 0.9877; val_best_f1_score: 0.9934; train_kl_reg_loss: 2134.1206; train_edge_recon_loss: 39999.1377; train_gene_expr_recon_loss: 84257.7055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126390.9636; train_optim_loss: 126390.9636; val_kl_reg_loss: 2157.9916; val_edge_recon_loss: 39348.7647; val_gene_expr_recon_loss: 88535.8793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130042.6358; val_optim_loss: 130042.6358

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9748; val_auprc_score: 0.9949; val_best_acc_score: 0.9870; val_best_f1_score: 0.9930; train_kl_reg_loss: 2176.2871; train_edge_recon_loss: 40773.3509; train_gene_expr_recon_loss: 83222.9327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 126172.5709; train_optim_loss: 126172.5709; val_kl_reg_loss: 2176.9574; val_edge_recon_loss: 40589.5534; val_gene_expr_recon_loss: 88086.8017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130853.3127; val_optim_loss: 130853.3127
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9761; val_auprc_score: 0.9958; val_best_acc_score: 0.9876; val_best_f1_score: 0.9933; train_kl_reg_loss: 2160.0701; train_edge_recon_loss: 39264.8215; train_gene_expr_recon_loss: 83068.8179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124493.7094; train_optim_loss: 124493.7094; val_kl_reg_loss: 2132.0400; val_edge_recon_loss: 38855.5518; val_gene_expr_recon_loss: 88160.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129147.8801; val_optim_loss: 129147.8801
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9766; val_auprc_score: 0.9954; val_best_acc_score: 0.9881; val_best_f1_score: 0.9936; train_kl_reg_loss: 2159.2487; train_edge_recon_loss: 39605.2447; train_gene_expr_recon_loss: 83039.0092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124803.5027; train_optim_loss: 124803.5027; val_kl_reg_loss: 2150.3017; val_edge_recon_loss: 41178.3253; val_gene_expr_recon_loss: 87983.4165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131312.0435; val_optim_loss: 131312.0435

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 38 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9793
Val AUPRC score: 0.9955
Val best accuracy score: 0.9863
Val best F1 score: 0.9926
Val gene expr MSE score: 0.8133
Duration of model training in run 10: 0 hours, 21 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
First script finished. Launching follow up script.
Run timestamp: 02062023_130322.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '128', '128', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_5pct', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_sample_integration_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '5', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 117324
Number of validation edges: 13036
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7613; val_auprc_score: 0.9654; val_best_acc_score: 0.9388; val_best_f1_score: 0.9677; train_kl_reg_loss: 909.8030; train_edge_recon_loss: 48808.1271; train_gene_expr_recon_loss: 110834.8902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 160552.8214; train_optim_loss: 160552.8214; val_kl_reg_loss: 1448.5423; val_edge_recon_loss: 46959.1300; val_gene_expr_recon_loss: 102838.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 151245.9420; val_optim_loss: 151245.9420
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8225; val_auprc_score: 0.9779; val_best_acc_score: 0.9419; val_best_f1_score: 0.9694; train_kl_reg_loss: 1751.3823; train_edge_recon_loss: 43983.1736; train_gene_expr_recon_loss: 101894.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 147629.2990; train_optim_loss: 147629.2990; val_kl_reg_loss: 1854.0095; val_edge_recon_loss: 42939.4336; val_gene_expr_recon_loss: 100815.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145609.1295; val_optim_loss: 145609.1295
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8617; val_auprc_score: 0.9835; val_best_acc_score: 0.9467; val_best_f1_score: 0.9717; train_kl_reg_loss: 1893.2663; train_edge_recon_loss: 42356.0388; train_gene_expr_recon_loss: 100557.2373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144806.5428; train_optim_loss: 144806.5428; val_kl_reg_loss: 1962.1041; val_edge_recon_loss: 43496.1786; val_gene_expr_recon_loss: 100017.3504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145475.6317; val_optim_loss: 145475.6317
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8686; val_auprc_score: 0.9832; val_best_acc_score: 0.9427; val_best_f1_score: 0.9695; train_kl_reg_loss: 1948.2139; train_edge_recon_loss: 41706.0312; train_gene_expr_recon_loss: 99417.0985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143071.3438; train_optim_loss: 143071.3438; val_kl_reg_loss: 1934.5338; val_edge_recon_loss: 45352.5374; val_gene_expr_recon_loss: 99219.9520; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146507.0246; val_optim_loss: 146507.0246
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8974; val_auprc_score: 0.9876; val_best_acc_score: 0.9480; val_best_f1_score: 0.9724; train_kl_reg_loss: 2005.4052; train_edge_recon_loss: 42433.0117; train_gene_expr_recon_loss: 98647.7848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143086.2012; train_optim_loss: 143086.2012; val_kl_reg_loss: 2092.7067; val_edge_recon_loss: 41777.3672; val_gene_expr_recon_loss: 98882.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142752.3415; val_optim_loss: 142752.3415
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9057; val_auprc_score: 0.9896; val_best_acc_score: 0.9480; val_best_f1_score: 0.9723; train_kl_reg_loss: 2027.4084; train_edge_recon_loss: 41521.8345; train_gene_expr_recon_loss: 98173.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141722.7942; train_optim_loss: 141722.7942; val_kl_reg_loss: 1982.4472; val_edge_recon_loss: 42967.9777; val_gene_expr_recon_loss: 97119.5525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142069.9777; val_optim_loss: 142069.9777
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9121; val_auprc_score: 0.9904; val_best_acc_score: 0.9515; val_best_f1_score: 0.9743; train_kl_reg_loss: 2032.3136; train_edge_recon_loss: 41751.2846; train_gene_expr_recon_loss: 97681.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141465.5805; train_optim_loss: 141465.5805; val_kl_reg_loss: 2069.8600; val_edge_recon_loss: 41516.9509; val_gene_expr_recon_loss: 97434.5558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141021.3683; val_optim_loss: 141021.3683
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9081; val_auprc_score: 0.9900; val_best_acc_score: 0.9502; val_best_f1_score: 0.9736; train_kl_reg_loss: 2019.1699; train_edge_recon_loss: 41377.1433; train_gene_expr_recon_loss: 97273.8995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140670.2126; train_optim_loss: 140670.2126; val_kl_reg_loss: 2068.9977; val_edge_recon_loss: 41147.3610; val_gene_expr_recon_loss: 97204.4788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140420.8371; val_optim_loss: 140420.8371
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9240; val_auprc_score: 0.9909; val_best_acc_score: 0.9541; val_best_f1_score: 0.9756; train_kl_reg_loss: 2065.6449; train_edge_recon_loss: 40614.4453; train_gene_expr_recon_loss: 96840.7236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139520.8145; train_optim_loss: 139520.8145; val_kl_reg_loss: 2003.8180; val_edge_recon_loss: 41379.3075; val_gene_expr_recon_loss: 96614.3728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139997.5000; val_optim_loss: 139997.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9294; val_auprc_score: 0.9929; val_best_acc_score: 0.9537; val_best_f1_score: 0.9753; train_kl_reg_loss: 2058.3967; train_edge_recon_loss: 40563.3356; train_gene_expr_recon_loss: 96477.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139099.3416; train_optim_loss: 139099.3416; val_kl_reg_loss: 1992.7187; val_edge_recon_loss: 41903.5949; val_gene_expr_recon_loss: 96183.1585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140079.4732; val_optim_loss: 140079.4732
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9264; val_auprc_score: 0.9919; val_best_acc_score: 0.9563; val_best_f1_score: 0.9768; train_kl_reg_loss: 2049.7235; train_edge_recon_loss: 40504.3380; train_gene_expr_recon_loss: 96057.0484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138611.1096; train_optim_loss: 138611.1096; val_kl_reg_loss: 2018.2313; val_edge_recon_loss: 40800.4503; val_gene_expr_recon_loss: 95860.3705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138679.0536; val_optim_loss: 138679.0536
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9273; val_auprc_score: 0.9918; val_best_acc_score: 0.9558; val_best_f1_score: 0.9764; train_kl_reg_loss: 2041.7861; train_edge_recon_loss: 41068.8774; train_gene_expr_recon_loss: 95858.7737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138969.4380; train_optim_loss: 138969.4380; val_kl_reg_loss: 2041.1240; val_edge_recon_loss: 41038.3544; val_gene_expr_recon_loss: 96084.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139163.9866; val_optim_loss: 139163.9866
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9319; val_auprc_score: 0.9928; val_best_acc_score: 0.9555; val_best_f1_score: 0.9763; train_kl_reg_loss: 2050.2007; train_edge_recon_loss: 41352.5481; train_gene_expr_recon_loss: 95554.7745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138957.5232; train_optim_loss: 138957.5232; val_kl_reg_loss: 1959.6709; val_edge_recon_loss: 40976.4612; val_gene_expr_recon_loss: 95217.7400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138153.8728; val_optim_loss: 138153.8728
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9328; val_auprc_score: 0.9928; val_best_acc_score: 0.9599; val_best_f1_score: 0.9787; train_kl_reg_loss: 2066.8029; train_edge_recon_loss: 41074.7966; train_gene_expr_recon_loss: 95273.0832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138414.6827; train_optim_loss: 138414.6827; val_kl_reg_loss: 2109.3522; val_edge_recon_loss: 39979.3298; val_gene_expr_recon_loss: 95442.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137531.1585; val_optim_loss: 137531.1585
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9284; val_auprc_score: 0.9921; val_best_acc_score: 0.9574; val_best_f1_score: 0.9772; train_kl_reg_loss: 2067.5794; train_edge_recon_loss: 41073.5054; train_gene_expr_recon_loss: 95026.8288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138167.9127; train_optim_loss: 138167.9127; val_kl_reg_loss: 1979.7989; val_edge_recon_loss: 42622.9353; val_gene_expr_recon_loss: 94711.8415; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139314.5759; val_optim_loss: 139314.5759
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9395; val_auprc_score: 0.9933; val_best_acc_score: 0.9591; val_best_f1_score: 0.9781; train_kl_reg_loss: 2054.5582; train_edge_recon_loss: 41063.3682; train_gene_expr_recon_loss: 94820.0877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137938.0137; train_optim_loss: 137938.0137; val_kl_reg_loss: 2061.9297; val_edge_recon_loss: 40859.1797; val_gene_expr_recon_loss: 94904.8929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137826.0056; val_optim_loss: 137826.0056
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9271; val_auprc_score: 0.9914; val_best_acc_score: 0.9540; val_best_f1_score: 0.9755; train_kl_reg_loss: 2076.2393; train_edge_recon_loss: 41193.0246; train_gene_expr_recon_loss: 94687.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137956.5307; train_optim_loss: 137956.5307; val_kl_reg_loss: 2045.9624; val_edge_recon_loss: 44103.8287; val_gene_expr_recon_loss: 94462.8170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140612.6094; val_optim_loss: 140612.6094

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9280; val_auprc_score: 0.9918; val_best_acc_score: 0.9570; val_best_f1_score: 0.9771; train_kl_reg_loss: 2082.8982; train_edge_recon_loss: 40903.7696; train_gene_expr_recon_loss: 94254.1952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137240.8633; train_optim_loss: 137240.8633; val_kl_reg_loss: 2040.9519; val_edge_recon_loss: 43206.8131; val_gene_expr_recon_loss: 93919.1998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139166.9643; val_optim_loss: 139166.9643
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9433; val_auprc_score: 0.9943; val_best_acc_score: 0.9609; val_best_f1_score: 0.9791; train_kl_reg_loss: 2070.5802; train_edge_recon_loss: 40283.1611; train_gene_expr_recon_loss: 94067.1293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136420.8700; train_optim_loss: 136420.8700; val_kl_reg_loss: 1993.3608; val_edge_recon_loss: 39873.0982; val_gene_expr_recon_loss: 94120.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135987.4286; val_optim_loss: 135987.4286
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9390; val_auprc_score: 0.9930; val_best_acc_score: 0.9589; val_best_f1_score: 0.9781; train_kl_reg_loss: 2064.4441; train_edge_recon_loss: 41198.9232; train_gene_expr_recon_loss: 93996.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137260.3502; train_optim_loss: 137260.3502; val_kl_reg_loss: 2041.2386; val_edge_recon_loss: 41191.8538; val_gene_expr_recon_loss: 94807.9096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138041.0022; val_optim_loss: 138041.0022
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9375; val_auprc_score: 0.9923; val_best_acc_score: 0.9582; val_best_f1_score: 0.9777; train_kl_reg_loss: 2068.6620; train_edge_recon_loss: 40732.6948; train_gene_expr_recon_loss: 93887.2268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136688.5835; train_optim_loss: 136688.5835; val_kl_reg_loss: 2017.6200; val_edge_recon_loss: 41935.8677; val_gene_expr_recon_loss: 94495.5290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138449.0179; val_optim_loss: 138449.0179
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9353; val_auprc_score: 0.9929; val_best_acc_score: 0.9586; val_best_f1_score: 0.9779; train_kl_reg_loss: 2064.5491; train_edge_recon_loss: 41065.9923; train_gene_expr_recon_loss: 93732.0917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136862.6320; train_optim_loss: 136862.6320; val_kl_reg_loss: 2026.5548; val_edge_recon_loss: 41675.7416; val_gene_expr_recon_loss: 94595.6596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138297.9621; val_optim_loss: 138297.9621

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9410; val_auprc_score: 0.9941; val_best_acc_score: 0.9603; val_best_f1_score: 0.9789; train_kl_reg_loss: 2065.4819; train_edge_recon_loss: 40394.0442; train_gene_expr_recon_loss: 93882.5870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136342.1129; train_optim_loss: 136342.1129; val_kl_reg_loss: 2025.4259; val_edge_recon_loss: 40089.8421; val_gene_expr_recon_loss: 94951.3103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137066.5781; val_optim_loss: 137066.5781
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9404; val_auprc_score: 0.9937; val_best_acc_score: 0.9599; val_best_f1_score: 0.9785; train_kl_reg_loss: 2065.4144; train_edge_recon_loss: 40525.3821; train_gene_expr_recon_loss: 93712.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136303.5546; train_optim_loss: 136303.5546; val_kl_reg_loss: 2021.2143; val_edge_recon_loss: 41604.9118; val_gene_expr_recon_loss: 94322.9074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137949.0335; val_optim_loss: 137949.0335
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9416; val_auprc_score: 0.9937; val_best_acc_score: 0.9601; val_best_f1_score: 0.9787; train_kl_reg_loss: 2059.2322; train_edge_recon_loss: 40436.0371; train_gene_expr_recon_loss: 93809.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136304.8281; train_optim_loss: 136304.8281; val_kl_reg_loss: 2017.1752; val_edge_recon_loss: 40688.2143; val_gene_expr_recon_loss: 94243.7042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136949.0915; val_optim_loss: 136949.0915

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 2 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9339
Val AUPRC score: 0.9921
Val best accuracy score: 0.9578
Val best F1 score: 0.9774
Val gene expr MSE score: 0.6088
Duration of model training in run 1: 0 hours, 5 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 117324
Number of validation edges: 13036
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7639; val_auprc_score: 0.9676; val_best_acc_score: 0.9400; val_best_f1_score: 0.9685; train_kl_reg_loss: 880.7477; train_edge_recon_loss: 48417.8233; train_gene_expr_recon_loss: 109920.7130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 159219.2850; train_optim_loss: 159219.2850; val_kl_reg_loss: 1264.2944; val_edge_recon_loss: 44938.0681; val_gene_expr_recon_loss: 103437.1808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 149639.5424; val_optim_loss: 149639.5424
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8195; val_auprc_score: 0.9766; val_best_acc_score: 0.9425; val_best_f1_score: 0.9696; train_kl_reg_loss: 1739.1304; train_edge_recon_loss: 43357.5280; train_gene_expr_recon_loss: 101415.8904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146512.5490; train_optim_loss: 146512.5490; val_kl_reg_loss: 1861.3731; val_edge_recon_loss: 43453.3265; val_gene_expr_recon_loss: 101312.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146627.4107; val_optim_loss: 146627.4107
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8509; val_auprc_score: 0.9821; val_best_acc_score: 0.9422; val_best_f1_score: 0.9695; train_kl_reg_loss: 1888.7512; train_edge_recon_loss: 41897.6530; train_gene_expr_recon_loss: 100043.0684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143829.4731; train_optim_loss: 143829.4731; val_kl_reg_loss: 1875.5370; val_edge_recon_loss: 43988.3878; val_gene_expr_recon_loss: 100620.5491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146484.4754; val_optim_loss: 146484.4754
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8891; val_auprc_score: 0.9872; val_best_acc_score: 0.9445; val_best_f1_score: 0.9706; train_kl_reg_loss: 1967.3045; train_edge_recon_loss: 42301.3568; train_gene_expr_recon_loss: 98931.9553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 143200.6175; train_optim_loss: 143200.6175; val_kl_reg_loss: 1936.1754; val_edge_recon_loss: 43496.6507; val_gene_expr_recon_loss: 99784.2757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 145217.1049; val_optim_loss: 145217.1049
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8922; val_auprc_score: 0.9878; val_best_acc_score: 0.9419; val_best_f1_score: 0.9693; train_kl_reg_loss: 1968.1776; train_edge_recon_loss: 41852.7721; train_gene_expr_recon_loss: 98296.9068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142117.8561; train_optim_loss: 142117.8561; val_kl_reg_loss: 1936.8038; val_edge_recon_loss: 43386.0050; val_gene_expr_recon_loss: 99485.5569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 144808.3638; val_optim_loss: 144808.3638
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9101; val_auprc_score: 0.9898; val_best_acc_score: 0.9492; val_best_f1_score: 0.9729; train_kl_reg_loss: 2000.9118; train_edge_recon_loss: 41672.4237; train_gene_expr_recon_loss: 97787.0023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141460.3378; train_optim_loss: 141460.3378; val_kl_reg_loss: 1989.6979; val_edge_recon_loss: 42832.6479; val_gene_expr_recon_loss: 97974.7377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142797.0848; val_optim_loss: 142797.0848
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9080; val_auprc_score: 0.9899; val_best_acc_score: 0.9497; val_best_f1_score: 0.9732; train_kl_reg_loss: 2023.3801; train_edge_recon_loss: 40981.1754; train_gene_expr_recon_loss: 97335.2324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140339.7885; train_optim_loss: 140339.7885; val_kl_reg_loss: 2009.3694; val_edge_recon_loss: 43199.4760; val_gene_expr_recon_loss: 97477.3538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142686.1987; val_optim_loss: 142686.1987
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9237; val_auprc_score: 0.9908; val_best_acc_score: 0.9517; val_best_f1_score: 0.9742; train_kl_reg_loss: 2034.0482; train_edge_recon_loss: 41331.5799; train_gene_expr_recon_loss: 97034.0888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 140399.7169; train_optim_loss: 140399.7169; val_kl_reg_loss: 1945.5689; val_edge_recon_loss: 42390.3878; val_gene_expr_recon_loss: 96821.1696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 141157.1250; val_optim_loss: 141157.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9217; val_auprc_score: 0.9917; val_best_acc_score: 0.9526; val_best_f1_score: 0.9749; train_kl_reg_loss: 2054.8245; train_edge_recon_loss: 41337.6517; train_gene_expr_recon_loss: 96554.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139947.4294; train_optim_loss: 139947.4294; val_kl_reg_loss: 1973.5338; val_edge_recon_loss: 40074.9877; val_gene_expr_recon_loss: 97320.4621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139368.9777; val_optim_loss: 139368.9777
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9204; val_auprc_score: 0.9902; val_best_acc_score: 0.9524; val_best_f1_score: 0.9746; train_kl_reg_loss: 2047.8841; train_edge_recon_loss: 40936.6575; train_gene_expr_recon_loss: 96116.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139100.8362; train_optim_loss: 139100.8362; val_kl_reg_loss: 1957.7116; val_edge_recon_loss: 43183.3292; val_gene_expr_recon_loss: 97018.3170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 142159.3571; val_optim_loss: 142159.3571
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9335; val_auprc_score: 0.9934; val_best_acc_score: 0.9543; val_best_f1_score: 0.9756; train_kl_reg_loss: 2055.7806; train_edge_recon_loss: 40932.2901; train_gene_expr_recon_loss: 95851.1553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138839.2276; train_optim_loss: 138839.2276; val_kl_reg_loss: 1980.1339; val_edge_recon_loss: 40852.9598; val_gene_expr_recon_loss: 96745.8504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139578.9442; val_optim_loss: 139578.9442
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9265; val_auprc_score: 0.9918; val_best_acc_score: 0.9539; val_best_f1_score: 0.9753; train_kl_reg_loss: 2025.6619; train_edge_recon_loss: 40433.4357; train_gene_expr_recon_loss: 95520.3508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137979.4480; train_optim_loss: 137979.4480; val_kl_reg_loss: 2105.3997; val_edge_recon_loss: 41870.7690; val_gene_expr_recon_loss: 96438.6116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140414.7835; val_optim_loss: 140414.7835

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9299; val_auprc_score: 0.9925; val_best_acc_score: 0.9547; val_best_f1_score: 0.9758; train_kl_reg_loss: 2074.5121; train_edge_recon_loss: 40735.0571; train_gene_expr_recon_loss: 95163.8797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137973.4491; train_optim_loss: 137973.4491; val_kl_reg_loss: 1973.8794; val_edge_recon_loss: 40983.9425; val_gene_expr_recon_loss: 95707.5257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138665.3482; val_optim_loss: 138665.3482
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9321; val_auprc_score: 0.9925; val_best_acc_score: 0.9531; val_best_f1_score: 0.9749; train_kl_reg_loss: 2044.2093; train_edge_recon_loss: 40536.5908; train_gene_expr_recon_loss: 94863.9755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137444.7761; train_optim_loss: 137444.7761; val_kl_reg_loss: 1978.8837; val_edge_recon_loss: 41628.5000; val_gene_expr_recon_loss: 96234.8839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139842.2656; val_optim_loss: 139842.2656
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9354; val_auprc_score: 0.9930; val_best_acc_score: 0.9536; val_best_f1_score: 0.9752; train_kl_reg_loss: 2042.0141; train_edge_recon_loss: 41021.5278; train_gene_expr_recon_loss: 94987.3279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138050.8685; train_optim_loss: 138050.8685; val_kl_reg_loss: 1974.4756; val_edge_recon_loss: 41356.3454; val_gene_expr_recon_loss: 96264.4420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139595.2612; val_optim_loss: 139595.2612
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9290; val_auprc_score: 0.9914; val_best_acc_score: 0.9541; val_best_f1_score: 0.9754; train_kl_reg_loss: 2049.0845; train_edge_recon_loss: 40533.9167; train_gene_expr_recon_loss: 94910.3574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137493.3596; train_optim_loss: 137493.3596; val_kl_reg_loss: 1994.3040; val_edge_recon_loss: 41729.6272; val_gene_expr_recon_loss: 95924.1496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139648.0826; val_optim_loss: 139648.0826

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9287; val_auprc_score: 0.9922; val_best_acc_score: 0.9554; val_best_f1_score: 0.9761; train_kl_reg_loss: 2046.4720; train_edge_recon_loss: 41184.4349; train_gene_expr_recon_loss: 94899.8175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138130.7244; train_optim_loss: 138130.7244; val_kl_reg_loss: 1989.6140; val_edge_recon_loss: 41585.9749; val_gene_expr_recon_loss: 96190.2433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139765.8304; val_optim_loss: 139765.8304
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9384; val_auprc_score: 0.9941; val_best_acc_score: 0.9544; val_best_f1_score: 0.9756; train_kl_reg_loss: 2042.6364; train_edge_recon_loss: 40703.2881; train_gene_expr_recon_loss: 94853.6950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137599.6204; train_optim_loss: 137599.6204; val_kl_reg_loss: 1985.6083; val_edge_recon_loss: 40689.2723; val_gene_expr_recon_loss: 96296.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138971.5580; val_optim_loss: 138971.5580
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9270; val_auprc_score: 0.9918; val_best_acc_score: 0.9538; val_best_f1_score: 0.9753; train_kl_reg_loss: 2037.5517; train_edge_recon_loss: 40949.7509; train_gene_expr_recon_loss: 94756.3257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137743.6280; train_optim_loss: 137743.6280; val_kl_reg_loss: 1984.9661; val_edge_recon_loss: 41502.0407; val_gene_expr_recon_loss: 95661.7946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139148.7991; val_optim_loss: 139148.7991

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 52 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9239
Val AUPRC score: 0.9907
Val best accuracy score: 0.9523
Val best F1 score: 0.9745
Val gene expr MSE score: 0.6618
Duration of model training in run 2: 0 hours, 3 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 226790
Number of validation edges: 25198
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8834; val_auprc_score: 0.9869; val_best_acc_score: 0.9530; val_best_f1_score: 0.9752; train_kl_reg_loss: 1559.8574; train_edge_recon_loss: 44522.7102; train_gene_expr_recon_loss: 102665.3952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 148747.9626; train_optim_loss: 148747.9626; val_kl_reg_loss: 1833.3733; val_edge_recon_loss: 40836.0731; val_gene_expr_recon_loss: 98150.7256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140820.1719; val_optim_loss: 140820.1719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9303; val_auprc_score: 0.9923; val_best_acc_score: 0.9588; val_best_f1_score: 0.9780; train_kl_reg_loss: 1948.6188; train_edge_recon_loss: 41885.3865; train_gene_expr_recon_loss: 98078.6863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141912.6919; train_optim_loss: 141912.6919; val_kl_reg_loss: 2150.5089; val_edge_recon_loss: 40877.0909; val_gene_expr_recon_loss: 96791.7881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139819.3872; val_optim_loss: 139819.3872
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9373; val_auprc_score: 0.9927; val_best_acc_score: 0.9628; val_best_f1_score: 0.9802; train_kl_reg_loss: 1995.2134; train_edge_recon_loss: 41104.5872; train_gene_expr_recon_loss: 96737.9927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139837.7931; train_optim_loss: 139837.7931; val_kl_reg_loss: 1932.5821; val_edge_recon_loss: 40837.7773; val_gene_expr_recon_loss: 95837.3641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138607.7231; val_optim_loss: 138607.7231
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9480; val_auprc_score: 0.9944; val_best_acc_score: 0.9682; val_best_f1_score: 0.9830; train_kl_reg_loss: 2009.7184; train_edge_recon_loss: 40724.9778; train_gene_expr_recon_loss: 95822.0661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138556.7617; train_optim_loss: 138556.7617; val_kl_reg_loss: 1956.2425; val_edge_recon_loss: 39457.3279; val_gene_expr_recon_loss: 94783.2838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136196.8528; val_optim_loss: 136196.8528
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9546; val_auprc_score: 0.9952; val_best_acc_score: 0.9662; val_best_f1_score: 0.9819; train_kl_reg_loss: 2008.0921; train_edge_recon_loss: 41160.6320; train_gene_expr_recon_loss: 95046.3904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138215.1151; train_optim_loss: 138215.1151; val_kl_reg_loss: 1964.2369; val_edge_recon_loss: 41770.1312; val_gene_expr_recon_loss: 94657.6497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138392.0181; val_optim_loss: 138392.0181
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9522; val_auprc_score: 0.9950; val_best_acc_score: 0.9679; val_best_f1_score: 0.9829; train_kl_reg_loss: 2010.8083; train_edge_recon_loss: 40812.1082; train_gene_expr_recon_loss: 94515.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137338.5371; train_optim_loss: 137338.5371; val_kl_reg_loss: 1957.9354; val_edge_recon_loss: 39305.8445; val_gene_expr_recon_loss: 94027.9722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135291.7519; val_optim_loss: 135291.7519
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9584; val_auprc_score: 0.9956; val_best_acc_score: 0.9693; val_best_f1_score: 0.9836; train_kl_reg_loss: 2002.7297; train_edge_recon_loss: 40604.1091; train_gene_expr_recon_loss: 94143.4982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136750.3375; train_optim_loss: 136750.3375; val_kl_reg_loss: 2015.0725; val_edge_recon_loss: 40689.8052; val_gene_expr_recon_loss: 93581.3306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136286.2056; val_optim_loss: 136286.2056
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9618; val_auprc_score: 0.9959; val_best_acc_score: 0.9700; val_best_f1_score: 0.9840; train_kl_reg_loss: 2025.5381; train_edge_recon_loss: 41090.1638; train_gene_expr_recon_loss: 93613.5018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136729.2041; train_optim_loss: 136729.2041; val_kl_reg_loss: 1964.3625; val_edge_recon_loss: 40605.9863; val_gene_expr_recon_loss: 92980.0038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135550.3528; val_optim_loss: 135550.3528
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9613; val_auprc_score: 0.9959; val_best_acc_score: 0.9698; val_best_f1_score: 0.9839; train_kl_reg_loss: 2019.9233; train_edge_recon_loss: 40082.9496; train_gene_expr_recon_loss: 93385.4490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135488.3221; train_optim_loss: 135488.3221; val_kl_reg_loss: 1983.6359; val_edge_recon_loss: 40582.0148; val_gene_expr_recon_loss: 92770.7066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135336.3572; val_optim_loss: 135336.3572

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9596; val_auprc_score: 0.9955; val_best_acc_score: 0.9725; val_best_f1_score: 0.9853; train_kl_reg_loss: 2030.9802; train_edge_recon_loss: 40451.6818; train_gene_expr_recon_loss: 92408.3680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134891.0308; train_optim_loss: 134891.0308; val_kl_reg_loss: 2013.8827; val_edge_recon_loss: 39441.5802; val_gene_expr_recon_loss: 92308.8669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133764.3306; val_optim_loss: 133764.3306
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9641; val_auprc_score: 0.9957; val_best_acc_score: 0.9731; val_best_f1_score: 0.9856; train_kl_reg_loss: 2028.4937; train_edge_recon_loss: 40384.3471; train_gene_expr_recon_loss: 92393.5206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134806.3617; train_optim_loss: 134806.3617; val_kl_reg_loss: 2002.9155; val_edge_recon_loss: 39277.9916; val_gene_expr_recon_loss: 92293.8694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133574.7762; val_optim_loss: 133574.7762
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9631; val_auprc_score: 0.9956; val_best_acc_score: 0.9714; val_best_f1_score: 0.9847; train_kl_reg_loss: 2024.8579; train_edge_recon_loss: 40174.5456; train_gene_expr_recon_loss: 92277.8616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134477.2649; train_optim_loss: 134477.2649; val_kl_reg_loss: 2005.6366; val_edge_recon_loss: 40384.7673; val_gene_expr_recon_loss: 92110.1756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134500.5809; val_optim_loss: 134500.5809
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9595; val_auprc_score: 0.9956; val_best_acc_score: 0.9725; val_best_f1_score: 0.9853; train_kl_reg_loss: 2033.2567; train_edge_recon_loss: 40030.9437; train_gene_expr_recon_loss: 92176.0492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134240.2499; train_optim_loss: 134240.2499; val_kl_reg_loss: 1980.3228; val_edge_recon_loss: 40456.2841; val_gene_expr_recon_loss: 91937.2550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134373.8606; val_optim_loss: 134373.8606
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9669; val_auprc_score: 0.9964; val_best_acc_score: 0.9716; val_best_f1_score: 0.9847; train_kl_reg_loss: 2021.8672; train_edge_recon_loss: 39544.0919; train_gene_expr_recon_loss: 92118.4157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133684.3750; train_optim_loss: 133684.3750; val_kl_reg_loss: 1965.6485; val_edge_recon_loss: 41815.4483; val_gene_expr_recon_loss: 91613.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135394.4619; val_optim_loss: 135394.4619

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9629; val_auprc_score: 0.9961; val_best_acc_score: 0.9728; val_best_f1_score: 0.9854; train_kl_reg_loss: 2008.4729; train_edge_recon_loss: 40694.9863; train_gene_expr_recon_loss: 92059.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134763.4170; train_optim_loss: 134763.4170; val_kl_reg_loss: 1992.1548; val_edge_recon_loss: 39787.6759; val_gene_expr_recon_loss: 91942.9056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133722.7369; val_optim_loss: 133722.7369
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9616; val_auprc_score: 0.9955; val_best_acc_score: 0.9732; val_best_f1_score: 0.9857; train_kl_reg_loss: 2025.9774; train_edge_recon_loss: 40497.6883; train_gene_expr_recon_loss: 92124.9616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134648.6272; train_optim_loss: 134648.6272; val_kl_reg_loss: 1998.5293; val_edge_recon_loss: 39000.4792; val_gene_expr_recon_loss: 91788.2953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132787.3044; val_optim_loss: 132787.3044
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9621; val_auprc_score: 0.9958; val_best_acc_score: 0.9719; val_best_f1_score: 0.9850; train_kl_reg_loss: 2031.0523; train_edge_recon_loss: 40279.8234; train_gene_expr_recon_loss: 92103.1598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134414.0354; train_optim_loss: 134414.0354; val_kl_reg_loss: 1994.1868; val_edge_recon_loss: 40218.5509; val_gene_expr_recon_loss: 92162.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134375.0406; val_optim_loss: 134375.0406
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9641; val_auprc_score: 0.9957; val_best_acc_score: 0.9728; val_best_f1_score: 0.9854; train_kl_reg_loss: 2025.7515; train_edge_recon_loss: 40315.7071; train_gene_expr_recon_loss: 92062.4669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134403.9259; train_optim_loss: 134403.9259; val_kl_reg_loss: 1994.5975; val_edge_recon_loss: 40925.1101; val_gene_expr_recon_loss: 92129.1369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135048.8431; val_optim_loss: 135048.8431
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9648; val_auprc_score: 0.9961; val_best_acc_score: 0.9711; val_best_f1_score: 0.9845; train_kl_reg_loss: 2023.9987; train_edge_recon_loss: 40171.7104; train_gene_expr_recon_loss: 92090.2995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134286.0091; train_optim_loss: 134286.0091; val_kl_reg_loss: 1993.3318; val_edge_recon_loss: 41711.6983; val_gene_expr_recon_loss: 92259.5959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135964.6231; val_optim_loss: 135964.6231

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9628; val_auprc_score: 0.9958; val_best_acc_score: 0.9726; val_best_f1_score: 0.9853; train_kl_reg_loss: 2024.5287; train_edge_recon_loss: 40492.6834; train_gene_expr_recon_loss: 91986.8394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134504.0518; train_optim_loss: 134504.0518; val_kl_reg_loss: 1993.5787; val_edge_recon_loss: 40902.0912; val_gene_expr_recon_loss: 91888.5394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134784.2106; val_optim_loss: 134784.2106
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9654; val_auprc_score: 0.9961; val_best_acc_score: 0.9729; val_best_f1_score: 0.9854; train_kl_reg_loss: 2023.8690; train_edge_recon_loss: 39693.7215; train_gene_expr_recon_loss: 91954.2501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133671.8407; train_optim_loss: 133671.8407; val_kl_reg_loss: 1990.1684; val_edge_recon_loss: 41351.7072; val_gene_expr_recon_loss: 91440.4797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134782.3538; val_optim_loss: 134782.3538
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9614; val_auprc_score: 0.9953; val_best_acc_score: 0.9734; val_best_f1_score: 0.9857; train_kl_reg_loss: 2024.2908; train_edge_recon_loss: 40721.6133; train_gene_expr_recon_loss: 92123.7950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134869.6989; train_optim_loss: 134869.6989; val_kl_reg_loss: 1992.0647; val_edge_recon_loss: 40047.8863; val_gene_expr_recon_loss: 91668.8644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133708.8144; val_optim_loss: 133708.8144

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 41 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9622
Val AUPRC score: 0.9958
Val best accuracy score: 0.9717
Val best F1 score: 0.9849
Val gene expr MSE score: 0.6273
Duration of model training in run 3: 0 hours, 14 minutes and 55 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 226790
Number of validation edges: 25198
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8835; val_auprc_score: 0.9857; val_best_acc_score: 0.9508; val_best_f1_score: 0.9738; train_kl_reg_loss: 1502.1318; train_edge_recon_loss: 45356.2937; train_gene_expr_recon_loss: 102185.0178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 149043.4438; train_optim_loss: 149043.4438; val_kl_reg_loss: 1916.4468; val_edge_recon_loss: 44441.4833; val_gene_expr_recon_loss: 99837.3278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 146195.2581; val_optim_loss: 146195.2581
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9225; val_auprc_score: 0.9914; val_best_acc_score: 0.9591; val_best_f1_score: 0.9782; train_kl_reg_loss: 1909.7096; train_edge_recon_loss: 42415.9871; train_gene_expr_recon_loss: 97502.4343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141828.1306; train_optim_loss: 141828.1306; val_kl_reg_loss: 1993.4223; val_edge_recon_loss: 40466.5005; val_gene_expr_recon_loss: 98123.3169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140583.2400; val_optim_loss: 140583.2400
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9391; val_auprc_score: 0.9933; val_best_acc_score: 0.9627; val_best_f1_score: 0.9800; train_kl_reg_loss: 1996.9955; train_edge_recon_loss: 41155.7867; train_gene_expr_recon_loss: 96267.9228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139420.7053; train_optim_loss: 139420.7053; val_kl_reg_loss: 1889.6856; val_edge_recon_loss: 41292.4377; val_gene_expr_recon_loss: 96983.5981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140165.7225; val_optim_loss: 140165.7225
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9441; val_auprc_score: 0.9937; val_best_acc_score: 0.9643; val_best_f1_score: 0.9810; train_kl_reg_loss: 2011.8566; train_edge_recon_loss: 41174.6663; train_gene_expr_recon_loss: 95376.3719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138562.8947; train_optim_loss: 138562.8947; val_kl_reg_loss: 1939.6724; val_edge_recon_loss: 41108.4597; val_gene_expr_recon_loss: 96434.1069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139482.2387; val_optim_loss: 139482.2387
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9484; val_auprc_score: 0.9943; val_best_acc_score: 0.9655; val_best_f1_score: 0.9816; train_kl_reg_loss: 2012.5743; train_edge_recon_loss: 40817.8022; train_gene_expr_recon_loss: 94808.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137638.9629; train_optim_loss: 137638.9629; val_kl_reg_loss: 2031.9798; val_edge_recon_loss: 40163.4880; val_gene_expr_recon_loss: 95778.8737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137974.3406; val_optim_loss: 137974.3406
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9498; val_auprc_score: 0.9944; val_best_acc_score: 0.9682; val_best_f1_score: 0.9830; train_kl_reg_loss: 2012.8506; train_edge_recon_loss: 40557.6940; train_gene_expr_recon_loss: 94264.5474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136835.0922; train_optim_loss: 136835.0922; val_kl_reg_loss: 1944.1495; val_edge_recon_loss: 40192.0212; val_gene_expr_recon_loss: 95024.7794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137160.9488; val_optim_loss: 137160.9488
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9517; val_auprc_score: 0.9943; val_best_acc_score: 0.9686; val_best_f1_score: 0.9832; train_kl_reg_loss: 2022.9085; train_edge_recon_loss: 40780.6974; train_gene_expr_recon_loss: 93911.0351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136714.6409; train_optim_loss: 136714.6409; val_kl_reg_loss: 1989.4129; val_edge_recon_loss: 40967.6364; val_gene_expr_recon_loss: 95391.4616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138348.5106; val_optim_loss: 138348.5106
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9538; val_auprc_score: 0.9944; val_best_acc_score: 0.9703; val_best_f1_score: 0.9840; train_kl_reg_loss: 2031.2933; train_edge_recon_loss: 41157.3676; train_gene_expr_recon_loss: 93621.3418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136810.0025; train_optim_loss: 136810.0025; val_kl_reg_loss: 2039.2652; val_edge_recon_loss: 41429.1980; val_gene_expr_recon_loss: 94865.9113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138334.3766; val_optim_loss: 138334.3766
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9598; val_auprc_score: 0.9953; val_best_acc_score: 0.9721; val_best_f1_score: 0.9851; train_kl_reg_loss: 2017.9571; train_edge_recon_loss: 40960.1243; train_gene_expr_recon_loss: 93103.0091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136081.0902; train_optim_loss: 136081.0902; val_kl_reg_loss: 1972.9980; val_edge_recon_loss: 38637.6207; val_gene_expr_recon_loss: 94128.7934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134739.4125; val_optim_loss: 134739.4125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9643; val_auprc_score: 0.9956; val_best_acc_score: 0.9728; val_best_f1_score: 0.9855; train_kl_reg_loss: 2032.9328; train_edge_recon_loss: 40445.1092; train_gene_expr_recon_loss: 92714.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135192.3724; train_optim_loss: 135192.3724; val_kl_reg_loss: 2014.8040; val_edge_recon_loss: 39836.8329; val_gene_expr_recon_loss: 94035.7641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135887.4019; val_optim_loss: 135887.4019
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9655; val_auprc_score: 0.9963; val_best_acc_score: 0.9740; val_best_f1_score: 0.9861; train_kl_reg_loss: 2045.9107; train_edge_recon_loss: 40536.2638; train_gene_expr_recon_loss: 92556.5348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135138.7091; train_optim_loss: 135138.7091; val_kl_reg_loss: 2118.1496; val_edge_recon_loss: 39975.3127; val_gene_expr_recon_loss: 94036.4672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136129.9300; val_optim_loss: 136129.9300
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9663; val_auprc_score: 0.9966; val_best_acc_score: 0.9749; val_best_f1_score: 0.9866; train_kl_reg_loss: 2054.9361; train_edge_recon_loss: 40754.4415; train_gene_expr_recon_loss: 92273.6687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135083.0465; train_optim_loss: 135083.0465; val_kl_reg_loss: 1998.9454; val_edge_recon_loss: 38868.6501; val_gene_expr_recon_loss: 93782.8375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134650.4337; val_optim_loss: 134650.4337
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9652; val_auprc_score: 0.9959; val_best_acc_score: 0.9736; val_best_f1_score: 0.9858; train_kl_reg_loss: 2054.3103; train_edge_recon_loss: 40206.9569; train_gene_expr_recon_loss: 92030.2632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134291.5304; train_optim_loss: 134291.5304; val_kl_reg_loss: 2013.6052; val_edge_recon_loss: 40220.0597; val_gene_expr_recon_loss: 93760.0381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135993.7028; val_optim_loss: 135993.7028
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9701; val_auprc_score: 0.9963; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 2057.3801; train_edge_recon_loss: 40204.5744; train_gene_expr_recon_loss: 91822.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134084.0109; train_optim_loss: 134084.0109; val_kl_reg_loss: 1913.1170; val_edge_recon_loss: 39794.2081; val_gene_expr_recon_loss: 93399.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135106.6006; val_optim_loss: 135106.6006
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9714; val_auprc_score: 0.9965; val_best_acc_score: 0.9761; val_best_f1_score: 0.9872; train_kl_reg_loss: 2086.1780; train_edge_recon_loss: 40794.9412; train_gene_expr_recon_loss: 91659.0520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134540.1702; train_optim_loss: 134540.1702; val_kl_reg_loss: 2031.0546; val_edge_recon_loss: 39338.4957; val_gene_expr_recon_loss: 93398.3231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134767.8737; val_optim_loss: 134767.8737

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9698; val_auprc_score: 0.9966; val_best_acc_score: 0.9757; val_best_f1_score: 0.9870; train_kl_reg_loss: 2079.3299; train_edge_recon_loss: 40598.0760; train_gene_expr_recon_loss: 90970.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133647.9767; train_optim_loss: 133647.9767; val_kl_reg_loss: 2050.5868; val_edge_recon_loss: 41089.3183; val_gene_expr_recon_loss: 92759.9956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135899.9009; val_optim_loss: 135899.9009
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9728; val_auprc_score: 0.9971; val_best_acc_score: 0.9764; val_best_f1_score: 0.9873; train_kl_reg_loss: 2074.2202; train_edge_recon_loss: 40096.4060; train_gene_expr_recon_loss: 90768.9403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132939.5666; train_optim_loss: 132939.5666; val_kl_reg_loss: 2053.7463; val_edge_recon_loss: 40712.4200; val_gene_expr_recon_loss: 92943.8409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135710.0081; val_optim_loss: 135710.0081
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9742; val_auprc_score: 0.9971; val_best_acc_score: 0.9771; val_best_f1_score: 0.9877; train_kl_reg_loss: 2075.3407; train_edge_recon_loss: 40094.5685; train_gene_expr_recon_loss: 90696.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132865.9991; train_optim_loss: 132865.9991; val_kl_reg_loss: 2023.8738; val_edge_recon_loss: 40614.4682; val_gene_expr_recon_loss: 92897.8709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135536.2131; val_optim_loss: 135536.2131

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 0 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9680
Val AUPRC score: 0.9968
Val best accuracy score: 0.9736
Val best F1 score: 0.9859
Val gene expr MSE score: 0.6701
Duration of model training in run 4: 0 hours, 12 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 336078
Number of validation edges: 37341
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9278; val_auprc_score: 0.9916; val_best_acc_score: 0.9616; val_best_f1_score: 0.9795; train_kl_reg_loss: 1693.2904; train_edge_recon_loss: 43351.9150; train_gene_expr_recon_loss: 99609.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144654.8006; train_optim_loss: 144654.8006; val_kl_reg_loss: 1863.1723; val_edge_recon_loss: 41746.3228; val_gene_expr_recon_loss: 96816.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140426.2971; val_optim_loss: 140426.2971
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9497; val_auprc_score: 0.9945; val_best_acc_score: 0.9677; val_best_f1_score: 0.9827; train_kl_reg_loss: 1950.9276; train_edge_recon_loss: 41084.0748; train_gene_expr_recon_loss: 95905.7489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 138940.7513; train_optim_loss: 138940.7513; val_kl_reg_loss: 2098.1619; val_edge_recon_loss: 40831.6408; val_gene_expr_recon_loss: 95231.9588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138161.7615; val_optim_loss: 138161.7615
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9604; val_auprc_score: 0.9954; val_best_acc_score: 0.9715; val_best_f1_score: 0.9847; train_kl_reg_loss: 1995.1837; train_edge_recon_loss: 40696.1108; train_gene_expr_recon_loss: 94419.1925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137110.4869; train_optim_loss: 137110.4869; val_kl_reg_loss: 1890.7313; val_edge_recon_loss: 41224.2347; val_gene_expr_recon_loss: 93947.1866; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137062.1526; val_optim_loss: 137062.1526
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9637; val_auprc_score: 0.9959; val_best_acc_score: 0.9721; val_best_f1_score: 0.9851; train_kl_reg_loss: 1999.6436; train_edge_recon_loss: 40459.5736; train_gene_expr_recon_loss: 93587.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136046.6397; train_optim_loss: 136046.6397; val_kl_reg_loss: 1959.1322; val_edge_recon_loss: 40713.9831; val_gene_expr_recon_loss: 93104.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135778.0795; val_optim_loss: 135778.0795
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9683; val_auprc_score: 0.9962; val_best_acc_score: 0.9767; val_best_f1_score: 0.9876; train_kl_reg_loss: 2023.2808; train_edge_recon_loss: 40723.0410; train_gene_expr_recon_loss: 92955.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135702.1598; train_optim_loss: 135702.1598; val_kl_reg_loss: 1999.5395; val_edge_recon_loss: 38441.9409; val_gene_expr_recon_loss: 92987.3094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133428.7903; val_optim_loss: 133428.7903
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9683; val_auprc_score: 0.9963; val_best_acc_score: 0.9775; val_best_f1_score: 0.9879; train_kl_reg_loss: 2023.9158; train_edge_recon_loss: 40338.5093; train_gene_expr_recon_loss: 92381.3372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134743.7621; train_optim_loss: 134743.7621; val_kl_reg_loss: 1977.4922; val_edge_recon_loss: 38933.8165; val_gene_expr_recon_loss: 92517.1032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133428.4116; val_optim_loss: 133428.4116
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9696; val_auprc_score: 0.9966; val_best_acc_score: 0.9767; val_best_f1_score: 0.9875; train_kl_reg_loss: 2032.5765; train_edge_recon_loss: 40007.4040; train_gene_expr_recon_loss: 91825.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133865.6674; train_optim_loss: 133865.6674; val_kl_reg_loss: 2005.4875; val_edge_recon_loss: 40326.9855; val_gene_expr_recon_loss: 92003.5910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134336.0639; val_optim_loss: 134336.0639
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9764; val_auprc_score: 0.9974; val_best_acc_score: 0.9785; val_best_f1_score: 0.9884; train_kl_reg_loss: 2038.7463; train_edge_recon_loss: 39876.8937; train_gene_expr_recon_loss: 91621.6582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133537.2980; train_optim_loss: 133537.2980; val_kl_reg_loss: 2046.4972; val_edge_recon_loss: 40032.5410; val_gene_expr_recon_loss: 92064.5418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134143.5796; val_optim_loss: 134143.5796
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9743; val_auprc_score: 0.9966; val_best_acc_score: 0.9779; val_best_f1_score: 0.9881; train_kl_reg_loss: 2050.1147; train_edge_recon_loss: 39989.4375; train_gene_expr_recon_loss: 91235.0347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133274.5867; train_optim_loss: 133274.5867; val_kl_reg_loss: 2003.1497; val_edge_recon_loss: 40942.2078; val_gene_expr_recon_loss: 91720.7284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134666.0860; val_optim_loss: 134666.0860

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9753; val_auprc_score: 0.9976; val_best_acc_score: 0.9790; val_best_f1_score: 0.9887; train_kl_reg_loss: 2053.3645; train_edge_recon_loss: 39893.9781; train_gene_expr_recon_loss: 90488.6713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132436.0140; train_optim_loss: 132436.0140; val_kl_reg_loss: 2027.6555; val_edge_recon_loss: 39037.6298; val_gene_expr_recon_loss: 90959.7517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132025.0368; val_optim_loss: 132025.0368
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9760; val_auprc_score: 0.9967; val_best_acc_score: 0.9792; val_best_f1_score: 0.9888; train_kl_reg_loss: 2047.1340; train_edge_recon_loss: 40063.0407; train_gene_expr_recon_loss: 90240.8943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132351.0689; train_optim_loss: 132351.0689; val_kl_reg_loss: 2047.8596; val_edge_recon_loss: 41046.7753; val_gene_expr_recon_loss: 90824.3613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133918.9966; val_optim_loss: 133918.9966
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9724; val_auprc_score: 0.9969; val_best_acc_score: 0.9804; val_best_f1_score: 0.9895; train_kl_reg_loss: 2054.1343; train_edge_recon_loss: 40283.7293; train_gene_expr_recon_loss: 90250.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132588.2663; train_optim_loss: 132588.2663; val_kl_reg_loss: 2043.0697; val_edge_recon_loss: 40085.4435; val_gene_expr_recon_loss: 90901.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133030.0721; val_optim_loss: 133030.0721
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9757; val_auprc_score: 0.9973; val_best_acc_score: 0.9806; val_best_f1_score: 0.9896; train_kl_reg_loss: 2052.6782; train_edge_recon_loss: 40149.0401; train_gene_expr_recon_loss: 89987.4060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132189.1244; train_optim_loss: 132189.1244; val_kl_reg_loss: 2023.4215; val_edge_recon_loss: 39668.3698; val_gene_expr_recon_loss: 90879.0091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132570.8003; val_optim_loss: 132570.8003

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9772; val_auprc_score: 0.9974; val_best_acc_score: 0.9801; val_best_f1_score: 0.9893; train_kl_reg_loss: 2052.1105; train_edge_recon_loss: 39807.8713; train_gene_expr_recon_loss: 89979.7264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131839.7078; train_optim_loss: 131839.7078; val_kl_reg_loss: 2031.3002; val_edge_recon_loss: 39872.0173; val_gene_expr_recon_loss: 90891.0591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132794.3767; val_optim_loss: 132794.3767
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9777; val_auprc_score: 0.9972; val_best_acc_score: 0.9808; val_best_f1_score: 0.9897; train_kl_reg_loss: 2052.8851; train_edge_recon_loss: 40109.2296; train_gene_expr_recon_loss: 90054.8075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132216.9222; train_optim_loss: 132216.9222; val_kl_reg_loss: 2030.4195; val_edge_recon_loss: 39956.6911; val_gene_expr_recon_loss: 91022.6788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133009.7894; val_optim_loss: 133009.7894
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9785; val_auprc_score: 0.9977; val_best_acc_score: 0.9811; val_best_f1_score: 0.9898; train_kl_reg_loss: 2054.3290; train_edge_recon_loss: 40090.7960; train_gene_expr_recon_loss: 89960.6802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132105.8052; train_optim_loss: 132105.8052; val_kl_reg_loss: 2035.7959; val_edge_recon_loss: 39394.0955; val_gene_expr_recon_loss: 90835.4839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132265.3753; val_optim_loss: 132265.3753

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 53 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9754
Val AUPRC score: 0.9973
Val best accuracy score: 0.9796
Val best F1 score: 0.9890
Val gene expr MSE score: 0.6032
Duration of model training in run 5: 0 hours, 28 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 336078
Number of validation edges: 37341
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9224; val_auprc_score: 0.9907; val_best_acc_score: 0.9613; val_best_f1_score: 0.9794; train_kl_reg_loss: 1709.2386; train_edge_recon_loss: 42889.5440; train_gene_expr_recon_loss: 99885.0203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144483.8030; train_optim_loss: 144483.8030; val_kl_reg_loss: 1866.5822; val_edge_recon_loss: 41597.5114; val_gene_expr_recon_loss: 96704.4597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140168.5542; val_optim_loss: 140168.5542
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9458; val_auprc_score: 0.9941; val_best_acc_score: 0.9658; val_best_f1_score: 0.9817; train_kl_reg_loss: 1968.1226; train_edge_recon_loss: 41214.4876; train_gene_expr_recon_loss: 96080.4944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 139263.1048; train_optim_loss: 139263.1048; val_kl_reg_loss: 1936.8773; val_edge_recon_loss: 40592.8860; val_gene_expr_recon_loss: 95124.7230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137654.4868; val_optim_loss: 137654.4868
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9546; val_auprc_score: 0.9949; val_best_acc_score: 0.9702; val_best_f1_score: 0.9841; train_kl_reg_loss: 2007.2502; train_edge_recon_loss: 40567.6881; train_gene_expr_recon_loss: 94547.3561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137122.2943; train_optim_loss: 137122.2943; val_kl_reg_loss: 1999.9422; val_edge_recon_loss: 40100.3317; val_gene_expr_recon_loss: 93834.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135935.1686; val_optim_loss: 135935.1686
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9640; val_auprc_score: 0.9959; val_best_acc_score: 0.9732; val_best_f1_score: 0.9857; train_kl_reg_loss: 2011.7503; train_edge_recon_loss: 40762.2870; train_gene_expr_recon_loss: 93542.8076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 136316.8450; train_optim_loss: 136316.8450; val_kl_reg_loss: 1980.4006; val_edge_recon_loss: 39725.7824; val_gene_expr_recon_loss: 93065.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134771.9429; val_optim_loss: 134771.9429
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9674; val_auprc_score: 0.9960; val_best_acc_score: 0.9750; val_best_f1_score: 0.9866; train_kl_reg_loss: 2030.7144; train_edge_recon_loss: 40788.7683; train_gene_expr_recon_loss: 92986.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135805.8658; train_optim_loss: 135805.8658; val_kl_reg_loss: 1995.4598; val_edge_recon_loss: 40204.9364; val_gene_expr_recon_loss: 92693.6282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134894.0246; val_optim_loss: 134894.0246
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9719; val_auprc_score: 0.9966; val_best_acc_score: 0.9764; val_best_f1_score: 0.9873; train_kl_reg_loss: 2024.8250; train_edge_recon_loss: 40335.1014; train_gene_expr_recon_loss: 92479.4233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134839.3501; train_optim_loss: 134839.3501; val_kl_reg_loss: 2044.2498; val_edge_recon_loss: 39840.6386; val_gene_expr_recon_loss: 92908.5727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134793.4605; val_optim_loss: 134793.4605
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9716; val_auprc_score: 0.9969; val_best_acc_score: 0.9765; val_best_f1_score: 0.9874; train_kl_reg_loss: 2037.8509; train_edge_recon_loss: 40600.6760; train_gene_expr_recon_loss: 92034.9679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134673.4946; train_optim_loss: 134673.4946; val_kl_reg_loss: 1981.7989; val_edge_recon_loss: 39509.5764; val_gene_expr_recon_loss: 91889.7989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133381.1741; val_optim_loss: 133381.1741
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9733; val_auprc_score: 0.9969; val_best_acc_score: 0.9775; val_best_f1_score: 0.9879; train_kl_reg_loss: 2050.6680; train_edge_recon_loss: 40316.0072; train_gene_expr_recon_loss: 91677.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134044.4656; train_optim_loss: 134044.4656; val_kl_reg_loss: 2074.2390; val_edge_recon_loss: 39923.1170; val_gene_expr_recon_loss: 91644.2892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133641.6461; val_optim_loss: 133641.6461
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9758; val_auprc_score: 0.9974; val_best_acc_score: 0.9795; val_best_f1_score: 0.9890; train_kl_reg_loss: 2056.4371; train_edge_recon_loss: 40352.7733; train_gene_expr_recon_loss: 91260.6375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133669.8478; train_optim_loss: 133669.8478; val_kl_reg_loss: 2132.2935; val_edge_recon_loss: 38810.3672; val_gene_expr_recon_loss: 91755.2201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132697.8814; val_optim_loss: 132697.8814
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9761; val_auprc_score: 0.9971; val_best_acc_score: 0.9807; val_best_f1_score: 0.9896; train_kl_reg_loss: 2068.0728; train_edge_recon_loss: 40479.8938; train_gene_expr_recon_loss: 90916.0510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133464.0175; train_optim_loss: 133464.0175; val_kl_reg_loss: 1941.5193; val_edge_recon_loss: 39698.6941; val_gene_expr_recon_loss: 90829.5356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132469.7490; val_optim_loss: 132469.7490
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9773; val_auprc_score: 0.9973; val_best_acc_score: 0.9812; val_best_f1_score: 0.9899; train_kl_reg_loss: 2085.2905; train_edge_recon_loss: 40336.3149; train_gene_expr_recon_loss: 90576.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132997.8504; train_optim_loss: 132997.8504; val_kl_reg_loss: 2073.1728; val_edge_recon_loss: 39906.5252; val_gene_expr_recon_loss: 90960.4516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132940.1501; val_optim_loss: 132940.1501
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9791; val_auprc_score: 0.9977; val_best_acc_score: 0.9806; val_best_f1_score: 0.9896; train_kl_reg_loss: 2094.9502; train_edge_recon_loss: 40253.5734; train_gene_expr_recon_loss: 90179.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132527.6621; train_optim_loss: 132527.6621; val_kl_reg_loss: 2100.3706; val_edge_recon_loss: 40055.2301; val_gene_expr_recon_loss: 90556.9695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132712.5701; val_optim_loss: 132712.5701
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9797; val_auprc_score: 0.9975; val_best_acc_score: 0.9803; val_best_f1_score: 0.9894; train_kl_reg_loss: 2108.7869; train_edge_recon_loss: 39847.3853; train_gene_expr_recon_loss: 89797.9864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131754.1586; train_optim_loss: 131754.1586; val_kl_reg_loss: 2053.1772; val_edge_recon_loss: 39339.5066; val_gene_expr_recon_loss: 90420.2144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131812.8981; val_optim_loss: 131812.8981
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9792; val_auprc_score: 0.9974; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2116.8600; train_edge_recon_loss: 39923.9227; train_gene_expr_recon_loss: 89506.1019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131546.8848; train_optim_loss: 131546.8848; val_kl_reg_loss: 2105.1173; val_edge_recon_loss: 38280.6247; val_gene_expr_recon_loss: 89815.0590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130200.8009; val_optim_loss: 130200.8009
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9825; val_auprc_score: 0.9981; val_best_acc_score: 0.9815; val_best_f1_score: 0.9900; train_kl_reg_loss: 2132.3257; train_edge_recon_loss: 40066.7582; train_gene_expr_recon_loss: 89177.5290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131376.6129; train_optim_loss: 131376.6129; val_kl_reg_loss: 2042.2317; val_edge_recon_loss: 41467.6822; val_gene_expr_recon_loss: 90067.3568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133577.2711; val_optim_loss: 133577.2711
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9837; val_auprc_score: 0.9982; val_best_acc_score: 0.9826; val_best_f1_score: 0.9907; train_kl_reg_loss: 2142.1059; train_edge_recon_loss: 40103.6807; train_gene_expr_recon_loss: 88867.8710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131113.6580; train_optim_loss: 131113.6580; val_kl_reg_loss: 2135.2083; val_edge_recon_loss: 40057.2429; val_gene_expr_recon_loss: 89816.6753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132009.1269; val_optim_loss: 132009.1269
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9848; val_auprc_score: 0.9982; val_best_acc_score: 0.9844; val_best_f1_score: 0.9916; train_kl_reg_loss: 2155.7611; train_edge_recon_loss: 39995.5447; train_gene_expr_recon_loss: 88629.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130780.3182; train_optim_loss: 130780.3182; val_kl_reg_loss: 2111.7171; val_edge_recon_loss: 38962.5599; val_gene_expr_recon_loss: 89494.9049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130569.1820; val_optim_loss: 130569.1820

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9849; val_auprc_score: 0.9985; val_best_acc_score: 0.9840; val_best_f1_score: 0.9914; train_kl_reg_loss: 2161.3294; train_edge_recon_loss: 39791.8752; train_gene_expr_recon_loss: 87978.1494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129931.3540; train_optim_loss: 129931.3540; val_kl_reg_loss: 2112.6912; val_edge_recon_loss: 39197.9278; val_gene_expr_recon_loss: 89699.2967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131009.9163; val_optim_loss: 131009.9163
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9836; val_auprc_score: 0.9980; val_best_acc_score: 0.9829; val_best_f1_score: 0.9908; train_kl_reg_loss: 2148.8927; train_edge_recon_loss: 39501.9853; train_gene_expr_recon_loss: 87827.0006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129477.8785; train_optim_loss: 129477.8785; val_kl_reg_loss: 2143.6304; val_edge_recon_loss: 39819.7896; val_gene_expr_recon_loss: 89599.2409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131562.6612; val_optim_loss: 131562.6612
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9855; val_auprc_score: 0.9979; val_best_acc_score: 0.9845; val_best_f1_score: 0.9917; train_kl_reg_loss: 2156.9558; train_edge_recon_loss: 39850.7797; train_gene_expr_recon_loss: 87819.8423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129827.5781; train_optim_loss: 129827.5781; val_kl_reg_loss: 2125.1225; val_edge_recon_loss: 40107.0702; val_gene_expr_recon_loss: 89422.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131654.9634; val_optim_loss: 131654.9634

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 31 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9837
Val AUPRC score: 0.9981
Val best accuracy score: 0.9828
Val best F1 score: 0.9908
Val gene expr MSE score: 0.6572
Duration of model training in run 6: 0 hours, 35 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 445494
Number of validation edges: 49499
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9507; val_auprc_score: 0.9947; val_best_acc_score: 0.9681; val_best_f1_score: 0.9829; train_kl_reg_loss: 1806.9919; train_edge_recon_loss: 42326.7901; train_gene_expr_recon_loss: 98607.0405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142740.8225; train_optim_loss: 142740.8225; val_kl_reg_loss: 1990.8231; val_edge_recon_loss: 39948.4738; val_gene_expr_recon_loss: 95840.0115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137779.3081; val_optim_loss: 137779.3081
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9602; val_auprc_score: 0.9957; val_best_acc_score: 0.9732; val_best_f1_score: 0.9857; train_kl_reg_loss: 1983.9435; train_edge_recon_loss: 40633.4261; train_gene_expr_recon_loss: 94582.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137200.1795; train_optim_loss: 137200.1795; val_kl_reg_loss: 1932.8582; val_edge_recon_loss: 39129.9060; val_gene_expr_recon_loss: 93804.1269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134866.8907; val_optim_loss: 134866.8907
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9681; val_auprc_score: 0.9964; val_best_acc_score: 0.9757; val_best_f1_score: 0.9870; train_kl_reg_loss: 2003.3506; train_edge_recon_loss: 40742.9986; train_gene_expr_recon_loss: 93039.7663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135786.1155; train_optim_loss: 135786.1155; val_kl_reg_loss: 2003.6317; val_edge_recon_loss: 38829.1576; val_gene_expr_recon_loss: 92683.7367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133516.5258; val_optim_loss: 133516.5258
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9712; val_auprc_score: 0.9966; val_best_acc_score: 0.9767; val_best_f1_score: 0.9875; train_kl_reg_loss: 2008.4360; train_edge_recon_loss: 40139.4385; train_gene_expr_recon_loss: 92087.0899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134234.9644; train_optim_loss: 134234.9644; val_kl_reg_loss: 2039.8469; val_edge_recon_loss: 40108.8840; val_gene_expr_recon_loss: 92056.2768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134205.0081; val_optim_loss: 134205.0081
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9755; val_auprc_score: 0.9972; val_best_acc_score: 0.9800; val_best_f1_score: 0.9892; train_kl_reg_loss: 2031.9150; train_edge_recon_loss: 40084.1615; train_gene_expr_recon_loss: 91403.6431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133519.7196; train_optim_loss: 133519.7196; val_kl_reg_loss: 1959.4729; val_edge_recon_loss: 39170.3782; val_gene_expr_recon_loss: 91504.0799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132633.9308; val_optim_loss: 132633.9308
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9773; val_auprc_score: 0.9973; val_best_acc_score: 0.9804; val_best_f1_score: 0.9895; train_kl_reg_loss: 2038.3093; train_edge_recon_loss: 39737.6576; train_gene_expr_recon_loss: 90800.5025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132576.4696; train_optim_loss: 132576.4696; val_kl_reg_loss: 1983.0852; val_edge_recon_loss: 40809.5667; val_gene_expr_recon_loss: 90965.8717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133758.5233; val_optim_loss: 133758.5233
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9803; val_auprc_score: 0.9979; val_best_acc_score: 0.9813; val_best_f1_score: 0.9900; train_kl_reg_loss: 2063.2842; train_edge_recon_loss: 40049.5015; train_gene_expr_recon_loss: 90294.0701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132406.8558; train_optim_loss: 132406.8558; val_kl_reg_loss: 2018.5539; val_edge_recon_loss: 39427.8810; val_gene_expr_recon_loss: 90722.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132168.8547; val_optim_loss: 132168.8547
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9811; val_auprc_score: 0.9978; val_best_acc_score: 0.9835; val_best_f1_score: 0.9912; train_kl_reg_loss: 2087.5654; train_edge_recon_loss: 40591.9711; train_gene_expr_recon_loss: 89791.1020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132470.6384; train_optim_loss: 132470.6384; val_kl_reg_loss: 2078.8716; val_edge_recon_loss: 39286.7855; val_gene_expr_recon_loss: 90292.4423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131658.0993; val_optim_loss: 131658.0993
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9823; val_auprc_score: 0.9981; val_best_acc_score: 0.9822; val_best_f1_score: 0.9904; train_kl_reg_loss: 2109.5784; train_edge_recon_loss: 39793.6704; train_gene_expr_recon_loss: 89366.2412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131269.4900; train_optim_loss: 131269.4900; val_kl_reg_loss: 2146.8689; val_edge_recon_loss: 40881.5531; val_gene_expr_recon_loss: 90030.2298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133058.6520; val_optim_loss: 133058.6520
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9841; val_auprc_score: 0.9975; val_best_acc_score: 0.9844; val_best_f1_score: 0.9916; train_kl_reg_loss: 2107.9881; train_edge_recon_loss: 39684.3687; train_gene_expr_recon_loss: 88951.4480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130743.8048; train_optim_loss: 130743.8048; val_kl_reg_loss: 2078.9203; val_edge_recon_loss: 38508.7052; val_gene_expr_recon_loss: 89771.4289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130359.0545; val_optim_loss: 130359.0545
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9852; val_auprc_score: 0.9982; val_best_acc_score: 0.9852; val_best_f1_score: 0.9920; train_kl_reg_loss: 2122.9400; train_edge_recon_loss: 39758.1132; train_gene_expr_recon_loss: 88605.7434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130486.7965; train_optim_loss: 130486.7965; val_kl_reg_loss: 2094.2470; val_edge_recon_loss: 40423.1805; val_gene_expr_recon_loss: 89617.4299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132134.8573; val_optim_loss: 132134.8573
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9877; val_auprc_score: 0.9985; val_best_acc_score: 0.9869; val_best_f1_score: 0.9930; train_kl_reg_loss: 2144.4671; train_edge_recon_loss: 39843.9839; train_gene_expr_recon_loss: 88275.1356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130263.5866; train_optim_loss: 130263.5866; val_kl_reg_loss: 2117.6323; val_edge_recon_loss: 39227.9290; val_gene_expr_recon_loss: 89426.0426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130771.6039; val_optim_loss: 130771.6039
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9882; val_auprc_score: 0.9985; val_best_acc_score: 0.9865; val_best_f1_score: 0.9927; train_kl_reg_loss: 2150.9953; train_edge_recon_loss: 39677.6032; train_gene_expr_recon_loss: 88031.2421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129859.8406; train_optim_loss: 129859.8406; val_kl_reg_loss: 2176.3358; val_edge_recon_loss: 39796.1307; val_gene_expr_recon_loss: 89355.0719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131327.5387; val_optim_loss: 131327.5387

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9982; val_best_acc_score: 0.9871; val_best_f1_score: 0.9931; train_kl_reg_loss: 2161.9164; train_edge_recon_loss: 39633.0716; train_gene_expr_recon_loss: 87296.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129091.5570; train_optim_loss: 129091.5570; val_kl_reg_loss: 2145.1690; val_edge_recon_loss: 39580.8896; val_gene_expr_recon_loss: 88923.1298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130649.1883; val_optim_loss: 130649.1883
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9894; val_auprc_score: 0.9988; val_best_acc_score: 0.9870; val_best_f1_score: 0.9930; train_kl_reg_loss: 2156.3550; train_edge_recon_loss: 40112.1483; train_gene_expr_recon_loss: 87160.7941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129429.2976; train_optim_loss: 129429.2976; val_kl_reg_loss: 2127.6727; val_edge_recon_loss: 39963.0831; val_gene_expr_recon_loss: 88941.7196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131032.4756; val_optim_loss: 131032.4756
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9886; val_auprc_score: 0.9981; val_best_acc_score: 0.9869; val_best_f1_score: 0.9929; train_kl_reg_loss: 2152.3463; train_edge_recon_loss: 39483.6635; train_gene_expr_recon_loss: 87106.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128742.8525; train_optim_loss: 128742.8525; val_kl_reg_loss: 2116.2553; val_edge_recon_loss: 39689.9438; val_gene_expr_recon_loss: 88998.8869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130805.0868; val_optim_loss: 130805.0868

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 59 min 50 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.9842
Val AUPRC score: 0.9982
Val best accuracy score: 0.9840
Val best F1 score: 0.9914
Val gene expr MSE score: 0.6652
Duration of model training in run 7: 1 hours, 1 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 445494
Number of validation edges: 49499
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9420; val_auprc_score: 0.9932; val_best_acc_score: 0.9649; val_best_f1_score: 0.9812; train_kl_reg_loss: 1810.3031; train_edge_recon_loss: 42203.3864; train_gene_expr_recon_loss: 98608.8704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142622.5600; train_optim_loss: 142622.5600; val_kl_reg_loss: 1937.6739; val_edge_recon_loss: 41242.5901; val_gene_expr_recon_loss: 96731.3232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 139911.5877; val_optim_loss: 139911.5877
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9620; val_auprc_score: 0.9959; val_best_acc_score: 0.9702; val_best_f1_score: 0.9840; train_kl_reg_loss: 1972.0650; train_edge_recon_loss: 40722.8376; train_gene_expr_recon_loss: 94654.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 137349.6264; train_optim_loss: 137349.6264; val_kl_reg_loss: 1981.2405; val_edge_recon_loss: 40699.8305; val_gene_expr_recon_loss: 94664.7947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137345.8657; val_optim_loss: 137345.8657
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9668; val_auprc_score: 0.9964; val_best_acc_score: 0.9745; val_best_f1_score: 0.9863; train_kl_reg_loss: 2009.9119; train_edge_recon_loss: 40753.3685; train_gene_expr_recon_loss: 93102.6414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135865.9218; train_optim_loss: 135865.9218; val_kl_reg_loss: 2004.8406; val_edge_recon_loss: 39753.8786; val_gene_expr_recon_loss: 93481.4467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 135240.1659; val_optim_loss: 135240.1659
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9710; val_auprc_score: 0.9969; val_best_acc_score: 0.9767; val_best_f1_score: 0.9875; train_kl_reg_loss: 2013.3910; train_edge_recon_loss: 40169.5289; train_gene_expr_recon_loss: 92094.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134277.8993; train_optim_loss: 134277.8993; val_kl_reg_loss: 2090.6131; val_edge_recon_loss: 39460.1987; val_gene_expr_recon_loss: 92853.3282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134404.1403; val_optim_loss: 134404.1403
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9730; val_auprc_score: 0.9969; val_best_acc_score: 0.9804; val_best_f1_score: 0.9895; train_kl_reg_loss: 2032.5228; train_edge_recon_loss: 40114.1377; train_gene_expr_recon_loss: 91386.4884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133533.1489; train_optim_loss: 133533.1489; val_kl_reg_loss: 1970.9272; val_edge_recon_loss: 38992.5024; val_gene_expr_recon_loss: 92337.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133301.3735; val_optim_loss: 133301.3735
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9759; val_auprc_score: 0.9974; val_best_acc_score: 0.9800; val_best_f1_score: 0.9893; train_kl_reg_loss: 2046.6902; train_edge_recon_loss: 39938.1796; train_gene_expr_recon_loss: 90828.4828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132813.3526; train_optim_loss: 132813.3526; val_kl_reg_loss: 2029.6389; val_edge_recon_loss: 40531.2997; val_gene_expr_recon_loss: 91735.8746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 134296.8131; val_optim_loss: 134296.8131
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9808; val_auprc_score: 0.9976; val_best_acc_score: 0.9808; val_best_f1_score: 0.9897; train_kl_reg_loss: 2064.4487; train_edge_recon_loss: 39917.3189; train_gene_expr_recon_loss: 90281.5808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 132263.3485; train_optim_loss: 132263.3485; val_kl_reg_loss: 1968.6657; val_edge_recon_loss: 39573.8392; val_gene_expr_recon_loss: 91483.7785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133026.2833; val_optim_loss: 133026.2833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9810; val_auprc_score: 0.9978; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2083.8204; train_edge_recon_loss: 39921.1673; train_gene_expr_recon_loss: 89758.9598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131763.9478; train_optim_loss: 131763.9478; val_kl_reg_loss: 2096.5203; val_edge_recon_loss: 39292.4265; val_gene_expr_recon_loss: 90997.1344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132386.0809; val_optim_loss: 132386.0809
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9829; val_auprc_score: 0.9978; val_best_acc_score: 0.9826; val_best_f1_score: 0.9906; train_kl_reg_loss: 2102.1057; train_edge_recon_loss: 39518.0970; train_gene_expr_recon_loss: 89248.2483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130868.4512; train_optim_loss: 130868.4512; val_kl_reg_loss: 2046.0995; val_edge_recon_loss: 40233.4095; val_gene_expr_recon_loss: 90629.6997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132909.2090; val_optim_loss: 132909.2090
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9865; val_auprc_score: 0.9983; val_best_acc_score: 0.9848; val_best_f1_score: 0.9918; train_kl_reg_loss: 2121.4565; train_edge_recon_loss: 40175.7030; train_gene_expr_recon_loss: 88858.4927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131155.6523; train_optim_loss: 131155.6523; val_kl_reg_loss: 2130.9057; val_edge_recon_loss: 39714.0232; val_gene_expr_recon_loss: 90491.0223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132335.9510; val_optim_loss: 132335.9510
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9827; val_auprc_score: 0.9976; val_best_acc_score: 0.9836; val_best_f1_score: 0.9912; train_kl_reg_loss: 2129.3508; train_edge_recon_loss: 39307.1200; train_gene_expr_recon_loss: 88532.2398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129968.7106; train_optim_loss: 129968.7106; val_kl_reg_loss: 2136.1651; val_edge_recon_loss: 40227.2545; val_gene_expr_recon_loss: 90323.4748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132686.8945; val_optim_loss: 132686.8945
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9853; val_auprc_score: 0.9984; val_best_acc_score: 0.9843; val_best_f1_score: 0.9916; train_kl_reg_loss: 2146.2865; train_edge_recon_loss: 40136.0010; train_gene_expr_recon_loss: 88164.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130446.3502; train_optim_loss: 130446.3502; val_kl_reg_loss: 2190.1259; val_edge_recon_loss: 39865.5343; val_gene_expr_recon_loss: 90078.1999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132133.8600; val_optim_loss: 132133.8600
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9860; val_auprc_score: 0.9982; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2153.7710; train_edge_recon_loss: 39647.0572; train_gene_expr_recon_loss: 87946.8820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129747.7101; train_optim_loss: 129747.7101; val_kl_reg_loss: 2199.5592; val_edge_recon_loss: 40189.5025; val_gene_expr_recon_loss: 89908.0891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132297.1505; val_optim_loss: 132297.1505
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9874; val_auprc_score: 0.9981; val_best_acc_score: 0.9867; val_best_f1_score: 0.9928; train_kl_reg_loss: 2165.3065; train_edge_recon_loss: 39860.4676; train_gene_expr_recon_loss: 87705.1345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129730.9087; train_optim_loss: 129730.9087; val_kl_reg_loss: 2159.6425; val_edge_recon_loss: 39836.0525; val_gene_expr_recon_loss: 89901.1048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131896.7999; val_optim_loss: 131896.7999
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9883; val_auprc_score: 0.9986; val_best_acc_score: 0.9863; val_best_f1_score: 0.9926; train_kl_reg_loss: 2173.0302; train_edge_recon_loss: 39813.7392; train_gene_expr_recon_loss: 87530.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129517.7358; train_optim_loss: 129517.7358; val_kl_reg_loss: 2169.6350; val_edge_recon_loss: 40408.8865; val_gene_expr_recon_loss: 89763.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132341.7490; val_optim_loss: 132341.7490
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9881; val_auprc_score: 0.9984; val_best_acc_score: 0.9869; val_best_f1_score: 0.9929; train_kl_reg_loss: 2173.8510; train_edge_recon_loss: 39482.7991; train_gene_expr_recon_loss: 87277.9271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128934.5771; train_optim_loss: 128934.5771; val_kl_reg_loss: 2200.8363; val_edge_recon_loss: 39985.8596; val_gene_expr_recon_loss: 89790.0152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131976.7108; val_optim_loss: 131976.7108
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9875; val_auprc_score: 0.9983; val_best_acc_score: 0.9870; val_best_f1_score: 0.9930; train_kl_reg_loss: 2193.7743; train_edge_recon_loss: 39996.8472; train_gene_expr_recon_loss: 87157.1859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129347.8074; train_optim_loss: 129347.8074; val_kl_reg_loss: 2200.1366; val_edge_recon_loss: 39697.3886; val_gene_expr_recon_loss: 89832.1908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131729.7162; val_optim_loss: 131729.7162
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9895; val_auprc_score: 0.9985; val_best_acc_score: 0.9879; val_best_f1_score: 0.9935; train_kl_reg_loss: 2193.7880; train_edge_recon_loss: 39759.6141; train_gene_expr_recon_loss: 87008.3076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128961.7097; train_optim_loss: 128961.7097; val_kl_reg_loss: 2182.1315; val_edge_recon_loss: 38801.2286; val_gene_expr_recon_loss: 89794.7589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130778.1191; val_optim_loss: 130778.1191
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9897; val_auprc_score: 0.9985; val_best_acc_score: 0.9872; val_best_f1_score: 0.9931; train_kl_reg_loss: 2200.7823; train_edge_recon_loss: 39679.2969; train_gene_expr_recon_loss: 86875.4221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128755.5012; train_optim_loss: 128755.5012; val_kl_reg_loss: 2200.6021; val_edge_recon_loss: 39697.6311; val_gene_expr_recon_loss: 89767.2565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131665.4898; val_optim_loss: 131665.4898
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9904; val_auprc_score: 0.9989; val_best_acc_score: 0.9871; val_best_f1_score: 0.9930; train_kl_reg_loss: 2215.4062; train_edge_recon_loss: 40024.2071; train_gene_expr_recon_loss: 86753.1986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128992.8118; train_optim_loss: 128992.8118; val_kl_reg_loss: 2300.1993; val_edge_recon_loss: 40496.2190; val_gene_expr_recon_loss: 89819.3769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132615.7947; val_optim_loss: 132615.7947
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9904; val_auprc_score: 0.9985; val_best_acc_score: 0.9881; val_best_f1_score: 0.9936; train_kl_reg_loss: 2217.9733; train_edge_recon_loss: 39651.1062; train_gene_expr_recon_loss: 86656.8871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128525.9665; train_optim_loss: 128525.9665; val_kl_reg_loss: 2198.9503; val_edge_recon_loss: 40624.2160; val_gene_expr_recon_loss: 89876.1120; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132699.2785; val_optim_loss: 132699.2785

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9910; val_auprc_score: 0.9987; val_best_acc_score: 0.9891; val_best_f1_score: 0.9941; train_kl_reg_loss: 2233.3417; train_edge_recon_loss: 39876.2020; train_gene_expr_recon_loss: 85986.3702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128095.9139; train_optim_loss: 128095.9139; val_kl_reg_loss: 2249.0550; val_edge_recon_loss: 37991.8501; val_gene_expr_recon_loss: 89553.4621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129794.3675; val_optim_loss: 129794.3675
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9910; val_auprc_score: 0.9985; val_best_acc_score: 0.9888; val_best_f1_score: 0.9940; train_kl_reg_loss: 2230.9024; train_edge_recon_loss: 39574.1941; train_gene_expr_recon_loss: 85873.1734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127678.2698; train_optim_loss: 127678.2698; val_kl_reg_loss: 2191.6816; val_edge_recon_loss: 39127.3174; val_gene_expr_recon_loss: 89515.2332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130834.2323; val_optim_loss: 130834.2323
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9915; val_auprc_score: 0.9988; val_best_acc_score: 0.9894; val_best_f1_score: 0.9943; train_kl_reg_loss: 2234.7244; train_edge_recon_loss: 39855.3195; train_gene_expr_recon_loss: 85787.8199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127877.8638; train_optim_loss: 127877.8638; val_kl_reg_loss: 2249.9186; val_edge_recon_loss: 39482.4448; val_gene_expr_recon_loss: 89502.7999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131235.1627; val_optim_loss: 131235.1627
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9920; val_auprc_score: 0.9989; val_best_acc_score: 0.9899; val_best_f1_score: 0.9945; train_kl_reg_loss: 2233.8851; train_edge_recon_loss: 39871.7605; train_gene_expr_recon_loss: 85754.1461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127859.7917; train_optim_loss: 127859.7917; val_kl_reg_loss: 2228.5837; val_edge_recon_loss: 39006.7627; val_gene_expr_recon_loss: 89558.8254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130794.1718; val_optim_loss: 130794.1718

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9904; val_auprc_score: 0.9983; val_best_acc_score: 0.9888; val_best_f1_score: 0.9939; train_kl_reg_loss: 2234.9953; train_edge_recon_loss: 39548.0782; train_gene_expr_recon_loss: 85652.3787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127435.4521; train_optim_loss: 127435.4521; val_kl_reg_loss: 2223.5659; val_edge_recon_loss: 39875.9968; val_gene_expr_recon_loss: 89588.7583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131688.3205; val_optim_loss: 131688.3205
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9914; val_auprc_score: 0.9989; val_best_acc_score: 0.9889; val_best_f1_score: 0.9940; train_kl_reg_loss: 2229.4573; train_edge_recon_loss: 39260.4865; train_gene_expr_recon_loss: 85596.9009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127086.8445; train_optim_loss: 127086.8445; val_kl_reg_loss: 2221.7768; val_edge_recon_loss: 39514.1602; val_gene_expr_recon_loss: 89592.2013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131328.1382; val_optim_loss: 131328.1382
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9916; val_auprc_score: 0.9989; val_best_acc_score: 0.9890; val_best_f1_score: 0.9941; train_kl_reg_loss: 2231.2157; train_edge_recon_loss: 39396.5945; train_gene_expr_recon_loss: 85608.8675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127236.6776; train_optim_loss: 127236.6776; val_kl_reg_loss: 2217.0355; val_edge_recon_loss: 40078.4359; val_gene_expr_recon_loss: 89606.3885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131901.8595; val_optim_loss: 131901.8595

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 109 min 35 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9923
Val AUPRC score: 0.9989
Val best accuracy score: 0.9886
Val best F1 score: 0.9939
Val gene expr MSE score: 0.6198
Duration of model training in run 8: 1 hours, 51 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...


Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 1022, n_heads: 4, self_loops: True

--- INITIALIZING TRAINER ---
Number of training nodes: 49099
Number of validation nodes: 5456
Number of training edges: 555301
Number of validation edges: 61700
Edge batch size: 128
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9526; val_auprc_score: 0.9945; val_best_acc_score: 0.9678; val_best_f1_score: 0.9827; train_kl_reg_loss: 1865.8290; train_edge_recon_loss: 42003.2962; train_gene_expr_recon_loss: 97953.0175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141822.1426; train_optim_loss: 141822.1426; val_kl_reg_loss: 2044.7229; val_edge_recon_loss: 40872.9286; val_gene_expr_recon_loss: 93761.1563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 136678.8075; val_optim_loss: 136678.8075
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9639; val_auprc_score: 0.9962; val_best_acc_score: 0.9740; val_best_f1_score: 0.9861; train_kl_reg_loss: 2003.8066; train_edge_recon_loss: 40560.0506; train_gene_expr_recon_loss: 93191.8064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135755.6636; train_optim_loss: 135755.6636; val_kl_reg_loss: 2061.1210; val_edge_recon_loss: 39762.8664; val_gene_expr_recon_loss: 91421.1634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 133245.1511; val_optim_loss: 133245.1511
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9718; val_auprc_score: 0.9966; val_best_acc_score: 0.9779; val_best_f1_score: 0.9882; train_kl_reg_loss: 2025.4493; train_edge_recon_loss: 40307.1638; train_gene_expr_recon_loss: 91579.4594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133912.0725; train_optim_loss: 133912.0725; val_kl_reg_loss: 2067.7150; val_edge_recon_loss: 39193.0646; val_gene_expr_recon_loss: 90449.9477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 131710.7271; val_optim_loss: 131710.7271
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9780; val_auprc_score: 0.9975; val_best_acc_score: 0.9824; val_best_f1_score: 0.9906; train_kl_reg_loss: 2052.3622; train_edge_recon_loss: 40312.9424; train_gene_expr_recon_loss: 90771.9477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 133137.2523; train_optim_loss: 133137.2523; val_kl_reg_loss: 2088.2055; val_edge_recon_loss: 38240.8818; val_gene_expr_recon_loss: 89960.9999; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130290.0870; val_optim_loss: 130290.0870
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9814; val_auprc_score: 0.9977; val_best_acc_score: 0.9839; val_best_f1_score: 0.9914; train_kl_reg_loss: 2069.5832; train_edge_recon_loss: 39782.9668; train_gene_expr_recon_loss: 90056.8187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131909.3689; train_optim_loss: 131909.3689; val_kl_reg_loss: 2061.1535; val_edge_recon_loss: 38576.8004; val_gene_expr_recon_loss: 89365.4039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130003.3578; val_optim_loss: 130003.3578
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9837; val_auprc_score: 0.9982; val_best_acc_score: 0.9849; val_best_f1_score: 0.9919; train_kl_reg_loss: 2093.8133; train_edge_recon_loss: 39600.7193; train_gene_expr_recon_loss: 89467.0071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 131161.5398; train_optim_loss: 131161.5398; val_kl_reg_loss: 2057.6279; val_edge_recon_loss: 38930.6003; val_gene_expr_recon_loss: 88760.7046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129748.9327; val_optim_loss: 129748.9327
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9860; val_auprc_score: 0.9981; val_best_acc_score: 0.9848; val_best_f1_score: 0.9918; train_kl_reg_loss: 2121.8124; train_edge_recon_loss: 39881.1415; train_gene_expr_recon_loss: 88976.9511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130979.9050; train_optim_loss: 130979.9050; val_kl_reg_loss: 2152.7062; val_edge_recon_loss: 39951.0364; val_gene_expr_recon_loss: 88585.5336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130689.2765; val_optim_loss: 130689.2765
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9873; val_auprc_score: 0.9983; val_best_acc_score: 0.9858; val_best_f1_score: 0.9924; train_kl_reg_loss: 2132.0107; train_edge_recon_loss: 39893.7664; train_gene_expr_recon_loss: 88571.3676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130597.1448; train_optim_loss: 130597.1448; val_kl_reg_loss: 2195.5578; val_edge_recon_loss: 40089.7833; val_gene_expr_recon_loss: 88252.5191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130537.8602; val_optim_loss: 130537.8602
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9875; val_auprc_score: 0.9984; val_best_acc_score: 0.9870; val_best_f1_score: 0.9930; train_kl_reg_loss: 2139.5262; train_edge_recon_loss: 39712.9076; train_gene_expr_recon_loss: 88260.8506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130113.2843; train_optim_loss: 130113.2843; val_kl_reg_loss: 2170.7629; val_edge_recon_loss: 39792.5593; val_gene_expr_recon_loss: 88058.8832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 130022.2053; val_optim_loss: 130022.2053

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9897; val_auprc_score: 0.9985; val_best_acc_score: 0.9876; val_best_f1_score: 0.9933; train_kl_reg_loss: 2157.9597; train_edge_recon_loss: 39541.6258; train_gene_expr_recon_loss: 87369.0248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 129068.6103; train_optim_loss: 129068.6103; val_kl_reg_loss: 2118.3294; val_edge_recon_loss: 39420.6944; val_gene_expr_recon_loss: 87923.8473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129462.8713; val_optim_loss: 129462.8713
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9891; val_auprc_score: 0.9983; val_best_acc_score: 0.9880; val_best_f1_score: 0.9935; train_kl_reg_loss: 2142.0765; train_edge_recon_loss: 39209.2962; train_gene_expr_recon_loss: 87215.4983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128566.8711; train_optim_loss: 128566.8711; val_kl_reg_loss: 2146.0252; val_edge_recon_loss: 39131.0374; val_gene_expr_recon_loss: 87489.5994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128766.6623; val_optim_loss: 128766.6623
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9893; val_auprc_score: 0.9988; val_best_acc_score: 0.9878; val_best_f1_score: 0.9934; train_kl_reg_loss: 2139.8361; train_edge_recon_loss: 39501.6706; train_gene_expr_recon_loss: 87087.7435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128729.2502; train_optim_loss: 128729.2502; val_kl_reg_loss: 2128.4534; val_edge_recon_loss: 39117.9364; val_gene_expr_recon_loss: 87626.0651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128872.4551; val_optim_loss: 128872.4551
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9906; val_auprc_score: 0.9988; val_best_acc_score: 0.9884; val_best_f1_score: 0.9938; train_kl_reg_loss: 2148.3636; train_edge_recon_loss: 39506.8044; train_gene_expr_recon_loss: 87029.8822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 128685.0502; train_optim_loss: 128685.0502; val_kl_reg_loss: 2161.7293; val_edge_recon_loss: 39027.2463; val_gene_expr_recon_loss: 87698.1081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128887.0834; val_optim_loss: 128887.0834
