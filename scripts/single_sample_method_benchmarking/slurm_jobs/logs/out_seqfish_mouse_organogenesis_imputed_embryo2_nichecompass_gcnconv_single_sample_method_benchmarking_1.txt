Run timestamp: 16082023_191723_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1626, n_latent: 1526, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9642; val_auprc_score: 0.9641; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6608028.1203; train_edge_recon_loss: 3635687.4286; train_gene_expr_recon_loss: 477184118.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 487427838.8571; train_optim_loss: 487427838.8571; val_kl_reg_loss: 1407080.5000; val_edge_recon_loss: 4066261.3750; val_gene_expr_recon_loss: 92223104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 97696444.0000; val_optim_loss: 97696444.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9569; val_auprc_score: 0.9546; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 681863.8304; train_edge_recon_loss: 3912838.0893; train_gene_expr_recon_loss: 74914905.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79509607.4286; train_optim_loss: 79509607.4286; val_kl_reg_loss: 623288.0938; val_edge_recon_loss: 4066277.0000; val_gene_expr_recon_loss: 64774948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69464516.0000; val_optim_loss: 69464516.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9574; val_auprc_score: 0.9554; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 802191.7411; train_edge_recon_loss: 3989352.6607; train_gene_expr_recon_loss: 63140914.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67932458.2857; train_optim_loss: 67932458.2857; val_kl_reg_loss: 708950.4375; val_edge_recon_loss: 4066281.3750; val_gene_expr_recon_loss: 60214604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64989836.0000; val_optim_loss: 64989836.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9551; val_auprc_score: 0.9521; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 747022.2857; train_edge_recon_loss: 4043953.8929; train_gene_expr_recon_loss: 60190182.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64981158.8571; train_optim_loss: 64981158.8571; val_kl_reg_loss: 735559.7188; val_edge_recon_loss: 4066283.2500; val_gene_expr_recon_loss: 58347872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63149716.0000; val_optim_loss: 63149716.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9559; val_auprc_score: 0.9528; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 752779.4464; train_edge_recon_loss: 4053626.2143; train_gene_expr_recon_loss: 58251302.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63057708.8571; train_optim_loss: 63057708.8571; val_kl_reg_loss: 746869.0000; val_edge_recon_loss: 4066283.8750; val_gene_expr_recon_loss: 57813098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62626250.0000; val_optim_loss: 62626250.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9526; val_auprc_score: 0.9478; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 996955.3929; train_edge_recon_loss: 3987443.5714; train_gene_expr_recon_loss: 84483901.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 89468300.8571; train_optim_loss: 89468300.8571; val_kl_reg_loss: 846714.0000; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 63300520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68213524.0000; val_optim_loss: 68213524.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9424; val_auprc_score: 0.9302; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1040547.2366; train_edge_recon_loss: 4021296.6250; train_gene_expr_recon_loss: 99431766.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 104493610.2857; train_optim_loss: 104493610.2857; val_kl_reg_loss: 1107762.3750; val_edge_recon_loss: 4066294.1250; val_gene_expr_recon_loss: 66588900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71762956.0000; val_optim_loss: 71762956.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9336; val_auprc_score: 0.9156; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1220882.2679; train_edge_recon_loss: 4065851.5357; train_gene_expr_recon_loss: 64760700.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70047435.4286; train_optim_loss: 70047435.4286; val_kl_reg_loss: 1282961.6875; val_edge_recon_loss: 4066295.1250; val_gene_expr_recon_loss: 63763712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69112972.0000; val_optim_loss: 69112972.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9323; val_auprc_score: 0.9142; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1278395.4018; train_edge_recon_loss: 4065978.7857; train_gene_expr_recon_loss: 62952427.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68296801.7143; train_optim_loss: 68296801.7143; val_kl_reg_loss: 1253217.3125; val_edge_recon_loss: 4066294.2500; val_gene_expr_recon_loss: 62709214.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68028728.0000; val_optim_loss: 68028728.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9320; val_auprc_score: 0.9135; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1249963.0536; train_edge_recon_loss: 4066046.7679; train_gene_expr_recon_loss: 62429735.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67745744.5714; train_optim_loss: 67745744.5714; val_kl_reg_loss: 1245395.4375; val_edge_recon_loss: 4066294.1250; val_gene_expr_recon_loss: 62576700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67888392.0000; val_optim_loss: 67888392.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9317; val_auprc_score: 0.9137; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1240192.2589; train_edge_recon_loss: 4066040.9821; train_gene_expr_recon_loss: 62339247.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67645480.5714; train_optim_loss: 67645480.5714; val_kl_reg_loss: 1234811.9375; val_edge_recon_loss: 4066294.1250; val_gene_expr_recon_loss: 62499128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67800232.0000; val_optim_loss: 67800232.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9350; val_auprc_score: 0.9188; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1230223.6875; train_edge_recon_loss: 4065977.2500; train_gene_expr_recon_loss: 62289215.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67585417.1429; train_optim_loss: 67585417.1429; val_kl_reg_loss: 1223552.2500; val_edge_recon_loss: 4066294.0000; val_gene_expr_recon_loss: 62473072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67762916.0000; val_optim_loss: 67762916.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9320; val_auprc_score: 0.9146; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1220355.6161; train_edge_recon_loss: 4065961.4464; train_gene_expr_recon_loss: 62243114.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67529431.4286; train_optim_loss: 67529431.4286; val_kl_reg_loss: 1215575.8125; val_edge_recon_loss: 4066294.2500; val_gene_expr_recon_loss: 62442378.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67724248.0000; val_optim_loss: 67724248.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 36 sec.
Using best model state, which was in epoch 5.

--- MODEL EVALUATION ---
val AUROC score: 0.9544
val AUPRC score: 0.9496
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 13.0300
val source rna MSE score: 7.5219
Duration of model training in run 8: 0 hours, 1 minutes and 46 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1626, n_latent: 1526, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9723; val_auprc_score: 0.9691; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1815857118.1847; train_edge_recon_loss: 3675352.7500; train_gene_expr_recon_loss: 809102544.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2628634992.5714; train_optim_loss: 2628634992.5714; val_kl_reg_loss: 666951.4062; val_edge_recon_loss: 4066289.3750; val_gene_expr_recon_loss: 86914444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 91647684.0000; val_optim_loss: 91647684.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9674; val_auprc_score: 0.9573; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1981087.1964; train_edge_recon_loss: 3901831.6964; train_gene_expr_recon_loss: 185593537.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 191476457.7143; train_optim_loss: 191476457.7143; val_kl_reg_loss: 1384675.5000; val_edge_recon_loss: 4066302.1250; val_gene_expr_recon_loss: 75806528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 81257504.0000; val_optim_loss: 81257504.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9636; val_auprc_score: 0.9491; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1670850.0089; train_edge_recon_loss: 4064096.1429; train_gene_expr_recon_loss: 71995981.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77730928.0000; train_optim_loss: 77730928.0000; val_kl_reg_loss: 1910868.9375; val_edge_recon_loss: 4066303.5000; val_gene_expr_recon_loss: 68450028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74427204.0000; val_optim_loss: 74427204.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9616; val_auprc_score: 0.9458; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2005941.9911; train_edge_recon_loss: 4066028.7679; train_gene_expr_recon_loss: 66577435.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 72649405.1429; train_optim_loss: 72649405.1429; val_kl_reg_loss: 2054907.5000; val_edge_recon_loss: 4066304.1250; val_gene_expr_recon_loss: 65375534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71496744.0000; val_optim_loss: 71496744.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9604; val_auprc_score: 0.9435; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2061334.8929; train_edge_recon_loss: 4066172.6607; train_gene_expr_recon_loss: 64744776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70872284.0000; train_optim_loss: 70872284.0000; val_kl_reg_loss: 2040648.3750; val_edge_recon_loss: 4066304.1250; val_gene_expr_recon_loss: 64498552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70605504.0000; val_optim_loss: 70605504.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9615; val_auprc_score: 0.9459; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2003080.1429; train_edge_recon_loss: 4066148.0179; train_gene_expr_recon_loss: 64109299.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70178527.4286; train_optim_loss: 70178527.4286; val_kl_reg_loss: 1962252.7500; val_edge_recon_loss: 4066303.8750; val_gene_expr_recon_loss: 64035946.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70064504.0000; val_optim_loss: 70064504.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9625; val_auprc_score: 0.9477; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1922960.6429; train_edge_recon_loss: 4066124.7500; train_gene_expr_recon_loss: 63769254.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69758338.2857; train_optim_loss: 69758338.2857; val_kl_reg_loss: 1866302.5625; val_edge_recon_loss: 4066303.5000; val_gene_expr_recon_loss: 63732402.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69665012.0000; val_optim_loss: 69665012.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9639; val_auprc_score: 0.9503; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1835157.0714; train_edge_recon_loss: 4066076.6786; train_gene_expr_recon_loss: 63516618.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69417851.4286; train_optim_loss: 69417851.4286; val_kl_reg_loss: 1786931.2500; val_edge_recon_loss: 4066303.1250; val_gene_expr_recon_loss: 63586686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69439920.0000; val_optim_loss: 69439920.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9640; val_auprc_score: 0.9509; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1751471.1071; train_edge_recon_loss: 4066060.1071; train_gene_expr_recon_loss: 63302448.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69119980.0000; train_optim_loss: 69119980.0000; val_kl_reg_loss: 1704821.1875; val_edge_recon_loss: 4066302.8750; val_gene_expr_recon_loss: 63365508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69136632.0000; val_optim_loss: 69136632.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9654; val_auprc_score: 0.9537; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1669649.9107; train_edge_recon_loss: 4066021.0893; train_gene_expr_recon_loss: 63120897.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68856567.4286; train_optim_loss: 68856567.4286; val_kl_reg_loss: 1621782.3125; val_edge_recon_loss: 4066302.7500; val_gene_expr_recon_loss: 63214248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68902332.0000; val_optim_loss: 68902332.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9654; val_auprc_score: 0.9538; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1586619.2411; train_edge_recon_loss: 4065995.3214; train_gene_expr_recon_loss: 62956991.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68609605.1429; train_optim_loss: 68609605.1429; val_kl_reg_loss: 1540166.2500; val_edge_recon_loss: 4066302.3750; val_gene_expr_recon_loss: 63087152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68693620.0000; val_optim_loss: 68693620.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9644; val_auprc_score: 0.9528; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1509447.4464; train_edge_recon_loss: 4065917.2321; train_gene_expr_recon_loss: 62791066.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68366431.4286; train_optim_loss: 68366431.4286; val_kl_reg_loss: 1465803.1250; val_edge_recon_loss: 4066301.7500; val_gene_expr_recon_loss: 62781002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68313104.0000; val_optim_loss: 68313104.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9660; val_auprc_score: 0.9560; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8106740.6696; train_edge_recon_loss: 4024268.7143; train_gene_expr_recon_loss: 178723682.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 190854691.4286; train_optim_loss: 190854691.4286; val_kl_reg_loss: 329920446464.0000; val_edge_recon_loss: 4066301.3750; val_gene_expr_recon_loss: 63834016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 329988341760.0000; val_optim_loss: 329988341760.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9012; val_auprc_score: 0.8442; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 24030912458356.5352; train_edge_recon_loss: 3900760.1607; train_gene_expr_recon_loss: 1488356077.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 24032404523414.8555; train_optim_loss: 24032404523414.8555; val_kl_reg_loss: 24417007.0000; val_edge_recon_loss: 4066307.2500; val_gene_expr_recon_loss: 1454604288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1483087552.0000; val_optim_loss: 1483087552.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8617; val_auprc_score: 0.7907; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 165030477849.5357; train_edge_recon_loss: 4022507.2143; train_gene_expr_recon_loss: 1536103542.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 166570616603.4286; train_optim_loss: 166570616603.4286; val_kl_reg_loss: 10552505856.0000; val_edge_recon_loss: 4066307.5000; val_gene_expr_recon_loss: 1553429248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 12110001664.0000; val_optim_loss: 12110001664.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9048; val_auprc_score: 0.8525; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 650003709.6250; train_edge_recon_loss: 4047065.1964; train_gene_expr_recon_loss: 1569050953.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2223101723.4286; train_optim_loss: 2223101723.4286; val_kl_reg_loss: 3488068.8750; val_edge_recon_loss: 4066307.0000; val_gene_expr_recon_loss: 1551683392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1559237760.0000; val_optim_loss: 1559237760.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9087; val_auprc_score: 0.8586; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3379064.3393; train_edge_recon_loss: 4064342.1071; train_gene_expr_recon_loss: 1536905865.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1544349257.1429; train_optim_loss: 1544349257.1429; val_kl_reg_loss: 3282020.2500; val_edge_recon_loss: 4066307.0000; val_gene_expr_recon_loss: 1539827648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1547176000.0000; val_optim_loss: 1547176000.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9109; val_auprc_score: 0.8622; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3220923.6250; train_edge_recon_loss: 4065407.5536; train_gene_expr_recon_loss: 1530257014.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1537543341.7143; train_optim_loss: 1537543341.7143; val_kl_reg_loss: 3131797.5000; val_edge_recon_loss: 4066307.0000; val_gene_expr_recon_loss: 1534106816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1541304896.0000; val_optim_loss: 1541304896.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9171; val_auprc_score: 0.8725; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3069552.0536; train_edge_recon_loss: 4065518.1071; train_gene_expr_recon_loss: 1524263533.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1531398592.0000; train_optim_loss: 1531398592.0000; val_kl_reg_loss: 2987799.1250; val_edge_recon_loss: 4066307.0000; val_gene_expr_recon_loss: 1530614528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1537668672.0000; val_optim_loss: 1537668672.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9190; val_auprc_score: 0.8755; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2931281.5000; train_edge_recon_loss: 4065571.4464; train_gene_expr_recon_loss: 1519180644.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1526177499.4286; train_optim_loss: 1526177499.4286; val_kl_reg_loss: 2854403.5000; val_edge_recon_loss: 4066306.2500; val_gene_expr_recon_loss: 1522746752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1529667456.0000; val_optim_loss: 1529667456.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 26 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
val AUROC score: 0.9652
val AUPRC score: 0.9542
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 9.6971
val source rna MSE score: 3.5071
Duration of model training in run 7: 0 hours, 2 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1626, n_latent: 1526, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9703; val_auprc_score: 0.9696; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 134679902.1744; train_edge_recon_loss: 3621903.4318; train_gene_expr_recon_loss: 605838504.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 744140296.7273; train_optim_loss: 744140296.7273; val_kl_reg_loss: 647581.1250; val_edge_recon_loss: 4066278.2500; val_gene_expr_recon_loss: 99667136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 104380996.0000; val_optim_loss: 104380996.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9663; val_auprc_score: 0.9600; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3202533.8011; train_edge_recon_loss: 3878806.2273; train_gene_expr_recon_loss: 169479024.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 176560364.3636; train_optim_loss: 176560364.3636; val_kl_reg_loss: 1139107.8125; val_edge_recon_loss: 4066298.2500; val_gene_expr_recon_loss: 80866160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86071568.0000; val_optim_loss: 86071568.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9611; val_auprc_score: 0.9508; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1441000.5568; train_edge_recon_loss: 4054471.2955; train_gene_expr_recon_loss: 71969773.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 77465245.8182; train_optim_loss: 77465245.8182; val_kl_reg_loss: 1738467.6250; val_edge_recon_loss: 4066301.5000; val_gene_expr_recon_loss: 67402896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73207668.0000; val_optim_loss: 73207668.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9571; val_auprc_score: 0.9433; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1870441.3409; train_edge_recon_loss: 4065954.9773; train_gene_expr_recon_loss: 64857407.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70793804.3636; train_optim_loss: 70793804.3636; val_kl_reg_loss: 2021622.0000; val_edge_recon_loss: 4066302.5000; val_gene_expr_recon_loss: 63583288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69671212.0000; val_optim_loss: 69671212.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9554; val_auprc_score: 0.9409; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2035971.8409; train_edge_recon_loss: 4066163.8864; train_gene_expr_recon_loss: 62540400.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68642536.7273; train_optim_loss: 68642536.7273; val_kl_reg_loss: 2100109.8750; val_edge_recon_loss: 4066302.7500; val_gene_expr_recon_loss: 62116612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68283024.0000; val_optim_loss: 68283024.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9560; val_auprc_score: 0.9423; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2065830.0795; train_edge_recon_loss: 4066173.5455; train_gene_expr_recon_loss: 61368521.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67500525.0909; train_optim_loss: 67500525.0909; val_kl_reg_loss: 2064141.0000; val_edge_recon_loss: 4066302.3750; val_gene_expr_recon_loss: 61005374.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67135816.0000; val_optim_loss: 67135816.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9561; val_auprc_score: 0.9425; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2044548.8068; train_edge_recon_loss: 4066175.9773; train_gene_expr_recon_loss: 60789846.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66900570.9091; train_optim_loss: 66900570.9091; val_kl_reg_loss: 2042258.3750; val_edge_recon_loss: 4066302.5000; val_gene_expr_recon_loss: 61091372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67199932.0000; val_optim_loss: 67199932.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9562; val_auprc_score: 0.9424; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2005446.3977; train_edge_recon_loss: 4066135.7727; train_gene_expr_recon_loss: 60411134.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66482716.3636; train_optim_loss: 66482716.3636; val_kl_reg_loss: 2005032.4375; val_edge_recon_loss: 4066302.2500; val_gene_expr_recon_loss: 60246916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66318252.0000; val_optim_loss: 66318252.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9574; val_auprc_score: 0.9448; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1963280.9545; train_edge_recon_loss: 4066143.3864; train_gene_expr_recon_loss: 60181913.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66211337.8182; train_optim_loss: 66211337.8182; val_kl_reg_loss: 1968705.3125; val_edge_recon_loss: 4066302.2500; val_gene_expr_recon_loss: 60503836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66538842.0000; val_optim_loss: 66538842.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9578; val_auprc_score: 0.9456; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1914320.9318; train_edge_recon_loss: 4066123.0455; train_gene_expr_recon_loss: 59988599.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65969043.6364; train_optim_loss: 65969043.6364; val_kl_reg_loss: 1916620.8125; val_edge_recon_loss: 4066301.8750; val_gene_expr_recon_loss: 60402136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66385058.0000; val_optim_loss: 66385058.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9589; val_auprc_score: 0.9479; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1868223.4545; train_edge_recon_loss: 4066110.0000; train_gene_expr_recon_loss: 59828209.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65762542.1818; train_optim_loss: 65762542.1818; val_kl_reg_loss: 1867241.3750; val_edge_recon_loss: 4066301.8750; val_gene_expr_recon_loss: 60002448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65935992.0000; val_optim_loss: 65935992.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9587; val_auprc_score: 0.9476; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1819787.1364; train_edge_recon_loss: 4066080.7273; train_gene_expr_recon_loss: 59709080.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65594948.7273; train_optim_loss: 65594948.7273; val_kl_reg_loss: 1799997.1875; val_edge_recon_loss: 4066301.3750; val_gene_expr_recon_loss: 59823042.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65689342.0000; val_optim_loss: 65689342.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9589; val_auprc_score: 0.9490; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1773035.5795; train_edge_recon_loss: 4066085.7045; train_gene_expr_recon_loss: 59605504.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65444625.0909; train_optim_loss: 65444625.0909; val_kl_reg_loss: 1749217.7500; val_edge_recon_loss: 4066301.1250; val_gene_expr_recon_loss: 59621664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65437182.0000; val_optim_loss: 65437182.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9582; val_auprc_score: 0.9473; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1726781.2500; train_edge_recon_loss: 4066049.2727; train_gene_expr_recon_loss: 59499670.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65292500.3636; train_optim_loss: 65292500.3636; val_kl_reg_loss: 1715414.8125; val_edge_recon_loss: 4066301.1250; val_gene_expr_recon_loss: 59888944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65670660.0000; val_optim_loss: 65670660.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9525; val_auprc_score: 0.9365; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5790514480.8636; train_edge_recon_loss: 3872214.0455; train_gene_expr_recon_loss: 914524060.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6708910679.2727; train_optim_loss: 6708910679.2727; val_kl_reg_loss: 4303094.7500; val_edge_recon_loss: 4066303.5000; val_gene_expr_recon_loss: 709393408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 717762816.0000; val_optim_loss: 717762816.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8847; val_auprc_score: 0.8238; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5196346445.7273; train_edge_recon_loss: 3888428.6364; train_gene_expr_recon_loss: 1212895749.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6413130624.0000; train_optim_loss: 6413130624.0000; val_kl_reg_loss: 34965574.0000; val_edge_recon_loss: 4066306.6250; val_gene_expr_recon_loss: 902216544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 941248416.0000; val_optim_loss: 941248416.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8342; val_auprc_score: 0.7580; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1101713328828.5908; train_edge_recon_loss: 3924374.6591; train_gene_expr_recon_loss: 1212709527.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1102929975988.3635; train_optim_loss: 1102929975988.3635; val_kl_reg_loss: 8778559.2500; val_edge_recon_loss: 4066307.1250; val_gene_expr_recon_loss: 806311872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 819156736.0000; val_optim_loss: 819156736.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8321; val_auprc_score: 0.7547; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7674818.6818; train_edge_recon_loss: 4055156.8409; train_gene_expr_recon_loss: 639611485.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 651341457.4545; train_optim_loss: 651341457.4545; val_kl_reg_loss: 7664564.5000; val_edge_recon_loss: 4066307.2500; val_gene_expr_recon_loss: 528000736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 539731616.0000; val_optim_loss: 539731616.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8379; val_auprc_score: 0.7618; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7552506.4545; train_edge_recon_loss: 4066298.5909; train_gene_expr_recon_loss: 457767895.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 469386696.7273; train_optim_loss: 469386696.7273; val_kl_reg_loss: 7506038.7500; val_edge_recon_loss: 4066307.2500; val_gene_expr_recon_loss: 406957952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 418530304.0000; val_optim_loss: 418530304.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8432; val_auprc_score: 0.7684; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7276276.7273; train_edge_recon_loss: 4066301.2727; train_gene_expr_recon_loss: 355722426.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367065006.5455; train_optim_loss: 367065006.5455; val_kl_reg_loss: 7191842.0000; val_edge_recon_loss: 4066307.2500; val_gene_expr_recon_loss: 321645168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 332903312.0000; val_optim_loss: 332903312.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8469; val_auprc_score: 0.7731; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6900510.3636; train_edge_recon_loss: 4066298.5227; train_gene_expr_recon_loss: 280346270.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 291313080.7273; train_optim_loss: 291313080.7273; val_kl_reg_loss: 6744220.0000; val_edge_recon_loss: 4066307.0000; val_gene_expr_recon_loss: 254394384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 265204912.0000; val_optim_loss: 265204912.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 0 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
val AUROC score: 0.9585
val AUPRC score: 0.9483
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 8.7092
val source rna MSE score: 3.9460
Duration of model training in run 6: 0 hours, 2 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1626, n_latent: 1526, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1526, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9671; val_auprc_score: 0.9692; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 24424651.1090; train_edge_recon_loss: 3621314.6136; train_gene_expr_recon_loss: 431138658.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 459184615.2727; train_optim_loss: 459184615.2727; val_kl_reg_loss: 1095136.3750; val_edge_recon_loss: 4066250.6250; val_gene_expr_recon_loss: 83459840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88621224.0000; val_optim_loss: 88621224.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9611; val_auprc_score: 0.9589; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1009858.4716; train_edge_recon_loss: 3901466.3636; train_gene_expr_recon_loss: 82250962.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 87162286.5455; train_optim_loss: 87162286.5455; val_kl_reg_loss: 642780.5625; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 65805098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70514160.0000; val_optim_loss: 70514160.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9600; val_auprc_score: 0.9569; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 727840.1591; train_edge_recon_loss: 4008882.6591; train_gene_expr_recon_loss: 64608968.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69345690.1818; train_optim_loss: 69345690.1818; val_kl_reg_loss: 2724512.1250; val_edge_recon_loss: 4066287.3750; val_gene_expr_recon_loss: 59705290.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66496088.0000; val_optim_loss: 66496088.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9553; val_auprc_score: 0.9513; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1723087.9034; train_edge_recon_loss: 3977749.4545; train_gene_expr_recon_loss: 68324243.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74025080.0000; train_optim_loss: 74025080.0000; val_kl_reg_loss: 951251.8125; val_edge_recon_loss: 4066290.6250; val_gene_expr_recon_loss: 59339390.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64356932.0000; val_optim_loss: 64356932.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9520; val_auprc_score: 0.9461; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1077193.0909; train_edge_recon_loss: 4044586.3636; train_gene_expr_recon_loss: 59117936.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64239716.3636; train_optim_loss: 64239716.3636; val_kl_reg_loss: 1160610.7500; val_edge_recon_loss: 4066293.3750; val_gene_expr_recon_loss: 58881468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64108372.0000; val_optim_loss: 64108372.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9516; val_auprc_score: 0.9463; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1201454.8409; train_edge_recon_loss: 4066109.9545; train_gene_expr_recon_loss: 58155649.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63423214.5455; train_optim_loss: 63423214.5455; val_kl_reg_loss: 1254321.6875; val_edge_recon_loss: 4066294.1250; val_gene_expr_recon_loss: 57915186.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63235802.0000; val_optim_loss: 63235802.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9504; val_auprc_score: 0.9438; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1249186.7955; train_edge_recon_loss: 4066132.8182; train_gene_expr_recon_loss: 57595862.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62911182.9091; train_optim_loss: 62911182.9091; val_kl_reg_loss: 1258445.5625; val_edge_recon_loss: 4066293.0000; val_gene_expr_recon_loss: 57915758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63240498.0000; val_optim_loss: 63240498.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9503; val_auprc_score: 0.9440; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1224604.0682; train_edge_recon_loss: 4066133.4545; train_gene_expr_recon_loss: 57323865.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62614602.5455; train_optim_loss: 62614602.5455; val_kl_reg_loss: 1218831.6875; val_edge_recon_loss: 4066292.3750; val_gene_expr_recon_loss: 57324796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62609920.0000; val_optim_loss: 62609920.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9506; val_auprc_score: 0.9449; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1179653.2955; train_edge_recon_loss: 4066023.5682; train_gene_expr_recon_loss: 57044106.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62289784.0000; train_optim_loss: 62289784.0000; val_kl_reg_loss: 1162600.8750; val_edge_recon_loss: 4066292.3750; val_gene_expr_recon_loss: 57409244.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62638138.0000; val_optim_loss: 62638138.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9500; val_auprc_score: 0.9451; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1129728.0341; train_edge_recon_loss: 4065944.7500; train_gene_expr_recon_loss: 56882108.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62077781.4545; train_optim_loss: 62077781.4545; val_kl_reg_loss: 1112598.8125; val_edge_recon_loss: 4066291.0000; val_gene_expr_recon_loss: 56869026.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62047916.0000; val_optim_loss: 62047916.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9505; val_auprc_score: 0.9474; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1079381.0455; train_edge_recon_loss: 4065207.0455; train_gene_expr_recon_loss: 56731865.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61876453.4545; train_optim_loss: 61876453.4545; val_kl_reg_loss: 1050223.3125; val_edge_recon_loss: 4066289.5000; val_gene_expr_recon_loss: 56799198.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61915710.0000; val_optim_loss: 61915710.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9513; val_auprc_score: 0.9490; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1034087.1761; train_edge_recon_loss: 4063877.3636; train_gene_expr_recon_loss: 56571170.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61669135.2727; train_optim_loss: 61669135.2727; val_kl_reg_loss: 1022303.8750; val_edge_recon_loss: 4066286.7500; val_gene_expr_recon_loss: 56893928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61982520.0000; val_optim_loss: 61982520.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9508; val_auprc_score: 0.9493; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1007067.3750; train_edge_recon_loss: 4050379.7500; train_gene_expr_recon_loss: 56454787.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61512234.9091; train_optim_loss: 61512234.9091; val_kl_reg_loss: 972209.4688; val_edge_recon_loss: 4066283.2500; val_gene_expr_recon_loss: 56709594.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61748086.0000; val_optim_loss: 61748086.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9480; val_auprc_score: 0.9456; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 951104.7500; train_edge_recon_loss: 4059868.0000; train_gene_expr_recon_loss: 59701939.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64712912.3636; train_optim_loss: 64712912.3636; val_kl_reg_loss: 946671.3750; val_edge_recon_loss: 4066279.5000; val_gene_expr_recon_loss: 57647546.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62660498.0000; val_optim_loss: 62660498.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9458; val_auprc_score: 0.9450; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 940194.2273; train_edge_recon_loss: 4064839.1136; train_gene_expr_recon_loss: 56828943.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61833976.3636; train_optim_loss: 61833976.3636; val_kl_reg_loss: 959978.7188; val_edge_recon_loss: 4066277.6250; val_gene_expr_recon_loss: 56807214.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61833470.0000; val_optim_loss: 61833470.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9426; val_auprc_score: 0.9410; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1105950.0852; train_edge_recon_loss: 4027187.2273; train_gene_expr_recon_loss: 63067348.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68200485.8182; train_optim_loss: 68200485.8182; val_kl_reg_loss: 1056600.5000; val_edge_recon_loss: 4066275.6250; val_gene_expr_recon_loss: 58416644.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63539520.0000; val_optim_loss: 63539520.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9441; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 952527.4886; train_edge_recon_loss: 4053357.9091; train_gene_expr_recon_loss: 58044282.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63050169.0909; train_optim_loss: 63050169.0909; val_kl_reg_loss: 56348010.0000; val_edge_recon_loss: 4066276.5000; val_gene_expr_recon_loss: 57080764.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 117495048.0000; val_optim_loss: 117495048.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9449; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5034176.1307; train_edge_recon_loss: 4014486.3636; train_gene_expr_recon_loss: 101783549.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 110832210.9091; train_optim_loss: 110832210.9091; val_kl_reg_loss: 930945.0312; val_edge_recon_loss: 4066275.1250; val_gene_expr_recon_loss: 56378728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61375948.0000; val_optim_loss: 61375948.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9433; val_auprc_score: 0.9414; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 935549.6591; train_edge_recon_loss: 4057435.5000; train_gene_expr_recon_loss: 56296159.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61289144.3636; train_optim_loss: 61289144.3636; val_kl_reg_loss: 940623.9375; val_edge_recon_loss: 4066275.1250; val_gene_expr_recon_loss: 56392162.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61399060.0000; val_optim_loss: 61399060.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9428; val_auprc_score: 0.9412; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 919018.6477; train_edge_recon_loss: 4062537.3636; train_gene_expr_recon_loss: 56113216.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61094772.3636; train_optim_loss: 61094772.3636; val_kl_reg_loss: 913917.3750; val_edge_recon_loss: 4066273.8750; val_gene_expr_recon_loss: 56353624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61333816.0000; val_optim_loss: 61333816.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9445; val_auprc_score: 0.9438; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 915048.3409; train_edge_recon_loss: 4055391.4318; train_gene_expr_recon_loss: 56059580.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61030020.3636; train_optim_loss: 61030020.3636; val_kl_reg_loss: 902899.9375; val_edge_recon_loss: 4066273.1250; val_gene_expr_recon_loss: 56199016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61168190.0000; val_optim_loss: 61168190.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9431; val_auprc_score: 0.9414; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 906302.4716; train_edge_recon_loss: 4054393.2273; train_gene_expr_recon_loss: 56022215.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60982911.2727; train_optim_loss: 60982911.2727; val_kl_reg_loss: 901244.2500; val_edge_recon_loss: 4066273.0000; val_gene_expr_recon_loss: 56332244.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61299762.0000; val_optim_loss: 61299762.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9416; val_auprc_score: 0.9399; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 890407.0568; train_edge_recon_loss: 4061440.0000; train_gene_expr_recon_loss: 55994420.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60946267.2727; train_optim_loss: 60946267.2727; val_kl_reg_loss: 897495.4062; val_edge_recon_loss: 4066272.2500; val_gene_expr_recon_loss: 56098044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61061812.0000; val_optim_loss: 61061812.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9426; val_auprc_score: 0.9414; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 892006.4148; train_edge_recon_loss: 4050023.1818; train_gene_expr_recon_loss: 55994830.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60936860.3636; train_optim_loss: 60936860.3636; val_kl_reg_loss: 889626.7188; val_edge_recon_loss: 4066270.7500; val_gene_expr_recon_loss: 56295730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61251626.0000; val_optim_loss: 61251626.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9411; val_auprc_score: 0.9391; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 883155.9602; train_edge_recon_loss: 4049986.5000; train_gene_expr_recon_loss: 55981472.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60914614.1818; train_optim_loss: 60914614.1818; val_kl_reg_loss: 879365.8750; val_edge_recon_loss: 4066270.1250; val_gene_expr_recon_loss: 56334730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61280368.0000; val_optim_loss: 61280368.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9431; val_auprc_score: 0.9419; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 872558.1591; train_edge_recon_loss: 4051498.7273; train_gene_expr_recon_loss: 55959486.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60883544.0000; train_optim_loss: 60883544.0000; val_kl_reg_loss: 870919.0312; val_edge_recon_loss: 4066269.6250; val_gene_expr_recon_loss: 56016368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60953556.0000; val_optim_loss: 60953556.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9416; val_auprc_score: 0.9396; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 862757.4773; train_edge_recon_loss: 4052958.8182; train_gene_expr_recon_loss: 55954581.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60870297.8182; train_optim_loss: 60870297.8182; val_kl_reg_loss: 865286.3750; val_edge_recon_loss: 4066268.5000; val_gene_expr_recon_loss: 56161120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61092674.0000; val_optim_loss: 61092674.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9431; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 849213.5341; train_edge_recon_loss: 4057978.8409; train_gene_expr_recon_loss: 55917495.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60824687.6364; train_optim_loss: 60824687.6364; val_kl_reg_loss: 862759.3750; val_edge_recon_loss: 4066269.2500; val_gene_expr_recon_loss: 56233526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61162554.0000; val_optim_loss: 61162554.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9417; val_auprc_score: 0.9404; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 857342.5909; train_edge_recon_loss: 4038742.0909; train_gene_expr_recon_loss: 55920792.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60816876.7273; train_optim_loss: 60816876.7273; val_kl_reg_loss: 841017.3750; val_edge_recon_loss: 4066268.0000; val_gene_expr_recon_loss: 56148784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61056070.0000; val_optim_loss: 61056070.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9432; val_auprc_score: 0.9423; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 844075.4432; train_edge_recon_loss: 4043917.9091; train_gene_expr_recon_loss: 55898764.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60786758.1818; train_optim_loss: 60786758.1818; val_kl_reg_loss: 835866.4688; val_edge_recon_loss: 4066264.7500; val_gene_expr_recon_loss: 56060238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60962370.0000; val_optim_loss: 60962370.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9420; val_auprc_score: 0.9420; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 830726.3693; train_edge_recon_loss: 4052603.3864; train_gene_expr_recon_loss: 55891726.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60775056.7273; train_optim_loss: 60775056.7273; val_kl_reg_loss: 834199.2500; val_edge_recon_loss: 4066268.6250; val_gene_expr_recon_loss: 56052806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60953274.0000; val_optim_loss: 60953274.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9443; val_auprc_score: 0.9450; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 843895.4432; train_edge_recon_loss: 4036922.9773; train_gene_expr_recon_loss: 55896135.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60776953.4545; train_optim_loss: 60776953.4545; val_kl_reg_loss: 877656.0000; val_edge_recon_loss: 4066266.7500; val_gene_expr_recon_loss: 56311736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61255660.0000; val_optim_loss: 61255660.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9429; val_auprc_score: 0.9427; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 851039.0227; train_edge_recon_loss: 4028638.4318; train_gene_expr_recon_loss: 55890837.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60770515.2727; train_optim_loss: 60770515.2727; val_kl_reg_loss: 856398.8438; val_edge_recon_loss: 4066266.7500; val_gene_expr_recon_loss: 56175388.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61098054.0000; val_optim_loss: 61098054.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9415; val_auprc_score: 0.9404; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 845958.0795; train_edge_recon_loss: 4032167.6136; train_gene_expr_recon_loss: 55899613.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60777739.2727; train_optim_loss: 60777739.2727; val_kl_reg_loss: 855488.3750; val_edge_recon_loss: 4066267.1250; val_gene_expr_recon_loss: 56076760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60998514.0000; val_optim_loss: 60998514.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9423; val_auprc_score: 0.9416; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847176.1761; train_edge_recon_loss: 4030468.7045; train_gene_expr_recon_loss: 55892939.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60770583.6364; train_optim_loss: 60770583.6364; val_kl_reg_loss: 857927.0625; val_edge_recon_loss: 4066265.1250; val_gene_expr_recon_loss: 56085542.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61009734.0000; val_optim_loss: 61009734.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9420; val_auprc_score: 0.9413; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847136.9261; train_edge_recon_loss: 4028310.4545; train_gene_expr_recon_loss: 55873514.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60748962.5455; train_optim_loss: 60748962.5455; val_kl_reg_loss: 860464.9688; val_edge_recon_loss: 4066267.8750; val_gene_expr_recon_loss: 56267280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61194014.0000; val_optim_loss: 61194014.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9426; val_auprc_score: 0.9421; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847598.4375; train_edge_recon_loss: 4028464.6818; train_gene_expr_recon_loss: 55879525.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60755588.3636; train_optim_loss: 60755588.3636; val_kl_reg_loss: 856651.0000; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 56120390.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61043308.0000; val_optim_loss: 61043308.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9424; val_auprc_score: 0.9417; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847654.1193; train_edge_recon_loss: 4028326.0455; train_gene_expr_recon_loss: 55884094.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60760074.5455; train_optim_loss: 60760074.5455; val_kl_reg_loss: 861456.6250; val_edge_recon_loss: 4066265.7500; val_gene_expr_recon_loss: 56102188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61029910.0000; val_optim_loss: 61029910.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9427; val_auprc_score: 0.9418; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 848562.1080; train_edge_recon_loss: 4028567.4545; train_gene_expr_recon_loss: 55923721.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60800851.6364; train_optim_loss: 60800851.6364; val_kl_reg_loss: 858818.8438; val_edge_recon_loss: 4066266.0000; val_gene_expr_recon_loss: 56010684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60935770.0000; val_optim_loss: 60935770.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9407; val_auprc_score: 0.9394; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847415.3977; train_edge_recon_loss: 4029025.5227; train_gene_expr_recon_loss: 55890561.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60767002.1818; train_optim_loss: 60767002.1818; val_kl_reg_loss: 852478.1875; val_edge_recon_loss: 4066268.1250; val_gene_expr_recon_loss: 56064568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60983316.0000; val_optim_loss: 60983316.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9427; val_auprc_score: 0.9422; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846485.9659; train_edge_recon_loss: 4029538.2955; train_gene_expr_recon_loss: 55876227.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60752252.3636; train_optim_loss: 60752252.3636; val_kl_reg_loss: 847370.3438; val_edge_recon_loss: 4066265.8750; val_gene_expr_recon_loss: 56148692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61062328.0000; val_optim_loss: 61062328.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9415; val_auprc_score: 0.9413; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 845929.4091; train_edge_recon_loss: 4029427.2500; train_gene_expr_recon_loss: 55877492.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60752849.4545; train_optim_loss: 60752849.4545; val_kl_reg_loss: 858256.2500; val_edge_recon_loss: 4066266.2500; val_gene_expr_recon_loss: 56465384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61389906.0000; val_optim_loss: 61389906.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9434; val_auprc_score: 0.9428; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 845992.5739; train_edge_recon_loss: 4029292.5909; train_gene_expr_recon_loss: 55884490.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60759776.7273; train_optim_loss: 60759776.7273; val_kl_reg_loss: 863575.0938; val_edge_recon_loss: 4066263.8750; val_gene_expr_recon_loss: 56109900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61039738.0000; val_optim_loss: 61039738.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9415; val_auprc_score: 0.9404; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847096.0227; train_edge_recon_loss: 4028786.9091; train_gene_expr_recon_loss: 55892307.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60768189.8182; train_optim_loss: 60768189.8182; val_kl_reg_loss: 848315.1875; val_edge_recon_loss: 4066268.7500; val_gene_expr_recon_loss: 56127218.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61041802.0000; val_optim_loss: 61041802.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9406; val_auprc_score: 0.9384; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846478.7500; train_edge_recon_loss: 4029206.2955; train_gene_expr_recon_loss: 55882436.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60758120.7273; train_optim_loss: 60758120.7273; val_kl_reg_loss: 850600.9688; val_edge_recon_loss: 4066264.6250; val_gene_expr_recon_loss: 55771744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60688610.0000; val_optim_loss: 60688610.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9419; val_auprc_score: 0.9409; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846727.1875; train_edge_recon_loss: 4029568.5000; train_gene_expr_recon_loss: 55886730.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60763025.8182; train_optim_loss: 60763025.8182; val_kl_reg_loss: 855823.9062; val_edge_recon_loss: 4066266.2500; val_gene_expr_recon_loss: 56198004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61120094.0000; val_optim_loss: 61120094.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9423; val_auprc_score: 0.9423; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847182.0398; train_edge_recon_loss: 4029147.2273; train_gene_expr_recon_loss: 55903864.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60780193.8182; train_optim_loss: 60780193.8182; val_kl_reg_loss: 857601.7500; val_edge_recon_loss: 4066266.7500; val_gene_expr_recon_loss: 56217916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61141786.0000; val_optim_loss: 61141786.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9440; val_auprc_score: 0.9440; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846248.7841; train_edge_recon_loss: 4028731.0682; train_gene_expr_recon_loss: 55891389.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60766369.0909; train_optim_loss: 60766369.0909; val_kl_reg_loss: 859518.6250; val_edge_recon_loss: 4066267.7500; val_gene_expr_recon_loss: 56107172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61032958.0000; val_optim_loss: 61032958.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9429; val_auprc_score: 0.9429; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846772.0682; train_edge_recon_loss: 4028950.5909; train_gene_expr_recon_loss: 55873047.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60748770.1818; train_optim_loss: 60748770.1818; val_kl_reg_loss: 858138.6250; val_edge_recon_loss: 4066267.7500; val_gene_expr_recon_loss: 56301490.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61225896.0000; val_optim_loss: 61225896.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9407; val_auprc_score: 0.9396; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847231.7955; train_edge_recon_loss: 4028967.4091; train_gene_expr_recon_loss: 55899263.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60775462.9091; train_optim_loss: 60775462.9091; val_kl_reg_loss: 869525.1250; val_edge_recon_loss: 4066266.6250; val_gene_expr_recon_loss: 56201934.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61137726.0000; val_optim_loss: 61137726.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9431; val_auprc_score: 0.9428; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846846.4205; train_edge_recon_loss: 4029075.6818; train_gene_expr_recon_loss: 55893597.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60769519.6364; train_optim_loss: 60769519.6364; val_kl_reg_loss: 849938.1562; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 56216692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61132896.0000; val_optim_loss: 61132896.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9404; val_auprc_score: 0.9395; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 846698.7670; train_edge_recon_loss: 4029235.3182; train_gene_expr_recon_loss: 55893760.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60769695.2727; train_optim_loss: 60769695.2727; val_kl_reg_loss: 865156.4062; val_edge_recon_loss: 4066267.7500; val_gene_expr_recon_loss: 56169516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61100940.0000; val_optim_loss: 61100940.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9427; val_auprc_score: 0.9423; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 847144.7443; train_edge_recon_loss: 4029264.1591; train_gene_expr_recon_loss: 55903950.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60780360.0000; train_optim_loss: 60780360.0000; val_kl_reg_loss: 856867.3438; val_edge_recon_loss: 4066265.8750; val_gene_expr_recon_loss: 56158706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61081838.0000; val_optim_loss: 61081838.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 41 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9428
val AUPRC score: 0.9417
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 7.8596
val source rna MSE score: 4.2424
Duration of model training in run 5: 0 hours, 5 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1629, n_latent: 1529, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1529, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1529, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9564; val_auprc_score: 0.9621; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 30558752.2530; train_edge_recon_loss: 3575585.9375; train_gene_expr_recon_loss: 464159496.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 498293835.0000; train_optim_loss: 498293835.0000; val_kl_reg_loss: 203253.7812; val_edge_recon_loss: 4066149.5000; val_gene_expr_recon_loss: 84466288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88735688.0000; val_optim_loss: 88735688.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9487; val_auprc_score: 0.9517; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 606452.9785; train_edge_recon_loss: 3766226.5625; train_gene_expr_recon_loss: 106081830.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 110454510.0000; train_optim_loss: 110454510.0000; val_kl_reg_loss: 431118.1250; val_edge_recon_loss: 4066238.0000; val_gene_expr_recon_loss: 75194200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 79691552.0000; val_optim_loss: 79691552.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9490; val_auprc_score: 0.9486; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 584555.4570; train_edge_recon_loss: 3921399.3438; train_gene_expr_recon_loss: 70607619.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 75113573.0000; train_optim_loss: 75113573.0000; val_kl_reg_loss: 1145899.6250; val_edge_recon_loss: 4066263.7500; val_gene_expr_recon_loss: 65165008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70377168.0000; val_optim_loss: 70377168.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9452; val_auprc_score: 0.9425; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 878553.0625; train_edge_recon_loss: 3956338.6250; train_gene_expr_recon_loss: 77694488.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 82529379.5000; train_optim_loss: 82529379.5000; val_kl_reg_loss: 696791.6250; val_edge_recon_loss: 4066268.7500; val_gene_expr_recon_loss: 61158872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65921932.0000; val_optim_loss: 65921932.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9440; val_auprc_score: 0.9415; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 831629.1641; train_edge_recon_loss: 4032596.6250; train_gene_expr_recon_loss: 62441466.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67305691.0000; train_optim_loss: 67305691.0000; val_kl_reg_loss: 1082368.2500; val_edge_recon_loss: 4066273.7500; val_gene_expr_recon_loss: 59119264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64267904.0000; val_optim_loss: 64267904.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9429; val_auprc_score: 0.9397; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 888854.3047; train_edge_recon_loss: 4015089.3125; train_gene_expr_recon_loss: 73831874.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 78735817.0000; train_optim_loss: 78735817.0000; val_kl_reg_loss: 808532.7500; val_edge_recon_loss: 4066273.7500; val_gene_expr_recon_loss: 58806640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63681448.0000; val_optim_loss: 63681448.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9411; val_auprc_score: 0.9370; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 854339.2656; train_edge_recon_loss: 4042928.5938; train_gene_expr_recon_loss: 58469828.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63367096.0000; train_optim_loss: 63367096.0000; val_kl_reg_loss: 1087854.3750; val_edge_recon_loss: 4066274.7500; val_gene_expr_recon_loss: 57961160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63115288.0000; val_optim_loss: 63115288.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9381; val_auprc_score: 0.9344; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 923150.1562; train_edge_recon_loss: 4024380.8750; train_gene_expr_recon_loss: 60461806.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65409337.5000; train_optim_loss: 65409337.5000; val_kl_reg_loss: 884782.6875; val_edge_recon_loss: 4066279.2500; val_gene_expr_recon_loss: 57557904.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62508968.0000; val_optim_loss: 62508968.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9384; val_auprc_score: 0.9350; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1266994.5469; train_edge_recon_loss: 4020854.2812; train_gene_expr_recon_loss: 57361075.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62648924.5000; train_optim_loss: 62648924.5000; val_kl_reg_loss: 1058916.7500; val_edge_recon_loss: 4066279.0000; val_gene_expr_recon_loss: 57205716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62330912.0000; val_optim_loss: 62330912.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9398; val_auprc_score: 0.9369; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 883562.3750; train_edge_recon_loss: 4043049.4688; train_gene_expr_recon_loss: 57254241.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62180853.0000; train_optim_loss: 62180853.0000; val_kl_reg_loss: 826492.0000; val_edge_recon_loss: 4066277.5000; val_gene_expr_recon_loss: 56980408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61873176.0000; val_optim_loss: 61873176.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9395; val_auprc_score: 0.9364; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 841726.8047; train_edge_recon_loss: 4065133.2812; train_gene_expr_recon_loss: 56934181.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61841040.5000; train_optim_loss: 61841040.5000; val_kl_reg_loss: 807251.7500; val_edge_recon_loss: 4066276.5000; val_gene_expr_recon_loss: 56849096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61722624.0000; val_optim_loss: 61722624.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9395; val_auprc_score: 0.9374; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 826114.4766; train_edge_recon_loss: 4057686.7188; train_gene_expr_recon_loss: 56832596.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61716397.0000; train_optim_loss: 61716397.0000; val_kl_reg_loss: 786592.7500; val_edge_recon_loss: 4066274.5000; val_gene_expr_recon_loss: 56731008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61583876.0000; val_optim_loss: 61583876.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9389; val_auprc_score: 0.9368; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 887452.5000; train_edge_recon_loss: 4033200.4375; train_gene_expr_recon_loss: 56730734.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61651387.5000; train_optim_loss: 61651387.5000; val_kl_reg_loss: 763298.1250; val_edge_recon_loss: 4066272.5000; val_gene_expr_recon_loss: 56633248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61462820.0000; val_optim_loss: 61462820.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9346; val_auprc_score: 0.9307; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 796204.6016; train_edge_recon_loss: 4050111.0938; train_gene_expr_recon_loss: 56647608.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61493924.5000; train_optim_loss: 61493924.5000; val_kl_reg_loss: 1271335.5000; val_edge_recon_loss: 4066271.7500; val_gene_expr_recon_loss: 56562864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61900472.0000; val_optim_loss: 61900472.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9385; val_auprc_score: 0.9364; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1064079.7500; train_edge_recon_loss: 4008029.0312; train_gene_expr_recon_loss: 60394301.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65466410.0000; train_optim_loss: 65466410.0000; val_kl_reg_loss: 734637.3750; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 56670352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61471256.0000; val_optim_loss: 61471256.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9376; val_auprc_score: 0.9334; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18731998.8281; train_edge_recon_loss: 3843706.8750; train_gene_expr_recon_loss: 493753808.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 516329524.0000; train_optim_loss: 516329524.0000; val_kl_reg_loss: 992406.5625; val_edge_recon_loss: 4066279.0000; val_gene_expr_recon_loss: 114708816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 119767504.0000; val_optim_loss: 119767504.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9328; val_auprc_score: 0.9215; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1122512.7500; train_edge_recon_loss: 4039853.6250; train_gene_expr_recon_loss: 100072266.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 105234633.0000; train_optim_loss: 105234633.0000; val_kl_reg_loss: 1206695.5000; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 77060080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 82333064.0000; val_optim_loss: 82333064.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9327; val_auprc_score: 0.9213; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1238764.0000; train_edge_recon_loss: 4065950.1250; train_gene_expr_recon_loss: 74419814.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79724529.0000; train_optim_loss: 79724529.0000; val_kl_reg_loss: 1204886.5000; val_edge_recon_loss: 4066288.0000; val_gene_expr_recon_loss: 70317576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75588752.0000; val_optim_loss: 75588752.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9350; val_auprc_score: 0.9255; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1226352.6094; train_edge_recon_loss: 4065984.5938; train_gene_expr_recon_loss: 68792280.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74084617.0000; train_optim_loss: 74084617.0000; val_kl_reg_loss: 1185882.1250; val_edge_recon_loss: 4066288.0000; val_gene_expr_recon_loss: 67320104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72572272.0000; val_optim_loss: 72572272.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9315; val_auprc_score: 0.9212; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1207614.7969; train_edge_recon_loss: 4065999.4062; train_gene_expr_recon_loss: 66373840.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71647455.0000; train_optim_loss: 71647455.0000; val_kl_reg_loss: 1169556.5000; val_edge_recon_loss: 4066288.0000; val_gene_expr_recon_loss: 65333592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70569440.0000; val_optim_loss: 70569440.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9351; val_auprc_score: 0.9261; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1189650.7188; train_edge_recon_loss: 4066023.2188; train_gene_expr_recon_loss: 64744014.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69999688.0000; train_optim_loss: 69999688.0000; val_kl_reg_loss: 1150837.0000; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 64092640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69309760.0000; val_optim_loss: 69309760.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 25 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
val AUROC score: 0.9393
val AUPRC score: 0.9376
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 7.1897
val source rna MSE score: 4.6559
Duration of model training in run 4: 0 hours, 1 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1629, n_latent: 1529, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1529, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1529, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9685; val_auprc_score: 0.9714; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5755588.5821; train_edge_recon_loss: 3608210.8125; train_gene_expr_recon_loss: 497220733.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 506584521.0000; train_optim_loss: 506584521.0000; val_kl_reg_loss: 272277.1250; val_edge_recon_loss: 4066238.5000; val_gene_expr_recon_loss: 93103104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 97441616.0000; val_optim_loss: 97441616.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9631; val_auprc_score: 0.9658; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 524520.9844; train_edge_recon_loss: 3815859.2188; train_gene_expr_recon_loss: 107884513.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 112224892.0000; train_optim_loss: 112224892.0000; val_kl_reg_loss: 419176.6250; val_edge_recon_loss: 4066281.2500; val_gene_expr_recon_loss: 80059160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 84544616.0000; val_optim_loss: 84544616.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9574; val_auprc_score: 0.9567; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 878649.0938; train_edge_recon_loss: 3925634.0625; train_gene_expr_recon_loss: 89803542.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 94607826.0000; train_optim_loss: 94607826.0000; val_kl_reg_loss: 607882.3125; val_edge_recon_loss: 4066289.2500; val_gene_expr_recon_loss: 68419824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73093992.0000; val_optim_loss: 73093992.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9520; val_auprc_score: 0.9481; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1040371.2031; train_edge_recon_loss: 3962697.0312; train_gene_expr_recon_loss: 74724513.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79727582.0000; train_optim_loss: 79727582.0000; val_kl_reg_loss: 727419.5000; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 62257264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67050976.0000; val_optim_loss: 67050976.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9488; val_auprc_score: 0.9450; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 957977.2734; train_edge_recon_loss: 4007893.8750; train_gene_expr_recon_loss: 61442313.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66408184.0000; train_optim_loss: 66408184.0000; val_kl_reg_loss: 806565.5000; val_edge_recon_loss: 4066293.0000; val_gene_expr_recon_loss: 60665668.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65538528.0000; val_optim_loss: 65538528.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9451; val_auprc_score: 0.9402; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 968007.2812; train_edge_recon_loss: 4016104.0625; train_gene_expr_recon_loss: 68439543.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 73423655.0000; train_optim_loss: 73423655.0000; val_kl_reg_loss: 858361.0625; val_edge_recon_loss: 4066293.7500; val_gene_expr_recon_loss: 59439564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 64364220.0000; val_optim_loss: 64364220.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9470; val_auprc_score: 0.9428; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 901004.9609; train_edge_recon_loss: 4055442.8750; train_gene_expr_recon_loss: 59241852.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64198300.0000; train_optim_loss: 64198300.0000; val_kl_reg_loss: 874710.0625; val_edge_recon_loss: 4066293.0000; val_gene_expr_recon_loss: 58598232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63539236.0000; val_optim_loss: 63539236.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9463; val_auprc_score: 0.9421; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 904029.6094; train_edge_recon_loss: 4054276.1875; train_gene_expr_recon_loss: 58402796.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 63361101.5000; train_optim_loss: 63361101.5000; val_kl_reg_loss: 867028.6250; val_edge_recon_loss: 4066293.0000; val_gene_expr_recon_loss: 58062868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62996188.0000; val_optim_loss: 62996188.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9449; val_auprc_score: 0.9407; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 913688.9922; train_edge_recon_loss: 4041851.6562; train_gene_expr_recon_loss: 60314553.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 65270093.5000; train_optim_loss: 65270093.5000; val_kl_reg_loss: 859193.5000; val_edge_recon_loss: 4066292.7500; val_gene_expr_recon_loss: 57802912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62728400.0000; val_optim_loss: 62728400.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9439; val_auprc_score: 0.9388; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1012558.6016; train_edge_recon_loss: 4018334.4688; train_gene_expr_recon_loss: 62234010.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67264902.5000; train_optim_loss: 67264902.5000; val_kl_reg_loss: 845405.5000; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 57765812.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62677512.0000; val_optim_loss: 62677512.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9448; val_auprc_score: 0.9378; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2770524.4375; train_edge_recon_loss: 3851007.1562; train_gene_expr_recon_loss: 385116301.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 391737837.0000; train_optim_loss: 391737837.0000; val_kl_reg_loss: 1105216.3750; val_edge_recon_loss: 4066297.5000; val_gene_expr_recon_loss: 83798960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 88970472.0000; val_optim_loss: 88970472.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9334; val_auprc_score: 0.9207; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1303191.2344; train_edge_recon_loss: 4065172.3750; train_gene_expr_recon_loss: 83545996.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 88914359.0000; train_optim_loss: 88914359.0000; val_kl_reg_loss: 1413287.5000; val_edge_recon_loss: 4066298.0000; val_gene_expr_recon_loss: 74975584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 80455168.0000; val_optim_loss: 80455168.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9310; val_auprc_score: 0.9198; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1510315.0781; train_edge_recon_loss: 4062392.9375; train_gene_expr_recon_loss: 73606443.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79179152.0000; train_optim_loss: 79179152.0000; val_kl_reg_loss: 1536454.2500; val_edge_recon_loss: 4066298.2500; val_gene_expr_recon_loss: 69299328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 74902080.0000; val_optim_loss: 74902080.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9302; val_auprc_score: 0.9187; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1599569.3125; train_edge_recon_loss: 4065483.2188; train_gene_expr_recon_loss: 68531246.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74196300.0000; train_optim_loss: 74196300.0000; val_kl_reg_loss: 1588013.2500; val_edge_recon_loss: 4066296.7500; val_gene_expr_recon_loss: 67520408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73174720.0000; val_optim_loss: 73174720.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9265; val_auprc_score: 0.9127; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1625969.3750; train_edge_recon_loss: 4065560.2500; train_gene_expr_recon_loss: 67122118.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 72813647.0000; train_optim_loss: 72813647.0000; val_kl_reg_loss: 1589199.7500; val_edge_recon_loss: 4066297.5000; val_gene_expr_recon_loss: 66600016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 72255512.0000; val_optim_loss: 72255512.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9310; val_auprc_score: 0.9202; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1622724.9375; train_edge_recon_loss: 4065636.0625; train_gene_expr_recon_loss: 66308385.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71996746.0000; train_optim_loss: 71996746.0000; val_kl_reg_loss: 1585342.2500; val_edge_recon_loss: 4066297.5000; val_gene_expr_recon_loss: 66042712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71694352.0000; val_optim_loss: 71694352.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9306; val_auprc_score: 0.9198; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1618828.7031; train_edge_recon_loss: 4065702.4688; train_gene_expr_recon_loss: 65909383.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71593916.0000; train_optim_loss: 71593916.0000; val_kl_reg_loss: 1581251.5000; val_edge_recon_loss: 4066297.5000; val_gene_expr_recon_loss: 65754388.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71401936.0000; val_optim_loss: 71401936.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9277; val_auprc_score: 0.9146; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1612207.5000; train_edge_recon_loss: 4065758.3438; train_gene_expr_recon_loss: 65659020.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71336988.0000; train_optim_loss: 71336988.0000; val_kl_reg_loss: 1575955.3750; val_edge_recon_loss: 4066297.5000; val_gene_expr_recon_loss: 65566744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71209000.0000; val_optim_loss: 71209000.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 14 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
val AUROC score: 0.9457
val AUPRC score: 0.9415
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 10.4122
val source rna MSE score: 9.5644
Duration of model training in run 3: 0 hours, 1 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1628, n_latent: 1528, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1528, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1528, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9504; val_auprc_score: 0.9562; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 171494452.2101; train_edge_recon_loss: 3577664.7500; train_gene_expr_recon_loss: 887612858.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1062684986.0000; train_optim_loss: 1062684986.0000; val_kl_reg_loss: 35095296.0000; val_edge_recon_loss: 4065995.2500; val_gene_expr_recon_loss: 132952256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 172113552.0000; val_optim_loss: 172113552.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9440; val_auprc_score: 0.9483; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16039474.7266; train_edge_recon_loss: 3589778.3750; train_gene_expr_recon_loss: 678518386.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 698147644.0000; train_optim_loss: 698147644.0000; val_kl_reg_loss: 309244.1875; val_edge_recon_loss: 4066239.5000; val_gene_expr_recon_loss: 92229768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 96605248.0000; val_optim_loss: 96605248.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9397; val_auprc_score: 0.9415; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 502418.5000; train_edge_recon_loss: 3893204.1250; train_gene_expr_recon_loss: 97060462.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 101456084.0000; train_optim_loss: 101456084.0000; val_kl_reg_loss: 1722405.0000; val_edge_recon_loss: 4066272.0000; val_gene_expr_recon_loss: 92675584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 98464264.0000; val_optim_loss: 98464264.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9382; val_auprc_score: 0.9390; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1032331.1094; train_edge_recon_loss: 3939739.1875; train_gene_expr_recon_loss: 114987958.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 119960026.0000; train_optim_loss: 119960026.0000; val_kl_reg_loss: 1112572.5000; val_edge_recon_loss: 4066282.7500; val_gene_expr_recon_loss: 82011384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 87190240.0000; val_optim_loss: 87190240.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9364; val_auprc_score: 0.9371; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1013835.2969; train_edge_recon_loss: 4003888.1875; train_gene_expr_recon_loss: 80700108.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 85717832.0000; train_optim_loss: 85717832.0000; val_kl_reg_loss: 1039714.9375; val_edge_recon_loss: 4066286.7500; val_gene_expr_recon_loss: 75562928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 80668928.0000; val_optim_loss: 80668928.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9325; val_auprc_score: 0.9296; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1160187.7812; train_edge_recon_loss: 4054334.8125; train_gene_expr_recon_loss: 74634264.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 79848786.0000; train_optim_loss: 79848786.0000; val_kl_reg_loss: 1231561.2500; val_edge_recon_loss: 4066290.2500; val_gene_expr_recon_loss: 75067096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 80364944.0000; val_optim_loss: 80364944.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9314; val_auprc_score: 0.9263; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1323346.9062; train_edge_recon_loss: 4064699.8125; train_gene_expr_recon_loss: 70847080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 76235128.0000; train_optim_loss: 76235128.0000; val_kl_reg_loss: 1365320.5000; val_edge_recon_loss: 4066290.2500; val_gene_expr_recon_loss: 68466992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 73898600.0000; val_optim_loss: 73898600.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9299; val_auprc_score: 0.9238; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1450424.2188; train_edge_recon_loss: 4065789.5000; train_gene_expr_recon_loss: 67499378.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 73015592.0000; train_optim_loss: 73015592.0000; val_kl_reg_loss: 1474109.2500; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 66290384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71830784.0000; val_optim_loss: 71830784.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9314; val_auprc_score: 0.9252; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1550916.0938; train_edge_recon_loss: 4066116.1250; train_gene_expr_recon_loss: 66052411.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71669442.0000; train_optim_loss: 71669442.0000; val_kl_reg_loss: 1558787.0000; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 65724452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71349528.0000; val_optim_loss: 71349528.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9308; val_auprc_score: 0.9238; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1614391.3750; train_edge_recon_loss: 4064421.8125; train_gene_expr_recon_loss: 65323713.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 71002526.0000; train_optim_loss: 71002526.0000; val_kl_reg_loss: 1593213.7500; val_edge_recon_loss: 4066291.7500; val_gene_expr_recon_loss: 64602216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 70261720.0000; val_optim_loss: 70261720.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9298; val_auprc_score: 0.9238; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1638340.7188; train_edge_recon_loss: 4065559.6875; train_gene_expr_recon_loss: 64208671.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69912572.0000; train_optim_loss: 69912572.0000; val_kl_reg_loss: 1588502.3750; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 63719356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 69374152.0000; val_optim_loss: 69374152.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9272; val_auprc_score: 0.9171; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1629907.8438; train_edge_recon_loss: 4066067.6250; train_gene_expr_recon_loss: 63448446.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 69144422.0000; train_optim_loss: 69144422.0000; val_kl_reg_loss: 1573340.8750; val_edge_recon_loss: 4066291.7500; val_gene_expr_recon_loss: 63261880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68901512.0000; val_optim_loss: 68901512.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9269; val_auprc_score: 0.9193; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1606830.1562; train_edge_recon_loss: 4066139.0000; train_gene_expr_recon_loss: 63173004.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68845972.0000; train_optim_loss: 68845972.0000; val_kl_reg_loss: 1546471.8750; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 62963288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68576048.0000; val_optim_loss: 68576048.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9272; val_auprc_score: 0.9204; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1581344.4688; train_edge_recon_loss: 4065848.7500; train_gene_expr_recon_loss: 62795205.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68442398.0000; train_optim_loss: 68442398.0000; val_kl_reg_loss: 1514981.2500; val_edge_recon_loss: 4066290.7500; val_gene_expr_recon_loss: 62669356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68250624.0000; val_optim_loss: 68250624.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9253; val_auprc_score: 0.9153; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1544433.0938; train_edge_recon_loss: 4066140.3125; train_gene_expr_recon_loss: 62582328.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68192900.0000; train_optim_loss: 68192900.0000; val_kl_reg_loss: 1478245.7500; val_edge_recon_loss: 4066291.7500; val_gene_expr_recon_loss: 62457952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68002488.0000; val_optim_loss: 68002488.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9263; val_auprc_score: 0.9192; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1510929.8125; train_edge_recon_loss: 4066125.0625; train_gene_expr_recon_loss: 62416539.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67993592.0000; train_optim_loss: 67993592.0000; val_kl_reg_loss: 1445148.8750; val_edge_recon_loss: 4066290.2500; val_gene_expr_recon_loss: 62302200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67813640.0000; val_optim_loss: 67813640.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9305; val_auprc_score: 0.9252; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1472448.0000; train_edge_recon_loss: 4066080.4375; train_gene_expr_recon_loss: 62261739.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67800268.0000; train_optim_loss: 67800268.0000; val_kl_reg_loss: 1405703.2500; val_edge_recon_loss: 4066290.2500; val_gene_expr_recon_loss: 62187416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67659408.0000; val_optim_loss: 67659408.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9299; val_auprc_score: 0.9251; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1432204.3125; train_edge_recon_loss: 4066037.3750; train_gene_expr_recon_loss: 62140999.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67639240.0000; train_optim_loss: 67639240.0000; val_kl_reg_loss: 1365513.5000; val_edge_recon_loss: 4066288.2500; val_gene_expr_recon_loss: 62045692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67477496.0000; val_optim_loss: 67477496.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9295; val_auprc_score: 0.9248; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1392273.2500; train_edge_recon_loss: 4066057.6250; train_gene_expr_recon_loss: 62022441.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67480772.0000; train_optim_loss: 67480772.0000; val_kl_reg_loss: 1331710.5000; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 61934108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67332104.0000; val_optim_loss: 67332104.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9298; val_auprc_score: 0.9246; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1358109.2188; train_edge_recon_loss: 4066011.8125; train_gene_expr_recon_loss: 61910887.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67335008.0000; train_optim_loss: 67335008.0000; val_kl_reg_loss: 1296129.8750; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 61831772.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67194192.0000; val_optim_loss: 67194192.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9280; val_auprc_score: 0.9227; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1320769.9375; train_edge_recon_loss: 4065967.6875; train_gene_expr_recon_loss: 61843406.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67230144.0000; train_optim_loss: 67230144.0000; val_kl_reg_loss: 1256559.7500; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 61738408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 67061256.0000; val_optim_loss: 67061256.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9288; val_auprc_score: 0.9245; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1284602.2188; train_edge_recon_loss: 4065928.8125; train_gene_expr_recon_loss: 61765153.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67115683.0000; train_optim_loss: 67115683.0000; val_kl_reg_loss: 1223620.0000; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 61665872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66955776.0000; val_optim_loss: 66955776.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9320; val_auprc_score: 0.9307; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1244929.4688; train_edge_recon_loss: 4065830.1875; train_gene_expr_recon_loss: 61667575.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66978334.0000; train_optim_loss: 66978334.0000; val_kl_reg_loss: 1185863.5000; val_edge_recon_loss: 4066284.5000; val_gene_expr_recon_loss: 61584864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66837012.0000; val_optim_loss: 66837012.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9322; val_auprc_score: 0.9311; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1209117.6562; train_edge_recon_loss: 4065732.3125; train_gene_expr_recon_loss: 61590884.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66865733.0000; train_optim_loss: 66865733.0000; val_kl_reg_loss: 1153597.5000; val_edge_recon_loss: 4066285.2500; val_gene_expr_recon_loss: 61540360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66760244.0000; val_optim_loss: 66760244.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9313; val_auprc_score: 0.9305; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1175332.0625; train_edge_recon_loss: 4065757.8750; train_gene_expr_recon_loss: 61527986.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66769076.0000; train_optim_loss: 66769076.0000; val_kl_reg_loss: 1119148.5000; val_edge_recon_loss: 4066282.2500; val_gene_expr_recon_loss: 61487560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66672992.0000; val_optim_loss: 66672992.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9328; val_auprc_score: 0.9339; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1142863.1250; train_edge_recon_loss: 4065514.0625; train_gene_expr_recon_loss: 61528294.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66736671.0000; train_optim_loss: 66736671.0000; val_kl_reg_loss: 1088824.1250; val_edge_recon_loss: 4066281.5000; val_gene_expr_recon_loss: 61470032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66625136.0000; val_optim_loss: 66625136.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9316; val_auprc_score: 0.9314; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1109135.1875; train_edge_recon_loss: 4065329.0625; train_gene_expr_recon_loss: 61482755.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66657220.0000; train_optim_loss: 66657220.0000; val_kl_reg_loss: 1056855.2500; val_edge_recon_loss: 4066278.0000; val_gene_expr_recon_loss: 61441548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66564680.0000; val_optim_loss: 66564680.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9298; val_auprc_score: 0.9304; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1077791.1562; train_edge_recon_loss: 4065040.0000; train_gene_expr_recon_loss: 61468240.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66611071.0000; train_optim_loss: 66611071.0000; val_kl_reg_loss: 1027441.5000; val_edge_recon_loss: 4066279.0000; val_gene_expr_recon_loss: 61427708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66521428.0000; val_optim_loss: 66521428.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9319; val_auprc_score: 0.9340; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1051448.5000; train_edge_recon_loss: 4060962.5625; train_gene_expr_recon_loss: 61482979.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66595390.0000; train_optim_loss: 66595390.0000; val_kl_reg_loss: 997158.3750; val_edge_recon_loss: 4066277.2500; val_gene_expr_recon_loss: 61387440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66450876.0000; val_optim_loss: 66450876.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9302; val_auprc_score: 0.9300; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1021113.5938; train_edge_recon_loss: 4062271.4375; train_gene_expr_recon_loss: 61434880.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66518265.0000; train_optim_loss: 66518265.0000; val_kl_reg_loss: 1131320.1250; val_edge_recon_loss: 4066275.0000; val_gene_expr_recon_loss: 61292048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 66489644.0000; val_optim_loss: 66489644.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9298; val_auprc_score: 0.9287; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 466432808.5625; train_edge_recon_loss: 3731837.3125; train_gene_expr_recon_loss: 879819988.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 1349984666.0000; train_optim_loss: 1349984666.0000; val_kl_reg_loss: 240983965696.0000; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 340958592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 241328979968.0000; val_optim_loss: 241328979968.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9167; val_auprc_score: 0.8980; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 100075704914.0000; train_edge_recon_loss: 3898449.5625; train_gene_expr_recon_loss: 1404492544.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 101484101920.0000; train_optim_loss: 101484101920.0000; val_kl_reg_loss: 772043840.0000; val_edge_recon_loss: 4066298.2500; val_gene_expr_recon_loss: 336536576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 1112646656.0000; val_optim_loss: 1112646656.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9077; val_auprc_score: 0.8800; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 203952177.8750; train_edge_recon_loss: 3921739.3750; train_gene_expr_recon_loss: 788414312.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 996288264.0000; train_optim_loss: 996288264.0000; val_kl_reg_loss: 4475228.0000; val_edge_recon_loss: 4066303.2500; val_gene_expr_recon_loss: 209542208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 218083744.0000; val_optim_loss: 218083744.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9100; val_auprc_score: 0.8844; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3801749.6250; train_edge_recon_loss: 4014419.8125; train_gene_expr_recon_loss: 314312152.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 322128316.0000; train_optim_loss: 322128316.0000; val_kl_reg_loss: 3301476.7500; val_edge_recon_loss: 4066303.7500; val_gene_expr_recon_loss: 154413136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 161780912.0000; val_optim_loss: 161780912.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9129; val_auprc_score: 0.8879; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3401090.3125; train_edge_recon_loss: 4066095.8750; train_gene_expr_recon_loss: 135823452.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 143290634.0000; train_optim_loss: 143290634.0000; val_kl_reg_loss: 3294438.5000; val_edge_recon_loss: 4066304.0000; val_gene_expr_recon_loss: 116241632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 123602376.0000; val_optim_loss: 123602376.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9111; val_auprc_score: 0.8837; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3367193.8750; train_edge_recon_loss: 4066248.3125; train_gene_expr_recon_loss: 108487262.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 115920704.0000; train_optim_loss: 115920704.0000; val_kl_reg_loss: 3227830.5000; val_edge_recon_loss: 4066303.2500; val_gene_expr_recon_loss: 100303248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 107597384.0000; val_optim_loss: 107597384.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9125; val_auprc_score: 0.8879; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3284783.3750; train_edge_recon_loss: 4066261.3750; train_gene_expr_recon_loss: 96443110.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 103794154.0000; train_optim_loss: 103794154.0000; val_kl_reg_loss: 3130397.0000; val_edge_recon_loss: 4066303.7500; val_gene_expr_recon_loss: 92041472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 99238176.0000; val_optim_loss: 99238176.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 32 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9310
val AUPRC score: 0.9310
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 8.2222
val source rna MSE score: 5.5029
Duration of model training in run 2: 0 hours, 1 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1628, n_latent: 1528, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1528, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1528, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9500; val_auprc_score: 0.9464; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15441234.5575; train_edge_recon_loss: 3548031.0000; train_gene_expr_recon_loss: 616665510.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 635654766.0000; train_optim_loss: 635654766.0000; val_kl_reg_loss: 157643.8438; val_edge_recon_loss: 4065876.0000; val_gene_expr_recon_loss: 103734416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 107957936.0000; val_optim_loss: 107957936.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9454; val_auprc_score: 0.9505; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 223119.8945; train_edge_recon_loss: 3611890.5625; train_gene_expr_recon_loss: 104332340.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 108167350.0000; train_optim_loss: 108167350.0000; val_kl_reg_loss: 279757.5938; val_edge_recon_loss: 4066176.5000; val_gene_expr_recon_loss: 89659752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 94005688.0000; val_optim_loss: 94005688.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9440; val_auprc_score: 0.9463; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 307326.3242; train_edge_recon_loss: 3779382.7500; train_gene_expr_recon_loss: 87528532.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 91615242.0000; train_optim_loss: 91615242.0000; val_kl_reg_loss: 627573.3125; val_edge_recon_loss: 4066239.0000; val_gene_expr_recon_loss: 81345936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 86039752.0000; val_optim_loss: 86039752.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9433; val_auprc_score: 0.9473; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 775366.7422; train_edge_recon_loss: 3808635.4375; train_gene_expr_recon_loss: 85222688.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 89806692.0000; train_optim_loss: 89806692.0000; val_kl_reg_loss: 394605.9375; val_edge_recon_loss: 4066257.0000; val_gene_expr_recon_loss: 73298808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 77759672.0000; val_optim_loss: 77759672.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9414; val_auprc_score: 0.9442; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 841704.1406; train_edge_recon_loss: 3895243.4375; train_gene_expr_recon_loss: 73637124.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 78374074.0000; train_optim_loss: 78374074.0000; val_kl_reg_loss: 461964.7812; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 66530832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 71059064.0000; val_optim_loss: 71059064.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9376; val_auprc_score: 0.9394; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 557116.1094; train_edge_recon_loss: 3997932.5625; train_gene_expr_recon_loss: 69982531.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 74537580.0000; train_optim_loss: 74537580.0000; val_kl_reg_loss: 764143.6875; val_edge_recon_loss: 4066275.0000; val_gene_expr_recon_loss: 63249656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 68080072.0000; val_optim_loss: 68080072.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9384; val_auprc_score: 0.9413; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 681507.7969; train_edge_recon_loss: 3996025.7500; train_gene_expr_recon_loss: 62578950.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67256483.0000; train_optim_loss: 67256483.0000; val_kl_reg_loss: 639013.9375; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 60609368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65314664.0000; val_optim_loss: 65314664.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9376; val_auprc_score: 0.9379; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 700653.7031; train_edge_recon_loss: 4041556.2500; train_gene_expr_recon_loss: 59766574.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 64508784.0000; train_optim_loss: 64508784.0000; val_kl_reg_loss: 693611.3750; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 58539432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 63299324.0000; val_optim_loss: 63299324.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9398; val_auprc_score: 0.9417; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 756558.7812; train_edge_recon_loss: 4041915.7500; train_gene_expr_recon_loss: 61635940.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 66434415.0000; train_optim_loss: 66434415.0000; val_kl_reg_loss: 740660.3750; val_edge_recon_loss: 4066284.0000; val_gene_expr_recon_loss: 57605180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 62412124.0000; val_optim_loss: 62412124.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9329; val_auprc_score: 0.9306; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 886305.2812; train_edge_recon_loss: 4018613.2500; train_gene_expr_recon_loss: 63022470.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 67927389.0000; train_optim_loss: 67927389.0000; val_kl_reg_loss: 772196.0000; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 56973984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61812464.0000; val_optim_loss: 61812464.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9358; val_auprc_score: 0.9332; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 811286.0781; train_edge_recon_loss: 4065928.0000; train_gene_expr_recon_loss: 57001165.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61878379.0000; train_optim_loss: 61878379.0000; val_kl_reg_loss: 809074.3750; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 56667528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61542888.0000; val_optim_loss: 61542888.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9367; val_auprc_score: 0.9359; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 979812.9219; train_edge_recon_loss: 4020075.0625; train_gene_expr_recon_loss: 57696945.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62696834.0000; train_optim_loss: 62696834.0000; val_kl_reg_loss: 839094.2500; val_edge_recon_loss: 4066288.0000; val_gene_expr_recon_loss: 56078024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60983408.0000; val_optim_loss: 60983408.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9359; val_auprc_score: 0.9326; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 904244.7188; train_edge_recon_loss: 4049021.5000; train_gene_expr_recon_loss: 55899413.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60852679.0000; train_optim_loss: 60852679.0000; val_kl_reg_loss: 862612.5000; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 55555624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60484524.0000; val_optim_loss: 60484524.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9340; val_auprc_score: 0.9316; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 906530.6719; train_edge_recon_loss: 4057004.2500; train_gene_expr_recon_loss: 55500285.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60463821.0000; train_optim_loss: 60463821.0000; val_kl_reg_loss: 876238.7500; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 55337096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60279624.0000; val_optim_loss: 60279624.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9340; val_auprc_score: 0.9302; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 912406.1875; train_edge_recon_loss: 4059656.4375; train_gene_expr_recon_loss: 55300797.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60272860.0000; train_optim_loss: 60272860.0000; val_kl_reg_loss: 885287.7500; val_edge_recon_loss: 4066286.7500; val_gene_expr_recon_loss: 55172096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60123672.0000; val_optim_loss: 60123672.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9332; val_auprc_score: 0.9298; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 915921.1250; train_edge_recon_loss: 4065028.8750; train_gene_expr_recon_loss: 55035524.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60016475.0000; train_optim_loss: 60016475.0000; val_kl_reg_loss: 897588.7500; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 54987832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59951708.0000; val_optim_loss: 59951708.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9331; val_auprc_score: 0.9307; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 926769.2344; train_edge_recon_loss: 4062373.5000; train_gene_expr_recon_loss: 54830569.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59819712.0000; train_optim_loss: 59819712.0000; val_kl_reg_loss: 900476.8750; val_edge_recon_loss: 4066286.5000; val_gene_expr_recon_loss: 54774676.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59741440.0000; val_optim_loss: 59741440.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9279; val_auprc_score: 0.9222; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 929457.9688; train_edge_recon_loss: 4065915.7500; train_gene_expr_recon_loss: 54725982.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59721356.0000; train_optim_loss: 59721356.0000; val_kl_reg_loss: 901795.7500; val_edge_recon_loss: 4066286.7500; val_gene_expr_recon_loss: 54626264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59594348.0000; val_optim_loss: 59594348.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9311; val_auprc_score: 0.9262; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 929912.7344; train_edge_recon_loss: 4064166.1875; train_gene_expr_recon_loss: 54559724.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59553803.0000; train_optim_loss: 59553803.0000; val_kl_reg_loss: 899462.3750; val_edge_recon_loss: 4066286.5000; val_gene_expr_recon_loss: 54495728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59461476.0000; val_optim_loss: 59461476.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9327; val_auprc_score: 0.9298; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 926596.7031; train_edge_recon_loss: 4065030.4375; train_gene_expr_recon_loss: 54411976.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59403603.0000; train_optim_loss: 59403603.0000; val_kl_reg_loss: 897768.3125; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 54397320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59361376.0000; val_optim_loss: 59361376.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9317; val_auprc_score: 0.9280; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 933775.7969; train_edge_recon_loss: 4055169.9375; train_gene_expr_recon_loss: 55314765.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 60303710.0000; train_optim_loss: 60303710.0000; val_kl_reg_loss: 890712.6250; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 54338332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59295332.0000; val_optim_loss: 59295332.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9367; val_auprc_score: 0.9355; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 938906.0938; train_edge_recon_loss: 4049495.5625; train_gene_expr_recon_loss: 54332534.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59320936.0000; train_optim_loss: 59320936.0000; val_kl_reg_loss: 885539.5000; val_edge_recon_loss: 4066285.2500; val_gene_expr_recon_loss: 54231096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59182920.0000; val_optim_loss: 59182920.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9288; val_auprc_score: 0.9234; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 910405.3125; train_edge_recon_loss: 4066135.0000; train_gene_expr_recon_loss: 54202818.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59179359.0000; train_optim_loss: 59179359.0000; val_kl_reg_loss: 878282.6875; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 54166344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59110912.0000; val_optim_loss: 59110912.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9326; val_auprc_score: 0.9304; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 904245.8750; train_edge_recon_loss: 4066116.7500; train_gene_expr_recon_loss: 54103934.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59074296.0000; train_optim_loss: 59074296.0000; val_kl_reg_loss: 871861.5000; val_edge_recon_loss: 4066284.5000; val_gene_expr_recon_loss: 54118132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59056280.0000; val_optim_loss: 59056280.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9311; val_auprc_score: 0.9293; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 894890.0000; train_edge_recon_loss: 4066031.0625; train_gene_expr_recon_loss: 54029749.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58990669.0000; train_optim_loss: 58990669.0000; val_kl_reg_loss: 866342.6250; val_edge_recon_loss: 4066285.0000; val_gene_expr_recon_loss: 54062968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58995596.0000; val_optim_loss: 58995596.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9349; val_auprc_score: 0.9330; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 890234.4688; train_edge_recon_loss: 4066073.0000; train_gene_expr_recon_loss: 54045528.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59001836.0000; train_optim_loss: 59001836.0000; val_kl_reg_loss: 856244.2500; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 54002128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58924652.0000; val_optim_loss: 58924652.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9334; val_auprc_score: 0.9329; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 880793.6875; train_edge_recon_loss: 4066033.1875; train_gene_expr_recon_loss: 53969367.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58916194.0000; train_optim_loss: 58916194.0000; val_kl_reg_loss: 848362.7500; val_edge_recon_loss: 4066281.5000; val_gene_expr_recon_loss: 53962200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58876844.0000; val_optim_loss: 58876844.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9311; val_auprc_score: 0.9292; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 870970.0469; train_edge_recon_loss: 4066018.8125; train_gene_expr_recon_loss: 53943007.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58879996.0000; train_optim_loss: 58879996.0000; val_kl_reg_loss: 839442.8750; val_edge_recon_loss: 4066279.5000; val_gene_expr_recon_loss: 53911384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58817108.0000; val_optim_loss: 58817108.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9317; val_auprc_score: 0.9307; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 863915.7344; train_edge_recon_loss: 4066011.5625; train_gene_expr_recon_loss: 53857260.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58787187.0000; train_optim_loss: 58787187.0000; val_kl_reg_loss: 831185.5000; val_edge_recon_loss: 4066280.2500; val_gene_expr_recon_loss: 53877972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58775440.0000; val_optim_loss: 58775440.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9307; val_auprc_score: 0.9311; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 854489.0625; train_edge_recon_loss: 4066061.3750; train_gene_expr_recon_loss: 53853892.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58774443.0000; train_optim_loss: 58774443.0000; val_kl_reg_loss: 821667.2500; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 53833004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58720952.0000; val_optim_loss: 58720952.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9336; val_auprc_score: 0.9353; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 844682.5781; train_edge_recon_loss: 4065992.1875; train_gene_expr_recon_loss: 53802646.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58713322.0000; train_optim_loss: 58713322.0000; val_kl_reg_loss: 816053.8750; val_edge_recon_loss: 4066276.7500; val_gene_expr_recon_loss: 53819420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58701752.0000; val_optim_loss: 58701752.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9295; val_auprc_score: 0.9280; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 857301.5312; train_edge_recon_loss: 4049916.5625; train_gene_expr_recon_loss: 53997483.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58904702.0000; train_optim_loss: 58904702.0000; val_kl_reg_loss: 806122.8750; val_edge_recon_loss: 4066278.0000; val_gene_expr_recon_loss: 53769272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58641672.0000; val_optim_loss: 58641672.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9288; val_auprc_score: 0.9298; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 849275.1562; train_edge_recon_loss: 4048556.6250; train_gene_expr_recon_loss: 53735381.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58633213.0000; train_optim_loss: 58633213.0000; val_kl_reg_loss: 796340.7500; val_edge_recon_loss: 4066276.5000; val_gene_expr_recon_loss: 53731584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58594200.0000; val_optim_loss: 58594200.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9288; val_auprc_score: 0.9278; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 817687.4688; train_edge_recon_loss: 4066035.6875; train_gene_expr_recon_loss: 53676842.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58560565.0000; train_optim_loss: 58560565.0000; val_kl_reg_loss: 790389.7500; val_edge_recon_loss: 4066273.5000; val_gene_expr_recon_loss: 53710564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58567228.0000; val_optim_loss: 58567228.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9294; val_auprc_score: 0.9308; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 810758.1875; train_edge_recon_loss: 4065976.0625; train_gene_expr_recon_loss: 53658141.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58534874.0000; train_optim_loss: 58534874.0000; val_kl_reg_loss: 779484.3750; val_edge_recon_loss: 4066272.0000; val_gene_expr_recon_loss: 53652912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58498668.0000; val_optim_loss: 58498668.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9299; val_auprc_score: 0.9325; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 803058.9688; train_edge_recon_loss: 4065937.6250; train_gene_expr_recon_loss: 53684820.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 58553817.0000; train_optim_loss: 58553817.0000; val_kl_reg_loss: 772066.3125; val_edge_recon_loss: 4066270.5000; val_gene_expr_recon_loss: 53641864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58480200.0000; val_optim_loss: 58480200.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9290; val_auprc_score: 0.9318; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 913668.5469; train_edge_recon_loss: 4029477.6875; train_gene_expr_recon_loss: 82115902.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 87059049.0000; train_optim_loss: 87059049.0000; val_kl_reg_loss: 759557.6250; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 61067272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65893096.0000; val_optim_loss: 65893096.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9271; val_auprc_score: 0.9279; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 786685.2812; train_edge_recon_loss: 4063386.3750; train_gene_expr_recon_loss: 57383386.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62233458.0000; train_optim_loss: 62233458.0000; val_kl_reg_loss: 772896.3125; val_edge_recon_loss: 4066273.0000; val_gene_expr_recon_loss: 55542648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60381816.0000; val_optim_loss: 60381816.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9275; val_auprc_score: 0.9280; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17332465.9688; train_edge_recon_loss: 4014698.6250; train_gene_expr_recon_loss: 142138112.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 163485276.0000; train_optim_loss: 163485276.0000; val_kl_reg_loss: 798982.3125; val_edge_recon_loss: 4066278.7500; val_gene_expr_recon_loss: 56057656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 60922916.0000; val_optim_loss: 60922916.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9210; val_auprc_score: 0.9125; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1342246.5156; train_edge_recon_loss: 4001776.3125; train_gene_expr_recon_loss: 74660976.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 80005000.0000; train_optim_loss: 80005000.0000; val_kl_reg_loss: 893291.6250; val_edge_recon_loss: 4066285.5000; val_gene_expr_recon_loss: 56838868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 61798444.0000; val_optim_loss: 61798444.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9199; val_auprc_score: 0.9090; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 925945.6250; train_edge_recon_loss: 4063217.5625; train_gene_expr_recon_loss: 56087790.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 61076953.0000; train_optim_loss: 61076953.0000; val_kl_reg_loss: 901434.0625; val_edge_recon_loss: 4066285.0000; val_gene_expr_recon_loss: 54912164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59879884.0000; val_optim_loss: 59879884.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9245; val_auprc_score: 0.9194; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 929334.0625; train_edge_recon_loss: 4065084.6250; train_gene_expr_recon_loss: 54402952.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59397371.0000; train_optim_loss: 59397371.0000; val_kl_reg_loss: 901921.1875; val_edge_recon_loss: 4066285.2500; val_gene_expr_recon_loss: 54164812.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59133020.0000; val_optim_loss: 59133020.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9230; val_auprc_score: 0.9167; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 931370.1406; train_edge_recon_loss: 4065822.6875; train_gene_expr_recon_loss: 54182039.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59179232.0000; train_optim_loss: 59179232.0000; val_kl_reg_loss: 902245.5000; val_edge_recon_loss: 4066285.2500; val_gene_expr_recon_loss: 54317840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59286372.0000; val_optim_loss: 59286372.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9221; val_auprc_score: 0.9134; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 930473.3125; train_edge_recon_loss: 4065870.8750; train_gene_expr_recon_loss: 54269718.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 59266062.0000; train_optim_loss: 59266062.0000; val_kl_reg_loss: 901879.8750; val_edge_recon_loss: 4066284.5000; val_gene_expr_recon_loss: 54187312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59155476.0000; val_optim_loss: 59155476.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 49 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9287
val AUPRC score: 0.9294
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 7.3802
val source rna MSE score: 4.4190
Duration of model training in run 1: 0 hours, 1 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
