Run timestamp: 16082023_160422_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_1pct', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3020
Number of validation edges: 335
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9678; val_auprc_score: 0.9489; val_best_acc_score: 0.8597; val_best_f1_score: 0.8766; train_kl_reg_loss: 2.2708; train_edge_recon_loss: 3465958.2500; train_gene_expr_recon_loss: 1824395.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5290356.0000; train_optim_loss: 5290356.0000; val_kl_reg_loss: 12.6875; val_edge_recon_loss: 3987832.7500; val_gene_expr_recon_loss: 1709700.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5697546.0000; val_optim_loss: 5697546.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9326; val_auprc_score: 0.8966; val_best_acc_score: 0.8687; val_best_f1_score: 0.8679; train_kl_reg_loss: 12.9876; train_edge_recon_loss: 3466352.0000; train_gene_expr_recon_loss: 1806276.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5272641.5000; train_optim_loss: 5272641.5000; val_kl_reg_loss: 55.5963; val_edge_recon_loss: 4036134.7500; val_gene_expr_recon_loss: 1706801.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5742992.0000; val_optim_loss: 5742992.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9183; val_auprc_score: 0.8773; val_best_acc_score: 0.7493; val_best_f1_score: 0.7981; train_kl_reg_loss: 57.4739; train_edge_recon_loss: 3466189.7500; train_gene_expr_recon_loss: 1795408.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5261656.0000; train_optim_loss: 5261656.0000; val_kl_reg_loss: 148.9435; val_edge_recon_loss: 4050583.5000; val_gene_expr_recon_loss: 1691576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5742308.5000; val_optim_loss: 5742308.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9071; val_auprc_score: 0.8824; val_best_acc_score: 0.6597; val_best_f1_score: 0.7461; train_kl_reg_loss: 159.7306; train_edge_recon_loss: 3462454.7500; train_gene_expr_recon_loss: 1790377.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5252992.0000; train_optim_loss: 5252992.0000; val_kl_reg_loss: 328.7159; val_edge_recon_loss: 4056686.2500; val_gene_expr_recon_loss: 1695756.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5752771.0000; val_optim_loss: 5752771.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8864; val_auprc_score: 0.8473; val_best_acc_score: 0.6463; val_best_f1_score: 0.7381; train_kl_reg_loss: 346.0293; train_edge_recon_loss: 3460597.0000; train_gene_expr_recon_loss: 1786596.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247539.5000; train_optim_loss: 5247539.5000; val_kl_reg_loss: 546.8027; val_edge_recon_loss: 4057004.5000; val_gene_expr_recon_loss: 1692882.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5750433.5000; val_optim_loss: 5750433.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8910; val_auprc_score: 0.8776; val_best_acc_score: 0.6716; val_best_f1_score: 0.7511; train_kl_reg_loss: 582.0562; train_edge_recon_loss: 3462157.0000; train_gene_expr_recon_loss: 1783701.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5246440.5000; train_optim_loss: 5246440.5000; val_kl_reg_loss: 706.5378; val_edge_recon_loss: 4053427.5000; val_gene_expr_recon_loss: 1683921.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5738055.0000; val_optim_loss: 5738055.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8660; val_auprc_score: 0.8366; val_best_acc_score: 0.7104; val_best_f1_score: 0.7707; train_kl_reg_loss: 760.9399; train_edge_recon_loss: 3461311.7500; train_gene_expr_recon_loss: 1782012.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5244085.0000; train_optim_loss: 5244085.0000; val_kl_reg_loss: 783.2070; val_edge_recon_loss: 4042303.7500; val_gene_expr_recon_loss: 1694360.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5737447.5000; val_optim_loss: 5737447.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8570; val_auprc_score: 0.8461; val_best_acc_score: 0.7179; val_best_f1_score: 0.7592; train_kl_reg_loss: 847.6196; train_edge_recon_loss: 3461876.2500; train_gene_expr_recon_loss: 1779126.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5241850.0000; train_optim_loss: 5241850.0000; val_kl_reg_loss: 818.3083; val_edge_recon_loss: 4024469.5000; val_gene_expr_recon_loss: 1691759.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5717047.0000; val_optim_loss: 5717047.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8644; val_auprc_score: 0.8460; val_best_acc_score: 0.7299; val_best_f1_score: 0.7658; train_kl_reg_loss: 857.0687; train_edge_recon_loss: 3453737.0000; train_gene_expr_recon_loss: 1777729.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5232323.0000; train_optim_loss: 5232323.0000; val_kl_reg_loss: 816.0957; val_edge_recon_loss: 4011390.7500; val_gene_expr_recon_loss: 1694917.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5707124.5000; val_optim_loss: 5707124.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9633
val AUPRC score: 0.9481
val best accuracy score: 0.8478
val best F1 score: 0.8675
val target rna MSE score: 0.0116
val source rna MSE score: 0.0035
Duration of model training in run 8: 0 hours, 0 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3020
Number of validation edges: 335
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9469; val_auprc_score: 0.9000; val_best_acc_score: 0.8537; val_best_f1_score: 0.8711; train_kl_reg_loss: 2.0660; train_edge_recon_loss: 3467062.0000; train_gene_expr_recon_loss: 1797763.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5264828.0000; train_optim_loss: 5264828.0000; val_kl_reg_loss: 11.8299; val_edge_recon_loss: 3985420.7500; val_gene_expr_recon_loss: 1847996.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5833429.0000; val_optim_loss: 5833429.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9334; val_auprc_score: 0.9009; val_best_acc_score: 0.8582; val_best_f1_score: 0.8541; train_kl_reg_loss: 11.7687; train_edge_recon_loss: 3467444.5000; train_gene_expr_recon_loss: 1780613.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5248069.0000; train_optim_loss: 5248069.0000; val_kl_reg_loss: 49.4199; val_edge_recon_loss: 4036081.5000; val_gene_expr_recon_loss: 1852232.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5888363.5000; val_optim_loss: 5888363.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9303; val_auprc_score: 0.9091; val_best_acc_score: 0.7851; val_best_f1_score: 0.8213; train_kl_reg_loss: 49.1803; train_edge_recon_loss: 3465526.5000; train_gene_expr_recon_loss: 1770112.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5235688.0000; train_optim_loss: 5235688.0000; val_kl_reg_loss: 138.9485; val_edge_recon_loss: 4051694.0000; val_gene_expr_recon_loss: 1843429.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5895262.0000; val_optim_loss: 5895262.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9246; val_auprc_score: 0.8762; val_best_acc_score: 0.6866; val_best_f1_score: 0.7608; train_kl_reg_loss: 137.8847; train_edge_recon_loss: 3461468.7500; train_gene_expr_recon_loss: 1765595.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5227202.0000; train_optim_loss: 5227202.0000; val_kl_reg_loss: 304.4524; val_edge_recon_loss: 4055571.5000; val_gene_expr_recon_loss: 1845489.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5901365.0000; val_optim_loss: 5901365.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9057; val_auprc_score: 0.8709; val_best_acc_score: 0.6343; val_best_f1_score: 0.7317; train_kl_reg_loss: 302.5740; train_edge_recon_loss: 3461561.0000; train_gene_expr_recon_loss: 1760799.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5222662.5000; train_optim_loss: 5222662.5000; val_kl_reg_loss: 528.5952; val_edge_recon_loss: 4057932.0000; val_gene_expr_recon_loss: 1842450.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5900910.5000; val_optim_loss: 5900910.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9041; val_auprc_score: 0.9033; val_best_acc_score: 0.6716; val_best_f1_score: 0.7511; train_kl_reg_loss: 526.3770; train_edge_recon_loss: 3458670.7500; train_gene_expr_recon_loss: 1757549.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5216746.0000; train_optim_loss: 5216746.0000; val_kl_reg_loss: 748.2490; val_edge_recon_loss: 4054916.5000; val_gene_expr_recon_loss: 1848982.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5904647.0000; val_optim_loss: 5904647.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8778; val_auprc_score: 0.8411; val_best_acc_score: 0.7134; val_best_f1_score: 0.7746; train_kl_reg_loss: 733.5651; train_edge_recon_loss: 3462252.0000; train_gene_expr_recon_loss: 1755455.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5218440.5000; train_optim_loss: 5218440.5000; val_kl_reg_loss: 832.6637; val_edge_recon_loss: 4049455.0000; val_gene_expr_recon_loss: 1836192.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5886480.0000; val_optim_loss: 5886480.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8770; val_auprc_score: 0.8609; val_best_acc_score: 0.7313; val_best_f1_score: 0.7778; train_kl_reg_loss: 831.1158; train_edge_recon_loss: 3458279.2500; train_gene_expr_recon_loss: 1753780.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5212890.5000; train_optim_loss: 5212890.5000; val_kl_reg_loss: 864.3389; val_edge_recon_loss: 4032203.7500; val_gene_expr_recon_loss: 1846399.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5879468.0000; val_optim_loss: 5879468.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8613; val_auprc_score: 0.8326; val_best_acc_score: 0.7373; val_best_f1_score: 0.7805; train_kl_reg_loss: 850.2037; train_edge_recon_loss: 3455109.2500; train_gene_expr_recon_loss: 1752153.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5208113.0000; train_optim_loss: 5208113.0000; val_kl_reg_loss: 850.0741; val_edge_recon_loss: 4026621.2500; val_gene_expr_recon_loss: 1835264.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5862735.5000; val_optim_loss: 5862735.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9485
val AUPRC score: 0.9117
val best accuracy score: 0.8522
val best F1 score: 0.8699
val target rna MSE score: 0.0118
val source rna MSE score: 0.0037
Duration of model training in run 7: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 2290
Number of validation edges: 254
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9352; val_auprc_score: 0.8818; val_best_acc_score: 0.8858; val_best_f1_score: 0.8938; train_kl_reg_loss: 2.3896; train_edge_recon_loss: 3464284.5000; train_gene_expr_recon_loss: 1809561.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5273848.0000; train_optim_loss: 5273848.0000; val_kl_reg_loss: 13.6303; val_edge_recon_loss: 3977058.5000; val_gene_expr_recon_loss: 1763117.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5740190.0000; val_optim_loss: 5740190.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9482; val_auprc_score: 0.9375; val_best_acc_score: 0.8425; val_best_f1_score: 0.8261; train_kl_reg_loss: 13.3161; train_edge_recon_loss: 3466273.7500; train_gene_expr_recon_loss: 1791545.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5257832.5000; train_optim_loss: 5257832.5000; val_kl_reg_loss: 57.1143; val_edge_recon_loss: 4034979.0000; val_gene_expr_recon_loss: 1761053.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5796089.0000; val_optim_loss: 5796089.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9395; val_auprc_score: 0.9168; val_best_acc_score: 0.8169; val_best_f1_score: 0.8426; train_kl_reg_loss: 57.5241; train_edge_recon_loss: 3466897.5000; train_gene_expr_recon_loss: 1782297.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5249252.0000; train_optim_loss: 5249252.0000; val_kl_reg_loss: 155.6265; val_edge_recon_loss: 4052038.7500; val_gene_expr_recon_loss: 1749276.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5801471.0000; val_optim_loss: 5801471.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9101; val_auprc_score: 0.8691; val_best_acc_score: 0.6693; val_best_f1_score: 0.7515; train_kl_reg_loss: 157.8436; train_edge_recon_loss: 3462597.5000; train_gene_expr_recon_loss: 1777750.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5240506.0000; train_optim_loss: 5240506.0000; val_kl_reg_loss: 325.4394; val_edge_recon_loss: 4058239.2500; val_gene_expr_recon_loss: 1747869.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5806434.5000; val_optim_loss: 5806434.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9293; val_auprc_score: 0.9216; val_best_acc_score: 0.6043; val_best_f1_score: 0.7165; train_kl_reg_loss: 326.5937; train_edge_recon_loss: 3457620.2500; train_gene_expr_recon_loss: 1773127.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231074.5000; train_optim_loss: 5231074.5000; val_kl_reg_loss: 563.0768; val_edge_recon_loss: 4060175.0000; val_gene_expr_recon_loss: 1751934.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5812673.0000; val_optim_loss: 5812673.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9327; val_auprc_score: 0.9180; val_best_acc_score: 0.6358; val_best_f1_score: 0.7330; train_kl_reg_loss: 557.2350; train_edge_recon_loss: 3460549.5000; train_gene_expr_recon_loss: 1770081.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231188.5000; train_optim_loss: 5231188.5000; val_kl_reg_loss: 771.0997; val_edge_recon_loss: 4058756.2500; val_gene_expr_recon_loss: 1753073.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5812600.0000; val_optim_loss: 5812600.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9179; val_auprc_score: 0.8872; val_best_acc_score: 0.6713; val_best_f1_score: 0.7526; train_kl_reg_loss: 763.9701; train_edge_recon_loss: 3463212.5000; train_gene_expr_recon_loss: 1767146.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231123.0000; train_optim_loss: 5231123.0000; val_kl_reg_loss: 862.9388; val_edge_recon_loss: 4055570.2500; val_gene_expr_recon_loss: 1743424.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5799858.0000; val_optim_loss: 5799858.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8747; val_auprc_score: 0.8509; val_best_acc_score: 0.7244; val_best_f1_score: 0.7819; train_kl_reg_loss: 864.6351; train_edge_recon_loss: 3460052.5000; train_gene_expr_recon_loss: 1765216.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5226134.0000; train_optim_loss: 5226134.0000; val_kl_reg_loss: 896.6407; val_edge_recon_loss: 4047955.5000; val_gene_expr_recon_loss: 1746969.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5795822.0000; val_optim_loss: 5795822.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9010; val_auprc_score: 0.8669; val_best_acc_score: 0.7441; val_best_f1_score: 0.7943; train_kl_reg_loss: 882.0632; train_edge_recon_loss: 3457570.0000; train_gene_expr_recon_loss: 1763549.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5222001.0000; train_optim_loss: 5222001.0000; val_kl_reg_loss: 897.5519; val_edge_recon_loss: 4043987.7500; val_gene_expr_recon_loss: 1755759.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5800644.5000; val_optim_loss: 5800644.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9394
val AUPRC score: 0.8763
val best accuracy score: 0.9055
val best F1 score: 0.9104
val target rna MSE score: 0.0103
val source rna MSE score: 0.0036
Duration of model training in run 6: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 2290
Number of validation edges: 254
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9455; val_auprc_score: 0.8887; val_best_acc_score: 0.8976; val_best_f1_score: 0.9030; train_kl_reg_loss: 2.3418; train_edge_recon_loss: 3465496.2500; train_gene_expr_recon_loss: 1802691.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5268189.5000; train_optim_loss: 5268189.5000; val_kl_reg_loss: 13.0188; val_edge_recon_loss: 3966060.2500; val_gene_expr_recon_loss: 1897565.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5863639.0000; val_optim_loss: 5863639.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9485; val_auprc_score: 0.9368; val_best_acc_score: 0.8622; val_best_f1_score: 0.8504; train_kl_reg_loss: 12.6899; train_edge_recon_loss: 3467460.5000; train_gene_expr_recon_loss: 1783776.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5251249.5000; train_optim_loss: 5251249.5000; val_kl_reg_loss: 54.7304; val_edge_recon_loss: 4032189.0000; val_gene_expr_recon_loss: 1898772.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5931016.0000; val_optim_loss: 5931016.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9387; val_auprc_score: 0.9111; val_best_acc_score: 0.8445; val_best_f1_score: 0.8631; train_kl_reg_loss: 53.4233; train_edge_recon_loss: 3465856.5000; train_gene_expr_recon_loss: 1774096.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5240006.5000; train_optim_loss: 5240006.5000; val_kl_reg_loss: 160.1970; val_edge_recon_loss: 4048329.5000; val_gene_expr_recon_loss: 1902920.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5951410.0000; val_optim_loss: 5951410.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9221; val_auprc_score: 0.8966; val_best_acc_score: 0.6713; val_best_f1_score: 0.7519; train_kl_reg_loss: 153.5363; train_edge_recon_loss: 3460576.2500; train_gene_expr_recon_loss: 1767603.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5228333.0000; train_optim_loss: 5228333.0000; val_kl_reg_loss: 348.9321; val_edge_recon_loss: 4055400.0000; val_gene_expr_recon_loss: 1894333.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5950082.0000; val_optim_loss: 5950082.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9299; val_auprc_score: 0.9097; val_best_acc_score: 0.6516; val_best_f1_score: 0.7416; train_kl_reg_loss: 334.8976; train_edge_recon_loss: 3462467.5000; train_gene_expr_recon_loss: 1763409.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5226211.5000; train_optim_loss: 5226211.5000; val_kl_reg_loss: 592.3250; val_edge_recon_loss: 4057068.0000; val_gene_expr_recon_loss: 1897757.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5955418.0000; val_optim_loss: 5955418.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9138; val_auprc_score: 0.8920; val_best_acc_score: 0.6713; val_best_f1_score: 0.7504; train_kl_reg_loss: 568.7095; train_edge_recon_loss: 3460274.0000; train_gene_expr_recon_loss: 1759696.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5220539.0000; train_optim_loss: 5220539.0000; val_kl_reg_loss: 813.0842; val_edge_recon_loss: 4054488.0000; val_gene_expr_recon_loss: 1894466.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5949767.0000; val_optim_loss: 5949767.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9187; val_auprc_score: 0.8957; val_best_acc_score: 0.7323; val_best_f1_score: 0.7848; train_kl_reg_loss: 765.3161; train_edge_recon_loss: 3461805.5000; train_gene_expr_recon_loss: 1757594.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5220165.5000; train_optim_loss: 5220165.5000; val_kl_reg_loss: 888.8733; val_edge_recon_loss: 4044260.7500; val_gene_expr_recon_loss: 1888695.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5933845.0000; val_optim_loss: 5933845.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9138; val_auprc_score: 0.9163; val_best_acc_score: 0.7894; val_best_f1_score: 0.8190; train_kl_reg_loss: 870.4081; train_edge_recon_loss: 3461414.5000; train_gene_expr_recon_loss: 1757004.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5219289.0000; train_optim_loss: 5219289.0000; val_kl_reg_loss: 940.3455; val_edge_recon_loss: 4025843.5000; val_gene_expr_recon_loss: 1898668.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5925452.5000; val_optim_loss: 5925452.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8723; val_auprc_score: 0.8326; val_best_acc_score: 0.7657; val_best_f1_score: 0.8027; train_kl_reg_loss: 897.1661; train_edge_recon_loss: 3450354.0000; train_gene_expr_recon_loss: 1753769.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205021.0000; train_optim_loss: 5205021.0000; val_kl_reg_loss: 953.7560; val_edge_recon_loss: 4026653.2500; val_gene_expr_recon_loss: 1879297.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5906905.0000; val_optim_loss: 5906905.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9502
val AUPRC score: 0.9134
val best accuracy score: 0.9055
val best F1 score: 0.9098
val target rna MSE score: 0.0113
val source rna MSE score: 0.0036
Duration of model training in run 5: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 1549
Number of validation edges: 172
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9492; val_auprc_score: 0.9237; val_best_acc_score: 0.8488; val_best_f1_score: 0.8673; train_kl_reg_loss: 2.3374; train_edge_recon_loss: 3464859.5000; train_gene_expr_recon_loss: 1826789.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5291651.0000; train_optim_loss: 5291651.0000; val_kl_reg_loss: 11.0651; val_edge_recon_loss: 3948705.0000; val_gene_expr_recon_loss: 1599370.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5548086.5000; val_optim_loss: 5548086.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9324; val_auprc_score: 0.9296; val_best_acc_score: 0.7238; val_best_f1_score: 0.7288; train_kl_reg_loss: 11.9726; train_edge_recon_loss: 3463689.7500; train_gene_expr_recon_loss: 1806837.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5270539.5000; train_optim_loss: 5270539.5000; val_kl_reg_loss: 45.3994; val_edge_recon_loss: 4026496.5000; val_gene_expr_recon_loss: 1590784.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5617327.0000; val_optim_loss: 5617327.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9024; val_auprc_score: 0.8590; val_best_acc_score: 0.8430; val_best_f1_score: 0.8508; train_kl_reg_loss: 51.3402; train_edge_recon_loss: 3462667.7500; train_gene_expr_recon_loss: 1797587.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5260307.0000; train_optim_loss: 5260307.0000; val_kl_reg_loss: 131.2127; val_edge_recon_loss: 4048634.5000; val_gene_expr_recon_loss: 1593258.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5642024.5000; val_optim_loss: 5642024.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8994; val_auprc_score: 0.8889; val_best_acc_score: 0.7035; val_best_f1_score: 0.7713; train_kl_reg_loss: 148.6749; train_edge_recon_loss: 3462226.0000; train_gene_expr_recon_loss: 1791576.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5253951.0000; train_optim_loss: 5253951.0000; val_kl_reg_loss: 276.4007; val_edge_recon_loss: 4056375.2500; val_gene_expr_recon_loss: 1592241.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5648893.5000; val_optim_loss: 5648893.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8516; val_auprc_score: 0.8228; val_best_acc_score: 0.6163; val_best_f1_score: 0.7227; train_kl_reg_loss: 318.5361; train_edge_recon_loss: 3459086.5000; train_gene_expr_recon_loss: 1787380.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5246785.5000; train_optim_loss: 5246785.5000; val_kl_reg_loss: 504.6597; val_edge_recon_loss: 4059752.0000; val_gene_expr_recon_loss: 1588969.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5649226.0000; val_optim_loss: 5649226.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8936; val_auprc_score: 0.8867; val_best_acc_score: 0.6337; val_best_f1_score: 0.7319; train_kl_reg_loss: 562.4804; train_edge_recon_loss: 3458418.2500; train_gene_expr_recon_loss: 1783397.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5242378.5000; train_optim_loss: 5242378.5000; val_kl_reg_loss: 698.1038; val_edge_recon_loss: 4058703.7500; val_gene_expr_recon_loss: 1587249.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5646651.0000; val_optim_loss: 5646651.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8838; val_auprc_score: 0.8690; val_best_acc_score: 0.6831; val_best_f1_score: 0.7594; train_kl_reg_loss: 809.7693; train_edge_recon_loss: 3461304.0000; train_gene_expr_recon_loss: 1783220.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5245334.0000; train_optim_loss: 5245334.0000; val_kl_reg_loss: 813.3012; val_edge_recon_loss: 4055630.7500; val_gene_expr_recon_loss: 1589180.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5645624.5000; val_optim_loss: 5645624.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8404; val_auprc_score: 0.8191; val_best_acc_score: 0.7035; val_best_f1_score: 0.7703; train_kl_reg_loss: 945.0979; train_edge_recon_loss: 3462092.2500; train_gene_expr_recon_loss: 1781116.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5244154.0000; train_optim_loss: 5244154.0000; val_kl_reg_loss: 819.4819; val_edge_recon_loss: 4050050.7500; val_gene_expr_recon_loss: 1586107.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5636977.0000; val_optim_loss: 5636977.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8713; val_auprc_score: 0.8690; val_best_acc_score: 0.7384; val_best_f1_score: 0.7917; train_kl_reg_loss: 971.1152; train_edge_recon_loss: 3457121.7500; train_gene_expr_recon_loss: 1777896.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5235989.0000; train_optim_loss: 5235989.0000; val_kl_reg_loss: 817.4488; val_edge_recon_loss: 4048619.7500; val_gene_expr_recon_loss: 1592866.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5642303.5000; val_optim_loss: 5642303.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9153
val AUPRC score: 0.8484
val best accuracy score: 0.8140
val best F1 score: 0.8273
val target rna MSE score: 0.0110
val source rna MSE score: 0.0036
Duration of model training in run 4: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 1549
Number of validation edges: 172
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9616; val_auprc_score: 0.9311; val_best_acc_score: 0.8779; val_best_f1_score: 0.8747; train_kl_reg_loss: 2.1725; train_edge_recon_loss: 3468176.7500; train_gene_expr_recon_loss: 1807809.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5275988.0000; train_optim_loss: 5275988.0000; val_kl_reg_loss: 10.8090; val_edge_recon_loss: 3941041.7500; val_gene_expr_recon_loss: 1783163.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5724216.0000; val_optim_loss: 5724216.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9562; val_auprc_score: 0.9314; val_best_acc_score: 0.7674; val_best_f1_score: 0.7872; train_kl_reg_loss: 10.4967; train_edge_recon_loss: 3464842.7500; train_gene_expr_recon_loss: 1788940.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5253794.0000; train_optim_loss: 5253794.0000; val_kl_reg_loss: 43.8306; val_edge_recon_loss: 4014425.5000; val_gene_expr_recon_loss: 1778499.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5792968.5000; val_optim_loss: 5792968.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9456; val_auprc_score: 0.9213; val_best_acc_score: 0.8663; val_best_f1_score: 0.8663; train_kl_reg_loss: 43.3730; train_edge_recon_loss: 3466785.5000; train_gene_expr_recon_loss: 1778791.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5245620.0000; train_optim_loss: 5245620.0000; val_kl_reg_loss: 123.3807; val_edge_recon_loss: 4042633.5000; val_gene_expr_recon_loss: 1778864.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5821621.0000; val_optim_loss: 5821621.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9188; val_auprc_score: 0.8878; val_best_acc_score: 0.7587; val_best_f1_score: 0.8047; train_kl_reg_loss: 120.6729; train_edge_recon_loss: 3462474.7500; train_gene_expr_recon_loss: 1773645.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5236241.0000; train_optim_loss: 5236241.0000; val_kl_reg_loss: 277.8890; val_edge_recon_loss: 4052895.0000; val_gene_expr_recon_loss: 1790059.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5843233.0000; val_optim_loss: 5843233.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9265; val_auprc_score: 0.9112; val_best_acc_score: 0.6831; val_best_f1_score: 0.7583; train_kl_reg_loss: 263.0473; train_edge_recon_loss: 3459708.5000; train_gene_expr_recon_loss: 1769862.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5229833.5000; train_optim_loss: 5229833.5000; val_kl_reg_loss: 493.5828; val_edge_recon_loss: 4055247.5000; val_gene_expr_recon_loss: 1771628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5827369.0000; val_optim_loss: 5827369.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9258; val_auprc_score: 0.8912; val_best_acc_score: 0.6453; val_best_f1_score: 0.7371; train_kl_reg_loss: 467.9227; train_edge_recon_loss: 3458111.5000; train_gene_expr_recon_loss: 1766097.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5224677.0000; train_optim_loss: 5224677.0000; val_kl_reg_loss: 743.2485; val_edge_recon_loss: 4057189.5000; val_gene_expr_recon_loss: 1774067.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5832000.5000; val_optim_loss: 5832000.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9031; val_auprc_score: 0.8664; val_best_acc_score: 0.6773; val_best_f1_score: 0.7550; train_kl_reg_loss: 713.4577; train_edge_recon_loss: 3464820.0000; train_gene_expr_recon_loss: 1764958.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5230492.0000; train_optim_loss: 5230492.0000; val_kl_reg_loss: 886.3941; val_edge_recon_loss: 4053764.2500; val_gene_expr_recon_loss: 1768348.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5822999.5000; val_optim_loss: 5822999.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8854; val_auprc_score: 0.8414; val_best_acc_score: 0.7238; val_best_f1_score: 0.7806; train_kl_reg_loss: 854.6683; train_edge_recon_loss: 3464332.2500; train_gene_expr_recon_loss: 1762012.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5227199.0000; train_optim_loss: 5227199.0000; val_kl_reg_loss: 940.4996; val_edge_recon_loss: 4045341.2500; val_gene_expr_recon_loss: 1771876.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5818158.0000; val_optim_loss: 5818158.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8828; val_auprc_score: 0.8452; val_best_acc_score: 0.7500; val_best_f1_score: 0.7962; train_kl_reg_loss: 913.1619; train_edge_recon_loss: 3459214.2500; train_gene_expr_recon_loss: 1760102.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5220229.5000; train_optim_loss: 5220229.5000; val_kl_reg_loss: 939.5975; val_edge_recon_loss: 4045048.7500; val_gene_expr_recon_loss: 1768958.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5814946.0000; val_optim_loss: 5814946.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9640
val AUPRC score: 0.9413
val best accuracy score: 0.8808
val best F1 score: 0.8860
val target rna MSE score: 0.0108
val source rna MSE score: 0.0045
Duration of model training in run 3: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 797
Number of validation edges: 88
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8098; val_auprc_score: 0.7939; val_best_acc_score: 0.7500; val_best_f1_score: 0.7609; train_kl_reg_loss: 2.5935; train_edge_recon_loss: 3466532.5000; train_gene_expr_recon_loss: 1787683.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5254218.0000; train_optim_loss: 5254218.0000; val_kl_reg_loss: 12.2306; val_edge_recon_loss: 3923114.7500; val_gene_expr_recon_loss: 1871069.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5794196.0000; val_optim_loss: 5794196.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7811; val_auprc_score: 0.7660; val_best_acc_score: 0.7102; val_best_f1_score: 0.7273; train_kl_reg_loss: 12.2259; train_edge_recon_loss: 3466358.7500; train_gene_expr_recon_loss: 1769586.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5235957.5000; train_optim_loss: 5235957.5000; val_kl_reg_loss: 47.3751; val_edge_recon_loss: 4013281.7500; val_gene_expr_recon_loss: 1869112.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5882441.5000; val_optim_loss: 5882441.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8275; val_auprc_score: 0.8347; val_best_acc_score: 0.6989; val_best_f1_score: 0.6929; train_kl_reg_loss: 46.3591; train_edge_recon_loss: 3465959.7500; train_gene_expr_recon_loss: 1759627.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225633.5000; train_optim_loss: 5225633.5000; val_kl_reg_loss: 127.4798; val_edge_recon_loss: 4038350.0000; val_gene_expr_recon_loss: 1871010.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5909488.0000; val_optim_loss: 5909488.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7934; val_auprc_score: 0.8064; val_best_acc_score: 0.6932; val_best_f1_score: 0.7000; train_kl_reg_loss: 127.5432; train_edge_recon_loss: 3461538.0000; train_gene_expr_recon_loss: 1754740.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5216406.0000; train_optim_loss: 5216406.0000; val_kl_reg_loss: 271.9309; val_edge_recon_loss: 4051965.5000; val_gene_expr_recon_loss: 1865659.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5917897.0000; val_optim_loss: 5917897.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8119; val_auprc_score: 0.8368; val_best_acc_score: 0.7045; val_best_f1_score: 0.7593; train_kl_reg_loss: 267.7587; train_edge_recon_loss: 3458690.0000; train_gene_expr_recon_loss: 1751245.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5210203.0000; train_optim_loss: 5210203.0000; val_kl_reg_loss: 487.5303; val_edge_recon_loss: 4056331.5000; val_gene_expr_recon_loss: 1864526.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5921346.0000; val_optim_loss: 5921346.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8214; val_auprc_score: 0.7907; val_best_acc_score: 0.7102; val_best_f1_score: 0.7692; train_kl_reg_loss: 476.0593; train_edge_recon_loss: 3455289.0000; train_gene_expr_recon_loss: 1747330.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203095.0000; train_optim_loss: 5203095.0000; val_kl_reg_loss: 720.9860; val_edge_recon_loss: 4056591.7500; val_gene_expr_recon_loss: 1861458.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5918771.0000; val_optim_loss: 5918771.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8386; val_auprc_score: 0.8200; val_best_acc_score: 0.6591; val_best_f1_score: 0.7391; train_kl_reg_loss: 701.6011; train_edge_recon_loss: 3458126.2500; train_gene_expr_recon_loss: 1743526.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5202354.0000; train_optim_loss: 5202354.0000; val_kl_reg_loss: 871.6929; val_edge_recon_loss: 4054726.0000; val_gene_expr_recon_loss: 1848996.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5904594.0000; val_optim_loss: 5904594.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7986; val_auprc_score: 0.7557; val_best_acc_score: 0.7216; val_best_f1_score: 0.7700; train_kl_reg_loss: 894.9472; train_edge_recon_loss: 3460459.0000; train_gene_expr_recon_loss: 1741824.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203179.0000; train_optim_loss: 5203179.0000; val_kl_reg_loss: 1016.5874; val_edge_recon_loss: 4049092.2500; val_gene_expr_recon_loss: 1852018.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5902127.5000; val_optim_loss: 5902127.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8321; val_auprc_score: 0.7945; val_best_acc_score: 0.7159; val_best_f1_score: 0.7642; train_kl_reg_loss: 978.4221; train_edge_recon_loss: 3453938.0000; train_gene_expr_recon_loss: 1740041.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5194958.0000; train_optim_loss: 5194958.0000; val_kl_reg_loss: 1026.0089; val_edge_recon_loss: 4045978.2500; val_gene_expr_recon_loss: 1858257.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5905262.0000; val_optim_loss: 5905262.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.8670
val AUPRC score: 0.8818
val best accuracy score: 0.8068
val best F1 score: 0.8046
val target rna MSE score: 0.0120
val source rna MSE score: 0.0042
Duration of model training in run 2: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 797
Number of validation edges: 88
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7837; val_auprc_score: 0.8190; val_best_acc_score: 0.7330; val_best_f1_score: 0.7064; train_kl_reg_loss: 2.6083; train_edge_recon_loss: 3465212.0000; train_gene_expr_recon_loss: 1798322.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5263537.0000; train_optim_loss: 5263537.0000; val_kl_reg_loss: 11.0390; val_edge_recon_loss: 3929296.5000; val_gene_expr_recon_loss: 1779434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5708741.5000; val_optim_loss: 5708741.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8302; val_auprc_score: 0.8339; val_best_acc_score: 0.7670; val_best_f1_score: 0.7684; train_kl_reg_loss: 11.3320; train_edge_recon_loss: 3466098.2500; train_gene_expr_recon_loss: 1779699.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5245809.0000; train_optim_loss: 5245809.0000; val_kl_reg_loss: 42.7436; val_edge_recon_loss: 4004027.7500; val_gene_expr_recon_loss: 1779210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5783280.5000; val_optim_loss: 5783280.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7969; val_auprc_score: 0.7586; val_best_acc_score: 0.6761; val_best_f1_score: 0.6984; train_kl_reg_loss: 44.1259; train_edge_recon_loss: 3465744.0000; train_gene_expr_recon_loss: 1770243.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5236031.0000; train_optim_loss: 5236031.0000; val_kl_reg_loss: 117.5866; val_edge_recon_loss: 4038776.2500; val_gene_expr_recon_loss: 1780952.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5819846.0000; val_optim_loss: 5819846.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8320; val_auprc_score: 0.8055; val_best_acc_score: 0.7898; val_best_f1_score: 0.7836; train_kl_reg_loss: 121.1109; train_edge_recon_loss: 3457065.7500; train_gene_expr_recon_loss: 1765282.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5222469.0000; train_optim_loss: 5222469.0000; val_kl_reg_loss: 243.4790; val_edge_recon_loss: 4050453.0000; val_gene_expr_recon_loss: 1780691.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5831388.0000; val_optim_loss: 5831388.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8144; val_auprc_score: 0.8204; val_best_acc_score: 0.6989; val_best_f1_score: 0.7488; train_kl_reg_loss: 261.0304; train_edge_recon_loss: 3452398.2500; train_gene_expr_recon_loss: 1761511.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5214170.5000; train_optim_loss: 5214170.5000; val_kl_reg_loss: 470.3619; val_edge_recon_loss: 4054448.0000; val_gene_expr_recon_loss: 1782437.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5837356.0000; val_optim_loss: 5837356.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8241; val_auprc_score: 0.7913; val_best_acc_score: 0.7045; val_best_f1_score: 0.7615; train_kl_reg_loss: 480.5384; train_edge_recon_loss: 3452358.2500; train_gene_expr_recon_loss: 1757466.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5210305.0000; train_optim_loss: 5210305.0000; val_kl_reg_loss: 701.9507; val_edge_recon_loss: 4055298.2500; val_gene_expr_recon_loss: 1776163.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5832164.0000; val_optim_loss: 5832164.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7893; val_auprc_score: 0.7606; val_best_acc_score: 0.6477; val_best_f1_score: 0.7304; train_kl_reg_loss: 739.4055; train_edge_recon_loss: 3458538.0000; train_gene_expr_recon_loss: 1754784.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5214061.5000; train_optim_loss: 5214061.5000; val_kl_reg_loss: 870.3121; val_edge_recon_loss: 4057125.7500; val_gene_expr_recon_loss: 1775265.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5833261.5000; val_optim_loss: 5833261.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8297; val_auprc_score: 0.8421; val_best_acc_score: 0.6761; val_best_f1_score: 0.7324; train_kl_reg_loss: 937.3327; train_edge_recon_loss: 3463207.5000; train_gene_expr_recon_loss: 1753009.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5217154.5000; train_optim_loss: 5217154.5000; val_kl_reg_loss: 924.5226; val_edge_recon_loss: 4052887.0000; val_gene_expr_recon_loss: 1778361.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5832173.0000; val_optim_loss: 5832173.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8481; val_auprc_score: 0.8494; val_best_acc_score: 0.7273; val_best_f1_score: 0.7624; train_kl_reg_loss: 989.3651; train_edge_recon_loss: 3453247.7500; train_gene_expr_recon_loss: 1750784.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205021.0000; train_optim_loss: 5205021.0000; val_kl_reg_loss: 914.9916; val_edge_recon_loss: 4046536.5000; val_gene_expr_recon_loss: 1776794.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5824246.5000; val_optim_loss: 5824246.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.8050
val AUPRC score: 0.8023
val best accuracy score: 0.7386
val best F1 score: 0.7404
val target rna MSE score: 0.0119
val source rna MSE score: 0.0051
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
