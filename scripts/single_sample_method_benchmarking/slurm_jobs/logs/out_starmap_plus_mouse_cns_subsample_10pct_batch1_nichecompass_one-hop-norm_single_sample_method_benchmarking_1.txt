Run timestamp: 15062023_155642.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_10pct_batch1', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 19618
Number of validation edges: 2179
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7749; val_auprc_score: 0.8096; val_best_acc_score: 0.6749; val_best_f1_score: 0.7075; train_kl_reg_loss: 134.9340; train_edge_recon_loss: 346092.8063; train_gene_expr_recon_loss: 176551.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 522779.4125; train_optim_loss: 522779.4125; val_kl_reg_loss: 248.2109; val_edge_recon_loss: 394399.5625; val_gene_expr_recon_loss: 151320.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 545968.5000; val_optim_loss: 545968.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7722; val_auprc_score: 0.7962; val_best_acc_score: 0.7040; val_best_f1_score: 0.7122; train_kl_reg_loss: 188.1629; train_edge_recon_loss: 344673.1625; train_gene_expr_recon_loss: 149404.1125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494265.4375; train_optim_loss: 494265.4375; val_kl_reg_loss: 178.8840; val_edge_recon_loss: 350923.8438; val_gene_expr_recon_loss: 151922.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 503025.0312; val_optim_loss: 503025.0312
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7571; val_auprc_score: 0.7719; val_best_acc_score: 0.6868; val_best_f1_score: 0.7081; train_kl_reg_loss: 314.4063; train_edge_recon_loss: 337821.3875; train_gene_expr_recon_loss: 145920.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484056.5938; train_optim_loss: 484056.5938; val_kl_reg_loss: 624.5573; val_edge_recon_loss: 323257.9062; val_gene_expr_recon_loss: 148941.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472823.4688; val_optim_loss: 472823.4688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7463; val_auprc_score: 0.7595; val_best_acc_score: 0.6771; val_best_f1_score: 0.7047; train_kl_reg_loss: 1393.9196; train_edge_recon_loss: 314955.0563; train_gene_expr_recon_loss: 146860.8844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463209.8563; train_optim_loss: 463209.8563; val_kl_reg_loss: 2946.8286; val_edge_recon_loss: 319023.6250; val_gene_expr_recon_loss: 146690.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468660.5938; val_optim_loss: 468660.5938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7951; val_auprc_score: 0.8047; val_best_acc_score: 0.7113; val_best_f1_score: 0.7331; train_kl_reg_loss: 4086.1267; train_edge_recon_loss: 296564.6625; train_gene_expr_recon_loss: 147617.4594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448268.2438; train_optim_loss: 448268.2438; val_kl_reg_loss: 5347.4131; val_edge_recon_loss: 301241.4688; val_gene_expr_recon_loss: 146069.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452658.1250; val_optim_loss: 452658.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8657; val_auprc_score: 0.8603; val_best_acc_score: 0.7914; val_best_f1_score: 0.7984; train_kl_reg_loss: 5898.8270; train_edge_recon_loss: 281910.8187; train_gene_expr_recon_loss: 145892.6781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433702.3250; train_optim_loss: 433702.3250; val_kl_reg_loss: 6061.5947; val_edge_recon_loss: 284409.8125; val_gene_expr_recon_loss: 145312.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435783.5000; val_optim_loss: 435783.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9164; val_auprc_score: 0.9050; val_best_acc_score: 0.8401; val_best_f1_score: 0.8470; train_kl_reg_loss: 5996.7448; train_edge_recon_loss: 272172.8312; train_gene_expr_recon_loss: 142603.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420773.1500; train_optim_loss: 420773.1500; val_kl_reg_loss: 5622.0840; val_edge_recon_loss: 274418.4688; val_gene_expr_recon_loss: 144923.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424964.4688; val_optim_loss: 424964.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9297; val_auprc_score: 0.9134; val_best_acc_score: 0.8653; val_best_f1_score: 0.8699; train_kl_reg_loss: 5378.0409; train_edge_recon_loss: 267926.1000; train_gene_expr_recon_loss: 143142.1906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416446.3375; train_optim_loss: 416446.3375; val_kl_reg_loss: 4891.8091; val_edge_recon_loss: 271179.6875; val_gene_expr_recon_loss: 144585.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420657.5000; val_optim_loss: 420657.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9355; val_auprc_score: 0.9209; val_best_acc_score: 0.8722; val_best_f1_score: 0.8788; train_kl_reg_loss: 4780.9331; train_edge_recon_loss: 268357.8875; train_gene_expr_recon_loss: 143732.1656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416870.9688; train_optim_loss: 416870.9688; val_kl_reg_loss: 4402.0830; val_edge_recon_loss: 269411.1250; val_gene_expr_recon_loss: 144242.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418055.9375; val_optim_loss: 418055.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9387; val_auprc_score: 0.9157; val_best_acc_score: 0.8807; val_best_f1_score: 0.8874; train_kl_reg_loss: 4364.9720; train_edge_recon_loss: 266498.3812; train_gene_expr_recon_loss: 142817.4281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413680.7875; train_optim_loss: 413680.7875; val_kl_reg_loss: 4206.8862; val_edge_recon_loss: 267504.8750; val_gene_expr_recon_loss: 144004.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415716.5312; val_optim_loss: 415716.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9369; val_auprc_score: 0.9187; val_best_acc_score: 0.8768; val_best_f1_score: 0.8840; train_kl_reg_loss: 4282.1233; train_edge_recon_loss: 267220.8375; train_gene_expr_recon_loss: 141676.9719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413179.9250; train_optim_loss: 413179.9250; val_kl_reg_loss: 4169.1597; val_edge_recon_loss: 267509.0938; val_gene_expr_recon_loss: 143853.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415531.6875; val_optim_loss: 415531.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9412; val_auprc_score: 0.9246; val_best_acc_score: 0.8827; val_best_f1_score: 0.8888; train_kl_reg_loss: 4219.6335; train_edge_recon_loss: 265966.6688; train_gene_expr_recon_loss: 140618.9937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410805.2938; train_optim_loss: 410805.2938; val_kl_reg_loss: 4154.3633; val_edge_recon_loss: 268475.9688; val_gene_expr_recon_loss: 143577.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416207.5625; val_optim_loss: 416207.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9431; val_auprc_score: 0.9270; val_best_acc_score: 0.8894; val_best_f1_score: 0.8940; train_kl_reg_loss: 4247.6351; train_edge_recon_loss: 265877.9437; train_gene_expr_recon_loss: 136881.5094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407007.0875; train_optim_loss: 407007.0875; val_kl_reg_loss: 4140.0103; val_edge_recon_loss: 268696.6562; val_gene_expr_recon_loss: 143251.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416088.5000; val_optim_loss: 416088.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9415; val_auprc_score: 0.9254; val_best_acc_score: 0.8837; val_best_f1_score: 0.8889; train_kl_reg_loss: 4135.1719; train_edge_recon_loss: 265200.3375; train_gene_expr_recon_loss: 140006.1219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409341.6375; train_optim_loss: 409341.6375; val_kl_reg_loss: 4044.2683; val_edge_recon_loss: 269363.5938; val_gene_expr_recon_loss: 143016.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416424.4375; val_optim_loss: 416424.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9417; val_auprc_score: 0.9268; val_best_acc_score: 0.8811; val_best_f1_score: 0.8878; train_kl_reg_loss: 4085.0673; train_edge_recon_loss: 265858.2875; train_gene_expr_recon_loss: 142777.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412720.3875; train_optim_loss: 412720.3875; val_kl_reg_loss: 4023.1423; val_edge_recon_loss: 270048.9062; val_gene_expr_recon_loss: 142829.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416901.2500; val_optim_loss: 416901.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9423; val_auprc_score: 0.9265; val_best_acc_score: 0.8850; val_best_f1_score: 0.8916; train_kl_reg_loss: 4084.0548; train_edge_recon_loss: 265300.7625; train_gene_expr_recon_loss: 142082.2906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411467.1250; train_optim_loss: 411467.1250; val_kl_reg_loss: 4016.9226; val_edge_recon_loss: 266746.7812; val_gene_expr_recon_loss: 142534.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413297.8125; val_optim_loss: 413297.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9461; val_auprc_score: 0.9342; val_best_acc_score: 0.8892; val_best_f1_score: 0.8940; train_kl_reg_loss: 4007.8749; train_edge_recon_loss: 266402.2250; train_gene_expr_recon_loss: 140805.8563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411215.9562; train_optim_loss: 411215.9562; val_kl_reg_loss: 3990.9631; val_edge_recon_loss: 266616.2500; val_gene_expr_recon_loss: 142335.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412942.3750; val_optim_loss: 412942.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9387; val_auprc_score: 0.9215; val_best_acc_score: 0.8830; val_best_f1_score: 0.8888; train_kl_reg_loss: 4002.6859; train_edge_recon_loss: 265021.1500; train_gene_expr_recon_loss: 139300.9813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408324.8187; train_optim_loss: 408324.8187; val_kl_reg_loss: 3995.2822; val_edge_recon_loss: 268058.3438; val_gene_expr_recon_loss: 142244.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414298.4375; val_optim_loss: 414298.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9431; val_auprc_score: 0.9297; val_best_acc_score: 0.8830; val_best_f1_score: 0.8895; train_kl_reg_loss: 3988.4495; train_edge_recon_loss: 264924.6937; train_gene_expr_recon_loss: 140540.3875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409453.5312; train_optim_loss: 409453.5312; val_kl_reg_loss: 3974.1201; val_edge_recon_loss: 267580.5312; val_gene_expr_recon_loss: 142198.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413753.3125; val_optim_loss: 413753.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9426; val_auprc_score: 0.9214; val_best_acc_score: 0.8857; val_best_f1_score: 0.8899; train_kl_reg_loss: 4055.3704; train_edge_recon_loss: 264744.8937; train_gene_expr_recon_loss: 135439.0375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404239.3000; train_optim_loss: 404239.3000; val_kl_reg_loss: 3980.1924; val_edge_recon_loss: 267844.6562; val_gene_expr_recon_loss: 142171.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413996.2812; val_optim_loss: 413996.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9412; val_auprc_score: 0.9208; val_best_acc_score: 0.8804; val_best_f1_score: 0.8868; train_kl_reg_loss: 4067.8676; train_edge_recon_loss: 265665.9250; train_gene_expr_recon_loss: 142715.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412448.9813; train_optim_loss: 412448.9813; val_kl_reg_loss: 3962.5100; val_edge_recon_loss: 269031.2188; val_gene_expr_recon_loss: 142166.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415159.9375; val_optim_loss: 415159.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9412; val_auprc_score: 0.9185; val_best_acc_score: 0.8862; val_best_f1_score: 0.8908; train_kl_reg_loss: 4070.7637; train_edge_recon_loss: 265424.1562; train_gene_expr_recon_loss: 142055.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411549.9938; train_optim_loss: 411549.9938; val_kl_reg_loss: 3982.1226; val_edge_recon_loss: 269027.6875; val_gene_expr_recon_loss: 142156.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415166.6562; val_optim_loss: 415166.6562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9446; val_auprc_score: 0.9316; val_best_acc_score: 0.8846; val_best_f1_score: 0.8912; train_kl_reg_loss: 3998.9010; train_edge_recon_loss: 265040.1813; train_gene_expr_recon_loss: 137340.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406379.8375; train_optim_loss: 406379.8375; val_kl_reg_loss: 3976.8887; val_edge_recon_loss: 268024.3125; val_gene_expr_recon_loss: 142144.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414145.9375; val_optim_loss: 414145.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9426
Val AUPRC score: 0.9226
Val best accuracy score: 0.8866
Val best F1 score: 0.8934
Val gene expr MSE score: 0.9297
Duration of model training in run 1: 0 hours, 0 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 19618
Number of validation edges: 2179
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7915; val_auprc_score: 0.8220; val_best_acc_score: 0.7090; val_best_f1_score: 0.7100; train_kl_reg_loss: 132.7982; train_edge_recon_loss: 346043.5625; train_gene_expr_recon_loss: 176213.9031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 522390.2750; train_optim_loss: 522390.2750; val_kl_reg_loss: 235.8425; val_edge_recon_loss: 393304.9375; val_gene_expr_recon_loss: 149676.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 543217.2500; val_optim_loss: 543217.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7758; val_auprc_score: 0.7992; val_best_acc_score: 0.7042; val_best_f1_score: 0.7113; train_kl_reg_loss: 195.2106; train_edge_recon_loss: 344307.1063; train_gene_expr_recon_loss: 151535.5531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496037.8750; train_optim_loss: 496037.8750; val_kl_reg_loss: 208.7221; val_edge_recon_loss: 348834.7500; val_gene_expr_recon_loss: 149889.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498932.6562; val_optim_loss: 498932.6562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7542; val_auprc_score: 0.7692; val_best_acc_score: 0.6941; val_best_f1_score: 0.7028; train_kl_reg_loss: 395.3724; train_edge_recon_loss: 335536.7062; train_gene_expr_recon_loss: 147472.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483404.1937; train_optim_loss: 483404.1937; val_kl_reg_loss: 785.3224; val_edge_recon_loss: 321870.2500; val_gene_expr_recon_loss: 147300.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469956.4062; val_optim_loss: 469956.4062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7463; val_auprc_score: 0.7535; val_best_acc_score: 0.6737; val_best_f1_score: 0.7077; train_kl_reg_loss: 1708.3729; train_edge_recon_loss: 310588.4500; train_gene_expr_recon_loss: 151226.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463523.6000; train_optim_loss: 463523.6000; val_kl_reg_loss: 3265.7793; val_edge_recon_loss: 315924.2188; val_gene_expr_recon_loss: 145309.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464499.6250; val_optim_loss: 464499.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8053; val_auprc_score: 0.8073; val_best_acc_score: 0.7304; val_best_f1_score: 0.7454; train_kl_reg_loss: 4337.4919; train_edge_recon_loss: 291932.2125; train_gene_expr_recon_loss: 143706.8188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439976.5312; train_optim_loss: 439976.5312; val_kl_reg_loss: 5518.8818; val_edge_recon_loss: 298793.7812; val_gene_expr_recon_loss: 144289.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448601.6562; val_optim_loss: 448601.6562
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8596; val_auprc_score: 0.8485; val_best_acc_score: 0.7754; val_best_f1_score: 0.7924; train_kl_reg_loss: 5944.7766; train_edge_recon_loss: 278587.7125; train_gene_expr_recon_loss: 141466.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425999.2625; train_optim_loss: 425999.2625; val_kl_reg_loss: 6192.1230; val_edge_recon_loss: 285386.4375; val_gene_expr_recon_loss: 143394.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434972.6875; val_optim_loss: 434972.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8924; val_auprc_score: 0.8770; val_best_acc_score: 0.8107; val_best_f1_score: 0.8221; train_kl_reg_loss: 6236.5689; train_edge_recon_loss: 272069.5375; train_gene_expr_recon_loss: 146078.2719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424384.3688; train_optim_loss: 424384.3688; val_kl_reg_loss: 5806.6865; val_edge_recon_loss: 278603.6875; val_gene_expr_recon_loss: 143049.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427460.1250; val_optim_loss: 427460.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9131; val_auprc_score: 0.9016; val_best_acc_score: 0.8348; val_best_f1_score: 0.8435; train_kl_reg_loss: 5627.7748; train_edge_recon_loss: 269940.5000; train_gene_expr_recon_loss: 143369.1437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418937.4125; train_optim_loss: 418937.4125; val_kl_reg_loss: 5001.5049; val_edge_recon_loss: 273848.7500; val_gene_expr_recon_loss: 142786.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421636.4375; val_optim_loss: 421636.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9269; val_auprc_score: 0.9083; val_best_acc_score: 0.8593; val_best_f1_score: 0.8642; train_kl_reg_loss: 4777.1065; train_edge_recon_loss: 269134.3000; train_gene_expr_recon_loss: 140924.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414835.4313; train_optim_loss: 414835.4313; val_kl_reg_loss: 4366.8550; val_edge_recon_loss: 269455.7812; val_gene_expr_recon_loss: 142572.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416395.0312; val_optim_loss: 416395.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9370; val_auprc_score: 0.9181; val_best_acc_score: 0.8701; val_best_f1_score: 0.8759; train_kl_reg_loss: 4402.9166; train_edge_recon_loss: 268097.8063; train_gene_expr_recon_loss: 144098.5375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416599.2500; train_optim_loss: 416599.2500; val_kl_reg_loss: 4089.7339; val_edge_recon_loss: 267214.2812; val_gene_expr_recon_loss: 142186.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413490.5000; val_optim_loss: 413490.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9364; val_auprc_score: 0.9206; val_best_acc_score: 0.8722; val_best_f1_score: 0.8799; train_kl_reg_loss: 4087.8338; train_edge_recon_loss: 266562.9750; train_gene_expr_recon_loss: 139474.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410125.3625; train_optim_loss: 410125.3625; val_kl_reg_loss: 4092.8203; val_edge_recon_loss: 270123.2500; val_gene_expr_recon_loss: 141985.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416201.8750; val_optim_loss: 416201.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9366; val_auprc_score: 0.9213; val_best_acc_score: 0.8800; val_best_f1_score: 0.8851; train_kl_reg_loss: 4196.2050; train_edge_recon_loss: 265397.9562; train_gene_expr_recon_loss: 143484.1344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413078.2875; train_optim_loss: 413078.2875; val_kl_reg_loss: 4145.6133; val_edge_recon_loss: 269127.7500; val_gene_expr_recon_loss: 141799.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415072.5000; val_optim_loss: 415072.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9398; val_auprc_score: 0.9229; val_best_acc_score: 0.8832; val_best_f1_score: 0.8882; train_kl_reg_loss: 4235.2209; train_edge_recon_loss: 267007.4062; train_gene_expr_recon_loss: 142684.0719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413926.7000; train_optim_loss: 413926.7000; val_kl_reg_loss: 4105.2100; val_edge_recon_loss: 267419.6875; val_gene_expr_recon_loss: 141693.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413217.9375; val_optim_loss: 413217.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9382; val_auprc_score: 0.9230; val_best_acc_score: 0.8793; val_best_f1_score: 0.8850; train_kl_reg_loss: 4185.5747; train_edge_recon_loss: 266672.7000; train_gene_expr_recon_loss: 143369.0219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414227.3000; train_optim_loss: 414227.3000; val_kl_reg_loss: 3973.2554; val_edge_recon_loss: 268156.0625; val_gene_expr_recon_loss: 141499.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413628.9688; val_optim_loss: 413628.9688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9440; val_auprc_score: 0.9290; val_best_acc_score: 0.8848; val_best_f1_score: 0.8901; train_kl_reg_loss: 4067.2955; train_edge_recon_loss: 266038.5250; train_gene_expr_recon_loss: 141246.7281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411352.5438; train_optim_loss: 411352.5438; val_kl_reg_loss: 3898.3525; val_edge_recon_loss: 266136.5938; val_gene_expr_recon_loss: 141291.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411326.4062; val_optim_loss: 411326.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9400; val_auprc_score: 0.9241; val_best_acc_score: 0.8791; val_best_f1_score: 0.8855; train_kl_reg_loss: 3942.0934; train_edge_recon_loss: 265996.1688; train_gene_expr_recon_loss: 140208.1781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410146.4313; train_optim_loss: 410146.4313; val_kl_reg_loss: 3849.9780; val_edge_recon_loss: 268161.7812; val_gene_expr_recon_loss: 141036.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413048.2188; val_optim_loss: 413048.2188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9389; val_auprc_score: 0.9147; val_best_acc_score: 0.8793; val_best_f1_score: 0.8859; train_kl_reg_loss: 3960.9538; train_edge_recon_loss: 264852.0500; train_gene_expr_recon_loss: 140022.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408835.5000; train_optim_loss: 408835.5000; val_kl_reg_loss: 3847.4438; val_edge_recon_loss: 267837.3125; val_gene_expr_recon_loss: 140818.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412503.0000; val_optim_loss: 412503.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9451; val_auprc_score: 0.9284; val_best_acc_score: 0.8871; val_best_f1_score: 0.8936; train_kl_reg_loss: 3908.3099; train_edge_recon_loss: 266169.5875; train_gene_expr_recon_loss: 140226.1625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410304.0500; train_optim_loss: 410304.0500; val_kl_reg_loss: 3799.2458; val_edge_recon_loss: 267488.3438; val_gene_expr_recon_loss: 140726.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412014.4375; val_optim_loss: 412014.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9443; val_auprc_score: 0.9300; val_best_acc_score: 0.8844; val_best_f1_score: 0.8908; train_kl_reg_loss: 3896.8804; train_edge_recon_loss: 264180.1312; train_gene_expr_recon_loss: 138026.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406103.5000; train_optim_loss: 406103.5000; val_kl_reg_loss: 3811.9902; val_edge_recon_loss: 268674.5312; val_gene_expr_recon_loss: 140544.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413031.2500; val_optim_loss: 413031.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9385; val_auprc_score: 0.9169; val_best_acc_score: 0.8837; val_best_f1_score: 0.8898; train_kl_reg_loss: 3936.1353; train_edge_recon_loss: 264344.4562; train_gene_expr_recon_loss: 140593.7563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408874.3563; train_optim_loss: 408874.3563; val_kl_reg_loss: 3793.2852; val_edge_recon_loss: 268614.9062; val_gene_expr_recon_loss: 140236.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412644.9375; val_optim_loss: 412644.9375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9447; val_auprc_score: 0.9286; val_best_acc_score: 0.8834; val_best_f1_score: 0.8896; train_kl_reg_loss: 3929.6001; train_edge_recon_loss: 264959.7750; train_gene_expr_recon_loss: 136951.7281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405841.0938; train_optim_loss: 405841.0938; val_kl_reg_loss: 3786.1560; val_edge_recon_loss: 268361.2500; val_gene_expr_recon_loss: 140029.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412177.2188; val_optim_loss: 412177.2188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 19 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9391
Val AUPRC score: 0.9227
Val best accuracy score: 0.8823
Val best F1 score: 0.8872
Val gene expr MSE score: 1.0142
Duration of model training in run 2: 0 hours, 0 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 37672
Number of validation edges: 4185
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7898; val_auprc_score: 0.8022; val_best_acc_score: 0.7121; val_best_f1_score: 0.7231; train_kl_reg_loss: 215.6718; train_edge_recon_loss: 342568.8750; train_gene_expr_recon_loss: 154670.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497454.7582; train_optim_loss: 497454.7582; val_kl_reg_loss: 725.0808; val_edge_recon_loss: 318711.0521; val_gene_expr_recon_loss: 148341.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467777.6979; val_optim_loss: 467777.6979
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9172; val_auprc_score: 0.9049; val_best_acc_score: 0.8407; val_best_f1_score: 0.8460; train_kl_reg_loss: 3885.7492; train_edge_recon_loss: 292502.6974; train_gene_expr_recon_loss: 142823.8392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439212.2829; train_optim_loss: 439212.2829; val_kl_reg_loss: 5353.3903; val_edge_recon_loss: 275844.0000; val_gene_expr_recon_loss: 145605.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426802.8021; val_optim_loss: 426802.8021
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9533; val_auprc_score: 0.9393; val_best_acc_score: 0.8965; val_best_f1_score: 0.8997; train_kl_reg_loss: 4517.6464; train_edge_recon_loss: 268636.0214; train_gene_expr_recon_loss: 142235.5189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415389.1842; train_optim_loss: 415389.1842; val_kl_reg_loss: 3850.4036; val_edge_recon_loss: 266274.2917; val_gene_expr_recon_loss: 144576.9740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414701.6771; val_optim_loss: 414701.6771
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9568; val_auprc_score: 0.9401; val_best_acc_score: 0.9027; val_best_f1_score: 0.9058; train_kl_reg_loss: 3958.1843; train_edge_recon_loss: 266487.3651; train_gene_expr_recon_loss: 141166.0502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411611.5954; train_optim_loss: 411611.5954; val_kl_reg_loss: 3867.8258; val_edge_recon_loss: 262636.2135; val_gene_expr_recon_loss: 144699.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411203.8542; val_optim_loss: 411203.8542
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9546; val_auprc_score: 0.9358; val_best_acc_score: 0.8992; val_best_f1_score: 0.9029; train_kl_reg_loss: 3815.1947; train_edge_recon_loss: 265605.6414; train_gene_expr_recon_loss: 142057.5033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411478.3438; train_optim_loss: 411478.3438; val_kl_reg_loss: 3764.9649; val_edge_recon_loss: 269718.4271; val_gene_expr_recon_loss: 144373.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417857.0208; val_optim_loss: 417857.0208
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9624; val_auprc_score: 0.9466; val_best_acc_score: 0.9117; val_best_f1_score: 0.9153; train_kl_reg_loss: 3734.1113; train_edge_recon_loss: 264897.7451; train_gene_expr_recon_loss: 141115.3503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409747.2039; train_optim_loss: 409747.2039; val_kl_reg_loss: 3680.1056; val_edge_recon_loss: 263404.7552; val_gene_expr_recon_loss: 142985.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410070.4375; val_optim_loss: 410070.4375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9660; val_auprc_score: 0.9516; val_best_acc_score: 0.9197; val_best_f1_score: 0.9220; train_kl_reg_loss: 3759.7192; train_edge_recon_loss: 263706.6965; train_gene_expr_recon_loss: 139058.3845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406524.8010; train_optim_loss: 406524.8010; val_kl_reg_loss: 3554.0029; val_edge_recon_loss: 261784.3281; val_gene_expr_recon_loss: 141747.4323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407085.7708; val_optim_loss: 407085.7708
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9670; val_auprc_score: 0.9511; val_best_acc_score: 0.9161; val_best_f1_score: 0.9201; train_kl_reg_loss: 3677.3130; train_edge_recon_loss: 263531.0025; train_gene_expr_recon_loss: 138804.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406012.7401; train_optim_loss: 406012.7401; val_kl_reg_loss: 3587.7884; val_edge_recon_loss: 269031.7083; val_gene_expr_recon_loss: 141850.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414469.7083; val_optim_loss: 414469.7083
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9722; val_auprc_score: 0.9635; val_best_acc_score: 0.9244; val_best_f1_score: 0.9271; train_kl_reg_loss: 3674.0864; train_edge_recon_loss: 262967.9449; train_gene_expr_recon_loss: 138709.0847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405351.1184; train_optim_loss: 405351.1184; val_kl_reg_loss: 3540.1449; val_edge_recon_loss: 260314.9062; val_gene_expr_recon_loss: 141035.2448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404890.3021; val_optim_loss: 404890.3021
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9743; val_auprc_score: 0.9648; val_best_acc_score: 0.9317; val_best_f1_score: 0.9342; train_kl_reg_loss: 3628.3782; train_edge_recon_loss: 262978.0535; train_gene_expr_recon_loss: 138561.3372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405167.7697; train_optim_loss: 405167.7697; val_kl_reg_loss: 3558.3892; val_edge_recon_loss: 258321.2083; val_gene_expr_recon_loss: 142800.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404679.6458; val_optim_loss: 404679.6458
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9742; val_auprc_score: 0.9617; val_best_acc_score: 0.9325; val_best_f1_score: 0.9348; train_kl_reg_loss: 3627.9202; train_edge_recon_loss: 261369.8520; train_gene_expr_recon_loss: 138136.9227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403134.6990; train_optim_loss: 403134.6990; val_kl_reg_loss: 3587.9013; val_edge_recon_loss: 263235.3854; val_gene_expr_recon_loss: 141460.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408283.8333; val_optim_loss: 408283.8333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9767; val_auprc_score: 0.9647; val_best_acc_score: 0.9394; val_best_f1_score: 0.9416; train_kl_reg_loss: 3609.6715; train_edge_recon_loss: 261824.3380; train_gene_expr_recon_loss: 136743.3322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402177.3405; train_optim_loss: 402177.3405; val_kl_reg_loss: 3553.7671; val_edge_recon_loss: 266602.2917; val_gene_expr_recon_loss: 140495.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410651.5104; val_optim_loss: 410651.5104
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9797; val_auprc_score: 0.9711; val_best_acc_score: 0.9449; val_best_f1_score: 0.9461; train_kl_reg_loss: 3593.8701; train_edge_recon_loss: 261007.9342; train_gene_expr_recon_loss: 137060.6275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401662.4309; train_optim_loss: 401662.4309; val_kl_reg_loss: 3586.4384; val_edge_recon_loss: 263652.5208; val_gene_expr_recon_loss: 140271.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407510.7396; val_optim_loss: 407510.7396

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9776; val_auprc_score: 0.9648; val_best_acc_score: 0.9410; val_best_f1_score: 0.9427; train_kl_reg_loss: 3609.9818; train_edge_recon_loss: 260749.5247; train_gene_expr_recon_loss: 136952.3618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401311.8651; train_optim_loss: 401311.8651; val_kl_reg_loss: 3511.7313; val_edge_recon_loss: 259552.4375; val_gene_expr_recon_loss: 138811.2552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401875.4271; val_optim_loss: 401875.4271
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9777; val_auprc_score: 0.9684; val_best_acc_score: 0.9401; val_best_f1_score: 0.9421; train_kl_reg_loss: 3589.0241; train_edge_recon_loss: 260390.0962; train_gene_expr_recon_loss: 137163.7944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401142.9161; train_optim_loss: 401142.9161; val_kl_reg_loss: 3536.8005; val_edge_recon_loss: 260435.8698; val_gene_expr_recon_loss: 139342.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403315.4479; val_optim_loss: 403315.4479
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9785; val_auprc_score: 0.9685; val_best_acc_score: 0.9410; val_best_f1_score: 0.9429; train_kl_reg_loss: 3595.9872; train_edge_recon_loss: 260104.2410; train_gene_expr_recon_loss: 137009.3799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400709.6069; train_optim_loss: 400709.6069; val_kl_reg_loss: 3506.5809; val_edge_recon_loss: 260539.8490; val_gene_expr_recon_loss: 139459.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403506.1562; val_optim_loss: 403506.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9790; val_auprc_score: 0.9676; val_best_acc_score: 0.9446; val_best_f1_score: 0.9462; train_kl_reg_loss: 3583.9655; train_edge_recon_loss: 260100.0979; train_gene_expr_recon_loss: 136834.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400518.8766; train_optim_loss: 400518.8766; val_kl_reg_loss: 3518.0228; val_edge_recon_loss: 262297.6510; val_gene_expr_recon_loss: 139352.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405167.7708; val_optim_loss: 405167.7708

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9777; val_auprc_score: 0.9667; val_best_acc_score: 0.9411; val_best_f1_score: 0.9430; train_kl_reg_loss: 3585.5272; train_edge_recon_loss: 260821.9013; train_gene_expr_recon_loss: 136872.0946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401279.5230; train_optim_loss: 401279.5230; val_kl_reg_loss: 3526.9089; val_edge_recon_loss: 261387.9479; val_gene_expr_recon_loss: 140083.5990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404998.4583; val_optim_loss: 404998.4583
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9801; val_auprc_score: 0.9716; val_best_acc_score: 0.9460; val_best_f1_score: 0.9475; train_kl_reg_loss: 3578.8095; train_edge_recon_loss: 260994.0181; train_gene_expr_recon_loss: 136047.3462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400620.1776; train_optim_loss: 400620.1776; val_kl_reg_loss: 3493.9491; val_edge_recon_loss: 258363.4635; val_gene_expr_recon_loss: 139088.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400946.2188; val_optim_loss: 400946.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9787; val_auprc_score: 0.9698; val_best_acc_score: 0.9406; val_best_f1_score: 0.9426; train_kl_reg_loss: 3573.6267; train_edge_recon_loss: 260644.1891; train_gene_expr_recon_loss: 135792.6324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400010.4474; train_optim_loss: 400010.4474; val_kl_reg_loss: 3522.6920; val_edge_recon_loss: 265515.3958; val_gene_expr_recon_loss: 139842.1510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408880.2500; val_optim_loss: 408880.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9771; val_auprc_score: 0.9656; val_best_acc_score: 0.9434; val_best_f1_score: 0.9451; train_kl_reg_loss: 3573.8706; train_edge_recon_loss: 260313.3257; train_gene_expr_recon_loss: 136110.7549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399997.9457; train_optim_loss: 399997.9457; val_kl_reg_loss: 3526.0509; val_edge_recon_loss: 258737.8594; val_gene_expr_recon_loss: 140606.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402870.7917; val_optim_loss: 402870.7917
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9764; val_auprc_score: 0.9622; val_best_acc_score: 0.9415; val_best_f1_score: 0.9433; train_kl_reg_loss: 3579.5227; train_edge_recon_loss: 261049.4934; train_gene_expr_recon_loss: 136963.5518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401592.5691; train_optim_loss: 401592.5691; val_kl_reg_loss: 3509.5514; val_edge_recon_loss: 259950.4375; val_gene_expr_recon_loss: 139262.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402722.7500; val_optim_loss: 402722.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9806; val_auprc_score: 0.9731; val_best_acc_score: 0.9462; val_best_f1_score: 0.9477; train_kl_reg_loss: 3572.5219; train_edge_recon_loss: 261060.4646; train_gene_expr_recon_loss: 136471.6225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401104.6086; train_optim_loss: 401104.6086; val_kl_reg_loss: 3512.5868; val_edge_recon_loss: 261839.3750; val_gene_expr_recon_loss: 140016.9427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405368.8958; val_optim_loss: 405368.8958
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9760; val_auprc_score: 0.9639; val_best_acc_score: 0.9388; val_best_f1_score: 0.9409; train_kl_reg_loss: 3568.2977; train_edge_recon_loss: 260329.0617; train_gene_expr_recon_loss: 136298.8396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400196.2056; train_optim_loss: 400196.2056; val_kl_reg_loss: 3510.3152; val_edge_recon_loss: 260778.2812; val_gene_expr_recon_loss: 139007.2240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403295.8229; val_optim_loss: 403295.8229
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9772; val_auprc_score: 0.9673; val_best_acc_score: 0.9400; val_best_f1_score: 0.9420; train_kl_reg_loss: 3581.5821; train_edge_recon_loss: 260753.0436; train_gene_expr_recon_loss: 136904.6480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401239.2763; train_optim_loss: 401239.2763; val_kl_reg_loss: 3485.4716; val_edge_recon_loss: 261416.5729; val_gene_expr_recon_loss: 139050.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403952.5312; val_optim_loss: 403952.5312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 49 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9775
Val AUPRC score: 0.9682
Val best accuracy score: 0.9419
Val best F1 score: 0.9437
Val gene expr MSE score: 0.8418
Duration of model training in run 3: 0 hours, 0 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 37672
Number of validation edges: 4185
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7837; val_auprc_score: 0.7973; val_best_acc_score: 0.7097; val_best_f1_score: 0.7158; train_kl_reg_loss: 215.1367; train_edge_recon_loss: 342566.6727; train_gene_expr_recon_loss: 154847.6012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497629.4194; train_optim_loss: 497629.4194; val_kl_reg_loss: 686.3294; val_edge_recon_loss: 320137.3229; val_gene_expr_recon_loss: 144994.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465818.4375; val_optim_loss: 465818.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8995; val_auprc_score: 0.8899; val_best_acc_score: 0.8155; val_best_f1_score: 0.8220; train_kl_reg_loss: 3756.8561; train_edge_recon_loss: 298054.2072; train_gene_expr_recon_loss: 142078.0354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443889.0987; train_optim_loss: 443889.0987; val_kl_reg_loss: 5221.7217; val_edge_recon_loss: 279149.5625; val_gene_expr_recon_loss: 142090.8646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426462.1458; val_optim_loss: 426462.1458
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9490; val_auprc_score: 0.9347; val_best_acc_score: 0.8901; val_best_f1_score: 0.8946; train_kl_reg_loss: 4501.9111; train_edge_recon_loss: 269807.8405; train_gene_expr_recon_loss: 141205.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415515.2681; train_optim_loss: 415515.2681; val_kl_reg_loss: 3765.0456; val_edge_recon_loss: 270070.6458; val_gene_expr_recon_loss: 141587.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415423.6875; val_optim_loss: 415423.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9587; val_auprc_score: 0.9460; val_best_acc_score: 0.9065; val_best_f1_score: 0.9103; train_kl_reg_loss: 3930.2740; train_edge_recon_loss: 266421.7007; train_gene_expr_recon_loss: 141207.7056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411559.6809; train_optim_loss: 411559.6809; val_kl_reg_loss: 3763.7927; val_edge_recon_loss: 268217.8854; val_gene_expr_recon_loss: 141366.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413348.1146; val_optim_loss: 413348.1146
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9589; val_auprc_score: 0.9433; val_best_acc_score: 0.9091; val_best_f1_score: 0.9127; train_kl_reg_loss: 3857.7087; train_edge_recon_loss: 265218.3660; train_gene_expr_recon_loss: 139736.3980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408812.4720; train_optim_loss: 408812.4720; val_kl_reg_loss: 3657.7777; val_edge_recon_loss: 269099.1562; val_gene_expr_recon_loss: 139294.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412051.4896; val_optim_loss: 412051.4896
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9632; val_auprc_score: 0.9519; val_best_acc_score: 0.9136; val_best_f1_score: 0.9170; train_kl_reg_loss: 3772.8536; train_edge_recon_loss: 264836.8413; train_gene_expr_recon_loss: 139598.8158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408208.5115; train_optim_loss: 408208.5115; val_kl_reg_loss: 3705.7716; val_edge_recon_loss: 266775.3229; val_gene_expr_recon_loss: 139745.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410226.5312; val_optim_loss: 410226.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9664; val_auprc_score: 0.9532; val_best_acc_score: 0.9164; val_best_f1_score: 0.9193; train_kl_reg_loss: 3728.7348; train_edge_recon_loss: 263702.6472; train_gene_expr_recon_loss: 138415.9704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405847.3536; train_optim_loss: 405847.3536; val_kl_reg_loss: 3649.0920; val_edge_recon_loss: 258373.3229; val_gene_expr_recon_loss: 138574.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400596.6771; val_optim_loss: 400596.6771
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9663; val_auprc_score: 0.9492; val_best_acc_score: 0.9190; val_best_f1_score: 0.9219; train_kl_reg_loss: 3704.1195; train_edge_recon_loss: 263243.6752; train_gene_expr_recon_loss: 138347.9137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405295.7072; train_optim_loss: 405295.7072; val_kl_reg_loss: 3639.4255; val_edge_recon_loss: 265239.2396; val_gene_expr_recon_loss: 139209.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408088.3854; val_optim_loss: 408088.3854
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9668; val_auprc_score: 0.9546; val_best_acc_score: 0.9164; val_best_f1_score: 0.9200; train_kl_reg_loss: 3667.6980; train_edge_recon_loss: 263943.8832; train_gene_expr_recon_loss: 137926.7089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405538.2895; train_optim_loss: 405538.2895; val_kl_reg_loss: 3537.5501; val_edge_recon_loss: 266880.0625; val_gene_expr_recon_loss: 138664.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409082.3438; val_optim_loss: 409082.3438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9718; val_auprc_score: 0.9596; val_best_acc_score: 0.9284; val_best_f1_score: 0.9302; train_kl_reg_loss: 3622.4294; train_edge_recon_loss: 263472.9984; train_gene_expr_recon_loss: 138571.4729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405666.9046; train_optim_loss: 405666.9046; val_kl_reg_loss: 3579.2047; val_edge_recon_loss: 260438.3385; val_gene_expr_recon_loss: 138625.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402643.2708; val_optim_loss: 402643.2708

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9713; val_auprc_score: 0.9571; val_best_acc_score: 0.9269; val_best_f1_score: 0.9295; train_kl_reg_loss: 3616.5594; train_edge_recon_loss: 262884.6217; train_gene_expr_recon_loss: 136888.6657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403389.8421; train_optim_loss: 403389.8421; val_kl_reg_loss: 3542.6363; val_edge_recon_loss: 262086.2396; val_gene_expr_recon_loss: 137450.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403079.5625; val_optim_loss: 403079.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9758; val_auprc_score: 0.9683; val_best_acc_score: 0.9286; val_best_f1_score: 0.9300; train_kl_reg_loss: 3586.9225; train_edge_recon_loss: 262373.7081; train_gene_expr_recon_loss: 137211.0387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403171.6727; train_optim_loss: 403171.6727; val_kl_reg_loss: 3517.0832; val_edge_recon_loss: 261064.9583; val_gene_expr_recon_loss: 137336.4115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401918.4479; val_optim_loss: 401918.4479
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9757; val_auprc_score: 0.9685; val_best_acc_score: 0.9286; val_best_f1_score: 0.9311; train_kl_reg_loss: 3596.1890; train_edge_recon_loss: 262496.3939; train_gene_expr_recon_loss: 137371.8479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403464.4342; train_optim_loss: 403464.4342; val_kl_reg_loss: 3519.5718; val_edge_recon_loss: 262660.2656; val_gene_expr_recon_loss: 136378.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402558.0208; val_optim_loss: 402558.0208

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 25 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.9678
Val AUPRC score: 0.9573
Val best accuracy score: 0.9168
Val best F1 score: 0.9197
Val gene expr MSE score: 0.9263
Duration of model training in run 4: 0 hours, 0 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 55457
Number of validation edges: 6161
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9412; val_auprc_score: 0.9225; val_best_acc_score: 0.8749; val_best_f1_score: 0.8825; train_kl_reg_loss: 2288.4652; train_edge_recon_loss: 312261.5239; train_gene_expr_recon_loss: 147106.9710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461656.9608; train_optim_loss: 461656.9608; val_kl_reg_loss: 4000.8386; val_edge_recon_loss: 270320.2455; val_gene_expr_recon_loss: 143343.4040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417664.4955; val_optim_loss: 417664.4955
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9598; val_auprc_score: 0.9450; val_best_acc_score: 0.9094; val_best_f1_score: 0.9136; train_kl_reg_loss: 3794.7934; train_edge_recon_loss: 265975.9213; train_gene_expr_recon_loss: 141209.7415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410980.4562; train_optim_loss: 410980.4562; val_kl_reg_loss: 3702.9538; val_edge_recon_loss: 268693.2366; val_gene_expr_recon_loss: 139790.6920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412186.8795; val_optim_loss: 412186.8795
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9666; val_auprc_score: 0.9532; val_best_acc_score: 0.9183; val_best_f1_score: 0.9215; train_kl_reg_loss: 3695.4518; train_edge_recon_loss: 264822.1901; train_gene_expr_recon_loss: 139882.6949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408400.3364; train_optim_loss: 408400.3364; val_kl_reg_loss: 3654.4307; val_edge_recon_loss: 261210.7522; val_gene_expr_recon_loss: 139239.1652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404104.3527; val_optim_loss: 404104.3527
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9734; val_auprc_score: 0.9635; val_best_acc_score: 0.9300; val_best_f1_score: 0.9318; train_kl_reg_loss: 3636.7256; train_edge_recon_loss: 263902.9591; train_gene_expr_recon_loss: 138928.3587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406468.0466; train_optim_loss: 406468.0466; val_kl_reg_loss: 3591.8274; val_edge_recon_loss: 263327.6652; val_gene_expr_recon_loss: 138789.0246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405708.5179; val_optim_loss: 405708.5179
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9766; val_auprc_score: 0.9652; val_best_acc_score: 0.9374; val_best_f1_score: 0.9395; train_kl_reg_loss: 3592.5146; train_edge_recon_loss: 262219.0347; train_gene_expr_recon_loss: 138307.3865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404118.9347; train_optim_loss: 404118.9347; val_kl_reg_loss: 3591.8566; val_edge_recon_loss: 259977.3237; val_gene_expr_recon_loss: 138374.3136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401943.4955; val_optim_loss: 401943.4955
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9803; val_auprc_score: 0.9688; val_best_acc_score: 0.9453; val_best_f1_score: 0.9468; train_kl_reg_loss: 3564.2103; train_edge_recon_loss: 261808.3665; train_gene_expr_recon_loss: 137745.6901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403118.2659; train_optim_loss: 403118.2659; val_kl_reg_loss: 3432.2644; val_edge_recon_loss: 259782.6719; val_gene_expr_recon_loss: 137470.0201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400684.9598; val_optim_loss: 400684.9598
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9840; val_auprc_score: 0.9762; val_best_acc_score: 0.9494; val_best_f1_score: 0.9506; train_kl_reg_loss: 3528.4812; train_edge_recon_loss: 260735.8724; train_gene_expr_recon_loss: 136924.2338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401188.5898; train_optim_loss: 401188.5898; val_kl_reg_loss: 3448.4165; val_edge_recon_loss: 259691.8371; val_gene_expr_recon_loss: 137462.7121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400602.9688; val_optim_loss: 400602.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9826; val_auprc_score: 0.9740; val_best_acc_score: 0.9489; val_best_f1_score: 0.9506; train_kl_reg_loss: 3491.3235; train_edge_recon_loss: 259768.2912; train_gene_expr_recon_loss: 136317.9411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399577.5523; train_optim_loss: 399577.5523; val_kl_reg_loss: 3410.1003; val_edge_recon_loss: 257158.1473; val_gene_expr_recon_loss: 135272.6462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395840.8884; val_optim_loss: 395840.8884
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9841; val_auprc_score: 0.9765; val_best_acc_score: 0.9525; val_best_f1_score: 0.9538; train_kl_reg_loss: 3477.8496; train_edge_recon_loss: 259238.3074; train_gene_expr_recon_loss: 135610.2868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398326.4415; train_optim_loss: 398326.4415; val_kl_reg_loss: 3456.7336; val_edge_recon_loss: 257950.0960; val_gene_expr_recon_loss: 136446.2746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397853.0982; val_optim_loss: 397853.0982
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9849; val_auprc_score: 0.9767; val_best_acc_score: 0.9570; val_best_f1_score: 0.9578; train_kl_reg_loss: 3446.0038; train_edge_recon_loss: 259866.8423; train_gene_expr_recon_loss: 135479.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398792.0591; train_optim_loss: 398792.0591; val_kl_reg_loss: 3437.4246; val_edge_recon_loss: 256417.9241; val_gene_expr_recon_loss: 136559.3527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396414.6964; val_optim_loss: 396414.6964
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9856; val_auprc_score: 0.9793; val_best_acc_score: 0.9542; val_best_f1_score: 0.9551; train_kl_reg_loss: 3445.1358; train_edge_recon_loss: 259306.3111; train_gene_expr_recon_loss: 134988.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397740.0597; train_optim_loss: 397740.0597; val_kl_reg_loss: 3423.5337; val_edge_recon_loss: 261383.7277; val_gene_expr_recon_loss: 136726.3304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401533.5893; val_optim_loss: 401533.5893

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9843; val_auprc_score: 0.9787; val_best_acc_score: 0.9537; val_best_f1_score: 0.9545; train_kl_reg_loss: 3447.8156; train_edge_recon_loss: 259251.0722; train_gene_expr_recon_loss: 134316.8104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397015.6966; train_optim_loss: 397015.6966; val_kl_reg_loss: 3371.3212; val_edge_recon_loss: 259628.5312; val_gene_expr_recon_loss: 135132.1808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398132.0268; val_optim_loss: 398132.0268
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9846; val_auprc_score: 0.9780; val_best_acc_score: 0.9541; val_best_f1_score: 0.9553; train_kl_reg_loss: 3438.1214; train_edge_recon_loss: 258893.6449; train_gene_expr_recon_loss: 134186.3574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396518.1233; train_optim_loss: 396518.1233; val_kl_reg_loss: 3384.6171; val_edge_recon_loss: 258745.7790; val_gene_expr_recon_loss: 135141.4275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397271.8170; val_optim_loss: 397271.8170
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9872; val_auprc_score: 0.9807; val_best_acc_score: 0.9598; val_best_f1_score: 0.9606; train_kl_reg_loss: 3434.3851; train_edge_recon_loss: 258460.7219; train_gene_expr_recon_loss: 133665.6878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395560.7966; train_optim_loss: 395560.7966; val_kl_reg_loss: 3410.2338; val_edge_recon_loss: 259840.9799; val_gene_expr_recon_loss: 133921.7076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397172.9196; val_optim_loss: 397172.9196

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 54 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9825
Val AUPRC score: 0.9742
Val best accuracy score: 0.9476
Val best F1 score: 0.9493
Val gene expr MSE score: 0.7530
Duration of model training in run 5: 0 hours, 0 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 55457
Number of validation edges: 6161
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9408; val_auprc_score: 0.9285; val_best_acc_score: 0.8724; val_best_f1_score: 0.8799; train_kl_reg_loss: 2188.7587; train_edge_recon_loss: 313979.7494; train_gene_expr_recon_loss: 147753.1034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463921.6142; train_optim_loss: 463921.6142; val_kl_reg_loss: 4153.0491; val_edge_recon_loss: 268609.9710; val_gene_expr_recon_loss: 144271.5357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417034.5536; val_optim_loss: 417034.5536
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9644; val_auprc_score: 0.9553; val_best_acc_score: 0.9138; val_best_f1_score: 0.9167; train_kl_reg_loss: 3801.2265; train_edge_recon_loss: 266950.9176; train_gene_expr_recon_loss: 141641.0230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412393.1659; train_optim_loss: 412393.1659; val_kl_reg_loss: 3752.4804; val_edge_recon_loss: 267481.8125; val_gene_expr_recon_loss: 142788.4509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414022.7500; val_optim_loss: 414022.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9697; val_auprc_score: 0.9561; val_best_acc_score: 0.9221; val_best_f1_score: 0.9241; train_kl_reg_loss: 3732.6918; train_edge_recon_loss: 264557.8435; train_gene_expr_recon_loss: 139848.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408139.1074; train_optim_loss: 408139.1074; val_kl_reg_loss: 3745.8615; val_edge_recon_loss: 259764.1562; val_gene_expr_recon_loss: 141488.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404998.8750; val_optim_loss: 404998.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9752; val_auprc_score: 0.9655; val_best_acc_score: 0.9335; val_best_f1_score: 0.9355; train_kl_reg_loss: 3694.0092; train_edge_recon_loss: 263331.4420; train_gene_expr_recon_loss: 138574.6989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405600.1511; train_optim_loss: 405600.1511; val_kl_reg_loss: 3596.0918; val_edge_recon_loss: 260807.9263; val_gene_expr_recon_loss: 140044.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404448.8304; val_optim_loss: 404448.8304
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9807; val_auprc_score: 0.9717; val_best_acc_score: 0.9458; val_best_f1_score: 0.9472; train_kl_reg_loss: 3591.8236; train_edge_recon_loss: 262094.6932; train_gene_expr_recon_loss: 137753.2010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403439.7153; train_optim_loss: 403439.7153; val_kl_reg_loss: 3513.9649; val_edge_recon_loss: 259547.9777; val_gene_expr_recon_loss: 140176.8761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403238.8214; val_optim_loss: 403238.8214
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9792; val_auprc_score: 0.9671; val_best_acc_score: 0.9455; val_best_f1_score: 0.9471; train_kl_reg_loss: 3554.6512; train_edge_recon_loss: 261488.1349; train_gene_expr_recon_loss: 137174.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402217.7420; train_optim_loss: 402217.7420; val_kl_reg_loss: 3526.0896; val_edge_recon_loss: 260638.0246; val_gene_expr_recon_loss: 139042.0112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403206.1250; val_optim_loss: 403206.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9826; val_auprc_score: 0.9747; val_best_acc_score: 0.9493; val_best_f1_score: 0.9507; train_kl_reg_loss: 3526.9008; train_edge_recon_loss: 260422.7687; train_gene_expr_recon_loss: 136709.6533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400659.3187; train_optim_loss: 400659.3187; val_kl_reg_loss: 3530.4927; val_edge_recon_loss: 257660.9933; val_gene_expr_recon_loss: 137949.5871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399141.0714; val_optim_loss: 399141.0714
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9811; val_auprc_score: 0.9696; val_best_acc_score: 0.9491; val_best_f1_score: 0.9506; train_kl_reg_loss: 3499.8281; train_edge_recon_loss: 260333.6977; train_gene_expr_recon_loss: 136036.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399870.1557; train_optim_loss: 399870.1557; val_kl_reg_loss: 3478.3391; val_edge_recon_loss: 256403.0848; val_gene_expr_recon_loss: 136139.9989; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396021.4286; val_optim_loss: 396021.4286
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9845; val_auprc_score: 0.9772; val_best_acc_score: 0.9530; val_best_f1_score: 0.9543; train_kl_reg_loss: 3467.2670; train_edge_recon_loss: 259989.3747; train_gene_expr_recon_loss: 135558.5966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399015.2409; train_optim_loss: 399015.2409; val_kl_reg_loss: 3439.3687; val_edge_recon_loss: 256340.8326; val_gene_expr_recon_loss: 137659.3616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397439.5625; val_optim_loss: 397439.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9853; val_auprc_score: 0.9786; val_best_acc_score: 0.9516; val_best_f1_score: 0.9529; train_kl_reg_loss: 3457.8241; train_edge_recon_loss: 259608.3687; train_gene_expr_recon_loss: 135068.4491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398134.6392; train_optim_loss: 398134.6392; val_kl_reg_loss: 3421.2393; val_edge_recon_loss: 256405.6741; val_gene_expr_recon_loss: 136985.2701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396812.1830; val_optim_loss: 396812.1830
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9856; val_auprc_score: 0.9781; val_best_acc_score: 0.9569; val_best_f1_score: 0.9579; train_kl_reg_loss: 3450.2157; train_edge_recon_loss: 259351.2915; train_gene_expr_recon_loss: 134548.1584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397349.6636; train_optim_loss: 397349.6636; val_kl_reg_loss: 3414.8925; val_edge_recon_loss: 259121.3415; val_gene_expr_recon_loss: 136194.7199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398730.9554; val_optim_loss: 398730.9554

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9833; val_auprc_score: 0.9739; val_best_acc_score: 0.9555; val_best_f1_score: 0.9566; train_kl_reg_loss: 3441.7559; train_edge_recon_loss: 259252.9710; train_gene_expr_recon_loss: 133796.3622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396491.0875; train_optim_loss: 396491.0875; val_kl_reg_loss: 3421.8639; val_edge_recon_loss: 262562.9040; val_gene_expr_recon_loss: 135297.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401282.4464; val_optim_loss: 401282.4464
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9861; val_auprc_score: 0.9769; val_best_acc_score: 0.9587; val_best_f1_score: 0.9595; train_kl_reg_loss: 3441.4228; train_edge_recon_loss: 258733.4665; train_gene_expr_recon_loss: 133826.6374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396001.5261; train_optim_loss: 396001.5261; val_kl_reg_loss: 3415.3164; val_edge_recon_loss: 259950.1562; val_gene_expr_recon_loss: 135602.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398967.8304; val_optim_loss: 398967.8304
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9861; val_auprc_score: 0.9762; val_best_acc_score: 0.9588; val_best_f1_score: 0.9596; train_kl_reg_loss: 3435.3691; train_edge_recon_loss: 259087.8020; train_gene_expr_recon_loss: 133668.2287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396191.3994; train_optim_loss: 396191.3994; val_kl_reg_loss: 3392.8396; val_edge_recon_loss: 259113.7946; val_gene_expr_recon_loss: 135082.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397589.5580; val_optim_loss: 397589.5580

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 55 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9827
Val AUPRC score: 0.9736
Val best accuracy score: 0.9485
Val best F1 score: 0.9496
Val gene expr MSE score: 0.9052
Duration of model training in run 6: 0 hours, 0 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 73221
Number of validation edges: 8135
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9577; val_auprc_score: 0.9427; val_best_acc_score: 0.9052; val_best_f1_score: 0.9089; train_kl_reg_loss: 2929.3250; train_edge_recon_loss: 291252.3548; train_gene_expr_recon_loss: 145906.6657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440088.3457; train_optim_loss: 440088.3457; val_kl_reg_loss: 3709.3463; val_edge_recon_loss: 267301.2002; val_gene_expr_recon_loss: 140626.7476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411637.2969; val_optim_loss: 411637.2969
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9757; val_auprc_score: 0.9667; val_best_acc_score: 0.9304; val_best_f1_score: 0.9329; train_kl_reg_loss: 3657.7502; train_edge_recon_loss: 264605.5583; train_gene_expr_recon_loss: 140713.2004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408976.5091; train_optim_loss: 408976.5091; val_kl_reg_loss: 3591.2545; val_edge_recon_loss: 264140.1904; val_gene_expr_recon_loss: 138523.3472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406254.7969; val_optim_loss: 406254.7969
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9808; val_auprc_score: 0.9717; val_best_acc_score: 0.9467; val_best_f1_score: 0.9479; train_kl_reg_loss: 3546.3803; train_edge_recon_loss: 261854.7772; train_gene_expr_recon_loss: 139343.0751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404744.2318; train_optim_loss: 404744.2318; val_kl_reg_loss: 3431.0071; val_edge_recon_loss: 261101.9199; val_gene_expr_recon_loss: 137904.4937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402437.4141; val_optim_loss: 402437.4141
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9803; val_auprc_score: 0.9694; val_best_acc_score: 0.9486; val_best_f1_score: 0.9500; train_kl_reg_loss: 3507.9720; train_edge_recon_loss: 260315.6879; train_gene_expr_recon_loss: 137754.5544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401578.2155; train_optim_loss: 401578.2155; val_kl_reg_loss: 3423.6623; val_edge_recon_loss: 261139.9658; val_gene_expr_recon_loss: 137190.6436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401754.2695; val_optim_loss: 401754.2695
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9821; val_auprc_score: 0.9719; val_best_acc_score: 0.9506; val_best_f1_score: 0.9519; train_kl_reg_loss: 3454.2994; train_edge_recon_loss: 259979.5614; train_gene_expr_recon_loss: 137122.3753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400556.2355; train_optim_loss: 400556.2355; val_kl_reg_loss: 3397.1886; val_edge_recon_loss: 260217.5254; val_gene_expr_recon_loss: 135082.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398697.3887; val_optim_loss: 398697.3887
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9835; val_auprc_score: 0.9755; val_best_acc_score: 0.9524; val_best_f1_score: 0.9537; train_kl_reg_loss: 3436.4408; train_edge_recon_loss: 259153.2382; train_gene_expr_recon_loss: 135640.9789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398230.6582; train_optim_loss: 398230.6582; val_kl_reg_loss: 3353.0812; val_edge_recon_loss: 260214.0234; val_gene_expr_recon_loss: 134481.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398048.7578; val_optim_loss: 398048.7578
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9871; val_auprc_score: 0.9824; val_best_acc_score: 0.9570; val_best_f1_score: 0.9580; train_kl_reg_loss: 3421.2208; train_edge_recon_loss: 258847.2815; train_gene_expr_recon_loss: 135099.3760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397367.8772; train_optim_loss: 397367.8772; val_kl_reg_loss: 3456.4090; val_edge_recon_loss: 258510.9404; val_gene_expr_recon_loss: 134880.9487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396848.2969; val_optim_loss: 396848.2969
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9868; val_auprc_score: 0.9810; val_best_acc_score: 0.9571; val_best_f1_score: 0.9581; train_kl_reg_loss: 3407.6196; train_edge_recon_loss: 258833.0142; train_gene_expr_recon_loss: 134154.0745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396394.7094; train_optim_loss: 396394.7094; val_kl_reg_loss: 3338.2238; val_edge_recon_loss: 258924.4209; val_gene_expr_recon_loss: 133567.8345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395830.4766; val_optim_loss: 395830.4766
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9870; val_auprc_score: 0.9790; val_best_acc_score: 0.9597; val_best_f1_score: 0.9605; train_kl_reg_loss: 3405.4799; train_edge_recon_loss: 258549.6313; train_gene_expr_recon_loss: 133482.8031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395437.9138; train_optim_loss: 395437.9138; val_kl_reg_loss: 3423.2960; val_edge_recon_loss: 258936.9863; val_gene_expr_recon_loss: 132100.5913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394460.8789; val_optim_loss: 394460.8789
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9872; val_auprc_score: 0.9816; val_best_acc_score: 0.9611; val_best_f1_score: 0.9619; train_kl_reg_loss: 3419.9880; train_edge_recon_loss: 258078.4033; train_gene_expr_recon_loss: 132752.5964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394250.9883; train_optim_loss: 394250.9883; val_kl_reg_loss: 3414.3270; val_edge_recon_loss: 258607.4844; val_gene_expr_recon_loss: 130828.3413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392850.1602; val_optim_loss: 392850.1602
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9893; val_auprc_score: 0.9852; val_best_acc_score: 0.9630; val_best_f1_score: 0.9638; train_kl_reg_loss: 3403.3277; train_edge_recon_loss: 257910.1304; train_gene_expr_recon_loss: 132496.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393810.0469; train_optim_loss: 393810.0469; val_kl_reg_loss: 3405.1132; val_edge_recon_loss: 257261.4678; val_gene_expr_recon_loss: 131080.2329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391746.8086; val_optim_loss: 391746.8086
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9894; val_auprc_score: 0.9853; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 3404.8500; train_edge_recon_loss: 257977.8470; train_gene_expr_recon_loss: 131853.9580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393236.6554; train_optim_loss: 393236.6554; val_kl_reg_loss: 3441.0785; val_edge_recon_loss: 258319.9404; val_gene_expr_recon_loss: 131148.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392909.3047; val_optim_loss: 392909.3047
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9901; val_auprc_score: 0.9854; val_best_acc_score: 0.9638; val_best_f1_score: 0.9645; train_kl_reg_loss: 3391.4436; train_edge_recon_loss: 257871.7081; train_gene_expr_recon_loss: 131263.5693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392526.7222; train_optim_loss: 392526.7222; val_kl_reg_loss: 3407.2534; val_edge_recon_loss: 258276.2881; val_gene_expr_recon_loss: 129774.1021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391457.6445; val_optim_loss: 391457.6445
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9906; val_auprc_score: 0.9866; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 3392.7125; train_edge_recon_loss: 257865.5211; train_gene_expr_recon_loss: 130769.5094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392027.7420; train_optim_loss: 392027.7420; val_kl_reg_loss: 3431.0432; val_edge_recon_loss: 257414.4756; val_gene_expr_recon_loss: 131111.5889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391957.1035; val_optim_loss: 391957.1035
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9907; val_auprc_score: 0.9874; val_best_acc_score: 0.9660; val_best_f1_score: 0.9666; train_kl_reg_loss: 3397.0467; train_edge_recon_loss: 257837.1948; train_gene_expr_recon_loss: 130613.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391847.7483; train_optim_loss: 391847.7483; val_kl_reg_loss: 3478.3692; val_edge_recon_loss: 257464.6768; val_gene_expr_recon_loss: 128680.6855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389623.7344; val_optim_loss: 389623.7344
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9918; val_auprc_score: 0.9873; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 3399.9905; train_edge_recon_loss: 257942.8860; train_gene_expr_recon_loss: 130526.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391868.8813; train_optim_loss: 391868.8813; val_kl_reg_loss: 3285.8300; val_edge_recon_loss: 256986.0518; val_gene_expr_recon_loss: 129957.3271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390229.2129; val_optim_loss: 390229.2129
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9909; val_auprc_score: 0.9859; val_best_acc_score: 0.9685; val_best_f1_score: 0.9691; train_kl_reg_loss: 3400.2384; train_edge_recon_loss: 257722.2094; train_gene_expr_recon_loss: 129773.7531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390896.2014; train_optim_loss: 390896.2014; val_kl_reg_loss: 3423.6785; val_edge_recon_loss: 257534.3193; val_gene_expr_recon_loss: 129665.7173; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390623.7188; val_optim_loss: 390623.7188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9916; val_auprc_score: 0.9875; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 3397.0232; train_edge_recon_loss: 258050.9270; train_gene_expr_recon_loss: 129803.8676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391251.8184; train_optim_loss: 391251.8184; val_kl_reg_loss: 3387.0362; val_edge_recon_loss: 256796.6992; val_gene_expr_recon_loss: 128136.5083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388320.2441; val_optim_loss: 388320.2441
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9924; val_auprc_score: 0.9877; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 3390.4282; train_edge_recon_loss: 256998.8570; train_gene_expr_recon_loss: 129421.1853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389810.4705; train_optim_loss: 389810.4705; val_kl_reg_loss: 3298.8349; val_edge_recon_loss: 257156.5166; val_gene_expr_recon_loss: 129524.8286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389980.1836; val_optim_loss: 389980.1836
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9917; val_auprc_score: 0.9866; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 3409.7611; train_edge_recon_loss: 257246.6009; train_gene_expr_recon_loss: 129468.0805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390124.4427; train_optim_loss: 390124.4427; val_kl_reg_loss: 3448.8708; val_edge_recon_loss: 257929.7832; val_gene_expr_recon_loss: 128336.6655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389715.3105; val_optim_loss: 389715.3105
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9924; val_auprc_score: 0.9882; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 3398.9028; train_edge_recon_loss: 257341.4224; train_gene_expr_recon_loss: 129173.9104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389914.2352; train_optim_loss: 389914.2352; val_kl_reg_loss: 3319.4478; val_edge_recon_loss: 257106.1201; val_gene_expr_recon_loss: 129327.8105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389753.3848; val_optim_loss: 389753.3848

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9926; val_auprc_score: 0.9903; val_best_acc_score: 0.9707; val_best_f1_score: 0.9713; train_kl_reg_loss: 3375.9291; train_edge_recon_loss: 257106.8021; train_gene_expr_recon_loss: 128644.0252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389126.7572; train_optim_loss: 389126.7572; val_kl_reg_loss: 3366.0612; val_edge_recon_loss: 256672.7529; val_gene_expr_recon_loss: 128871.4653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388910.2773; val_optim_loss: 388910.2773
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9939; val_auprc_score: 0.9923; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 3402.3422; train_edge_recon_loss: 256706.1851; train_gene_expr_recon_loss: 128228.7370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388337.2635; train_optim_loss: 388337.2635; val_kl_reg_loss: 3358.5128; val_edge_recon_loss: 255463.6738; val_gene_expr_recon_loss: 128964.8364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387787.0254; val_optim_loss: 387787.0254
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9931; val_auprc_score: 0.9874; val_best_acc_score: 0.9732; val_best_f1_score: 0.9734; train_kl_reg_loss: 3380.4856; train_edge_recon_loss: 256934.6954; train_gene_expr_recon_loss: 128239.3838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388554.5658; train_optim_loss: 388554.5658; val_kl_reg_loss: 3354.6295; val_edge_recon_loss: 256747.0273; val_gene_expr_recon_loss: 128154.8267; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388256.4824; val_optim_loss: 388256.4824
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9928; val_auprc_score: 0.9873; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 3392.1509; train_edge_recon_loss: 256656.5789; train_gene_expr_recon_loss: 127942.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387990.8641; train_optim_loss: 387990.8641; val_kl_reg_loss: 3368.6976; val_edge_recon_loss: 256695.6270; val_gene_expr_recon_loss: 128561.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388626.1055; val_optim_loss: 388626.1055
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9927; val_auprc_score: 0.9892; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 3175.4995; train_edge_recon_loss: 257018.0578; train_gene_expr_recon_loss: 128130.6299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388324.1877; train_optim_loss: 388324.1877; val_kl_reg_loss: 2713.3949; val_edge_recon_loss: 256619.3965; val_gene_expr_recon_loss: 127974.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387306.9180; val_optim_loss: 387306.9180
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9874; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 2872.0483; train_edge_recon_loss: 256653.3197; train_gene_expr_recon_loss: 128293.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387819.0916; train_optim_loss: 387819.0916; val_kl_reg_loss: 2449.5508; val_edge_recon_loss: 256701.1123; val_gene_expr_recon_loss: 128868.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388018.7793; val_optim_loss: 388018.7793
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9937; val_auprc_score: 0.9910; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 2638.3726; train_edge_recon_loss: 256704.7609; train_gene_expr_recon_loss: 128133.9033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387477.0382; train_optim_loss: 387477.0382; val_kl_reg_loss: 2252.0280; val_edge_recon_loss: 256179.4570; val_gene_expr_recon_loss: 128218.5225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386650.0078; val_optim_loss: 386650.0078
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9912; val_auprc_score: 0.9860; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 2498.4842; train_edge_recon_loss: 256615.0588; train_gene_expr_recon_loss: 128110.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387224.2342; train_optim_loss: 387224.2342; val_kl_reg_loss: 2193.0956; val_edge_recon_loss: 257764.4014; val_gene_expr_recon_loss: 128563.7349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388521.2324; val_optim_loss: 388521.2324
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9925; val_auprc_score: 0.9875; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 2459.5358; train_edge_recon_loss: 256555.5783; train_gene_expr_recon_loss: 128129.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387144.2975; train_optim_loss: 387144.2975; val_kl_reg_loss: 2172.5711; val_edge_recon_loss: 256884.5967; val_gene_expr_recon_loss: 128065.6450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387122.8125; val_optim_loss: 387122.8125
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9934; val_auprc_score: 0.9868; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 2443.0568; train_edge_recon_loss: 256379.2540; train_gene_expr_recon_loss: 127905.8369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386728.1474; train_optim_loss: 386728.1474; val_kl_reg_loss: 2188.1882; val_edge_recon_loss: 256220.8398; val_gene_expr_recon_loss: 127536.1821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385945.2129; val_optim_loss: 385945.2129
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9930; val_auprc_score: 0.9896; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 2428.7155; train_edge_recon_loss: 256687.9979; train_gene_expr_recon_loss: 128095.9626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387212.6747; train_optim_loss: 387212.6747; val_kl_reg_loss: 2158.6930; val_edge_recon_loss: 256520.6934; val_gene_expr_recon_loss: 128482.1313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387161.5156; val_optim_loss: 387161.5156
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9932; val_auprc_score: 0.9885; val_best_acc_score: 0.9728; val_best_f1_score: 0.9732; train_kl_reg_loss: 2411.2514; train_edge_recon_loss: 256757.1602; train_gene_expr_recon_loss: 128226.6880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387395.0987; train_optim_loss: 387395.0987; val_kl_reg_loss: 2163.9811; val_edge_recon_loss: 256743.6221; val_gene_expr_recon_loss: 127224.6919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386132.2969; val_optim_loss: 386132.2969
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9932; val_auprc_score: 0.9898; val_best_acc_score: 0.9726; val_best_f1_score: 0.9731; train_kl_reg_loss: 2403.7845; train_edge_recon_loss: 256343.3372; train_gene_expr_recon_loss: 128097.0577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386844.1793; train_optim_loss: 386844.1793; val_kl_reg_loss: 2163.5524; val_edge_recon_loss: 256481.4004; val_gene_expr_recon_loss: 127551.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386196.3945; val_optim_loss: 386196.3945

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9919; val_auprc_score: 0.9874; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 2403.3958; train_edge_recon_loss: 256409.6919; train_gene_expr_recon_loss: 127974.2561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386787.3435; train_optim_loss: 386787.3435; val_kl_reg_loss: 2160.7691; val_edge_recon_loss: 256339.8701; val_gene_expr_recon_loss: 128305.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386806.5586; val_optim_loss: 386806.5586
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9940; val_auprc_score: 0.9907; val_best_acc_score: 0.9752; val_best_f1_score: 0.9755; train_kl_reg_loss: 2401.9483; train_edge_recon_loss: 256401.8464; train_gene_expr_recon_loss: 127892.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386695.8019; train_optim_loss: 386695.8019; val_kl_reg_loss: 2161.8327; val_edge_recon_loss: 256706.2354; val_gene_expr_recon_loss: 128051.1577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386919.2266; val_optim_loss: 386919.2266
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9940; val_auprc_score: 0.9914; val_best_acc_score: 0.9743; val_best_f1_score: 0.9746; train_kl_reg_loss: 2397.6212; train_edge_recon_loss: 256516.8829; train_gene_expr_recon_loss: 128033.8124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386948.3151; train_optim_loss: 386948.3151; val_kl_reg_loss: 2161.0504; val_edge_recon_loss: 256473.0479; val_gene_expr_recon_loss: 127844.1924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386478.2930; val_optim_loss: 386478.2930

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 41 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9927
Val AUPRC score: 0.9888
Val best accuracy score: 0.9730
Val best F1 score: 0.9734
Val gene expr MSE score: 0.7660
Duration of model training in run 7: 0 hours, 6 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 73221
Number of validation edges: 8135
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9634; val_auprc_score: 0.9517; val_best_acc_score: 0.9120; val_best_f1_score: 0.9148; train_kl_reg_loss: 2845.6464; train_edge_recon_loss: 290102.7217; train_gene_expr_recon_loss: 143733.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436682.0150; train_optim_loss: 436682.0150; val_kl_reg_loss: 3687.5916; val_edge_recon_loss: 266385.3184; val_gene_expr_recon_loss: 143487.7388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413560.6523; val_optim_loss: 413560.6523
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9724; val_auprc_score: 0.9606; val_best_acc_score: 0.9291; val_best_f1_score: 0.9313; train_kl_reg_loss: 3626.7217; train_edge_recon_loss: 263524.5175; train_gene_expr_recon_loss: 139102.5072; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406253.7452; train_optim_loss: 406253.7452; val_kl_reg_loss: 3465.6326; val_edge_recon_loss: 264158.3750; val_gene_expr_recon_loss: 141994.4980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409618.5039; val_optim_loss: 409618.5039
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9779; val_auprc_score: 0.9681; val_best_acc_score: 0.9382; val_best_f1_score: 0.9402; train_kl_reg_loss: 3533.9626; train_edge_recon_loss: 262414.0181; train_gene_expr_recon_loss: 137181.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403129.0545; train_optim_loss: 403129.0545; val_kl_reg_loss: 3562.8663; val_edge_recon_loss: 264672.8408; val_gene_expr_recon_loss: 140929.1543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409164.8594; val_optim_loss: 409164.8594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9816; val_auprc_score: 0.9719; val_best_acc_score: 0.9503; val_best_f1_score: 0.9517; train_kl_reg_loss: 3478.7801; train_edge_recon_loss: 260329.3523; train_gene_expr_recon_loss: 136292.2968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400100.4310; train_optim_loss: 400100.4310; val_kl_reg_loss: 3408.6249; val_edge_recon_loss: 260786.3398; val_gene_expr_recon_loss: 138603.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402798.2910; val_optim_loss: 402798.2910
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9838; val_auprc_score: 0.9763; val_best_acc_score: 0.9527; val_best_f1_score: 0.9539; train_kl_reg_loss: 3445.5156; train_edge_recon_loss: 259624.6469; train_gene_expr_recon_loss: 135226.7501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398296.9136; train_optim_loss: 398296.9136; val_kl_reg_loss: 3636.8472; val_edge_recon_loss: 264186.3350; val_gene_expr_recon_loss: 138501.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406324.6738; val_optim_loss: 406324.6738
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9867; val_auprc_score: 0.9809; val_best_acc_score: 0.9581; val_best_f1_score: 0.9590; train_kl_reg_loss: 3458.0170; train_edge_recon_loss: 259898.9341; train_gene_expr_recon_loss: 134360.4712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397717.4232; train_optim_loss: 397717.4232; val_kl_reg_loss: 3384.5995; val_edge_recon_loss: 258134.2061; val_gene_expr_recon_loss: 137724.5181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399243.3281; val_optim_loss: 399243.3281
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9846; val_auprc_score: 0.9773; val_best_acc_score: 0.9565; val_best_f1_score: 0.9578; train_kl_reg_loss: 3421.5898; train_edge_recon_loss: 259087.0569; train_gene_expr_recon_loss: 133576.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396085.4332; train_optim_loss: 396085.4332; val_kl_reg_loss: 3433.4893; val_edge_recon_loss: 259084.7070; val_gene_expr_recon_loss: 137023.8042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399542.0000; val_optim_loss: 399542.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9851; val_auprc_score: 0.9775; val_best_acc_score: 0.9591; val_best_f1_score: 0.9601; train_kl_reg_loss: 3421.2696; train_edge_recon_loss: 258946.9630; train_gene_expr_recon_loss: 132820.7759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395189.0093; train_optim_loss: 395189.0093; val_kl_reg_loss: 3361.9141; val_edge_recon_loss: 258751.8281; val_gene_expr_recon_loss: 135097.2251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397210.9629; val_optim_loss: 397210.9629
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9893; val_auprc_score: 0.9852; val_best_acc_score: 0.9636; val_best_f1_score: 0.9645; train_kl_reg_loss: 3423.5806; train_edge_recon_loss: 258438.4596; train_gene_expr_recon_loss: 132234.0537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394096.0944; train_optim_loss: 394096.0944; val_kl_reg_loss: 3477.5056; val_edge_recon_loss: 257761.3369; val_gene_expr_recon_loss: 135861.3638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397100.1992; val_optim_loss: 397100.1992
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9878; val_auprc_score: 0.9818; val_best_acc_score: 0.9608; val_best_f1_score: 0.9618; train_kl_reg_loss: 3406.8532; train_edge_recon_loss: 258429.2486; train_gene_expr_recon_loss: 131847.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393683.7318; train_optim_loss: 393683.7318; val_kl_reg_loss: 3321.1109; val_edge_recon_loss: 257630.7236; val_gene_expr_recon_loss: 134876.5386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395828.3809; val_optim_loss: 395828.3809
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9882; val_auprc_score: 0.9825; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 3406.4655; train_edge_recon_loss: 258057.9672; train_gene_expr_recon_loss: 130954.0155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392418.4481; train_optim_loss: 392418.4481; val_kl_reg_loss: 3296.8676; val_edge_recon_loss: 257071.3291; val_gene_expr_recon_loss: 134355.6450; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394723.8418; val_optim_loss: 394723.8418
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9893; val_auprc_score: 0.9842; val_best_acc_score: 0.9629; val_best_f1_score: 0.9638; train_kl_reg_loss: 3397.2845; train_edge_recon_loss: 257975.9230; train_gene_expr_recon_loss: 130189.4079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391562.6155; train_optim_loss: 391562.6155; val_kl_reg_loss: 3440.2887; val_edge_recon_loss: 258271.0557; val_gene_expr_recon_loss: 134386.7139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396098.0605; val_optim_loss: 396098.0605
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9900; val_auprc_score: 0.9843; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 3391.4895; train_edge_recon_loss: 258003.3837; train_gene_expr_recon_loss: 130083.1663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391478.0378; train_optim_loss: 391478.0378; val_kl_reg_loss: 3475.6311; val_edge_recon_loss: 258005.9482; val_gene_expr_recon_loss: 133724.1206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395205.7012; val_optim_loss: 395205.7012
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9894; val_auprc_score: 0.9842; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 3393.4272; train_edge_recon_loss: 257443.2943; train_gene_expr_recon_loss: 129721.3883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390558.1105; train_optim_loss: 390558.1105; val_kl_reg_loss: 3338.1416; val_edge_recon_loss: 258349.3320; val_gene_expr_recon_loss: 134874.6309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396562.1016; val_optim_loss: 396562.1016

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9896; val_auprc_score: 0.9856; val_best_acc_score: 0.9667; val_best_f1_score: 0.9675; train_kl_reg_loss: 3395.0764; train_edge_recon_loss: 257535.0790; train_gene_expr_recon_loss: 129259.3031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390189.4586; train_optim_loss: 390189.4586; val_kl_reg_loss: 3357.9960; val_edge_recon_loss: 257142.5830; val_gene_expr_recon_loss: 133119.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393619.7676; val_optim_loss: 393619.7676
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9912; val_auprc_score: 0.9873; val_best_acc_score: 0.9665; val_best_f1_score: 0.9672; train_kl_reg_loss: 3392.2835; train_edge_recon_loss: 257430.5174; train_gene_expr_recon_loss: 129073.5643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389896.3644; train_optim_loss: 389896.3644; val_kl_reg_loss: 3373.2815; val_edge_recon_loss: 257175.7246; val_gene_expr_recon_loss: 133296.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393845.1914; val_optim_loss: 393845.1914
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9919; val_auprc_score: 0.9892; val_best_acc_score: 0.9675; val_best_f1_score: 0.9681; train_kl_reg_loss: 3391.4914; train_edge_recon_loss: 257101.1672; train_gene_expr_recon_loss: 129029.5871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389522.2448; train_optim_loss: 389522.2448; val_kl_reg_loss: 3371.7549; val_edge_recon_loss: 257355.2744; val_gene_expr_recon_loss: 133194.2651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393921.2949; val_optim_loss: 393921.2949
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9898; val_auprc_score: 0.9855; val_best_acc_score: 0.9656; val_best_f1_score: 0.9664; train_kl_reg_loss: 3400.6380; train_edge_recon_loss: 257071.6080; train_gene_expr_recon_loss: 129003.1134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389475.3600; train_optim_loss: 389475.3600; val_kl_reg_loss: 3381.9557; val_edge_recon_loss: 257483.2959; val_gene_expr_recon_loss: 133364.4072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394229.6641; val_optim_loss: 394229.6641

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9924; val_auprc_score: 0.9893; val_best_acc_score: 0.9680; val_best_f1_score: 0.9686; train_kl_reg_loss: 3396.8720; train_edge_recon_loss: 257044.0059; train_gene_expr_recon_loss: 128840.9737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389281.8516; train_optim_loss: 389281.8516; val_kl_reg_loss: 3368.8491; val_edge_recon_loss: 256732.4727; val_gene_expr_recon_loss: 133200.4458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393301.7637; val_optim_loss: 393301.7637
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9911; val_auprc_score: 0.9873; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 3382.1128; train_edge_recon_loss: 257256.6732; train_gene_expr_recon_loss: 128561.5378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389200.3231; train_optim_loss: 389200.3231; val_kl_reg_loss: 3358.0176; val_edge_recon_loss: 256309.0166; val_gene_expr_recon_loss: 133112.6567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392779.6914; val_optim_loss: 392779.6914
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9913; val_auprc_score: 0.9883; val_best_acc_score: 0.9680; val_best_f1_score: 0.9687; train_kl_reg_loss: 3378.7971; train_edge_recon_loss: 257060.3102; train_gene_expr_recon_loss: 128803.9889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389243.0985; train_optim_loss: 389243.0985; val_kl_reg_loss: 3356.6837; val_edge_recon_loss: 256409.5850; val_gene_expr_recon_loss: 133197.8687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392964.1348; val_optim_loss: 392964.1348
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9912; val_auprc_score: 0.9880; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 3374.5760; train_edge_recon_loss: 257058.6454; train_gene_expr_recon_loss: 128679.9775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389113.1997; train_optim_loss: 389113.1997; val_kl_reg_loss: 3354.6984; val_edge_recon_loss: 256873.9121; val_gene_expr_recon_loss: 131548.5542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391777.1680; val_optim_loss: 391777.1680
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9902; val_auprc_score: 0.9854; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 3376.9271; train_edge_recon_loss: 257486.2593; train_gene_expr_recon_loss: 128719.5732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389582.7602; train_optim_loss: 389582.7602; val_kl_reg_loss: 3350.4104; val_edge_recon_loss: 257572.6855; val_gene_expr_recon_loss: 132652.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393575.6191; val_optim_loss: 393575.6191
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9916; val_auprc_score: 0.9890; val_best_acc_score: 0.9670; val_best_f1_score: 0.9678; train_kl_reg_loss: 3374.6758; train_edge_recon_loss: 256963.7429; train_gene_expr_recon_loss: 128919.1396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389257.5592; train_optim_loss: 389257.5592; val_kl_reg_loss: 3350.4205; val_edge_recon_loss: 256653.0527; val_gene_expr_recon_loss: 132721.9321; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392725.4062; val_optim_loss: 392725.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9912; val_auprc_score: 0.9877; val_best_acc_score: 0.9659; val_best_f1_score: 0.9668; train_kl_reg_loss: 3381.1180; train_edge_recon_loss: 256858.7708; train_gene_expr_recon_loss: 129108.8480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389348.7372; train_optim_loss: 389348.7372; val_kl_reg_loss: 3362.0795; val_edge_recon_loss: 257456.9736; val_gene_expr_recon_loss: 133889.3022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394708.3535; val_optim_loss: 394708.3535

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9893; val_auprc_score: 0.9848; val_best_acc_score: 0.9642; val_best_f1_score: 0.9650; train_kl_reg_loss: 3376.3086; train_edge_recon_loss: 257526.8554; train_gene_expr_recon_loss: 128890.6574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389793.8205; train_optim_loss: 389793.8205; val_kl_reg_loss: 3120.8515; val_edge_recon_loss: 257461.6416; val_gene_expr_recon_loss: 133352.9292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393935.4238; val_optim_loss: 393935.4238
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9905; val_auprc_score: 0.9872; val_best_acc_score: 0.9648; val_best_f1_score: 0.9657; train_kl_reg_loss: 3364.1620; train_edge_recon_loss: 257484.9591; train_gene_expr_recon_loss: 128875.1175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389724.2378; train_optim_loss: 389724.2378; val_kl_reg_loss: 3110.3719; val_edge_recon_loss: 258140.7461; val_gene_expr_recon_loss: 133417.7471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394668.8672; val_optim_loss: 394668.8672
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9902; val_auprc_score: 0.9853; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 3350.9379; train_edge_recon_loss: 257442.9932; train_gene_expr_recon_loss: 128797.3792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389591.3099; train_optim_loss: 389591.3099; val_kl_reg_loss: 3100.5519; val_edge_recon_loss: 258139.1875; val_gene_expr_recon_loss: 133133.7183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394373.4590; val_optim_loss: 394373.4590

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 19 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9902
Val AUPRC score: 0.9864
Val best accuracy score: 0.9653
Val best F1 score: 0.9660
Val gene expr MSE score: 0.8002
Duration of model training in run 8: 0 hours, 4 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 90939
Number of validation edges: 10104
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9717; val_auprc_score: 0.9624; val_best_acc_score: 0.9200; val_best_f1_score: 0.9223; train_kl_reg_loss: 3208.6079; train_edge_recon_loss: 278356.1120; train_gene_expr_recon_loss: 144024.6227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425589.3432; train_optim_loss: 425589.3432; val_kl_reg_loss: 3605.9815; val_edge_recon_loss: 263659.5285; val_gene_expr_recon_loss: 138786.1734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406051.6820; val_optim_loss: 406051.6820
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9797; val_auprc_score: 0.9699; val_best_acc_score: 0.9427; val_best_f1_score: 0.9447; train_kl_reg_loss: 3482.8344; train_edge_recon_loss: 262295.9350; train_gene_expr_recon_loss: 138779.0976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404557.8670; train_optim_loss: 404557.8670; val_kl_reg_loss: 3400.7453; val_edge_recon_loss: 260400.1164; val_gene_expr_recon_loss: 135857.9018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399658.7664; val_optim_loss: 399658.7664
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9844; val_auprc_score: 0.9760; val_best_acc_score: 0.9546; val_best_f1_score: 0.9558; train_kl_reg_loss: 3420.0276; train_edge_recon_loss: 259868.3957; train_gene_expr_recon_loss: 136445.3770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399733.8004; train_optim_loss: 399733.8004; val_kl_reg_loss: 3434.5302; val_edge_recon_loss: 258534.6266; val_gene_expr_recon_loss: 134260.3805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396229.5391; val_optim_loss: 396229.5391
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9878; val_auprc_score: 0.9822; val_best_acc_score: 0.9598; val_best_f1_score: 0.9606; train_kl_reg_loss: 3404.8612; train_edge_recon_loss: 258571.1735; train_gene_expr_recon_loss: 134694.8305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396670.8641; train_optim_loss: 396670.8641; val_kl_reg_loss: 3377.5850; val_edge_recon_loss: 257803.9574; val_gene_expr_recon_loss: 132517.1963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393698.7398; val_optim_loss: 393698.7398
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9885; val_auprc_score: 0.9836; val_best_acc_score: 0.9592; val_best_f1_score: 0.9601; train_kl_reg_loss: 3400.9536; train_edge_recon_loss: 258486.6708; train_gene_expr_recon_loss: 133264.4364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395152.0610; train_optim_loss: 395152.0610; val_kl_reg_loss: 3392.5580; val_edge_recon_loss: 258487.2262; val_gene_expr_recon_loss: 131391.7285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393271.5148; val_optim_loss: 393271.5148
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9903; val_auprc_score: 0.9865; val_best_acc_score: 0.9646; val_best_f1_score: 0.9653; train_kl_reg_loss: 3390.7221; train_edge_recon_loss: 257952.3973; train_gene_expr_recon_loss: 132039.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393382.7630; train_optim_loss: 393382.7630; val_kl_reg_loss: 3405.8968; val_edge_recon_loss: 258678.5887; val_gene_expr_recon_loss: 130279.5723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392364.0586; val_optim_loss: 392364.0586
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9904; val_auprc_score: 0.9848; val_best_acc_score: 0.9678; val_best_f1_score: 0.9685; train_kl_reg_loss: 3385.2953; train_edge_recon_loss: 257850.3610; train_gene_expr_recon_loss: 131136.0171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392371.6722; train_optim_loss: 392371.6722; val_kl_reg_loss: 3383.2044; val_edge_recon_loss: 256466.3637; val_gene_expr_recon_loss: 129671.9270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389521.4922; val_optim_loss: 389521.4922
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9908; val_auprc_score: 0.9867; val_best_acc_score: 0.9688; val_best_f1_score: 0.9693; train_kl_reg_loss: 3386.4013; train_edge_recon_loss: 257481.6154; train_gene_expr_recon_loss: 130448.5022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391316.5188; train_optim_loss: 391316.5188; val_kl_reg_loss: 3387.3485; val_edge_recon_loss: 257237.5008; val_gene_expr_recon_loss: 128797.7412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389422.5914; val_optim_loss: 389422.5914
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9932; val_auprc_score: 0.9895; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 3388.2412; train_edge_recon_loss: 257351.6737; train_gene_expr_recon_loss: 129874.1158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390614.0308; train_optim_loss: 390614.0308; val_kl_reg_loss: 3406.6320; val_edge_recon_loss: 256699.8777; val_gene_expr_recon_loss: 128324.2732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388430.7867; val_optim_loss: 388430.7867
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9940; val_auprc_score: 0.9903; val_best_acc_score: 0.9766; val_best_f1_score: 0.9770; train_kl_reg_loss: 3396.5418; train_edge_recon_loss: 256949.1261; train_gene_expr_recon_loss: 129336.9749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389682.6433; train_optim_loss: 389682.6433; val_kl_reg_loss: 3270.5571; val_edge_recon_loss: 256181.0871; val_gene_expr_recon_loss: 128012.6256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387464.2727; val_optim_loss: 387464.2727
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9938; val_auprc_score: 0.9906; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 3388.4605; train_edge_recon_loss: 257126.0872; train_gene_expr_recon_loss: 128960.4910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389475.0379; train_optim_loss: 389475.0379; val_kl_reg_loss: 3387.3973; val_edge_recon_loss: 256833.3613; val_gene_expr_recon_loss: 127604.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387824.8617; val_optim_loss: 387824.8617
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 3404.8383; train_edge_recon_loss: 256703.0389; train_gene_expr_recon_loss: 128626.9221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388734.7997; train_optim_loss: 388734.7997; val_kl_reg_loss: 3256.7116; val_edge_recon_loss: 256452.9105; val_gene_expr_recon_loss: 127535.2428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387244.8648; val_optim_loss: 387244.8648
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9939; val_auprc_score: 0.9900; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 3400.5384; train_edge_recon_loss: 256517.4017; train_gene_expr_recon_loss: 128333.7913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388251.7322; train_optim_loss: 388251.7322; val_kl_reg_loss: 3454.4741; val_edge_recon_loss: 256637.7273; val_gene_expr_recon_loss: 127102.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387194.3422; val_optim_loss: 387194.3422
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9948; val_auprc_score: 0.9921; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 3400.6628; train_edge_recon_loss: 256610.0822; train_gene_expr_recon_loss: 128072.4002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388083.1446; train_optim_loss: 388083.1446; val_kl_reg_loss: 3425.2742; val_edge_recon_loss: 256196.9090; val_gene_expr_recon_loss: 127056.8727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386679.0578; val_optim_loss: 386679.0578
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9951; val_auprc_score: 0.9921; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 3401.3179; train_edge_recon_loss: 256617.0406; train_gene_expr_recon_loss: 127783.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387801.5931; train_optim_loss: 387801.5931; val_kl_reg_loss: 3415.7457; val_edge_recon_loss: 255729.8500; val_gene_expr_recon_loss: 126889.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386035.2164; val_optim_loss: 386035.2164
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9951; val_auprc_score: 0.9924; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 3409.4719; train_edge_recon_loss: 256429.8951; train_gene_expr_recon_loss: 127644.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387484.0017; train_optim_loss: 387484.0017; val_kl_reg_loss: 3426.8965; val_edge_recon_loss: 255936.0812; val_gene_expr_recon_loss: 126770.6795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386133.6555; val_optim_loss: 386133.6555
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9945; val_auprc_score: 0.9899; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 3413.0622; train_edge_recon_loss: 256417.4415; train_gene_expr_recon_loss: 127447.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387277.6369; train_optim_loss: 387277.6369; val_kl_reg_loss: 3405.1687; val_edge_recon_loss: 256287.6605; val_gene_expr_recon_loss: 126922.4338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386615.2609; val_optim_loss: 386615.2609
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9954; val_auprc_score: 0.9916; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 3417.0873; train_edge_recon_loss: 256072.4245; train_gene_expr_recon_loss: 127293.4700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386782.9814; train_optim_loss: 386782.9814; val_kl_reg_loss: 3330.1062; val_edge_recon_loss: 255189.5879; val_gene_expr_recon_loss: 126726.4902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385246.1828; val_optim_loss: 385246.1828
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9933; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 3417.0542; train_edge_recon_loss: 256086.0157; train_gene_expr_recon_loss: 127201.1126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386704.1822; train_optim_loss: 386704.1822; val_kl_reg_loss: 3440.7410; val_edge_recon_loss: 256302.3824; val_gene_expr_recon_loss: 126823.8590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386566.9820; val_optim_loss: 386566.9820
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9950; val_auprc_score: 0.9915; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 3427.6863; train_edge_recon_loss: 255912.0535; train_gene_expr_recon_loss: 127027.0723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386366.8119; train_optim_loss: 386366.8119; val_kl_reg_loss: 3413.6790; val_edge_recon_loss: 255858.2102; val_gene_expr_recon_loss: 126525.3787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385797.2672; val_optim_loss: 385797.2672
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9963; val_auprc_score: 0.9941; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 3432.5809; train_edge_recon_loss: 255779.0720; train_gene_expr_recon_loss: 126922.1525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386133.8041; train_optim_loss: 386133.8041; val_kl_reg_loss: 3418.3129; val_edge_recon_loss: 255669.2727; val_gene_expr_recon_loss: 126447.9504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385535.5367; val_optim_loss: 385535.5367

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9959; val_auprc_score: 0.9932; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3434.6750; train_edge_recon_loss: 255635.0195; train_gene_expr_recon_loss: 126440.9428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385510.6367; train_optim_loss: 385510.6367; val_kl_reg_loss: 3411.9410; val_edge_recon_loss: 255374.3441; val_gene_expr_recon_loss: 126327.1525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385113.4367; val_optim_loss: 385113.4367
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9954; val_auprc_score: 0.9934; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 3425.0611; train_edge_recon_loss: 255867.5230; train_gene_expr_recon_loss: 126356.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385648.6716; train_optim_loss: 385648.6716; val_kl_reg_loss: 3412.9498; val_edge_recon_loss: 254909.8488; val_gene_expr_recon_loss: 126326.8033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384649.6023; val_optim_loss: 384649.6023
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9961; val_auprc_score: 0.9930; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 3426.8302; train_edge_recon_loss: 255789.6746; train_gene_expr_recon_loss: 126291.5262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385508.0319; train_optim_loss: 385508.0319; val_kl_reg_loss: 3416.4323; val_edge_recon_loss: 255394.9297; val_gene_expr_recon_loss: 126425.4059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385236.7672; val_optim_loss: 385236.7672
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9955; val_auprc_score: 0.9919; val_best_acc_score: 0.9844; val_best_f1_score: 0.9846; train_kl_reg_loss: 3424.6881; train_edge_recon_loss: 255821.5723; train_gene_expr_recon_loss: 126265.5057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385511.7664; train_optim_loss: 385511.7664; val_kl_reg_loss: 3386.0725; val_edge_recon_loss: 255865.1805; val_gene_expr_recon_loss: 126262.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385513.6617; val_optim_loss: 385513.6617
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9963; val_auprc_score: 0.9951; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 3207.7757; train_edge_recon_loss: 255822.7660; train_gene_expr_recon_loss: 126531.6363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385562.1778; train_optim_loss: 385562.1778; val_kl_reg_loss: 2654.5875; val_edge_recon_loss: 255749.9891; val_gene_expr_recon_loss: 126597.3914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385001.9672; val_optim_loss: 385001.9672

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9961; val_auprc_score: 0.9924; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2994.8359; train_edge_recon_loss: 255731.4687; train_gene_expr_recon_loss: 126447.2460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385173.5510; train_optim_loss: 385173.5510; val_kl_reg_loss: 2621.4908; val_edge_recon_loss: 255981.0934; val_gene_expr_recon_loss: 126357.2309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384959.8117; val_optim_loss: 384959.8117
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9959; val_auprc_score: 0.9924; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 2957.5793; train_edge_recon_loss: 256012.1537; train_gene_expr_recon_loss: 126418.9266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385388.6597; train_optim_loss: 385388.6597; val_kl_reg_loss: 2576.2054; val_edge_recon_loss: 255421.5551; val_gene_expr_recon_loss: 126394.1457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384391.9031; val_optim_loss: 384391.9031
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9968; val_auprc_score: 0.9948; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2923.0265; train_edge_recon_loss: 255705.8688; train_gene_expr_recon_loss: 126412.2030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385041.0988; train_optim_loss: 385041.0988; val_kl_reg_loss: 2541.2466; val_edge_recon_loss: 255467.2660; val_gene_expr_recon_loss: 126420.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384429.1500; val_optim_loss: 384429.1500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9954; val_auprc_score: 0.9927; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 2881.4123; train_edge_recon_loss: 255444.2900; train_gene_expr_recon_loss: 126390.3120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384716.0134; train_optim_loss: 384716.0134; val_kl_reg_loss: 2500.4938; val_edge_recon_loss: 255925.3758; val_gene_expr_recon_loss: 126501.1678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384927.0391; val_optim_loss: 384927.0391
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9957; val_auprc_score: 0.9925; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 2838.5490; train_edge_recon_loss: 255711.9390; train_gene_expr_recon_loss: 126424.8574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384975.3453; train_optim_loss: 384975.3453; val_kl_reg_loss: 2456.3044; val_edge_recon_loss: 256108.8410; val_gene_expr_recon_loss: 126352.0941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384917.2438; val_optim_loss: 384917.2438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9962; val_auprc_score: 0.9939; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 2814.6630; train_edge_recon_loss: 255869.4257; train_gene_expr_recon_loss: 126380.5752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385064.6633; train_optim_loss: 385064.6633; val_kl_reg_loss: 2451.1332; val_edge_recon_loss: 255402.7609; val_gene_expr_recon_loss: 126478.0824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384331.9750; val_optim_loss: 384331.9750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9963; val_auprc_score: 0.9922; val_best_acc_score: 0.9854; val_best_f1_score: 0.9854; train_kl_reg_loss: 2809.5268; train_edge_recon_loss: 256018.6291; train_gene_expr_recon_loss: 126446.9064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385275.0632; train_optim_loss: 385275.0632; val_kl_reg_loss: 2445.7747; val_edge_recon_loss: 254862.1535; val_gene_expr_recon_loss: 126365.9568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383673.8898; val_optim_loss: 383673.8898
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9947; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 2804.5468; train_edge_recon_loss: 255777.4319; train_gene_expr_recon_loss: 126448.1595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385030.1384; train_optim_loss: 385030.1384; val_kl_reg_loss: 2440.7851; val_edge_recon_loss: 255334.8277; val_gene_expr_recon_loss: 126408.7361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384184.3500; val_optim_loss: 384184.3500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9960; val_auprc_score: 0.9920; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 2799.1686; train_edge_recon_loss: 255777.5864; train_gene_expr_recon_loss: 126418.2038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384994.9592; train_optim_loss: 384994.9592; val_kl_reg_loss: 2437.2713; val_edge_recon_loss: 255869.0172; val_gene_expr_recon_loss: 126292.2617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384598.5484; val_optim_loss: 384598.5484
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9960; val_auprc_score: 0.9943; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 2794.4517; train_edge_recon_loss: 255932.9907; train_gene_expr_recon_loss: 126377.4557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385104.8984; train_optim_loss: 385104.8984; val_kl_reg_loss: 2432.3234; val_edge_recon_loss: 255965.5387; val_gene_expr_recon_loss: 126346.8111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384744.6734; val_optim_loss: 384744.6734

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9963; val_auprc_score: 0.9927; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 2791.5207; train_edge_recon_loss: 255755.4181; train_gene_expr_recon_loss: 126424.2203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384971.1590; train_optim_loss: 384971.1590; val_kl_reg_loss: 2432.2551; val_edge_recon_loss: 256118.3848; val_gene_expr_recon_loss: 126140.1988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384690.8406; val_optim_loss: 384690.8406
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9960; val_auprc_score: 0.9934; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 2791.2015; train_edge_recon_loss: 255624.8305; train_gene_expr_recon_loss: 126414.0449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384830.0754; train_optim_loss: 384830.0754; val_kl_reg_loss: 2431.3882; val_edge_recon_loss: 255991.2879; val_gene_expr_recon_loss: 126485.8820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384908.5563; val_optim_loss: 384908.5563
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9962; val_auprc_score: 0.9942; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 2790.4853; train_edge_recon_loss: 255585.9871; train_gene_expr_recon_loss: 126385.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384762.4508; train_optim_loss: 384762.4508; val_kl_reg_loss: 2431.5717; val_edge_recon_loss: 255006.3531; val_gene_expr_recon_loss: 126407.1479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383845.0719; val_optim_loss: 383845.0719

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 11 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9960
Val AUPRC score: 0.9923
Val best accuracy score: 0.9835
Val best F1 score: 0.9836
Val gene expr MSE score: 0.8539
Duration of model training in run 9: 0 hours, 16 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8212
Number of validation nodes: 912
Number of training edges: 90939
Number of validation edges: 10104
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9675; val_auprc_score: 0.9551; val_best_acc_score: 0.9195; val_best_f1_score: 0.9223; train_kl_reg_loss: 3229.0314; train_edge_recon_loss: 278967.8413; train_gene_expr_recon_loss: 143452.1463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425649.0191; train_optim_loss: 425649.0191; val_kl_reg_loss: 3493.9041; val_edge_recon_loss: 263270.9223; val_gene_expr_recon_loss: 142177.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408942.5430; val_optim_loss: 408942.5430
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9801; val_auprc_score: 0.9694; val_best_acc_score: 0.9470; val_best_f1_score: 0.9484; train_kl_reg_loss: 3479.3841; train_edge_recon_loss: 261871.7524; train_gene_expr_recon_loss: 138347.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403698.3404; train_optim_loss: 403698.3404; val_kl_reg_loss: 3367.6688; val_edge_recon_loss: 260075.9215; val_gene_expr_recon_loss: 139378.7947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402822.3859; val_optim_loss: 402822.3859
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9843; val_auprc_score: 0.9761; val_best_acc_score: 0.9543; val_best_f1_score: 0.9551; train_kl_reg_loss: 3431.7064; train_edge_recon_loss: 259613.0570; train_gene_expr_recon_loss: 135902.1752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398946.9398; train_optim_loss: 398946.9398; val_kl_reg_loss: 3400.4961; val_edge_recon_loss: 259080.1051; val_gene_expr_recon_loss: 137239.0277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399719.6266; val_optim_loss: 399719.6266
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9850; val_auprc_score: 0.9789; val_best_acc_score: 0.9565; val_best_f1_score: 0.9577; train_kl_reg_loss: 3404.4209; train_edge_recon_loss: 258431.6904; train_gene_expr_recon_loss: 134072.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395908.4036; train_optim_loss: 395908.4036; val_kl_reg_loss: 3307.5034; val_edge_recon_loss: 258951.4781; val_gene_expr_recon_loss: 135837.8605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398096.8453; val_optim_loss: 398096.8453
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9884; val_auprc_score: 0.9827; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 3385.6789; train_edge_recon_loss: 258513.9913; train_gene_expr_recon_loss: 132792.7041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394692.3738; train_optim_loss: 394692.3738; val_kl_reg_loss: 3362.6889; val_edge_recon_loss: 257104.7566; val_gene_expr_recon_loss: 134515.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394983.2031; val_optim_loss: 394983.2031
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9910; val_auprc_score: 0.9860; val_best_acc_score: 0.9661; val_best_f1_score: 0.9666; train_kl_reg_loss: 3378.6535; train_edge_recon_loss: 258237.1572; train_gene_expr_recon_loss: 131583.7814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393199.5922; train_optim_loss: 393199.5922; val_kl_reg_loss: 3408.2618; val_edge_recon_loss: 256384.0234; val_gene_expr_recon_loss: 133737.9184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393530.2070; val_optim_loss: 393530.2070
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9891; val_auprc_score: 0.9830; val_best_acc_score: 0.9657; val_best_f1_score: 0.9664; train_kl_reg_loss: 3381.6679; train_edge_recon_loss: 257810.9841; train_gene_expr_recon_loss: 130743.6299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391936.2812; train_optim_loss: 391936.2812; val_kl_reg_loss: 3252.3103; val_edge_recon_loss: 257496.7277; val_gene_expr_recon_loss: 133001.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393750.4984; val_optim_loss: 393750.4984
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9901; val_auprc_score: 0.9849; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 3384.0847; train_edge_recon_loss: 257495.5404; train_gene_expr_recon_loss: 130005.1911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390884.8158; train_optim_loss: 390884.8158; val_kl_reg_loss: 3323.6475; val_edge_recon_loss: 257396.5895; val_gene_expr_recon_loss: 132542.1291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393262.3672; val_optim_loss: 393262.3672
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9926; val_auprc_score: 0.9890; val_best_acc_score: 0.9716; val_best_f1_score: 0.9721; train_kl_reg_loss: 3389.7715; train_edge_recon_loss: 256938.1457; train_gene_expr_recon_loss: 129461.0907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389789.0088; train_optim_loss: 389789.0088; val_kl_reg_loss: 3452.8113; val_edge_recon_loss: 256797.0973; val_gene_expr_recon_loss: 131777.2596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392027.1672; val_optim_loss: 392027.1672
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9930; val_auprc_score: 0.9892; val_best_acc_score: 0.9745; val_best_f1_score: 0.9750; train_kl_reg_loss: 3399.5672; train_edge_recon_loss: 256949.6613; train_gene_expr_recon_loss: 128885.3275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389234.5568; train_optim_loss: 389234.5568; val_kl_reg_loss: 3337.6868; val_edge_recon_loss: 257014.8910; val_gene_expr_recon_loss: 131470.4955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391823.0680; val_optim_loss: 391823.0680
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9929; val_auprc_score: 0.9882; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 3394.7344; train_edge_recon_loss: 256969.8774; train_gene_expr_recon_loss: 128499.2110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388863.8225; train_optim_loss: 388863.8225; val_kl_reg_loss: 3283.9560; val_edge_recon_loss: 256101.7000; val_gene_expr_recon_loss: 131119.9621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390505.6195; val_optim_loss: 390505.6195
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9929; val_auprc_score: 0.9882; val_best_acc_score: 0.9765; val_best_f1_score: 0.9769; train_kl_reg_loss: 3397.7288; train_edge_recon_loss: 256794.4936; train_gene_expr_recon_loss: 128168.6978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388360.9195; train_optim_loss: 388360.9195; val_kl_reg_loss: 3322.0187; val_edge_recon_loss: 256431.6230; val_gene_expr_recon_loss: 130935.0348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390688.6789; val_optim_loss: 390688.6789
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9933; val_auprc_score: 0.9888; val_best_acc_score: 0.9761; val_best_f1_score: 0.9765; train_kl_reg_loss: 3405.3319; train_edge_recon_loss: 256468.2205; train_gene_expr_recon_loss: 127940.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387814.3653; train_optim_loss: 387814.3653; val_kl_reg_loss: 3366.3063; val_edge_recon_loss: 256596.6383; val_gene_expr_recon_loss: 131002.0072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390964.9531; val_optim_loss: 390964.9531
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9941; val_auprc_score: 0.9901; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 3398.8725; train_edge_recon_loss: 256604.6014; train_gene_expr_recon_loss: 127752.2899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387755.7633; train_optim_loss: 387755.7633; val_kl_reg_loss: 3374.5929; val_edge_recon_loss: 256410.9242; val_gene_expr_recon_loss: 130443.6609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390229.1805; val_optim_loss: 390229.1805
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9943; val_auprc_score: 0.9909; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 3403.4123; train_edge_recon_loss: 256436.1414; train_gene_expr_recon_loss: 127549.3381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387388.8912; train_optim_loss: 387388.8912; val_kl_reg_loss: 3321.4017; val_edge_recon_loss: 255822.0191; val_gene_expr_recon_loss: 130592.7053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389736.1258; val_optim_loss: 389736.1258
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9936; val_auprc_score: 0.9891; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 3410.4467; train_edge_recon_loss: 256404.8318; train_gene_expr_recon_loss: 127328.6964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387143.9752; train_optim_loss: 387143.9752; val_kl_reg_loss: 3349.0214; val_edge_recon_loss: 256914.3773; val_gene_expr_recon_loss: 130345.5432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390608.9430; val_optim_loss: 390608.9430
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9950; val_auprc_score: 0.9917; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 3415.4028; train_edge_recon_loss: 256119.4762; train_gene_expr_recon_loss: 127176.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386711.3538; train_optim_loss: 386711.3538; val_kl_reg_loss: 3402.2711; val_edge_recon_loss: 255878.4234; val_gene_expr_recon_loss: 130292.4937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389573.1859; val_optim_loss: 389573.1859
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9949; val_auprc_score: 0.9925; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 3416.3002; train_edge_recon_loss: 255977.6965; train_gene_expr_recon_loss: 126986.9243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386380.9210; train_optim_loss: 386380.9210; val_kl_reg_loss: 3335.2614; val_edge_recon_loss: 255903.7305; val_gene_expr_recon_loss: 130257.5209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389496.5094; val_optim_loss: 389496.5094
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9959; val_auprc_score: 0.9934; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 3419.4632; train_edge_recon_loss: 256019.6039; train_gene_expr_recon_loss: 126866.7537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386305.8206; train_optim_loss: 386305.8206; val_kl_reg_loss: 3511.4495; val_edge_recon_loss: 256021.1496; val_gene_expr_recon_loss: 130202.3938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389734.9906; val_optim_loss: 389734.9906
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9947; val_auprc_score: 0.9895; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 3420.0624; train_edge_recon_loss: 256240.4503; train_gene_expr_recon_loss: 126725.5402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386386.0530; train_optim_loss: 386386.0530; val_kl_reg_loss: 3368.5457; val_edge_recon_loss: 255689.4937; val_gene_expr_recon_loss: 130102.9588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389161.0016; val_optim_loss: 389161.0016
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9934; val_best_acc_score: 0.9823; val_best_f1_score: 0.9826; train_kl_reg_loss: 3424.7770; train_edge_recon_loss: 256021.7448; train_gene_expr_recon_loss: 126493.6040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385940.1260; train_optim_loss: 385940.1260; val_kl_reg_loss: 3483.2332; val_edge_recon_loss: 255986.5723; val_gene_expr_recon_loss: 130051.6119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389521.4172; val_optim_loss: 389521.4172
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9959; val_auprc_score: 0.9931; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 3426.5154; train_edge_recon_loss: 255958.3337; train_gene_expr_recon_loss: 126408.5053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385793.3556; train_optim_loss: 385793.3556; val_kl_reg_loss: 3361.5194; val_edge_recon_loss: 255637.1516; val_gene_expr_recon_loss: 130060.8389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389059.5070; val_optim_loss: 389059.5070
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9960; val_auprc_score: 0.9942; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 3433.7635; train_edge_recon_loss: 255886.3518; train_gene_expr_recon_loss: 126315.9876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385636.1029; train_optim_loss: 385636.1029; val_kl_reg_loss: 3437.0941; val_edge_recon_loss: 255171.9355; val_gene_expr_recon_loss: 130077.5092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388686.5383; val_optim_loss: 388686.5383
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9956; val_auprc_score: 0.9928; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 3434.9175; train_edge_recon_loss: 256177.3933; train_gene_expr_recon_loss: 126224.9068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385837.2174; train_optim_loss: 385837.2174; val_kl_reg_loss: 3404.1977; val_edge_recon_loss: 255707.8195; val_gene_expr_recon_loss: 129889.8949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389001.9156; val_optim_loss: 389001.9156
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9958; val_auprc_score: 0.9921; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 3437.2375; train_edge_recon_loss: 255714.7674; train_gene_expr_recon_loss: 126056.6347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385208.6389; train_optim_loss: 385208.6389; val_kl_reg_loss: 3323.3794; val_edge_recon_loss: 255555.9258; val_gene_expr_recon_loss: 130092.1748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388971.4797; val_optim_loss: 388971.4797
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9963; val_auprc_score: 0.9935; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 2786.8268; train_edge_recon_loss: 255809.9208; train_gene_expr_recon_loss: 126144.9189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384741.6663; train_optim_loss: 384741.6663; val_kl_reg_loss: 2345.3901; val_edge_recon_loss: 255661.5051; val_gene_expr_recon_loss: 130130.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388137.7219; val_optim_loss: 388137.7219
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9968; val_auprc_score: 0.9954; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2543.3550; train_edge_recon_loss: 255607.5231; train_gene_expr_recon_loss: 126008.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384159.4808; train_optim_loss: 384159.4808; val_kl_reg_loss: 2234.8166; val_edge_recon_loss: 255047.6277; val_gene_expr_recon_loss: 130093.6301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387376.0734; val_optim_loss: 387376.0734
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9966; val_auprc_score: 0.9940; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2452.0386; train_edge_recon_loss: 255484.8945; train_gene_expr_recon_loss: 125932.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383868.9889; train_optim_loss: 383868.9889; val_kl_reg_loss: 2174.3071; val_edge_recon_loss: 255389.8801; val_gene_expr_recon_loss: 130101.1840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387665.3703; val_optim_loss: 387665.3703
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9967; val_auprc_score: 0.9946; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 2400.9129; train_edge_recon_loss: 255524.6250; train_gene_expr_recon_loss: 125840.9510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383766.4890; train_optim_loss: 383766.4890; val_kl_reg_loss: 2224.2719; val_edge_recon_loss: 255388.9414; val_gene_expr_recon_loss: 130051.2336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387664.4484; val_optim_loss: 387664.4484
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9966; val_auprc_score: 0.9937; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2357.1678; train_edge_recon_loss: 255497.1622; train_gene_expr_recon_loss: 125789.3360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383643.6655; train_optim_loss: 383643.6655; val_kl_reg_loss: 2134.3042; val_edge_recon_loss: 255307.9344; val_gene_expr_recon_loss: 129982.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387425.0297; val_optim_loss: 387425.0297

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9968; val_auprc_score: 0.9957; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 2336.5911; train_edge_recon_loss: 255282.4583; train_gene_expr_recon_loss: 125366.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382985.6059; train_optim_loss: 382985.6059; val_kl_reg_loss: 2213.9615; val_edge_recon_loss: 255099.4504; val_gene_expr_recon_loss: 129969.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387283.3992; val_optim_loss: 387283.3992
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9964; val_auprc_score: 0.9920; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2339.1295; train_edge_recon_loss: 255297.6024; train_gene_expr_recon_loss: 125240.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382876.9172; train_optim_loss: 382876.9172; val_kl_reg_loss: 2193.0651; val_edge_recon_loss: 255810.8250; val_gene_expr_recon_loss: 129864.1566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387868.0484; val_optim_loss: 387868.0484
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9966; val_auprc_score: 0.9939; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2329.1776; train_edge_recon_loss: 255269.7557; train_gene_expr_recon_loss: 125179.3140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382778.2475; train_optim_loss: 382778.2475; val_kl_reg_loss: 2208.7586; val_edge_recon_loss: 255306.2824; val_gene_expr_recon_loss: 130181.1266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387696.1695; val_optim_loss: 387696.1695
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9967; val_auprc_score: 0.9950; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 2323.1277; train_edge_recon_loss: 255361.9698; train_gene_expr_recon_loss: 125120.4190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382805.5168; train_optim_loss: 382805.5168; val_kl_reg_loss: 2191.4620; val_edge_recon_loss: 255186.1484; val_gene_expr_recon_loss: 130230.8791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387608.4906; val_optim_loss: 387608.4906

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9969; val_auprc_score: 0.9947; val_best_acc_score: 0.9867; val_best_f1_score: 0.9868; train_kl_reg_loss: 2313.8643; train_edge_recon_loss: 255277.9441; train_gene_expr_recon_loss: 125111.0923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382702.9008; train_optim_loss: 382702.9008; val_kl_reg_loss: 2196.3136; val_edge_recon_loss: 255219.5508; val_gene_expr_recon_loss: 129815.2920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387231.1594; val_optim_loss: 387231.1594
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9969; val_auprc_score: 0.9949; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 2315.9458; train_edge_recon_loss: 255341.6320; train_gene_expr_recon_loss: 125056.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382714.3868; train_optim_loss: 382714.3868; val_kl_reg_loss: 2199.7474; val_edge_recon_loss: 255682.2527; val_gene_expr_recon_loss: 129996.0719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387878.0742; val_optim_loss: 387878.0742
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9968; val_auprc_score: 0.9945; val_best_acc_score: 0.9866; val_best_f1_score: 0.9867; train_kl_reg_loss: 2316.5530; train_edge_recon_loss: 255359.5201; train_gene_expr_recon_loss: 125125.7624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382801.8352; train_optim_loss: 382801.8352; val_kl_reg_loss: 2198.9037; val_edge_recon_loss: 255164.2727; val_gene_expr_recon_loss: 129877.2264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387240.4023; val_optim_loss: 387240.4023
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9971; val_auprc_score: 0.9949; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 2314.0101; train_edge_recon_loss: 255197.0306; train_gene_expr_recon_loss: 125057.4291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382568.4701; train_optim_loss: 382568.4701; val_kl_reg_loss: 2200.0247; val_edge_recon_loss: 254795.1023; val_gene_expr_recon_loss: 129929.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386924.9117; val_optim_loss: 386924.9117
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9972; val_auprc_score: 0.9941; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 2315.0058; train_edge_recon_loss: 255130.1756; train_gene_expr_recon_loss: 125066.1391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382511.3210; train_optim_loss: 382511.3210; val_kl_reg_loss: 2199.3376; val_edge_recon_loss: 254875.4598; val_gene_expr_recon_loss: 130074.2838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387149.0797; val_optim_loss: 387149.0797
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9967; val_auprc_score: 0.9936; val_best_acc_score: 0.9860; val_best_f1_score: 0.9862; train_kl_reg_loss: 2312.5435; train_edge_recon_loss: 255266.3372; train_gene_expr_recon_loss: 125076.8965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382655.7767; train_optim_loss: 382655.7767; val_kl_reg_loss: 2195.1923; val_edge_recon_loss: 255104.5652; val_gene_expr_recon_loss: 130027.4309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387327.1922; val_optim_loss: 387327.1922
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9968; val_auprc_score: 0.9941; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 2311.2658; train_edge_recon_loss: 255246.8975; train_gene_expr_recon_loss: 125023.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382581.4776; train_optim_loss: 382581.4776; val_kl_reg_loss: 2202.2800; val_edge_recon_loss: 255105.0332; val_gene_expr_recon_loss: 130009.5775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387316.8914; val_optim_loss: 387316.8914

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9970; val_auprc_score: 0.9955; val_best_acc_score: 0.9860; val_best_f1_score: 0.9862; train_kl_reg_loss: 2312.9518; train_edge_recon_loss: 255157.6866; train_gene_expr_recon_loss: 125095.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382566.3532; train_optim_loss: 382566.3532; val_kl_reg_loss: 2202.0077; val_edge_recon_loss: 255275.3316; val_gene_expr_recon_loss: 130074.7023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387552.0430; val_optim_loss: 387552.0430
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9966; val_auprc_score: 0.9928; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 2312.3552; train_edge_recon_loss: 255004.1694; train_gene_expr_recon_loss: 125041.4159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382357.9415; train_optim_loss: 382357.9415; val_kl_reg_loss: 2201.0388; val_edge_recon_loss: 255254.6809; val_gene_expr_recon_loss: 129998.4371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387454.1586; val_optim_loss: 387454.1586
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9968; val_auprc_score: 0.9952; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 2311.9102; train_edge_recon_loss: 255117.8892; train_gene_expr_recon_loss: 125040.8154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382470.6151; train_optim_loss: 382470.6151; val_kl_reg_loss: 2201.3691; val_edge_recon_loss: 254878.8762; val_gene_expr_recon_loss: 130113.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387194.1109; val_optim_loss: 387194.1109

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 8 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9936
Val best accuracy score: 0.9866
Val best F1 score: 0.9867
Val gene expr MSE score: 0.8141
Duration of model training in run 10: 0 hours, 19 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
