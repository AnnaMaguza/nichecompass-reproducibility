Run timestamp: 21062023_135012.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_5pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6655; val_auprc_score: 0.6881; val_best_acc_score: 0.6405; val_best_f1_score: 0.6496; train_kl_reg_loss: 1196.9113; train_edge_recon_loss: 366692.7969; train_cond_contrastive_loss: 141211.2188; train_gene_expr_recon_loss: 142821.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 651922.4062; train_optim_loss: 651922.4062; val_kl_reg_loss: 2102.4814; val_edge_recon_loss: 424022.4062; val_cond_contrastive_loss: 78425.9062; val_gene_expr_recon_loss: 119203.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 623754.3750; val_optim_loss: 623754.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6549; val_auprc_score: 0.6798; val_best_acc_score: 0.6294; val_best_f1_score: 0.6491; train_kl_reg_loss: 2826.5862; train_edge_recon_loss: 381155.7812; train_cond_contrastive_loss: 101629.6719; train_gene_expr_recon_loss: 116484.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 602097.0000; train_optim_loss: 602097.0000; val_kl_reg_loss: 5272.2544; val_edge_recon_loss: 422735.3125; val_cond_contrastive_loss: 78395.4297; val_gene_expr_recon_loss: 109252.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 615655.7500; val_optim_loss: 615655.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6457; val_auprc_score: 0.6688; val_best_acc_score: 0.6253; val_best_f1_score: 0.6470; train_kl_reg_loss: 8435.9614; train_edge_recon_loss: 383444.8125; train_cond_contrastive_loss: 88103.9258; train_gene_expr_recon_loss: 109583.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 589568.0000; train_optim_loss: 589568.0000; val_kl_reg_loss: 9529.4004; val_edge_recon_loss: 420466.0938; val_cond_contrastive_loss: 78402.2734; val_gene_expr_recon_loss: 105438.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 613835.9375; val_optim_loss: 613835.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6300; val_auprc_score: 0.6495; val_best_acc_score: 0.6095; val_best_f1_score: 0.6493; train_kl_reg_loss: 9283.8901; train_edge_recon_loss: 377678.4688; train_cond_contrastive_loss: 87230.5977; train_gene_expr_recon_loss: 106353.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 580546.6562; train_optim_loss: 580546.6562; val_kl_reg_loss: 6303.5820; val_edge_recon_loss: 413298.5938; val_cond_contrastive_loss: 78424.1250; val_gene_expr_recon_loss: 104135.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602161.9375; val_optim_loss: 602161.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6378; val_auprc_score: 0.6568; val_best_acc_score: 0.6039; val_best_f1_score: 0.6522; train_kl_reg_loss: 6214.9729; train_edge_recon_loss: 374396.5781; train_cond_contrastive_loss: 87432.1055; train_gene_expr_recon_loss: 104324.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 572368.3438; train_optim_loss: 572368.3438; val_kl_reg_loss: 4882.5981; val_edge_recon_loss: 399467.1250; val_cond_contrastive_loss: 78464.1875; val_gene_expr_recon_loss: 103416.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 586230.1250; val_optim_loss: 586230.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6250; val_auprc_score: 0.6375; val_best_acc_score: 0.6010; val_best_f1_score: 0.6406; train_kl_reg_loss: 4842.6755; train_edge_recon_loss: 369934.5938; train_cond_contrastive_loss: 87869.4648; train_gene_expr_recon_loss: 103681.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 566327.8438; train_optim_loss: 566327.8438; val_kl_reg_loss: 4043.6907; val_edge_recon_loss: 396238.8125; val_cond_contrastive_loss: 78512.7109; val_gene_expr_recon_loss: 103020.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 581815.8750; val_optim_loss: 581815.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6343; val_auprc_score: 0.6486; val_best_acc_score: 0.6109; val_best_f1_score: 0.6564; train_kl_reg_loss: 4014.5596; train_edge_recon_loss: 361804.2344; train_cond_contrastive_loss: 88093.3594; train_gene_expr_recon_loss: 103166.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557079.0625; train_optim_loss: 557079.0625; val_kl_reg_loss: 3486.1855; val_edge_recon_loss: 373798.2812; val_cond_contrastive_loss: 78509.2812; val_gene_expr_recon_loss: 102722.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558515.8750; val_optim_loss: 558515.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6394; val_auprc_score: 0.6592; val_best_acc_score: 0.6133; val_best_f1_score: 0.6535; train_kl_reg_loss: 3496.9725; train_edge_recon_loss: 352326.2969; train_cond_contrastive_loss: 86139.1133; train_gene_expr_recon_loss: 102783.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544745.6875; train_optim_loss: 544745.6875; val_kl_reg_loss: 3326.6021; val_edge_recon_loss: 369846.7500; val_cond_contrastive_loss: 78446.2734; val_gene_expr_recon_loss: 102471.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554091.5000; val_optim_loss: 554091.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6441; val_auprc_score: 0.6587; val_best_acc_score: 0.6148; val_best_f1_score: 0.6531; train_kl_reg_loss: 3407.1787; train_edge_recon_loss: 347946.4688; train_cond_contrastive_loss: 83268.0898; train_gene_expr_recon_loss: 102577.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537199.4062; train_optim_loss: 537199.4062; val_kl_reg_loss: 3451.2769; val_edge_recon_loss: 370516.9688; val_cond_contrastive_loss: 78405.4453; val_gene_expr_recon_loss: 102218.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554591.7500; val_optim_loss: 554591.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6591; val_auprc_score: 0.6738; val_best_acc_score: 0.6177; val_best_f1_score: 0.6532; train_kl_reg_loss: 3550.9232; train_edge_recon_loss: 346644.4062; train_cond_contrastive_loss: 81550.9023; train_gene_expr_recon_loss: 102168.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533914.7188; train_optim_loss: 533914.7188; val_kl_reg_loss: 3613.2466; val_edge_recon_loss: 364473.7812; val_cond_contrastive_loss: 78394.6719; val_gene_expr_recon_loss: 101944.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 548425.7500; val_optim_loss: 548425.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6565; val_auprc_score: 0.6703; val_best_acc_score: 0.6251; val_best_f1_score: 0.6488; train_kl_reg_loss: 3687.7941; train_edge_recon_loss: 347756.2969; train_cond_contrastive_loss: 80793.9805; train_gene_expr_recon_loss: 101976.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534214.9375; train_optim_loss: 534214.9375; val_kl_reg_loss: 3657.4448; val_edge_recon_loss: 370972.8438; val_cond_contrastive_loss: 78386.8750; val_gene_expr_recon_loss: 101652.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554669.6250; val_optim_loss: 554669.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6697; val_auprc_score: 0.6813; val_best_acc_score: 0.6352; val_best_f1_score: 0.6523; train_kl_reg_loss: 3702.4565; train_edge_recon_loss: 345265.2500; train_cond_contrastive_loss: 80493.6484; train_gene_expr_recon_loss: 101684.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531145.6875; train_optim_loss: 531145.6875; val_kl_reg_loss: 3640.1543; val_edge_recon_loss: 363559.6250; val_cond_contrastive_loss: 78388.3828; val_gene_expr_recon_loss: 101406.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546994.4375; val_optim_loss: 546994.4375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6801; val_auprc_score: 0.6887; val_best_acc_score: 0.6394; val_best_f1_score: 0.6565; train_kl_reg_loss: 3675.7489; train_edge_recon_loss: 342639.2812; train_cond_contrastive_loss: 80434.4297; train_gene_expr_recon_loss: 101696.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528445.9062; train_optim_loss: 528445.9062; val_kl_reg_loss: 3651.0386; val_edge_recon_loss: 359718.8438; val_cond_contrastive_loss: 78389.6016; val_gene_expr_recon_loss: 101207.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542967.2500; val_optim_loss: 542967.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7005; val_auprc_score: 0.7081; val_best_acc_score: 0.6512; val_best_f1_score: 0.6716; train_kl_reg_loss: 3690.1802; train_edge_recon_loss: 340666.8906; train_cond_contrastive_loss: 80501.7109; train_gene_expr_recon_loss: 101327.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 526186.0312; train_optim_loss: 526186.0312; val_kl_reg_loss: 3719.5337; val_edge_recon_loss: 351613.0000; val_cond_contrastive_loss: 78389.4922; val_gene_expr_recon_loss: 101054.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534776.3125; val_optim_loss: 534776.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7139; val_auprc_score: 0.7124; val_best_acc_score: 0.6644; val_best_f1_score: 0.6667; train_kl_reg_loss: 3801.0422; train_edge_recon_loss: 336101.2344; train_cond_contrastive_loss: 80325.9297; train_gene_expr_recon_loss: 101264.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521493.1875; train_optim_loss: 521493.1875; val_kl_reg_loss: 3917.5813; val_edge_recon_loss: 348101.7812; val_cond_contrastive_loss: 78401.2344; val_gene_expr_recon_loss: 100914.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 531335.1250; val_optim_loss: 531335.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7458; val_auprc_score: 0.7308; val_best_acc_score: 0.6808; val_best_f1_score: 0.6874; train_kl_reg_loss: 4056.5558; train_edge_recon_loss: 328755.2656; train_cond_contrastive_loss: 79902.2812; train_gene_expr_recon_loss: 100976.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513690.7812; train_optim_loss: 513690.7812; val_kl_reg_loss: 4348.0635; val_edge_recon_loss: 336650.1562; val_cond_contrastive_loss: 78406.2578; val_gene_expr_recon_loss: 100740.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 520145.4375; val_optim_loss: 520145.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7652; val_auprc_score: 0.7359; val_best_acc_score: 0.6914; val_best_f1_score: 0.7091; train_kl_reg_loss: 4554.9695; train_edge_recon_loss: 322930.7344; train_cond_contrastive_loss: 79498.7266; train_gene_expr_recon_loss: 100853.8633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507838.2969; train_optim_loss: 507838.2969; val_kl_reg_loss: 4984.3604; val_edge_recon_loss: 325696.2500; val_cond_contrastive_loss: 78424.4141; val_gene_expr_recon_loss: 100521.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509626.2812; val_optim_loss: 509626.2812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7869; val_auprc_score: 0.7512; val_best_acc_score: 0.7083; val_best_f1_score: 0.7280; train_kl_reg_loss: 5276.9736; train_edge_recon_loss: 315465.0156; train_cond_contrastive_loss: 79124.7148; train_gene_expr_recon_loss: 100620.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500487.2188; train_optim_loss: 500487.2188; val_kl_reg_loss: 5778.8438; val_edge_recon_loss: 320134.0000; val_cond_contrastive_loss: 78432.2500; val_gene_expr_recon_loss: 100238.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 504583.8750; val_optim_loss: 504583.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8075; val_auprc_score: 0.7734; val_best_acc_score: 0.7257; val_best_f1_score: 0.7468; train_kl_reg_loss: 6114.3193; train_edge_recon_loss: 308503.9844; train_cond_contrastive_loss: 78864.5547; train_gene_expr_recon_loss: 100144.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493626.9844; train_optim_loss: 493626.9844; val_kl_reg_loss: 6627.6475; val_edge_recon_loss: 312152.5625; val_cond_contrastive_loss: 78425.2656; val_gene_expr_recon_loss: 99942.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497147.7500; val_optim_loss: 497147.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7935; val_auprc_score: 0.7485; val_best_acc_score: 0.7238; val_best_f1_score: 0.7498; train_kl_reg_loss: 6950.2939; train_edge_recon_loss: 308725.4844; train_cond_contrastive_loss: 78709.2031; train_gene_expr_recon_loss: 100058.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494443.7812; train_optim_loss: 494443.7812; val_kl_reg_loss: 7255.6982; val_edge_recon_loss: 313160.9062; val_cond_contrastive_loss: 78417.1016; val_gene_expr_recon_loss: 99669.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498503.0938; val_optim_loss: 498503.0938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8144; val_auprc_score: 0.7667; val_best_acc_score: 0.7476; val_best_f1_score: 0.7687; train_kl_reg_loss: 7557.7256; train_edge_recon_loss: 300950.8281; train_cond_contrastive_loss: 78670.0039; train_gene_expr_recon_loss: 99728.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486906.6406; train_optim_loss: 486906.6406; val_kl_reg_loss: 7776.2129; val_edge_recon_loss: 305236.5000; val_cond_contrastive_loss: 78414.8438; val_gene_expr_recon_loss: 99396.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490824.3438; val_optim_loss: 490824.3438
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8164; val_auprc_score: 0.7623; val_best_acc_score: 0.7428; val_best_f1_score: 0.7685; train_kl_reg_loss: 8026.4648; train_edge_recon_loss: 301767.0938; train_cond_contrastive_loss: 78649.9453; train_gene_expr_recon_loss: 99394.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487838.3438; train_optim_loss: 487838.3438; val_kl_reg_loss: 8097.3345; val_edge_recon_loss: 304703.8438; val_cond_contrastive_loss: 78403.3359; val_gene_expr_recon_loss: 99146.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490350.8125; val_optim_loss: 490350.8125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8141; val_auprc_score: 0.7630; val_best_acc_score: 0.7384; val_best_f1_score: 0.7675; train_kl_reg_loss: 8337.6968; train_edge_recon_loss: 299697.4375; train_cond_contrastive_loss: 78634.8516; train_gene_expr_recon_loss: 99122.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485792.4688; train_optim_loss: 485792.4688; val_kl_reg_loss: 8223.8027; val_edge_recon_loss: 303995.5312; val_cond_contrastive_loss: 78401.5000; val_gene_expr_recon_loss: 98933.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489554.5938; val_optim_loss: 489554.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8385; val_auprc_score: 0.7864; val_best_acc_score: 0.7637; val_best_f1_score: 0.7811; train_kl_reg_loss: 8385.0220; train_edge_recon_loss: 299585.7812; train_cond_contrastive_loss: 78653.3438; train_gene_expr_recon_loss: 98926.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485550.2500; train_optim_loss: 485550.2500; val_kl_reg_loss: 8127.5020; val_edge_recon_loss: 297475.5625; val_cond_contrastive_loss: 78397.6953; val_gene_expr_recon_loss: 98757.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482757.9375; val_optim_loss: 482757.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8341; val_auprc_score: 0.7713; val_best_acc_score: 0.7652; val_best_f1_score: 0.7725; train_kl_reg_loss: 8238.9375; train_edge_recon_loss: 296631.4531; train_cond_contrastive_loss: 78699.5742; train_gene_expr_recon_loss: 98950.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482519.9844; train_optim_loss: 482519.9844; val_kl_reg_loss: 7873.5034; val_edge_recon_loss: 302989.0000; val_cond_contrastive_loss: 78396.8125; val_gene_expr_recon_loss: 98613.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487873.0625; val_optim_loss: 487873.0625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8264; val_auprc_score: 0.7611; val_best_acc_score: 0.7578; val_best_f1_score: 0.7697; train_kl_reg_loss: 7934.7319; train_edge_recon_loss: 299628.3281; train_cond_contrastive_loss: 78776.7070; train_gene_expr_recon_loss: 98715.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485055.1875; train_optim_loss: 485055.1875; val_kl_reg_loss: 7503.5518; val_edge_recon_loss: 305993.9375; val_cond_contrastive_loss: 78402.3828; val_gene_expr_recon_loss: 98469.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490369.0000; val_optim_loss: 490369.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8427; val_auprc_score: 0.7846; val_best_acc_score: 0.7770; val_best_f1_score: 0.7841; train_kl_reg_loss: 7610.4695; train_edge_recon_loss: 297581.2031; train_cond_contrastive_loss: 78853.4609; train_gene_expr_recon_loss: 98542.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482587.7969; train_optim_loss: 482587.7969; val_kl_reg_loss: 7219.4443; val_edge_recon_loss: 297429.3750; val_cond_contrastive_loss: 78402.4531; val_gene_expr_recon_loss: 98317.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481368.6562; val_optim_loss: 481368.6562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8457; val_auprc_score: 0.7905; val_best_acc_score: 0.7812; val_best_f1_score: 0.7910; train_kl_reg_loss: 7313.4883; train_edge_recon_loss: 295389.4375; train_cond_contrastive_loss: 78923.9883; train_gene_expr_recon_loss: 98276.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479903.8438; train_optim_loss: 479903.8438; val_kl_reg_loss: 6983.7954; val_edge_recon_loss: 296743.8125; val_cond_contrastive_loss: 78412.4297; val_gene_expr_recon_loss: 98174.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480314.7500; val_optim_loss: 480314.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8584; val_auprc_score: 0.8021; val_best_acc_score: 0.7886; val_best_f1_score: 0.7982; train_kl_reg_loss: 7099.4902; train_edge_recon_loss: 294935.8906; train_cond_contrastive_loss: 78965.1680; train_gene_expr_recon_loss: 98304.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479305.3906; train_optim_loss: 479305.3906; val_kl_reg_loss: 6850.2686; val_edge_recon_loss: 296804.0312; val_cond_contrastive_loss: 78417.9609; val_gene_expr_recon_loss: 98016.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480089.2188; val_optim_loss: 480089.2188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8512; val_auprc_score: 0.7976; val_best_acc_score: 0.7854; val_best_f1_score: 0.8008; train_kl_reg_loss: 6998.1033; train_edge_recon_loss: 292088.2812; train_cond_contrastive_loss: 78966.0117; train_gene_expr_recon_loss: 98142.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476195.2031; train_optim_loss: 476195.2031; val_kl_reg_loss: 6848.2500; val_edge_recon_loss: 296099.4688; val_cond_contrastive_loss: 78432.7109; val_gene_expr_recon_loss: 97852.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479232.8125; val_optim_loss: 479232.8125
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8622; val_auprc_score: 0.8013; val_best_acc_score: 0.8009; val_best_f1_score: 0.8125; train_kl_reg_loss: 6971.8823; train_edge_recon_loss: 292934.5312; train_cond_contrastive_loss: 78933.8672; train_gene_expr_recon_loss: 97930.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476770.6875; train_optim_loss: 476770.6875; val_kl_reg_loss: 6848.4658; val_edge_recon_loss: 291109.9688; val_cond_contrastive_loss: 78446.8359; val_gene_expr_recon_loss: 97718.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474123.5625; val_optim_loss: 474123.5625
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8676; val_auprc_score: 0.8142; val_best_acc_score: 0.7983; val_best_f1_score: 0.8117; train_kl_reg_loss: 6991.5620; train_edge_recon_loss: 291412.4375; train_cond_contrastive_loss: 78887.8359; train_gene_expr_recon_loss: 97702.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474994.6562; train_optim_loss: 474994.6562; val_kl_reg_loss: 6856.0762; val_edge_recon_loss: 296196.9062; val_cond_contrastive_loss: 78459.4219; val_gene_expr_recon_loss: 97615.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479127.5312; val_optim_loss: 479127.5312
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8950; val_auprc_score: 0.8523; val_best_acc_score: 0.8236; val_best_f1_score: 0.8275; train_kl_reg_loss: 7004.7456; train_edge_recon_loss: 290761.0156; train_cond_contrastive_loss: 78846.3086; train_gene_expr_recon_loss: 97705.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474317.8438; train_optim_loss: 474317.8438; val_kl_reg_loss: 6808.4756; val_edge_recon_loss: 290351.2812; val_cond_contrastive_loss: 78468.9766; val_gene_expr_recon_loss: 97493.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473122.4375; val_optim_loss: 473122.4375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8974; val_auprc_score: 0.8624; val_best_acc_score: 0.8263; val_best_f1_score: 0.8377; train_kl_reg_loss: 6933.8801; train_edge_recon_loss: 289692.4844; train_cond_contrastive_loss: 78839.3359; train_gene_expr_recon_loss: 97613.3555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473079.0625; train_optim_loss: 473079.0625; val_kl_reg_loss: 6675.8096; val_edge_recon_loss: 281831.7500; val_cond_contrastive_loss: 78486.2969; val_gene_expr_recon_loss: 97377.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464371.0625; val_optim_loss: 464371.0625
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8991; val_auprc_score: 0.8632; val_best_acc_score: 0.8188; val_best_f1_score: 0.8249; train_kl_reg_loss: 6789.7617; train_edge_recon_loss: 289211.2188; train_cond_contrastive_loss: 78850.1328; train_gene_expr_recon_loss: 97642.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472494.0000; train_optim_loss: 472494.0000; val_kl_reg_loss: 6510.2607; val_edge_recon_loss: 292277.5938; val_cond_contrastive_loss: 78489.1406; val_gene_expr_recon_loss: 97300.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474577.3125; val_optim_loss: 474577.3125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9065; val_auprc_score: 0.8747; val_best_acc_score: 0.8259; val_best_f1_score: 0.8293; train_kl_reg_loss: 6647.2810; train_edge_recon_loss: 287526.7500; train_cond_contrastive_loss: 78845.6523; train_gene_expr_recon_loss: 97409.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470429.4688; train_optim_loss: 470429.4688; val_kl_reg_loss: 6437.1626; val_edge_recon_loss: 286875.4062; val_cond_contrastive_loss: 78490.5156; val_gene_expr_recon_loss: 97204.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469007.1875; val_optim_loss: 469007.1875
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9094; val_auprc_score: 0.8795; val_best_acc_score: 0.8291; val_best_f1_score: 0.8343; train_kl_reg_loss: 6570.3467; train_edge_recon_loss: 286791.8594; train_cond_contrastive_loss: 78812.2578; train_gene_expr_recon_loss: 97366.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469541.3125; train_optim_loss: 469541.3125; val_kl_reg_loss: 6358.1152; val_edge_recon_loss: 290574.4688; val_cond_contrastive_loss: 78500.6094; val_gene_expr_recon_loss: 97113.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472546.8438; val_optim_loss: 472546.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9175; val_auprc_score: 0.8936; val_best_acc_score: 0.8380; val_best_f1_score: 0.8416; train_kl_reg_loss: 6503.2322; train_edge_recon_loss: 285802.1719; train_cond_contrastive_loss: 78795.2422; train_gene_expr_recon_loss: 97448.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468548.8281; train_optim_loss: 468548.8281; val_kl_reg_loss: 6339.2715; val_edge_recon_loss: 286810.6875; val_cond_contrastive_loss: 78501.0938; val_gene_expr_recon_loss: 97103.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468754.1875; val_optim_loss: 468754.1875
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9189; val_auprc_score: 0.8952; val_best_acc_score: 0.8362; val_best_f1_score: 0.8399; train_kl_reg_loss: 6492.4307; train_edge_recon_loss: 284982.7031; train_cond_contrastive_loss: 78795.8203; train_gene_expr_recon_loss: 97265.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467536.1562; train_optim_loss: 467536.1562; val_kl_reg_loss: 6317.9697; val_edge_recon_loss: 286867.0312; val_cond_contrastive_loss: 78502.2578; val_gene_expr_recon_loss: 97088.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468775.6875; val_optim_loss: 468775.6875
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9171; val_auprc_score: 0.8926; val_best_acc_score: 0.8410; val_best_f1_score: 0.8455; train_kl_reg_loss: 6474.0381; train_edge_recon_loss: 285996.1406; train_cond_contrastive_loss: 78799.8008; train_gene_expr_recon_loss: 97198.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468468.2812; train_optim_loss: 468468.2812; val_kl_reg_loss: 6295.9438; val_edge_recon_loss: 282886.4062; val_cond_contrastive_loss: 78502.8750; val_gene_expr_recon_loss: 97072.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464758.0625; val_optim_loss: 464758.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 51 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.8718
Val AUPRC score: 0.8269
Val best accuracy score: 0.7974
Val best F1 score: 0.8113
Val gene expr MSE score: 1.7859
Duration of model training in run 1: 0 hours, 0 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6858; val_auprc_score: 0.7165; val_best_acc_score: 0.6590; val_best_f1_score: 0.6631; train_kl_reg_loss: 1282.4155; train_edge_recon_loss: 369282.3594; train_cond_contrastive_loss: 137405.6367; train_gene_expr_recon_loss: 145925.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 653895.8125; train_optim_loss: 653895.8125; val_kl_reg_loss: 2290.2202; val_edge_recon_loss: 422112.3125; val_cond_contrastive_loss: 78415.6875; val_gene_expr_recon_loss: 120979.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 623798.0625; val_optim_loss: 623798.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6652; val_auprc_score: 0.6912; val_best_acc_score: 0.6382; val_best_f1_score: 0.6501; train_kl_reg_loss: 2998.9088; train_edge_recon_loss: 386294.1562; train_cond_contrastive_loss: 96851.5547; train_gene_expr_recon_loss: 118109.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 604253.9375; train_optim_loss: 604253.9375; val_kl_reg_loss: 5235.4541; val_edge_recon_loss: 426204.5625; val_cond_contrastive_loss: 78395.8359; val_gene_expr_recon_loss: 110124.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 619960.1250; val_optim_loss: 619960.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6517; val_auprc_score: 0.6848; val_best_acc_score: 0.6302; val_best_f1_score: 0.6604; train_kl_reg_loss: 9270.6165; train_edge_recon_loss: 384451.0938; train_cond_contrastive_loss: 86473.3906; train_gene_expr_recon_loss: 111427.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 591622.1250; train_optim_loss: 591622.1250; val_kl_reg_loss: 9277.0156; val_edge_recon_loss: 414913.9375; val_cond_contrastive_loss: 78414.4375; val_gene_expr_recon_loss: 106199.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 608804.5625; val_optim_loss: 608804.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6489; val_auprc_score: 0.6800; val_best_acc_score: 0.6273; val_best_f1_score: 0.6561; train_kl_reg_loss: 9252.9585; train_edge_recon_loss: 376851.6406; train_cond_contrastive_loss: 87654.8203; train_gene_expr_recon_loss: 107301.5117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 581060.9375; train_optim_loss: 581060.9375; val_kl_reg_loss: 6590.5098; val_edge_recon_loss: 411097.0625; val_cond_contrastive_loss: 78449.6719; val_gene_expr_recon_loss: 104368.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 600505.8750; val_optim_loss: 600505.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6555; val_auprc_score: 0.6763; val_best_acc_score: 0.6057; val_best_f1_score: 0.6550; train_kl_reg_loss: 6572.3867; train_edge_recon_loss: 374900.7344; train_cond_contrastive_loss: 87269.3086; train_gene_expr_recon_loss: 105048.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 573791.0938; train_optim_loss: 573791.0938; val_kl_reg_loss: 5086.4961; val_edge_recon_loss: 398245.2500; val_cond_contrastive_loss: 78521.1328; val_gene_expr_recon_loss: 103529.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 585382.1250; val_optim_loss: 585382.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6544; val_auprc_score: 0.6669; val_best_acc_score: 0.6234; val_best_f1_score: 0.6524; train_kl_reg_loss: 5098.4258; train_edge_recon_loss: 369653.9375; train_cond_contrastive_loss: 87590.3242; train_gene_expr_recon_loss: 104270.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 566613.0625; train_optim_loss: 566613.0625; val_kl_reg_loss: 4038.7678; val_edge_recon_loss: 385491.4688; val_cond_contrastive_loss: 78620.7578; val_gene_expr_recon_loss: 103225.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 571376.8750; val_optim_loss: 571376.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6603; val_auprc_score: 0.6812; val_best_acc_score: 0.6398; val_best_f1_score: 0.6489; train_kl_reg_loss: 4003.1085; train_edge_recon_loss: 360373.7500; train_cond_contrastive_loss: 88105.0977; train_gene_expr_recon_loss: 103634.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556116.4688; train_optim_loss: 556116.4688; val_kl_reg_loss: 3370.9502; val_edge_recon_loss: 374293.8125; val_cond_contrastive_loss: 78615.8828; val_gene_expr_recon_loss: 103015.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559295.6875; val_optim_loss: 559295.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6529; val_auprc_score: 0.6710; val_best_acc_score: 0.6317; val_best_f1_score: 0.6531; train_kl_reg_loss: 3421.6802; train_edge_recon_loss: 350997.2812; train_cond_contrastive_loss: 87276.8711; train_gene_expr_recon_loss: 103312.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545008.2500; train_optim_loss: 545008.2500; val_kl_reg_loss: 3381.7070; val_edge_recon_loss: 369036.8438; val_cond_contrastive_loss: 78522.8125; val_gene_expr_recon_loss: 102866.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553807.6875; val_optim_loss: 553807.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6582; val_auprc_score: 0.6688; val_best_acc_score: 0.6429; val_best_f1_score: 0.6412; train_kl_reg_loss: 3542.8253; train_edge_recon_loss: 344372.1094; train_cond_contrastive_loss: 83451.3398; train_gene_expr_recon_loss: 103110.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534476.9375; train_optim_loss: 534476.9375; val_kl_reg_loss: 3758.7986; val_edge_recon_loss: 376649.1875; val_cond_contrastive_loss: 78479.2344; val_gene_expr_recon_loss: 102563.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561451.0000; val_optim_loss: 561451.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6608; val_auprc_score: 0.6781; val_best_acc_score: 0.6322; val_best_f1_score: 0.6565; train_kl_reg_loss: 3923.2576; train_edge_recon_loss: 345123.0469; train_cond_contrastive_loss: 80959.1680; train_gene_expr_recon_loss: 102856.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532861.6562; train_optim_loss: 532861.6562; val_kl_reg_loss: 4035.1216; val_edge_recon_loss: 364944.9062; val_cond_contrastive_loss: 78472.5312; val_gene_expr_recon_loss: 102191.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 549644.4375; val_optim_loss: 549644.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6718; val_auprc_score: 0.6935; val_best_acc_score: 0.6433; val_best_f1_score: 0.6559; train_kl_reg_loss: 4140.3027; train_edge_recon_loss: 345966.8438; train_cond_contrastive_loss: 80209.0156; train_gene_expr_recon_loss: 102499.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532815.1875; train_optim_loss: 532815.1875; val_kl_reg_loss: 4073.5171; val_edge_recon_loss: 361200.4375; val_cond_contrastive_loss: 78468.0000; val_gene_expr_recon_loss: 101927.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 545669.1250; val_optim_loss: 545669.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6911; val_auprc_score: 0.6956; val_best_acc_score: 0.6562; val_best_f1_score: 0.6581; train_kl_reg_loss: 4142.6040; train_edge_recon_loss: 342906.6562; train_cond_contrastive_loss: 79993.2578; train_gene_expr_recon_loss: 102216.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529258.8125; train_optim_loss: 529258.8125; val_kl_reg_loss: 3975.2471; val_edge_recon_loss: 357081.8438; val_cond_contrastive_loss: 78466.3359; val_gene_expr_recon_loss: 101704.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 541227.8125; val_optim_loss: 541227.8125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7135; val_auprc_score: 0.7150; val_best_acc_score: 0.6601; val_best_f1_score: 0.6753; train_kl_reg_loss: 4038.9299; train_edge_recon_loss: 337527.7969; train_cond_contrastive_loss: 80032.2500; train_gene_expr_recon_loss: 102144.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 523743.6406; train_optim_loss: 523743.6406; val_kl_reg_loss: 3878.4487; val_edge_recon_loss: 343831.8438; val_cond_contrastive_loss: 78477.8750; val_gene_expr_recon_loss: 101499.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 527687.1875; val_optim_loss: 527687.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7337; val_auprc_score: 0.7243; val_best_acc_score: 0.6638; val_best_f1_score: 0.6846; train_kl_reg_loss: 3959.0702; train_edge_recon_loss: 329827.2500; train_cond_contrastive_loss: 80128.6250; train_gene_expr_recon_loss: 101866.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 515781.0000; train_optim_loss: 515781.0000; val_kl_reg_loss: 3914.5496; val_edge_recon_loss: 337192.9375; val_cond_contrastive_loss: 78491.5547; val_gene_expr_recon_loss: 101295.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 520894.8750; val_optim_loss: 520894.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7540; val_auprc_score: 0.7315; val_best_acc_score: 0.6788; val_best_f1_score: 0.6964; train_kl_reg_loss: 4083.1033; train_edge_recon_loss: 323573.9219; train_cond_contrastive_loss: 79948.1680; train_gene_expr_recon_loss: 101588.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 509194.1094; train_optim_loss: 509194.1094; val_kl_reg_loss: 4221.4150; val_edge_recon_loss: 333337.8438; val_cond_contrastive_loss: 78518.1328; val_gene_expr_recon_loss: 101050.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 517128.0000; val_optim_loss: 517128.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7766; val_auprc_score: 0.7412; val_best_acc_score: 0.6961; val_best_f1_score: 0.7200; train_kl_reg_loss: 4451.8989; train_edge_recon_loss: 315010.2344; train_cond_contrastive_loss: 79559.4570; train_gene_expr_recon_loss: 101399.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500420.9531; train_optim_loss: 500420.9531; val_kl_reg_loss: 4741.2295; val_edge_recon_loss: 323228.6562; val_cond_contrastive_loss: 78514.6484; val_gene_expr_recon_loss: 100755.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 507240.4375; val_optim_loss: 507240.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7982; val_auprc_score: 0.7575; val_best_acc_score: 0.7201; val_best_f1_score: 0.7444; train_kl_reg_loss: 5055.2520; train_edge_recon_loss: 311945.7969; train_cond_contrastive_loss: 79162.0234; train_gene_expr_recon_loss: 101136.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497299.0938; train_optim_loss: 497299.0938; val_kl_reg_loss: 5424.6631; val_edge_recon_loss: 314609.2500; val_cond_contrastive_loss: 78489.8047; val_gene_expr_recon_loss: 100415.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498939.4375; val_optim_loss: 498939.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8046; val_auprc_score: 0.7591; val_best_acc_score: 0.7233; val_best_f1_score: 0.7469; train_kl_reg_loss: 5773.7373; train_edge_recon_loss: 306062.4844; train_cond_contrastive_loss: 78876.0312; train_gene_expr_recon_loss: 100645.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491357.9375; train_optim_loss: 491357.9375; val_kl_reg_loss: 6113.8076; val_edge_recon_loss: 313901.1562; val_cond_contrastive_loss: 78471.8906; val_gene_expr_recon_loss: 100106.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498593.7500; val_optim_loss: 498593.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8032; val_auprc_score: 0.7564; val_best_acc_score: 0.7246; val_best_f1_score: 0.7519; train_kl_reg_loss: 6475.2852; train_edge_recon_loss: 302947.7500; train_cond_contrastive_loss: 78706.8555; train_gene_expr_recon_loss: 100530.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488660.0000; train_optim_loss: 488660.0000; val_kl_reg_loss: 6671.9365; val_edge_recon_loss: 312075.8750; val_cond_contrastive_loss: 78460.6172; val_gene_expr_recon_loss: 99877.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497086.2188; val_optim_loss: 497086.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8240; val_auprc_score: 0.7779; val_best_acc_score: 0.7444; val_best_f1_score: 0.7658; train_kl_reg_loss: 6974.1406; train_edge_recon_loss: 300860.1094; train_cond_contrastive_loss: 78657.6406; train_gene_expr_recon_loss: 100257.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486749.3125; train_optim_loss: 486749.3125; val_kl_reg_loss: 6975.5059; val_edge_recon_loss: 303397.3125; val_cond_contrastive_loss: 78438.9766; val_gene_expr_recon_loss: 99692.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488504.0000; val_optim_loss: 488504.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8163; val_auprc_score: 0.7746; val_best_acc_score: 0.7375; val_best_f1_score: 0.7634; train_kl_reg_loss: 7233.5156; train_edge_recon_loss: 299754.0156; train_cond_contrastive_loss: 78656.3477; train_gene_expr_recon_loss: 99929.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485573.0156; train_optim_loss: 485573.0156; val_kl_reg_loss: 7071.9414; val_edge_recon_loss: 306259.7812; val_cond_contrastive_loss: 78423.5781; val_gene_expr_recon_loss: 99511.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491266.4062; val_optim_loss: 491266.4062
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8184; val_auprc_score: 0.7710; val_best_acc_score: 0.7379; val_best_f1_score: 0.7662; train_kl_reg_loss: 7296.2629; train_edge_recon_loss: 300818.9531; train_cond_contrastive_loss: 78693.4102; train_gene_expr_recon_loss: 99751.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486559.6562; train_optim_loss: 486559.6562; val_kl_reg_loss: 7044.2231; val_edge_recon_loss: 305513.0938; val_cond_contrastive_loss: 78420.0625; val_gene_expr_recon_loss: 99304.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490281.4375; val_optim_loss: 490281.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8298; val_auprc_score: 0.7837; val_best_acc_score: 0.7497; val_best_f1_score: 0.7778; train_kl_reg_loss: 7255.3652; train_edge_recon_loss: 299973.0312; train_cond_contrastive_loss: 78720.3125; train_gene_expr_recon_loss: 99620.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485569.4062; train_optim_loss: 485569.4062; val_kl_reg_loss: 6918.2217; val_edge_recon_loss: 298842.7188; val_cond_contrastive_loss: 78413.6328; val_gene_expr_recon_loss: 99106.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483280.5625; val_optim_loss: 483280.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8408; val_auprc_score: 0.7815; val_best_acc_score: 0.7617; val_best_f1_score: 0.7772; train_kl_reg_loss: 7097.4646; train_edge_recon_loss: 296888.1094; train_cond_contrastive_loss: 78749.1836; train_gene_expr_recon_loss: 99501.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482235.8594; train_optim_loss: 482235.8594; val_kl_reg_loss: 6721.6011; val_edge_recon_loss: 300328.8438; val_cond_contrastive_loss: 78419.3750; val_gene_expr_recon_loss: 98926.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484396.3125; val_optim_loss: 484396.3125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8372; val_auprc_score: 0.7865; val_best_acc_score: 0.7635; val_best_f1_score: 0.7817; train_kl_reg_loss: 6861.9932; train_edge_recon_loss: 296301.1250; train_cond_contrastive_loss: 78802.1406; train_gene_expr_recon_loss: 99354.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481320.0156; train_optim_loss: 481320.0156; val_kl_reg_loss: 6460.8872; val_edge_recon_loss: 301209.6562; val_cond_contrastive_loss: 78417.0156; val_gene_expr_recon_loss: 98759.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484846.5625; val_optim_loss: 484846.5625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8515; val_auprc_score: 0.7991; val_best_acc_score: 0.7777; val_best_f1_score: 0.7894; train_kl_reg_loss: 6596.0498; train_edge_recon_loss: 295306.1250; train_cond_contrastive_loss: 78891.4531; train_gene_expr_recon_loss: 99126.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479920.0156; train_optim_loss: 479920.0156; val_kl_reg_loss: 6227.4067; val_edge_recon_loss: 297954.1875; val_cond_contrastive_loss: 78420.8359; val_gene_expr_recon_loss: 98583.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481185.6875; val_optim_loss: 481185.6875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8518; val_auprc_score: 0.7913; val_best_acc_score: 0.7830; val_best_f1_score: 0.7947; train_kl_reg_loss: 6405.5388; train_edge_recon_loss: 294877.4844; train_cond_contrastive_loss: 78953.7891; train_gene_expr_recon_loss: 98936.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479172.9844; train_optim_loss: 479172.9844; val_kl_reg_loss: 6149.2002; val_edge_recon_loss: 297125.3125; val_cond_contrastive_loss: 78430.4375; val_gene_expr_recon_loss: 98394.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480099.2500; val_optim_loss: 480099.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8512; val_auprc_score: 0.7970; val_best_acc_score: 0.7802; val_best_f1_score: 0.7929; train_kl_reg_loss: 6323.8577; train_edge_recon_loss: 294664.5000; train_cond_contrastive_loss: 78973.6992; train_gene_expr_recon_loss: 98684.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478646.9531; train_optim_loss: 478646.9531; val_kl_reg_loss: 6132.5654; val_edge_recon_loss: 303085.7812; val_cond_contrastive_loss: 78436.3359; val_gene_expr_recon_loss: 98203.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485858.5000; val_optim_loss: 485858.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8631; val_auprc_score: 0.8078; val_best_acc_score: 0.7970; val_best_f1_score: 0.8098; train_kl_reg_loss: 6324.1558; train_edge_recon_loss: 292377.5781; train_cond_contrastive_loss: 78953.9727; train_gene_expr_recon_loss: 98519.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476175.2656; train_optim_loss: 476175.2656; val_kl_reg_loss: 6196.2178; val_edge_recon_loss: 295466.5312; val_cond_contrastive_loss: 78447.0000; val_gene_expr_recon_loss: 98026.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478136.7500; val_optim_loss: 478136.7500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8750; val_auprc_score: 0.8278; val_best_acc_score: 0.8062; val_best_f1_score: 0.8183; train_kl_reg_loss: 6378.8179; train_edge_recon_loss: 293160.0000; train_cond_contrastive_loss: 78911.5117; train_gene_expr_recon_loss: 98395.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476845.5156; train_optim_loss: 476845.5156; val_kl_reg_loss: 6229.1064; val_edge_recon_loss: 291973.8125; val_cond_contrastive_loss: 78456.5938; val_gene_expr_recon_loss: 97882.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474541.6562; val_optim_loss: 474541.6562
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8823; val_auprc_score: 0.8317; val_best_acc_score: 0.8121; val_best_f1_score: 0.8201; train_kl_reg_loss: 6420.0232; train_edge_recon_loss: 289661.2656; train_cond_contrastive_loss: 78878.8945; train_gene_expr_recon_loss: 98302.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473262.6562; train_optim_loss: 473262.6562; val_kl_reg_loss: 6272.1270; val_edge_recon_loss: 293839.8438; val_cond_contrastive_loss: 78465.2656; val_gene_expr_recon_loss: 97770.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476348.0625; val_optim_loss: 476348.0625
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8859; val_auprc_score: 0.8377; val_best_acc_score: 0.8077; val_best_f1_score: 0.8129; train_kl_reg_loss: 6462.1128; train_edge_recon_loss: 290046.4844; train_cond_contrastive_loss: 78835.8906; train_gene_expr_recon_loss: 98148.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473492.6406; train_optim_loss: 473492.6406; val_kl_reg_loss: 6281.2432; val_edge_recon_loss: 299993.3125; val_cond_contrastive_loss: 78474.8516; val_gene_expr_recon_loss: 97666.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482416.1875; val_optim_loss: 482416.1875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8886; val_auprc_score: 0.8467; val_best_acc_score: 0.8096; val_best_f1_score: 0.8181; train_kl_reg_loss: 6443.8796; train_edge_recon_loss: 287768.4375; train_cond_contrastive_loss: 78789.0195; train_gene_expr_recon_loss: 97891.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470892.5625; train_optim_loss: 470892.5625; val_kl_reg_loss: 6202.9912; val_edge_recon_loss: 296591.2500; val_cond_contrastive_loss: 78484.9375; val_gene_expr_recon_loss: 97546.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478825.5625; val_optim_loss: 478825.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9036; val_auprc_score: 0.8710; val_best_acc_score: 0.8262; val_best_f1_score: 0.8286; train_kl_reg_loss: 6383.9775; train_edge_recon_loss: 289175.3906; train_cond_contrastive_loss: 78766.1133; train_gene_expr_recon_loss: 97795.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472120.7031; train_optim_loss: 472120.7031; val_kl_reg_loss: 6182.5645; val_edge_recon_loss: 289766.4375; val_cond_contrastive_loss: 78490.2891; val_gene_expr_recon_loss: 97531.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471970.2812; val_optim_loss: 471970.2812
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9000; val_auprc_score: 0.8652; val_best_acc_score: 0.8195; val_best_f1_score: 0.8236; train_kl_reg_loss: 6375.0981; train_edge_recon_loss: 289538.6719; train_cond_contrastive_loss: 78768.2539; train_gene_expr_recon_loss: 97959.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472641.2500; train_optim_loss: 472641.2500; val_kl_reg_loss: 6172.4844; val_edge_recon_loss: 293440.8438; val_cond_contrastive_loss: 78489.6484; val_gene_expr_recon_loss: 97511.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475614.5000; val_optim_loss: 475614.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8977; val_auprc_score: 0.8619; val_best_acc_score: 0.8230; val_best_f1_score: 0.8240; train_kl_reg_loss: 6340.5461; train_edge_recon_loss: 287911.1562; train_cond_contrastive_loss: 78773.6719; train_gene_expr_recon_loss: 98028.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471053.8594; train_optim_loss: 471053.8594; val_kl_reg_loss: 6143.1196; val_edge_recon_loss: 294318.8750; val_cond_contrastive_loss: 78489.9609; val_gene_expr_recon_loss: 97490.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476442.6562; val_optim_loss: 476442.6562
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8926; val_auprc_score: 0.8513; val_best_acc_score: 0.8137; val_best_f1_score: 0.8196; train_kl_reg_loss: 6307.9976; train_edge_recon_loss: 287961.6406; train_cond_contrastive_loss: 78780.1836; train_gene_expr_recon_loss: 98026.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471076.0312; train_optim_loss: 471076.0312; val_kl_reg_loss: 6097.6943; val_edge_recon_loss: 296003.5938; val_cond_contrastive_loss: 78492.0234; val_gene_expr_recon_loss: 97470.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478064.2188; val_optim_loss: 478064.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8932; val_auprc_score: 0.8555; val_best_acc_score: 0.8153; val_best_f1_score: 0.8197; train_kl_reg_loss: 6269.5957; train_edge_recon_loss: 289771.7812; train_cond_contrastive_loss: 78787.4961; train_gene_expr_recon_loss: 97808.8711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472637.7188; train_optim_loss: 472637.7188; val_kl_reg_loss: 6083.5586; val_edge_recon_loss: 295723.1250; val_cond_contrastive_loss: 78489.8438; val_gene_expr_recon_loss: 97468.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477765.5000; val_optim_loss: 477765.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8990; val_auprc_score: 0.8594; val_best_acc_score: 0.8208; val_best_f1_score: 0.8242; train_kl_reg_loss: 6263.3845; train_edge_recon_loss: 287931.6250; train_cond_contrastive_loss: 78788.4570; train_gene_expr_recon_loss: 97817.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470800.9062; train_optim_loss: 470800.9062; val_kl_reg_loss: 6090.9639; val_edge_recon_loss: 291891.2188; val_cond_contrastive_loss: 78492.0547; val_gene_expr_recon_loss: 97466.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473941.2188; val_optim_loss: 473941.2188
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8965; val_auprc_score: 0.8673; val_best_acc_score: 0.8245; val_best_f1_score: 0.8285; train_kl_reg_loss: 6260.8022; train_edge_recon_loss: 287493.4375; train_cond_contrastive_loss: 78791.1836; train_gene_expr_recon_loss: 97769.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470315.3438; train_optim_loss: 470315.3438; val_kl_reg_loss: 6092.7622; val_edge_recon_loss: 290053.3125; val_cond_contrastive_loss: 78490.9062; val_gene_expr_recon_loss: 97464.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472101.9375; val_optim_loss: 472101.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 49 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.8979
Val AUPRC score: 0.8597
Val best accuracy score: 0.8228
Val best F1 score: 0.8276
Val gene expr MSE score: 1.8547
Duration of model training in run 2: 0 hours, 0 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7361; val_auprc_score: 0.7799; val_best_acc_score: 0.6766; val_best_f1_score: 0.6903; train_kl_reg_loss: 1937.4541; train_edge_recon_loss: 357642.8047; train_cond_contrastive_loss: 118950.5801; train_gene_expr_recon_loss: 128141.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 606672.0625; train_optim_loss: 606672.0625; val_kl_reg_loss: 4948.0869; val_edge_recon_loss: 401709.1875; val_cond_contrastive_loss: 78358.6719; val_gene_expr_recon_loss: 109119.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 594135.9375; val_optim_loss: 594135.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6996; val_auprc_score: 0.7386; val_best_acc_score: 0.6386; val_best_f1_score: 0.6867; train_kl_reg_loss: 9236.7231; train_edge_recon_loss: 361256.9375; train_cond_contrastive_loss: 87190.1113; train_gene_expr_recon_loss: 106954.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564638.6094; train_optim_loss: 564638.6094; val_kl_reg_loss: 7682.6826; val_edge_recon_loss: 397052.2188; val_cond_contrastive_loss: 78381.5078; val_gene_expr_recon_loss: 104175.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 587292.2500; val_optim_loss: 587292.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6869; val_auprc_score: 0.7280; val_best_acc_score: 0.6226; val_best_f1_score: 0.6824; train_kl_reg_loss: 6466.3827; train_edge_recon_loss: 355018.1094; train_cond_contrastive_loss: 88726.5254; train_gene_expr_recon_loss: 104071.7129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554282.7344; train_optim_loss: 554282.7344; val_kl_reg_loss: 4710.2100; val_edge_recon_loss: 379981.6562; val_cond_contrastive_loss: 78457.8672; val_gene_expr_recon_loss: 103007.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 566157.3750; val_optim_loss: 566157.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6863; val_auprc_score: 0.7197; val_best_acc_score: 0.6245; val_best_f1_score: 0.6869; train_kl_reg_loss: 4567.6588; train_edge_recon_loss: 347363.6719; train_cond_contrastive_loss: 88597.9004; train_gene_expr_recon_loss: 101646.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542175.4688; train_optim_loss: 542175.4688; val_kl_reg_loss: 3857.2839; val_edge_recon_loss: 349861.3125; val_cond_contrastive_loss: 78551.6328; val_gene_expr_recon_loss: 102465.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534735.8125; val_optim_loss: 534735.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6896; val_auprc_score: 0.7231; val_best_acc_score: 0.6382; val_best_f1_score: 0.6817; train_kl_reg_loss: 3738.8836; train_edge_recon_loss: 334346.6562; train_cond_contrastive_loss: 87115.1113; train_gene_expr_recon_loss: 101487.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 526688.0391; train_optim_loss: 526688.0391; val_kl_reg_loss: 3647.8740; val_edge_recon_loss: 343113.0312; val_cond_contrastive_loss: 78428.1172; val_gene_expr_recon_loss: 102020.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 527209.2500; val_optim_loss: 527209.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6961; val_auprc_score: 0.7304; val_best_acc_score: 0.6414; val_best_f1_score: 0.6858; train_kl_reg_loss: 3916.0856; train_edge_recon_loss: 328352.3047; train_cond_contrastive_loss: 81419.1816; train_gene_expr_recon_loss: 100958.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 514646.0078; train_optim_loss: 514646.0078; val_kl_reg_loss: 4208.3770; val_edge_recon_loss: 338465.1562; val_cond_contrastive_loss: 78410.8359; val_gene_expr_recon_loss: 101489.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 522574.1875; val_optim_loss: 522574.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7306; val_auprc_score: 0.7571; val_best_acc_score: 0.6595; val_best_f1_score: 0.7029; train_kl_reg_loss: 4363.7699; train_edge_recon_loss: 320590.5000; train_cond_contrastive_loss: 79449.6113; train_gene_expr_recon_loss: 100634.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 505038.5625; train_optim_loss: 505038.5625; val_kl_reg_loss: 4405.1172; val_edge_recon_loss: 320569.8750; val_cond_contrastive_loss: 78418.1406; val_gene_expr_recon_loss: 100984.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 504377.8438; val_optim_loss: 504377.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7832; val_auprc_score: 0.7848; val_best_acc_score: 0.7020; val_best_f1_score: 0.7412; train_kl_reg_loss: 4546.0199; train_edge_recon_loss: 307243.7188; train_cond_contrastive_loss: 79250.3848; train_gene_expr_recon_loss: 99706.7090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490746.8438; train_optim_loss: 490746.8438; val_kl_reg_loss: 4747.1572; val_edge_recon_loss: 302945.5000; val_cond_contrastive_loss: 78446.2500; val_gene_expr_recon_loss: 100510.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486649.8438; val_optim_loss: 486649.8438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8080; val_auprc_score: 0.7929; val_best_acc_score: 0.7255; val_best_f1_score: 0.7715; train_kl_reg_loss: 5123.3296; train_edge_recon_loss: 294194.8125; train_cond_contrastive_loss: 79048.9688; train_gene_expr_recon_loss: 99887.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478254.1094; train_optim_loss: 478254.1094; val_kl_reg_loss: 5673.9238; val_edge_recon_loss: 293414.6250; val_cond_contrastive_loss: 78449.4375; val_gene_expr_recon_loss: 99915.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477453.4062; val_optim_loss: 477453.4062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8304; val_auprc_score: 0.8096; val_best_acc_score: 0.7499; val_best_f1_score: 0.7873; train_kl_reg_loss: 6116.0400; train_edge_recon_loss: 288056.4219; train_cond_contrastive_loss: 78741.9688; train_gene_expr_recon_loss: 98704.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471619.1953; train_optim_loss: 471619.1953; val_kl_reg_loss: 6477.2930; val_edge_recon_loss: 286070.1250; val_cond_contrastive_loss: 78426.2188; val_gene_expr_recon_loss: 99328.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470301.6875; val_optim_loss: 470301.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8402; val_auprc_score: 0.8101; val_best_acc_score: 0.7606; val_best_f1_score: 0.7939; train_kl_reg_loss: 6664.8417; train_edge_recon_loss: 283860.6250; train_cond_contrastive_loss: 78730.3535; train_gene_expr_recon_loss: 98278.9355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467534.7656; train_optim_loss: 467534.7656; val_kl_reg_loss: 6620.2422; val_edge_recon_loss: 286605.8438; val_cond_contrastive_loss: 78406.7188; val_gene_expr_recon_loss: 98909.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470542.6250; val_optim_loss: 470542.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8488; val_auprc_score: 0.8186; val_best_acc_score: 0.7682; val_best_f1_score: 0.7960; train_kl_reg_loss: 6696.0170; train_edge_recon_loss: 281767.2969; train_cond_contrastive_loss: 78822.5527; train_gene_expr_recon_loss: 97668.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464954.3438; train_optim_loss: 464954.3438; val_kl_reg_loss: 6494.6338; val_edge_recon_loss: 283400.5625; val_cond_contrastive_loss: 78402.2109; val_gene_expr_recon_loss: 98477.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466775.0625; val_optim_loss: 466775.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8533; val_auprc_score: 0.8192; val_best_acc_score: 0.7818; val_best_f1_score: 0.8077; train_kl_reg_loss: 6557.8866; train_edge_recon_loss: 282006.6328; train_cond_contrastive_loss: 78913.4102; train_gene_expr_recon_loss: 97162.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464639.9375; train_optim_loss: 464639.9375; val_kl_reg_loss: 6311.8682; val_edge_recon_loss: 279372.2188; val_cond_contrastive_loss: 78403.9219; val_gene_expr_recon_loss: 98158.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462246.5000; val_optim_loss: 462246.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8682; val_auprc_score: 0.8360; val_best_acc_score: 0.7982; val_best_f1_score: 0.8175; train_kl_reg_loss: 6504.8879; train_edge_recon_loss: 280121.6172; train_cond_contrastive_loss: 79002.8633; train_gene_expr_recon_loss: 97127.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462757.2969; train_optim_loss: 462757.2969; val_kl_reg_loss: 6528.8652; val_edge_recon_loss: 280019.5000; val_cond_contrastive_loss: 78413.2969; val_gene_expr_recon_loss: 97892.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462854.0938; val_optim_loss: 462854.0938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8827; val_auprc_score: 0.8518; val_best_acc_score: 0.8149; val_best_f1_score: 0.8324; train_kl_reg_loss: 6745.0317; train_edge_recon_loss: 278800.0781; train_cond_contrastive_loss: 78879.5566; train_gene_expr_recon_loss: 97024.4668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461449.1406; train_optim_loss: 461449.1406; val_kl_reg_loss: 6634.9985; val_edge_recon_loss: 277622.4375; val_cond_contrastive_loss: 78422.3672; val_gene_expr_recon_loss: 97619.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460299.0000; val_optim_loss: 460299.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8982; val_auprc_score: 0.8760; val_best_acc_score: 0.8301; val_best_f1_score: 0.8446; train_kl_reg_loss: 6706.5345; train_edge_recon_loss: 275983.1172; train_cond_contrastive_loss: 78876.8125; train_gene_expr_recon_loss: 96582.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458149.4453; train_optim_loss: 458149.4453; val_kl_reg_loss: 6393.4863; val_edge_recon_loss: 273712.1562; val_cond_contrastive_loss: 78438.7812; val_gene_expr_recon_loss: 97442.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455986.4375; val_optim_loss: 455986.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9017; val_auprc_score: 0.8779; val_best_acc_score: 0.8273; val_best_f1_score: 0.8425; train_kl_reg_loss: 6399.2468; train_edge_recon_loss: 273457.6406; train_cond_contrastive_loss: 78881.7344; train_gene_expr_recon_loss: 96704.2910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455442.8984; train_optim_loss: 455442.8984; val_kl_reg_loss: 6029.1670; val_edge_recon_loss: 278198.4688; val_cond_contrastive_loss: 78450.7891; val_gene_expr_recon_loss: 97183.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459862.2500; val_optim_loss: 459862.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9252; val_auprc_score: 0.9072; val_best_acc_score: 0.8523; val_best_f1_score: 0.8604; train_kl_reg_loss: 6099.3972; train_edge_recon_loss: 273034.9766; train_cond_contrastive_loss: 78887.4961; train_gene_expr_recon_loss: 96333.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454355.3047; train_optim_loss: 454355.3047; val_kl_reg_loss: 5903.9312; val_edge_recon_loss: 274658.1250; val_cond_contrastive_loss: 78455.7344; val_gene_expr_recon_loss: 96912.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455930.5312; val_optim_loss: 455930.5312
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9323; val_auprc_score: 0.9197; val_best_acc_score: 0.8563; val_best_f1_score: 0.8649; train_kl_reg_loss: 5968.8372; train_edge_recon_loss: 272441.5000; train_cond_contrastive_loss: 78788.4102; train_gene_expr_recon_loss: 96458.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453657.0938; train_optim_loss: 453657.0938; val_kl_reg_loss: 5784.1504; val_edge_recon_loss: 272971.6562; val_cond_contrastive_loss: 78455.8047; val_gene_expr_recon_loss: 96689.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453901.4688; val_optim_loss: 453901.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9428; val_auprc_score: 0.9309; val_best_acc_score: 0.8749; val_best_f1_score: 0.8794; train_kl_reg_loss: 5869.9738; train_edge_recon_loss: 271881.8516; train_cond_contrastive_loss: 78758.7031; train_gene_expr_recon_loss: 95910.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452421.2422; train_optim_loss: 452421.2422; val_kl_reg_loss: 5806.3018; val_edge_recon_loss: 268870.9375; val_cond_contrastive_loss: 78451.9922; val_gene_expr_recon_loss: 96459.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449588.8750; val_optim_loss: 449588.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9503; val_auprc_score: 0.9441; val_best_acc_score: 0.8838; val_best_f1_score: 0.8894; train_kl_reg_loss: 6022.6980; train_edge_recon_loss: 269188.6016; train_cond_contrastive_loss: 78683.5059; train_gene_expr_recon_loss: 96146.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450041.4297; train_optim_loss: 450041.4297; val_kl_reg_loss: 6003.4883; val_edge_recon_loss: 266554.5312; val_cond_contrastive_loss: 78447.4062; val_gene_expr_recon_loss: 96245.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447250.8438; val_optim_loss: 447250.8438
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9526; val_auprc_score: 0.9440; val_best_acc_score: 0.8923; val_best_f1_score: 0.8972; train_kl_reg_loss: 6156.2144; train_edge_recon_loss: 268711.9531; train_cond_contrastive_loss: 78629.1250; train_gene_expr_recon_loss: 95608.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449105.3047; train_optim_loss: 449105.3047; val_kl_reg_loss: 6097.9189; val_edge_recon_loss: 264677.9062; val_cond_contrastive_loss: 78446.4844; val_gene_expr_recon_loss: 96064.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445286.7188; val_optim_loss: 445286.7188
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9570; val_auprc_score: 0.9479; val_best_acc_score: 0.8980; val_best_f1_score: 0.9000; train_kl_reg_loss: 6197.7261; train_edge_recon_loss: 266771.7812; train_cond_contrastive_loss: 78625.7480; train_gene_expr_recon_loss: 94457.6504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446052.9062; train_optim_loss: 446052.9062; val_kl_reg_loss: 6076.0850; val_edge_recon_loss: 272990.0000; val_cond_contrastive_loss: 78439.9297; val_gene_expr_recon_loss: 95883.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453389.4688; val_optim_loss: 453389.4688
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9647; val_auprc_score: 0.9573; val_best_acc_score: 0.9090; val_best_f1_score: 0.9112; train_kl_reg_loss: 6168.1946; train_edge_recon_loss: 268413.4844; train_cond_contrastive_loss: 78639.8984; train_gene_expr_recon_loss: 94975.5586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448197.1406; train_optim_loss: 448197.1406; val_kl_reg_loss: 5922.7578; val_edge_recon_loss: 268571.1875; val_cond_contrastive_loss: 78441.5234; val_gene_expr_recon_loss: 95734.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448669.8125; val_optim_loss: 448669.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9690; val_auprc_score: 0.9623; val_best_acc_score: 0.9185; val_best_f1_score: 0.9194; train_kl_reg_loss: 6016.1533; train_edge_recon_loss: 266812.5781; train_cond_contrastive_loss: 78692.2363; train_gene_expr_recon_loss: 94871.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446392.7422; train_optim_loss: 446392.7422; val_kl_reg_loss: 5905.2026; val_edge_recon_loss: 265995.5938; val_cond_contrastive_loss: 78438.4297; val_gene_expr_recon_loss: 95538.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445877.4375; val_optim_loss: 445877.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9697; val_auprc_score: 0.9620; val_best_acc_score: 0.9231; val_best_f1_score: 0.9254; train_kl_reg_loss: 6010.8157; train_edge_recon_loss: 265328.2734; train_cond_contrastive_loss: 78694.5625; train_gene_expr_recon_loss: 94623.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444657.0234; train_optim_loss: 444657.0234; val_kl_reg_loss: 5867.3877; val_edge_recon_loss: 263307.9375; val_cond_contrastive_loss: 78438.6641; val_gene_expr_recon_loss: 95505.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443119.1250; val_optim_loss: 443119.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9689; val_auprc_score: 0.9597; val_best_acc_score: 0.9187; val_best_f1_score: 0.9211; train_kl_reg_loss: 5971.2770; train_edge_recon_loss: 267482.1641; train_cond_contrastive_loss: 78709.3828; train_gene_expr_recon_loss: 94030.9082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446193.7344; train_optim_loss: 446193.7344; val_kl_reg_loss: 5835.6880; val_edge_recon_loss: 266050.6875; val_cond_contrastive_loss: 78438.6875; val_gene_expr_recon_loss: 95478.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445804.0000; val_optim_loss: 445804.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9706; val_auprc_score: 0.9653; val_best_acc_score: 0.9231; val_best_f1_score: 0.9249; train_kl_reg_loss: 5964.4659; train_edge_recon_loss: 266751.9219; train_cond_contrastive_loss: 78708.7773; train_gene_expr_recon_loss: 94254.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445680.1016; train_optim_loss: 445680.1016; val_kl_reg_loss: 5837.5708; val_edge_recon_loss: 262527.6875; val_cond_contrastive_loss: 78439.3750; val_gene_expr_recon_loss: 95457.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442262.1562; val_optim_loss: 442262.1562
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9708; val_auprc_score: 0.9648; val_best_acc_score: 0.9188; val_best_f1_score: 0.9220; train_kl_reg_loss: 5960.3445; train_edge_recon_loss: 264807.6250; train_cond_contrastive_loss: 78711.0254; train_gene_expr_recon_loss: 94353.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443832.3281; train_optim_loss: 443832.3281; val_kl_reg_loss: 5844.2432; val_edge_recon_loss: 264439.0312; val_cond_contrastive_loss: 78439.4219; val_gene_expr_recon_loss: 95435.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444157.7188; val_optim_loss: 444157.7188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9693; val_auprc_score: 0.9619; val_best_acc_score: 0.9210; val_best_f1_score: 0.9242; train_kl_reg_loss: 5964.2695; train_edge_recon_loss: 266732.6250; train_cond_contrastive_loss: 78704.2305; train_gene_expr_recon_loss: 94472.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445873.1641; train_optim_loss: 445873.1641; val_kl_reg_loss: 5862.4683; val_edge_recon_loss: 262964.4375; val_cond_contrastive_loss: 78439.3750; val_gene_expr_recon_loss: 95414.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442680.3438; val_optim_loss: 442680.3438
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9723; val_auprc_score: 0.9671; val_best_acc_score: 0.9239; val_best_f1_score: 0.9265; train_kl_reg_loss: 5978.5117; train_edge_recon_loss: 265548.1797; train_cond_contrastive_loss: 78700.7148; train_gene_expr_recon_loss: 94513.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444741.4062; train_optim_loss: 444741.4062; val_kl_reg_loss: 5855.9790; val_edge_recon_loss: 266967.0938; val_cond_contrastive_loss: 78438.6953; val_gene_expr_recon_loss: 95394.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446656.1250; val_optim_loss: 446656.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9715; val_auprc_score: 0.9646; val_best_acc_score: 0.9243; val_best_f1_score: 0.9274; train_kl_reg_loss: 5984.3746; train_edge_recon_loss: 265417.9688; train_cond_contrastive_loss: 78701.6172; train_gene_expr_recon_loss: 94490.9707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444594.9219; train_optim_loss: 444594.9219; val_kl_reg_loss: 5845.6309; val_edge_recon_loss: 261535.9062; val_cond_contrastive_loss: 78440.0938; val_gene_expr_recon_loss: 95392.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441213.9375; val_optim_loss: 441213.9375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9708; val_auprc_score: 0.9620; val_best_acc_score: 0.9217; val_best_f1_score: 0.9231; train_kl_reg_loss: 5981.8250; train_edge_recon_loss: 265380.8359; train_cond_contrastive_loss: 78702.3164; train_gene_expr_recon_loss: 94232.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444297.4609; train_optim_loss: 444297.4609; val_kl_reg_loss: 5846.5518; val_edge_recon_loss: 266910.9375; val_cond_contrastive_loss: 78438.5156; val_gene_expr_recon_loss: 95390.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446586.2500; val_optim_loss: 446586.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9722; val_auprc_score: 0.9664; val_best_acc_score: 0.9256; val_best_f1_score: 0.9280; train_kl_reg_loss: 5979.9808; train_edge_recon_loss: 266678.4531; train_cond_contrastive_loss: 78701.5840; train_gene_expr_recon_loss: 94054.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445414.4219; train_optim_loss: 445414.4219; val_kl_reg_loss: 5845.9922; val_edge_recon_loss: 261293.8281; val_cond_contrastive_loss: 78439.1328; val_gene_expr_recon_loss: 95388.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440967.1875; val_optim_loss: 440967.1875
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9699; val_auprc_score: 0.9651; val_best_acc_score: 0.9228; val_best_f1_score: 0.9255; train_kl_reg_loss: 5985.7532; train_edge_recon_loss: 265308.6094; train_cond_contrastive_loss: 78703.3184; train_gene_expr_recon_loss: 94464.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444462.3281; train_optim_loss: 444462.3281; val_kl_reg_loss: 5836.3760; val_edge_recon_loss: 264979.8125; val_cond_contrastive_loss: 78439.7969; val_gene_expr_recon_loss: 95386.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444642.5312; val_optim_loss: 444642.5312
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9702; val_auprc_score: 0.9610; val_best_acc_score: 0.9234; val_best_f1_score: 0.9252; train_kl_reg_loss: 5978.8544; train_edge_recon_loss: 264718.7422; train_cond_contrastive_loss: 78705.2754; train_gene_expr_recon_loss: 94986.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444389.8672; train_optim_loss: 444389.8672; val_kl_reg_loss: 5842.4746; val_edge_recon_loss: 265330.4062; val_cond_contrastive_loss: 78439.0938; val_gene_expr_recon_loss: 95384.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444996.9375; val_optim_loss: 444996.9375
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9722; val_auprc_score: 0.9662; val_best_acc_score: 0.9252; val_best_f1_score: 0.9274; train_kl_reg_loss: 5962.2212; train_edge_recon_loss: 264768.9219; train_cond_contrastive_loss: 78707.4629; train_gene_expr_recon_loss: 94279.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443717.8984; train_optim_loss: 443717.8984; val_kl_reg_loss: 5836.3779; val_edge_recon_loss: 263787.1875; val_cond_contrastive_loss: 78438.9062; val_gene_expr_recon_loss: 95382.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443445.4375; val_optim_loss: 443445.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9729; val_auprc_score: 0.9678; val_best_acc_score: 0.9254; val_best_f1_score: 0.9264; train_kl_reg_loss: 5958.5065; train_edge_recon_loss: 264320.9922; train_cond_contrastive_loss: 78705.6191; train_gene_expr_recon_loss: 94334.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443319.8516; train_optim_loss: 443319.8516; val_kl_reg_loss: 5838.9512; val_edge_recon_loss: 267230.1250; val_cond_contrastive_loss: 78438.3438; val_gene_expr_recon_loss: 95382.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446890.1562; val_optim_loss: 446890.1562
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9725; val_auprc_score: 0.9635; val_best_acc_score: 0.9239; val_best_f1_score: 0.9261; train_kl_reg_loss: 5956.7841; train_edge_recon_loss: 265966.8984; train_cond_contrastive_loss: 78707.1543; train_gene_expr_recon_loss: 94240.8105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444871.6328; train_optim_loss: 444871.6328; val_kl_reg_loss: 5834.0186; val_edge_recon_loss: 263521.9688; val_cond_contrastive_loss: 78439.8438; val_gene_expr_recon_loss: 95382.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443178.3750; val_optim_loss: 443178.3750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9698; val_auprc_score: 0.9649; val_best_acc_score: 0.9179; val_best_f1_score: 0.9202; train_kl_reg_loss: 5975.3187; train_edge_recon_loss: 265902.6797; train_cond_contrastive_loss: 78708.1504; train_gene_expr_recon_loss: 94401.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444987.3125; train_optim_loss: 444987.3125; val_kl_reg_loss: 5833.3628; val_edge_recon_loss: 265417.5000; val_cond_contrastive_loss: 78439.0938; val_gene_expr_recon_loss: 95382.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445072.2812; val_optim_loss: 445072.2812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 28 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9718
Val AUPRC score: 0.9639
Val best accuracy score: 0.9263
Val best F1 score: 0.9280
Val gene expr MSE score: 1.6271
Duration of model training in run 3: 0 hours, 1 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7381; val_auprc_score: 0.7848; val_best_acc_score: 0.6754; val_best_f1_score: 0.6973; train_kl_reg_loss: 1990.8716; train_edge_recon_loss: 354589.1016; train_cond_contrastive_loss: 117626.8379; train_gene_expr_recon_loss: 127203.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 601410.3750; train_optim_loss: 601410.3750; val_kl_reg_loss: 8182.0342; val_edge_recon_loss: 395888.9688; val_cond_contrastive_loss: 78356.6406; val_gene_expr_recon_loss: 107967.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 590395.3125; val_optim_loss: 590395.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6821; val_auprc_score: 0.7243; val_best_acc_score: 0.6127; val_best_f1_score: 0.6858; train_kl_reg_loss: 7569.8248; train_edge_recon_loss: 365296.7422; train_cond_contrastive_loss: 83441.3633; train_gene_expr_recon_loss: 107025.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 563333.8750; train_optim_loss: 563333.8750; val_kl_reg_loss: 6233.4834; val_edge_recon_loss: 392015.5312; val_cond_contrastive_loss: 78373.8438; val_gene_expr_recon_loss: 103792.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 580415.6250; val_optim_loss: 580415.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6694; val_auprc_score: 0.7104; val_best_acc_score: 0.6065; val_best_f1_score: 0.6874; train_kl_reg_loss: 6118.5286; train_edge_recon_loss: 355634.1484; train_cond_contrastive_loss: 86019.5996; train_gene_expr_recon_loss: 103215.6855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550987.9531; train_optim_loss: 550987.9531; val_kl_reg_loss: 4327.3447; val_edge_recon_loss: 374652.0938; val_cond_contrastive_loss: 78423.0312; val_gene_expr_recon_loss: 102524.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559927.0000; val_optim_loss: 559927.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6717; val_auprc_score: 0.7042; val_best_acc_score: 0.6110; val_best_f1_score: 0.6851; train_kl_reg_loss: 3869.2476; train_edge_recon_loss: 348539.6562; train_cond_contrastive_loss: 88369.8125; train_gene_expr_recon_loss: 101773.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542552.0781; train_optim_loss: 542552.0781; val_kl_reg_loss: 3185.5830; val_edge_recon_loss: 356532.7188; val_cond_contrastive_loss: 78462.2266; val_gene_expr_recon_loss: 102024.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540205.3750; val_optim_loss: 540205.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6789; val_auprc_score: 0.7159; val_best_acc_score: 0.6272; val_best_f1_score: 0.6873; train_kl_reg_loss: 3210.4273; train_edge_recon_loss: 338177.5469; train_cond_contrastive_loss: 87680.0469; train_gene_expr_recon_loss: 101667.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 530735.2969; train_optim_loss: 530735.2969; val_kl_reg_loss: 3217.2258; val_edge_recon_loss: 343640.9375; val_cond_contrastive_loss: 78391.5547; val_gene_expr_recon_loss: 101638.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526888.5625; val_optim_loss: 526888.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6811; val_auprc_score: 0.7198; val_best_acc_score: 0.6275; val_best_f1_score: 0.6861; train_kl_reg_loss: 3507.3997; train_edge_recon_loss: 330084.2578; train_cond_contrastive_loss: 83582.7520; train_gene_expr_recon_loss: 101083.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518257.5078; train_optim_loss: 518257.5078; val_kl_reg_loss: 3923.7808; val_edge_recon_loss: 339746.3125; val_cond_contrastive_loss: 78383.0547; val_gene_expr_recon_loss: 101111.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523164.8750; val_optim_loss: 523164.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6954; val_auprc_score: 0.7319; val_best_acc_score: 0.6369; val_best_f1_score: 0.6881; train_kl_reg_loss: 4151.8597; train_edge_recon_loss: 328319.1016; train_cond_contrastive_loss: 80027.1035; train_gene_expr_recon_loss: 100794.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513292.5000; train_optim_loss: 513292.5000; val_kl_reg_loss: 4221.2441; val_edge_recon_loss: 334638.0625; val_cond_contrastive_loss: 78381.4453; val_gene_expr_recon_loss: 100756.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 517997.4375; val_optim_loss: 517997.4375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7375; val_auprc_score: 0.7640; val_best_acc_score: 0.6684; val_best_f1_score: 0.7100; train_kl_reg_loss: 4182.1096; train_edge_recon_loss: 323100.8203; train_cond_contrastive_loss: 79600.7129; train_gene_expr_recon_loss: 100722.3301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507605.9844; train_optim_loss: 507605.9844; val_kl_reg_loss: 4037.4163; val_edge_recon_loss: 315986.6562; val_cond_contrastive_loss: 78396.8828; val_gene_expr_recon_loss: 100413.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498834.5000; val_optim_loss: 498834.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7807; val_auprc_score: 0.7811; val_best_acc_score: 0.6987; val_best_f1_score: 0.7398; train_kl_reg_loss: 4092.9487; train_edge_recon_loss: 310522.7578; train_cond_contrastive_loss: 79758.2578; train_gene_expr_recon_loss: 100009.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494383.8906; train_optim_loss: 494383.8906; val_kl_reg_loss: 4282.8281; val_edge_recon_loss: 302341.1875; val_cond_contrastive_loss: 78432.3359; val_gene_expr_recon_loss: 99987.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485043.5625; val_optim_loss: 485043.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8147; val_auprc_score: 0.8014; val_best_acc_score: 0.7388; val_best_f1_score: 0.7773; train_kl_reg_loss: 4655.0325; train_edge_recon_loss: 297641.5234; train_cond_contrastive_loss: 79312.8574; train_gene_expr_recon_loss: 98908.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480517.5391; train_optim_loss: 480517.5391; val_kl_reg_loss: 5314.1260; val_edge_recon_loss: 289377.4062; val_cond_contrastive_loss: 78429.5234; val_gene_expr_recon_loss: 99488.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472609.8125; val_optim_loss: 472609.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8246; val_auprc_score: 0.8073; val_best_acc_score: 0.7428; val_best_f1_score: 0.7837; train_kl_reg_loss: 5838.7202; train_edge_recon_loss: 287237.1719; train_cond_contrastive_loss: 78874.1445; train_gene_expr_recon_loss: 99094.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471044.9922; train_optim_loss: 471044.9922; val_kl_reg_loss: 6436.2188; val_edge_recon_loss: 288859.6250; val_cond_contrastive_loss: 78416.5781; val_gene_expr_recon_loss: 99005.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472717.9375; val_optim_loss: 472717.9375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8343; val_auprc_score: 0.8088; val_best_acc_score: 0.7555; val_best_f1_score: 0.7936; train_kl_reg_loss: 6706.0530; train_edge_recon_loss: 284641.6172; train_cond_contrastive_loss: 78762.0137; train_gene_expr_recon_loss: 98512.9277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468622.5938; train_optim_loss: 468622.5938; val_kl_reg_loss: 6899.0747; val_edge_recon_loss: 285118.3750; val_cond_contrastive_loss: 78405.6406; val_gene_expr_recon_loss: 98684.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469108.0625; val_optim_loss: 469108.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8539; val_auprc_score: 0.8258; val_best_acc_score: 0.7786; val_best_f1_score: 0.8054; train_kl_reg_loss: 6988.7560; train_edge_recon_loss: 282505.3047; train_cond_contrastive_loss: 78777.0645; train_gene_expr_recon_loss: 98259.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466531.1016; train_optim_loss: 466531.1016; val_kl_reg_loss: 6870.6387; val_edge_recon_loss: 278542.2500; val_cond_contrastive_loss: 78401.8438; val_gene_expr_recon_loss: 98285.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462099.8125; val_optim_loss: 462099.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8488; val_auprc_score: 0.8165; val_best_acc_score: 0.7775; val_best_f1_score: 0.8068; train_kl_reg_loss: 6843.0779; train_edge_recon_loss: 280315.6328; train_cond_contrastive_loss: 78897.4141; train_gene_expr_recon_loss: 97808.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463864.8828; train_optim_loss: 463864.8828; val_kl_reg_loss: 6590.7090; val_edge_recon_loss: 279992.1875; val_cond_contrastive_loss: 78397.5703; val_gene_expr_recon_loss: 98009.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462990.1562; val_optim_loss: 462990.1562
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8539; val_auprc_score: 0.8188; val_best_acc_score: 0.7865; val_best_f1_score: 0.8104; train_kl_reg_loss: 6610.7539; train_edge_recon_loss: 281261.2891; train_cond_contrastive_loss: 79021.5410; train_gene_expr_recon_loss: 97335.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464228.9766; train_optim_loss: 464228.9766; val_kl_reg_loss: 6550.4990; val_edge_recon_loss: 282652.0625; val_cond_contrastive_loss: 78402.8906; val_gene_expr_recon_loss: 97765.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465371.1875; val_optim_loss: 465371.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8684; val_auprc_score: 0.8325; val_best_acc_score: 0.8055; val_best_f1_score: 0.8279; train_kl_reg_loss: 6670.9810; train_edge_recon_loss: 278008.4531; train_cond_contrastive_loss: 78945.2480; train_gene_expr_recon_loss: 96669.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460293.7344; train_optim_loss: 460293.7344; val_kl_reg_loss: 6663.4160; val_edge_recon_loss: 276457.2812; val_cond_contrastive_loss: 78410.8984; val_gene_expr_recon_loss: 97531.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459063.1562; val_optim_loss: 459063.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8845; val_auprc_score: 0.8556; val_best_acc_score: 0.8228; val_best_f1_score: 0.8437; train_kl_reg_loss: 6725.8557; train_edge_recon_loss: 277122.4844; train_cond_contrastive_loss: 78886.0859; train_gene_expr_recon_loss: 96868.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459602.9297; train_optim_loss: 459602.9297; val_kl_reg_loss: 6565.5166; val_edge_recon_loss: 273819.5625; val_cond_contrastive_loss: 78423.9062; val_gene_expr_recon_loss: 97278.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456087.2500; val_optim_loss: 456087.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9096; val_auprc_score: 0.8909; val_best_acc_score: 0.8418; val_best_f1_score: 0.8573; train_kl_reg_loss: 6554.2450; train_edge_recon_loss: 275090.2109; train_cond_contrastive_loss: 78866.8457; train_gene_expr_recon_loss: 96429.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456941.0156; train_optim_loss: 456941.0156; val_kl_reg_loss: 6318.6763; val_edge_recon_loss: 269266.5938; val_cond_contrastive_loss: 78433.9219; val_gene_expr_recon_loss: 97062.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451081.4375; val_optim_loss: 451081.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9177; val_auprc_score: 0.9016; val_best_acc_score: 0.8432; val_best_f1_score: 0.8558; train_kl_reg_loss: 6310.5894; train_edge_recon_loss: 272570.2344; train_cond_contrastive_loss: 78871.2832; train_gene_expr_recon_loss: 96518.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454270.3828; train_optim_loss: 454270.3828; val_kl_reg_loss: 6073.5264; val_edge_recon_loss: 271871.3438; val_cond_contrastive_loss: 78442.5078; val_gene_expr_recon_loss: 96860.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453247.5938; val_optim_loss: 453247.5938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9312; val_auprc_score: 0.9168; val_best_acc_score: 0.8587; val_best_f1_score: 0.8686; train_kl_reg_loss: 6126.6857; train_edge_recon_loss: 272266.4219; train_cond_contrastive_loss: 78831.1348; train_gene_expr_recon_loss: 95919.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453143.9453; train_optim_loss: 453143.9453; val_kl_reg_loss: 5977.6577; val_edge_recon_loss: 269749.7812; val_cond_contrastive_loss: 78446.1328; val_gene_expr_recon_loss: 96666.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450840.2812; val_optim_loss: 450840.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9398; val_auprc_score: 0.9334; val_best_acc_score: 0.8679; val_best_f1_score: 0.8761; train_kl_reg_loss: 6038.3422; train_edge_recon_loss: 270640.6953; train_cond_contrastive_loss: 78766.4688; train_gene_expr_recon_loss: 96006.8770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451452.3672; train_optim_loss: 451452.3672; val_kl_reg_loss: 5915.9922; val_edge_recon_loss: 266507.8438; val_cond_contrastive_loss: 78445.4766; val_gene_expr_recon_loss: 96446.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447315.7812; val_optim_loss: 447315.7812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9498; val_auprc_score: 0.9400; val_best_acc_score: 0.8902; val_best_f1_score: 0.8944; train_kl_reg_loss: 6035.6819; train_edge_recon_loss: 270168.2578; train_cond_contrastive_loss: 78721.4238; train_gene_expr_recon_loss: 95869.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450794.5469; train_optim_loss: 450794.5469; val_kl_reg_loss: 5954.5786; val_edge_recon_loss: 263716.6875; val_cond_contrastive_loss: 78444.1562; val_gene_expr_recon_loss: 96212.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444327.5625; val_optim_loss: 444327.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9549; val_auprc_score: 0.9421; val_best_acc_score: 0.8942; val_best_f1_score: 0.8983; train_kl_reg_loss: 6101.5723; train_edge_recon_loss: 268411.1797; train_cond_contrastive_loss: 78662.0625; train_gene_expr_recon_loss: 95257.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448432.0391; train_optim_loss: 448432.0391; val_kl_reg_loss: 6077.7637; val_edge_recon_loss: 267304.4688; val_cond_contrastive_loss: 78437.9688; val_gene_expr_recon_loss: 96004.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447824.6250; val_optim_loss: 447824.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9602; val_auprc_score: 0.9511; val_best_acc_score: 0.9031; val_best_f1_score: 0.9068; train_kl_reg_loss: 6194.3202; train_edge_recon_loss: 268393.3906; train_cond_contrastive_loss: 78643.1270; train_gene_expr_recon_loss: 95972.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449203.3438; train_optim_loss: 449203.3438; val_kl_reg_loss: 6030.1260; val_edge_recon_loss: 263534.9688; val_cond_contrastive_loss: 78439.9766; val_gene_expr_recon_loss: 95840.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443845.9375; val_optim_loss: 443845.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9604; val_auprc_score: 0.9499; val_best_acc_score: 0.9049; val_best_f1_score: 0.9091; train_kl_reg_loss: 6081.7760; train_edge_recon_loss: 266578.3203; train_cond_contrastive_loss: 78660.0957; train_gene_expr_recon_loss: 94834.0996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446154.2812; train_optim_loss: 446154.2812; val_kl_reg_loss: 5931.1279; val_edge_recon_loss: 266067.6562; val_cond_contrastive_loss: 78441.0859; val_gene_expr_recon_loss: 95644.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446084.7188; val_optim_loss: 446084.7188
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9680; val_auprc_score: 0.9602; val_best_acc_score: 0.9137; val_best_f1_score: 0.9172; train_kl_reg_loss: 6048.0421; train_edge_recon_loss: 266231.3125; train_cond_contrastive_loss: 78677.5645; train_gene_expr_recon_loss: 95524.0645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446480.9609; train_optim_loss: 446480.9609; val_kl_reg_loss: 5889.9756; val_edge_recon_loss: 261706.0781; val_cond_contrastive_loss: 78445.2500; val_gene_expr_recon_loss: 95454.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441495.4375; val_optim_loss: 441495.4375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9697; val_auprc_score: 0.9627; val_best_acc_score: 0.9171; val_best_f1_score: 0.9200; train_kl_reg_loss: 6016.5891; train_edge_recon_loss: 265254.2891; train_cond_contrastive_loss: 78689.8926; train_gene_expr_recon_loss: 94832.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444793.4219; train_optim_loss: 444793.4219; val_kl_reg_loss: 5885.4365; val_edge_recon_loss: 267410.3438; val_cond_contrastive_loss: 78446.6172; val_gene_expr_recon_loss: 95319.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447062.0625; val_optim_loss: 447062.0625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9720; val_auprc_score: 0.9658; val_best_acc_score: 0.9226; val_best_f1_score: 0.9256; train_kl_reg_loss: 5986.6633; train_edge_recon_loss: 265756.4219; train_cond_contrastive_loss: 78710.0000; train_gene_expr_recon_loss: 94775.7383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445228.8359; train_optim_loss: 445228.8359; val_kl_reg_loss: 5843.5840; val_edge_recon_loss: 260809.8125; val_cond_contrastive_loss: 78447.4922; val_gene_expr_recon_loss: 95134.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440235.5312; val_optim_loss: 440235.5312
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9748; val_auprc_score: 0.9680; val_best_acc_score: 0.9253; val_best_f1_score: 0.9278; train_kl_reg_loss: 5950.6401; train_edge_recon_loss: 263685.4180; train_cond_contrastive_loss: 78720.8281; train_gene_expr_recon_loss: 94460.2676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442817.1719; train_optim_loss: 442817.1719; val_kl_reg_loss: 5812.4409; val_edge_recon_loss: 261303.3906; val_cond_contrastive_loss: 78440.9766; val_gene_expr_recon_loss: 94945.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440502.3438; val_optim_loss: 440502.3438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9720; val_auprc_score: 0.9654; val_best_acc_score: 0.9221; val_best_f1_score: 0.9257; train_kl_reg_loss: 5970.3444; train_edge_recon_loss: 263063.1250; train_cond_contrastive_loss: 78716.6113; train_gene_expr_recon_loss: 93895.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441645.7578; train_optim_loss: 441645.7578; val_kl_reg_loss: 5891.5967; val_edge_recon_loss: 261520.1250; val_cond_contrastive_loss: 78436.2891; val_gene_expr_recon_loss: 94786.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440634.2188; val_optim_loss: 440634.2188
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9752; val_auprc_score: 0.9711; val_best_acc_score: 0.9262; val_best_f1_score: 0.9297; train_kl_reg_loss: 5964.4126; train_edge_recon_loss: 263321.5156; train_cond_contrastive_loss: 78722.3984; train_gene_expr_recon_loss: 93937.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441946.1641; train_optim_loss: 441946.1641; val_kl_reg_loss: 5781.5527; val_edge_recon_loss: 260693.2188; val_cond_contrastive_loss: 78431.9922; val_gene_expr_recon_loss: 94613.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439520.3750; val_optim_loss: 439520.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9770; val_auprc_score: 0.9738; val_best_acc_score: 0.9292; val_best_f1_score: 0.9320; train_kl_reg_loss: 5919.0804; train_edge_recon_loss: 263566.3594; train_cond_contrastive_loss: 78732.2695; train_gene_expr_recon_loss: 94077.6113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442295.3281; train_optim_loss: 442295.3281; val_kl_reg_loss: 5783.3408; val_edge_recon_loss: 260286.0625; val_cond_contrastive_loss: 78432.8359; val_gene_expr_recon_loss: 94445.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438947.4375; val_optim_loss: 438947.4375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9770; val_auprc_score: 0.9718; val_best_acc_score: 0.9316; val_best_f1_score: 0.9345; train_kl_reg_loss: 5910.6899; train_edge_recon_loss: 262926.6133; train_cond_contrastive_loss: 78724.6641; train_gene_expr_recon_loss: 93460.8066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441022.7734; train_optim_loss: 441022.7734; val_kl_reg_loss: 5789.3125; val_edge_recon_loss: 260071.3906; val_cond_contrastive_loss: 78432.4531; val_gene_expr_recon_loss: 94274.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438567.2500; val_optim_loss: 438567.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9794; val_auprc_score: 0.9708; val_best_acc_score: 0.9365; val_best_f1_score: 0.9386; train_kl_reg_loss: 5914.6428; train_edge_recon_loss: 261598.5039; train_cond_contrastive_loss: 78718.2402; train_gene_expr_recon_loss: 93273.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439505.0781; train_optim_loss: 439505.0781; val_kl_reg_loss: 5737.9751; val_edge_recon_loss: 261457.6875; val_cond_contrastive_loss: 78433.5312; val_gene_expr_recon_loss: 94147.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439776.6250; val_optim_loss: 439776.6250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9810; val_auprc_score: 0.9773; val_best_acc_score: 0.9376; val_best_f1_score: 0.9399; train_kl_reg_loss: 5889.8000; train_edge_recon_loss: 262271.0586; train_cond_contrastive_loss: 78728.2676; train_gene_expr_recon_loss: 93775.3730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440664.5000; train_optim_loss: 440664.5000; val_kl_reg_loss: 5748.5352; val_edge_recon_loss: 262270.8438; val_cond_contrastive_loss: 78436.0938; val_gene_expr_recon_loss: 93977.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440432.6875; val_optim_loss: 440432.6875
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9791; val_auprc_score: 0.9735; val_best_acc_score: 0.9375; val_best_f1_score: 0.9391; train_kl_reg_loss: 5871.1497; train_edge_recon_loss: 260909.0820; train_cond_contrastive_loss: 78729.9043; train_gene_expr_recon_loss: 93153.7207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438663.8516; train_optim_loss: 438663.8516; val_kl_reg_loss: 5730.1099; val_edge_recon_loss: 264247.9688; val_cond_contrastive_loss: 78438.2578; val_gene_expr_recon_loss: 93821.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442238.0625; val_optim_loss: 442238.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9802; val_auprc_score: 0.9758; val_best_acc_score: 0.9372; val_best_f1_score: 0.9395; train_kl_reg_loss: 5857.0388; train_edge_recon_loss: 262979.1211; train_cond_contrastive_loss: 78733.6230; train_gene_expr_recon_loss: 93148.3379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440718.1094; train_optim_loss: 440718.1094; val_kl_reg_loss: 5736.3223; val_edge_recon_loss: 259548.6719; val_cond_contrastive_loss: 78438.9062; val_gene_expr_recon_loss: 93797.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437521.4375; val_optim_loss: 437521.4375
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9810; val_auprc_score: 0.9769; val_best_acc_score: 0.9408; val_best_f1_score: 0.9431; train_kl_reg_loss: 5860.1061; train_edge_recon_loss: 263188.7383; train_cond_contrastive_loss: 78728.4043; train_gene_expr_recon_loss: 93759.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441537.0938; train_optim_loss: 441537.0938; val_kl_reg_loss: 5731.5244; val_edge_recon_loss: 255972.5312; val_cond_contrastive_loss: 78439.6797; val_gene_expr_recon_loss: 93773.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433917.1250; val_optim_loss: 433917.1250
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9811; val_auprc_score: 0.9742; val_best_acc_score: 0.9395; val_best_f1_score: 0.9416; train_kl_reg_loss: 5854.0453; train_edge_recon_loss: 261497.2812; train_cond_contrastive_loss: 78727.5488; train_gene_expr_recon_loss: 92902.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438981.7891; train_optim_loss: 438981.7891; val_kl_reg_loss: 5725.4492; val_edge_recon_loss: 258496.7344; val_cond_contrastive_loss: 78439.0312; val_gene_expr_recon_loss: 93750.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436411.2500; val_optim_loss: 436411.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9817; val_auprc_score: 0.9762; val_best_acc_score: 0.9449; val_best_f1_score: 0.9464; train_kl_reg_loss: 5851.4442; train_edge_recon_loss: 262212.1289; train_cond_contrastive_loss: 78733.6699; train_gene_expr_recon_loss: 93818.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440615.8750; train_optim_loss: 440615.8750; val_kl_reg_loss: 5722.3037; val_edge_recon_loss: 259639.2344; val_cond_contrastive_loss: 78439.3672; val_gene_expr_recon_loss: 93732.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437533.1250; val_optim_loss: 437533.1250
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9820; val_auprc_score: 0.9751; val_best_acc_score: 0.9424; val_best_f1_score: 0.9444; train_kl_reg_loss: 5833.4987; train_edge_recon_loss: 262277.5547; train_cond_contrastive_loss: 78730.1602; train_gene_expr_recon_loss: 93741.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440582.4609; train_optim_loss: 440582.4609; val_kl_reg_loss: 5719.3242; val_edge_recon_loss: 259726.8281; val_cond_contrastive_loss: 78439.5078; val_gene_expr_recon_loss: 93715.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437600.6875; val_optim_loss: 437600.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9806; val_auprc_score: 0.9750; val_best_acc_score: 0.9417; val_best_f1_score: 0.9440; train_kl_reg_loss: 5844.4122; train_edge_recon_loss: 262087.6641; train_cond_contrastive_loss: 78726.7168; train_gene_expr_recon_loss: 93622.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440281.1406; train_optim_loss: 440281.1406; val_kl_reg_loss: 5721.6885; val_edge_recon_loss: 259959.0156; val_cond_contrastive_loss: 78439.4297; val_gene_expr_recon_loss: 93713.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437833.4688; val_optim_loss: 437833.4688
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9777; val_auprc_score: 0.9690; val_best_acc_score: 0.9348; val_best_f1_score: 0.9373; train_kl_reg_loss: 5857.8401; train_edge_recon_loss: 262735.1562; train_cond_contrastive_loss: 78726.5742; train_gene_expr_recon_loss: 93711.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441031.4141; train_optim_loss: 441031.4141; val_kl_reg_loss: 5719.3369; val_edge_recon_loss: 261965.7188; val_cond_contrastive_loss: 78438.9531; val_gene_expr_recon_loss: 93711.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439835.6875; val_optim_loss: 439835.6875
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9817; val_auprc_score: 0.9745; val_best_acc_score: 0.9424; val_best_f1_score: 0.9453; train_kl_reg_loss: 5837.8768; train_edge_recon_loss: 263111.0000; train_cond_contrastive_loss: 78733.7871; train_gene_expr_recon_loss: 93063.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440745.9922; train_optim_loss: 440745.9922; val_kl_reg_loss: 5717.2144; val_edge_recon_loss: 257255.9688; val_cond_contrastive_loss: 78439.9609; val_gene_expr_recon_loss: 93709.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435122.8750; val_optim_loss: 435122.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 37 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9806
Val AUPRC score: 0.9735
Val best accuracy score: 0.9373
Val best F1 score: 0.9392
Val gene expr MSE score: 1.4902
Duration of model training in run 4: 0 hours, 1 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7686; val_auprc_score: 0.8095; val_best_acc_score: 0.6909; val_best_f1_score: 0.7092; train_kl_reg_loss: 3167.1682; train_edge_recon_loss: 361581.0781; train_cond_contrastive_loss: 109673.2786; train_gene_expr_recon_loss: 122309.0755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 596730.5938; train_optim_loss: 596730.5938; val_kl_reg_loss: 12382.6426; val_edge_recon_loss: 397441.2500; val_cond_contrastive_loss: 78342.2344; val_gene_expr_recon_loss: 104163.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592329.3750; val_optim_loss: 592329.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7204; val_auprc_score: 0.7557; val_best_acc_score: 0.6379; val_best_f1_score: 0.7031; train_kl_reg_loss: 9171.5035; train_edge_recon_loss: 354830.2812; train_cond_contrastive_loss: 89126.7148; train_gene_expr_recon_loss: 102797.1107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 555925.6146; train_optim_loss: 555925.6146; val_kl_reg_loss: 4770.8682; val_edge_recon_loss: 384167.1562; val_cond_contrastive_loss: 78378.3125; val_gene_expr_recon_loss: 100678.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567995.0625; val_optim_loss: 567995.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7182; val_auprc_score: 0.7457; val_best_acc_score: 0.6469; val_best_f1_score: 0.6943; train_kl_reg_loss: 4347.7333; train_edge_recon_loss: 346240.3177; train_cond_contrastive_loss: 89030.4049; train_gene_expr_recon_loss: 100344.6966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 539963.1562; train_optim_loss: 539963.1562; val_kl_reg_loss: 3660.7939; val_edge_recon_loss: 347277.9062; val_cond_contrastive_loss: 78440.5938; val_gene_expr_recon_loss: 99907.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 529286.4375; val_optim_loss: 529286.4375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7224; val_auprc_score: 0.7546; val_best_acc_score: 0.6611; val_best_f1_score: 0.7012; train_kl_reg_loss: 3739.4781; train_edge_recon_loss: 327156.9062; train_cond_contrastive_loss: 84709.1003; train_gene_expr_recon_loss: 99486.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 515092.3854; train_optim_loss: 515092.3854; val_kl_reg_loss: 4118.1602; val_edge_recon_loss: 328108.0312; val_cond_contrastive_loss: 78362.4766; val_gene_expr_recon_loss: 99160.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509749.2188; val_optim_loss: 509749.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7664; val_auprc_score: 0.7823; val_best_acc_score: 0.6843; val_best_f1_score: 0.7227; train_kl_reg_loss: 4443.2701; train_edge_recon_loss: 317443.9740; train_cond_contrastive_loss: 79293.4688; train_gene_expr_recon_loss: 98675.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499856.6719; train_optim_loss: 499856.6719; val_kl_reg_loss: 4754.5259; val_edge_recon_loss: 309657.6250; val_cond_contrastive_loss: 78368.5312; val_gene_expr_recon_loss: 98315.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491096.6250; val_optim_loss: 491096.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8264; val_auprc_score: 0.8139; val_best_acc_score: 0.7422; val_best_f1_score: 0.7746; train_kl_reg_loss: 5086.9647; train_edge_recon_loss: 298433.6979; train_cond_contrastive_loss: 78884.9792; train_gene_expr_recon_loss: 98062.7122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480468.3438; train_optim_loss: 480468.3438; val_kl_reg_loss: 5623.8047; val_edge_recon_loss: 291006.7500; val_cond_contrastive_loss: 78384.7031; val_gene_expr_recon_loss: 97690.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472705.5000; val_optim_loss: 472705.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8401; val_auprc_score: 0.8205; val_best_acc_score: 0.7668; val_best_f1_score: 0.7983; train_kl_reg_loss: 6071.2565; train_edge_recon_loss: 284725.4115; train_cond_contrastive_loss: 78759.8620; train_gene_expr_recon_loss: 97264.0404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466820.5677; train_optim_loss: 466820.5677; val_kl_reg_loss: 6475.2715; val_edge_recon_loss: 281609.4688; val_cond_contrastive_loss: 78379.0781; val_gene_expr_recon_loss: 96915.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463379.7812; val_optim_loss: 463379.7812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8515; val_auprc_score: 0.8263; val_best_acc_score: 0.7765; val_best_f1_score: 0.8057; train_kl_reg_loss: 6581.5461; train_edge_recon_loss: 281986.1875; train_cond_contrastive_loss: 78840.0534; train_gene_expr_recon_loss: 96618.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464026.5521; train_optim_loss: 464026.5521; val_kl_reg_loss: 6489.5820; val_edge_recon_loss: 279920.5000; val_cond_contrastive_loss: 78375.2812; val_gene_expr_recon_loss: 96276.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461061.9062; val_optim_loss: 461061.9062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8680; val_auprc_score: 0.8417; val_best_acc_score: 0.7903; val_best_f1_score: 0.8145; train_kl_reg_loss: 6499.3660; train_edge_recon_loss: 281052.6302; train_cond_contrastive_loss: 78964.7630; train_gene_expr_recon_loss: 96055.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462571.8125; train_optim_loss: 462571.8125; val_kl_reg_loss: 6444.1572; val_edge_recon_loss: 278691.8438; val_cond_contrastive_loss: 78383.0938; val_gene_expr_recon_loss: 95808.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459327.6250; val_optim_loss: 459327.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8804; val_auprc_score: 0.8479; val_best_acc_score: 0.8141; val_best_f1_score: 0.8299; train_kl_reg_loss: 6584.4619; train_edge_recon_loss: 278221.7135; train_cond_contrastive_loss: 78982.2370; train_gene_expr_recon_loss: 95529.2956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459317.6979; train_optim_loss: 459317.6979; val_kl_reg_loss: 6624.9121; val_edge_recon_loss: 278893.8438; val_cond_contrastive_loss: 78398.4297; val_gene_expr_recon_loss: 95445.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459363.0938; val_optim_loss: 459363.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9038; val_auprc_score: 0.8822; val_best_acc_score: 0.8351; val_best_f1_score: 0.8511; train_kl_reg_loss: 6689.6049; train_edge_recon_loss: 275000.1198; train_cond_contrastive_loss: 78902.1823; train_gene_expr_recon_loss: 95078.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455670.1302; train_optim_loss: 455670.1302; val_kl_reg_loss: 6451.9287; val_edge_recon_loss: 274066.7500; val_cond_contrastive_loss: 78418.8828; val_gene_expr_recon_loss: 95020.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453957.7188; val_optim_loss: 453957.7188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9244; val_auprc_score: 0.9061; val_best_acc_score: 0.8530; val_best_f1_score: 0.8636; train_kl_reg_loss: 6326.5981; train_edge_recon_loss: 272861.9948; train_cond_contrastive_loss: 78915.4948; train_gene_expr_recon_loss: 94853.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452957.1198; train_optim_loss: 452957.1198; val_kl_reg_loss: 6014.8237; val_edge_recon_loss: 272358.1875; val_cond_contrastive_loss: 78436.3281; val_gene_expr_recon_loss: 94702.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451512.0625; val_optim_loss: 451512.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9428; val_auprc_score: 0.9312; val_best_acc_score: 0.8723; val_best_f1_score: 0.8776; train_kl_reg_loss: 6070.7948; train_edge_recon_loss: 270348.6875; train_cond_contrastive_loss: 78871.5781; train_gene_expr_recon_loss: 94673.3763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449964.4219; train_optim_loss: 449964.4219; val_kl_reg_loss: 6136.7554; val_edge_recon_loss: 269567.2812; val_cond_contrastive_loss: 78437.3906; val_gene_expr_recon_loss: 94379.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448520.4375; val_optim_loss: 448520.4375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9521; val_auprc_score: 0.9414; val_best_acc_score: 0.8900; val_best_f1_score: 0.8943; train_kl_reg_loss: 6264.0891; train_edge_recon_loss: 268603.7083; train_cond_contrastive_loss: 78715.6576; train_gene_expr_recon_loss: 94281.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447864.6875; train_optim_loss: 447864.6875; val_kl_reg_loss: 6283.1504; val_edge_recon_loss: 268836.4375; val_cond_contrastive_loss: 78425.0781; val_gene_expr_recon_loss: 94037.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447582.0625; val_optim_loss: 447582.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9597; val_auprc_score: 0.9513; val_best_acc_score: 0.9013; val_best_f1_score: 0.9035; train_kl_reg_loss: 6290.2256; train_edge_recon_loss: 268887.7135; train_cond_contrastive_loss: 78678.9622; train_gene_expr_recon_loss: 93964.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447821.6875; train_optim_loss: 447821.6875; val_kl_reg_loss: 6150.3398; val_edge_recon_loss: 267972.7812; val_cond_contrastive_loss: 78418.7734; val_gene_expr_recon_loss: 93762.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446304.0938; val_optim_loss: 446304.0938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9627; val_auprc_score: 0.9546; val_best_acc_score: 0.9074; val_best_f1_score: 0.9102; train_kl_reg_loss: 6163.3676; train_edge_recon_loss: 267407.0990; train_cond_contrastive_loss: 78701.0117; train_gene_expr_recon_loss: 93637.1615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445908.6354; train_optim_loss: 445908.6354; val_kl_reg_loss: 6075.5508; val_edge_recon_loss: 265863.1250; val_cond_contrastive_loss: 78416.0234; val_gene_expr_recon_loss: 93500.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443855.6562; val_optim_loss: 443855.6562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9698; val_auprc_score: 0.9629; val_best_acc_score: 0.9185; val_best_f1_score: 0.9207; train_kl_reg_loss: 6072.6014; train_edge_recon_loss: 265662.0677; train_cond_contrastive_loss: 78725.3503; train_gene_expr_recon_loss: 93120.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443580.2500; train_optim_loss: 443580.2500; val_kl_reg_loss: 6021.7578; val_edge_recon_loss: 265132.6875; val_cond_contrastive_loss: 78416.3906; val_gene_expr_recon_loss: 93241.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442812.5625; val_optim_loss: 442812.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9753; val_auprc_score: 0.9677; val_best_acc_score: 0.9285; val_best_f1_score: 0.9305; train_kl_reg_loss: 6025.6985; train_edge_recon_loss: 263469.3516; train_cond_contrastive_loss: 78731.8190; train_gene_expr_recon_loss: 92945.3294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441172.2031; train_optim_loss: 441172.2031; val_kl_reg_loss: 5974.0645; val_edge_recon_loss: 262882.8125; val_cond_contrastive_loss: 78413.9531; val_gene_expr_recon_loss: 93037.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440308.4688; val_optim_loss: 440308.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9768; val_auprc_score: 0.9718; val_best_acc_score: 0.9312; val_best_f1_score: 0.9333; train_kl_reg_loss: 5947.1825; train_edge_recon_loss: 264015.7552; train_cond_contrastive_loss: 78740.1133; train_gene_expr_recon_loss: 93047.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441750.2188; train_optim_loss: 441750.2188; val_kl_reg_loss: 5902.8882; val_edge_recon_loss: 262447.1875; val_cond_contrastive_loss: 78411.1328; val_gene_expr_recon_loss: 92853.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439614.1875; val_optim_loss: 439614.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9821; val_auprc_score: 0.9790; val_best_acc_score: 0.9373; val_best_f1_score: 0.9377; train_kl_reg_loss: 5934.9169; train_edge_recon_loss: 264019.5755; train_cond_contrastive_loss: 78726.2044; train_gene_expr_recon_loss: 92709.9206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441390.6302; train_optim_loss: 441390.6302; val_kl_reg_loss: 5838.8848; val_edge_recon_loss: 262983.1562; val_cond_contrastive_loss: 78407.2266; val_gene_expr_recon_loss: 92682.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439911.6562; val_optim_loss: 439911.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9811; val_auprc_score: 0.9743; val_best_acc_score: 0.9391; val_best_f1_score: 0.9403; train_kl_reg_loss: 5906.6667; train_edge_recon_loss: 263636.2005; train_cond_contrastive_loss: 78708.9284; train_gene_expr_recon_loss: 92432.4049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440684.1927; train_optim_loss: 440684.1927; val_kl_reg_loss: 5849.6553; val_edge_recon_loss: 261362.9062; val_cond_contrastive_loss: 78404.7109; val_gene_expr_recon_loss: 92500.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438117.9375; val_optim_loss: 438117.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9815; val_auprc_score: 0.9773; val_best_acc_score: 0.9400; val_best_f1_score: 0.9414; train_kl_reg_loss: 5900.4931; train_edge_recon_loss: 262857.0052; train_cond_contrastive_loss: 78685.9062; train_gene_expr_recon_loss: 92295.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439738.5365; train_optim_loss: 439738.5365; val_kl_reg_loss: 5824.1538; val_edge_recon_loss: 259017.0781; val_cond_contrastive_loss: 78402.2500; val_gene_expr_recon_loss: 92259.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435502.6875; val_optim_loss: 435502.6875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9808; val_auprc_score: 0.9734; val_best_acc_score: 0.9396; val_best_f1_score: 0.9416; train_kl_reg_loss: 5890.8128; train_edge_recon_loss: 262298.8203; train_cond_contrastive_loss: 78687.4115; train_gene_expr_recon_loss: 92018.9622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438896.0000; train_optim_loss: 438896.0000; val_kl_reg_loss: 5823.0083; val_edge_recon_loss: 258244.3281; val_cond_contrastive_loss: 78400.9922; val_gene_expr_recon_loss: 92037.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434506.2188; val_optim_loss: 434506.2188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9844; val_auprc_score: 0.9804; val_best_acc_score: 0.9451; val_best_f1_score: 0.9462; train_kl_reg_loss: 5873.6458; train_edge_recon_loss: 261212.4141; train_cond_contrastive_loss: 78690.2617; train_gene_expr_recon_loss: 91801.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437578.1927; train_optim_loss: 437578.1927; val_kl_reg_loss: 5873.2715; val_edge_recon_loss: 260754.3438; val_cond_contrastive_loss: 78399.5547; val_gene_expr_recon_loss: 91827.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436854.3125; val_optim_loss: 436854.3125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9821; val_auprc_score: 0.9757; val_best_acc_score: 0.9433; val_best_f1_score: 0.9452; train_kl_reg_loss: 5912.1001; train_edge_recon_loss: 260284.4010; train_cond_contrastive_loss: 78687.5326; train_gene_expr_recon_loss: 91433.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436317.4740; train_optim_loss: 436317.4740; val_kl_reg_loss: 5852.0415; val_edge_recon_loss: 258544.3281; val_cond_contrastive_loss: 78399.9141; val_gene_expr_recon_loss: 91604.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434401.2500; val_optim_loss: 434401.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9854; val_auprc_score: 0.9810; val_best_acc_score: 0.9481; val_best_f1_score: 0.9500; train_kl_reg_loss: 5854.4623; train_edge_recon_loss: 261485.7969; train_cond_contrastive_loss: 78699.4089; train_gene_expr_recon_loss: 91319.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437359.4323; train_optim_loss: 437359.4323; val_kl_reg_loss: 5754.4160; val_edge_recon_loss: 258143.4219; val_cond_contrastive_loss: 78398.4609; val_gene_expr_recon_loss: 91377.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433674.0625; val_optim_loss: 433674.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9873; val_auprc_score: 0.9841; val_best_acc_score: 0.9519; val_best_f1_score: 0.9537; train_kl_reg_loss: 5830.1061; train_edge_recon_loss: 261891.3906; train_cond_contrastive_loss: 78697.9010; train_gene_expr_recon_loss: 91112.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437532.0729; train_optim_loss: 437532.0729; val_kl_reg_loss: 5716.1016; val_edge_recon_loss: 257210.5781; val_cond_contrastive_loss: 78396.7188; val_gene_expr_recon_loss: 91179.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432502.8125; val_optim_loss: 432502.8125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9857; val_auprc_score: 0.9796; val_best_acc_score: 0.9487; val_best_f1_score: 0.9504; train_kl_reg_loss: 5819.2424; train_edge_recon_loss: 261175.7214; train_cond_contrastive_loss: 78671.3971; train_gene_expr_recon_loss: 91028.4753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436694.8385; train_optim_loss: 436694.8385; val_kl_reg_loss: 5722.6572; val_edge_recon_loss: 257559.6562; val_cond_contrastive_loss: 78397.3984; val_gene_expr_recon_loss: 90992.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432672.4375; val_optim_loss: 432672.4375
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9883; val_auprc_score: 0.9852; val_best_acc_score: 0.9533; val_best_f1_score: 0.9539; train_kl_reg_loss: 5787.9097; train_edge_recon_loss: 261482.7760; train_cond_contrastive_loss: 78671.3607; train_gene_expr_recon_loss: 91012.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436954.2604; train_optim_loss: 436954.2604; val_kl_reg_loss: 5649.2197; val_edge_recon_loss: 261167.3438; val_cond_contrastive_loss: 78398.8281; val_gene_expr_recon_loss: 90804.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436019.8750; val_optim_loss: 436019.8750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9874; val_auprc_score: 0.9812; val_best_acc_score: 0.9549; val_best_f1_score: 0.9561; train_kl_reg_loss: 5736.1373; train_edge_recon_loss: 261187.8359; train_cond_contrastive_loss: 78673.6953; train_gene_expr_recon_loss: 90679.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436277.2865; train_optim_loss: 436277.2865; val_kl_reg_loss: 5715.1201; val_edge_recon_loss: 257515.7812; val_cond_contrastive_loss: 78402.4219; val_gene_expr_recon_loss: 90586.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432220.1875; val_optim_loss: 432220.1875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9872; val_auprc_score: 0.9827; val_best_acc_score: 0.9512; val_best_f1_score: 0.9529; train_kl_reg_loss: 5815.1237; train_edge_recon_loss: 260074.5547; train_cond_contrastive_loss: 78659.4167; train_gene_expr_recon_loss: 90309.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434858.4010; train_optim_loss: 434858.4010; val_kl_reg_loss: 5711.1533; val_edge_recon_loss: 258015.2188; val_cond_contrastive_loss: 78405.3125; val_gene_expr_recon_loss: 90400.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432532.6875; val_optim_loss: 432532.6875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9881; val_auprc_score: 0.9829; val_best_acc_score: 0.9527; val_best_f1_score: 0.9537; train_kl_reg_loss: 5732.1399; train_edge_recon_loss: 260935.6094; train_cond_contrastive_loss: 78670.3815; train_gene_expr_recon_loss: 90234.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435572.9792; train_optim_loss: 435572.9792; val_kl_reg_loss: 5629.3242; val_edge_recon_loss: 258959.1094; val_cond_contrastive_loss: 78407.2656; val_gene_expr_recon_loss: 90231.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433227.3750; val_optim_loss: 433227.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9895; val_auprc_score: 0.9841; val_best_acc_score: 0.9578; val_best_f1_score: 0.9588; train_kl_reg_loss: 5732.1233; train_edge_recon_loss: 259636.7682; train_cond_contrastive_loss: 78670.1419; train_gene_expr_recon_loss: 90064.0169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434103.0521; train_optim_loss: 434103.0521; val_kl_reg_loss: 5671.9443; val_edge_recon_loss: 259758.0625; val_cond_contrastive_loss: 78408.9375; val_gene_expr_recon_loss: 90061.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433900.1250; val_optim_loss: 433900.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9882; val_auprc_score: 0.9826; val_best_acc_score: 0.9555; val_best_f1_score: 0.9569; train_kl_reg_loss: 5751.7247; train_edge_recon_loss: 259849.3672; train_cond_contrastive_loss: 78675.8906; train_gene_expr_recon_loss: 89869.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434146.0312; train_optim_loss: 434146.0312; val_kl_reg_loss: 5655.1631; val_edge_recon_loss: 257820.0156; val_cond_contrastive_loss: 78409.5469; val_gene_expr_recon_loss: 90038.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431923.3750; val_optim_loss: 431923.3750
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9892; val_auprc_score: 0.9847; val_best_acc_score: 0.9561; val_best_f1_score: 0.9571; train_kl_reg_loss: 5728.7961; train_edge_recon_loss: 259638.6094; train_cond_contrastive_loss: 78679.8086; train_gene_expr_recon_loss: 89888.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433936.2031; train_optim_loss: 433936.2031; val_kl_reg_loss: 5627.3545; val_edge_recon_loss: 260648.8125; val_cond_contrastive_loss: 78409.1406; val_gene_expr_recon_loss: 90016.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434701.3750; val_optim_loss: 434701.3750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9888; val_auprc_score: 0.9865; val_best_acc_score: 0.9511; val_best_f1_score: 0.9525; train_kl_reg_loss: 5701.9473; train_edge_recon_loss: 259178.7031; train_cond_contrastive_loss: 78691.2292; train_gene_expr_recon_loss: 89760.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433332.1094; train_optim_loss: 433332.1094; val_kl_reg_loss: 5616.5859; val_edge_recon_loss: 259150.9219; val_cond_contrastive_loss: 78409.9922; val_gene_expr_recon_loss: 90000.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433178.2500; val_optim_loss: 433178.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9885; val_auprc_score: 0.9847; val_best_acc_score: 0.9565; val_best_f1_score: 0.9582; train_kl_reg_loss: 5705.4814; train_edge_recon_loss: 260997.0365; train_cond_contrastive_loss: 78684.4727; train_gene_expr_recon_loss: 89874.7096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435261.7135; train_optim_loss: 435261.7135; val_kl_reg_loss: 5631.7554; val_edge_recon_loss: 255651.0625; val_cond_contrastive_loss: 78411.2266; val_gene_expr_recon_loss: 89985.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429679.8750; val_optim_loss: 429679.8750
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9870; val_best_acc_score: 0.9562; val_best_f1_score: 0.9575; train_kl_reg_loss: 5709.0422; train_edge_recon_loss: 260787.3307; train_cond_contrastive_loss: 78673.6146; train_gene_expr_recon_loss: 89809.6654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434979.6510; train_optim_loss: 434979.6510; val_kl_reg_loss: 5618.2285; val_edge_recon_loss: 256908.6875; val_cond_contrastive_loss: 78411.3125; val_gene_expr_recon_loss: 89970.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430909.0938; val_optim_loss: 430909.0938
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9888; val_auprc_score: 0.9854; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 5708.6095; train_edge_recon_loss: 259927.5443; train_cond_contrastive_loss: 78686.1120; train_gene_expr_recon_loss: 89764.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434086.3385; train_optim_loss: 434086.3385; val_kl_reg_loss: 5616.7373; val_edge_recon_loss: 258751.0625; val_cond_contrastive_loss: 78411.6484; val_gene_expr_recon_loss: 89954.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432734.2500; val_optim_loss: 432734.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9895; val_auprc_score: 0.9860; val_best_acc_score: 0.9558; val_best_f1_score: 0.9566; train_kl_reg_loss: 5700.8470; train_edge_recon_loss: 260504.8880; train_cond_contrastive_loss: 78683.8737; train_gene_expr_recon_loss: 89787.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434677.1458; train_optim_loss: 434677.1458; val_kl_reg_loss: 5618.4849; val_edge_recon_loss: 259077.0156; val_cond_contrastive_loss: 78411.1875; val_gene_expr_recon_loss: 89939.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433045.7500; val_optim_loss: 433045.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9906; val_auprc_score: 0.9889; val_best_acc_score: 0.9592; val_best_f1_score: 0.9600; train_kl_reg_loss: 5699.4724; train_edge_recon_loss: 258381.7969; train_cond_contrastive_loss: 78688.8620; train_gene_expr_recon_loss: 89784.4518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432554.5885; train_optim_loss: 432554.5885; val_kl_reg_loss: 5614.5786; val_edge_recon_loss: 257837.1406; val_cond_contrastive_loss: 78411.4609; val_gene_expr_recon_loss: 89936.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431800.1875; val_optim_loss: 431800.1875
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9880; val_auprc_score: 0.9834; val_best_acc_score: 0.9544; val_best_f1_score: 0.9550; train_kl_reg_loss: 5701.8244; train_edge_recon_loss: 259207.2396; train_cond_contrastive_loss: 78676.6914; train_gene_expr_recon_loss: 89935.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433520.9531; train_optim_loss: 433520.9531; val_kl_reg_loss: 5620.7402; val_edge_recon_loss: 260058.4688; val_cond_contrastive_loss: 78411.5859; val_gene_expr_recon_loss: 89934.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434025.6250; val_optim_loss: 434025.6250
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9884; val_auprc_score: 0.9846; val_best_acc_score: 0.9533; val_best_f1_score: 0.9548; train_kl_reg_loss: 5701.6502; train_edge_recon_loss: 260412.4922; train_cond_contrastive_loss: 78677.4440; train_gene_expr_recon_loss: 89758.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434550.5833; train_optim_loss: 434550.5833; val_kl_reg_loss: 5610.3701; val_edge_recon_loss: 258791.3594; val_cond_contrastive_loss: 78412.0312; val_gene_expr_recon_loss: 89932.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432746.6562; val_optim_loss: 432746.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 24 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9887
Val AUPRC score: 0.9841
Val best accuracy score: 0.9559
Val best F1 score: 0.9572
Val gene expr MSE score: 1.3708
Duration of model training in run 5: 0 hours, 2 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7571; val_auprc_score: 0.7896; val_best_acc_score: 0.6776; val_best_f1_score: 0.7043; train_kl_reg_loss: 3473.7679; train_edge_recon_loss: 358074.6458; train_cond_contrastive_loss: 109598.7669; train_gene_expr_recon_loss: 120356.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 591504.0625; train_optim_loss: 591504.0625; val_kl_reg_loss: 13840.2031; val_edge_recon_loss: 401421.1562; val_cond_contrastive_loss: 78340.1562; val_gene_expr_recon_loss: 102159.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595761.0625; val_optim_loss: 595761.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7130; val_auprc_score: 0.7418; val_best_acc_score: 0.6313; val_best_f1_score: 0.7023; train_kl_reg_loss: 9506.7450; train_edge_recon_loss: 355799.6667; train_cond_contrastive_loss: 90305.9622; train_gene_expr_recon_loss: 102216.9544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557829.3125; train_optim_loss: 557829.3125; val_kl_reg_loss: 5550.3330; val_edge_recon_loss: 387155.5625; val_cond_contrastive_loss: 78371.9219; val_gene_expr_recon_loss: 99794.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 570872.7500; val_optim_loss: 570872.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7137; val_auprc_score: 0.7367; val_best_acc_score: 0.6389; val_best_f1_score: 0.7008; train_kl_reg_loss: 5252.6224; train_edge_recon_loss: 348595.8854; train_cond_contrastive_loss: 87206.0495; train_gene_expr_recon_loss: 99882.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540937.4271; train_optim_loss: 540937.4271; val_kl_reg_loss: 3628.7505; val_edge_recon_loss: 345833.6562; val_cond_contrastive_loss: 78438.3438; val_gene_expr_recon_loss: 98884.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526785.0000; val_optim_loss: 526785.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7159; val_auprc_score: 0.7436; val_best_acc_score: 0.6499; val_best_f1_score: 0.6954; train_kl_reg_loss: 3630.9740; train_edge_recon_loss: 327341.4375; train_cond_contrastive_loss: 85930.1641; train_gene_expr_recon_loss: 99121.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 516024.0312; train_optim_loss: 516024.0312; val_kl_reg_loss: 4065.9497; val_edge_recon_loss: 329967.6562; val_cond_contrastive_loss: 78370.0625; val_gene_expr_recon_loss: 98312.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 510715.8125; val_optim_loss: 510715.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7709; val_auprc_score: 0.7835; val_best_acc_score: 0.6864; val_best_f1_score: 0.7206; train_kl_reg_loss: 4548.3349; train_edge_recon_loss: 317261.4062; train_cond_contrastive_loss: 79453.2422; train_gene_expr_recon_loss: 98150.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499413.5365; train_optim_loss: 499413.5365; val_kl_reg_loss: 4862.0083; val_edge_recon_loss: 310121.0938; val_cond_contrastive_loss: 78370.1875; val_gene_expr_recon_loss: 97621.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490975.0938; val_optim_loss: 490975.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8125; val_auprc_score: 0.8054; val_best_acc_score: 0.7298; val_best_f1_score: 0.7655; train_kl_reg_loss: 5232.1222; train_edge_recon_loss: 302315.8125; train_cond_contrastive_loss: 78973.0508; train_gene_expr_recon_loss: 97545.6862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484066.6562; train_optim_loss: 484066.6562; val_kl_reg_loss: 5555.0059; val_edge_recon_loss: 293474.0625; val_cond_contrastive_loss: 78392.8594; val_gene_expr_recon_loss: 96969.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474391.1562; val_optim_loss: 474391.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8445; val_auprc_score: 0.8298; val_best_acc_score: 0.7631; val_best_f1_score: 0.7949; train_kl_reg_loss: 5905.7131; train_edge_recon_loss: 287992.8594; train_cond_contrastive_loss: 78809.0339; train_gene_expr_recon_loss: 97031.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469738.8854; train_optim_loss: 469738.8854; val_kl_reg_loss: 6078.7197; val_edge_recon_loss: 283113.6250; val_cond_contrastive_loss: 78387.6953; val_gene_expr_recon_loss: 96284.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463864.8438; val_optim_loss: 463864.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8531; val_auprc_score: 0.8314; val_best_acc_score: 0.7732; val_best_f1_score: 0.7977; train_kl_reg_loss: 6249.9111; train_edge_recon_loss: 281424.6979; train_cond_contrastive_loss: 78866.9753; train_gene_expr_recon_loss: 96424.6654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462966.2448; train_optim_loss: 462966.2448; val_kl_reg_loss: 6142.8398; val_edge_recon_loss: 283458.7500; val_cond_contrastive_loss: 78382.0078; val_gene_expr_recon_loss: 95789.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463773.0938; val_optim_loss: 463773.0938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8666; val_auprc_score: 0.8407; val_best_acc_score: 0.7966; val_best_f1_score: 0.8167; train_kl_reg_loss: 6273.8593; train_edge_recon_loss: 279723.0677; train_cond_contrastive_loss: 78981.7240; train_gene_expr_recon_loss: 95981.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460960.4062; train_optim_loss: 460960.4062; val_kl_reg_loss: 6260.6016; val_edge_recon_loss: 277805.3438; val_cond_contrastive_loss: 78386.5781; val_gene_expr_recon_loss: 95400.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457853.1875; val_optim_loss: 457853.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8878; val_auprc_score: 0.8647; val_best_acc_score: 0.8186; val_best_f1_score: 0.8374; train_kl_reg_loss: 6499.9077; train_edge_recon_loss: 275410.9583; train_cond_contrastive_loss: 78932.0690; train_gene_expr_recon_loss: 95478.9909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456321.9323; train_optim_loss: 456321.9323; val_kl_reg_loss: 6444.2085; val_edge_recon_loss: 275476.4375; val_cond_contrastive_loss: 78397.6953; val_gene_expr_recon_loss: 95023.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455341.6562; val_optim_loss: 455341.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9101; val_auprc_score: 0.8921; val_best_acc_score: 0.8384; val_best_f1_score: 0.8533; train_kl_reg_loss: 6415.6302; train_edge_recon_loss: 272857.2240; train_cond_contrastive_loss: 78909.9271; train_gene_expr_recon_loss: 95044.5456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453227.3333; train_optim_loss: 453227.3333; val_kl_reg_loss: 6084.7231; val_edge_recon_loss: 269835.0312; val_cond_contrastive_loss: 78411.0469; val_gene_expr_recon_loss: 94652.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448983.3125; val_optim_loss: 448983.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9229; val_auprc_score: 0.9051; val_best_acc_score: 0.8544; val_best_f1_score: 0.8642; train_kl_reg_loss: 6094.3005; train_edge_recon_loss: 272194.2917; train_cond_contrastive_loss: 78872.0339; train_gene_expr_recon_loss: 94742.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451903.2292; train_optim_loss: 451903.2292; val_kl_reg_loss: 5967.8789; val_edge_recon_loss: 269881.6875; val_cond_contrastive_loss: 78423.6719; val_gene_expr_recon_loss: 94342.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448615.9375; val_optim_loss: 448615.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9355; val_auprc_score: 0.9223; val_best_acc_score: 0.8655; val_best_f1_score: 0.8714; train_kl_reg_loss: 6104.7568; train_edge_recon_loss: 271260.2708; train_cond_contrastive_loss: 78768.0612; train_gene_expr_recon_loss: 94608.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450741.1406; train_optim_loss: 450741.1406; val_kl_reg_loss: 6083.7734; val_edge_recon_loss: 271948.4375; val_cond_contrastive_loss: 78422.1094; val_gene_expr_recon_loss: 94030.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450484.5938; val_optim_loss: 450484.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9480; val_auprc_score: 0.9352; val_best_acc_score: 0.8825; val_best_f1_score: 0.8874; train_kl_reg_loss: 6251.4628; train_edge_recon_loss: 269895.8490; train_cond_contrastive_loss: 78684.4232; train_gene_expr_recon_loss: 93962.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448794.6510; train_optim_loss: 448794.6510; val_kl_reg_loss: 6164.4404; val_edge_recon_loss: 267335.0625; val_cond_contrastive_loss: 78415.3828; val_gene_expr_recon_loss: 93743.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445658.5938; val_optim_loss: 445658.5938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9532; val_auprc_score: 0.9461; val_best_acc_score: 0.8867; val_best_f1_score: 0.8911; train_kl_reg_loss: 6264.5125; train_edge_recon_loss: 269042.0729; train_cond_contrastive_loss: 78693.0859; train_gene_expr_recon_loss: 93868.2799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447867.9531; train_optim_loss: 447867.9531; val_kl_reg_loss: 6125.8608; val_edge_recon_loss: 269730.5625; val_cond_contrastive_loss: 78410.7109; val_gene_expr_recon_loss: 93472.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447739.9688; val_optim_loss: 447739.9688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9593; val_auprc_score: 0.9527; val_best_acc_score: 0.9006; val_best_f1_score: 0.9044; train_kl_reg_loss: 6178.6970; train_edge_recon_loss: 267796.4323; train_cond_contrastive_loss: 78720.2344; train_gene_expr_recon_loss: 93761.4753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446456.8385; train_optim_loss: 446456.8385; val_kl_reg_loss: 6051.5884; val_edge_recon_loss: 264563.2812; val_cond_contrastive_loss: 78408.1797; val_gene_expr_recon_loss: 93178.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442201.9062; val_optim_loss: 442201.9062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9644; val_auprc_score: 0.9572; val_best_acc_score: 0.9078; val_best_f1_score: 0.9104; train_kl_reg_loss: 6107.2749; train_edge_recon_loss: 267288.5885; train_cond_contrastive_loss: 78744.1771; train_gene_expr_recon_loss: 93364.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445504.0938; train_optim_loss: 445504.0938; val_kl_reg_loss: 5935.5942; val_edge_recon_loss: 266082.6875; val_cond_contrastive_loss: 78409.0312; val_gene_expr_recon_loss: 92896.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443323.7188; val_optim_loss: 443323.7188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9688; val_auprc_score: 0.9585; val_best_acc_score: 0.9174; val_best_f1_score: 0.9200; train_kl_reg_loss: 5959.0632; train_edge_recon_loss: 266782.8906; train_cond_contrastive_loss: 78775.4388; train_gene_expr_recon_loss: 92986.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444504.1042; train_optim_loss: 444504.1042; val_kl_reg_loss: 5843.4473; val_edge_recon_loss: 266274.9062; val_cond_contrastive_loss: 78412.5234; val_gene_expr_recon_loss: 92643.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443174.3750; val_optim_loss: 443174.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9754; val_auprc_score: 0.9674; val_best_acc_score: 0.9283; val_best_f1_score: 0.9292; train_kl_reg_loss: 5903.4219; train_edge_recon_loss: 265759.7292; train_cond_contrastive_loss: 78785.6680; train_gene_expr_recon_loss: 92720.8346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443169.6458; train_optim_loss: 443169.6458; val_kl_reg_loss: 5796.6738; val_edge_recon_loss: 263888.4688; val_cond_contrastive_loss: 78417.2734; val_gene_expr_recon_loss: 92399.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440501.5938; val_optim_loss: 440501.5938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9787; val_auprc_score: 0.9714; val_best_acc_score: 0.9313; val_best_f1_score: 0.9320; train_kl_reg_loss: 5855.1344; train_edge_recon_loss: 263536.4922; train_cond_contrastive_loss: 78793.8320; train_gene_expr_recon_loss: 92471.6849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440657.1562; train_optim_loss: 440657.1562; val_kl_reg_loss: 5746.3506; val_edge_recon_loss: 268036.3438; val_cond_contrastive_loss: 78415.6797; val_gene_expr_recon_loss: 92218.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444416.8438; val_optim_loss: 444416.8438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9797; val_auprc_score: 0.9719; val_best_acc_score: 0.9359; val_best_f1_score: 0.9373; train_kl_reg_loss: 5885.8342; train_edge_recon_loss: 262587.4193; train_cond_contrastive_loss: 78771.3737; train_gene_expr_recon_loss: 92503.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439748.5729; train_optim_loss: 439748.5729; val_kl_reg_loss: 5786.9922; val_edge_recon_loss: 260464.0156; val_cond_contrastive_loss: 78414.5312; val_gene_expr_recon_loss: 92012.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436678.2500; val_optim_loss: 436678.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9835; val_auprc_score: 0.9786; val_best_acc_score: 0.9412; val_best_f1_score: 0.9430; train_kl_reg_loss: 5851.6825; train_edge_recon_loss: 261455.5417; train_cond_contrastive_loss: 78758.1901; train_gene_expr_recon_loss: 92321.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438387.1667; train_optim_loss: 438387.1667; val_kl_reg_loss: 5806.3242; val_edge_recon_loss: 260367.6250; val_cond_contrastive_loss: 78408.5469; val_gene_expr_recon_loss: 91822.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436405.0000; val_optim_loss: 436405.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9829; val_auprc_score: 0.9760; val_best_acc_score: 0.9435; val_best_f1_score: 0.9448; train_kl_reg_loss: 5927.7232; train_edge_recon_loss: 261234.5469; train_cond_contrastive_loss: 78707.7604; train_gene_expr_recon_loss: 91964.9323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437834.9792; train_optim_loss: 437834.9792; val_kl_reg_loss: 5787.2363; val_edge_recon_loss: 261817.2188; val_cond_contrastive_loss: 78404.1953; val_gene_expr_recon_loss: 91620.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437628.7188; val_optim_loss: 437628.7188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9842; val_auprc_score: 0.9795; val_best_acc_score: 0.9448; val_best_f1_score: 0.9461; train_kl_reg_loss: 5871.2566; train_edge_recon_loss: 261400.2057; train_cond_contrastive_loss: 78711.3242; train_gene_expr_recon_loss: 91887.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437870.4479; train_optim_loss: 437870.4479; val_kl_reg_loss: 5822.4951; val_edge_recon_loss: 259746.3438; val_cond_contrastive_loss: 78404.3438; val_gene_expr_recon_loss: 91411.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435384.7188; val_optim_loss: 435384.7188
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9849; val_auprc_score: 0.9815; val_best_acc_score: 0.9452; val_best_f1_score: 0.9464; train_kl_reg_loss: 5935.3890; train_edge_recon_loss: 260848.8229; train_cond_contrastive_loss: 78696.7969; train_gene_expr_recon_loss: 91517.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436998.5573; train_optim_loss: 436998.5573; val_kl_reg_loss: 5812.8174; val_edge_recon_loss: 258150.9062; val_cond_contrastive_loss: 78406.7266; val_gene_expr_recon_loss: 91183.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433553.4688; val_optim_loss: 433553.4688
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9849; val_auprc_score: 0.9798; val_best_acc_score: 0.9473; val_best_f1_score: 0.9483; train_kl_reg_loss: 5845.3271; train_edge_recon_loss: 260286.1276; train_cond_contrastive_loss: 78699.4062; train_gene_expr_recon_loss: 91402.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436233.3229; train_optim_loss: 436233.3229; val_kl_reg_loss: 5736.3101; val_edge_recon_loss: 259982.4375; val_cond_contrastive_loss: 78408.1094; val_gene_expr_recon_loss: 90939.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435066.6562; val_optim_loss: 435066.6562
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9856; val_auprc_score: 0.9829; val_best_acc_score: 0.9441; val_best_f1_score: 0.9451; train_kl_reg_loss: 5831.1908; train_edge_recon_loss: 262422.2656; train_cond_contrastive_loss: 78704.6732; train_gene_expr_recon_loss: 91043.9883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438002.1042; train_optim_loss: 438002.1042; val_kl_reg_loss: 5683.3857; val_edge_recon_loss: 259044.9219; val_cond_contrastive_loss: 78409.1562; val_gene_expr_recon_loss: 90716.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433853.8750; val_optim_loss: 433853.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9864; val_auprc_score: 0.9799; val_best_acc_score: 0.9497; val_best_f1_score: 0.9507; train_kl_reg_loss: 5788.1362; train_edge_recon_loss: 261060.5807; train_cond_contrastive_loss: 78703.2826; train_gene_expr_recon_loss: 90831.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436383.1615; train_optim_loss: 436383.1615; val_kl_reg_loss: 5690.1719; val_edge_recon_loss: 258140.7969; val_cond_contrastive_loss: 78407.6016; val_gene_expr_recon_loss: 90505.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432743.8750; val_optim_loss: 432743.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9861; val_auprc_score: 0.9799; val_best_acc_score: 0.9504; val_best_f1_score: 0.9522; train_kl_reg_loss: 5788.4736; train_edge_recon_loss: 260621.5547; train_cond_contrastive_loss: 78681.8503; train_gene_expr_recon_loss: 90757.7747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435849.6458; train_optim_loss: 435849.6458; val_kl_reg_loss: 5649.4287; val_edge_recon_loss: 256553.9219; val_cond_contrastive_loss: 78407.8984; val_gene_expr_recon_loss: 90292.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430903.9375; val_optim_loss: 430903.9375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9865; val_auprc_score: 0.9819; val_best_acc_score: 0.9478; val_best_f1_score: 0.9488; train_kl_reg_loss: 5711.2244; train_edge_recon_loss: 261199.2448; train_cond_contrastive_loss: 78689.9310; train_gene_expr_recon_loss: 90381.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435981.9844; train_optim_loss: 435981.9844; val_kl_reg_loss: 5594.5078; val_edge_recon_loss: 260905.1406; val_cond_contrastive_loss: 78410.1016; val_gene_expr_recon_loss: 90107.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435016.9375; val_optim_loss: 435016.9375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9859; val_auprc_score: 0.9827; val_best_acc_score: 0.9490; val_best_f1_score: 0.9504; train_kl_reg_loss: 5744.0435; train_edge_recon_loss: 260117.9818; train_cond_contrastive_loss: 78680.7031; train_gene_expr_recon_loss: 90183.6849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434726.4167; train_optim_loss: 434726.4167; val_kl_reg_loss: 5615.3193; val_edge_recon_loss: 260633.8594; val_cond_contrastive_loss: 78412.3281; val_gene_expr_recon_loss: 89936.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434598.1250; val_optim_loss: 434598.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9869; val_auprc_score: 0.9796; val_best_acc_score: 0.9547; val_best_f1_score: 0.9559; train_kl_reg_loss: 5706.9694; train_edge_recon_loss: 260711.2760; train_cond_contrastive_loss: 78673.9883; train_gene_expr_recon_loss: 90058.8490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435151.0781; train_optim_loss: 435151.0781; val_kl_reg_loss: 5600.0928; val_edge_recon_loss: 257817.3906; val_cond_contrastive_loss: 78413.9375; val_gene_expr_recon_loss: 89772.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431603.8750; val_optim_loss: 431603.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9871; val_auprc_score: 0.9837; val_best_acc_score: 0.9520; val_best_f1_score: 0.9530; train_kl_reg_loss: 5710.6443; train_edge_recon_loss: 259767.6562; train_cond_contrastive_loss: 78663.2682; train_gene_expr_recon_loss: 89877.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434018.5677; train_optim_loss: 434018.5677; val_kl_reg_loss: 5587.9121; val_edge_recon_loss: 259110.4844; val_cond_contrastive_loss: 78414.3516; val_gene_expr_recon_loss: 89724.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432837.3125; val_optim_loss: 432837.3125
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9868; val_auprc_score: 0.9815; val_best_acc_score: 0.9527; val_best_f1_score: 0.9536; train_kl_reg_loss: 5697.6141; train_edge_recon_loss: 259890.1224; train_cond_contrastive_loss: 78675.1979; train_gene_expr_recon_loss: 89865.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434128.1094; train_optim_loss: 434128.1094; val_kl_reg_loss: 5584.0132; val_edge_recon_loss: 261079.4062; val_cond_contrastive_loss: 78413.8828; val_gene_expr_recon_loss: 89703.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434780.5938; val_optim_loss: 434780.5938
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9875; val_auprc_score: 0.9824; val_best_acc_score: 0.9540; val_best_f1_score: 0.9552; train_kl_reg_loss: 5695.3085; train_edge_recon_loss: 259584.7969; train_cond_contrastive_loss: 78665.8151; train_gene_expr_recon_loss: 89842.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433788.3073; train_optim_loss: 433788.3073; val_kl_reg_loss: 5579.8838; val_edge_recon_loss: 258982.8438; val_cond_contrastive_loss: 78413.9141; val_gene_expr_recon_loss: 89689.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432665.6250; val_optim_loss: 432665.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 52 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9862
Val AUPRC score: 0.9805
Val best accuracy score: 0.9495
Val best F1 score: 0.9508
Val gene expr MSE score: 1.3875
Duration of model training in run 6: 0 hours, 1 minutes and 55 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7835; val_auprc_score: 0.8177; val_best_acc_score: 0.7060; val_best_f1_score: 0.7169; train_kl_reg_loss: 4976.0266; train_edge_recon_loss: 357784.3393; train_cond_contrastive_loss: 106292.4944; train_gene_expr_recon_loss: 121347.8862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 590400.7589; train_optim_loss: 590400.7589; val_kl_reg_loss: 8833.4902; val_edge_recon_loss: 398262.1562; val_cond_contrastive_loss: 78335.9453; val_gene_expr_recon_loss: 101533.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 586965.4375; val_optim_loss: 586965.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7406; val_auprc_score: 0.7670; val_best_acc_score: 0.6504; val_best_f1_score: 0.7160; train_kl_reg_loss: 7418.6705; train_edge_recon_loss: 353781.2589; train_cond_contrastive_loss: 87902.6194; train_gene_expr_recon_loss: 101790.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550892.7768; train_optim_loss: 550892.7768; val_kl_reg_loss: 4682.8042; val_edge_recon_loss: 373922.0000; val_cond_contrastive_loss: 78382.2500; val_gene_expr_recon_loss: 99018.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556005.6875; val_optim_loss: 556005.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7463; val_auprc_score: 0.7676; val_best_acc_score: 0.6697; val_best_f1_score: 0.7082; train_kl_reg_loss: 3840.7221; train_edge_recon_loss: 338915.1295; train_cond_contrastive_loss: 87432.6116; train_gene_expr_recon_loss: 99711.4107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529899.8795; train_optim_loss: 529899.8795; val_kl_reg_loss: 3216.0366; val_edge_recon_loss: 327202.0000; val_cond_contrastive_loss: 78376.9766; val_gene_expr_recon_loss: 98284.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 507079.7188; val_optim_loss: 507079.7188
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7809; val_auprc_score: 0.7950; val_best_acc_score: 0.6978; val_best_f1_score: 0.7273; train_kl_reg_loss: 3979.0525; train_edge_recon_loss: 315690.5491; train_cond_contrastive_loss: 80567.2455; train_gene_expr_recon_loss: 99270.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499507.5759; train_optim_loss: 499507.5759; val_kl_reg_loss: 4915.6406; val_edge_recon_loss: 306798.3125; val_cond_contrastive_loss: 78360.8203; val_gene_expr_recon_loss: 97412.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487487.5000; val_optim_loss: 487487.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8271; val_auprc_score: 0.8168; val_best_acc_score: 0.7411; val_best_f1_score: 0.7737; train_kl_reg_loss: 5675.1755; train_edge_recon_loss: 296620.7188; train_cond_contrastive_loss: 78740.3895; train_gene_expr_recon_loss: 98029.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479065.8929; train_optim_loss: 479065.8929; val_kl_reg_loss: 6313.2090; val_edge_recon_loss: 291652.8438; val_cond_contrastive_loss: 78369.1250; val_gene_expr_recon_loss: 96661.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472996.3438; val_optim_loss: 472996.3438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8543; val_auprc_score: 0.8361; val_best_acc_score: 0.7787; val_best_f1_score: 0.8039; train_kl_reg_loss: 6480.4369; train_edge_recon_loss: 283347.8393; train_cond_contrastive_loss: 78634.0569; train_gene_expr_recon_loss: 97003.8326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465466.1652; train_optim_loss: 465466.1652; val_kl_reg_loss: 6308.8174; val_edge_recon_loss: 278972.0000; val_cond_contrastive_loss: 78369.9531; val_gene_expr_recon_loss: 95895.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459545.7500; val_optim_loss: 459545.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8727; val_auprc_score: 0.8486; val_best_acc_score: 0.8025; val_best_f1_score: 0.8202; train_kl_reg_loss: 6177.7131; train_edge_recon_loss: 279432.5893; train_cond_contrastive_loss: 78824.4252; train_gene_expr_recon_loss: 97164.4710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461599.2098; train_optim_loss: 461599.2098; val_kl_reg_loss: 5801.3350; val_edge_recon_loss: 278762.7812; val_cond_contrastive_loss: 78367.2500; val_gene_expr_recon_loss: 95358.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458290.1875; val_optim_loss: 458290.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8930; val_auprc_score: 0.8700; val_best_acc_score: 0.8291; val_best_f1_score: 0.8442; train_kl_reg_loss: 5917.4136; train_edge_recon_loss: 276953.2366; train_cond_contrastive_loss: 78993.1786; train_gene_expr_recon_loss: 96415.4665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458279.3080; train_optim_loss: 458279.3080; val_kl_reg_loss: 5915.6914; val_edge_recon_loss: 272321.7500; val_cond_contrastive_loss: 78375.9609; val_gene_expr_recon_loss: 94867.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451481.0000; val_optim_loss: 451481.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9110; val_auprc_score: 0.8915; val_best_acc_score: 0.8433; val_best_f1_score: 0.8577; train_kl_reg_loss: 5971.7145; train_edge_recon_loss: 274110.1429; train_cond_contrastive_loss: 78957.4386; train_gene_expr_recon_loss: 95957.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454997.0089; train_optim_loss: 454997.0089; val_kl_reg_loss: 5871.2900; val_edge_recon_loss: 272567.9375; val_cond_contrastive_loss: 78387.0234; val_gene_expr_recon_loss: 94353.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451179.8438; val_optim_loss: 451179.8438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9316; val_auprc_score: 0.9159; val_best_acc_score: 0.8621; val_best_f1_score: 0.8708; train_kl_reg_loss: 6002.7307; train_edge_recon_loss: 270231.7277; train_cond_contrastive_loss: 78818.9397; train_gene_expr_recon_loss: 95347.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450401.1295; train_optim_loss: 450401.1295; val_kl_reg_loss: 5914.4941; val_edge_recon_loss: 271937.8750; val_cond_contrastive_loss: 78394.7578; val_gene_expr_recon_loss: 93934.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450181.7500; val_optim_loss: 450181.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9451; val_auprc_score: 0.9349; val_best_acc_score: 0.8764; val_best_f1_score: 0.8841; train_kl_reg_loss: 6033.7636; train_edge_recon_loss: 269625.5446; train_cond_contrastive_loss: 78743.0525; train_gene_expr_recon_loss: 94807.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449210.1161; train_optim_loss: 449210.1161; val_kl_reg_loss: 5988.4551; val_edge_recon_loss: 267625.4062; val_cond_contrastive_loss: 78395.1953; val_gene_expr_recon_loss: 93564.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445573.4375; val_optim_loss: 445573.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9553; val_auprc_score: 0.9468; val_best_acc_score: 0.8921; val_best_f1_score: 0.8980; train_kl_reg_loss: 6220.5293; train_edge_recon_loss: 268805.0134; train_cond_contrastive_loss: 78691.3795; train_gene_expr_recon_loss: 94514.9643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448231.8795; train_optim_loss: 448231.8795; val_kl_reg_loss: 6184.3916; val_edge_recon_loss: 264367.6250; val_cond_contrastive_loss: 78392.6875; val_gene_expr_recon_loss: 93239.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442184.0625; val_optim_loss: 442184.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9595; val_auprc_score: 0.9492; val_best_acc_score: 0.9031; val_best_f1_score: 0.9067; train_kl_reg_loss: 6224.3440; train_edge_recon_loss: 266815.0804; train_cond_contrastive_loss: 78704.3315; train_gene_expr_recon_loss: 94226.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445970.0357; train_optim_loss: 445970.0357; val_kl_reg_loss: 6062.6274; val_edge_recon_loss: 268454.6875; val_cond_contrastive_loss: 78390.3594; val_gene_expr_recon_loss: 92951.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445859.0000; val_optim_loss: 445859.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9635; val_auprc_score: 0.9548; val_best_acc_score: 0.9098; val_best_f1_score: 0.9132; train_kl_reg_loss: 6091.0662; train_edge_recon_loss: 265996.7098; train_cond_contrastive_loss: 78746.8538; train_gene_expr_recon_loss: 93498.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444332.6429; train_optim_loss: 444332.6429; val_kl_reg_loss: 5935.9805; val_edge_recon_loss: 265723.5938; val_cond_contrastive_loss: 78391.0781; val_gene_expr_recon_loss: 92665.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442716.3750; val_optim_loss: 442716.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9707; val_auprc_score: 0.9642; val_best_acc_score: 0.9178; val_best_f1_score: 0.9203; train_kl_reg_loss: 5996.6646; train_edge_recon_loss: 264805.4241; train_cond_contrastive_loss: 78771.3917; train_gene_expr_recon_loss: 93361.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442935.1964; train_optim_loss: 442935.1964; val_kl_reg_loss: 5845.7363; val_edge_recon_loss: 266566.2812; val_cond_contrastive_loss: 78393.3984; val_gene_expr_recon_loss: 92374.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443179.5312; val_optim_loss: 443179.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9728; val_auprc_score: 0.9680; val_best_acc_score: 0.9210; val_best_f1_score: 0.9225; train_kl_reg_loss: 5924.1000; train_edge_recon_loss: 264275.4911; train_cond_contrastive_loss: 78790.7522; train_gene_expr_recon_loss: 93268.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442259.3259; train_optim_loss: 442259.3259; val_kl_reg_loss: 5835.3105; val_edge_recon_loss: 266010.9375; val_cond_contrastive_loss: 78393.9688; val_gene_expr_recon_loss: 92335.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442576.1250; val_optim_loss: 442576.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9706; val_auprc_score: 0.9644; val_best_acc_score: 0.9192; val_best_f1_score: 0.9224; train_kl_reg_loss: 5925.6842; train_edge_recon_loss: 265403.7143; train_cond_contrastive_loss: 78785.7812; train_gene_expr_recon_loss: 93289.7623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443404.9464; train_optim_loss: 443404.9464; val_kl_reg_loss: 5839.9258; val_edge_recon_loss: 263954.6875; val_cond_contrastive_loss: 78394.3828; val_gene_expr_recon_loss: 92300.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440489.0625; val_optim_loss: 440489.0625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9728; val_auprc_score: 0.9674; val_best_acc_score: 0.9227; val_best_f1_score: 0.9255; train_kl_reg_loss: 5918.6110; train_edge_recon_loss: 264197.8661; train_cond_contrastive_loss: 78783.3158; train_gene_expr_recon_loss: 93444.8795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442344.6741; train_optim_loss: 442344.6741; val_kl_reg_loss: 5819.4365; val_edge_recon_loss: 263572.6250; val_cond_contrastive_loss: 78394.5312; val_gene_expr_recon_loss: 92274.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440061.5938; val_optim_loss: 440061.5938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9741; val_auprc_score: 0.9692; val_best_acc_score: 0.9237; val_best_f1_score: 0.9264; train_kl_reg_loss: 5900.4240; train_edge_recon_loss: 264191.2701; train_cond_contrastive_loss: 78788.5636; train_gene_expr_recon_loss: 93108.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441989.2188; train_optim_loss: 441989.2188; val_kl_reg_loss: 5807.3013; val_edge_recon_loss: 263263.9062; val_cond_contrastive_loss: 78394.0547; val_gene_expr_recon_loss: 92246.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439711.3438; val_optim_loss: 439711.3438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9746; val_auprc_score: 0.9703; val_best_acc_score: 0.9257; val_best_f1_score: 0.9274; train_kl_reg_loss: 5898.9166; train_edge_recon_loss: 264692.3326; train_cond_contrastive_loss: 78783.4196; train_gene_expr_recon_loss: 93337.1864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442711.8482; train_optim_loss: 442711.8482; val_kl_reg_loss: 5820.2739; val_edge_recon_loss: 262931.1250; val_cond_contrastive_loss: 78394.7188; val_gene_expr_recon_loss: 92217.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439363.7188; val_optim_loss: 439363.7188
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9722; val_auprc_score: 0.9657; val_best_acc_score: 0.9193; val_best_f1_score: 0.9222; train_kl_reg_loss: 5898.6299; train_edge_recon_loss: 264578.5089; train_cond_contrastive_loss: 78777.9051; train_gene_expr_recon_loss: 93211.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442466.6473; train_optim_loss: 442466.6473; val_kl_reg_loss: 5803.9219; val_edge_recon_loss: 265016.0312; val_cond_contrastive_loss: 78394.5781; val_gene_expr_recon_loss: 92190.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441404.6875; val_optim_loss: 441404.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9762; val_auprc_score: 0.9711; val_best_acc_score: 0.9293; val_best_f1_score: 0.9318; train_kl_reg_loss: 5886.8597; train_edge_recon_loss: 264403.7366; train_cond_contrastive_loss: 78778.1362; train_gene_expr_recon_loss: 93195.3371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442264.0804; train_optim_loss: 442264.0804; val_kl_reg_loss: 5800.0234; val_edge_recon_loss: 261475.4062; val_cond_contrastive_loss: 78394.5859; val_gene_expr_recon_loss: 92161.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437831.0938; val_optim_loss: 437831.0938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9764; val_auprc_score: 0.9718; val_best_acc_score: 0.9284; val_best_f1_score: 0.9307; train_kl_reg_loss: 5879.0753; train_edge_recon_loss: 264707.1161; train_cond_contrastive_loss: 78776.2600; train_gene_expr_recon_loss: 92989.4888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442351.9464; train_optim_loss: 442351.9464; val_kl_reg_loss: 5785.3535; val_edge_recon_loss: 262745.8750; val_cond_contrastive_loss: 78394.9531; val_gene_expr_recon_loss: 92132.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439059.0938; val_optim_loss: 439059.0938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9757; val_auprc_score: 0.9699; val_best_acc_score: 0.9273; val_best_f1_score: 0.9294; train_kl_reg_loss: 5868.5972; train_edge_recon_loss: 264148.3906; train_cond_contrastive_loss: 78775.2422; train_gene_expr_recon_loss: 93152.6473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441944.8795; train_optim_loss: 441944.8795; val_kl_reg_loss: 5786.6797; val_edge_recon_loss: 264512.7500; val_cond_contrastive_loss: 78394.7656; val_gene_expr_recon_loss: 92102.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440796.3750; val_optim_loss: 440796.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9755; val_auprc_score: 0.9688; val_best_acc_score: 0.9276; val_best_f1_score: 0.9299; train_kl_reg_loss: 5879.5803; train_edge_recon_loss: 263750.2009; train_cond_contrastive_loss: 78766.8281; train_gene_expr_recon_loss: 93084.9632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441481.5804; train_optim_loss: 441481.5804; val_kl_reg_loss: 5783.6230; val_edge_recon_loss: 265226.5625; val_cond_contrastive_loss: 78394.5156; val_gene_expr_recon_loss: 92073.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441477.8125; val_optim_loss: 441477.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9755; val_auprc_score: 0.9702; val_best_acc_score: 0.9273; val_best_f1_score: 0.9295; train_kl_reg_loss: 5867.7073; train_edge_recon_loss: 263803.1384; train_cond_contrastive_loss: 78767.5759; train_gene_expr_recon_loss: 93001.9420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441440.3705; train_optim_loss: 441440.3705; val_kl_reg_loss: 5760.6528; val_edge_recon_loss: 264796.2188; val_cond_contrastive_loss: 78394.6875; val_gene_expr_recon_loss: 92070.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441022.0312; val_optim_loss: 441022.0312
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9743; val_auprc_score: 0.9680; val_best_acc_score: 0.9270; val_best_f1_score: 0.9297; train_kl_reg_loss: 5869.8086; train_edge_recon_loss: 263527.4955; train_cond_contrastive_loss: 78768.6161; train_gene_expr_recon_loss: 92921.9587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441087.8750; train_optim_loss: 441087.8750; val_kl_reg_loss: 5760.5430; val_edge_recon_loss: 263792.6562; val_cond_contrastive_loss: 78394.9844; val_gene_expr_recon_loss: 92067.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440015.4688; val_optim_loss: 440015.4688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9775; val_auprc_score: 0.9741; val_best_acc_score: 0.9278; val_best_f1_score: 0.9302; train_kl_reg_loss: 5871.3703; train_edge_recon_loss: 263181.5112; train_cond_contrastive_loss: 78768.9353; train_gene_expr_recon_loss: 93036.6429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440858.4688; train_optim_loss: 440858.4688; val_kl_reg_loss: 5755.4922; val_edge_recon_loss: 262510.0625; val_cond_contrastive_loss: 78395.0234; val_gene_expr_recon_loss: 92064.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438724.8125; val_optim_loss: 438724.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 51 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9753
Val AUPRC score: 0.9685
Val best accuracy score: 0.9260
Val best F1 score: 0.9279
Val gene expr MSE score: 1.4765
Duration of model training in run 7: 0 hours, 1 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7769; val_auprc_score: 0.8099; val_best_acc_score: 0.6912; val_best_f1_score: 0.7167; train_kl_reg_loss: 5741.8249; train_edge_recon_loss: 353817.6250; train_cond_contrastive_loss: 108619.3292; train_gene_expr_recon_loss: 118937.6451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 587116.4375; train_optim_loss: 587116.4375; val_kl_reg_loss: 12664.8926; val_edge_recon_loss: 396108.4375; val_cond_contrastive_loss: 78332.8281; val_gene_expr_recon_loss: 102206.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 589312.6875; val_optim_loss: 589312.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7337; val_auprc_score: 0.7560; val_best_acc_score: 0.6524; val_best_f1_score: 0.7166; train_kl_reg_loss: 8100.6705; train_edge_recon_loss: 356996.8839; train_cond_contrastive_loss: 86415.6663; train_gene_expr_recon_loss: 100665.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 552178.5357; train_optim_loss: 552178.5357; val_kl_reg_loss: 6349.0464; val_edge_recon_loss: 377244.4688; val_cond_contrastive_loss: 78365.3594; val_gene_expr_recon_loss: 99891.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561850.8125; val_optim_loss: 561850.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7222; val_auprc_score: 0.7512; val_best_acc_score: 0.6432; val_best_f1_score: 0.7070; train_kl_reg_loss: 4762.6993; train_edge_recon_loss: 342419.7411; train_cond_contrastive_loss: 86931.5480; train_gene_expr_recon_loss: 98999.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533113.6875; train_optim_loss: 533113.6875; val_kl_reg_loss: 3476.0112; val_edge_recon_loss: 333888.9375; val_cond_contrastive_loss: 78371.0000; val_gene_expr_recon_loss: 99110.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 514846.4062; val_optim_loss: 514846.4062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7393; val_auprc_score: 0.7669; val_best_acc_score: 0.6661; val_best_f1_score: 0.7104; train_kl_reg_loss: 3973.4436; train_edge_recon_loss: 322780.2232; train_cond_contrastive_loss: 82721.7623; train_gene_expr_recon_loss: 98293.6060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507769.0357; train_optim_loss: 507769.0357; val_kl_reg_loss: 4720.0879; val_edge_recon_loss: 320825.0625; val_cond_contrastive_loss: 78345.8906; val_gene_expr_recon_loss: 98383.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502274.2188; val_optim_loss: 502274.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8015; val_auprc_score: 0.8085; val_best_acc_score: 0.7137; val_best_f1_score: 0.7511; train_kl_reg_loss: 5064.8474; train_edge_recon_loss: 310881.5268; train_cond_contrastive_loss: 79096.0759; train_gene_expr_recon_loss: 97522.9319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492565.3839; train_optim_loss: 492565.3839; val_kl_reg_loss: 5411.3594; val_edge_recon_loss: 296954.0000; val_cond_contrastive_loss: 78358.9062; val_gene_expr_recon_loss: 97725.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478449.3750; val_optim_loss: 478449.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8449; val_auprc_score: 0.8319; val_best_acc_score: 0.7653; val_best_f1_score: 0.7944; train_kl_reg_loss: 5766.2499; train_edge_recon_loss: 289978.5982; train_cond_contrastive_loss: 78828.7411; train_gene_expr_recon_loss: 96882.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471456.1339; train_optim_loss: 471456.1339; val_kl_reg_loss: 6155.8911; val_edge_recon_loss: 280467.1875; val_cond_contrastive_loss: 78370.6953; val_gene_expr_recon_loss: 96945.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461939.6875; val_optim_loss: 461939.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8565; val_auprc_score: 0.8377; val_best_acc_score: 0.7802; val_best_f1_score: 0.8044; train_kl_reg_loss: 6260.4996; train_edge_recon_loss: 283156.4866; train_cond_contrastive_loss: 78896.3237; train_gene_expr_recon_loss: 96100.2154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464413.5268; train_optim_loss: 464413.5268; val_kl_reg_loss: 6243.8921; val_edge_recon_loss: 277720.5938; val_cond_contrastive_loss: 78371.2969; val_gene_expr_recon_loss: 96328.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458664.2500; val_optim_loss: 458664.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8742; val_auprc_score: 0.8504; val_best_acc_score: 0.7987; val_best_f1_score: 0.8184; train_kl_reg_loss: 6409.1276; train_edge_recon_loss: 279170.5491; train_cond_contrastive_loss: 79010.5871; train_gene_expr_recon_loss: 95464.5670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460054.8259; train_optim_loss: 460054.8259; val_kl_reg_loss: 6478.0488; val_edge_recon_loss: 273781.3438; val_cond_contrastive_loss: 78374.1953; val_gene_expr_recon_loss: 95772.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454406.5625; val_optim_loss: 454406.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8831; val_auprc_score: 0.8577; val_best_acc_score: 0.8166; val_best_f1_score: 0.8378; train_kl_reg_loss: 6509.6902; train_edge_recon_loss: 276783.4554; train_cond_contrastive_loss: 78999.4520; train_gene_expr_recon_loss: 95022.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457315.3884; train_optim_loss: 457315.3884; val_kl_reg_loss: 6422.5088; val_edge_recon_loss: 273293.1875; val_cond_contrastive_loss: 78386.6172; val_gene_expr_recon_loss: 95374.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453476.4375; val_optim_loss: 453476.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9071; val_auprc_score: 0.8880; val_best_acc_score: 0.8362; val_best_f1_score: 0.8522; train_kl_reg_loss: 6490.0286; train_edge_recon_loss: 274843.2366; train_cond_contrastive_loss: 78975.2388; train_gene_expr_recon_loss: 94632.9576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454941.4688; train_optim_loss: 454941.4688; val_kl_reg_loss: 6309.5459; val_edge_recon_loss: 271867.4375; val_cond_contrastive_loss: 78402.7500; val_gene_expr_recon_loss: 94879.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451459.6875; val_optim_loss: 451459.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9308; val_auprc_score: 0.9183; val_best_acc_score: 0.8614; val_best_f1_score: 0.8722; train_kl_reg_loss: 6280.5021; train_edge_recon_loss: 270810.1562; train_cond_contrastive_loss: 79008.3605; train_gene_expr_recon_loss: 94071.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450170.4241; train_optim_loss: 450170.4241; val_kl_reg_loss: 6213.0771; val_edge_recon_loss: 266639.8438; val_cond_contrastive_loss: 78413.7188; val_gene_expr_recon_loss: 94487.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445754.5938; val_optim_loss: 445754.5938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9450; val_auprc_score: 0.9333; val_best_acc_score: 0.8790; val_best_f1_score: 0.8860; train_kl_reg_loss: 6205.4803; train_edge_recon_loss: 269315.3750; train_cond_contrastive_loss: 78917.9833; train_gene_expr_recon_loss: 94071.8717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448510.7054; train_optim_loss: 448510.7054; val_kl_reg_loss: 6230.3203; val_edge_recon_loss: 269046.4375; val_cond_contrastive_loss: 78409.1406; val_gene_expr_recon_loss: 94134.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447819.8750; val_optim_loss: 447819.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9561; val_auprc_score: 0.9472; val_best_acc_score: 0.8964; val_best_f1_score: 0.9034; train_kl_reg_loss: 6277.2927; train_edge_recon_loss: 267201.7366; train_cond_contrastive_loss: 78785.0792; train_gene_expr_recon_loss: 93422.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445686.3393; train_optim_loss: 445686.3393; val_kl_reg_loss: 6316.3457; val_edge_recon_loss: 261903.0156; val_cond_contrastive_loss: 78405.1406; val_gene_expr_recon_loss: 93809.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440433.6875; val_optim_loss: 440433.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9614; val_auprc_score: 0.9516; val_best_acc_score: 0.9054; val_best_f1_score: 0.9106; train_kl_reg_loss: 6289.0949; train_edge_recon_loss: 268195.4241; train_cond_contrastive_loss: 78730.4051; train_gene_expr_recon_loss: 93019.5011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446234.4330; train_optim_loss: 446234.4330; val_kl_reg_loss: 6197.3145; val_edge_recon_loss: 263440.5312; val_cond_contrastive_loss: 78403.7266; val_gene_expr_recon_loss: 93465.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441506.6875; val_optim_loss: 441506.6875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9676; val_auprc_score: 0.9597; val_best_acc_score: 0.9173; val_best_f1_score: 0.9207; train_kl_reg_loss: 6083.3474; train_edge_recon_loss: 265608.7522; train_cond_contrastive_loss: 78751.0424; train_gene_expr_recon_loss: 92894.8583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443338.0089; train_optim_loss: 443338.0089; val_kl_reg_loss: 5950.4829; val_edge_recon_loss: 264334.6562; val_cond_contrastive_loss: 78407.6953; val_gene_expr_recon_loss: 93125.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441818.2812; val_optim_loss: 441818.2812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9735; val_auprc_score: 0.9671; val_best_acc_score: 0.9266; val_best_f1_score: 0.9300; train_kl_reg_loss: 5928.4860; train_edge_recon_loss: 265716.6562; train_cond_contrastive_loss: 78739.7299; train_gene_expr_recon_loss: 92485.8170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442870.6920; train_optim_loss: 442870.6920; val_kl_reg_loss: 5856.2246; val_edge_recon_loss: 262918.0625; val_cond_contrastive_loss: 78412.1641; val_gene_expr_recon_loss: 92807.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439993.9062; val_optim_loss: 439993.9062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9798; val_auprc_score: 0.9760; val_best_acc_score: 0.9352; val_best_f1_score: 0.9376; train_kl_reg_loss: 5821.5188; train_edge_recon_loss: 263886.9933; train_cond_contrastive_loss: 78747.2723; train_gene_expr_recon_loss: 91969.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440424.8705; train_optim_loss: 440424.8705; val_kl_reg_loss: 5858.1748; val_edge_recon_loss: 260314.1094; val_cond_contrastive_loss: 78414.2344; val_gene_expr_recon_loss: 92538.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437124.7500; val_optim_loss: 437124.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9848; val_auprc_score: 0.9807; val_best_acc_score: 0.9420; val_best_f1_score: 0.9436; train_kl_reg_loss: 5865.7557; train_edge_recon_loss: 262872.6987; train_cond_contrastive_loss: 78729.8538; train_gene_expr_recon_loss: 91809.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439277.8750; train_optim_loss: 439277.8750; val_kl_reg_loss: 5778.6514; val_edge_recon_loss: 260008.0312; val_cond_contrastive_loss: 78410.6016; val_gene_expr_recon_loss: 92279.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436477.2500; val_optim_loss: 436477.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9848; val_auprc_score: 0.9799; val_best_acc_score: 0.9455; val_best_f1_score: 0.9470; train_kl_reg_loss: 5824.4130; train_edge_recon_loss: 261926.6406; train_cond_contrastive_loss: 78747.8025; train_gene_expr_recon_loss: 91513.5324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438012.3929; train_optim_loss: 438012.3929; val_kl_reg_loss: 5924.2373; val_edge_recon_loss: 260015.8125; val_cond_contrastive_loss: 78406.3125; val_gene_expr_recon_loss: 92055.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436401.8125; val_optim_loss: 436401.8125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9851; val_auprc_score: 0.9805; val_best_acc_score: 0.9461; val_best_f1_score: 0.9485; train_kl_reg_loss: 5896.1500; train_edge_recon_loss: 261013.6451; train_cond_contrastive_loss: 78737.5100; train_gene_expr_recon_loss: 91095.4442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436742.7455; train_optim_loss: 436742.7455; val_kl_reg_loss: 5814.7529; val_edge_recon_loss: 256668.8281; val_cond_contrastive_loss: 78401.5781; val_gene_expr_recon_loss: 91818.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432703.6250; val_optim_loss: 432703.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9852; val_auprc_score: 0.9814; val_best_acc_score: 0.9474; val_best_f1_score: 0.9490; train_kl_reg_loss: 5859.7263; train_edge_recon_loss: 260594.2723; train_cond_contrastive_loss: 78761.9174; train_gene_expr_recon_loss: 90985.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436200.9241; train_optim_loss: 436200.9241; val_kl_reg_loss: 5913.0840; val_edge_recon_loss: 259819.5938; val_cond_contrastive_loss: 78397.8828; val_gene_expr_recon_loss: 91531.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435661.9688; val_optim_loss: 435661.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9847; val_auprc_score: 0.9780; val_best_acc_score: 0.9452; val_best_f1_score: 0.9472; train_kl_reg_loss: 5915.9125; train_edge_recon_loss: 260358.4911; train_cond_contrastive_loss: 78749.0982; train_gene_expr_recon_loss: 90920.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435943.7188; train_optim_loss: 435943.7188; val_kl_reg_loss: 5850.7021; val_edge_recon_loss: 258363.5469; val_cond_contrastive_loss: 78395.9844; val_gene_expr_recon_loss: 91270.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433880.8125; val_optim_loss: 433880.8125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9868; val_auprc_score: 0.9834; val_best_acc_score: 0.9499; val_best_f1_score: 0.9515; train_kl_reg_loss: 5893.4506; train_edge_recon_loss: 259364.9353; train_cond_contrastive_loss: 78764.2087; train_gene_expr_recon_loss: 90544.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434567.2723; train_optim_loss: 434567.2723; val_kl_reg_loss: 5841.2529; val_edge_recon_loss: 258341.5781; val_cond_contrastive_loss: 78396.3359; val_gene_expr_recon_loss: 91033.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433612.8438; val_optim_loss: 433612.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9871; val_auprc_score: 0.9819; val_best_acc_score: 0.9510; val_best_f1_score: 0.9528; train_kl_reg_loss: 5889.6555; train_edge_recon_loss: 260200.5781; train_cond_contrastive_loss: 78770.5290; train_gene_expr_recon_loss: 90593.5871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435454.3438; train_optim_loss: 435454.3438; val_kl_reg_loss: 5889.9434; val_edge_recon_loss: 257819.9531; val_cond_contrastive_loss: 78396.7969; val_gene_expr_recon_loss: 90968.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433075.5000; val_optim_loss: 433075.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9876; val_auprc_score: 0.9850; val_best_acc_score: 0.9506; val_best_f1_score: 0.9521; train_kl_reg_loss: 5899.3802; train_edge_recon_loss: 260380.2701; train_cond_contrastive_loss: 78747.5993; train_gene_expr_recon_loss: 90002.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435029.8438; train_optim_loss: 435029.8438; val_kl_reg_loss: 5856.5879; val_edge_recon_loss: 258235.8125; val_cond_contrastive_loss: 78396.4922; val_gene_expr_recon_loss: 90941.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433430.4375; val_optim_loss: 433430.4375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9876; val_auprc_score: 0.9847; val_best_acc_score: 0.9518; val_best_f1_score: 0.9535; train_kl_reg_loss: 5871.3684; train_edge_recon_loss: 259654.9911; train_cond_contrastive_loss: 78766.5826; train_gene_expr_recon_loss: 90131.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434424.9062; train_optim_loss: 434424.9062; val_kl_reg_loss: 5840.9443; val_edge_recon_loss: 257148.8594; val_cond_contrastive_loss: 78397.1094; val_gene_expr_recon_loss: 90921.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432308.6250; val_optim_loss: 432308.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9873; val_auprc_score: 0.9840; val_best_acc_score: 0.9502; val_best_f1_score: 0.9522; train_kl_reg_loss: 5885.7080; train_edge_recon_loss: 258755.5714; train_cond_contrastive_loss: 78751.9877; train_gene_expr_recon_loss: 90074.0960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433467.3616; train_optim_loss: 433467.3616; val_kl_reg_loss: 5855.4004; val_edge_recon_loss: 256455.4531; val_cond_contrastive_loss: 78397.1094; val_gene_expr_recon_loss: 90890.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431598.0312; val_optim_loss: 431598.0312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9878; val_auprc_score: 0.9855; val_best_acc_score: 0.9507; val_best_f1_score: 0.9525; train_kl_reg_loss: 5883.5679; train_edge_recon_loss: 259015.9844; train_cond_contrastive_loss: 78750.8683; train_gene_expr_recon_loss: 90340.4308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433990.8438; train_optim_loss: 433990.8438; val_kl_reg_loss: 5833.8311; val_edge_recon_loss: 256300.3594; val_cond_contrastive_loss: 78397.0391; val_gene_expr_recon_loss: 90870.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431402.0625; val_optim_loss: 431402.0625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9872; val_auprc_score: 0.9825; val_best_acc_score: 0.9515; val_best_f1_score: 0.9531; train_kl_reg_loss: 5874.5312; train_edge_recon_loss: 258576.4085; train_cond_contrastive_loss: 78751.0279; train_gene_expr_recon_loss: 90271.9498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433473.9241; train_optim_loss: 433473.9241; val_kl_reg_loss: 5835.7803; val_edge_recon_loss: 256948.7969; val_cond_contrastive_loss: 78397.3750; val_gene_expr_recon_loss: 90841.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432023.8750; val_optim_loss: 432023.8750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9878; val_auprc_score: 0.9836; val_best_acc_score: 0.9536; val_best_f1_score: 0.9552; train_kl_reg_loss: 5863.9198; train_edge_recon_loss: 259316.1942; train_cond_contrastive_loss: 78749.6417; train_gene_expr_recon_loss: 89956.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433886.4866; train_optim_loss: 433886.4866; val_kl_reg_loss: 5820.4180; val_edge_recon_loss: 256584.9062; val_cond_contrastive_loss: 78398.1797; val_gene_expr_recon_loss: 90819.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431623.2500; val_optim_loss: 431623.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9884; val_auprc_score: 0.9850; val_best_acc_score: 0.9524; val_best_f1_score: 0.9539; train_kl_reg_loss: 5858.5584; train_edge_recon_loss: 260638.0625; train_cond_contrastive_loss: 78747.6406; train_gene_expr_recon_loss: 90230.6362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435474.9062; train_optim_loss: 435474.9062; val_kl_reg_loss: 5818.4849; val_edge_recon_loss: 256788.4375; val_cond_contrastive_loss: 78398.0938; val_gene_expr_recon_loss: 90793.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431798.5625; val_optim_loss: 431798.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9872; val_auprc_score: 0.9844; val_best_acc_score: 0.9502; val_best_f1_score: 0.9518; train_kl_reg_loss: 5857.8518; train_edge_recon_loss: 259337.3683; train_cond_contrastive_loss: 78742.9855; train_gene_expr_recon_loss: 89903.3862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433841.5848; train_optim_loss: 433841.5848; val_kl_reg_loss: 5819.0410; val_edge_recon_loss: 259063.8438; val_cond_contrastive_loss: 78398.1328; val_gene_expr_recon_loss: 90790.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434071.6562; val_optim_loss: 434071.6562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9884; val_auprc_score: 0.9848; val_best_acc_score: 0.9541; val_best_f1_score: 0.9554; train_kl_reg_loss: 5856.1522; train_edge_recon_loss: 260002.3237; train_cond_contrastive_loss: 78744.1730; train_gene_expr_recon_loss: 90155.9900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434758.6473; train_optim_loss: 434758.6473; val_kl_reg_loss: 5815.5879; val_edge_recon_loss: 257920.1719; val_cond_contrastive_loss: 78398.2578; val_gene_expr_recon_loss: 90788.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432922.2500; val_optim_loss: 432922.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9886; val_auprc_score: 0.9859; val_best_acc_score: 0.9548; val_best_f1_score: 0.9563; train_kl_reg_loss: 5848.1966; train_edge_recon_loss: 259626.3594; train_cond_contrastive_loss: 78746.3114; train_gene_expr_recon_loss: 90224.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434445.1161; train_optim_loss: 434445.1161; val_kl_reg_loss: 5815.4751; val_edge_recon_loss: 256239.0312; val_cond_contrastive_loss: 78398.3984; val_gene_expr_recon_loss: 90786.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431239.2500; val_optim_loss: 431239.2500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9879; val_auprc_score: 0.9839; val_best_acc_score: 0.9540; val_best_f1_score: 0.9557; train_kl_reg_loss: 5852.3756; train_edge_recon_loss: 259782.1897; train_cond_contrastive_loss: 78747.9163; train_gene_expr_recon_loss: 90076.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434458.9375; train_optim_loss: 434458.9375; val_kl_reg_loss: 5809.9795; val_edge_recon_loss: 255548.4531; val_cond_contrastive_loss: 78398.9141; val_gene_expr_recon_loss: 90784.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430542.0312; val_optim_loss: 430542.0312
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9877; val_auprc_score: 0.9845; val_best_acc_score: 0.9522; val_best_f1_score: 0.9539; train_kl_reg_loss: 5846.3118; train_edge_recon_loss: 259811.8170; train_cond_contrastive_loss: 78748.4866; train_gene_expr_recon_loss: 90159.8426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434566.4598; train_optim_loss: 434566.4598; val_kl_reg_loss: 5806.7949; val_edge_recon_loss: 256196.9688; val_cond_contrastive_loss: 78398.6641; val_gene_expr_recon_loss: 90782.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431185.1875; val_optim_loss: 431185.1875
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9884; val_auprc_score: 0.9864; val_best_acc_score: 0.9531; val_best_f1_score: 0.9546; train_kl_reg_loss: 5845.1036; train_edge_recon_loss: 259409.2121; train_cond_contrastive_loss: 78748.4643; train_gene_expr_recon_loss: 89936.9208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433939.7009; train_optim_loss: 433939.7009; val_kl_reg_loss: 5807.9448; val_edge_recon_loss: 257714.3281; val_cond_contrastive_loss: 78398.5469; val_gene_expr_recon_loss: 90780.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432701.3125; val_optim_loss: 432701.3125
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9872; val_auprc_score: 0.9813; val_best_acc_score: 0.9522; val_best_f1_score: 0.9538; train_kl_reg_loss: 5848.9470; train_edge_recon_loss: 259902.6786; train_cond_contrastive_loss: 78748.6875; train_gene_expr_recon_loss: 89954.9007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434455.2098; train_optim_loss: 434455.2098; val_kl_reg_loss: 5807.9424; val_edge_recon_loss: 257293.6094; val_cond_contrastive_loss: 78398.1094; val_gene_expr_recon_loss: 90777.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432277.5625; val_optim_loss: 432277.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9877; val_auprc_score: 0.9854; val_best_acc_score: 0.9508; val_best_f1_score: 0.9526; train_kl_reg_loss: 5847.8825; train_edge_recon_loss: 259077.7411; train_cond_contrastive_loss: 78748.2221; train_gene_expr_recon_loss: 89887.9632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433561.8080; train_optim_loss: 433561.8080; val_kl_reg_loss: 5809.4604; val_edge_recon_loss: 256416.0000; val_cond_contrastive_loss: 78398.3125; val_gene_expr_recon_loss: 90777.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431401.4062; val_optim_loss: 431401.4062
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9881; val_auprc_score: 0.9841; val_best_acc_score: 0.9526; val_best_f1_score: 0.9542; train_kl_reg_loss: 5847.0555; train_edge_recon_loss: 259772.0446; train_cond_contrastive_loss: 78748.1116; train_gene_expr_recon_loss: 89810.8080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434178.0179; train_optim_loss: 434178.0179; val_kl_reg_loss: 5807.8354; val_edge_recon_loss: 257970.7500; val_cond_contrastive_loss: 78398.1250; val_gene_expr_recon_loss: 90777.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432954.0625; val_optim_loss: 432954.0625
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9876; val_auprc_score: 0.9831; val_best_acc_score: 0.9526; val_best_f1_score: 0.9541; train_kl_reg_loss: 5850.1718; train_edge_recon_loss: 260319.0692; train_cond_contrastive_loss: 78747.9029; train_gene_expr_recon_loss: 90054.8973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434972.0446; train_optim_loss: 434972.0446; val_kl_reg_loss: 5809.1904; val_edge_recon_loss: 256041.3750; val_cond_contrastive_loss: 78398.7344; val_gene_expr_recon_loss: 90777.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431026.3438; val_optim_loss: 431026.3438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 52 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9884
Val AUPRC score: 0.9857
Val best accuracy score: 0.9525
Val best F1 score: 0.9542
Val gene expr MSE score: 1.4742
Duration of model training in run 8: 0 hours, 2 minutes and 55 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7552; val_auprc_score: 0.7854; val_best_acc_score: 0.6619; val_best_f1_score: 0.7125; train_kl_reg_loss: 5544.1105; train_edge_recon_loss: 357152.4028; train_cond_contrastive_loss: 99852.3464; train_gene_expr_recon_loss: 117035.6476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 579584.5069; train_optim_loss: 579584.5069; val_kl_reg_loss: 6464.1279; val_edge_recon_loss: 395104.9062; val_cond_contrastive_loss: 78334.9297; val_gene_expr_recon_loss: 99666.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 579570.8750; val_optim_loss: 579570.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7296; val_auprc_score: 0.7480; val_best_acc_score: 0.6528; val_best_f1_score: 0.7095; train_kl_reg_loss: 4606.7944; train_edge_recon_loss: 349480.6007; train_cond_contrastive_loss: 87725.8542; train_gene_expr_recon_loss: 99236.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 541049.6736; train_optim_loss: 541049.6736; val_kl_reg_loss: 2938.4639; val_edge_recon_loss: 345539.4688; val_cond_contrastive_loss: 78380.1094; val_gene_expr_recon_loss: 98194.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 525052.6250; val_optim_loss: 525052.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7505; val_auprc_score: 0.7699; val_best_acc_score: 0.6752; val_best_f1_score: 0.7142; train_kl_reg_loss: 3303.0394; train_edge_recon_loss: 323415.1285; train_cond_contrastive_loss: 83233.9071; train_gene_expr_recon_loss: 98060.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 508012.7500; train_optim_loss: 508012.7500; val_kl_reg_loss: 4193.8711; val_edge_recon_loss: 319965.6875; val_cond_contrastive_loss: 78339.8594; val_gene_expr_recon_loss: 97172.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 499671.7500; val_optim_loss: 499671.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8296; val_auprc_score: 0.8215; val_best_acc_score: 0.7427; val_best_f1_score: 0.7788; train_kl_reg_loss: 4849.1641; train_edge_recon_loss: 303856.9861; train_cond_contrastive_loss: 78749.2031; train_gene_expr_recon_loss: 96904.5252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484359.8715; train_optim_loss: 484359.8715; val_kl_reg_loss: 5637.0762; val_edge_recon_loss: 286098.4062; val_cond_contrastive_loss: 78354.5234; val_gene_expr_recon_loss: 96095.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466185.0938; val_optim_loss: 466185.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8492; val_auprc_score: 0.8247; val_best_acc_score: 0.7710; val_best_f1_score: 0.7978; train_kl_reg_loss: 6254.2432; train_edge_recon_loss: 283538.2500; train_cond_contrastive_loss: 78622.6597; train_gene_expr_recon_loss: 95898.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464313.3090; train_optim_loss: 464313.3090; val_kl_reg_loss: 6450.2588; val_edge_recon_loss: 283657.0625; val_cond_contrastive_loss: 78354.6016; val_gene_expr_recon_loss: 95032.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463494.0625; val_optim_loss: 463494.0625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8716; val_auprc_score: 0.8439; val_best_acc_score: 0.7994; val_best_f1_score: 0.8202; train_kl_reg_loss: 6346.1782; train_edge_recon_loss: 278752.9167; train_cond_contrastive_loss: 78862.0451; train_gene_expr_recon_loss: 94924.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458885.8229; train_optim_loss: 458885.8229; val_kl_reg_loss: 6180.6235; val_edge_recon_loss: 277104.2812; val_cond_contrastive_loss: 78358.0078; val_gene_expr_recon_loss: 94240.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455883.7188; val_optim_loss: 455883.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8933; val_auprc_score: 0.8710; val_best_acc_score: 0.8227; val_best_f1_score: 0.8416; train_kl_reg_loss: 6404.1715; train_edge_recon_loss: 275339.4097; train_cond_contrastive_loss: 78975.0833; train_gene_expr_recon_loss: 94289.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455008.3993; train_optim_loss: 455008.3993; val_kl_reg_loss: 6514.6963; val_edge_recon_loss: 273768.0312; val_cond_contrastive_loss: 78370.9609; val_gene_expr_recon_loss: 93737.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452391.1875; val_optim_loss: 452391.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9237; val_auprc_score: 0.9088; val_best_acc_score: 0.8529; val_best_f1_score: 0.8648; train_kl_reg_loss: 6378.7317; train_edge_recon_loss: 271474.4514; train_cond_contrastive_loss: 78937.7431; train_gene_expr_recon_loss: 93721.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450512.3576; train_optim_loss: 450512.3576; val_kl_reg_loss: 6047.7700; val_edge_recon_loss: 269283.7188; val_cond_contrastive_loss: 78391.4141; val_gene_expr_recon_loss: 93164.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446887.8125; val_optim_loss: 446887.8125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9441; val_auprc_score: 0.9329; val_best_acc_score: 0.8795; val_best_f1_score: 0.8872; train_kl_reg_loss: 6118.5393; train_edge_recon_loss: 269388.7118; train_cond_contrastive_loss: 78885.8811; train_gene_expr_recon_loss: 93243.3802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447636.5069; train_optim_loss: 447636.5069; val_kl_reg_loss: 6175.5586; val_edge_recon_loss: 266811.5938; val_cond_contrastive_loss: 78401.5078; val_gene_expr_recon_loss: 92714.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444103.0312; val_optim_loss: 444103.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9545; val_auprc_score: 0.9435; val_best_acc_score: 0.8987; val_best_f1_score: 0.9037; train_kl_reg_loss: 6309.2726; train_edge_recon_loss: 266680.8681; train_cond_contrastive_loss: 78746.2917; train_gene_expr_recon_loss: 92753.0043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444489.4340; train_optim_loss: 444489.4340; val_kl_reg_loss: 6407.9150; val_edge_recon_loss: 262924.0312; val_cond_contrastive_loss: 78396.2578; val_gene_expr_recon_loss: 92306.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440035.0625; val_optim_loss: 440035.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9612; val_auprc_score: 0.9479; val_best_acc_score: 0.9073; val_best_f1_score: 0.9114; train_kl_reg_loss: 6287.2950; train_edge_recon_loss: 266171.9896; train_cond_contrastive_loss: 78752.2231; train_gene_expr_recon_loss: 92313.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443524.5590; train_optim_loss: 443524.5590; val_kl_reg_loss: 6089.9219; val_edge_recon_loss: 265581.0625; val_cond_contrastive_loss: 78393.4609; val_gene_expr_recon_loss: 91832.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441897.3125; val_optim_loss: 441897.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9688; val_auprc_score: 0.9627; val_best_acc_score: 0.9161; val_best_f1_score: 0.9190; train_kl_reg_loss: 6067.5279; train_edge_recon_loss: 266450.4062; train_cond_contrastive_loss: 78813.1536; train_gene_expr_recon_loss: 91810.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443141.6111; train_optim_loss: 443141.6111; val_kl_reg_loss: 5965.3999; val_edge_recon_loss: 265397.5938; val_cond_contrastive_loss: 78394.0703; val_gene_expr_recon_loss: 91419.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441176.7500; val_optim_loss: 441176.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9753; val_auprc_score: 0.9704; val_best_acc_score: 0.9271; val_best_f1_score: 0.9287; train_kl_reg_loss: 5929.1787; train_edge_recon_loss: 263560.4705; train_cond_contrastive_loss: 78826.3385; train_gene_expr_recon_loss: 91463.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439779.1701; train_optim_loss: 439779.1701; val_kl_reg_loss: 5860.1445; val_edge_recon_loss: 264911.5000; val_cond_contrastive_loss: 78399.8125; val_gene_expr_recon_loss: 91051.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440223.2812; val_optim_loss: 440223.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9765; val_auprc_score: 0.9718; val_best_acc_score: 0.9281; val_best_f1_score: 0.9302; train_kl_reg_loss: 5889.8462; train_edge_recon_loss: 264563.7830; train_cond_contrastive_loss: 78813.9123; train_gene_expr_recon_loss: 91218.6102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440486.1562; train_optim_loss: 440486.1562; val_kl_reg_loss: 5846.7788; val_edge_recon_loss: 264593.4375; val_cond_contrastive_loss: 78400.0625; val_gene_expr_recon_loss: 90998.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439838.6250; val_optim_loss: 439838.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9775; val_auprc_score: 0.9733; val_best_acc_score: 0.9307; val_best_f1_score: 0.9328; train_kl_reg_loss: 5852.1697; train_edge_recon_loss: 263371.0035; train_cond_contrastive_loss: 78814.3872; train_gene_expr_recon_loss: 91100.3099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439137.8750; train_optim_loss: 439137.8750; val_kl_reg_loss: 5796.7842; val_edge_recon_loss: 264204.7188; val_cond_contrastive_loss: 78401.3438; val_gene_expr_recon_loss: 90950.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439353.5938; val_optim_loss: 439353.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9767; val_auprc_score: 0.9721; val_best_acc_score: 0.9298; val_best_f1_score: 0.9325; train_kl_reg_loss: 5828.4546; train_edge_recon_loss: 263189.1667; train_cond_contrastive_loss: 78813.9983; train_gene_expr_recon_loss: 91185.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439016.9583; train_optim_loss: 439016.9583; val_kl_reg_loss: 5803.9438; val_edge_recon_loss: 262549.4375; val_cond_contrastive_loss: 78401.8750; val_gene_expr_recon_loss: 90908.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437663.7188; val_optim_loss: 437663.7188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9764; val_auprc_score: 0.9711; val_best_acc_score: 0.9304; val_best_f1_score: 0.9330; train_kl_reg_loss: 5824.2913; train_edge_recon_loss: 263637.8160; train_cond_contrastive_loss: 78810.5460; train_gene_expr_recon_loss: 91045.6675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439318.3160; train_optim_loss: 439318.3160; val_kl_reg_loss: 5786.8271; val_edge_recon_loss: 263097.6562; val_cond_contrastive_loss: 78402.8672; val_gene_expr_recon_loss: 90871.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438158.5625; val_optim_loss: 438158.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9775; val_auprc_score: 0.9705; val_best_acc_score: 0.9328; val_best_f1_score: 0.9353; train_kl_reg_loss: 5810.4308; train_edge_recon_loss: 263605.5677; train_cond_contrastive_loss: 78805.1007; train_gene_expr_recon_loss: 90954.9601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439176.0625; train_optim_loss: 439176.0625; val_kl_reg_loss: 5773.2529; val_edge_recon_loss: 260362.9219; val_cond_contrastive_loss: 78403.2344; val_gene_expr_recon_loss: 90835.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435375.0625; val_optim_loss: 435375.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9798; val_auprc_score: 0.9735; val_best_acc_score: 0.9356; val_best_f1_score: 0.9374; train_kl_reg_loss: 5800.0319; train_edge_recon_loss: 262756.8490; train_cond_contrastive_loss: 78799.8160; train_gene_expr_recon_loss: 91028.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438384.9688; train_optim_loss: 438384.9688; val_kl_reg_loss: 5756.6729; val_edge_recon_loss: 261055.4688; val_cond_contrastive_loss: 78403.0547; val_gene_expr_recon_loss: 90796.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436012.0312; val_optim_loss: 436012.0312
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9786; val_auprc_score: 0.9741; val_best_acc_score: 0.9342; val_best_f1_score: 0.9365; train_kl_reg_loss: 5788.7618; train_edge_recon_loss: 263453.6753; train_cond_contrastive_loss: 78805.0035; train_gene_expr_recon_loss: 90986.4627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439033.8993; train_optim_loss: 439033.8993; val_kl_reg_loss: 5761.5889; val_edge_recon_loss: 261945.4844; val_cond_contrastive_loss: 78403.6953; val_gene_expr_recon_loss: 90758.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436868.7812; val_optim_loss: 436868.7812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9791; val_auprc_score: 0.9719; val_best_acc_score: 0.9338; val_best_f1_score: 0.9353; train_kl_reg_loss: 5788.8401; train_edge_recon_loss: 262454.5920; train_cond_contrastive_loss: 78793.4210; train_gene_expr_recon_loss: 90910.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437947.4792; train_optim_loss: 437947.4792; val_kl_reg_loss: 5756.9248; val_edge_recon_loss: 263194.6562; val_cond_contrastive_loss: 78403.2578; val_gene_expr_recon_loss: 90715.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438070.3438; val_optim_loss: 438070.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9813; val_auprc_score: 0.9781; val_best_acc_score: 0.9363; val_best_f1_score: 0.9382; train_kl_reg_loss: 5785.8053; train_edge_recon_loss: 262880.7760; train_cond_contrastive_loss: 78789.5955; train_gene_expr_recon_loss: 90954.2856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438410.4479; train_optim_loss: 438410.4479; val_kl_reg_loss: 5752.1602; val_edge_recon_loss: 260463.0938; val_cond_contrastive_loss: 78403.7031; val_gene_expr_recon_loss: 90711.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435330.4375; val_optim_loss: 435330.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9801; val_auprc_score: 0.9766; val_best_acc_score: 0.9345; val_best_f1_score: 0.9365; train_kl_reg_loss: 5782.2527; train_edge_recon_loss: 262291.4653; train_cond_contrastive_loss: 78792.6484; train_gene_expr_recon_loss: 90964.7370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437831.0972; train_optim_loss: 437831.0972; val_kl_reg_loss: 5750.6807; val_edge_recon_loss: 261707.0625; val_cond_contrastive_loss: 78403.7109; val_gene_expr_recon_loss: 90707.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436568.8750; val_optim_loss: 436568.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9808; val_auprc_score: 0.9775; val_best_acc_score: 0.9358; val_best_f1_score: 0.9372; train_kl_reg_loss: 5779.3104; train_edge_recon_loss: 262384.1979; train_cond_contrastive_loss: 78795.2127; train_gene_expr_recon_loss: 90987.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437946.1215; train_optim_loss: 437946.1215; val_kl_reg_loss: 5746.2666; val_edge_recon_loss: 262820.0938; val_cond_contrastive_loss: 78403.5469; val_gene_expr_recon_loss: 90703.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437673.5938; val_optim_loss: 437673.5938
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9798; val_auprc_score: 0.9744; val_best_acc_score: 0.9365; val_best_f1_score: 0.9389; train_kl_reg_loss: 5777.2514; train_edge_recon_loss: 262679.7830; train_cond_contrastive_loss: 78798.6085; train_gene_expr_recon_loss: 90888.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438143.7986; train_optim_loss: 438143.7986; val_kl_reg_loss: 5741.1387; val_edge_recon_loss: 259259.8750; val_cond_contrastive_loss: 78404.3438; val_gene_expr_recon_loss: 90700.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434105.4375; val_optim_loss: 434105.4375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9808; val_auprc_score: 0.9774; val_best_acc_score: 0.9366; val_best_f1_score: 0.9381; train_kl_reg_loss: 5773.1138; train_edge_recon_loss: 262848.9965; train_cond_contrastive_loss: 78800.9479; train_gene_expr_recon_loss: 90887.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438310.1910; train_optim_loss: 438310.1910; val_kl_reg_loss: 5730.3257; val_edge_recon_loss: 262011.7031; val_cond_contrastive_loss: 78403.4453; val_gene_expr_recon_loss: 90696.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436841.5625; val_optim_loss: 436841.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9796; val_auprc_score: 0.9726; val_best_acc_score: 0.9352; val_best_f1_score: 0.9374; train_kl_reg_loss: 5776.7236; train_edge_recon_loss: 261035.4514; train_cond_contrastive_loss: 78800.4340; train_gene_expr_recon_loss: 90909.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436521.6736; train_optim_loss: 436521.6736; val_kl_reg_loss: 5727.9902; val_edge_recon_loss: 261371.5781; val_cond_contrastive_loss: 78403.3047; val_gene_expr_recon_loss: 90692.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436195.3125; val_optim_loss: 436195.3125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9807; val_auprc_score: 0.9755; val_best_acc_score: 0.9371; val_best_f1_score: 0.9389; train_kl_reg_loss: 5778.5669; train_edge_recon_loss: 262496.1875; train_cond_contrastive_loss: 78796.1970; train_gene_expr_recon_loss: 90934.8464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438005.8021; train_optim_loss: 438005.8021; val_kl_reg_loss: 5737.0986; val_edge_recon_loss: 261911.0625; val_cond_contrastive_loss: 78403.1875; val_gene_expr_recon_loss: 90687.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436739.2188; val_optim_loss: 436739.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9796; val_auprc_score: 0.9745; val_best_acc_score: 0.9346; val_best_f1_score: 0.9364; train_kl_reg_loss: 5780.5152; train_edge_recon_loss: 262230.0503; train_cond_contrastive_loss: 78794.6684; train_gene_expr_recon_loss: 90865.6224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437670.8681; train_optim_loss: 437670.8681; val_kl_reg_loss: 5735.5972; val_edge_recon_loss: 262668.0938; val_cond_contrastive_loss: 78403.0625; val_gene_expr_recon_loss: 90687.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437494.2188; val_optim_loss: 437494.2188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9798; val_auprc_score: 0.9753; val_best_acc_score: 0.9349; val_best_f1_score: 0.9368; train_kl_reg_loss: 5778.6113; train_edge_recon_loss: 261845.8889; train_cond_contrastive_loss: 78795.1458; train_gene_expr_recon_loss: 90821.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437241.4931; train_optim_loss: 437241.4931; val_kl_reg_loss: 5733.9438; val_edge_recon_loss: 262171.4688; val_cond_contrastive_loss: 78403.1094; val_gene_expr_recon_loss: 90687.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436995.5000; val_optim_loss: 436995.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9823; val_auprc_score: 0.9780; val_best_acc_score: 0.9389; val_best_f1_score: 0.9406; train_kl_reg_loss: 5779.5202; train_edge_recon_loss: 262235.3941; train_cond_contrastive_loss: 78793.2630; train_gene_expr_recon_loss: 90893.1823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437701.3646; train_optim_loss: 437701.3646; val_kl_reg_loss: 5736.1543; val_edge_recon_loss: 260376.3594; val_cond_contrastive_loss: 78403.0469; val_gene_expr_recon_loss: 90686.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435202.1562; val_optim_loss: 435202.1562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 43 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9799
Val AUPRC score: 0.9763
Val best accuracy score: 0.9324
Val best F1 score: 0.9347
Val gene expr MSE score: 1.5257
Duration of model training in run 9: 0 hours, 2 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7994; val_auprc_score: 0.8283; val_best_acc_score: 0.7125; val_best_f1_score: 0.7260; train_kl_reg_loss: 6957.4704; train_edge_recon_loss: 355156.9861; train_cond_contrastive_loss: 103784.7422; train_gene_expr_recon_loss: 114841.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 580740.7569; train_optim_loss: 580740.7569; val_kl_reg_loss: 7580.5400; val_edge_recon_loss: 395565.0000; val_cond_contrastive_loss: 78332.4453; val_gene_expr_recon_loss: 101519.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 582997.2500; val_optim_loss: 582997.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7665; val_auprc_score: 0.7900; val_best_acc_score: 0.6762; val_best_f1_score: 0.7237; train_kl_reg_loss: 6081.2141; train_edge_recon_loss: 353344.9097; train_cond_contrastive_loss: 87973.3550; train_gene_expr_recon_loss: 98741.7274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546141.2083; train_optim_loss: 546141.2083; val_kl_reg_loss: 4231.1318; val_edge_recon_loss: 351685.5312; val_cond_contrastive_loss: 78406.2109; val_gene_expr_recon_loss: 99975.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534297.8750; val_optim_loss: 534297.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7739; val_auprc_score: 0.7925; val_best_acc_score: 0.6892; val_best_f1_score: 0.7272; train_kl_reg_loss: 3889.0910; train_edge_recon_loss: 326377.1840; train_cond_contrastive_loss: 86192.6007; train_gene_expr_recon_loss: 97456.8342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513915.7049; train_optim_loss: 513915.7049; val_kl_reg_loss: 4648.6050; val_edge_recon_loss: 309521.0312; val_cond_contrastive_loss: 78352.2734; val_gene_expr_recon_loss: 99081.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491603.8125; val_optim_loss: 491603.8125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8336; val_auprc_score: 0.8252; val_best_acc_score: 0.7513; val_best_f1_score: 0.7835; train_kl_reg_loss: 5754.5068; train_edge_recon_loss: 297790.3264; train_cond_contrastive_loss: 78888.2630; train_gene_expr_recon_loss: 96541.2161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478974.3090; train_optim_loss: 478974.3090; val_kl_reg_loss: 6689.7300; val_edge_recon_loss: 285759.5625; val_cond_contrastive_loss: 78360.8828; val_gene_expr_recon_loss: 98103.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468914.0312; val_optim_loss: 468914.0312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8595; val_auprc_score: 0.8434; val_best_acc_score: 0.7789; val_best_f1_score: 0.8035; train_kl_reg_loss: 6744.3118; train_edge_recon_loss: 282237.9097; train_cond_contrastive_loss: 78668.4913; train_gene_expr_recon_loss: 95750.8099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463401.5208; train_optim_loss: 463401.5208; val_kl_reg_loss: 6296.0342; val_edge_recon_loss: 281269.6562; val_cond_contrastive_loss: 78362.5391; val_gene_expr_recon_loss: 97175.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463103.3125; val_optim_loss: 463103.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8817; val_auprc_score: 0.8618; val_best_acc_score: 0.8077; val_best_f1_score: 0.8268; train_kl_reg_loss: 6037.2138; train_edge_recon_loss: 278620.9306; train_cond_contrastive_loss: 79028.1997; train_gene_expr_recon_loss: 94895.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458582.2847; train_optim_loss: 458582.2847; val_kl_reg_loss: 5917.3818; val_edge_recon_loss: 275639.1875; val_cond_contrastive_loss: 78368.2656; val_gene_expr_recon_loss: 96572.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456496.9688; val_optim_loss: 456496.9688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9051; val_auprc_score: 0.8839; val_best_acc_score: 0.8379; val_best_f1_score: 0.8524; train_kl_reg_loss: 6089.2242; train_edge_recon_loss: 274496.3819; train_cond_contrastive_loss: 79052.0113; train_gene_expr_recon_loss: 94235.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453872.6389; train_optim_loss: 453872.6389; val_kl_reg_loss: 6139.3315; val_edge_recon_loss: 273070.5625; val_cond_contrastive_loss: 78384.0703; val_gene_expr_recon_loss: 96019.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453613.7188; val_optim_loss: 453613.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9323; val_auprc_score: 0.9195; val_best_acc_score: 0.8617; val_best_f1_score: 0.8714; train_kl_reg_loss: 6063.9072; train_edge_recon_loss: 270597.7396; train_cond_contrastive_loss: 78968.0859; train_gene_expr_recon_loss: 93772.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449402.2535; train_optim_loss: 449402.2535; val_kl_reg_loss: 5918.2861; val_edge_recon_loss: 268746.6875; val_cond_contrastive_loss: 78397.0703; val_gene_expr_recon_loss: 95459.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448521.7500; val_optim_loss: 448521.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9508; val_auprc_score: 0.9415; val_best_acc_score: 0.8870; val_best_f1_score: 0.8934; train_kl_reg_loss: 6025.0938; train_edge_recon_loss: 268240.6181; train_cond_contrastive_loss: 78818.9991; train_gene_expr_recon_loss: 93355.4497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446440.1597; train_optim_loss: 446440.1597; val_kl_reg_loss: 6125.1289; val_edge_recon_loss: 265225.6562; val_cond_contrastive_loss: 78395.3594; val_gene_expr_recon_loss: 95024.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444770.4062; val_optim_loss: 444770.4062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9587; val_auprc_score: 0.9495; val_best_acc_score: 0.9009; val_best_f1_score: 0.9056; train_kl_reg_loss: 6263.6789; train_edge_recon_loss: 266190.8073; train_cond_contrastive_loss: 78711.6797; train_gene_expr_recon_loss: 92911.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444077.2708; train_optim_loss: 444077.2708; val_kl_reg_loss: 6220.1846; val_edge_recon_loss: 264240.4062; val_cond_contrastive_loss: 78390.7266; val_gene_expr_recon_loss: 94567.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443418.5625; val_optim_loss: 443418.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9645; val_auprc_score: 0.9562; val_best_acc_score: 0.9113; val_best_f1_score: 0.9160; train_kl_reg_loss: 6218.8352; train_edge_recon_loss: 266132.7917; train_cond_contrastive_loss: 78734.8273; train_gene_expr_recon_loss: 92460.5330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443546.9826; train_optim_loss: 443546.9826; val_kl_reg_loss: 6072.7812; val_edge_recon_loss: 264079.8438; val_cond_contrastive_loss: 78389.7891; val_gene_expr_recon_loss: 94143.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442685.5625; val_optim_loss: 442685.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9744; val_auprc_score: 0.9679; val_best_acc_score: 0.9258; val_best_f1_score: 0.9283; train_kl_reg_loss: 6060.0401; train_edge_recon_loss: 264499.2292; train_cond_contrastive_loss: 78771.8637; train_gene_expr_recon_loss: 92010.8924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441342.0278; train_optim_loss: 441342.0278; val_kl_reg_loss: 5895.0259; val_edge_recon_loss: 262780.8438; val_cond_contrastive_loss: 78390.8047; val_gene_expr_recon_loss: 93735.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440802.0312; val_optim_loss: 440802.0312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9769; val_auprc_score: 0.9705; val_best_acc_score: 0.9302; val_best_f1_score: 0.9331; train_kl_reg_loss: 5944.2574; train_edge_recon_loss: 263502.1424; train_cond_contrastive_loss: 78754.9427; train_gene_expr_recon_loss: 91775.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439977.2222; train_optim_loss: 439977.2222; val_kl_reg_loss: 5892.8936; val_edge_recon_loss: 259543.0625; val_cond_contrastive_loss: 78389.0547; val_gene_expr_recon_loss: 93414.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437239.7500; val_optim_loss: 437239.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9816; val_auprc_score: 0.9758; val_best_acc_score: 0.9377; val_best_f1_score: 0.9392; train_kl_reg_loss: 5859.0718; train_edge_recon_loss: 262321.0538; train_cond_contrastive_loss: 78710.5304; train_gene_expr_recon_loss: 91386.5286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438277.1840; train_optim_loss: 438277.1840; val_kl_reg_loss: 5776.0146; val_edge_recon_loss: 262797.8125; val_cond_contrastive_loss: 78386.8438; val_gene_expr_recon_loss: 93089.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440050.0938; val_optim_loss: 440050.0938
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9837; val_auprc_score: 0.9801; val_best_acc_score: 0.9417; val_best_f1_score: 0.9435; train_kl_reg_loss: 5801.4996; train_edge_recon_loss: 262303.7587; train_cond_contrastive_loss: 78682.6658; train_gene_expr_recon_loss: 91089.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437877.7257; train_optim_loss: 437877.7257; val_kl_reg_loss: 5687.8838; val_edge_recon_loss: 259071.0156; val_cond_contrastive_loss: 78385.6719; val_gene_expr_recon_loss: 92770.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435914.8125; val_optim_loss: 435914.8125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9852; val_auprc_score: 0.9821; val_best_acc_score: 0.9438; val_best_f1_score: 0.9457; train_kl_reg_loss: 5750.8362; train_edge_recon_loss: 260607.0642; train_cond_contrastive_loss: 78676.0868; train_gene_expr_recon_loss: 90809.6450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435843.6424; train_optim_loss: 435843.6424; val_kl_reg_loss: 5625.5996; val_edge_recon_loss: 258927.4062; val_cond_contrastive_loss: 78385.0391; val_gene_expr_recon_loss: 92445.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435383.8750; val_optim_loss: 435383.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9857; val_auprc_score: 0.9826; val_best_acc_score: 0.9457; val_best_f1_score: 0.9476; train_kl_reg_loss: 5690.2456; train_edge_recon_loss: 260921.9635; train_cond_contrastive_loss: 78687.5747; train_gene_expr_recon_loss: 90481.1502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435780.9306; train_optim_loss: 435780.9306; val_kl_reg_loss: 5656.7158; val_edge_recon_loss: 260257.3594; val_cond_contrastive_loss: 78383.2266; val_gene_expr_recon_loss: 92178.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436475.3125; val_optim_loss: 436475.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9871; val_auprc_score: 0.9829; val_best_acc_score: 0.9497; val_best_f1_score: 0.9512; train_kl_reg_loss: 5701.8792; train_edge_recon_loss: 259631.8351; train_cond_contrastive_loss: 78671.0477; train_gene_expr_recon_loss: 90221.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434226.1597; train_optim_loss: 434226.1597; val_kl_reg_loss: 5675.5840; val_edge_recon_loss: 257020.7188; val_cond_contrastive_loss: 78383.1875; val_gene_expr_recon_loss: 91916.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432995.6562; val_optim_loss: 432995.6562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9865; val_auprc_score: 0.9830; val_best_acc_score: 0.9500; val_best_f1_score: 0.9516; train_kl_reg_loss: 5707.6799; train_edge_recon_loss: 259661.6250; train_cond_contrastive_loss: 78678.3429; train_gene_expr_recon_loss: 89875.0113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433922.6597; train_optim_loss: 433922.6597; val_kl_reg_loss: 5667.0859; val_edge_recon_loss: 256251.9688; val_cond_contrastive_loss: 78382.9453; val_gene_expr_recon_loss: 91597.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431899.5625; val_optim_loss: 431899.5625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9880; val_auprc_score: 0.9839; val_best_acc_score: 0.9523; val_best_f1_score: 0.9537; train_kl_reg_loss: 5712.3792; train_edge_recon_loss: 260476.0451; train_cond_contrastive_loss: 78702.4349; train_gene_expr_recon_loss: 89743.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434634.6597; train_optim_loss: 434634.6597; val_kl_reg_loss: 5657.2178; val_edge_recon_loss: 256956.0938; val_cond_contrastive_loss: 78382.7891; val_gene_expr_recon_loss: 91305.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432301.9688; val_optim_loss: 432301.9688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9877; val_auprc_score: 0.9827; val_best_acc_score: 0.9538; val_best_f1_score: 0.9550; train_kl_reg_loss: 5705.2108; train_edge_recon_loss: 259192.3594; train_cond_contrastive_loss: 78708.0312; train_gene_expr_recon_loss: 89416.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433022.3576; train_optim_loss: 433022.3576; val_kl_reg_loss: 5641.6938; val_edge_recon_loss: 258652.4844; val_cond_contrastive_loss: 78384.8438; val_gene_expr_recon_loss: 91001.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433680.0938; val_optim_loss: 433680.0938
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9887; val_auprc_score: 0.9836; val_best_acc_score: 0.9568; val_best_f1_score: 0.9582; train_kl_reg_loss: 5700.2203; train_edge_recon_loss: 259228.2292; train_cond_contrastive_loss: 78688.7726; train_gene_expr_recon_loss: 89122.0616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432739.2847; train_optim_loss: 432739.2847; val_kl_reg_loss: 5603.2832; val_edge_recon_loss: 255550.2656; val_cond_contrastive_loss: 78387.1719; val_gene_expr_recon_loss: 90717.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430258.0625; val_optim_loss: 430258.0625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9907; val_auprc_score: 0.9880; val_best_acc_score: 0.9590; val_best_f1_score: 0.9599; train_kl_reg_loss: 5682.7603; train_edge_recon_loss: 258588.9757; train_cond_contrastive_loss: 78699.6241; train_gene_expr_recon_loss: 88901.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431873.3333; train_optim_loss: 431873.3333; val_kl_reg_loss: 5639.4746; val_edge_recon_loss: 256636.0000; val_cond_contrastive_loss: 78389.9297; val_gene_expr_recon_loss: 90452.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431117.5625; val_optim_loss: 431117.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9907; val_auprc_score: 0.9867; val_best_acc_score: 0.9622; val_best_f1_score: 0.9634; train_kl_reg_loss: 5702.4384; train_edge_recon_loss: 258767.0938; train_cond_contrastive_loss: 78711.3160; train_gene_expr_recon_loss: 88589.5530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431770.3993; train_optim_loss: 431770.3993; val_kl_reg_loss: 5672.8789; val_edge_recon_loss: 256748.7656; val_cond_contrastive_loss: 78393.1250; val_gene_expr_recon_loss: 90193.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431008.0312; val_optim_loss: 431008.0312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9900; val_auprc_score: 0.9851; val_best_acc_score: 0.9605; val_best_f1_score: 0.9617; train_kl_reg_loss: 5717.2217; train_edge_recon_loss: 258368.5938; train_cond_contrastive_loss: 78720.8707; train_gene_expr_recon_loss: 88304.3481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431111.0347; train_optim_loss: 431111.0347; val_kl_reg_loss: 5609.9746; val_edge_recon_loss: 257991.6719; val_cond_contrastive_loss: 78393.8438; val_gene_expr_recon_loss: 89946.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431942.2500; val_optim_loss: 431942.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9916; val_auprc_score: 0.9889; val_best_acc_score: 0.9632; val_best_f1_score: 0.9641; train_kl_reg_loss: 5681.4373; train_edge_recon_loss: 258068.4392; train_cond_contrastive_loss: 78729.7422; train_gene_expr_recon_loss: 88121.9253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430601.5556; train_optim_loss: 430601.5556; val_kl_reg_loss: 5632.5693; val_edge_recon_loss: 257869.0000; val_cond_contrastive_loss: 78393.8516; val_gene_expr_recon_loss: 89901.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431796.7500; val_optim_loss: 431796.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9909; val_auprc_score: 0.9873; val_best_acc_score: 0.9608; val_best_f1_score: 0.9623; train_kl_reg_loss: 5698.1514; train_edge_recon_loss: 258332.4045; train_cond_contrastive_loss: 78725.1684; train_gene_expr_recon_loss: 88101.7908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430857.5208; train_optim_loss: 430857.5208; val_kl_reg_loss: 5616.6113; val_edge_recon_loss: 256455.1875; val_cond_contrastive_loss: 78394.2812; val_gene_expr_recon_loss: 89864.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430330.9062; val_optim_loss: 430330.9062
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9917; val_auprc_score: 0.9901; val_best_acc_score: 0.9624; val_best_f1_score: 0.9632; train_kl_reg_loss: 5688.6405; train_edge_recon_loss: 257479.1840; train_cond_contrastive_loss: 78726.3368; train_gene_expr_recon_loss: 88138.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430032.6875; train_optim_loss: 430032.6875; val_kl_reg_loss: 5612.8423; val_edge_recon_loss: 257033.6094; val_cond_contrastive_loss: 78394.3750; val_gene_expr_recon_loss: 89841.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430881.8750; val_optim_loss: 430881.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 24 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9897
Val AUPRC score: 0.9874
Val best accuracy score: 0.9563
Val best F1 score: 0.9579
Val gene expr MSE score: 1.5051
Duration of model training in run 10: 0 hours, 2 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
