Run timestamp: 15062023_135543.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_25pct', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 21689
Number of validation edges: 2409
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8020; val_auprc_score: 0.7947; val_best_acc_score: 0.6760; val_best_f1_score: 0.7216; train_kl_reg_loss: 22.7145; train_edge_recon_loss: 346466.0417; train_gene_expr_recon_loss: 74214.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420703.2396; train_optim_loss: 420703.2396; val_kl_reg_loss: 104.8116; val_edge_recon_loss: 401704.9062; val_gene_expr_recon_loss: 67905.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469715.0625; val_optim_loss: 469715.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7345; val_auprc_score: 0.7330; val_best_acc_score: 0.6613; val_best_f1_score: 0.7152; train_kl_reg_loss: 231.7127; train_edge_recon_loss: 343770.9688; train_gene_expr_recon_loss: 67396.1901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411398.8750; train_optim_loss: 411398.8750; val_kl_reg_loss: 313.1431; val_edge_recon_loss: 362667.1562; val_gene_expr_recon_loss: 66550.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429530.8750; val_optim_loss: 429530.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8005; val_auprc_score: 0.7909; val_best_acc_score: 0.7080; val_best_f1_score: 0.7505; train_kl_reg_loss: 428.6229; train_edge_recon_loss: 334313.8073; train_gene_expr_recon_loss: 66175.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400918.3281; train_optim_loss: 400918.3281; val_kl_reg_loss: 802.6995; val_edge_recon_loss: 306456.3750; val_gene_expr_recon_loss: 66116.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373375.2812; val_optim_loss: 373375.2812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8085; val_auprc_score: 0.8033; val_best_acc_score: 0.7063; val_best_f1_score: 0.7566; train_kl_reg_loss: 1969.4715; train_edge_recon_loss: 309877.1042; train_gene_expr_recon_loss: 65523.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377370.0677; train_optim_loss: 377370.0677; val_kl_reg_loss: 4399.4995; val_edge_recon_loss: 302263.5938; val_gene_expr_recon_loss: 65334.6367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371997.7188; val_optim_loss: 371997.7188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8043; val_auprc_score: 0.7972; val_best_acc_score: 0.7044; val_best_f1_score: 0.7565; train_kl_reg_loss: 6990.4822; train_edge_recon_loss: 294370.3906; train_gene_expr_recon_loss: 64711.5775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366072.4531; train_optim_loss: 366072.4531; val_kl_reg_loss: 8991.3535; val_edge_recon_loss: 303117.7188; val_gene_expr_recon_loss: 64759.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376868.8750; val_optim_loss: 376868.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8167; val_auprc_score: 0.8105; val_best_acc_score: 0.7181; val_best_f1_score: 0.7656; train_kl_reg_loss: 9758.1092; train_edge_recon_loss: 292636.7396; train_gene_expr_recon_loss: 64448.2142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366843.0625; train_optim_loss: 366843.0625; val_kl_reg_loss: 9481.4258; val_edge_recon_loss: 296859.2500; val_gene_expr_recon_loss: 64411.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370752.4688; val_optim_loss: 370752.4688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8291; val_auprc_score: 0.8174; val_best_acc_score: 0.7341; val_best_f1_score: 0.7689; train_kl_reg_loss: 8221.7524; train_edge_recon_loss: 292200.1458; train_gene_expr_recon_loss: 63987.1673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364409.0729; train_optim_loss: 364409.0729; val_kl_reg_loss: 6246.8296; val_edge_recon_loss: 296161.0312; val_gene_expr_recon_loss: 64214.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366622.7500; val_optim_loss: 366622.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8349; val_auprc_score: 0.8216; val_best_acc_score: 0.7453; val_best_f1_score: 0.7744; train_kl_reg_loss: 5678.7712; train_edge_recon_loss: 289838.8177; train_gene_expr_recon_loss: 63816.0638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359333.6615; train_optim_loss: 359333.6615; val_kl_reg_loss: 4731.7363; val_edge_recon_loss: 289279.3125; val_gene_expr_recon_loss: 64102.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358114.0000; val_optim_loss: 358114.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8512; val_auprc_score: 0.8333; val_best_acc_score: 0.7713; val_best_f1_score: 0.7942; train_kl_reg_loss: 4560.5165; train_edge_recon_loss: 286279.0312; train_gene_expr_recon_loss: 63758.4668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354598.0156; train_optim_loss: 354598.0156; val_kl_reg_loss: 4395.9912; val_edge_recon_loss: 284909.0000; val_gene_expr_recon_loss: 64009.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353314.2500; val_optim_loss: 353314.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8733; val_auprc_score: 0.8507; val_best_acc_score: 0.7956; val_best_f1_score: 0.8133; train_kl_reg_loss: 4918.2047; train_edge_recon_loss: 278627.5156; train_gene_expr_recon_loss: 63665.1960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347210.9115; train_optim_loss: 347210.9115; val_kl_reg_loss: 5274.5356; val_edge_recon_loss: 281038.8750; val_gene_expr_recon_loss: 63964.2852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350277.6875; val_optim_loss: 350277.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8958; val_auprc_score: 0.8692; val_best_acc_score: 0.8315; val_best_f1_score: 0.8422; train_kl_reg_loss: 5734.1163; train_edge_recon_loss: 273118.4792; train_gene_expr_recon_loss: 63765.8014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342618.3906; train_optim_loss: 342618.3906; val_kl_reg_loss: 5795.2559; val_edge_recon_loss: 275473.5312; val_gene_expr_recon_loss: 63926.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345195.1875; val_optim_loss: 345195.1875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8998; val_auprc_score: 0.8798; val_best_acc_score: 0.8313; val_best_f1_score: 0.8419; train_kl_reg_loss: 5877.8058; train_edge_recon_loss: 270044.4583; train_gene_expr_recon_loss: 63526.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339448.3698; train_optim_loss: 339448.3698; val_kl_reg_loss: 5441.3457; val_edge_recon_loss: 275371.0938; val_gene_expr_recon_loss: 63817.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344630.1250; val_optim_loss: 344630.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9039; val_auprc_score: 0.8813; val_best_acc_score: 0.8323; val_best_f1_score: 0.8448; train_kl_reg_loss: 5195.2185; train_edge_recon_loss: 268163.8646; train_gene_expr_recon_loss: 63300.1322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336659.2135; train_optim_loss: 336659.2135; val_kl_reg_loss: 4597.4512; val_edge_recon_loss: 274129.5312; val_gene_expr_recon_loss: 63564.4258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342291.4062; val_optim_loss: 342291.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9059; val_auprc_score: 0.8764; val_best_acc_score: 0.8425; val_best_f1_score: 0.8517; train_kl_reg_loss: 4578.6049; train_edge_recon_loss: 270199.6927; train_gene_expr_recon_loss: 63213.8958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337992.1927; train_optim_loss: 337992.1927; val_kl_reg_loss: 4418.9082; val_edge_recon_loss: 274456.1250; val_gene_expr_recon_loss: 63382.8242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342257.8438; val_optim_loss: 342257.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9141; val_auprc_score: 0.8914; val_best_acc_score: 0.8437; val_best_f1_score: 0.8551; train_kl_reg_loss: 4582.1213; train_edge_recon_loss: 267791.6302; train_gene_expr_recon_loss: 62856.1185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335229.8698; train_optim_loss: 335229.8698; val_kl_reg_loss: 4563.4600; val_edge_recon_loss: 271257.2500; val_gene_expr_recon_loss: 63243.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339064.4688; val_optim_loss: 339064.4688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9150; val_auprc_score: 0.8968; val_best_acc_score: 0.8458; val_best_f1_score: 0.8564; train_kl_reg_loss: 4742.6801; train_edge_recon_loss: 267599.3542; train_gene_expr_recon_loss: 62951.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335293.9479; train_optim_loss: 335293.9479; val_kl_reg_loss: 4579.4844; val_edge_recon_loss: 273324.0312; val_gene_expr_recon_loss: 63113.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341016.5312; val_optim_loss: 341016.5312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9135; val_auprc_score: 0.8899; val_best_acc_score: 0.8456; val_best_f1_score: 0.8554; train_kl_reg_loss: 4642.6009; train_edge_recon_loss: 267067.8542; train_gene_expr_recon_loss: 62781.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334491.6979; train_optim_loss: 334491.6979; val_kl_reg_loss: 4401.0142; val_edge_recon_loss: 275591.8438; val_gene_expr_recon_loss: 63038.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343031.0938; val_optim_loss: 343031.0938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9278; val_auprc_score: 0.9070; val_best_acc_score: 0.8616; val_best_f1_score: 0.8688; train_kl_reg_loss: 4452.9952; train_edge_recon_loss: 267549.7865; train_gene_expr_recon_loss: 62455.7858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334458.5729; train_optim_loss: 334458.5729; val_kl_reg_loss: 4282.4863; val_edge_recon_loss: 266468.9062; val_gene_expr_recon_loss: 62961.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333713.1875; val_optim_loss: 333713.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9164; val_auprc_score: 0.8873; val_best_acc_score: 0.8568; val_best_f1_score: 0.8652; train_kl_reg_loss: 4406.2998; train_edge_recon_loss: 266721.8646; train_gene_expr_recon_loss: 62541.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333669.4896; train_optim_loss: 333669.4896; val_kl_reg_loss: 4328.8369; val_edge_recon_loss: 272156.2812; val_gene_expr_recon_loss: 62899.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339384.4375; val_optim_loss: 339384.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9269; val_auprc_score: 0.9033; val_best_acc_score: 0.8645; val_best_f1_score: 0.8696; train_kl_reg_loss: 4407.5035; train_edge_recon_loss: 266785.5469; train_gene_expr_recon_loss: 62603.0540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333796.1094; train_optim_loss: 333796.1094; val_kl_reg_loss: 4243.5244; val_edge_recon_loss: 271014.5000; val_gene_expr_recon_loss: 62859.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338117.6250; val_optim_loss: 338117.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9262; val_auprc_score: 0.9036; val_best_acc_score: 0.8672; val_best_f1_score: 0.8732; train_kl_reg_loss: 4339.8363; train_edge_recon_loss: 266233.6823; train_gene_expr_recon_loss: 62576.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333149.7188; train_optim_loss: 333149.7188; val_kl_reg_loss: 4176.6445; val_edge_recon_loss: 268422.5000; val_gene_expr_recon_loss: 62793.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335392.1875; val_optim_loss: 335392.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9238; val_auprc_score: 0.8906; val_best_acc_score: 0.8676; val_best_f1_score: 0.8732; train_kl_reg_loss: 4297.6988; train_edge_recon_loss: 266429.2396; train_gene_expr_recon_loss: 62323.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333050.6250; train_optim_loss: 333050.6250; val_kl_reg_loss: 4181.7944; val_edge_recon_loss: 267783.7812; val_gene_expr_recon_loss: 62741.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334706.8438; val_optim_loss: 334706.8438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9243; val_auprc_score: 0.8983; val_best_acc_score: 0.8601; val_best_f1_score: 0.8683; train_kl_reg_loss: 4308.5390; train_edge_recon_loss: 266435.1667; train_gene_expr_recon_loss: 62470.9186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333214.6250; train_optim_loss: 333214.6250; val_kl_reg_loss: 4188.4297; val_edge_recon_loss: 270347.7500; val_gene_expr_recon_loss: 62710.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337246.3750; val_optim_loss: 337246.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9237; val_auprc_score: 0.8926; val_best_acc_score: 0.8605; val_best_f1_score: 0.8700; train_kl_reg_loss: 4307.0546; train_edge_recon_loss: 266289.5000; train_gene_expr_recon_loss: 62257.9883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332854.5469; train_optim_loss: 332854.5469; val_kl_reg_loss: 4191.6543; val_edge_recon_loss: 270115.2500; val_gene_expr_recon_loss: 62706.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337013.8125; val_optim_loss: 337013.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 37 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9199
Val AUPRC score: 0.8967
Val best accuracy score: 0.8549
Val best F1 score: 0.8606
Val gene expr MSE score: 0.0100
Duration of model training in run 1: 0 hours, 0 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 21689
Number of validation edges: 2409
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8199; val_auprc_score: 0.8064; val_best_acc_score: 0.6912; val_best_f1_score: 0.7398; train_kl_reg_loss: 25.6496; train_edge_recon_loss: 346447.2865; train_gene_expr_recon_loss: 74625.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421098.8385; train_optim_loss: 421098.8385; val_kl_reg_loss: 113.9683; val_edge_recon_loss: 400285.8750; val_gene_expr_recon_loss: 65748.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466148.2500; val_optim_loss: 466148.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7616; val_auprc_score: 0.7535; val_best_acc_score: 0.6816; val_best_f1_score: 0.7298; train_kl_reg_loss: 236.5459; train_edge_recon_loss: 344076.7292; train_gene_expr_recon_loss: 67395.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411708.9375; train_optim_loss: 411708.9375; val_kl_reg_loss: 287.7171; val_edge_recon_loss: 357180.8438; val_gene_expr_recon_loss: 64767.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 422236.5000; val_optim_loss: 422236.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7997; val_auprc_score: 0.7903; val_best_acc_score: 0.7082; val_best_f1_score: 0.7510; train_kl_reg_loss: 454.1492; train_edge_recon_loss: 332229.6562; train_gene_expr_recon_loss: 66468.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399152.1042; train_optim_loss: 399152.1042; val_kl_reg_loss: 986.0094; val_edge_recon_loss: 306103.0625; val_gene_expr_recon_loss: 64108.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371197.1875; val_optim_loss: 371197.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7985; val_auprc_score: 0.7946; val_best_acc_score: 0.6984; val_best_f1_score: 0.7487; train_kl_reg_loss: 2365.5275; train_edge_recon_loss: 307486.9375; train_gene_expr_recon_loss: 65510.7546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375363.2083; train_optim_loss: 375363.2083; val_kl_reg_loss: 4821.7393; val_edge_recon_loss: 307249.6875; val_gene_expr_recon_loss: 63385.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375456.5312; val_optim_loss: 375456.5312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8096; val_auprc_score: 0.8059; val_best_acc_score: 0.7090; val_best_f1_score: 0.7584; train_kl_reg_loss: 7306.4430; train_edge_recon_loss: 294191.7240; train_gene_expr_recon_loss: 64887.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366385.9896; train_optim_loss: 366385.9896; val_kl_reg_loss: 8559.9463; val_edge_recon_loss: 302723.9375; val_gene_expr_recon_loss: 62903.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374187.3125; val_optim_loss: 374187.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8153; val_auprc_score: 0.8100; val_best_acc_score: 0.7219; val_best_f1_score: 0.7610; train_kl_reg_loss: 9150.0267; train_edge_recon_loss: 292472.3958; train_gene_expr_recon_loss: 64459.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366081.8906; train_optim_loss: 366081.8906; val_kl_reg_loss: 8686.9336; val_edge_recon_loss: 301886.1875; val_gene_expr_recon_loss: 62584.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373157.3125; val_optim_loss: 373157.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8178; val_auprc_score: 0.8044; val_best_acc_score: 0.7304; val_best_f1_score: 0.7637; train_kl_reg_loss: 9027.1925; train_edge_recon_loss: 289972.9323; train_gene_expr_recon_loss: 64170.6549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363170.7969; train_optim_loss: 363170.7969; val_kl_reg_loss: 8425.9297; val_edge_recon_loss: 300251.9375; val_gene_expr_recon_loss: 62498.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371176.1875; val_optim_loss: 371176.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8226; val_auprc_score: 0.8158; val_best_acc_score: 0.7262; val_best_f1_score: 0.7641; train_kl_reg_loss: 8574.2645; train_edge_recon_loss: 291651.3021; train_gene_expr_recon_loss: 64097.0632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364322.6198; train_optim_loss: 364322.6198; val_kl_reg_loss: 7870.0801; val_edge_recon_loss: 298598.2812; val_gene_expr_recon_loss: 62422.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368891.3438; val_optim_loss: 368891.3438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8246; val_auprc_score: 0.8147; val_best_acc_score: 0.7304; val_best_f1_score: 0.7692; train_kl_reg_loss: 8041.0306; train_edge_recon_loss: 291489.4010; train_gene_expr_recon_loss: 64150.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363681.2188; train_optim_loss: 363681.2188; val_kl_reg_loss: 7357.0088; val_edge_recon_loss: 296397.4375; val_gene_expr_recon_loss: 62407.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366161.4688; val_optim_loss: 366161.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8186; val_auprc_score: 0.8095; val_best_acc_score: 0.7271; val_best_f1_score: 0.7639; train_kl_reg_loss: 7505.6995; train_edge_recon_loss: 290341.3281; train_gene_expr_recon_loss: 64098.1126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361945.1406; train_optim_loss: 361945.1406; val_kl_reg_loss: 6912.0371; val_edge_recon_loss: 299439.0625; val_gene_expr_recon_loss: 62385.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368736.0938; val_optim_loss: 368736.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8270; val_auprc_score: 0.8206; val_best_acc_score: 0.7362; val_best_f1_score: 0.7626; train_kl_reg_loss: 7126.8394; train_edge_recon_loss: 291323.6927; train_gene_expr_recon_loss: 64012.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362462.9896; train_optim_loss: 362462.9896; val_kl_reg_loss: 6606.9336; val_edge_recon_loss: 301677.7188; val_gene_expr_recon_loss: 62361.9648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370646.6250; val_optim_loss: 370646.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8304; val_auprc_score: 0.8157; val_best_acc_score: 0.7383; val_best_f1_score: 0.7718; train_kl_reg_loss: 6811.1702; train_edge_recon_loss: 292933.1510; train_gene_expr_recon_loss: 63901.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363645.4427; train_optim_loss: 363645.4427; val_kl_reg_loss: 6362.1484; val_edge_recon_loss: 293213.5938; val_gene_expr_recon_loss: 62348.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361924.2500; val_optim_loss: 361924.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8287; val_auprc_score: 0.8198; val_best_acc_score: 0.7366; val_best_f1_score: 0.7637; train_kl_reg_loss: 6492.5005; train_edge_recon_loss: 292062.9792; train_gene_expr_recon_loss: 64036.9883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362592.4688; train_optim_loss: 362592.4688; val_kl_reg_loss: 5963.6846; val_edge_recon_loss: 298344.5938; val_gene_expr_recon_loss: 62340.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366648.5000; val_optim_loss: 366648.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8286; val_auprc_score: 0.8187; val_best_acc_score: 0.7416; val_best_f1_score: 0.7633; train_kl_reg_loss: 6132.5545; train_edge_recon_loss: 291021.5573; train_gene_expr_recon_loss: 63778.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360932.4479; train_optim_loss: 360932.4479; val_kl_reg_loss: 5721.2793; val_edge_recon_loss: 299805.5625; val_gene_expr_recon_loss: 62332.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367859.4375; val_optim_loss: 367859.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8268; val_auprc_score: 0.8174; val_best_acc_score: 0.7377; val_best_f1_score: 0.7598; train_kl_reg_loss: 5875.1040; train_edge_recon_loss: 289430.6354; train_gene_expr_recon_loss: 63893.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359199.5990; train_optim_loss: 359199.5990; val_kl_reg_loss: 5462.3027; val_edge_recon_loss: 302549.8438; val_gene_expr_recon_loss: 62326.0195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370338.1875; val_optim_loss: 370338.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8314; val_auprc_score: 0.8193; val_best_acc_score: 0.7437; val_best_f1_score: 0.7687; train_kl_reg_loss: 5734.1860; train_edge_recon_loss: 289926.5417; train_gene_expr_recon_loss: 64017.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359678.4792; train_optim_loss: 359678.4792; val_kl_reg_loss: 5456.8481; val_edge_recon_loss: 295391.8438; val_gene_expr_recon_loss: 62324.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363173.1875; val_optim_loss: 363173.1875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8386; val_auprc_score: 0.8332; val_best_acc_score: 0.7489; val_best_f1_score: 0.7661; train_kl_reg_loss: 5718.2795; train_edge_recon_loss: 290357.8802; train_gene_expr_recon_loss: 63864.8444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359941.0052; train_optim_loss: 359941.0052; val_kl_reg_loss: 5447.8560; val_edge_recon_loss: 297513.5938; val_gene_expr_recon_loss: 62322.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365284.1875; val_optim_loss: 365284.1875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8345; val_auprc_score: 0.8263; val_best_acc_score: 0.7437; val_best_f1_score: 0.7700; train_kl_reg_loss: 5703.2219; train_edge_recon_loss: 291874.7604; train_gene_expr_recon_loss: 63950.9199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361528.9010; train_optim_loss: 361528.9010; val_kl_reg_loss: 5454.0508; val_edge_recon_loss: 294249.4062; val_gene_expr_recon_loss: 62321.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362024.5312; val_optim_loss: 362024.5312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 28 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.8247
Val AUPRC score: 0.8178
Val best accuracy score: 0.7329
Val best F1 score: 0.7610
Val gene expr MSE score: 0.0102
Duration of model training in run 2: 0 hours, 0 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 41903
Number of validation edges: 4655
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8247; val_auprc_score: 0.8215; val_best_acc_score: 0.7223; val_best_f1_score: 0.7664; train_kl_reg_loss: 255.1172; train_edge_recon_loss: 340701.6310; train_gene_expr_recon_loss: 69979.9929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410936.7396; train_optim_loss: 410936.7396; val_kl_reg_loss: 1005.5412; val_edge_recon_loss: 303068.0208; val_gene_expr_recon_loss: 62941.8997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367015.4583; val_optim_loss: 367015.4583
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8393; val_auprc_score: 0.8274; val_best_acc_score: 0.7429; val_best_f1_score: 0.7762; train_kl_reg_loss: 6505.0709; train_edge_recon_loss: 297156.8482; train_gene_expr_recon_loss: 65983.5441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369645.4613; train_optim_loss: 369645.4613; val_kl_reg_loss: 8686.0990; val_edge_recon_loss: 291942.0938; val_gene_expr_recon_loss: 63853.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364481.2708; val_optim_loss: 364481.2708
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8754; val_auprc_score: 0.8663; val_best_acc_score: 0.8044; val_best_f1_score: 0.7978; train_kl_reg_loss: 5284.8870; train_edge_recon_loss: 291847.7589; train_gene_expr_recon_loss: 65236.5472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362369.1935; train_optim_loss: 362369.1935; val_kl_reg_loss: 3645.2377; val_edge_recon_loss: 292525.5833; val_gene_expr_recon_loss: 61463.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357633.9479; val_optim_loss: 357633.9479
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9189; val_auprc_score: 0.8969; val_best_acc_score: 0.8533; val_best_f1_score: 0.8609; train_kl_reg_loss: 4696.0503; train_edge_recon_loss: 280781.7083; train_gene_expr_recon_loss: 65041.9202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350519.6741; train_optim_loss: 350519.6741; val_kl_reg_loss: 4946.2106; val_edge_recon_loss: 271374.6250; val_gene_expr_recon_loss: 63461.4206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339782.2604; val_optim_loss: 339782.2604
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9355; val_auprc_score: 0.9129; val_best_acc_score: 0.8802; val_best_f1_score: 0.8875; train_kl_reg_loss: 4444.2508; train_edge_recon_loss: 269105.7202; train_gene_expr_recon_loss: 64717.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338267.1265; train_optim_loss: 338267.1265; val_kl_reg_loss: 4519.8073; val_edge_recon_loss: 269382.4062; val_gene_expr_recon_loss: 62981.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336883.6042; val_optim_loss: 336883.6042
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9431; val_auprc_score: 0.9187; val_best_acc_score: 0.8930; val_best_f1_score: 0.8984; train_kl_reg_loss: 4359.5734; train_edge_recon_loss: 267189.2247; train_gene_expr_recon_loss: 64206.5435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335755.3408; train_optim_loss: 335755.3408; val_kl_reg_loss: 4199.4043; val_edge_recon_loss: 267319.4896; val_gene_expr_recon_loss: 65947.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337466.5938; val_optim_loss: 337466.5938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9506; val_auprc_score: 0.9291; val_best_acc_score: 0.9027; val_best_f1_score: 0.9058; train_kl_reg_loss: 4245.7171; train_edge_recon_loss: 265976.3735; train_gene_expr_recon_loss: 63987.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334209.8973; train_optim_loss: 334209.8973; val_kl_reg_loss: 4203.8843; val_edge_recon_loss: 266474.9375; val_gene_expr_recon_loss: 64941.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335619.9271; val_optim_loss: 335619.9271
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9558; val_auprc_score: 0.9381; val_best_acc_score: 0.9106; val_best_f1_score: 0.9125; train_kl_reg_loss: 4304.1572; train_edge_recon_loss: 264575.5015; train_gene_expr_recon_loss: 63785.8064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332665.4628; train_optim_loss: 332665.4628; val_kl_reg_loss: 4385.2197; val_edge_recon_loss: 264993.0521; val_gene_expr_recon_loss: 62249.6107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331627.8750; val_optim_loss: 331627.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9578; val_auprc_score: 0.9418; val_best_acc_score: 0.9170; val_best_f1_score: 0.9204; train_kl_reg_loss: 4309.3239; train_edge_recon_loss: 264320.7656; train_gene_expr_recon_loss: 63503.9064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332133.9970; train_optim_loss: 332133.9970; val_kl_reg_loss: 4202.4185; val_edge_recon_loss: 263879.6615; val_gene_expr_recon_loss: 63054.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331136.7812; val_optim_loss: 331136.7812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9611; val_auprc_score: 0.9431; val_best_acc_score: 0.9174; val_best_f1_score: 0.9203; train_kl_reg_loss: 4317.3802; train_edge_recon_loss: 263687.4107; train_gene_expr_recon_loss: 63262.8082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331267.6027; train_optim_loss: 331267.6027; val_kl_reg_loss: 4128.3464; val_edge_recon_loss: 264160.4792; val_gene_expr_recon_loss: 60200.8073; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328489.6354; val_optim_loss: 328489.6354
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9628; val_auprc_score: 0.9465; val_best_acc_score: 0.9249; val_best_f1_score: 0.9280; train_kl_reg_loss: 4258.8558; train_edge_recon_loss: 263661.1696; train_gene_expr_recon_loss: 63224.9559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331144.9821; train_optim_loss: 331144.9821; val_kl_reg_loss: 4126.3301; val_edge_recon_loss: 262164.2031; val_gene_expr_recon_loss: 59799.2826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326089.8125; val_optim_loss: 326089.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9650; val_auprc_score: 0.9445; val_best_acc_score: 0.9278; val_best_f1_score: 0.9309; train_kl_reg_loss: 4236.6468; train_edge_recon_loss: 262965.4516; train_gene_expr_recon_loss: 63028.1334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330230.2262; train_optim_loss: 330230.2262; val_kl_reg_loss: 4211.4307; val_edge_recon_loss: 262084.1667; val_gene_expr_recon_loss: 63284.7982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329580.3854; val_optim_loss: 329580.3854
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9630; val_auprc_score: 0.9423; val_best_acc_score: 0.9260; val_best_f1_score: 0.9295; train_kl_reg_loss: 4269.2163; train_edge_recon_loss: 261894.8363; train_gene_expr_recon_loss: 63014.7706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329178.8185; train_optim_loss: 329178.8185; val_kl_reg_loss: 4210.0549; val_edge_recon_loss: 263816.5208; val_gene_expr_recon_loss: 60456.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328483.1354; val_optim_loss: 328483.1354
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9688; val_auprc_score: 0.9528; val_best_acc_score: 0.9300; val_best_f1_score: 0.9327; train_kl_reg_loss: 4259.9945; train_edge_recon_loss: 262001.7046; train_gene_expr_recon_loss: 62878.3144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329140.0149; train_optim_loss: 329140.0149; val_kl_reg_loss: 4247.2508; val_edge_recon_loss: 261740.3438; val_gene_expr_recon_loss: 61635.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327623.2188; val_optim_loss: 327623.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9683; val_auprc_score: 0.9521; val_best_acc_score: 0.9300; val_best_f1_score: 0.9329; train_kl_reg_loss: 4297.8956; train_edge_recon_loss: 261810.9159; train_gene_expr_recon_loss: 62518.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328627.3943; train_optim_loss: 328627.3943; val_kl_reg_loss: 4215.5177; val_edge_recon_loss: 261720.0365; val_gene_expr_recon_loss: 63051.9115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328987.4583; val_optim_loss: 328987.4583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9673; val_auprc_score: 0.9516; val_best_acc_score: 0.9308; val_best_f1_score: 0.9335; train_kl_reg_loss: 4248.8786; train_edge_recon_loss: 261208.2336; train_gene_expr_recon_loss: 62313.3078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327770.4182; train_optim_loss: 327770.4182; val_kl_reg_loss: 4197.0428; val_edge_recon_loss: 260737.5677; val_gene_expr_recon_loss: 60717.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325652.2500; val_optim_loss: 325652.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9691; val_auprc_score: 0.9531; val_best_acc_score: 0.9308; val_best_f1_score: 0.9334; train_kl_reg_loss: 4254.5794; train_edge_recon_loss: 261388.7560; train_gene_expr_recon_loss: 62385.6174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328028.9494; train_optim_loss: 328028.9494; val_kl_reg_loss: 4166.7998; val_edge_recon_loss: 259292.0677; val_gene_expr_recon_loss: 63227.6263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326686.4896; val_optim_loss: 326686.4896
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9679; val_auprc_score: 0.9532; val_best_acc_score: 0.9304; val_best_f1_score: 0.9335; train_kl_reg_loss: 4256.1600; train_edge_recon_loss: 261586.4159; train_gene_expr_recon_loss: 62403.9541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328246.5283; train_optim_loss: 328246.5283; val_kl_reg_loss: 4184.7622; val_edge_recon_loss: 262595.7396; val_gene_expr_recon_loss: 60117.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326897.6458; val_optim_loss: 326897.6458
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9679; val_auprc_score: 0.9544; val_best_acc_score: 0.9280; val_best_f1_score: 0.9309; train_kl_reg_loss: 4249.4557; train_edge_recon_loss: 261401.1280; train_gene_expr_recon_loss: 62321.6404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327972.2232; train_optim_loss: 327972.2232; val_kl_reg_loss: 4217.6535; val_edge_recon_loss: 260459.2604; val_gene_expr_recon_loss: 61118.6784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325795.5938; val_optim_loss: 325795.5938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9684; val_auprc_score: 0.9531; val_best_acc_score: 0.9298; val_best_f1_score: 0.9326; train_kl_reg_loss: 4256.3119; train_edge_recon_loss: 261481.5677; train_gene_expr_recon_loss: 62352.9600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328090.8378; train_optim_loss: 328090.8378; val_kl_reg_loss: 4231.1172; val_edge_recon_loss: 261202.8073; val_gene_expr_recon_loss: 60301.5143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325735.4271; val_optim_loss: 325735.4271
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9646; val_auprc_score: 0.9467; val_best_acc_score: 0.9284; val_best_f1_score: 0.9312; train_kl_reg_loss: 4254.5040; train_edge_recon_loss: 261374.8103; train_gene_expr_recon_loss: 62362.4658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327991.7798; train_optim_loss: 327991.7798; val_kl_reg_loss: 4208.6732; val_edge_recon_loss: 262178.7552; val_gene_expr_recon_loss: 60244.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326631.5521; val_optim_loss: 326631.5521
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9678; val_auprc_score: 0.9521; val_best_acc_score: 0.9284; val_best_f1_score: 0.9307; train_kl_reg_loss: 4248.9155; train_edge_recon_loss: 261250.0060; train_gene_expr_recon_loss: 62258.4803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327757.4003; train_optim_loss: 327757.4003; val_kl_reg_loss: 4206.6769; val_edge_recon_loss: 262282.3958; val_gene_expr_recon_loss: 63139.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329629.0729; val_optim_loss: 329629.0729

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 19 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9649
Val AUPRC score: 0.9462
Val best accuracy score: 0.9259
Val best F1 score: 0.9292
Val gene expr MSE score: 0.0097
Duration of model training in run 3: 0 hours, 1 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 41903
Number of validation edges: 4655
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8211; val_auprc_score: 0.8202; val_best_acc_score: 0.7179; val_best_f1_score: 0.7611; train_kl_reg_loss: 283.2299; train_edge_recon_loss: 340144.9568; train_gene_expr_recon_loss: 69479.1071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409907.2917; train_optim_loss: 409907.2917; val_kl_reg_loss: 1183.3151; val_edge_recon_loss: 304809.3958; val_gene_expr_recon_loss: 65043.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371036.4792; val_optim_loss: 371036.4792
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8472; val_auprc_score: 0.8405; val_best_acc_score: 0.7382; val_best_f1_score: 0.7757; train_kl_reg_loss: 6840.4737; train_edge_recon_loss: 295777.2530; train_gene_expr_recon_loss: 65170.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367788.3095; train_optim_loss: 367788.3095; val_kl_reg_loss: 7876.4064; val_edge_recon_loss: 292720.7292; val_gene_expr_recon_loss: 68022.5599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368619.6875; val_optim_loss: 368619.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8848; val_auprc_score: 0.8771; val_best_acc_score: 0.8004; val_best_f1_score: 0.8038; train_kl_reg_loss: 4972.8663; train_edge_recon_loss: 290034.8259; train_gene_expr_recon_loss: 64635.9591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359643.6533; train_optim_loss: 359643.6533; val_kl_reg_loss: 3967.1051; val_edge_recon_loss: 287419.0938; val_gene_expr_recon_loss: 65734.2161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357120.4167; val_optim_loss: 357120.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9298; val_auprc_score: 0.9094; val_best_acc_score: 0.8637; val_best_f1_score: 0.8697; train_kl_reg_loss: 5008.0267; train_edge_recon_loss: 278034.5298; train_gene_expr_recon_loss: 64500.6955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347543.2545; train_optim_loss: 347543.2545; val_kl_reg_loss: 5136.3529; val_edge_recon_loss: 268856.4479; val_gene_expr_recon_loss: 64270.5990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338263.3958; val_optim_loss: 338263.3958
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9420; val_auprc_score: 0.9244; val_best_acc_score: 0.8837; val_best_f1_score: 0.8894; train_kl_reg_loss: 4561.5891; train_edge_recon_loss: 268754.3929; train_gene_expr_recon_loss: 64019.3674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337335.3452; train_optim_loss: 337335.3452; val_kl_reg_loss: 4359.4017; val_edge_recon_loss: 268617.8333; val_gene_expr_recon_loss: 63509.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336487.1771; val_optim_loss: 336487.1771
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9458; val_auprc_score: 0.9218; val_best_acc_score: 0.8974; val_best_f1_score: 0.9025; train_kl_reg_loss: 4359.4408; train_edge_recon_loss: 266099.2455; train_gene_expr_recon_loss: 63545.3895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334004.0759; train_optim_loss: 334004.0759; val_kl_reg_loss: 4175.8185; val_edge_recon_loss: 267259.3438; val_gene_expr_recon_loss: 64825.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336260.2708; val_optim_loss: 336260.2708
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9551; val_auprc_score: 0.9362; val_best_acc_score: 0.9063; val_best_f1_score: 0.9114; train_kl_reg_loss: 4265.8656; train_edge_recon_loss: 265283.7113; train_gene_expr_recon_loss: 63395.4807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332945.0610; train_optim_loss: 332945.0610; val_kl_reg_loss: 4296.1567; val_edge_recon_loss: 265739.2917; val_gene_expr_recon_loss: 63727.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333763.3021; val_optim_loss: 333763.3021
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9543; val_auprc_score: 0.9358; val_best_acc_score: 0.9103; val_best_f1_score: 0.9141; train_kl_reg_loss: 4314.7935; train_edge_recon_loss: 264151.9621; train_gene_expr_recon_loss: 63053.4222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331520.1786; train_optim_loss: 331520.1786; val_kl_reg_loss: 4239.9933; val_edge_recon_loss: 264906.0208; val_gene_expr_recon_loss: 61492.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330638.9583; val_optim_loss: 330638.9583
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9573; val_auprc_score: 0.9387; val_best_acc_score: 0.9120; val_best_f1_score: 0.9167; train_kl_reg_loss: 4347.2388; train_edge_recon_loss: 264309.3371; train_gene_expr_recon_loss: 62627.9978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331284.5744; train_optim_loss: 331284.5744; val_kl_reg_loss: 4261.3180; val_edge_recon_loss: 264350.0625; val_gene_expr_recon_loss: 63994.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332605.5625; val_optim_loss: 332605.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9618; val_auprc_score: 0.9442; val_best_acc_score: 0.9175; val_best_f1_score: 0.9213; train_kl_reg_loss: 4288.2908; train_edge_recon_loss: 263929.4397; train_gene_expr_recon_loss: 62637.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330854.8393; train_optim_loss: 330854.8393; val_kl_reg_loss: 4250.8001; val_edge_recon_loss: 262983.1146; val_gene_expr_recon_loss: 62819.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330053.0938; val_optim_loss: 330053.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9643; val_auprc_score: 0.9471; val_best_acc_score: 0.9188; val_best_f1_score: 0.9228; train_kl_reg_loss: 4277.5606; train_edge_recon_loss: 263679.1198; train_gene_expr_recon_loss: 62462.1732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330418.8482; train_optim_loss: 330418.8482; val_kl_reg_loss: 4141.7683; val_edge_recon_loss: 262290.2188; val_gene_expr_recon_loss: 64113.3776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330545.3646; val_optim_loss: 330545.3646
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9639; val_auprc_score: 0.9450; val_best_acc_score: 0.9244; val_best_f1_score: 0.9273; train_kl_reg_loss: 4257.0240; train_edge_recon_loss: 262726.6458; train_gene_expr_recon_loss: 62409.2375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329392.9048; train_optim_loss: 329392.9048; val_kl_reg_loss: 4170.8117; val_edge_recon_loss: 263709.1250; val_gene_expr_recon_loss: 60737.0560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328616.9896; val_optim_loss: 328616.9896
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9617; val_auprc_score: 0.9380; val_best_acc_score: 0.9234; val_best_f1_score: 0.9262; train_kl_reg_loss: 4204.9604; train_edge_recon_loss: 263362.0186; train_gene_expr_recon_loss: 62146.1217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329713.0982; train_optim_loss: 329713.0982; val_kl_reg_loss: 4086.2005; val_edge_recon_loss: 262976.2500; val_gene_expr_recon_loss: 65561.1432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332623.5938; val_optim_loss: 332623.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9667; val_auprc_score: 0.9508; val_best_acc_score: 0.9325; val_best_f1_score: 0.9354; train_kl_reg_loss: 4212.4645; train_edge_recon_loss: 262520.3452; train_gene_expr_recon_loss: 62098.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328830.8378; train_optim_loss: 328830.8378; val_kl_reg_loss: 4188.2287; val_edge_recon_loss: 261405.4479; val_gene_expr_recon_loss: 65300.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330894.5833; val_optim_loss: 330894.5833
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9687; val_auprc_score: 0.9544; val_best_acc_score: 0.9308; val_best_f1_score: 0.9333; train_kl_reg_loss: 4201.9672; train_edge_recon_loss: 262002.6079; train_gene_expr_recon_loss: 61961.2582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328165.8348; train_optim_loss: 328165.8348; val_kl_reg_loss: 4226.1974; val_edge_recon_loss: 263149.3854; val_gene_expr_recon_loss: 66747.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334123.3438; val_optim_loss: 334123.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9706; val_auprc_score: 0.9553; val_best_acc_score: 0.9349; val_best_f1_score: 0.9372; train_kl_reg_loss: 4240.5693; train_edge_recon_loss: 261868.5134; train_gene_expr_recon_loss: 61578.7294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327687.8125; train_optim_loss: 327687.8125; val_kl_reg_loss: 4123.0734; val_edge_recon_loss: 261008.8385; val_gene_expr_recon_loss: 60403.0911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325535.0104; val_optim_loss: 325535.0104
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9685; val_auprc_score: 0.9538; val_best_acc_score: 0.9346; val_best_f1_score: 0.9366; train_kl_reg_loss: 4202.1816; train_edge_recon_loss: 261181.6496; train_gene_expr_recon_loss: 61534.6148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326918.4464; train_optim_loss: 326918.4464; val_kl_reg_loss: 4168.7155; val_edge_recon_loss: 262301.8438; val_gene_expr_recon_loss: 63482.4635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329953.0208; val_optim_loss: 329953.0208
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9707; val_auprc_score: 0.9550; val_best_acc_score: 0.9337; val_best_f1_score: 0.9361; train_kl_reg_loss: 4205.6279; train_edge_recon_loss: 261464.5156; train_gene_expr_recon_loss: 61561.0813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327231.2262; train_optim_loss: 327231.2262; val_kl_reg_loss: 4139.4259; val_edge_recon_loss: 261383.8490; val_gene_expr_recon_loss: 64610.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330134.2500; val_optim_loss: 330134.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9672; val_auprc_score: 0.9518; val_best_acc_score: 0.9311; val_best_f1_score: 0.9336; train_kl_reg_loss: 4204.1191; train_edge_recon_loss: 260815.6518; train_gene_expr_recon_loss: 61581.0536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326600.8244; train_optim_loss: 326600.8244; val_kl_reg_loss: 4116.5278; val_edge_recon_loss: 262031.9479; val_gene_expr_recon_loss: 59803.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325952.1562; val_optim_loss: 325952.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9651; val_auprc_score: 0.9440; val_best_acc_score: 0.9306; val_best_f1_score: 0.9332; train_kl_reg_loss: 4205.4250; train_edge_recon_loss: 261520.2336; train_gene_expr_recon_loss: 61510.4386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327236.0982; train_optim_loss: 327236.0982; val_kl_reg_loss: 4128.8407; val_edge_recon_loss: 263011.9271; val_gene_expr_recon_loss: 62781.7604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329922.5208; val_optim_loss: 329922.5208
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9705; val_auprc_score: 0.9577; val_best_acc_score: 0.9334; val_best_f1_score: 0.9362; train_kl_reg_loss: 4203.6959; train_edge_recon_loss: 261550.3475; train_gene_expr_recon_loss: 61546.1600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327300.2009; train_optim_loss: 327300.2009; val_kl_reg_loss: 4154.8354; val_edge_recon_loss: 261053.3542; val_gene_expr_recon_loss: 62781.6198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327989.8125; val_optim_loss: 327989.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9688; val_auprc_score: 0.9496; val_best_acc_score: 0.9339; val_best_f1_score: 0.9361; train_kl_reg_loss: 4204.2686; train_edge_recon_loss: 261631.5350; train_gene_expr_recon_loss: 61525.6027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327361.4003; train_optim_loss: 327361.4003; val_kl_reg_loss: 4150.0892; val_edge_recon_loss: 259947.9635; val_gene_expr_recon_loss: 62842.5872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326940.6458; val_optim_loss: 326940.6458

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 21 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9676
Val AUPRC score: 0.9507
Val best accuracy score: 0.9353
Val best F1 score: 0.9374
Val gene expr MSE score: 0.0094
Duration of model training in run 4: 0 hours, 1 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 61823
Number of validation edges: 6869
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8662; val_auprc_score: 0.8578; val_best_acc_score: 0.7665; val_best_f1_score: 0.7832; train_kl_reg_loss: 3817.9662; train_edge_recon_loss: 312113.6101; train_gene_expr_recon_loss: 67041.5784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382973.1552; train_optim_loss: 382973.1552; val_kl_reg_loss: 3891.4155; val_edge_recon_loss: 292596.5045; val_gene_expr_recon_loss: 64077.7081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360565.6295; val_optim_loss: 360565.6295
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9322; val_auprc_score: 0.9093; val_best_acc_score: 0.8715; val_best_f1_score: 0.8790; train_kl_reg_loss: 4362.1662; train_edge_recon_loss: 279401.6673; train_gene_expr_recon_loss: 64575.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348339.2162; train_optim_loss: 348339.2162; val_kl_reg_loss: 4131.6562; val_edge_recon_loss: 270035.3527; val_gene_expr_recon_loss: 63631.2706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337798.2812; val_optim_loss: 337798.2812
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9500; val_auprc_score: 0.9294; val_best_acc_score: 0.8976; val_best_f1_score: 0.9026; train_kl_reg_loss: 4263.9893; train_edge_recon_loss: 267410.8463; train_gene_expr_recon_loss: 63883.7184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335558.5512; train_optim_loss: 335558.5512; val_kl_reg_loss: 4164.5246; val_edge_recon_loss: 266191.8036; val_gene_expr_recon_loss: 63349.4972; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333705.8304; val_optim_loss: 333705.8304
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9649; val_auprc_score: 0.9486; val_best_acc_score: 0.9235; val_best_f1_score: 0.9260; train_kl_reg_loss: 4157.9419; train_edge_recon_loss: 266105.7825; train_gene_expr_recon_loss: 63338.7150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333602.4401; train_optim_loss: 333602.4401; val_kl_reg_loss: 4117.4016; val_edge_recon_loss: 264901.2143; val_gene_expr_recon_loss: 62975.2924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331993.9062; val_optim_loss: 331993.9062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9674; val_auprc_score: 0.9506; val_best_acc_score: 0.9286; val_best_f1_score: 0.9307; train_kl_reg_loss: 4220.6441; train_edge_recon_loss: 263940.7269; train_gene_expr_recon_loss: 62805.8238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330967.1942; train_optim_loss: 330967.1942; val_kl_reg_loss: 4106.6004; val_edge_recon_loss: 262058.9978; val_gene_expr_recon_loss: 62538.4715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328704.0759; val_optim_loss: 328704.0759
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9715; val_auprc_score: 0.9575; val_best_acc_score: 0.9353; val_best_f1_score: 0.9378; train_kl_reg_loss: 4206.7231; train_edge_recon_loss: 262643.7113; train_gene_expr_recon_loss: 62503.1625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329353.5948; train_optim_loss: 329353.5948; val_kl_reg_loss: 4216.6839; val_edge_recon_loss: 262309.2299; val_gene_expr_recon_loss: 62979.8337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329505.7545; val_optim_loss: 329505.7545
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9730; val_auprc_score: 0.9612; val_best_acc_score: 0.9377; val_best_f1_score: 0.9404; train_kl_reg_loss: 4236.1538; train_edge_recon_loss: 261377.1012; train_gene_expr_recon_loss: 62122.7401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327735.9959; train_optim_loss: 327735.9959; val_kl_reg_loss: 4301.0191; val_edge_recon_loss: 260503.1138; val_gene_expr_recon_loss: 61744.8878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326549.0223; val_optim_loss: 326549.0223
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9726; val_auprc_score: 0.9585; val_best_acc_score: 0.9393; val_best_f1_score: 0.9420; train_kl_reg_loss: 4207.7963; train_edge_recon_loss: 260800.4324; train_gene_expr_recon_loss: 61870.9020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326879.1306; train_optim_loss: 326879.1306; val_kl_reg_loss: 4181.6422; val_edge_recon_loss: 260227.5290; val_gene_expr_recon_loss: 61383.7550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325792.9330; val_optim_loss: 325792.9330
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9751; val_auprc_score: 0.9624; val_best_acc_score: 0.9460; val_best_f1_score: 0.9478; train_kl_reg_loss: 4174.3486; train_edge_recon_loss: 260605.1101; train_gene_expr_recon_loss: 61511.4751; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326290.9349; train_optim_loss: 326290.9349; val_kl_reg_loss: 4131.6078; val_edge_recon_loss: 260437.3125; val_gene_expr_recon_loss: 61870.6791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326439.5938; val_optim_loss: 326439.5938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9781; val_auprc_score: 0.9676; val_best_acc_score: 0.9474; val_best_f1_score: 0.9492; train_kl_reg_loss: 4185.7019; train_edge_recon_loss: 260120.8476; train_gene_expr_recon_loss: 61366.5815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325673.1317; train_optim_loss: 325673.1317; val_kl_reg_loss: 4117.9121; val_edge_recon_loss: 259006.7835; val_gene_expr_recon_loss: 61028.6451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324153.3348; val_optim_loss: 324153.3348
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9794; val_auprc_score: 0.9669; val_best_acc_score: 0.9512; val_best_f1_score: 0.9526; train_kl_reg_loss: 4195.2127; train_edge_recon_loss: 259507.5566; train_gene_expr_recon_loss: 61128.4924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324831.2623; train_optim_loss: 324831.2623; val_kl_reg_loss: 4098.1502; val_edge_recon_loss: 258594.5893; val_gene_expr_recon_loss: 61039.2076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323731.9509; val_optim_loss: 323731.9509
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9755; val_auprc_score: 0.9635; val_best_acc_score: 0.9470; val_best_f1_score: 0.9489; train_kl_reg_loss: 4167.7368; train_edge_recon_loss: 259302.5912; train_gene_expr_recon_loss: 60922.4299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324392.7577; train_optim_loss: 324392.7577; val_kl_reg_loss: 4149.7464; val_edge_recon_loss: 259792.2232; val_gene_expr_recon_loss: 61869.6802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325811.6473; val_optim_loss: 325811.6473
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9768; val_auprc_score: 0.9648; val_best_acc_score: 0.9496; val_best_f1_score: 0.9515; train_kl_reg_loss: 4157.6553; train_edge_recon_loss: 259006.3145; train_gene_expr_recon_loss: 60639.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323803.2526; train_optim_loss: 323803.2526; val_kl_reg_loss: 4138.6335; val_edge_recon_loss: 258888.4018; val_gene_expr_recon_loss: 60306.1378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323333.1696; val_optim_loss: 323333.1696
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9785; val_auprc_score: 0.9680; val_best_acc_score: 0.9520; val_best_f1_score: 0.9536; train_kl_reg_loss: 4147.4048; train_edge_recon_loss: 258976.8046; train_gene_expr_recon_loss: 60496.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323620.2710; train_optim_loss: 323620.2710; val_kl_reg_loss: 4137.9896; val_edge_recon_loss: 258749.2589; val_gene_expr_recon_loss: 60131.0435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323018.2946; val_optim_loss: 323018.2946
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9782; val_auprc_score: 0.9648; val_best_acc_score: 0.9517; val_best_f1_score: 0.9533; train_kl_reg_loss: 4134.3217; train_edge_recon_loss: 259190.4477; train_gene_expr_recon_loss: 60333.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323658.0763; train_optim_loss: 323658.0763; val_kl_reg_loss: 4051.6641; val_edge_recon_loss: 258721.6317; val_gene_expr_recon_loss: 60495.4007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323268.6920; val_optim_loss: 323268.6920
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9815; val_auprc_score: 0.9730; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 4137.6808; train_edge_recon_loss: 258530.6929; train_gene_expr_recon_loss: 60134.3284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322802.7039; train_optim_loss: 322802.7039; val_kl_reg_loss: 4153.7671; val_edge_recon_loss: 257819.6317; val_gene_expr_recon_loss: 60338.4012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322311.8036; val_optim_loss: 322311.8036
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9819; val_auprc_score: 0.9741; val_best_acc_score: 0.9559; val_best_f1_score: 0.9573; train_kl_reg_loss: 4131.9132; train_edge_recon_loss: 259161.2024; train_gene_expr_recon_loss: 59957.1778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323250.2946; train_optim_loss: 323250.2946; val_kl_reg_loss: 4175.2972; val_edge_recon_loss: 257723.8728; val_gene_expr_recon_loss: 60673.4213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322572.5982; val_optim_loss: 322572.5982
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9801; val_auprc_score: 0.9702; val_best_acc_score: 0.9560; val_best_f1_score: 0.9574; train_kl_reg_loss: 4132.9022; train_edge_recon_loss: 258597.6634; train_gene_expr_recon_loss: 59762.2905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322492.8560; train_optim_loss: 322492.8560; val_kl_reg_loss: 4091.9509; val_edge_recon_loss: 257233.7656; val_gene_expr_recon_loss: 59511.5541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320837.2723; val_optim_loss: 320837.2723
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9805; val_auprc_score: 0.9717; val_best_acc_score: 0.9549; val_best_f1_score: 0.9563; train_kl_reg_loss: 4115.3364; train_edge_recon_loss: 258407.1260; train_gene_expr_recon_loss: 59787.8510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322310.3176; train_optim_loss: 322310.3176; val_kl_reg_loss: 4053.4097; val_edge_recon_loss: 258551.0826; val_gene_expr_recon_loss: 59930.2919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322534.7812; val_optim_loss: 322534.7812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9810; val_auprc_score: 0.9723; val_best_acc_score: 0.9549; val_best_f1_score: 0.9565; train_kl_reg_loss: 4133.9820; train_edge_recon_loss: 258529.5699; train_gene_expr_recon_loss: 59565.9184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322229.4688; train_optim_loss: 322229.4688; val_kl_reg_loss: 4107.8737; val_edge_recon_loss: 258425.1763; val_gene_expr_recon_loss: 59381.1155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321914.1696; val_optim_loss: 321914.1696
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9796; val_auprc_score: 0.9698; val_best_acc_score: 0.9534; val_best_f1_score: 0.9547; train_kl_reg_loss: 4138.1763; train_edge_recon_loss: 257826.8573; train_gene_expr_recon_loss: 59418.0020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321383.0353; train_optim_loss: 321383.0353; val_kl_reg_loss: 4189.2866; val_edge_recon_loss: 258073.3348; val_gene_expr_recon_loss: 59763.7757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322026.3973; val_optim_loss: 322026.3973

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9823; val_auprc_score: 0.9720; val_best_acc_score: 0.9596; val_best_f1_score: 0.9608; train_kl_reg_loss: 4171.1026; train_edge_recon_loss: 258490.2733; train_gene_expr_recon_loss: 59128.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321789.7736; train_optim_loss: 321789.7736; val_kl_reg_loss: 4105.5708; val_edge_recon_loss: 256619.5826; val_gene_expr_recon_loss: 59042.3644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319767.5134; val_optim_loss: 319767.5134
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9802; val_auprc_score: 0.9682; val_best_acc_score: 0.9571; val_best_f1_score: 0.9584; train_kl_reg_loss: 4126.1246; train_edge_recon_loss: 257825.7912; train_gene_expr_recon_loss: 59044.1062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320996.0205; train_optim_loss: 320996.0205; val_kl_reg_loss: 4115.6804; val_edge_recon_loss: 257931.4263; val_gene_expr_recon_loss: 58876.5056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320923.6071; val_optim_loss: 320923.6071
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9832; val_auprc_score: 0.9758; val_best_acc_score: 0.9594; val_best_f1_score: 0.9605; train_kl_reg_loss: 4127.1647; train_edge_recon_loss: 258026.1081; train_gene_expr_recon_loss: 59027.1188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321180.3899; train_optim_loss: 321180.3899; val_kl_reg_loss: 4080.6876; val_edge_recon_loss: 256780.4509; val_gene_expr_recon_loss: 58624.3248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319485.4643; val_optim_loss: 319485.4643
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9822; val_auprc_score: 0.9733; val_best_acc_score: 0.9578; val_best_f1_score: 0.9591; train_kl_reg_loss: 4130.3572; train_edge_recon_loss: 257733.4506; train_gene_expr_recon_loss: 59060.3703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320924.1783; train_optim_loss: 320924.1783; val_kl_reg_loss: 4088.8644; val_edge_recon_loss: 256633.3549; val_gene_expr_recon_loss: 58528.9079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319251.1295; val_optim_loss: 319251.1295
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9808; val_auprc_score: 0.9710; val_best_acc_score: 0.9570; val_best_f1_score: 0.9584; train_kl_reg_loss: 3936.4454; train_edge_recon_loss: 257840.1368; train_gene_expr_recon_loss: 59035.5705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320812.1522; train_optim_loss: 320812.1522; val_kl_reg_loss: 3528.2736; val_edge_recon_loss: 257456.5268; val_gene_expr_recon_loss: 59765.1088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320749.9062; val_optim_loss: 320749.9062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9809; val_auprc_score: 0.9706; val_best_acc_score: 0.9566; val_best_f1_score: 0.9578; train_kl_reg_loss: 3607.9682; train_edge_recon_loss: 257815.1880; train_gene_expr_recon_loss: 58928.1128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320351.2705; train_optim_loss: 320351.2705; val_kl_reg_loss: 3252.6164; val_edge_recon_loss: 258226.8951; val_gene_expr_recon_loss: 59303.7003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320783.2188; val_optim_loss: 320783.2188
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9795; val_auprc_score: 0.9707; val_best_acc_score: 0.9557; val_best_f1_score: 0.9570; train_kl_reg_loss: 3378.8313; train_edge_recon_loss: 257690.1652; train_gene_expr_recon_loss: 58989.5074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320058.5026; train_optim_loss: 320058.5026; val_kl_reg_loss: 3075.5596; val_edge_recon_loss: 258297.9152; val_gene_expr_recon_loss: 59641.8309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321015.3080; val_optim_loss: 321015.3080

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9812; val_auprc_score: 0.9709; val_best_acc_score: 0.9589; val_best_f1_score: 0.9602; train_kl_reg_loss: 3289.4767; train_edge_recon_loss: 257563.4180; train_gene_expr_recon_loss: 58950.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319803.3140; train_optim_loss: 319803.3140; val_kl_reg_loss: 3062.9017; val_edge_recon_loss: 257050.7299; val_gene_expr_recon_loss: 59263.5095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319377.1384; val_optim_loss: 319377.1384
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9797; val_auprc_score: 0.9699; val_best_acc_score: 0.9553; val_best_f1_score: 0.9568; train_kl_reg_loss: 3281.1547; train_edge_recon_loss: 257705.3837; train_gene_expr_recon_loss: 59017.8981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320004.4349; train_optim_loss: 320004.4349; val_kl_reg_loss: 3055.4653; val_edge_recon_loss: 257967.2679; val_gene_expr_recon_loss: 59250.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320273.5982; val_optim_loss: 320273.5982
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9820; val_auprc_score: 0.9726; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 3273.0205; train_edge_recon_loss: 257603.2984; train_gene_expr_recon_loss: 58964.8108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319841.1281; train_optim_loss: 319841.1281; val_kl_reg_loss: 3044.7008; val_edge_recon_loss: 256694.4799; val_gene_expr_recon_loss: 59595.7824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319334.9598; val_optim_loss: 319334.9598

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9808
Val AUPRC score: 0.9701
Val best accuracy score: 0.9572
Val best F1 score: 0.9585
Val gene expr MSE score: 0.0092
Duration of model training in run 5: 0 hours, 4 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 61823
Number of validation edges: 6869
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8672; val_auprc_score: 0.8616; val_best_acc_score: 0.7671; val_best_f1_score: 0.7817; train_kl_reg_loss: 3846.0882; train_edge_recon_loss: 313050.4800; train_gene_expr_recon_loss: 67199.1121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384095.6788; train_optim_loss: 384095.6788; val_kl_reg_loss: 4102.1538; val_edge_recon_loss: 293162.8259; val_gene_expr_recon_loss: 65254.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362519.2321; val_optim_loss: 362519.2321
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9403; val_auprc_score: 0.9172; val_best_acc_score: 0.8827; val_best_f1_score: 0.8892; train_kl_reg_loss: 4430.9454; train_edge_recon_loss: 277796.8417; train_gene_expr_recon_loss: 64982.4837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347210.2700; train_optim_loss: 347210.2700; val_kl_reg_loss: 4408.1598; val_edge_recon_loss: 268926.2188; val_gene_expr_recon_loss: 64253.7467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337588.1250; val_optim_loss: 337588.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9552; val_auprc_score: 0.9371; val_best_acc_score: 0.9082; val_best_f1_score: 0.9124; train_kl_reg_loss: 4287.4249; train_edge_recon_loss: 267507.0697; train_gene_expr_recon_loss: 63931.8606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335726.3555; train_optim_loss: 335726.3555; val_kl_reg_loss: 4267.2515; val_edge_recon_loss: 265302.8214; val_gene_expr_recon_loss: 64056.1256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333626.2009; val_optim_loss: 333626.2009
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9646; val_auprc_score: 0.9494; val_best_acc_score: 0.9244; val_best_f1_score: 0.9271; train_kl_reg_loss: 4209.9475; train_edge_recon_loss: 264972.9275; train_gene_expr_recon_loss: 63474.8909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332657.7659; train_optim_loss: 332657.7659; val_kl_reg_loss: 4177.6417; val_edge_recon_loss: 263893.0134; val_gene_expr_recon_loss: 63366.0876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331436.7455; val_optim_loss: 331436.7455
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9714; val_auprc_score: 0.9550; val_best_acc_score: 0.9383; val_best_f1_score: 0.9410; train_kl_reg_loss: 4268.6971; train_edge_recon_loss: 262640.8791; train_gene_expr_recon_loss: 62941.1728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329850.7464; train_optim_loss: 329850.7464; val_kl_reg_loss: 4212.0245; val_edge_recon_loss: 260027.0893; val_gene_expr_recon_loss: 62362.2427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326601.3616; val_optim_loss: 326601.3616
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9718; val_auprc_score: 0.9592; val_best_acc_score: 0.9362; val_best_f1_score: 0.9387; train_kl_reg_loss: 4258.0631; train_edge_recon_loss: 261981.2031; train_gene_expr_recon_loss: 62570.6781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328809.9426; train_optim_loss: 328809.9426; val_kl_reg_loss: 4216.2420; val_edge_recon_loss: 261563.5357; val_gene_expr_recon_loss: 62817.9353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328597.7143; val_optim_loss: 328597.7143
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9736; val_auprc_score: 0.9609; val_best_acc_score: 0.9411; val_best_f1_score: 0.9437; train_kl_reg_loss: 4232.0488; train_edge_recon_loss: 261669.9928; train_gene_expr_recon_loss: 62338.0662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328240.1071; train_optim_loss: 328240.1071; val_kl_reg_loss: 4217.7146; val_edge_recon_loss: 261622.1987; val_gene_expr_recon_loss: 61759.6987; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327599.6116; val_optim_loss: 327599.6116
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9752; val_auprc_score: 0.9606; val_best_acc_score: 0.9454; val_best_f1_score: 0.9473; train_kl_reg_loss: 4238.6198; train_edge_recon_loss: 260391.2623; train_gene_expr_recon_loss: 61911.5554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326541.4390; train_optim_loss: 326541.4390; val_kl_reg_loss: 4166.2660; val_edge_recon_loss: 260546.6384; val_gene_expr_recon_loss: 61755.6540; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326468.5580; val_optim_loss: 326468.5580
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9762; val_auprc_score: 0.9648; val_best_acc_score: 0.9469; val_best_f1_score: 0.9485; train_kl_reg_loss: 4223.5571; train_edge_recon_loss: 260130.2149; train_gene_expr_recon_loss: 61781.5248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326135.2941; train_optim_loss: 326135.2941; val_kl_reg_loss: 4143.8946; val_edge_recon_loss: 260363.1897; val_gene_expr_recon_loss: 62019.3426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326526.4286; val_optim_loss: 326526.4286
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9733; val_auprc_score: 0.9606; val_best_acc_score: 0.9460; val_best_f1_score: 0.9479; train_kl_reg_loss: 4199.7115; train_edge_recon_loss: 259796.2075; train_gene_expr_recon_loss: 61421.3384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325417.2572; train_optim_loss: 325417.2572; val_kl_reg_loss: 4192.8066; val_edge_recon_loss: 259651.1317; val_gene_expr_recon_loss: 61111.5843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324955.5223; val_optim_loss: 324955.5223
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9773; val_auprc_score: 0.9670; val_best_acc_score: 0.9466; val_best_f1_score: 0.9485; train_kl_reg_loss: 4187.6741; train_edge_recon_loss: 259804.8916; train_gene_expr_recon_loss: 61247.7199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325240.2838; train_optim_loss: 325240.2838; val_kl_reg_loss: 4143.1747; val_edge_recon_loss: 258519.5223; val_gene_expr_recon_loss: 61238.5558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323901.2500; val_optim_loss: 323901.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9777; val_auprc_score: 0.9682; val_best_acc_score: 0.9474; val_best_f1_score: 0.9490; train_kl_reg_loss: 4177.3600; train_edge_recon_loss: 259005.8865; train_gene_expr_recon_loss: 61039.1398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324222.3873; train_optim_loss: 324222.3873; val_kl_reg_loss: 4154.0776; val_edge_recon_loss: 258237.0580; val_gene_expr_recon_loss: 61577.6685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323968.8036; val_optim_loss: 323968.8036
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9807; val_auprc_score: 0.9715; val_best_acc_score: 0.9525; val_best_f1_score: 0.9539; train_kl_reg_loss: 4165.7478; train_edge_recon_loss: 258544.9910; train_gene_expr_recon_loss: 60827.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323538.1511; train_optim_loss: 323538.1511; val_kl_reg_loss: 4116.5889; val_edge_recon_loss: 257340.6094; val_gene_expr_recon_loss: 60291.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321749.1250; val_optim_loss: 321749.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9784; val_auprc_score: 0.9668; val_best_acc_score: 0.9506; val_best_f1_score: 0.9523; train_kl_reg_loss: 4153.1592; train_edge_recon_loss: 258757.8499; train_gene_expr_recon_loss: 60511.6210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323422.6301; train_optim_loss: 323422.6301; val_kl_reg_loss: 4158.8237; val_edge_recon_loss: 258748.3438; val_gene_expr_recon_loss: 60857.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323764.3839; val_optim_loss: 323764.3839
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9780; val_auprc_score: 0.9680; val_best_acc_score: 0.9511; val_best_f1_score: 0.9528; train_kl_reg_loss: 4143.5614; train_edge_recon_loss: 258943.3489; train_gene_expr_recon_loss: 60530.2916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323617.2013; train_optim_loss: 323617.2013; val_kl_reg_loss: 4061.6204; val_edge_recon_loss: 258527.4219; val_gene_expr_recon_loss: 61473.2796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324062.3170; val_optim_loss: 324062.3170
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9790; val_auprc_score: 0.9688; val_best_acc_score: 0.9532; val_best_f1_score: 0.9547; train_kl_reg_loss: 4124.7897; train_edge_recon_loss: 259047.5984; train_gene_expr_recon_loss: 60208.5551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323380.9442; train_optim_loss: 323380.9442; val_kl_reg_loss: 4106.1534; val_edge_recon_loss: 258966.7478; val_gene_expr_recon_loss: 60537.3850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323610.2902; val_optim_loss: 323610.2902

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9789; val_auprc_score: 0.9675; val_best_acc_score: 0.9520; val_best_f1_score: 0.9536; train_kl_reg_loss: 4140.0471; train_edge_recon_loss: 258560.7976; train_gene_expr_recon_loss: 59893.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322594.2638; train_optim_loss: 322594.2638; val_kl_reg_loss: 4095.3289; val_edge_recon_loss: 258777.5982; val_gene_expr_recon_loss: 60334.8705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323207.8036; val_optim_loss: 323207.8036
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9760; val_auprc_score: 0.9638; val_best_acc_score: 0.9497; val_best_f1_score: 0.9512; train_kl_reg_loss: 4126.2151; train_edge_recon_loss: 258389.0272; train_gene_expr_recon_loss: 59609.1568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322124.3975; train_optim_loss: 322124.3975; val_kl_reg_loss: 4101.3546; val_edge_recon_loss: 259072.1585; val_gene_expr_recon_loss: 60248.7215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323422.2321; val_optim_loss: 323422.2321
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9791; val_auprc_score: 0.9676; val_best_acc_score: 0.9532; val_best_f1_score: 0.9546; train_kl_reg_loss: 4153.9224; train_edge_recon_loss: 258275.6591; train_gene_expr_recon_loss: 59721.9990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322151.5763; train_optim_loss: 322151.5763; val_kl_reg_loss: 4093.3869; val_edge_recon_loss: 257916.4777; val_gene_expr_recon_loss: 59559.6429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321569.5089; val_optim_loss: 321569.5089
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9777; val_auprc_score: 0.9663; val_best_acc_score: 0.9523; val_best_f1_score: 0.9539; train_kl_reg_loss: 4120.6952; train_edge_recon_loss: 258569.1288; train_gene_expr_recon_loss: 59739.2489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322429.0722; train_optim_loss: 322429.0722; val_kl_reg_loss: 4080.8769; val_edge_recon_loss: 258403.3281; val_gene_expr_recon_loss: 59903.7651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322387.9732; val_optim_loss: 322387.9732
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9810; val_auprc_score: 0.9714; val_best_acc_score: 0.9536; val_best_f1_score: 0.9551; train_kl_reg_loss: 4123.5478; train_edge_recon_loss: 258666.7049; train_gene_expr_recon_loss: 59691.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322481.8499; train_optim_loss: 322481.8499; val_kl_reg_loss: 4088.6881; val_edge_recon_loss: 257648.9688; val_gene_expr_recon_loss: 60434.1440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322171.8036; val_optim_loss: 322171.8036
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9784; val_auprc_score: 0.9672; val_best_acc_score: 0.9512; val_best_f1_score: 0.9527; train_kl_reg_loss: 4130.6276; train_edge_recon_loss: 258534.4488; train_gene_expr_recon_loss: 59680.6018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322345.6793; train_optim_loss: 322345.6793; val_kl_reg_loss: 4072.2011; val_edge_recon_loss: 259266.6607; val_gene_expr_recon_loss: 60134.5742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323473.4330; val_optim_loss: 323473.4330

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9797; val_auprc_score: 0.9668; val_best_acc_score: 0.9526; val_best_f1_score: 0.9541; train_kl_reg_loss: 4112.2493; train_edge_recon_loss: 258509.2526; train_gene_expr_recon_loss: 59655.6513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322277.1496; train_optim_loss: 322277.1496; val_kl_reg_loss: 4072.7560; val_edge_recon_loss: 258400.9710; val_gene_expr_recon_loss: 60497.8292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322971.5491; val_optim_loss: 322971.5491
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9796; val_auprc_score: 0.9704; val_best_acc_score: 0.9551; val_best_f1_score: 0.9563; train_kl_reg_loss: 4115.6239; train_edge_recon_loss: 258153.8753; train_gene_expr_recon_loss: 59600.9339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321870.4324; train_optim_loss: 321870.4324; val_kl_reg_loss: 4086.5286; val_edge_recon_loss: 257845.7857; val_gene_expr_recon_loss: 59599.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321531.4062; val_optim_loss: 321531.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9817; val_auprc_score: 0.9727; val_best_acc_score: 0.9562; val_best_f1_score: 0.9575; train_kl_reg_loss: 4119.5351; train_edge_recon_loss: 258607.8576; train_gene_expr_recon_loss: 59556.7618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322284.1547; train_optim_loss: 322284.1547; val_kl_reg_loss: 4081.2403; val_edge_recon_loss: 257311.2812; val_gene_expr_recon_loss: 60861.2360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322253.7545; val_optim_loss: 322253.7545
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9790; val_auprc_score: 0.9677; val_best_acc_score: 0.9525; val_best_f1_score: 0.9543; train_kl_reg_loss: 4095.6425; train_edge_recon_loss: 258425.6104; train_gene_expr_recon_loss: 59604.2169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322125.4718; train_optim_loss: 322125.4718; val_kl_reg_loss: 3820.5522; val_edge_recon_loss: 257811.1161; val_gene_expr_recon_loss: 60505.2528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322136.9196; val_optim_loss: 322136.9196
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9774; val_auprc_score: 0.9662; val_best_acc_score: 0.9515; val_best_f1_score: 0.9531; train_kl_reg_loss: 4043.6387; train_edge_recon_loss: 258374.2702; train_gene_expr_recon_loss: 59651.1701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322069.0774; train_optim_loss: 322069.0774; val_kl_reg_loss: 3772.3946; val_edge_recon_loss: 258593.5759; val_gene_expr_recon_loss: 60371.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322737.8482; val_optim_loss: 322737.8482

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9784; val_auprc_score: 0.9660; val_best_acc_score: 0.9530; val_best_f1_score: 0.9546; train_kl_reg_loss: 4017.4552; train_edge_recon_loss: 258358.6365; train_gene_expr_recon_loss: 59588.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321964.2172; train_optim_loss: 321964.2172; val_kl_reg_loss: 3767.5495; val_edge_recon_loss: 258306.2188; val_gene_expr_recon_loss: 60033.0491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322106.8259; val_optim_loss: 322106.8259
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9781; val_auprc_score: 0.9670; val_best_acc_score: 0.9535; val_best_f1_score: 0.9550; train_kl_reg_loss: 4013.0819; train_edge_recon_loss: 258146.9124; train_gene_expr_recon_loss: 59656.3415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321816.3376; train_optim_loss: 321816.3376; val_kl_reg_loss: 3761.8100; val_edge_recon_loss: 257906.4799; val_gene_expr_recon_loss: 59939.9286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321608.2188; val_optim_loss: 321608.2188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9805; val_auprc_score: 0.9710; val_best_acc_score: 0.9557; val_best_f1_score: 0.9570; train_kl_reg_loss: 4007.5706; train_edge_recon_loss: 258416.2277; train_gene_expr_recon_loss: 59598.4632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322022.2592; train_optim_loss: 322022.2592; val_kl_reg_loss: 3759.9682; val_edge_recon_loss: 257809.4018; val_gene_expr_recon_loss: 59505.6194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321074.9911; val_optim_loss: 321074.9911
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9770; val_auprc_score: 0.9648; val_best_acc_score: 0.9511; val_best_f1_score: 0.9530; train_kl_reg_loss: 4002.9277; train_edge_recon_loss: 258742.9147; train_gene_expr_recon_loss: 59617.6323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322363.4754; train_optim_loss: 322363.4754; val_kl_reg_loss: 3757.1986; val_edge_recon_loss: 258615.2388; val_gene_expr_recon_loss: 60700.0485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323072.4821; val_optim_loss: 323072.4821
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9785; val_auprc_score: 0.9670; val_best_acc_score: 0.9541; val_best_f1_score: 0.9558; train_kl_reg_loss: 3997.6445; train_edge_recon_loss: 258261.2987; train_gene_expr_recon_loss: 59569.9664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321828.9114; train_optim_loss: 321828.9114; val_kl_reg_loss: 3745.6275; val_edge_recon_loss: 258146.8415; val_gene_expr_recon_loss: 60449.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322341.5491; val_optim_loss: 322341.5491
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9789; val_auprc_score: 0.9667; val_best_acc_score: 0.9527; val_best_f1_score: 0.9544; train_kl_reg_loss: 3992.4604; train_edge_recon_loss: 258274.7989; train_gene_expr_recon_loss: 59552.0685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321819.3284; train_optim_loss: 321819.3284; val_kl_reg_loss: 3750.7355; val_edge_recon_loss: 258834.8058; val_gene_expr_recon_loss: 60254.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322840.2143; val_optim_loss: 322840.2143

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9782; val_auprc_score: 0.9678; val_best_acc_score: 0.9528; val_best_f1_score: 0.9543; train_kl_reg_loss: 3989.2788; train_edge_recon_loss: 257945.6844; train_gene_expr_recon_loss: 59663.2445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321598.2100; train_optim_loss: 321598.2100; val_kl_reg_loss: 3738.5427; val_edge_recon_loss: 257986.3951; val_gene_expr_recon_loss: 60227.2182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321952.1562; val_optim_loss: 321952.1562
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9786; val_auprc_score: 0.9664; val_best_acc_score: 0.9530; val_best_f1_score: 0.9547; train_kl_reg_loss: 3988.0365; train_edge_recon_loss: 258083.8445; train_gene_expr_recon_loss: 59672.1233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321744.0031; train_optim_loss: 321744.0031; val_kl_reg_loss: 3750.6378; val_edge_recon_loss: 258311.8237; val_gene_expr_recon_loss: 60501.3365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322563.7991; val_optim_loss: 322563.7991
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9777; val_auprc_score: 0.9660; val_best_acc_score: 0.9527; val_best_f1_score: 0.9542; train_kl_reg_loss: 3988.6838; train_edge_recon_loss: 258065.7154; train_gene_expr_recon_loss: 59564.5031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321618.9011; train_optim_loss: 321618.9011; val_kl_reg_loss: 3738.7482; val_edge_recon_loss: 258800.7991; val_gene_expr_recon_loss: 60025.5201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322565.0625; val_optim_loss: 322565.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 36 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9806
Val AUPRC score: 0.9708
Val best accuracy score: 0.9564
Val best F1 score: 0.9579
Val gene expr MSE score: 0.0095
Duration of model training in run 6: 0 hours, 5 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 81747
Number of validation edges: 9082
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9452; val_auprc_score: 0.9224; val_best_acc_score: 0.8885; val_best_f1_score: 0.8936; train_kl_reg_loss: 3930.9880; train_edge_recon_loss: 293465.0782; train_gene_expr_recon_loss: 66331.1533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363727.2188; train_optim_loss: 363727.2188; val_kl_reg_loss: 4262.5047; val_edge_recon_loss: 267609.9149; val_gene_expr_recon_loss: 64171.8236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336044.2431; val_optim_loss: 336044.2431
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9597; val_auprc_score: 0.9386; val_best_acc_score: 0.9152; val_best_f1_score: 0.9182; train_kl_reg_loss: 4188.5805; train_edge_recon_loss: 265943.6117; train_gene_expr_recon_loss: 64190.0886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334322.2828; train_optim_loss: 334322.2828; val_kl_reg_loss: 4245.4702; val_edge_recon_loss: 263689.6293; val_gene_expr_recon_loss: 62680.8557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330615.9514; val_optim_loss: 330615.9514
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9719; val_auprc_score: 0.9579; val_best_acc_score: 0.9370; val_best_f1_score: 0.9393; train_kl_reg_loss: 4228.5121; train_edge_recon_loss: 261921.0022; train_gene_expr_recon_loss: 63251.0849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329400.6008; train_optim_loss: 329400.6008; val_kl_reg_loss: 4170.6279; val_edge_recon_loss: 261649.4010; val_gene_expr_recon_loss: 62012.6387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327832.6684; val_optim_loss: 327832.6684
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9753; val_auprc_score: 0.9613; val_best_acc_score: 0.9435; val_best_f1_score: 0.9452; train_kl_reg_loss: 4179.4942; train_edge_recon_loss: 260666.0632; train_gene_expr_recon_loss: 62285.5564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327131.1152; train_optim_loss: 327131.1152; val_kl_reg_loss: 4127.3572; val_edge_recon_loss: 258694.0547; val_gene_expr_recon_loss: 61514.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324335.4306; val_optim_loss: 324335.4306
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9748; val_auprc_score: 0.9623; val_best_acc_score: 0.9459; val_best_f1_score: 0.9480; train_kl_reg_loss: 4160.2399; train_edge_recon_loss: 259709.4770; train_gene_expr_recon_loss: 61629.1937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325498.9086; train_optim_loss: 325498.9086; val_kl_reg_loss: 4146.4657; val_edge_recon_loss: 258995.1345; val_gene_expr_recon_loss: 60787.9616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323929.5642; val_optim_loss: 323929.5642
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9750; val_auprc_score: 0.9604; val_best_acc_score: 0.9462; val_best_f1_score: 0.9483; train_kl_reg_loss: 4143.9551; train_edge_recon_loss: 259459.5537; train_gene_expr_recon_loss: 61059.1278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324662.6354; train_optim_loss: 324662.6354; val_kl_reg_loss: 4047.5425; val_edge_recon_loss: 259587.3663; val_gene_expr_recon_loss: 59892.8683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323527.7778; val_optim_loss: 323527.7778
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9786; val_auprc_score: 0.9689; val_best_acc_score: 0.9507; val_best_f1_score: 0.9525; train_kl_reg_loss: 4122.6336; train_edge_recon_loss: 259307.8001; train_gene_expr_recon_loss: 60637.7726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324068.2053; train_optim_loss: 324068.2053; val_kl_reg_loss: 4076.6624; val_edge_recon_loss: 258525.8220; val_gene_expr_recon_loss: 59751.9123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322354.4010; val_optim_loss: 322354.4010
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9769; val_auprc_score: 0.9652; val_best_acc_score: 0.9490; val_best_f1_score: 0.9510; train_kl_reg_loss: 4117.5775; train_edge_recon_loss: 258773.1906; train_gene_expr_recon_loss: 60161.2349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323052.0033; train_optim_loss: 323052.0033; val_kl_reg_loss: 4101.5175; val_edge_recon_loss: 258798.3793; val_gene_expr_recon_loss: 59589.6536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322489.5486; val_optim_loss: 322489.5486
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9789; val_auprc_score: 0.9685; val_best_acc_score: 0.9517; val_best_f1_score: 0.9533; train_kl_reg_loss: 4115.9651; train_edge_recon_loss: 258931.1522; train_gene_expr_recon_loss: 59817.5104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322864.6293; train_optim_loss: 322864.6293; val_kl_reg_loss: 4136.3101; val_edge_recon_loss: 257810.9696; val_gene_expr_recon_loss: 59160.5206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321107.8003; val_optim_loss: 321107.8003
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9801; val_auprc_score: 0.9712; val_best_acc_score: 0.9515; val_best_f1_score: 0.9530; train_kl_reg_loss: 4118.9573; train_edge_recon_loss: 258391.3262; train_gene_expr_recon_loss: 59565.5698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322075.8523; train_optim_loss: 322075.8523; val_kl_reg_loss: 4076.9051; val_edge_recon_loss: 258393.6250; val_gene_expr_recon_loss: 58789.0592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321259.5920; val_optim_loss: 321259.5920
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9815; val_auprc_score: 0.9751; val_best_acc_score: 0.9546; val_best_f1_score: 0.9562; train_kl_reg_loss: 4111.2783; train_edge_recon_loss: 258603.8090; train_gene_expr_recon_loss: 59203.1372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321918.2262; train_optim_loss: 321918.2262; val_kl_reg_loss: 4044.7317; val_edge_recon_loss: 258047.4627; val_gene_expr_recon_loss: 58720.6300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320812.8264; val_optim_loss: 320812.8264
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9814; val_auprc_score: 0.9728; val_best_acc_score: 0.9575; val_best_f1_score: 0.9588; train_kl_reg_loss: 4100.4098; train_edge_recon_loss: 258457.1749; train_gene_expr_recon_loss: 59038.0399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321595.6250; train_optim_loss: 321595.6250; val_kl_reg_loss: 4077.0932; val_edge_recon_loss: 257332.8385; val_gene_expr_recon_loss: 58605.8418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320015.7726; val_optim_loss: 320015.7726
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9811; val_auprc_score: 0.9710; val_best_acc_score: 0.9569; val_best_f1_score: 0.9585; train_kl_reg_loss: 4109.8792; train_edge_recon_loss: 258003.8391; train_gene_expr_recon_loss: 58744.9267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320858.6445; train_optim_loss: 320858.6445; val_kl_reg_loss: 3998.2418; val_edge_recon_loss: 258100.6111; val_gene_expr_recon_loss: 58264.2906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320363.1458; val_optim_loss: 320363.1458
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9846; val_auprc_score: 0.9774; val_best_acc_score: 0.9618; val_best_f1_score: 0.9628; train_kl_reg_loss: 4105.4468; train_edge_recon_loss: 257965.5186; train_gene_expr_recon_loss: 58673.4588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320744.4242; train_optim_loss: 320744.4242; val_kl_reg_loss: 4097.0862; val_edge_recon_loss: 257621.9123; val_gene_expr_recon_loss: 58176.6788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319895.6753; val_optim_loss: 319895.6753
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9860; val_auprc_score: 0.9780; val_best_acc_score: 0.9640; val_best_f1_score: 0.9651; train_kl_reg_loss: 4113.7327; train_edge_recon_loss: 257769.6923; train_gene_expr_recon_loss: 58550.0099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320433.4344; train_optim_loss: 320433.4344; val_kl_reg_loss: 4127.4449; val_edge_recon_loss: 256891.5599; val_gene_expr_recon_loss: 58088.9763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319107.9757; val_optim_loss: 319107.9757
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9866; val_auprc_score: 0.9802; val_best_acc_score: 0.9640; val_best_f1_score: 0.9650; train_kl_reg_loss: 4117.3248; train_edge_recon_loss: 257628.2546; train_gene_expr_recon_loss: 58345.9691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320091.5475; train_optim_loss: 320091.5475; val_kl_reg_loss: 4284.3177; val_edge_recon_loss: 256392.1337; val_gene_expr_recon_loss: 57599.7613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318276.2135; val_optim_loss: 318276.2135
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9866; val_auprc_score: 0.9813; val_best_acc_score: 0.9651; val_best_f1_score: 0.9660; train_kl_reg_loss: 4122.6436; train_edge_recon_loss: 257470.6726; train_gene_expr_recon_loss: 58115.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319708.7955; train_optim_loss: 319708.7955; val_kl_reg_loss: 4138.8902; val_edge_recon_loss: 256630.6033; val_gene_expr_recon_loss: 57954.2274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318723.7205; val_optim_loss: 318723.7205
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9861; val_auprc_score: 0.9797; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 4126.4435; train_edge_recon_loss: 257117.4934; train_gene_expr_recon_loss: 58075.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319319.7777; train_optim_loss: 319319.7777; val_kl_reg_loss: 4172.1491; val_edge_recon_loss: 256301.0069; val_gene_expr_recon_loss: 57344.8268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317817.9826; val_optim_loss: 317817.9826
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9878; val_auprc_score: 0.9816; val_best_acc_score: 0.9685; val_best_f1_score: 0.9691; train_kl_reg_loss: 4114.2503; train_edge_recon_loss: 257608.6662; train_gene_expr_recon_loss: 57893.9188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319616.8365; train_optim_loss: 319616.8365; val_kl_reg_loss: 4132.6318; val_edge_recon_loss: 256444.8594; val_gene_expr_recon_loss: 57435.6821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318013.1736; val_optim_loss: 318013.1736
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9883; val_auprc_score: 0.9822; val_best_acc_score: 0.9686; val_best_f1_score: 0.9694; train_kl_reg_loss: 4116.3685; train_edge_recon_loss: 257581.2525; train_gene_expr_recon_loss: 57814.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319511.9596; train_optim_loss: 319511.9596; val_kl_reg_loss: 4112.6690; val_edge_recon_loss: 256958.5773; val_gene_expr_recon_loss: 57692.0749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318763.3229; val_optim_loss: 318763.3229
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9885; val_auprc_score: 0.9834; val_best_acc_score: 0.9691; val_best_f1_score: 0.9698; train_kl_reg_loss: 4128.8513; train_edge_recon_loss: 256927.9196; train_gene_expr_recon_loss: 57718.6879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318775.4578; train_optim_loss: 318775.4578; val_kl_reg_loss: 4184.6485; val_edge_recon_loss: 256477.5503; val_gene_expr_recon_loss: 57353.3887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318015.5851; val_optim_loss: 318015.5851

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9877; val_auprc_score: 0.9801; val_best_acc_score: 0.9674; val_best_f1_score: 0.9683; train_kl_reg_loss: 4130.4080; train_edge_recon_loss: 256813.8588; train_gene_expr_recon_loss: 57513.7014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318457.9666; train_optim_loss: 318457.9666; val_kl_reg_loss: 4109.2502; val_edge_recon_loss: 256809.8689; val_gene_expr_recon_loss: 57251.6252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318170.7431; val_optim_loss: 318170.7431
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9887; val_auprc_score: 0.9834; val_best_acc_score: 0.9705; val_best_f1_score: 0.9712; train_kl_reg_loss: 4115.7540; train_edge_recon_loss: 257063.4173; train_gene_expr_recon_loss: 57462.6357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318641.8082; train_optim_loss: 318641.8082; val_kl_reg_loss: 4109.6613; val_edge_recon_loss: 256072.3845; val_gene_expr_recon_loss: 57229.9629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317412.0069; val_optim_loss: 317412.0069
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9881; val_auprc_score: 0.9815; val_best_acc_score: 0.9685; val_best_f1_score: 0.9692; train_kl_reg_loss: 4112.7776; train_edge_recon_loss: 256958.3957; train_gene_expr_recon_loss: 57435.3983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318506.5703; train_optim_loss: 318506.5703; val_kl_reg_loss: 4094.0019; val_edge_recon_loss: 256745.8003; val_gene_expr_recon_loss: 57509.7205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318349.5208; val_optim_loss: 318349.5208
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9893; val_auprc_score: 0.9814; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 4117.1506; train_edge_recon_loss: 256793.4929; train_gene_expr_recon_loss: 57409.8423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318320.4857; train_optim_loss: 318320.4857; val_kl_reg_loss: 4109.0291; val_edge_recon_loss: 255615.3524; val_gene_expr_recon_loss: 57352.8353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317077.2188; val_optim_loss: 317077.2188
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9878; val_auprc_score: 0.9819; val_best_acc_score: 0.9684; val_best_f1_score: 0.9691; train_kl_reg_loss: 3809.7791; train_edge_recon_loss: 256923.2241; train_gene_expr_recon_loss: 57540.8971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318273.9006; train_optim_loss: 318273.9006; val_kl_reg_loss: 3355.1149; val_edge_recon_loss: 256903.3108; val_gene_expr_recon_loss: 57239.8500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317498.2726; val_optim_loss: 317498.2726
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9882; val_auprc_score: 0.9812; val_best_acc_score: 0.9708; val_best_f1_score: 0.9713; train_kl_reg_loss: 3415.2662; train_edge_recon_loss: 256639.4311; train_gene_expr_recon_loss: 57467.2804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317521.9787; train_optim_loss: 317521.9787; val_kl_reg_loss: 3001.9408; val_edge_recon_loss: 256447.2786; val_gene_expr_recon_loss: 57262.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316711.7587; val_optim_loss: 316711.7587
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9884; val_auprc_score: 0.9838; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 3201.4991; train_edge_recon_loss: 256394.2250; train_gene_expr_recon_loss: 57537.6228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317133.3479; train_optim_loss: 317133.3479; val_kl_reg_loss: 2897.0739; val_edge_recon_loss: 257545.9896; val_gene_expr_recon_loss: 57366.0163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317809.0781; val_optim_loss: 317809.0781
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9879; val_auprc_score: 0.9798; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 3137.7482; train_edge_recon_loss: 256308.1999; train_gene_expr_recon_loss: 57474.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316920.6564; train_optim_loss: 316920.6564; val_kl_reg_loss: 2911.4043; val_edge_recon_loss: 256010.8741; val_gene_expr_recon_loss: 56832.0202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315754.2986; val_optim_loss: 315754.2986
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9886; val_auprc_score: 0.9813; val_best_acc_score: 0.9702; val_best_f1_score: 0.9708; train_kl_reg_loss: 3122.3946; train_edge_recon_loss: 256543.7228; train_gene_expr_recon_loss: 57407.7440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317073.8607; train_optim_loss: 317073.8607; val_kl_reg_loss: 2887.2492; val_edge_recon_loss: 255895.0851; val_gene_expr_recon_loss: 57207.2029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315989.5382; val_optim_loss: 315989.5382
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9877; val_auprc_score: 0.9813; val_best_acc_score: 0.9703; val_best_f1_score: 0.9710; train_kl_reg_loss: 3102.0974; train_edge_recon_loss: 256583.2305; train_gene_expr_recon_loss: 57517.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317202.6424; train_optim_loss: 317202.6424; val_kl_reg_loss: 2904.6923; val_edge_recon_loss: 256753.4583; val_gene_expr_recon_loss: 57524.4158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317182.5660; val_optim_loss: 317182.5660
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9888; val_auprc_score: 0.9815; val_best_acc_score: 0.9718; val_best_f1_score: 0.9723; train_kl_reg_loss: 3089.2643; train_edge_recon_loss: 256425.5395; train_gene_expr_recon_loss: 57418.3541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316933.1570; train_optim_loss: 316933.1570; val_kl_reg_loss: 2895.6297; val_edge_recon_loss: 255606.5712; val_gene_expr_recon_loss: 57304.5584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315806.7587; val_optim_loss: 315806.7587

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9880; val_auprc_score: 0.9803; val_best_acc_score: 0.9709; val_best_f1_score: 0.9715; train_kl_reg_loss: 3086.7514; train_edge_recon_loss: 256297.6305; train_gene_expr_recon_loss: 57420.9329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316805.3145; train_optim_loss: 316805.3145; val_kl_reg_loss: 2885.3573; val_edge_recon_loss: 255638.7491; val_gene_expr_recon_loss: 57346.9266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315871.0347; val_optim_loss: 315871.0347
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9888; val_auprc_score: 0.9832; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 3079.1023; train_edge_recon_loss: 256264.9021; train_gene_expr_recon_loss: 57400.7186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316744.7242; train_optim_loss: 316744.7242; val_kl_reg_loss: 2889.2941; val_edge_recon_loss: 255905.8915; val_gene_expr_recon_loss: 57317.7361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316112.9236; val_optim_loss: 316112.9236
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9883; val_auprc_score: 0.9813; val_best_acc_score: 0.9719; val_best_f1_score: 0.9724; train_kl_reg_loss: 3083.2484; train_edge_recon_loss: 256222.1969; train_gene_expr_recon_loss: 57484.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316790.2133; train_optim_loss: 316790.2133; val_kl_reg_loss: 2895.5338; val_edge_recon_loss: 256101.8220; val_gene_expr_recon_loss: 57444.2691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316441.6198; val_optim_loss: 316441.6198

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 38 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9878
Val AUPRC score: 0.9809
Val best accuracy score: 0.9702
Val best F1 score: 0.9709
Val gene expr MSE score: 0.0094
Duration of model training in run 7: 0 hours, 11 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 81747
Number of validation edges: 9082
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9400; val_auprc_score: 0.9206; val_best_acc_score: 0.8817; val_best_f1_score: 0.8889; train_kl_reg_loss: 3920.6807; train_edge_recon_loss: 296601.3661; train_gene_expr_recon_loss: 66042.4232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366564.4678; train_optim_loss: 366564.4678; val_kl_reg_loss: 4013.9414; val_edge_recon_loss: 268016.2031; val_gene_expr_recon_loss: 64707.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336737.3524; val_optim_loss: 336737.3524
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9619; val_auprc_score: 0.9439; val_best_acc_score: 0.9174; val_best_f1_score: 0.9216; train_kl_reg_loss: 4166.7048; train_edge_recon_loss: 265728.8637; train_gene_expr_recon_loss: 63686.9828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333582.5512; train_optim_loss: 333582.5512; val_kl_reg_loss: 4130.5125; val_edge_recon_loss: 262779.4236; val_gene_expr_recon_loss: 63787.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330697.8854; val_optim_loss: 330697.8854
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9715; val_auprc_score: 0.9557; val_best_acc_score: 0.9384; val_best_f1_score: 0.9409; train_kl_reg_loss: 4168.0882; train_edge_recon_loss: 262554.0091; train_gene_expr_recon_loss: 62758.8410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329480.9385; train_optim_loss: 329480.9385; val_kl_reg_loss: 4141.7966; val_edge_recon_loss: 260958.1016; val_gene_expr_recon_loss: 63086.2096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328186.1042; val_optim_loss: 328186.1042
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9746; val_auprc_score: 0.9642; val_best_acc_score: 0.9407; val_best_f1_score: 0.9429; train_kl_reg_loss: 4190.0383; train_edge_recon_loss: 260337.9819; train_gene_expr_recon_loss: 61934.2638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326462.2844; train_optim_loss: 326462.2844; val_kl_reg_loss: 4145.0280; val_edge_recon_loss: 259045.5512; val_gene_expr_recon_loss: 61849.5796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325040.1597; val_optim_loss: 325040.1597
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9751; val_auprc_score: 0.9626; val_best_acc_score: 0.9453; val_best_f1_score: 0.9473; train_kl_reg_loss: 4168.9356; train_edge_recon_loss: 259417.5791; train_gene_expr_recon_loss: 61309.5513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324896.0654; train_optim_loss: 324896.0654; val_kl_reg_loss: 4051.2480; val_edge_recon_loss: 258316.6016; val_gene_expr_recon_loss: 61406.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323774.5990; val_optim_loss: 323774.5990
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9764; val_auprc_score: 0.9655; val_best_acc_score: 0.9443; val_best_f1_score: 0.9465; train_kl_reg_loss: 4144.0399; train_edge_recon_loss: 258818.0048; train_gene_expr_recon_loss: 60812.0437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323774.0869; train_optim_loss: 323774.0869; val_kl_reg_loss: 4232.2139; val_edge_recon_loss: 258811.7743; val_gene_expr_recon_loss: 61041.2693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324085.2535; val_optim_loss: 324085.2535
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9767; val_auprc_score: 0.9678; val_best_acc_score: 0.9445; val_best_f1_score: 0.9464; train_kl_reg_loss: 4129.8286; train_edge_recon_loss: 258915.9330; train_gene_expr_recon_loss: 60293.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323339.5172; train_optim_loss: 323339.5172; val_kl_reg_loss: 4095.9820; val_edge_recon_loss: 258986.3889; val_gene_expr_recon_loss: 60635.7270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323718.0972; val_optim_loss: 323718.0972
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9775; val_auprc_score: 0.9677; val_best_acc_score: 0.9484; val_best_f1_score: 0.9501; train_kl_reg_loss: 4110.4470; train_edge_recon_loss: 258969.0221; train_gene_expr_recon_loss: 59900.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322980.4068; train_optim_loss: 322980.4068; val_kl_reg_loss: 4094.5731; val_edge_recon_loss: 257743.8229; val_gene_expr_recon_loss: 60267.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322105.6597; val_optim_loss: 322105.6597
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9782; val_auprc_score: 0.9680; val_best_acc_score: 0.9498; val_best_f1_score: 0.9514; train_kl_reg_loss: 4111.1419; train_edge_recon_loss: 258708.2527; train_gene_expr_recon_loss: 59601.7495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322421.1434; train_optim_loss: 322421.1434; val_kl_reg_loss: 4119.1163; val_edge_recon_loss: 257770.3290; val_gene_expr_recon_loss: 60073.9957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321963.4410; val_optim_loss: 321963.4410
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9796; val_auprc_score: 0.9695; val_best_acc_score: 0.9533; val_best_f1_score: 0.9547; train_kl_reg_loss: 4107.3667; train_edge_recon_loss: 258481.5123; train_gene_expr_recon_loss: 59316.7982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321905.6771; train_optim_loss: 321905.6771; val_kl_reg_loss: 4155.8409; val_edge_recon_loss: 257639.6832; val_gene_expr_recon_loss: 59770.5152; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321566.0365; val_optim_loss: 321566.0365
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9777; val_auprc_score: 0.9654; val_best_acc_score: 0.9527; val_best_f1_score: 0.9542; train_kl_reg_loss: 4110.5393; train_edge_recon_loss: 258321.5788; train_gene_expr_recon_loss: 58964.8425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321396.9594; train_optim_loss: 321396.9594; val_kl_reg_loss: 3996.5814; val_edge_recon_loss: 258343.9080; val_gene_expr_recon_loss: 59962.9668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322303.4514; val_optim_loss: 322303.4514
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9832; val_auprc_score: 0.9757; val_best_acc_score: 0.9575; val_best_f1_score: 0.9589; train_kl_reg_loss: 4111.6329; train_edge_recon_loss: 258221.7936; train_gene_expr_recon_loss: 58811.5592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321144.9840; train_optim_loss: 321144.9840; val_kl_reg_loss: 4123.4284; val_edge_recon_loss: 256895.0885; val_gene_expr_recon_loss: 59572.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320591.1007; val_optim_loss: 320591.1007
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9818; val_auprc_score: 0.9741; val_best_acc_score: 0.9596; val_best_f1_score: 0.9610; train_kl_reg_loss: 4106.6436; train_edge_recon_loss: 258334.4825; train_gene_expr_recon_loss: 58605.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321046.2164; train_optim_loss: 321046.2164; val_kl_reg_loss: 4047.3536; val_edge_recon_loss: 257202.7691; val_gene_expr_recon_loss: 59400.0595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320650.1788; val_optim_loss: 320650.1788
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9838; val_auprc_score: 0.9760; val_best_acc_score: 0.9594; val_best_f1_score: 0.9605; train_kl_reg_loss: 4111.7316; train_edge_recon_loss: 257718.0336; train_gene_expr_recon_loss: 58442.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320272.0572; train_optim_loss: 320272.0572; val_kl_reg_loss: 4017.2105; val_edge_recon_loss: 257303.6719; val_gene_expr_recon_loss: 58904.6513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320225.5347; val_optim_loss: 320225.5347
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9859; val_auprc_score: 0.9786; val_best_acc_score: 0.9634; val_best_f1_score: 0.9644; train_kl_reg_loss: 4104.9805; train_edge_recon_loss: 257940.0662; train_gene_expr_recon_loss: 58216.6419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320261.6873; train_optim_loss: 320261.6873; val_kl_reg_loss: 4045.2098; val_edge_recon_loss: 256278.4210; val_gene_expr_recon_loss: 58690.0981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319013.7257; val_optim_loss: 319013.7257
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9845; val_auprc_score: 0.9772; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 4110.3227; train_edge_recon_loss: 257624.4931; train_gene_expr_recon_loss: 58136.7274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319871.5418; train_optim_loss: 319871.5418; val_kl_reg_loss: 4107.7554; val_edge_recon_loss: 257630.3733; val_gene_expr_recon_loss: 58585.5282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320323.6615; val_optim_loss: 320323.6615
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9876; val_auprc_score: 0.9809; val_best_acc_score: 0.9661; val_best_f1_score: 0.9669; train_kl_reg_loss: 4112.6903; train_edge_recon_loss: 257412.2594; train_gene_expr_recon_loss: 58137.0498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319661.9992; train_optim_loss: 319661.9992; val_kl_reg_loss: 4052.0822; val_edge_recon_loss: 256563.8915; val_gene_expr_recon_loss: 58518.3574; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319134.3333; val_optim_loss: 319134.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9870; val_auprc_score: 0.9814; val_best_acc_score: 0.9656; val_best_f1_score: 0.9663; train_kl_reg_loss: 4122.2616; train_edge_recon_loss: 257230.2053; train_gene_expr_recon_loss: 57916.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319268.5281; train_optim_loss: 319268.5281; val_kl_reg_loss: 4090.4199; val_edge_recon_loss: 257192.3012; val_gene_expr_recon_loss: 58368.2010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319650.9219; val_optim_loss: 319650.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9860; val_auprc_score: 0.9791; val_best_acc_score: 0.9656; val_best_f1_score: 0.9664; train_kl_reg_loss: 4103.0435; train_edge_recon_loss: 257365.7188; train_gene_expr_recon_loss: 57639.6097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319108.3721; train_optim_loss: 319108.3721; val_kl_reg_loss: 4095.4215; val_edge_recon_loss: 257428.1519; val_gene_expr_recon_loss: 58281.9069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319805.4792; val_optim_loss: 319805.4792
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9871; val_auprc_score: 0.9816; val_best_acc_score: 0.9654; val_best_f1_score: 0.9662; train_kl_reg_loss: 4111.2271; train_edge_recon_loss: 257412.9909; train_gene_expr_recon_loss: 57561.0045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319085.2230; train_optim_loss: 319085.2230; val_kl_reg_loss: 4083.7883; val_edge_recon_loss: 257086.4132; val_gene_expr_recon_loss: 58428.5462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319598.7500; val_optim_loss: 319598.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9876; val_auprc_score: 0.9816; val_best_acc_score: 0.9672; val_best_f1_score: 0.9678; train_kl_reg_loss: 4103.2087; train_edge_recon_loss: 257055.8479; train_gene_expr_recon_loss: 57558.6083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318717.6645; train_optim_loss: 318717.6645; val_kl_reg_loss: 4083.2877; val_edge_recon_loss: 256318.8194; val_gene_expr_recon_loss: 58305.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318707.2812; val_optim_loss: 318707.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9863; val_auprc_score: 0.9784; val_best_acc_score: 0.9672; val_best_f1_score: 0.9679; train_kl_reg_loss: 4107.1504; train_edge_recon_loss: 257097.9100; train_gene_expr_recon_loss: 57608.3726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318813.4322; train_optim_loss: 318813.4322; val_kl_reg_loss: 4076.1620; val_edge_recon_loss: 256867.7161; val_gene_expr_recon_loss: 58276.2320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319220.1059; val_optim_loss: 319220.1059
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9872; val_auprc_score: 0.9814; val_best_acc_score: 0.9667; val_best_f1_score: 0.9674; train_kl_reg_loss: 4119.0753; train_edge_recon_loss: 256836.8959; train_gene_expr_recon_loss: 57495.5635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318451.5354; train_optim_loss: 318451.5354; val_kl_reg_loss: 4111.6416; val_edge_recon_loss: 257256.4401; val_gene_expr_recon_loss: 58470.2038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319838.2847; val_optim_loss: 319838.2847
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9880; val_auprc_score: 0.9818; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 4105.1680; train_edge_recon_loss: 256999.5767; train_gene_expr_recon_loss: 57449.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318554.5707; train_optim_loss: 318554.5707; val_kl_reg_loss: 4096.0840; val_edge_recon_loss: 256532.6562; val_gene_expr_recon_loss: 58535.9546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319164.6927; val_optim_loss: 319164.6927

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9891; val_auprc_score: 0.9844; val_best_acc_score: 0.9702; val_best_f1_score: 0.9708; train_kl_reg_loss: 4103.2170; train_edge_recon_loss: 257179.9090; train_gene_expr_recon_loss: 57560.6490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318843.7746; train_optim_loss: 318843.7746; val_kl_reg_loss: 4107.5867; val_edge_recon_loss: 255306.9245; val_gene_expr_recon_loss: 58310.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317724.7986; val_optim_loss: 317724.7986
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9878; val_auprc_score: 0.9824; val_best_acc_score: 0.9681; val_best_f1_score: 0.9688; train_kl_reg_loss: 4056.1240; train_edge_recon_loss: 256791.8956; train_gene_expr_recon_loss: 57569.2650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318417.2840; train_optim_loss: 318417.2840; val_kl_reg_loss: 3740.1494; val_edge_recon_loss: 256067.9488; val_gene_expr_recon_loss: 58127.8468; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317935.9444; val_optim_loss: 317935.9444
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9873; val_auprc_score: 0.9784; val_best_acc_score: 0.9680; val_best_f1_score: 0.9687; train_kl_reg_loss: 3972.2696; train_edge_recon_loss: 257161.0887; train_gene_expr_recon_loss: 57552.8199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318686.1781; train_optim_loss: 318686.1781; val_kl_reg_loss: 3667.7743; val_edge_recon_loss: 255629.0035; val_gene_expr_recon_loss: 58471.1528; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317767.9340; val_optim_loss: 317767.9340
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9862; val_auprc_score: 0.9788; val_best_acc_score: 0.9664; val_best_f1_score: 0.9672; train_kl_reg_loss: 3901.3055; train_edge_recon_loss: 257230.9537; train_gene_expr_recon_loss: 57513.7601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318646.0174; train_optim_loss: 318646.0174; val_kl_reg_loss: 3612.7959; val_edge_recon_loss: 256769.8646; val_gene_expr_recon_loss: 58436.8388; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318819.5000; val_optim_loss: 318819.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9869; val_auprc_score: 0.9801; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 3873.6786; train_edge_recon_loss: 257201.5749; train_gene_expr_recon_loss: 57551.9400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318627.1926; train_optim_loss: 318627.1926; val_kl_reg_loss: 3606.3128; val_edge_recon_loss: 255997.6710; val_gene_expr_recon_loss: 58519.0673; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318123.0486; val_optim_loss: 318123.0486
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9859; val_auprc_score: 0.9783; val_best_acc_score: 0.9663; val_best_f1_score: 0.9671; train_kl_reg_loss: 3869.7681; train_edge_recon_loss: 256956.0978; train_gene_expr_recon_loss: 57519.1931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318345.0586; train_optim_loss: 318345.0586; val_kl_reg_loss: 3600.3305; val_edge_recon_loss: 257745.5781; val_gene_expr_recon_loss: 58397.9293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319743.8333; val_optim_loss: 319743.8333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9882; val_auprc_score: 0.9829; val_best_acc_score: 0.9675; val_best_f1_score: 0.9682; train_kl_reg_loss: 3863.5041; train_edge_recon_loss: 256963.1466; train_gene_expr_recon_loss: 57620.1353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318446.7855; train_optim_loss: 318446.7855; val_kl_reg_loss: 3594.0888; val_edge_recon_loss: 256382.2083; val_gene_expr_recon_loss: 58657.6632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318633.9601; val_optim_loss: 318633.9601

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 44 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9866
Val AUPRC score: 0.9795
Val best accuracy score: 0.9661
Val best F1 score: 0.9669
Val gene expr MSE score: 0.0093
Duration of model training in run 8: 0 hours, 9 minutes and 56 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 101700
Number of validation edges: 11300
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9558; val_auprc_score: 0.9396; val_best_acc_score: 0.9070; val_best_f1_score: 0.9108; train_kl_reg_loss: 3910.9558; train_edge_recon_loss: 280472.7799; train_gene_expr_recon_loss: 65893.9761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350277.7106; train_optim_loss: 350277.7106; val_kl_reg_loss: 3969.7716; val_edge_recon_loss: 265271.9819; val_gene_expr_recon_loss: 64351.0925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333592.8486; val_optim_loss: 333592.8486
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9749; val_auprc_score: 0.9641; val_best_acc_score: 0.9415; val_best_f1_score: 0.9430; train_kl_reg_loss: 4161.7298; train_edge_recon_loss: 262592.8036; train_gene_expr_recon_loss: 62932.9526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329687.4878; train_optim_loss: 329687.4878; val_kl_reg_loss: 4215.1254; val_edge_recon_loss: 260157.8799; val_gene_expr_recon_loss: 62633.2381; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327006.2417; val_optim_loss: 327006.2417
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9782; val_auprc_score: 0.9679; val_best_acc_score: 0.9470; val_best_f1_score: 0.9488; train_kl_reg_loss: 4153.0998; train_edge_recon_loss: 259821.4605; train_gene_expr_recon_loss: 61354.7494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325329.3082; train_optim_loss: 325329.3082; val_kl_reg_loss: 4097.8316; val_edge_recon_loss: 258417.0059; val_gene_expr_recon_loss: 61170.0789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323684.9153; val_optim_loss: 323684.9153
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9788; val_auprc_score: 0.9685; val_best_acc_score: 0.9515; val_best_f1_score: 0.9532; train_kl_reg_loss: 4117.7456; train_edge_recon_loss: 258981.6112; train_gene_expr_recon_loss: 60201.9686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323301.3256; train_optim_loss: 323301.3256; val_kl_reg_loss: 4261.2819; val_edge_recon_loss: 257529.8569; val_gene_expr_recon_loss: 60504.3638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322295.4986; val_optim_loss: 322295.4986
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9812; val_auprc_score: 0.9727; val_best_acc_score: 0.9528; val_best_f1_score: 0.9543; train_kl_reg_loss: 4120.6493; train_edge_recon_loss: 258480.9841; train_gene_expr_recon_loss: 59447.7055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322049.3393; train_optim_loss: 322049.3393; val_kl_reg_loss: 4007.8170; val_edge_recon_loss: 258228.5187; val_gene_expr_recon_loss: 59769.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322006.0368; val_optim_loss: 322006.0368
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9815; val_auprc_score: 0.9723; val_best_acc_score: 0.9577; val_best_f1_score: 0.9590; train_kl_reg_loss: 4114.2959; train_edge_recon_loss: 258145.6825; train_gene_expr_recon_loss: 58986.9851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321246.9639; train_optim_loss: 321246.9639; val_kl_reg_loss: 4188.2876; val_edge_recon_loss: 257271.8684; val_gene_expr_recon_loss: 59341.4454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320801.6014; val_optim_loss: 320801.6014
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9846; val_auprc_score: 0.9781; val_best_acc_score: 0.9614; val_best_f1_score: 0.9625; train_kl_reg_loss: 4109.4759; train_edge_recon_loss: 258092.5573; train_gene_expr_recon_loss: 58484.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320686.4783; train_optim_loss: 320686.4783; val_kl_reg_loss: 3899.6469; val_edge_recon_loss: 258101.6955; val_gene_expr_recon_loss: 58813.3473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320814.6910; val_optim_loss: 320814.6910
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9868; val_auprc_score: 0.9811; val_best_acc_score: 0.9653; val_best_f1_score: 0.9662; train_kl_reg_loss: 4111.9916; train_edge_recon_loss: 257950.0967; train_gene_expr_recon_loss: 58364.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320426.4932; train_optim_loss: 320426.4932; val_kl_reg_loss: 4148.8623; val_edge_recon_loss: 256374.6441; val_gene_expr_recon_loss: 58596.1527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319119.6590; val_optim_loss: 319119.6590
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9863; val_auprc_score: 0.9784; val_best_acc_score: 0.9665; val_best_f1_score: 0.9674; train_kl_reg_loss: 4120.7100; train_edge_recon_loss: 257650.0222; train_gene_expr_recon_loss: 58132.4511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319903.1829; train_optim_loss: 319903.1829; val_kl_reg_loss: 4125.3527; val_edge_recon_loss: 256461.6319; val_gene_expr_recon_loss: 58497.4643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319084.4514; val_optim_loss: 319084.4514
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9864; val_auprc_score: 0.9786; val_best_acc_score: 0.9673; val_best_f1_score: 0.9681; train_kl_reg_loss: 4126.4406; train_edge_recon_loss: 257434.1429; train_gene_expr_recon_loss: 57812.0754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319372.6594; train_optim_loss: 319372.6594; val_kl_reg_loss: 4037.7810; val_edge_recon_loss: 256913.6122; val_gene_expr_recon_loss: 58331.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319283.1361; val_optim_loss: 319283.1361
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9888; val_auprc_score: 0.9848; val_best_acc_score: 0.9685; val_best_f1_score: 0.9692; train_kl_reg_loss: 4119.2517; train_edge_recon_loss: 257467.8592; train_gene_expr_recon_loss: 57681.0569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319268.1668; train_optim_loss: 319268.1668; val_kl_reg_loss: 4088.5361; val_edge_recon_loss: 257045.3882; val_gene_expr_recon_loss: 58208.1217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319342.0424; val_optim_loss: 319342.0424
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9896; val_auprc_score: 0.9845; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 4124.7611; train_edge_recon_loss: 257177.5945; train_gene_expr_recon_loss: 57437.6115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318739.9675; train_optim_loss: 318739.9675; val_kl_reg_loss: 4211.7854; val_edge_recon_loss: 256119.9715; val_gene_expr_recon_loss: 58328.1856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318659.9437; val_optim_loss: 318659.9437
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9902; val_auprc_score: 0.9844; val_best_acc_score: 0.9718; val_best_f1_score: 0.9725; train_kl_reg_loss: 4132.1032; train_edge_recon_loss: 256975.9073; train_gene_expr_recon_loss: 57399.5816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318507.5919; train_optim_loss: 318507.5919; val_kl_reg_loss: 4130.6829; val_edge_recon_loss: 256352.8312; val_gene_expr_recon_loss: 58312.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318795.9354; val_optim_loss: 318795.9354
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9903; val_auprc_score: 0.9840; val_best_acc_score: 0.9736; val_best_f1_score: 0.9742; train_kl_reg_loss: 4133.7736; train_edge_recon_loss: 256969.6241; train_gene_expr_recon_loss: 57282.7088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318386.1068; train_optim_loss: 318386.1068; val_kl_reg_loss: 4157.2223; val_edge_recon_loss: 255578.1392; val_gene_expr_recon_loss: 57902.0957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317637.4583; val_optim_loss: 317637.4583
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9910; val_auprc_score: 0.9858; val_best_acc_score: 0.9752; val_best_f1_score: 0.9756; train_kl_reg_loss: 4136.6548; train_edge_recon_loss: 256631.4344; train_gene_expr_recon_loss: 57210.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317978.7513; train_optim_loss: 317978.7513; val_kl_reg_loss: 4130.0241; val_edge_recon_loss: 255813.0462; val_gene_expr_recon_loss: 57869.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317812.3132; val_optim_loss: 317812.3132
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9920; val_auprc_score: 0.9861; val_best_acc_score: 0.9765; val_best_f1_score: 0.9769; train_kl_reg_loss: 4143.2040; train_edge_recon_loss: 256390.7900; train_gene_expr_recon_loss: 57135.5475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317669.5415; train_optim_loss: 317669.5415; val_kl_reg_loss: 4142.6842; val_edge_recon_loss: 255804.6462; val_gene_expr_recon_loss: 57875.8621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317823.1937; val_optim_loss: 317823.1937
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9927; val_auprc_score: 0.9879; val_best_acc_score: 0.9780; val_best_f1_score: 0.9783; train_kl_reg_loss: 4147.0283; train_edge_recon_loss: 256356.5188; train_gene_expr_recon_loss: 56975.1453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317478.6912; train_optim_loss: 317478.6912; val_kl_reg_loss: 4130.5531; val_edge_recon_loss: 255967.7080; val_gene_expr_recon_loss: 57716.1472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317814.4111; val_optim_loss: 317814.4111

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9919; val_auprc_score: 0.9857; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 4151.4075; train_edge_recon_loss: 256264.1724; train_gene_expr_recon_loss: 56672.8051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317088.3855; train_optim_loss: 317088.3855; val_kl_reg_loss: 4137.9270; val_edge_recon_loss: 255639.3726; val_gene_expr_recon_loss: 57727.5774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317504.8764; val_optim_loss: 317504.8764
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9929; val_auprc_score: 0.9895; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 4133.9370; train_edge_recon_loss: 256235.0826; train_gene_expr_recon_loss: 56751.6657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317120.6847; train_optim_loss: 317120.6847; val_kl_reg_loss: 4145.9831; val_edge_recon_loss: 255535.9535; val_gene_expr_recon_loss: 57740.6451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317422.5812; val_optim_loss: 317422.5812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9928; val_auprc_score: 0.9881; val_best_acc_score: 0.9785; val_best_f1_score: 0.9788; train_kl_reg_loss: 4137.5752; train_edge_recon_loss: 256435.7575; train_gene_expr_recon_loss: 56672.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317245.7319; train_optim_loss: 317245.7319; val_kl_reg_loss: 4126.4823; val_edge_recon_loss: 255818.1837; val_gene_expr_recon_loss: 57534.3602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317479.0278; val_optim_loss: 317479.0278
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9928; val_auprc_score: 0.9879; val_best_acc_score: 0.9792; val_best_f1_score: 0.9796; train_kl_reg_loss: 4131.2572; train_edge_recon_loss: 255968.0327; train_gene_expr_recon_loss: 56623.1860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316722.4764; train_optim_loss: 316722.4764; val_kl_reg_loss: 4155.8510; val_edge_recon_loss: 255306.4281; val_gene_expr_recon_loss: 57423.3625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316885.6424; val_optim_loss: 316885.6424
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9925; val_auprc_score: 0.9893; val_best_acc_score: 0.9782; val_best_f1_score: 0.9786; train_kl_reg_loss: 4127.1960; train_edge_recon_loss: 256239.4809; train_gene_expr_recon_loss: 56719.1126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317085.7896; train_optim_loss: 317085.7896; val_kl_reg_loss: 4109.1366; val_edge_recon_loss: 255525.5771; val_gene_expr_recon_loss: 57407.4236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317042.1361; val_optim_loss: 317042.1361
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9926; val_auprc_score: 0.9894; val_best_acc_score: 0.9787; val_best_f1_score: 0.9791; train_kl_reg_loss: 4131.4766; train_edge_recon_loss: 256152.1648; train_gene_expr_recon_loss: 56685.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316969.5367; train_optim_loss: 316969.5367; val_kl_reg_loss: 4143.2103; val_edge_recon_loss: 256156.3806; val_gene_expr_recon_loss: 57724.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318023.7049; val_optim_loss: 318023.7049
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9943; val_auprc_score: 0.9915; val_best_acc_score: 0.9812; val_best_f1_score: 0.9815; train_kl_reg_loss: 4126.7082; train_edge_recon_loss: 256260.6251; train_gene_expr_recon_loss: 56674.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317061.8411; train_optim_loss: 317061.8411; val_kl_reg_loss: 4108.6459; val_edge_recon_loss: 255081.6118; val_gene_expr_recon_loss: 57404.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316595.1444; val_optim_loss: 316595.1444
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9928; val_auprc_score: 0.9887; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 4131.6914; train_edge_recon_loss: 256120.1441; train_gene_expr_recon_loss: 56570.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316822.2968; train_optim_loss: 316822.2968; val_kl_reg_loss: 4112.5160; val_edge_recon_loss: 255640.4476; val_gene_expr_recon_loss: 57625.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317378.4062; val_optim_loss: 317378.4062
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9929; val_auprc_score: 0.9895; val_best_acc_score: 0.9802; val_best_f1_score: 0.9805; train_kl_reg_loss: 3776.1917; train_edge_recon_loss: 255986.2055; train_gene_expr_recon_loss: 56732.0754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316494.4716; train_optim_loss: 316494.4716; val_kl_reg_loss: 3201.9922; val_edge_recon_loss: 255370.3000; val_gene_expr_recon_loss: 57760.8812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316333.1729; val_optim_loss: 316333.1729
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9930; val_auprc_score: 0.9889; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 3307.7365; train_edge_recon_loss: 255784.1413; train_gene_expr_recon_loss: 56722.2823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315814.1606; train_optim_loss: 315814.1606; val_kl_reg_loss: 2923.3102; val_edge_recon_loss: 256294.3312; val_gene_expr_recon_loss: 57593.9464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316811.5882; val_optim_loss: 316811.5882
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9931; val_auprc_score: 0.9886; val_best_acc_score: 0.9810; val_best_f1_score: 0.9813; train_kl_reg_loss: 3175.3407; train_edge_recon_loss: 255753.2182; train_gene_expr_recon_loss: 56667.4435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315596.0035; train_optim_loss: 315596.0035; val_kl_reg_loss: 2907.6242; val_edge_recon_loss: 255467.6878; val_gene_expr_recon_loss: 57513.6338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315888.9451; val_optim_loss: 315888.9451
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9931; val_auprc_score: 0.9878; val_best_acc_score: 0.9782; val_best_f1_score: 0.9786; train_kl_reg_loss: 3142.8758; train_edge_recon_loss: 255783.0803; train_gene_expr_recon_loss: 56617.6853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315543.6407; train_optim_loss: 315543.6407; val_kl_reg_loss: 2901.7503; val_edge_recon_loss: 256251.7490; val_gene_expr_recon_loss: 57792.4546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316945.9542; val_optim_loss: 316945.9542
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9940; val_auprc_score: 0.9904; val_best_acc_score: 0.9809; val_best_f1_score: 0.9812; train_kl_reg_loss: 3118.5867; train_edge_recon_loss: 255720.2290; train_gene_expr_recon_loss: 56733.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315572.6971; train_optim_loss: 315572.6971; val_kl_reg_loss: 2906.2521; val_edge_recon_loss: 254761.0302; val_gene_expr_recon_loss: 57531.6832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315198.9639; val_optim_loss: 315198.9639
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9929; val_auprc_score: 0.9877; val_best_acc_score: 0.9806; val_best_f1_score: 0.9809; train_kl_reg_loss: 3095.4961; train_edge_recon_loss: 255816.2233; train_gene_expr_recon_loss: 56769.0194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315680.7385; train_optim_loss: 315680.7385; val_kl_reg_loss: 2899.2883; val_edge_recon_loss: 255924.0753; val_gene_expr_recon_loss: 57802.9834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316626.3486; val_optim_loss: 316626.3486
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9934; val_auprc_score: 0.9893; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 3074.9951; train_edge_recon_loss: 255420.4007; train_gene_expr_recon_loss: 56611.6066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315107.0021; train_optim_loss: 315107.0021; val_kl_reg_loss: 2910.8851; val_edge_recon_loss: 255598.6639; val_gene_expr_recon_loss: 57683.4023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316192.9486; val_optim_loss: 316192.9486
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9937; val_auprc_score: 0.9884; val_best_acc_score: 0.9812; val_best_f1_score: 0.9814; train_kl_reg_loss: 3053.5983; train_edge_recon_loss: 255635.3238; train_gene_expr_recon_loss: 56604.4734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315293.3955; train_optim_loss: 315293.3955; val_kl_reg_loss: 2905.1903; val_edge_recon_loss: 255710.7451; val_gene_expr_recon_loss: 57508.0494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316123.9847; val_optim_loss: 316123.9847

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9934; val_auprc_score: 0.9898; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 3037.4623; train_edge_recon_loss: 255790.1772; train_gene_expr_recon_loss: 56647.5676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315475.2067; train_optim_loss: 315475.2067; val_kl_reg_loss: 2899.9560; val_edge_recon_loss: 255601.3014; val_gene_expr_recon_loss: 57496.6349; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315997.8924; val_optim_loss: 315997.8924
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9944; val_auprc_score: 0.9918; val_best_acc_score: 0.9815; val_best_f1_score: 0.9818; train_kl_reg_loss: 3039.1526; train_edge_recon_loss: 255466.2385; train_gene_expr_recon_loss: 56612.5160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315117.9073; train_optim_loss: 315117.9073; val_kl_reg_loss: 2905.5732; val_edge_recon_loss: 255327.9118; val_gene_expr_recon_loss: 57402.0241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315635.5090; val_optim_loss: 315635.5090
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9941; val_auprc_score: 0.9913; val_best_acc_score: 0.9818; val_best_f1_score: 0.9821; train_kl_reg_loss: 3036.5594; train_edge_recon_loss: 255672.6500; train_gene_expr_recon_loss: 56577.2171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315286.4274; train_optim_loss: 315286.4274; val_kl_reg_loss: 2900.6850; val_edge_recon_loss: 254837.6906; val_gene_expr_recon_loss: 57512.8707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315251.2451; val_optim_loss: 315251.2451

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 3 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9935
Val AUPRC score: 0.9888
Val best accuracy score: 0.9796
Val best F1 score: 0.9800
Val gene expr MSE score: 0.0094
Duration of model training in run 9: 0 hours, 28 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 9402
Number of validation nodes: 1045
Number of training edges: 101700
Number of validation edges: 11300
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9611; val_auprc_score: 0.9470; val_best_acc_score: 0.9116; val_best_f1_score: 0.9155; train_kl_reg_loss: 3980.4991; train_edge_recon_loss: 279618.5915; train_gene_expr_recon_loss: 66049.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349648.6553; train_optim_loss: 349648.6553; val_kl_reg_loss: 4119.1218; val_edge_recon_loss: 264617.6906; val_gene_expr_recon_loss: 63153.2576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331890.0729; val_optim_loss: 331890.0729
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9736; val_auprc_score: 0.9593; val_best_acc_score: 0.9401; val_best_f1_score: 0.9425; train_kl_reg_loss: 4155.6514; train_edge_recon_loss: 262618.7470; train_gene_expr_recon_loss: 63062.5960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329836.9943; train_optim_loss: 329836.9943; val_kl_reg_loss: 4100.8254; val_edge_recon_loss: 259837.6385; val_gene_expr_recon_loss: 61333.0514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325271.5125; val_optim_loss: 325271.5125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9786; val_auprc_score: 0.9684; val_best_acc_score: 0.9472; val_best_f1_score: 0.9490; train_kl_reg_loss: 4134.6650; train_edge_recon_loss: 259965.5572; train_gene_expr_recon_loss: 61499.4235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325599.6462; train_optim_loss: 325599.6462; val_kl_reg_loss: 4011.7589; val_edge_recon_loss: 259414.2549; val_gene_expr_recon_loss: 59993.7240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323419.7410; val_optim_loss: 323419.7410
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9785; val_auprc_score: 0.9692; val_best_acc_score: 0.9493; val_best_f1_score: 0.9509; train_kl_reg_loss: 4108.6644; train_edge_recon_loss: 259219.8641; train_gene_expr_recon_loss: 60424.1805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323752.7103; train_optim_loss: 323752.7103; val_kl_reg_loss: 4130.5954; val_edge_recon_loss: 259140.4552; val_gene_expr_recon_loss: 59402.6543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322673.7035; val_optim_loss: 322673.7035
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9812; val_auprc_score: 0.9727; val_best_acc_score: 0.9540; val_best_f1_score: 0.9554; train_kl_reg_loss: 4100.1482; train_edge_recon_loss: 258907.9633; train_gene_expr_recon_loss: 59618.9602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322627.0710; train_optim_loss: 322627.0710; val_kl_reg_loss: 4176.8855; val_edge_recon_loss: 258242.1847; val_gene_expr_recon_loss: 58593.3273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321012.3972; val_optim_loss: 321012.3972
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9817; val_auprc_score: 0.9746; val_best_acc_score: 0.9573; val_best_f1_score: 0.9588; train_kl_reg_loss: 4108.0800; train_edge_recon_loss: 258376.2624; train_gene_expr_recon_loss: 59172.7360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321657.0780; train_optim_loss: 321657.0780; val_kl_reg_loss: 4109.0743; val_edge_recon_loss: 257817.2906; val_gene_expr_recon_loss: 58393.9935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320320.3563; val_optim_loss: 320320.3563
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9840; val_auprc_score: 0.9761; val_best_acc_score: 0.9625; val_best_f1_score: 0.9636; train_kl_reg_loss: 4104.4716; train_edge_recon_loss: 258145.8262; train_gene_expr_recon_loss: 58746.1032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320996.4018; train_optim_loss: 320996.4018; val_kl_reg_loss: 4080.8104; val_edge_recon_loss: 257303.1674; val_gene_expr_recon_loss: 57946.0617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319330.0382; val_optim_loss: 319330.0382
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9849; val_auprc_score: 0.9770; val_best_acc_score: 0.9604; val_best_f1_score: 0.9615; train_kl_reg_loss: 4119.5867; train_edge_recon_loss: 257575.1807; train_gene_expr_recon_loss: 58371.1066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320065.8736; train_optim_loss: 320065.8736; val_kl_reg_loss: 4134.1619; val_edge_recon_loss: 256768.5677; val_gene_expr_recon_loss: 57703.9647; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318606.6944; val_optim_loss: 318606.6944
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9841; val_auprc_score: 0.9753; val_best_acc_score: 0.9621; val_best_f1_score: 0.9633; train_kl_reg_loss: 4116.3466; train_edge_recon_loss: 257689.3494; train_gene_expr_recon_loss: 58254.5377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320060.2337; train_optim_loss: 320060.2337; val_kl_reg_loss: 4165.7875; val_edge_recon_loss: 257415.9024; val_gene_expr_recon_loss: 57239.9072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318821.5979; val_optim_loss: 318821.5979
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9869; val_auprc_score: 0.9815; val_best_acc_score: 0.9660; val_best_f1_score: 0.9669; train_kl_reg_loss: 4126.1944; train_edge_recon_loss: 257436.8994; train_gene_expr_recon_loss: 57946.3555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319509.4491; train_optim_loss: 319509.4491; val_kl_reg_loss: 4096.8670; val_edge_recon_loss: 256500.9330; val_gene_expr_recon_loss: 57290.6583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317888.4590; val_optim_loss: 317888.4590
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9861; val_auprc_score: 0.9763; val_best_acc_score: 0.9669; val_best_f1_score: 0.9677; train_kl_reg_loss: 4121.1092; train_edge_recon_loss: 257190.0039; train_gene_expr_recon_loss: 57787.1345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319098.2492; train_optim_loss: 319098.2492; val_kl_reg_loss: 4017.1077; val_edge_recon_loss: 257017.9972; val_gene_expr_recon_loss: 57023.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318058.4194; val_optim_loss: 318058.4194
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9888; val_auprc_score: 0.9833; val_best_acc_score: 0.9704; val_best_f1_score: 0.9710; train_kl_reg_loss: 4122.0284; train_edge_recon_loss: 257273.3276; train_gene_expr_recon_loss: 57665.8680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319061.2243; train_optim_loss: 319061.2243; val_kl_reg_loss: 4027.4789; val_edge_recon_loss: 256724.9670; val_gene_expr_recon_loss: 57271.0149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318023.4639; val_optim_loss: 318023.4639
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9887; val_auprc_score: 0.9831; val_best_acc_score: 0.9707; val_best_f1_score: 0.9714; train_kl_reg_loss: 4125.7650; train_edge_recon_loss: 256885.7789; train_gene_expr_recon_loss: 57565.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318576.9311; train_optim_loss: 318576.9311; val_kl_reg_loss: 4105.9983; val_edge_recon_loss: 256773.9146; val_gene_expr_recon_loss: 57061.5303; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317941.4444; val_optim_loss: 317941.4444

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9905; val_auprc_score: 0.9846; val_best_acc_score: 0.9750; val_best_f1_score: 0.9754; train_kl_reg_loss: 4138.7615; train_edge_recon_loss: 256689.3582; train_gene_expr_recon_loss: 57254.1025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318082.2222; train_optim_loss: 318082.2222; val_kl_reg_loss: 4111.3240; val_edge_recon_loss: 254987.3983; val_gene_expr_recon_loss: 56771.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315870.1403; val_optim_loss: 315870.1403
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9898; val_auprc_score: 0.9856; val_best_acc_score: 0.9720; val_best_f1_score: 0.9726; train_kl_reg_loss: 4122.7498; train_edge_recon_loss: 256717.5481; train_gene_expr_recon_loss: 57231.3432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318071.6412; train_optim_loss: 318071.6412; val_kl_reg_loss: 4129.0871; val_edge_recon_loss: 256716.3222; val_gene_expr_recon_loss: 56756.6687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317602.0785; val_optim_loss: 317602.0785
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9901; val_auprc_score: 0.9842; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 4120.7500; train_edge_recon_loss: 256482.9280; train_gene_expr_recon_loss: 57263.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317866.7669; train_optim_loss: 317866.7669; val_kl_reg_loss: 4134.2418; val_edge_recon_loss: 256002.6514; val_gene_expr_recon_loss: 56763.0003; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316899.8903; val_optim_loss: 316899.8903
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9903; val_auprc_score: 0.9838; val_best_acc_score: 0.9741; val_best_f1_score: 0.9746; train_kl_reg_loss: 4119.4939; train_edge_recon_loss: 256488.6395; train_gene_expr_recon_loss: 57177.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317785.3565; train_optim_loss: 317785.3565; val_kl_reg_loss: 4137.4408; val_edge_recon_loss: 255514.7743; val_gene_expr_recon_loss: 56583.9518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316236.1688; val_optim_loss: 316236.1688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9900; val_auprc_score: 0.9856; val_best_acc_score: 0.9741; val_best_f1_score: 0.9746; train_kl_reg_loss: 4123.8684; train_edge_recon_loss: 256654.3022; train_gene_expr_recon_loss: 57142.8297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317921.0002; train_optim_loss: 317921.0002; val_kl_reg_loss: 4122.3115; val_edge_recon_loss: 255628.8583; val_gene_expr_recon_loss: 56610.5761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 316361.7479; val_optim_loss: 316361.7479
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9899; val_auprc_score: 0.9848; val_best_acc_score: 0.9734; val_best_f1_score: 0.9739; train_kl_reg_loss: 4115.6486; train_edge_recon_loss: 256779.1891; train_gene_expr_recon_loss: 57082.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317977.6171; train_optim_loss: 317977.6171; val_kl_reg_loss: 4120.2334; val_edge_recon_loss: 256707.8483; val_gene_expr_recon_loss: 56630.0510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317458.1333; val_optim_loss: 317458.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9896; val_auprc_score: 0.9842; val_best_acc_score: 0.9735; val_best_f1_score: 0.9740; train_kl_reg_loss: 4117.6054; train_edge_recon_loss: 256360.2250; train_gene_expr_recon_loss: 57098.4540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317576.2850; train_optim_loss: 317576.2850; val_kl_reg_loss: 4121.2163; val_edge_recon_loss: 256511.7556; val_gene_expr_recon_loss: 56510.5023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317143.4743; val_optim_loss: 317143.4743

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 59 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9895
Val AUPRC score: 0.9840
Val best accuracy score: 0.9725
Val best F1 score: 0.9730
Val gene expr MSE score: 0.0094
Duration of model training in run 10: 0 hours, 13 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
