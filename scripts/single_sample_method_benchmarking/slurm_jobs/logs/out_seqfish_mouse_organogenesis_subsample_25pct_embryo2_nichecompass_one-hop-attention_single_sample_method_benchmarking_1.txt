Run timestamp: 21062023_133744.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_25pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6864; val_auprc_score: 0.7030; val_best_acc_score: 0.6513; val_best_f1_score: 0.6500; train_kl_reg_loss: 1170.5445; train_edge_recon_loss: 365647.1875; train_cond_contrastive_loss: 139853.6133; train_gene_expr_recon_loss: 141305.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 647977.2188; train_optim_loss: 647977.2188; val_kl_reg_loss: 2188.3965; val_edge_recon_loss: 429829.3125; val_cond_contrastive_loss: 78422.9922; val_gene_expr_recon_loss: 120695.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 631136.5625; val_optim_loss: 631136.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6652; val_auprc_score: 0.6822; val_best_acc_score: 0.6309; val_best_f1_score: 0.6499; train_kl_reg_loss: 3220.9650; train_edge_recon_loss: 382015.6562; train_cond_contrastive_loss: 95733.3320; train_gene_expr_recon_loss: 116566.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 597536.3125; train_optim_loss: 597536.3125; val_kl_reg_loss: 11331.2930; val_edge_recon_loss: 424958.7500; val_cond_contrastive_loss: 78405.4375; val_gene_expr_recon_loss: 110480.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 625176.0625; val_optim_loss: 625176.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6537; val_auprc_score: 0.6653; val_best_acc_score: 0.6193; val_best_f1_score: 0.6506; train_kl_reg_loss: 10642.0757; train_edge_recon_loss: 389582.3438; train_cond_contrastive_loss: 81166.5000; train_gene_expr_recon_loss: 109645.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 591036.2812; train_optim_loss: 591036.2812; val_kl_reg_loss: 5495.7100; val_edge_recon_loss: 419519.6562; val_cond_contrastive_loss: 78415.5000; val_gene_expr_recon_loss: 106576.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 610007.6875; val_optim_loss: 610007.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6404; val_auprc_score: 0.6568; val_best_acc_score: 0.6239; val_best_f1_score: 0.6496; train_kl_reg_loss: 5185.8733; train_edge_recon_loss: 381087.3438; train_cond_contrastive_loss: 85400.9805; train_gene_expr_recon_loss: 105090.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 576764.4375; train_optim_loss: 576764.4375; val_kl_reg_loss: 3721.3567; val_edge_recon_loss: 410688.2188; val_cond_contrastive_loss: 78451.7344; val_gene_expr_recon_loss: 105084.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 597945.5000; val_optim_loss: 597945.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6335; val_auprc_score: 0.6454; val_best_acc_score: 0.6069; val_best_f1_score: 0.6490; train_kl_reg_loss: 3774.9009; train_edge_recon_loss: 374779.8281; train_cond_contrastive_loss: 90278.4570; train_gene_expr_recon_loss: 103930.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 572763.9062; train_optim_loss: 572763.9062; val_kl_reg_loss: 3435.2485; val_edge_recon_loss: 398175.4062; val_cond_contrastive_loss: 78510.5469; val_gene_expr_recon_loss: 104485.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 584607.0625; val_optim_loss: 584607.0625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6380; val_auprc_score: 0.6475; val_best_acc_score: 0.6048; val_best_f1_score: 0.6513; train_kl_reg_loss: 3714.7378; train_edge_recon_loss: 368147.9688; train_cond_contrastive_loss: 90770.7930; train_gene_expr_recon_loss: 103382.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 566015.8438; train_optim_loss: 566015.8438; val_kl_reg_loss: 3612.6636; val_edge_recon_loss: 382194.7500; val_cond_contrastive_loss: 78549.5469; val_gene_expr_recon_loss: 104130.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568487.8125; val_optim_loss: 568487.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6479; val_auprc_score: 0.6635; val_best_acc_score: 0.6130; val_best_f1_score: 0.6540; train_kl_reg_loss: 3682.6084; train_edge_recon_loss: 361841.7812; train_cond_contrastive_loss: 88859.7930; train_gene_expr_recon_loss: 102980.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557364.6875; train_optim_loss: 557364.6875; val_kl_reg_loss: 3085.7241; val_edge_recon_loss: 369769.0938; val_cond_contrastive_loss: 78515.0938; val_gene_expr_recon_loss: 103908.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555278.1250; val_optim_loss: 555278.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6437; val_auprc_score: 0.6562; val_best_acc_score: 0.6117; val_best_f1_score: 0.6543; train_kl_reg_loss: 3098.0951; train_edge_recon_loss: 356344.9688; train_cond_contrastive_loss: 90320.9102; train_gene_expr_recon_loss: 102765.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 552529.6250; train_optim_loss: 552529.6250; val_kl_reg_loss: 2886.5337; val_edge_recon_loss: 368281.8750; val_cond_contrastive_loss: 78462.6641; val_gene_expr_recon_loss: 103726.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553357.1875; val_optim_loss: 553357.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6507; val_auprc_score: 0.6624; val_best_acc_score: 0.6130; val_best_f1_score: 0.6563; train_kl_reg_loss: 2951.5425; train_edge_recon_loss: 350374.4688; train_cond_contrastive_loss: 88743.9453; train_gene_expr_recon_loss: 102633.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544703.0938; train_optim_loss: 544703.0938; val_kl_reg_loss: 3102.5308; val_edge_recon_loss: 365058.4375; val_cond_contrastive_loss: 78423.1875; val_gene_expr_recon_loss: 103538.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550123.1250; val_optim_loss: 550123.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6374; val_auprc_score: 0.6516; val_best_acc_score: 0.6146; val_best_f1_score: 0.6458; train_kl_reg_loss: 3196.3965; train_edge_recon_loss: 348380.1562; train_cond_contrastive_loss: 84101.1016; train_gene_expr_recon_loss: 102302.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537980.4688; train_optim_loss: 537980.4688; val_kl_reg_loss: 3496.7529; val_edge_recon_loss: 376668.6250; val_cond_contrastive_loss: 78397.7031; val_gene_expr_recon_loss: 103317.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561880.1250; val_optim_loss: 561880.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6413; val_auprc_score: 0.6595; val_best_acc_score: 0.6177; val_best_f1_score: 0.6508; train_kl_reg_loss: 3571.0488; train_edge_recon_loss: 346514.4219; train_cond_contrastive_loss: 81270.8906; train_gene_expr_recon_loss: 101978.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533334.4375; train_optim_loss: 533334.4375; val_kl_reg_loss: 3816.6748; val_edge_recon_loss: 372067.2500; val_cond_contrastive_loss: 78385.9922; val_gene_expr_recon_loss: 103079.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 557349.7500; val_optim_loss: 557349.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6526; val_auprc_score: 0.6611; val_best_acc_score: 0.6224; val_best_f1_score: 0.6463; train_kl_reg_loss: 3852.6406; train_edge_recon_loss: 348588.6406; train_cond_contrastive_loss: 80144.2344; train_gene_expr_recon_loss: 101751.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534337.4375; train_optim_loss: 534337.4375; val_kl_reg_loss: 3955.2219; val_edge_recon_loss: 372845.4062; val_cond_contrastive_loss: 78383.7734; val_gene_expr_recon_loss: 102871.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558055.6875; val_optim_loss: 558055.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6446; val_auprc_score: 0.6562; val_best_acc_score: 0.6128; val_best_f1_score: 0.6538; train_kl_reg_loss: 3924.9019; train_edge_recon_loss: 348766.7344; train_cond_contrastive_loss: 79896.7852; train_gene_expr_recon_loss: 101679.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534267.6875; train_optim_loss: 534267.6875; val_kl_reg_loss: 3953.0698; val_edge_recon_loss: 371393.5625; val_cond_contrastive_loss: 78385.0312; val_gene_expr_recon_loss: 102846.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556578.5625; val_optim_loss: 556578.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6477; val_auprc_score: 0.6604; val_best_acc_score: 0.6164; val_best_f1_score: 0.6502; train_kl_reg_loss: 3920.7598; train_edge_recon_loss: 347313.0625; train_cond_contrastive_loss: 79856.6562; train_gene_expr_recon_loss: 101689.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532779.5312; train_optim_loss: 532779.5312; val_kl_reg_loss: 3937.8291; val_edge_recon_loss: 372855.5000; val_cond_contrastive_loss: 78383.3750; val_gene_expr_recon_loss: 102812.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 557989.5000; val_optim_loss: 557989.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6513; val_auprc_score: 0.6609; val_best_acc_score: 0.6214; val_best_f1_score: 0.6455; train_kl_reg_loss: 3887.0616; train_edge_recon_loss: 350829.4688; train_cond_contrastive_loss: 79898.0430; train_gene_expr_recon_loss: 101636.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536251.3750; train_optim_loss: 536251.3750; val_kl_reg_loss: 3884.8796; val_edge_recon_loss: 374462.3438; val_cond_contrastive_loss: 78380.2734; val_gene_expr_recon_loss: 102773.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559500.5000; val_optim_loss: 559500.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.6395
Val AUPRC score: 0.6548
Val best accuracy score: 0.6097
Val best F1 score: 0.6527
Val gene expr MSE score: 2.1272
Duration of model training in run 1: 0 hours, 0 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6695; val_auprc_score: 0.6980; val_best_acc_score: 0.6470; val_best_f1_score: 0.6507; train_kl_reg_loss: 1118.5503; train_edge_recon_loss: 367673.8906; train_cond_contrastive_loss: 139854.8359; train_gene_expr_recon_loss: 143021.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 651669.0938; train_optim_loss: 651669.0938; val_kl_reg_loss: 2065.1655; val_edge_recon_loss: 424482.8438; val_cond_contrastive_loss: 78415.1641; val_gene_expr_recon_loss: 118431.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 623394.6250; val_optim_loss: 623394.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6480; val_auprc_score: 0.6775; val_best_acc_score: 0.6329; val_best_f1_score: 0.6459; train_kl_reg_loss: 2738.1038; train_edge_recon_loss: 385148.7188; train_cond_contrastive_loss: 99849.6445; train_gene_expr_recon_loss: 116874.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 604610.8750; train_optim_loss: 604610.8750; val_kl_reg_loss: 4595.2524; val_edge_recon_loss: 425272.3125; val_cond_contrastive_loss: 78391.1953; val_gene_expr_recon_loss: 108508.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 616767.1875; val_optim_loss: 616767.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6436; val_auprc_score: 0.6679; val_best_acc_score: 0.6280; val_best_f1_score: 0.6492; train_kl_reg_loss: 7388.7061; train_edge_recon_loss: 381697.9844; train_cond_contrastive_loss: 87951.1367; train_gene_expr_recon_loss: 109814.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 586851.8750; train_optim_loss: 586851.8750; val_kl_reg_loss: 8836.1016; val_edge_recon_loss: 420266.6562; val_cond_contrastive_loss: 78404.6016; val_gene_expr_recon_loss: 105039.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 612547.3125; val_optim_loss: 612547.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6312; val_auprc_score: 0.6518; val_best_acc_score: 0.6206; val_best_f1_score: 0.6438; train_kl_reg_loss: 8694.6562; train_edge_recon_loss: 377064.3750; train_cond_contrastive_loss: 89593.7070; train_gene_expr_recon_loss: 106770.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 582123.7500; train_optim_loss: 582123.7500; val_kl_reg_loss: 6091.7769; val_edge_recon_loss: 415246.7500; val_cond_contrastive_loss: 78431.2656; val_gene_expr_recon_loss: 103547.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 603317.1250; val_optim_loss: 603317.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6264; val_auprc_score: 0.6408; val_best_acc_score: 0.6156; val_best_f1_score: 0.6444; train_kl_reg_loss: 6039.8726; train_edge_recon_loss: 369292.4219; train_cond_contrastive_loss: 91923.1641; train_gene_expr_recon_loss: 105154.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 572409.9688; train_optim_loss: 572409.9688; val_kl_reg_loss: 4748.6685; val_edge_recon_loss: 405861.1250; val_cond_contrastive_loss: 78472.2422; val_gene_expr_recon_loss: 102988.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592070.9375; val_optim_loss: 592070.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6398; val_auprc_score: 0.6546; val_best_acc_score: 0.6028; val_best_f1_score: 0.6494; train_kl_reg_loss: 4816.4570; train_edge_recon_loss: 368068.8281; train_cond_contrastive_loss: 91371.9062; train_gene_expr_recon_loss: 104386.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 568644.0312; train_optim_loss: 568644.0312; val_kl_reg_loss: 4101.4785; val_edge_recon_loss: 387190.9688; val_cond_contrastive_loss: 78524.9297; val_gene_expr_recon_loss: 102739.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572556.9375; val_optim_loss: 572556.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6395; val_auprc_score: 0.6600; val_best_acc_score: 0.6267; val_best_f1_score: 0.6403; train_kl_reg_loss: 4157.4270; train_edge_recon_loss: 358190.2812; train_cond_contrastive_loss: 89679.2852; train_gene_expr_recon_loss: 104190.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556217.2500; train_optim_loss: 556217.2500; val_kl_reg_loss: 3730.1602; val_edge_recon_loss: 382990.3438; val_cond_contrastive_loss: 78515.3984; val_gene_expr_recon_loss: 102546.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567782.8750; val_optim_loss: 567782.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6546; val_auprc_score: 0.6656; val_best_acc_score: 0.6287; val_best_f1_score: 0.6455; train_kl_reg_loss: 3831.5195; train_edge_recon_loss: 350661.6719; train_cond_contrastive_loss: 85858.1016; train_gene_expr_recon_loss: 103771.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544122.4062; train_optim_loss: 544122.4062; val_kl_reg_loss: 3713.5344; val_edge_recon_loss: 368745.1875; val_cond_contrastive_loss: 78454.0234; val_gene_expr_recon_loss: 102373.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553286.3750; val_optim_loss: 553286.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6459; val_auprc_score: 0.6538; val_best_acc_score: 0.6255; val_best_f1_score: 0.6434; train_kl_reg_loss: 3883.1046; train_edge_recon_loss: 349917.0938; train_cond_contrastive_loss: 82286.8008; train_gene_expr_recon_loss: 103694.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 539781.1562; train_optim_loss: 539781.1562; val_kl_reg_loss: 3940.0200; val_edge_recon_loss: 376506.3438; val_cond_contrastive_loss: 78417.5703; val_gene_expr_recon_loss: 102111.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560975.9375; val_optim_loss: 560975.9375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6491; val_auprc_score: 0.6589; val_best_acc_score: 0.6235; val_best_f1_score: 0.6433; train_kl_reg_loss: 4097.6313; train_edge_recon_loss: 343277.4375; train_cond_contrastive_loss: 80793.4023; train_gene_expr_recon_loss: 103281.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531450.2812; train_optim_loss: 531450.2812; val_kl_reg_loss: 4100.8394; val_edge_recon_loss: 373275.5625; val_cond_contrastive_loss: 78409.6328; val_gene_expr_recon_loss: 101716.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 557502.6875; val_optim_loss: 557502.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6482; val_auprc_score: 0.6611; val_best_acc_score: 0.6261; val_best_f1_score: 0.6459; train_kl_reg_loss: 4224.7761; train_edge_recon_loss: 345430.9375; train_cond_contrastive_loss: 80240.0664; train_gene_expr_recon_loss: 102986.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532882.7500; train_optim_loss: 532882.7500; val_kl_reg_loss: 4071.3296; val_edge_recon_loss: 373023.6562; val_cond_contrastive_loss: 78405.9609; val_gene_expr_recon_loss: 101353.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556854.3125; val_optim_loss: 556854.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6626; val_auprc_score: 0.6711; val_best_acc_score: 0.6379; val_best_f1_score: 0.6441; train_kl_reg_loss: 4200.2271; train_edge_recon_loss: 344104.2656; train_cond_contrastive_loss: 80104.7461; train_gene_expr_recon_loss: 102724.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531134.0625; train_optim_loss: 531134.0625; val_kl_reg_loss: 4047.8425; val_edge_recon_loss: 370566.4375; val_cond_contrastive_loss: 78408.1953; val_gene_expr_recon_loss: 101317.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554340.3750; val_optim_loss: 554340.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6659; val_auprc_score: 0.6777; val_best_acc_score: 0.6403; val_best_f1_score: 0.6463; train_kl_reg_loss: 4175.5896; train_edge_recon_loss: 342153.1250; train_cond_contrastive_loss: 80146.0117; train_gene_expr_recon_loss: 102576.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529051.5938; train_optim_loss: 529051.5938; val_kl_reg_loss: 4023.1313; val_edge_recon_loss: 370021.3750; val_cond_contrastive_loss: 78409.9453; val_gene_expr_recon_loss: 101273.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553727.6250; val_optim_loss: 553727.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6653; val_auprc_score: 0.6710; val_best_acc_score: 0.6324; val_best_f1_score: 0.6487; train_kl_reg_loss: 4146.8218; train_edge_recon_loss: 342805.0312; train_cond_contrastive_loss: 80107.6211; train_gene_expr_recon_loss: 102526.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529585.6250; train_optim_loss: 529585.6250; val_kl_reg_loss: 3992.0171; val_edge_recon_loss: 369121.0625; val_cond_contrastive_loss: 78409.3359; val_gene_expr_recon_loss: 101222.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 552745.1250; val_optim_loss: 552745.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6705; val_auprc_score: 0.6826; val_best_acc_score: 0.6358; val_best_f1_score: 0.6535; train_kl_reg_loss: 4100.5901; train_edge_recon_loss: 343284.6719; train_cond_contrastive_loss: 80172.1172; train_gene_expr_recon_loss: 102483.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 530041.0625; train_optim_loss: 530041.0625; val_kl_reg_loss: 3934.2632; val_edge_recon_loss: 361494.2188; val_cond_contrastive_loss: 78409.7578; val_gene_expr_recon_loss: 101169.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 545007.6875; val_optim_loss: 545007.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.6783; val_auprc_score: 0.6842; val_best_acc_score: 0.6389; val_best_f1_score: 0.6572; train_kl_reg_loss: 4051.9683; train_edge_recon_loss: 342531.0469; train_cond_contrastive_loss: 80156.2617; train_gene_expr_recon_loss: 102430.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529169.7812; train_optim_loss: 529169.7812; val_kl_reg_loss: 3901.8994; val_edge_recon_loss: 357826.8125; val_cond_contrastive_loss: 78402.8047; val_gene_expr_recon_loss: 101115.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 541247.2500; val_optim_loss: 541247.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.6808; val_auprc_score: 0.6849; val_best_acc_score: 0.6488; val_best_f1_score: 0.6487; train_kl_reg_loss: 4006.4048; train_edge_recon_loss: 339269.1719; train_cond_contrastive_loss: 80136.9453; train_gene_expr_recon_loss: 102400.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525812.8125; train_optim_loss: 525812.8125; val_kl_reg_loss: 3850.8821; val_edge_recon_loss: 367139.6250; val_cond_contrastive_loss: 78406.4219; val_gene_expr_recon_loss: 101062.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550459.6250; val_optim_loss: 550459.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.6884; val_auprc_score: 0.6881; val_best_acc_score: 0.6508; val_best_f1_score: 0.6543; train_kl_reg_loss: 3956.0874; train_edge_recon_loss: 339003.6250; train_cond_contrastive_loss: 80222.6016; train_gene_expr_recon_loss: 102368.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525550.5781; train_optim_loss: 525550.5781; val_kl_reg_loss: 3810.5825; val_edge_recon_loss: 361781.7188; val_cond_contrastive_loss: 78407.2734; val_gene_expr_recon_loss: 101011.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 545010.6875; val_optim_loss: 545010.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.6940; val_auprc_score: 0.6971; val_best_acc_score: 0.6539; val_best_f1_score: 0.6639; train_kl_reg_loss: 3927.7469; train_edge_recon_loss: 339095.3281; train_cond_contrastive_loss: 80223.9375; train_gene_expr_recon_loss: 102297.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525544.9688; train_optim_loss: 525544.9688; val_kl_reg_loss: 3771.7026; val_edge_recon_loss: 353892.0312; val_cond_contrastive_loss: 78407.7422; val_gene_expr_recon_loss: 100961.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537033.0000; val_optim_loss: 537033.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.6904; val_auprc_score: 0.6915; val_best_acc_score: 0.6492; val_best_f1_score: 0.6583; train_kl_reg_loss: 3886.8043; train_edge_recon_loss: 336030.4531; train_cond_contrastive_loss: 80203.8711; train_gene_expr_recon_loss: 102152.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 522273.6875; train_optim_loss: 522273.6875; val_kl_reg_loss: 3748.2842; val_edge_recon_loss: 358773.0000; val_cond_contrastive_loss: 78407.8203; val_gene_expr_recon_loss: 100914.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 541843.2500; val_optim_loss: 541843.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.6950; val_auprc_score: 0.6972; val_best_acc_score: 0.6511; val_best_f1_score: 0.6665; train_kl_reg_loss: 3870.7092; train_edge_recon_loss: 337799.5938; train_cond_contrastive_loss: 80264.5039; train_gene_expr_recon_loss: 102127.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 524062.3906; train_optim_loss: 524062.3906; val_kl_reg_loss: 3731.9407; val_edge_recon_loss: 351837.1250; val_cond_contrastive_loss: 78410.6719; val_gene_expr_recon_loss: 100869.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534848.9375; val_optim_loss: 534848.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.6974; val_auprc_score: 0.6953; val_best_acc_score: 0.6469; val_best_f1_score: 0.6662; train_kl_reg_loss: 3848.3807; train_edge_recon_loss: 335403.1250; train_cond_contrastive_loss: 80289.5820; train_gene_expr_recon_loss: 102120.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521661.7969; train_optim_loss: 521661.7969; val_kl_reg_loss: 3735.5037; val_edge_recon_loss: 353749.7812; val_cond_contrastive_loss: 78410.5547; val_gene_expr_recon_loss: 100826.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536722.0625; val_optim_loss: 536722.0625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7021; val_auprc_score: 0.6993; val_best_acc_score: 0.6569; val_best_f1_score: 0.6665; train_kl_reg_loss: 3847.0114; train_edge_recon_loss: 335332.4844; train_cond_contrastive_loss: 80271.0938; train_gene_expr_recon_loss: 102089.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521540.2500; train_optim_loss: 521540.2500; val_kl_reg_loss: 3730.0791; val_edge_recon_loss: 352758.6250; val_cond_contrastive_loss: 78414.5312; val_gene_expr_recon_loss: 100785.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535688.5000; val_optim_loss: 535688.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.6931; val_auprc_score: 0.6849; val_best_acc_score: 0.6440; val_best_f1_score: 0.6649; train_kl_reg_loss: 3861.5089; train_edge_recon_loss: 332674.5781; train_cond_contrastive_loss: 80267.6602; train_gene_expr_recon_loss: 102186.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518989.9375; train_optim_loss: 518989.9375; val_kl_reg_loss: 3765.8511; val_edge_recon_loss: 356976.7812; val_cond_contrastive_loss: 78415.2031; val_gene_expr_recon_loss: 100745.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539903.4375; val_optim_loss: 539903.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7047; val_auprc_score: 0.7009; val_best_acc_score: 0.6564; val_best_f1_score: 0.6734; train_kl_reg_loss: 3872.7019; train_edge_recon_loss: 333472.0312; train_cond_contrastive_loss: 80226.1016; train_gene_expr_recon_loss: 102175.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 519746.4062; train_optim_loss: 519746.4062; val_kl_reg_loss: 3763.5674; val_edge_recon_loss: 347934.5938; val_cond_contrastive_loss: 78418.3516; val_gene_expr_recon_loss: 100741.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 530858.1875; val_optim_loss: 530858.1875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.7029; val_auprc_score: 0.6985; val_best_acc_score: 0.6551; val_best_f1_score: 0.6665; train_kl_reg_loss: 3881.5327; train_edge_recon_loss: 331625.0469; train_cond_contrastive_loss: 80241.9023; train_gene_expr_recon_loss: 102124.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517873.1719; train_optim_loss: 517873.1719; val_kl_reg_loss: 3761.5056; val_edge_recon_loss: 351501.4688; val_cond_contrastive_loss: 78416.7266; val_gene_expr_recon_loss: 100737.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534417.3125; val_optim_loss: 534417.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.7050; val_auprc_score: 0.7016; val_best_acc_score: 0.6587; val_best_f1_score: 0.6651; train_kl_reg_loss: 3880.0183; train_edge_recon_loss: 331616.6562; train_cond_contrastive_loss: 80209.8945; train_gene_expr_recon_loss: 101985.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517692.1094; train_optim_loss: 517692.1094; val_kl_reg_loss: 3752.9795; val_edge_recon_loss: 351481.0000; val_cond_contrastive_loss: 78420.0391; val_gene_expr_recon_loss: 100733.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534387.5625; val_optim_loss: 534387.5625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.6915; val_auprc_score: 0.6896; val_best_acc_score: 0.6447; val_best_f1_score: 0.6651; train_kl_reg_loss: 3887.0771; train_edge_recon_loss: 330376.2812; train_cond_contrastive_loss: 80259.5977; train_gene_expr_recon_loss: 102061.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 516584.0625; train_optim_loss: 516584.0625; val_kl_reg_loss: 3755.2144; val_edge_recon_loss: 355752.8125; val_cond_contrastive_loss: 78421.4766; val_gene_expr_recon_loss: 100729.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 538658.9375; val_optim_loss: 538658.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.6970; val_auprc_score: 0.7008; val_best_acc_score: 0.6535; val_best_f1_score: 0.6619; train_kl_reg_loss: 3893.7374; train_edge_recon_loss: 331574.6250; train_cond_contrastive_loss: 80207.2812; train_gene_expr_recon_loss: 101976.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517651.9219; train_optim_loss: 517651.9219; val_kl_reg_loss: 3757.6826; val_edge_recon_loss: 354590.3750; val_cond_contrastive_loss: 78424.3828; val_gene_expr_recon_loss: 100729.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537501.5000; val_optim_loss: 537501.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.6989; val_auprc_score: 0.6983; val_best_acc_score: 0.6476; val_best_f1_score: 0.6690; train_kl_reg_loss: 3882.4547; train_edge_recon_loss: 332277.8438; train_cond_contrastive_loss: 80227.1211; train_gene_expr_recon_loss: 102083.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518470.9531; train_optim_loss: 518470.9531; val_kl_reg_loss: 3772.0876; val_edge_recon_loss: 354330.1250; val_cond_contrastive_loss: 78422.6562; val_gene_expr_recon_loss: 100728.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537253.5000; val_optim_loss: 537253.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.7066; val_auprc_score: 0.7029; val_best_acc_score: 0.6580; val_best_f1_score: 0.6707; train_kl_reg_loss: 3885.2206; train_edge_recon_loss: 333820.4375; train_cond_contrastive_loss: 80212.5156; train_gene_expr_recon_loss: 102099.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 520018.0938; train_optim_loss: 520018.0938; val_kl_reg_loss: 3771.7915; val_edge_recon_loss: 348826.8438; val_cond_contrastive_loss: 78420.7812; val_gene_expr_recon_loss: 100728.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 531747.6250; val_optim_loss: 531747.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.7087
Val AUPRC score: 0.7056
Val best accuracy score: 0.6520
Val best F1 score: 0.6701
Val gene expr MSE score: 1.9894
Duration of model training in run 2: 0 hours, 0 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7205; val_auprc_score: 0.7684; val_best_acc_score: 0.6698; val_best_f1_score: 0.6861; train_kl_reg_loss: 1771.7540; train_edge_recon_loss: 356203.8359; train_cond_contrastive_loss: 120933.9668; train_gene_expr_recon_loss: 128660.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 607569.5938; train_optim_loss: 607569.5938; val_kl_reg_loss: 4376.5063; val_edge_recon_loss: 400879.8125; val_cond_contrastive_loss: 78360.7344; val_gene_expr_recon_loss: 108169.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 591786.5625; val_optim_loss: 591786.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6930; val_auprc_score: 0.7358; val_best_acc_score: 0.6301; val_best_f1_score: 0.6805; train_kl_reg_loss: 8335.6047; train_edge_recon_loss: 362432.5781; train_cond_contrastive_loss: 86522.5176; train_gene_expr_recon_loss: 106674.9355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 563965.6250; train_optim_loss: 563965.6250; val_kl_reg_loss: 7718.7979; val_edge_recon_loss: 396478.5625; val_cond_contrastive_loss: 78381.4062; val_gene_expr_recon_loss: 103357.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 585935.8750; val_optim_loss: 585935.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6722; val_auprc_score: 0.7210; val_best_acc_score: 0.6067; val_best_f1_score: 0.6849; train_kl_reg_loss: 6789.8948; train_edge_recon_loss: 356374.7266; train_cond_contrastive_loss: 86938.1816; train_gene_expr_recon_loss: 102678.3066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 552781.1094; train_optim_loss: 552781.1094; val_kl_reg_loss: 4763.7363; val_edge_recon_loss: 375620.3438; val_cond_contrastive_loss: 78441.9609; val_gene_expr_recon_loss: 101996.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560822.7500; val_optim_loss: 560822.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6761; val_auprc_score: 0.7197; val_best_acc_score: 0.6209; val_best_f1_score: 0.6811; train_kl_reg_loss: 4225.5336; train_edge_recon_loss: 347915.1250; train_cond_contrastive_loss: 87511.1094; train_gene_expr_recon_loss: 101443.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 541095.7344; train_optim_loss: 541095.7344; val_kl_reg_loss: 3178.8174; val_edge_recon_loss: 353009.4375; val_cond_contrastive_loss: 78510.6641; val_gene_expr_recon_loss: 101444.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536143.6250; val_optim_loss: 536143.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6784; val_auprc_score: 0.7220; val_best_acc_score: 0.6386; val_best_f1_score: 0.6813; train_kl_reg_loss: 3132.8428; train_edge_recon_loss: 333678.3672; train_cond_contrastive_loss: 87209.5879; train_gene_expr_recon_loss: 101403.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525424.0469; train_optim_loss: 525424.0469; val_kl_reg_loss: 3169.8667; val_edge_recon_loss: 346782.2812; val_cond_contrastive_loss: 78412.7344; val_gene_expr_recon_loss: 101070.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 529435.3750; val_optim_loss: 529435.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6928; val_auprc_score: 0.7257; val_best_acc_score: 0.6450; val_best_f1_score: 0.6806; train_kl_reg_loss: 3481.0411; train_edge_recon_loss: 326599.2656; train_cond_contrastive_loss: 81265.9473; train_gene_expr_recon_loss: 100854.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 512200.8281; train_optim_loss: 512200.8281; val_kl_reg_loss: 3720.2759; val_edge_recon_loss: 341085.3438; val_cond_contrastive_loss: 78391.7969; val_gene_expr_recon_loss: 100534.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523731.8125; val_optim_loss: 523731.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7199; val_auprc_score: 0.7446; val_best_acc_score: 0.6614; val_best_f1_score: 0.6928; train_kl_reg_loss: 3831.1077; train_edge_recon_loss: 323518.2500; train_cond_contrastive_loss: 79835.3496; train_gene_expr_recon_loss: 100556.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507741.5312; train_optim_loss: 507741.5312; val_kl_reg_loss: 3828.8179; val_edge_recon_loss: 331349.4375; val_cond_contrastive_loss: 78395.9766; val_gene_expr_recon_loss: 100147.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 513721.3750; val_optim_loss: 513721.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7670; val_auprc_score: 0.7691; val_best_acc_score: 0.6881; val_best_f1_score: 0.7190; train_kl_reg_loss: 3905.7808; train_edge_recon_loss: 312833.5312; train_cond_contrastive_loss: 79598.6641; train_gene_expr_recon_loss: 99861.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496199.9453; train_optim_loss: 496199.9453; val_kl_reg_loss: 4061.6318; val_edge_recon_loss: 315185.5625; val_cond_contrastive_loss: 78419.2188; val_gene_expr_recon_loss: 99867.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497533.6875; val_optim_loss: 497533.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8065; val_auprc_score: 0.7997; val_best_acc_score: 0.7261; val_best_f1_score: 0.7646; train_kl_reg_loss: 4472.3184; train_edge_recon_loss: 300122.9609; train_cond_contrastive_loss: 79261.9004; train_gene_expr_recon_loss: 99623.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483480.3672; train_optim_loss: 483480.3672; val_kl_reg_loss: 5119.5508; val_edge_recon_loss: 294477.4062; val_cond_contrastive_loss: 78446.6016; val_gene_expr_recon_loss: 99316.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477360.0000; val_optim_loss: 477360.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8197; val_auprc_score: 0.7962; val_best_acc_score: 0.7465; val_best_f1_score: 0.7829; train_kl_reg_loss: 5785.9814; train_edge_recon_loss: 290939.1875; train_cond_contrastive_loss: 78811.3633; train_gene_expr_recon_loss: 98926.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474462.9297; train_optim_loss: 474462.9297; val_kl_reg_loss: 6514.7920; val_edge_recon_loss: 290539.8750; val_cond_contrastive_loss: 78431.2109; val_gene_expr_recon_loss: 98713.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474199.0625; val_optim_loss: 474199.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8417; val_auprc_score: 0.8174; val_best_acc_score: 0.7697; val_best_f1_score: 0.7995; train_kl_reg_loss: 7040.1494; train_edge_recon_loss: 284079.5859; train_cond_contrastive_loss: 78664.6484; train_gene_expr_recon_loss: 98824.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468609.2812; train_optim_loss: 468609.2812; val_kl_reg_loss: 7298.0703; val_edge_recon_loss: 281504.8125; val_cond_contrastive_loss: 78408.4766; val_gene_expr_recon_loss: 98392.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465604.2188; val_optim_loss: 465604.2188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8451; val_auprc_score: 0.8132; val_best_acc_score: 0.7706; val_best_f1_score: 0.7982; train_kl_reg_loss: 7476.9708; train_edge_recon_loss: 282225.1016; train_cond_contrastive_loss: 78684.2852; train_gene_expr_recon_loss: 98367.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466753.9766; train_optim_loss: 466753.9766; val_kl_reg_loss: 7320.4644; val_edge_recon_loss: 286360.2812; val_cond_contrastive_loss: 78400.6719; val_gene_expr_recon_loss: 97977.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470059.0938; val_optim_loss: 470059.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8560; val_auprc_score: 0.8204; val_best_acc_score: 0.7883; val_best_f1_score: 0.8098; train_kl_reg_loss: 7300.6335; train_edge_recon_loss: 280498.7656; train_cond_contrastive_loss: 78770.2285; train_gene_expr_recon_loss: 97977.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464547.1172; train_optim_loss: 464547.1172; val_kl_reg_loss: 6852.1084; val_edge_recon_loss: 283188.2500; val_cond_contrastive_loss: 78398.3672; val_gene_expr_recon_loss: 97644.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466083.4688; val_optim_loss: 466083.4688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8605; val_auprc_score: 0.8198; val_best_acc_score: 0.8025; val_best_f1_score: 0.8237; train_kl_reg_loss: 6806.7555; train_edge_recon_loss: 279813.3906; train_cond_contrastive_loss: 78943.3652; train_gene_expr_recon_loss: 97677.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463241.2109; train_optim_loss: 463241.2109; val_kl_reg_loss: 6498.2578; val_edge_recon_loss: 280441.5000; val_cond_contrastive_loss: 78407.1953; val_gene_expr_recon_loss: 97377.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462724.2812; val_optim_loss: 462724.2812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8856; val_auprc_score: 0.8520; val_best_acc_score: 0.8238; val_best_f1_score: 0.8411; train_kl_reg_loss: 6643.8882; train_edge_recon_loss: 276021.6016; train_cond_contrastive_loss: 78979.9824; train_gene_expr_recon_loss: 97702.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459347.6875; train_optim_loss: 459347.6875; val_kl_reg_loss: 6577.7915; val_edge_recon_loss: 276767.2188; val_cond_contrastive_loss: 78414.8438; val_gene_expr_recon_loss: 97077.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458836.9375; val_optim_loss: 458836.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8943; val_auprc_score: 0.8679; val_best_acc_score: 0.8326; val_best_f1_score: 0.8486; train_kl_reg_loss: 6755.4106; train_edge_recon_loss: 276458.9922; train_cond_contrastive_loss: 78891.0762; train_gene_expr_recon_loss: 96709.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458814.5781; train_optim_loss: 458814.5781; val_kl_reg_loss: 6630.8135; val_edge_recon_loss: 274372.7812; val_cond_contrastive_loss: 78420.3203; val_gene_expr_recon_loss: 96857.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456281.7188; val_optim_loss: 456281.7188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9029; val_auprc_score: 0.8740; val_best_acc_score: 0.8425; val_best_f1_score: 0.8570; train_kl_reg_loss: 6719.9991; train_edge_recon_loss: 273035.5547; train_cond_contrastive_loss: 78847.7676; train_gene_expr_recon_loss: 96239.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454843.0000; train_optim_loss: 454843.0000; val_kl_reg_loss: 6444.5640; val_edge_recon_loss: 270518.5000; val_cond_contrastive_loss: 78432.0625; val_gene_expr_recon_loss: 96655.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452050.4062; val_optim_loss: 452050.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9168; val_auprc_score: 0.9010; val_best_acc_score: 0.8450; val_best_f1_score: 0.8578; train_kl_reg_loss: 6482.9756; train_edge_recon_loss: 271915.0078; train_cond_contrastive_loss: 78822.5801; train_gene_expr_recon_loss: 97243.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454463.6875; train_optim_loss: 454463.6875; val_kl_reg_loss: 6105.1924; val_edge_recon_loss: 272672.0625; val_cond_contrastive_loss: 78437.0312; val_gene_expr_recon_loss: 96441.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453655.4688; val_optim_loss: 453655.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9295; val_auprc_score: 0.9134; val_best_acc_score: 0.8583; val_best_f1_score: 0.8674; train_kl_reg_loss: 6158.6195; train_edge_recon_loss: 272014.3672; train_cond_contrastive_loss: 78836.4023; train_gene_expr_recon_loss: 96230.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453239.4922; train_optim_loss: 453239.4922; val_kl_reg_loss: 5888.8398; val_edge_recon_loss: 271157.6875; val_cond_contrastive_loss: 78442.4609; val_gene_expr_recon_loss: 96268.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451757.9688; val_optim_loss: 451757.9688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9347; val_auprc_score: 0.9262; val_best_acc_score: 0.8635; val_best_f1_score: 0.8726; train_kl_reg_loss: 6078.5410; train_edge_recon_loss: 271106.4922; train_cond_contrastive_loss: 78762.9902; train_gene_expr_recon_loss: 96465.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452413.6641; train_optim_loss: 452413.6641; val_kl_reg_loss: 5903.3755; val_edge_recon_loss: 269482.9688; val_cond_contrastive_loss: 78441.7578; val_gene_expr_recon_loss: 96079.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449907.8750; val_optim_loss: 449907.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9401; val_auprc_score: 0.9292; val_best_acc_score: 0.8717; val_best_f1_score: 0.8745; train_kl_reg_loss: 6127.3734; train_edge_recon_loss: 269722.3594; train_cond_contrastive_loss: 78696.1758; train_gene_expr_recon_loss: 96102.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450648.6406; train_optim_loss: 450648.6406; val_kl_reg_loss: 5989.5791; val_edge_recon_loss: 274057.5625; val_cond_contrastive_loss: 78435.7109; val_gene_expr_recon_loss: 95892.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454375.6250; val_optim_loss: 454375.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9434; val_auprc_score: 0.9287; val_best_acc_score: 0.8782; val_best_f1_score: 0.8836; train_kl_reg_loss: 6227.1100; train_edge_recon_loss: 268804.7969; train_cond_contrastive_loss: 78652.1270; train_gene_expr_recon_loss: 95650.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449334.4844; train_optim_loss: 449334.4844; val_kl_reg_loss: 6077.9033; val_edge_recon_loss: 270132.0625; val_cond_contrastive_loss: 78430.5938; val_gene_expr_recon_loss: 95707.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450348.0312; val_optim_loss: 450348.0312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9518; val_auprc_score: 0.9385; val_best_acc_score: 0.8894; val_best_f1_score: 0.8939; train_kl_reg_loss: 6200.9805; train_edge_recon_loss: 267785.4766; train_cond_contrastive_loss: 78647.9688; train_gene_expr_recon_loss: 95507.3027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448141.7266; train_optim_loss: 448141.7266; val_kl_reg_loss: 5951.9512; val_edge_recon_loss: 269284.0000; val_cond_contrastive_loss: 78431.5859; val_gene_expr_recon_loss: 95528.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449195.7500; val_optim_loss: 449195.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9548; val_auprc_score: 0.9418; val_best_acc_score: 0.8964; val_best_f1_score: 0.9003; train_kl_reg_loss: 6115.6411; train_edge_recon_loss: 268655.7812; train_cond_contrastive_loss: 78666.1270; train_gene_expr_recon_loss: 95060.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448497.6953; train_optim_loss: 448497.6953; val_kl_reg_loss: 5892.7148; val_edge_recon_loss: 268436.9062; val_cond_contrastive_loss: 78430.4141; val_gene_expr_recon_loss: 95375.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448135.1250; val_optim_loss: 448135.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9626; val_auprc_score: 0.9544; val_best_acc_score: 0.9087; val_best_f1_score: 0.9129; train_kl_reg_loss: 6014.3793; train_edge_recon_loss: 267361.2109; train_cond_contrastive_loss: 78694.2637; train_gene_expr_recon_loss: 95421.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447491.7344; train_optim_loss: 447491.7344; val_kl_reg_loss: 5822.5742; val_edge_recon_loss: 264256.1875; val_cond_contrastive_loss: 78434.3281; val_gene_expr_recon_loss: 95194.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443707.3750; val_optim_loss: 443707.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9639; val_auprc_score: 0.9551; val_best_acc_score: 0.9130; val_best_f1_score: 0.9167; train_kl_reg_loss: 5945.9879; train_edge_recon_loss: 267337.1172; train_cond_contrastive_loss: 78705.0586; train_gene_expr_recon_loss: 95148.7754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447136.9375; train_optim_loss: 447136.9375; val_kl_reg_loss: 5732.7998; val_edge_recon_loss: 264714.7500; val_cond_contrastive_loss: 78438.0000; val_gene_expr_recon_loss: 94999.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443885.1875; val_optim_loss: 443885.1875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9690; val_auprc_score: 0.9609; val_best_acc_score: 0.9169; val_best_f1_score: 0.9188; train_kl_reg_loss: 5893.5457; train_edge_recon_loss: 265968.6172; train_cond_contrastive_loss: 78729.3301; train_gene_expr_recon_loss: 94829.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445421.0938; train_optim_loss: 445421.0938; val_kl_reg_loss: 5717.9092; val_edge_recon_loss: 270530.6562; val_cond_contrastive_loss: 78438.5156; val_gene_expr_recon_loss: 94826.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449513.3750; val_optim_loss: 449513.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9756; val_auprc_score: 0.9699; val_best_acc_score: 0.9273; val_best_f1_score: 0.9286; train_kl_reg_loss: 5892.5642; train_edge_recon_loss: 264848.7578; train_cond_contrastive_loss: 78731.1621; train_gene_expr_recon_loss: 94407.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443880.0469; train_optim_loss: 443880.0469; val_kl_reg_loss: 5712.6865; val_edge_recon_loss: 263098.5625; val_cond_contrastive_loss: 78436.2422; val_gene_expr_recon_loss: 94652.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441900.3125; val_optim_loss: 441900.3125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9717; val_auprc_score: 0.9582; val_best_acc_score: 0.9238; val_best_f1_score: 0.9270; train_kl_reg_loss: 5854.7358; train_edge_recon_loss: 264466.9141; train_cond_contrastive_loss: 78774.9746; train_gene_expr_recon_loss: 93933.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443030.1953; train_optim_loss: 443030.1953; val_kl_reg_loss: 5687.3960; val_edge_recon_loss: 262826.6562; val_cond_contrastive_loss: 78437.2734; val_gene_expr_recon_loss: 94485.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441437.0625; val_optim_loss: 441437.0625
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9782; val_auprc_score: 0.9719; val_best_acc_score: 0.9342; val_best_f1_score: 0.9361; train_kl_reg_loss: 5866.7128; train_edge_recon_loss: 263258.6250; train_cond_contrastive_loss: 78767.0664; train_gene_expr_recon_loss: 94158.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442050.5312; train_optim_loss: 442050.5312; val_kl_reg_loss: 5751.8584; val_edge_recon_loss: 262843.6875; val_cond_contrastive_loss: 78437.2812; val_gene_expr_recon_loss: 94309.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441342.1875; val_optim_loss: 441342.1875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9774; val_auprc_score: 0.9674; val_best_acc_score: 0.9354; val_best_f1_score: 0.9378; train_kl_reg_loss: 5910.0449; train_edge_recon_loss: 262429.1445; train_cond_contrastive_loss: 78757.9238; train_gene_expr_recon_loss: 94285.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441382.5547; train_optim_loss: 441382.5547; val_kl_reg_loss: 5730.8750; val_edge_recon_loss: 258172.6562; val_cond_contrastive_loss: 78438.3594; val_gene_expr_recon_loss: 94145.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436487.6250; val_optim_loss: 436487.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9783; val_auprc_score: 0.9701; val_best_acc_score: 0.9384; val_best_f1_score: 0.9394; train_kl_reg_loss: 5919.3304; train_edge_recon_loss: 261653.7383; train_cond_contrastive_loss: 78758.4375; train_gene_expr_recon_loss: 93875.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440207.0000; train_optim_loss: 440207.0000; val_kl_reg_loss: 5774.9971; val_edge_recon_loss: 262888.6875; val_cond_contrastive_loss: 78436.9297; val_gene_expr_recon_loss: 93973.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441074.5625; val_optim_loss: 441074.5625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9791; val_auprc_score: 0.9717; val_best_acc_score: 0.9353; val_best_f1_score: 0.9368; train_kl_reg_loss: 5918.3175; train_edge_recon_loss: 261463.7227; train_cond_contrastive_loss: 78749.8887; train_gene_expr_recon_loss: 93497.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439629.5859; train_optim_loss: 439629.5859; val_kl_reg_loss: 5755.2617; val_edge_recon_loss: 260025.1094; val_cond_contrastive_loss: 78436.7812; val_gene_expr_recon_loss: 93788.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438005.4375; val_optim_loss: 438005.4375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9832; val_auprc_score: 0.9782; val_best_acc_score: 0.9436; val_best_f1_score: 0.9453; train_kl_reg_loss: 5883.5648; train_edge_recon_loss: 262216.7578; train_cond_contrastive_loss: 78757.2031; train_gene_expr_recon_loss: 93278.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440136.1016; train_optim_loss: 440136.1016; val_kl_reg_loss: 5728.1187; val_edge_recon_loss: 256545.6875; val_cond_contrastive_loss: 78436.6875; val_gene_expr_recon_loss: 93610.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434320.6250; val_optim_loss: 434320.6250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9833; val_auprc_score: 0.9763; val_best_acc_score: 0.9449; val_best_f1_score: 0.9461; train_kl_reg_loss: 5872.5522; train_edge_recon_loss: 261434.4648; train_cond_contrastive_loss: 78747.0625; train_gene_expr_recon_loss: 93016.9941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439071.0625; train_optim_loss: 439071.0625; val_kl_reg_loss: 5741.9346; val_edge_recon_loss: 261419.2031; val_cond_contrastive_loss: 78436.5234; val_gene_expr_recon_loss: 93449.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439047.6250; val_optim_loss: 439047.6250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9827; val_auprc_score: 0.9775; val_best_acc_score: 0.9479; val_best_f1_score: 0.9491; train_kl_reg_loss: 5904.2467; train_edge_recon_loss: 260816.6953; train_cond_contrastive_loss: 78742.7266; train_gene_expr_recon_loss: 93378.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438842.3750; train_optim_loss: 438842.3750; val_kl_reg_loss: 5730.4932; val_edge_recon_loss: 257986.5156; val_cond_contrastive_loss: 78436.3828; val_gene_expr_recon_loss: 93300.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435454.0938; val_optim_loss: 435454.0938
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9829; val_auprc_score: 0.9765; val_best_acc_score: 0.9448; val_best_f1_score: 0.9457; train_kl_reg_loss: 5877.4305; train_edge_recon_loss: 261885.7930; train_cond_contrastive_loss: 78744.2520; train_gene_expr_recon_loss: 92957.0996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439464.5703; train_optim_loss: 439464.5703; val_kl_reg_loss: 5704.9941; val_edge_recon_loss: 266189.5938; val_cond_contrastive_loss: 78434.0078; val_gene_expr_recon_loss: 93142.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443471.5625; val_optim_loss: 443471.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9840; val_auprc_score: 0.9800; val_best_acc_score: 0.9465; val_best_f1_score: 0.9477; train_kl_reg_loss: 5858.5945; train_edge_recon_loss: 262665.2070; train_cond_contrastive_loss: 78733.5879; train_gene_expr_recon_loss: 93446.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440703.4062; train_optim_loss: 440703.4062; val_kl_reg_loss: 5687.5342; val_edge_recon_loss: 261795.5156; val_cond_contrastive_loss: 78435.9062; val_gene_expr_recon_loss: 93112.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439031.7500; val_optim_loss: 439031.7500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9834; val_auprc_score: 0.9794; val_best_acc_score: 0.9441; val_best_f1_score: 0.9453; train_kl_reg_loss: 5842.9025; train_edge_recon_loss: 261254.3633; train_cond_contrastive_loss: 78744.4316; train_gene_expr_recon_loss: 92968.4160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438810.1172; train_optim_loss: 438810.1172; val_kl_reg_loss: 5691.7349; val_edge_recon_loss: 262780.6562; val_cond_contrastive_loss: 78435.8125; val_gene_expr_recon_loss: 93086.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439994.3750; val_optim_loss: 439994.3750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9852; val_auprc_score: 0.9805; val_best_acc_score: 0.9493; val_best_f1_score: 0.9499; train_kl_reg_loss: 5849.8590; train_edge_recon_loss: 260929.4922; train_cond_contrastive_loss: 78742.2422; train_gene_expr_recon_loss: 92855.9043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438377.4844; train_optim_loss: 438377.4844; val_kl_reg_loss: 5703.6270; val_edge_recon_loss: 262439.1562; val_cond_contrastive_loss: 78435.2969; val_gene_expr_recon_loss: 93059.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439637.1250; val_optim_loss: 439637.1250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 22 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9816
Val AUPRC score: 0.9747
Val best accuracy score: 0.9416
Val best F1 score: 0.9430
Val gene expr MSE score: 1.6037
Duration of model training in run 3: 0 hours, 1 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7340; val_auprc_score: 0.7829; val_best_acc_score: 0.6795; val_best_f1_score: 0.6956; train_kl_reg_loss: 1893.7504; train_edge_recon_loss: 357595.5078; train_cond_contrastive_loss: 119305.6719; train_gene_expr_recon_loss: 129626.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 608421.0781; train_optim_loss: 608421.0781; val_kl_reg_loss: 4720.3994; val_edge_recon_loss: 397050.3125; val_cond_contrastive_loss: 78357.2891; val_gene_expr_recon_loss: 108909.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 589037.3125; val_optim_loss: 589037.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7030; val_auprc_score: 0.7478; val_best_acc_score: 0.6364; val_best_f1_score: 0.6881; train_kl_reg_loss: 10566.2148; train_edge_recon_loss: 364421.7500; train_cond_contrastive_loss: 87635.7676; train_gene_expr_recon_loss: 107715.8379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 570339.5625; train_optim_loss: 570339.5625; val_kl_reg_loss: 9230.5801; val_edge_recon_loss: 395585.0625; val_cond_contrastive_loss: 78374.9375; val_gene_expr_recon_loss: 103801.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 586992.2500; val_optim_loss: 586992.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6855; val_auprc_score: 0.7230; val_best_acc_score: 0.6185; val_best_f1_score: 0.6863; train_kl_reg_loss: 7140.2935; train_edge_recon_loss: 357961.8750; train_cond_contrastive_loss: 87509.3984; train_gene_expr_recon_loss: 103802.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556414.3750; train_optim_loss: 556414.3750; val_kl_reg_loss: 4870.9922; val_edge_recon_loss: 382562.0312; val_cond_contrastive_loss: 78435.3984; val_gene_expr_recon_loss: 102553.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568421.5000; val_optim_loss: 568421.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6906; val_auprc_score: 0.7268; val_best_acc_score: 0.6248; val_best_f1_score: 0.6904; train_kl_reg_loss: 4962.2152; train_edge_recon_loss: 351874.0078; train_cond_contrastive_loss: 85443.9844; train_gene_expr_recon_loss: 102301.5820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544581.7812; train_optim_loss: 544581.7812; val_kl_reg_loss: 3808.9580; val_edge_recon_loss: 350752.4688; val_cond_contrastive_loss: 78521.2031; val_gene_expr_recon_loss: 101968.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535050.7500; val_optim_loss: 535050.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6760; val_auprc_score: 0.7104; val_best_acc_score: 0.6180; val_best_f1_score: 0.6860; train_kl_reg_loss: 3478.6541; train_edge_recon_loss: 337971.3203; train_cond_contrastive_loss: 87699.7461; train_gene_expr_recon_loss: 101964.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531113.7344; train_optim_loss: 531113.7344; val_kl_reg_loss: 3189.8633; val_edge_recon_loss: 345498.5312; val_cond_contrastive_loss: 78416.0078; val_gene_expr_recon_loss: 101497.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528601.5000; val_optim_loss: 528601.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6784; val_auprc_score: 0.7186; val_best_acc_score: 0.6282; val_best_f1_score: 0.6824; train_kl_reg_loss: 3441.4138; train_edge_recon_loss: 328197.0312; train_cond_contrastive_loss: 83784.3125; train_gene_expr_recon_loss: 101079.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 516502.0938; train_optim_loss: 516502.0938; val_kl_reg_loss: 3754.1572; val_edge_recon_loss: 342776.3438; val_cond_contrastive_loss: 78396.7578; val_gene_expr_recon_loss: 100970.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 525898.1250; val_optim_loss: 525898.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7027; val_auprc_score: 0.7411; val_best_acc_score: 0.6394; val_best_f1_score: 0.6993; train_kl_reg_loss: 4031.1144; train_edge_recon_loss: 326640.0312; train_cond_contrastive_loss: 80339.8984; train_gene_expr_recon_loss: 100372.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511383.9688; train_optim_loss: 511383.9688; val_kl_reg_loss: 4144.3994; val_edge_recon_loss: 326873.0938; val_cond_contrastive_loss: 78390.3984; val_gene_expr_recon_loss: 100550.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509958.0000; val_optim_loss: 509958.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7405; val_auprc_score: 0.7561; val_best_acc_score: 0.6649; val_best_f1_score: 0.7133; train_kl_reg_loss: 4256.5953; train_edge_recon_loss: 318737.2734; train_cond_contrastive_loss: 79722.7969; train_gene_expr_recon_loss: 100139.6113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 502856.2734; train_optim_loss: 502856.2734; val_kl_reg_loss: 4292.2671; val_edge_recon_loss: 316943.3750; val_cond_contrastive_loss: 78406.6016; val_gene_expr_recon_loss: 100154.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 499796.8750; val_optim_loss: 499796.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7854; val_auprc_score: 0.7811; val_best_acc_score: 0.7020; val_best_f1_score: 0.7450; train_kl_reg_loss: 4551.7358; train_edge_recon_loss: 306058.5703; train_cond_contrastive_loss: 79618.8906; train_gene_expr_recon_loss: 99307.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489536.6562; train_optim_loss: 489536.6562; val_kl_reg_loss: 4910.7725; val_edge_recon_loss: 303571.1875; val_cond_contrastive_loss: 78429.9375; val_gene_expr_recon_loss: 99723.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486635.8125; val_optim_loss: 486635.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8191; val_auprc_score: 0.8068; val_best_acc_score: 0.7387; val_best_f1_score: 0.7752; train_kl_reg_loss: 5396.6711; train_edge_recon_loss: 292765.8828; train_cond_contrastive_loss: 79148.5059; train_gene_expr_recon_loss: 99156.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476467.7344; train_optim_loss: 476467.7344; val_kl_reg_loss: 5979.4922; val_edge_recon_loss: 292325.6875; val_cond_contrastive_loss: 78430.2500; val_gene_expr_recon_loss: 99096.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475832.0000; val_optim_loss: 475832.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8439; val_auprc_score: 0.8269; val_best_acc_score: 0.7598; val_best_f1_score: 0.7928; train_kl_reg_loss: 6489.9631; train_edge_recon_loss: 284415.4062; train_cond_contrastive_loss: 78820.2285; train_gene_expr_recon_loss: 99207.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468933.2188; train_optim_loss: 468933.2188; val_kl_reg_loss: 6811.5933; val_edge_recon_loss: 285224.4688; val_cond_contrastive_loss: 78416.5703; val_gene_expr_recon_loss: 98560.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469012.6875; val_optim_loss: 469012.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8534; val_auprc_score: 0.8293; val_best_acc_score: 0.7784; val_best_f1_score: 0.8040; train_kl_reg_loss: 7137.3516; train_edge_recon_loss: 283092.7578; train_cond_contrastive_loss: 78727.8594; train_gene_expr_recon_loss: 98108.7324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467066.7031; train_optim_loss: 467066.7031; val_kl_reg_loss: 7014.5493; val_edge_recon_loss: 282746.6875; val_cond_contrastive_loss: 78404.5469; val_gene_expr_recon_loss: 98137.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466303.6562; val_optim_loss: 466303.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8614; val_auprc_score: 0.8330; val_best_acc_score: 0.7926; val_best_f1_score: 0.8136; train_kl_reg_loss: 7118.3595; train_edge_recon_loss: 278160.6953; train_cond_contrastive_loss: 78773.2363; train_gene_expr_recon_loss: 97946.6934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461998.9844; train_optim_loss: 461998.9844; val_kl_reg_loss: 6755.2690; val_edge_recon_loss: 280301.7812; val_cond_contrastive_loss: 78403.0156; val_gene_expr_recon_loss: 97743.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463203.5625; val_optim_loss: 463203.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8778; val_auprc_score: 0.8483; val_best_acc_score: 0.8112; val_best_f1_score: 0.8319; train_kl_reg_loss: 6820.4207; train_edge_recon_loss: 279689.1094; train_cond_contrastive_loss: 78860.3945; train_gene_expr_recon_loss: 97560.7754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462930.7109; train_optim_loss: 462930.7109; val_kl_reg_loss: 6536.8936; val_edge_recon_loss: 278304.5312; val_cond_contrastive_loss: 78407.1953; val_gene_expr_recon_loss: 97473.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460721.7500; val_optim_loss: 460721.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8915; val_auprc_score: 0.8645; val_best_acc_score: 0.8271; val_best_f1_score: 0.8440; train_kl_reg_loss: 6730.6875; train_edge_recon_loss: 275944.4453; train_cond_contrastive_loss: 78862.6270; train_gene_expr_recon_loss: 97464.4629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459002.2188; train_optim_loss: 459002.2188; val_kl_reg_loss: 6559.6436; val_edge_recon_loss: 273132.3750; val_cond_contrastive_loss: 78412.3203; val_gene_expr_recon_loss: 97211.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455316.0000; val_optim_loss: 455316.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9071; val_auprc_score: 0.8889; val_best_acc_score: 0.8332; val_best_f1_score: 0.8494; train_kl_reg_loss: 6716.6985; train_edge_recon_loss: 274569.5391; train_cond_contrastive_loss: 78829.1426; train_gene_expr_recon_loss: 96881.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456997.3203; train_optim_loss: 456997.3203; val_kl_reg_loss: 6462.9097; val_edge_recon_loss: 273152.8125; val_cond_contrastive_loss: 78428.6016; val_gene_expr_recon_loss: 96955.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454999.3750; val_optim_loss: 454999.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9153; val_auprc_score: 0.8977; val_best_acc_score: 0.8431; val_best_f1_score: 0.8557; train_kl_reg_loss: 6539.5414; train_edge_recon_loss: 272304.8828; train_cond_contrastive_loss: 78847.7520; train_gene_expr_recon_loss: 96879.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454572.1172; train_optim_loss: 454572.1172; val_kl_reg_loss: 6240.5576; val_edge_recon_loss: 272275.6562; val_cond_contrastive_loss: 78442.9688; val_gene_expr_recon_loss: 96713.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453672.3750; val_optim_loss: 453672.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9290; val_auprc_score: 0.9121; val_best_acc_score: 0.8545; val_best_f1_score: 0.8650; train_kl_reg_loss: 6312.0530; train_edge_recon_loss: 273339.8047; train_cond_contrastive_loss: 78896.3555; train_gene_expr_recon_loss: 96465.9473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455014.1484; train_optim_loss: 455014.1484; val_kl_reg_loss: 6083.1885; val_edge_recon_loss: 273221.9062; val_cond_contrastive_loss: 78446.4141; val_gene_expr_recon_loss: 96474.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454225.8125; val_optim_loss: 454225.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9425; val_auprc_score: 0.9332; val_best_acc_score: 0.8726; val_best_f1_score: 0.8787; train_kl_reg_loss: 6215.2408; train_edge_recon_loss: 270433.8906; train_cond_contrastive_loss: 78884.4316; train_gene_expr_recon_loss: 96086.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451620.5703; train_optim_loss: 451620.5703; val_kl_reg_loss: 6128.4893; val_edge_recon_loss: 267265.1562; val_cond_contrastive_loss: 78452.6016; val_gene_expr_recon_loss: 96250.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448097.2188; val_optim_loss: 448097.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9467; val_auprc_score: 0.9355; val_best_acc_score: 0.8807; val_best_f1_score: 0.8859; train_kl_reg_loss: 6271.9337; train_edge_recon_loss: 269716.4297; train_cond_contrastive_loss: 78814.4941; train_gene_expr_recon_loss: 95702.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450504.8750; train_optim_loss: 450504.8750; val_kl_reg_loss: 6173.0732; val_edge_recon_loss: 267735.5625; val_cond_contrastive_loss: 78452.8516; val_gene_expr_recon_loss: 96027.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448388.7812; val_optim_loss: 448388.7812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9497; val_auprc_score: 0.9332; val_best_acc_score: 0.8893; val_best_f1_score: 0.8932; train_kl_reg_loss: 6271.7460; train_edge_recon_loss: 271179.3984; train_cond_contrastive_loss: 78765.7734; train_gene_expr_recon_loss: 95777.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451994.3438; train_optim_loss: 451994.3438; val_kl_reg_loss: 6122.2583; val_edge_recon_loss: 269297.7812; val_cond_contrastive_loss: 78449.4766; val_gene_expr_recon_loss: 95811.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449680.8438; val_optim_loss: 449680.8438
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9574; val_auprc_score: 0.9498; val_best_acc_score: 0.8993; val_best_f1_score: 0.9022; train_kl_reg_loss: 6223.0029; train_edge_recon_loss: 267915.2578; train_cond_contrastive_loss: 78742.6777; train_gene_expr_recon_loss: 95507.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448388.5781; train_optim_loss: 448388.5781; val_kl_reg_loss: 6046.4756; val_edge_recon_loss: 265954.8750; val_cond_contrastive_loss: 78446.3672; val_gene_expr_recon_loss: 95558.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446006.5938; val_optim_loss: 446006.5938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9612; val_auprc_score: 0.9504; val_best_acc_score: 0.9026; val_best_f1_score: 0.9062; train_kl_reg_loss: 6150.9196; train_edge_recon_loss: 266985.9219; train_cond_contrastive_loss: 78726.7559; train_gene_expr_recon_loss: 95009.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446873.2188; train_optim_loss: 446873.2188; val_kl_reg_loss: 5984.2192; val_edge_recon_loss: 266267.6250; val_cond_contrastive_loss: 78446.1641; val_gene_expr_recon_loss: 95311.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446009.1562; val_optim_loss: 446009.1562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9608; val_auprc_score: 0.9500; val_best_acc_score: 0.9076; val_best_f1_score: 0.9119; train_kl_reg_loss: 6106.0894; train_edge_recon_loss: 267161.5703; train_cond_contrastive_loss: 78715.1660; train_gene_expr_recon_loss: 95250.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447232.9453; train_optim_loss: 447232.9453; val_kl_reg_loss: 5924.5264; val_edge_recon_loss: 266084.5312; val_cond_contrastive_loss: 78449.5234; val_gene_expr_recon_loss: 95051.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445510.4375; val_optim_loss: 445510.4375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9673; val_auprc_score: 0.9616; val_best_acc_score: 0.9155; val_best_f1_score: 0.9185; train_kl_reg_loss: 5962.7988; train_edge_recon_loss: 265448.4531; train_cond_contrastive_loss: 78743.8770; train_gene_expr_recon_loss: 94589.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444744.5156; train_optim_loss: 444744.5156; val_kl_reg_loss: 5806.6709; val_edge_recon_loss: 268352.4062; val_cond_contrastive_loss: 78448.3438; val_gene_expr_recon_loss: 94825.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447433.3438; val_optim_loss: 447433.3438
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9715; val_auprc_score: 0.9678; val_best_acc_score: 0.9153; val_best_f1_score: 0.9192; train_kl_reg_loss: 5937.8783; train_edge_recon_loss: 265746.2969; train_cond_contrastive_loss: 78731.5586; train_gene_expr_recon_loss: 94655.5117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445071.2500; train_optim_loss: 445071.2500; val_kl_reg_loss: 5816.6758; val_edge_recon_loss: 264795.6250; val_cond_contrastive_loss: 78449.6172; val_gene_expr_recon_loss: 94642.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443704.2500; val_optim_loss: 443704.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9755; val_auprc_score: 0.9714; val_best_acc_score: 0.9255; val_best_f1_score: 0.9282; train_kl_reg_loss: 5945.1666; train_edge_recon_loss: 266069.2109; train_cond_contrastive_loss: 78735.9219; train_gene_expr_recon_loss: 94072.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444823.2578; train_optim_loss: 444823.2578; val_kl_reg_loss: 5751.9062; val_edge_recon_loss: 261660.7500; val_cond_contrastive_loss: 78450.4375; val_gene_expr_recon_loss: 94454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440317.0938; val_optim_loss: 440317.0938
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9724; val_auprc_score: 0.9643; val_best_acc_score: 0.9208; val_best_f1_score: 0.9241; train_kl_reg_loss: 5851.8665; train_edge_recon_loss: 263527.3320; train_cond_contrastive_loss: 78771.5723; train_gene_expr_recon_loss: 93654.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441805.3750; train_optim_loss: 441805.3750; val_kl_reg_loss: 5755.8516; val_edge_recon_loss: 265333.7500; val_cond_contrastive_loss: 78447.1719; val_gene_expr_recon_loss: 94288.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443825.3750; val_optim_loss: 443825.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9793; val_auprc_score: 0.9753; val_best_acc_score: 0.9303; val_best_f1_score: 0.9332; train_kl_reg_loss: 5932.9775; train_edge_recon_loss: 263565.5312; train_cond_contrastive_loss: 78770.1484; train_gene_expr_recon_loss: 94167.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442436.4219; train_optim_loss: 442436.4219; val_kl_reg_loss: 5859.8472; val_edge_recon_loss: 260295.1250; val_cond_contrastive_loss: 78445.9297; val_gene_expr_recon_loss: 94107.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438708.0312; val_optim_loss: 438708.0312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9777; val_auprc_score: 0.9736; val_best_acc_score: 0.9311; val_best_f1_score: 0.9323; train_kl_reg_loss: 5962.4398; train_edge_recon_loss: 262390.2148; train_cond_contrastive_loss: 78782.2539; train_gene_expr_recon_loss: 93903.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441038.0625; train_optim_loss: 441038.0625; val_kl_reg_loss: 5790.8008; val_edge_recon_loss: 263562.3750; val_cond_contrastive_loss: 78444.0781; val_gene_expr_recon_loss: 93926.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441723.3438; val_optim_loss: 441723.3438
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9781; val_auprc_score: 0.9742; val_best_acc_score: 0.9313; val_best_f1_score: 0.9338; train_kl_reg_loss: 5936.8102; train_edge_recon_loss: 262739.7539; train_cond_contrastive_loss: 78786.0840; train_gene_expr_recon_loss: 94167.7324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441630.3750; train_optim_loss: 441630.3750; val_kl_reg_loss: 5808.1548; val_edge_recon_loss: 261189.1406; val_cond_contrastive_loss: 78444.8672; val_gene_expr_recon_loss: 93737.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439179.8438; val_optim_loss: 439179.8438
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9803; val_auprc_score: 0.9738; val_best_acc_score: 0.9372; val_best_f1_score: 0.9397; train_kl_reg_loss: 5959.3905; train_edge_recon_loss: 261665.0547; train_cond_contrastive_loss: 78785.8926; train_gene_expr_recon_loss: 93469.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439880.1484; train_optim_loss: 439880.1484; val_kl_reg_loss: 5791.7705; val_edge_recon_loss: 259930.9062; val_cond_contrastive_loss: 78446.7500; val_gene_expr_recon_loss: 93562.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437732.2500; val_optim_loss: 437732.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9804; val_auprc_score: 0.9738; val_best_acc_score: 0.9404; val_best_f1_score: 0.9421; train_kl_reg_loss: 5928.4266; train_edge_recon_loss: 262763.0273; train_cond_contrastive_loss: 78791.7930; train_gene_expr_recon_loss: 93137.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440620.2891; train_optim_loss: 440620.2891; val_kl_reg_loss: 5797.2568; val_edge_recon_loss: 262612.4375; val_cond_contrastive_loss: 78449.8281; val_gene_expr_recon_loss: 93378.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440238.1562; val_optim_loss: 440238.1562
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9806; val_auprc_score: 0.9711; val_best_acc_score: 0.9419; val_best_f1_score: 0.9437; train_kl_reg_loss: 5963.3101; train_edge_recon_loss: 261138.5000; train_cond_contrastive_loss: 78789.1094; train_gene_expr_recon_loss: 93484.0762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439374.9922; train_optim_loss: 439374.9922; val_kl_reg_loss: 5797.5415; val_edge_recon_loss: 260937.4844; val_cond_contrastive_loss: 78450.2109; val_gene_expr_recon_loss: 93209.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438394.7500; val_optim_loss: 438394.7500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9812; val_auprc_score: 0.9756; val_best_acc_score: 0.9439; val_best_f1_score: 0.9458; train_kl_reg_loss: 5920.8336; train_edge_recon_loss: 261160.3477; train_cond_contrastive_loss: 78794.8379; train_gene_expr_recon_loss: 92770.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438646.3359; train_optim_loss: 438646.3359; val_kl_reg_loss: 5758.5576; val_edge_recon_loss: 260040.6406; val_cond_contrastive_loss: 78449.9844; val_gene_expr_recon_loss: 93052.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437302.0000; val_optim_loss: 437302.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9846; val_auprc_score: 0.9816; val_best_acc_score: 0.9410; val_best_f1_score: 0.9417; train_kl_reg_loss: 5905.9052; train_edge_recon_loss: 262162.2344; train_cond_contrastive_loss: 78798.2891; train_gene_expr_recon_loss: 93189.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440056.0547; train_optim_loss: 440056.0547; val_kl_reg_loss: 5799.7510; val_edge_recon_loss: 265139.0938; val_cond_contrastive_loss: 78449.7031; val_gene_expr_recon_loss: 92888.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442276.7188; val_optim_loss: 442276.7188
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9836; val_auprc_score: 0.9802; val_best_acc_score: 0.9456; val_best_f1_score: 0.9475; train_kl_reg_loss: 5924.5522; train_edge_recon_loss: 260680.7812; train_cond_contrastive_loss: 78790.1914; train_gene_expr_recon_loss: 92624.2559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438019.7734; train_optim_loss: 438019.7734; val_kl_reg_loss: 5786.3008; val_edge_recon_loss: 258601.7812; val_cond_contrastive_loss: 78451.7891; val_gene_expr_recon_loss: 92735.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435575.6875; val_optim_loss: 435575.6875
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9846; val_auprc_score: 0.9772; val_best_acc_score: 0.9455; val_best_f1_score: 0.9465; train_kl_reg_loss: 5910.0435; train_edge_recon_loss: 260382.7695; train_cond_contrastive_loss: 78796.4180; train_gene_expr_recon_loss: 92672.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437761.9453; train_optim_loss: 437761.9453; val_kl_reg_loss: 5757.1904; val_edge_recon_loss: 261692.3125; val_cond_contrastive_loss: 78452.9297; val_gene_expr_recon_loss: 92599.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438502.2500; val_optim_loss: 438502.2500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9853; val_auprc_score: 0.9812; val_best_acc_score: 0.9487; val_best_f1_score: 0.9499; train_kl_reg_loss: 5885.4839; train_edge_recon_loss: 260514.8750; train_cond_contrastive_loss: 78799.9922; train_gene_expr_recon_loss: 92253.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437453.8750; train_optim_loss: 437453.8750; val_kl_reg_loss: 5762.2598; val_edge_recon_loss: 261150.5625; val_cond_contrastive_loss: 78455.0156; val_gene_expr_recon_loss: 92446.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437814.1875; val_optim_loss: 437814.1875
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9865; val_auprc_score: 0.9844; val_best_acc_score: 0.9500; val_best_f1_score: 0.9523; train_kl_reg_loss: 5906.1885; train_edge_recon_loss: 261205.8672; train_cond_contrastive_loss: 78791.6074; train_gene_expr_recon_loss: 92019.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437923.2188; train_optim_loss: 437923.2188; val_kl_reg_loss: 5772.8701; val_edge_recon_loss: 256975.2656; val_cond_contrastive_loss: 78455.6328; val_gene_expr_recon_loss: 92300.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433504.4688; val_optim_loss: 433504.4688
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9866; val_auprc_score: 0.9802; val_best_acc_score: 0.9507; val_best_f1_score: 0.9521; train_kl_reg_loss: 5928.1331; train_edge_recon_loss: 260179.5000; train_cond_contrastive_loss: 78778.0586; train_gene_expr_recon_loss: 91821.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436706.7109; train_optim_loss: 436706.7109; val_kl_reg_loss: 5758.5723; val_edge_recon_loss: 259636.5469; val_cond_contrastive_loss: 78452.1562; val_gene_expr_recon_loss: 92142.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435989.5000; val_optim_loss: 435989.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9858; val_auprc_score: 0.9802; val_best_acc_score: 0.9530; val_best_f1_score: 0.9545; train_kl_reg_loss: 5867.6052; train_edge_recon_loss: 260707.8359; train_cond_contrastive_loss: 78786.7949; train_gene_expr_recon_loss: 91598.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436961.1484; train_optim_loss: 436961.1484; val_kl_reg_loss: 5718.0503; val_edge_recon_loss: 259237.3125; val_cond_contrastive_loss: 78455.1797; val_gene_expr_recon_loss: 92014.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435425.2188; val_optim_loss: 435425.2188
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9874; val_auprc_score: 0.9828; val_best_acc_score: 0.9538; val_best_f1_score: 0.9549; train_kl_reg_loss: 5845.9479; train_edge_recon_loss: 261954.5312; train_cond_contrastive_loss: 78774.5234; train_gene_expr_recon_loss: 91501.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438076.7109; train_optim_loss: 438076.7109; val_kl_reg_loss: 5714.0986; val_edge_recon_loss: 259983.2656; val_cond_contrastive_loss: 78456.4375; val_gene_expr_recon_loss: 91884.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436038.6875; val_optim_loss: 436038.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9860; val_auprc_score: 0.9819; val_best_acc_score: 0.9522; val_best_f1_score: 0.9534; train_kl_reg_loss: 5851.7162; train_edge_recon_loss: 261102.2578; train_cond_contrastive_loss: 78773.2168; train_gene_expr_recon_loss: 91647.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437374.4062; train_optim_loss: 437374.4062; val_kl_reg_loss: 5712.3750; val_edge_recon_loss: 261117.4531; val_cond_contrastive_loss: 78456.1172; val_gene_expr_recon_loss: 91857.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437143.2500; val_optim_loss: 437143.2500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9883; val_auprc_score: 0.9853; val_best_acc_score: 0.9561; val_best_f1_score: 0.9572; train_kl_reg_loss: 5839.3778; train_edge_recon_loss: 260983.1289; train_cond_contrastive_loss: 78766.0000; train_gene_expr_recon_loss: 90952.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436540.6641; train_optim_loss: 436540.6641; val_kl_reg_loss: 5716.6260; val_edge_recon_loss: 260491.0469; val_cond_contrastive_loss: 78455.4922; val_gene_expr_recon_loss: 91828.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436491.7500; val_optim_loss: 436491.7500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9886; val_auprc_score: 0.9857; val_best_acc_score: 0.9536; val_best_f1_score: 0.9546; train_kl_reg_loss: 5845.5295; train_edge_recon_loss: 261944.7031; train_cond_contrastive_loss: 78760.5957; train_gene_expr_recon_loss: 91656.0137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438206.8594; train_optim_loss: 438206.8594; val_kl_reg_loss: 5715.3828; val_edge_recon_loss: 261860.8750; val_cond_contrastive_loss: 78454.3984; val_gene_expr_recon_loss: 91802.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437833.5312; val_optim_loss: 437833.5312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 36 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
Val AUROC score: 0.9840
Val AUPRC score: 0.9766
Val best accuracy score: 0.9485
Val best F1 score: 0.9494
Val gene expr MSE score: 1.4450
Duration of model training in run 4: 0 hours, 1 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7831; val_auprc_score: 0.8200; val_best_acc_score: 0.7058; val_best_f1_score: 0.7055; train_kl_reg_loss: 3385.5333; train_edge_recon_loss: 356885.6406; train_cond_contrastive_loss: 109999.6784; train_gene_expr_recon_loss: 120289.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 590560.7500; train_optim_loss: 590560.7500; val_kl_reg_loss: 14531.2031; val_edge_recon_loss: 399807.2500; val_cond_contrastive_loss: 78340.1719; val_gene_expr_recon_loss: 103142.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595821.5000; val_optim_loss: 595821.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7314; val_auprc_score: 0.7628; val_best_acc_score: 0.6474; val_best_f1_score: 0.6983; train_kl_reg_loss: 9763.1355; train_edge_recon_loss: 357365.9948; train_cond_contrastive_loss: 87797.5833; train_gene_expr_recon_loss: 102842.6341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557769.3542; train_optim_loss: 557769.3542; val_kl_reg_loss: 5311.6035; val_edge_recon_loss: 393154.8438; val_cond_contrastive_loss: 78365.5703; val_gene_expr_recon_loss: 100444.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 577276.3750; val_optim_loss: 577276.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7293; val_auprc_score: 0.7494; val_best_acc_score: 0.6536; val_best_f1_score: 0.6988; train_kl_reg_loss: 4999.3468; train_edge_recon_loss: 350773.0365; train_cond_contrastive_loss: 87499.4427; train_gene_expr_recon_loss: 100387.1940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543659.0312; train_optim_loss: 543659.0312; val_kl_reg_loss: 3839.2117; val_edge_recon_loss: 356658.5000; val_cond_contrastive_loss: 78466.8047; val_gene_expr_recon_loss: 99630.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 538595.0000; val_optim_loss: 538595.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7326; val_auprc_score: 0.7592; val_best_acc_score: 0.6662; val_best_f1_score: 0.6986; train_kl_reg_loss: 3643.1034; train_edge_recon_loss: 331399.2865; train_cond_contrastive_loss: 87357.1562; train_gene_expr_recon_loss: 99629.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 522028.9740; train_optim_loss: 522028.9740; val_kl_reg_loss: 3909.8340; val_edge_recon_loss: 329158.5938; val_cond_contrastive_loss: 78387.0391; val_gene_expr_recon_loss: 98890.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 510346.4062; val_optim_loss: 510346.4062
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7781; val_auprc_score: 0.7877; val_best_acc_score: 0.6938; val_best_f1_score: 0.7275; train_kl_reg_loss: 4495.1089; train_edge_recon_loss: 314297.3229; train_cond_contrastive_loss: 79876.9427; train_gene_expr_recon_loss: 98902.8607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497572.2448; train_optim_loss: 497572.2448; val_kl_reg_loss: 5122.1143; val_edge_recon_loss: 307778.1250; val_cond_contrastive_loss: 78382.3516; val_gene_expr_recon_loss: 98151.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489434.0312; val_optim_loss: 489434.0312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8144; val_auprc_score: 0.8039; val_best_acc_score: 0.7324; val_best_f1_score: 0.7681; train_kl_reg_loss: 5582.8494; train_edge_recon_loss: 298670.2344; train_cond_contrastive_loss: 78830.8815; train_gene_expr_recon_loss: 98057.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481141.0625; train_optim_loss: 481141.0625; val_kl_reg_loss: 5982.2881; val_edge_recon_loss: 293711.2500; val_cond_contrastive_loss: 78397.7656; val_gene_expr_recon_loss: 97495.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475587.0938; val_optim_loss: 475587.0938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8433; val_auprc_score: 0.8197; val_best_acc_score: 0.7610; val_best_f1_score: 0.7903; train_kl_reg_loss: 6253.5951; train_edge_recon_loss: 286576.8333; train_cond_contrastive_loss: 78711.8242; train_gene_expr_recon_loss: 97443.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468986.0052; train_optim_loss: 468986.0052; val_kl_reg_loss: 6290.8604; val_edge_recon_loss: 286213.1562; val_cond_contrastive_loss: 78392.1562; val_gene_expr_recon_loss: 96773.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467669.6875; val_optim_loss: 467669.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8643; val_auprc_score: 0.8385; val_best_acc_score: 0.7882; val_best_f1_score: 0.8078; train_kl_reg_loss: 6275.9939; train_edge_recon_loss: 282740.3438; train_cond_contrastive_loss: 78851.8385; train_gene_expr_recon_loss: 96546.5091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464414.6875; train_optim_loss: 464414.6875; val_kl_reg_loss: 6160.9551; val_edge_recon_loss: 279310.3438; val_cond_contrastive_loss: 78388.0469; val_gene_expr_recon_loss: 96216.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460075.7500; val_optim_loss: 460075.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8723; val_auprc_score: 0.8477; val_best_acc_score: 0.8054; val_best_f1_score: 0.8240; train_kl_reg_loss: 6195.9543; train_edge_recon_loss: 279264.1302; train_cond_contrastive_loss: 78968.5195; train_gene_expr_recon_loss: 96336.3659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460764.9688; train_optim_loss: 460764.9688; val_kl_reg_loss: 6170.3486; val_edge_recon_loss: 275917.4688; val_cond_contrastive_loss: 78391.6406; val_gene_expr_recon_loss: 95765.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456244.7812; val_optim_loss: 456244.7812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8943; val_auprc_score: 0.8673; val_best_acc_score: 0.8272; val_best_f1_score: 0.8403; train_kl_reg_loss: 6342.1372; train_edge_recon_loss: 276172.7552; train_cond_contrastive_loss: 78997.8073; train_gene_expr_recon_loss: 95780.6276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457293.3177; train_optim_loss: 457293.3177; val_kl_reg_loss: 6424.8623; val_edge_recon_loss: 276472.4062; val_cond_contrastive_loss: 78403.3047; val_gene_expr_recon_loss: 95409.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456710.4375; val_optim_loss: 456710.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9113; val_auprc_score: 0.8964; val_best_acc_score: 0.8403; val_best_f1_score: 0.8510; train_kl_reg_loss: 6366.9903; train_edge_recon_loss: 273291.9948; train_cond_contrastive_loss: 78863.0221; train_gene_expr_recon_loss: 95331.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453853.8229; train_optim_loss: 453853.8229; val_kl_reg_loss: 6037.8691; val_edge_recon_loss: 272889.7188; val_cond_contrastive_loss: 78416.3594; val_gene_expr_recon_loss: 94981.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452325.6250; val_optim_loss: 452325.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9323; val_auprc_score: 0.9182; val_best_acc_score: 0.8596; val_best_f1_score: 0.8679; train_kl_reg_loss: 5988.5521; train_edge_recon_loss: 270602.3542; train_cond_contrastive_loss: 78851.8841; train_gene_expr_recon_loss: 95057.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450500.3385; train_optim_loss: 450500.3385; val_kl_reg_loss: 5903.2104; val_edge_recon_loss: 270243.4688; val_cond_contrastive_loss: 78419.3047; val_gene_expr_recon_loss: 94659.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449225.6875; val_optim_loss: 449225.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9378; val_auprc_score: 0.9250; val_best_acc_score: 0.8677; val_best_f1_score: 0.8750; train_kl_reg_loss: 6091.9339; train_edge_recon_loss: 270858.0521; train_cond_contrastive_loss: 78739.5117; train_gene_expr_recon_loss: 94572.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450261.5677; train_optim_loss: 450261.5677; val_kl_reg_loss: 6042.1328; val_edge_recon_loss: 270160.6562; val_cond_contrastive_loss: 78416.1641; val_gene_expr_recon_loss: 94333.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448952.1875; val_optim_loss: 448952.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9482; val_auprc_score: 0.9386; val_best_acc_score: 0.8846; val_best_f1_score: 0.8879; train_kl_reg_loss: 6183.2060; train_edge_recon_loss: 270130.7500; train_cond_contrastive_loss: 78685.6094; train_gene_expr_recon_loss: 94390.5247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449390.0781; train_optim_loss: 449390.0781; val_kl_reg_loss: 6120.2920; val_edge_recon_loss: 269550.1875; val_cond_contrastive_loss: 78413.6953; val_gene_expr_recon_loss: 94011.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448095.4375; val_optim_loss: 448095.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9566; val_auprc_score: 0.9480; val_best_acc_score: 0.8956; val_best_f1_score: 0.8991; train_kl_reg_loss: 6264.5499; train_edge_recon_loss: 266863.7552; train_cond_contrastive_loss: 78672.9622; train_gene_expr_recon_loss: 94032.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445833.3854; train_optim_loss: 445833.3854; val_kl_reg_loss: 6142.6636; val_edge_recon_loss: 268043.7812; val_cond_contrastive_loss: 78412.7188; val_gene_expr_recon_loss: 93710.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446309.5625; val_optim_loss: 446309.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9605; val_auprc_score: 0.9518; val_best_acc_score: 0.9034; val_best_f1_score: 0.9060; train_kl_reg_loss: 6160.0798; train_edge_recon_loss: 267362.0521; train_cond_contrastive_loss: 78698.8581; train_gene_expr_recon_loss: 93740.3815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445961.3646; train_optim_loss: 445961.3646; val_kl_reg_loss: 5957.3682; val_edge_recon_loss: 267259.2188; val_cond_contrastive_loss: 78414.0469; val_gene_expr_recon_loss: 93414.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445045.0312; val_optim_loss: 445045.0312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9661; val_auprc_score: 0.9589; val_best_acc_score: 0.9111; val_best_f1_score: 0.9140; train_kl_reg_loss: 5998.3454; train_edge_recon_loss: 266690.6224; train_cond_contrastive_loss: 78737.1966; train_gene_expr_recon_loss: 93315.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444741.6042; train_optim_loss: 444741.6042; val_kl_reg_loss: 5891.6787; val_edge_recon_loss: 266080.5312; val_cond_contrastive_loss: 78419.3125; val_gene_expr_recon_loss: 93112.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443504.2188; val_optim_loss: 443504.2188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9746; val_auprc_score: 0.9698; val_best_acc_score: 0.9239; val_best_f1_score: 0.9257; train_kl_reg_loss: 5956.4443; train_edge_recon_loss: 264908.9688; train_cond_contrastive_loss: 78723.8958; train_gene_expr_recon_loss: 93046.8737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442636.1823; train_optim_loss: 442636.1823; val_kl_reg_loss: 5784.6938; val_edge_recon_loss: 265582.2188; val_cond_contrastive_loss: 78425.0234; val_gene_expr_recon_loss: 92862.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442654.4688; val_optim_loss: 442654.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9787; val_auprc_score: 0.9720; val_best_acc_score: 0.9324; val_best_f1_score: 0.9337; train_kl_reg_loss: 5863.0977; train_edge_recon_loss: 263741.4375; train_cond_contrastive_loss: 78725.6419; train_gene_expr_recon_loss: 92827.3919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441157.5729; train_optim_loss: 441157.5729; val_kl_reg_loss: 5749.2837; val_edge_recon_loss: 264190.8750; val_cond_contrastive_loss: 78425.4453; val_gene_expr_recon_loss: 92615.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440980.9375; val_optim_loss: 440980.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9803; val_auprc_score: 0.9754; val_best_acc_score: 0.9343; val_best_f1_score: 0.9354; train_kl_reg_loss: 5875.6882; train_edge_recon_loss: 262816.4245; train_cond_contrastive_loss: 78731.5273; train_gene_expr_recon_loss: 92877.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440300.8385; train_optim_loss: 440300.8385; val_kl_reg_loss: 5816.5938; val_edge_recon_loss: 264483.0000; val_cond_contrastive_loss: 78419.2891; val_gene_expr_recon_loss: 92394.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441113.5938; val_optim_loss: 441113.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9829; val_auprc_score: 0.9790; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 5881.6133; train_edge_recon_loss: 262799.8203; train_cond_contrastive_loss: 78736.8867; train_gene_expr_recon_loss: 92406.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439825.1823; train_optim_loss: 439825.1823; val_kl_reg_loss: 5747.5620; val_edge_recon_loss: 260316.3438; val_cond_contrastive_loss: 78412.5234; val_gene_expr_recon_loss: 92153.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436629.6562; val_optim_loss: 436629.6562
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9829; val_auprc_score: 0.9768; val_best_acc_score: 0.9429; val_best_f1_score: 0.9436; train_kl_reg_loss: 5844.0358; train_edge_recon_loss: 261885.9115; train_cond_contrastive_loss: 78745.5586; train_gene_expr_recon_loss: 92073.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438549.2656; train_optim_loss: 438549.2656; val_kl_reg_loss: 5757.8984; val_edge_recon_loss: 263829.5312; val_cond_contrastive_loss: 78406.3750; val_gene_expr_recon_loss: 91928.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439922.1875; val_optim_loss: 439922.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9834; val_auprc_score: 0.9793; val_best_acc_score: 0.9432; val_best_f1_score: 0.9440; train_kl_reg_loss: 5876.7623; train_edge_recon_loss: 262153.7995; train_cond_contrastive_loss: 78748.5026; train_gene_expr_recon_loss: 91821.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438600.3802; train_optim_loss: 438600.3802; val_kl_reg_loss: 5730.3369; val_edge_recon_loss: 262952.5625; val_cond_contrastive_loss: 78404.0938; val_gene_expr_recon_loss: 91733.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438820.6250; val_optim_loss: 438820.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9849; val_auprc_score: 0.9801; val_best_acc_score: 0.9475; val_best_f1_score: 0.9489; train_kl_reg_loss: 5844.5352; train_edge_recon_loss: 261549.8307; train_cond_contrastive_loss: 78759.5977; train_gene_expr_recon_loss: 91559.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437713.3750; train_optim_loss: 437713.3750; val_kl_reg_loss: 5738.9263; val_edge_recon_loss: 258559.8750; val_cond_contrastive_loss: 78405.9062; val_gene_expr_recon_loss: 91510.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434214.8750; val_optim_loss: 434214.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9856; val_auprc_score: 0.9818; val_best_acc_score: 0.9460; val_best_f1_score: 0.9471; train_kl_reg_loss: 5875.6154; train_edge_recon_loss: 261272.8750; train_cond_contrastive_loss: 78742.9193; train_gene_expr_recon_loss: 91297.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437189.0365; train_optim_loss: 437189.0365; val_kl_reg_loss: 5725.3257; val_edge_recon_loss: 259405.8438; val_cond_contrastive_loss: 78407.2266; val_gene_expr_recon_loss: 91274.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434812.9375; val_optim_loss: 434812.9375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9852; val_auprc_score: 0.9796; val_best_acc_score: 0.9454; val_best_f1_score: 0.9469; train_kl_reg_loss: 5829.0172; train_edge_recon_loss: 260450.6771; train_cond_contrastive_loss: 78756.6615; train_gene_expr_recon_loss: 91148.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436184.8698; train_optim_loss: 436184.8698; val_kl_reg_loss: 5747.7861; val_edge_recon_loss: 259787.5312; val_cond_contrastive_loss: 78406.8672; val_gene_expr_recon_loss: 91041.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434983.5938; val_optim_loss: 434983.5938
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9868; val_auprc_score: 0.9823; val_best_acc_score: 0.9476; val_best_f1_score: 0.9487; train_kl_reg_loss: 5901.2367; train_edge_recon_loss: 259951.9505; train_cond_contrastive_loss: 78739.9753; train_gene_expr_recon_loss: 91057.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435650.3177; train_optim_loss: 435650.3177; val_kl_reg_loss: 5740.1162; val_edge_recon_loss: 260386.6719; val_cond_contrastive_loss: 78408.6094; val_gene_expr_recon_loss: 90830.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435365.7500; val_optim_loss: 435365.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9859; val_auprc_score: 0.9817; val_best_acc_score: 0.9468; val_best_f1_score: 0.9480; train_kl_reg_loss: 5854.4517; train_edge_recon_loss: 259726.2396; train_cond_contrastive_loss: 78753.9414; train_gene_expr_recon_loss: 90909.7201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435244.3542; train_optim_loss: 435244.3542; val_kl_reg_loss: 5749.6641; val_edge_recon_loss: 260408.3438; val_cond_contrastive_loss: 78408.9844; val_gene_expr_recon_loss: 90783.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435350.4375; val_optim_loss: 435350.4375
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9850; val_auprc_score: 0.9782; val_best_acc_score: 0.9450; val_best_f1_score: 0.9459; train_kl_reg_loss: 5853.6926; train_edge_recon_loss: 260978.3594; train_cond_contrastive_loss: 78745.1185; train_gene_expr_recon_loss: 90835.7591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436412.9271; train_optim_loss: 436412.9271; val_kl_reg_loss: 5733.7041; val_edge_recon_loss: 260669.8594; val_cond_contrastive_loss: 78409.2188; val_gene_expr_recon_loss: 90758.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435571.3750; val_optim_loss: 435571.3750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9866; val_auprc_score: 0.9826; val_best_acc_score: 0.9464; val_best_f1_score: 0.9477; train_kl_reg_loss: 5821.8830; train_edge_recon_loss: 260649.5547; train_cond_contrastive_loss: 78749.8815; train_gene_expr_recon_loss: 90740.1471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435961.4583; train_optim_loss: 435961.4583; val_kl_reg_loss: 5705.2822; val_edge_recon_loss: 261769.5625; val_cond_contrastive_loss: 78408.9375; val_gene_expr_recon_loss: 90741.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436625.7500; val_optim_loss: 436625.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 30 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9845
Val AUPRC score: 0.9801
Val best accuracy score: 0.9458
Val best F1 score: 0.9467
Val gene expr MSE score: 1.4154
Duration of model training in run 5: 0 hours, 1 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7669; val_auprc_score: 0.8057; val_best_acc_score: 0.6892; val_best_f1_score: 0.7088; train_kl_reg_loss: 4864.5321; train_edge_recon_loss: 355473.0573; train_cond_contrastive_loss: 110292.1615; train_gene_expr_recon_loss: 124857.2799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 595487.0208; train_optim_loss: 595487.0208; val_kl_reg_loss: 12259.9561; val_edge_recon_loss: 395671.3125; val_cond_contrastive_loss: 78340.0547; val_gene_expr_recon_loss: 105117.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 591388.6250; val_optim_loss: 591388.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7280; val_auprc_score: 0.7589; val_best_acc_score: 0.6447; val_best_f1_score: 0.7013; train_kl_reg_loss: 8202.3194; train_edge_recon_loss: 357303.8854; train_cond_contrastive_loss: 89237.0898; train_gene_expr_recon_loss: 102730.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557473.3646; train_optim_loss: 557473.3646; val_kl_reg_loss: 5645.4854; val_edge_recon_loss: 385141.8438; val_cond_contrastive_loss: 78375.3750; val_gene_expr_recon_loss: 101221.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 570383.8125; val_optim_loss: 570383.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7179; val_auprc_score: 0.7508; val_best_acc_score: 0.6447; val_best_f1_score: 0.6980; train_kl_reg_loss: 5293.8658; train_edge_recon_loss: 347901.6250; train_cond_contrastive_loss: 86984.8008; train_gene_expr_recon_loss: 101080.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 541260.5521; train_optim_loss: 541260.5521; val_kl_reg_loss: 3850.9800; val_edge_recon_loss: 345128.2188; val_cond_contrastive_loss: 78446.0781; val_gene_expr_recon_loss: 100607.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528032.5000; val_optim_loss: 528032.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7225; val_auprc_score: 0.7534; val_best_acc_score: 0.6595; val_best_f1_score: 0.6950; train_kl_reg_loss: 3495.5589; train_edge_recon_loss: 330144.7083; train_cond_contrastive_loss: 85355.2695; train_gene_expr_recon_loss: 100110.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 519105.6719; train_optim_loss: 519105.6719; val_kl_reg_loss: 3597.9402; val_edge_recon_loss: 330482.9062; val_cond_contrastive_loss: 78369.8203; val_gene_expr_recon_loss: 99766.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 512217.5312; val_optim_loss: 512217.5312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7556; val_auprc_score: 0.7758; val_best_acc_score: 0.6789; val_best_f1_score: 0.7168; train_kl_reg_loss: 3986.5670; train_edge_recon_loss: 317622.7812; train_cond_contrastive_loss: 79739.0951; train_gene_expr_recon_loss: 99356.3763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500704.8125; train_optim_loss: 500704.8125; val_kl_reg_loss: 4506.9502; val_edge_recon_loss: 313453.6250; val_cond_contrastive_loss: 78363.9062; val_gene_expr_recon_loss: 99095.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 495420.3125; val_optim_loss: 495420.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8062; val_auprc_score: 0.8007; val_best_acc_score: 0.7258; val_best_f1_score: 0.7590; train_kl_reg_loss: 4795.0901; train_edge_recon_loss: 302964.9427; train_cond_contrastive_loss: 78947.4492; train_gene_expr_recon_loss: 98627.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485334.6302; train_optim_loss: 485334.6302; val_kl_reg_loss: 5375.6377; val_edge_recon_loss: 296185.5625; val_cond_contrastive_loss: 78383.7344; val_gene_expr_recon_loss: 98543.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478488.1875; val_optim_loss: 478488.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8369; val_auprc_score: 0.8230; val_best_acc_score: 0.7557; val_best_f1_score: 0.7886; train_kl_reg_loss: 5734.5873; train_edge_recon_loss: 288554.8281; train_cond_contrastive_loss: 78760.8490; train_gene_expr_recon_loss: 98094.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471144.6094; train_optim_loss: 471144.6094; val_kl_reg_loss: 6236.1489; val_edge_recon_loss: 284650.6875; val_cond_contrastive_loss: 78379.4844; val_gene_expr_recon_loss: 97792.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467058.6250; val_optim_loss: 467058.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8493; val_auprc_score: 0.8272; val_best_acc_score: 0.7668; val_best_f1_score: 0.7951; train_kl_reg_loss: 6337.1299; train_edge_recon_loss: 282630.8906; train_cond_contrastive_loss: 78760.0456; train_gene_expr_recon_loss: 97500.1901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465228.2500; train_optim_loss: 465228.2500; val_kl_reg_loss: 6308.5874; val_edge_recon_loss: 284390.9688; val_cond_contrastive_loss: 78372.6719; val_gene_expr_recon_loss: 97203.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466275.3125; val_optim_loss: 466275.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8716; val_auprc_score: 0.8507; val_best_acc_score: 0.7947; val_best_f1_score: 0.8161; train_kl_reg_loss: 6233.6709; train_edge_recon_loss: 279817.2604; train_cond_contrastive_loss: 78963.2995; train_gene_expr_recon_loss: 96946.7487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461960.9688; train_optim_loss: 461960.9688; val_kl_reg_loss: 6191.0986; val_edge_recon_loss: 278656.9375; val_cond_contrastive_loss: 78374.5391; val_gene_expr_recon_loss: 96701.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459924.4375; val_optim_loss: 459924.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8828; val_auprc_score: 0.8554; val_best_acc_score: 0.8155; val_best_f1_score: 0.8362; train_kl_reg_loss: 6330.9305; train_edge_recon_loss: 277103.6979; train_cond_contrastive_loss: 79031.5169; train_gene_expr_recon_loss: 96412.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458878.9062; train_optim_loss: 458878.9062; val_kl_reg_loss: 6461.4121; val_edge_recon_loss: 271881.5312; val_cond_contrastive_loss: 78382.8906; val_gene_expr_recon_loss: 96306.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453032.2500; val_optim_loss: 453032.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8982; val_auprc_score: 0.8741; val_best_acc_score: 0.8285; val_best_f1_score: 0.8455; train_kl_reg_loss: 6538.0402; train_edge_recon_loss: 274422.8385; train_cond_contrastive_loss: 78928.2826; train_gene_expr_recon_loss: 96078.9076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455968.0625; train_optim_loss: 455968.0625; val_kl_reg_loss: 6385.5322; val_edge_recon_loss: 273867.2188; val_cond_contrastive_loss: 78396.2969; val_gene_expr_recon_loss: 95895.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454544.9688; val_optim_loss: 454544.9688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9194; val_auprc_score: 0.9013; val_best_acc_score: 0.8460; val_best_f1_score: 0.8578; train_kl_reg_loss: 6227.8633; train_edge_recon_loss: 272813.5260; train_cond_contrastive_loss: 78913.0547; train_gene_expr_recon_loss: 95729.3034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453683.7448; train_optim_loss: 453683.7448; val_kl_reg_loss: 5918.4678; val_edge_recon_loss: 272928.9375; val_cond_contrastive_loss: 78407.3359; val_gene_expr_recon_loss: 95527.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452782.3125; val_optim_loss: 452782.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9339; val_auprc_score: 0.9225; val_best_acc_score: 0.8629; val_best_f1_score: 0.8722; train_kl_reg_loss: 5988.1584; train_edge_recon_loss: 271173.5573; train_cond_contrastive_loss: 78861.0521; train_gene_expr_recon_loss: 95492.0169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451514.7760; train_optim_loss: 451514.7760; val_kl_reg_loss: 5984.2729; val_edge_recon_loss: 268365.3125; val_cond_contrastive_loss: 78409.0859; val_gene_expr_recon_loss: 95232.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447991.0000; val_optim_loss: 447991.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9468; val_auprc_score: 0.9398; val_best_acc_score: 0.8789; val_best_f1_score: 0.8843; train_kl_reg_loss: 6113.3657; train_edge_recon_loss: 269613.5000; train_cond_contrastive_loss: 78712.3659; train_gene_expr_recon_loss: 94918.8607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449358.0885; train_optim_loss: 449358.0885; val_kl_reg_loss: 6115.8882; val_edge_recon_loss: 268180.0625; val_cond_contrastive_loss: 78405.0156; val_gene_expr_recon_loss: 94905.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447606.5312; val_optim_loss: 447606.5312
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9521; val_auprc_score: 0.9431; val_best_acc_score: 0.8878; val_best_f1_score: 0.8918; train_kl_reg_loss: 6207.1213; train_edge_recon_loss: 269201.8490; train_cond_contrastive_loss: 78666.3151; train_gene_expr_recon_loss: 94739.5456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448814.8385; train_optim_loss: 448814.8385; val_kl_reg_loss: 6123.7324; val_edge_recon_loss: 268506.2188; val_cond_contrastive_loss: 78403.4609; val_gene_expr_recon_loss: 94643.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447677.3125; val_optim_loss: 447677.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9582; val_auprc_score: 0.9484; val_best_acc_score: 0.9006; val_best_f1_score: 0.9060; train_kl_reg_loss: 6153.6212; train_edge_recon_loss: 268476.6562; train_cond_contrastive_loss: 78674.7396; train_gene_expr_recon_loss: 94341.4284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447646.4479; train_optim_loss: 447646.4479; val_kl_reg_loss: 5924.1738; val_edge_recon_loss: 265024.9375; val_cond_contrastive_loss: 78404.0469; val_gene_expr_recon_loss: 94365.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443719.1250; val_optim_loss: 443719.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9652; val_auprc_score: 0.9576; val_best_acc_score: 0.9130; val_best_f1_score: 0.9160; train_kl_reg_loss: 5985.7764; train_edge_recon_loss: 267139.5573; train_cond_contrastive_loss: 78712.7044; train_gene_expr_recon_loss: 93943.0690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445781.1146; train_optim_loss: 445781.1146; val_kl_reg_loss: 5861.5703; val_edge_recon_loss: 264708.9062; val_cond_contrastive_loss: 78406.5859; val_gene_expr_recon_loss: 94052.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443029.8125; val_optim_loss: 443029.8125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9681; val_auprc_score: 0.9608; val_best_acc_score: 0.9174; val_best_f1_score: 0.9199; train_kl_reg_loss: 5887.4909; train_edge_recon_loss: 269115.3333; train_cond_contrastive_loss: 78717.3893; train_gene_expr_recon_loss: 93823.3307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447543.5469; train_optim_loss: 447543.5469; val_kl_reg_loss: 5730.9839; val_edge_recon_loss: 265530.7812; val_cond_contrastive_loss: 78412.0000; val_gene_expr_recon_loss: 93753.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443426.8125; val_optim_loss: 443426.8125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9754; val_auprc_score: 0.9708; val_best_acc_score: 0.9265; val_best_f1_score: 0.9287; train_kl_reg_loss: 5778.3949; train_edge_recon_loss: 265105.4948; train_cond_contrastive_loss: 78715.8919; train_gene_expr_recon_loss: 93523.4128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443123.1875; train_optim_loss: 443123.1875; val_kl_reg_loss: 5659.5273; val_edge_recon_loss: 263189.7188; val_cond_contrastive_loss: 78413.8516; val_gene_expr_recon_loss: 93470.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440733.5938; val_optim_loss: 440733.5938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9779; val_auprc_score: 0.9721; val_best_acc_score: 0.9324; val_best_f1_score: 0.9339; train_kl_reg_loss: 5748.2710; train_edge_recon_loss: 265340.3073; train_cond_contrastive_loss: 78701.2031; train_gene_expr_recon_loss: 93228.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443018.3802; train_optim_loss: 443018.3802; val_kl_reg_loss: 5662.3809; val_edge_recon_loss: 261985.2969; val_cond_contrastive_loss: 78412.4219; val_gene_expr_recon_loss: 93208.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439268.6562; val_optim_loss: 439268.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9784; val_auprc_score: 0.9723; val_best_acc_score: 0.9354; val_best_f1_score: 0.9370; train_kl_reg_loss: 5761.6136; train_edge_recon_loss: 263788.6146; train_cond_contrastive_loss: 78704.8581; train_gene_expr_recon_loss: 92769.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441025.0729; train_optim_loss: 441025.0729; val_kl_reg_loss: 5704.3809; val_edge_recon_loss: 264053.1875; val_cond_contrastive_loss: 78408.4375; val_gene_expr_recon_loss: 92962.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441128.1250; val_optim_loss: 441128.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9812; val_auprc_score: 0.9758; val_best_acc_score: 0.9386; val_best_f1_score: 0.9397; train_kl_reg_loss: 5781.5126; train_edge_recon_loss: 263617.8646; train_cond_contrastive_loss: 78708.9648; train_gene_expr_recon_loss: 92640.9831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440749.3281; train_optim_loss: 440749.3281; val_kl_reg_loss: 5689.5664; val_edge_recon_loss: 264424.4375; val_cond_contrastive_loss: 78403.9297; val_gene_expr_recon_loss: 92709.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441227.5312; val_optim_loss: 441227.5312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9837; val_auprc_score: 0.9802; val_best_acc_score: 0.9450; val_best_f1_score: 0.9463; train_kl_reg_loss: 5812.7413; train_edge_recon_loss: 261159.6719; train_cond_contrastive_loss: 78721.9258; train_gene_expr_recon_loss: 92423.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438118.0469; train_optim_loss: 438118.0469; val_kl_reg_loss: 5763.0039; val_edge_recon_loss: 262573.6562; val_cond_contrastive_loss: 78404.3672; val_gene_expr_recon_loss: 92479.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439220.8438; val_optim_loss: 439220.8438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9858; val_auprc_score: 0.9816; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 5818.4609; train_edge_recon_loss: 262450.9714; train_cond_contrastive_loss: 78740.4466; train_gene_expr_recon_loss: 92098.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439108.5365; train_optim_loss: 439108.5365; val_kl_reg_loss: 5686.7769; val_edge_recon_loss: 260054.4062; val_cond_contrastive_loss: 78409.1719; val_gene_expr_recon_loss: 92232.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436382.9375; val_optim_loss: 436382.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9875; val_auprc_score: 0.9846; val_best_acc_score: 0.9547; val_best_f1_score: 0.9560; train_kl_reg_loss: 5820.8757; train_edge_recon_loss: 261917.0260; train_cond_contrastive_loss: 78749.7826; train_gene_expr_recon_loss: 92006.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438493.9635; train_optim_loss: 438493.9635; val_kl_reg_loss: 5808.2148; val_edge_recon_loss: 257737.4844; val_cond_contrastive_loss: 78412.1562; val_gene_expr_recon_loss: 91981.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433938.9062; val_optim_loss: 433938.9062
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9866; val_auprc_score: 0.9818; val_best_acc_score: 0.9527; val_best_f1_score: 0.9535; train_kl_reg_loss: 5872.5972; train_edge_recon_loss: 260506.5833; train_cond_contrastive_loss: 78745.6797; train_gene_expr_recon_loss: 91766.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436891.2604; train_optim_loss: 436891.2604; val_kl_reg_loss: 5732.1938; val_edge_recon_loss: 259547.4688; val_cond_contrastive_loss: 78412.2266; val_gene_expr_recon_loss: 91759.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435451.3125; val_optim_loss: 435451.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9866; val_auprc_score: 0.9832; val_best_acc_score: 0.9520; val_best_f1_score: 0.9534; train_kl_reg_loss: 5818.4228; train_edge_recon_loss: 260457.0130; train_cond_contrastive_loss: 78767.8451; train_gene_expr_recon_loss: 91480.6315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436523.9167; train_optim_loss: 436523.9167; val_kl_reg_loss: 5744.6895; val_edge_recon_loss: 259756.1250; val_cond_contrastive_loss: 78417.1484; val_gene_expr_recon_loss: 91542.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435459.9688; val_optim_loss: 435459.9688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9871; val_auprc_score: 0.9830; val_best_acc_score: 0.9536; val_best_f1_score: 0.9547; train_kl_reg_loss: 5846.4807; train_edge_recon_loss: 260692.3932; train_cond_contrastive_loss: 78767.8659; train_gene_expr_recon_loss: 91259.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436566.0104; train_optim_loss: 436566.0104; val_kl_reg_loss: 5744.2012; val_edge_recon_loss: 259401.1719; val_cond_contrastive_loss: 78417.1484; val_gene_expr_recon_loss: 91334.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434896.7500; val_optim_loss: 434896.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9863; val_auprc_score: 0.9813; val_best_acc_score: 0.9543; val_best_f1_score: 0.9555; train_kl_reg_loss: 5832.4452; train_edge_recon_loss: 260232.4922; train_cond_contrastive_loss: 78771.9896; train_gene_expr_recon_loss: 91154.9909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435991.9167; train_optim_loss: 435991.9167; val_kl_reg_loss: 5736.2666; val_edge_recon_loss: 259458.5938; val_cond_contrastive_loss: 78417.8516; val_gene_expr_recon_loss: 91295.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434908.1250; val_optim_loss: 434908.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9857; val_auprc_score: 0.9805; val_best_acc_score: 0.9501; val_best_f1_score: 0.9516; train_kl_reg_loss: 5830.3896; train_edge_recon_loss: 261252.9219; train_cond_contrastive_loss: 78773.5859; train_gene_expr_recon_loss: 91103.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436960.8125; train_optim_loss: 436960.8125; val_kl_reg_loss: 5726.5195; val_edge_recon_loss: 260633.4375; val_cond_contrastive_loss: 78416.9922; val_gene_expr_recon_loss: 91264.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436041.8438; val_optim_loss: 436041.8438
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9875; val_auprc_score: 0.9812; val_best_acc_score: 0.9555; val_best_f1_score: 0.9566; train_kl_reg_loss: 5825.7173; train_edge_recon_loss: 260117.6979; train_cond_contrastive_loss: 78770.8880; train_gene_expr_recon_loss: 91002.6706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435716.9792; train_optim_loss: 435716.9792; val_kl_reg_loss: 5720.9951; val_edge_recon_loss: 259344.2500; val_cond_contrastive_loss: 78416.8750; val_gene_expr_recon_loss: 91240.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434722.1875; val_optim_loss: 434722.1875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9858
Val AUPRC score: 0.9834
Val best accuracy score: 0.9486
Val best F1 score: 0.9502
Val gene expr MSE score: 1.4532
Duration of model training in run 6: 0 hours, 1 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7749; val_auprc_score: 0.8120; val_best_acc_score: 0.6904; val_best_f1_score: 0.7141; train_kl_reg_loss: 6126.1585; train_edge_recon_loss: 358489.5848; train_cond_contrastive_loss: 103699.1652; train_gene_expr_recon_loss: 120989.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 589304.1518; train_optim_loss: 589304.1518; val_kl_reg_loss: 9197.5820; val_edge_recon_loss: 396701.2188; val_cond_contrastive_loss: 78333.5859; val_gene_expr_recon_loss: 103381.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 587613.5625; val_optim_loss: 587613.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7372; val_auprc_score: 0.7575; val_best_acc_score: 0.6501; val_best_f1_score: 0.7151; train_kl_reg_loss: 7260.1179; train_edge_recon_loss: 355220.4777; train_cond_contrastive_loss: 87502.4944; train_gene_expr_recon_loss: 101603.6607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551586.7500; train_optim_loss: 551586.7500; val_kl_reg_loss: 4901.5400; val_edge_recon_loss: 382207.4688; val_cond_contrastive_loss: 78362.2734; val_gene_expr_recon_loss: 100508.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 565979.5000; val_optim_loss: 565979.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7345; val_auprc_score: 0.7646; val_best_acc_score: 0.6540; val_best_f1_score: 0.7086; train_kl_reg_loss: 3987.6841; train_edge_recon_loss: 343657.6339; train_cond_contrastive_loss: 87589.6629; train_gene_expr_recon_loss: 99840.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 535075.2857; train_optim_loss: 535075.2857; val_kl_reg_loss: 3389.0969; val_edge_recon_loss: 331918.2500; val_cond_contrastive_loss: 78381.6016; val_gene_expr_recon_loss: 99545.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 513234.5938; val_optim_loss: 513234.5938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7525; val_auprc_score: 0.7764; val_best_acc_score: 0.6767; val_best_f1_score: 0.7110; train_kl_reg_loss: 4067.1498; train_edge_recon_loss: 321168.1205; train_cond_contrastive_loss: 82364.2779; train_gene_expr_recon_loss: 99100.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 506700.1741; train_optim_loss: 506700.1741; val_kl_reg_loss: 4952.1328; val_edge_recon_loss: 317092.2812; val_cond_contrastive_loss: 78360.9062; val_gene_expr_recon_loss: 98798.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 499204.0000; val_optim_loss: 499204.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8136; val_auprc_score: 0.8200; val_best_acc_score: 0.7271; val_best_f1_score: 0.7522; train_kl_reg_loss: 5324.6524; train_edge_recon_loss: 307814.1518; train_cond_contrastive_loss: 79050.8136; train_gene_expr_recon_loss: 98373.4888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490563.1116; train_optim_loss: 490563.1116; val_kl_reg_loss: 5717.9683; val_edge_recon_loss: 295189.4062; val_cond_contrastive_loss: 78375.6484; val_gene_expr_recon_loss: 98043.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477326.1250; val_optim_loss: 477326.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8634; val_auprc_score: 0.8547; val_best_acc_score: 0.7773; val_best_f1_score: 0.8018; train_kl_reg_loss: 5946.9540; train_edge_recon_loss: 288549.7411; train_cond_contrastive_loss: 78795.9632; train_gene_expr_recon_loss: 97597.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470890.3214; train_optim_loss: 470890.3214; val_kl_reg_loss: 6128.2139; val_edge_recon_loss: 281584.4375; val_cond_contrastive_loss: 78386.5938; val_gene_expr_recon_loss: 97216.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463315.5625; val_optim_loss: 463315.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8823; val_auprc_score: 0.8624; val_best_acc_score: 0.8141; val_best_f1_score: 0.8336; train_kl_reg_loss: 6186.2223; train_edge_recon_loss: 278876.2500; train_cond_contrastive_loss: 78890.0681; train_gene_expr_recon_loss: 96732.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460685.2768; train_optim_loss: 460685.2768; val_kl_reg_loss: 6153.1094; val_edge_recon_loss: 273552.8125; val_cond_contrastive_loss: 78385.3828; val_gene_expr_recon_loss: 96601.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454693.0000; val_optim_loss: 454693.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8999; val_auprc_score: 0.8780; val_best_acc_score: 0.8358; val_best_f1_score: 0.8494; train_kl_reg_loss: 6159.9350; train_edge_recon_loss: 275834.7589; train_cond_contrastive_loss: 78986.5636; train_gene_expr_recon_loss: 96000.2723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456981.5357; train_optim_loss: 456981.5357; val_kl_reg_loss: 6051.0278; val_edge_recon_loss: 273405.5312; val_cond_contrastive_loss: 78387.9609; val_gene_expr_recon_loss: 95980.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453825.1562; val_optim_loss: 453825.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9205; val_auprc_score: 0.9035; val_best_acc_score: 0.8503; val_best_f1_score: 0.8618; train_kl_reg_loss: 6052.6989; train_edge_recon_loss: 272573.3929; train_cond_contrastive_loss: 79050.3850; train_gene_expr_recon_loss: 95708.8583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453385.3393; train_optim_loss: 453385.3393; val_kl_reg_loss: 5994.9863; val_edge_recon_loss: 271467.2500; val_cond_contrastive_loss: 78396.3047; val_gene_expr_recon_loss: 95409.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451268.0000; val_optim_loss: 451268.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9358; val_auprc_score: 0.9221; val_best_acc_score: 0.8691; val_best_f1_score: 0.8776; train_kl_reg_loss: 6039.3104; train_edge_recon_loss: 272058.1875; train_cond_contrastive_loss: 78947.7857; train_gene_expr_recon_loss: 94870.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451915.9464; train_optim_loss: 451915.9464; val_kl_reg_loss: 5978.8745; val_edge_recon_loss: 267323.7188; val_cond_contrastive_loss: 78399.8594; val_gene_expr_recon_loss: 94981.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446683.6875; val_optim_loss: 446683.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9439; val_auprc_score: 0.9322; val_best_acc_score: 0.8781; val_best_f1_score: 0.8848; train_kl_reg_loss: 6112.9910; train_edge_recon_loss: 269212.2321; train_cond_contrastive_loss: 78809.4219; train_gene_expr_recon_loss: 94561.7400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448696.3839; train_optim_loss: 448696.3839; val_kl_reg_loss: 6120.0908; val_edge_recon_loss: 265964.3438; val_cond_contrastive_loss: 78398.0078; val_gene_expr_recon_loss: 94572.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445054.6250; val_optim_loss: 445054.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9543; val_auprc_score: 0.9443; val_best_acc_score: 0.8945; val_best_f1_score: 0.8994; train_kl_reg_loss: 6200.4737; train_edge_recon_loss: 268649.3170; train_cond_contrastive_loss: 78740.0324; train_gene_expr_recon_loss: 93932.6161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447522.4330; train_optim_loss: 447522.4330; val_kl_reg_loss: 6118.1641; val_edge_recon_loss: 264120.6250; val_cond_contrastive_loss: 78396.5625; val_gene_expr_recon_loss: 94182.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442818.2500; val_optim_loss: 442818.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9579; val_auprc_score: 0.9469; val_best_acc_score: 0.8991; val_best_f1_score: 0.9036; train_kl_reg_loss: 6194.6964; train_edge_recon_loss: 267434.2143; train_cond_contrastive_loss: 78732.0067; train_gene_expr_recon_loss: 93681.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446042.6339; train_optim_loss: 446042.6339; val_kl_reg_loss: 6107.5967; val_edge_recon_loss: 264433.2500; val_cond_contrastive_loss: 78396.9766; val_gene_expr_recon_loss: 93807.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442745.1250; val_optim_loss: 442745.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9680; val_auprc_score: 0.9604; val_best_acc_score: 0.9144; val_best_f1_score: 0.9175; train_kl_reg_loss: 6072.6104; train_edge_recon_loss: 266675.2277; train_cond_contrastive_loss: 78751.7388; train_gene_expr_recon_loss: 93254.1317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444753.7232; train_optim_loss: 444753.7232; val_kl_reg_loss: 5848.0234; val_edge_recon_loss: 264095.4688; val_cond_contrastive_loss: 78399.4688; val_gene_expr_recon_loss: 93422.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441765.3750; val_optim_loss: 441765.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9727; val_auprc_score: 0.9680; val_best_acc_score: 0.9211; val_best_f1_score: 0.9247; train_kl_reg_loss: 5872.8013; train_edge_recon_loss: 265707.3304; train_cond_contrastive_loss: 78771.6060; train_gene_expr_recon_loss: 92896.7411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443248.4777; train_optim_loss: 443248.4777; val_kl_reg_loss: 5788.9937; val_edge_recon_loss: 262518.2188; val_cond_contrastive_loss: 78404.7969; val_gene_expr_recon_loss: 93060.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439772.0312; val_optim_loss: 439772.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9789; val_auprc_score: 0.9745; val_best_acc_score: 0.9312; val_best_f1_score: 0.9334; train_kl_reg_loss: 5847.6341; train_edge_recon_loss: 264965.9777; train_cond_contrastive_loss: 78743.3136; train_gene_expr_recon_loss: 92915.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442472.8973; train_optim_loss: 442472.8973; val_kl_reg_loss: 5737.9561; val_edge_recon_loss: 260762.1875; val_cond_contrastive_loss: 78409.9453; val_gene_expr_recon_loss: 92698.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437608.6250; val_optim_loss: 437608.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9816; val_auprc_score: 0.9766; val_best_acc_score: 0.9360; val_best_f1_score: 0.9382; train_kl_reg_loss: 5779.0405; train_edge_recon_loss: 264417.0491; train_cond_contrastive_loss: 78757.1540; train_gene_expr_recon_loss: 91880.0112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440833.2545; train_optim_loss: 440833.2545; val_kl_reg_loss: 5683.0176; val_edge_recon_loss: 260367.3594; val_cond_contrastive_loss: 78412.0781; val_gene_expr_recon_loss: 92378.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436840.9062; val_optim_loss: 436840.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9851; val_auprc_score: 0.9819; val_best_acc_score: 0.9458; val_best_f1_score: 0.9475; train_kl_reg_loss: 5782.1237; train_edge_recon_loss: 262415.5826; train_cond_contrastive_loss: 78757.0145; train_gene_expr_recon_loss: 91686.5201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438641.2366; train_optim_loss: 438641.2366; val_kl_reg_loss: 5748.4194; val_edge_recon_loss: 259172.9531; val_cond_contrastive_loss: 78411.7578; val_gene_expr_recon_loss: 92101.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435434.1562; val_optim_loss: 435434.1562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9850; val_auprc_score: 0.9799; val_best_acc_score: 0.9471; val_best_f1_score: 0.9492; train_kl_reg_loss: 5810.5579; train_edge_recon_loss: 262326.5670; train_cond_contrastive_loss: 78737.8415; train_gene_expr_recon_loss: 91366.5022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438241.4688; train_optim_loss: 438241.4688; val_kl_reg_loss: 5682.5225; val_edge_recon_loss: 257526.1875; val_cond_contrastive_loss: 78408.5938; val_gene_expr_recon_loss: 91852.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433469.8750; val_optim_loss: 433469.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9865; val_auprc_score: 0.9814; val_best_acc_score: 0.9519; val_best_f1_score: 0.9538; train_kl_reg_loss: 5803.2586; train_edge_recon_loss: 261579.3750; train_cond_contrastive_loss: 78731.6853; train_gene_expr_recon_loss: 91124.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437238.8527; train_optim_loss: 437238.8527; val_kl_reg_loss: 5776.5488; val_edge_recon_loss: 257923.9375; val_cond_contrastive_loss: 78405.7812; val_gene_expr_recon_loss: 91586.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433692.6875; val_optim_loss: 433692.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9878; val_auprc_score: 0.9837; val_best_acc_score: 0.9524; val_best_f1_score: 0.9541; train_kl_reg_loss: 5821.5265; train_edge_recon_loss: 260336.5647; train_cond_contrastive_loss: 78735.5156; train_gene_expr_recon_loss: 90904.0190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435797.6339; train_optim_loss: 435797.6339; val_kl_reg_loss: 5719.9292; val_edge_recon_loss: 257887.5156; val_cond_contrastive_loss: 78404.1016; val_gene_expr_recon_loss: 91321.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433333.1875; val_optim_loss: 433333.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9880; val_auprc_score: 0.9853; val_best_acc_score: 0.9544; val_best_f1_score: 0.9558; train_kl_reg_loss: 5819.1161; train_edge_recon_loss: 260198.0804; train_cond_contrastive_loss: 78742.8426; train_gene_expr_recon_loss: 90727.8951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435487.9375; train_optim_loss: 435487.9375; val_kl_reg_loss: 5724.3550; val_edge_recon_loss: 256801.0625; val_cond_contrastive_loss: 78402.6953; val_gene_expr_recon_loss: 91047.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431975.9375; val_optim_loss: 431975.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9870; val_auprc_score: 0.9830; val_best_acc_score: 0.9541; val_best_f1_score: 0.9556; train_kl_reg_loss: 5787.5121; train_edge_recon_loss: 259256.0491; train_cond_contrastive_loss: 78749.8013; train_gene_expr_recon_loss: 90232.2020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434025.5670; train_optim_loss: 434025.5670; val_kl_reg_loss: 5776.0967; val_edge_recon_loss: 256978.3281; val_cond_contrastive_loss: 78402.6797; val_gene_expr_recon_loss: 90785.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431942.3125; val_optim_loss: 431942.3125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9900; val_auprc_score: 0.9862; val_best_acc_score: 0.9608; val_best_f1_score: 0.9618; train_kl_reg_loss: 5809.4895; train_edge_recon_loss: 259425.7835; train_cond_contrastive_loss: 78735.0703; train_gene_expr_recon_loss: 90451.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434422.2946; train_optim_loss: 434422.2946; val_kl_reg_loss: 5620.8096; val_edge_recon_loss: 255745.0312; val_cond_contrastive_loss: 78404.2188; val_gene_expr_recon_loss: 90569.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430339.2812; val_optim_loss: 430339.2812
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9900; val_auprc_score: 0.9860; val_best_acc_score: 0.9591; val_best_f1_score: 0.9602; train_kl_reg_loss: 5756.8981; train_edge_recon_loss: 258799.7656; train_cond_contrastive_loss: 78732.5346; train_gene_expr_recon_loss: 89930.9018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433220.1071; train_optim_loss: 433220.1071; val_kl_reg_loss: 5724.9468; val_edge_recon_loss: 256837.6094; val_cond_contrastive_loss: 78407.5703; val_gene_expr_recon_loss: 90348.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431318.1875; val_optim_loss: 431318.1875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9907; val_auprc_score: 0.9882; val_best_acc_score: 0.9608; val_best_f1_score: 0.9617; train_kl_reg_loss: 5759.9701; train_edge_recon_loss: 258285.1138; train_cond_contrastive_loss: 78728.7690; train_gene_expr_recon_loss: 89728.1585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432502.0045; train_optim_loss: 432502.0045; val_kl_reg_loss: 5636.6226; val_edge_recon_loss: 257496.7500; val_cond_contrastive_loss: 78409.5938; val_gene_expr_recon_loss: 90138.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431681.9375; val_optim_loss: 431681.9375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9912; val_auprc_score: 0.9882; val_best_acc_score: 0.9633; val_best_f1_score: 0.9644; train_kl_reg_loss: 5747.7574; train_edge_recon_loss: 259623.7321; train_cond_contrastive_loss: 78716.4688; train_gene_expr_recon_loss: 89223.3605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433311.3259; train_optim_loss: 433311.3259; val_kl_reg_loss: 5606.1367; val_edge_recon_loss: 253929.2500; val_cond_contrastive_loss: 78411.0859; val_gene_expr_recon_loss: 89945.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427892.2500; val_optim_loss: 427892.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9909; val_auprc_score: 0.9871; val_best_acc_score: 0.9611; val_best_f1_score: 0.9623; train_kl_reg_loss: 5701.8252; train_edge_recon_loss: 258229.8036; train_cond_contrastive_loss: 78725.9141; train_gene_expr_recon_loss: 89357.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432014.6786; train_optim_loss: 432014.6786; val_kl_reg_loss: 5610.3008; val_edge_recon_loss: 255376.6406; val_cond_contrastive_loss: 78412.7344; val_gene_expr_recon_loss: 89767.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429167.0625; val_optim_loss: 429167.0625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9650; val_best_f1_score: 0.9659; train_kl_reg_loss: 5693.5285; train_edge_recon_loss: 258436.0692; train_cond_contrastive_loss: 78734.5792; train_gene_expr_recon_loss: 89150.2623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432014.4375; train_optim_loss: 432014.4375; val_kl_reg_loss: 5623.0664; val_edge_recon_loss: 257231.8281; val_cond_contrastive_loss: 78414.4531; val_gene_expr_recon_loss: 89592.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430861.5000; val_optim_loss: 430861.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9919; val_auprc_score: 0.9889; val_best_acc_score: 0.9636; val_best_f1_score: 0.9643; train_kl_reg_loss: 5709.4957; train_edge_recon_loss: 258841.0379; train_cond_contrastive_loss: 78732.1551; train_gene_expr_recon_loss: 88872.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432154.8259; train_optim_loss: 432154.8259; val_kl_reg_loss: 5618.7139; val_edge_recon_loss: 257753.3438; val_cond_contrastive_loss: 78413.7969; val_gene_expr_recon_loss: 89424.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431210.5625; val_optim_loss: 431210.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9928; val_auprc_score: 0.9902; val_best_acc_score: 0.9636; val_best_f1_score: 0.9647; train_kl_reg_loss: 5699.5193; train_edge_recon_loss: 258789.0022; train_cond_contrastive_loss: 78730.6853; train_gene_expr_recon_loss: 89054.8683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432274.0714; train_optim_loss: 432274.0714; val_kl_reg_loss: 5604.0615; val_edge_recon_loss: 257162.9844; val_cond_contrastive_loss: 78413.3828; val_gene_expr_recon_loss: 89398.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430579.0312; val_optim_loss: 430579.0312
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9925; val_auprc_score: 0.9910; val_best_acc_score: 0.9648; val_best_f1_score: 0.9657; train_kl_reg_loss: 5687.9843; train_edge_recon_loss: 258144.0089; train_cond_contrastive_loss: 78731.4777; train_gene_expr_recon_loss: 88835.3996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431398.8705; train_optim_loss: 431398.8705; val_kl_reg_loss: 5601.6318; val_edge_recon_loss: 256773.7969; val_cond_contrastive_loss: 78413.7578; val_gene_expr_recon_loss: 89375.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430164.5625; val_optim_loss: 430164.5625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9921; val_auprc_score: 0.9886; val_best_acc_score: 0.9646; val_best_f1_score: 0.9657; train_kl_reg_loss: 5687.5679; train_edge_recon_loss: 258530.7098; train_cond_contrastive_loss: 78731.0268; train_gene_expr_recon_loss: 88640.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431589.5982; train_optim_loss: 431589.5982; val_kl_reg_loss: 5597.5869; val_edge_recon_loss: 256085.5156; val_cond_contrastive_loss: 78413.5625; val_gene_expr_recon_loss: 89355.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429452.5938; val_optim_loss: 429452.5938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 11 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9912
Val AUPRC score: 0.9878
Val best accuracy score: 0.9610
Val best F1 score: 0.9619
Val gene expr MSE score: 1.3326
Duration of model training in run 7: 0 hours, 2 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7652; val_auprc_score: 0.8003; val_best_acc_score: 0.6778; val_best_f1_score: 0.7144; train_kl_reg_loss: 6823.6338; train_edge_recon_loss: 356435.0580; train_cond_contrastive_loss: 104554.5982; train_gene_expr_recon_loss: 120157.6708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 587970.9554; train_optim_loss: 587970.9554; val_kl_reg_loss: 8462.2949; val_edge_recon_loss: 394323.8125; val_cond_contrastive_loss: 78337.0859; val_gene_expr_recon_loss: 103239.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 584362.6875; val_optim_loss: 584362.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7296; val_auprc_score: 0.7565; val_best_acc_score: 0.6492; val_best_f1_score: 0.7127; train_kl_reg_loss: 6833.4205; train_edge_recon_loss: 354828.5938; train_cond_contrastive_loss: 86541.1674; train_gene_expr_recon_loss: 100704.0413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 548907.2321; train_optim_loss: 548907.2321; val_kl_reg_loss: 4144.0894; val_edge_recon_loss: 368752.0625; val_cond_contrastive_loss: 78382.1875; val_gene_expr_recon_loss: 100172.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 551451.1250; val_optim_loss: 551451.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7215; val_auprc_score: 0.7571; val_best_acc_score: 0.6458; val_best_f1_score: 0.7089; train_kl_reg_loss: 3477.9166; train_edge_recon_loss: 337606.6384; train_cond_contrastive_loss: 88032.8873; train_gene_expr_recon_loss: 98596.8482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 527714.2857; train_optim_loss: 527714.2857; val_kl_reg_loss: 3377.9565; val_edge_recon_loss: 328149.9688; val_cond_contrastive_loss: 78380.0625; val_gene_expr_recon_loss: 99011.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 508919.9375; val_optim_loss: 508919.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7405; val_auprc_score: 0.7704; val_best_acc_score: 0.6646; val_best_f1_score: 0.7093; train_kl_reg_loss: 4128.1293; train_edge_recon_loss: 319472.0670; train_cond_contrastive_loss: 81137.2243; train_gene_expr_recon_loss: 97151.1507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 501888.5714; train_optim_loss: 501888.5714; val_kl_reg_loss: 4880.6318; val_edge_recon_loss: 318686.0625; val_cond_contrastive_loss: 78356.5000; val_gene_expr_recon_loss: 98210.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500134.1250; val_optim_loss: 500134.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8082; val_auprc_score: 0.8147; val_best_acc_score: 0.7190; val_best_f1_score: 0.7503; train_kl_reg_loss: 5267.4436; train_edge_recon_loss: 308207.2277; train_cond_contrastive_loss: 78988.8069; train_gene_expr_recon_loss: 96339.6830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488803.1473; train_optim_loss: 488803.1473; val_kl_reg_loss: 5502.8408; val_edge_recon_loss: 296409.9062; val_cond_contrastive_loss: 78369.6797; val_gene_expr_recon_loss: 97489.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477772.4062; val_optim_loss: 477772.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8467; val_auprc_score: 0.8361; val_best_acc_score: 0.7635; val_best_f1_score: 0.7922; train_kl_reg_loss: 5807.1194; train_edge_recon_loss: 289028.7634; train_cond_contrastive_loss: 78811.7645; train_gene_expr_recon_loss: 95705.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469352.9464; train_optim_loss: 469352.9464; val_kl_reg_loss: 5891.5244; val_edge_recon_loss: 284628.5625; val_cond_contrastive_loss: 78377.9062; val_gene_expr_recon_loss: 96697.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465595.7500; val_optim_loss: 465595.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8668; val_auprc_score: 0.8506; val_best_acc_score: 0.7866; val_best_f1_score: 0.8121; train_kl_reg_loss: 6015.4259; train_edge_recon_loss: 280815.3080; train_cond_contrastive_loss: 78903.4699; train_gene_expr_recon_loss: 95188.8292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460923.0268; train_optim_loss: 460923.0268; val_kl_reg_loss: 5966.5894; val_edge_recon_loss: 277195.2812; val_cond_contrastive_loss: 78376.1406; val_gene_expr_recon_loss: 96001.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457539.9375; val_optim_loss: 457539.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8794; val_auprc_score: 0.8594; val_best_acc_score: 0.8059; val_best_f1_score: 0.8250; train_kl_reg_loss: 6067.0658; train_edge_recon_loss: 279668.2321; train_cond_contrastive_loss: 79011.5379; train_gene_expr_recon_loss: 94545.2589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459292.0848; train_optim_loss: 459292.0848; val_kl_reg_loss: 6011.2578; val_edge_recon_loss: 276202.0938; val_cond_contrastive_loss: 78377.9375; val_gene_expr_recon_loss: 95496.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456087.5000; val_optim_loss: 456087.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9027; val_auprc_score: 0.8845; val_best_acc_score: 0.8354; val_best_f1_score: 0.8509; train_kl_reg_loss: 6194.5322; train_edge_recon_loss: 274992.6741; train_cond_contrastive_loss: 78999.4241; train_gene_expr_recon_loss: 94219.8058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454406.4420; train_optim_loss: 454406.4420; val_kl_reg_loss: 6211.5449; val_edge_recon_loss: 270255.0312; val_cond_contrastive_loss: 78387.4609; val_gene_expr_recon_loss: 95030.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449884.1562; val_optim_loss: 449884.1562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9178; val_auprc_score: 0.9051; val_best_acc_score: 0.8462; val_best_f1_score: 0.8591; train_kl_reg_loss: 6158.2113; train_edge_recon_loss: 273196.8125; train_cond_contrastive_loss: 78977.6507; train_gene_expr_recon_loss: 93352.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451685.0268; train_optim_loss: 451685.0268; val_kl_reg_loss: 5920.5381; val_edge_recon_loss: 269263.1562; val_cond_contrastive_loss: 78398.4375; val_gene_expr_recon_loss: 94618.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448200.8125; val_optim_loss: 448200.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9347; val_auprc_score: 0.9226; val_best_acc_score: 0.8646; val_best_f1_score: 0.8725; train_kl_reg_loss: 5971.4385; train_edge_recon_loss: 270682.9509; train_cond_contrastive_loss: 78906.5703; train_gene_expr_recon_loss: 93268.7221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448829.6830; train_optim_loss: 448829.6830; val_kl_reg_loss: 5897.5908; val_edge_recon_loss: 269015.1250; val_cond_contrastive_loss: 78401.5391; val_gene_expr_recon_loss: 94225.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447539.8750; val_optim_loss: 447539.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9465; val_auprc_score: 0.9378; val_best_acc_score: 0.8793; val_best_f1_score: 0.8860; train_kl_reg_loss: 6021.6532; train_edge_recon_loss: 269002.6964; train_cond_contrastive_loss: 78786.7054; train_gene_expr_recon_loss: 92760.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446572.0402; train_optim_loss: 446572.0402; val_kl_reg_loss: 6042.7368; val_edge_recon_loss: 267024.5938; val_cond_contrastive_loss: 78398.7812; val_gene_expr_recon_loss: 93845.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445311.6250; val_optim_loss: 445311.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9539; val_auprc_score: 0.9439; val_best_acc_score: 0.8896; val_best_f1_score: 0.8946; train_kl_reg_loss: 6162.2262; train_edge_recon_loss: 268574.7679; train_cond_contrastive_loss: 78711.6250; train_gene_expr_recon_loss: 92736.4699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446185.0848; train_optim_loss: 446185.0848; val_kl_reg_loss: 6131.2856; val_edge_recon_loss: 267137.7812; val_cond_contrastive_loss: 78393.4375; val_gene_expr_recon_loss: 93530.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445192.5625; val_optim_loss: 445192.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9593; val_auprc_score: 0.9524; val_best_acc_score: 0.8988; val_best_f1_score: 0.9041; train_kl_reg_loss: 6128.3333; train_edge_recon_loss: 268332.3527; train_cond_contrastive_loss: 78720.8906; train_gene_expr_recon_loss: 92358.2098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445539.7812; train_optim_loss: 445539.7812; val_kl_reg_loss: 5990.1299; val_edge_recon_loss: 264566.4062; val_cond_contrastive_loss: 78391.9531; val_gene_expr_recon_loss: 93211.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442160.2188; val_optim_loss: 442160.2188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9652; val_auprc_score: 0.9577; val_best_acc_score: 0.9094; val_best_f1_score: 0.9134; train_kl_reg_loss: 6022.6488; train_edge_recon_loss: 265647.9554; train_cond_contrastive_loss: 78748.9308; train_gene_expr_recon_loss: 91729.4107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442148.9375; train_optim_loss: 442148.9375; val_kl_reg_loss: 5975.9023; val_edge_recon_loss: 265135.8125; val_cond_contrastive_loss: 78392.4375; val_gene_expr_recon_loss: 92887.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442391.3438; val_optim_loss: 442391.3438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9719; val_auprc_score: 0.9657; val_best_acc_score: 0.9226; val_best_f1_score: 0.9258; train_kl_reg_loss: 5967.2314; train_edge_recon_loss: 265641.6652; train_cond_contrastive_loss: 78759.8672; train_gene_expr_recon_loss: 91928.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442296.9375; train_optim_loss: 442296.9375; val_kl_reg_loss: 5768.0635; val_edge_recon_loss: 262164.5625; val_cond_contrastive_loss: 78396.1172; val_gene_expr_recon_loss: 92567.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438896.1562; val_optim_loss: 438896.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9758; val_auprc_score: 0.9717; val_best_acc_score: 0.9259; val_best_f1_score: 0.9280; train_kl_reg_loss: 5798.0354; train_edge_recon_loss: 265153.3705; train_cond_contrastive_loss: 78780.5904; train_gene_expr_recon_loss: 91467.1228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441199.1295; train_optim_loss: 441199.1295; val_kl_reg_loss: 5711.5820; val_edge_recon_loss: 264558.1875; val_cond_contrastive_loss: 78396.4766; val_gene_expr_recon_loss: 92288.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440954.6875; val_optim_loss: 440954.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9779; val_auprc_score: 0.9724; val_best_acc_score: 0.9302; val_best_f1_score: 0.9323; train_kl_reg_loss: 5794.1572; train_edge_recon_loss: 264554.0179; train_cond_contrastive_loss: 78754.5737; train_gene_expr_recon_loss: 90951.6853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440054.4196; train_optim_loss: 440054.4196; val_kl_reg_loss: 5711.2266; val_edge_recon_loss: 262740.9062; val_cond_contrastive_loss: 78394.4375; val_gene_expr_recon_loss: 92021.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438868.0625; val_optim_loss: 438868.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9826; val_auprc_score: 0.9777; val_best_acc_score: 0.9387; val_best_f1_score: 0.9406; train_kl_reg_loss: 5778.7210; train_edge_recon_loss: 263051.0491; train_cond_contrastive_loss: 78750.8136; train_gene_expr_recon_loss: 90823.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438403.9554; train_optim_loss: 438403.9554; val_kl_reg_loss: 5716.4009; val_edge_recon_loss: 260381.5156; val_cond_contrastive_loss: 78392.8594; val_gene_expr_recon_loss: 91776.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436266.9062; val_optim_loss: 436266.9062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9824; val_auprc_score: 0.9765; val_best_acc_score: 0.9401; val_best_f1_score: 0.9417; train_kl_reg_loss: 5798.8601; train_edge_recon_loss: 261589.1473; train_cond_contrastive_loss: 78744.6094; train_gene_expr_recon_loss: 90408.9933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436541.6161; train_optim_loss: 436541.6161; val_kl_reg_loss: 5745.7822; val_edge_recon_loss: 262492.2188; val_cond_contrastive_loss: 78392.7031; val_gene_expr_recon_loss: 91557.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438188.6250; val_optim_loss: 438188.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9844; val_auprc_score: 0.9810; val_best_acc_score: 0.9450; val_best_f1_score: 0.9468; train_kl_reg_loss: 5838.1579; train_edge_recon_loss: 260975.0402; train_cond_contrastive_loss: 78746.4989; train_gene_expr_recon_loss: 90416.0603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435975.7545; train_optim_loss: 435975.7545; val_kl_reg_loss: 5778.8525; val_edge_recon_loss: 259724.0781; val_cond_contrastive_loss: 78391.7188; val_gene_expr_recon_loss: 91292.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435186.9688; val_optim_loss: 435186.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9867; val_auprc_score: 0.9832; val_best_acc_score: 0.9465; val_best_f1_score: 0.9487; train_kl_reg_loss: 5813.0776; train_edge_recon_loss: 259914.3661; train_cond_contrastive_loss: 78751.7656; train_gene_expr_recon_loss: 90175.5826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434654.8036; train_optim_loss: 434654.8036; val_kl_reg_loss: 5739.5620; val_edge_recon_loss: 257501.4219; val_cond_contrastive_loss: 78391.0469; val_gene_expr_recon_loss: 91069.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432701.4375; val_optim_loss: 432701.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9862; val_auprc_score: 0.9816; val_best_acc_score: 0.9465; val_best_f1_score: 0.9482; train_kl_reg_loss: 5806.4044; train_edge_recon_loss: 259018.2790; train_cond_contrastive_loss: 78749.6830; train_gene_expr_recon_loss: 89708.1462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433282.5089; train_optim_loss: 433282.5089; val_kl_reg_loss: 5720.8550; val_edge_recon_loss: 259461.5469; val_cond_contrastive_loss: 78390.0547; val_gene_expr_recon_loss: 90866.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434439.0000; val_optim_loss: 434439.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9880; val_auprc_score: 0.9847; val_best_acc_score: 0.9493; val_best_f1_score: 0.9510; train_kl_reg_loss: 5811.3158; train_edge_recon_loss: 260592.6540; train_cond_contrastive_loss: 78743.6875; train_gene_expr_recon_loss: 89706.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434854.4420; train_optim_loss: 434854.4420; val_kl_reg_loss: 5749.3286; val_edge_recon_loss: 256954.3438; val_cond_contrastive_loss: 78390.4766; val_gene_expr_recon_loss: 90633.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431727.1875; val_optim_loss: 431727.1875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9888; val_auprc_score: 0.9865; val_best_acc_score: 0.9529; val_best_f1_score: 0.9545; train_kl_reg_loss: 5793.3908; train_edge_recon_loss: 260026.6295; train_cond_contrastive_loss: 78742.9007; train_gene_expr_recon_loss: 89343.1417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433906.0670; train_optim_loss: 433906.0670; val_kl_reg_loss: 5728.3379; val_edge_recon_loss: 256649.2031; val_cond_contrastive_loss: 78391.6484; val_gene_expr_recon_loss: 90397.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431166.9688; val_optim_loss: 431166.9688
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9892; val_auprc_score: 0.9852; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 5800.2031; train_edge_recon_loss: 260114.3705; train_cond_contrastive_loss: 78731.0949; train_gene_expr_recon_loss: 89419.3337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434065.0045; train_optim_loss: 434065.0045; val_kl_reg_loss: 5717.7109; val_edge_recon_loss: 257572.3750; val_cond_contrastive_loss: 78393.3047; val_gene_expr_recon_loss: 90184.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431867.8125; val_optim_loss: 431867.8125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9888; val_auprc_score: 0.9855; val_best_acc_score: 0.9560; val_best_f1_score: 0.9574; train_kl_reg_loss: 5762.7116; train_edge_recon_loss: 259389.0580; train_cond_contrastive_loss: 78736.7009; train_gene_expr_recon_loss: 89037.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432925.8482; train_optim_loss: 432925.8482; val_kl_reg_loss: 5645.7109; val_edge_recon_loss: 255991.0781; val_cond_contrastive_loss: 78395.8203; val_gene_expr_recon_loss: 89988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430020.5938; val_optim_loss: 430020.5938
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9908; val_auprc_score: 0.9893; val_best_acc_score: 0.9587; val_best_f1_score: 0.9599; train_kl_reg_loss: 5758.0848; train_edge_recon_loss: 259243.4754; train_cond_contrastive_loss: 78743.4520; train_gene_expr_recon_loss: 88801.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432546.2188; train_optim_loss: 432546.2188; val_kl_reg_loss: 5678.3701; val_edge_recon_loss: 256502.8125; val_cond_contrastive_loss: 78397.6875; val_gene_expr_recon_loss: 89811.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430390.5938; val_optim_loss: 430390.5938
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9910; val_auprc_score: 0.9886; val_best_acc_score: 0.9583; val_best_f1_score: 0.9595; train_kl_reg_loss: 5720.7151; train_edge_recon_loss: 259704.9799; train_cond_contrastive_loss: 78746.3884; train_gene_expr_recon_loss: 88768.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432940.3616; train_optim_loss: 432940.3616; val_kl_reg_loss: 5628.8579; val_edge_recon_loss: 257691.0625; val_cond_contrastive_loss: 78400.8359; val_gene_expr_recon_loss: 89650.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431371.0625; val_optim_loss: 431371.0625
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9908; val_auprc_score: 0.9882; val_best_acc_score: 0.9593; val_best_f1_score: 0.9605; train_kl_reg_loss: 5729.7298; train_edge_recon_loss: 258637.3125; train_cond_contrastive_loss: 78748.3504; train_gene_expr_recon_loss: 88235.3683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431350.7500; train_optim_loss: 431350.7500; val_kl_reg_loss: 5645.4072; val_edge_recon_loss: 257232.5781; val_cond_contrastive_loss: 78401.8516; val_gene_expr_recon_loss: 89475.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430755.2188; val_optim_loss: 430755.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9911; val_auprc_score: 0.9883; val_best_acc_score: 0.9597; val_best_f1_score: 0.9612; train_kl_reg_loss: 5708.4639; train_edge_recon_loss: 258496.2746; train_cond_contrastive_loss: 78748.8839; train_gene_expr_recon_loss: 88150.5804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431104.2009; train_optim_loss: 431104.2009; val_kl_reg_loss: 5636.7427; val_edge_recon_loss: 254110.0312; val_cond_contrastive_loss: 78402.5781; val_gene_expr_recon_loss: 89445.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427595.2500; val_optim_loss: 427595.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9888; val_auprc_score: 0.9852; val_best_acc_score: 0.9560; val_best_f1_score: 0.9574; train_kl_reg_loss: 5711.4600; train_edge_recon_loss: 259572.3884; train_cond_contrastive_loss: 78750.6261; train_gene_expr_recon_loss: 88141.7377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432176.2098; train_optim_loss: 432176.2098; val_kl_reg_loss: 5653.4375; val_edge_recon_loss: 257345.8594; val_cond_contrastive_loss: 78402.3828; val_gene_expr_recon_loss: 89419.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430821.5625; val_optim_loss: 430821.5625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9911; val_auprc_score: 0.9884; val_best_acc_score: 0.9623; val_best_f1_score: 0.9631; train_kl_reg_loss: 5729.0915; train_edge_recon_loss: 258857.7679; train_cond_contrastive_loss: 78742.0156; train_gene_expr_recon_loss: 88377.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431706.4062; train_optim_loss: 431706.4062; val_kl_reg_loss: 5659.9053; val_edge_recon_loss: 256007.4375; val_cond_contrastive_loss: 78402.4766; val_gene_expr_recon_loss: 89401.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429471.3750; val_optim_loss: 429471.3750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9908; val_auprc_score: 0.9890; val_best_acc_score: 0.9595; val_best_f1_score: 0.9608; train_kl_reg_loss: 5725.9673; train_edge_recon_loss: 258620.5603; train_cond_contrastive_loss: 78747.1049; train_gene_expr_recon_loss: 88228.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431322.2054; train_optim_loss: 431322.2054; val_kl_reg_loss: 5653.8389; val_edge_recon_loss: 255341.0781; val_cond_contrastive_loss: 78402.9141; val_gene_expr_recon_loss: 89386.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428783.8750; val_optim_loss: 428783.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9902; val_auprc_score: 0.9843; val_best_acc_score: 0.9601; val_best_f1_score: 0.9613; train_kl_reg_loss: 5727.7086; train_edge_recon_loss: 259049.6094; train_cond_contrastive_loss: 78747.1908; train_gene_expr_recon_loss: 88336.4174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431860.9196; train_optim_loss: 431860.9196; val_kl_reg_loss: 5654.3301; val_edge_recon_loss: 256293.5312; val_cond_contrastive_loss: 78402.6562; val_gene_expr_recon_loss: 89384.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429734.5938; val_optim_loss: 429734.5938
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9912; val_auprc_score: 0.9888; val_best_acc_score: 0.9584; val_best_f1_score: 0.9596; train_kl_reg_loss: 5720.2889; train_edge_recon_loss: 259436.7991; train_cond_contrastive_loss: 78745.7634; train_gene_expr_recon_loss: 88122.8917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432025.7455; train_optim_loss: 432025.7455; val_kl_reg_loss: 5655.9629; val_edge_recon_loss: 257128.5312; val_cond_contrastive_loss: 78402.8125; val_gene_expr_recon_loss: 89381.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430569.0000; val_optim_loss: 430569.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9899; val_auprc_score: 0.9868; val_best_acc_score: 0.9578; val_best_f1_score: 0.9593; train_kl_reg_loss: 5724.5500; train_edge_recon_loss: 258521.1451; train_cond_contrastive_loss: 78746.7344; train_gene_expr_recon_loss: 88158.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431151.2589; train_optim_loss: 431151.2589; val_kl_reg_loss: 5649.8584; val_edge_recon_loss: 254857.4531; val_cond_contrastive_loss: 78403.1484; val_gene_expr_recon_loss: 89379.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428289.9375; val_optim_loss: 428289.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 31 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9865
Val best accuracy score: 0.9571
Val best F1 score: 0.9581
Val gene expr MSE score: 1.3811
Duration of model training in run 8: 0 hours, 2 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7798; val_auprc_score: 0.8085; val_best_acc_score: 0.6936; val_best_f1_score: 0.7262; train_kl_reg_loss: 6564.7994; train_edge_recon_loss: 355505.0104; train_cond_contrastive_loss: 103357.6701; train_gene_expr_recon_loss: 114979.6589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 580407.1458; train_optim_loss: 580407.1458; val_kl_reg_loss: 7279.2075; val_edge_recon_loss: 396310.4062; val_cond_contrastive_loss: 78333.3516; val_gene_expr_recon_loss: 100209.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 582132.1875; val_optim_loss: 582132.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7480; val_auprc_score: 0.7667; val_best_acc_score: 0.6610; val_best_f1_score: 0.7158; train_kl_reg_loss: 5894.1312; train_edge_recon_loss: 350878.1354; train_cond_contrastive_loss: 88720.1988; train_gene_expr_recon_loss: 99357.8941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544850.3681; train_optim_loss: 544850.3681; val_kl_reg_loss: 4496.4341; val_edge_recon_loss: 353998.6875; val_cond_contrastive_loss: 78396.6094; val_gene_expr_recon_loss: 98620.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535512.2500; val_optim_loss: 535512.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7499; val_auprc_score: 0.7685; val_best_acc_score: 0.6738; val_best_f1_score: 0.7109; train_kl_reg_loss: 3770.1959; train_edge_recon_loss: 327683.5868; train_cond_contrastive_loss: 84149.1476; train_gene_expr_recon_loss: 98215.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513817.9826; train_optim_loss: 513817.9826; val_kl_reg_loss: 4131.7896; val_edge_recon_loss: 319941.8750; val_cond_contrastive_loss: 78345.1172; val_gene_expr_recon_loss: 97591.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500009.9375; val_optim_loss: 500009.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8232; val_auprc_score: 0.8165; val_best_acc_score: 0.7360; val_best_f1_score: 0.7665; train_kl_reg_loss: 4863.6915; train_edge_recon_loss: 304732.7361; train_cond_contrastive_loss: 78993.6163; train_gene_expr_recon_loss: 97200.9054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485790.9514; train_optim_loss: 485790.9514; val_kl_reg_loss: 5574.8613; val_edge_recon_loss: 293431.5938; val_cond_contrastive_loss: 78356.6094; val_gene_expr_recon_loss: 96701.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474064.1250; val_optim_loss: 474064.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8567; val_auprc_score: 0.8352; val_best_acc_score: 0.7817; val_best_f1_score: 0.8070; train_kl_reg_loss: 6054.8936; train_edge_recon_loss: 283951.2361; train_cond_contrastive_loss: 78717.6562; train_gene_expr_recon_loss: 96272.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464996.2222; train_optim_loss: 464996.2222; val_kl_reg_loss: 6224.3569; val_edge_recon_loss: 280855.7188; val_cond_contrastive_loss: 78361.9688; val_gene_expr_recon_loss: 95689.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461131.5625; val_optim_loss: 461131.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8818; val_auprc_score: 0.8557; val_best_acc_score: 0.8116; val_best_f1_score: 0.8257; train_kl_reg_loss: 6160.6737; train_edge_recon_loss: 278050.3785; train_cond_contrastive_loss: 78937.5616; train_gene_expr_recon_loss: 95447.6901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458596.3021; train_optim_loss: 458596.3021; val_kl_reg_loss: 6095.8193; val_edge_recon_loss: 277149.9375; val_cond_contrastive_loss: 78363.2344; val_gene_expr_recon_loss: 94919.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456528.3125; val_optim_loss: 456528.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9055; val_auprc_score: 0.8830; val_best_acc_score: 0.8423; val_best_f1_score: 0.8562; train_kl_reg_loss: 6277.3174; train_edge_recon_loss: 274507.2257; train_cond_contrastive_loss: 78997.1710; train_gene_expr_recon_loss: 94723.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454505.5347; train_optim_loss: 454505.5347; val_kl_reg_loss: 6288.5210; val_edge_recon_loss: 270919.1562; val_cond_contrastive_loss: 78375.1016; val_gene_expr_recon_loss: 94468.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450051.3125; val_optim_loss: 450051.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9349; val_auprc_score: 0.9213; val_best_acc_score: 0.8673; val_best_f1_score: 0.8758; train_kl_reg_loss: 6229.4206; train_edge_recon_loss: 271592.4618; train_cond_contrastive_loss: 78970.5321; train_gene_expr_recon_loss: 94198.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450990.7778; train_optim_loss: 450990.7778; val_kl_reg_loss: 5959.9424; val_edge_recon_loss: 270230.6875; val_cond_contrastive_loss: 78396.0625; val_gene_expr_recon_loss: 93877.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448464.0000; val_optim_loss: 448464.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9532; val_auprc_score: 0.9441; val_best_acc_score: 0.8889; val_best_f1_score: 0.8938; train_kl_reg_loss: 6132.5618; train_edge_recon_loss: 267776.7188; train_cond_contrastive_loss: 78844.0356; train_gene_expr_recon_loss: 93672.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446426.2188; train_optim_loss: 446426.2188; val_kl_reg_loss: 6155.4062; val_edge_recon_loss: 268688.2812; val_cond_contrastive_loss: 78399.3906; val_gene_expr_recon_loss: 93416.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446659.2812; val_optim_loss: 446659.2812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9628; val_auprc_score: 0.9523; val_best_acc_score: 0.9067; val_best_f1_score: 0.9102; train_kl_reg_loss: 6312.0735; train_edge_recon_loss: 266929.9896; train_cond_contrastive_loss: 78723.9696; train_gene_expr_recon_loss: 93091.6024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445057.6319; train_optim_loss: 445057.6319; val_kl_reg_loss: 6194.3745; val_edge_recon_loss: 268515.7812; val_cond_contrastive_loss: 78392.9453; val_gene_expr_recon_loss: 92946.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446049.1875; val_optim_loss: 446049.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9713; val_auprc_score: 0.9635; val_best_acc_score: 0.9232; val_best_f1_score: 0.9251; train_kl_reg_loss: 6236.9506; train_edge_recon_loss: 264895.6111; train_cond_contrastive_loss: 78747.9392; train_gene_expr_recon_loss: 92679.4401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442559.9444; train_optim_loss: 442559.9444; val_kl_reg_loss: 5991.2290; val_edge_recon_loss: 266141.0000; val_cond_contrastive_loss: 78392.2578; val_gene_expr_recon_loss: 92446.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442970.6875; val_optim_loss: 442970.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9760; val_auprc_score: 0.9677; val_best_acc_score: 0.9314; val_best_f1_score: 0.9329; train_kl_reg_loss: 6000.6806; train_edge_recon_loss: 263832.9045; train_cond_contrastive_loss: 78790.2795; train_gene_expr_recon_loss: 92253.3568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440877.2153; train_optim_loss: 440877.2153; val_kl_reg_loss: 5820.9658; val_edge_recon_loss: 263315.3750; val_cond_contrastive_loss: 78392.4609; val_gene_expr_recon_loss: 92048.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439577.4375; val_optim_loss: 439577.4375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9822; val_auprc_score: 0.9784; val_best_acc_score: 0.9397; val_best_f1_score: 0.9411; train_kl_reg_loss: 5907.7027; train_edge_recon_loss: 262841.4340; train_cond_contrastive_loss: 78750.3464; train_gene_expr_recon_loss: 91852.3229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439351.8056; train_optim_loss: 439351.8056; val_kl_reg_loss: 5783.0630; val_edge_recon_loss: 263007.6562; val_cond_contrastive_loss: 78386.7578; val_gene_expr_recon_loss: 91702.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438880.3750; val_optim_loss: 438880.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9829; val_auprc_score: 0.9787; val_best_acc_score: 0.9420; val_best_f1_score: 0.9436; train_kl_reg_loss: 5850.1560; train_edge_recon_loss: 261973.8333; train_cond_contrastive_loss: 78719.3142; train_gene_expr_recon_loss: 91482.2405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438025.5451; train_optim_loss: 438025.5451; val_kl_reg_loss: 5773.2358; val_edge_recon_loss: 261891.0312; val_cond_contrastive_loss: 78382.3125; val_gene_expr_recon_loss: 91380.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437427.1562; val_optim_loss: 437427.1562
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9836; val_auprc_score: 0.9789; val_best_acc_score: 0.9426; val_best_f1_score: 0.9438; train_kl_reg_loss: 5799.0493; train_edge_recon_loss: 261016.1042; train_cond_contrastive_loss: 78707.6094; train_gene_expr_recon_loss: 91225.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436748.0972; train_optim_loss: 436748.0972; val_kl_reg_loss: 5745.5303; val_edge_recon_loss: 262334.1562; val_cond_contrastive_loss: 78380.0312; val_gene_expr_recon_loss: 91091.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437550.9375; val_optim_loss: 437550.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9842; val_auprc_score: 0.9795; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 5784.6464; train_edge_recon_loss: 260683.6597; train_cond_contrastive_loss: 78705.5208; train_gene_expr_recon_loss: 90926.4887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436100.3160; train_optim_loss: 436100.3160; val_kl_reg_loss: 5640.2144; val_edge_recon_loss: 261666.1250; val_cond_contrastive_loss: 78379.7891; val_gene_expr_recon_loss: 90785.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436471.9375; val_optim_loss: 436471.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9857; val_auprc_score: 0.9809; val_best_acc_score: 0.9501; val_best_f1_score: 0.9515; train_kl_reg_loss: 5784.8566; train_edge_recon_loss: 260697.2708; train_cond_contrastive_loss: 78704.6727; train_gene_expr_recon_loss: 90597.5122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435784.3125; train_optim_loss: 435784.3125; val_kl_reg_loss: 5703.1006; val_edge_recon_loss: 260233.4688; val_cond_contrastive_loss: 78381.3281; val_gene_expr_recon_loss: 90495.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434813.7500; val_optim_loss: 434813.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9869; val_auprc_score: 0.9832; val_best_acc_score: 0.9508; val_best_f1_score: 0.9521; train_kl_reg_loss: 5778.2428; train_edge_recon_loss: 259809.7951; train_cond_contrastive_loss: 78721.9227; train_gene_expr_recon_loss: 90247.6215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434557.5729; train_optim_loss: 434557.5729; val_kl_reg_loss: 5704.3931; val_edge_recon_loss: 259507.0312; val_cond_contrastive_loss: 78380.9375; val_gene_expr_recon_loss: 90193.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433786.1875; val_optim_loss: 433786.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9873; val_auprc_score: 0.9825; val_best_acc_score: 0.9514; val_best_f1_score: 0.9528; train_kl_reg_loss: 5786.5494; train_edge_recon_loss: 259413.0903; train_cond_contrastive_loss: 78718.6997; train_gene_expr_recon_loss: 89951.5851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433869.9236; train_optim_loss: 433869.9236; val_kl_reg_loss: 5701.2402; val_edge_recon_loss: 259107.2656; val_cond_contrastive_loss: 78380.2500; val_gene_expr_recon_loss: 89910.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433099.6875; val_optim_loss: 433099.6875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9889; val_auprc_score: 0.9863; val_best_acc_score: 0.9559; val_best_f1_score: 0.9565; train_kl_reg_loss: 5788.9035; train_edge_recon_loss: 259355.6684; train_cond_contrastive_loss: 78715.9974; train_gene_expr_recon_loss: 89781.6259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433642.1944; train_optim_loss: 433642.1944; val_kl_reg_loss: 5732.5186; val_edge_recon_loss: 258798.0625; val_cond_contrastive_loss: 78381.9453; val_gene_expr_recon_loss: 89664.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432576.8125; val_optim_loss: 432576.8125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9893; val_auprc_score: 0.9867; val_best_acc_score: 0.9568; val_best_f1_score: 0.9575; train_kl_reg_loss: 5778.2916; train_edge_recon_loss: 258568.1545; train_cond_contrastive_loss: 78708.0738; train_gene_expr_recon_loss: 89442.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432497.3368; train_optim_loss: 432497.3368; val_kl_reg_loss: 5682.9912; val_edge_recon_loss: 261140.5000; val_cond_contrastive_loss: 78384.2734; val_gene_expr_recon_loss: 89409.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434617.4688; val_optim_loss: 434617.4688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9897; val_auprc_score: 0.9859; val_best_acc_score: 0.9580; val_best_f1_score: 0.9590; train_kl_reg_loss: 5770.5745; train_edge_recon_loss: 258103.4896; train_cond_contrastive_loss: 78707.6128; train_gene_expr_recon_loss: 89288.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431869.9375; train_optim_loss: 431869.9375; val_kl_reg_loss: 5670.3228; val_edge_recon_loss: 258415.9688; val_cond_contrastive_loss: 78386.0000; val_gene_expr_recon_loss: 89139.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431611.4062; val_optim_loss: 431611.4062
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9906; val_auprc_score: 0.9882; val_best_acc_score: 0.9585; val_best_f1_score: 0.9589; train_kl_reg_loss: 5758.0397; train_edge_recon_loss: 258416.4740; train_cond_contrastive_loss: 78722.6068; train_gene_expr_recon_loss: 88944.6102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431841.7326; train_optim_loss: 431841.7326; val_kl_reg_loss: 5683.1455; val_edge_recon_loss: 261658.2812; val_cond_contrastive_loss: 78387.7734; val_gene_expr_recon_loss: 88883.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434612.6875; val_optim_loss: 434612.6875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9906; val_auprc_score: 0.9873; val_best_acc_score: 0.9598; val_best_f1_score: 0.9606; train_kl_reg_loss: 5740.0173; train_edge_recon_loss: 258720.4653; train_cond_contrastive_loss: 78730.6493; train_gene_expr_recon_loss: 88664.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431855.2153; train_optim_loss: 431855.2153; val_kl_reg_loss: 5684.7012; val_edge_recon_loss: 257062.5781; val_cond_contrastive_loss: 78389.3516; val_gene_expr_recon_loss: 88663.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429799.7500; val_optim_loss: 429799.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9899; val_auprc_score: 0.9863; val_best_acc_score: 0.9582; val_best_f1_score: 0.9591; train_kl_reg_loss: 5750.6472; train_edge_recon_loss: 257940.3715; train_cond_contrastive_loss: 78731.0165; train_gene_expr_recon_loss: 88521.7830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430943.8194; train_optim_loss: 430943.8194; val_kl_reg_loss: 5662.8599; val_edge_recon_loss: 258307.5781; val_cond_contrastive_loss: 78390.9219; val_gene_expr_recon_loss: 88446.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430808.2812; val_optim_loss: 430808.2812
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9917; val_auprc_score: 0.9892; val_best_acc_score: 0.9626; val_best_f1_score: 0.9632; train_kl_reg_loss: 5749.9463; train_edge_recon_loss: 257614.2917; train_cond_contrastive_loss: 78736.3698; train_gene_expr_recon_loss: 88225.1502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430325.7569; train_optim_loss: 430325.7569; val_kl_reg_loss: 5688.1377; val_edge_recon_loss: 258429.8594; val_cond_contrastive_loss: 78391.4453; val_gene_expr_recon_loss: 88230.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430739.6250; val_optim_loss: 430739.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9914; val_auprc_score: 0.9885; val_best_acc_score: 0.9635; val_best_f1_score: 0.9646; train_kl_reg_loss: 5717.8454; train_edge_recon_loss: 256449.8976; train_cond_contrastive_loss: 78745.9514; train_gene_expr_recon_loss: 88048.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428961.7569; train_optim_loss: 428961.7569; val_kl_reg_loss: 5614.2539; val_edge_recon_loss: 256641.8281; val_cond_contrastive_loss: 78391.6172; val_gene_expr_recon_loss: 88026.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428674.1875; val_optim_loss: 428674.1875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9865; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 5705.2786; train_edge_recon_loss: 256322.8212; train_cond_contrastive_loss: 78727.6302; train_gene_expr_recon_loss: 87785.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428541.7014; train_optim_loss: 428541.7014; val_kl_reg_loss: 5564.5684; val_edge_recon_loss: 258375.3438; val_cond_contrastive_loss: 78393.5547; val_gene_expr_recon_loss: 87860.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430193.9062; val_optim_loss: 430193.9062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 5665.0450; train_edge_recon_loss: 257214.8038; train_cond_contrastive_loss: 78720.9306; train_gene_expr_recon_loss: 87652.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429253.5243; train_optim_loss: 429253.5243; val_kl_reg_loss: 5634.9668; val_edge_recon_loss: 260264.4219; val_cond_contrastive_loss: 78392.8594; val_gene_expr_recon_loss: 87674.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431967.0312; val_optim_loss: 431967.0312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9656; val_best_f1_score: 0.9664; train_kl_reg_loss: 5652.5819; train_edge_recon_loss: 256797.2778; train_cond_contrastive_loss: 78717.0634; train_gene_expr_recon_loss: 87501.1840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428668.1111; train_optim_loss: 428668.1111; val_kl_reg_loss: 5594.0430; val_edge_recon_loss: 255810.5938; val_cond_contrastive_loss: 78394.8125; val_gene_expr_recon_loss: 87530.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427330.1562; val_optim_loss: 427330.1562
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9929; val_auprc_score: 0.9896; val_best_acc_score: 0.9679; val_best_f1_score: 0.9689; train_kl_reg_loss: 5658.4543; train_edge_recon_loss: 257682.9149; train_cond_contrastive_loss: 78724.8620; train_gene_expr_recon_loss: 87362.7700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429429.0000; train_optim_loss: 429429.0000; val_kl_reg_loss: 5580.0869; val_edge_recon_loss: 256193.0938; val_cond_contrastive_loss: 78398.5781; val_gene_expr_recon_loss: 87382.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427553.8125; val_optim_loss: 427553.8125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9920; val_auprc_score: 0.9852; val_best_acc_score: 0.9669; val_best_f1_score: 0.9680; train_kl_reg_loss: 5649.7180; train_edge_recon_loss: 257391.1424; train_cond_contrastive_loss: 78725.8273; train_gene_expr_recon_loss: 87180.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428947.1806; train_optim_loss: 428947.1806; val_kl_reg_loss: 5556.9385; val_edge_recon_loss: 255233.7031; val_cond_contrastive_loss: 78401.1328; val_gene_expr_recon_loss: 87216.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426408.2188; val_optim_loss: 426408.2188
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9920; val_auprc_score: 0.9894; val_best_acc_score: 0.9648; val_best_f1_score: 0.9658; train_kl_reg_loss: 5649.3110; train_edge_recon_loss: 257231.8281; train_cond_contrastive_loss: 78721.1875; train_gene_expr_recon_loss: 87090.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428693.0243; train_optim_loss: 428693.0243; val_kl_reg_loss: 5532.2793; val_edge_recon_loss: 256294.5781; val_cond_contrastive_loss: 78401.7422; val_gene_expr_recon_loss: 87082.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427310.9375; val_optim_loss: 427310.9375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9933; val_auprc_score: 0.9914; val_best_acc_score: 0.9692; val_best_f1_score: 0.9696; train_kl_reg_loss: 5644.6705; train_edge_recon_loss: 256109.5278; train_cond_contrastive_loss: 78728.5460; train_gene_expr_recon_loss: 86925.8811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427408.6181; train_optim_loss: 427408.6181; val_kl_reg_loss: 5533.7949; val_edge_recon_loss: 257885.7500; val_cond_contrastive_loss: 78402.7812; val_gene_expr_recon_loss: 86954.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428776.4688; val_optim_loss: 428776.4688
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9924; val_auprc_score: 0.9874; val_best_acc_score: 0.9677; val_best_f1_score: 0.9684; train_kl_reg_loss: 5645.4110; train_edge_recon_loss: 256788.8038; train_cond_contrastive_loss: 78733.1189; train_gene_expr_recon_loss: 86585.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427753.0104; train_optim_loss: 427753.0104; val_kl_reg_loss: 5605.1445; val_edge_recon_loss: 257003.7188; val_cond_contrastive_loss: 78402.5859; val_gene_expr_recon_loss: 86824.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427836.2188; val_optim_loss: 427836.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9935; val_auprc_score: 0.9901; val_best_acc_score: 0.9710; val_best_f1_score: 0.9716; train_kl_reg_loss: 5675.6072; train_edge_recon_loss: 255847.5694; train_cond_contrastive_loss: 78728.6884; train_gene_expr_recon_loss: 86609.5043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426861.3646; train_optim_loss: 426861.3646; val_kl_reg_loss: 5572.3818; val_edge_recon_loss: 257092.7188; val_cond_contrastive_loss: 78402.7500; val_gene_expr_recon_loss: 86783.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427851.4688; val_optim_loss: 427851.4688
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9939; val_auprc_score: 0.9914; val_best_acc_score: 0.9703; val_best_f1_score: 0.9710; train_kl_reg_loss: 5642.6875; train_edge_recon_loss: 256298.3194; train_cond_contrastive_loss: 78730.7326; train_gene_expr_recon_loss: 86632.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427304.4514; train_optim_loss: 427304.4514; val_kl_reg_loss: 5551.6494; val_edge_recon_loss: 255407.7812; val_cond_contrastive_loss: 78403.3594; val_gene_expr_recon_loss: 86766.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426129.5625; val_optim_loss: 426129.5625
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9936; val_auprc_score: 0.9910; val_best_acc_score: 0.9713; val_best_f1_score: 0.9720; train_kl_reg_loss: 5631.9350; train_edge_recon_loss: 256682.1701; train_cond_contrastive_loss: 78731.8802; train_gene_expr_recon_loss: 86638.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427684.5903; train_optim_loss: 427684.5903; val_kl_reg_loss: 5558.1016; val_edge_recon_loss: 255383.8438; val_cond_contrastive_loss: 78403.2734; val_gene_expr_recon_loss: 86750.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426095.3438; val_optim_loss: 426095.3438
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9929; val_auprc_score: 0.9901; val_best_acc_score: 0.9677; val_best_f1_score: 0.9687; train_kl_reg_loss: 5644.2154; train_edge_recon_loss: 256263.9080; train_cond_contrastive_loss: 78728.4167; train_gene_expr_recon_loss: 86565.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427202.2778; train_optim_loss: 427202.2778; val_kl_reg_loss: 5566.1943; val_edge_recon_loss: 255903.3281; val_cond_contrastive_loss: 78403.2109; val_gene_expr_recon_loss: 86736.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426609.5000; val_optim_loss: 426609.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9934; val_auprc_score: 0.9917; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 5643.9314; train_edge_recon_loss: 255883.3142; train_cond_contrastive_loss: 78727.0217; train_gene_expr_recon_loss: 86618.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426873.0069; train_optim_loss: 426873.0069; val_kl_reg_loss: 5555.8174; val_edge_recon_loss: 255993.4531; val_cond_contrastive_loss: 78403.3359; val_gene_expr_recon_loss: 86723.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426676.0625; val_optim_loss: 426676.0625
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9930; val_auprc_score: 0.9897; val_best_acc_score: 0.9687; val_best_f1_score: 0.9695; train_kl_reg_loss: 5630.9683; train_edge_recon_loss: 256158.2222; train_cond_contrastive_loss: 78729.8134; train_gene_expr_recon_loss: 86501.7439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427020.7500; train_optim_loss: 427020.7500; val_kl_reg_loss: 5557.6387; val_edge_recon_loss: 257633.3281; val_cond_contrastive_loss: 78403.5469; val_gene_expr_recon_loss: 86709.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428304.0312; val_optim_loss: 428304.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9936; val_auprc_score: 0.9905; val_best_acc_score: 0.9701; val_best_f1_score: 0.9708; train_kl_reg_loss: 5634.9961; train_edge_recon_loss: 256113.9809; train_cond_contrastive_loss: 78729.8785; train_gene_expr_recon_loss: 86589.6233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427068.4826; train_optim_loss: 427068.4826; val_kl_reg_loss: 5552.6226; val_edge_recon_loss: 255924.7656; val_cond_contrastive_loss: 78403.3750; val_gene_expr_recon_loss: 86707.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426588.2188; val_optim_loss: 426588.2188
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9938; val_auprc_score: 0.9921; val_best_acc_score: 0.9712; val_best_f1_score: 0.9720; train_kl_reg_loss: 5632.8333; train_edge_recon_loss: 256297.4288; train_cond_contrastive_loss: 78729.9592; train_gene_expr_recon_loss: 86603.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427263.9618; train_optim_loss: 427263.9618; val_kl_reg_loss: 5553.3667; val_edge_recon_loss: 254826.5156; val_cond_contrastive_loss: 78403.7891; val_gene_expr_recon_loss: 86706.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425490.1562; val_optim_loss: 425490.1562
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9932; val_auprc_score: 0.9915; val_best_acc_score: 0.9683; val_best_f1_score: 0.9689; train_kl_reg_loss: 5628.9247; train_edge_recon_loss: 255994.0278; train_cond_contrastive_loss: 78730.0660; train_gene_expr_recon_loss: 86587.7526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426940.7708; train_optim_loss: 426940.7708; val_kl_reg_loss: 5550.0469; val_edge_recon_loss: 257481.7188; val_cond_contrastive_loss: 78403.5234; val_gene_expr_recon_loss: 86705.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428140.6250; val_optim_loss: 428140.6250
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9926; val_auprc_score: 0.9882; val_best_acc_score: 0.9699; val_best_f1_score: 0.9705; train_kl_reg_loss: 5631.6956; train_edge_recon_loss: 256734.4653; train_cond_contrastive_loss: 78730.2561; train_gene_expr_recon_loss: 86528.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427624.5243; train_optim_loss: 427624.5243; val_kl_reg_loss: 5551.0420; val_edge_recon_loss: 257126.8125; val_cond_contrastive_loss: 78403.7812; val_gene_expr_recon_loss: 86703.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427785.3750; val_optim_loss: 427785.3750
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9932; val_auprc_score: 0.9891; val_best_acc_score: 0.9692; val_best_f1_score: 0.9701; train_kl_reg_loss: 5634.5844; train_edge_recon_loss: 256407.7795; train_cond_contrastive_loss: 78729.2700; train_gene_expr_recon_loss: 86565.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427336.9792; train_optim_loss: 427336.9792; val_kl_reg_loss: 5551.0938; val_edge_recon_loss: 256235.8750; val_cond_contrastive_loss: 78404.0078; val_gene_expr_recon_loss: 86702.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426893.3750; val_optim_loss: 426893.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9929; val_auprc_score: 0.9894; val_best_acc_score: 0.9705; val_best_f1_score: 0.9711; train_kl_reg_loss: 5631.5526; train_edge_recon_loss: 256529.2135; train_cond_contrastive_loss: 78731.3273; train_gene_expr_recon_loss: 86471.5920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427363.6771; train_optim_loss: 427363.6771; val_kl_reg_loss: 5554.8257; val_edge_recon_loss: 257678.9531; val_cond_contrastive_loss: 78403.4688; val_gene_expr_recon_loss: 86702.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428339.5312; val_optim_loss: 428339.5312
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9924; val_auprc_score: 0.9896; val_best_acc_score: 0.9673; val_best_f1_score: 0.9678; train_kl_reg_loss: 5634.3392; train_edge_recon_loss: 256557.4826; train_cond_contrastive_loss: 78730.7865; train_gene_expr_recon_loss: 86498.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427421.1597; train_optim_loss: 427421.1597; val_kl_reg_loss: 5555.7061; val_edge_recon_loss: 258659.5156; val_cond_contrastive_loss: 78403.4766; val_gene_expr_recon_loss: 86702.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429320.8438; val_optim_loss: 429320.8438
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9933; val_auprc_score: 0.9917; val_best_acc_score: 0.9692; val_best_f1_score: 0.9700; train_kl_reg_loss: 5634.3062; train_edge_recon_loss: 256352.7344; train_cond_contrastive_loss: 78730.2700; train_gene_expr_recon_loss: 86594.8915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427312.1944; train_optim_loss: 427312.1944; val_kl_reg_loss: 5552.5093; val_edge_recon_loss: 256471.5781; val_cond_contrastive_loss: 78403.6094; val_gene_expr_recon_loss: 86702.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427129.7188; val_optim_loss: 427129.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 28 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
Val AUROC score: 0.9923
Val AUPRC score: 0.9875
Val best accuracy score: 0.9664
Val best F1 score: 0.9673
Val gene expr MSE score: 1.1940
Duration of model training in run 9: 0 hours, 4 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7799; val_auprc_score: 0.8096; val_best_acc_score: 0.6970; val_best_f1_score: 0.7130; train_kl_reg_loss: 7267.4724; train_edge_recon_loss: 353695.9618; train_cond_contrastive_loss: 101712.4974; train_gene_expr_recon_loss: 117294.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 579970.1458; train_optim_loss: 579970.1458; val_kl_reg_loss: 7444.3828; val_edge_recon_loss: 402655.1562; val_cond_contrastive_loss: 78330.7656; val_gene_expr_recon_loss: 102438.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 590869.0625; val_optim_loss: 590869.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7606; val_auprc_score: 0.7810; val_best_acc_score: 0.6727; val_best_f1_score: 0.7174; train_kl_reg_loss: 6777.1188; train_edge_recon_loss: 351265.0312; train_cond_contrastive_loss: 87619.4939; train_gene_expr_recon_loss: 100046.8767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545708.5208; train_optim_loss: 545708.5208; val_kl_reg_loss: 4129.1265; val_edge_recon_loss: 364014.7500; val_cond_contrastive_loss: 78389.6406; val_gene_expr_recon_loss: 100020.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546553.6875; val_optim_loss: 546553.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7659; val_auprc_score: 0.7856; val_best_acc_score: 0.6857; val_best_f1_score: 0.7098; train_kl_reg_loss: 4050.8514; train_edge_recon_loss: 326420.5833; train_cond_contrastive_loss: 85185.5677; train_gene_expr_recon_loss: 98522.8663; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 514179.8646; train_optim_loss: 514179.8646; val_kl_reg_loss: 4856.4229; val_edge_recon_loss: 318450.9062; val_cond_contrastive_loss: 78353.6953; val_gene_expr_recon_loss: 98953.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500614.3125; val_optim_loss: 500614.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8384; val_auprc_score: 0.8321; val_best_acc_score: 0.7493; val_best_f1_score: 0.7787; train_kl_reg_loss: 5517.1052; train_edge_recon_loss: 301165.4826; train_cond_contrastive_loss: 78917.3420; train_gene_expr_recon_loss: 97473.1215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483073.0451; train_optim_loss: 483073.0451; val_kl_reg_loss: 6161.7256; val_edge_recon_loss: 289480.9688; val_cond_contrastive_loss: 78363.2188; val_gene_expr_recon_loss: 97914.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471919.9375; val_optim_loss: 471919.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8588; val_auprc_score: 0.8410; val_best_acc_score: 0.7741; val_best_f1_score: 0.7996; train_kl_reg_loss: 6190.7392; train_edge_recon_loss: 283254.4757; train_cond_contrastive_loss: 78743.5998; train_gene_expr_recon_loss: 96464.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464653.6840; train_optim_loss: 464653.6840; val_kl_reg_loss: 5992.1914; val_edge_recon_loss: 283849.5625; val_cond_contrastive_loss: 78364.5625; val_gene_expr_recon_loss: 96943.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465149.6875; val_optim_loss: 465149.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8826; val_auprc_score: 0.8600; val_best_acc_score: 0.8098; val_best_f1_score: 0.8256; train_kl_reg_loss: 5879.3258; train_edge_recon_loss: 277758.7326; train_cond_contrastive_loss: 79013.7934; train_gene_expr_recon_loss: 95467.5330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458119.3854; train_optim_loss: 458119.3854; val_kl_reg_loss: 5938.4370; val_edge_recon_loss: 278801.2188; val_cond_contrastive_loss: 78367.3906; val_gene_expr_recon_loss: 96203.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459310.5938; val_optim_loss: 459310.5938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9067; val_auprc_score: 0.8822; val_best_acc_score: 0.8343; val_best_f1_score: 0.8492; train_kl_reg_loss: 6153.4083; train_edge_recon_loss: 273445.5833; train_cond_contrastive_loss: 78994.8993; train_gene_expr_recon_loss: 94894.9731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453488.8646; train_optim_loss: 453488.8646; val_kl_reg_loss: 6126.7319; val_edge_recon_loss: 278129.6875; val_cond_contrastive_loss: 78380.8203; val_gene_expr_recon_loss: 95672.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458309.8438; val_optim_loss: 458309.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9354; val_auprc_score: 0.9211; val_best_acc_score: 0.8645; val_best_f1_score: 0.8715; train_kl_reg_loss: 6008.7634; train_edge_recon_loss: 270432.1354; train_cond_contrastive_loss: 78979.8602; train_gene_expr_recon_loss: 94383.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449803.9410; train_optim_loss: 449803.9410; val_kl_reg_loss: 5832.8296; val_edge_recon_loss: 272493.8750; val_cond_contrastive_loss: 78394.9922; val_gene_expr_recon_loss: 95131.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451852.8750; val_optim_loss: 451852.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9490; val_auprc_score: 0.9380; val_best_acc_score: 0.8863; val_best_f1_score: 0.8906; train_kl_reg_loss: 5980.4472; train_edge_recon_loss: 267789.6354; train_cond_contrastive_loss: 78819.0981; train_gene_expr_recon_loss: 93875.7517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446464.9271; train_optim_loss: 446464.9271; val_kl_reg_loss: 6069.6855; val_edge_recon_loss: 269796.7500; val_cond_contrastive_loss: 78392.7109; val_gene_expr_recon_loss: 94613.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448872.3750; val_optim_loss: 448872.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9583; val_auprc_score: 0.9477; val_best_acc_score: 0.8983; val_best_f1_score: 0.9020; train_kl_reg_loss: 6158.5563; train_edge_recon_loss: 267121.9757; train_cond_contrastive_loss: 78717.0382; train_gene_expr_recon_loss: 93196.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445193.7986; train_optim_loss: 445193.7986; val_kl_reg_loss: 6120.4287; val_edge_recon_loss: 267099.2500; val_cond_contrastive_loss: 78387.3047; val_gene_expr_recon_loss: 94114.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445721.4688; val_optim_loss: 445721.4688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9659; val_auprc_score: 0.9559; val_best_acc_score: 0.9106; val_best_f1_score: 0.9139; train_kl_reg_loss: 6125.6404; train_edge_recon_loss: 264815.4583; train_cond_contrastive_loss: 78720.9757; train_gene_expr_recon_loss: 92883.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442545.9549; train_optim_loss: 442545.9549; val_kl_reg_loss: 5932.7246; val_edge_recon_loss: 265262.2500; val_cond_contrastive_loss: 78387.2344; val_gene_expr_recon_loss: 93652.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443234.6875; val_optim_loss: 443234.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9723; val_auprc_score: 0.9635; val_best_acc_score: 0.9233; val_best_f1_score: 0.9253; train_kl_reg_loss: 5867.6518; train_edge_recon_loss: 266084.1285; train_cond_contrastive_loss: 78766.9271; train_gene_expr_recon_loss: 92424.4054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443143.1111; train_optim_loss: 443143.1111; val_kl_reg_loss: 5781.3901; val_edge_recon_loss: 265722.6875; val_cond_contrastive_loss: 78389.7812; val_gene_expr_recon_loss: 93234.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443128.0000; val_optim_loss: 443128.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9787; val_auprc_score: 0.9737; val_best_acc_score: 0.9323; val_best_f1_score: 0.9334; train_kl_reg_loss: 5802.2704; train_edge_recon_loss: 264730.5417; train_cond_contrastive_loss: 78731.6450; train_gene_expr_recon_loss: 91921.9878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441186.4479; train_optim_loss: 441186.4479; val_kl_reg_loss: 5720.6201; val_edge_recon_loss: 264920.4375; val_cond_contrastive_loss: 78390.7500; val_gene_expr_recon_loss: 92855.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441886.8125; val_optim_loss: 441886.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9810; val_auprc_score: 0.9760; val_best_acc_score: 0.9366; val_best_f1_score: 0.9376; train_kl_reg_loss: 5775.4396; train_edge_recon_loss: 263001.3455; train_cond_contrastive_loss: 78725.4722; train_gene_expr_recon_loss: 91678.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439180.6458; train_optim_loss: 439180.6458; val_kl_reg_loss: 5733.8560; val_edge_recon_loss: 265172.7812; val_cond_contrastive_loss: 78389.1797; val_gene_expr_recon_loss: 92517.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441813.4375; val_optim_loss: 441813.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9829; val_auprc_score: 0.9780; val_best_acc_score: 0.9410; val_best_f1_score: 0.9423; train_kl_reg_loss: 5765.0429; train_edge_recon_loss: 262670.3264; train_cond_contrastive_loss: 78714.9332; train_gene_expr_recon_loss: 91351.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438501.4410; train_optim_loss: 438501.4410; val_kl_reg_loss: 5674.2705; val_edge_recon_loss: 262069.6719; val_cond_contrastive_loss: 78386.5391; val_gene_expr_recon_loss: 92154.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438285.1875; val_optim_loss: 438285.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9867; val_auprc_score: 0.9838; val_best_acc_score: 0.9471; val_best_f1_score: 0.9482; train_kl_reg_loss: 5732.5541; train_edge_recon_loss: 260877.7101; train_cond_contrastive_loss: 78720.1354; train_gene_expr_recon_loss: 90907.1962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436237.6007; train_optim_loss: 436237.6007; val_kl_reg_loss: 5670.4404; val_edge_recon_loss: 261217.7656; val_cond_contrastive_loss: 78385.3281; val_gene_expr_recon_loss: 91806.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437080.4375; val_optim_loss: 437080.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9870; val_auprc_score: 0.9834; val_best_acc_score: 0.9484; val_best_f1_score: 0.9495; train_kl_reg_loss: 5740.0555; train_edge_recon_loss: 260107.5729; train_cond_contrastive_loss: 78707.8984; train_gene_expr_recon_loss: 90540.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435095.9028; train_optim_loss: 435095.9028; val_kl_reg_loss: 5685.2686; val_edge_recon_loss: 261722.5938; val_cond_contrastive_loss: 78384.9844; val_gene_expr_recon_loss: 91491.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437284.5625; val_optim_loss: 437284.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9866; val_auprc_score: 0.9812; val_best_acc_score: 0.9514; val_best_f1_score: 0.9521; train_kl_reg_loss: 5724.9424; train_edge_recon_loss: 259930.4427; train_cond_contrastive_loss: 78702.9175; train_gene_expr_recon_loss: 90336.1545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434694.4549; train_optim_loss: 434694.4549; val_kl_reg_loss: 5687.2979; val_edge_recon_loss: 262262.1250; val_cond_contrastive_loss: 78385.9062; val_gene_expr_recon_loss: 91201.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437536.5000; val_optim_loss: 437536.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9886; val_auprc_score: 0.9853; val_best_acc_score: 0.9526; val_best_f1_score: 0.9532; train_kl_reg_loss: 5749.3114; train_edge_recon_loss: 259003.7292; train_cond_contrastive_loss: 78705.7587; train_gene_expr_recon_loss: 89922.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433381.0660; train_optim_loss: 433381.0660; val_kl_reg_loss: 5700.5742; val_edge_recon_loss: 261116.1719; val_cond_contrastive_loss: 78387.4375; val_gene_expr_recon_loss: 90878.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436083.0938; val_optim_loss: 436083.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9909; val_auprc_score: 0.9886; val_best_acc_score: 0.9571; val_best_f1_score: 0.9582; train_kl_reg_loss: 5749.4495; train_edge_recon_loss: 258518.2101; train_cond_contrastive_loss: 78702.0755; train_gene_expr_recon_loss: 89594.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432564.6597; train_optim_loss: 432564.6597; val_kl_reg_loss: 5724.2695; val_edge_recon_loss: 256762.2344; val_cond_contrastive_loss: 78388.0156; val_gene_expr_recon_loss: 90576.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431451.2500; val_optim_loss: 431451.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9903; val_auprc_score: 0.9872; val_best_acc_score: 0.9567; val_best_f1_score: 0.9574; train_kl_reg_loss: 5748.8194; train_edge_recon_loss: 259111.4045; train_cond_contrastive_loss: 78699.0087; train_gene_expr_recon_loss: 89379.5642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432938.8125; train_optim_loss: 432938.8125; val_kl_reg_loss: 5656.3081; val_edge_recon_loss: 261848.5469; val_cond_contrastive_loss: 78388.1484; val_gene_expr_recon_loss: 90305.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436198.9375; val_optim_loss: 436198.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9903; val_auprc_score: 0.9873; val_best_acc_score: 0.9575; val_best_f1_score: 0.9584; train_kl_reg_loss: 5759.6087; train_edge_recon_loss: 258128.9253; train_cond_contrastive_loss: 78694.2118; train_gene_expr_recon_loss: 89083.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431665.9375; train_optim_loss: 431665.9375; val_kl_reg_loss: 5676.3687; val_edge_recon_loss: 261785.8125; val_cond_contrastive_loss: 78389.0078; val_gene_expr_recon_loss: 90041.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435893.1875; val_optim_loss: 435893.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9909; val_auprc_score: 0.9868; val_best_acc_score: 0.9604; val_best_f1_score: 0.9609; train_kl_reg_loss: 5727.0505; train_edge_recon_loss: 258382.4549; train_cond_contrastive_loss: 78700.2500; train_gene_expr_recon_loss: 88807.5095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431617.2569; train_optim_loss: 431617.2569; val_kl_reg_loss: 5717.1826; val_edge_recon_loss: 258928.0000; val_cond_contrastive_loss: 78390.2031; val_gene_expr_recon_loss: 89808.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432843.6250; val_optim_loss: 432843.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9907; val_auprc_score: 0.9865; val_best_acc_score: 0.9609; val_best_f1_score: 0.9618; train_kl_reg_loss: 5749.5101; train_edge_recon_loss: 256797.5503; train_cond_contrastive_loss: 78697.6293; train_gene_expr_recon_loss: 88748.1311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429992.8194; train_optim_loss: 429992.8194; val_kl_reg_loss: 5685.3066; val_edge_recon_loss: 257097.2188; val_cond_contrastive_loss: 78390.2891; val_gene_expr_recon_loss: 89766.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430938.9688; val_optim_loss: 430938.9688
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9896; val_best_acc_score: 0.9625; val_best_f1_score: 0.9630; train_kl_reg_loss: 5735.8054; train_edge_recon_loss: 257982.2431; train_cond_contrastive_loss: 78698.2830; train_gene_expr_recon_loss: 88623.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431039.6701; train_optim_loss: 431039.6701; val_kl_reg_loss: 5683.9277; val_edge_recon_loss: 258835.3438; val_cond_contrastive_loss: 78390.4922; val_gene_expr_recon_loss: 89729.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432639.6562; val_optim_loss: 432639.6562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9907; val_auprc_score: 0.9862; val_best_acc_score: 0.9592; val_best_f1_score: 0.9599; train_kl_reg_loss: 5727.1757; train_edge_recon_loss: 257644.2378; train_cond_contrastive_loss: 78701.5694; train_gene_expr_recon_loss: 88566.8255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430639.8090; train_optim_loss: 430639.8090; val_kl_reg_loss: 5657.6016; val_edge_recon_loss: 259218.3125; val_cond_contrastive_loss: 78390.6406; val_gene_expr_recon_loss: 89708.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432974.8750; val_optim_loss: 432974.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9900; val_auprc_score: 0.9853; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 5721.6088; train_edge_recon_loss: 257871.5920; train_cond_contrastive_loss: 78704.9288; train_gene_expr_recon_loss: 88605.6554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430903.7778; train_optim_loss: 430903.7778; val_kl_reg_loss: 5657.2031; val_edge_recon_loss: 260202.3750; val_cond_contrastive_loss: 78390.3672; val_gene_expr_recon_loss: 89683.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433933.1875; val_optim_loss: 433933.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9902; val_auprc_score: 0.9863; val_best_acc_score: 0.9603; val_best_f1_score: 0.9608; train_kl_reg_loss: 5722.3879; train_edge_recon_loss: 257643.9757; train_cond_contrastive_loss: 78706.1458; train_gene_expr_recon_loss: 88607.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430679.6910; train_optim_loss: 430679.6910; val_kl_reg_loss: 5659.9253; val_edge_recon_loss: 260419.5156; val_cond_contrastive_loss: 78390.5547; val_gene_expr_recon_loss: 89680.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434150.2500; val_optim_loss: 434150.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9911; val_auprc_score: 0.9873; val_best_acc_score: 0.9624; val_best_f1_score: 0.9628; train_kl_reg_loss: 5725.7056; train_edge_recon_loss: 257058.8854; train_cond_contrastive_loss: 78704.9236; train_gene_expr_recon_loss: 88522.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430012.1146; train_optim_loss: 430012.1146; val_kl_reg_loss: 5661.4844; val_edge_recon_loss: 259719.8750; val_cond_contrastive_loss: 78390.7031; val_gene_expr_recon_loss: 89676.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433449.0625; val_optim_loss: 433449.0625
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9908; val_auprc_score: 0.9873; val_best_acc_score: 0.9605; val_best_f1_score: 0.9615; train_kl_reg_loss: 5728.0380; train_edge_recon_loss: 258036.6597; train_cond_contrastive_loss: 78702.6823; train_gene_expr_recon_loss: 88546.8602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431014.2465; train_optim_loss: 431014.2465; val_kl_reg_loss: 5660.2617; val_edge_recon_loss: 257606.1719; val_cond_contrastive_loss: 78391.0312; val_gene_expr_recon_loss: 89674.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431331.5625; val_optim_loss: 431331.5625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 36 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9871
Val best accuracy score: 0.9597
Val best F1 score: 0.9604
Val gene expr MSE score: 1.3248
Duration of model training in run 10: 0 hours, 2 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
