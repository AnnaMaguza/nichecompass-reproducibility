Run timestamp: 15062023_135543.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_10pct', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 8762
Number of validation edges: 973
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8154; val_auprc_score: 0.8048; val_best_acc_score: 0.7276; val_best_f1_score: 0.7421; train_kl_reg_loss: 5.5975; train_edge_recon_loss: 346563.2917; train_gene_expr_recon_loss: 82333.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428901.9375; train_optim_loss: 428901.9375; val_kl_reg_loss: 19.4352; val_edge_recon_loss: 397098.1250; val_gene_expr_recon_loss: 68244.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465362.0625; val_optim_loss: 465362.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7831; val_auprc_score: 0.7760; val_best_acc_score: 0.6660; val_best_f1_score: 0.7290; train_kl_reg_loss: 44.2394; train_edge_recon_loss: 346287.4896; train_gene_expr_recon_loss: 68624.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414956.3750; train_optim_loss: 414956.3750; val_kl_reg_loss: 113.0023; val_edge_recon_loss: 400941.9688; val_gene_expr_recon_loss: 68372.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469427.0625; val_optim_loss: 469427.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7538; val_auprc_score: 0.7576; val_best_acc_score: 0.6644; val_best_f1_score: 0.7225; train_kl_reg_loss: 187.2365; train_edge_recon_loss: 344932.6146; train_gene_expr_recon_loss: 69072.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414192.1979; train_optim_loss: 414192.1979; val_kl_reg_loss: 283.9167; val_edge_recon_loss: 394678.1250; val_gene_expr_recon_loss: 67575.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462537.9062; val_optim_loss: 462537.9062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7410; val_auprc_score: 0.7364; val_best_acc_score: 0.6624; val_best_f1_score: 0.7190; train_kl_reg_loss: 340.0036; train_edge_recon_loss: 342212.8125; train_gene_expr_recon_loss: 67604.1823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410156.9896; train_optim_loss: 410156.9896; val_kl_reg_loss: 359.0790; val_edge_recon_loss: 360080.1875; val_gene_expr_recon_loss: 66944.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427383.4375; val_optim_loss: 427383.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7850; val_auprc_score: 0.7727; val_best_acc_score: 0.7045; val_best_f1_score: 0.7561; train_kl_reg_loss: 396.9796; train_edge_recon_loss: 338083.8542; train_gene_expr_recon_loss: 67431.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405912.6250; train_optim_loss: 405912.6250; val_kl_reg_loss: 388.7150; val_edge_recon_loss: 314987.2500; val_gene_expr_recon_loss: 66732.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382108.2812; val_optim_loss: 382108.2812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7993; val_auprc_score: 0.7919; val_best_acc_score: 0.7112; val_best_f1_score: 0.7584; train_kl_reg_loss: 479.8526; train_edge_recon_loss: 330916.5833; train_gene_expr_recon_loss: 67092.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398489.3125; train_optim_loss: 398489.3125; val_kl_reg_loss: 612.4832; val_edge_recon_loss: 306341.9375; val_gene_expr_recon_loss: 66297.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373252.2500; val_optim_loss: 373252.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7916; val_auprc_score: 0.7868; val_best_acc_score: 0.6989; val_best_f1_score: 0.7542; train_kl_reg_loss: 879.6854; train_edge_recon_loss: 318018.8438; train_gene_expr_recon_loss: 66547.4635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385445.9792; train_optim_loss: 385445.9792; val_kl_reg_loss: 1386.9978; val_edge_recon_loss: 307634.3125; val_gene_expr_recon_loss: 65896.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374917.9688; val_optim_loss: 374917.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7955; val_auprc_score: 0.7876; val_best_acc_score: 0.6989; val_best_f1_score: 0.7585; train_kl_reg_loss: 2043.0976; train_edge_recon_loss: 306867.2812; train_gene_expr_recon_loss: 66214.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375125.1458; train_optim_loss: 375125.1458; val_kl_reg_loss: 3195.3000; val_edge_recon_loss: 304775.8438; val_gene_expr_recon_loss: 65621.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373592.5938; val_optim_loss: 373592.5938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7826; val_auprc_score: 0.7702; val_best_acc_score: 0.6963; val_best_f1_score: 0.7422; train_kl_reg_loss: 4443.5199; train_edge_recon_loss: 294094.4479; train_gene_expr_recon_loss: 65780.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364318.3750; train_optim_loss: 364318.3750; val_kl_reg_loss: 6030.4863; val_edge_recon_loss: 313566.9375; val_gene_expr_recon_loss: 65258.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384855.5625; val_optim_loss: 384855.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7934; val_auprc_score: 0.7776; val_best_acc_score: 0.7071; val_best_f1_score: 0.7610; train_kl_reg_loss: 6724.9670; train_edge_recon_loss: 292522.5312; train_gene_expr_recon_loss: 65629.9753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364877.4688; train_optim_loss: 364877.4688; val_kl_reg_loss: 6325.6475; val_edge_recon_loss: 299942.6875; val_gene_expr_recon_loss: 65176.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371445.2500; val_optim_loss: 371445.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7929; val_auprc_score: 0.7846; val_best_acc_score: 0.6958; val_best_f1_score: 0.7587; train_kl_reg_loss: 6825.1016; train_edge_recon_loss: 290560.2188; train_gene_expr_recon_loss: 65507.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362892.4479; train_optim_loss: 362892.4479; val_kl_reg_loss: 6438.5361; val_edge_recon_loss: 305100.0312; val_gene_expr_recon_loss: 65061.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376599.5938; val_optim_loss: 376599.5938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7982; val_auprc_score: 0.7869; val_best_acc_score: 0.7066; val_best_f1_score: 0.7581; train_kl_reg_loss: 6815.6462; train_edge_recon_loss: 293791.2708; train_gene_expr_recon_loss: 65290.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365897.0104; train_optim_loss: 365897.0104; val_kl_reg_loss: 6393.4814; val_edge_recon_loss: 303887.0625; val_gene_expr_recon_loss: 64957.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375237.9375; val_optim_loss: 375237.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7919; val_auprc_score: 0.7909; val_best_acc_score: 0.6942; val_best_f1_score: 0.7543; train_kl_reg_loss: 6920.6566; train_edge_recon_loss: 290758.4375; train_gene_expr_recon_loss: 65438.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363118.0521; train_optim_loss: 363118.0521; val_kl_reg_loss: 6354.4131; val_edge_recon_loss: 306743.4688; val_gene_expr_recon_loss: 64886.9102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377984.7812; val_optim_loss: 377984.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7996; val_auprc_score: 0.7822; val_best_acc_score: 0.7055; val_best_f1_score: 0.7636; train_kl_reg_loss: 6799.2420; train_edge_recon_loss: 292390.7292; train_gene_expr_recon_loss: 65343.4349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364533.4062; train_optim_loss: 364533.4062; val_kl_reg_loss: 6434.5488; val_edge_recon_loss: 300564.3125; val_gene_expr_recon_loss: 64881.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371880.5000; val_optim_loss: 371880.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7980; val_auprc_score: 0.7892; val_best_acc_score: 0.7076; val_best_f1_score: 0.7609; train_kl_reg_loss: 6877.5970; train_edge_recon_loss: 295035.6875; train_gene_expr_recon_loss: 65370.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367283.7292; train_optim_loss: 367283.7292; val_kl_reg_loss: 6296.7275; val_edge_recon_loss: 301361.4062; val_gene_expr_recon_loss: 64876.1289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372534.2500; val_optim_loss: 372534.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7968; val_auprc_score: 0.7814; val_best_acc_score: 0.7061; val_best_f1_score: 0.7667; train_kl_reg_loss: 6785.4813; train_edge_recon_loss: 289858.7812; train_gene_expr_recon_loss: 65070.8216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361715.0833; train_optim_loss: 361715.0833; val_kl_reg_loss: 6345.2759; val_edge_recon_loss: 301314.5000; val_gene_expr_recon_loss: 64870.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372530.5312; val_optim_loss: 372530.5312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 12 sec.
Using best model state, which was in epoch 10.

--- MODEL EVALUATION ---
Val AUROC score: 0.7926
Val AUPRC score: 0.7847
Val best accuracy score: 0.7004
Val best F1 score: 0.7602
Val gene expr MSE score: 0.0105
Duration of model training in run 1: 0 hours, 0 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 8762
Number of validation edges: 973
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8258; val_auprc_score: 0.8164; val_best_acc_score: 0.7210; val_best_f1_score: 0.7609; train_kl_reg_loss: 4.9252; train_edge_recon_loss: 346498.6250; train_gene_expr_recon_loss: 82935.0573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429438.6146; train_optim_loss: 429438.6146; val_kl_reg_loss: 15.8644; val_edge_recon_loss: 395382.9688; val_gene_expr_recon_loss: 67769.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463168.2188; val_optim_loss: 463168.2188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7827; val_auprc_score: 0.7763; val_best_acc_score: 0.6557; val_best_f1_score: 0.7348; train_kl_reg_loss: 32.3640; train_edge_recon_loss: 346334.6562; train_gene_expr_recon_loss: 69360.6693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415727.6875; train_optim_loss: 415727.6875; val_kl_reg_loss: 79.2931; val_edge_recon_loss: 399922.4062; val_gene_expr_recon_loss: 67087.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467088.8438; val_optim_loss: 467088.8438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7408; val_auprc_score: 0.7507; val_best_acc_score: 0.6557; val_best_f1_score: 0.7186; train_kl_reg_loss: 134.2102; train_edge_recon_loss: 345404.3958; train_gene_expr_recon_loss: 69839.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415378.2292; train_optim_loss: 415378.2292; val_kl_reg_loss: 234.0036; val_edge_recon_loss: 395364.6562; val_gene_expr_recon_loss: 66869.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462468.3750; val_optim_loss: 462468.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7307; val_auprc_score: 0.7416; val_best_acc_score: 0.6516; val_best_f1_score: 0.7121; train_kl_reg_loss: 294.6558; train_edge_recon_loss: 342539.8021; train_gene_expr_recon_loss: 68890.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411724.8333; train_optim_loss: 411724.8333; val_kl_reg_loss: 368.4277; val_edge_recon_loss: 369434.9375; val_gene_expr_recon_loss: 66313.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436116.7500; val_optim_loss: 436116.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7772; val_auprc_score: 0.7817; val_best_acc_score: 0.6860; val_best_f1_score: 0.7337; train_kl_reg_loss: 406.5681; train_edge_recon_loss: 339616.0312; train_gene_expr_recon_loss: 68459.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408482.3958; train_optim_loss: 408482.3958; val_kl_reg_loss: 415.8727; val_edge_recon_loss: 329499.4062; val_gene_expr_recon_loss: 66026.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395941.4062; val_optim_loss: 395941.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7976; val_auprc_score: 0.7860; val_best_acc_score: 0.7117; val_best_f1_score: 0.7597; train_kl_reg_loss: 455.2900; train_edge_recon_loss: 333810.0729; train_gene_expr_recon_loss: 68046.9193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402312.2812; train_optim_loss: 402312.2812; val_kl_reg_loss: 541.0540; val_edge_recon_loss: 305248.2188; val_gene_expr_recon_loss: 65630.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371420.2188; val_optim_loss: 371420.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7891; val_auprc_score: 0.7888; val_best_acc_score: 0.6937; val_best_f1_score: 0.7488; train_kl_reg_loss: 714.7126; train_edge_recon_loss: 321132.4167; train_gene_expr_recon_loss: 67457.7760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389304.9062; train_optim_loss: 389304.9062; val_kl_reg_loss: 1137.7844; val_edge_recon_loss: 312672.9688; val_gene_expr_recon_loss: 65275.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379086.6875; val_optim_loss: 379086.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8064; val_auprc_score: 0.8028; val_best_acc_score: 0.7091; val_best_f1_score: 0.7558; train_kl_reg_loss: 1639.3228; train_edge_recon_loss: 307363.8646; train_gene_expr_recon_loss: 67232.9245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376236.1042; train_optim_loss: 376236.1042; val_kl_reg_loss: 2692.3672; val_edge_recon_loss: 306618.1250; val_gene_expr_recon_loss: 64956.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374267.3438; val_optim_loss: 374267.3438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8008; val_auprc_score: 0.7984; val_best_acc_score: 0.7020; val_best_f1_score: 0.7567; train_kl_reg_loss: 3609.0259; train_edge_recon_loss: 299423.3021; train_gene_expr_recon_loss: 66863.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369895.4167; train_optim_loss: 369895.4167; val_kl_reg_loss: 5530.6650; val_edge_recon_loss: 304051.1250; val_gene_expr_recon_loss: 64641.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374223.2500; val_optim_loss: 374223.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7955; val_auprc_score: 0.7866; val_best_acc_score: 0.7030; val_best_f1_score: 0.7579; train_kl_reg_loss: 5808.9837; train_edge_recon_loss: 293594.5938; train_gene_expr_recon_loss: 66702.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366105.7396; train_optim_loss: 366105.7396; val_kl_reg_loss: 5861.5527; val_edge_recon_loss: 303904.1250; val_gene_expr_recon_loss: 64581.4180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374347.0938; val_optim_loss: 374347.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7954; val_auprc_score: 0.7783; val_best_acc_score: 0.7014; val_best_f1_score: 0.7567; train_kl_reg_loss: 6069.1917; train_edge_recon_loss: 292821.3021; train_gene_expr_recon_loss: 66797.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365688.2292; train_optim_loss: 365688.2292; val_kl_reg_loss: 5987.4980; val_edge_recon_loss: 304271.1562; val_gene_expr_recon_loss: 64479.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374738.5625; val_optim_loss: 374738.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8098; val_auprc_score: 0.7984; val_best_acc_score: 0.7210; val_best_f1_score: 0.7689; train_kl_reg_loss: 6234.9097; train_edge_recon_loss: 291675.4479; train_gene_expr_recon_loss: 66684.2370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364594.5938; train_optim_loss: 364594.5938; val_kl_reg_loss: 6174.1904; val_edge_recon_loss: 293997.4375; val_gene_expr_recon_loss: 64382.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364554.2812; val_optim_loss: 364554.2812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8096; val_auprc_score: 0.8028; val_best_acc_score: 0.7158; val_best_f1_score: 0.7630; train_kl_reg_loss: 6199.4604; train_edge_recon_loss: 293182.7396; train_gene_expr_recon_loss: 66282.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365664.8125; train_optim_loss: 365664.8125; val_kl_reg_loss: 6031.8809; val_edge_recon_loss: 297657.5938; val_gene_expr_recon_loss: 64319.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368008.7500; val_optim_loss: 368008.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7987; val_auprc_score: 0.7934; val_best_acc_score: 0.7050; val_best_f1_score: 0.7569; train_kl_reg_loss: 6309.2692; train_edge_recon_loss: 292978.5417; train_gene_expr_recon_loss: 66293.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365580.9583; train_optim_loss: 365580.9583; val_kl_reg_loss: 6059.3350; val_edge_recon_loss: 303001.7812; val_gene_expr_recon_loss: 64283.6289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373344.7500; val_optim_loss: 373344.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7998; val_auprc_score: 0.7868; val_best_acc_score: 0.7076; val_best_f1_score: 0.7563; train_kl_reg_loss: 6310.5908; train_edge_recon_loss: 292710.0312; train_gene_expr_recon_loss: 66208.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365228.6354; train_optim_loss: 365228.6354; val_kl_reg_loss: 6065.5107; val_edge_recon_loss: 304036.7812; val_gene_expr_recon_loss: 64258.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374360.9688; val_optim_loss: 374360.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7967; val_auprc_score: 0.7782; val_best_acc_score: 0.7097; val_best_f1_score: 0.7608; train_kl_reg_loss: 6216.0926; train_edge_recon_loss: 292941.5417; train_gene_expr_recon_loss: 66235.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365393.3438; train_optim_loss: 365393.3438; val_kl_reg_loss: 6038.6826; val_edge_recon_loss: 300873.2188; val_gene_expr_recon_loss: 64255.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371167.5625; val_optim_loss: 371167.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7998; val_auprc_score: 0.7895; val_best_acc_score: 0.7097; val_best_f1_score: 0.7611; train_kl_reg_loss: 6324.2035; train_edge_recon_loss: 293053.1979; train_gene_expr_recon_loss: 66430.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365808.1667; train_optim_loss: 365808.1667; val_kl_reg_loss: 6078.4497; val_edge_recon_loss: 301299.2500; val_gene_expr_recon_loss: 64251.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371629.5938; val_optim_loss: 371629.5938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8016; val_auprc_score: 0.7974; val_best_acc_score: 0.7091; val_best_f1_score: 0.7605; train_kl_reg_loss: 6295.8778; train_edge_recon_loss: 293145.6458; train_gene_expr_recon_loss: 66338.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365780.3854; train_optim_loss: 365780.3854; val_kl_reg_loss: 6134.0039; val_edge_recon_loss: 301520.4062; val_gene_expr_recon_loss: 64248.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371902.5000; val_optim_loss: 371902.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.8042
Val AUPRC score: 0.8052
Val best accuracy score: 0.7112
Val best F1 score: 0.7545
Val gene expr MSE score: 0.0102
Duration of model training in run 2: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 17000
Number of validation edges: 1888
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8049; val_auprc_score: 0.8082; val_best_acc_score: 0.7135; val_best_f1_score: 0.7371; train_kl_reg_loss: 81.6485; train_edge_recon_loss: 345929.0868; train_gene_expr_recon_loss: 74500.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420511.1146; train_optim_loss: 420511.1146; val_kl_reg_loss: 289.8247; val_edge_recon_loss: 394115.2812; val_gene_expr_recon_loss: 71004.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465409.1562; val_optim_loss: 465409.1562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8356; val_auprc_score: 0.8259; val_best_acc_score: 0.7466; val_best_f1_score: 0.7733; train_kl_reg_loss: 384.5677; train_edge_recon_loss: 337439.4167; train_gene_expr_recon_loss: 68634.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406458.6389; train_optim_loss: 406458.6389; val_kl_reg_loss: 665.1947; val_edge_recon_loss: 298425.7188; val_gene_expr_recon_loss: 69138.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368229.5625; val_optim_loss: 368229.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8320; val_auprc_score: 0.8261; val_best_acc_score: 0.7328; val_best_f1_score: 0.7668; train_kl_reg_loss: 2190.9582; train_edge_recon_loss: 306136.9722; train_gene_expr_recon_loss: 66816.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375144.0764; train_optim_loss: 375144.0764; val_kl_reg_loss: 5521.1958; val_edge_recon_loss: 298472.2188; val_gene_expr_recon_loss: 67890.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371883.9062; val_optim_loss: 371883.9062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8428; val_auprc_score: 0.8380; val_best_acc_score: 0.7376; val_best_f1_score: 0.7734; train_kl_reg_loss: 7903.8989; train_edge_recon_loss: 292811.9549; train_gene_expr_recon_loss: 65971.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366687.4062; train_optim_loss: 366687.4062; val_kl_reg_loss: 8478.3848; val_edge_recon_loss: 294346.0938; val_gene_expr_recon_loss: 67191.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370015.5625; val_optim_loss: 370015.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8561; val_auprc_score: 0.8446; val_best_acc_score: 0.7630; val_best_f1_score: 0.7845; train_kl_reg_loss: 7658.1389; train_edge_recon_loss: 288837.7535; train_gene_expr_recon_loss: 65180.4744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361676.3715; train_optim_loss: 361676.3715; val_kl_reg_loss: 5739.3101; val_edge_recon_loss: 288272.4688; val_gene_expr_recon_loss: 66849.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360860.9375; val_optim_loss: 360860.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8694; val_auprc_score: 0.8616; val_best_acc_score: 0.7775; val_best_f1_score: 0.7910; train_kl_reg_loss: 4821.0741; train_edge_recon_loss: 289802.8194; train_gene_expr_recon_loss: 65284.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359908.1667; train_optim_loss: 359908.1667; val_kl_reg_loss: 4035.3159; val_edge_recon_loss: 287747.4062; val_gene_expr_recon_loss: 66667.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358450.4062; val_optim_loss: 358450.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8690; val_auprc_score: 0.8557; val_best_acc_score: 0.7773; val_best_f1_score: 0.7986; train_kl_reg_loss: 4114.3435; train_edge_recon_loss: 287458.1875; train_gene_expr_recon_loss: 65280.1168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356852.6458; train_optim_loss: 356852.6458; val_kl_reg_loss: 4145.9854; val_edge_recon_loss: 286371.8438; val_gene_expr_recon_loss: 66523.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357041.3125; val_optim_loss: 357041.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8773; val_auprc_score: 0.8575; val_best_acc_score: 0.7969; val_best_f1_score: 0.8166; train_kl_reg_loss: 4461.3961; train_edge_recon_loss: 283726.7743; train_gene_expr_recon_loss: 65197.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353385.4340; train_optim_loss: 353385.4340; val_kl_reg_loss: 4592.7480; val_edge_recon_loss: 281345.0625; val_gene_expr_recon_loss: 66366.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352304.2812; val_optim_loss: 352304.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8996; val_auprc_score: 0.8732; val_best_acc_score: 0.8273; val_best_f1_score: 0.8470; train_kl_reg_loss: 4749.8904; train_edge_recon_loss: 275164.3542; train_gene_expr_recon_loss: 64801.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344715.8229; train_optim_loss: 344715.8229; val_kl_reg_loss: 4702.9053; val_edge_recon_loss: 271645.1875; val_gene_expr_recon_loss: 66430.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342778.2812; val_optim_loss: 342778.2812
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9150; val_auprc_score: 0.8879; val_best_acc_score: 0.8403; val_best_f1_score: 0.8545; train_kl_reg_loss: 4511.0856; train_edge_recon_loss: 274076.1528; train_gene_expr_recon_loss: 64946.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 343533.8021; train_optim_loss: 343533.8021; val_kl_reg_loss: 3942.0840; val_edge_recon_loss: 273500.8750; val_gene_expr_recon_loss: 66222.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343665.8750; val_optim_loss: 343665.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9292; val_auprc_score: 0.9092; val_best_acc_score: 0.8689; val_best_f1_score: 0.8761; train_kl_reg_loss: 3914.3336; train_edge_recon_loss: 270517.3993; train_gene_expr_recon_loss: 64847.0790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339278.8090; train_optim_loss: 339278.8090; val_kl_reg_loss: 3886.7764; val_edge_recon_loss: 270114.3125; val_gene_expr_recon_loss: 66047.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340048.6875; val_optim_loss: 340048.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9465; val_auprc_score: 0.9293; val_best_acc_score: 0.8882; val_best_f1_score: 0.8928; train_kl_reg_loss: 4197.3951; train_edge_recon_loss: 268414.5833; train_gene_expr_recon_loss: 64333.4744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336945.4514; train_optim_loss: 336945.4514; val_kl_reg_loss: 4199.8530; val_edge_recon_loss: 266633.0000; val_gene_expr_recon_loss: 65985.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336817.9375; val_optim_loss: 336817.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9373; val_auprc_score: 0.9147; val_best_acc_score: 0.8822; val_best_f1_score: 0.8875; train_kl_reg_loss: 4218.2996; train_edge_recon_loss: 267911.1458; train_gene_expr_recon_loss: 64239.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336368.5174; train_optim_loss: 336368.5174; val_kl_reg_loss: 4047.3887; val_edge_recon_loss: 269334.3750; val_gene_expr_recon_loss: 65854.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339236.6250; val_optim_loss: 339236.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9496; val_auprc_score: 0.9344; val_best_acc_score: 0.8925; val_best_f1_score: 0.8982; train_kl_reg_loss: 4222.2023; train_edge_recon_loss: 266642.8750; train_gene_expr_recon_loss: 64117.4891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334982.5660; train_optim_loss: 334982.5660; val_kl_reg_loss: 4152.5654; val_edge_recon_loss: 267285.7812; val_gene_expr_recon_loss: 65704.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337142.9062; val_optim_loss: 337142.9062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9507; val_auprc_score: 0.9305; val_best_acc_score: 0.8943; val_best_f1_score: 0.8992; train_kl_reg_loss: 4216.7753; train_edge_recon_loss: 266610.3194; train_gene_expr_recon_loss: 63990.8247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334817.9236; train_optim_loss: 334817.9236; val_kl_reg_loss: 4061.6243; val_edge_recon_loss: 267535.3750; val_gene_expr_recon_loss: 65619.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337216.6250; val_optim_loss: 337216.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9493; val_auprc_score: 0.9263; val_best_acc_score: 0.8954; val_best_f1_score: 0.9016; train_kl_reg_loss: 4128.5782; train_edge_recon_loss: 265095.9688; train_gene_expr_recon_loss: 63826.9145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333051.4653; train_optim_loss: 333051.4653; val_kl_reg_loss: 4027.7126; val_edge_recon_loss: 265309.7812; val_gene_expr_recon_loss: 65391.4258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334728.9375; val_optim_loss: 334728.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9513; val_auprc_score: 0.9346; val_best_acc_score: 0.8930; val_best_f1_score: 0.8982; train_kl_reg_loss: 4112.5882; train_edge_recon_loss: 265960.2951; train_gene_expr_recon_loss: 63827.8537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333900.7361; train_optim_loss: 333900.7361; val_kl_reg_loss: 4055.7844; val_edge_recon_loss: 267397.4375; val_gene_expr_recon_loss: 65334.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336787.5000; val_optim_loss: 336787.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9484; val_auprc_score: 0.9199; val_best_acc_score: 0.8962; val_best_f1_score: 0.9026; train_kl_reg_loss: 4143.3760; train_edge_recon_loss: 265582.8056; train_gene_expr_recon_loss: 63791.4978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333517.6806; train_optim_loss: 333517.6806; val_kl_reg_loss: 4062.7004; val_edge_recon_loss: 265969.3750; val_gene_expr_recon_loss: 65323.5352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335355.5938; val_optim_loss: 335355.5938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9495; val_auprc_score: 0.9290; val_best_acc_score: 0.9004; val_best_f1_score: 0.9065; train_kl_reg_loss: 4128.7768; train_edge_recon_loss: 265975.5208; train_gene_expr_recon_loss: 63576.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333681.0694; train_optim_loss: 333681.0694; val_kl_reg_loss: 4035.0698; val_edge_recon_loss: 262819.9375; val_gene_expr_recon_loss: 65305.2148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332160.2188; val_optim_loss: 332160.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9488; val_auprc_score: 0.9291; val_best_acc_score: 0.8978; val_best_f1_score: 0.9025; train_kl_reg_loss: 4116.6956; train_edge_recon_loss: 265762.3472; train_gene_expr_recon_loss: 63654.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333533.6910; train_optim_loss: 333533.6910; val_kl_reg_loss: 4046.2964; val_edge_recon_loss: 266538.6250; val_gene_expr_recon_loss: 65296.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335881.3438; val_optim_loss: 335881.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9521; val_auprc_score: 0.9335; val_best_acc_score: 0.8972; val_best_f1_score: 0.9020; train_kl_reg_loss: 4126.0670; train_edge_recon_loss: 265686.0382; train_gene_expr_recon_loss: 63802.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333614.6840; train_optim_loss: 333614.6840; val_kl_reg_loss: 4038.1826; val_edge_recon_loss: 268807.4688; val_gene_expr_recon_loss: 65289.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338134.6875; val_optim_loss: 338134.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9544; val_auprc_score: 0.9399; val_best_acc_score: 0.8986; val_best_f1_score: 0.9037; train_kl_reg_loss: 4107.1976; train_edge_recon_loss: 265666.6597; train_gene_expr_recon_loss: 63674.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333448.1701; train_optim_loss: 333448.1701; val_kl_reg_loss: 4019.5737; val_edge_recon_loss: 265580.1250; val_gene_expr_recon_loss: 65280.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334880.3438; val_optim_loss: 334880.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9493; val_auprc_score: 0.9297; val_best_acc_score: 0.8988; val_best_f1_score: 0.9051; train_kl_reg_loss: 4100.5415; train_edge_recon_loss: 265247.4514; train_gene_expr_recon_loss: 63867.7088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333215.7083; train_optim_loss: 333215.7083; val_kl_reg_loss: 4023.8992; val_edge_recon_loss: 267102.3750; val_gene_expr_recon_loss: 65278.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336405.1875; val_optim_loss: 336405.1875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9506; val_auprc_score: 0.9306; val_best_acc_score: 0.8957; val_best_f1_score: 0.8999; train_kl_reg_loss: 4103.7329; train_edge_recon_loss: 266196.9792; train_gene_expr_recon_loss: 63580.1168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333880.8264; train_optim_loss: 333880.8264; val_kl_reg_loss: 4022.9629; val_edge_recon_loss: 266026.7188; val_gene_expr_recon_loss: 65276.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335326.0000; val_optim_loss: 335326.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9512; val_auprc_score: 0.9277; val_best_acc_score: 0.9017; val_best_f1_score: 0.9076; train_kl_reg_loss: 4104.1292; train_edge_recon_loss: 265035.8542; train_gene_expr_recon_loss: 63601.2391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332741.2222; train_optim_loss: 332741.2222; val_kl_reg_loss: 4024.8047; val_edge_recon_loss: 264835.2188; val_gene_expr_recon_loss: 65274.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334134.9375; val_optim_loss: 334134.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9473
Val AUPRC score: 0.9323
Val best accuracy score: 0.8933
Val best F1 score: 0.8992
Val gene expr MSE score: 0.0097
Duration of model training in run 3: 0 hours, 0 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 17000
Number of validation edges: 1888
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8014; val_auprc_score: 0.8114; val_best_acc_score: 0.7195; val_best_f1_score: 0.7308; train_kl_reg_loss: 68.0143; train_edge_recon_loss: 345998.9410; train_gene_expr_recon_loss: 73725.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419792.6181; train_optim_loss: 419792.6181; val_kl_reg_loss: 261.9966; val_edge_recon_loss: 392394.9688; val_gene_expr_recon_loss: 70638.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463295.1250; val_optim_loss: 463295.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8315; val_auprc_score: 0.8229; val_best_acc_score: 0.7381; val_best_f1_score: 0.7723; train_kl_reg_loss: 380.1446; train_edge_recon_loss: 337648.2188; train_gene_expr_recon_loss: 68501.3368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406529.6910; train_optim_loss: 406529.6910; val_kl_reg_loss: 631.7249; val_edge_recon_loss: 299584.0938; val_gene_expr_recon_loss: 68834.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369050.5625; val_optim_loss: 369050.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8352; val_auprc_score: 0.8294; val_best_acc_score: 0.7368; val_best_f1_score: 0.7783; train_kl_reg_loss: 2416.1691; train_edge_recon_loss: 305449.2986; train_gene_expr_recon_loss: 66878.0122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374743.4826; train_optim_loss: 374743.4826; val_kl_reg_loss: 6198.6621; val_edge_recon_loss: 289618.3750; val_gene_expr_recon_loss: 67751.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363568.3125; val_optim_loss: 363568.3125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8357; val_auprc_score: 0.8277; val_best_acc_score: 0.7413; val_best_f1_score: 0.7702; train_kl_reg_loss: 8474.6156; train_edge_recon_loss: 290816.2847; train_gene_expr_recon_loss: 66237.0009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365527.9028; train_optim_loss: 365527.9028; val_kl_reg_loss: 8656.6758; val_edge_recon_loss: 296813.0625; val_gene_expr_recon_loss: 67134.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372604.5000; val_optim_loss: 372604.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8424; val_auprc_score: 0.8315; val_best_acc_score: 0.7503; val_best_f1_score: 0.7788; train_kl_reg_loss: 7729.5409; train_edge_recon_loss: 290671.0972; train_gene_expr_recon_loss: 65694.8459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364095.4896; train_optim_loss: 364095.4896; val_kl_reg_loss: 5881.6729; val_edge_recon_loss: 289929.8750; val_gene_expr_recon_loss: 66801.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362613.1250; val_optim_loss: 362613.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8460; val_auprc_score: 0.8324; val_best_acc_score: 0.7526; val_best_f1_score: 0.7800; train_kl_reg_loss: 4967.3269; train_edge_recon_loss: 289525.9965; train_gene_expr_recon_loss: 65663.1927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360156.5104; train_optim_loss: 360156.5104; val_kl_reg_loss: 3907.0249; val_edge_recon_loss: 292493.4375; val_gene_expr_recon_loss: 66679.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363080.2500; val_optim_loss: 363080.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8629; val_auprc_score: 0.8341; val_best_acc_score: 0.7865; val_best_f1_score: 0.8110; train_kl_reg_loss: 4169.4089; train_edge_recon_loss: 283951.4896; train_gene_expr_recon_loss: 65351.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353471.9618; train_optim_loss: 353471.9618; val_kl_reg_loss: 4477.1895; val_edge_recon_loss: 282175.2188; val_gene_expr_recon_loss: 66545.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353197.8750; val_optim_loss: 353197.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8938; val_auprc_score: 0.8717; val_best_acc_score: 0.8197; val_best_f1_score: 0.8372; train_kl_reg_loss: 4892.4500; train_edge_recon_loss: 275728.0451; train_gene_expr_recon_loss: 65574.3016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346194.7986; train_optim_loss: 346194.7986; val_kl_reg_loss: 5149.3999; val_edge_recon_loss: 275949.1875; val_gene_expr_recon_loss: 66579.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347678.1875; val_optim_loss: 347678.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9083; val_auprc_score: 0.8852; val_best_acc_score: 0.8427; val_best_f1_score: 0.8537; train_kl_reg_loss: 4916.8941; train_edge_recon_loss: 273203.6528; train_gene_expr_recon_loss: 65330.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 343450.8368; train_optim_loss: 343450.8368; val_kl_reg_loss: 4472.9932; val_edge_recon_loss: 273890.7812; val_gene_expr_recon_loss: 66415.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344779.4062; val_optim_loss: 344779.4062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9111; val_auprc_score: 0.8803; val_best_acc_score: 0.8512; val_best_f1_score: 0.8640; train_kl_reg_loss: 4205.8756; train_edge_recon_loss: 272033.0035; train_gene_expr_recon_loss: 65048.2166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341287.0972; train_optim_loss: 341287.0972; val_kl_reg_loss: 4024.3145; val_edge_recon_loss: 273221.8750; val_gene_expr_recon_loss: 66234.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343480.6875; val_optim_loss: 343480.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9319; val_auprc_score: 0.9119; val_best_acc_score: 0.8739; val_best_f1_score: 0.8805; train_kl_reg_loss: 4093.2361; train_edge_recon_loss: 269668.3229; train_gene_expr_recon_loss: 64832.6476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338594.2083; train_optim_loss: 338594.2083; val_kl_reg_loss: 4143.1885; val_edge_recon_loss: 270424.9062; val_gene_expr_recon_loss: 66085.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340653.4375; val_optim_loss: 340653.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9307; val_auprc_score: 0.9045; val_best_acc_score: 0.8724; val_best_f1_score: 0.8818; train_kl_reg_loss: 4186.9149; train_edge_recon_loss: 269126.6389; train_gene_expr_recon_loss: 64673.6345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337987.1875; train_optim_loss: 337987.1875; val_kl_reg_loss: 4203.7920; val_edge_recon_loss: 267519.7188; val_gene_expr_recon_loss: 65949.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337672.6875; val_optim_loss: 337672.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9379; val_auprc_score: 0.9222; val_best_acc_score: 0.8713; val_best_f1_score: 0.8791; train_kl_reg_loss: 4224.3329; train_edge_recon_loss: 267553.4271; train_gene_expr_recon_loss: 64857.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336635.1111; train_optim_loss: 336635.1111; val_kl_reg_loss: 4233.7754; val_edge_recon_loss: 270539.2188; val_gene_expr_recon_loss: 65819.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340592.5000; val_optim_loss: 340592.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9417; val_auprc_score: 0.9181; val_best_acc_score: 0.8859; val_best_f1_score: 0.8927; train_kl_reg_loss: 4246.0527; train_edge_recon_loss: 266745.2569; train_gene_expr_recon_loss: 64644.4939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335635.8021; train_optim_loss: 335635.8021; val_kl_reg_loss: 4129.6807; val_edge_recon_loss: 268195.3125; val_gene_expr_recon_loss: 65687.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338012.0625; val_optim_loss: 338012.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9468; val_auprc_score: 0.9254; val_best_acc_score: 0.8967; val_best_f1_score: 0.9022; train_kl_reg_loss: 4175.8324; train_edge_recon_loss: 266654.7326; train_gene_expr_recon_loss: 64652.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335482.5938; train_optim_loss: 335482.5938; val_kl_reg_loss: 4112.7197; val_edge_recon_loss: 266923.2500; val_gene_expr_recon_loss: 65664.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336700.2812; val_optim_loss: 336700.2812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9555; val_auprc_score: 0.9351; val_best_acc_score: 0.9094; val_best_f1_score: 0.9130; train_kl_reg_loss: 4138.5245; train_edge_recon_loss: 266243.3438; train_gene_expr_recon_loss: 64234.3711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334616.2431; train_optim_loss: 334616.2431; val_kl_reg_loss: 4174.1514; val_edge_recon_loss: 264612.6562; val_gene_expr_recon_loss: 65598.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334384.9375; val_optim_loss: 334384.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9579; val_auprc_score: 0.9420; val_best_acc_score: 0.9142; val_best_f1_score: 0.9172; train_kl_reg_loss: 4160.2078; train_edge_recon_loss: 265435.0764; train_gene_expr_recon_loss: 64204.7934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333800.0833; train_optim_loss: 333800.0833; val_kl_reg_loss: 4103.2646; val_edge_recon_loss: 264410.7812; val_gene_expr_recon_loss: 65516.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334030.2500; val_optim_loss: 334030.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9522; val_auprc_score: 0.9326; val_best_acc_score: 0.9049; val_best_f1_score: 0.9090; train_kl_reg_loss: 4101.3364; train_edge_recon_loss: 265879.8576; train_gene_expr_recon_loss: 64106.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334088.1875; train_optim_loss: 334088.1875; val_kl_reg_loss: 4066.5488; val_edge_recon_loss: 265764.8438; val_gene_expr_recon_loss: 65454.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335286.3438; val_optim_loss: 335286.3438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9601; val_auprc_score: 0.9429; val_best_acc_score: 0.9118; val_best_f1_score: 0.9145; train_kl_reg_loss: 4096.8175; train_edge_recon_loss: 264475.3299; train_gene_expr_recon_loss: 64046.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332618.9549; train_optim_loss: 332618.9549; val_kl_reg_loss: 4151.5674; val_edge_recon_loss: 263939.7188; val_gene_expr_recon_loss: 65363.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333454.6562; val_optim_loss: 333454.6562
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9575; val_auprc_score: 0.9418; val_best_acc_score: 0.9097; val_best_f1_score: 0.9138; train_kl_reg_loss: 4152.8843; train_edge_recon_loss: 263898.2135; train_gene_expr_recon_loss: 63903.0868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331954.1806; train_optim_loss: 331954.1806; val_kl_reg_loss: 4136.2578; val_edge_recon_loss: 265378.3438; val_gene_expr_recon_loss: 65325.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334840.1562; val_optim_loss: 334840.1562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9567; val_auprc_score: 0.9340; val_best_acc_score: 0.9070; val_best_f1_score: 0.9121; train_kl_reg_loss: 4132.5208; train_edge_recon_loss: 263258.0816; train_gene_expr_recon_loss: 63825.1254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331215.7222; train_optim_loss: 331215.7222; val_kl_reg_loss: 4125.8164; val_edge_recon_loss: 267154.0312; val_gene_expr_recon_loss: 65226.3867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336506.2188; val_optim_loss: 336506.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9602; val_auprc_score: 0.9416; val_best_acc_score: 0.9153; val_best_f1_score: 0.9194; train_kl_reg_loss: 4154.9017; train_edge_recon_loss: 264396.3368; train_gene_expr_recon_loss: 63375.3238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331926.5625; train_optim_loss: 331926.5625; val_kl_reg_loss: 4113.0874; val_edge_recon_loss: 263025.6250; val_gene_expr_recon_loss: 65163.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332301.8750; val_optim_loss: 332301.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9612; val_auprc_score: 0.9387; val_best_acc_score: 0.9158; val_best_f1_score: 0.9195; train_kl_reg_loss: 4162.0455; train_edge_recon_loss: 263160.8802; train_gene_expr_recon_loss: 63724.8511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331047.7743; train_optim_loss: 331047.7743; val_kl_reg_loss: 4157.9199; val_edge_recon_loss: 264340.2500; val_gene_expr_recon_loss: 65079.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333577.8750; val_optim_loss: 333577.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9598; val_auprc_score: 0.9371; val_best_acc_score: 0.9176; val_best_f1_score: 0.9214; train_kl_reg_loss: 4199.0960; train_edge_recon_loss: 262817.1823; train_gene_expr_recon_loss: 63654.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330670.3889; train_optim_loss: 330670.3889; val_kl_reg_loss: 4138.6719; val_edge_recon_loss: 265669.9688; val_gene_expr_recon_loss: 65036.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334844.9688; val_optim_loss: 334844.9688
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9625; val_auprc_score: 0.9466; val_best_acc_score: 0.9198; val_best_f1_score: 0.9233; train_kl_reg_loss: 4159.8102; train_edge_recon_loss: 263355.9358; train_gene_expr_recon_loss: 63490.4084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331006.1597; train_optim_loss: 331006.1597; val_kl_reg_loss: 4109.3452; val_edge_recon_loss: 264208.8438; val_gene_expr_recon_loss: 64941.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333259.2500; val_optim_loss: 333259.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9692; val_auprc_score: 0.9596; val_best_acc_score: 0.9232; val_best_f1_score: 0.9264; train_kl_reg_loss: 4154.9730; train_edge_recon_loss: 263434.3090; train_gene_expr_recon_loss: 63272.1363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330861.4167; train_optim_loss: 330861.4167; val_kl_reg_loss: 4026.2637; val_edge_recon_loss: 263315.2188; val_gene_expr_recon_loss: 64749.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332091.0000; val_optim_loss: 332091.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9613; val_auprc_score: 0.9412; val_best_acc_score: 0.9240; val_best_f1_score: 0.9271; train_kl_reg_loss: 4136.1072; train_edge_recon_loss: 262735.2969; train_gene_expr_recon_loss: 63290.3260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330161.7326; train_optim_loss: 330161.7326; val_kl_reg_loss: 4001.4419; val_edge_recon_loss: 263167.2188; val_gene_expr_recon_loss: 64695.2539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331863.9062; val_optim_loss: 331863.9062
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9610; val_auprc_score: 0.9398; val_best_acc_score: 0.9195; val_best_f1_score: 0.9228; train_kl_reg_loss: 4119.8311; train_edge_recon_loss: 262440.8681; train_gene_expr_recon_loss: 63274.7873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329835.4896; train_optim_loss: 329835.4896; val_kl_reg_loss: 3994.9155; val_edge_recon_loss: 264525.0938; val_gene_expr_recon_loss: 64676.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333196.3438; val_optim_loss: 333196.3438
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9629; val_auprc_score: 0.9486; val_best_acc_score: 0.9229; val_best_f1_score: 0.9258; train_kl_reg_loss: 4096.6254; train_edge_recon_loss: 262056.3958; train_gene_expr_recon_loss: 62948.4731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329101.5000; train_optim_loss: 329101.5000; val_kl_reg_loss: 3970.9622; val_edge_recon_loss: 262204.9688; val_gene_expr_recon_loss: 64661.1758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330837.1250; val_optim_loss: 330837.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9646; val_auprc_score: 0.9440; val_best_acc_score: 0.9256; val_best_f1_score: 0.9288; train_kl_reg_loss: 4084.9506; train_edge_recon_loss: 262200.3715; train_gene_expr_recon_loss: 62755.0265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329040.3472; train_optim_loss: 329040.3472; val_kl_reg_loss: 3961.4832; val_edge_recon_loss: 263067.6250; val_gene_expr_recon_loss: 64657.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331686.3125; val_optim_loss: 331686.3125
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9714; val_auprc_score: 0.9560; val_best_acc_score: 0.9314; val_best_f1_score: 0.9335; train_kl_reg_loss: 4074.7223; train_edge_recon_loss: 262887.2882; train_gene_expr_recon_loss: 63203.7834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330165.7986; train_optim_loss: 330165.7986; val_kl_reg_loss: 3941.5200; val_edge_recon_loss: 261988.1094; val_gene_expr_recon_loss: 64654.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330584.5938; val_optim_loss: 330584.5938
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9628; val_auprc_score: 0.9418; val_best_acc_score: 0.9227; val_best_f1_score: 0.9257; train_kl_reg_loss: 4039.8244; train_edge_recon_loss: 263694.0156; train_gene_expr_recon_loss: 63161.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330895.0382; train_optim_loss: 330895.0382; val_kl_reg_loss: 3917.7034; val_edge_recon_loss: 263834.3125; val_gene_expr_recon_loss: 64646.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332398.6250; val_optim_loss: 332398.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9592; val_auprc_score: 0.9373; val_best_acc_score: 0.9200; val_best_f1_score: 0.9239; train_kl_reg_loss: 4017.8101; train_edge_recon_loss: 262674.4792; train_gene_expr_recon_loss: 63004.7435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329697.0347; train_optim_loss: 329697.0347; val_kl_reg_loss: 3904.3589; val_edge_recon_loss: 264229.6562; val_gene_expr_recon_loss: 64645.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332779.8125; val_optim_loss: 332779.8125
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9642; val_auprc_score: 0.9474; val_best_acc_score: 0.9243; val_best_f1_score: 0.9277; train_kl_reg_loss: 4012.7526; train_edge_recon_loss: 262640.0764; train_gene_expr_recon_loss: 63165.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329818.1181; train_optim_loss: 329818.1181; val_kl_reg_loss: 3892.2471; val_edge_recon_loss: 263718.2812; val_gene_expr_recon_loss: 64646.4492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332256.9688; val_optim_loss: 332256.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9658; val_auprc_score: 0.9524; val_best_acc_score: 0.9229; val_best_f1_score: 0.9268; train_kl_reg_loss: 4001.7565; train_edge_recon_loss: 263008.2049; train_gene_expr_recon_loss: 63067.0898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330077.0451; train_optim_loss: 330077.0451; val_kl_reg_loss: 3888.9048; val_edge_recon_loss: 262872.7500; val_gene_expr_recon_loss: 64644.7461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331406.4062; val_optim_loss: 331406.4062
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9658; val_auprc_score: 0.9534; val_best_acc_score: 0.9232; val_best_f1_score: 0.9270; train_kl_reg_loss: 4000.0056; train_edge_recon_loss: 262291.4757; train_gene_expr_recon_loss: 63096.6372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329388.1181; train_optim_loss: 329388.1181; val_kl_reg_loss: 3891.7085; val_edge_recon_loss: 263182.4688; val_gene_expr_recon_loss: 64642.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331716.4375; val_optim_loss: 331716.4375
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9636; val_auprc_score: 0.9428; val_best_acc_score: 0.9224; val_best_f1_score: 0.9257; train_kl_reg_loss: 3998.1667; train_edge_recon_loss: 262462.2326; train_gene_expr_recon_loss: 63169.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329629.9965; train_optim_loss: 329629.9965; val_kl_reg_loss: 3890.1682; val_edge_recon_loss: 264890.4062; val_gene_expr_recon_loss: 64639.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333419.9688; val_optim_loss: 333419.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 48 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9662
Val AUPRC score: 0.9516
Val best accuracy score: 0.9248
Val best F1 score: 0.9275
Val gene expr MSE score: 0.0098
Duration of model training in run 4: 0 hours, 0 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 25137
Number of validation edges: 2792
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8302; val_auprc_score: 0.8338; val_best_acc_score: 0.7185; val_best_f1_score: 0.7593; train_kl_reg_loss: 356.5827; train_edge_recon_loss: 338009.6038; train_gene_expr_recon_loss: 70247.9378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408614.1250; train_optim_loss: 408614.1250; val_kl_reg_loss: 1701.5672; val_edge_recon_loss: 306026.5417; val_gene_expr_recon_loss: 69673.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377401.4583; val_optim_loss: 377401.4583
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8619; val_auprc_score: 0.8605; val_best_acc_score: 0.7412; val_best_f1_score: 0.7734; train_kl_reg_loss: 6508.7180; train_edge_recon_loss: 293549.2512; train_gene_expr_recon_loss: 66631.2142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366689.1875; train_optim_loss: 366689.1875; val_kl_reg_loss: 5179.7858; val_edge_recon_loss: 297691.0000; val_gene_expr_recon_loss: 67936.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370807.6146; val_optim_loss: 370807.6146
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8787; val_auprc_score: 0.8630; val_best_acc_score: 0.7992; val_best_f1_score: 0.8073; train_kl_reg_loss: 4283.6600; train_edge_recon_loss: 288779.8688; train_gene_expr_recon_loss: 65790.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358854.0488; train_optim_loss: 358854.0488; val_kl_reg_loss: 4436.1784; val_edge_recon_loss: 288600.8646; val_gene_expr_recon_loss: 67162.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360199.1250; val_optim_loss: 360199.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9117; val_auprc_score: 0.8921; val_best_acc_score: 0.8324; val_best_f1_score: 0.8472; train_kl_reg_loss: 4233.6692; train_edge_recon_loss: 280885.5312; train_gene_expr_recon_loss: 65432.4017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350551.6013; train_optim_loss: 350551.6013; val_kl_reg_loss: 4620.7526; val_edge_recon_loss: 273694.4688; val_gene_expr_recon_loss: 68170.4076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346485.6250; val_optim_loss: 346485.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9382; val_auprc_score: 0.9157; val_best_acc_score: 0.8766; val_best_f1_score: 0.8832; train_kl_reg_loss: 4206.5166; train_edge_recon_loss: 270213.1475; train_gene_expr_recon_loss: 65132.2423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339551.9050; train_optim_loss: 339551.9050; val_kl_reg_loss: 4089.8281; val_edge_recon_loss: 268830.1667; val_gene_expr_recon_loss: 66593.3841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339513.3854; val_optim_loss: 339513.3854
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9538; val_auprc_score: 0.9367; val_best_acc_score: 0.8985; val_best_f1_score: 0.9044; train_kl_reg_loss: 4178.2913; train_edge_recon_loss: 266421.0500; train_gene_expr_recon_loss: 64561.9133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335161.2575; train_optim_loss: 335161.2575; val_kl_reg_loss: 4103.1688; val_edge_recon_loss: 268188.1458; val_gene_expr_recon_loss: 66824.6068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339115.9167; val_optim_loss: 339115.9167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9528; val_auprc_score: 0.9325; val_best_acc_score: 0.9013; val_best_f1_score: 0.9066; train_kl_reg_loss: 4077.1797; train_edge_recon_loss: 266340.8394; train_gene_expr_recon_loss: 64370.9837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334789.0025; train_optim_loss: 334789.0025; val_kl_reg_loss: 4100.8823; val_edge_recon_loss: 267082.0833; val_gene_expr_recon_loss: 67225.3385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338408.3021; val_optim_loss: 338408.3021
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9558; val_auprc_score: 0.9408; val_best_acc_score: 0.9065; val_best_f1_score: 0.9105; train_kl_reg_loss: 4126.5286; train_edge_recon_loss: 264498.7213; train_gene_expr_recon_loss: 64346.1980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332971.4450; train_optim_loss: 332971.4450; val_kl_reg_loss: 4136.3639; val_edge_recon_loss: 266604.9896; val_gene_expr_recon_loss: 66448.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337189.4062; val_optim_loss: 337189.4062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9619; val_auprc_score: 0.9380; val_best_acc_score: 0.9194; val_best_f1_score: 0.9237; train_kl_reg_loss: 4164.2442; train_edge_recon_loss: 263829.8638; train_gene_expr_recon_loss: 63945.5680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331939.6750; train_optim_loss: 331939.6750; val_kl_reg_loss: 4170.0601; val_edge_recon_loss: 261706.0885; val_gene_expr_recon_loss: 66035.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331912.0521; val_optim_loss: 331912.0521
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9663; val_auprc_score: 0.9472; val_best_acc_score: 0.9232; val_best_f1_score: 0.9263; train_kl_reg_loss: 4165.2351; train_edge_recon_loss: 262663.9125; train_gene_expr_recon_loss: 63842.0747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330671.2213; train_optim_loss: 330671.2213; val_kl_reg_loss: 4067.1999; val_edge_recon_loss: 262441.5625; val_gene_expr_recon_loss: 66353.1146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332861.8854; val_optim_loss: 332861.8854
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9664; val_auprc_score: 0.9489; val_best_acc_score: 0.9277; val_best_f1_score: 0.9309; train_kl_reg_loss: 4122.0468; train_edge_recon_loss: 262824.8406; train_gene_expr_recon_loss: 63677.7648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330624.6512; train_optim_loss: 330624.6512; val_kl_reg_loss: 4084.5684; val_edge_recon_loss: 264618.1562; val_gene_expr_recon_loss: 65668.9010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334371.6146; val_optim_loss: 334371.6146
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9706; val_auprc_score: 0.9573; val_best_acc_score: 0.9337; val_best_f1_score: 0.9366; train_kl_reg_loss: 4095.2514; train_edge_recon_loss: 262888.3362; train_gene_expr_recon_loss: 63484.6609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330468.2438; train_optim_loss: 330468.2438; val_kl_reg_loss: 4084.3475; val_edge_recon_loss: 261690.5052; val_gene_expr_recon_loss: 65673.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331448.7188; val_optim_loss: 331448.7188
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9734; val_auprc_score: 0.9563; val_best_acc_score: 0.9422; val_best_f1_score: 0.9443; train_kl_reg_loss: 4069.6468; train_edge_recon_loss: 261914.4881; train_gene_expr_recon_loss: 63474.4202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329458.5563; train_optim_loss: 329458.5563; val_kl_reg_loss: 4078.0972; val_edge_recon_loss: 261440.4531; val_gene_expr_recon_loss: 65947.7487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331466.2917; val_optim_loss: 331466.2917
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9749; val_auprc_score: 0.9640; val_best_acc_score: 0.9384; val_best_f1_score: 0.9410; train_kl_reg_loss: 4108.4688; train_edge_recon_loss: 261601.0744; train_gene_expr_recon_loss: 63253.6370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328963.1813; train_optim_loss: 328963.1813; val_kl_reg_loss: 4046.5321; val_edge_recon_loss: 261989.4792; val_gene_expr_recon_loss: 65405.7474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331441.7604; val_optim_loss: 331441.7604
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9751; val_auprc_score: 0.9634; val_best_acc_score: 0.9459; val_best_f1_score: 0.9480; train_kl_reg_loss: 4060.6741; train_edge_recon_loss: 261943.2425; train_gene_expr_recon_loss: 63031.3419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329035.2575; train_optim_loss: 329035.2575; val_kl_reg_loss: 4095.4996; val_edge_recon_loss: 261161.1510; val_gene_expr_recon_loss: 65134.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330391.2188; val_optim_loss: 330391.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9745; val_auprc_score: 0.9620; val_best_acc_score: 0.9418; val_best_f1_score: 0.9446; train_kl_reg_loss: 4086.5344; train_edge_recon_loss: 261188.6794; train_gene_expr_recon_loss: 62893.5362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328168.7488; train_optim_loss: 328168.7488; val_kl_reg_loss: 4098.4473; val_edge_recon_loss: 262031.3490; val_gene_expr_recon_loss: 66061.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332191.0417; val_optim_loss: 332191.0417
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9742; val_auprc_score: 0.9616; val_best_acc_score: 0.9396; val_best_f1_score: 0.9418; train_kl_reg_loss: 4077.7935; train_edge_recon_loss: 260648.0250; train_gene_expr_recon_loss: 62757.5906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327483.4062; train_optim_loss: 327483.4062; val_kl_reg_loss: 4091.4256; val_edge_recon_loss: 262153.3281; val_gene_expr_recon_loss: 65472.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331716.7604; val_optim_loss: 331716.7604
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9762; val_auprc_score: 0.9595; val_best_acc_score: 0.9443; val_best_f1_score: 0.9461; train_kl_reg_loss: 4104.4324; train_edge_recon_loss: 260656.7613; train_gene_expr_recon_loss: 62415.0331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327176.2238; train_optim_loss: 327176.2238; val_kl_reg_loss: 4045.4277; val_edge_recon_loss: 261365.2083; val_gene_expr_recon_loss: 64770.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330180.7604; val_optim_loss: 330180.7604
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9832; val_auprc_score: 0.9770; val_best_acc_score: 0.9529; val_best_f1_score: 0.9537; train_kl_reg_loss: 4106.2626; train_edge_recon_loss: 260344.9637; train_gene_expr_recon_loss: 62658.1294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327109.3538; train_optim_loss: 327109.3538; val_kl_reg_loss: 4071.0964; val_edge_recon_loss: 257199.4583; val_gene_expr_recon_loss: 64073.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325344.0625; val_optim_loss: 325344.0625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9816; val_auprc_score: 0.9720; val_best_acc_score: 0.9529; val_best_f1_score: 0.9548; train_kl_reg_loss: 4081.8177; train_edge_recon_loss: 259983.2381; train_gene_expr_recon_loss: 62160.5528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326225.6088; train_optim_loss: 326225.6088; val_kl_reg_loss: 4069.0639; val_edge_recon_loss: 259374.7135; val_gene_expr_recon_loss: 64178.6029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327622.3958; val_optim_loss: 327622.3958
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9792; val_auprc_score: 0.9682; val_best_acc_score: 0.9484; val_best_f1_score: 0.9501; train_kl_reg_loss: 4086.2607; train_edge_recon_loss: 260104.9337; train_gene_expr_recon_loss: 62461.9320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326653.1287; train_optim_loss: 326653.1287; val_kl_reg_loss: 4095.3691; val_edge_recon_loss: 261093.9948; val_gene_expr_recon_loss: 65119.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330308.4271; val_optim_loss: 330308.4271
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9826; val_auprc_score: 0.9757; val_best_acc_score: 0.9491; val_best_f1_score: 0.9509; train_kl_reg_loss: 4060.5637; train_edge_recon_loss: 260441.8125; train_gene_expr_recon_loss: 62136.1884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326638.5613; train_optim_loss: 326638.5613; val_kl_reg_loss: 4014.7985; val_edge_recon_loss: 258897.8021; val_gene_expr_recon_loss: 64557.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327469.7083; val_optim_loss: 327469.7083

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9813; val_auprc_score: 0.9752; val_best_acc_score: 0.9477; val_best_f1_score: 0.9493; train_kl_reg_loss: 4047.9056; train_edge_recon_loss: 259350.8581; train_gene_expr_recon_loss: 61758.5858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325157.3500; train_optim_loss: 325157.3500; val_kl_reg_loss: 4023.5809; val_edge_recon_loss: 259446.5990; val_gene_expr_recon_loss: 64315.7682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327785.9479; val_optim_loss: 327785.9479
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9809; val_auprc_score: 0.9743; val_best_acc_score: 0.9477; val_best_f1_score: 0.9499; train_kl_reg_loss: 4059.3504; train_edge_recon_loss: 259152.6112; train_gene_expr_recon_loss: 61568.6659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324780.6250; train_optim_loss: 324780.6250; val_kl_reg_loss: 4038.9066; val_edge_recon_loss: 258886.7031; val_gene_expr_recon_loss: 63716.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326642.3333; val_optim_loss: 326642.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9800; val_auprc_score: 0.9702; val_best_acc_score: 0.9499; val_best_f1_score: 0.9518; train_kl_reg_loss: 4049.3576; train_edge_recon_loss: 260288.2712; train_gene_expr_recon_loss: 61588.5431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325926.1713; train_optim_loss: 325926.1713; val_kl_reg_loss: 4013.8319; val_edge_recon_loss: 257588.0885; val_gene_expr_recon_loss: 64072.1185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325674.0417; val_optim_loss: 325674.0417

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 54 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9800
Val AUPRC score: 0.9711
Val best accuracy score: 0.9491
Val best F1 score: 0.9502
Val gene expr MSE score: 0.0096
Duration of model training in run 5: 0 hours, 0 minutes and 56 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 25137
Number of validation edges: 2792
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8291; val_auprc_score: 0.8359; val_best_acc_score: 0.7149; val_best_f1_score: 0.7634; train_kl_reg_loss: 414.2327; train_edge_recon_loss: 336245.8650; train_gene_expr_recon_loss: 70148.7045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406808.8050; train_optim_loss: 406808.8050; val_kl_reg_loss: 2148.4846; val_edge_recon_loss: 303461.6562; val_gene_expr_recon_loss: 68356.7474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373966.8854; val_optim_loss: 373966.8854
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8736; val_auprc_score: 0.8661; val_best_acc_score: 0.7604; val_best_f1_score: 0.7898; train_kl_reg_loss: 6808.8513; train_edge_recon_loss: 291586.2775; train_gene_expr_recon_loss: 66427.7320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364822.8613; train_optim_loss: 364822.8613; val_kl_reg_loss: 5146.0015; val_edge_recon_loss: 288199.5521; val_gene_expr_recon_loss: 66362.9076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359708.4583; val_optim_loss: 359708.4583
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8922; val_auprc_score: 0.8725; val_best_acc_score: 0.8114; val_best_f1_score: 0.8251; train_kl_reg_loss: 3949.7035; train_edge_recon_loss: 289737.9587; train_gene_expr_recon_loss: 65623.6092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359311.2700; train_optim_loss: 359311.2700; val_kl_reg_loss: 3644.0956; val_edge_recon_loss: 283302.3229; val_gene_expr_recon_loss: 66858.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353805.3854; val_optim_loss: 353805.3854
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9117; val_auprc_score: 0.8924; val_best_acc_score: 0.8322; val_best_f1_score: 0.8474; train_kl_reg_loss: 3784.3851; train_edge_recon_loss: 282390.5250; train_gene_expr_recon_loss: 65420.6320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351595.5413; train_optim_loss: 351595.5413; val_kl_reg_loss: 4480.6698; val_edge_recon_loss: 272585.5417; val_gene_expr_recon_loss: 66706.7292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343772.9271; val_optim_loss: 343772.9271
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9301; val_auprc_score: 0.9096; val_best_acc_score: 0.8619; val_best_f1_score: 0.8722; train_kl_reg_loss: 4081.0280; train_edge_recon_loss: 269925.6900; train_gene_expr_recon_loss: 64672.4020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338679.1188; train_optim_loss: 338679.1188; val_kl_reg_loss: 4048.5490; val_edge_recon_loss: 271891.8958; val_gene_expr_recon_loss: 66537.7461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342478.1875; val_optim_loss: 342478.1875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9506; val_auprc_score: 0.9281; val_best_acc_score: 0.8968; val_best_f1_score: 0.9036; train_kl_reg_loss: 4162.2742; train_edge_recon_loss: 267022.1337; train_gene_expr_recon_loss: 64618.3544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335802.7625; train_optim_loss: 335802.7625; val_kl_reg_loss: 4119.8910; val_edge_recon_loss: 266002.3854; val_gene_expr_recon_loss: 65251.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335374.1250; val_optim_loss: 335374.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9610; val_auprc_score: 0.9438; val_best_acc_score: 0.9164; val_best_f1_score: 0.9199; train_kl_reg_loss: 4162.0377; train_edge_recon_loss: 266439.6706; train_gene_expr_recon_loss: 64578.7131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335180.4200; train_optim_loss: 335180.4200; val_kl_reg_loss: 4088.7426; val_edge_recon_loss: 265265.0312; val_gene_expr_recon_loss: 65934.5872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335288.3542; val_optim_loss: 335288.3542
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9659; val_auprc_score: 0.9507; val_best_acc_score: 0.9237; val_best_f1_score: 0.9267; train_kl_reg_loss: 4121.3470; train_edge_recon_loss: 264673.7750; train_gene_expr_recon_loss: 64256.2997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333051.4175; train_optim_loss: 333051.4175; val_kl_reg_loss: 4061.8779; val_edge_recon_loss: 263578.5938; val_gene_expr_recon_loss: 65823.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333463.5000; val_optim_loss: 333463.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9710; val_auprc_score: 0.9559; val_best_acc_score: 0.9314; val_best_f1_score: 0.9341; train_kl_reg_loss: 4147.5833; train_edge_recon_loss: 263929.8950; train_gene_expr_recon_loss: 63825.3822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331902.8588; train_optim_loss: 331902.8588; val_kl_reg_loss: 4093.1741; val_edge_recon_loss: 262192.4896; val_gene_expr_recon_loss: 65663.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331949.0104; val_optim_loss: 331949.0104
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9696; val_auprc_score: 0.9534; val_best_acc_score: 0.9364; val_best_f1_score: 0.9389; train_kl_reg_loss: 4184.9444; train_edge_recon_loss: 263276.1269; train_gene_expr_recon_loss: 63608.2517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331069.3225; train_optim_loss: 331069.3225; val_kl_reg_loss: 4146.0555; val_edge_recon_loss: 260234.6719; val_gene_expr_recon_loss: 64807.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329187.7812; val_optim_loss: 329187.7812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9710; val_auprc_score: 0.9552; val_best_acc_score: 0.9354; val_best_f1_score: 0.9373; train_kl_reg_loss: 4163.8612; train_edge_recon_loss: 261749.8731; train_gene_expr_recon_loss: 63621.2055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329534.9400; train_optim_loss: 329534.9400; val_kl_reg_loss: 4108.1794; val_edge_recon_loss: 263041.8281; val_gene_expr_recon_loss: 65251.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332401.4062; val_optim_loss: 332401.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9750; val_auprc_score: 0.9603; val_best_acc_score: 0.9354; val_best_f1_score: 0.9371; train_kl_reg_loss: 4086.6943; train_edge_recon_loss: 262236.8331; train_gene_expr_recon_loss: 63409.7962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329733.3225; train_optim_loss: 329733.3225; val_kl_reg_loss: 4137.3172; val_edge_recon_loss: 262335.2812; val_gene_expr_recon_loss: 65160.7227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331633.3021; val_optim_loss: 331633.3021
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9759; val_auprc_score: 0.9631; val_best_acc_score: 0.9416; val_best_f1_score: 0.9435; train_kl_reg_loss: 4092.3114; train_edge_recon_loss: 262017.7131; train_gene_expr_recon_loss: 63215.1056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329325.1350; train_optim_loss: 329325.1350; val_kl_reg_loss: 4017.1620; val_edge_recon_loss: 260678.3125; val_gene_expr_recon_loss: 64416.0195; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329111.5000; val_optim_loss: 329111.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9754; val_auprc_score: 0.9641; val_best_acc_score: 0.9352; val_best_f1_score: 0.9383; train_kl_reg_loss: 4076.2804; train_edge_recon_loss: 262322.7087; train_gene_expr_recon_loss: 63135.8344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329534.8225; train_optim_loss: 329534.8225; val_kl_reg_loss: 4005.9784; val_edge_recon_loss: 263562.4635; val_gene_expr_recon_loss: 64919.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332488.0729; val_optim_loss: 332488.0729
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9794; val_auprc_score: 0.9689; val_best_acc_score: 0.9486; val_best_f1_score: 0.9499; train_kl_reg_loss: 4083.7607; train_edge_recon_loss: 261759.1625; train_gene_expr_recon_loss: 62958.6756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328801.6013; train_optim_loss: 328801.6013; val_kl_reg_loss: 4053.3296; val_edge_recon_loss: 258984.0521; val_gene_expr_recon_loss: 64244.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327281.6250; val_optim_loss: 327281.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9812; val_auprc_score: 0.9727; val_best_acc_score: 0.9457; val_best_f1_score: 0.9474; train_kl_reg_loss: 4125.6892; train_edge_recon_loss: 260512.2850; train_gene_expr_recon_loss: 62791.2056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327429.1775; train_optim_loss: 327429.1775; val_kl_reg_loss: 4072.4036; val_edge_recon_loss: 259992.6927; val_gene_expr_recon_loss: 63842.6914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327907.7917; val_optim_loss: 327907.7917
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9791; val_auprc_score: 0.9681; val_best_acc_score: 0.9425; val_best_f1_score: 0.9438; train_kl_reg_loss: 4105.7092; train_edge_recon_loss: 261086.2675; train_gene_expr_recon_loss: 62573.3375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327765.3150; train_optim_loss: 327765.3150; val_kl_reg_loss: 4163.5889; val_edge_recon_loss: 260311.6927; val_gene_expr_recon_loss: 63572.3216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328047.5938; val_optim_loss: 328047.5938
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9794; val_auprc_score: 0.9690; val_best_acc_score: 0.9441; val_best_f1_score: 0.9457; train_kl_reg_loss: 4118.1975; train_edge_recon_loss: 260865.2356; train_gene_expr_recon_loss: 62585.3991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327568.8300; train_optim_loss: 327568.8300; val_kl_reg_loss: 4133.8442; val_edge_recon_loss: 259970.0573; val_gene_expr_recon_loss: 63820.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327924.4792; val_optim_loss: 327924.4792

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9779; val_auprc_score: 0.9654; val_best_acc_score: 0.9456; val_best_f1_score: 0.9471; train_kl_reg_loss: 4148.9902; train_edge_recon_loss: 260494.0594; train_gene_expr_recon_loss: 62197.5348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326840.5850; train_optim_loss: 326840.5850; val_kl_reg_loss: 4067.8083; val_edge_recon_loss: 259530.2083; val_gene_expr_recon_loss: 63305.5885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326903.6146; val_optim_loss: 326903.6146
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9812; val_auprc_score: 0.9712; val_best_acc_score: 0.9482; val_best_f1_score: 0.9501; train_kl_reg_loss: 4107.3974; train_edge_recon_loss: 259815.5287; train_gene_expr_recon_loss: 61811.7336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325734.6600; train_optim_loss: 325734.6600; val_kl_reg_loss: 4051.5212; val_edge_recon_loss: 257501.8854; val_gene_expr_recon_loss: 63104.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324657.5312; val_optim_loss: 324657.5312
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9799; val_auprc_score: 0.9704; val_best_acc_score: 0.9473; val_best_f1_score: 0.9488; train_kl_reg_loss: 4106.4227; train_edge_recon_loss: 259769.8312; train_gene_expr_recon_loss: 61824.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325701.0975; train_optim_loss: 325701.0975; val_kl_reg_loss: 4062.3594; val_edge_recon_loss: 258266.6510; val_gene_expr_recon_loss: 62603.6706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324932.6771; val_optim_loss: 324932.6771
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9793; val_auprc_score: 0.9676; val_best_acc_score: 0.9423; val_best_f1_score: 0.9438; train_kl_reg_loss: 4120.7551; train_edge_recon_loss: 259765.4394; train_gene_expr_recon_loss: 61905.3439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325791.5375; train_optim_loss: 325791.5375; val_kl_reg_loss: 4053.3606; val_edge_recon_loss: 261406.4583; val_gene_expr_recon_loss: 63200.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328660.0521; val_optim_loss: 328660.0521
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9819; val_auprc_score: 0.9708; val_best_acc_score: 0.9508; val_best_f1_score: 0.9522; train_kl_reg_loss: 4082.8848; train_edge_recon_loss: 260037.5306; train_gene_expr_recon_loss: 61885.7178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326006.1312; train_optim_loss: 326006.1312; val_kl_reg_loss: 4031.1999; val_edge_recon_loss: 258971.7083; val_gene_expr_recon_loss: 63102.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326105.4583; val_optim_loss: 326105.4583

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9757; val_auprc_score: 0.9620; val_best_acc_score: 0.9395; val_best_f1_score: 0.9417; train_kl_reg_loss: 4073.5888; train_edge_recon_loss: 259609.2669; train_gene_expr_recon_loss: 61681.1845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325364.0425; train_optim_loss: 325364.0425; val_kl_reg_loss: 4021.9694; val_edge_recon_loss: 261681.6615; val_gene_expr_recon_loss: 63522.7799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329226.4062; val_optim_loss: 329226.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9808; val_auprc_score: 0.9687; val_best_acc_score: 0.9484; val_best_f1_score: 0.9498; train_kl_reg_loss: 4072.6123; train_edge_recon_loss: 259467.4375; train_gene_expr_recon_loss: 61819.8367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325359.8862; train_optim_loss: 325359.8862; val_kl_reg_loss: 4031.3634; val_edge_recon_loss: 258550.3646; val_gene_expr_recon_loss: 63264.8268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325846.5521; val_optim_loss: 325846.5521
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9804; val_auprc_score: 0.9720; val_best_acc_score: 0.9443; val_best_f1_score: 0.9461; train_kl_reg_loss: 4071.5653; train_edge_recon_loss: 259766.6837; train_gene_expr_recon_loss: 61676.1186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325514.3688; train_optim_loss: 325514.3688; val_kl_reg_loss: 3895.6073; val_edge_recon_loss: 260170.1510; val_gene_expr_recon_loss: 63166.8581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327232.6146; val_optim_loss: 327232.6146

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 0 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9777
Val AUPRC score: 0.9677
Val best accuracy score: 0.9438
Val best F1 score: 0.9455
Val gene expr MSE score: 0.0096
Duration of model training in run 6: 0 hours, 1 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 33257
Number of validation edges: 3695
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8877; val_auprc_score: 0.8865; val_best_acc_score: 0.7310; val_best_f1_score: 0.7773; train_kl_reg_loss: 3238.4869; train_edge_recon_loss: 312388.4072; train_gene_expr_recon_loss: 69147.6898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384774.5832; train_optim_loss: 384774.5832; val_kl_reg_loss: 3239.5681; val_edge_recon_loss: 296805.8633; val_gene_expr_recon_loss: 67005.3496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367050.7812; val_optim_loss: 367050.7812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9283; val_auprc_score: 0.9034; val_best_acc_score: 0.8728; val_best_f1_score: 0.8821; train_kl_reg_loss: 3724.7692; train_edge_recon_loss: 282844.0298; train_gene_expr_recon_loss: 66823.3855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353392.1861; train_optim_loss: 353392.1861; val_kl_reg_loss: 4076.2690; val_edge_recon_loss: 267821.2578; val_gene_expr_recon_loss: 66494.0264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338391.5625; val_optim_loss: 338391.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9546; val_auprc_score: 0.9351; val_best_acc_score: 0.9045; val_best_f1_score: 0.9089; train_kl_reg_loss: 4121.5105; train_edge_recon_loss: 266981.1678; train_gene_expr_recon_loss: 66355.9295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337458.6072; train_optim_loss: 337458.6072; val_kl_reg_loss: 4164.4238; val_edge_recon_loss: 266611.5664; val_gene_expr_recon_loss: 66398.3447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337174.3398; val_optim_loss: 337174.3398
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9613; val_auprc_score: 0.9457; val_best_acc_score: 0.9183; val_best_f1_score: 0.9223; train_kl_reg_loss: 4048.8111; train_edge_recon_loss: 265449.8159; train_gene_expr_recon_loss: 65373.1814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334871.8077; train_optim_loss: 334871.8077; val_kl_reg_loss: 4021.0004; val_edge_recon_loss: 263531.8223; val_gene_expr_recon_loss: 65752.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333305.1016; val_optim_loss: 333305.1016
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9673; val_auprc_score: 0.9490; val_best_acc_score: 0.9288; val_best_f1_score: 0.9323; train_kl_reg_loss: 4046.8328; train_edge_recon_loss: 263653.1524; train_gene_expr_recon_loss: 64706.8384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332406.8226; train_optim_loss: 332406.8226; val_kl_reg_loss: 4044.0434; val_edge_recon_loss: 264026.8027; val_gene_expr_recon_loss: 65154.5840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333225.4297; val_optim_loss: 333225.4297
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9722; val_auprc_score: 0.9575; val_best_acc_score: 0.9319; val_best_f1_score: 0.9343; train_kl_reg_loss: 4062.3484; train_edge_recon_loss: 263056.6774; train_gene_expr_recon_loss: 64273.8597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331392.8865; train_optim_loss: 331392.8865; val_kl_reg_loss: 4032.4057; val_edge_recon_loss: 261924.3418; val_gene_expr_recon_loss: 63850.3057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329807.0508; val_optim_loss: 329807.0508
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9722; val_auprc_score: 0.9570; val_best_acc_score: 0.9345; val_best_f1_score: 0.9375; train_kl_reg_loss: 4094.3823; train_edge_recon_loss: 262149.2731; train_gene_expr_recon_loss: 64027.3610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330271.0163; train_optim_loss: 330271.0163; val_kl_reg_loss: 3944.9121; val_edge_recon_loss: 260573.5703; val_gene_expr_recon_loss: 64343.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328862.2227; val_optim_loss: 328862.2227
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9743; val_auprc_score: 0.9580; val_best_acc_score: 0.9361; val_best_f1_score: 0.9385; train_kl_reg_loss: 4098.7187; train_edge_recon_loss: 261336.3300; train_gene_expr_recon_loss: 63537.4111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328972.4596; train_optim_loss: 328972.4596; val_kl_reg_loss: 4079.3950; val_edge_recon_loss: 259395.4590; val_gene_expr_recon_loss: 63524.6055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326999.4609; val_optim_loss: 326999.4609
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9687; val_best_acc_score: 0.9437; val_best_f1_score: 0.9458; train_kl_reg_loss: 4103.4946; train_edge_recon_loss: 260303.4514; train_gene_expr_recon_loss: 63107.5323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327514.4760; train_optim_loss: 327514.4760; val_kl_reg_loss: 4063.0912; val_edge_recon_loss: 261478.9590; val_gene_expr_recon_loss: 63707.4990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329249.5508; val_optim_loss: 329249.5508
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9817; val_auprc_score: 0.9724; val_best_acc_score: 0.9524; val_best_f1_score: 0.9538; train_kl_reg_loss: 4094.9822; train_edge_recon_loss: 260402.4195; train_gene_expr_recon_loss: 62824.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327322.3726; train_optim_loss: 327322.3726; val_kl_reg_loss: 4076.7333; val_edge_recon_loss: 258716.7812; val_gene_expr_recon_loss: 63357.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326151.1641; val_optim_loss: 326151.1641
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9794; val_auprc_score: 0.9689; val_best_acc_score: 0.9507; val_best_f1_score: 0.9517; train_kl_reg_loss: 4107.7120; train_edge_recon_loss: 259624.0925; train_gene_expr_recon_loss: 62808.7998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326540.6058; train_optim_loss: 326540.6058; val_kl_reg_loss: 3933.2048; val_edge_recon_loss: 258868.8652; val_gene_expr_recon_loss: 62928.9331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325731.0000; val_optim_loss: 325731.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9794; val_auprc_score: 0.9692; val_best_acc_score: 0.9518; val_best_f1_score: 0.9534; train_kl_reg_loss: 4098.6954; train_edge_recon_loss: 259585.4351; train_gene_expr_recon_loss: 62194.2513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325878.3812; train_optim_loss: 325878.3812; val_kl_reg_loss: 4048.7271; val_edge_recon_loss: 258763.2969; val_gene_expr_recon_loss: 62960.8413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325772.8711; val_optim_loss: 325772.8711
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9829; val_auprc_score: 0.9754; val_best_acc_score: 0.9571; val_best_f1_score: 0.9584; train_kl_reg_loss: 4081.4954; train_edge_recon_loss: 259214.8389; train_gene_expr_recon_loss: 62205.0591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325501.3957; train_optim_loss: 325501.3957; val_kl_reg_loss: 4025.6066; val_edge_recon_loss: 256720.7676; val_gene_expr_recon_loss: 62037.1582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322783.5352; val_optim_loss: 322783.5352
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9833; val_auprc_score: 0.9756; val_best_acc_score: 0.9564; val_best_f1_score: 0.9578; train_kl_reg_loss: 4105.8944; train_edge_recon_loss: 258825.4615; train_gene_expr_recon_loss: 62266.6648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325198.0207; train_optim_loss: 325198.0207; val_kl_reg_loss: 4059.4353; val_edge_recon_loss: 257890.9688; val_gene_expr_recon_loss: 62725.3896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324675.7930; val_optim_loss: 324675.7930
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9829; val_auprc_score: 0.9708; val_best_acc_score: 0.9567; val_best_f1_score: 0.9578; train_kl_reg_loss: 4086.5159; train_edge_recon_loss: 258942.3998; train_gene_expr_recon_loss: 61644.7720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324673.6894; train_optim_loss: 324673.6894; val_kl_reg_loss: 4096.4754; val_edge_recon_loss: 258569.6230; val_gene_expr_recon_loss: 61662.2979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324328.3984; val_optim_loss: 324328.3984
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9849; val_auprc_score: 0.9790; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 4096.2141; train_edge_recon_loss: 258664.0748; train_gene_expr_recon_loss: 61429.2327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324189.5216; train_optim_loss: 324189.5216; val_kl_reg_loss: 4053.8036; val_edge_recon_loss: 258840.6523; val_gene_expr_recon_loss: 61912.1157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324806.5703; val_optim_loss: 324806.5703

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9835; val_auprc_score: 0.9763; val_best_acc_score: 0.9582; val_best_f1_score: 0.9595; train_kl_reg_loss: 4062.0478; train_edge_recon_loss: 258532.9050; train_gene_expr_recon_loss: 61396.2190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323991.1688; train_optim_loss: 323991.1688; val_kl_reg_loss: 4027.7276; val_edge_recon_loss: 257440.4922; val_gene_expr_recon_loss: 60838.5098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322306.7266; val_optim_loss: 322306.7266
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9856; val_auprc_score: 0.9764; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 4066.7516; train_edge_recon_loss: 258279.8916; train_gene_expr_recon_loss: 60551.7356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322898.3788; train_optim_loss: 322898.3788; val_kl_reg_loss: 4051.9375; val_edge_recon_loss: 256938.7852; val_gene_expr_recon_loss: 60459.8149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321450.5391; val_optim_loss: 321450.5391
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9869; val_auprc_score: 0.9810; val_best_acc_score: 0.9629; val_best_f1_score: 0.9640; train_kl_reg_loss: 4087.2474; train_edge_recon_loss: 258818.4817; train_gene_expr_recon_loss: 60533.8715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323439.6000; train_optim_loss: 323439.6000; val_kl_reg_loss: 4041.5135; val_edge_recon_loss: 256214.0898; val_gene_expr_recon_loss: 60434.3994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320690.0039; val_optim_loss: 320690.0039
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9843; val_auprc_score: 0.9759; val_best_acc_score: 0.9604; val_best_f1_score: 0.9616; train_kl_reg_loss: 4082.9451; train_edge_recon_loss: 258084.0851; train_gene_expr_recon_loss: 60770.2245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322937.2558; train_optim_loss: 322937.2558; val_kl_reg_loss: 4070.3376; val_edge_recon_loss: 257566.8242; val_gene_expr_recon_loss: 61212.3013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322849.4648; val_optim_loss: 322849.4648
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9857; val_auprc_score: 0.9784; val_best_acc_score: 0.9614; val_best_f1_score: 0.9626; train_kl_reg_loss: 4093.6739; train_edge_recon_loss: 257755.0654; train_gene_expr_recon_loss: 60592.3461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322441.0827; train_optim_loss: 322441.0827; val_kl_reg_loss: 4074.3327; val_edge_recon_loss: 256659.1094; val_gene_expr_recon_loss: 61371.8218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322105.2656; val_optim_loss: 322105.2656
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9853; val_auprc_score: 0.9749; val_best_acc_score: 0.9608; val_best_f1_score: 0.9618; train_kl_reg_loss: 4067.2157; train_edge_recon_loss: 258076.7560; train_gene_expr_recon_loss: 60844.1343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322988.1034; train_optim_loss: 322988.1034; val_kl_reg_loss: 4023.6091; val_edge_recon_loss: 256520.6699; val_gene_expr_recon_loss: 60865.6963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321409.9766; val_optim_loss: 321409.9766

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9867; val_auprc_score: 0.9790; val_best_acc_score: 0.9605; val_best_f1_score: 0.9615; train_kl_reg_loss: 4062.3677; train_edge_recon_loss: 258036.5704; train_gene_expr_recon_loss: 60598.7572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322697.6971; train_optim_loss: 322697.6971; val_kl_reg_loss: 4045.6717; val_edge_recon_loss: 257530.4766; val_gene_expr_recon_loss: 60134.4585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321710.6055; val_optim_loss: 321710.6055
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9868; val_auprc_score: 0.9824; val_best_acc_score: 0.9606; val_best_f1_score: 0.9617; train_kl_reg_loss: 4067.9287; train_edge_recon_loss: 258775.6615; train_gene_expr_recon_loss: 60580.5939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323424.1817; train_optim_loss: 323424.1817; val_kl_reg_loss: 4046.1807; val_edge_recon_loss: 259374.5703; val_gene_expr_recon_loss: 60821.0522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324241.7969; val_optim_loss: 324241.7969
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9851; val_auprc_score: 0.9768; val_best_acc_score: 0.9604; val_best_f1_score: 0.9614; train_kl_reg_loss: 4063.0497; train_edge_recon_loss: 258451.9800; train_gene_expr_recon_loss: 60681.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323196.3010; train_optim_loss: 323196.3010; val_kl_reg_loss: 4036.4122; val_edge_recon_loss: 257480.5176; val_gene_expr_recon_loss: 60313.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321830.3281; val_optim_loss: 321830.3281

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 55 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9836
Val AUPRC score: 0.9741
Val best accuracy score: 0.9595
Val best F1 score: 0.9608
Val gene expr MSE score: 0.0093
Duration of model training in run 7: 0 hours, 2 minutes and 0 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 33257
Number of validation edges: 3695
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8807; val_auprc_score: 0.8778; val_best_acc_score: 0.7562; val_best_f1_score: 0.7849; train_kl_reg_loss: 3411.8802; train_edge_recon_loss: 313416.2236; train_gene_expr_recon_loss: 68391.7683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385219.8712; train_optim_loss: 385219.8712; val_kl_reg_loss: 3691.9803; val_edge_recon_loss: 291949.5977; val_gene_expr_recon_loss: 68276.8794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363918.4609; val_optim_loss: 363918.4609
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9348; val_auprc_score: 0.9135; val_best_acc_score: 0.8710; val_best_f1_score: 0.8768; train_kl_reg_loss: 3898.7924; train_edge_recon_loss: 282586.0870; train_gene_expr_recon_loss: 65719.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352203.8870; train_optim_loss: 352203.8870; val_kl_reg_loss: 4112.6251; val_edge_recon_loss: 267605.5312; val_gene_expr_recon_loss: 67936.9854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339655.1367; val_optim_loss: 339655.1367
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9594; val_auprc_score: 0.9428; val_best_acc_score: 0.9115; val_best_f1_score: 0.9152; train_kl_reg_loss: 4127.2495; train_edge_recon_loss: 267617.0243; train_gene_expr_recon_loss: 65175.0900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336919.3644; train_optim_loss: 336919.3644; val_kl_reg_loss: 4077.0172; val_edge_recon_loss: 264878.8242; val_gene_expr_recon_loss: 67349.2915; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336305.1367; val_optim_loss: 336305.1367
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9640; val_auprc_score: 0.9490; val_best_acc_score: 0.9200; val_best_f1_score: 0.9234; train_kl_reg_loss: 4062.3920; train_edge_recon_loss: 265440.8315; train_gene_expr_recon_loss: 64831.3428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334334.5639; train_optim_loss: 334334.5639; val_kl_reg_loss: 4013.7629; val_edge_recon_loss: 263478.9668; val_gene_expr_recon_loss: 66256.9873; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333749.7148; val_optim_loss: 333749.7148
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9699; val_auprc_score: 0.9573; val_best_acc_score: 0.9313; val_best_f1_score: 0.9341; train_kl_reg_loss: 4095.2409; train_edge_recon_loss: 263874.3127; train_gene_expr_recon_loss: 64223.7629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332193.3183; train_optim_loss: 332193.3183; val_kl_reg_loss: 4188.5333; val_edge_recon_loss: 261359.6309; val_gene_expr_recon_loss: 65955.9478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331504.1094; val_optim_loss: 331504.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9749; val_auprc_score: 0.9632; val_best_acc_score: 0.9382; val_best_f1_score: 0.9402; train_kl_reg_loss: 4120.1664; train_edge_recon_loss: 263104.9190; train_gene_expr_recon_loss: 63998.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331223.3010; train_optim_loss: 331223.3010; val_kl_reg_loss: 3997.6162; val_edge_recon_loss: 261946.7109; val_gene_expr_recon_loss: 65792.2637; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331736.5898; val_optim_loss: 331736.5898
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9774; val_auprc_score: 0.9649; val_best_acc_score: 0.9475; val_best_f1_score: 0.9492; train_kl_reg_loss: 4128.7873; train_edge_recon_loss: 260872.3748; train_gene_expr_recon_loss: 63472.8276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328473.9904; train_optim_loss: 328473.9904; val_kl_reg_loss: 4056.6524; val_edge_recon_loss: 259390.6426; val_gene_expr_recon_loss: 65387.7686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328835.0586; val_optim_loss: 328835.0586
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9822; val_auprc_score: 0.9747; val_best_acc_score: 0.9498; val_best_f1_score: 0.9511; train_kl_reg_loss: 4102.0051; train_edge_recon_loss: 261043.5002; train_gene_expr_recon_loss: 63089.1418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328234.6462; train_optim_loss: 328234.6462; val_kl_reg_loss: 4069.4488; val_edge_recon_loss: 257964.5996; val_gene_expr_recon_loss: 64645.2651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326679.3164; val_optim_loss: 326679.3164
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9796; val_auprc_score: 0.9695; val_best_acc_score: 0.9495; val_best_f1_score: 0.9510; train_kl_reg_loss: 4087.3014; train_edge_recon_loss: 260573.0060; train_gene_expr_recon_loss: 62421.9860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327082.2899; train_optim_loss: 327082.2899; val_kl_reg_loss: 3998.7106; val_edge_recon_loss: 259561.0938; val_gene_expr_recon_loss: 64065.9160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327625.7188; val_optim_loss: 327625.7188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9831; val_auprc_score: 0.9744; val_best_acc_score: 0.9547; val_best_f1_score: 0.9559; train_kl_reg_loss: 4071.7382; train_edge_recon_loss: 260387.5796; train_gene_expr_recon_loss: 62493.6998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326953.0159; train_optim_loss: 326953.0159; val_kl_reg_loss: 4035.9737; val_edge_recon_loss: 258492.2441; val_gene_expr_recon_loss: 64134.4204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326662.6367; val_optim_loss: 326662.6367
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9810; val_auprc_score: 0.9718; val_best_acc_score: 0.9537; val_best_f1_score: 0.9549; train_kl_reg_loss: 4078.3206; train_edge_recon_loss: 259649.1731; train_gene_expr_recon_loss: 62400.7375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326128.2308; train_optim_loss: 326128.2308; val_kl_reg_loss: 4011.2636; val_edge_recon_loss: 257731.3281; val_gene_expr_recon_loss: 64005.6206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325748.2031; val_optim_loss: 325748.2031
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9817; val_auprc_score: 0.9710; val_best_acc_score: 0.9528; val_best_f1_score: 0.9542; train_kl_reg_loss: 4078.2456; train_edge_recon_loss: 258903.3788; train_gene_expr_recon_loss: 62047.6821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325029.3063; train_optim_loss: 325029.3063; val_kl_reg_loss: 3877.3962; val_edge_recon_loss: 260364.0469; val_gene_expr_recon_loss: 64172.3853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328413.8203; val_optim_loss: 328413.8203
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9828; val_auprc_score: 0.9753; val_best_acc_score: 0.9567; val_best_f1_score: 0.9581; train_kl_reg_loss: 4095.2021; train_edge_recon_loss: 259205.3668; train_gene_expr_recon_loss: 61725.0995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325025.6663; train_optim_loss: 325025.6663; val_kl_reg_loss: 4053.0135; val_edge_recon_loss: 258311.2480; val_gene_expr_recon_loss: 63413.3730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325777.6328; val_optim_loss: 325777.6328
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9842; val_auprc_score: 0.9746; val_best_acc_score: 0.9567; val_best_f1_score: 0.9580; train_kl_reg_loss: 4086.2315; train_edge_recon_loss: 258687.3675; train_gene_expr_recon_loss: 61414.4298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324188.0312; train_optim_loss: 324188.0312; val_kl_reg_loss: 4072.0743; val_edge_recon_loss: 257475.5801; val_gene_expr_recon_loss: 64193.1216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325740.7812; val_optim_loss: 325740.7812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9865; val_auprc_score: 0.9825; val_best_acc_score: 0.9574; val_best_f1_score: 0.9585; train_kl_reg_loss: 4081.0263; train_edge_recon_loss: 258710.9582; train_gene_expr_recon_loss: 61455.4064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324247.3909; train_optim_loss: 324247.3909; val_kl_reg_loss: 3916.3918; val_edge_recon_loss: 257155.2031; val_gene_expr_recon_loss: 63688.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324759.9258; val_optim_loss: 324759.9258
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9843; val_auprc_score: 0.9763; val_best_acc_score: 0.9590; val_best_f1_score: 0.9603; train_kl_reg_loss: 4085.8422; train_edge_recon_loss: 259082.0212; train_gene_expr_recon_loss: 61180.4546; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324348.3221; train_optim_loss: 324348.3221; val_kl_reg_loss: 4031.5684; val_edge_recon_loss: 257661.1426; val_gene_expr_recon_loss: 63407.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325100.5195; val_optim_loss: 325100.5195
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9865; val_auprc_score: 0.9807; val_best_acc_score: 0.9594; val_best_f1_score: 0.9608; train_kl_reg_loss: 4087.3054; train_edge_recon_loss: 258652.6370; train_gene_expr_recon_loss: 60914.9867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323654.9293; train_optim_loss: 323654.9293; val_kl_reg_loss: 3948.2273; val_edge_recon_loss: 256930.2734; val_gene_expr_recon_loss: 62432.3936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323310.8945; val_optim_loss: 323310.8945
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9845; val_auprc_score: 0.9774; val_best_acc_score: 0.9571; val_best_f1_score: 0.9581; train_kl_reg_loss: 4077.3514; train_edge_recon_loss: 258164.1834; train_gene_expr_recon_loss: 60697.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322939.3611; train_optim_loss: 322939.3611; val_kl_reg_loss: 4033.4483; val_edge_recon_loss: 258299.7266; val_gene_expr_recon_loss: 62364.7671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324697.9336; val_optim_loss: 324697.9336
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9857; val_auprc_score: 0.9759; val_best_acc_score: 0.9572; val_best_f1_score: 0.9587; train_kl_reg_loss: 4098.9827; train_edge_recon_loss: 258142.5248; train_gene_expr_recon_loss: 60504.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322745.5457; train_optim_loss: 322745.5457; val_kl_reg_loss: 4094.9867; val_edge_recon_loss: 258871.6270; val_gene_expr_recon_loss: 62814.5273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325781.1289; val_optim_loss: 325781.1289
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9872; val_auprc_score: 0.9805; val_best_acc_score: 0.9618; val_best_f1_score: 0.9628; train_kl_reg_loss: 4098.5058; train_edge_recon_loss: 258055.6079; train_gene_expr_recon_loss: 60214.1401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322368.2524; train_optim_loss: 322368.2524; val_kl_reg_loss: 4092.3371; val_edge_recon_loss: 256430.0254; val_gene_expr_recon_loss: 62149.8242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322672.1836; val_optim_loss: 322672.1836
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9871; val_auprc_score: 0.9793; val_best_acc_score: 0.9631; val_best_f1_score: 0.9640; train_kl_reg_loss: 4088.9469; train_edge_recon_loss: 257757.7260; train_gene_expr_recon_loss: 60237.6749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322084.3500; train_optim_loss: 322084.3500; val_kl_reg_loss: 3996.9282; val_edge_recon_loss: 257240.6875; val_gene_expr_recon_loss: 62539.5010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323777.1211; val_optim_loss: 323777.1211
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9887; val_auprc_score: 0.9812; val_best_acc_score: 0.9670; val_best_f1_score: 0.9678; train_kl_reg_loss: 4095.7396; train_edge_recon_loss: 257963.7464; train_gene_expr_recon_loss: 59999.3178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322058.8038; train_optim_loss: 322058.8038; val_kl_reg_loss: 4126.1286; val_edge_recon_loss: 256322.3320; val_gene_expr_recon_loss: 61872.8408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322321.3008; val_optim_loss: 322321.3008
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9865; val_auprc_score: 0.9767; val_best_acc_score: 0.9621; val_best_f1_score: 0.9633; train_kl_reg_loss: 4084.4962; train_edge_recon_loss: 258159.2690; train_gene_expr_recon_loss: 59712.1604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321955.9269; train_optim_loss: 321955.9269; val_kl_reg_loss: 4127.6185; val_edge_recon_loss: 258133.2422; val_gene_expr_recon_loss: 62329.1685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324590.0273; val_optim_loss: 324590.0273
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9879; val_auprc_score: 0.9805; val_best_acc_score: 0.9650; val_best_f1_score: 0.9659; train_kl_reg_loss: 4095.3023; train_edge_recon_loss: 257961.2200; train_gene_expr_recon_loss: 59756.1059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321812.6293; train_optim_loss: 321812.6293; val_kl_reg_loss: 4088.3914; val_edge_recon_loss: 257258.0195; val_gene_expr_recon_loss: 61051.8491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322398.2617; val_optim_loss: 322398.2617
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9885; val_auprc_score: 0.9805; val_best_acc_score: 0.9650; val_best_f1_score: 0.9659; train_kl_reg_loss: 4098.8137; train_edge_recon_loss: 257711.0433; train_gene_expr_recon_loss: 59666.3162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321476.1731; train_optim_loss: 321476.1731; val_kl_reg_loss: 4035.9773; val_edge_recon_loss: 257678.0879; val_gene_expr_recon_loss: 60756.1958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322470.2617; val_optim_loss: 322470.2617

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9881; val_auprc_score: 0.9800; val_best_acc_score: 0.9651; val_best_f1_score: 0.9660; train_kl_reg_loss: 3956.6858; train_edge_recon_loss: 257793.9204; train_gene_expr_recon_loss: 59504.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321254.7442; train_optim_loss: 321254.7442; val_kl_reg_loss: 3580.9252; val_edge_recon_loss: 258091.7773; val_gene_expr_recon_loss: 61003.5996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322676.3008; val_optim_loss: 322676.3008
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9874; val_auprc_score: 0.9790; val_best_acc_score: 0.9666; val_best_f1_score: 0.9674; train_kl_reg_loss: 3772.5106; train_edge_recon_loss: 257340.3478; train_gene_expr_recon_loss: 59484.6360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320597.4933; train_optim_loss: 320597.4933; val_kl_reg_loss: 3424.4427; val_edge_recon_loss: 256857.6172; val_gene_expr_recon_loss: 60684.9429; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320967.0000; val_optim_loss: 320967.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9901; val_auprc_score: 0.9850; val_best_acc_score: 0.9705; val_best_f1_score: 0.9711; train_kl_reg_loss: 3581.9498; train_edge_recon_loss: 257393.1171; train_gene_expr_recon_loss: 59224.5541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320199.6221; train_optim_loss: 320199.6221; val_kl_reg_loss: 3249.4158; val_edge_recon_loss: 254467.2949; val_gene_expr_recon_loss: 60681.2144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318397.9258; val_optim_loss: 318397.9258
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9876; val_auprc_score: 0.9810; val_best_acc_score: 0.9673; val_best_f1_score: 0.9681; train_kl_reg_loss: 3438.9007; train_edge_recon_loss: 257071.2327; train_gene_expr_recon_loss: 59475.0096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319985.1399; train_optim_loss: 319985.1399; val_kl_reg_loss: 3119.0626; val_edge_recon_loss: 256135.6816; val_gene_expr_recon_loss: 60249.8979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319504.6484; val_optim_loss: 319504.6484
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9849; val_auprc_score: 0.9755; val_best_acc_score: 0.9643; val_best_f1_score: 0.9653; train_kl_reg_loss: 3329.7762; train_edge_recon_loss: 256695.6913; train_gene_expr_recon_loss: 59002.2834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319027.7514; train_optim_loss: 319027.7514; val_kl_reg_loss: 3058.2312; val_edge_recon_loss: 257292.9121; val_gene_expr_recon_loss: 60409.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320760.8789; val_optim_loss: 320760.8789
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9879; val_auprc_score: 0.9807; val_best_acc_score: 0.9674; val_best_f1_score: 0.9682; train_kl_reg_loss: 3258.6520; train_edge_recon_loss: 257020.0543; train_gene_expr_recon_loss: 59124.4678; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319403.1750; train_optim_loss: 319403.1750; val_kl_reg_loss: 2998.1212; val_edge_recon_loss: 255899.4004; val_gene_expr_recon_loss: 60932.1509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319829.6758; val_optim_loss: 319829.6758

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9891; val_auprc_score: 0.9826; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 3227.8543; train_edge_recon_loss: 257003.5925; train_gene_expr_recon_loss: 59135.6108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319367.0567; train_optim_loss: 319367.0567; val_kl_reg_loss: 2995.2787; val_edge_recon_loss: 256107.2285; val_gene_expr_recon_loss: 60606.8252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319709.3359; val_optim_loss: 319709.3359
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9879; val_auprc_score: 0.9838; val_best_acc_score: 0.9648; val_best_f1_score: 0.9657; train_kl_reg_loss: 3222.2710; train_edge_recon_loss: 257455.6981; train_gene_expr_recon_loss: 59242.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319919.9938; train_optim_loss: 319919.9938; val_kl_reg_loss: 2982.3550; val_edge_recon_loss: 257314.8047; val_gene_expr_recon_loss: 61293.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321590.2773; val_optim_loss: 321590.2773
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9906; val_auprc_score: 0.9860; val_best_acc_score: 0.9673; val_best_f1_score: 0.9680; train_kl_reg_loss: 3217.4570; train_edge_recon_loss: 257171.2428; train_gene_expr_recon_loss: 59124.3822; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319513.0803; train_optim_loss: 319513.0803; val_kl_reg_loss: 2987.0463; val_edge_recon_loss: 257093.6191; val_gene_expr_recon_loss: 60589.4458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320670.1133; val_optim_loss: 320670.1133

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 26 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9895
Val AUPRC score: 0.9819
Val best accuracy score: 0.9682
Val best F1 score: 0.9689
Val gene expr MSE score: 0.0092
Duration of model training in run 8: 0 hours, 3 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 41473
Number of validation edges: 4608
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9151; val_auprc_score: 0.8912; val_best_acc_score: 0.8518; val_best_f1_score: 0.8641; train_kl_reg_loss: 3503.8867; train_edge_recon_loss: 297885.5237; train_gene_expr_recon_loss: 68328.4270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369717.8370; train_optim_loss: 369717.8370; val_kl_reg_loss: 4514.5974; val_edge_recon_loss: 275705.7552; val_gene_expr_recon_loss: 67789.6074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348009.9583; val_optim_loss: 348009.9583
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9604; val_auprc_score: 0.9418; val_best_acc_score: 0.9131; val_best_f1_score: 0.9167; train_kl_reg_loss: 4045.8876; train_edge_recon_loss: 268152.4999; train_gene_expr_recon_loss: 66027.1708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338225.5569; train_optim_loss: 338225.5569; val_kl_reg_loss: 4102.6283; val_edge_recon_loss: 265011.7752; val_gene_expr_recon_loss: 65615.9021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334730.3108; val_optim_loss: 334730.3108
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9671; val_auprc_score: 0.9523; val_best_acc_score: 0.9211; val_best_f1_score: 0.9249; train_kl_reg_loss: 4095.9603; train_edge_recon_loss: 263613.9560; train_gene_expr_recon_loss: 64697.7041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332407.6191; train_optim_loss: 332407.6191; val_kl_reg_loss: 4018.2577; val_edge_recon_loss: 263647.1042; val_gene_expr_recon_loss: 64849.9722; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332515.3333; val_optim_loss: 332515.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9730; val_auprc_score: 0.9584; val_best_acc_score: 0.9376; val_best_f1_score: 0.9399; train_kl_reg_loss: 4160.5871; train_edge_recon_loss: 262634.1096; train_gene_expr_recon_loss: 64004.7450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330799.4427; train_optim_loss: 330799.4427; val_kl_reg_loss: 4207.4444; val_edge_recon_loss: 259980.2396; val_gene_expr_recon_loss: 63830.3036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328017.9896; val_optim_loss: 328017.9896
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9775; val_auprc_score: 0.9643; val_best_acc_score: 0.9447; val_best_f1_score: 0.9469; train_kl_reg_loss: 4110.0878; train_edge_recon_loss: 260827.4426; train_gene_expr_recon_loss: 62980.4347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327917.9657; train_optim_loss: 327917.9657; val_kl_reg_loss: 4020.1233; val_edge_recon_loss: 259236.5078; val_gene_expr_recon_loss: 63218.9735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326475.6024; val_optim_loss: 326475.6024
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9812; val_auprc_score: 0.9719; val_best_acc_score: 0.9516; val_best_f1_score: 0.9529; train_kl_reg_loss: 4107.6029; train_edge_recon_loss: 260836.8694; train_gene_expr_recon_loss: 62405.3419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327349.8137; train_optim_loss: 327349.8137; val_kl_reg_loss: 3942.3439; val_edge_recon_loss: 260176.0807; val_gene_expr_recon_loss: 62882.9329; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327001.3611; val_optim_loss: 327001.3611
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9790; val_auprc_score: 0.9656; val_best_acc_score: 0.9494; val_best_f1_score: 0.9512; train_kl_reg_loss: 4078.4718; train_edge_recon_loss: 259386.7792; train_gene_expr_recon_loss: 61790.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325255.3606; train_optim_loss: 325255.3606; val_kl_reg_loss: 4055.6833; val_edge_recon_loss: 261036.8220; val_gene_expr_recon_loss: 62304.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327396.8403; val_optim_loss: 327396.8403
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9832; val_auprc_score: 0.9759; val_best_acc_score: 0.9546; val_best_f1_score: 0.9563; train_kl_reg_loss: 4087.3255; train_edge_recon_loss: 259405.1028; train_gene_expr_recon_loss: 61274.2758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324766.7046; train_optim_loss: 324766.7046; val_kl_reg_loss: 4046.8575; val_edge_recon_loss: 258141.9253; val_gene_expr_recon_loss: 61547.5211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323736.3038; val_optim_loss: 323736.3038
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9841; val_auprc_score: 0.9759; val_best_acc_score: 0.9587; val_best_f1_score: 0.9597; train_kl_reg_loss: 4087.6172; train_edge_recon_loss: 260258.2793; train_gene_expr_recon_loss: 61145.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325491.0148; train_optim_loss: 325491.0148; val_kl_reg_loss: 4106.7580; val_edge_recon_loss: 257481.8203; val_gene_expr_recon_loss: 61705.2897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323293.8698; val_optim_loss: 323293.8698
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9855; val_auprc_score: 0.9804; val_best_acc_score: 0.9586; val_best_f1_score: 0.9596; train_kl_reg_loss: 4104.1220; train_edge_recon_loss: 258874.6717; train_gene_expr_recon_loss: 60609.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323587.9927; train_optim_loss: 323587.9927; val_kl_reg_loss: 4081.5908; val_edge_recon_loss: 258017.8759; val_gene_expr_recon_loss: 61077.4829; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323176.9497; val_optim_loss: 323176.9497
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9858; val_auprc_score: 0.9775; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 4082.9165; train_edge_recon_loss: 258897.0645; train_gene_expr_recon_loss: 60308.0803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323288.0604; train_optim_loss: 323288.0604; val_kl_reg_loss: 4109.8311; val_edge_recon_loss: 256780.8342; val_gene_expr_recon_loss: 60644.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321535.0694; val_optim_loss: 321535.0694
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9864; val_auprc_score: 0.9796; val_best_acc_score: 0.9637; val_best_f1_score: 0.9647; train_kl_reg_loss: 4115.2220; train_edge_recon_loss: 257780.1688; train_gene_expr_recon_loss: 60085.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321980.7094; train_optim_loss: 321980.7094; val_kl_reg_loss: 4174.0164; val_edge_recon_loss: 257905.1901; val_gene_expr_recon_loss: 60232.9703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322312.1788; val_optim_loss: 322312.1788
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9862; val_auprc_score: 0.9779; val_best_acc_score: 0.9647; val_best_f1_score: 0.9656; train_kl_reg_loss: 4114.1595; train_edge_recon_loss: 258027.1683; train_gene_expr_recon_loss: 59792.4228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321933.7504; train_optim_loss: 321933.7504; val_kl_reg_loss: 4111.9184; val_edge_recon_loss: 257170.9514; val_gene_expr_recon_loss: 60396.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321679.0556; val_optim_loss: 321679.0556
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9872; val_auprc_score: 0.9798; val_best_acc_score: 0.9660; val_best_f1_score: 0.9668; train_kl_reg_loss: 4116.8006; train_edge_recon_loss: 257806.5149; train_gene_expr_recon_loss: 59631.3882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321554.7057; train_optim_loss: 321554.7057; val_kl_reg_loss: 4240.9333; val_edge_recon_loss: 257255.4080; val_gene_expr_recon_loss: 60060.6871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321557.0278; val_optim_loss: 321557.0278

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9875; val_auprc_score: 0.9807; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 4150.6120; train_edge_recon_loss: 257353.6512; train_gene_expr_recon_loss: 59073.0575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320577.3188; train_optim_loss: 320577.3188; val_kl_reg_loss: 4106.5568; val_edge_recon_loss: 255948.9731; val_gene_expr_recon_loss: 59950.9889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320006.5156; val_optim_loss: 320006.5156
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9878; val_auprc_score: 0.9817; val_best_acc_score: 0.9678; val_best_f1_score: 0.9685; train_kl_reg_loss: 4122.4520; train_edge_recon_loss: 257628.8897; train_gene_expr_recon_loss: 59010.7755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320762.1177; train_optim_loss: 320762.1177; val_kl_reg_loss: 4108.1377; val_edge_recon_loss: 256820.4922; val_gene_expr_recon_loss: 59847.8236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320776.4566; val_optim_loss: 320776.4566
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9906; val_auprc_score: 0.9850; val_best_acc_score: 0.9701; val_best_f1_score: 0.9707; train_kl_reg_loss: 4091.9687; train_edge_recon_loss: 257565.0792; train_gene_expr_recon_loss: 58975.0517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320632.1007; train_optim_loss: 320632.1007; val_kl_reg_loss: 4102.1706; val_edge_recon_loss: 255561.9688; val_gene_expr_recon_loss: 59853.8403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319517.9722; val_optim_loss: 319517.9722
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9877; val_auprc_score: 0.9797; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 4102.1353; train_edge_recon_loss: 257555.0992; train_gene_expr_recon_loss: 58883.8758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320541.1095; train_optim_loss: 320541.1095; val_kl_reg_loss: 4122.8394; val_edge_recon_loss: 257228.5182; val_gene_expr_recon_loss: 59853.2511; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321204.6076; val_optim_loss: 321204.6076
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9876; val_auprc_score: 0.9783; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 4111.1590; train_edge_recon_loss: 257406.2699; train_gene_expr_recon_loss: 59004.8420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320522.2726; train_optim_loss: 320522.2726; val_kl_reg_loss: 4099.6981; val_edge_recon_loss: 256742.5894; val_gene_expr_recon_loss: 59780.4768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320622.7639; val_optim_loss: 320622.7639
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9885; val_auprc_score: 0.9821; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 4108.4512; train_edge_recon_loss: 257078.4660; train_gene_expr_recon_loss: 58807.8219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319994.7379; train_optim_loss: 319994.7379; val_kl_reg_loss: 4115.1960; val_edge_recon_loss: 256573.6155; val_gene_expr_recon_loss: 59726.6879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320415.4965; val_optim_loss: 320415.4965

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9884; val_auprc_score: 0.9804; val_best_acc_score: 0.9699; val_best_f1_score: 0.9705; train_kl_reg_loss: 4118.4394; train_edge_recon_loss: 256853.6776; train_gene_expr_recon_loss: 58896.5535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319868.6701; train_optim_loss: 319868.6701; val_kl_reg_loss: 4103.6589; val_edge_recon_loss: 255875.3585; val_gene_expr_recon_loss: 59677.4106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319656.4271; val_optim_loss: 319656.4271
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9889; val_auprc_score: 0.9813; val_best_acc_score: 0.9669; val_best_f1_score: 0.9677; train_kl_reg_loss: 4107.8262; train_edge_recon_loss: 258205.6065; train_gene_expr_recon_loss: 59000.8990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321314.3309; train_optim_loss: 321314.3309; val_kl_reg_loss: 4098.0700; val_edge_recon_loss: 256824.2604; val_gene_expr_recon_loss: 59869.1654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320791.4948; val_optim_loss: 320791.4948
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9886; val_auprc_score: 0.9803; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 4102.9924; train_edge_recon_loss: 257852.5086; train_gene_expr_recon_loss: 59029.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320985.0573; train_optim_loss: 320985.0573; val_kl_reg_loss: 4097.7303; val_edge_recon_loss: 256680.3446; val_gene_expr_recon_loss: 59625.4251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320403.5000; val_optim_loss: 320403.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 50 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9854
Val AUPRC score: 0.9787
Val best accuracy score: 0.9600
Val best F1 score: 0.9612
Val gene expr MSE score: 0.0092
Duration of model training in run 9: 0 hours, 4 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 3780
Number of validation nodes: 420
Number of training edges: 41473
Number of validation edges: 4608
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9289; val_auprc_score: 0.9066; val_best_acc_score: 0.8668; val_best_f1_score: 0.8759; train_kl_reg_loss: 3576.0059; train_edge_recon_loss: 296261.4379; train_gene_expr_recon_loss: 68342.2709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368179.7161; train_optim_loss: 368179.7161; val_kl_reg_loss: 3996.8003; val_edge_recon_loss: 269660.7561; val_gene_expr_recon_loss: 66458.2046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340115.7604; val_optim_loss: 340115.7604
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9626; val_auprc_score: 0.9385; val_best_acc_score: 0.9198; val_best_f1_score: 0.9232; train_kl_reg_loss: 4104.7820; train_edge_recon_loss: 265789.2900; train_gene_expr_recon_loss: 65941.1526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335835.2259; train_optim_loss: 335835.2259; val_kl_reg_loss: 4218.7501; val_edge_recon_loss: 265170.0503; val_gene_expr_recon_loss: 64319.0929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333707.8924; val_optim_loss: 333707.8924
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9673; val_auprc_score: 0.9496; val_best_acc_score: 0.9224; val_best_f1_score: 0.9253; train_kl_reg_loss: 4092.4097; train_edge_recon_loss: 263538.6002; train_gene_expr_recon_loss: 64752.9108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332383.9222; train_optim_loss: 332383.9222; val_kl_reg_loss: 4045.5457; val_edge_recon_loss: 264653.6398; val_gene_expr_recon_loss: 63775.0412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332474.2309; val_optim_loss: 332474.2309
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9741; val_auprc_score: 0.9605; val_best_acc_score: 0.9344; val_best_f1_score: 0.9368; train_kl_reg_loss: 4108.0969; train_edge_recon_loss: 262055.5382; train_gene_expr_recon_loss: 63777.0997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329940.7341; train_optim_loss: 329940.7341; val_kl_reg_loss: 4165.6775; val_edge_recon_loss: 261896.9271; val_gene_expr_recon_loss: 62840.8628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328903.4670; val_optim_loss: 328903.4670
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9790; val_auprc_score: 0.9659; val_best_acc_score: 0.9446; val_best_f1_score: 0.9463; train_kl_reg_loss: 4140.4201; train_edge_recon_loss: 260416.9374; train_gene_expr_recon_loss: 63229.8510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327787.2080; train_optim_loss: 327787.2080; val_kl_reg_loss: 4109.1459; val_edge_recon_loss: 260087.8090; val_gene_expr_recon_loss: 61906.6126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326103.5660; val_optim_loss: 326103.5660
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9795; val_auprc_score: 0.9704; val_best_acc_score: 0.9516; val_best_f1_score: 0.9529; train_kl_reg_loss: 4117.6748; train_edge_recon_loss: 260005.6312; train_gene_expr_recon_loss: 62228.7402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326352.0462; train_optim_loss: 326352.0462; val_kl_reg_loss: 4146.8406; val_edge_recon_loss: 259316.2821; val_gene_expr_recon_loss: 62034.2472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325497.3646; val_optim_loss: 325497.3646
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9796; val_auprc_score: 0.9676; val_best_acc_score: 0.9485; val_best_f1_score: 0.9503; train_kl_reg_loss: 4123.4129; train_edge_recon_loss: 260174.8641; train_gene_expr_recon_loss: 62026.5231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326324.8020; train_optim_loss: 326324.8020; val_kl_reg_loss: 4188.8935; val_edge_recon_loss: 259579.2578; val_gene_expr_recon_loss: 61613.5315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325381.6840; val_optim_loss: 325381.6840
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9831; val_auprc_score: 0.9730; val_best_acc_score: 0.9553; val_best_f1_score: 0.9563; train_kl_reg_loss: 4098.2512; train_edge_recon_loss: 259829.0368; train_gene_expr_recon_loss: 61362.7666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325290.0552; train_optim_loss: 325290.0552; val_kl_reg_loss: 4132.8543; val_edge_recon_loss: 259287.0069; val_gene_expr_recon_loss: 60771.9230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324191.7847; val_optim_loss: 324191.7847
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9825; val_auprc_score: 0.9712; val_best_acc_score: 0.9556; val_best_f1_score: 0.9569; train_kl_reg_loss: 4130.8947; train_edge_recon_loss: 259876.8155; train_gene_expr_recon_loss: 60942.5215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324950.2308; train_optim_loss: 324950.2308; val_kl_reg_loss: 3978.9092; val_edge_recon_loss: 259252.3516; val_gene_expr_recon_loss: 60490.3160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323721.5781; val_optim_loss: 323721.5781
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9847; val_auprc_score: 0.9736; val_best_acc_score: 0.9589; val_best_f1_score: 0.9600; train_kl_reg_loss: 4082.8554; train_edge_recon_loss: 258807.3873; train_gene_expr_recon_loss: 60745.6676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323635.9116; train_optim_loss: 323635.9116; val_kl_reg_loss: 4237.7901; val_edge_recon_loss: 257799.1424; val_gene_expr_recon_loss: 60023.5451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322060.4844; val_optim_loss: 322060.4844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9858; val_auprc_score: 0.9780; val_best_acc_score: 0.9607; val_best_f1_score: 0.9618; train_kl_reg_loss: 4114.7331; train_edge_recon_loss: 259080.8516; train_gene_expr_recon_loss: 60309.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323504.6137; train_optim_loss: 323504.6137; val_kl_reg_loss: 4186.5554; val_edge_recon_loss: 258257.0677; val_gene_expr_recon_loss: 60060.4286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322504.0521; val_optim_loss: 322504.0521
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9859; val_auprc_score: 0.9780; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 4145.1217; train_edge_recon_loss: 258667.6739; train_gene_expr_recon_loss: 59983.0987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322795.8934; train_optim_loss: 322795.8934; val_kl_reg_loss: 4231.5619; val_edge_recon_loss: 258144.4002; val_gene_expr_recon_loss: 59800.3531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322176.3212; val_optim_loss: 322176.3212
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9754; val_best_acc_score: 0.9622; val_best_f1_score: 0.9633; train_kl_reg_loss: 4123.3931; train_edge_recon_loss: 258193.0134; train_gene_expr_recon_loss: 59807.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322124.2124; train_optim_loss: 322124.2124; val_kl_reg_loss: 4098.9871; val_edge_recon_loss: 258011.5286; val_gene_expr_recon_loss: 59792.0681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321902.5816; val_optim_loss: 321902.5816
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9876; val_auprc_score: 0.9816; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 4121.5956; train_edge_recon_loss: 258823.5597; train_gene_expr_recon_loss: 59782.6001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322727.7552; train_optim_loss: 322727.7552; val_kl_reg_loss: 4003.2626; val_edge_recon_loss: 256990.0938; val_gene_expr_recon_loss: 59145.5184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320138.8767; val_optim_loss: 320138.8767
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9874; val_auprc_score: 0.9778; val_best_acc_score: 0.9667; val_best_f1_score: 0.9676; train_kl_reg_loss: 4113.0513; train_edge_recon_loss: 257561.7983; train_gene_expr_recon_loss: 59428.6346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321103.4818; train_optim_loss: 321103.4818; val_kl_reg_loss: 4074.1007; val_edge_recon_loss: 257341.1970; val_gene_expr_recon_loss: 59244.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320660.2049; val_optim_loss: 320660.2049
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9875; val_auprc_score: 0.9802; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 4135.2459; train_edge_recon_loss: 257696.0792; train_gene_expr_recon_loss: 59279.3010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321110.6254; train_optim_loss: 321110.6254; val_kl_reg_loss: 4128.6402; val_edge_recon_loss: 257258.2326; val_gene_expr_recon_loss: 59138.3461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320525.2222; val_optim_loss: 320525.2222
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9872; val_auprc_score: 0.9807; val_best_acc_score: 0.9643; val_best_f1_score: 0.9652; train_kl_reg_loss: 4127.2306; train_edge_recon_loss: 257659.7244; train_gene_expr_recon_loss: 59027.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320813.9826; train_optim_loss: 320813.9826; val_kl_reg_loss: 4209.8166; val_edge_recon_loss: 257104.9010; val_gene_expr_recon_loss: 58945.1309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320259.8472; val_optim_loss: 320259.8472

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9882; val_auprc_score: 0.9814; val_best_acc_score: 0.9655; val_best_f1_score: 0.9663; train_kl_reg_loss: 4140.5978; train_edge_recon_loss: 257538.7486; train_gene_expr_recon_loss: 58860.6850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320540.0307; train_optim_loss: 320540.0307; val_kl_reg_loss: 4095.0473; val_edge_recon_loss: 257452.5469; val_gene_expr_recon_loss: 58557.6591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320105.2535; val_optim_loss: 320105.2535
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9890; val_auprc_score: 0.9799; val_best_acc_score: 0.9691; val_best_f1_score: 0.9698; train_kl_reg_loss: 4113.0045; train_edge_recon_loss: 256943.4592; train_gene_expr_recon_loss: 58488.9708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319545.4339; train_optim_loss: 319545.4339; val_kl_reg_loss: 4106.1999; val_edge_recon_loss: 256272.3828; val_gene_expr_recon_loss: 58580.0658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318958.6493; val_optim_loss: 318958.6493
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9882; val_auprc_score: 0.9809; val_best_acc_score: 0.9669; val_best_f1_score: 0.9676; train_kl_reg_loss: 4114.2682; train_edge_recon_loss: 257903.4324; train_gene_expr_recon_loss: 58650.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320668.6806; train_optim_loss: 320668.6806; val_kl_reg_loss: 4103.2406; val_edge_recon_loss: 256969.7066; val_gene_expr_recon_loss: 58816.8898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319889.8403; val_optim_loss: 319889.8403
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9886; val_auprc_score: 0.9808; val_best_acc_score: 0.9676; val_best_f1_score: 0.9682; train_kl_reg_loss: 4105.2065; train_edge_recon_loss: 257228.3903; train_gene_expr_recon_loss: 58451.5779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319785.1760; train_optim_loss: 319785.1760; val_kl_reg_loss: 4095.1259; val_edge_recon_loss: 255942.8403; val_gene_expr_recon_loss: 58663.0434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318701.0052; val_optim_loss: 318701.0052
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9874; val_auprc_score: 0.9791; val_best_acc_score: 0.9660; val_best_f1_score: 0.9670; train_kl_reg_loss: 4103.0954; train_edge_recon_loss: 257060.7060; train_gene_expr_recon_loss: 58538.7900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319702.5911; train_optim_loss: 319702.5911; val_kl_reg_loss: 4120.1894; val_edge_recon_loss: 257820.7509; val_gene_expr_recon_loss: 58723.9746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320664.9167; val_optim_loss: 320664.9167
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9877; val_auprc_score: 0.9790; val_best_acc_score: 0.9659; val_best_f1_score: 0.9668; train_kl_reg_loss: 4113.1250; train_edge_recon_loss: 257208.5898; train_gene_expr_recon_loss: 58568.0356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319889.7498; train_optim_loss: 319889.7498; val_kl_reg_loss: 4119.0578; val_edge_recon_loss: 257366.2734; val_gene_expr_recon_loss: 58754.0927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320239.4236; val_optim_loss: 320239.4236
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9889; val_auprc_score: 0.9802; val_best_acc_score: 0.9698; val_best_f1_score: 0.9706; train_kl_reg_loss: 4101.8276; train_edge_recon_loss: 256967.6214; train_gene_expr_recon_loss: 58496.0027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319565.4503; train_optim_loss: 319565.4503; val_kl_reg_loss: 4095.0436; val_edge_recon_loss: 255969.4774; val_gene_expr_recon_loss: 58558.8474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318623.3681; val_optim_loss: 318623.3681
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9884; val_auprc_score: 0.9782; val_best_acc_score: 0.9712; val_best_f1_score: 0.9718; train_kl_reg_loss: 4099.8222; train_edge_recon_loss: 257565.2542; train_gene_expr_recon_loss: 58471.3318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320136.4074; train_optim_loss: 320136.4074; val_kl_reg_loss: 4077.7584; val_edge_recon_loss: 255885.2847; val_gene_expr_recon_loss: 58535.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318498.2361; val_optim_loss: 318498.2361
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9884; val_auprc_score: 0.9809; val_best_acc_score: 0.9679; val_best_f1_score: 0.9687; train_kl_reg_loss: 3918.1093; train_edge_recon_loss: 257552.4873; train_gene_expr_recon_loss: 58589.1963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 320059.7920; train_optim_loss: 320059.7920; val_kl_reg_loss: 3430.7872; val_edge_recon_loss: 256661.4340; val_gene_expr_recon_loss: 58720.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318813.1892; val_optim_loss: 318813.1892
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9891; val_auprc_score: 0.9802; val_best_acc_score: 0.9701; val_best_f1_score: 0.9708; train_kl_reg_loss: 3612.5796; train_edge_recon_loss: 257393.4210; train_gene_expr_recon_loss: 58521.5738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319527.5736; train_optim_loss: 319527.5736; val_kl_reg_loss: 3167.1688; val_edge_recon_loss: 256129.2804; val_gene_expr_recon_loss: 59009.7352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318306.1910; val_optim_loss: 318306.1910
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9892; val_auprc_score: 0.9844; val_best_acc_score: 0.9688; val_best_f1_score: 0.9695; train_kl_reg_loss: 3414.5978; train_edge_recon_loss: 256826.2149; train_gene_expr_recon_loss: 58561.6815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318802.4956; train_optim_loss: 318802.4956; val_kl_reg_loss: 2981.6984; val_edge_recon_loss: 255666.5911; val_gene_expr_recon_loss: 58634.9119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317283.1997; val_optim_loss: 317283.1997
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9875; val_auprc_score: 0.9800; val_best_acc_score: 0.9679; val_best_f1_score: 0.9687; train_kl_reg_loss: 3222.9812; train_edge_recon_loss: 256973.3014; train_gene_expr_recon_loss: 58564.5266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318760.8096; train_optim_loss: 318760.8096; val_kl_reg_loss: 2840.8700; val_edge_recon_loss: 257003.1606; val_gene_expr_recon_loss: 58879.0328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318723.0642; val_optim_loss: 318723.0642
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9888; val_auprc_score: 0.9784; val_best_acc_score: 0.9710; val_best_f1_score: 0.9717; train_kl_reg_loss: 3129.3959; train_edge_recon_loss: 256559.8974; train_gene_expr_recon_loss: 58567.3887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318256.6819; train_optim_loss: 318256.6819; val_kl_reg_loss: 2777.7484; val_edge_recon_loss: 256695.7118; val_gene_expr_recon_loss: 58624.6432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318098.1042; val_optim_loss: 318098.1042
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9899; val_auprc_score: 0.9866; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 3065.4391; train_edge_recon_loss: 256917.9956; train_gene_expr_recon_loss: 58527.1391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318510.5744; train_optim_loss: 318510.5744; val_kl_reg_loss: 2735.4777; val_edge_recon_loss: 256526.1641; val_gene_expr_recon_loss: 58677.2122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317938.8524; val_optim_loss: 317938.8524

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9890; val_auprc_score: 0.9800; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 3040.0220; train_edge_recon_loss: 256434.9536; train_gene_expr_recon_loss: 58568.0792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318043.0529; train_optim_loss: 318043.0529; val_kl_reg_loss: 2743.0238; val_edge_recon_loss: 257112.3915; val_gene_expr_recon_loss: 58759.7862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318615.1997; val_optim_loss: 318615.1997
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9892; val_auprc_score: 0.9822; val_best_acc_score: 0.9681; val_best_f1_score: 0.9688; train_kl_reg_loss: 3044.9985; train_edge_recon_loss: 257447.3353; train_gene_expr_recon_loss: 58471.0281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318963.3606; train_optim_loss: 318963.3606; val_kl_reg_loss: 2745.5853; val_edge_recon_loss: 257627.4557; val_gene_expr_recon_loss: 58521.8950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318894.9375; val_optim_loss: 318894.9375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9875; val_auprc_score: 0.9803; val_best_acc_score: 0.9697; val_best_f1_score: 0.9705; train_kl_reg_loss: 3037.7957; train_edge_recon_loss: 257115.9588; train_gene_expr_recon_loss: 58537.5491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 318691.3037; train_optim_loss: 318691.3037; val_kl_reg_loss: 2736.9622; val_edge_recon_loss: 257313.6250; val_gene_expr_recon_loss: 58679.6048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318730.1910; val_optim_loss: 318730.1910

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 31 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9870
Val AUPRC score: 0.9770
Val best accuracy score: 0.9674
Val best F1 score: 0.9683
Val gene expr MSE score: 0.0094
Duration of model training in run 10: 0 hours, 7 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
