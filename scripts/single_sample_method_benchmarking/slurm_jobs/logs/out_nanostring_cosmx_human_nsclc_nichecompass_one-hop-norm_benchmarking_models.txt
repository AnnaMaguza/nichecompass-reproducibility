First script finished. Launching follow up script.
Run timestamp: 12062023_140601.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '200', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1577.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 175515
Number of validation edges: 19501
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.8494; val_auprc_score: 0.8410; val_best_acc_score: 0.7530; val_best_f1_score: 0.7786; train_kl_reg_loss: 4131.3800; train_edge_recon_loss: 302693.4121; train_gene_expr_recon_loss: 133754.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440579.2071; train_optim_loss: 440579.2071; val_kl_reg_loss: 4445.5494; val_edge_recon_loss: 292933.5812; val_gene_expr_recon_loss: 129900.1812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427279.3063; val_optim_loss: 427279.3063
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9050; val_auprc_score: 0.8863; val_best_acc_score: 0.8287; val_best_f1_score: 0.8402; train_kl_reg_loss: 5011.8925; train_edge_recon_loss: 276408.9789; train_gene_expr_recon_loss: 127613.3029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409034.1722; train_optim_loss: 409034.1722; val_kl_reg_loss: 4970.6699; val_edge_recon_loss: 275013.4500; val_gene_expr_recon_loss: 127688.2937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407672.4125; val_optim_loss: 407672.4125
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9316; val_auprc_score: 0.9163; val_best_acc_score: 0.8639; val_best_f1_score: 0.8703; train_kl_reg_loss: 4974.1437; train_edge_recon_loss: 269048.0305; train_gene_expr_recon_loss: 126461.8632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400484.0363; train_optim_loss: 400484.0363; val_kl_reg_loss: 4804.9140; val_edge_recon_loss: 271464.2188; val_gene_expr_recon_loss: 128372.3813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404641.5125; val_optim_loss: 404641.5125
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9370; val_auprc_score: 0.9235; val_best_acc_score: 0.8701; val_best_f1_score: 0.8776; train_kl_reg_loss: 4931.6879; train_edge_recon_loss: 266040.8176; train_gene_expr_recon_loss: 125987.1225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396959.6286; train_optim_loss: 396959.6286; val_kl_reg_loss: 4597.9103; val_edge_recon_loss: 270125.2250; val_gene_expr_recon_loss: 126574.0984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401297.2313; val_optim_loss: 401297.2313
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9453; val_auprc_score: 0.9316; val_best_acc_score: 0.8833; val_best_f1_score: 0.8893; train_kl_reg_loss: 4772.6495; train_edge_recon_loss: 264917.4404; train_gene_expr_recon_loss: 125345.9855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395036.0756; train_optim_loss: 395036.0756; val_kl_reg_loss: 4691.5495; val_edge_recon_loss: 269253.1688; val_gene_expr_recon_loss: 126316.7047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400261.4250; val_optim_loss: 400261.4250
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9540; val_auprc_score: 0.9431; val_best_acc_score: 0.8915; val_best_f1_score: 0.8963; train_kl_reg_loss: 4753.1390; train_edge_recon_loss: 264009.5723; train_gene_expr_recon_loss: 125076.8341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393839.5436; train_optim_loss: 393839.5436; val_kl_reg_loss: 4639.4109; val_edge_recon_loss: 267958.8312; val_gene_expr_recon_loss: 124998.7531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397596.9938; val_optim_loss: 397596.9938
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9562; val_auprc_score: 0.9470; val_best_acc_score: 0.8945; val_best_f1_score: 0.8994; train_kl_reg_loss: 4712.3654; train_edge_recon_loss: 263466.5680; train_gene_expr_recon_loss: 124783.3785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392962.3110; train_optim_loss: 392962.3110; val_kl_reg_loss: 4523.7611; val_edge_recon_loss: 267989.6875; val_gene_expr_recon_loss: 123778.2516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396291.7125; val_optim_loss: 396291.7125
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9586; val_auprc_score: 0.9488; val_best_acc_score: 0.8992; val_best_f1_score: 0.9027; train_kl_reg_loss: 4653.2089; train_edge_recon_loss: 263149.2653; train_gene_expr_recon_loss: 124360.5149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392162.9935; train_optim_loss: 392162.9935; val_kl_reg_loss: 4495.6509; val_edge_recon_loss: 267632.5687; val_gene_expr_recon_loss: 126451.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398579.6813; val_optim_loss: 398579.6813
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9611; val_auprc_score: 0.9529; val_best_acc_score: 0.9030; val_best_f1_score: 0.9060; train_kl_reg_loss: 4656.2682; train_edge_recon_loss: 262568.0872; train_gene_expr_recon_loss: 124168.1724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391392.5291; train_optim_loss: 391392.5291; val_kl_reg_loss: 4461.1286; val_edge_recon_loss: 267558.1250; val_gene_expr_recon_loss: 124438.5953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396457.8438; val_optim_loss: 396457.8438
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9646; val_auprc_score: 0.9571; val_best_acc_score: 0.9070; val_best_f1_score: 0.9097; train_kl_reg_loss: 4631.6444; train_edge_recon_loss: 262483.0796; train_gene_expr_recon_loss: 123811.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390926.2980; train_optim_loss: 390926.2980; val_kl_reg_loss: 4463.5024; val_edge_recon_loss: 267394.4813; val_gene_expr_recon_loss: 124651.2609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396509.2438; val_optim_loss: 396509.2438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9637; val_auprc_score: 0.9560; val_best_acc_score: 0.9063; val_best_f1_score: 0.9093; train_kl_reg_loss: 4629.6322; train_edge_recon_loss: 262019.7009; train_gene_expr_recon_loss: 123574.2484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390223.5814; train_optim_loss: 390223.5814; val_kl_reg_loss: 4523.2930; val_edge_recon_loss: 267495.2938; val_gene_expr_recon_loss: 125534.5031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397553.0875; val_optim_loss: 397553.0875
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9658; val_auprc_score: 0.9578; val_best_acc_score: 0.9087; val_best_f1_score: 0.9123; train_kl_reg_loss: 4637.6041; train_edge_recon_loss: 262102.6446; train_gene_expr_recon_loss: 123783.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390524.2020; train_optim_loss: 390524.2020; val_kl_reg_loss: 4504.3310; val_edge_recon_loss: 266821.6188; val_gene_expr_recon_loss: 123918.3844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395244.3312; val_optim_loss: 395244.3312
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9656; val_auprc_score: 0.9572; val_best_acc_score: 0.9105; val_best_f1_score: 0.9130; train_kl_reg_loss: 4630.4930; train_edge_recon_loss: 262136.9742; train_gene_expr_recon_loss: 123587.5963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390355.0618; train_optim_loss: 390355.0618; val_kl_reg_loss: 4489.9938; val_edge_recon_loss: 266820.7500; val_gene_expr_recon_loss: 126785.4156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398096.1562; val_optim_loss: 398096.1562
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9661; val_auprc_score: 0.9588; val_best_acc_score: 0.9082; val_best_f1_score: 0.9109; train_kl_reg_loss: 4622.7461; train_edge_recon_loss: 262179.7969; train_gene_expr_recon_loss: 123594.0223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390396.5661; train_optim_loss: 390396.5661; val_kl_reg_loss: 4499.1108; val_edge_recon_loss: 267236.7375; val_gene_expr_recon_loss: 124217.5281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395953.3812; val_optim_loss: 395953.3812
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9662; val_auprc_score: 0.9591; val_best_acc_score: 0.9076; val_best_f1_score: 0.9100; train_kl_reg_loss: 4624.2431; train_edge_recon_loss: 261945.7907; train_gene_expr_recon_loss: 123533.5376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390103.5749; train_optim_loss: 390103.5749; val_kl_reg_loss: 4505.7747; val_edge_recon_loss: 267436.0687; val_gene_expr_recon_loss: 125446.9078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397388.7500; val_optim_loss: 397388.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9663; val_auprc_score: 0.9587; val_best_acc_score: 0.9084; val_best_f1_score: 0.9109; train_kl_reg_loss: 4627.0164; train_edge_recon_loss: 262027.9419; train_gene_expr_recon_loss: 123692.0712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390347.0291; train_optim_loss: 390347.0291; val_kl_reg_loss: 4508.9450; val_edge_recon_loss: 266968.7062; val_gene_expr_recon_loss: 123306.3656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394784.0187; val_optim_loss: 394784.0187
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9654; val_auprc_score: 0.9572; val_best_acc_score: 0.9098; val_best_f1_score: 0.9125; train_kl_reg_loss: 4620.4251; train_edge_recon_loss: 262035.6181; train_gene_expr_recon_loss: 123547.8367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390203.8779; train_optim_loss: 390203.8779; val_kl_reg_loss: 4502.7819; val_edge_recon_loss: 266713.4562; val_gene_expr_recon_loss: 124015.8922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395232.1188; val_optim_loss: 395232.1188
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9666; val_auprc_score: 0.9585; val_best_acc_score: 0.9106; val_best_f1_score: 0.9134; train_kl_reg_loss: 4625.8517; train_edge_recon_loss: 261956.6148; train_gene_expr_recon_loss: 123457.0734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390039.5429; train_optim_loss: 390039.5429; val_kl_reg_loss: 4504.5505; val_edge_recon_loss: 266190.3250; val_gene_expr_recon_loss: 123833.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394527.9000; val_optim_loss: 394527.9000
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9664; val_auprc_score: 0.9581; val_best_acc_score: 0.9109; val_best_f1_score: 0.9138; train_kl_reg_loss: 4621.3912; train_edge_recon_loss: 261859.3932; train_gene_expr_recon_loss: 123618.4117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390099.1977; train_optim_loss: 390099.1977; val_kl_reg_loss: 4501.5700; val_edge_recon_loss: 266298.8688; val_gene_expr_recon_loss: 125113.8687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395914.3125; val_optim_loss: 395914.3125
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9663; val_auprc_score: 0.9592; val_best_acc_score: 0.9093; val_best_f1_score: 0.9117; train_kl_reg_loss: 4620.3046; train_edge_recon_loss: 262025.6057; train_gene_expr_recon_loss: 123495.7714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390141.6831; train_optim_loss: 390141.6831; val_kl_reg_loss: 4496.5432; val_edge_recon_loss: 266819.8937; val_gene_expr_recon_loss: 124298.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395614.5000; val_optim_loss: 395614.5000
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9650; val_auprc_score: 0.9577; val_best_acc_score: 0.9073; val_best_f1_score: 0.9103; train_kl_reg_loss: 4619.5190; train_edge_recon_loss: 261877.8819; train_gene_expr_recon_loss: 123616.2691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390113.6708; train_optim_loss: 390113.6708; val_kl_reg_loss: 4500.8123; val_edge_recon_loss: 267447.9000; val_gene_expr_recon_loss: 124895.5922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396844.3000; val_optim_loss: 396844.3000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9650; val_auprc_score: 0.9568; val_best_acc_score: 0.9083; val_best_f1_score: 0.9114; train_kl_reg_loss: 4618.3585; train_edge_recon_loss: 261818.5828; train_gene_expr_recon_loss: 123475.7562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389912.6940; train_optim_loss: 389912.6940; val_kl_reg_loss: 4498.6503; val_edge_recon_loss: 267173.8875; val_gene_expr_recon_loss: 126250.9797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397923.5312; val_optim_loss: 397923.5312
Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9663; val_auprc_score: 0.9589; val_best_acc_score: 0.9087; val_best_f1_score: 0.9117; train_kl_reg_loss: 4618.8854; train_edge_recon_loss: 261987.7336; train_gene_expr_recon_loss: 123482.6530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390089.2747; train_optim_loss: 390089.2747; val_kl_reg_loss: 4500.8596; val_edge_recon_loss: 266584.4750; val_gene_expr_recon_loss: 123447.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394533.1937; val_optim_loss: 394533.1937
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9674; val_auprc_score: 0.9609; val_best_acc_score: 0.9104; val_best_f1_score: 0.9131; train_kl_reg_loss: 4617.9698; train_edge_recon_loss: 261931.4121; train_gene_expr_recon_loss: 123434.7525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389984.1344; train_optim_loss: 389984.1344; val_kl_reg_loss: 4490.1192; val_edge_recon_loss: 266576.1312; val_gene_expr_recon_loss: 123358.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394425.1000; val_optim_loss: 394425.1000
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9652; val_auprc_score: 0.9570; val_best_acc_score: 0.9079; val_best_f1_score: 0.9112; train_kl_reg_loss: 4619.2571; train_edge_recon_loss: 261922.5494; train_gene_expr_recon_loss: 123283.6699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389825.4760; train_optim_loss: 389825.4760; val_kl_reg_loss: 4498.3661; val_edge_recon_loss: 267551.0750; val_gene_expr_recon_loss: 124063.9438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396113.3812; val_optim_loss: 396113.3812
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9657; val_auprc_score: 0.9576; val_best_acc_score: 0.9090; val_best_f1_score: 0.9119; train_kl_reg_loss: 4616.5697; train_edge_recon_loss: 262073.2376; train_gene_expr_recon_loss: 123516.0536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390205.8641; train_optim_loss: 390205.8641; val_kl_reg_loss: 4415.3489; val_edge_recon_loss: 267339.0312; val_gene_expr_recon_loss: 123380.9344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395135.3187; val_optim_loss: 395135.3187
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9660; val_auprc_score: 0.9580; val_best_acc_score: 0.9089; val_best_f1_score: 0.9113; train_kl_reg_loss: 4612.9499; train_edge_recon_loss: 261888.9618; train_gene_expr_recon_loss: 123505.4057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390007.3212; train_optim_loss: 390007.3212; val_kl_reg_loss: 4418.8055; val_edge_recon_loss: 266771.3063; val_gene_expr_recon_loss: 124732.3453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395922.4562; val_optim_loss: 395922.4562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9653; val_auprc_score: 0.9584; val_best_acc_score: 0.9079; val_best_f1_score: 0.9107; train_kl_reg_loss: 4609.9072; train_edge_recon_loss: 261889.1675; train_gene_expr_recon_loss: 123385.7456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389884.8205; train_optim_loss: 389884.8205; val_kl_reg_loss: 4412.2747; val_edge_recon_loss: 267416.3500; val_gene_expr_recon_loss: 124930.8344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396759.4625; val_optim_loss: 396759.4625
Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9658; val_auprc_score: 0.9581; val_best_acc_score: 0.9086; val_best_f1_score: 0.9115; train_kl_reg_loss: 4609.2829; train_edge_recon_loss: 261914.0229; train_gene_expr_recon_loss: 123428.7078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389952.0109; train_optim_loss: 389952.0109; val_kl_reg_loss: 4417.1860; val_edge_recon_loss: 267202.5000; val_gene_expr_recon_loss: 124562.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396182.0187; val_optim_loss: 396182.0187
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9658; val_auprc_score: 0.9588; val_best_acc_score: 0.9095; val_best_f1_score: 0.9121; train_kl_reg_loss: 4608.4869; train_edge_recon_loss: 262006.4985; train_gene_expr_recon_loss: 123397.1930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390012.1795; train_optim_loss: 390012.1795; val_kl_reg_loss: 4411.2950; val_edge_recon_loss: 266913.3937; val_gene_expr_recon_loss: 123113.5453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394438.2375; val_optim_loss: 394438.2375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 0 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9658
Val AUPRC score: 0.9580
Val best accuracy score: 0.9093
Val best F1 score: 0.9124
Val gene expr MSE score: 0.3928
Duration of model training in run 1: 0 hours, 9 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 175515
Number of validation edges: 19501
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.8475; val_auprc_score: 0.8426; val_best_acc_score: 0.7577; val_best_f1_score: 0.7721; train_kl_reg_loss: 4251.6337; train_edge_recon_loss: 303156.5654; train_gene_expr_recon_loss: 133683.3532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441091.5501; train_optim_loss: 441091.5501; val_kl_reg_loss: 3870.8908; val_edge_recon_loss: 296655.5312; val_gene_expr_recon_loss: 131048.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431575.3812; val_optim_loss: 431575.3812
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9025; val_auprc_score: 0.8815; val_best_acc_score: 0.8293; val_best_f1_score: 0.8419; train_kl_reg_loss: 4862.5729; train_edge_recon_loss: 277581.6337; train_gene_expr_recon_loss: 127903.0878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410347.2929; train_optim_loss: 410347.2929; val_kl_reg_loss: 4820.2747; val_edge_recon_loss: 275505.3187; val_gene_expr_recon_loss: 128448.4984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408774.1063; val_optim_loss: 408774.1063
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9283; val_auprc_score: 0.9137; val_best_acc_score: 0.8604; val_best_f1_score: 0.8663; train_kl_reg_loss: 4971.8966; train_edge_recon_loss: 268906.3670; train_gene_expr_recon_loss: 126839.2782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400717.5458; train_optim_loss: 400717.5458; val_kl_reg_loss: 4842.4289; val_edge_recon_loss: 271913.4000; val_gene_expr_recon_loss: 127044.5031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403800.3250; val_optim_loss: 403800.3250
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9393; val_auprc_score: 0.9254; val_best_acc_score: 0.8739; val_best_f1_score: 0.8798; train_kl_reg_loss: 4852.1941; train_edge_recon_loss: 266217.8496; train_gene_expr_recon_loss: 126131.4477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397201.4920; train_optim_loss: 397201.4920; val_kl_reg_loss: 4765.0864; val_edge_recon_loss: 270278.8312; val_gene_expr_recon_loss: 126947.9078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401991.8312; val_optim_loss: 401991.8312
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9470; val_auprc_score: 0.9361; val_best_acc_score: 0.8825; val_best_f1_score: 0.8886; train_kl_reg_loss: 4781.0870; train_edge_recon_loss: 264773.8801; train_gene_expr_recon_loss: 125600.9035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395155.8706; train_optim_loss: 395155.8706; val_kl_reg_loss: 4687.9189; val_edge_recon_loss: 269059.1188; val_gene_expr_recon_loss: 126127.4156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399874.4625; val_optim_loss: 399874.4625
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9543; val_auprc_score: 0.9457; val_best_acc_score: 0.8918; val_best_f1_score: 0.8969; train_kl_reg_loss: 4730.4200; train_edge_recon_loss: 263739.0945; train_gene_expr_recon_loss: 125437.5739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393907.0908; train_optim_loss: 393907.0908; val_kl_reg_loss: 4570.3956; val_edge_recon_loss: 268273.3438; val_gene_expr_recon_loss: 124539.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397383.2562; val_optim_loss: 397383.2562
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9570; val_auprc_score: 0.9482; val_best_acc_score: 0.8969; val_best_f1_score: 0.9011; train_kl_reg_loss: 4686.3361; train_edge_recon_loss: 263348.9651; train_gene_expr_recon_loss: 124861.4130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392896.7115; train_optim_loss: 392896.7115; val_kl_reg_loss: 4568.0814; val_edge_recon_loss: 267908.1625; val_gene_expr_recon_loss: 124851.4031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397327.6375; val_optim_loss: 397327.6375
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9595; val_auprc_score: 0.9506; val_best_acc_score: 0.9004; val_best_f1_score: 0.9041; train_kl_reg_loss: 4664.9595; train_edge_recon_loss: 262856.2951; train_gene_expr_recon_loss: 124531.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392052.2783; train_optim_loss: 392052.2783; val_kl_reg_loss: 4525.2047; val_edge_recon_loss: 267798.6000; val_gene_expr_recon_loss: 125668.7203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397992.5187; val_optim_loss: 397992.5187
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9613; val_auprc_score: 0.9530; val_best_acc_score: 0.9024; val_best_f1_score: 0.9065; train_kl_reg_loss: 4637.8087; train_edge_recon_loss: 262596.8459; train_gene_expr_recon_loss: 124426.0331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391660.6853; train_optim_loss: 391660.6853; val_kl_reg_loss: 4494.5626; val_edge_recon_loss: 268439.8187; val_gene_expr_recon_loss: 123492.4344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396426.8125; val_optim_loss: 396426.8125
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9641; val_auprc_score: 0.9575; val_best_acc_score: 0.9045; val_best_f1_score: 0.9076; train_kl_reg_loss: 4618.9632; train_edge_recon_loss: 262456.7733; train_gene_expr_recon_loss: 124288.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391364.3496; train_optim_loss: 391364.3496; val_kl_reg_loss: 4616.1411; val_edge_recon_loss: 267356.4062; val_gene_expr_recon_loss: 125400.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397373.2875; val_optim_loss: 397373.2875
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9668; val_auprc_score: 0.9600; val_best_acc_score: 0.9099; val_best_f1_score: 0.9130; train_kl_reg_loss: 4631.6284; train_edge_recon_loss: 261945.4978; train_gene_expr_recon_loss: 123889.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390467.0138; train_optim_loss: 390467.0138; val_kl_reg_loss: 4557.0094; val_edge_recon_loss: 266587.7687; val_gene_expr_recon_loss: 124970.3484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396115.1250; val_optim_loss: 396115.1250
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9667; val_auprc_score: 0.9599; val_best_acc_score: 0.9099; val_best_f1_score: 0.9131; train_kl_reg_loss: 4600.9588; train_edge_recon_loss: 261909.0843; train_gene_expr_recon_loss: 123755.5983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390265.6432; train_optim_loss: 390265.6432; val_kl_reg_loss: 4462.1175; val_edge_recon_loss: 267184.9250; val_gene_expr_recon_loss: 123917.3938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395564.4437; val_optim_loss: 395564.4437
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9679; val_auprc_score: 0.9613; val_best_acc_score: 0.9122; val_best_f1_score: 0.9141; train_kl_reg_loss: 4597.4988; train_edge_recon_loss: 261883.4655; train_gene_expr_recon_loss: 123519.4508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390000.4172; train_optim_loss: 390000.4172; val_kl_reg_loss: 4525.7810; val_edge_recon_loss: 267182.8187; val_gene_expr_recon_loss: 124151.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395859.9250; val_optim_loss: 395859.9250
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9683; val_auprc_score: 0.9617; val_best_acc_score: 0.9136; val_best_f1_score: 0.9161; train_kl_reg_loss: 4584.6005; train_edge_recon_loss: 261858.5796; train_gene_expr_recon_loss: 123398.6239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389841.8031; train_optim_loss: 389841.8031; val_kl_reg_loss: 4513.1603; val_edge_recon_loss: 267717.3500; val_gene_expr_recon_loss: 125848.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398078.7938; val_optim_loss: 398078.7938
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9702; val_auprc_score: 0.9640; val_best_acc_score: 0.9171; val_best_f1_score: 0.9195; train_kl_reg_loss: 4590.4792; train_edge_recon_loss: 261535.4248; train_gene_expr_recon_loss: 123210.3581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389336.2587; train_optim_loss: 389336.2587; val_kl_reg_loss: 4515.2596; val_edge_recon_loss: 266520.6562; val_gene_expr_recon_loss: 124520.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395556.6188; val_optim_loss: 395556.6188
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9721; val_auprc_score: 0.9670; val_best_acc_score: 0.9189; val_best_f1_score: 0.9210; train_kl_reg_loss: 4574.6740; train_edge_recon_loss: 261438.5996; train_gene_expr_recon_loss: 122942.7048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388955.9804; train_optim_loss: 388955.9804; val_kl_reg_loss: 4457.6202; val_edge_recon_loss: 266167.3500; val_gene_expr_recon_loss: 123482.5453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394107.5062; val_optim_loss: 394107.5062
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9717; val_auprc_score: 0.9651; val_best_acc_score: 0.9194; val_best_f1_score: 0.9215; train_kl_reg_loss: 4570.9465; train_edge_recon_loss: 261443.5956; train_gene_expr_recon_loss: 123043.2729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389057.8169; train_optim_loss: 389057.8169; val_kl_reg_loss: 4544.0383; val_edge_recon_loss: 266367.8812; val_gene_expr_recon_loss: 122914.8797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393826.7938; val_optim_loss: 393826.7938
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9712; val_auprc_score: 0.9647; val_best_acc_score: 0.9198; val_best_f1_score: 0.9213; train_kl_reg_loss: 4571.3071; train_edge_recon_loss: 261355.2315; train_gene_expr_recon_loss: 122638.9041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388565.4440; train_optim_loss: 388565.4440; val_kl_reg_loss: 4448.3352; val_edge_recon_loss: 266393.7188; val_gene_expr_recon_loss: 124442.2641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395284.3312; val_optim_loss: 395284.3312
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9730; val_auprc_score: 0.9667; val_best_acc_score: 0.9218; val_best_f1_score: 0.9242; train_kl_reg_loss: 4557.4665; train_edge_recon_loss: 261300.9746; train_gene_expr_recon_loss: 122451.6086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388310.0472; train_optim_loss: 388310.0472; val_kl_reg_loss: 4438.5485; val_edge_recon_loss: 266088.3312; val_gene_expr_recon_loss: 122173.0219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392699.8937; val_optim_loss: 392699.8937
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9723; val_auprc_score: 0.9657; val_best_acc_score: 0.9229; val_best_f1_score: 0.9243; train_kl_reg_loss: 4563.5477; train_edge_recon_loss: 260931.3605; train_gene_expr_recon_loss: 122554.1036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388049.0116; train_optim_loss: 388049.0116; val_kl_reg_loss: 4418.0375; val_edge_recon_loss: 267105.6250; val_gene_expr_recon_loss: 122551.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394075.0563; val_optim_loss: 394075.0563
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9725; val_auprc_score: 0.9666; val_best_acc_score: 0.9224; val_best_f1_score: 0.9245; train_kl_reg_loss: 4563.8150; train_edge_recon_loss: 261118.8986; train_gene_expr_recon_loss: 122316.8863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387999.5988; train_optim_loss: 387999.5988; val_kl_reg_loss: 4446.1404; val_edge_recon_loss: 266638.1312; val_gene_expr_recon_loss: 122833.5453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393917.8187; val_optim_loss: 393917.8187
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9741; val_auprc_score: 0.9682; val_best_acc_score: 0.9249; val_best_f1_score: 0.9268; train_kl_reg_loss: 4563.6080; train_edge_recon_loss: 260958.9295; train_gene_expr_recon_loss: 122189.3881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387711.9222; train_optim_loss: 387711.9222; val_kl_reg_loss: 4471.0509; val_edge_recon_loss: 265864.3187; val_gene_expr_recon_loss: 122697.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393032.6437; val_optim_loss: 393032.6437

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9742; val_auprc_score: 0.9690; val_best_acc_score: 0.9243; val_best_f1_score: 0.9261; train_kl_reg_loss: 4558.0306; train_edge_recon_loss: 260766.5988; train_gene_expr_recon_loss: 121947.7900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387272.4186; train_optim_loss: 387272.4186; val_kl_reg_loss: 4468.7134; val_edge_recon_loss: 266451.6625; val_gene_expr_recon_loss: 121538.0906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392458.4625; val_optim_loss: 392458.4625
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9749; val_auprc_score: 0.9684; val_best_acc_score: 0.9276; val_best_f1_score: 0.9297; train_kl_reg_loss: 4560.4434; train_edge_recon_loss: 260692.8394; train_gene_expr_recon_loss: 121928.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387182.2638; train_optim_loss: 387182.2638; val_kl_reg_loss: 4447.4696; val_edge_recon_loss: 265321.4250; val_gene_expr_recon_loss: 122734.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392503.2188; val_optim_loss: 392503.2188
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9749; val_auprc_score: 0.9687; val_best_acc_score: 0.9271; val_best_f1_score: 0.9287; train_kl_reg_loss: 4556.0851; train_edge_recon_loss: 260806.2580; train_gene_expr_recon_loss: 122026.0665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387388.4113; train_optim_loss: 387388.4113; val_kl_reg_loss: 4475.8410; val_edge_recon_loss: 265574.7000; val_gene_expr_recon_loss: 121510.2922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391560.8312; val_optim_loss: 391560.8312
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9741; val_auprc_score: 0.9674; val_best_acc_score: 0.9248; val_best_f1_score: 0.9268; train_kl_reg_loss: 4443.6216; train_edge_recon_loss: 260603.1192; train_gene_expr_recon_loss: 121947.5025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386994.2391; train_optim_loss: 386994.2391; val_kl_reg_loss: 4116.9813; val_edge_recon_loss: 266113.3375; val_gene_expr_recon_loss: 122207.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392438.1562; val_optim_loss: 392438.1562
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9764; val_auprc_score: 0.9716; val_best_acc_score: 0.9288; val_best_f1_score: 0.9304; train_kl_reg_loss: 4242.2950; train_edge_recon_loss: 260619.6348; train_gene_expr_recon_loss: 121802.6052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386664.5356; train_optim_loss: 386664.5356; val_kl_reg_loss: 3973.0997; val_edge_recon_loss: 265074.0563; val_gene_expr_recon_loss: 122952.8719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392000.0250; val_optim_loss: 392000.0250
Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9758; val_auprc_score: 0.9699; val_best_acc_score: 0.9273; val_best_f1_score: 0.9291; train_kl_reg_loss: 4190.5375; train_edge_recon_loss: 260669.0836; train_gene_expr_recon_loss: 121894.6210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386754.2398; train_optim_loss: 386754.2398; val_kl_reg_loss: 3981.4541; val_edge_recon_loss: 265349.6000; val_gene_expr_recon_loss: 122789.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392120.5625; val_optim_loss: 392120.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9742; val_auprc_score: 0.9681; val_best_acc_score: 0.9244; val_best_f1_score: 0.9264; train_kl_reg_loss: 4172.5737; train_edge_recon_loss: 260444.5273; train_gene_expr_recon_loss: 121977.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386594.9738; train_optim_loss: 386594.9738; val_kl_reg_loss: 3974.1809; val_edge_recon_loss: 266394.0125; val_gene_expr_recon_loss: 122431.9234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392800.1063; val_optim_loss: 392800.1063
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9750; val_auprc_score: 0.9692; val_best_acc_score: 0.9266; val_best_f1_score: 0.9288; train_kl_reg_loss: 4177.9803; train_edge_recon_loss: 260588.4582; train_gene_expr_recon_loss: 121699.7956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386466.2340; train_optim_loss: 386466.2340; val_kl_reg_loss: 3977.7917; val_edge_recon_loss: 265797.7062; val_gene_expr_recon_loss: 123208.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392984.1312; val_optim_loss: 392984.1312
Epoch 31/200 |███-----------------| 15.5% val_auroc_score: 0.9731; val_auprc_score: 0.9664; val_best_acc_score: 0.9242; val_best_f1_score: 0.9261; train_kl_reg_loss: 4180.5458; train_edge_recon_loss: 260593.0076; train_gene_expr_recon_loss: 121852.5029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386626.0574; train_optim_loss: 386626.0574; val_kl_reg_loss: 3978.0001; val_edge_recon_loss: 266758.7938; val_gene_expr_recon_loss: 122982.4969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393719.2938; val_optim_loss: 393719.2938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 5 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9740
Val AUPRC score: 0.9671
Val best accuracy score: 0.9245
Val best F1 score: 0.9266
Val gene expr MSE score: 0.3706
Duration of model training in run 2: 0 hours, 9 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 338764
Number of validation edges: 37640
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9511; val_auprc_score: 0.9403; val_best_acc_score: 0.8865; val_best_f1_score: 0.8909; train_kl_reg_loss: 4608.8606; train_edge_recon_loss: 281679.6777; train_gene_expr_recon_loss: 129171.4619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415460.0008; train_optim_loss: 415460.0008; val_kl_reg_loss: 4834.1769; val_edge_recon_loss: 267448.8602; val_gene_expr_recon_loss: 127405.5136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399688.5461; val_optim_loss: 399688.5461
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9683; val_auprc_score: 0.9620; val_best_acc_score: 0.9114; val_best_f1_score: 0.9146; train_kl_reg_loss: 4758.7525; train_edge_recon_loss: 264607.8088; train_gene_expr_recon_loss: 126033.9158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395400.4770; train_optim_loss: 395400.4770; val_kl_reg_loss: 4698.4199; val_edge_recon_loss: 264478.5929; val_gene_expr_recon_loss: 125140.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394317.7105; val_optim_loss: 394317.7105
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9767; val_auprc_score: 0.9717; val_best_acc_score: 0.9271; val_best_f1_score: 0.9287; train_kl_reg_loss: 4634.0467; train_edge_recon_loss: 262879.8805; train_gene_expr_recon_loss: 124973.0304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392486.9575; train_optim_loss: 392486.9575; val_kl_reg_loss: 4626.7935; val_edge_recon_loss: 263847.4087; val_gene_expr_recon_loss: 124820.7644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393294.9622; val_optim_loss: 393294.9622
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9794; val_auprc_score: 0.9740; val_best_acc_score: 0.9343; val_best_f1_score: 0.9361; train_kl_reg_loss: 4605.8375; train_edge_recon_loss: 261923.3751; train_gene_expr_recon_loss: 124498.3898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391027.6009; train_optim_loss: 391027.6009; val_kl_reg_loss: 4485.0377; val_edge_recon_loss: 262401.4507; val_gene_expr_recon_loss: 124402.2755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391288.7632; val_optim_loss: 391288.7632
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9827; val_auprc_score: 0.9788; val_best_acc_score: 0.9394; val_best_f1_score: 0.9406; train_kl_reg_loss: 4599.8948; train_edge_recon_loss: 261434.1436; train_gene_expr_recon_loss: 123753.5248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389787.5631; train_optim_loss: 389787.5631; val_kl_reg_loss: 4515.0221; val_edge_recon_loss: 262302.1135; val_gene_expr_recon_loss: 123184.5851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390001.7237; val_optim_loss: 390001.7237
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9846; val_auprc_score: 0.9810; val_best_acc_score: 0.9445; val_best_f1_score: 0.9458; train_kl_reg_loss: 4587.5631; train_edge_recon_loss: 260997.2047; train_gene_expr_recon_loss: 123363.4266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388948.1943; train_optim_loss: 388948.1943; val_kl_reg_loss: 4466.4865; val_edge_recon_loss: 261814.3322; val_gene_expr_recon_loss: 123450.5543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389731.3717; val_optim_loss: 389731.3717
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9864; val_auprc_score: 0.9833; val_best_acc_score: 0.9487; val_best_f1_score: 0.9496; train_kl_reg_loss: 4583.1849; train_edge_recon_loss: 260543.2139; train_gene_expr_recon_loss: 122952.4495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388078.8486; train_optim_loss: 388078.8486; val_kl_reg_loss: 4455.4325; val_edge_recon_loss: 261880.0822; val_gene_expr_recon_loss: 122679.1850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389014.7056; val_optim_loss: 389014.7056
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9876; val_auprc_score: 0.9841; val_best_acc_score: 0.9517; val_best_f1_score: 0.9525; train_kl_reg_loss: 4568.6523; train_edge_recon_loss: 260405.9079; train_gene_expr_recon_loss: 122801.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387776.1581; train_optim_loss: 387776.1581; val_kl_reg_loss: 4451.6650; val_edge_recon_loss: 261307.0058; val_gene_expr_recon_loss: 122993.9083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388752.5757; val_optim_loss: 388752.5757
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9879; val_auprc_score: 0.9847; val_best_acc_score: 0.9539; val_best_f1_score: 0.9548; train_kl_reg_loss: 4566.2589; train_edge_recon_loss: 260100.9628; train_gene_expr_recon_loss: 122443.3450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387110.5685; train_optim_loss: 387110.5685; val_kl_reg_loss: 4404.6392; val_edge_recon_loss: 260792.3413; val_gene_expr_recon_loss: 122257.4881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387454.4671; val_optim_loss: 387454.4671
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9884; val_auprc_score: 0.9855; val_best_acc_score: 0.9546; val_best_f1_score: 0.9555; train_kl_reg_loss: 4559.2908; train_edge_recon_loss: 259994.8734; train_gene_expr_recon_loss: 122229.6966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386783.8588; train_optim_loss: 386783.8588; val_kl_reg_loss: 4453.9041; val_edge_recon_loss: 261138.9942; val_gene_expr_recon_loss: 122151.1879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387744.0855; val_optim_loss: 387744.0855
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9894; val_auprc_score: 0.9864; val_best_acc_score: 0.9581; val_best_f1_score: 0.9587; train_kl_reg_loss: 4556.6462; train_edge_recon_loss: 259777.6366; train_gene_expr_recon_loss: 121988.6496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386322.9319; train_optim_loss: 386322.9319; val_kl_reg_loss: 4522.2444; val_edge_recon_loss: 260673.0477; val_gene_expr_recon_loss: 122151.3512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387346.6414; val_optim_loss: 387346.6414
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9582; val_best_f1_score: 0.9588; train_kl_reg_loss: 4556.6340; train_edge_recon_loss: 259562.3980; train_gene_expr_recon_loss: 121899.7897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386018.8213; train_optim_loss: 386018.8213; val_kl_reg_loss: 4458.0013; val_edge_recon_loss: 260493.0181; val_gene_expr_recon_loss: 121812.8433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386763.8618; val_optim_loss: 386763.8618
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9911; val_auprc_score: 0.9888; val_best_acc_score: 0.9618; val_best_f1_score: 0.9625; train_kl_reg_loss: 4555.1298; train_edge_recon_loss: 259432.4749; train_gene_expr_recon_loss: 121611.2890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385598.8948; train_optim_loss: 385598.8948; val_kl_reg_loss: 4514.9023; val_edge_recon_loss: 260373.7747; val_gene_expr_recon_loss: 121866.8302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386755.5082; val_optim_loss: 386755.5082
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 4557.2080; train_edge_recon_loss: 259236.6643; train_gene_expr_recon_loss: 121673.3658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385467.2383; train_optim_loss: 385467.2383; val_kl_reg_loss: 4455.1570; val_edge_recon_loss: 260626.0896; val_gene_expr_recon_loss: 121639.6649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386720.9112; val_optim_loss: 386720.9112
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9918; val_auprc_score: 0.9894; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 4551.6609; train_edge_recon_loss: 259166.4598; train_gene_expr_recon_loss: 121399.0427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385117.1643; train_optim_loss: 385117.1643; val_kl_reg_loss: 4425.3323; val_edge_recon_loss: 259997.0419; val_gene_expr_recon_loss: 121649.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386071.7961; val_optim_loss: 386071.7961
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9916; val_auprc_score: 0.9894; val_best_acc_score: 0.9643; val_best_f1_score: 0.9648; train_kl_reg_loss: 4553.5317; train_edge_recon_loss: 258980.0209; train_gene_expr_recon_loss: 121276.6314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384810.1852; train_optim_loss: 384810.1852; val_kl_reg_loss: 4500.8786; val_edge_recon_loss: 259343.7089; val_gene_expr_recon_loss: 121183.6221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385028.2105; val_optim_loss: 385028.2105
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9658; val_best_f1_score: 0.9663; train_kl_reg_loss: 4550.8071; train_edge_recon_loss: 258923.1115; train_gene_expr_recon_loss: 121205.4706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384679.3891; train_optim_loss: 384679.3891; val_kl_reg_loss: 4479.3629; val_edge_recon_loss: 260132.6275; val_gene_expr_recon_loss: 121182.2475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385794.2401; val_optim_loss: 385794.2401
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9923; val_auprc_score: 0.9900; val_best_acc_score: 0.9669; val_best_f1_score: 0.9673; train_kl_reg_loss: 4554.8649; train_edge_recon_loss: 258784.1558; train_gene_expr_recon_loss: 121224.7186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384563.7396; train_optim_loss: 384563.7396; val_kl_reg_loss: 4531.5705; val_edge_recon_loss: 259675.8117; val_gene_expr_recon_loss: 121285.0448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385492.4276; val_optim_loss: 385492.4276
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9933; val_auprc_score: 0.9914; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 4554.9407; train_edge_recon_loss: 258762.7857; train_gene_expr_recon_loss: 120955.2336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384272.9610; train_optim_loss: 384272.9610; val_kl_reg_loss: 4478.6881; val_edge_recon_loss: 259558.6620; val_gene_expr_recon_loss: 121453.5555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385490.9062; val_optim_loss: 385490.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9928; val_auprc_score: 0.9907; val_best_acc_score: 0.9691; val_best_f1_score: 0.9694; train_kl_reg_loss: 4550.8639; train_edge_recon_loss: 258400.9306; train_gene_expr_recon_loss: 120713.0853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383664.8803; train_optim_loss: 383664.8803; val_kl_reg_loss: 4506.0978; val_edge_recon_loss: 259210.4992; val_gene_expr_recon_loss: 121120.0892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384836.6842; val_optim_loss: 384836.6842
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9936; val_auprc_score: 0.9920; val_best_acc_score: 0.9704; val_best_f1_score: 0.9708; train_kl_reg_loss: 4538.5128; train_edge_recon_loss: 258565.4097; train_gene_expr_recon_loss: 120621.3569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383725.2799; train_optim_loss: 383725.2799; val_kl_reg_loss: 4486.0722; val_edge_recon_loss: 258923.9391; val_gene_expr_recon_loss: 121243.9215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384653.9326; val_optim_loss: 384653.9326
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 4540.6927; train_edge_recon_loss: 258491.8636; train_gene_expr_recon_loss: 120620.5298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383653.0870; train_optim_loss: 383653.0870; val_kl_reg_loss: 4473.8166; val_edge_recon_loss: 259145.3676; val_gene_expr_recon_loss: 120380.4260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383999.6102; val_optim_loss: 383999.6102
Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9934; val_auprc_score: 0.9916; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 4541.8129; train_edge_recon_loss: 258276.5737; train_gene_expr_recon_loss: 120681.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383499.7491; train_optim_loss: 383499.7491; val_kl_reg_loss: 4483.0622; val_edge_recon_loss: 259181.9342; val_gene_expr_recon_loss: 120504.0177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384169.0132; val_optim_loss: 384169.0132
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9937; val_auprc_score: 0.9917; val_best_acc_score: 0.9709; val_best_f1_score: 0.9713; train_kl_reg_loss: 4533.9108; train_edge_recon_loss: 258391.3309; train_gene_expr_recon_loss: 120593.7626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383519.0024; train_optim_loss: 383519.0024; val_kl_reg_loss: 4460.9117; val_edge_recon_loss: 259035.5493; val_gene_expr_recon_loss: 120621.1550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384117.6151; val_optim_loss: 384117.6151
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9705; val_best_f1_score: 0.9709; train_kl_reg_loss: 4540.2281; train_edge_recon_loss: 258174.1114; train_gene_expr_recon_loss: 120604.7956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383319.1350; train_optim_loss: 383319.1350; val_kl_reg_loss: 4458.4166; val_edge_recon_loss: 259061.2286; val_gene_expr_recon_loss: 120272.0954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383791.7434; val_optim_loss: 383791.7434
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 4125.8469; train_edge_recon_loss: 258133.3099; train_gene_expr_recon_loss: 120686.1181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382945.2760; train_optim_loss: 382945.2760; val_kl_reg_loss: 3720.9988; val_edge_recon_loss: 259369.0074; val_gene_expr_recon_loss: 120560.8914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383650.8980; val_optim_loss: 383650.8980
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 3959.5151; train_edge_recon_loss: 258191.1012; train_gene_expr_recon_loss: 120592.1353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382742.7523; train_optim_loss: 382742.7523; val_kl_reg_loss: 3710.9637; val_edge_recon_loss: 258577.8651; val_gene_expr_recon_loss: 120660.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382948.9671; val_optim_loss: 382948.9671
Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9719; val_best_f1_score: 0.9722; train_kl_reg_loss: 3935.3282; train_edge_recon_loss: 258072.5702; train_gene_expr_recon_loss: 120591.4791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382599.3786; train_optim_loss: 382599.3786; val_kl_reg_loss: 3709.7320; val_edge_recon_loss: 258809.8281; val_gene_expr_recon_loss: 120543.5559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383063.1168; val_optim_loss: 383063.1168
Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 3914.1543; train_edge_recon_loss: 258223.5329; train_gene_expr_recon_loss: 120576.6176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382714.3038; train_optim_loss: 382714.3038; val_kl_reg_loss: 3704.2985; val_edge_recon_loss: 259478.7368; val_gene_expr_recon_loss: 120940.4260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384123.4589; val_optim_loss: 384123.4589
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9936; val_auprc_score: 0.9919; val_best_acc_score: 0.9714; val_best_f1_score: 0.9718; train_kl_reg_loss: 3892.5549; train_edge_recon_loss: 258019.4666; train_gene_expr_recon_loss: 120566.3377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382478.3582; train_optim_loss: 382478.3582; val_kl_reg_loss: 3677.5747; val_edge_recon_loss: 258929.1653; val_gene_expr_recon_loss: 120874.3092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383481.0510; val_optim_loss: 383481.0510

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/200 |███-----------------| 15.5% val_auroc_score: 0.9935; val_auprc_score: 0.9914; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 3879.9483; train_edge_recon_loss: 258076.3018; train_gene_expr_recon_loss: 120598.3880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382554.6395; train_optim_loss: 382554.6395; val_kl_reg_loss: 3689.2386; val_edge_recon_loss: 259161.8495; val_gene_expr_recon_loss: 121174.4124; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384025.4984; val_optim_loss: 384025.4984
Epoch 32/200 |███-----------------| 16.0% val_auroc_score: 0.9941; val_auprc_score: 0.9924; val_best_acc_score: 0.9721; val_best_f1_score: 0.9724; train_kl_reg_loss: 3882.6955; train_edge_recon_loss: 258020.3132; train_gene_expr_recon_loss: 120627.4499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382530.4573; train_optim_loss: 382530.4573; val_kl_reg_loss: 3685.6159; val_edge_recon_loss: 259004.0164; val_gene_expr_recon_loss: 121151.7644; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383841.3980; val_optim_loss: 383841.3980
Epoch 33/200 |███-----------------| 16.5% val_auroc_score: 0.9936; val_auprc_score: 0.9916; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 3882.4684; train_edge_recon_loss: 257950.2627; train_gene_expr_recon_loss: 120637.5845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382470.3140; train_optim_loss: 382470.3140; val_kl_reg_loss: 3683.1657; val_edge_recon_loss: 258865.2229; val_gene_expr_recon_loss: 120594.0991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383142.4868; val_optim_loss: 383142.4868

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 24 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9936
Val AUPRC score: 0.9917
Val best accuracy score: 0.9700
Val best F1 score: 0.9705
Val gene expr MSE score: 0.3671
Duration of model training in run 3: 0 hours, 33 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 338764
Number of validation edges: 37640
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9505; val_auprc_score: 0.9405; val_best_acc_score: 0.8861; val_best_f1_score: 0.8904; train_kl_reg_loss: 4610.7857; train_edge_recon_loss: 281695.1990; train_gene_expr_recon_loss: 128893.0778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415199.0608; train_optim_loss: 415199.0608; val_kl_reg_loss: 4692.0529; val_edge_recon_loss: 269387.9836; val_gene_expr_recon_loss: 125729.3343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399809.3717; val_optim_loss: 399809.3717
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9670; val_auprc_score: 0.9603; val_best_acc_score: 0.9106; val_best_f1_score: 0.9134; train_kl_reg_loss: 4725.8181; train_edge_recon_loss: 264403.2783; train_gene_expr_recon_loss: 125739.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394868.4040; train_optim_loss: 394868.4040; val_kl_reg_loss: 4636.7968; val_edge_recon_loss: 265250.8372; val_gene_expr_recon_loss: 124865.0111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394752.6431; val_optim_loss: 394752.6431
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9754; val_auprc_score: 0.9706; val_best_acc_score: 0.9241; val_best_f1_score: 0.9265; train_kl_reg_loss: 4632.8192; train_edge_recon_loss: 262787.2274; train_gene_expr_recon_loss: 124787.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392207.9328; train_optim_loss: 392207.9328; val_kl_reg_loss: 4547.2869; val_edge_recon_loss: 263901.6768; val_gene_expr_recon_loss: 123535.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391984.8553; val_optim_loss: 391984.8553
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9792; val_auprc_score: 0.9748; val_best_acc_score: 0.9340; val_best_f1_score: 0.9356; train_kl_reg_loss: 4614.6999; train_edge_recon_loss: 261884.9880; train_gene_expr_recon_loss: 124365.9282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390865.6152; train_optim_loss: 390865.6152; val_kl_reg_loss: 4620.1046; val_edge_recon_loss: 263652.3043; val_gene_expr_recon_loss: 123444.8236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391717.2336; val_optim_loss: 391717.2336
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9826; val_auprc_score: 0.9787; val_best_acc_score: 0.9391; val_best_f1_score: 0.9407; train_kl_reg_loss: 4591.8602; train_edge_recon_loss: 261293.1797; train_gene_expr_recon_loss: 123708.3014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389593.3413; train_optim_loss: 389593.3413; val_kl_reg_loss: 4480.9455; val_edge_recon_loss: 263054.7434; val_gene_expr_recon_loss: 122455.3783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389991.0609; val_optim_loss: 389991.0609
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9852; val_auprc_score: 0.9817; val_best_acc_score: 0.9457; val_best_f1_score: 0.9465; train_kl_reg_loss: 4572.1083; train_edge_recon_loss: 260989.5609; train_gene_expr_recon_loss: 123180.0020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388741.6711; train_optim_loss: 388741.6711; val_kl_reg_loss: 4538.3862; val_edge_recon_loss: 262143.8997; val_gene_expr_recon_loss: 121790.5843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388472.8701; val_optim_loss: 388472.8701
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9865; val_auprc_score: 0.9836; val_best_acc_score: 0.9486; val_best_f1_score: 0.9497; train_kl_reg_loss: 4565.9378; train_edge_recon_loss: 260701.1844; train_gene_expr_recon_loss: 123100.4598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388367.5832; train_optim_loss: 388367.5832; val_kl_reg_loss: 4428.4528; val_edge_recon_loss: 262043.4145; val_gene_expr_recon_loss: 122067.9745; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388539.8454; val_optim_loss: 388539.8454
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9847; val_best_acc_score: 0.9523; val_best_f1_score: 0.9532; train_kl_reg_loss: 4568.7069; train_edge_recon_loss: 260428.6855; train_gene_expr_recon_loss: 122578.3505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387575.7453; train_optim_loss: 387575.7453; val_kl_reg_loss: 4519.7777; val_edge_recon_loss: 261615.8067; val_gene_expr_recon_loss: 121473.9165; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387609.4984; val_optim_loss: 387609.4984
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9878; val_auprc_score: 0.9849; val_best_acc_score: 0.9533; val_best_f1_score: 0.9542; train_kl_reg_loss: 4564.0280; train_edge_recon_loss: 260071.1452; train_gene_expr_recon_loss: 122321.0930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386956.2654; train_optim_loss: 386956.2654; val_kl_reg_loss: 4534.5936; val_edge_recon_loss: 261523.9737; val_gene_expr_recon_loss: 121104.2278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387162.7993; val_optim_loss: 387162.7993
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9883; val_auprc_score: 0.9850; val_best_acc_score: 0.9550; val_best_f1_score: 0.9560; train_kl_reg_loss: 4561.0173; train_edge_recon_loss: 260019.1506; train_gene_expr_recon_loss: 122108.6517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386688.8206; train_optim_loss: 386688.8206; val_kl_reg_loss: 4523.5529; val_edge_recon_loss: 261012.3010; val_gene_expr_recon_loss: 121315.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386851.7204; val_optim_loss: 386851.7204
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9891; val_auprc_score: 0.9860; val_best_acc_score: 0.9571; val_best_f1_score: 0.9578; train_kl_reg_loss: 4559.0305; train_edge_recon_loss: 259756.2726; train_gene_expr_recon_loss: 121881.7670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386197.0697; train_optim_loss: 386197.0697; val_kl_reg_loss: 4416.2324; val_edge_recon_loss: 260972.8207; val_gene_expr_recon_loss: 121494.0341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386883.0855; val_optim_loss: 386883.0855
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9896; val_auprc_score: 0.9870; val_best_acc_score: 0.9590; val_best_f1_score: 0.9595; train_kl_reg_loss: 4558.4188; train_edge_recon_loss: 259528.4047; train_gene_expr_recon_loss: 121914.8524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386001.6755; train_optim_loss: 386001.6755; val_kl_reg_loss: 4502.7881; val_edge_recon_loss: 260883.0551; val_gene_expr_recon_loss: 121466.3228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386852.1661; val_optim_loss: 386852.1661
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9908; val_auprc_score: 0.9889; val_best_acc_score: 0.9601; val_best_f1_score: 0.9609; train_kl_reg_loss: 4558.1492; train_edge_recon_loss: 259380.6726; train_gene_expr_recon_loss: 121650.0856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385588.9087; train_optim_loss: 385588.9087; val_kl_reg_loss: 4571.7366; val_edge_recon_loss: 260756.8553; val_gene_expr_recon_loss: 121347.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386675.6990; val_optim_loss: 386675.6990
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9911; val_auprc_score: 0.9885; val_best_acc_score: 0.9633; val_best_f1_score: 0.9639; train_kl_reg_loss: 4558.4361; train_edge_recon_loss: 259301.0838; train_gene_expr_recon_loss: 121538.1651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385397.6852; train_optim_loss: 385397.6852; val_kl_reg_loss: 4474.3083; val_edge_recon_loss: 259986.4646; val_gene_expr_recon_loss: 120493.5839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384954.3602; val_optim_loss: 384954.3602
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9915; val_auprc_score: 0.9892; val_best_acc_score: 0.9634; val_best_f1_score: 0.9639; train_kl_reg_loss: 4561.6618; train_edge_recon_loss: 259108.7958; train_gene_expr_recon_loss: 121426.8720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385097.3319; train_optim_loss: 385097.3319; val_kl_reg_loss: 4376.4551; val_edge_recon_loss: 259943.3306; val_gene_expr_recon_loss: 120424.3947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384744.1793; val_optim_loss: 384744.1793
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9918; val_auprc_score: 0.9896; val_best_acc_score: 0.9643; val_best_f1_score: 0.9648; train_kl_reg_loss: 4551.3285; train_edge_recon_loss: 259039.1363; train_gene_expr_recon_loss: 121328.3995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384918.8654; train_optim_loss: 384918.8654; val_kl_reg_loss: 4484.5841; val_edge_recon_loss: 260227.4186; val_gene_expr_recon_loss: 120720.7611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385432.7632; val_optim_loss: 385432.7632
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9920; val_auprc_score: 0.9899; val_best_acc_score: 0.9652; val_best_f1_score: 0.9657; train_kl_reg_loss: 4557.3633; train_edge_recon_loss: 258887.6346; train_gene_expr_recon_loss: 121153.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384598.8257; train_optim_loss: 384598.8257; val_kl_reg_loss: 4361.1462; val_edge_recon_loss: 260001.3684; val_gene_expr_recon_loss: 120805.0683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385167.5789; val_optim_loss: 385167.5789
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9925; val_auprc_score: 0.9901; val_best_acc_score: 0.9674; val_best_f1_score: 0.9678; train_kl_reg_loss: 4554.0177; train_edge_recon_loss: 258904.1689; train_gene_expr_recon_loss: 121145.1213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384603.3087; train_optim_loss: 384603.3087; val_kl_reg_loss: 4435.8982; val_edge_recon_loss: 259770.7590; val_gene_expr_recon_loss: 120623.6978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384830.3586; val_optim_loss: 384830.3586

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9684; val_best_f1_score: 0.9687; train_kl_reg_loss: 4555.0220; train_edge_recon_loss: 258518.1917; train_gene_expr_recon_loss: 120711.2915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383784.5062; train_optim_loss: 383784.5062; val_kl_reg_loss: 4485.4187; val_edge_recon_loss: 258875.3446; val_gene_expr_recon_loss: 120103.6373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383464.4030; val_optim_loss: 383464.4030
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9932; val_auprc_score: 0.9914; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 4547.0749; train_edge_recon_loss: 258491.2069; train_gene_expr_recon_loss: 120787.1077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383825.3904; train_optim_loss: 383825.3904; val_kl_reg_loss: 4516.2902; val_edge_recon_loss: 259387.7122; val_gene_expr_recon_loss: 120755.5177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384659.5230; val_optim_loss: 384659.5230
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9933; val_auprc_score: 0.9911; val_best_acc_score: 0.9694; val_best_f1_score: 0.9699; train_kl_reg_loss: 4544.1704; train_edge_recon_loss: 258503.4149; train_gene_expr_recon_loss: 120676.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383724.0666; train_optim_loss: 383724.0666; val_kl_reg_loss: 4491.8709; val_edge_recon_loss: 259011.9211; val_gene_expr_recon_loss: 120486.9383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383990.7352; val_optim_loss: 383990.7352
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9932; val_auprc_score: 0.9911; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 4543.9092; train_edge_recon_loss: 258422.8160; train_gene_expr_recon_loss: 120804.4356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383771.1596; train_optim_loss: 383771.1596; val_kl_reg_loss: 4503.3442; val_edge_recon_loss: 259253.0280; val_gene_expr_recon_loss: 120181.6826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383938.0543; val_optim_loss: 383938.0543

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9934; val_auprc_score: 0.9913; val_best_acc_score: 0.9695; val_best_f1_score: 0.9700; train_kl_reg_loss: 4540.4810; train_edge_recon_loss: 258475.9105; train_gene_expr_recon_loss: 120726.9627; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383743.3549; train_optim_loss: 383743.3549; val_kl_reg_loss: 4487.4910; val_edge_recon_loss: 259386.7418; val_gene_expr_recon_loss: 120705.6102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384579.8438; val_optim_loss: 384579.8438
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9933; val_auprc_score: 0.9911; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 4543.8490; train_edge_recon_loss: 258297.3005; train_gene_expr_recon_loss: 120709.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383550.6967; train_optim_loss: 383550.6967; val_kl_reg_loss: 4487.1720; val_edge_recon_loss: 259495.0872; val_gene_expr_recon_loss: 120050.1928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384032.4507; val_optim_loss: 384032.4507
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9935; val_auprc_score: 0.9917; val_best_acc_score: 0.9688; val_best_f1_score: 0.9692; train_kl_reg_loss: 4541.4221; train_edge_recon_loss: 258462.4796; train_gene_expr_recon_loss: 120724.4174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383728.3191; train_optim_loss: 383728.3191; val_kl_reg_loss: 4487.6993; val_edge_recon_loss: 259448.0970; val_gene_expr_recon_loss: 120888.6456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384824.4457; val_optim_loss: 384824.4457

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 6 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9933
Val AUPRC score: 0.9914
Val best accuracy score: 0.9682
Val best F1 score: 0.9685
Val gene expr MSE score: 0.3641
Duration of model training in run 4: 0 hours, 24 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 501620
Number of validation edges: 55735
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9769; val_auprc_score: 0.9724; val_best_acc_score: 0.9258; val_best_f1_score: 0.9279; train_kl_reg_loss: 4647.8179; train_edge_recon_loss: 270986.5065; train_gene_expr_recon_loss: 127569.2140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403203.5379; train_optim_loss: 403203.5379; val_kl_reg_loss: 4465.7959; val_edge_recon_loss: 262952.3926; val_gene_expr_recon_loss: 124940.7129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392358.9045; val_optim_loss: 392358.9045
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9855; val_auprc_score: 0.9824; val_best_acc_score: 0.9451; val_best_f1_score: 0.9459; train_kl_reg_loss: 4599.4930; train_edge_recon_loss: 261844.7294; train_gene_expr_recon_loss: 124728.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391172.5067; train_optim_loss: 391172.5067; val_kl_reg_loss: 4556.9717; val_edge_recon_loss: 261508.1722; val_gene_expr_recon_loss: 123852.6185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389917.7642; val_optim_loss: 389917.7642
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9884; val_auprc_score: 0.9851; val_best_acc_score: 0.9536; val_best_f1_score: 0.9546; train_kl_reg_loss: 4568.1807; train_edge_recon_loss: 260913.6677; train_gene_expr_recon_loss: 123658.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389139.8652; train_optim_loss: 389139.8652; val_kl_reg_loss: 4563.3210; val_edge_recon_loss: 260672.1156; val_gene_expr_recon_loss: 122577.8729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387813.3080; val_optim_loss: 387813.3080
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9906; val_auprc_score: 0.9879; val_best_acc_score: 0.9603; val_best_f1_score: 0.9610; train_kl_reg_loss: 4572.1110; train_edge_recon_loss: 260122.8960; train_gene_expr_recon_loss: 123043.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387738.8211; train_optim_loss: 387738.8211; val_kl_reg_loss: 4563.1345; val_edge_recon_loss: 260187.2580; val_gene_expr_recon_loss: 121827.1700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386577.5636; val_optim_loss: 386577.5636
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9916; val_auprc_score: 0.9888; val_best_acc_score: 0.9642; val_best_f1_score: 0.9647; train_kl_reg_loss: 4559.4498; train_edge_recon_loss: 259580.7842; train_gene_expr_recon_loss: 122610.0541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386750.2878; train_optim_loss: 386750.2878; val_kl_reg_loss: 4491.2212; val_edge_recon_loss: 259868.1756; val_gene_expr_recon_loss: 121528.7283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385888.1284; val_optim_loss: 385888.1284
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9927; val_auprc_score: 0.9904; val_best_acc_score: 0.9678; val_best_f1_score: 0.9683; train_kl_reg_loss: 4550.4907; train_edge_recon_loss: 259172.9511; train_gene_expr_recon_loss: 122243.8478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385967.2904; train_optim_loss: 385967.2904; val_kl_reg_loss: 4619.3518; val_edge_recon_loss: 259133.1449; val_gene_expr_recon_loss: 121266.5831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385019.0824; val_optim_loss: 385019.0824
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9942; val_auprc_score: 0.9927; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 4545.1645; train_edge_recon_loss: 258778.5573; train_gene_expr_recon_loss: 121884.2603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385207.9819; train_optim_loss: 385207.9819; val_kl_reg_loss: 4618.4350; val_edge_recon_loss: 258815.1974; val_gene_expr_recon_loss: 121804.9449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385238.5767; val_optim_loss: 385238.5767
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9732; val_best_f1_score: 0.9735; train_kl_reg_loss: 4547.1263; train_edge_recon_loss: 258657.3173; train_gene_expr_recon_loss: 121859.6288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385064.0712; train_optim_loss: 385064.0712; val_kl_reg_loss: 4571.1310; val_edge_recon_loss: 258287.3435; val_gene_expr_recon_loss: 121150.5207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384008.9920; val_optim_loss: 384008.9920
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9946; val_auprc_score: 0.9929; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 4543.6469; train_edge_recon_loss: 258365.5179; train_gene_expr_recon_loss: 121666.8373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384576.0029; train_optim_loss: 384576.0029; val_kl_reg_loss: 4495.1164; val_edge_recon_loss: 258421.3233; val_gene_expr_recon_loss: 121228.9678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384145.4074; val_optim_loss: 384145.4074
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9948; val_auprc_score: 0.9934; val_best_acc_score: 0.9757; val_best_f1_score: 0.9761; train_kl_reg_loss: 4542.8903; train_edge_recon_loss: 258112.1520; train_gene_expr_recon_loss: 121468.2691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384123.3119; train_optim_loss: 384123.3119; val_kl_reg_loss: 4361.3379; val_edge_recon_loss: 258270.2534; val_gene_expr_recon_loss: 121085.3896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383716.9801; val_optim_loss: 383716.9801
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9949; val_auprc_score: 0.9933; val_best_acc_score: 0.9756; val_best_f1_score: 0.9759; train_kl_reg_loss: 4541.2817; train_edge_recon_loss: 257899.5444; train_gene_expr_recon_loss: 121388.6819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383829.5072; train_optim_loss: 383829.5072; val_kl_reg_loss: 4495.4331; val_edge_recon_loss: 257852.3386; val_gene_expr_recon_loss: 120401.1938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382748.9665; val_optim_loss: 382748.9665
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9952; val_auprc_score: 0.9938; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 4540.8816; train_edge_recon_loss: 257908.7266; train_gene_expr_recon_loss: 121245.4406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383695.0496; train_optim_loss: 383695.0496; val_kl_reg_loss: 4455.2841; val_edge_recon_loss: 257601.9153; val_gene_expr_recon_loss: 120948.5501; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383005.7472; val_optim_loss: 383005.7472
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 4537.8491; train_edge_recon_loss: 257761.8976; train_gene_expr_recon_loss: 121198.5567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383498.3045; train_optim_loss: 383498.3045; val_kl_reg_loss: 4482.8351; val_edge_recon_loss: 257595.7491; val_gene_expr_recon_loss: 121218.9236; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383297.5068; val_optim_loss: 383297.5068
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9962; val_auprc_score: 0.9952; val_best_acc_score: 0.9795; val_best_f1_score: 0.9797; train_kl_reg_loss: 4540.1649; train_edge_recon_loss: 257550.0179; train_gene_expr_recon_loss: 121159.8222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383250.0050; train_optim_loss: 383250.0050; val_kl_reg_loss: 4432.2775; val_edge_recon_loss: 257666.6026; val_gene_expr_recon_loss: 120878.5031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382977.3852; val_optim_loss: 382977.3852

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9807; val_best_f1_score: 0.9809; train_kl_reg_loss: 4529.4208; train_edge_recon_loss: 257154.3206; train_gene_expr_recon_loss: 120782.2566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382465.9976; train_optim_loss: 382465.9976; val_kl_reg_loss: 4503.4446; val_edge_recon_loss: 256957.0858; val_gene_expr_recon_loss: 120597.7798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382058.3097; val_optim_loss: 382058.3097
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 4525.7885; train_edge_recon_loss: 257118.8879; train_gene_expr_recon_loss: 120886.7171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382531.3936; train_optim_loss: 382531.3936; val_kl_reg_loss: 4482.7599; val_edge_recon_loss: 256878.1776; val_gene_expr_recon_loss: 120509.1541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381870.0909; val_optim_loss: 381870.0909
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9964; val_auprc_score: 0.9951; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 4519.5324; train_edge_recon_loss: 257065.2335; train_gene_expr_recon_loss: 120776.8481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382361.6138; train_optim_loss: 382361.6138; val_kl_reg_loss: 4460.7058; val_edge_recon_loss: 256866.3185; val_gene_expr_recon_loss: 120117.1439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381444.1659; val_optim_loss: 381444.1659
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9959; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 4515.8440; train_edge_recon_loss: 257097.4954; train_gene_expr_recon_loss: 120738.3231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382351.6622; train_optim_loss: 382351.6622; val_kl_reg_loss: 4509.4477; val_edge_recon_loss: 256802.8756; val_gene_expr_recon_loss: 120361.4136; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381673.7364; val_optim_loss: 381673.7364
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9966; val_auprc_score: 0.9956; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 4517.8218; train_edge_recon_loss: 257059.1084; train_gene_expr_recon_loss: 120819.8241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382396.7541; train_optim_loss: 382396.7541; val_kl_reg_loss: 4480.2260; val_edge_recon_loss: 257172.3247; val_gene_expr_recon_loss: 120512.3246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382164.8784; val_optim_loss: 382164.8784
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 4513.6493; train_edge_recon_loss: 257085.6122; train_gene_expr_recon_loss: 120691.2798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382290.5410; train_optim_loss: 382290.5410; val_kl_reg_loss: 4460.1178; val_edge_recon_loss: 256764.0866; val_gene_expr_recon_loss: 120762.9571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381987.1642; val_optim_loss: 381987.1642

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9826; val_best_f1_score: 0.9827; train_kl_reg_loss: 4510.9935; train_edge_recon_loss: 257011.6882; train_gene_expr_recon_loss: 120779.7602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382302.4422; train_optim_loss: 382302.4422; val_kl_reg_loss: 4474.6340; val_edge_recon_loss: 256668.9145; val_gene_expr_recon_loss: 120756.0337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381899.5830; val_optim_loss: 381899.5830
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9966; val_auprc_score: 0.9954; val_best_acc_score: 0.9819; val_best_f1_score: 0.9820; train_kl_reg_loss: 4514.5288; train_edge_recon_loss: 256994.0354; train_gene_expr_recon_loss: 120781.2352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382289.7993; train_optim_loss: 382289.7993; val_kl_reg_loss: 4490.7082; val_edge_recon_loss: 256912.6284; val_gene_expr_recon_loss: 121092.9901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382496.3267; val_optim_loss: 382496.3267
Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9966; val_auprc_score: 0.9957; val_best_acc_score: 0.9819; val_best_f1_score: 0.9821; train_kl_reg_loss: 4511.9333; train_edge_recon_loss: 257000.9101; train_gene_expr_recon_loss: 120593.1187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382105.9617; train_optim_loss: 382105.9617; val_kl_reg_loss: 4478.5206; val_edge_recon_loss: 256598.0031; val_gene_expr_recon_loss: 120389.8313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381466.3545; val_optim_loss: 381466.3545

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 59 min 49 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9965
Val AUPRC score: 0.9950
Val best accuracy score: 0.9810
Val best F1 score: 0.9812
Val gene expr MSE score: 0.3714
Duration of model training in run 5: 1 hours, 0 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 501620
Number of validation edges: 55735
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9760; val_auprc_score: 0.9709; val_best_acc_score: 0.9261; val_best_f1_score: 0.9285; train_kl_reg_loss: 4620.6275; train_edge_recon_loss: 271185.9354; train_gene_expr_recon_loss: 128078.1228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403884.6851; train_optim_loss: 403884.6851; val_kl_reg_loss: 4739.7823; val_edge_recon_loss: 262922.3736; val_gene_expr_recon_loss: 125692.2714; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393354.4261; val_optim_loss: 393354.4261
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9848; val_auprc_score: 0.9816; val_best_acc_score: 0.9440; val_best_f1_score: 0.9450; train_kl_reg_loss: 4603.2580; train_edge_recon_loss: 261820.0103; train_gene_expr_recon_loss: 125105.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391529.2288; train_optim_loss: 391529.2288; val_kl_reg_loss: 4430.4127; val_edge_recon_loss: 261292.1707; val_gene_expr_recon_loss: 123428.2075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389150.7909; val_optim_loss: 389150.7909
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9888; val_auprc_score: 0.9856; val_best_acc_score: 0.9556; val_best_f1_score: 0.9563; train_kl_reg_loss: 4576.6443; train_edge_recon_loss: 260748.4496; train_gene_expr_recon_loss: 123730.6136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389055.7071; train_optim_loss: 389055.7071; val_kl_reg_loss: 4515.4483; val_edge_recon_loss: 260589.0202; val_gene_expr_recon_loss: 122700.7453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387805.2131; val_optim_loss: 387805.2131
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9915; val_auprc_score: 0.9891; val_best_acc_score: 0.9614; val_best_f1_score: 0.9618; train_kl_reg_loss: 4558.1180; train_edge_recon_loss: 260067.4262; train_gene_expr_recon_loss: 123031.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387657.4674; train_optim_loss: 387657.4674; val_kl_reg_loss: 4607.8063; val_edge_recon_loss: 260088.2938; val_gene_expr_recon_loss: 121924.6810; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386620.7801; val_optim_loss: 386620.7801
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9649; val_best_f1_score: 0.9655; train_kl_reg_loss: 4552.5474; train_edge_recon_loss: 259586.5478; train_gene_expr_recon_loss: 122538.4246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386677.5189; train_optim_loss: 386677.5189; val_kl_reg_loss: 4474.2069; val_edge_recon_loss: 259771.7841; val_gene_expr_recon_loss: 121694.3126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385940.3045; val_optim_loss: 385940.3045
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9933; val_auprc_score: 0.9913; val_best_acc_score: 0.9688; val_best_f1_score: 0.9692; train_kl_reg_loss: 4553.4099; train_edge_recon_loss: 259009.3047; train_gene_expr_recon_loss: 122161.5276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385724.2429; train_optim_loss: 385724.2429; val_kl_reg_loss: 4566.3657; val_edge_recon_loss: 259444.8301; val_gene_expr_recon_loss: 121604.2541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385615.4494; val_optim_loss: 385615.4494
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9940; val_auprc_score: 0.9920; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 4541.3396; train_edge_recon_loss: 258962.5807; train_gene_expr_recon_loss: 121929.4665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385433.3864; train_optim_loss: 385433.3864; val_kl_reg_loss: 4417.2644; val_edge_recon_loss: 258611.0119; val_gene_expr_recon_loss: 121118.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384147.1364; val_optim_loss: 384147.1364
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9944; val_auprc_score: 0.9928; val_best_acc_score: 0.9720; val_best_f1_score: 0.9724; train_kl_reg_loss: 4541.9009; train_edge_recon_loss: 258552.4412; train_gene_expr_recon_loss: 121673.2580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384767.5998; train_optim_loss: 384767.5998; val_kl_reg_loss: 4487.4284; val_edge_recon_loss: 258768.2145; val_gene_expr_recon_loss: 121148.7276; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384404.3716; val_optim_loss: 384404.3716
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9949; val_auprc_score: 0.9934; val_best_acc_score: 0.9751; val_best_f1_score: 0.9754; train_kl_reg_loss: 4541.4928; train_edge_recon_loss: 258410.5300; train_gene_expr_recon_loss: 121517.6203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384469.6430; train_optim_loss: 384469.6430; val_kl_reg_loss: 4479.1153; val_edge_recon_loss: 258168.4264; val_gene_expr_recon_loss: 121257.9327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383905.4744; val_optim_loss: 383905.4744
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 4541.7611; train_edge_recon_loss: 258108.5395; train_gene_expr_recon_loss: 121461.6773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384111.9783; train_optim_loss: 384111.9783; val_kl_reg_loss: 4530.6077; val_edge_recon_loss: 258209.7753; val_gene_expr_recon_loss: 120653.2341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383393.6159; val_optim_loss: 383393.6159
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9787; val_best_f1_score: 0.9789; train_kl_reg_loss: 4543.7152; train_edge_recon_loss: 257943.5644; train_gene_expr_recon_loss: 121361.2335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383848.5141; train_optim_loss: 383848.5141; val_kl_reg_loss: 4482.3413; val_edge_recon_loss: 257622.5517; val_gene_expr_recon_loss: 121340.0544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383444.9472; val_optim_loss: 383444.9472
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9958; val_auprc_score: 0.9944; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 4541.1056; train_edge_recon_loss: 257777.3069; train_gene_expr_recon_loss: 121387.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383706.0485; train_optim_loss: 383706.0485; val_kl_reg_loss: 4569.7114; val_edge_recon_loss: 257381.4094; val_gene_expr_recon_loss: 120871.8247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382822.9449; val_optim_loss: 382822.9449
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9796; val_best_f1_score: 0.9797; train_kl_reg_loss: 4542.1991; train_edge_recon_loss: 257670.6111; train_gene_expr_recon_loss: 121192.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383405.3982; train_optim_loss: 383405.3982; val_kl_reg_loss: 4541.3252; val_edge_recon_loss: 257224.8886; val_gene_expr_recon_loss: 120832.4625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382598.6767; val_optim_loss: 382598.6767
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 4541.7346; train_edge_recon_loss: 257535.3624; train_gene_expr_recon_loss: 120999.5123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383076.6087; train_optim_loss: 383076.6087; val_kl_reg_loss: 4559.5518; val_edge_recon_loss: 257115.5955; val_gene_expr_recon_loss: 120937.3949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382612.5420; val_optim_loss: 382612.5420
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9963; val_auprc_score: 0.9954; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 4544.1467; train_edge_recon_loss: 257397.3710; train_gene_expr_recon_loss: 121032.9730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382974.4912; train_optim_loss: 382974.4912; val_kl_reg_loss: 4456.1922; val_edge_recon_loss: 257479.8918; val_gene_expr_recon_loss: 121198.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383134.4085; val_optim_loss: 383134.4085
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9965; val_auprc_score: 0.9956; val_best_acc_score: 0.9823; val_best_f1_score: 0.9824; train_kl_reg_loss: 4546.3673; train_edge_recon_loss: 257284.7559; train_gene_expr_recon_loss: 121020.1561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382851.2798; train_optim_loss: 382851.2798; val_kl_reg_loss: 4462.0341; val_edge_recon_loss: 257032.3827; val_gene_expr_recon_loss: 121125.4178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382619.8341; val_optim_loss: 382619.8341

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 4537.2808; train_edge_recon_loss: 256937.8679; train_gene_expr_recon_loss: 120651.6954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382126.8445; train_optim_loss: 382126.8445; val_kl_reg_loss: 4494.5165; val_edge_recon_loss: 256902.1753; val_gene_expr_recon_loss: 120413.0298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381809.7216; val_optim_loss: 381809.7216
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9820; val_best_f1_score: 0.9821; train_kl_reg_loss: 4528.0363; train_edge_recon_loss: 256920.5611; train_gene_expr_recon_loss: 120558.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382007.4767; train_optim_loss: 382007.4767; val_kl_reg_loss: 4496.8383; val_edge_recon_loss: 256762.8162; val_gene_expr_recon_loss: 121179.8607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382439.5159; val_optim_loss: 382439.5159
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9970; val_auprc_score: 0.9962; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 4525.7920; train_edge_recon_loss: 256934.8147; train_gene_expr_recon_loss: 120558.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382019.1795; train_optim_loss: 382019.1795; val_kl_reg_loss: 4467.9409; val_edge_recon_loss: 256433.1165; val_gene_expr_recon_loss: 120589.8014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381490.8597; val_optim_loss: 381490.8597
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 4524.4772; train_edge_recon_loss: 256806.6349; train_gene_expr_recon_loss: 120570.7486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381901.8614; train_optim_loss: 381901.8614; val_kl_reg_loss: 4508.0326; val_edge_recon_loss: 256571.9537; val_gene_expr_recon_loss: 120916.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381996.6909; val_optim_loss: 381996.6909
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 4522.5438; train_edge_recon_loss: 256930.7671; train_gene_expr_recon_loss: 120575.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382029.3025; train_optim_loss: 382029.3025; val_kl_reg_loss: 4545.6181; val_edge_recon_loss: 256685.7207; val_gene_expr_recon_loss: 120513.3830; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381744.7239; val_optim_loss: 381744.7239
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9971; val_auprc_score: 0.9964; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 4521.9592; train_edge_recon_loss: 256857.9251; train_gene_expr_recon_loss: 120569.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381949.0473; train_optim_loss: 381949.0473; val_kl_reg_loss: 4518.9069; val_edge_recon_loss: 256637.0494; val_gene_expr_recon_loss: 120657.3295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381813.2875; val_optim_loss: 381813.2875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 4519.4419; train_edge_recon_loss: 256920.8085; train_gene_expr_recon_loss: 120528.4362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381968.6867; train_optim_loss: 381968.6867; val_kl_reg_loss: 4488.2707; val_edge_recon_loss: 256482.0048; val_gene_expr_recon_loss: 120432.7727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381403.0483; val_optim_loss: 381403.0483
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 4516.3416; train_edge_recon_loss: 256919.5404; train_gene_expr_recon_loss: 120574.3061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382010.1879; train_optim_loss: 382010.1879; val_kl_reg_loss: 4475.2600; val_edge_recon_loss: 256277.2230; val_gene_expr_recon_loss: 120591.8199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381344.3034; val_optim_loss: 381344.3034
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 4518.6741; train_edge_recon_loss: 256807.9485; train_gene_expr_recon_loss: 120615.6713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381942.2934; train_optim_loss: 381942.2934; val_kl_reg_loss: 4482.0223; val_edge_recon_loss: 256783.2722; val_gene_expr_recon_loss: 121050.3935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382315.6903; val_optim_loss: 382315.6903
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 4383.8309; train_edge_recon_loss: 256925.0735; train_gene_expr_recon_loss: 120614.7040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381923.6082; train_optim_loss: 381923.6082; val_kl_reg_loss: 3843.1368; val_edge_recon_loss: 256553.0895; val_gene_expr_recon_loss: 120756.2778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381152.5034; val_optim_loss: 381152.5034
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 4110.8929; train_edge_recon_loss: 256890.9032; train_gene_expr_recon_loss: 120613.8024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381615.5996; train_optim_loss: 381615.5996; val_kl_reg_loss: 3589.0407; val_edge_recon_loss: 256481.5219; val_gene_expr_recon_loss: 120602.5746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380673.1375; val_optim_loss: 380673.1375
Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 3889.0342; train_edge_recon_loss: 256840.6822; train_gene_expr_recon_loss: 120568.3624; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381298.0781; train_optim_loss: 381298.0781; val_kl_reg_loss: 3402.1115; val_edge_recon_loss: 257034.6969; val_gene_expr_recon_loss: 120382.5290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380819.3375; val_optim_loss: 380819.3375
Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9973; val_auprc_score: 0.9967; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3751.7277; train_edge_recon_loss: 256778.3785; train_gene_expr_recon_loss: 120611.4541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381141.5601; train_optim_loss: 381141.5601; val_kl_reg_loss: 3324.8249; val_edge_recon_loss: 256613.7955; val_gene_expr_recon_loss: 121299.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381238.4392; val_optim_loss: 381238.4392
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 3695.0942; train_edge_recon_loss: 256732.9803; train_gene_expr_recon_loss: 120574.0242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381002.0991; train_optim_loss: 381002.0991; val_kl_reg_loss: 3299.7434; val_edge_recon_loss: 256403.4327; val_gene_expr_recon_loss: 121011.6162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380714.7932; val_optim_loss: 380714.7932

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/200 |███-----------------| 15.5% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9836; val_best_f1_score: 0.9837; train_kl_reg_loss: 3680.6738; train_edge_recon_loss: 256758.7332; train_gene_expr_recon_loss: 120548.9873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380988.3943; train_optim_loss: 380988.3943; val_kl_reg_loss: 3295.1845; val_edge_recon_loss: 256660.0514; val_gene_expr_recon_loss: 120355.2749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380310.5085; val_optim_loss: 380310.5085
Epoch 32/200 |███-----------------| 16.0% val_auroc_score: 0.9976; val_auprc_score: 0.9970; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 3679.1130; train_edge_recon_loss: 256688.7076; train_gene_expr_recon_loss: 120574.3075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380942.1272; train_optim_loss: 380942.1272; val_kl_reg_loss: 3298.3253; val_edge_recon_loss: 256404.3886; val_gene_expr_recon_loss: 120727.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380430.5727; val_optim_loss: 380430.5727
Epoch 33/200 |███-----------------| 16.5% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 3680.0281; train_edge_recon_loss: 256637.3144; train_gene_expr_recon_loss: 120631.9968; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380949.3392; train_optim_loss: 380949.3392; val_kl_reg_loss: 3301.2482; val_edge_recon_loss: 256610.5034; val_gene_expr_recon_loss: 120700.4649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380612.2170; val_optim_loss: 380612.2170
Epoch 34/200 |███-----------------| 17.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 3676.8469; train_edge_recon_loss: 256646.2155; train_gene_expr_recon_loss: 120425.6805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380748.7425; train_optim_loss: 380748.7425; val_kl_reg_loss: 3300.6090; val_edge_recon_loss: 256616.6119; val_gene_expr_recon_loss: 120655.8884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380573.1080; val_optim_loss: 380573.1080

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 35/200 |███-----------------| 17.5% val_auroc_score: 0.9972; val_auprc_score: 0.9965; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3675.4835; train_edge_recon_loss: 256771.2383; train_gene_expr_recon_loss: 120606.8052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381053.5276; train_optim_loss: 381053.5276; val_kl_reg_loss: 3299.5496; val_edge_recon_loss: 256549.9707; val_gene_expr_recon_loss: 120318.7098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380168.2290; val_optim_loss: 380168.2290
Epoch 36/200 |███-----------------| 18.0% val_auroc_score: 0.9973; val_auprc_score: 0.9966; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 3675.2630; train_edge_recon_loss: 256634.2309; train_gene_expr_recon_loss: 120569.1093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380878.6036; train_optim_loss: 380878.6036; val_kl_reg_loss: 3299.5035; val_edge_recon_loss: 256609.6207; val_gene_expr_recon_loss: 120802.8938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380712.0159; val_optim_loss: 380712.0159
Epoch 37/200 |███-----------------| 18.5% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3675.6962; train_edge_recon_loss: 256569.1904; train_gene_expr_recon_loss: 120470.9679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380715.8545; train_optim_loss: 380715.8545; val_kl_reg_loss: 3301.0174; val_edge_recon_loss: 256595.1511; val_gene_expr_recon_loss: 120715.9223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380612.0875; val_optim_loss: 380612.0875
Epoch 38/200 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 3675.3542; train_edge_recon_loss: 256599.8831; train_gene_expr_recon_loss: 120560.2787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380835.5157; train_optim_loss: 380835.5157; val_kl_reg_loss: 3300.6099; val_edge_recon_loss: 256533.6611; val_gene_expr_recon_loss: 120793.1683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380627.4381; val_optim_loss: 380627.4381

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 39/200 |███-----------------| 19.5% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9840; val_best_f1_score: 0.9842; train_kl_reg_loss: 3675.4455; train_edge_recon_loss: 256638.6385; train_gene_expr_recon_loss: 120610.3498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380924.4332; train_optim_loss: 380924.4332; val_kl_reg_loss: 3300.7831; val_edge_recon_loss: 256395.5974; val_gene_expr_recon_loss: 120504.9534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380201.3330; val_optim_loss: 380201.3330
Epoch 40/200 |████----------------| 20.0% val_auroc_score: 0.9974; val_auprc_score: 0.9965; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 3675.7033; train_edge_recon_loss: 256640.2165; train_gene_expr_recon_loss: 120689.3526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381005.2731; train_optim_loss: 381005.2731; val_kl_reg_loss: 3300.5091; val_edge_recon_loss: 256310.6557; val_gene_expr_recon_loss: 120879.2592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380490.4244; val_optim_loss: 380490.4244
Epoch 41/200 |████----------------| 20.5% val_auroc_score: 0.9971; val_auprc_score: 0.9961; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 3675.3534; train_edge_recon_loss: 256612.1521; train_gene_expr_recon_loss: 120449.6626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380737.1677; train_optim_loss: 380737.1677; val_kl_reg_loss: 3299.7478; val_edge_recon_loss: 257243.2352; val_gene_expr_recon_loss: 120578.6402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381121.6244; val_optim_loss: 381121.6244

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 115 min 38 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9961
Val best accuracy score: 0.9842
Val best F1 score: 0.9843
Val gene expr MSE score: 0.3755
Duration of model training in run 6: 1 hours, 56 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 663499
Number of validation edges: 73722
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9869; val_auprc_score: 0.9841; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 4588.6668; train_edge_recon_loss: 266361.6886; train_gene_expr_recon_loss: 126513.6613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397464.0175; train_optim_loss: 397464.0175; val_kl_reg_loss: 4525.8680; val_edge_recon_loss: 260523.1113; val_gene_expr_recon_loss: 125299.2287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390348.2086; val_optim_loss: 390348.2086
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9914; val_auprc_score: 0.9891; val_best_acc_score: 0.9628; val_best_f1_score: 0.9634; train_kl_reg_loss: 4586.3477; train_edge_recon_loss: 260309.1144; train_gene_expr_recon_loss: 123399.8759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388295.3376; train_optim_loss: 388295.3376; val_kl_reg_loss: 4567.9110; val_edge_recon_loss: 259551.1692; val_gene_expr_recon_loss: 123670.6053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387789.6851; val_optim_loss: 387789.6851
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 4564.4600; train_edge_recon_loss: 259195.5456; train_gene_expr_recon_loss: 122375.1149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386135.1206; train_optim_loss: 386135.1206; val_kl_reg_loss: 4473.4781; val_edge_recon_loss: 258589.2514; val_gene_expr_recon_loss: 123160.1634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386222.8921; val_optim_loss: 386222.8921
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 4542.7545; train_edge_recon_loss: 258626.2294; train_gene_expr_recon_loss: 121889.8104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385058.7940; train_optim_loss: 385058.7940; val_kl_reg_loss: 4567.3035; val_edge_recon_loss: 258291.4429; val_gene_expr_recon_loss: 122824.6592; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385683.4058; val_optim_loss: 385683.4058
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9952; val_auprc_score: 0.9936; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 4538.3063; train_edge_recon_loss: 258183.4694; train_gene_expr_recon_loss: 121923.1938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384644.9702; train_optim_loss: 384644.9702; val_kl_reg_loss: 4437.6802; val_edge_recon_loss: 257426.9256; val_gene_expr_recon_loss: 122844.1594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384708.7639; val_optim_loss: 384708.7639
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 4533.7989; train_edge_recon_loss: 257849.5185; train_gene_expr_recon_loss: 121696.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384079.4308; train_optim_loss: 384079.4308; val_kl_reg_loss: 4422.8277; val_edge_recon_loss: 257464.0876; val_gene_expr_recon_loss: 122660.4984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384547.4138; val_optim_loss: 384547.4138
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9963; val_auprc_score: 0.9953; val_best_acc_score: 0.9793; val_best_f1_score: 0.9795; train_kl_reg_loss: 4532.0421; train_edge_recon_loss: 257544.6455; train_gene_expr_recon_loss: 121419.8861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383496.5737; train_optim_loss: 383496.5737; val_kl_reg_loss: 4443.8548; val_edge_recon_loss: 257294.1781; val_gene_expr_recon_loss: 122632.7912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384370.8236; val_optim_loss: 384370.8236
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9968; val_auprc_score: 0.9959; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 4527.6289; train_edge_recon_loss: 257253.1940; train_gene_expr_recon_loss: 121335.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383116.2928; train_optim_loss: 383116.2928; val_kl_reg_loss: 4483.0848; val_edge_recon_loss: 256793.2974; val_gene_expr_recon_loss: 122685.9856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383962.3678; val_optim_loss: 383962.3678
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 4532.8076; train_edge_recon_loss: 257146.9776; train_gene_expr_recon_loss: 121278.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382957.8868; train_optim_loss: 382957.8868; val_kl_reg_loss: 4587.7679; val_edge_recon_loss: 256079.9618; val_gene_expr_recon_loss: 122788.6449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383456.3728; val_optim_loss: 383456.3728
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 4532.7952; train_edge_recon_loss: 256954.6865; train_gene_expr_recon_loss: 121211.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382698.6352; train_optim_loss: 382698.6352; val_kl_reg_loss: 4553.3580; val_edge_recon_loss: 256400.5535; val_gene_expr_recon_loss: 122663.1584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383617.0712; val_optim_loss: 383617.0712
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9974; val_auprc_score: 0.9968; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 4534.9629; train_edge_recon_loss: 256842.9656; train_gene_expr_recon_loss: 121236.1108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382614.0389; train_optim_loss: 382614.0389; val_kl_reg_loss: 4578.6180; val_edge_recon_loss: 256199.4983; val_gene_expr_recon_loss: 122604.2605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383382.3752; val_optim_loss: 383382.3752
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9848; val_best_f1_score: 0.9848; train_kl_reg_loss: 4537.1152; train_edge_recon_loss: 256770.2104; train_gene_expr_recon_loss: 121070.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382378.0690; train_optim_loss: 382378.0690; val_kl_reg_loss: 4577.5166; val_edge_recon_loss: 256225.2671; val_gene_expr_recon_loss: 122912.6348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383715.4180; val_optim_loss: 383715.4180
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9976; val_auprc_score: 0.9969; val_best_acc_score: 0.9845; val_best_f1_score: 0.9847; train_kl_reg_loss: 4543.8877; train_edge_recon_loss: 256628.3401; train_gene_expr_recon_loss: 121085.7366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382257.9646; train_optim_loss: 382257.9646; val_kl_reg_loss: 4297.9368; val_edge_recon_loss: 256317.2757; val_gene_expr_recon_loss: 122674.7024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383289.9147; val_optim_loss: 383289.9147
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9844; val_best_f1_score: 0.9844; train_kl_reg_loss: 4547.0713; train_edge_recon_loss: 256541.4457; train_gene_expr_recon_loss: 121002.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382091.1247; train_optim_loss: 382091.1247; val_kl_reg_loss: 4544.0225; val_edge_recon_loss: 256238.7640; val_gene_expr_recon_loss: 122664.2096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383446.9959; val_optim_loss: 383446.9959
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 4548.7263; train_edge_recon_loss: 256491.0071; train_gene_expr_recon_loss: 120869.4430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381909.1766; train_optim_loss: 381909.1766; val_kl_reg_loss: 4548.7800; val_edge_recon_loss: 255688.7536; val_gene_expr_recon_loss: 122582.2382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382819.7706; val_optim_loss: 382819.7706
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9978; val_auprc_score: 0.9973; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 4552.7611; train_edge_recon_loss: 256342.7445; train_gene_expr_recon_loss: 120895.0232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381790.5289; train_optim_loss: 381790.5289; val_kl_reg_loss: 4437.2196; val_edge_recon_loss: 255634.2779; val_gene_expr_recon_loss: 122946.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383017.9499; val_optim_loss: 383017.9499
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 4559.3538; train_edge_recon_loss: 256277.3598; train_gene_expr_recon_loss: 120666.9257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381503.6396; train_optim_loss: 381503.6396; val_kl_reg_loss: 4519.6420; val_edge_recon_loss: 255683.0212; val_gene_expr_recon_loss: 122689.0738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382891.7376; val_optim_loss: 382891.7376
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 4564.2514; train_edge_recon_loss: 256226.6702; train_gene_expr_recon_loss: 120792.7438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381583.6656; train_optim_loss: 381583.6656; val_kl_reg_loss: 4489.4254; val_edge_recon_loss: 255642.2537; val_gene_expr_recon_loss: 122820.9437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382952.6224; val_optim_loss: 382952.6224

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 4559.8206; train_edge_recon_loss: 255906.1656; train_gene_expr_recon_loss: 120339.3414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380805.3276; train_optim_loss: 380805.3276; val_kl_reg_loss: 4550.9303; val_edge_recon_loss: 255495.2820; val_gene_expr_recon_loss: 122612.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382658.3850; val_optim_loss: 382658.3850
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 4554.7816; train_edge_recon_loss: 255904.2748; train_gene_expr_recon_loss: 120309.0876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380768.1438; train_optim_loss: 380768.1438; val_kl_reg_loss: 4517.8298; val_edge_recon_loss: 255288.1424; val_gene_expr_recon_loss: 122731.1903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382537.1625; val_optim_loss: 382537.1625
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 4553.5152; train_edge_recon_loss: 255863.3675; train_gene_expr_recon_loss: 120243.3905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380660.2730; train_optim_loss: 380660.2730; val_kl_reg_loss: 4533.0474; val_edge_recon_loss: 255272.4416; val_gene_expr_recon_loss: 122787.6627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382593.1502; val_optim_loss: 382593.1502
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9984; val_auprc_score: 0.9981; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 4548.3206; train_edge_recon_loss: 255943.8642; train_gene_expr_recon_loss: 120180.3934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380672.5779; train_optim_loss: 380672.5779; val_kl_reg_loss: 4521.5261; val_edge_recon_loss: 255292.5723; val_gene_expr_recon_loss: 122757.3012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382571.3987; val_optim_loss: 382571.3987
Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 4552.4031; train_edge_recon_loss: 255792.2862; train_gene_expr_recon_loss: 120313.7776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380658.4672; train_optim_loss: 380658.4672; val_kl_reg_loss: 4525.8861; val_edge_recon_loss: 255255.4663; val_gene_expr_recon_loss: 122540.5720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382321.9234; val_optim_loss: 382321.9234
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9985; val_auprc_score: 0.9978; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 4550.7028; train_edge_recon_loss: 255792.8899; train_gene_expr_recon_loss: 120223.2097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380566.8024; train_optim_loss: 380566.8024; val_kl_reg_loss: 4525.8287; val_edge_recon_loss: 255064.1702; val_gene_expr_recon_loss: 122718.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382308.8947; val_optim_loss: 382308.8947
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9879; val_best_f1_score: 0.9879; train_kl_reg_loss: 4548.8099; train_edge_recon_loss: 255744.4724; train_gene_expr_recon_loss: 120219.3897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380512.6722; train_optim_loss: 380512.6722; val_kl_reg_loss: 4522.7978; val_edge_recon_loss: 255378.4058; val_gene_expr_recon_loss: 122826.8317; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382728.0352; val_optim_loss: 382728.0352
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 3975.5727; train_edge_recon_loss: 255716.2313; train_gene_expr_recon_loss: 120100.6492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379792.4532; train_optim_loss: 379792.4532; val_kl_reg_loss: 3414.4229; val_edge_recon_loss: 255232.1849; val_gene_expr_recon_loss: 122786.1547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381432.7606; val_optim_loss: 381432.7606
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 3723.1464; train_edge_recon_loss: 255562.4285; train_gene_expr_recon_loss: 120181.6469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379467.2219; train_optim_loss: 379467.2219; val_kl_reg_loss: 3325.4071; val_edge_recon_loss: 255459.8765; val_gene_expr_recon_loss: 122788.3365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381573.6185; val_optim_loss: 381573.6185
Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 3618.6614; train_edge_recon_loss: 255449.4220; train_gene_expr_recon_loss: 120107.9345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379176.0177; train_optim_loss: 379176.0177; val_kl_reg_loss: 3293.5488; val_edge_recon_loss: 255437.3964; val_gene_expr_recon_loss: 122678.4365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381409.3822; val_optim_loss: 381409.3822
Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 3520.3092; train_edge_recon_loss: 255476.8928; train_gene_expr_recon_loss: 120104.9908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379102.1930; train_optim_loss: 379102.1930; val_kl_reg_loss: 3290.8694; val_edge_recon_loss: 255179.4220; val_gene_expr_recon_loss: 123183.9778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381654.2687; val_optim_loss: 381654.2687
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 3427.2120; train_edge_recon_loss: 255464.4930; train_gene_expr_recon_loss: 120018.7733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378910.4785; train_optim_loss: 378910.4785; val_kl_reg_loss: 3250.5731; val_edge_recon_loss: 255306.2057; val_gene_expr_recon_loss: 122864.5345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381421.3127; val_optim_loss: 381421.3127
Epoch 31/200 |███-----------------| 15.5% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 3344.0769; train_edge_recon_loss: 255469.4006; train_gene_expr_recon_loss: 120041.3631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378854.8412; train_optim_loss: 378854.8412; val_kl_reg_loss: 3249.8557; val_edge_recon_loss: 255516.4005; val_gene_expr_recon_loss: 123096.4760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381862.7316; val_optim_loss: 381862.7316

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/200 |███-----------------| 16.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 3309.6476; train_edge_recon_loss: 255438.8546; train_gene_expr_recon_loss: 120088.6781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378837.1803; train_optim_loss: 378837.1803; val_kl_reg_loss: 3229.7546; val_edge_recon_loss: 255169.2783; val_gene_expr_recon_loss: 122751.9828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381151.0161; val_optim_loss: 381151.0161
Epoch 33/200 |███-----------------| 16.5% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 3304.2853; train_edge_recon_loss: 255350.0160; train_gene_expr_recon_loss: 120042.4572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378696.7584; train_optim_loss: 378696.7584; val_kl_reg_loss: 3235.7126; val_edge_recon_loss: 254962.6878; val_gene_expr_recon_loss: 122965.0433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381163.4421; val_optim_loss: 381163.4421
Epoch 34/200 |███-----------------| 17.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 3295.7450; train_edge_recon_loss: 255432.4006; train_gene_expr_recon_loss: 119951.4033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378679.5491; train_optim_loss: 378679.5491; val_kl_reg_loss: 3226.7831; val_edge_recon_loss: 254867.9055; val_gene_expr_recon_loss: 122821.0263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380915.7157; val_optim_loss: 380915.7157
Epoch 35/200 |███-----------------| 17.5% val_auroc_score: 0.9983; val_auprc_score: 0.9976; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 3288.4981; train_edge_recon_loss: 255427.9236; train_gene_expr_recon_loss: 119895.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378611.8656; train_optim_loss: 378611.8656; val_kl_reg_loss: 3217.1255; val_edge_recon_loss: 254985.7563; val_gene_expr_recon_loss: 122720.4306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380923.3138; val_optim_loss: 380923.3138
Epoch 36/200 |███-----------------| 18.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 3281.2862; train_edge_recon_loss: 255351.5605; train_gene_expr_recon_loss: 119860.6916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378493.5382; train_optim_loss: 378493.5382; val_kl_reg_loss: 3223.9073; val_edge_recon_loss: 255148.9233; val_gene_expr_recon_loss: 122738.4988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381111.3294; val_optim_loss: 381111.3294
Epoch 37/200 |███-----------------| 18.5% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 3272.8387; train_edge_recon_loss: 255443.5958; train_gene_expr_recon_loss: 120044.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378760.4651; train_optim_loss: 378760.4651; val_kl_reg_loss: 3221.6240; val_edge_recon_loss: 255480.4442; val_gene_expr_recon_loss: 122830.7816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381532.8509; val_optim_loss: 381532.8509

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/200 |███-----------------| 19.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 3270.7525; train_edge_recon_loss: 255474.6727; train_gene_expr_recon_loss: 119939.0777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378684.5027; train_optim_loss: 378684.5027; val_kl_reg_loss: 3222.4047; val_edge_recon_loss: 255168.9020; val_gene_expr_recon_loss: 123103.1315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381494.4386; val_optim_loss: 381494.4386
Epoch 39/200 |███-----------------| 19.5% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 3269.1881; train_edge_recon_loss: 255394.4664; train_gene_expr_recon_loss: 120058.7314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378722.3856; train_optim_loss: 378722.3856; val_kl_reg_loss: 3221.4416; val_edge_recon_loss: 255395.3277; val_gene_expr_recon_loss: 122794.1876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381410.9568; val_optim_loss: 381410.9568
Epoch 40/200 |████----------------| 20.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 3267.3105; train_edge_recon_loss: 255461.4650; train_gene_expr_recon_loss: 120018.5081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378747.2834; train_optim_loss: 378747.2834; val_kl_reg_loss: 3219.8862; val_edge_recon_loss: 255402.9133; val_gene_expr_recon_loss: 122878.3201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381501.1198; val_optim_loss: 381501.1198

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 259 min 51 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9984
Val AUPRC score: 0.9977
Val best accuracy score: 0.9882
Val best F1 score: 0.9882
Val gene expr MSE score: 0.3904
Duration of model training in run 7: 4 hours, 21 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 663499
Number of validation edges: 73722
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9878; val_auprc_score: 0.9851; val_best_acc_score: 0.9509; val_best_f1_score: 0.9517; train_kl_reg_loss: 4607.4583; train_edge_recon_loss: 266205.9076; train_gene_expr_recon_loss: 126457.8755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397271.2417; train_optim_loss: 397271.2417; val_kl_reg_loss: 4514.1411; val_edge_recon_loss: 260930.9068; val_gene_expr_recon_loss: 123632.0320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389077.0790; val_optim_loss: 389077.0790
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9916; val_auprc_score: 0.9894; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 4579.7111; train_edge_recon_loss: 260294.2588; train_gene_expr_recon_loss: 123572.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388446.9107; train_optim_loss: 388446.9107; val_kl_reg_loss: 4498.2039; val_edge_recon_loss: 259499.2364; val_gene_expr_recon_loss: 122567.2176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386564.6573; val_optim_loss: 386564.6573
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9935; val_auprc_score: 0.9915; val_best_acc_score: 0.9688; val_best_f1_score: 0.9692; train_kl_reg_loss: 4562.4983; train_edge_recon_loss: 259303.7662; train_gene_expr_recon_loss: 122500.4139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386366.6781; train_optim_loss: 386366.6781; val_kl_reg_loss: 4544.6282; val_edge_recon_loss: 258618.4413; val_gene_expr_recon_loss: 121809.3613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384972.4301; val_optim_loss: 384972.4301
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9933; val_best_acc_score: 0.9738; val_best_f1_score: 0.9741; train_kl_reg_loss: 4546.7488; train_edge_recon_loss: 258634.2488; train_gene_expr_recon_loss: 122185.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385366.4060; train_optim_loss: 385366.4060; val_kl_reg_loss: 4454.1834; val_edge_recon_loss: 258166.4906; val_gene_expr_recon_loss: 122091.3035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384711.9783; val_optim_loss: 384711.9783
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9782; val_best_f1_score: 0.9784; train_kl_reg_loss: 4536.7780; train_edge_recon_loss: 258221.5652; train_gene_expr_recon_loss: 121871.2893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384629.6333; train_optim_loss: 384629.6333; val_kl_reg_loss: 4545.5289; val_edge_recon_loss: 257398.1255; val_gene_expr_recon_loss: 121374.1116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383317.7661; val_optim_loss: 383317.7661
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9961; val_auprc_score: 0.9950; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 4528.9778; train_edge_recon_loss: 257922.7988; train_gene_expr_recon_loss: 121684.8895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384136.6658; train_optim_loss: 384136.6658; val_kl_reg_loss: 4491.8899; val_edge_recon_loss: 256791.7325; val_gene_expr_recon_loss: 121754.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383037.8937; val_optim_loss: 383037.8937
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9965; val_auprc_score: 0.9952; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 4529.3456; train_edge_recon_loss: 257546.4001; train_gene_expr_recon_loss: 121688.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383764.5717; train_optim_loss: 383764.5717; val_kl_reg_loss: 4472.0516; val_edge_recon_loss: 257224.5156; val_gene_expr_recon_loss: 121243.4582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382940.0265; val_optim_loss: 382940.0265
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9816; val_best_f1_score: 0.9818; train_kl_reg_loss: 4529.3690; train_edge_recon_loss: 257270.0230; train_gene_expr_recon_loss: 121697.2301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383496.6216; train_optim_loss: 383496.6216; val_kl_reg_loss: 4486.0772; val_edge_recon_loss: 256674.4693; val_gene_expr_recon_loss: 121177.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382337.7726; val_optim_loss: 382337.7726
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 4529.0226; train_edge_recon_loss: 257083.6622; train_gene_expr_recon_loss: 121456.3040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383068.9891; train_optim_loss: 383068.9891; val_kl_reg_loss: 4618.7053; val_edge_recon_loss: 256504.7511; val_gene_expr_recon_loss: 121584.8914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382708.3490; val_optim_loss: 382708.3490
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9840; val_best_f1_score: 0.9841; train_kl_reg_loss: 4535.0057; train_edge_recon_loss: 256855.6671; train_gene_expr_recon_loss: 121402.9935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382793.6661; train_optim_loss: 382793.6661; val_kl_reg_loss: 4519.6062; val_edge_recon_loss: 256345.6541; val_gene_expr_recon_loss: 121317.0093; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382182.2682; val_optim_loss: 382182.2682
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 4536.6147; train_edge_recon_loss: 256823.8261; train_gene_expr_recon_loss: 121318.7703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382679.2112; train_optim_loss: 382679.2112; val_kl_reg_loss: 4396.8561; val_edge_recon_loss: 256058.6143; val_gene_expr_recon_loss: 121807.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382262.7333; val_optim_loss: 382262.7333
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9976; val_auprc_score: 0.9964; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 4534.6656; train_edge_recon_loss: 256679.4677; train_gene_expr_recon_loss: 121237.0340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382451.1672; train_optim_loss: 382451.1672; val_kl_reg_loss: 4579.1434; val_edge_recon_loss: 256064.2422; val_gene_expr_recon_loss: 121511.0674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382154.4533; val_optim_loss: 382154.4533
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9978; val_auprc_score: 0.9972; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 4542.3380; train_edge_recon_loss: 256525.7439; train_gene_expr_recon_loss: 121249.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382317.3463; train_optim_loss: 382317.3463; val_kl_reg_loss: 4499.1803; val_edge_recon_loss: 255857.9385; val_gene_expr_recon_loss: 121663.7096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382020.8268; val_optim_loss: 382020.8268
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 4546.1183; train_edge_recon_loss: 256539.2297; train_gene_expr_recon_loss: 121113.7798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382199.1274; train_optim_loss: 382199.1274; val_kl_reg_loss: 4557.3132; val_edge_recon_loss: 255782.3637; val_gene_expr_recon_loss: 121496.1676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381835.8442; val_optim_loss: 381835.8442
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 4549.0930; train_edge_recon_loss: 256377.4450; train_gene_expr_recon_loss: 121134.7901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382061.3280; train_optim_loss: 382061.3280; val_kl_reg_loss: 4443.2509; val_edge_recon_loss: 255615.9695; val_gene_expr_recon_loss: 121497.9482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381557.1686; val_optim_loss: 381557.1686
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9978; val_auprc_score: 0.9967; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 4556.5961; train_edge_recon_loss: 256228.8971; train_gene_expr_recon_loss: 121079.1488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381864.6420; train_optim_loss: 381864.6420; val_kl_reg_loss: 4513.5678; val_edge_recon_loss: 255617.5326; val_gene_expr_recon_loss: 121229.4749; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381360.5766; val_optim_loss: 381360.5766
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 4558.4420; train_edge_recon_loss: 256221.5727; train_gene_expr_recon_loss: 120975.7387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381755.7534; train_optim_loss: 381755.7534; val_kl_reg_loss: 4620.1727; val_edge_recon_loss: 255699.6502; val_gene_expr_recon_loss: 121410.0289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381729.8531; val_optim_loss: 381729.8531
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 4564.9186; train_edge_recon_loss: 256104.6896; train_gene_expr_recon_loss: 120866.0016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381535.6095; train_optim_loss: 381535.6095; val_kl_reg_loss: 4548.3921; val_edge_recon_loss: 255535.9769; val_gene_expr_recon_loss: 121772.3116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381856.6814; val_optim_loss: 381856.6814
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 4568.0559; train_edge_recon_loss: 256152.5144; train_gene_expr_recon_loss: 120789.9755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381510.5458; train_optim_loss: 381510.5458; val_kl_reg_loss: 4598.2290; val_edge_recon_loss: 255570.6454; val_gene_expr_recon_loss: 121561.6568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381730.5317; val_optim_loss: 381730.5317

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 4565.0117; train_edge_recon_loss: 255894.8685; train_gene_expr_recon_loss: 120481.8995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380941.7796; train_optim_loss: 380941.7796; val_kl_reg_loss: 4545.3662; val_edge_recon_loss: 255306.5916; val_gene_expr_recon_loss: 121296.9223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381148.8791; val_optim_loss: 381148.8791
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 4559.0190; train_edge_recon_loss: 255813.7457; train_gene_expr_recon_loss: 120430.8312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380803.5961; train_optim_loss: 380803.5961; val_kl_reg_loss: 4540.9825; val_edge_recon_loss: 255247.6927; val_gene_expr_recon_loss: 121567.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381356.3702; val_optim_loss: 381356.3702
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 4558.3754; train_edge_recon_loss: 255836.2356; train_gene_expr_recon_loss: 120246.2814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380640.8927; train_optim_loss: 380640.8927; val_kl_reg_loss: 4542.5878; val_edge_recon_loss: 255260.3101; val_gene_expr_recon_loss: 121542.3089; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381345.2053; val_optim_loss: 381345.2053
Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 4556.7675; train_edge_recon_loss: 255798.9295; train_gene_expr_recon_loss: 120308.5037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380664.2010; train_optim_loss: 380664.2010; val_kl_reg_loss: 4505.9292; val_edge_recon_loss: 255161.8579; val_gene_expr_recon_loss: 121710.2283; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381378.0148; val_optim_loss: 381378.0148

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 4556.1259; train_edge_recon_loss: 255807.6781; train_gene_expr_recon_loss: 120239.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380603.7964; train_optim_loss: 380603.7964; val_kl_reg_loss: 4537.5906; val_edge_recon_loss: 255175.3506; val_gene_expr_recon_loss: 122008.6463; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381721.5875; val_optim_loss: 381721.5875
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 4553.9507; train_edge_recon_loss: 255754.7385; train_gene_expr_recon_loss: 120248.5409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380557.2309; train_optim_loss: 380557.2309; val_kl_reg_loss: 4542.6862; val_edge_recon_loss: 255128.1533; val_gene_expr_recon_loss: 121579.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381250.7602; val_optim_loss: 381250.7602
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 4454.3406; train_edge_recon_loss: 255867.9856; train_gene_expr_recon_loss: 120364.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380686.8996; train_optim_loss: 380686.8996; val_kl_reg_loss: 3761.8903; val_edge_recon_loss: 255203.7334; val_gene_expr_recon_loss: 121309.7310; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380275.3537; val_optim_loss: 380275.3537
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 4165.2940; train_edge_recon_loss: 255916.6898; train_gene_expr_recon_loss: 120230.6939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380312.6779; train_optim_loss: 380312.6779; val_kl_reg_loss: 3460.8547; val_edge_recon_loss: 255299.5406; val_gene_expr_recon_loss: 121444.5458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380204.9408; val_optim_loss: 380204.9408
Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9986; val_auprc_score: 0.9983; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 3890.6838; train_edge_recon_loss: 255710.8797; train_gene_expr_recon_loss: 120249.0892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379850.6524; train_optim_loss: 379850.6524; val_kl_reg_loss: 3219.0384; val_edge_recon_loss: 255352.4677; val_gene_expr_recon_loss: 121675.2986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380246.8049; val_optim_loss: 380246.8049
Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9986; val_auprc_score: 0.9984; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 3675.5685; train_edge_recon_loss: 255713.7045; train_gene_expr_recon_loss: 120201.7171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379590.9898; train_optim_loss: 379590.9898; val_kl_reg_loss: 3072.2118; val_edge_recon_loss: 255409.6645; val_gene_expr_recon_loss: 121593.9019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380075.7793; val_optim_loss: 380075.7793
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9985; val_auprc_score: 0.9978; val_best_acc_score: 0.9882; val_best_f1_score: 0.9882; train_kl_reg_loss: 3558.9659; train_edge_recon_loss: 255588.7057; train_gene_expr_recon_loss: 120351.5133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379499.1850; train_optim_loss: 379499.1850; val_kl_reg_loss: 3043.0435; val_edge_recon_loss: 255563.9200; val_gene_expr_recon_loss: 121746.6419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380353.6061; val_optim_loss: 380353.6061
Epoch 31/200 |███-----------------| 15.5% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 3501.4561; train_edge_recon_loss: 255712.8966; train_gene_expr_recon_loss: 120389.4719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379603.8241; train_optim_loss: 379603.8241; val_kl_reg_loss: 3041.3155; val_edge_recon_loss: 255436.0927; val_gene_expr_recon_loss: 121332.9580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379810.3650; val_optim_loss: 379810.3650
Epoch 32/200 |███-----------------| 16.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9886; val_best_f1_score: 0.9886; train_kl_reg_loss: 3451.2788; train_edge_recon_loss: 255507.5136; train_gene_expr_recon_loss: 120347.8980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379306.6905; train_optim_loss: 379306.6905; val_kl_reg_loss: 3047.2356; val_edge_recon_loss: 255228.3081; val_gene_expr_recon_loss: 121579.4798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379855.0241; val_optim_loss: 379855.0241
Epoch 33/200 |███-----------------| 16.5% val_auroc_score: 0.9985; val_auprc_score: 0.9978; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 3400.0884; train_edge_recon_loss: 255513.5485; train_gene_expr_recon_loss: 120187.3325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379100.9696; train_optim_loss: 379100.9696; val_kl_reg_loss: 3034.6970; val_edge_recon_loss: 255250.0857; val_gene_expr_recon_loss: 121378.7523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379663.5360; val_optim_loss: 379663.5360
Epoch 34/200 |███-----------------| 17.0% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 3351.6080; train_edge_recon_loss: 255461.5183; train_gene_expr_recon_loss: 120350.5575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379163.6834; train_optim_loss: 379163.6834; val_kl_reg_loss: 3033.0311; val_edge_recon_loss: 255417.4800; val_gene_expr_recon_loss: 121229.4608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379679.9727; val_optim_loss: 379679.9727
Epoch 35/200 |███-----------------| 17.5% val_auroc_score: 0.9986; val_auprc_score: 0.9980; val_best_acc_score: 0.9885; val_best_f1_score: 0.9886; train_kl_reg_loss: 3309.1932; train_edge_recon_loss: 255518.7229; train_gene_expr_recon_loss: 120312.5184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379140.4341; train_optim_loss: 379140.4341; val_kl_reg_loss: 3028.1453; val_edge_recon_loss: 255465.1561; val_gene_expr_recon_loss: 121480.6780; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379973.9776; val_optim_loss: 379973.9776
Epoch 36/200 |███-----------------| 18.0% val_auroc_score: 0.9987; val_auprc_score: 0.9983; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 3273.3045; train_edge_recon_loss: 255495.3316; train_gene_expr_recon_loss: 120153.7925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378922.4288; train_optim_loss: 378922.4288; val_kl_reg_loss: 3017.5903; val_edge_recon_loss: 255492.8095; val_gene_expr_recon_loss: 121337.7326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379848.1328; val_optim_loss: 379848.1328

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 37/200 |███-----------------| 18.5% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9883; val_best_f1_score: 0.9883; train_kl_reg_loss: 3255.1500; train_edge_recon_loss: 255402.0710; train_gene_expr_recon_loss: 120313.3018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378970.5228; train_optim_loss: 378970.5228; val_kl_reg_loss: 3020.2496; val_edge_recon_loss: 255288.6185; val_gene_expr_recon_loss: 121642.1570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379951.0247; val_optim_loss: 379951.0247
Epoch 38/200 |███-----------------| 19.0% val_auroc_score: 0.9986; val_auprc_score: 0.9981; val_best_acc_score: 0.9888; val_best_f1_score: 0.9888; train_kl_reg_loss: 3251.3744; train_edge_recon_loss: 255471.7108; train_gene_expr_recon_loss: 120232.6469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378955.7326; train_optim_loss: 378955.7326; val_kl_reg_loss: 3020.0273; val_edge_recon_loss: 255257.2289; val_gene_expr_recon_loss: 121677.2051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379954.4607; val_optim_loss: 379954.4607
Epoch 39/200 |███-----------------| 19.5% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9885; val_best_f1_score: 0.9885; train_kl_reg_loss: 3247.0293; train_edge_recon_loss: 255479.3695; train_gene_expr_recon_loss: 120222.9893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378949.3883; train_optim_loss: 378949.3883; val_kl_reg_loss: 3018.3431; val_edge_recon_loss: 255343.5164; val_gene_expr_recon_loss: 121568.7038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379930.5629; val_optim_loss: 379930.5629

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 252 min 11 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
Val AUROC score: 0.9986
Val AUPRC score: 0.9982
Val best accuracy score: 0.9888
Val best F1 score: 0.9889
Val gene expr MSE score: 0.3816
Duration of model training in run 8: 4 hours, 13 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 825073
Number of validation edges: 91674
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9907; val_auprc_score: 0.9880; val_best_acc_score: 0.9619; val_best_f1_score: 0.9626; train_kl_reg_loss: 4587.9458; train_edge_recon_loss: 263556.7741; train_gene_expr_recon_loss: 125931.9797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394076.6993; train_optim_loss: 394076.6993; val_kl_reg_loss: 4579.4965; val_edge_recon_loss: 259516.5255; val_gene_expr_recon_loss: 122666.3175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386762.3396; val_optim_loss: 386762.3396
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9945; val_auprc_score: 0.9929; val_best_acc_score: 0.9721; val_best_f1_score: 0.9724; train_kl_reg_loss: 4564.5726; train_edge_recon_loss: 259295.0692; train_gene_expr_recon_loss: 122712.1521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386571.7944; train_optim_loss: 386571.7944; val_kl_reg_loss: 4633.5514; val_edge_recon_loss: 258390.2409; val_gene_expr_recon_loss: 121449.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384473.2654; val_optim_loss: 384473.2654
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9958; val_auprc_score: 0.9946; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 4545.2665; train_edge_recon_loss: 258278.4839; train_gene_expr_recon_loss: 122273.0276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385096.7781; train_optim_loss: 385096.7781; val_kl_reg_loss: 4608.6289; val_edge_recon_loss: 257271.2968; val_gene_expr_recon_loss: 121750.4250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383630.3500; val_optim_loss: 383630.3500
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9962; val_auprc_score: 0.9951; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 4533.4928; train_edge_recon_loss: 257603.7155; train_gene_expr_recon_loss: 122127.1665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384264.3747; train_optim_loss: 384264.3747; val_kl_reg_loss: 4468.0889; val_edge_recon_loss: 256527.2897; val_gene_expr_recon_loss: 121654.8457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382650.2241; val_optim_loss: 382650.2241
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 4531.0652; train_edge_recon_loss: 257248.5480; train_gene_expr_recon_loss: 121901.1214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383680.7347; train_optim_loss: 383680.7347; val_kl_reg_loss: 4313.2300; val_edge_recon_loss: 256577.7825; val_gene_expr_recon_loss: 121497.8621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382388.8754; val_optim_loss: 382388.8754
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9972; val_auprc_score: 0.9964; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 4531.3545; train_edge_recon_loss: 256988.0159; train_gene_expr_recon_loss: 121804.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383323.9638; train_optim_loss: 383323.9638; val_kl_reg_loss: 4499.6486; val_edge_recon_loss: 256230.5618; val_gene_expr_recon_loss: 121528.3546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382258.5651; val_optim_loss: 382258.5651
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 4531.7786; train_edge_recon_loss: 256789.5192; train_gene_expr_recon_loss: 121742.9916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383064.2893; train_optim_loss: 383064.2893; val_kl_reg_loss: 4534.5950; val_edge_recon_loss: 255831.2482; val_gene_expr_recon_loss: 121736.2285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382102.0714; val_optim_loss: 382102.0714
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9851; val_best_f1_score: 0.9852; train_kl_reg_loss: 4535.5133; train_edge_recon_loss: 256607.2981; train_gene_expr_recon_loss: 121587.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382730.7096; train_optim_loss: 382730.7096; val_kl_reg_loss: 4512.3980; val_edge_recon_loss: 255713.4229; val_gene_expr_recon_loss: 121820.9654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382046.7866; val_optim_loss: 382046.7866
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 4542.5419; train_edge_recon_loss: 256331.7153; train_gene_expr_recon_loss: 121698.1433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382572.4011; train_optim_loss: 382572.4011; val_kl_reg_loss: 4576.7627; val_edge_recon_loss: 255520.1069; val_gene_expr_recon_loss: 121496.7104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381593.5796; val_optim_loss: 381593.5796
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 4542.5241; train_edge_recon_loss: 256283.6015; train_gene_expr_recon_loss: 121527.7638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382353.8893; train_optim_loss: 382353.8893; val_kl_reg_loss: 4567.3233; val_edge_recon_loss: 255680.9980; val_gene_expr_recon_loss: 121405.0707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381653.3915; val_optim_loss: 381653.3915
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9979; val_auprc_score: 0.9974; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 4552.4716; train_edge_recon_loss: 256145.7503; train_gene_expr_recon_loss: 121470.7408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382168.9624; train_optim_loss: 382168.9624; val_kl_reg_loss: 4479.8757; val_edge_recon_loss: 255570.7232; val_gene_expr_recon_loss: 121801.5075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381852.1085; val_optim_loss: 381852.1085
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9980; val_auprc_score: 0.9975; val_best_acc_score: 0.9869; val_best_f1_score: 0.9869; train_kl_reg_loss: 4555.8308; train_edge_recon_loss: 256104.3609; train_gene_expr_recon_loss: 121305.9136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381966.1055; train_optim_loss: 381966.1055; val_kl_reg_loss: 4679.3064; val_edge_recon_loss: 255384.2123; val_gene_expr_recon_loss: 121868.0248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381931.5452; val_optim_loss: 381931.5452

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 4555.6664; train_edge_recon_loss: 255828.5088; train_gene_expr_recon_loss: 120955.8322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381340.0076; train_optim_loss: 381340.0076; val_kl_reg_loss: 4561.7300; val_edge_recon_loss: 254980.0945; val_gene_expr_recon_loss: 121460.3923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381002.2162; val_optim_loss: 381002.2162
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 4545.2311; train_edge_recon_loss: 255790.0267; train_gene_expr_recon_loss: 120967.9877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381303.2454; train_optim_loss: 381303.2454; val_kl_reg_loss: 4529.4364; val_edge_recon_loss: 254913.2262; val_gene_expr_recon_loss: 121750.5287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381193.1909; val_optim_loss: 381193.1909
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 4539.8992; train_edge_recon_loss: 255767.6750; train_gene_expr_recon_loss: 120867.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381174.8333; train_optim_loss: 381174.8333; val_kl_reg_loss: 4513.5416; val_edge_recon_loss: 255159.6419; val_gene_expr_recon_loss: 121452.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381125.5321; val_optim_loss: 381125.5321
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9884; val_best_f1_score: 0.9884; train_kl_reg_loss: 4538.9156; train_edge_recon_loss: 255720.6433; train_gene_expr_recon_loss: 120962.8938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381222.4528; train_optim_loss: 381222.4528; val_kl_reg_loss: 4524.1188; val_edge_recon_loss: 255008.2297; val_gene_expr_recon_loss: 121718.3207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381250.6689; val_optim_loss: 381250.6689

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9984; val_auprc_score: 0.9979; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 4541.2074; train_edge_recon_loss: 255681.8062; train_gene_expr_recon_loss: 120766.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380989.9583; train_optim_loss: 380989.9583; val_kl_reg_loss: 4533.2567; val_edge_recon_loss: 254999.6926; val_gene_expr_recon_loss: 121636.9483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381169.8973; val_optim_loss: 381169.8973
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9985; val_auprc_score: 0.9982; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 4538.5210; train_edge_recon_loss: 255653.8866; train_gene_expr_recon_loss: 120716.5966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380909.0044; train_optim_loss: 380909.0044; val_kl_reg_loss: 4535.4471; val_edge_recon_loss: 254766.1502; val_gene_expr_recon_loss: 121616.2087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380917.8068; val_optim_loss: 380917.8068
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 4537.9577; train_edge_recon_loss: 255658.4830; train_gene_expr_recon_loss: 120744.7609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380941.2015; train_optim_loss: 380941.2015; val_kl_reg_loss: 4533.7050; val_edge_recon_loss: 255062.3609; val_gene_expr_recon_loss: 121246.3046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380842.3713; val_optim_loss: 380842.3713
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 4539.2588; train_edge_recon_loss: 255585.8111; train_gene_expr_recon_loss: 120694.2702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380819.3400; train_optim_loss: 380819.3400; val_kl_reg_loss: 4526.6492; val_edge_recon_loss: 254891.5696; val_gene_expr_recon_loss: 121068.8741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380487.0935; val_optim_loss: 380487.0935
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9887; val_best_f1_score: 0.9887; train_kl_reg_loss: 4538.2048; train_edge_recon_loss: 255664.5801; train_gene_expr_recon_loss: 120778.0483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380980.8331; train_optim_loss: 380980.8331; val_kl_reg_loss: 4533.6884; val_edge_recon_loss: 254665.6200; val_gene_expr_recon_loss: 121594.3225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380793.6295; val_optim_loss: 380793.6295
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 4539.0071; train_edge_recon_loss: 255630.8802; train_gene_expr_recon_loss: 120813.1032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380982.9904; train_optim_loss: 380982.9904; val_kl_reg_loss: 4538.7959; val_edge_recon_loss: 254846.2886; val_gene_expr_recon_loss: 121736.5316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381121.6157; val_optim_loss: 381121.6157
Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 4538.9442; train_edge_recon_loss: 255599.4228; train_gene_expr_recon_loss: 120692.3141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380830.6814; train_optim_loss: 380830.6814; val_kl_reg_loss: 4531.2668; val_edge_recon_loss: 255067.6323; val_gene_expr_recon_loss: 121600.7228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381199.6220; val_optim_loss: 381199.6220

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9986; val_auprc_score: 0.9979; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 4537.9146; train_edge_recon_loss: 255490.8829; train_gene_expr_recon_loss: 120686.6984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380715.4958; train_optim_loss: 380715.4958; val_kl_reg_loss: 4536.0282; val_edge_recon_loss: 254721.4062; val_gene_expr_recon_loss: 121756.5197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381013.9543; val_optim_loss: 381013.9543
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 4538.3622; train_edge_recon_loss: 255596.8753; train_gene_expr_recon_loss: 120630.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380766.0344; train_optim_loss: 380766.0344; val_kl_reg_loss: 4532.4407; val_edge_recon_loss: 254854.0153; val_gene_expr_recon_loss: 121630.5553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381017.0112; val_optim_loss: 381017.0112
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9889; val_best_f1_score: 0.9889; train_kl_reg_loss: 4544.1004; train_edge_recon_loss: 255815.0794; train_gene_expr_recon_loss: 120753.5960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381112.7757; train_optim_loss: 381112.7757; val_kl_reg_loss: 4060.9967; val_edge_recon_loss: 254995.7135; val_gene_expr_recon_loss: 121654.3075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380711.0171; val_optim_loss: 380711.0171

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 313 min 19 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9985
Val AUPRC score: 0.9980
Val best accuracy score: 0.9888
Val best F1 score: 0.9889
Val gene expr MSE score: 0.3848
Duration of model training in run 9: 5 hours, 16 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 75259
Number of validation nodes: 8362
Number of training edges: 825073
Number of validation edges: 91674
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/200 |--------------------| 0.5% val_auroc_score: 0.9911; val_auprc_score: 0.9887; val_best_acc_score: 0.9602; val_best_f1_score: 0.9606; train_kl_reg_loss: 4603.8150; train_edge_recon_loss: 263501.4280; train_gene_expr_recon_loss: 125640.0457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393745.2888; train_optim_loss: 393745.2888; val_kl_reg_loss: 4520.9885; val_edge_recon_loss: 259591.5561; val_gene_expr_recon_loss: 124179.4066; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388291.9509; val_optim_loss: 388291.9509
Epoch 2/200 |--------------------| 1.0% val_auroc_score: 0.9942; val_auprc_score: 0.9926; val_best_acc_score: 0.9734; val_best_f1_score: 0.9737; train_kl_reg_loss: 4571.1776; train_edge_recon_loss: 259222.2462; train_gene_expr_recon_loss: 122562.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386356.1482; train_optim_loss: 386356.1482; val_kl_reg_loss: 4447.6745; val_edge_recon_loss: 258197.4460; val_gene_expr_recon_loss: 123517.6725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386162.7941; val_optim_loss: 386162.7941
Epoch 3/200 |--------------------| 1.5% val_auroc_score: 0.9953; val_auprc_score: 0.9939; val_best_acc_score: 0.9774; val_best_f1_score: 0.9777; train_kl_reg_loss: 4546.0652; train_edge_recon_loss: 258233.0946; train_gene_expr_recon_loss: 122058.7518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384837.9111; train_optim_loss: 384837.9111; val_kl_reg_loss: 4678.2254; val_edge_recon_loss: 257332.5134; val_gene_expr_recon_loss: 123172.7597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385183.4990; val_optim_loss: 385183.4990
Epoch 4/200 |--------------------| 2.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 4536.6863; train_edge_recon_loss: 257593.2301; train_gene_expr_recon_loss: 121902.5992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384032.5157; train_optim_loss: 384032.5157; val_kl_reg_loss: 4514.0365; val_edge_recon_loss: 256868.4529; val_gene_expr_recon_loss: 123098.7781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384481.2677; val_optim_loss: 384481.2677
Epoch 5/200 |--------------------| 2.5% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 4529.8562; train_edge_recon_loss: 257255.7615; train_gene_expr_recon_loss: 121780.3115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383565.9290; train_optim_loss: 383565.9290; val_kl_reg_loss: 4453.6175; val_edge_recon_loss: 256592.8622; val_gene_expr_recon_loss: 123265.3308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384311.8109; val_optim_loss: 384311.8109
Epoch 6/200 |--------------------| 3.0% val_auroc_score: 0.9969; val_auprc_score: 0.9961; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 4529.2255; train_edge_recon_loss: 256937.8705; train_gene_expr_recon_loss: 121627.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383094.5135; train_optim_loss: 383094.5135; val_kl_reg_loss: 4610.6252; val_edge_recon_loss: 256194.5581; val_gene_expr_recon_loss: 123060.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383865.5628; val_optim_loss: 383865.5628
Epoch 7/200 |--------------------| 3.5% val_auroc_score: 0.9974; val_auprc_score: 0.9966; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 4535.1415; train_edge_recon_loss: 256735.3530; train_gene_expr_recon_loss: 121464.9714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382735.4661; train_optim_loss: 382735.4661; val_kl_reg_loss: 4448.6466; val_edge_recon_loss: 256028.9612; val_gene_expr_recon_loss: 123219.9917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383697.6003; val_optim_loss: 383697.6003
Epoch 8/200 |--------------------| 4.0% val_auroc_score: 0.9975; val_auprc_score: 0.9968; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 4538.3421; train_edge_recon_loss: 256563.5667; train_gene_expr_recon_loss: 121447.5171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382549.4261; train_optim_loss: 382549.4261; val_kl_reg_loss: 4490.8366; val_edge_recon_loss: 255724.3227; val_gene_expr_recon_loss: 122971.7585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383186.9178; val_optim_loss: 383186.9178
Epoch 9/200 |--------------------| 4.5% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 4542.8092; train_edge_recon_loss: 256452.7286; train_gene_expr_recon_loss: 121388.8456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382384.3835; train_optim_loss: 382384.3835; val_kl_reg_loss: 4575.5701; val_edge_recon_loss: 255811.0773; val_gene_expr_recon_loss: 123073.6683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383460.3160; val_optim_loss: 383460.3160
Epoch 10/200 |█-------------------| 5.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 4546.8021; train_edge_recon_loss: 256322.4832; train_gene_expr_recon_loss: 121384.9937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382254.2792; train_optim_loss: 382254.2792; val_kl_reg_loss: 4461.8220; val_edge_recon_loss: 255627.4407; val_gene_expr_recon_loss: 123150.1932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383239.4560; val_optim_loss: 383239.4560
Epoch 11/200 |█-------------------| 5.5% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 4551.6616; train_edge_recon_loss: 256101.1396; train_gene_expr_recon_loss: 121239.0121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381891.8131; train_optim_loss: 381891.8131; val_kl_reg_loss: 4593.9721; val_edge_recon_loss: 255432.8983; val_gene_expr_recon_loss: 123011.6652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383038.5358; val_optim_loss: 383038.5358
Epoch 12/200 |█-------------------| 6.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9862; val_best_f1_score: 0.9863; train_kl_reg_loss: 4557.8857; train_edge_recon_loss: 255969.6033; train_gene_expr_recon_loss: 121179.6090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381707.0978; train_optim_loss: 381707.0978; val_kl_reg_loss: 4528.1031; val_edge_recon_loss: 255383.4723; val_gene_expr_recon_loss: 123267.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383178.6286; val_optim_loss: 383178.6286
Epoch 13/200 |█-------------------| 6.5% val_auroc_score: 0.9978; val_auprc_score: 0.9967; val_best_acc_score: 0.9864; val_best_f1_score: 0.9865; train_kl_reg_loss: 4560.0272; train_edge_recon_loss: 255987.5985; train_gene_expr_recon_loss: 121121.3364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381668.9625; train_optim_loss: 381668.9625; val_kl_reg_loss: 4621.6842; val_edge_recon_loss: 255236.9781; val_gene_expr_recon_loss: 122888.3740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382747.0358; val_optim_loss: 382747.0358
Epoch 14/200 |█-------------------| 7.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 4567.3405; train_edge_recon_loss: 255840.1754; train_gene_expr_recon_loss: 121164.6737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381572.1897; train_optim_loss: 381572.1897; val_kl_reg_loss: 4643.7315; val_edge_recon_loss: 255084.3387; val_gene_expr_recon_loss: 123070.2658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382798.3359; val_optim_loss: 382798.3359
Epoch 15/200 |█-------------------| 7.5% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 4573.5545; train_edge_recon_loss: 255740.9285; train_gene_expr_recon_loss: 121069.8569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381384.3396; train_optim_loss: 381384.3396; val_kl_reg_loss: 4648.8406; val_edge_recon_loss: 255140.2107; val_gene_expr_recon_loss: 123309.1819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383098.2335; val_optim_loss: 383098.2335
Epoch 16/200 |█-------------------| 8.0% val_auroc_score: 0.9982; val_auprc_score: 0.9978; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 4577.4787; train_edge_recon_loss: 255736.6904; train_gene_expr_recon_loss: 121033.8873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381348.0564; train_optim_loss: 381348.0564; val_kl_reg_loss: 4529.5356; val_edge_recon_loss: 254900.6394; val_gene_expr_recon_loss: 123252.3087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382682.4838; val_optim_loss: 382682.4838
Epoch 17/200 |█-------------------| 8.5% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 4583.1170; train_edge_recon_loss: 255694.1151; train_gene_expr_recon_loss: 120895.8510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381173.0828; train_optim_loss: 381173.0828; val_kl_reg_loss: 4602.1398; val_edge_recon_loss: 254921.7716; val_gene_expr_recon_loss: 123406.5099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382930.4217; val_optim_loss: 382930.4217
Epoch 18/200 |█-------------------| 9.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9876; val_best_f1_score: 0.9877; train_kl_reg_loss: 4589.0617; train_edge_recon_loss: 255591.6544; train_gene_expr_recon_loss: 120795.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380976.2944; train_optim_loss: 380976.2944; val_kl_reg_loss: 4602.7628; val_edge_recon_loss: 254928.2564; val_gene_expr_recon_loss: 123220.0318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382751.0505; val_optim_loss: 382751.0505
Epoch 19/200 |█-------------------| 9.5% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 4591.5156; train_edge_recon_loss: 255569.4967; train_gene_expr_recon_loss: 120873.3782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381034.3907; train_optim_loss: 381034.3907; val_kl_reg_loss: 4575.0892; val_edge_recon_loss: 254759.4005; val_gene_expr_recon_loss: 123116.8249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382451.3133; val_optim_loss: 382451.3133
Epoch 20/200 |██------------------| 10.0% val_auroc_score: 0.9983; val_auprc_score: 0.9975; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 4597.1247; train_edge_recon_loss: 255541.0875; train_gene_expr_recon_loss: 120664.9194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380803.1313; train_optim_loss: 380803.1313; val_kl_reg_loss: 4655.6073; val_edge_recon_loss: 254757.5796; val_gene_expr_recon_loss: 123541.5617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382954.7490; val_optim_loss: 382954.7490
Epoch 21/200 |██------------------| 10.5% val_auroc_score: 0.9981; val_auprc_score: 0.9976; val_best_acc_score: 0.9875; val_best_f1_score: 0.9875; train_kl_reg_loss: 4599.4695; train_edge_recon_loss: 255521.9187; train_gene_expr_recon_loss: 120731.3532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380852.7414; train_optim_loss: 380852.7414; val_kl_reg_loss: 4669.0986; val_edge_recon_loss: 254725.6702; val_gene_expr_recon_loss: 123205.9138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382600.6833; val_optim_loss: 382600.6833
Epoch 22/200 |██------------------| 11.0% val_auroc_score: 0.9982; val_auprc_score: 0.9977; val_best_acc_score: 0.9881; val_best_f1_score: 0.9881; train_kl_reg_loss: 4605.4423; train_edge_recon_loss: 255418.2722; train_gene_expr_recon_loss: 120736.6365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380760.3507; train_optim_loss: 380760.3507; val_kl_reg_loss: 4702.5109; val_edge_recon_loss: 254717.0549; val_gene_expr_recon_loss: 123074.5405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382494.1058; val_optim_loss: 382494.1058

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/200 |██------------------| 11.5% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 4614.6747; train_edge_recon_loss: 255253.9758; train_gene_expr_recon_loss: 120155.5918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380024.2423; train_optim_loss: 380024.2423; val_kl_reg_loss: 4603.2468; val_edge_recon_loss: 254633.5736; val_gene_expr_recon_loss: 123412.7451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382649.5660; val_optim_loss: 382649.5660
Epoch 24/200 |██------------------| 12.0% val_auroc_score: 0.9984; val_auprc_score: 0.9976; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 4605.3379; train_edge_recon_loss: 255250.2330; train_gene_expr_recon_loss: 120181.5563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380037.1272; train_optim_loss: 380037.1272; val_kl_reg_loss: 4600.4846; val_edge_recon_loss: 254509.0125; val_gene_expr_recon_loss: 123305.1104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382414.6069; val_optim_loss: 382414.6069
Epoch 25/200 |██------------------| 12.5% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 4602.0649; train_edge_recon_loss: 255208.1896; train_gene_expr_recon_loss: 120136.8795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379947.1341; train_optim_loss: 379947.1341; val_kl_reg_loss: 4605.4998; val_edge_recon_loss: 254485.1236; val_gene_expr_recon_loss: 123337.1408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382427.7654; val_optim_loss: 382427.7654
Epoch 26/200 |██------------------| 13.0% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 3633.5975; train_edge_recon_loss: 255225.4548; train_gene_expr_recon_loss: 120157.2405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379016.2924; train_optim_loss: 379016.2924; val_kl_reg_loss: 2312.5288; val_edge_recon_loss: 255263.1710; val_gene_expr_recon_loss: 123384.3678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380960.0670; val_optim_loss: 380960.0670
Epoch 27/200 |██------------------| 13.5% val_auroc_score: 0.9984; val_auprc_score: 0.9980; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 2806.1191; train_edge_recon_loss: 255076.6169; train_gene_expr_recon_loss: 120084.3720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377967.1078; train_optim_loss: 377967.1078; val_kl_reg_loss: 2205.1391; val_edge_recon_loss: 255036.1376; val_gene_expr_recon_loss: 123288.8309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380530.1078; val_optim_loss: 380530.1078
Epoch 28/200 |██------------------| 14.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 2423.8779; train_edge_recon_loss: 254953.0163; train_gene_expr_recon_loss: 120003.7267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377380.6210; train_optim_loss: 377380.6210; val_kl_reg_loss: 2096.7621; val_edge_recon_loss: 255070.6900; val_gene_expr_recon_loss: 123355.6762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380523.1276; val_optim_loss: 380523.1276
Epoch 29/200 |██------------------| 14.5% val_auroc_score: 0.9986; val_auprc_score: 0.9982; val_best_acc_score: 0.9895; val_best_f1_score: 0.9895; train_kl_reg_loss: 2175.3443; train_edge_recon_loss: 254939.9547; train_gene_expr_recon_loss: 120091.5063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377206.8054; train_optim_loss: 377206.8054; val_kl_reg_loss: 1994.4783; val_edge_recon_loss: 254854.2567; val_gene_expr_recon_loss: 123339.9981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380188.7323; val_optim_loss: 380188.7323
Epoch 30/200 |███-----------------| 15.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 2051.2184; train_edge_recon_loss: 254873.7207; train_gene_expr_recon_loss: 120049.5370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376974.4760; train_optim_loss: 376974.4760; val_kl_reg_loss: 1918.8508; val_edge_recon_loss: 254880.7764; val_gene_expr_recon_loss: 123182.4075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379982.0346; val_optim_loss: 379982.0346
Epoch 31/200 |███-----------------| 15.5% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9892; val_best_f1_score: 0.9892; train_kl_reg_loss: 1967.5046; train_edge_recon_loss: 255024.5671; train_gene_expr_recon_loss: 120060.4462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377052.5180; train_optim_loss: 377052.5180; val_kl_reg_loss: 1850.1321; val_edge_recon_loss: 254930.8192; val_gene_expr_recon_loss: 123760.7374; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380541.6892; val_optim_loss: 380541.6892
Epoch 32/200 |███-----------------| 16.0% val_auroc_score: 0.9985; val_auprc_score: 0.9981; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 1901.9786; train_edge_recon_loss: 254910.8169; train_gene_expr_recon_loss: 119977.6639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376790.4594; train_optim_loss: 376790.4594; val_kl_reg_loss: 1778.0191; val_edge_recon_loss: 255161.8750; val_gene_expr_recon_loss: 123505.6635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380445.5568; val_optim_loss: 380445.5568
Epoch 33/200 |███-----------------| 16.5% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 1836.7000; train_edge_recon_loss: 254902.5292; train_gene_expr_recon_loss: 119986.6173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376725.8466; train_optim_loss: 376725.8466; val_kl_reg_loss: 1720.8475; val_edge_recon_loss: 255059.7568; val_gene_expr_recon_loss: 123448.8257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380229.4302; val_optim_loss: 380229.4302

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/200 |███-----------------| 17.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 1810.2278; train_edge_recon_loss: 254885.7581; train_gene_expr_recon_loss: 119887.0717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376583.0575; train_optim_loss: 376583.0575; val_kl_reg_loss: 1714.6942; val_edge_recon_loss: 255011.7261; val_gene_expr_recon_loss: 123368.2978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380094.7181; val_optim_loss: 380094.7181
Epoch 35/200 |███-----------------| 17.5% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9890; val_best_f1_score: 0.9891; train_kl_reg_loss: 1796.2505; train_edge_recon_loss: 254897.1343; train_gene_expr_recon_loss: 119978.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376671.8189; train_optim_loss: 376671.8189; val_kl_reg_loss: 1706.2595; val_edge_recon_loss: 255008.9967; val_gene_expr_recon_loss: 123179.7948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379895.0503; val_optim_loss: 379895.0503
Epoch 36/200 |███-----------------| 18.0% val_auroc_score: 0.9985; val_auprc_score: 0.9979; val_best_acc_score: 0.9895; val_best_f1_score: 0.9896; train_kl_reg_loss: 1777.1330; train_edge_recon_loss: 254919.7064; train_gene_expr_recon_loss: 119871.4745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376568.3142; train_optim_loss: 376568.3142; val_kl_reg_loss: 1696.1687; val_edge_recon_loss: 255164.9478; val_gene_expr_recon_loss: 123133.9616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379995.0783; val_optim_loss: 379995.0783
Epoch 37/200 |███-----------------| 18.5% val_auroc_score: 0.9984; val_auprc_score: 0.9976; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 1758.1541; train_edge_recon_loss: 254852.3845; train_gene_expr_recon_loss: 119904.0733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376514.6116; train_optim_loss: 376514.6116; val_kl_reg_loss: 1687.6559; val_edge_recon_loss: 254950.6351; val_gene_expr_recon_loss: 123574.5439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380212.8349; val_optim_loss: 380212.8349
Epoch 38/200 |███-----------------| 19.0% val_auroc_score: 0.9983; val_auprc_score: 0.9978; val_best_acc_score: 0.9892; val_best_f1_score: 0.9892; train_kl_reg_loss: 1743.7006; train_edge_recon_loss: 254929.7479; train_gene_expr_recon_loss: 119981.1750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376654.6237; train_optim_loss: 376654.6237; val_kl_reg_loss: 1684.1459; val_edge_recon_loss: 255028.8535; val_gene_expr_recon_loss: 123484.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380197.0723; val_optim_loss: 380197.0723

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/200 |███-----------------| 19.5% val_auroc_score: 0.9985; val_auprc_score: 0.9977; val_best_acc_score: 0.9892; val_best_f1_score: 0.9892; train_kl_reg_loss: 1738.0824; train_edge_recon_loss: 254955.8536; train_gene_expr_recon_loss: 119833.5532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376527.4893; train_optim_loss: 376527.4893; val_kl_reg_loss: 1682.3327; val_edge_recon_loss: 254978.5512; val_gene_expr_recon_loss: 123330.9493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379991.8331; val_optim_loss: 379991.8331
Epoch 40/200 |████----------------| 20.0% val_auroc_score: 0.9984; val_auprc_score: 0.9978; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 1736.2126; train_edge_recon_loss: 254917.8815; train_gene_expr_recon_loss: 119875.6569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376529.7508; train_optim_loss: 376529.7508; val_kl_reg_loss: 1679.4493; val_edge_recon_loss: 255033.3175; val_gene_expr_recon_loss: 123366.9098; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380079.6778; val_optim_loss: 380079.6778
Epoch 41/200 |████----------------| 20.5% val_auroc_score: 0.9985; val_auprc_score: 0.9980; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 1735.5301; train_edge_recon_loss: 254936.0080; train_gene_expr_recon_loss: 119829.7201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376501.2582; train_optim_loss: 376501.2582; val_kl_reg_loss: 1678.5909; val_edge_recon_loss: 254912.3803; val_gene_expr_recon_loss: 123264.3512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379855.3229; val_optim_loss: 379855.3229
Epoch 42/200 |████----------------| 21.0% val_auroc_score: 0.9983; val_auprc_score: 0.9975; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 1734.2023; train_edge_recon_loss: 254913.5007; train_gene_expr_recon_loss: 119920.1249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376567.8280; train_optim_loss: 376567.8280; val_kl_reg_loss: 1678.7929; val_edge_recon_loss: 255102.1268; val_gene_expr_recon_loss: 123224.9285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380005.8490; val_optim_loss: 380005.8490
Epoch 43/200 |████----------------| 21.5% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 1732.7579; train_edge_recon_loss: 254916.3062; train_gene_expr_recon_loss: 119905.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376554.6149; train_optim_loss: 376554.6149; val_kl_reg_loss: 1678.6623; val_edge_recon_loss: 255153.2890; val_gene_expr_recon_loss: 123532.9094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380364.8611; val_optim_loss: 380364.8611
Epoch 44/200 |████----------------| 22.0% val_auroc_score: 0.9984; val_auprc_score: 0.9977; val_best_acc_score: 0.9891; val_best_f1_score: 0.9891; train_kl_reg_loss: 1732.0104; train_edge_recon_loss: 254901.5283; train_gene_expr_recon_loss: 119941.4090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376574.9477; train_optim_loss: 376574.9477; val_kl_reg_loss: 1678.0557; val_edge_recon_loss: 254947.7144; val_gene_expr_recon_loss: 123208.8546; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379834.6256; val_optim_loss: 379834.6256
Epoch 45/200 |████----------------| 22.5% val_auroc_score: 0.9985; val_auprc_score: 0.9977; val_best_acc_score: 0.9890; val_best_f1_score: 0.9890; train_kl_reg_loss: 1731.2122; train_edge_recon_loss: 254914.0656; train_gene_expr_recon_loss: 119882.6145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376527.8923; train_optim_loss: 376527.8923; val_kl_reg_loss: 1677.6629; val_edge_recon_loss: 255211.8188; val_gene_expr_recon_loss: 123477.7023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380367.1837; val_optim_loss: 380367.1837
