Run timestamp: 18082023_191958_4.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '--edge_batch_size_list', '512', '512', '--node_batch_size_list', 'None', 'None', '--seeds', '1', '0', '--run_index', '2', '1', '--cell_type_key', 'Cell_Type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'vizgen_merfish_mouse_liver', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 347, n_cat_covariates_embed_input: 0, n_hidden: 347, n_latent: 1378, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347

--- INITIALIZING TRAINER ---
Number of training nodes: 330601
Number of validation nodes: 36734
Number of training edges: 769040
Number of validation edges: 85448
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8773; val_auprc_score: 0.8462; val_best_acc_score: 0.8059; val_best_f1_score: 0.8271; train_kl_reg_loss: 38179.4944; train_edge_recon_loss: 2910910.9242; train_gene_expr_recon_loss: 2409121.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5358211.7355; train_optim_loss: 5358211.7355; val_kl_reg_loss: 36209.4546; val_edge_recon_loss: 2800938.9895; val_gene_expr_recon_loss: 2179785.4880; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5016933.9251; val_optim_loss: 5016933.9251
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8981; val_auprc_score: 0.8692; val_best_acc_score: 0.8302; val_best_f1_score: 0.8465; train_kl_reg_loss: 29940.3516; train_edge_recon_loss: 2728046.2458; train_gene_expr_recon_loss: 2045472.7238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4803459.3144; train_optim_loss: 4803459.3144; val_kl_reg_loss: 27225.8640; val_edge_recon_loss: 2781244.5299; val_gene_expr_recon_loss: 1932603.0457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4741073.4431; val_optim_loss: 4741073.4431
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9113; val_auprc_score: 0.8877; val_best_acc_score: 0.8414; val_best_f1_score: 0.8541; train_kl_reg_loss: 25445.2718; train_edge_recon_loss: 2705802.6236; train_gene_expr_recon_loss: 1865049.3360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4596297.2325; train_optim_loss: 4596297.2325; val_kl_reg_loss: 24098.0010; val_edge_recon_loss: 2755875.4716; val_gene_expr_recon_loss: 1809861.6819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4589835.1287; val_optim_loss: 4589835.1287
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9216; val_auprc_score: 0.8996; val_best_acc_score: 0.8538; val_best_f1_score: 0.8648; train_kl_reg_loss: 23022.8852; train_edge_recon_loss: 2686720.2992; train_gene_expr_recon_loss: 1774412.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4484155.2788; train_optim_loss: 4484155.2788; val_kl_reg_loss: 22455.2614; val_edge_recon_loss: 2743284.5928; val_gene_expr_recon_loss: 1754874.2395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4520614.1078; val_optim_loss: 4520614.1078
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9254; val_auprc_score: 0.9070; val_best_acc_score: 0.8564; val_best_f1_score: 0.8659; train_kl_reg_loss: 22103.4297; train_edge_recon_loss: 2675434.3397; train_gene_expr_recon_loss: 1729016.0032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4426553.7784; train_optim_loss: 4426553.7784; val_kl_reg_loss: 22275.3370; val_edge_recon_loss: 2766270.5344; val_gene_expr_recon_loss: 1722730.2867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4511276.1497; val_optim_loss: 4511276.1497
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9336; val_auprc_score: 0.9157; val_best_acc_score: 0.8673; val_best_f1_score: 0.8754; train_kl_reg_loss: 21526.8411; train_edge_recon_loss: 2666715.5481; train_gene_expr_recon_loss: 1704190.0014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4392432.3842; train_optim_loss: 4392432.3842; val_kl_reg_loss: 21280.8599; val_edge_recon_loss: 2741443.1961; val_gene_expr_recon_loss: 1693079.3847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4455803.4251; val_optim_loss: 4455803.4251
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9368; val_auprc_score: 0.9191; val_best_acc_score: 0.8715; val_best_f1_score: 0.8788; train_kl_reg_loss: 21005.9064; train_edge_recon_loss: 2659362.6530; train_gene_expr_recon_loss: 1687155.3508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4367523.9152; train_optim_loss: 4367523.9152; val_kl_reg_loss: 20923.2184; val_edge_recon_loss: 2744536.5599; val_gene_expr_recon_loss: 1683508.5808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4448968.3713; val_optim_loss: 4448968.3713
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9379; val_auprc_score: 0.9205; val_best_acc_score: 0.8724; val_best_f1_score: 0.8797; train_kl_reg_loss: 20643.2167; train_edge_recon_loss: 2658145.9356; train_gene_expr_recon_loss: 1676740.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4355529.1707; train_optim_loss: 4355529.1707; val_kl_reg_loss: 20639.4624; val_edge_recon_loss: 2732792.0434; val_gene_expr_recon_loss: 1670840.5951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4424272.0928; val_optim_loss: 4424272.0928
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9370; val_auprc_score: 0.9197; val_best_acc_score: 0.8717; val_best_f1_score: 0.8790; train_kl_reg_loss: 20465.8017; train_edge_recon_loss: 2655392.7395; train_gene_expr_recon_loss: 1670133.2918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4345991.8353; train_optim_loss: 4345991.8353; val_kl_reg_loss: 20688.8870; val_edge_recon_loss: 2731504.7470; val_gene_expr_recon_loss: 1667593.3555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4419786.9880; val_optim_loss: 4419786.9880
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9387; val_auprc_score: 0.9218; val_best_acc_score: 0.8733; val_best_f1_score: 0.8804; train_kl_reg_loss: 20180.2184; train_edge_recon_loss: 2655365.7327; train_gene_expr_recon_loss: 1663634.9588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4339180.9145; train_optim_loss: 4339180.9145; val_kl_reg_loss: 20144.5961; val_edge_recon_loss: 2729989.1707; val_gene_expr_recon_loss: 1663216.0606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4413349.8353; val_optim_loss: 4413349.8353
