Run timestamp: 16082023_165031_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'Cell_Type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'vizgen_merfish_mouse_liver', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 347, n_cat_covariates_embed_input: 0, n_hidden: 347, n_latent: 1378, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347

--- INITIALIZING TRAINER ---
Number of training nodes: 330601
Number of validation nodes: 36734
Number of training edges: 2874829
Number of validation edges: 319425
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9139; val_auprc_score: 0.8929; val_best_acc_score: 0.8410; val_best_f1_score: 0.8529; train_kl_reg_loss: 46457.7746; train_edge_recon_loss: 3039554.2888; train_gene_expr_recon_loss: 2675991.7304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5762003.7877; train_optim_loss: 5762003.7877; val_kl_reg_loss: 45697.1666; val_edge_recon_loss: 2788642.9038; val_gene_expr_recon_loss: 2475105.1923; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5309445.2821; val_optim_loss: 5309445.2821
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9439; val_auprc_score: 0.9332; val_best_acc_score: 0.8740; val_best_f1_score: 0.8805; train_kl_reg_loss: 39848.7823; train_edge_recon_loss: 2743339.5235; train_gene_expr_recon_loss: 2399867.6182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5183055.9259; train_optim_loss: 5183055.9259; val_kl_reg_loss: 33988.6291; val_edge_recon_loss: 2743373.8365; val_gene_expr_recon_loss: 2346377.1538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5123739.5962; val_optim_loss: 5123739.5962
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9595; val_auprc_score: 0.9521; val_best_acc_score: 0.8969; val_best_f1_score: 0.9009; train_kl_reg_loss: 33011.2653; train_edge_recon_loss: 2702202.7639; train_gene_expr_recon_loss: 2295667.9476; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5030881.9744; train_optim_loss: 5030881.9744; val_kl_reg_loss: 31262.7925; val_edge_recon_loss: 2711644.7276; val_gene_expr_recon_loss: 2262400.5865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5005308.1218; val_optim_loss: 5005308.1218
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9633; val_auprc_score: 0.9567; val_best_acc_score: 0.9028; val_best_f1_score: 0.9063; train_kl_reg_loss: 29550.6069; train_edge_recon_loss: 2684057.9822; train_gene_expr_recon_loss: 2229708.6788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4943317.2792; train_optim_loss: 4943317.2792; val_kl_reg_loss: 27625.7147; val_edge_recon_loss: 2697822.2147; val_gene_expr_recon_loss: 2209335.5897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4934783.5128; val_optim_loss: 4934783.5128
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9666; val_auprc_score: 0.9609; val_best_acc_score: 0.9076; val_best_f1_score: 0.9107; train_kl_reg_loss: 26988.9196; train_edge_recon_loss: 2672454.2301; train_gene_expr_recon_loss: 2184215.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4883658.6546; train_optim_loss: 4883658.6546; val_kl_reg_loss: 25369.6010; val_edge_recon_loss: 2687682.4968; val_gene_expr_recon_loss: 2170709.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4883761.1282; val_optim_loss: 4883761.1282
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9702; val_auprc_score: 0.9651; val_best_acc_score: 0.9130; val_best_f1_score: 0.9159; train_kl_reg_loss: 24709.2749; train_edge_recon_loss: 2666095.4843; train_gene_expr_recon_loss: 2152182.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4842986.9566; train_optim_loss: 4842986.9566; val_kl_reg_loss: 23681.7470; val_edge_recon_loss: 2682609.3750; val_gene_expr_recon_loss: 2143074.4263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849365.5513; val_optim_loss: 4849365.5513
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9748; val_auprc_score: 0.9706; val_best_acc_score: 0.9214; val_best_f1_score: 0.9235; train_kl_reg_loss: 22902.6317; train_edge_recon_loss: 2659052.6225; train_gene_expr_recon_loss: 2128379.2502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4810334.5114; train_optim_loss: 4810334.5114; val_kl_reg_loss: 22083.0218; val_edge_recon_loss: 2672019.8365; val_gene_expr_recon_loss: 2123477.5433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4817580.4038; val_optim_loss: 4817580.4038
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9766; val_auprc_score: 0.9728; val_best_acc_score: 0.9251; val_best_f1_score: 0.9270; train_kl_reg_loss: 21712.4100; train_edge_recon_loss: 2652225.0958; train_gene_expr_recon_loss: 2111809.5386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4785747.0413; train_optim_loss: 4785747.0413; val_kl_reg_loss: 21201.6347; val_edge_recon_loss: 2669592.3494; val_gene_expr_recon_loss: 2110351.0545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4801145.0385; val_optim_loss: 4801145.0385
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9771; val_auprc_score: 0.9733; val_best_acc_score: 0.9265; val_best_f1_score: 0.9283; train_kl_reg_loss: 20952.0383; train_edge_recon_loss: 2649047.2379; train_gene_expr_recon_loss: 2099118.6752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4769117.9466; train_optim_loss: 4769117.9466; val_kl_reg_loss: 20196.5798; val_edge_recon_loss: 2667163.6603; val_gene_expr_recon_loss: 2096130.5865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4783490.8141; val_optim_loss: 4783490.8141
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9784; val_auprc_score: 0.9748; val_best_acc_score: 0.9287; val_best_f1_score: 0.9303; train_kl_reg_loss: 20186.0319; train_edge_recon_loss: 2646044.5146; train_gene_expr_recon_loss: 2089946.6936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4756177.2365; train_optim_loss: 4756177.2365; val_kl_reg_loss: 19654.4119; val_edge_recon_loss: 2666147.8590; val_gene_expr_recon_loss: 2090965.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4776767.3974; val_optim_loss: 4776767.3974
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9795; val_auprc_score: 0.9760; val_best_acc_score: 0.9306; val_best_f1_score: 0.9322; train_kl_reg_loss: 19526.2040; train_edge_recon_loss: 2644418.5121; train_gene_expr_recon_loss: 2083658.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747603.5171; train_optim_loss: 4747603.5171; val_kl_reg_loss: 18793.6934; val_edge_recon_loss: 2661781.6923; val_gene_expr_recon_loss: 2087532.2420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4768107.6603; val_optim_loss: 4768107.6603
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9798; val_auprc_score: 0.9765; val_best_acc_score: 0.9311; val_best_f1_score: 0.9326; train_kl_reg_loss: 18888.1685; train_edge_recon_loss: 2642728.6108; train_gene_expr_recon_loss: 2079259.3121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4740876.0876; train_optim_loss: 4740876.0876; val_kl_reg_loss: 18564.2927; val_edge_recon_loss: 2660287.2115; val_gene_expr_recon_loss: 2081691.1763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4760542.6795; val_optim_loss: 4760542.6795
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9805; val_auprc_score: 0.9775; val_best_acc_score: 0.9324; val_best_f1_score: 0.9338; train_kl_reg_loss: 18444.1810; train_edge_recon_loss: 2642093.9306; train_gene_expr_recon_loss: 2075748.5689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736286.6838; train_optim_loss: 4736286.6838; val_kl_reg_loss: 18070.2260; val_edge_recon_loss: 2661408.4519; val_gene_expr_recon_loss: 2080204.6266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4759683.3013; val_optim_loss: 4759683.3013
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9806; val_auprc_score: 0.9775; val_best_acc_score: 0.9327; val_best_f1_score: 0.9341; train_kl_reg_loss: 18038.7948; train_edge_recon_loss: 2640331.3344; train_gene_expr_recon_loss: 2072352.4517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730722.5862; train_optim_loss: 4730722.5862; val_kl_reg_loss: 17710.6682; val_edge_recon_loss: 2658644.3974; val_gene_expr_recon_loss: 2077067.0785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4753422.1218; val_optim_loss: 4753422.1218
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9822; val_auprc_score: 0.9794; val_best_acc_score: 0.9358; val_best_f1_score: 0.9370; train_kl_reg_loss: 17624.0071; train_edge_recon_loss: 2639475.2229; train_gene_expr_recon_loss: 2070184.1216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4727283.3497; train_optim_loss: 4727283.3497; val_kl_reg_loss: 17048.8672; val_edge_recon_loss: 2656455.6282; val_gene_expr_recon_loss: 2072567.7147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746072.2372; val_optim_loss: 4746072.2372
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9827; val_auprc_score: 0.9801; val_best_acc_score: 0.9368; val_best_f1_score: 0.9380; train_kl_reg_loss: 17328.0948; train_edge_recon_loss: 2638634.1193; train_gene_expr_recon_loss: 2068677.7416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4724639.9466; train_optim_loss: 4724639.9466; val_kl_reg_loss: 16904.0927; val_edge_recon_loss: 2655733.7404; val_gene_expr_recon_loss: 2071221.8590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4743859.7308; val_optim_loss: 4743859.7308
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9832; val_auprc_score: 0.9805; val_best_acc_score: 0.9382; val_best_f1_score: 0.9394; train_kl_reg_loss: 17059.3268; train_edge_recon_loss: 2637266.5167; train_gene_expr_recon_loss: 2067152.9936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721478.8355; train_optim_loss: 4721478.8355; val_kl_reg_loss: 16826.0920; val_edge_recon_loss: 2655897.6506; val_gene_expr_recon_loss: 2072605.7821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4745329.5256; val_optim_loss: 4745329.5256
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9843; val_auprc_score: 0.9820; val_best_acc_score: 0.9399; val_best_f1_score: 0.9410; train_kl_reg_loss: 16873.0470; train_edge_recon_loss: 2636107.9363; train_gene_expr_recon_loss: 2066041.6150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4719022.6061; train_optim_loss: 4719022.6061; val_kl_reg_loss: 16420.6127; val_edge_recon_loss: 2652545.6314; val_gene_expr_recon_loss: 2070330.6202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4739296.8654; val_optim_loss: 4739296.8654
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9846; val_auprc_score: 0.9822; val_best_acc_score: 0.9410; val_best_f1_score: 0.9421; train_kl_reg_loss: 16688.7278; train_edge_recon_loss: 2634668.8946; train_gene_expr_recon_loss: 2064476.6444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4715834.2735; train_optim_loss: 4715834.2735; val_kl_reg_loss: 16391.1864; val_edge_recon_loss: 2651722.7692; val_gene_expr_recon_loss: 2068864.0769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736977.9936; val_optim_loss: 4736977.9936
