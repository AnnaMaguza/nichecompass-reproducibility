Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9567; val_auprc_score: 0.9583; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 462639.9688; train_edge_recon_loss: 3804328.8750; train_gene_expr_recon_loss: 33616072.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37883040.0000; train_optim_loss: 37883040.0000; val_kl_reg_loss: 395479.8750; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 32950622.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37412392.0000; val_optim_loss: 37412392.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9603; val_auprc_score: 0.9614; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 393600.1562; train_edge_recon_loss: 3898997.6250; train_gene_expr_recon_loss: 32834212.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37126810.0000; train_optim_loss: 37126810.0000; val_kl_reg_loss: 391106.3125; val_edge_recon_loss: 4066291.2500; val_gene_expr_recon_loss: 32831580.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37288976.0000; val_optim_loss: 37288976.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9559; val_auprc_score: 0.9563; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 395684.4844; train_edge_recon_loss: 3897840.5000; train_gene_expr_recon_loss: 32722636.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37016162.0000; train_optim_loss: 37016162.0000; val_kl_reg_loss: 397686.4375; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 32707592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37171568.0000; val_optim_loss: 37171568.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9546; val_auprc_score: 0.9525; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 404719.7188; train_edge_recon_loss: 3884910.6250; train_gene_expr_recon_loss: 32612854.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36902484.0000; train_optim_loss: 36902484.0000; val_kl_reg_loss: 407931.6250; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 32582140.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37056364.0000; val_optim_loss: 37056364.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9549; val_auprc_score: 0.9540; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 410159.9062; train_edge_recon_loss: 3879594.8750; train_gene_expr_recon_loss: 32493798.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36783554.0000; train_optim_loss: 36783554.0000; val_kl_reg_loss: 405588.5000; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 32440098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36911980.0000; val_optim_loss: 36911980.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 56 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9583
val AUPRC score: 0.9572
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 71.1101
val source rna MSE score: 24.2017
Duration of model training in run 3: 0 hours, 0 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1521, n_latent: 1521, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1521, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1521, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 7397
Number of validation edges: 821
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9224; val_auprc_score: 0.9215; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1105.8654; train_edge_recon_loss: 3471440.7500; train_gene_expr_recon_loss: 32149156.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35621704.0000; train_optim_loss: 35621704.0000; val_kl_reg_loss: 11986094.0000; val_edge_recon_loss: 4065829.0000; val_gene_expr_recon_loss: 296137184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312189120.0000; val_optim_loss: 312189120.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9274; val_auprc_score: 0.9368; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12857772.0000; train_edge_recon_loss: 3516299.7500; train_gene_expr_recon_loss: 580363584.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 596737664.0000; train_optim_loss: 596737664.0000; val_kl_reg_loss: 5638311.5000; val_edge_recon_loss: 4065642.2500; val_gene_expr_recon_loss: 33028994.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42732948.0000; val_optim_loss: 42732948.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9248; val_auprc_score: 0.9336; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6333334.0000; train_edge_recon_loss: 3560325.5000; train_gene_expr_recon_loss: 558134528.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 568028160.0000; train_optim_loss: 568028160.0000; val_kl_reg_loss: 401312.8750; val_edge_recon_loss: 4065974.2500; val_gene_expr_recon_loss: 33125600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37592888.0000; val_optim_loss: 37592888.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9306; val_auprc_score: 0.9365; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 419889.8750; train_edge_recon_loss: 3490789.7500; train_gene_expr_recon_loss: 91498632.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95409312.0000; train_optim_loss: 95409312.0000; val_kl_reg_loss: 81396.4062; val_edge_recon_loss: 4066029.2500; val_gene_expr_recon_loss: 33901292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38048716.0000; val_optim_loss: 38048716.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9189; val_auprc_score: 0.9207; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 83075.9844; train_edge_recon_loss: 3607617.5000; train_gene_expr_recon_loss: 34335312.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38026004.0000; train_optim_loss: 38026004.0000; val_kl_reg_loss: 235783.6250; val_edge_recon_loss: 4066146.5000; val_gene_expr_recon_loss: 34680448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38982376.0000; val_optim_loss: 38982376.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9224; val_auprc_score: 0.9304; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 248227.9688; train_edge_recon_loss: 3592122.7500; train_gene_expr_recon_loss: 36741848.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40582200.0000; train_optim_loss: 40582200.0000; val_kl_reg_loss: 267142.1875; val_edge_recon_loss: 4066187.5000; val_gene_expr_recon_loss: 34909300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39242628.0000; val_optim_loss: 39242628.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9227; val_auprc_score: 0.9302; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 281315.8750; train_edge_recon_loss: 3567586.2500; train_gene_expr_recon_loss: 35291276.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 39140176.0000; train_optim_loss: 39140176.0000; val_kl_reg_loss: 157105.5469; val_edge_recon_loss: 4066212.2500; val_gene_expr_recon_loss: 34803956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39027272.0000; val_optim_loss: 39027272.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9162; val_auprc_score: 0.9186; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 165831.7031; train_edge_recon_loss: 3678910.5000; train_gene_expr_recon_loss: 34923736.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38768480.0000; train_optim_loss: 38768480.0000; val_kl_reg_loss: 156756.0312; val_edge_recon_loss: 4066233.0000; val_gene_expr_recon_loss: 34692132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38915120.0000; val_optim_loss: 38915120.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9154; val_auprc_score: 0.9161; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 162213.2812; train_edge_recon_loss: 3707387.5000; train_gene_expr_recon_loss: 34744672.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38614272.0000; train_optim_loss: 38614272.0000; val_kl_reg_loss: 168666.3594; val_edge_recon_loss: 4066233.2500; val_gene_expr_recon_loss: 34671648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38906548.0000; val_optim_loss: 38906548.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9125; val_auprc_score: 0.9155; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 175136.5156; train_edge_recon_loss: 3691409.5000; train_gene_expr_recon_loss: 34713772.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38580320.0000; train_optim_loss: 38580320.0000; val_kl_reg_loss: 183158.9688; val_edge_recon_loss: 4066235.2500; val_gene_expr_recon_loss: 34617592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38866984.0000; val_optim_loss: 38866984.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9196; val_auprc_score: 0.9248; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 190643.3438; train_edge_recon_loss: 3678520.0000; train_gene_expr_recon_loss: 34666244.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38535408.0000; train_optim_loss: 38535408.0000; val_kl_reg_loss: 201058.2031; val_edge_recon_loss: 4066229.2500; val_gene_expr_recon_loss: 34546248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38813536.0000; val_optim_loss: 38813536.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9266
val AUPRC score: 0.9314
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 1161.5963
val source rna MSE score: 40.6731
Duration of model training in run 2: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1521, n_latent: 1521, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1521, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1521, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 7397
Number of validation edges: 821
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9280; val_auprc_score: 0.9291; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1575.3138; train_edge_recon_loss: 3472407.5000; train_gene_expr_recon_loss: 32294868.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35768852.0000; train_optim_loss: 35768852.0000; val_kl_reg_loss: 41501864.0000; val_edge_recon_loss: 4065798.0000; val_gene_expr_recon_loss: 564343232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 609910912.0000; val_optim_loss: 609910912.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9290; val_auprc_score: 0.9347; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 50607244.0000; train_edge_recon_loss: 3623268.5000; train_gene_expr_recon_loss: 612350720.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 666581248.0000; train_optim_loss: 666581248.0000; val_kl_reg_loss: 365224704.0000; val_edge_recon_loss: 4065765.5000; val_gene_expr_recon_loss: 123764960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493055424.0000; val_optim_loss: 493055424.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9236; val_auprc_score: 0.9207; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 411422720.0000; train_edge_recon_loss: 3653077.2500; train_gene_expr_recon_loss: 617924608.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1033000448.0000; train_optim_loss: 1033000448.0000; val_kl_reg_loss: 337170240.0000; val_edge_recon_loss: 4066031.7500; val_gene_expr_recon_loss: 79022008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420258272.0000; val_optim_loss: 420258272.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9287; val_auprc_score: 0.9340; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 423144192.0000; train_edge_recon_loss: 3764377.2500; train_gene_expr_recon_loss: 611340288.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1038248832.0000; train_optim_loss: 1038248832.0000; val_kl_reg_loss: 34996312.0000; val_edge_recon_loss: 4066099.5000; val_gene_expr_recon_loss: 86002240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125064656.0000; val_optim_loss: 125064656.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9323; val_auprc_score: 0.9409; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 43488044.0000; train_edge_recon_loss: 3566108.0000; train_gene_expr_recon_loss: 595717952.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 642772096.0000; train_optim_loss: 642772096.0000; val_kl_reg_loss: 62022568.0000; val_edge_recon_loss: 4066178.7500; val_gene_expr_recon_loss: 72803536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 138892288.0000; val_optim_loss: 138892288.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9286; val_auprc_score: 0.9286; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 72938008.0000; train_edge_recon_loss: 3571095.7500; train_gene_expr_recon_loss: 583752064.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 660261184.0000; train_optim_loss: 660261184.0000; val_kl_reg_loss: 9696841.0000; val_edge_recon_loss: 4066220.5000; val_gene_expr_recon_loss: 89940328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103703392.0000; val_optim_loss: 103703392.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9265; val_auprc_score: 0.9260; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11320978.0000; train_edge_recon_loss: 3525728.5000; train_gene_expr_recon_loss: 580839168.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 595685888.0000; train_optim_loss: 595685888.0000; val_kl_reg_loss: 2163398.0000; val_edge_recon_loss: 4066243.5000; val_gene_expr_recon_loss: 39575720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45805360.0000; val_optim_loss: 45805360.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9241; val_auprc_score: 0.9243; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2462090.5000; train_edge_recon_loss: 3507273.0000; train_gene_expr_recon_loss: 492124704.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 498094080.0000; train_optim_loss: 498094080.0000; val_kl_reg_loss: 494575.1875; val_edge_recon_loss: 4066254.2500; val_gene_expr_recon_loss: 37980832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42541660.0000; val_optim_loss: 42541660.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9240; val_auprc_score: 0.9272; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 548236.5000; train_edge_recon_loss: 3551128.7500; train_gene_expr_recon_loss: 119699240.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 123798608.0000; train_optim_loss: 123798608.0000; val_kl_reg_loss: 177528.0625; val_edge_recon_loss: 4066265.5000; val_gene_expr_recon_loss: 39966020.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 44209812.0000; val_optim_loss: 44209812.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9260; val_auprc_score: 0.9307; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 184325.1250; train_edge_recon_loss: 3877882.7500; train_gene_expr_recon_loss: 40225112.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44287320.0000; train_optim_loss: 44287320.0000; val_kl_reg_loss: 196664.6250; val_edge_recon_loss: 4066275.2500; val_gene_expr_recon_loss: 40898120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45161060.0000; val_optim_loss: 45161060.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9252; val_auprc_score: 0.9299; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 203949.5312; train_edge_recon_loss: 3944800.2500; train_gene_expr_recon_loss: 40982392.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 45131140.0000; train_optim_loss: 45131140.0000; val_kl_reg_loss: 316109.7188; val_edge_recon_loss: 4066282.0000; val_gene_expr_recon_loss: 41191232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45573624.0000; val_optim_loss: 45573624.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9270; val_auprc_score: 0.9281; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 334951.8750; train_edge_recon_loss: 3776953.5000; train_gene_expr_recon_loss: 45974736.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50086640.0000; train_optim_loss: 50086640.0000; val_kl_reg_loss: 845911.8125; val_edge_recon_loss: 4066283.7500; val_gene_expr_recon_loss: 41223548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46135744.0000; val_optim_loss: 46135744.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9304; val_auprc_score: 0.9338; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 922462.3750; train_edge_recon_loss: 3631467.2500; train_gene_expr_recon_loss: 53562392.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 58116320.0000; train_optim_loss: 58116320.0000; val_kl_reg_loss: 679072.8750; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 41187556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45932912.0000; val_optim_loss: 45932912.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9325; val_auprc_score: 0.9320; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 755077.5000; train_edge_recon_loss: 3644470.5000; train_gene_expr_recon_loss: 46631916.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 51031464.0000; train_optim_loss: 51031464.0000; val_kl_reg_loss: 537010.8750; val_edge_recon_loss: 4066282.0000; val_gene_expr_recon_loss: 41157344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45760636.0000; val_optim_loss: 45760636.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9300; val_auprc_score: 0.9321; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 598574.5000; train_edge_recon_loss: 3680241.7500; train_gene_expr_recon_loss: 43985656.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 48264472.0000; train_optim_loss: 48264472.0000; val_kl_reg_loss: 454004.9375; val_edge_recon_loss: 4066282.2500; val_gene_expr_recon_loss: 41128964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45649252.0000; val_optim_loss: 45649252.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9286; val_auprc_score: 0.9268; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 486018.8125; train_edge_recon_loss: 3727209.7500; train_gene_expr_recon_loss: 41835360.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46048588.0000; train_optim_loss: 46048588.0000; val_kl_reg_loss: 391640.1875; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 41076852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45534776.0000; val_optim_loss: 45534776.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 10 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
val AUROC score: 0.9229
val AUPRC score: 0.9227
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 365.3145
val source rna MSE score: 38.8880
Duration of model training in run 1: 0 hours, 0 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Run timestamp: 16082023_220318_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_25pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1462, n_latent: 1462, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1462, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1462, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 28559
Number of validation edges: 3173
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9660; val_auprc_score: 0.9621; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4528663.7767; train_edge_recon_loss: 3572181.8750; train_gene_expr_recon_loss: 178663369.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 186764212.5000; train_optim_loss: 186764212.5000; val_kl_reg_loss: 243602.1875; val_edge_recon_loss: 4066009.2500; val_gene_expr_recon_loss: 25094100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29403712.0000; val_optim_loss: 29403712.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9624; val_auprc_score: 0.9591; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 167990.2227; train_edge_recon_loss: 3553733.6875; train_gene_expr_recon_loss: 30452836.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34174559.5000; train_optim_loss: 34174559.5000; val_kl_reg_loss: 138046.5000; val_edge_recon_loss: 4066214.0000; val_gene_expr_recon_loss: 27818880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32023140.0000; val_optim_loss: 32023140.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9648; val_auprc_score: 0.9616; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 208154.4883; train_edge_recon_loss: 3651555.5625; train_gene_expr_recon_loss: 27254335.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31114046.0000; train_optim_loss: 31114046.0000; val_kl_reg_loss: 225207.8906; val_edge_recon_loss: 4066260.2500; val_gene_expr_recon_loss: 25805568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30097036.0000; val_optim_loss: 30097036.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9608; val_auprc_score: 0.9568; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 396406.2070; train_edge_recon_loss: 3704828.0625; train_gene_expr_recon_loss: 25212411.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29313645.5000; train_optim_loss: 29313645.5000; val_kl_reg_loss: 233241.3906; val_edge_recon_loss: 4066276.2500; val_gene_expr_recon_loss: 23302472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27601990.0000; val_optim_loss: 27601990.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9630; val_auprc_score: 0.9604; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 395585.7031; train_edge_recon_loss: 3757341.1875; train_gene_expr_recon_loss: 22763971.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26916898.0000; train_optim_loss: 26916898.0000; val_kl_reg_loss: 437792.3438; val_edge_recon_loss: 4066284.0000; val_gene_expr_recon_loss: 21488444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25992520.0000; val_optim_loss: 25992520.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9596; val_auprc_score: 0.9537; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 532945.1875; train_edge_recon_loss: 3764158.1250; train_gene_expr_recon_loss: 23095501.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27392604.5000; train_optim_loss: 27392604.5000; val_kl_reg_loss: 325941.4375; val_edge_recon_loss: 4066286.7500; val_gene_expr_recon_loss: 20508446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24900674.0000; val_optim_loss: 24900674.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9603; val_auprc_score: 0.9544; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 436985.9375; train_edge_recon_loss: 3843642.4375; train_gene_expr_recon_loss: 20851277.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25131905.0000; train_optim_loss: 25131905.0000; val_kl_reg_loss: 491608.6250; val_edge_recon_loss: 4066289.7500; val_gene_expr_recon_loss: 19485792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24043690.0000; val_optim_loss: 24043690.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9581; val_auprc_score: 0.9503; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 545450.5859; train_edge_recon_loss: 3845691.9375; train_gene_expr_recon_loss: 19656302.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24047445.5000; train_optim_loss: 24047445.5000; val_kl_reg_loss: 342489.5312; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 18871840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23280620.0000; val_optim_loss: 23280620.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9570; val_auprc_score: 0.9490; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 456435.8594; train_edge_recon_loss: 3912860.8125; train_gene_expr_recon_loss: 19555577.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23924874.0000; train_optim_loss: 23924874.0000; val_kl_reg_loss: 384012.4688; val_edge_recon_loss: 4066291.7500; val_gene_expr_recon_loss: 18422122.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22872426.0000; val_optim_loss: 22872426.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9548; val_auprc_score: 0.9463; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 435427.3828; train_edge_recon_loss: 3943087.1250; train_gene_expr_recon_loss: 18313201.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22691716.0000; train_optim_loss: 22691716.0000; val_kl_reg_loss: 361020.0625; val_edge_recon_loss: 4066291.7500; val_gene_expr_recon_loss: 17961686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22388998.0000; val_optim_loss: 22388998.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9558; val_auprc_score: 0.9480; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 433518.6094; train_edge_recon_loss: 3959513.6875; train_gene_expr_recon_loss: 19142014.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23535046.0000; train_optim_loss: 23535046.0000; val_kl_reg_loss: 366354.7500; val_edge_recon_loss: 4066292.0000; val_gene_expr_recon_loss: 17687744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22120392.0000; val_optim_loss: 22120392.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9570; val_auprc_score: 0.9489; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 396860.6172; train_edge_recon_loss: 4019851.0625; train_gene_expr_recon_loss: 17894515.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22311227.0000; train_optim_loss: 22311227.0000; val_kl_reg_loss: 384720.5000; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 17417790.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21868802.0000; val_optim_loss: 21868802.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9581; val_auprc_score: 0.9524; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 503361.7578; train_edge_recon_loss: 3911191.9375; train_gene_expr_recon_loss: 17374456.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21789009.0000; train_optim_loss: 21789009.0000; val_kl_reg_loss: 429021.7500; val_edge_recon_loss: 4066292.0000; val_gene_expr_recon_loss: 17246610.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21741924.0000; val_optim_loss: 21741924.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9572; val_auprc_score: 0.9508; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 981424.6562; train_edge_recon_loss: 3949072.0625; train_gene_expr_recon_loss: 17243337.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22173835.0000; train_optim_loss: 22173835.0000; val_kl_reg_loss: 365168.3125; val_edge_recon_loss: 4066291.7500; val_gene_expr_recon_loss: 17098010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21529470.0000; val_optim_loss: 21529470.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9598; val_auprc_score: 0.9552; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 393912.5703; train_edge_recon_loss: 4021767.0000; train_gene_expr_recon_loss: 17095483.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21511163.0000; train_optim_loss: 21511163.0000; val_kl_reg_loss: 510597.5625; val_edge_recon_loss: 4066290.5000; val_gene_expr_recon_loss: 16949052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21525940.0000; val_optim_loss: 21525940.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9553; val_auprc_score: 0.9464; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1669259.9219; train_edge_recon_loss: 3906690.0625; train_gene_expr_recon_loss: 19872664.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25448614.5000; train_optim_loss: 25448614.5000; val_kl_reg_loss: 357796.3750; val_edge_recon_loss: 4066290.7500; val_gene_expr_recon_loss: 16847558.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21271644.0000; val_optim_loss: 21271644.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9554; val_auprc_score: 0.9483; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 387077.9375; train_edge_recon_loss: 4012217.6250; train_gene_expr_recon_loss: 19426375.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23825671.0000; train_optim_loss: 23825671.0000; val_kl_reg_loss: 362878.0312; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 16770499.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21199670.0000; val_optim_loss: 21199670.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9561; val_auprc_score: 0.9482; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 418045.8047; train_edge_recon_loss: 4006226.5000; train_gene_expr_recon_loss: 29161782.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33586053.5000; train_optim_loss: 33586053.5000; val_kl_reg_loss: 371037.1250; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 16730567.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21167896.0000; val_optim_loss: 21167896.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9540; val_auprc_score: 0.9445; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 391705.1641; train_edge_recon_loss: 4032634.1875; train_gene_expr_recon_loss: 17379918.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21804258.0000; train_optim_loss: 21804258.0000; val_kl_reg_loss: 677948.7500; val_edge_recon_loss: 4066294.7500; val_gene_expr_recon_loss: 17083334.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21827578.0000; val_optim_loss: 21827578.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9505; val_auprc_score: 0.9416; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 477431.7109; train_edge_recon_loss: 3995992.3750; train_gene_expr_recon_loss: 22713620.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27187044.0000; train_optim_loss: 27187044.0000; val_kl_reg_loss: 452086.3125; val_edge_recon_loss: 4066295.0000; val_gene_expr_recon_loss: 17160658.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21679040.0000; val_optim_loss: 21679040.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9491; val_auprc_score: 0.9417; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3012111.6094; train_edge_recon_loss: 3950485.8125; train_gene_expr_recon_loss: 17410225.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24372822.5000; train_optim_loss: 24372822.5000; val_kl_reg_loss: 442533.8750; val_edge_recon_loss: 4066294.2500; val_gene_expr_recon_loss: 17038488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21547316.0000; val_optim_loss: 21547316.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9461; val_auprc_score: 0.9375; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 454418.4766; train_edge_recon_loss: 4032716.5000; train_gene_expr_recon_loss: 18354184.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22841319.0000; train_optim_loss: 22841319.0000; val_kl_reg_loss: 437384.6875; val_edge_recon_loss: 4066293.2500; val_gene_expr_recon_loss: 16998402.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21502080.0000; val_optim_loss: 21502080.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9481; val_auprc_score: 0.9400; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 454718.4219; train_edge_recon_loss: 4033458.8125; train_gene_expr_recon_loss: 17026369.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21514546.5000; train_optim_loss: 21514546.5000; val_kl_reg_loss: 453537.1875; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 16974960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21494790.0000; val_optim_loss: 21494790.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9455; val_auprc_score: 0.9364; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 453126.1406; train_edge_recon_loss: 4035772.0625; train_gene_expr_recon_loss: 17012297.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21501196.0000; train_optim_loss: 21501196.0000; val_kl_reg_loss: 441218.7500; val_edge_recon_loss: 4066293.2500; val_gene_expr_recon_loss: 16955180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21462692.0000; val_optim_loss: 21462692.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9450; val_auprc_score: 0.9362; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 445192.0938; train_edge_recon_loss: 4051214.1875; train_gene_expr_recon_loss: 17015247.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21511653.5000; train_optim_loss: 21511653.5000; val_kl_reg_loss: 438925.3125; val_edge_recon_loss: 4066293.5000; val_gene_expr_recon_loss: 16935266.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21440484.0000; val_optim_loss: 21440484.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9437; val_auprc_score: 0.9339; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 442718.1406; train_edge_recon_loss: 4052560.6250; train_gene_expr_recon_loss: 16944157.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21439436.0000; train_optim_loss: 21439436.0000; val_kl_reg_loss: 441274.4375; val_edge_recon_loss: 4066293.2500; val_gene_expr_recon_loss: 16920686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21428254.0000; val_optim_loss: 21428254.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 40 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
val AUROC score: 0.9532
val AUPRC score: 0.9437
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 19.7778
val source rna MSE score: 19.9476
Duration of model training in run 8: 0 hours, 0 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1462, n_latent: 1462, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1462, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1462, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 28559
Number of validation edges: 3173
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9670; val_auprc_score: 0.9662; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3054333.3898; train_edge_recon_loss: 3542696.8750; train_gene_expr_recon_loss: 353749271.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360346302.5000; train_optim_loss: 360346302.5000; val_kl_reg_loss: 357495.7500; val_edge_recon_loss: 4065918.5000; val_gene_expr_recon_loss: 24338672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28762086.0000; val_optim_loss: 28762086.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9582; val_auprc_score: 0.9560; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 159984.1953; train_edge_recon_loss: 3523078.8750; train_gene_expr_recon_loss: 37887224.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41570288.5000; train_optim_loss: 41570288.5000; val_kl_reg_loss: 115221.3438; val_edge_recon_loss: 4066085.2500; val_gene_expr_recon_loss: 26835202.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31016508.0000; val_optim_loss: 31016508.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9538; val_auprc_score: 0.9535; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 123032.0547; train_edge_recon_loss: 3558299.3125; train_gene_expr_recon_loss: 26453585.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30134917.0000; train_optim_loss: 30134917.0000; val_kl_reg_loss: 136025.9688; val_edge_recon_loss: 4066163.2500; val_gene_expr_recon_loss: 24629418.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28831608.0000; val_optim_loss: 28831608.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9507; val_auprc_score: 0.9525; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 168649.6953; train_edge_recon_loss: 3611251.8125; train_gene_expr_recon_loss: 23114815.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26894716.5000; train_optim_loss: 26894716.5000; val_kl_reg_loss: 333727.7812; val_edge_recon_loss: 4066182.2500; val_gene_expr_recon_loss: 21167670.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25567580.0000; val_optim_loss: 25567580.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9497; val_auprc_score: 0.9483; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 231329.2578; train_edge_recon_loss: 3632127.0000; train_gene_expr_recon_loss: 20745119.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24608575.0000; train_optim_loss: 24608575.0000; val_kl_reg_loss: 301488.0312; val_edge_recon_loss: 4066211.0000; val_gene_expr_recon_loss: 19287092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23654792.0000; val_optim_loss: 23654792.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9471; val_auprc_score: 0.9481; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 279582.1406; train_edge_recon_loss: 3635491.3750; train_gene_expr_recon_loss: 19292523.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23207597.0000; train_optim_loss: 23207597.0000; val_kl_reg_loss: 230440.1562; val_edge_recon_loss: 4066225.5000; val_gene_expr_recon_loss: 18900758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23197424.0000; val_optim_loss: 23197424.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9472; val_auprc_score: 0.9466; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 271927.9219; train_edge_recon_loss: 3682692.2500; train_gene_expr_recon_loss: 18358075.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22312695.0000; train_optim_loss: 22312695.0000; val_kl_reg_loss: 244245.9375; val_edge_recon_loss: 4066228.5000; val_gene_expr_recon_loss: 17542952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21853426.0000; val_optim_loss: 21853426.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9453; val_auprc_score: 0.9435; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 304926.8086; train_edge_recon_loss: 3683890.4375; train_gene_expr_recon_loss: 17384616.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21373433.0000; train_optim_loss: 21373433.0000; val_kl_reg_loss: 278290.3438; val_edge_recon_loss: 4066238.7500; val_gene_expr_recon_loss: 16925576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21270104.0000; val_optim_loss: 21270104.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9459; val_auprc_score: 0.9450; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 330656.1875; train_edge_recon_loss: 3689002.3750; train_gene_expr_recon_loss: 16715117.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20734776.5000; train_optim_loss: 20734776.5000; val_kl_reg_loss: 293751.7500; val_edge_recon_loss: 4066239.0000; val_gene_expr_recon_loss: 16167683.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20527674.0000; val_optim_loss: 20527674.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9448; val_auprc_score: 0.9455; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 344650.2656; train_edge_recon_loss: 3700424.4375; train_gene_expr_recon_loss: 16104351.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20149425.0000; train_optim_loss: 20149425.0000; val_kl_reg_loss: 301159.0000; val_edge_recon_loss: 4066248.5000; val_gene_expr_recon_loss: 15753084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20120492.0000; val_optim_loss: 20120492.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9432; val_auprc_score: 0.9390; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 354902.6250; train_edge_recon_loss: 3702190.0625; train_gene_expr_recon_loss: 15752684.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19809776.5000; train_optim_loss: 19809776.5000; val_kl_reg_loss: 310641.7500; val_edge_recon_loss: 4066244.7500; val_gene_expr_recon_loss: 15472578.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19849464.0000; val_optim_loss: 19849464.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9430; val_auprc_score: 0.9402; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 362219.7656; train_edge_recon_loss: 3704622.4375; train_gene_expr_recon_loss: 15414341.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19481183.5000; train_optim_loss: 19481183.5000; val_kl_reg_loss: 285817.6875; val_edge_recon_loss: 4066245.7500; val_gene_expr_recon_loss: 15132016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19484080.0000; val_optim_loss: 19484080.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9460; val_auprc_score: 0.9441; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 360534.9062; train_edge_recon_loss: 3717701.6875; train_gene_expr_recon_loss: 15131392.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19209629.5000; train_optim_loss: 19209629.5000; val_kl_reg_loss: 291859.7812; val_edge_recon_loss: 4066247.0000; val_gene_expr_recon_loss: 14918796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19276904.0000; val_optim_loss: 19276904.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9463; val_auprc_score: 0.9463; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 358273.7344; train_edge_recon_loss: 3723537.8750; train_gene_expr_recon_loss: 14984289.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19066101.0000; train_optim_loss: 19066101.0000; val_kl_reg_loss: 265549.0000; val_edge_recon_loss: 4066244.7500; val_gene_expr_recon_loss: 14746334.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19078128.0000; val_optim_loss: 19078128.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9433; val_auprc_score: 0.9413; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 353454.3203; train_edge_recon_loss: 3740625.3750; train_gene_expr_recon_loss: 15027495.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19121574.5000; train_optim_loss: 19121574.5000; val_kl_reg_loss: 291954.0000; val_edge_recon_loss: 4066237.7500; val_gene_expr_recon_loss: 14595820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18954012.0000; val_optim_loss: 18954012.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9424; val_auprc_score: 0.9397; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 353161.8438; train_edge_recon_loss: 3741058.0000; train_gene_expr_recon_loss: 14623848.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18718068.5000; train_optim_loss: 18718068.5000; val_kl_reg_loss: 358555.9062; val_edge_recon_loss: 4066249.2500; val_gene_expr_recon_loss: 14472034.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18896840.0000; val_optim_loss: 18896840.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9412; val_auprc_score: 0.9393; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 378087.6172; train_edge_recon_loss: 3715619.9375; train_gene_expr_recon_loss: 14530578.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18624286.5000; train_optim_loss: 18624286.5000; val_kl_reg_loss: 286102.8750; val_edge_recon_loss: 4066246.7500; val_gene_expr_recon_loss: 14368366.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18720716.0000; val_optim_loss: 18720716.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9407; val_auprc_score: 0.9386; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 347641.3516; train_edge_recon_loss: 3757433.2500; train_gene_expr_recon_loss: 14399696.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18504771.5000; train_optim_loss: 18504771.5000; val_kl_reg_loss: 304369.2812; val_edge_recon_loss: 4066240.0000; val_gene_expr_recon_loss: 14271346.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18641956.0000; val_optim_loss: 18641956.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9377; val_auprc_score: 0.9336; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 356570.0547; train_edge_recon_loss: 3768047.5625; train_gene_expr_recon_loss: 14359485.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18484103.0000; train_optim_loss: 18484103.0000; val_kl_reg_loss: 310081.8125; val_edge_recon_loss: 4066244.0000; val_gene_expr_recon_loss: 14183662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18559988.0000; val_optim_loss: 18559988.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9426; val_auprc_score: 0.9405; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 380647.6328; train_edge_recon_loss: 3761406.8750; train_gene_expr_recon_loss: 14258651.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18400706.0000; train_optim_loss: 18400706.0000; val_kl_reg_loss: 252152.4062; val_edge_recon_loss: 4066243.7500; val_gene_expr_recon_loss: 14104726.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18423122.0000; val_optim_loss: 18423122.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9418; val_auprc_score: 0.9403; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 338568.8359; train_edge_recon_loss: 3798387.8750; train_gene_expr_recon_loss: 14174915.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18311872.5000; train_optim_loss: 18311872.5000; val_kl_reg_loss: 251258.6406; val_edge_recon_loss: 4066242.5000; val_gene_expr_recon_loss: 14035565.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18353066.0000; val_optim_loss: 18353066.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9399; val_auprc_score: 0.9380; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 311073.8672; train_edge_recon_loss: 3821414.4375; train_gene_expr_recon_loss: 14090508.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18222997.5000; train_optim_loss: 18222997.5000; val_kl_reg_loss: 292490.1250; val_edge_recon_loss: 4066233.2500; val_gene_expr_recon_loss: 13977323.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18336046.0000; val_optim_loss: 18336046.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9407; val_auprc_score: 0.9404; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 315000.0000; train_edge_recon_loss: 3803299.9375; train_gene_expr_recon_loss: 14473806.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18592106.5000; train_optim_loss: 18592106.5000; val_kl_reg_loss: 284945.5625; val_edge_recon_loss: 4066244.2500; val_gene_expr_recon_loss: 13917211.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18268400.0000; val_optim_loss: 18268400.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9409; val_auprc_score: 0.9396; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 335782.0391; train_edge_recon_loss: 3778365.0625; train_gene_expr_recon_loss: 14002164.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18116312.0000; train_optim_loss: 18116312.0000; val_kl_reg_loss: 247515.4062; val_edge_recon_loss: 4066236.2500; val_gene_expr_recon_loss: 13873740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18187492.0000; val_optim_loss: 18187492.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9409; val_auprc_score: 0.9402; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 332096.1562; train_edge_recon_loss: 3816561.2500; train_gene_expr_recon_loss: 13947388.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18096046.0000; train_optim_loss: 18096046.0000; val_kl_reg_loss: 267052.1562; val_edge_recon_loss: 4066239.2500; val_gene_expr_recon_loss: 13834097.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18167388.0000; val_optim_loss: 18167388.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9433; val_auprc_score: 0.9459; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 339882.3516; train_edge_recon_loss: 3806240.6250; train_gene_expr_recon_loss: 14560911.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18707034.5000; train_optim_loss: 18707034.5000; val_kl_reg_loss: 218541.8125; val_edge_recon_loss: 4066242.5000; val_gene_expr_recon_loss: 13803141.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18087926.0000; val_optim_loss: 18087926.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9417; val_auprc_score: 0.9418; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 220551.6211; train_edge_recon_loss: 3977011.9375; train_gene_expr_recon_loss: 13956635.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18154198.5000; train_optim_loss: 18154198.5000; val_kl_reg_loss: 299597.0000; val_edge_recon_loss: 4066236.2500; val_gene_expr_recon_loss: 13784693.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18150526.0000; val_optim_loss: 18150526.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9391; val_auprc_score: 0.9377; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 389202.7812; train_edge_recon_loss: 3795965.5000; train_gene_expr_recon_loss: 13864019.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18049187.0000; train_optim_loss: 18049187.0000; val_kl_reg_loss: 253082.2188; val_edge_recon_loss: 4066233.2500; val_gene_expr_recon_loss: 13763932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18083248.0000; val_optim_loss: 18083248.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9371; val_auprc_score: 0.9357; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 340471.8203; train_edge_recon_loss: 3825354.6875; train_gene_expr_recon_loss: 19672875.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23838702.5000; train_optim_loss: 23838702.5000; val_kl_reg_loss: 741037.5000; val_edge_recon_loss: 4066230.0000; val_gene_expr_recon_loss: 13782118.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18589386.0000; val_optim_loss: 18589386.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9427; val_auprc_score: 0.9390; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 412774.5977; train_edge_recon_loss: 3833987.5000; train_gene_expr_recon_loss: 31838519.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36085282.0000; train_optim_loss: 36085282.0000; val_kl_reg_loss: 234625.2031; val_edge_recon_loss: 4066257.2500; val_gene_expr_recon_loss: 13884488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18185370.0000; val_optim_loss: 18185370.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9428; val_auprc_score: 0.9370; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 531191.6484; train_edge_recon_loss: 3812510.2500; train_gene_expr_recon_loss: 14513632.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18857335.0000; train_optim_loss: 18857335.0000; val_kl_reg_loss: 291422.0625; val_edge_recon_loss: 4066264.0000; val_gene_expr_recon_loss: 13958219.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18315904.0000; val_optim_loss: 18315904.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9397; val_auprc_score: 0.9345; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 640702.2031; train_edge_recon_loss: 3806355.6875; train_gene_expr_recon_loss: 17364244.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21811302.0000; train_optim_loss: 21811302.0000; val_kl_reg_loss: 296027.4375; val_edge_recon_loss: 4066272.0000; val_gene_expr_recon_loss: 13896840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18259140.0000; val_optim_loss: 18259140.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9379; val_auprc_score: 0.9302; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 291454.2969; train_edge_recon_loss: 3912551.0625; train_gene_expr_recon_loss: 14013817.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18217823.0000; train_optim_loss: 18217823.0000; val_kl_reg_loss: 287897.7500; val_edge_recon_loss: 4066273.5000; val_gene_expr_recon_loss: 13882473.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18236644.0000; val_optim_loss: 18236644.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9408; val_auprc_score: 0.9341; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 320054.2031; train_edge_recon_loss: 3860571.6875; train_gene_expr_recon_loss: 13961081.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18141706.5000; train_optim_loss: 18141706.5000; val_kl_reg_loss: 382920.5000; val_edge_recon_loss: 4066270.5000; val_gene_expr_recon_loss: 13864782.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18313972.0000; val_optim_loss: 18313972.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9419; val_auprc_score: 0.9341; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 398505.9297; train_edge_recon_loss: 3769585.1875; train_gene_expr_recon_loss: 14007293.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18175384.5000; train_optim_loss: 18175384.5000; val_kl_reg_loss: 355737.9688; val_edge_recon_loss: 4066270.2500; val_gene_expr_recon_loss: 13845362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18267370.0000; val_optim_loss: 18267370.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9410; val_auprc_score: 0.9339; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 354239.9062; train_edge_recon_loss: 3797588.6875; train_gene_expr_recon_loss: 13930260.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18082088.5000; train_optim_loss: 18082088.5000; val_kl_reg_loss: 336899.6250; val_edge_recon_loss: 4066271.7500; val_gene_expr_recon_loss: 13827100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18230272.0000; val_optim_loss: 18230272.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 0 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9380
val AUPRC score: 0.9369
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 19.3209
val source rna MSE score: 16.8602
Duration of model training in run 7: 0 hours, 1 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1463, n_latent: 1463, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1463, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1463, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 21520
Number of validation edges: 2391
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9622; val_auprc_score: 0.9607; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1358892.4650; train_edge_recon_loss: 3520931.0000; train_gene_expr_recon_loss: 243573496.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 248453318.0000; train_optim_loss: 248453318.0000; val_kl_reg_loss: 204141.7812; val_edge_recon_loss: 4065712.7500; val_gene_expr_recon_loss: 23062948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27332802.0000; val_optim_loss: 27332802.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9581; val_auprc_score: 0.9592; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 163954.6406; train_edge_recon_loss: 3517217.8333; train_gene_expr_recon_loss: 27452969.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31134142.0000; train_optim_loss: 31134142.0000; val_kl_reg_loss: 93182.4297; val_edge_recon_loss: 4066110.0000; val_gene_expr_recon_loss: 28426956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32586248.0000; val_optim_loss: 32586248.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9520; val_auprc_score: 0.9543; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 144250.7292; train_edge_recon_loss: 3588016.6667; train_gene_expr_recon_loss: 29810027.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33542294.6667; train_optim_loss: 33542294.6667; val_kl_reg_loss: 556086.6875; val_edge_recon_loss: 4066200.7500; val_gene_expr_recon_loss: 29110966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33733252.0000; val_optim_loss: 33733252.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9510; val_auprc_score: 0.9527; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 319296.5312; train_edge_recon_loss: 3649401.4167; train_gene_expr_recon_loss: 28560062.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32528760.6667; train_optim_loss: 32528760.6667; val_kl_reg_loss: 167398.6250; val_edge_recon_loss: 4066230.7500; val_gene_expr_recon_loss: 27275184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31508814.0000; val_optim_loss: 31508814.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9466; val_auprc_score: 0.9500; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 383930.2917; train_edge_recon_loss: 3721644.0833; train_gene_expr_recon_loss: 27812855.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31918430.0000; train_optim_loss: 31918430.0000; val_kl_reg_loss: 246112.1250; val_edge_recon_loss: 4066251.7500; val_gene_expr_recon_loss: 26183510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30495874.0000; val_optim_loss: 30495874.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9419; val_auprc_score: 0.9408; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 314585.0312; train_edge_recon_loss: 3802156.0833; train_gene_expr_recon_loss: 25862912.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29979654.0000; train_optim_loss: 29979654.0000; val_kl_reg_loss: 314737.5625; val_edge_recon_loss: 4066258.7500; val_gene_expr_recon_loss: 25544204.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29925200.0000; val_optim_loss: 29925200.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9392; val_auprc_score: 0.9381; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 418377.4792; train_edge_recon_loss: 3798030.4167; train_gene_expr_recon_loss: 24960599.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29177007.3333; train_optim_loss: 29177007.3333; val_kl_reg_loss: 339795.5938; val_edge_recon_loss: 4066262.7500; val_gene_expr_recon_loss: 24153664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28559722.0000; val_optim_loss: 28559722.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9386; val_auprc_score: 0.9365; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 819560.9062; train_edge_recon_loss: 3788048.3333; train_gene_expr_recon_loss: 24364160.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28971770.0000; train_optim_loss: 28971770.0000; val_kl_reg_loss: 311754.1562; val_edge_recon_loss: 4066269.0000; val_gene_expr_recon_loss: 23355924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27733948.0000; val_optim_loss: 27733948.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9405; val_auprc_score: 0.9407; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 319715.4167; train_edge_recon_loss: 3997268.1667; train_gene_expr_recon_loss: 23334337.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27651320.6667; train_optim_loss: 27651320.6667; val_kl_reg_loss: 326925.4062; val_edge_recon_loss: 4066268.5000; val_gene_expr_recon_loss: 23266410.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27659604.0000; val_optim_loss: 27659604.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9607
val AUPRC score: 0.9547
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 114.4943
val source rna MSE score: 60.0921
Duration of model training in run 6: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1463, n_latent: 1463, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1463, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1463, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 21520
Number of validation edges: 2391
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9650; val_auprc_score: 0.9620; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13823266.8070; train_edge_recon_loss: 3637609.8333; train_gene_expr_recon_loss: 339702124.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357162999.3333; train_optim_loss: 357162999.3333; val_kl_reg_loss: 674409.2500; val_edge_recon_loss: 4065814.0000; val_gene_expr_recon_loss: 23609842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28350064.0000; val_optim_loss: 28350064.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9663; val_auprc_score: 0.9624; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 323147.6198; train_edge_recon_loss: 3512508.5000; train_gene_expr_recon_loss: 99704684.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 103540338.6667; train_optim_loss: 103540338.6667; val_kl_reg_loss: 85654.7188; val_edge_recon_loss: 4066074.5000; val_gene_expr_recon_loss: 26890440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31042170.0000; val_optim_loss: 31042170.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9616; val_auprc_score: 0.9613; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 128080.4922; train_edge_recon_loss: 3550790.0833; train_gene_expr_recon_loss: 27944938.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31623808.6667; train_optim_loss: 31623808.6667; val_kl_reg_loss: 123626.7188; val_edge_recon_loss: 4066204.7500; val_gene_expr_recon_loss: 28154296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32344128.0000; val_optim_loss: 32344128.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9599; val_auprc_score: 0.9582; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 180456.6562; train_edge_recon_loss: 3586237.8333; train_gene_expr_recon_loss: 27782572.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31549266.6667; train_optim_loss: 31549266.6667; val_kl_reg_loss: 143244.5938; val_edge_recon_loss: 4066238.0000; val_gene_expr_recon_loss: 26219302.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30428784.0000; val_optim_loss: 30428784.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9608; val_auprc_score: 0.9597; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 214314.0312; train_edge_recon_loss: 3646588.0833; train_gene_expr_recon_loss: 25176430.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29037332.0000; train_optim_loss: 29037332.0000; val_kl_reg_loss: 204660.3125; val_edge_recon_loss: 4066255.7500; val_gene_expr_recon_loss: 22416420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26687336.0000; val_optim_loss: 26687336.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9585; val_auprc_score: 0.9565; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 290672.0365; train_edge_recon_loss: 3645130.5000; train_gene_expr_recon_loss: 21020678.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24956481.3333; train_optim_loss: 24956481.3333; val_kl_reg_loss: 235412.9531; val_edge_recon_loss: 4066269.5000; val_gene_expr_recon_loss: 19571142.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23872824.0000; val_optim_loss: 23872824.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9575; val_auprc_score: 0.9546; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 270197.7917; train_edge_recon_loss: 3716210.6667; train_gene_expr_recon_loss: 20293090.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24279498.0000; train_optim_loss: 24279498.0000; val_kl_reg_loss: 332460.3750; val_edge_recon_loss: 4066275.0000; val_gene_expr_recon_loss: 18519646.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22918382.0000; val_optim_loss: 22918382.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9577; val_auprc_score: 0.9550; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 335125.9583; train_edge_recon_loss: 3693709.7500; train_gene_expr_recon_loss: 19771811.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23800646.6667; train_optim_loss: 23800646.6667; val_kl_reg_loss: 298866.9688; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 20648450.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25013598.0000; val_optim_loss: 25013598.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9583; val_auprc_score: 0.9574; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 346270.1562; train_edge_recon_loss: 3727682.9167; train_gene_expr_recon_loss: 21170423.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25244376.0000; train_optim_loss: 25244376.0000; val_kl_reg_loss: 376924.4375; val_edge_recon_loss: 4066285.2500; val_gene_expr_recon_loss: 21738554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26181764.0000; val_optim_loss: 26181764.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9547; val_auprc_score: 0.9502; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 371441.7812; train_edge_recon_loss: 3737256.8333; train_gene_expr_recon_loss: 21581413.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25690112.0000; train_optim_loss: 25690112.0000; val_kl_reg_loss: 445711.8750; val_edge_recon_loss: 4066285.2500; val_gene_expr_recon_loss: 21200328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25712324.0000; val_optim_loss: 25712324.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9529; val_auprc_score: 0.9472; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 391591.6146; train_edge_recon_loss: 3756713.5000; train_gene_expr_recon_loss: 20804524.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24952830.0000; train_optim_loss: 24952830.0000; val_kl_reg_loss: 467174.6875; val_edge_recon_loss: 4066284.5000; val_gene_expr_recon_loss: 19946368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24479828.0000; val_optim_loss: 24479828.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9522; val_auprc_score: 0.9472; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 444775.2396; train_edge_recon_loss: 3705749.3333; train_gene_expr_recon_loss: 19872618.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24023143.3333; train_optim_loss: 24023143.3333; val_kl_reg_loss: 380315.6875; val_edge_recon_loss: 4066286.7500; val_gene_expr_recon_loss: 19731348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24177950.0000; val_optim_loss: 24177950.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9557; val_auprc_score: 0.9523; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 370421.0417; train_edge_recon_loss: 3771577.2500; train_gene_expr_recon_loss: 19590653.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23732652.0000; train_optim_loss: 23732652.0000; val_kl_reg_loss: 347430.1562; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 19446740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23860456.0000; val_optim_loss: 23860456.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9543; val_auprc_score: 0.9510; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 360319.0000; train_edge_recon_loss: 3783297.5833; train_gene_expr_recon_loss: 19295449.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23439066.0000; train_optim_loss: 23439066.0000; val_kl_reg_loss: 376405.0625; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 19122384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23565076.0000; val_optim_loss: 23565076.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9581; val_auprc_score: 0.9560; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 403263.4479; train_edge_recon_loss: 3739638.0000; train_gene_expr_recon_loss: 18966503.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23109404.6667; train_optim_loss: 23109404.6667; val_kl_reg_loss: 410613.5625; val_edge_recon_loss: 4066286.0000; val_gene_expr_recon_loss: 18776380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23253280.0000; val_optim_loss: 23253280.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 18 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
val AUROC score: 0.9563
val AUPRC score: 0.9536
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 87.1847
val source rna MSE score: 49.6606
Duration of model training in run 5: 0 hours, 0 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1467, n_latent: 1467, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1467, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1467, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 14357
Number of validation edges: 1595
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9538; val_auprc_score: 0.9546; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9162168.6936; train_edge_recon_loss: 3603069.7500; train_gene_expr_recon_loss: 247888104.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260653349.0000; train_optim_loss: 260653349.0000; val_kl_reg_loss: 1954750976.0000; val_edge_recon_loss: 4065271.0000; val_gene_expr_recon_loss: 76146640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2034962944.0000; val_optim_loss: 2034962944.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9496; val_auprc_score: 0.9520; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1153394518.1250; train_edge_recon_loss: 3775916.3750; train_gene_expr_recon_loss: 497140432.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1654310848.0000; train_optim_loss: 1654310848.0000; val_kl_reg_loss: 3673174.0000; val_edge_recon_loss: 4065911.5000; val_gene_expr_recon_loss: 23232944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30972030.0000; val_optim_loss: 30972030.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9557; val_auprc_score: 0.9540; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4411447.2500; train_edge_recon_loss: 3513402.5000; train_gene_expr_recon_loss: 470199632.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478124480.0000; train_optim_loss: 478124480.0000; val_kl_reg_loss: 5486640.0000; val_edge_recon_loss: 4066195.2500; val_gene_expr_recon_loss: 30404176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39957012.0000; val_optim_loss: 39957012.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9520; val_auprc_score: 0.9534; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3551103.7500; train_edge_recon_loss: 3605517.5000; train_gene_expr_recon_loss: 293287432.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300444048.0000; train_optim_loss: 300444048.0000; val_kl_reg_loss: 204334.8750; val_edge_recon_loss: 4066264.0000; val_gene_expr_recon_loss: 33581040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37851640.0000; val_optim_loss: 37851640.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9538; val_auprc_score: 0.9531; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 204726.6719; train_edge_recon_loss: 3844578.5000; train_gene_expr_recon_loss: 34294196.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38343502.0000; train_optim_loss: 38343502.0000; val_kl_reg_loss: 399410.9062; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 33829864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38295556.0000; val_optim_loss: 38295556.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9535; val_auprc_score: 0.9525; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 556885.3438; train_edge_recon_loss: 3704026.1250; train_gene_expr_recon_loss: 34153002.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38413914.0000; train_optim_loss: 38413914.0000; val_kl_reg_loss: 375898.5938; val_edge_recon_loss: 4066290.0000; val_gene_expr_recon_loss: 33947544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38389732.0000; val_optim_loss: 38389732.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9456; val_auprc_score: 0.9386; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 390132.3438; train_edge_recon_loss: 3976117.7500; train_gene_expr_recon_loss: 33669258.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38035508.0000; train_optim_loss: 38035508.0000; val_kl_reg_loss: 542883.8750; val_edge_recon_loss: 4066294.5000; val_gene_expr_recon_loss: 33129888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37739068.0000; val_optim_loss: 37739068.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9454; val_auprc_score: 0.9369; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1157014.7188; train_edge_recon_loss: 3756913.1250; train_gene_expr_recon_loss: 36130520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41044448.0000; train_optim_loss: 41044448.0000; val_kl_reg_loss: 602789.6250; val_edge_recon_loss: 4066297.7500; val_gene_expr_recon_loss: 31952796.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36621884.0000; val_optim_loss: 36621884.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9471; val_auprc_score: 0.9405; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 611860.7812; train_edge_recon_loss: 3976037.1250; train_gene_expr_recon_loss: 31808199.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36396098.0000; train_optim_loss: 36396098.0000; val_kl_reg_loss: 591670.4375; val_edge_recon_loss: 4066297.0000; val_gene_expr_recon_loss: 31794714.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36452680.0000; val_optim_loss: 36452680.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9399; val_auprc_score: 0.9279; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 599636.3750; train_edge_recon_loss: 4007916.7500; train_gene_expr_recon_loss: 31617128.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36224682.0000; train_optim_loss: 36224682.0000; val_kl_reg_loss: 583876.8750; val_edge_recon_loss: 4066298.0000; val_gene_expr_recon_loss: 31564084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36214260.0000; val_optim_loss: 36214260.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
val AUROC score: 0.9527
val AUPRC score: 0.9555
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 115.9898
val source rna MSE score: 59.0140
Duration of model training in run 4: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1467, n_latent: 1467, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1467, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1467, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 14357
Number of validation edges: 1595
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9570; val_auprc_score: 0.9559; val_best_acc_score: 0.5025; val_best_f1_score: 0.6678; train_kl_reg_loss: 3098858.2687; train_edge_recon_loss: 3516421.7500; train_gene_expr_recon_loss: 251947829.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258563106.0000; train_optim_loss: 258563106.0000; val_kl_reg_loss: 21406642.0000; val_edge_recon_loss: 4065005.5000; val_gene_expr_recon_loss: 55529628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81001280.0000; val_optim_loss: 81001280.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9587; val_auprc_score: 0.9626; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10677324.7656; train_edge_recon_loss: 3675314.6250; train_gene_expr_recon_loss: 258902924.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273255564.0000; train_optim_loss: 273255564.0000; val_kl_reg_loss: 83516.0781; val_edge_recon_loss: 4065733.5000; val_gene_expr_recon_loss: 24210104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28359354.0000; val_optim_loss: 28359354.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9540; val_auprc_score: 0.9547; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 89615.3359; train_edge_recon_loss: 3513423.6250; train_gene_expr_recon_loss: 25683755.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29286794.0000; train_optim_loss: 29286794.0000; val_kl_reg_loss: 93490.7344; val_edge_recon_loss: 4066048.2500; val_gene_expr_recon_loss: 27454684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31614224.0000; val_optim_loss: 31614224.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9575; val_auprc_score: 0.9586; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 91105.5273; train_edge_recon_loss: 3566614.2500; train_gene_expr_recon_loss: 28043221.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31700941.0000; train_optim_loss: 31700941.0000; val_kl_reg_loss: 166139.6250; val_edge_recon_loss: 4066167.5000; val_gene_expr_recon_loss: 28377108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32609416.0000; val_optim_loss: 32609416.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9546; val_auprc_score: 0.9573; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 155941.7969; train_edge_recon_loss: 3573125.8750; train_gene_expr_recon_loss: 28419586.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32148654.0000; train_optim_loss: 32148654.0000; val_kl_reg_loss: 267292.6875; val_edge_recon_loss: 4066212.0000; val_gene_expr_recon_loss: 27558260.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31891764.0000; val_optim_loss: 31891764.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9551; val_auprc_score: 0.9531; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 214414.2891; train_edge_recon_loss: 3624424.8750; train_gene_expr_recon_loss: 27226274.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31065113.0000; train_optim_loss: 31065113.0000; val_kl_reg_loss: 163600.2812; val_edge_recon_loss: 4066234.7500; val_gene_expr_recon_loss: 26237960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30467796.0000; val_optim_loss: 30467796.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9534; val_auprc_score: 0.9539; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 309780.6875; train_edge_recon_loss: 3626050.2500; train_gene_expr_recon_loss: 26164779.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30100610.0000; train_optim_loss: 30100610.0000; val_kl_reg_loss: 221664.4375; val_edge_recon_loss: 4066254.0000; val_gene_expr_recon_loss: 24969648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29257566.0000; val_optim_loss: 29257566.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9491; val_auprc_score: 0.9471; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 204835.4844; train_edge_recon_loss: 3753289.0000; train_gene_expr_recon_loss: 24620016.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28578141.0000; train_optim_loss: 28578141.0000; val_kl_reg_loss: 246964.7188; val_edge_recon_loss: 4066264.2500; val_gene_expr_recon_loss: 23760396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28073624.0000; val_optim_loss: 28073624.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9498; val_auprc_score: 0.9506; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 588138.8516; train_edge_recon_loss: 3648780.6250; train_gene_expr_recon_loss: 24922163.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29159082.0000; train_optim_loss: 29159082.0000; val_kl_reg_loss: 315785.6875; val_edge_recon_loss: 4066273.5000; val_gene_expr_recon_loss: 24024490.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28406548.0000; val_optim_loss: 28406548.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9502; val_auprc_score: 0.9465; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 278993.1406; train_edge_recon_loss: 3793859.7500; train_gene_expr_recon_loss: 23404633.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27477486.0000; train_optim_loss: 27477486.0000; val_kl_reg_loss: 265965.8750; val_edge_recon_loss: 4066275.2500; val_gene_expr_recon_loss: 23121418.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27453660.0000; val_optim_loss: 27453660.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9523; val_auprc_score: 0.9530; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 420450.1719; train_edge_recon_loss: 3761038.0000; train_gene_expr_recon_loss: 23022684.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27204172.0000; train_optim_loss: 27204172.0000; val_kl_reg_loss: 325066.0625; val_edge_recon_loss: 4066280.7500; val_gene_expr_recon_loss: 22826822.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27218168.0000; val_optim_loss: 27218168.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9548; val_auprc_score: 0.9555; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 323810.1250; train_edge_recon_loss: 3820617.3750; train_gene_expr_recon_loss: 22671368.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26815796.0000; train_optim_loss: 26815796.0000; val_kl_reg_loss: 679566.7500; val_edge_recon_loss: 4066280.2500; val_gene_expr_recon_loss: 22284364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27030212.0000; val_optim_loss: 27030212.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9505; val_auprc_score: 0.9491; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 508349.1406; train_edge_recon_loss: 3745961.5000; train_gene_expr_recon_loss: 22082089.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26336400.0000; train_optim_loss: 26336400.0000; val_kl_reg_loss: 347817.5000; val_edge_recon_loss: 4066282.7500; val_gene_expr_recon_loss: 21607010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26021110.0000; val_optim_loss: 26021110.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9514; val_auprc_score: 0.9493; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 492187.6406; train_edge_recon_loss: 3791892.8750; train_gene_expr_recon_loss: 21515652.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25799733.0000; train_optim_loss: 25799733.0000; val_kl_reg_loss: 333440.6250; val_edge_recon_loss: 4066284.5000; val_gene_expr_recon_loss: 21361748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25761472.0000; val_optim_loss: 25761472.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9525; val_auprc_score: 0.9512; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 343435.8281; train_edge_recon_loss: 3900658.5000; train_gene_expr_recon_loss: 21233782.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25477877.0000; train_optim_loss: 25477877.0000; val_kl_reg_loss: 1079262.0000; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 20948984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26094532.0000; val_optim_loss: 26094532.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9529; val_auprc_score: 0.9532; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 712149.0938; train_edge_recon_loss: 3795980.6250; train_gene_expr_recon_loss: 22579906.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27088035.0000; train_optim_loss: 27088035.0000; val_kl_reg_loss: 351624.7812; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 20585246.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25003158.0000; val_optim_loss: 25003158.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9507; val_auprc_score: 0.9471; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 723020.2344; train_edge_recon_loss: 3811368.6250; train_gene_expr_recon_loss: 24322732.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28857121.0000; train_optim_loss: 28857121.0000; val_kl_reg_loss: 321049.3438; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 20390516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24777852.0000; val_optim_loss: 24777852.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9505; val_auprc_score: 0.9482; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 317895.2031; train_edge_recon_loss: 4027214.8750; train_gene_expr_recon_loss: 20334012.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24679122.0000; train_optim_loss: 24679122.0000; val_kl_reg_loss: 335504.8750; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 20189026.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24590820.0000; val_optim_loss: 24590820.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9480; val_auprc_score: 0.9441; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 421720.8125; train_edge_recon_loss: 3908848.8750; train_gene_expr_recon_loss: 22373354.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26703924.0000; train_optim_loss: 26703924.0000; val_kl_reg_loss: 605173.0000; val_edge_recon_loss: 4066289.0000; val_gene_expr_recon_loss: 20003000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24674462.0000; val_optim_loss: 24674462.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9505; val_auprc_score: 0.9470; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 471625.7500; train_edge_recon_loss: 3902176.1250; train_gene_expr_recon_loss: 21495202.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25869004.0000; train_optim_loss: 25869004.0000; val_kl_reg_loss: 561538.0000; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 19770602.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24398428.0000; val_optim_loss: 24398428.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9548; val_auprc_score: 0.9527; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 518373.2812; train_edge_recon_loss: 3826828.2500; train_gene_expr_recon_loss: 19864742.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24209944.0000; train_optim_loss: 24209944.0000; val_kl_reg_loss: 507422.8750; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 19656144.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24229854.0000; val_optim_loss: 24229854.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9484; val_auprc_score: 0.9435; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 417086.9531; train_edge_recon_loss: 3900813.2500; train_gene_expr_recon_loss: 20180451.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24498351.0000; train_optim_loss: 24498351.0000; val_kl_reg_loss: 426008.6250; val_edge_recon_loss: 4066288.2500; val_gene_expr_recon_loss: 19554270.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24046568.0000; val_optim_loss: 24046568.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9435; val_auprc_score: 0.9354; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 373374.0156; train_edge_recon_loss: 3965210.2500; train_gene_expr_recon_loss: 19534689.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23873273.0000; train_optim_loss: 23873273.0000; val_kl_reg_loss: 332070.2812; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 19461494.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23859852.0000; val_optim_loss: 23859852.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9471; val_auprc_score: 0.9407; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 321114.8750; train_edge_recon_loss: 4027368.2500; train_gene_expr_recon_loss: 19816694.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24165178.0000; train_optim_loss: 24165178.0000; val_kl_reg_loss: 306441.5000; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 19344760.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23717488.0000; val_optim_loss: 23717488.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9474; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 315773.6719; train_edge_recon_loss: 4039079.7500; train_gene_expr_recon_loss: 19326497.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23681350.0000; train_optim_loss: 23681350.0000; val_kl_reg_loss: 769595.1250; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 19260418.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24096300.0000; val_optim_loss: 24096300.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9453; val_auprc_score: 0.9407; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 548267.2656; train_edge_recon_loss: 3916552.5000; train_gene_expr_recon_loss: 19247295.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23712115.0000; train_optim_loss: 23712115.0000; val_kl_reg_loss: 307893.1875; val_edge_recon_loss: 4066290.0000; val_gene_expr_recon_loss: 19174642.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23548824.0000; val_optim_loss: 23548824.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9457; val_auprc_score: 0.9423; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 308920.2969; train_edge_recon_loss: 4060659.0000; train_gene_expr_recon_loss: 19155369.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23524949.0000; train_optim_loss: 23524949.0000; val_kl_reg_loss: 308728.3438; val_edge_recon_loss: 4066288.2500; val_gene_expr_recon_loss: 19086290.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23461306.0000; val_optim_loss: 23461306.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9462; val_auprc_score: 0.9429; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 310977.6562; train_edge_recon_loss: 4055668.5000; train_gene_expr_recon_loss: 19093433.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23460079.0000; train_optim_loss: 23460079.0000; val_kl_reg_loss: 318204.6250; val_edge_recon_loss: 4066290.0000; val_gene_expr_recon_loss: 18988432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23372926.0000; val_optim_loss: 23372926.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9506; val_auprc_score: 0.9513; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 346704.8750; train_edge_recon_loss: 3967713.8750; train_gene_expr_recon_loss: 20051956.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24366375.0000; train_optim_loss: 24366375.0000; val_kl_reg_loss: 1061877.1250; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18908936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24037102.0000; val_optim_loss: 24037102.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9470; val_auprc_score: 0.9447; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 682324.8750; train_edge_recon_loss: 3892590.3750; train_gene_expr_recon_loss: 20792763.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25367678.0000; train_optim_loss: 25367678.0000; val_kl_reg_loss: 314812.1875; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18852996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23234096.0000; val_optim_loss: 23234096.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9464; val_auprc_score: 0.9437; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 363644.2500; train_edge_recon_loss: 3976357.0000; train_gene_expr_recon_loss: 20194677.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24534678.0000; train_optim_loss: 24534678.0000; val_kl_reg_loss: 311378.6875; val_edge_recon_loss: 4066288.2500; val_gene_expr_recon_loss: 18796198.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23173864.0000; val_optim_loss: 23173864.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9476; val_auprc_score: 0.9431; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 315819.4688; train_edge_recon_loss: 4046668.5000; train_gene_expr_recon_loss: 18785942.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23148430.0000; train_optim_loss: 23148430.0000; val_kl_reg_loss: 341449.8438; val_edge_recon_loss: 4066286.0000; val_gene_expr_recon_loss: 18738368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23146104.0000; val_optim_loss: 23146104.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9421; val_auprc_score: 0.9364; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 488088.2188; train_edge_recon_loss: 3896047.3750; train_gene_expr_recon_loss: 19459152.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23843288.0000; train_optim_loss: 23843288.0000; val_kl_reg_loss: 551575.6250; val_edge_recon_loss: 4066288.7500; val_gene_expr_recon_loss: 18690684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23308548.0000; val_optim_loss: 23308548.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9447; val_auprc_score: 0.9408; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439256.5312; train_edge_recon_loss: 3907104.0000; train_gene_expr_recon_loss: 19647187.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23993548.0000; train_optim_loss: 23993548.0000; val_kl_reg_loss: 310452.8438; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 18650038.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23026778.0000; val_optim_loss: 23026778.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9443; val_auprc_score: 0.9412; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 323272.9688; train_edge_recon_loss: 4020446.8750; train_gene_expr_recon_loss: 19520173.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23863893.0000; train_optim_loss: 23863893.0000; val_kl_reg_loss: 637559.4375; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18606252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23310100.0000; val_optim_loss: 23310100.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9473; val_auprc_score: 0.9462; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 573950.0000; train_edge_recon_loss: 3833119.5000; train_gene_expr_recon_loss: 19403910.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23810980.0000; train_optim_loss: 23810980.0000; val_kl_reg_loss: 313625.4375; val_edge_recon_loss: 4066289.0000; val_gene_expr_recon_loss: 18566102.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22946016.0000; val_optim_loss: 22946016.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9472; val_auprc_score: 0.9471; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 311715.5000; train_edge_recon_loss: 4049681.8750; train_gene_expr_recon_loss: 18567839.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22929236.0000; train_optim_loss: 22929236.0000; val_kl_reg_loss: 308349.3125; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18544078.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22918716.0000; val_optim_loss: 22918716.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9429; val_auprc_score: 0.9389; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 345044.2344; train_edge_recon_loss: 3993917.7500; train_gene_expr_recon_loss: 18541354.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22880316.0000; train_optim_loss: 22880316.0000; val_kl_reg_loss: 332019.5000; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 18504492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22902800.0000; val_optim_loss: 22902800.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9428; val_auprc_score: 0.9377; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 659535.0625; train_edge_recon_loss: 3895390.7500; train_gene_expr_recon_loss: 18527795.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23082720.0000; train_optim_loss: 23082720.0000; val_kl_reg_loss: 316852.5312; val_edge_recon_loss: 4066288.2500; val_gene_expr_recon_loss: 18481152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22864292.0000; val_optim_loss: 22864292.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9420; val_auprc_score: 0.9382; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 312217.6562; train_edge_recon_loss: 4043181.2500; train_gene_expr_recon_loss: 18484222.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22839621.0000; train_optim_loss: 22839621.0000; val_kl_reg_loss: 301667.5938; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18455862.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22823818.0000; val_optim_loss: 22823818.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9435; val_auprc_score: 0.9431; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 304517.9062; train_edge_recon_loss: 4064676.7500; train_gene_expr_recon_loss: 18467222.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22836417.0000; train_optim_loss: 22836417.0000; val_kl_reg_loss: 302230.5000; val_edge_recon_loss: 4066289.0000; val_gene_expr_recon_loss: 18439120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22807640.0000; val_optim_loss: 22807640.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9422; val_auprc_score: 0.9385; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 308873.9688; train_edge_recon_loss: 4048573.3750; train_gene_expr_recon_loss: 18578475.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22935922.0000; train_optim_loss: 22935922.0000; val_kl_reg_loss: 302881.4375; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 18410356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22779524.0000; val_optim_loss: 22779524.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9456; val_auprc_score: 0.9432; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 304503.2188; train_edge_recon_loss: 4063433.1250; train_gene_expr_recon_loss: 18421989.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22789925.0000; train_optim_loss: 22789925.0000; val_kl_reg_loss: 303286.2188; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 18395848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22765420.0000; val_optim_loss: 22765420.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9428; val_auprc_score: 0.9373; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 324071.6562; train_edge_recon_loss: 4015109.1250; train_gene_expr_recon_loss: 19023179.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23362359.0000; train_optim_loss: 23362359.0000; val_kl_reg_loss: 303823.6875; val_edge_recon_loss: 4066289.0000; val_gene_expr_recon_loss: 18372890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22743002.0000; val_optim_loss: 22743002.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9428; val_auprc_score: 0.9379; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 323308.1094; train_edge_recon_loss: 4016501.2500; train_gene_expr_recon_loss: 23289157.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27628966.0000; train_optim_loss: 27628966.0000; val_kl_reg_loss: 308045.1875; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 18389424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22763756.0000; val_optim_loss: 22763756.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9404; val_auprc_score: 0.9329; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 331972.0000; train_edge_recon_loss: 3993366.5000; train_gene_expr_recon_loss: 18430816.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22756154.0000; train_optim_loss: 22756154.0000; val_kl_reg_loss: 973262.6250; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18380320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23419872.0000; val_optim_loss: 23419872.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9444; val_auprc_score: 0.9394; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 652963.3750; train_edge_recon_loss: 3913626.3750; train_gene_expr_recon_loss: 18490303.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23056892.0000; train_optim_loss: 23056892.0000; val_kl_reg_loss: 314219.4375; val_edge_recon_loss: 4066288.5000; val_gene_expr_recon_loss: 18351516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22732024.0000; val_optim_loss: 22732024.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9442; val_auprc_score: 0.9401; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 412401.7500; train_edge_recon_loss: 3919920.7500; train_gene_expr_recon_loss: 22360225.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26692547.0000; train_optim_loss: 26692547.0000; val_kl_reg_loss: 319726.7500; val_edge_recon_loss: 4066288.7500; val_gene_expr_recon_loss: 18336386.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22722402.0000; val_optim_loss: 22722402.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9420; val_auprc_score: 0.9352; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 315193.1875; train_edge_recon_loss: 4028057.2500; train_gene_expr_recon_loss: 18372949.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22716200.0000; train_optim_loss: 22716200.0000; val_kl_reg_loss: 306410.7812; val_edge_recon_loss: 4066290.0000; val_gene_expr_recon_loss: 18440200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22812900.0000; val_optim_loss: 22812900.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9449; val_auprc_score: 0.9392; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 308778.8125; train_edge_recon_loss: 4048246.5000; train_gene_expr_recon_loss: 18426246.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22783272.0000; train_optim_loss: 22783272.0000; val_kl_reg_loss: 308239.6875; val_edge_recon_loss: 4066290.2500; val_gene_expr_recon_loss: 18328286.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22702816.0000; val_optim_loss: 22702816.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9408; val_auprc_score: 0.9344; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 311357.0625; train_edge_recon_loss: 4047892.5000; train_gene_expr_recon_loss: 18335113.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22694363.0000; train_optim_loss: 22694363.0000; val_kl_reg_loss: 330964.5000; val_edge_recon_loss: 4066290.0000; val_gene_expr_recon_loss: 18409342.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22806596.0000; val_optim_loss: 22806596.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9364; val_auprc_score: 0.9254; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 546457.2500; train_edge_recon_loss: 3889782.7500; train_gene_expr_recon_loss: 35849097.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40285336.0000; train_optim_loss: 40285336.0000; val_kl_reg_loss: 438169.3750; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 18457574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22962036.0000; val_optim_loss: 22962036.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9407; val_auprc_score: 0.9328; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 747750.0000; train_edge_recon_loss: 3800080.0000; train_gene_expr_recon_loss: 39684161.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44231992.0000; train_optim_loss: 44231992.0000; val_kl_reg_loss: 344339.3750; val_edge_recon_loss: 4066289.7500; val_gene_expr_recon_loss: 18556312.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22966940.0000; val_optim_loss: 22966940.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9384; val_auprc_score: 0.9272; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 348887.1719; train_edge_recon_loss: 3998259.3750; train_gene_expr_recon_loss: 18528484.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22875630.0000; train_optim_loss: 22875630.0000; val_kl_reg_loss: 646062.8125; val_edge_recon_loss: 4066293.7500; val_gene_expr_recon_loss: 18495296.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23207652.0000; val_optim_loss: 23207652.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9427; val_auprc_score: 0.9336; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 602418.0625; train_edge_recon_loss: 3845037.5000; train_gene_expr_recon_loss: 20659671.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25107127.0000; train_optim_loss: 25107127.0000; val_kl_reg_loss: 463653.8125; val_edge_recon_loss: 4066293.5000; val_gene_expr_recon_loss: 18483868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23013816.0000; val_optim_loss: 23013816.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9374; val_auprc_score: 0.9264; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439112.1875; train_edge_recon_loss: 3911355.1250; train_gene_expr_recon_loss: 18777774.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23128241.0000; train_optim_loss: 23128241.0000; val_kl_reg_loss: 379749.4375; val_edge_recon_loss: 4066294.5000; val_gene_expr_recon_loss: 18443120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22889164.0000; val_optim_loss: 22889164.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9353; val_auprc_score: 0.9231; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 374893.7656; train_edge_recon_loss: 3983419.1250; train_gene_expr_recon_loss: 18448576.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22806889.0000; train_optim_loss: 22806889.0000; val_kl_reg_loss: 360579.4062; val_edge_recon_loss: 4066295.0000; val_gene_expr_recon_loss: 18416966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22843840.0000; val_optim_loss: 22843840.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9378; val_auprc_score: 0.9274; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 361871.5000; train_edge_recon_loss: 4005653.0000; train_gene_expr_recon_loss: 18405267.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22772791.0000; train_optim_loss: 22772791.0000; val_kl_reg_loss: 368099.6250; val_edge_recon_loss: 4066293.5000; val_gene_expr_recon_loss: 18390148.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22824540.0000; val_optim_loss: 22824540.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 2 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9445
val AUPRC score: 0.9385
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 20.7750
val source rna MSE score: 16.5760
Duration of model training in run 3: 0 hours, 1 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 7397
Number of validation edges: 821
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9359; val_auprc_score: 0.9414; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 1831.0132; train_edge_recon_loss: 3477015.5000; train_gene_expr_recon_loss: 23646776.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27125622.0000; train_optim_loss: 27125622.0000; val_kl_reg_loss: 5311998.0000; val_edge_recon_loss: 4065184.5000; val_gene_expr_recon_loss: 272642752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 282019936.0000; val_optim_loss: 282019936.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9359; val_auprc_score: 0.9413; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 5702118.0000; train_edge_recon_loss: 3630513.2500; train_gene_expr_recon_loss: 387433824.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396766464.0000; train_optim_loss: 396766464.0000; val_kl_reg_loss: 601557.5000; val_edge_recon_loss: 4064832.0000; val_gene_expr_recon_loss: 23351276.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28017666.0000; val_optim_loss: 28017666.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9333; val_auprc_score: 0.9403; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 651284.0625; train_edge_recon_loss: 3539857.0000; train_gene_expr_recon_loss: 207971392.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 212162528.0000; train_optim_loss: 212162528.0000; val_kl_reg_loss: 271560.1250; val_edge_recon_loss: 4065593.2500; val_gene_expr_recon_loss: 23748692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28085846.0000; val_optim_loss: 28085846.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9320; val_auprc_score: 0.9285; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 280449.2812; train_edge_recon_loss: 3579159.0000; train_gene_expr_recon_loss: 51514240.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 55373848.0000; train_optim_loss: 55373848.0000; val_kl_reg_loss: 95666.4375; val_edge_recon_loss: 4065864.0000; val_gene_expr_recon_loss: 25947932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30109462.0000; val_optim_loss: 30109462.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9334; val_auprc_score: 0.9279; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 100534.2422; train_edge_recon_loss: 3541325.7500; train_gene_expr_recon_loss: 26479478.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30121338.0000; train_optim_loss: 30121338.0000; val_kl_reg_loss: 110049.7188; val_edge_recon_loss: 4066012.7500; val_gene_expr_recon_loss: 27838620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32014682.0000; val_optim_loss: 32014682.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9380; val_auprc_score: 0.9392; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 117504.4688; train_edge_recon_loss: 3547078.0000; train_gene_expr_recon_loss: 28366208.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32030790.0000; train_optim_loss: 32030790.0000; val_kl_reg_loss: 135808.8125; val_edge_recon_loss: 4066103.0000; val_gene_expr_recon_loss: 28855488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33057400.0000; val_optim_loss: 33057400.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9215; val_auprc_score: 0.9183; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 142706.4062; train_edge_recon_loss: 3584264.2500; train_gene_expr_recon_loss: 32102520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35829492.0000; train_optim_loss: 35829492.0000; val_kl_reg_loss: 236204.5625; val_edge_recon_loss: 4066164.7500; val_gene_expr_recon_loss: 29079520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33381890.0000; val_optim_loss: 33381890.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9357; val_auprc_score: 0.9321; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 248503.4062; train_edge_recon_loss: 3560827.2500; train_gene_expr_recon_loss: 29171914.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32981244.0000; train_optim_loss: 32981244.0000; val_kl_reg_loss: 134537.8906; val_edge_recon_loss: 4066195.5000; val_gene_expr_recon_loss: 29030944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33231678.0000; val_optim_loss: 33231678.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9294; val_auprc_score: 0.9350; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 141851.5781; train_edge_recon_loss: 3650918.0000; train_gene_expr_recon_loss: 28924694.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32717464.0000; train_optim_loss: 32717464.0000; val_kl_reg_loss: 134175.1875; val_edge_recon_loss: 4066202.2500; val_gene_expr_recon_loss: 29036364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33236742.0000; val_optim_loss: 33236742.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9364; val_auprc_score: 0.9364; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 140061.0312; train_edge_recon_loss: 3654107.5000; train_gene_expr_recon_loss: 28897308.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32691476.0000; train_optim_loss: 32691476.0000; val_kl_reg_loss: 134130.1562; val_edge_recon_loss: 4066199.0000; val_gene_expr_recon_loss: 28976404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33176732.0000; val_optim_loss: 33176732.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
val AUROC score: 0.9351
val AUPRC score: 0.9401
val best accuracy score: 0.5049
val best F1 score: 0.6688
val target rna MSE score: 210.0871
val source rna MSE score: 59.6975
Duration of model training in run 2: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 3191
Number of validation nodes: 355
Number of training edges: 7397
Number of validation edges: 821
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9277; val_auprc_score: 0.9333; val_best_acc_score: 0.5018; val_best_f1_score: 0.6675; train_kl_reg_loss: 1868.8341; train_edge_recon_loss: 3475386.0000; train_gene_expr_recon_loss: 23686436.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27163690.0000; train_optim_loss: 27163690.0000; val_kl_reg_loss: 2943240.5000; val_edge_recon_loss: 4065168.2500; val_gene_expr_recon_loss: 298428640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 305437056.0000; val_optim_loss: 305437056.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9222; val_auprc_score: 0.9208; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 3138925.7500; train_edge_recon_loss: 3609156.2500; train_gene_expr_recon_loss: 404730080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411478176.0000; train_optim_loss: 411478176.0000; val_kl_reg_loss: 358894.6250; val_edge_recon_loss: 4065147.7500; val_gene_expr_recon_loss: 36958272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41382316.0000; val_optim_loss: 41382316.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9211; val_auprc_score: 0.9212; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 374195.3750; train_edge_recon_loss: 3523935.5000; train_gene_expr_recon_loss: 91605296.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95503424.0000; train_optim_loss: 95503424.0000; val_kl_reg_loss: 199933.3750; val_edge_recon_loss: 4065773.7500; val_gene_expr_recon_loss: 23821556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28087264.0000; val_optim_loss: 28087264.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9161; val_auprc_score: 0.9242; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 208846.1250; train_edge_recon_loss: 3525013.2500; train_gene_expr_recon_loss: 34864492.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38598352.0000; train_optim_loss: 38598352.0000; val_kl_reg_loss: 87550.4219; val_edge_recon_loss: 4066006.7500; val_gene_expr_recon_loss: 25193088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29346646.0000; val_optim_loss: 29346646.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9155; val_auprc_score: 0.9063; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 90906.7031; train_edge_recon_loss: 3571995.2500; train_gene_expr_recon_loss: 25385972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29048874.0000; train_optim_loss: 29048874.0000; val_kl_reg_loss: 68173.6328; val_edge_recon_loss: 4066088.0000; val_gene_expr_recon_loss: 26775420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30909682.0000; val_optim_loss: 30909682.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9223; val_auprc_score: 0.9257; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 70731.1562; train_edge_recon_loss: 3642073.7500; train_gene_expr_recon_loss: 26720502.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30433308.0000; train_optim_loss: 30433308.0000; val_kl_reg_loss: 236555.0469; val_edge_recon_loss: 4066158.2500; val_gene_expr_recon_loss: 28067718.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32370432.0000; val_optim_loss: 32370432.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9171; val_auprc_score: 0.9106; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 239050.0625; train_edge_recon_loss: 3584721.5000; train_gene_expr_recon_loss: 28174128.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31997900.0000; train_optim_loss: 31997900.0000; val_kl_reg_loss: 213358.9688; val_edge_recon_loss: 4066194.5000; val_gene_expr_recon_loss: 28800572.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33080126.0000; val_optim_loss: 33080126.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9231; val_auprc_score: 0.9206; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 220838.6406; train_edge_recon_loss: 3569494.0000; train_gene_expr_recon_loss: 28625560.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32415892.0000; train_optim_loss: 32415892.0000; val_kl_reg_loss: 134878.6719; val_edge_recon_loss: 4066215.7500; val_gene_expr_recon_loss: 28939950.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33141044.0000; val_optim_loss: 33141044.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9298; val_auprc_score: 0.9338; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 139957.3750; train_edge_recon_loss: 3691799.0000; train_gene_expr_recon_loss: 28781512.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32613268.0000; train_optim_loss: 32613268.0000; val_kl_reg_loss: 139331.7812; val_edge_recon_loss: 4066219.7500; val_gene_expr_recon_loss: 28946528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33152080.0000; val_optim_loss: 33152080.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9242; val_auprc_score: 0.9276; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 144211.1406; train_edge_recon_loss: 3691194.7500; train_gene_expr_recon_loss: 28772936.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32608342.0000; train_optim_loss: 32608342.0000; val_kl_reg_loss: 148594.4062; val_edge_recon_loss: 4066217.2500; val_gene_expr_recon_loss: 28905472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33120284.0000; val_optim_loss: 33120284.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9234; val_auprc_score: 0.9236; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 152742.1719; train_edge_recon_loss: 3682111.2500; train_gene_expr_recon_loss: 28734164.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32569018.0000; train_optim_loss: 32569018.0000; val_kl_reg_loss: 160168.3438; val_edge_recon_loss: 4066227.7500; val_gene_expr_recon_loss: 28837638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33064034.0000; val_optim_loss: 33064034.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9217
val AUPRC score: 0.9282
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 798.7578
val source rna MSE score: 59.7066
Duration of model training in run 1: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
