Run timestamp: 21062023_133744.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6687; val_auprc_score: 0.6933; val_best_acc_score: 0.6422; val_best_f1_score: 0.6506; train_kl_reg_loss: 1056.5948; train_edge_recon_loss: 365760.5781; train_cond_contrastive_loss: 140832.5938; train_gene_expr_recon_loss: 139574.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 647224.0938; train_optim_loss: 647224.0938; val_kl_reg_loss: 1941.1135; val_edge_recon_loss: 424170.5938; val_cond_contrastive_loss: 78443.4844; val_gene_expr_recon_loss: 120083.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 624638.9375; val_optim_loss: 624638.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6458; val_auprc_score: 0.6671; val_best_acc_score: 0.6282; val_best_f1_score: 0.6470; train_kl_reg_loss: 2582.2373; train_edge_recon_loss: 383946.7344; train_cond_contrastive_loss: 100366.1250; train_gene_expr_recon_loss: 115917.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 602812.9375; train_optim_loss: 602812.9375; val_kl_reg_loss: 4301.2959; val_edge_recon_loss: 425575.2812; val_cond_contrastive_loss: 78411.2969; val_gene_expr_recon_loss: 110142.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 618430.5625; val_optim_loss: 618430.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6534; val_auprc_score: 0.6757; val_best_acc_score: 0.6261; val_best_f1_score: 0.6503; train_kl_reg_loss: 5711.8892; train_edge_recon_loss: 381903.9844; train_cond_contrastive_loss: 89419.6797; train_gene_expr_recon_loss: 108191.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 585227.2500; train_optim_loss: 585227.2500; val_kl_reg_loss: 12861.9688; val_edge_recon_loss: 418708.5625; val_cond_contrastive_loss: 78429.1953; val_gene_expr_recon_loss: 106500.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 616499.9375; val_optim_loss: 616499.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6540; val_auprc_score: 0.6701; val_best_acc_score: 0.6207; val_best_f1_score: 0.6498; train_kl_reg_loss: 12624.3794; train_edge_recon_loss: 374762.4688; train_cond_contrastive_loss: 89427.3867; train_gene_expr_recon_loss: 106970.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 583784.9688; train_optim_loss: 583784.9688; val_kl_reg_loss: 7637.8311; val_edge_recon_loss: 410681.7812; val_cond_contrastive_loss: 78467.7578; val_gene_expr_recon_loss: 105466.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602253.5000; val_optim_loss: 602253.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6431; val_auprc_score: 0.6610; val_best_acc_score: 0.6065; val_best_f1_score: 0.6456; train_kl_reg_loss: 7241.4880; train_edge_recon_loss: 373479.8125; train_cond_contrastive_loss: 89887.9570; train_gene_expr_recon_loss: 104718.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 575327.4688; train_optim_loss: 575327.4688; val_kl_reg_loss: 5038.4404; val_edge_recon_loss: 402025.8125; val_cond_contrastive_loss: 78530.2500; val_gene_expr_recon_loss: 104967.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 590562.3125; val_optim_loss: 590562.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6412; val_auprc_score: 0.6616; val_best_acc_score: 0.6071; val_best_f1_score: 0.6553; train_kl_reg_loss: 4929.3867; train_edge_recon_loss: 367901.0469; train_cond_contrastive_loss: 88936.4023; train_gene_expr_recon_loss: 104147.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 565914.5000; train_optim_loss: 565914.5000; val_kl_reg_loss: 4003.5090; val_edge_recon_loss: 381574.6250; val_cond_contrastive_loss: 78599.6875; val_gene_expr_recon_loss: 104726.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568903.9375; val_optim_loss: 568903.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6525; val_auprc_score: 0.6739; val_best_acc_score: 0.6278; val_best_f1_score: 0.6557; train_kl_reg_loss: 3959.9080; train_edge_recon_loss: 358208.7812; train_cond_contrastive_loss: 86582.9297; train_gene_expr_recon_loss: 103769.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 552521.2500; train_optim_loss: 552521.2500; val_kl_reg_loss: 3501.2566; val_edge_recon_loss: 368606.3438; val_cond_contrastive_loss: 78581.3125; val_gene_expr_recon_loss: 104487.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555176.6250; val_optim_loss: 555176.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6528; val_auprc_score: 0.6620; val_best_acc_score: 0.6220; val_best_f1_score: 0.6510; train_kl_reg_loss: 3521.6125; train_edge_recon_loss: 350579.8281; train_cond_contrastive_loss: 84062.6875; train_gene_expr_recon_loss: 103523.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 541687.6250; train_optim_loss: 541687.6250; val_kl_reg_loss: 3393.9487; val_edge_recon_loss: 366234.8438; val_cond_contrastive_loss: 78486.3750; val_gene_expr_recon_loss: 104244.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 552359.4375; val_optim_loss: 552359.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6411; val_auprc_score: 0.6589; val_best_acc_score: 0.6226; val_best_f1_score: 0.6436; train_kl_reg_loss: 3479.3826; train_edge_recon_loss: 346218.3125; train_cond_contrastive_loss: 82090.7422; train_gene_expr_recon_loss: 103042.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534831.1562; train_optim_loss: 534831.1562; val_kl_reg_loss: 3535.4419; val_edge_recon_loss: 374084.4688; val_cond_contrastive_loss: 78441.9531; val_gene_expr_recon_loss: 103959.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560021.5000; val_optim_loss: 560021.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6594; val_auprc_score: 0.6701; val_best_acc_score: 0.6268; val_best_f1_score: 0.6535; train_kl_reg_loss: 3629.7793; train_edge_recon_loss: 344821.1875; train_cond_contrastive_loss: 81023.2539; train_gene_expr_recon_loss: 102910.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532384.4062; train_optim_loss: 532384.4062; val_kl_reg_loss: 3654.7341; val_edge_recon_loss: 364595.1250; val_cond_contrastive_loss: 78426.6875; val_gene_expr_recon_loss: 103584.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550261.5000; val_optim_loss: 550261.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6633; val_auprc_score: 0.6714; val_best_acc_score: 0.6289; val_best_f1_score: 0.6509; train_kl_reg_loss: 3721.8705; train_edge_recon_loss: 345265.4531; train_cond_contrastive_loss: 80670.5977; train_gene_expr_recon_loss: 102381.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532039.5625; train_optim_loss: 532039.5625; val_kl_reg_loss: 3675.1362; val_edge_recon_loss: 363999.4062; val_cond_contrastive_loss: 78429.7031; val_gene_expr_recon_loss: 103293.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 549398.1875; val_optim_loss: 549398.1875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6917; val_auprc_score: 0.6974; val_best_acc_score: 0.6529; val_best_f1_score: 0.6605; train_kl_reg_loss: 3706.3699; train_edge_recon_loss: 341852.4844; train_cond_contrastive_loss: 80525.2852; train_gene_expr_recon_loss: 102383.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528467.2812; train_optim_loss: 528467.2812; val_kl_reg_loss: 3701.9023; val_edge_recon_loss: 354069.2812; val_cond_contrastive_loss: 78426.0156; val_gene_expr_recon_loss: 103100.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539298.1250; val_optim_loss: 539298.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6998; val_auprc_score: 0.7036; val_best_acc_score: 0.6510; val_best_f1_score: 0.6599; train_kl_reg_loss: 3723.6173; train_edge_recon_loss: 339016.6250; train_cond_contrastive_loss: 80491.5898; train_gene_expr_recon_loss: 102061.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525292.9844; train_optim_loss: 525292.9844; val_kl_reg_loss: 3735.1362; val_edge_recon_loss: 348469.2188; val_cond_contrastive_loss: 78422.8516; val_gene_expr_recon_loss: 102942.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 533570.1250; val_optim_loss: 533570.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7195; val_auprc_score: 0.7173; val_best_acc_score: 0.6585; val_best_f1_score: 0.6682; train_kl_reg_loss: 3790.2795; train_edge_recon_loss: 335073.7500; train_cond_contrastive_loss: 80340.9102; train_gene_expr_recon_loss: 101891.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521096.7031; train_optim_loss: 521096.7031; val_kl_reg_loss: 3882.3491; val_edge_recon_loss: 343868.4688; val_cond_contrastive_loss: 78425.0078; val_gene_expr_recon_loss: 102784.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528960.2500; val_optim_loss: 528960.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7391; val_auprc_score: 0.7266; val_best_acc_score: 0.6743; val_best_f1_score: 0.6779; train_kl_reg_loss: 3993.3042; train_edge_recon_loss: 329309.0469; train_cond_contrastive_loss: 79990.5352; train_gene_expr_recon_loss: 101585.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 514877.9219; train_optim_loss: 514877.9219; val_kl_reg_loss: 4263.6323; val_edge_recon_loss: 341807.6875; val_cond_contrastive_loss: 78430.6562; val_gene_expr_recon_loss: 102598.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 527100.4375; val_optim_loss: 527100.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7540; val_auprc_score: 0.7149; val_best_acc_score: 0.6842; val_best_f1_score: 0.7006; train_kl_reg_loss: 4421.8867; train_edge_recon_loss: 324184.8281; train_cond_contrastive_loss: 79619.8750; train_gene_expr_recon_loss: 101415.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 509642.0938; train_optim_loss: 509642.0938; val_kl_reg_loss: 4810.7344; val_edge_recon_loss: 330290.1250; val_cond_contrastive_loss: 78436.1250; val_gene_expr_recon_loss: 102323.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 515860.9688; val_optim_loss: 515860.9688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7639; val_auprc_score: 0.7329; val_best_acc_score: 0.6943; val_best_f1_score: 0.7180; train_kl_reg_loss: 5053.1851; train_edge_recon_loss: 316740.4062; train_cond_contrastive_loss: 79191.4648; train_gene_expr_recon_loss: 101119.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 502104.8281; train_optim_loss: 502104.8281; val_kl_reg_loss: 5505.3174; val_edge_recon_loss: 320833.9062; val_cond_contrastive_loss: 78451.4453; val_gene_expr_recon_loss: 101992.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 506782.7188; val_optim_loss: 506782.7188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7996; val_auprc_score: 0.7677; val_best_acc_score: 0.7188; val_best_f1_score: 0.7415; train_kl_reg_loss: 5763.4111; train_edge_recon_loss: 310233.5781; train_cond_contrastive_loss: 78922.5039; train_gene_expr_recon_loss: 100856.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495776.1250; train_optim_loss: 495776.1250; val_kl_reg_loss: 6170.4697; val_edge_recon_loss: 310536.1250; val_cond_contrastive_loss: 78452.5859; val_gene_expr_recon_loss: 101713.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 496873.0938; val_optim_loss: 496873.0938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7913; val_auprc_score: 0.7516; val_best_acc_score: 0.7121; val_best_f1_score: 0.7432; train_kl_reg_loss: 6411.3999; train_edge_recon_loss: 307772.7969; train_cond_contrastive_loss: 78777.6055; train_gene_expr_recon_loss: 100636.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493598.2031; train_optim_loss: 493598.2031; val_kl_reg_loss: 6684.5088; val_edge_recon_loss: 316551.3750; val_cond_contrastive_loss: 78435.5547; val_gene_expr_recon_loss: 101500.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 503171.5000; val_optim_loss: 503171.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8042; val_auprc_score: 0.7519; val_best_acc_score: 0.7255; val_best_f1_score: 0.7559; train_kl_reg_loss: 6953.2939; train_edge_recon_loss: 303851.3281; train_cond_contrastive_loss: 78701.0547; train_gene_expr_recon_loss: 100257.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489763.5938; train_optim_loss: 489763.5938; val_kl_reg_loss: 7147.8721; val_edge_recon_loss: 310901.2812; val_cond_contrastive_loss: 78440.6719; val_gene_expr_recon_loss: 101295.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497785.1250; val_optim_loss: 497785.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8131; val_auprc_score: 0.7704; val_best_acc_score: 0.7369; val_best_f1_score: 0.7708; train_kl_reg_loss: 7392.8381; train_edge_recon_loss: 303525.4375; train_cond_contrastive_loss: 78675.9961; train_gene_expr_recon_loss: 100093.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489687.6406; train_optim_loss: 489687.6406; val_kl_reg_loss: 7456.6562; val_edge_recon_loss: 300482.2812; val_cond_contrastive_loss: 78425.3203; val_gene_expr_recon_loss: 101049.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487413.2500; val_optim_loss: 487413.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8217; val_auprc_score: 0.7770; val_best_acc_score: 0.7399; val_best_f1_score: 0.7643; train_kl_reg_loss: 7689.0222; train_edge_recon_loss: 299524.7656; train_cond_contrastive_loss: 78664.7344; train_gene_expr_recon_loss: 99675.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485554.4062; train_optim_loss: 485554.4062; val_kl_reg_loss: 7606.3452; val_edge_recon_loss: 304631.8750; val_cond_contrastive_loss: 78428.1250; val_gene_expr_recon_loss: 100839.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491505.9375; val_optim_loss: 491505.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8197; val_auprc_score: 0.7669; val_best_acc_score: 0.7388; val_best_f1_score: 0.7626; train_kl_reg_loss: 7800.6758; train_edge_recon_loss: 301623.0469; train_cond_contrastive_loss: 78668.5469; train_gene_expr_recon_loss: 99623.3867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487715.6406; train_optim_loss: 487715.6406; val_kl_reg_loss: 7496.6377; val_edge_recon_loss: 308340.2812; val_cond_contrastive_loss: 78426.9297; val_gene_expr_recon_loss: 100681.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494945.0625; val_optim_loss: 494945.0625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8238; val_auprc_score: 0.7729; val_best_acc_score: 0.7561; val_best_f1_score: 0.7785; train_kl_reg_loss: 7668.1155; train_edge_recon_loss: 299265.7500; train_cond_contrastive_loss: 78717.6914; train_gene_expr_recon_loss: 99587.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485239.5156; train_optim_loss: 485239.5156; val_kl_reg_loss: 7293.1816; val_edge_recon_loss: 298697.8438; val_cond_contrastive_loss: 78415.9453; val_gene_expr_recon_loss: 100516.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484923.2500; val_optim_loss: 484923.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8391; val_auprc_score: 0.7894; val_best_acc_score: 0.7677; val_best_f1_score: 0.7829; train_kl_reg_loss: 7402.1406; train_edge_recon_loss: 299001.7969; train_cond_contrastive_loss: 78794.9688; train_gene_expr_recon_loss: 99351.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484550.4688; train_optim_loss: 484550.4688; val_kl_reg_loss: 6931.6484; val_edge_recon_loss: 299897.4375; val_cond_contrastive_loss: 78429.6562; val_gene_expr_recon_loss: 100369.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485628.7500; val_optim_loss: 485628.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8345; val_auprc_score: 0.7828; val_best_acc_score: 0.7613; val_best_f1_score: 0.7786; train_kl_reg_loss: 7053.2329; train_edge_recon_loss: 298396.2500; train_cond_contrastive_loss: 78901.6367; train_gene_expr_recon_loss: 99245.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483596.3750; train_optim_loss: 483596.3750; val_kl_reg_loss: 6629.6240; val_edge_recon_loss: 300656.5625; val_cond_contrastive_loss: 78431.2422; val_gene_expr_recon_loss: 100231.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485949.3438; val_optim_loss: 485949.3438
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8414; val_auprc_score: 0.7861; val_best_acc_score: 0.7723; val_best_f1_score: 0.7897; train_kl_reg_loss: 6785.1421; train_edge_recon_loss: 295292.5000; train_cond_contrastive_loss: 78986.3125; train_gene_expr_recon_loss: 99177.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480241.8438; train_optim_loss: 480241.8438; val_kl_reg_loss: 6437.0264; val_edge_recon_loss: 298543.0000; val_cond_contrastive_loss: 78434.5391; val_gene_expr_recon_loss: 100105.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483520.0312; val_optim_loss: 483520.0312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8459; val_auprc_score: 0.7791; val_best_acc_score: 0.7787; val_best_f1_score: 0.7922; train_kl_reg_loss: 6632.5852; train_edge_recon_loss: 298520.3438; train_cond_contrastive_loss: 79015.2422; train_gene_expr_recon_loss: 98985.2383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483153.4062; train_optim_loss: 483153.4062; val_kl_reg_loss: 6382.8916; val_edge_recon_loss: 301529.4062; val_cond_contrastive_loss: 78440.3047; val_gene_expr_recon_loss: 99953.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486306.4375; val_optim_loss: 486306.4375
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8585; val_auprc_score: 0.8037; val_best_acc_score: 0.7907; val_best_f1_score: 0.8009; train_kl_reg_loss: 6593.6677; train_edge_recon_loss: 296669.5625; train_cond_contrastive_loss: 79002.4062; train_gene_expr_recon_loss: 98978.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481243.6562; train_optim_loss: 481243.6562; val_kl_reg_loss: 6355.2251; val_edge_recon_loss: 295737.4375; val_cond_contrastive_loss: 78462.8203; val_gene_expr_recon_loss: 99789.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480345.1250; val_optim_loss: 480345.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8611; val_auprc_score: 0.8013; val_best_acc_score: 0.7963; val_best_f1_score: 0.8088; train_kl_reg_loss: 6580.5718; train_edge_recon_loss: 290819.9688; train_cond_contrastive_loss: 78973.8594; train_gene_expr_recon_loss: 98760.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475134.8594; train_optim_loss: 475134.8594; val_kl_reg_loss: 6361.0698; val_edge_recon_loss: 296602.0625; val_cond_contrastive_loss: 78470.2188; val_gene_expr_recon_loss: 99632.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481065.8750; val_optim_loss: 481065.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8798; val_auprc_score: 0.8262; val_best_acc_score: 0.8210; val_best_f1_score: 0.8281; train_kl_reg_loss: 6572.5251; train_edge_recon_loss: 292361.6562; train_cond_contrastive_loss: 78942.5625; train_gene_expr_recon_loss: 98491.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476367.8594; train_optim_loss: 476367.8594; val_kl_reg_loss: 6341.1699; val_edge_recon_loss: 286213.1562; val_cond_contrastive_loss: 78482.9609; val_gene_expr_recon_loss: 99486.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470523.4375; val_optim_loss: 470523.4375
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8687; val_auprc_score: 0.8161; val_best_acc_score: 0.8060; val_best_f1_score: 0.8171; train_kl_reg_loss: 6533.8230; train_edge_recon_loss: 290608.2188; train_cond_contrastive_loss: 78928.5547; train_gene_expr_recon_loss: 98373.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474443.8750; train_optim_loss: 474443.8750; val_kl_reg_loss: 6317.7637; val_edge_recon_loss: 296062.0625; val_cond_contrastive_loss: 78504.8359; val_gene_expr_recon_loss: 99377.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480261.7812; val_optim_loss: 480261.7812
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8841; val_auprc_score: 0.8356; val_best_acc_score: 0.8123; val_best_f1_score: 0.8211; train_kl_reg_loss: 6513.5894; train_edge_recon_loss: 290890.5000; train_cond_contrastive_loss: 78895.8906; train_gene_expr_recon_loss: 98338.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474638.4531; train_optim_loss: 474638.4531; val_kl_reg_loss: 6330.2573; val_edge_recon_loss: 293023.5000; val_cond_contrastive_loss: 78518.8438; val_gene_expr_recon_loss: 99271.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477143.6562; val_optim_loss: 477143.6562
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8945; val_auprc_score: 0.8534; val_best_acc_score: 0.8240; val_best_f1_score: 0.8298; train_kl_reg_loss: 6508.6973; train_edge_recon_loss: 291079.6562; train_cond_contrastive_loss: 78851.4570; train_gene_expr_recon_loss: 98265.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474705.1094; train_optim_loss: 474705.1094; val_kl_reg_loss: 6252.3169; val_edge_recon_loss: 290262.6875; val_cond_contrastive_loss: 78530.4141; val_gene_expr_recon_loss: 99145.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474190.9688; val_optim_loss: 474190.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8942; val_auprc_score: 0.8607; val_best_acc_score: 0.8235; val_best_f1_score: 0.8324; train_kl_reg_loss: 6426.2893; train_edge_recon_loss: 287396.5469; train_cond_contrastive_loss: 78840.0469; train_gene_expr_recon_loss: 98225.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470887.9219; train_optim_loss: 470887.9219; val_kl_reg_loss: 6241.5117; val_edge_recon_loss: 287567.5938; val_cond_contrastive_loss: 78529.0234; val_gene_expr_recon_loss: 99129.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471467.8125; val_optim_loss: 471467.8125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8860; val_auprc_score: 0.8381; val_best_acc_score: 0.8134; val_best_f1_score: 0.8211; train_kl_reg_loss: 6411.9023; train_edge_recon_loss: 288390.0000; train_cond_contrastive_loss: 78838.1641; train_gene_expr_recon_loss: 98070.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471710.9688; train_optim_loss: 471710.9688; val_kl_reg_loss: 6228.6943; val_edge_recon_loss: 296343.6250; val_cond_contrastive_loss: 78527.5859; val_gene_expr_recon_loss: 99110.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480210.5312; val_optim_loss: 480210.5312
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8906; val_auprc_score: 0.8522; val_best_acc_score: 0.8165; val_best_f1_score: 0.8268; train_kl_reg_loss: 6399.1213; train_edge_recon_loss: 289804.7812; train_cond_contrastive_loss: 78836.5078; train_gene_expr_recon_loss: 98067.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473107.7031; train_optim_loss: 473107.7031; val_kl_reg_loss: 6207.8438; val_edge_recon_loss: 288424.5625; val_cond_contrastive_loss: 78533.1094; val_gene_expr_recon_loss: 99091.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472256.6250; val_optim_loss: 472256.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 52 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.8741
Val AUPRC score: 0.8190
Val best accuracy score: 0.8133
Val best F1 score: 0.8213
Val gene expr MSE score: 2.0056
Duration of model training in run 1: 0 hours, 1 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7011; val_auprc_score: 0.7251; val_best_acc_score: 0.6583; val_best_f1_score: 0.6590; train_kl_reg_loss: 1161.0589; train_edge_recon_loss: 366961.6875; train_cond_contrastive_loss: 139230.9492; train_gene_expr_recon_loss: 144418.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 651772.3125; train_optim_loss: 651772.3125; val_kl_reg_loss: 2102.2593; val_edge_recon_loss: 425490.4375; val_cond_contrastive_loss: 78429.7188; val_gene_expr_recon_loss: 121079.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 627102.0625; val_optim_loss: 627102.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6787; val_auprc_score: 0.7003; val_best_acc_score: 0.6378; val_best_f1_score: 0.6606; train_kl_reg_loss: 2775.4214; train_edge_recon_loss: 381433.6875; train_cond_contrastive_loss: 99052.2656; train_gene_expr_recon_loss: 118011.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 601273.1562; train_optim_loss: 601273.1562; val_kl_reg_loss: 5021.1543; val_edge_recon_loss: 423079.2812; val_cond_contrastive_loss: 78404.8828; val_gene_expr_recon_loss: 110712.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 617218.1875; val_optim_loss: 617218.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6596; val_auprc_score: 0.6829; val_best_acc_score: 0.6316; val_best_f1_score: 0.6547; train_kl_reg_loss: 9088.0613; train_edge_recon_loss: 384925.4531; train_cond_contrastive_loss: 85407.5820; train_gene_expr_recon_loss: 111354.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 590775.5000; train_optim_loss: 590775.5000; val_kl_reg_loss: 9493.6621; val_edge_recon_loss: 416932.4062; val_cond_contrastive_loss: 78422.4297; val_gene_expr_recon_loss: 106935.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 611784.0000; val_optim_loss: 611784.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6577; val_auprc_score: 0.6835; val_best_acc_score: 0.6173; val_best_f1_score: 0.6605; train_kl_reg_loss: 8981.4961; train_edge_recon_loss: 376757.8750; train_cond_contrastive_loss: 86446.7148; train_gene_expr_recon_loss: 107145.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 579331.7188; train_optim_loss: 579331.7188; val_kl_reg_loss: 6350.9326; val_edge_recon_loss: 404967.2188; val_cond_contrastive_loss: 78463.1719; val_gene_expr_recon_loss: 105854.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595636.2500; val_optim_loss: 595636.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6544; val_auprc_score: 0.6696; val_best_acc_score: 0.6121; val_best_f1_score: 0.6512; train_kl_reg_loss: 6271.4731; train_edge_recon_loss: 371257.5469; train_cond_contrastive_loss: 88226.8281; train_gene_expr_recon_loss: 105940.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 571696.0938; train_optim_loss: 571696.0938; val_kl_reg_loss: 5034.7695; val_edge_recon_loss: 399873.4062; val_cond_contrastive_loss: 78525.9609; val_gene_expr_recon_loss: 105182.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 588616.2500; val_optim_loss: 588616.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6708; val_auprc_score: 0.6808; val_best_acc_score: 0.6257; val_best_f1_score: 0.6556; train_kl_reg_loss: 5030.1550; train_edge_recon_loss: 368321.2344; train_cond_contrastive_loss: 89516.7773; train_gene_expr_recon_loss: 104847.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567715.2500; train_optim_loss: 567715.2500; val_kl_reg_loss: 4139.4019; val_edge_recon_loss: 382372.6875; val_cond_contrastive_loss: 78580.8750; val_gene_expr_recon_loss: 104705.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 569798.8125; val_optim_loss: 569798.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6568; val_auprc_score: 0.6595; val_best_acc_score: 0.6359; val_best_f1_score: 0.6523; train_kl_reg_loss: 4129.7351; train_edge_recon_loss: 358326.7969; train_cond_contrastive_loss: 89599.3125; train_gene_expr_recon_loss: 104559.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556615.5938; train_optim_loss: 556615.5938; val_kl_reg_loss: 3659.2578; val_edge_recon_loss: 374677.3750; val_cond_contrastive_loss: 78556.6562; val_gene_expr_recon_loss: 104446.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561339.3125; val_optim_loss: 561339.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6785; val_auprc_score: 0.6867; val_best_acc_score: 0.6577; val_best_f1_score: 0.6437; train_kl_reg_loss: 3742.6187; train_edge_recon_loss: 349816.3125; train_cond_contrastive_loss: 87111.2070; train_gene_expr_recon_loss: 104338.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545008.3438; train_optim_loss: 545008.3438; val_kl_reg_loss: 3699.1775; val_edge_recon_loss: 369378.3750; val_cond_contrastive_loss: 78479.6953; val_gene_expr_recon_loss: 104191.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555748.9375; val_optim_loss: 555748.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6628; val_auprc_score: 0.6809; val_best_acc_score: 0.6371; val_best_f1_score: 0.6474; train_kl_reg_loss: 3856.2180; train_edge_recon_loss: 345538.9844; train_cond_contrastive_loss: 83213.9062; train_gene_expr_recon_loss: 104021.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536630.8438; train_optim_loss: 536630.8438; val_kl_reg_loss: 4000.8350; val_edge_recon_loss: 370118.7188; val_cond_contrastive_loss: 78435.8984; val_gene_expr_recon_loss: 103873.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556429.2500; val_optim_loss: 556429.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6725; val_auprc_score: 0.6863; val_best_acc_score: 0.6349; val_best_f1_score: 0.6529; train_kl_reg_loss: 4151.2668; train_edge_recon_loss: 347597.5781; train_cond_contrastive_loss: 81099.1445; train_gene_expr_recon_loss: 103708.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536556.7500; train_optim_loss: 536556.7500; val_kl_reg_loss: 4250.6606; val_edge_recon_loss: 362831.4375; val_cond_contrastive_loss: 78424.3359; val_gene_expr_recon_loss: 103507.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 549014.4375; val_optim_loss: 549014.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6840; val_auprc_score: 0.6977; val_best_acc_score: 0.6460; val_best_f1_score: 0.6608; train_kl_reg_loss: 4347.0449; train_edge_recon_loss: 346097.7188; train_cond_contrastive_loss: 80302.4102; train_gene_expr_recon_loss: 103184.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533931.4062; train_optim_loss: 533931.4062; val_kl_reg_loss: 4285.6265; val_edge_recon_loss: 357001.6875; val_cond_contrastive_loss: 78422.9219; val_gene_expr_recon_loss: 103160.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542870.4375; val_optim_loss: 542870.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6916; val_auprc_score: 0.6950; val_best_acc_score: 0.6514; val_best_f1_score: 0.6513; train_kl_reg_loss: 4334.7393; train_edge_recon_loss: 346729.8594; train_cond_contrastive_loss: 80041.9023; train_gene_expr_recon_loss: 102775.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533882.0000; train_optim_loss: 533882.0000; val_kl_reg_loss: 4139.0063; val_edge_recon_loss: 365655.3125; val_cond_contrastive_loss: 78423.9688; val_gene_expr_recon_loss: 102907.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 551126.1250; val_optim_loss: 551126.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6973; val_auprc_score: 0.7108; val_best_acc_score: 0.6607; val_best_f1_score: 0.6579; train_kl_reg_loss: 4160.2363; train_edge_recon_loss: 343541.1875; train_cond_contrastive_loss: 80047.4883; train_gene_expr_recon_loss: 102871.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 530620.2188; train_optim_loss: 530620.2188; val_kl_reg_loss: 3908.8425; val_edge_recon_loss: 356444.6250; val_cond_contrastive_loss: 78430.8359; val_gene_expr_recon_loss: 102707.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 541492.3125; val_optim_loss: 541492.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7233; val_auprc_score: 0.7294; val_best_acc_score: 0.6670; val_best_f1_score: 0.6754; train_kl_reg_loss: 3907.6277; train_edge_recon_loss: 337748.5625; train_cond_contrastive_loss: 80149.4062; train_gene_expr_recon_loss: 102566.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 524372.2188; train_optim_loss: 524372.2188; val_kl_reg_loss: 3713.2019; val_edge_recon_loss: 341531.1562; val_cond_contrastive_loss: 78442.2109; val_gene_expr_recon_loss: 102484.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526171.1250; val_optim_loss: 526171.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7375; val_auprc_score: 0.7383; val_best_acc_score: 0.6735; val_best_f1_score: 0.6830; train_kl_reg_loss: 3764.4877; train_edge_recon_loss: 331889.3438; train_cond_contrastive_loss: 80348.0195; train_gene_expr_recon_loss: 102433.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518435.8281; train_optim_loss: 518435.8281; val_kl_reg_loss: 3750.2954; val_edge_recon_loss: 337155.4688; val_cond_contrastive_loss: 78451.8438; val_gene_expr_recon_loss: 102232.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 521590.0312; val_optim_loss: 521590.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7589; val_auprc_score: 0.7424; val_best_acc_score: 0.6856; val_best_f1_score: 0.6982; train_kl_reg_loss: 3877.8552; train_edge_recon_loss: 325797.6250; train_cond_contrastive_loss: 80156.2578; train_gene_expr_recon_loss: 101973.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511805.5469; train_optim_loss: 511805.5469; val_kl_reg_loss: 4059.3940; val_edge_recon_loss: 331613.7812; val_cond_contrastive_loss: 78469.3281; val_gene_expr_recon_loss: 101950.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 516093.2188; val_optim_loss: 516093.2188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7824; val_auprc_score: 0.7549; val_best_acc_score: 0.7032; val_best_f1_score: 0.7181; train_kl_reg_loss: 4256.7136; train_edge_recon_loss: 319085.3750; train_cond_contrastive_loss: 79810.2148; train_gene_expr_recon_loss: 101797.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504949.6250; train_optim_loss: 504949.6250; val_kl_reg_loss: 4646.0532; val_edge_recon_loss: 323863.0000; val_cond_contrastive_loss: 78476.4297; val_gene_expr_recon_loss: 101648.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 508634.1562; val_optim_loss: 508634.1562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7874; val_auprc_score: 0.7440; val_best_acc_score: 0.7090; val_best_f1_score: 0.7352; train_kl_reg_loss: 4920.1917; train_edge_recon_loss: 310802.4375; train_cond_contrastive_loss: 79360.9023; train_gene_expr_recon_loss: 101359.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496442.8438; train_optim_loss: 496442.8438; val_kl_reg_loss: 5471.5347; val_edge_recon_loss: 317926.4062; val_cond_contrastive_loss: 78471.1328; val_gene_expr_recon_loss: 101348.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 503217.7500; val_optim_loss: 503217.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8082; val_auprc_score: 0.7718; val_best_acc_score: 0.7308; val_best_f1_score: 0.7542; train_kl_reg_loss: 5785.8379; train_edge_recon_loss: 307579.9688; train_cond_contrastive_loss: 78944.8164; train_gene_expr_recon_loss: 101144.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493455.3906; train_optim_loss: 493455.3906; val_kl_reg_loss: 6315.7031; val_edge_recon_loss: 309890.5625; val_cond_contrastive_loss: 78460.8906; val_gene_expr_recon_loss: 101054.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 495721.7812; val_optim_loss: 495721.7812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8024; val_auprc_score: 0.7608; val_best_acc_score: 0.7194; val_best_f1_score: 0.7499; train_kl_reg_loss: 6619.8623; train_edge_recon_loss: 303232.0312; train_cond_contrastive_loss: 78746.8125; train_gene_expr_recon_loss: 100852.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489451.4375; train_optim_loss: 489451.4375; val_kl_reg_loss: 7000.6807; val_edge_recon_loss: 312058.3125; val_cond_contrastive_loss: 78454.7812; val_gene_expr_recon_loss: 100811.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498325.1250; val_optim_loss: 498325.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8257; val_auprc_score: 0.7778; val_best_acc_score: 0.7421; val_best_f1_score: 0.7609; train_kl_reg_loss: 7248.2864; train_edge_recon_loss: 303295.2344; train_cond_contrastive_loss: 78678.8750; train_gene_expr_recon_loss: 100573.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489795.7812; train_optim_loss: 489795.7812; val_kl_reg_loss: 7444.6484; val_edge_recon_loss: 305295.0938; val_cond_contrastive_loss: 78443.5234; val_gene_expr_recon_loss: 100629.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491812.7500; val_optim_loss: 491812.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8184; val_auprc_score: 0.7651; val_best_acc_score: 0.7392; val_best_f1_score: 0.7648; train_kl_reg_loss: 7681.2151; train_edge_recon_loss: 300293.5000; train_cond_contrastive_loss: 78667.2383; train_gene_expr_recon_loss: 100381.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487023.8906; train_optim_loss: 487023.8906; val_kl_reg_loss: 7738.0166; val_edge_recon_loss: 305071.8750; val_cond_contrastive_loss: 78432.6484; val_gene_expr_recon_loss: 100420.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491662.5625; val_optim_loss: 491662.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8344; val_auprc_score: 0.7844; val_best_acc_score: 0.7591; val_best_f1_score: 0.7692; train_kl_reg_loss: 7926.1689; train_edge_recon_loss: 299666.6094; train_cond_contrastive_loss: 78663.6797; train_gene_expr_recon_loss: 100235.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486491.8594; train_optim_loss: 486491.8594; val_kl_reg_loss: 7814.0342; val_edge_recon_loss: 301711.0938; val_cond_contrastive_loss: 78429.1641; val_gene_expr_recon_loss: 100201.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488155.9375; val_optim_loss: 488155.9375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8286; val_auprc_score: 0.7695; val_best_acc_score: 0.7538; val_best_f1_score: 0.7715; train_kl_reg_loss: 8006.0791; train_edge_recon_loss: 299605.3750; train_cond_contrastive_loss: 78672.1719; train_gene_expr_recon_loss: 99902.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486185.7344; train_optim_loss: 486185.7344; val_kl_reg_loss: 7781.3623; val_edge_recon_loss: 301116.1562; val_cond_contrastive_loss: 78420.1250; val_gene_expr_recon_loss: 99987.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487305.5000; val_optim_loss: 487305.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8409; val_auprc_score: 0.7869; val_best_acc_score: 0.7636; val_best_f1_score: 0.7712; train_kl_reg_loss: 7914.8086; train_edge_recon_loss: 295955.4531; train_cond_contrastive_loss: 78687.9688; train_gene_expr_recon_loss: 99747.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482306.0469; train_optim_loss: 482306.0469; val_kl_reg_loss: 7566.5801; val_edge_recon_loss: 305283.5938; val_cond_contrastive_loss: 78418.2734; val_gene_expr_recon_loss: 99815.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491083.5312; val_optim_loss: 491083.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8467; val_auprc_score: 0.7970; val_best_acc_score: 0.7747; val_best_f1_score: 0.7858; train_kl_reg_loss: 7652.1794; train_edge_recon_loss: 296628.7969; train_cond_contrastive_loss: 78736.7930; train_gene_expr_recon_loss: 99448.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482465.9219; train_optim_loss: 482465.9219; val_kl_reg_loss: 7198.5361; val_edge_recon_loss: 297334.1562; val_cond_contrastive_loss: 78416.9844; val_gene_expr_recon_loss: 99656.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482606.1250; val_optim_loss: 482606.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8454; val_auprc_score: 0.7918; val_best_acc_score: 0.7680; val_best_f1_score: 0.7856; train_kl_reg_loss: 7290.2354; train_edge_recon_loss: 296271.9219; train_cond_contrastive_loss: 78818.6836; train_gene_expr_recon_loss: 99433.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481814.1875; train_optim_loss: 481814.1875; val_kl_reg_loss: 6811.8594; val_edge_recon_loss: 297394.5312; val_cond_contrastive_loss: 78424.0938; val_gene_expr_recon_loss: 99486.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482116.9375; val_optim_loss: 482116.9375
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8549; val_auprc_score: 0.7948; val_best_acc_score: 0.7798; val_best_f1_score: 0.7912; train_kl_reg_loss: 6956.3130; train_edge_recon_loss: 295687.1406; train_cond_contrastive_loss: 78902.9180; train_gene_expr_recon_loss: 99163.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480710.0469; train_optim_loss: 480710.0469; val_kl_reg_loss: 6543.7520; val_edge_recon_loss: 300698.0625; val_cond_contrastive_loss: 78427.7812; val_gene_expr_recon_loss: 99311.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484980.7188; val_optim_loss: 484980.7188
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8544; val_auprc_score: 0.7957; val_best_acc_score: 0.7802; val_best_f1_score: 0.8006; train_kl_reg_loss: 6687.1460; train_edge_recon_loss: 294531.7656; train_cond_contrastive_loss: 78956.8789; train_gene_expr_recon_loss: 99069.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479245.0156; train_optim_loss: 479245.0156; val_kl_reg_loss: 6367.2959; val_edge_recon_loss: 295503.2812; val_cond_contrastive_loss: 78430.3438; val_gene_expr_recon_loss: 99142.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479443.5000; val_optim_loss: 479443.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8700; val_auprc_score: 0.8170; val_best_acc_score: 0.8001; val_best_f1_score: 0.8144; train_kl_reg_loss: 6523.1936; train_edge_recon_loss: 292800.3438; train_cond_contrastive_loss: 78999.2656; train_gene_expr_recon_loss: 98909.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477232.5781; train_optim_loss: 477232.5781; val_kl_reg_loss: 6284.9946; val_edge_recon_loss: 293287.0312; val_cond_contrastive_loss: 78432.6172; val_gene_expr_recon_loss: 98987.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476991.8750; val_optim_loss: 476991.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8708; val_auprc_score: 0.8234; val_best_acc_score: 0.7928; val_best_f1_score: 0.8081; train_kl_reg_loss: 6455.8667; train_edge_recon_loss: 290736.4375; train_cond_contrastive_loss: 78990.5078; train_gene_expr_recon_loss: 98774.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474957.7344; train_optim_loss: 474957.7344; val_kl_reg_loss: 6306.4912; val_edge_recon_loss: 299577.5000; val_cond_contrastive_loss: 78443.0469; val_gene_expr_recon_loss: 98860.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483187.4375; val_optim_loss: 483187.4375
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8897; val_auprc_score: 0.8483; val_best_acc_score: 0.8080; val_best_f1_score: 0.8190; train_kl_reg_loss: 6506.6973; train_edge_recon_loss: 290077.8125; train_cond_contrastive_loss: 78926.0508; train_gene_expr_recon_loss: 98751.3867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474261.9531; train_optim_loss: 474261.9531; val_kl_reg_loss: 6372.0254; val_edge_recon_loss: 294379.9062; val_cond_contrastive_loss: 78452.2109; val_gene_expr_recon_loss: 98771.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477976.1250; val_optim_loss: 477976.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8896; val_auprc_score: 0.8448; val_best_acc_score: 0.8069; val_best_f1_score: 0.8202; train_kl_reg_loss: 6564.9619; train_edge_recon_loss: 288910.0312; train_cond_contrastive_loss: 78853.2578; train_gene_expr_recon_loss: 98524.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472852.9062; train_optim_loss: 472852.9062; val_kl_reg_loss: 6372.3750; val_edge_recon_loss: 293435.3125; val_cond_contrastive_loss: 78457.2812; val_gene_expr_recon_loss: 98653.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476918.8125; val_optim_loss: 476918.8125
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9002; val_auprc_score: 0.8632; val_best_acc_score: 0.8149; val_best_f1_score: 0.8194; train_kl_reg_loss: 6536.4719; train_edge_recon_loss: 288596.0000; train_cond_contrastive_loss: 78839.6250; train_gene_expr_recon_loss: 98290.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472262.7656; train_optim_loss: 472262.7656; val_kl_reg_loss: 6300.4346; val_edge_recon_loss: 296290.3750; val_cond_contrastive_loss: 78460.0000; val_gene_expr_recon_loss: 98546.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479597.6250; val_optim_loss: 479597.6250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8982; val_auprc_score: 0.8666; val_best_acc_score: 0.8176; val_best_f1_score: 0.8278; train_kl_reg_loss: 6456.6724; train_edge_recon_loss: 287104.7812; train_cond_contrastive_loss: 78838.7148; train_gene_expr_recon_loss: 98511.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470911.8906; train_optim_loss: 470911.8906; val_kl_reg_loss: 6219.3584; val_edge_recon_loss: 291549.2188; val_cond_contrastive_loss: 78468.8203; val_gene_expr_recon_loss: 98445.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474682.7188; val_optim_loss: 474682.7188
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9071; val_auprc_score: 0.8694; val_best_acc_score: 0.8340; val_best_f1_score: 0.8328; train_kl_reg_loss: 6374.6208; train_edge_recon_loss: 289400.6406; train_cond_contrastive_loss: 78796.4375; train_gene_expr_recon_loss: 98204.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472776.6250; train_optim_loss: 472776.6250; val_kl_reg_loss: 6163.0762; val_edge_recon_loss: 292533.0625; val_cond_contrastive_loss: 78476.3672; val_gene_expr_recon_loss: 98369.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475541.8750; val_optim_loss: 475541.8750
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9221; val_auprc_score: 0.8994; val_best_acc_score: 0.8372; val_best_f1_score: 0.8370; train_kl_reg_loss: 6331.3179; train_edge_recon_loss: 288146.2188; train_cond_contrastive_loss: 78750.1133; train_gene_expr_recon_loss: 98328.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471556.6250; train_optim_loss: 471556.6250; val_kl_reg_loss: 6099.6694; val_edge_recon_loss: 291294.3750; val_cond_contrastive_loss: 78477.6172; val_gene_expr_recon_loss: 98248.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474119.9688; val_optim_loss: 474119.9688
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9263; val_auprc_score: 0.9046; val_best_acc_score: 0.8427; val_best_f1_score: 0.8371; train_kl_reg_loss: 6238.7544; train_edge_recon_loss: 288256.0938; train_cond_contrastive_loss: 78735.5977; train_gene_expr_recon_loss: 98066.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471296.4844; train_optim_loss: 471296.4844; val_kl_reg_loss: 5978.7065; val_edge_recon_loss: 294365.7188; val_cond_contrastive_loss: 78476.2656; val_gene_expr_recon_loss: 98117.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476938.1562; val_optim_loss: 476938.1562
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9293; val_auprc_score: 0.9056; val_best_acc_score: 0.8492; val_best_f1_score: 0.8501; train_kl_reg_loss: 6118.7803; train_edge_recon_loss: 286191.8594; train_cond_contrastive_loss: 78746.8516; train_gene_expr_recon_loss: 98094.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469152.4375; train_optim_loss: 469152.4375; val_kl_reg_loss: 5920.2227; val_edge_recon_loss: 283895.3125; val_cond_contrastive_loss: 78482.7891; val_gene_expr_recon_loss: 98038.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466336.6875; val_optim_loss: 466336.6875
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9259; val_auprc_score: 0.9007; val_best_acc_score: 0.8495; val_best_f1_score: 0.8444; train_kl_reg_loss: 6076.6589; train_edge_recon_loss: 284409.7656; train_cond_contrastive_loss: 78743.1211; train_gene_expr_recon_loss: 97769.5117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466999.0625; train_optim_loss: 466999.0625; val_kl_reg_loss: 5918.0605; val_edge_recon_loss: 286790.6562; val_cond_contrastive_loss: 78480.3047; val_gene_expr_recon_loss: 97907.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469096.7500; val_optim_loss: 469096.7500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9321; val_auprc_score: 0.9076; val_best_acc_score: 0.8608; val_best_f1_score: 0.8555; train_kl_reg_loss: 6119.0718; train_edge_recon_loss: 285542.4531; train_cond_contrastive_loss: 78708.8359; train_gene_expr_recon_loss: 97738.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468108.7500; train_optim_loss: 468108.7500; val_kl_reg_loss: 5987.9517; val_edge_recon_loss: 289371.8438; val_cond_contrastive_loss: 78474.0000; val_gene_expr_recon_loss: 97796.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471630.7500; val_optim_loss: 471630.7500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9321; val_auprc_score: 0.9072; val_best_acc_score: 0.8597; val_best_f1_score: 0.8580; train_kl_reg_loss: 6169.6812; train_edge_recon_loss: 283709.2500; train_cond_contrastive_loss: 78680.8711; train_gene_expr_recon_loss: 97352.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465912.2031; train_optim_loss: 465912.2031; val_kl_reg_loss: 6056.5078; val_edge_recon_loss: 287178.7188; val_cond_contrastive_loss: 78479.4609; val_gene_expr_recon_loss: 97711.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469426.0938; val_optim_loss: 469426.0938

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9285; val_auprc_score: 0.9097; val_best_acc_score: 0.8527; val_best_f1_score: 0.8510; train_kl_reg_loss: 6228.7822; train_edge_recon_loss: 287542.5469; train_cond_contrastive_loss: 78664.6016; train_gene_expr_recon_loss: 97600.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470036.5781; train_optim_loss: 470036.5781; val_kl_reg_loss: 6055.5342; val_edge_recon_loss: 289923.2500; val_cond_contrastive_loss: 78481.9062; val_gene_expr_recon_loss: 97697.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472158.6562; val_optim_loss: 472158.6562
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9261; val_auprc_score: 0.8964; val_best_acc_score: 0.8564; val_best_f1_score: 0.8540; train_kl_reg_loss: 6220.4775; train_edge_recon_loss: 285866.3438; train_cond_contrastive_loss: 78666.1094; train_gene_expr_recon_loss: 97413.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468166.3906; train_optim_loss: 468166.3906; val_kl_reg_loss: 6053.0420; val_edge_recon_loss: 287527.4375; val_cond_contrastive_loss: 78483.5547; val_gene_expr_recon_loss: 97678.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469742.7812; val_optim_loss: 469742.7812
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9328; val_auprc_score: 0.9037; val_best_acc_score: 0.8582; val_best_f1_score: 0.8496; train_kl_reg_loss: 6223.7756; train_edge_recon_loss: 284978.3750; train_cond_contrastive_loss: 78663.4805; train_gene_expr_recon_loss: 97478.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467344.2031; train_optim_loss: 467344.2031; val_kl_reg_loss: 6079.9277; val_edge_recon_loss: 292555.4062; val_cond_contrastive_loss: 78479.2812; val_gene_expr_recon_loss: 97658.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474773.5938; val_optim_loss: 474773.5938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 56 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9180
Val AUPRC score: 0.8937
Val best accuracy score: 0.8385
Val best F1 score: 0.8354
Val gene expr MSE score: 1.7180
Duration of model training in run 2: 0 hours, 0 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7482; val_auprc_score: 0.7914; val_best_acc_score: 0.6800; val_best_f1_score: 0.6929; train_kl_reg_loss: 2056.6945; train_edge_recon_loss: 354473.0938; train_cond_contrastive_loss: 119949.4551; train_gene_expr_recon_loss: 128283.1152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 604762.3594; train_optim_loss: 604762.3594; val_kl_reg_loss: 5676.2031; val_edge_recon_loss: 405951.1562; val_cond_contrastive_loss: 78352.9844; val_gene_expr_recon_loss: 108634.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 598614.4375; val_optim_loss: 598614.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7113; val_auprc_score: 0.7485; val_best_acc_score: 0.6497; val_best_f1_score: 0.6849; train_kl_reg_loss: 9937.1462; train_edge_recon_loss: 358887.6484; train_cond_contrastive_loss: 88666.9414; train_gene_expr_recon_loss: 106882.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564374.1250; train_optim_loss: 564374.1250; val_kl_reg_loss: 7722.6382; val_edge_recon_loss: 402680.1875; val_cond_contrastive_loss: 78365.8359; val_gene_expr_recon_loss: 103405.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592173.8125; val_optim_loss: 592173.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6876; val_auprc_score: 0.7193; val_best_acc_score: 0.6272; val_best_f1_score: 0.6841; train_kl_reg_loss: 6936.8563; train_edge_recon_loss: 357106.0000; train_cond_contrastive_loss: 87968.7715; train_gene_expr_recon_loss: 103083.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 555095.0781; train_optim_loss: 555095.0781; val_kl_reg_loss: 5644.8125; val_edge_recon_loss: 389269.4375; val_cond_contrastive_loss: 78422.5625; val_gene_expr_recon_loss: 102237.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575574.2500; val_optim_loss: 575574.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6782; val_auprc_score: 0.7094; val_best_acc_score: 0.6192; val_best_f1_score: 0.6816; train_kl_reg_loss: 5162.7249; train_edge_recon_loss: 350143.8828; train_cond_contrastive_loss: 87676.1934; train_gene_expr_recon_loss: 100801.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543783.8438; train_optim_loss: 543783.8438; val_kl_reg_loss: 3999.2300; val_edge_recon_loss: 362252.7812; val_cond_contrastive_loss: 78550.3594; val_gene_expr_recon_loss: 101607.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546409.8750; val_optim_loss: 546409.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6840; val_auprc_score: 0.7165; val_best_acc_score: 0.6246; val_best_f1_score: 0.6859; train_kl_reg_loss: 3803.3962; train_edge_recon_loss: 338617.6484; train_cond_contrastive_loss: 88496.7871; train_gene_expr_recon_loss: 100804.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531722.6094; train_optim_loss: 531722.6094; val_kl_reg_loss: 3489.0325; val_edge_recon_loss: 343289.9062; val_cond_contrastive_loss: 78455.0234; val_gene_expr_recon_loss: 101082.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526316.5625; val_optim_loss: 526316.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6841; val_auprc_score: 0.7224; val_best_acc_score: 0.6322; val_best_f1_score: 0.6836; train_kl_reg_loss: 3673.5625; train_edge_recon_loss: 328892.1250; train_cond_contrastive_loss: 83433.2266; train_gene_expr_recon_loss: 100411.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 516410.6250; train_optim_loss: 516410.6250; val_kl_reg_loss: 3953.5386; val_edge_recon_loss: 342126.5000; val_cond_contrastive_loss: 78399.1484; val_gene_expr_recon_loss: 100702.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 525182.0625; val_optim_loss: 525182.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7069; val_auprc_score: 0.7283; val_best_acc_score: 0.6474; val_best_f1_score: 0.6891; train_kl_reg_loss: 4076.6074; train_edge_recon_loss: 326142.3984; train_cond_contrastive_loss: 79912.2812; train_gene_expr_recon_loss: 100107.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510238.8828; train_optim_loss: 510238.8828; val_kl_reg_loss: 4119.8721; val_edge_recon_loss: 336757.6875; val_cond_contrastive_loss: 78401.8203; val_gene_expr_recon_loss: 100287.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519567.2500; val_optim_loss: 519567.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7553; val_auprc_score: 0.7625; val_best_acc_score: 0.6781; val_best_f1_score: 0.7160; train_kl_reg_loss: 4118.4376; train_edge_recon_loss: 316126.6641; train_cond_contrastive_loss: 79601.5781; train_gene_expr_recon_loss: 100191.5996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500038.2812; train_optim_loss: 500038.2812; val_kl_reg_loss: 4108.9448; val_edge_recon_loss: 314920.0625; val_cond_contrastive_loss: 78420.7812; val_gene_expr_recon_loss: 99871.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497321.4375; val_optim_loss: 497321.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8141; val_auprc_score: 0.8054; val_best_acc_score: 0.7271; val_best_f1_score: 0.7592; train_kl_reg_loss: 4325.7230; train_edge_recon_loss: 302390.3203; train_cond_contrastive_loss: 79402.4629; train_gene_expr_recon_loss: 98849.1113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484967.6172; train_optim_loss: 484967.6172; val_kl_reg_loss: 4878.4517; val_edge_recon_loss: 298233.3750; val_cond_contrastive_loss: 78456.2266; val_gene_expr_recon_loss: 99427.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480995.4688; val_optim_loss: 480995.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8315; val_auprc_score: 0.8093; val_best_acc_score: 0.7500; val_best_f1_score: 0.7831; train_kl_reg_loss: 5395.9393; train_edge_recon_loss: 290590.8750; train_cond_contrastive_loss: 78948.1758; train_gene_expr_recon_loss: 98623.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473558.1406; train_optim_loss: 473558.1406; val_kl_reg_loss: 6186.1680; val_edge_recon_loss: 292415.3438; val_cond_contrastive_loss: 78440.6172; val_gene_expr_recon_loss: 99001.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476043.9375; val_optim_loss: 476043.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8504; val_auprc_score: 0.8238; val_best_acc_score: 0.7709; val_best_f1_score: 0.7958; train_kl_reg_loss: 6610.8223; train_edge_recon_loss: 284801.1250; train_cond_contrastive_loss: 78759.1758; train_gene_expr_recon_loss: 98577.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468748.4453; train_optim_loss: 468748.4453; val_kl_reg_loss: 6992.8569; val_edge_recon_loss: 285267.3438; val_cond_contrastive_loss: 78421.9375; val_gene_expr_recon_loss: 98623.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469305.1562; val_optim_loss: 469305.1562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8574; val_auprc_score: 0.8221; val_best_acc_score: 0.7835; val_best_f1_score: 0.8064; train_kl_reg_loss: 7202.7133; train_edge_recon_loss: 282255.8047; train_cond_contrastive_loss: 78741.4531; train_gene_expr_recon_loss: 98034.4746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466234.4453; train_optim_loss: 466234.4453; val_kl_reg_loss: 7127.5786; val_edge_recon_loss: 284457.1250; val_cond_contrastive_loss: 78414.1953; val_gene_expr_recon_loss: 98212.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468211.0000; val_optim_loss: 468211.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8690; val_auprc_score: 0.8335; val_best_acc_score: 0.7971; val_best_f1_score: 0.8187; train_kl_reg_loss: 7106.4315; train_edge_recon_loss: 279007.6719; train_cond_contrastive_loss: 78803.3711; train_gene_expr_recon_loss: 97414.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462332.1016; train_optim_loss: 462332.1016; val_kl_reg_loss: 6769.5361; val_edge_recon_loss: 280966.9688; val_cond_contrastive_loss: 78411.3047; val_gene_expr_recon_loss: 97893.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464041.6562; val_optim_loss: 464041.6562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8797; val_auprc_score: 0.8459; val_best_acc_score: 0.8126; val_best_f1_score: 0.8310; train_kl_reg_loss: 6752.2832; train_edge_recon_loss: 276335.0938; train_cond_contrastive_loss: 78941.6680; train_gene_expr_recon_loss: 96902.0723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458931.1250; train_optim_loss: 458931.1250; val_kl_reg_loss: 6537.0679; val_edge_recon_loss: 281169.8438; val_cond_contrastive_loss: 78419.6562; val_gene_expr_recon_loss: 97565.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463692.4375; val_optim_loss: 463692.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8958; val_auprc_score: 0.8645; val_best_acc_score: 0.8291; val_best_f1_score: 0.8457; train_kl_reg_loss: 6648.0927; train_edge_recon_loss: 276196.2500; train_cond_contrastive_loss: 78961.9629; train_gene_expr_recon_loss: 96926.2246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458732.5469; train_optim_loss: 458732.5469; val_kl_reg_loss: 6529.6436; val_edge_recon_loss: 275535.1562; val_cond_contrastive_loss: 78425.7500; val_gene_expr_recon_loss: 97245.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457736.3750; val_optim_loss: 457736.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9095; val_auprc_score: 0.8894; val_best_acc_score: 0.8382; val_best_f1_score: 0.8511; train_kl_reg_loss: 6699.7753; train_edge_recon_loss: 274035.6250; train_cond_contrastive_loss: 78903.2305; train_gene_expr_recon_loss: 96320.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455958.9531; train_optim_loss: 455958.9531; val_kl_reg_loss: 6552.7817; val_edge_recon_loss: 274638.7812; val_cond_contrastive_loss: 78437.9219; val_gene_expr_recon_loss: 96983.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456613.3125; val_optim_loss: 456613.3125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9195; val_auprc_score: 0.9004; val_best_acc_score: 0.8468; val_best_f1_score: 0.8529; train_kl_reg_loss: 6609.2640; train_edge_recon_loss: 271443.0859; train_cond_contrastive_loss: 78829.9707; train_gene_expr_recon_loss: 96513.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453395.7500; train_optim_loss: 453395.7500; val_kl_reg_loss: 6358.8574; val_edge_recon_loss: 275451.5312; val_cond_contrastive_loss: 78440.8359; val_gene_expr_recon_loss: 96799.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457050.4062; val_optim_loss: 457050.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9295; val_auprc_score: 0.9137; val_best_acc_score: 0.8586; val_best_f1_score: 0.8641; train_kl_reg_loss: 6400.3043; train_edge_recon_loss: 272402.8828; train_cond_contrastive_loss: 78798.3398; train_gene_expr_recon_loss: 96325.2148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453926.7422; train_optim_loss: 453926.7422; val_kl_reg_loss: 6143.6191; val_edge_recon_loss: 275199.6562; val_cond_contrastive_loss: 78439.7344; val_gene_expr_recon_loss: 96572.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456355.7500; val_optim_loss: 456355.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9328; val_auprc_score: 0.9198; val_best_acc_score: 0.8570; val_best_f1_score: 0.8630; train_kl_reg_loss: 6270.3761; train_edge_recon_loss: 271148.6484; train_cond_contrastive_loss: 78744.8105; train_gene_expr_recon_loss: 96142.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452306.4609; train_optim_loss: 452306.4609; val_kl_reg_loss: 6148.8281; val_edge_recon_loss: 271944.9688; val_cond_contrastive_loss: 78437.6797; val_gene_expr_recon_loss: 96343.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452874.5938; val_optim_loss: 452874.5938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9437; val_auprc_score: 0.9300; val_best_acc_score: 0.8742; val_best_f1_score: 0.8785; train_kl_reg_loss: 6312.3005; train_edge_recon_loss: 270004.6094; train_cond_contrastive_loss: 78702.8965; train_gene_expr_recon_loss: 95684.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450703.9688; train_optim_loss: 450703.9688; val_kl_reg_loss: 6209.3730; val_edge_recon_loss: 271059.3750; val_cond_contrastive_loss: 78432.1094; val_gene_expr_recon_loss: 96196.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451897.3125; val_optim_loss: 451897.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9400; val_auprc_score: 0.9236; val_best_acc_score: 0.8677; val_best_f1_score: 0.8736; train_kl_reg_loss: 6449.4932; train_edge_recon_loss: 269403.3594; train_cond_contrastive_loss: 78649.7441; train_gene_expr_recon_loss: 96007.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450510.3438; train_optim_loss: 450510.3438; val_kl_reg_loss: 6344.1465; val_edge_recon_loss: 272379.7812; val_cond_contrastive_loss: 78427.3672; val_gene_expr_recon_loss: 96010.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453161.8125; val_optim_loss: 453161.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9514; val_auprc_score: 0.9418; val_best_acc_score: 0.8860; val_best_f1_score: 0.8873; train_kl_reg_loss: 6394.8073; train_edge_recon_loss: 268732.7344; train_cond_contrastive_loss: 78661.0723; train_gene_expr_recon_loss: 95598.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449386.7734; train_optim_loss: 449386.7734; val_kl_reg_loss: 6148.6514; val_edge_recon_loss: 269586.4688; val_cond_contrastive_loss: 78429.8906; val_gene_expr_recon_loss: 95816.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449981.3125; val_optim_loss: 449981.3125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9547; val_auprc_score: 0.9469; val_best_acc_score: 0.8870; val_best_f1_score: 0.8891; train_kl_reg_loss: 6237.0785; train_edge_recon_loss: 269645.4531; train_cond_contrastive_loss: 78695.4668; train_gene_expr_recon_loss: 95380.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449958.4766; train_optim_loss: 449958.4766; val_kl_reg_loss: 5969.0186; val_edge_recon_loss: 273672.0938; val_cond_contrastive_loss: 78431.3359; val_gene_expr_recon_loss: 95611.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453683.6562; val_optim_loss: 453683.6562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9611; val_auprc_score: 0.9508; val_best_acc_score: 0.9036; val_best_f1_score: 0.9071; train_kl_reg_loss: 6037.0459; train_edge_recon_loss: 267363.1875; train_cond_contrastive_loss: 78746.9570; train_gene_expr_recon_loss: 94988.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447136.1875; train_optim_loss: 447136.1875; val_kl_reg_loss: 5897.7466; val_edge_recon_loss: 267856.6250; val_cond_contrastive_loss: 78435.1641; val_gene_expr_recon_loss: 95421.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447611.0000; val_optim_loss: 447611.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9655; val_auprc_score: 0.9619; val_best_acc_score: 0.9055; val_best_f1_score: 0.9091; train_kl_reg_loss: 6025.0092; train_edge_recon_loss: 266133.0156; train_cond_contrastive_loss: 78750.8105; train_gene_expr_recon_loss: 94868.8301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445777.6719; train_optim_loss: 445777.6719; val_kl_reg_loss: 5888.8057; val_edge_recon_loss: 270103.8438; val_cond_contrastive_loss: 78440.1953; val_gene_expr_recon_loss: 95247.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449680.0000; val_optim_loss: 449680.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9696; val_auprc_score: 0.9653; val_best_acc_score: 0.9167; val_best_f1_score: 0.9196; train_kl_reg_loss: 5920.8890; train_edge_recon_loss: 264961.1875; train_cond_contrastive_loss: 78757.8125; train_gene_expr_recon_loss: 94315.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443955.7969; train_optim_loss: 443955.7969; val_kl_reg_loss: 5739.6973; val_edge_recon_loss: 264401.0938; val_cond_contrastive_loss: 78443.3984; val_gene_expr_recon_loss: 95081.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443665.8125; val_optim_loss: 443665.8125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9716; val_auprc_score: 0.9649; val_best_acc_score: 0.9173; val_best_f1_score: 0.9185; train_kl_reg_loss: 5881.3782; train_edge_recon_loss: 266294.2656; train_cond_contrastive_loss: 78753.9824; train_gene_expr_recon_loss: 94787.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445716.9375; train_optim_loss: 445716.9375; val_kl_reg_loss: 5686.9409; val_edge_recon_loss: 270877.3750; val_cond_contrastive_loss: 78443.8984; val_gene_expr_recon_loss: 94953.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449961.3125; val_optim_loss: 449961.3125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9746; val_auprc_score: 0.9694; val_best_acc_score: 0.9282; val_best_f1_score: 0.9305; train_kl_reg_loss: 5878.4530; train_edge_recon_loss: 263414.4453; train_cond_contrastive_loss: 78754.0801; train_gene_expr_recon_loss: 94722.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442769.8984; train_optim_loss: 442769.8984; val_kl_reg_loss: 5728.1914; val_edge_recon_loss: 263766.1875; val_cond_contrastive_loss: 78447.1250; val_gene_expr_recon_loss: 94817.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442758.8125; val_optim_loss: 442758.8125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9727; val_auprc_score: 0.9622; val_best_acc_score: 0.9261; val_best_f1_score: 0.9285; train_kl_reg_loss: 5835.9147; train_edge_recon_loss: 262346.6680; train_cond_contrastive_loss: 78768.5879; train_gene_expr_recon_loss: 93952.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440903.3047; train_optim_loss: 440903.3047; val_kl_reg_loss: 5723.1538; val_edge_recon_loss: 262767.0312; val_cond_contrastive_loss: 78450.6172; val_gene_expr_recon_loss: 94688.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441629.3438; val_optim_loss: 441629.3438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9783; val_auprc_score: 0.9733; val_best_acc_score: 0.9375; val_best_f1_score: 0.9385; train_kl_reg_loss: 5877.3136; train_edge_recon_loss: 261873.7930; train_cond_contrastive_loss: 78759.4414; train_gene_expr_recon_loss: 94013.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440523.7031; train_optim_loss: 440523.7031; val_kl_reg_loss: 5788.3398; val_edge_recon_loss: 264379.2500; val_cond_contrastive_loss: 78452.8047; val_gene_expr_recon_loss: 94509.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443130.3750; val_optim_loss: 443130.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9798; val_auprc_score: 0.9708; val_best_acc_score: 0.9395; val_best_f1_score: 0.9408; train_kl_reg_loss: 5883.9773; train_edge_recon_loss: 261913.9609; train_cond_contrastive_loss: 78757.0977; train_gene_expr_recon_loss: 94084.2871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440639.3125; train_optim_loss: 440639.3125; val_kl_reg_loss: 5725.3267; val_edge_recon_loss: 263261.3438; val_cond_contrastive_loss: 78451.8047; val_gene_expr_recon_loss: 94339.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441777.8750; val_optim_loss: 441777.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9817; val_auprc_score: 0.9769; val_best_acc_score: 0.9412; val_best_f1_score: 0.9416; train_kl_reg_loss: 5904.5479; train_edge_recon_loss: 261437.1875; train_cond_contrastive_loss: 78771.1719; train_gene_expr_recon_loss: 93707.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439820.6406; train_optim_loss: 439820.6406; val_kl_reg_loss: 5767.8682; val_edge_recon_loss: 261128.5781; val_cond_contrastive_loss: 78450.3984; val_gene_expr_recon_loss: 94164.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439511.3125; val_optim_loss: 439511.3125
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9806; val_auprc_score: 0.9747; val_best_acc_score: 0.9418; val_best_f1_score: 0.9429; train_kl_reg_loss: 5900.7444; train_edge_recon_loss: 262821.9609; train_cond_contrastive_loss: 78772.6367; train_gene_expr_recon_loss: 93237.5566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440732.9062; train_optim_loss: 440732.9062; val_kl_reg_loss: 5767.9478; val_edge_recon_loss: 265475.5000; val_cond_contrastive_loss: 78448.9531; val_gene_expr_recon_loss: 93985.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443677.6875; val_optim_loss: 443677.6875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9840; val_auprc_score: 0.9779; val_best_acc_score: 0.9462; val_best_f1_score: 0.9472; train_kl_reg_loss: 5895.8850; train_edge_recon_loss: 261895.8945; train_cond_contrastive_loss: 78782.4180; train_gene_expr_recon_loss: 93497.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440071.9219; train_optim_loss: 440071.9219; val_kl_reg_loss: 5767.1646; val_edge_recon_loss: 261496.9062; val_cond_contrastive_loss: 78448.9219; val_gene_expr_recon_loss: 93802.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439515.4062; val_optim_loss: 439515.4062
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9814; val_auprc_score: 0.9752; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 5885.5656; train_edge_recon_loss: 261311.9922; train_cond_contrastive_loss: 78788.0215; train_gene_expr_recon_loss: 93325.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439311.1016; train_optim_loss: 439311.1016; val_kl_reg_loss: 5737.0527; val_edge_recon_loss: 262628.5312; val_cond_contrastive_loss: 78448.9766; val_gene_expr_recon_loss: 93658.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440472.9375; val_optim_loss: 440472.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9834; val_auprc_score: 0.9780; val_best_acc_score: 0.9495; val_best_f1_score: 0.9500; train_kl_reg_loss: 5870.6871; train_edge_recon_loss: 261082.3984; train_cond_contrastive_loss: 78774.4160; train_gene_expr_recon_loss: 93486.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439214.4375; train_optim_loss: 439214.4375; val_kl_reg_loss: 5738.6348; val_edge_recon_loss: 263711.2188; val_cond_contrastive_loss: 78448.0391; val_gene_expr_recon_loss: 93631.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441529.3125; val_optim_loss: 441529.3125
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9819; val_auprc_score: 0.9767; val_best_acc_score: 0.9428; val_best_f1_score: 0.9440; train_kl_reg_loss: 5869.8177; train_edge_recon_loss: 262595.3516; train_cond_contrastive_loss: 78781.8984; train_gene_expr_recon_loss: 93586.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440833.2109; train_optim_loss: 440833.2109; val_kl_reg_loss: 5727.3628; val_edge_recon_loss: 263437.1562; val_cond_contrastive_loss: 78448.7734; val_gene_expr_recon_loss: 93605.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441218.3750; val_optim_loss: 441218.3750
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9791; val_auprc_score: 0.9720; val_best_acc_score: 0.9431; val_best_f1_score: 0.9436; train_kl_reg_loss: 5863.9629; train_edge_recon_loss: 261687.8750; train_cond_contrastive_loss: 78783.5195; train_gene_expr_recon_loss: 93133.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439468.5000; train_optim_loss: 439468.5000; val_kl_reg_loss: 5736.3491; val_edge_recon_loss: 266953.5312; val_cond_contrastive_loss: 78447.5391; val_gene_expr_recon_loss: 93578.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444715.7500; val_optim_loss: 444715.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 23 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9804
Val AUPRC score: 0.9739
Val best accuracy score: 0.9411
Val best F1 score: 0.9413
Val gene expr MSE score: 1.5494
Duration of model training in run 3: 0 hours, 1 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7423; val_auprc_score: 0.7952; val_best_acc_score: 0.6805; val_best_f1_score: 0.6914; train_kl_reg_loss: 1952.0044; train_edge_recon_loss: 358174.7031; train_cond_contrastive_loss: 118712.3672; train_gene_expr_recon_loss: 130724.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 609563.5469; train_optim_loss: 609563.5469; val_kl_reg_loss: 4810.2949; val_edge_recon_loss: 395859.5000; val_cond_contrastive_loss: 78348.3125; val_gene_expr_recon_loss: 109802.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 588821.0000; val_optim_loss: 588821.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7090; val_auprc_score: 0.7590; val_best_acc_score: 0.6566; val_best_f1_score: 0.6807; train_kl_reg_loss: 9185.3158; train_edge_recon_loss: 364156.4062; train_cond_contrastive_loss: 85808.8008; train_gene_expr_recon_loss: 106777.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 565928.0938; train_optim_loss: 565928.0938; val_kl_reg_loss: 8128.2998; val_edge_recon_loss: 396875.6562; val_cond_contrastive_loss: 78361.4766; val_gene_expr_recon_loss: 103679.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 587044.5000; val_optim_loss: 587044.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6808; val_auprc_score: 0.7228; val_best_acc_score: 0.6193; val_best_f1_score: 0.6839; train_kl_reg_loss: 6528.6931; train_edge_recon_loss: 359502.6172; train_cond_contrastive_loss: 85715.2324; train_gene_expr_recon_loss: 102575.8145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554322.3594; train_optim_loss: 554322.3594; val_kl_reg_loss: 4346.0444; val_edge_recon_loss: 383582.9375; val_cond_contrastive_loss: 78410.1094; val_gene_expr_recon_loss: 102034.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568373.5000; val_optim_loss: 568373.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6845; val_auprc_score: 0.7211; val_best_acc_score: 0.6228; val_best_f1_score: 0.6877; train_kl_reg_loss: 4118.8021; train_edge_recon_loss: 350977.1484; train_cond_contrastive_loss: 87556.1367; train_gene_expr_recon_loss: 100896.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543548.3281; train_optim_loss: 543548.3281; val_kl_reg_loss: 3359.7520; val_edge_recon_loss: 357271.5312; val_cond_contrastive_loss: 78502.0312; val_gene_expr_recon_loss: 101555.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540688.8750; val_optim_loss: 540688.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6883; val_auprc_score: 0.7179; val_best_acc_score: 0.6309; val_best_f1_score: 0.6885; train_kl_reg_loss: 3232.4073; train_edge_recon_loss: 338710.8125; train_cond_contrastive_loss: 89484.7266; train_gene_expr_recon_loss: 100457.3691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531885.3281; train_optim_loss: 531885.3281; val_kl_reg_loss: 3146.5454; val_edge_recon_loss: 340772.9062; val_cond_contrastive_loss: 78430.4219; val_gene_expr_recon_loss: 101131.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523481.1875; val_optim_loss: 523481.1875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6849; val_auprc_score: 0.7189; val_best_acc_score: 0.6302; val_best_f1_score: 0.6903; train_kl_reg_loss: 3428.7832; train_edge_recon_loss: 327031.1016; train_cond_contrastive_loss: 83390.3281; train_gene_expr_recon_loss: 100638.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 514488.3750; train_optim_loss: 514488.3750; val_kl_reg_loss: 3865.8577; val_edge_recon_loss: 337620.1875; val_cond_contrastive_loss: 78386.5000; val_gene_expr_recon_loss: 100582.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 520454.8750; val_optim_loss: 520454.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7201; val_auprc_score: 0.7463; val_best_acc_score: 0.6579; val_best_f1_score: 0.6967; train_kl_reg_loss: 4087.8881; train_edge_recon_loss: 323048.5000; train_cond_contrastive_loss: 79700.7832; train_gene_expr_recon_loss: 99552.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 506389.5781; train_optim_loss: 506389.5781; val_kl_reg_loss: 4334.0674; val_edge_recon_loss: 327353.0312; val_cond_contrastive_loss: 78385.7344; val_gene_expr_recon_loss: 100080.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 510153.5000; val_optim_loss: 510153.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7699; val_auprc_score: 0.7737; val_best_acc_score: 0.6876; val_best_f1_score: 0.7275; train_kl_reg_loss: 4494.1329; train_edge_recon_loss: 314553.2656; train_cond_contrastive_loss: 79338.6738; train_gene_expr_recon_loss: 99060.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497446.5938; train_optim_loss: 497446.5938; val_kl_reg_loss: 4734.1367; val_edge_recon_loss: 309200.1875; val_cond_contrastive_loss: 78407.8203; val_gene_expr_recon_loss: 99602.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491945.0000; val_optim_loss: 491945.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8103; val_auprc_score: 0.8000; val_best_acc_score: 0.7278; val_best_f1_score: 0.7678; train_kl_reg_loss: 5022.7710; train_edge_recon_loss: 299710.3984; train_cond_contrastive_loss: 79026.2637; train_gene_expr_recon_loss: 98510.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482269.8672; train_optim_loss: 482269.8672; val_kl_reg_loss: 5436.9805; val_edge_recon_loss: 293195.1562; val_cond_contrastive_loss: 78428.5000; val_gene_expr_recon_loss: 99108.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476169.1875; val_optim_loss: 476169.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8291; val_auprc_score: 0.8053; val_best_acc_score: 0.7505; val_best_f1_score: 0.7848; train_kl_reg_loss: 5777.8127; train_edge_recon_loss: 288836.0156; train_cond_contrastive_loss: 78809.8809; train_gene_expr_recon_loss: 97803.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471226.7500; train_optim_loss: 471226.7500; val_kl_reg_loss: 6236.4741; val_edge_recon_loss: 288577.1562; val_cond_contrastive_loss: 78413.5547; val_gene_expr_recon_loss: 98603.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471830.6875; val_optim_loss: 471830.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8370; val_auprc_score: 0.8186; val_best_acc_score: 0.7584; val_best_f1_score: 0.7963; train_kl_reg_loss: 6511.7368; train_edge_recon_loss: 284350.5547; train_cond_contrastive_loss: 78729.9102; train_gene_expr_recon_loss: 97350.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466942.8359; train_optim_loss: 466942.8359; val_kl_reg_loss: 6721.0244; val_edge_recon_loss: 282687.3438; val_cond_contrastive_loss: 78400.4531; val_gene_expr_recon_loss: 98209.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466018.2188; val_optim_loss: 466018.2188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8533; val_auprc_score: 0.8228; val_best_acc_score: 0.7798; val_best_f1_score: 0.8040; train_kl_reg_loss: 6788.6599; train_edge_recon_loss: 280903.9609; train_cond_contrastive_loss: 78732.5527; train_gene_expr_recon_loss: 96698.6934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463123.8672; train_optim_loss: 463123.8672; val_kl_reg_loss: 6618.4097; val_edge_recon_loss: 285504.2500; val_cond_contrastive_loss: 78393.4375; val_gene_expr_recon_loss: 97914.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468430.6250; val_optim_loss: 468430.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8686; val_auprc_score: 0.8384; val_best_acc_score: 0.8015; val_best_f1_score: 0.8262; train_kl_reg_loss: 6668.9343; train_edge_recon_loss: 279728.3984; train_cond_contrastive_loss: 78875.7090; train_gene_expr_recon_loss: 96989.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462262.9844; train_optim_loss: 462262.9844; val_kl_reg_loss: 6555.3203; val_edge_recon_loss: 274081.7500; val_cond_contrastive_loss: 78396.1562; val_gene_expr_recon_loss: 97639.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456672.2500; val_optim_loss: 456672.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8815; val_auprc_score: 0.8487; val_best_acc_score: 0.8190; val_best_f1_score: 0.8379; train_kl_reg_loss: 6642.0662; train_edge_recon_loss: 279294.7656; train_cond_contrastive_loss: 78885.5117; train_gene_expr_recon_loss: 97150.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461973.2266; train_optim_loss: 461973.2266; val_kl_reg_loss: 6570.7266; val_edge_recon_loss: 273342.5312; val_cond_contrastive_loss: 78403.3750; val_gene_expr_recon_loss: 97314.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455631.3125; val_optim_loss: 455631.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8906; val_auprc_score: 0.8618; val_best_acc_score: 0.8313; val_best_f1_score: 0.8501; train_kl_reg_loss: 6621.3647; train_edge_recon_loss: 276289.5156; train_cond_contrastive_loss: 78897.9473; train_gene_expr_recon_loss: 96442.0664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458250.8906; train_optim_loss: 458250.8906; val_kl_reg_loss: 6464.4824; val_edge_recon_loss: 268405.4688; val_cond_contrastive_loss: 78410.6641; val_gene_expr_recon_loss: 96935.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450216.4062; val_optim_loss: 450216.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9093; val_auprc_score: 0.8876; val_best_acc_score: 0.8396; val_best_f1_score: 0.8505; train_kl_reg_loss: 6543.6293; train_edge_recon_loss: 273645.3516; train_cond_contrastive_loss: 78873.3301; train_gene_expr_recon_loss: 96189.1895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455251.4922; train_optim_loss: 455251.4922; val_kl_reg_loss: 6383.1372; val_edge_recon_loss: 274029.3438; val_cond_contrastive_loss: 78418.2422; val_gene_expr_recon_loss: 96642.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455473.1562; val_optim_loss: 455473.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9178; val_auprc_score: 0.8985; val_best_acc_score: 0.8454; val_best_f1_score: 0.8579; train_kl_reg_loss: 6418.3966; train_edge_recon_loss: 273837.1484; train_cond_contrastive_loss: 78808.8359; train_gene_expr_recon_loss: 95801.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454865.6719; train_optim_loss: 454865.6719; val_kl_reg_loss: 6208.5557; val_edge_recon_loss: 268979.8750; val_cond_contrastive_loss: 78428.4766; val_gene_expr_recon_loss: 96428.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450045.0000; val_optim_loss: 450045.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9273; val_auprc_score: 0.9109; val_best_acc_score: 0.8538; val_best_f1_score: 0.8620; train_kl_reg_loss: 6231.5037; train_edge_recon_loss: 273455.5234; train_cond_contrastive_loss: 78802.7559; train_gene_expr_recon_loss: 95034.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453524.5703; train_optim_loss: 453524.5703; val_kl_reg_loss: 6081.8774; val_edge_recon_loss: 270897.5938; val_cond_contrastive_loss: 78433.3672; val_gene_expr_recon_loss: 96214.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451627.7812; val_optim_loss: 451627.7812
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9361; val_auprc_score: 0.9256; val_best_acc_score: 0.8662; val_best_f1_score: 0.8728; train_kl_reg_loss: 6217.7007; train_edge_recon_loss: 271459.5859; train_cond_contrastive_loss: 78731.3652; train_gene_expr_recon_loss: 95365.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451774.1484; train_optim_loss: 451774.1484; val_kl_reg_loss: 6230.7393; val_edge_recon_loss: 269485.1875; val_cond_contrastive_loss: 78434.1953; val_gene_expr_recon_loss: 95993.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450144.0000; val_optim_loss: 450144.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9449; val_auprc_score: 0.9334; val_best_acc_score: 0.8777; val_best_f1_score: 0.8824; train_kl_reg_loss: 6368.3795; train_edge_recon_loss: 270575.3359; train_cond_contrastive_loss: 78663.2168; train_gene_expr_recon_loss: 95018.6035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450625.5391; train_optim_loss: 450625.5391; val_kl_reg_loss: 6338.3057; val_edge_recon_loss: 268713.7812; val_cond_contrastive_loss: 78432.2109; val_gene_expr_recon_loss: 95780.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449264.5000; val_optim_loss: 449264.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9503; val_auprc_score: 0.9423; val_best_acc_score: 0.8909; val_best_f1_score: 0.8948; train_kl_reg_loss: 6392.8008; train_edge_recon_loss: 270767.1719; train_cond_contrastive_loss: 78650.3711; train_gene_expr_recon_loss: 94439.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450249.4453; train_optim_loss: 450249.4453; val_kl_reg_loss: 6274.6963; val_edge_recon_loss: 267299.0000; val_cond_contrastive_loss: 78430.0156; val_gene_expr_recon_loss: 95586.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447590.5000; val_optim_loss: 447590.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9497; val_auprc_score: 0.9412; val_best_acc_score: 0.8895; val_best_f1_score: 0.8940; train_kl_reg_loss: 6322.5979; train_edge_recon_loss: 268145.4766; train_cond_contrastive_loss: 78661.5137; train_gene_expr_recon_loss: 94796.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447926.0469; train_optim_loss: 447926.0469; val_kl_reg_loss: 6133.5430; val_edge_recon_loss: 270211.2188; val_cond_contrastive_loss: 78430.6562; val_gene_expr_recon_loss: 95399.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450174.9375; val_optim_loss: 450174.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9556; val_auprc_score: 0.9471; val_best_acc_score: 0.9001; val_best_f1_score: 0.9046; train_kl_reg_loss: 6185.7223; train_edge_recon_loss: 268963.0547; train_cond_contrastive_loss: 78698.3633; train_gene_expr_recon_loss: 94822.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448669.9297; train_optim_loss: 448669.9297; val_kl_reg_loss: 6135.1631; val_edge_recon_loss: 266195.3125; val_cond_contrastive_loss: 78435.0391; val_gene_expr_recon_loss: 95221.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445986.5938; val_optim_loss: 445986.5938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9642; val_auprc_score: 0.9566; val_best_acc_score: 0.9131; val_best_f1_score: 0.9159; train_kl_reg_loss: 6206.1476; train_edge_recon_loss: 267162.9531; train_cond_contrastive_loss: 78690.6250; train_gene_expr_recon_loss: 94547.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446606.9609; train_optim_loss: 446606.9609; val_kl_reg_loss: 6016.0405; val_edge_recon_loss: 265354.9062; val_cond_contrastive_loss: 78438.4141; val_gene_expr_recon_loss: 95045.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444854.4688; val_optim_loss: 444854.4688
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9702; val_auprc_score: 0.9651; val_best_acc_score: 0.9189; val_best_f1_score: 0.9213; train_kl_reg_loss: 6038.6760; train_edge_recon_loss: 266215.6797; train_cond_contrastive_loss: 78726.4883; train_gene_expr_recon_loss: 94478.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445459.5938; train_optim_loss: 445459.5938; val_kl_reg_loss: 5883.8140; val_edge_recon_loss: 262554.2188; val_cond_contrastive_loss: 78444.8125; val_gene_expr_recon_loss: 94882.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441765.6250; val_optim_loss: 441765.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9718; val_auprc_score: 0.9644; val_best_acc_score: 0.9223; val_best_f1_score: 0.9250; train_kl_reg_loss: 5960.4329; train_edge_recon_loss: 266164.0312; train_cond_contrastive_loss: 78748.4883; train_gene_expr_recon_loss: 93893.7148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444766.6719; train_optim_loss: 444766.6719; val_kl_reg_loss: 5875.5264; val_edge_recon_loss: 262689.5625; val_cond_contrastive_loss: 78447.1953; val_gene_expr_recon_loss: 94730.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441742.5938; val_optim_loss: 441742.5938
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9740; val_auprc_score: 0.9666; val_best_acc_score: 0.9280; val_best_f1_score: 0.9299; train_kl_reg_loss: 5967.0626; train_edge_recon_loss: 264484.9062; train_cond_contrastive_loss: 78736.4785; train_gene_expr_recon_loss: 94307.6035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443496.0625; train_optim_loss: 443496.0625; val_kl_reg_loss: 5845.1807; val_edge_recon_loss: 262727.5000; val_cond_contrastive_loss: 78446.8516; val_gene_expr_recon_loss: 94606.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441626.0625; val_optim_loss: 441626.0625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9794; val_auprc_score: 0.9723; val_best_acc_score: 0.9358; val_best_f1_score: 0.9380; train_kl_reg_loss: 5956.0895; train_edge_recon_loss: 263882.6875; train_cond_contrastive_loss: 78750.0078; train_gene_expr_recon_loss: 93524.9980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442113.7969; train_optim_loss: 442113.7969; val_kl_reg_loss: 5830.9482; val_edge_recon_loss: 258161.6094; val_cond_contrastive_loss: 78441.5859; val_gene_expr_recon_loss: 94447.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436881.5000; val_optim_loss: 436881.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9799; val_auprc_score: 0.9764; val_best_acc_score: 0.9360; val_best_f1_score: 0.9385; train_kl_reg_loss: 5916.4916; train_edge_recon_loss: 263764.0820; train_cond_contrastive_loss: 78722.9766; train_gene_expr_recon_loss: 93919.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442323.0938; train_optim_loss: 442323.0938; val_kl_reg_loss: 5787.3867; val_edge_recon_loss: 256768.9688; val_cond_contrastive_loss: 78435.0156; val_gene_expr_recon_loss: 94276.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435268.3438; val_optim_loss: 435268.3438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9791; val_auprc_score: 0.9736; val_best_acc_score: 0.9386; val_best_f1_score: 0.9405; train_kl_reg_loss: 5884.1799; train_edge_recon_loss: 262826.3711; train_cond_contrastive_loss: 78708.1113; train_gene_expr_recon_loss: 92997.8301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440416.4922; train_optim_loss: 440416.4922; val_kl_reg_loss: 5761.9292; val_edge_recon_loss: 261461.2344; val_cond_contrastive_loss: 78432.0859; val_gene_expr_recon_loss: 94115.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439771.0625; val_optim_loss: 439771.0625
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9830; val_auprc_score: 0.9767; val_best_acc_score: 0.9440; val_best_f1_score: 0.9461; train_kl_reg_loss: 5847.1428; train_edge_recon_loss: 263679.1328; train_cond_contrastive_loss: 78692.1816; train_gene_expr_recon_loss: 92918.9863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441137.4375; train_optim_loss: 441137.4375; val_kl_reg_loss: 5779.6318; val_edge_recon_loss: 260162.1094; val_cond_contrastive_loss: 78433.0781; val_gene_expr_recon_loss: 93940.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438315.7188; val_optim_loss: 438315.7188
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9831; val_auprc_score: 0.9781; val_best_acc_score: 0.9456; val_best_f1_score: 0.9468; train_kl_reg_loss: 5884.9995; train_edge_recon_loss: 262822.6797; train_cond_contrastive_loss: 78674.8262; train_gene_expr_recon_loss: 93186.8574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440569.3672; train_optim_loss: 440569.3672; val_kl_reg_loss: 5774.5908; val_edge_recon_loss: 259698.3594; val_cond_contrastive_loss: 78437.0391; val_gene_expr_recon_loss: 93769.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437679.7500; val_optim_loss: 437679.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9812; val_auprc_score: 0.9714; val_best_acc_score: 0.9419; val_best_f1_score: 0.9436; train_kl_reg_loss: 5864.0829; train_edge_recon_loss: 261398.0664; train_cond_contrastive_loss: 78676.2227; train_gene_expr_recon_loss: 93313.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439252.2266; train_optim_loss: 439252.2266; val_kl_reg_loss: 5774.4697; val_edge_recon_loss: 262070.7188; val_cond_contrastive_loss: 78436.7109; val_gene_expr_recon_loss: 93741.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440023.0000; val_optim_loss: 440023.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9839; val_auprc_score: 0.9798; val_best_acc_score: 0.9468; val_best_f1_score: 0.9483; train_kl_reg_loss: 5858.5874; train_edge_recon_loss: 262104.5820; train_cond_contrastive_loss: 78672.6523; train_gene_expr_recon_loss: 92762.8730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439398.6953; train_optim_loss: 439398.6953; val_kl_reg_loss: 5765.2271; val_edge_recon_loss: 260209.5000; val_cond_contrastive_loss: 78437.0078; val_gene_expr_recon_loss: 93713.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438125.4375; val_optim_loss: 438125.4375
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9820; val_auprc_score: 0.9735; val_best_acc_score: 0.9474; val_best_f1_score: 0.9491; train_kl_reg_loss: 5844.8647; train_edge_recon_loss: 262814.3477; train_cond_contrastive_loss: 78674.3105; train_gene_expr_recon_loss: 93277.5762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440611.1094; train_optim_loss: 440611.1094; val_kl_reg_loss: 5759.5234; val_edge_recon_loss: 259328.1562; val_cond_contrastive_loss: 78438.2344; val_gene_expr_recon_loss: 93689.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437215.3750; val_optim_loss: 437215.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 15 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9772
Val AUPRC score: 0.9710
Val best accuracy score: 0.9349
Val best F1 score: 0.9367
Val gene expr MSE score: 1.5842
Duration of model training in run 4: 0 hours, 1 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7540; val_auprc_score: 0.7941; val_best_acc_score: 0.6822; val_best_f1_score: 0.7056; train_kl_reg_loss: 4923.6250; train_edge_recon_loss: 356469.5990; train_cond_contrastive_loss: 107945.7500; train_gene_expr_recon_loss: 124276.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 593615.0521; train_optim_loss: 593615.0521; val_kl_reg_loss: 11932.7871; val_edge_recon_loss: 400691.4688; val_cond_contrastive_loss: 78341.6250; val_gene_expr_recon_loss: 104534.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595499.8750; val_optim_loss: 595499.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7140; val_auprc_score: 0.7450; val_best_acc_score: 0.6330; val_best_f1_score: 0.7000; train_kl_reg_loss: 7635.9236; train_edge_recon_loss: 355985.0104; train_cond_contrastive_loss: 85583.1641; train_gene_expr_recon_loss: 102659.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551863.2396; train_optim_loss: 551863.2396; val_kl_reg_loss: 5701.9351; val_edge_recon_loss: 388382.2188; val_cond_contrastive_loss: 78369.0391; val_gene_expr_recon_loss: 100936.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 573389.4375; val_optim_loss: 573389.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7052; val_auprc_score: 0.7330; val_best_acc_score: 0.6336; val_best_f1_score: 0.6959; train_kl_reg_loss: 5136.9189; train_edge_recon_loss: 347811.3177; train_cond_contrastive_loss: 87148.8112; train_gene_expr_recon_loss: 100153.2279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540250.2812; train_optim_loss: 540250.2812; val_kl_reg_loss: 3619.5142; val_edge_recon_loss: 351137.2500; val_cond_contrastive_loss: 78417.9688; val_gene_expr_recon_loss: 99885.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 533060.1250; val_optim_loss: 533060.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7097; val_auprc_score: 0.7375; val_best_acc_score: 0.6497; val_best_f1_score: 0.6953; train_kl_reg_loss: 3610.6562; train_edge_recon_loss: 329434.7292; train_cond_contrastive_loss: 86348.3229; train_gene_expr_recon_loss: 99321.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518715.1458; train_optim_loss: 518715.1458; val_kl_reg_loss: 4018.4448; val_edge_recon_loss: 331961.1562; val_cond_contrastive_loss: 78360.0859; val_gene_expr_recon_loss: 99428.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 513767.8438; val_optim_loss: 513767.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7374; val_auprc_score: 0.7597; val_best_acc_score: 0.6649; val_best_f1_score: 0.7034; train_kl_reg_loss: 4319.9861; train_edge_recon_loss: 322303.5625; train_cond_contrastive_loss: 79618.7292; train_gene_expr_recon_loss: 98671.0716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504913.3438; train_optim_loss: 504913.3438; val_kl_reg_loss: 4507.5508; val_edge_recon_loss: 322342.0938; val_cond_contrastive_loss: 78352.7578; val_gene_expr_recon_loss: 98658.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 503860.8750; val_optim_loss: 503860.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7855; val_auprc_score: 0.7903; val_best_acc_score: 0.7040; val_best_f1_score: 0.7429; train_kl_reg_loss: 4486.6773; train_edge_recon_loss: 310262.6302; train_cond_contrastive_loss: 79097.4453; train_gene_expr_recon_loss: 97930.3685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491777.1198; train_optim_loss: 491777.1198; val_kl_reg_loss: 4628.5225; val_edge_recon_loss: 300014.7188; val_cond_contrastive_loss: 78373.2734; val_gene_expr_recon_loss: 98031.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481047.7500; val_optim_loss: 481047.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8324; val_auprc_score: 0.8201; val_best_acc_score: 0.7473; val_best_f1_score: 0.7837; train_kl_reg_loss: 5047.4055; train_edge_recon_loss: 292591.6927; train_cond_contrastive_loss: 78922.2318; train_gene_expr_recon_loss: 97058.4987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473619.8281; train_optim_loss: 473619.8281; val_kl_reg_loss: 5836.6846; val_edge_recon_loss: 286580.0000; val_cond_contrastive_loss: 78383.1719; val_gene_expr_recon_loss: 97233.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468032.9375; val_optim_loss: 468032.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8402; val_auprc_score: 0.8195; val_best_acc_score: 0.7597; val_best_f1_score: 0.7912; train_kl_reg_loss: 6365.0724; train_edge_recon_loss: 284718.5469; train_cond_contrastive_loss: 78764.3307; train_gene_expr_recon_loss: 96530.4049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466378.3542; train_optim_loss: 466378.3542; val_kl_reg_loss: 6741.2427; val_edge_recon_loss: 286256.8750; val_cond_contrastive_loss: 78372.9453; val_gene_expr_recon_loss: 96576.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467947.7812; val_optim_loss: 467947.7812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8470; val_auprc_score: 0.8177; val_best_acc_score: 0.7721; val_best_f1_score: 0.8015; train_kl_reg_loss: 6693.8558; train_edge_recon_loss: 281570.3750; train_cond_contrastive_loss: 78787.4557; train_gene_expr_recon_loss: 95809.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462861.4688; train_optim_loss: 462861.4688; val_kl_reg_loss: 6325.9434; val_edge_recon_loss: 280555.6562; val_cond_contrastive_loss: 78369.5781; val_gene_expr_recon_loss: 96067.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461318.8750; val_optim_loss: 461318.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8614; val_auprc_score: 0.8313; val_best_acc_score: 0.7877; val_best_f1_score: 0.8106; train_kl_reg_loss: 6307.6615; train_edge_recon_loss: 279130.3906; train_cond_contrastive_loss: 79028.7461; train_gene_expr_recon_loss: 95436.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459903.2812; train_optim_loss: 459903.2812; val_kl_reg_loss: 6184.2119; val_edge_recon_loss: 281149.9688; val_cond_contrastive_loss: 78377.9766; val_gene_expr_recon_loss: 95671.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461383.8125; val_optim_loss: 461383.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8803; val_auprc_score: 0.8552; val_best_acc_score: 0.8102; val_best_f1_score: 0.8301; train_kl_reg_loss: 6378.1341; train_edge_recon_loss: 278141.0365; train_cond_contrastive_loss: 79009.1055; train_gene_expr_recon_loss: 94965.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458493.8750; train_optim_loss: 458493.8750; val_kl_reg_loss: 6436.6201; val_edge_recon_loss: 275496.4375; val_cond_contrastive_loss: 78390.0859; val_gene_expr_recon_loss: 95304.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455627.8750; val_optim_loss: 455627.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8968; val_auprc_score: 0.8752; val_best_acc_score: 0.8278; val_best_f1_score: 0.8448; train_kl_reg_loss: 6518.9193; train_edge_recon_loss: 274637.7969; train_cond_contrastive_loss: 78911.5651; train_gene_expr_recon_loss: 94466.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454534.6250; train_optim_loss: 454534.6250; val_kl_reg_loss: 6306.6758; val_edge_recon_loss: 274690.0312; val_cond_contrastive_loss: 78407.4141; val_gene_expr_recon_loss: 94937.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454342.0312; val_optim_loss: 454342.0312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9172; val_auprc_score: 0.8975; val_best_acc_score: 0.8485; val_best_f1_score: 0.8599; train_kl_reg_loss: 6231.8281; train_edge_recon_loss: 273865.6354; train_cond_contrastive_loss: 78954.6094; train_gene_expr_recon_loss: 94307.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453359.7760; train_optim_loss: 453359.7760; val_kl_reg_loss: 5972.2539; val_edge_recon_loss: 270792.0000; val_cond_contrastive_loss: 78422.1484; val_gene_expr_recon_loss: 94546.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449733.1875; val_optim_loss: 449733.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9324; val_auprc_score: 0.9196; val_best_acc_score: 0.8595; val_best_f1_score: 0.8671; train_kl_reg_loss: 5950.8022; train_edge_recon_loss: 271945.2292; train_cond_contrastive_loss: 78932.0664; train_gene_expr_recon_loss: 93755.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450583.8802; train_optim_loss: 450583.8802; val_kl_reg_loss: 5844.9707; val_edge_recon_loss: 274164.0312; val_cond_contrastive_loss: 78427.1953; val_gene_expr_recon_loss: 94219.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452655.4688; val_optim_loss: 452655.4688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9503; val_auprc_score: 0.9406; val_best_acc_score: 0.8864; val_best_f1_score: 0.8908; train_kl_reg_loss: 5982.9439; train_edge_recon_loss: 270774.4948; train_cond_contrastive_loss: 78809.9518; train_gene_expr_recon_loss: 93527.4661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449094.8646; train_optim_loss: 449094.8646; val_kl_reg_loss: 6122.9111; val_edge_recon_loss: 267718.1562; val_cond_contrastive_loss: 78425.2500; val_gene_expr_recon_loss: 93907.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446173.3438; val_optim_loss: 446173.3438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9576; val_auprc_score: 0.9505; val_best_acc_score: 0.9003; val_best_f1_score: 0.9042; train_kl_reg_loss: 6205.3393; train_edge_recon_loss: 268344.3698; train_cond_contrastive_loss: 78706.6602; train_gene_expr_recon_loss: 93233.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446490.1927; train_optim_loss: 446490.1927; val_kl_reg_loss: 6205.5635; val_edge_recon_loss: 267464.3125; val_cond_contrastive_loss: 78416.8984; val_gene_expr_recon_loss: 93638.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445725.4062; val_optim_loss: 445725.4062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9617; val_auprc_score: 0.9562; val_best_acc_score: 0.9017; val_best_f1_score: 0.9059; train_kl_reg_loss: 6160.5738; train_edge_recon_loss: 266803.5885; train_cond_contrastive_loss: 78699.3255; train_gene_expr_recon_loss: 92904.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444568.1354; train_optim_loss: 444568.1354; val_kl_reg_loss: 6047.7949; val_edge_recon_loss: 268179.9688; val_cond_contrastive_loss: 78414.0156; val_gene_expr_recon_loss: 93377.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446019.3750; val_optim_loss: 446019.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9667; val_auprc_score: 0.9565; val_best_acc_score: 0.9169; val_best_f1_score: 0.9193; train_kl_reg_loss: 6076.8624; train_edge_recon_loss: 267423.4323; train_cond_contrastive_loss: 78720.7591; train_gene_expr_recon_loss: 92575.3503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444796.4010; train_optim_loss: 444796.4010; val_kl_reg_loss: 6007.3408; val_edge_recon_loss: 264230.1875; val_cond_contrastive_loss: 78414.7578; val_gene_expr_recon_loss: 93095.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441747.4375; val_optim_loss: 441747.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9732; val_auprc_score: 0.9661; val_best_acc_score: 0.9254; val_best_f1_score: 0.9273; train_kl_reg_loss: 6055.6792; train_edge_recon_loss: 265758.6823; train_cond_contrastive_loss: 78733.9141; train_gene_expr_recon_loss: 92483.8268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443032.1042; train_optim_loss: 443032.1042; val_kl_reg_loss: 5949.9668; val_edge_recon_loss: 265512.7500; val_cond_contrastive_loss: 78415.1328; val_gene_expr_recon_loss: 92833.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442711.4688; val_optim_loss: 442711.4688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9727; val_best_acc_score: 0.9298; val_best_f1_score: 0.9318; train_kl_reg_loss: 5940.7936; train_edge_recon_loss: 264782.5990; train_cond_contrastive_loss: 78759.4414; train_gene_expr_recon_loss: 92097.2995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441580.1302; train_optim_loss: 441580.1302; val_kl_reg_loss: 5835.4990; val_edge_recon_loss: 263786.4375; val_cond_contrastive_loss: 78414.2734; val_gene_expr_recon_loss: 92585.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440621.7500; val_optim_loss: 440621.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9786; val_auprc_score: 0.9723; val_best_acc_score: 0.9335; val_best_f1_score: 0.9353; train_kl_reg_loss: 5903.8045; train_edge_recon_loss: 263711.9896; train_cond_contrastive_loss: 78744.2305; train_gene_expr_recon_loss: 91900.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440260.9271; train_optim_loss: 440260.9271; val_kl_reg_loss: 5859.0273; val_edge_recon_loss: 263609.5000; val_cond_contrastive_loss: 78411.8516; val_gene_expr_recon_loss: 92373.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440253.9688; val_optim_loss: 440253.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9817; val_auprc_score: 0.9779; val_best_acc_score: 0.9374; val_best_f1_score: 0.9392; train_kl_reg_loss: 5852.9114; train_edge_recon_loss: 262708.0729; train_cond_contrastive_loss: 78708.3451; train_gene_expr_recon_loss: 91642.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438911.8177; train_optim_loss: 438911.8177; val_kl_reg_loss: 5781.4839; val_edge_recon_loss: 261457.9844; val_cond_contrastive_loss: 78407.9844; val_gene_expr_recon_loss: 92165.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437813.1875; val_optim_loss: 437813.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9804; val_auprc_score: 0.9709; val_best_acc_score: 0.9391; val_best_f1_score: 0.9417; train_kl_reg_loss: 5841.9218; train_edge_recon_loss: 262549.1667; train_cond_contrastive_loss: 78671.1224; train_gene_expr_recon_loss: 91767.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438829.7240; train_optim_loss: 438829.7240; val_kl_reg_loss: 5772.6777; val_edge_recon_loss: 260028.9844; val_cond_contrastive_loss: 78406.1016; val_gene_expr_recon_loss: 91960.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436168.3750; val_optim_loss: 436168.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9842; val_auprc_score: 0.9786; val_best_acc_score: 0.9455; val_best_f1_score: 0.9472; train_kl_reg_loss: 5827.2175; train_edge_recon_loss: 261448.9323; train_cond_contrastive_loss: 78640.6784; train_gene_expr_recon_loss: 91477.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437394.2135; train_optim_loss: 437394.2135; val_kl_reg_loss: 5818.1519; val_edge_recon_loss: 259230.9375; val_cond_contrastive_loss: 78405.8125; val_gene_expr_recon_loss: 91758.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435212.9688; val_optim_loss: 435212.9688
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9829; val_auprc_score: 0.9774; val_best_acc_score: 0.9467; val_best_f1_score: 0.9482; train_kl_reg_loss: 5886.7445; train_edge_recon_loss: 261545.1406; train_cond_contrastive_loss: 78634.8997; train_gene_expr_recon_loss: 91171.2513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437238.0312; train_optim_loss: 437238.0312; val_kl_reg_loss: 5843.6553; val_edge_recon_loss: 260289.6094; val_cond_contrastive_loss: 78405.8906; val_gene_expr_recon_loss: 91509.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436048.9375; val_optim_loss: 436048.9375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9851; val_auprc_score: 0.9831; val_best_acc_score: 0.9446; val_best_f1_score: 0.9460; train_kl_reg_loss: 5823.6004; train_edge_recon_loss: 260514.0104; train_cond_contrastive_loss: 78644.5664; train_gene_expr_recon_loss: 90967.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435950.0104; train_optim_loss: 435950.0104; val_kl_reg_loss: 5741.6992; val_edge_recon_loss: 259405.3750; val_cond_contrastive_loss: 78403.1719; val_gene_expr_recon_loss: 91291.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434841.9688; val_optim_loss: 434841.9688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9855; val_auprc_score: 0.9802; val_best_acc_score: 0.9508; val_best_f1_score: 0.9521; train_kl_reg_loss: 5781.8629; train_edge_recon_loss: 261659.5260; train_cond_contrastive_loss: 78647.8620; train_gene_expr_recon_loss: 90688.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436777.8125; train_optim_loss: 436777.8125; val_kl_reg_loss: 5743.7017; val_edge_recon_loss: 258034.4062; val_cond_contrastive_loss: 78400.6719; val_gene_expr_recon_loss: 91046.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433225.6875; val_optim_loss: 433225.6875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9869; val_auprc_score: 0.9848; val_best_acc_score: 0.9493; val_best_f1_score: 0.9497; train_kl_reg_loss: 5764.6729; train_edge_recon_loss: 261924.0208; train_cond_contrastive_loss: 78660.3320; train_gene_expr_recon_loss: 90634.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436983.6979; train_optim_loss: 436983.6979; val_kl_reg_loss: 5714.1104; val_edge_recon_loss: 262355.9062; val_cond_contrastive_loss: 78401.1562; val_gene_expr_recon_loss: 90846.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437317.2500; val_optim_loss: 437317.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9871; val_auprc_score: 0.9834; val_best_acc_score: 0.9522; val_best_f1_score: 0.9533; train_kl_reg_loss: 5800.6868; train_edge_recon_loss: 260784.9505; train_cond_contrastive_loss: 78654.8750; train_gene_expr_recon_loss: 90273.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435513.9844; train_optim_loss: 435513.9844; val_kl_reg_loss: 5691.1885; val_edge_recon_loss: 257834.5469; val_cond_contrastive_loss: 78405.6719; val_gene_expr_recon_loss: 90667.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432598.6875; val_optim_loss: 432598.6875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9886; val_auprc_score: 0.9849; val_best_acc_score: 0.9533; val_best_f1_score: 0.9544; train_kl_reg_loss: 5724.2300; train_edge_recon_loss: 260177.5547; train_cond_contrastive_loss: 78665.0951; train_gene_expr_recon_loss: 90191.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434758.2917; train_optim_loss: 434758.2917; val_kl_reg_loss: 5700.1904; val_edge_recon_loss: 257722.5000; val_cond_contrastive_loss: 78410.2188; val_gene_expr_recon_loss: 90478.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432311.1562; val_optim_loss: 432311.1562
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9885; val_auprc_score: 0.9857; val_best_acc_score: 0.9526; val_best_f1_score: 0.9535; train_kl_reg_loss: 5804.1903; train_edge_recon_loss: 260641.9479; train_cond_contrastive_loss: 78649.2305; train_gene_expr_recon_loss: 89929.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435025.1875; train_optim_loss: 435025.1875; val_kl_reg_loss: 5709.2446; val_edge_recon_loss: 260181.7500; val_cond_contrastive_loss: 78412.6562; val_gene_expr_recon_loss: 90310.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434613.6562; val_optim_loss: 434613.6562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9902; val_auprc_score: 0.9882; val_best_acc_score: 0.9576; val_best_f1_score: 0.9581; train_kl_reg_loss: 5700.8132; train_edge_recon_loss: 260776.4479; train_cond_contrastive_loss: 78660.5000; train_gene_expr_recon_loss: 89766.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434904.0625; train_optim_loss: 434904.0625; val_kl_reg_loss: 5692.2119; val_edge_recon_loss: 259369.1875; val_cond_contrastive_loss: 78413.2812; val_gene_expr_recon_loss: 90127.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433601.7500; val_optim_loss: 433601.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9884; val_auprc_score: 0.9829; val_best_acc_score: 0.9552; val_best_f1_score: 0.9561; train_kl_reg_loss: 5782.2139; train_edge_recon_loss: 260400.2682; train_cond_contrastive_loss: 78657.9688; train_gene_expr_recon_loss: 89546.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434387.1719; train_optim_loss: 434387.1719; val_kl_reg_loss: 5694.2012; val_edge_recon_loss: 259657.2344; val_cond_contrastive_loss: 78412.9141; val_gene_expr_recon_loss: 89961.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433726.0625; val_optim_loss: 433726.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9889; val_auprc_score: 0.9867; val_best_acc_score: 0.9567; val_best_f1_score: 0.9576; train_kl_reg_loss: 5740.3142; train_edge_recon_loss: 259806.3880; train_cond_contrastive_loss: 78672.2734; train_gene_expr_recon_loss: 89555.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433774.1302; train_optim_loss: 433774.1302; val_kl_reg_loss: 5662.1055; val_edge_recon_loss: 256891.2500; val_cond_contrastive_loss: 78411.9297; val_gene_expr_recon_loss: 89929.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430894.8438; val_optim_loss: 430894.8438
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9884; val_auprc_score: 0.9825; val_best_acc_score: 0.9567; val_best_f1_score: 0.9571; train_kl_reg_loss: 5715.8931; train_edge_recon_loss: 259571.9062; train_cond_contrastive_loss: 78658.9609; train_gene_expr_recon_loss: 89309.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433256.3906; train_optim_loss: 433256.3906; val_kl_reg_loss: 5666.0283; val_edge_recon_loss: 261442.8438; val_cond_contrastive_loss: 78411.1250; val_gene_expr_recon_loss: 89911.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435431.2188; val_optim_loss: 435431.2188
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9895; val_auprc_score: 0.9829; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 5718.9687; train_edge_recon_loss: 260491.8151; train_cond_contrastive_loss: 78654.1849; train_gene_expr_recon_loss: 89371.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434236.0521; train_optim_loss: 434236.0521; val_kl_reg_loss: 5675.8418; val_edge_recon_loss: 257937.9375; val_cond_contrastive_loss: 78412.5547; val_gene_expr_recon_loss: 89883.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431909.8125; val_optim_loss: 431909.8125
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9892; val_auprc_score: 0.9853; val_best_acc_score: 0.9582; val_best_f1_score: 0.9590; train_kl_reg_loss: 5722.0964; train_edge_recon_loss: 260283.4271; train_cond_contrastive_loss: 78659.4219; train_gene_expr_recon_loss: 89472.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434137.7135; train_optim_loss: 434137.7135; val_kl_reg_loss: 5651.5518; val_edge_recon_loss: 258701.6875; val_cond_contrastive_loss: 78412.1797; val_gene_expr_recon_loss: 89869.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432635.0625; val_optim_loss: 432635.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9878; val_auprc_score: 0.9815; val_best_acc_score: 0.9550; val_best_f1_score: 0.9556; train_kl_reg_loss: 5702.3337; train_edge_recon_loss: 260525.1016; train_cond_contrastive_loss: 78663.0938; train_gene_expr_recon_loss: 89491.8919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434382.4167; train_optim_loss: 434382.4167; val_kl_reg_loss: 5653.9766; val_edge_recon_loss: 259928.5312; val_cond_contrastive_loss: 78412.0625; val_gene_expr_recon_loss: 89867.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433862.0312; val_optim_loss: 433862.0312
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9907; val_auprc_score: 0.9890; val_best_acc_score: 0.9586; val_best_f1_score: 0.9596; train_kl_reg_loss: 5706.1910; train_edge_recon_loss: 260791.7474; train_cond_contrastive_loss: 78657.2969; train_gene_expr_recon_loss: 89241.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434397.0677; train_optim_loss: 434397.0677; val_kl_reg_loss: 5660.4463; val_edge_recon_loss: 255489.5625; val_cond_contrastive_loss: 78412.4766; val_gene_expr_recon_loss: 89863.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429426.3125; val_optim_loss: 429426.3125
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9892; val_auprc_score: 0.9858; val_best_acc_score: 0.9568; val_best_f1_score: 0.9578; train_kl_reg_loss: 5707.6987; train_edge_recon_loss: 261259.5964; train_cond_contrastive_loss: 78658.0417; train_gene_expr_recon_loss: 89406.6706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435032.0104; train_optim_loss: 435032.0104; val_kl_reg_loss: 5661.5000; val_edge_recon_loss: 257522.7969; val_cond_contrastive_loss: 78412.5781; val_gene_expr_recon_loss: 89860.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431457.7500; val_optim_loss: 431457.7500
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9874; val_auprc_score: 0.9841; val_best_acc_score: 0.9565; val_best_f1_score: 0.9571; train_kl_reg_loss: 5709.4780; train_edge_recon_loss: 260193.8802; train_cond_contrastive_loss: 78654.4049; train_gene_expr_recon_loss: 89135.6654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433693.4271; train_optim_loss: 433693.4271; val_kl_reg_loss: 5657.2178; val_edge_recon_loss: 258850.8750; val_cond_contrastive_loss: 78412.0234; val_gene_expr_recon_loss: 89858.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432778.8125; val_optim_loss: 432778.8125
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9879; val_auprc_score: 0.9849; val_best_acc_score: 0.9531; val_best_f1_score: 0.9546; train_kl_reg_loss: 5711.1474; train_edge_recon_loss: 260695.8854; train_cond_contrastive_loss: 78654.6849; train_gene_expr_recon_loss: 89360.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434422.1875; train_optim_loss: 434422.1875; val_kl_reg_loss: 5657.4897; val_edge_recon_loss: 258166.2812; val_cond_contrastive_loss: 78412.7734; val_gene_expr_recon_loss: 89856.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432093.3438; val_optim_loss: 432093.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9910; val_auprc_score: 0.9866; val_best_acc_score: 0.9602; val_best_f1_score: 0.9605; train_kl_reg_loss: 5706.2457; train_edge_recon_loss: 259841.9089; train_cond_contrastive_loss: 78661.2682; train_gene_expr_recon_loss: 89431.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433641.3906; train_optim_loss: 433641.3906; val_kl_reg_loss: 5655.5171; val_edge_recon_loss: 259587.5625; val_cond_contrastive_loss: 78412.1016; val_gene_expr_recon_loss: 89856.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433511.8125; val_optim_loss: 433511.8125
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9875; val_auprc_score: 0.9836; val_best_acc_score: 0.9553; val_best_f1_score: 0.9565; train_kl_reg_loss: 5705.9957; train_edge_recon_loss: 260352.5156; train_cond_contrastive_loss: 78654.7018; train_gene_expr_recon_loss: 89299.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434013.0885; train_optim_loss: 434013.0885; val_kl_reg_loss: 5660.5205; val_edge_recon_loss: 257383.8281; val_cond_contrastive_loss: 78412.4531; val_gene_expr_recon_loss: 89856.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431313.2812; val_optim_loss: 431313.2812
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9884; val_auprc_score: 0.9840; val_best_acc_score: 0.9546; val_best_f1_score: 0.9557; train_kl_reg_loss: 5706.7217; train_edge_recon_loss: 260476.0521; train_cond_contrastive_loss: 78666.8490; train_gene_expr_recon_loss: 89295.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434144.9479; train_optim_loss: 434144.9479; val_kl_reg_loss: 5656.1016; val_edge_recon_loss: 259347.5938; val_cond_contrastive_loss: 78412.6094; val_gene_expr_recon_loss: 89856.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433272.6562; val_optim_loss: 433272.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 32 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.9897
Val AUPRC score: 0.9870
Val best accuracy score: 0.9583
Val best F1 score: 0.9594
Val gene expr MSE score: 1.3699
Duration of model training in run 5: 0 hours, 2 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7866; val_auprc_score: 0.8198; val_best_acc_score: 0.7149; val_best_f1_score: 0.7083; train_kl_reg_loss: 3378.1760; train_edge_recon_loss: 358532.1302; train_cond_contrastive_loss: 109530.2734; train_gene_expr_recon_loss: 121931.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 593371.9479; train_optim_loss: 593371.9479; val_kl_reg_loss: 15569.8848; val_edge_recon_loss: 403861.0000; val_cond_contrastive_loss: 78340.3750; val_gene_expr_recon_loss: 103432.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 601203.7500; val_optim_loss: 601203.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7332; val_auprc_score: 0.7662; val_best_acc_score: 0.6460; val_best_f1_score: 0.7026; train_kl_reg_loss: 10570.8524; train_edge_recon_loss: 357216.9010; train_cond_contrastive_loss: 87611.2044; train_gene_expr_recon_loss: 102299.3529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557698.3021; train_optim_loss: 557698.3021; val_kl_reg_loss: 5264.7217; val_edge_recon_loss: 389919.2812; val_cond_contrastive_loss: 78371.8438; val_gene_expr_recon_loss: 100822.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 574378.6250; val_optim_loss: 574378.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7291; val_auprc_score: 0.7563; val_best_acc_score: 0.6548; val_best_f1_score: 0.7044; train_kl_reg_loss: 5176.4032; train_edge_recon_loss: 348483.5677; train_cond_contrastive_loss: 87679.6680; train_gene_expr_recon_loss: 100999.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542338.8125; train_optim_loss: 542338.8125; val_kl_reg_loss: 4108.7598; val_edge_recon_loss: 348408.7500; val_cond_contrastive_loss: 78459.2344; val_gene_expr_recon_loss: 100123.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 531099.8125; val_optim_loss: 531099.8125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7350; val_auprc_score: 0.7599; val_best_acc_score: 0.6644; val_best_f1_score: 0.7042; train_kl_reg_loss: 3749.2440; train_edge_recon_loss: 330468.4896; train_cond_contrastive_loss: 86758.4258; train_gene_expr_recon_loss: 100067.8060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521043.9740; train_optim_loss: 521043.9740; val_kl_reg_loss: 3886.2676; val_edge_recon_loss: 323484.8438; val_cond_contrastive_loss: 78375.1562; val_gene_expr_recon_loss: 99404.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 505150.5000; val_optim_loss: 505150.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7768; val_auprc_score: 0.7891; val_best_acc_score: 0.6912; val_best_f1_score: 0.7284; train_kl_reg_loss: 4461.2435; train_edge_recon_loss: 313744.1927; train_cond_contrastive_loss: 79779.1042; train_gene_expr_recon_loss: 99297.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497281.8073; train_optim_loss: 497281.8073; val_kl_reg_loss: 5154.8037; val_edge_recon_loss: 306446.0938; val_cond_contrastive_loss: 78377.4219; val_gene_expr_recon_loss: 98724.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488702.5000; val_optim_loss: 488702.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8347; val_auprc_score: 0.8231; val_best_acc_score: 0.7462; val_best_f1_score: 0.7766; train_kl_reg_loss: 5669.4158; train_edge_recon_loss: 297313.3281; train_cond_contrastive_loss: 78875.9909; train_gene_expr_recon_loss: 98624.7174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480483.4583; train_optim_loss: 480483.4583; val_kl_reg_loss: 6282.4111; val_edge_recon_loss: 290298.5000; val_cond_contrastive_loss: 78401.1094; val_gene_expr_recon_loss: 98004.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472986.0625; val_optim_loss: 472986.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8536; val_auprc_score: 0.8324; val_best_acc_score: 0.7704; val_best_f1_score: 0.7967; train_kl_reg_loss: 6442.3757; train_edge_recon_loss: 285028.1302; train_cond_contrastive_loss: 78748.3776; train_gene_expr_recon_loss: 97421.5091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467640.4062; train_optim_loss: 467640.4062; val_kl_reg_loss: 6552.3940; val_edge_recon_loss: 286956.8750; val_cond_contrastive_loss: 78398.5234; val_gene_expr_recon_loss: 97283.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469191.1875; val_optim_loss: 469191.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8737; val_auprc_score: 0.8460; val_best_acc_score: 0.8002; val_best_f1_score: 0.8188; train_kl_reg_loss: 6433.7216; train_edge_recon_loss: 279478.4688; train_cond_contrastive_loss: 78889.2930; train_gene_expr_recon_loss: 97189.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461991.2188; train_optim_loss: 461991.2188; val_kl_reg_loss: 6257.8027; val_edge_recon_loss: 279592.9375; val_cond_contrastive_loss: 78396.6641; val_gene_expr_recon_loss: 96697.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460944.8438; val_optim_loss: 460944.8438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8813; val_auprc_score: 0.8516; val_best_acc_score: 0.8198; val_best_f1_score: 0.8375; train_kl_reg_loss: 6246.7852; train_edge_recon_loss: 276828.8906; train_cond_contrastive_loss: 79024.8438; train_gene_expr_recon_loss: 96566.7682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458667.2917; train_optim_loss: 458667.2917; val_kl_reg_loss: 6226.7559; val_edge_recon_loss: 276784.5938; val_cond_contrastive_loss: 78401.8281; val_gene_expr_recon_loss: 96157.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457570.9688; val_optim_loss: 457570.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8992; val_auprc_score: 0.8767; val_best_acc_score: 0.8334; val_best_f1_score: 0.8448; train_kl_reg_loss: 6312.9072; train_edge_recon_loss: 273905.0312; train_cond_contrastive_loss: 79004.8672; train_gene_expr_recon_loss: 96137.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455359.8385; train_optim_loss: 455359.8385; val_kl_reg_loss: 6262.5479; val_edge_recon_loss: 278025.2188; val_cond_contrastive_loss: 78412.7500; val_gene_expr_recon_loss: 95682.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458382.5312; val_optim_loss: 458382.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9209; val_auprc_score: 0.9039; val_best_acc_score: 0.8519; val_best_f1_score: 0.8612; train_kl_reg_loss: 6232.4427; train_edge_recon_loss: 272369.6250; train_cond_contrastive_loss: 78934.2266; train_gene_expr_recon_loss: 95668.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453204.6927; train_optim_loss: 453204.6927; val_kl_reg_loss: 6060.3164; val_edge_recon_loss: 273790.6875; val_cond_contrastive_loss: 78425.1094; val_gene_expr_recon_loss: 95281.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453557.9062; val_optim_loss: 453557.9062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9338; val_auprc_score: 0.9187; val_best_acc_score: 0.8640; val_best_f1_score: 0.8723; train_kl_reg_loss: 6031.7799; train_edge_recon_loss: 272364.3490; train_cond_contrastive_loss: 78852.5039; train_gene_expr_recon_loss: 95367.8112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452616.4479; train_optim_loss: 452616.4479; val_kl_reg_loss: 5893.4502; val_edge_recon_loss: 269051.5938; val_cond_contrastive_loss: 78429.7734; val_gene_expr_recon_loss: 94942.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448317.5625; val_optim_loss: 448317.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9443; val_auprc_score: 0.9338; val_best_acc_score: 0.8744; val_best_f1_score: 0.8800; train_kl_reg_loss: 6063.1825; train_edge_recon_loss: 268761.8542; train_cond_contrastive_loss: 78769.1068; train_gene_expr_recon_loss: 95046.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448640.8490; train_optim_loss: 448640.8490; val_kl_reg_loss: 6102.3838; val_edge_recon_loss: 270362.6875; val_cond_contrastive_loss: 78423.1406; val_gene_expr_recon_loss: 94615.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449503.8125; val_optim_loss: 449503.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9508; val_auprc_score: 0.9415; val_best_acc_score: 0.8852; val_best_f1_score: 0.8905; train_kl_reg_loss: 6236.2275; train_edge_recon_loss: 268242.7604; train_cond_contrastive_loss: 78695.9089; train_gene_expr_recon_loss: 94563.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447738.4635; train_optim_loss: 447738.4635; val_kl_reg_loss: 6232.9941; val_edge_recon_loss: 271781.3438; val_cond_contrastive_loss: 78414.9375; val_gene_expr_recon_loss: 94323.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450752.6250; val_optim_loss: 450752.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9572; val_auprc_score: 0.9482; val_best_acc_score: 0.9002; val_best_f1_score: 0.9033; train_kl_reg_loss: 6247.3308; train_edge_recon_loss: 268642.4271; train_cond_contrastive_loss: 78688.7604; train_gene_expr_recon_loss: 94541.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448119.7812; train_optim_loss: 448119.7812; val_kl_reg_loss: 6044.6191; val_edge_recon_loss: 268445.6875; val_cond_contrastive_loss: 78413.8203; val_gene_expr_recon_loss: 94052.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446956.1875; val_optim_loss: 446956.1875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9649; val_auprc_score: 0.9565; val_best_acc_score: 0.9092; val_best_f1_score: 0.9118; train_kl_reg_loss: 6098.2438; train_edge_recon_loss: 267645.8281; train_cond_contrastive_loss: 78715.4857; train_gene_expr_recon_loss: 93994.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446453.6094; train_optim_loss: 446453.6094; val_kl_reg_loss: 5897.3555; val_edge_recon_loss: 268598.6250; val_cond_contrastive_loss: 78416.2734; val_gene_expr_recon_loss: 93743.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446655.8438; val_optim_loss: 446655.8438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9701; val_auprc_score: 0.9646; val_best_acc_score: 0.9165; val_best_f1_score: 0.9203; train_kl_reg_loss: 6013.9422; train_edge_recon_loss: 266007.5000; train_cond_contrastive_loss: 78720.2682; train_gene_expr_recon_loss: 93889.6276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444631.3490; train_optim_loss: 444631.3490; val_kl_reg_loss: 5817.6172; val_edge_recon_loss: 265731.8750; val_cond_contrastive_loss: 78419.3906; val_gene_expr_recon_loss: 93419.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443388.6875; val_optim_loss: 443388.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9772; val_auprc_score: 0.9707; val_best_acc_score: 0.9322; val_best_f1_score: 0.9343; train_kl_reg_loss: 5811.3603; train_edge_recon_loss: 265985.1510; train_cond_contrastive_loss: 78746.8346; train_gene_expr_recon_loss: 93546.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444089.7396; train_optim_loss: 444089.7396; val_kl_reg_loss: 5718.4385; val_edge_recon_loss: 262097.5000; val_cond_contrastive_loss: 78421.9453; val_gene_expr_recon_loss: 93115.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439353.3438; val_optim_loss: 439353.3438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9790; val_auprc_score: 0.9736; val_best_acc_score: 0.9346; val_best_f1_score: 0.9360; train_kl_reg_loss: 5848.3049; train_edge_recon_loss: 264091.9089; train_cond_contrastive_loss: 78738.2852; train_gene_expr_recon_loss: 93235.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441914.1094; train_optim_loss: 441914.1094; val_kl_reg_loss: 5771.8311; val_edge_recon_loss: 266384.8750; val_cond_contrastive_loss: 78420.6797; val_gene_expr_recon_loss: 92861.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443439.0625; val_optim_loss: 443439.0625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9829; val_auprc_score: 0.9779; val_best_acc_score: 0.9442; val_best_f1_score: 0.9455; train_kl_reg_loss: 5861.9345; train_edge_recon_loss: 263784.2969; train_cond_contrastive_loss: 78735.2148; train_gene_expr_recon_loss: 93040.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441421.7604; train_optim_loss: 441421.7604; val_kl_reg_loss: 5745.2051; val_edge_recon_loss: 261771.6719; val_cond_contrastive_loss: 78416.8828; val_gene_expr_recon_loss: 92622.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438555.8750; val_optim_loss: 438555.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9836; val_auprc_score: 0.9798; val_best_acc_score: 0.9458; val_best_f1_score: 0.9471; train_kl_reg_loss: 5850.3106; train_edge_recon_loss: 261830.6276; train_cond_contrastive_loss: 78742.3346; train_gene_expr_recon_loss: 92676.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439100.0104; train_optim_loss: 439100.0104; val_kl_reg_loss: 5825.8164; val_edge_recon_loss: 259969.2031; val_cond_contrastive_loss: 78412.0469; val_gene_expr_recon_loss: 92403.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436610.3750; val_optim_loss: 436610.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9833; val_auprc_score: 0.9788; val_best_acc_score: 0.9469; val_best_f1_score: 0.9488; train_kl_reg_loss: 5900.2885; train_edge_recon_loss: 261610.7839; train_cond_contrastive_loss: 78732.9167; train_gene_expr_recon_loss: 92423.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438667.0938; train_optim_loss: 438667.0938; val_kl_reg_loss: 5795.6431; val_edge_recon_loss: 258652.9531; val_cond_contrastive_loss: 78407.0078; val_gene_expr_recon_loss: 92173.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435029.3750; val_optim_loss: 435029.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9838; val_auprc_score: 0.9788; val_best_acc_score: 0.9458; val_best_f1_score: 0.9468; train_kl_reg_loss: 5859.2218; train_edge_recon_loss: 261439.7552; train_cond_contrastive_loss: 78735.2734; train_gene_expr_recon_loss: 92195.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438229.5990; train_optim_loss: 438229.5990; val_kl_reg_loss: 5752.5293; val_edge_recon_loss: 261804.8125; val_cond_contrastive_loss: 78403.5547; val_gene_expr_recon_loss: 91915.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437876.8438; val_optim_loss: 437876.8438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9800; val_best_acc_score: 0.9483; val_best_f1_score: 0.9496; train_kl_reg_loss: 5853.9417; train_edge_recon_loss: 261626.5573; train_cond_contrastive_loss: 78744.1315; train_gene_expr_recon_loss: 92030.3841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438255.0104; train_optim_loss: 438255.0104; val_kl_reg_loss: 5828.0327; val_edge_recon_loss: 259969.1406; val_cond_contrastive_loss: 78404.0859; val_gene_expr_recon_loss: 91681.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435882.3125; val_optim_loss: 435882.3125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9828; val_auprc_score: 0.9775; val_best_acc_score: 0.9462; val_best_f1_score: 0.9478; train_kl_reg_loss: 5875.3771; train_edge_recon_loss: 259824.3021; train_cond_contrastive_loss: 78742.4115; train_gene_expr_recon_loss: 91892.7240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436334.8177; train_optim_loss: 436334.8177; val_kl_reg_loss: 5799.2559; val_edge_recon_loss: 259842.3125; val_cond_contrastive_loss: 78405.6484; val_gene_expr_recon_loss: 91466.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435513.5625; val_optim_loss: 435513.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9857; val_auprc_score: 0.9825; val_best_acc_score: 0.9470; val_best_f1_score: 0.9479; train_kl_reg_loss: 5870.0054; train_edge_recon_loss: 260344.5130; train_cond_contrastive_loss: 78736.5794; train_gene_expr_recon_loss: 91527.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436478.2292; train_optim_loss: 436478.2292; val_kl_reg_loss: 5781.5137; val_edge_recon_loss: 261169.8281; val_cond_contrastive_loss: 78405.7422; val_gene_expr_recon_loss: 91437.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436795.0000; val_optim_loss: 436795.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9834; val_auprc_score: 0.9787; val_best_acc_score: 0.9447; val_best_f1_score: 0.9464; train_kl_reg_loss: 5859.2369; train_edge_recon_loss: 259979.3385; train_cond_contrastive_loss: 78741.3451; train_gene_expr_recon_loss: 91558.1419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436138.0521; train_optim_loss: 436138.0521; val_kl_reg_loss: 5767.0576; val_edge_recon_loss: 259190.8906; val_cond_contrastive_loss: 78405.8828; val_gene_expr_recon_loss: 91412.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434776.1875; val_optim_loss: 434776.1875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9866; val_auprc_score: 0.9823; val_best_acc_score: 0.9503; val_best_f1_score: 0.9514; train_kl_reg_loss: 5853.1401; train_edge_recon_loss: 260939.7943; train_cond_contrastive_loss: 78734.6328; train_gene_expr_recon_loss: 91595.1810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437122.7396; train_optim_loss: 437122.7396; val_kl_reg_loss: 5768.1836; val_edge_recon_loss: 259322.8594; val_cond_contrastive_loss: 78406.0078; val_gene_expr_recon_loss: 91381.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434878.9688; val_optim_loss: 434878.9688
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9846; val_auprc_score: 0.9773; val_best_acc_score: 0.9476; val_best_f1_score: 0.9485; train_kl_reg_loss: 5843.9200; train_edge_recon_loss: 259170.9245; train_cond_contrastive_loss: 78732.8333; train_gene_expr_recon_loss: 91734.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435481.9531; train_optim_loss: 435481.9531; val_kl_reg_loss: 5749.6826; val_edge_recon_loss: 260898.2969; val_cond_contrastive_loss: 78405.9141; val_gene_expr_recon_loss: 91356.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436410.2188; val_optim_loss: 436410.2188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9861; val_auprc_score: 0.9825; val_best_acc_score: 0.9503; val_best_f1_score: 0.9513; train_kl_reg_loss: 5827.9401; train_edge_recon_loss: 259861.0156; train_cond_contrastive_loss: 78739.2682; train_gene_expr_recon_loss: 91442.9909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435871.2083; train_optim_loss: 435871.2083; val_kl_reg_loss: 5738.1611; val_edge_recon_loss: 259202.2344; val_cond_contrastive_loss: 78406.1250; val_gene_expr_recon_loss: 91334.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434681.1875; val_optim_loss: 434681.1875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9838; val_auprc_score: 0.9757; val_best_acc_score: 0.9476; val_best_f1_score: 0.9486; train_kl_reg_loss: 5825.0163; train_edge_recon_loss: 261380.7083; train_cond_contrastive_loss: 78742.9518; train_gene_expr_recon_loss: 91389.4779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437338.1615; train_optim_loss: 437338.1615; val_kl_reg_loss: 5741.2959; val_edge_recon_loss: 261168.6875; val_cond_contrastive_loss: 78406.1953; val_gene_expr_recon_loss: 91310.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436627.1562; val_optim_loss: 436627.1562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9874; val_auprc_score: 0.9837; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 5830.8124; train_edge_recon_loss: 260031.9714; train_cond_contrastive_loss: 78739.7396; train_gene_expr_recon_loss: 91364.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435966.7292; train_optim_loss: 435966.7292; val_kl_reg_loss: 5743.9385; val_edge_recon_loss: 258936.8281; val_cond_contrastive_loss: 78406.7422; val_gene_expr_recon_loss: 91286.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434373.6250; val_optim_loss: 434373.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9845; val_auprc_score: 0.9793; val_best_acc_score: 0.9460; val_best_f1_score: 0.9475; train_kl_reg_loss: 5825.1921; train_edge_recon_loss: 261442.6172; train_cond_contrastive_loss: 78735.3112; train_gene_expr_recon_loss: 91322.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437325.9115; train_optim_loss: 437325.9115; val_kl_reg_loss: 5732.9658; val_edge_recon_loss: 259845.2500; val_cond_contrastive_loss: 78407.2188; val_gene_expr_recon_loss: 91264.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435249.4688; val_optim_loss: 435249.4688
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9861; val_auprc_score: 0.9825; val_best_acc_score: 0.9484; val_best_f1_score: 0.9490; train_kl_reg_loss: 5811.2547; train_edge_recon_loss: 260445.4010; train_cond_contrastive_loss: 78743.5586; train_gene_expr_recon_loss: 91509.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436509.5990; train_optim_loss: 436509.5990; val_kl_reg_loss: 5721.3672; val_edge_recon_loss: 263286.2188; val_cond_contrastive_loss: 78407.0859; val_gene_expr_recon_loss: 91241.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438656.0312; val_optim_loss: 438656.0312
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9843; val_auprc_score: 0.9793; val_best_acc_score: 0.9456; val_best_f1_score: 0.9462; train_kl_reg_loss: 5810.8258; train_edge_recon_loss: 258622.6484; train_cond_contrastive_loss: 78745.0378; train_gene_expr_recon_loss: 91518.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434697.1094; train_optim_loss: 434697.1094; val_kl_reg_loss: 5724.3901; val_edge_recon_loss: 265013.0000; val_cond_contrastive_loss: 78407.0781; val_gene_expr_recon_loss: 91214.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440359.1875; val_optim_loss: 440359.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9873; val_auprc_score: 0.9844; val_best_acc_score: 0.9509; val_best_f1_score: 0.9520; train_kl_reg_loss: 5807.2877; train_edge_recon_loss: 261040.3646; train_cond_contrastive_loss: 78735.2617; train_gene_expr_recon_loss: 91304.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436887.8125; train_optim_loss: 436887.8125; val_kl_reg_loss: 5725.4771; val_edge_recon_loss: 257556.0469; val_cond_contrastive_loss: 78407.7188; val_gene_expr_recon_loss: 91212.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432902.1250; val_optim_loss: 432902.1250
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9865; val_auprc_score: 0.9827; val_best_acc_score: 0.9485; val_best_f1_score: 0.9493; train_kl_reg_loss: 5805.1716; train_edge_recon_loss: 261238.4089; train_cond_contrastive_loss: 78739.7083; train_gene_expr_recon_loss: 91279.3607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437062.6510; train_optim_loss: 437062.6510; val_kl_reg_loss: 5722.5088; val_edge_recon_loss: 261307.5938; val_cond_contrastive_loss: 78407.5547; val_gene_expr_recon_loss: 91211.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436648.8125; val_optim_loss: 436648.8125
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9866; val_auprc_score: 0.9824; val_best_acc_score: 0.9498; val_best_f1_score: 0.9503; train_kl_reg_loss: 5810.2144; train_edge_recon_loss: 260993.7786; train_cond_contrastive_loss: 78740.7591; train_gene_expr_recon_loss: 91399.2799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436944.0312; train_optim_loss: 436944.0312; val_kl_reg_loss: 5723.9072; val_edge_recon_loss: 262391.7188; val_cond_contrastive_loss: 78407.5859; val_gene_expr_recon_loss: 91209.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437732.7812; val_optim_loss: 437732.7812
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9851; val_auprc_score: 0.9804; val_best_acc_score: 0.9500; val_best_f1_score: 0.9507; train_kl_reg_loss: 5806.5957; train_edge_recon_loss: 262236.9245; train_cond_contrastive_loss: 78740.3763; train_gene_expr_recon_loss: 91328.0898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438111.9844; train_optim_loss: 438111.9844; val_kl_reg_loss: 5719.0063; val_edge_recon_loss: 261591.3438; val_cond_contrastive_loss: 78407.1172; val_gene_expr_recon_loss: 91207.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436925.0625; val_optim_loss: 436925.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9866; val_auprc_score: 0.9833; val_best_acc_score: 0.9508; val_best_f1_score: 0.9526; train_kl_reg_loss: 5805.1056; train_edge_recon_loss: 260378.1068; train_cond_contrastive_loss: 78743.0729; train_gene_expr_recon_loss: 91401.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436328.1458; train_optim_loss: 436328.1458; val_kl_reg_loss: 5721.6416; val_edge_recon_loss: 258963.2500; val_cond_contrastive_loss: 78407.9219; val_gene_expr_recon_loss: 91207.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434300.1875; val_optim_loss: 434300.1875
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9865; val_auprc_score: 0.9817; val_best_acc_score: 0.9491; val_best_f1_score: 0.9497; train_kl_reg_loss: 5808.0667; train_edge_recon_loss: 259886.9818; train_cond_contrastive_loss: 78749.4740; train_gene_expr_recon_loss: 91517.9857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435962.4896; train_optim_loss: 435962.4896; val_kl_reg_loss: 5728.7222; val_edge_recon_loss: 262152.8125; val_cond_contrastive_loss: 78407.3281; val_gene_expr_recon_loss: 91207.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437496.0000; val_optim_loss: 437496.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9850; val_auprc_score: 0.9799; val_best_acc_score: 0.9491; val_best_f1_score: 0.9502; train_kl_reg_loss: 5804.7507; train_edge_recon_loss: 260470.8932; train_cond_contrastive_loss: 78745.3776; train_gene_expr_recon_loss: 91357.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436378.8958; train_optim_loss: 436378.8958; val_kl_reg_loss: 5723.3545; val_edge_recon_loss: 262155.5312; val_cond_contrastive_loss: 78407.4766; val_gene_expr_recon_loss: 91206.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437493.1875; val_optim_loss: 437493.1875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 20 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9869
Val AUPRC score: 0.9836
Val best accuracy score: 0.9508
Val best F1 score: 0.9517
Val gene expr MSE score: 1.4545
Duration of model training in run 6: 0 hours, 2 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7700; val_auprc_score: 0.8052; val_best_acc_score: 0.6870; val_best_f1_score: 0.7102; train_kl_reg_loss: 6180.1973; train_edge_recon_loss: 355758.2366; train_cond_contrastive_loss: 105167.0614; train_gene_expr_recon_loss: 118220.8292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 585326.3214; train_optim_loss: 585326.3214; val_kl_reg_loss: 8857.4043; val_edge_recon_loss: 400225.3750; val_cond_contrastive_loss: 78332.4141; val_gene_expr_recon_loss: 101615.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 589030.9375; val_optim_loss: 589030.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7288; val_auprc_score: 0.7483; val_best_acc_score: 0.6493; val_best_f1_score: 0.7117; train_kl_reg_loss: 7243.2613; train_edge_recon_loss: 355272.3036; train_cond_contrastive_loss: 87601.9922; train_gene_expr_recon_loss: 101340.9431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551458.5089; train_optim_loss: 551458.5089; val_kl_reg_loss: 5879.6611; val_edge_recon_loss: 384070.8750; val_cond_contrastive_loss: 78359.1953; val_gene_expr_recon_loss: 98789.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567099.6250; val_optim_loss: 567099.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7267; val_auprc_score: 0.7480; val_best_acc_score: 0.6499; val_best_f1_score: 0.7039; train_kl_reg_loss: 4482.2981; train_edge_recon_loss: 343977.4777; train_cond_contrastive_loss: 88578.0569; train_gene_expr_recon_loss: 99588.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536625.9732; train_optim_loss: 536625.9732; val_kl_reg_loss: 3570.3433; val_edge_recon_loss: 338968.4062; val_cond_contrastive_loss: 78377.3750; val_gene_expr_recon_loss: 98085.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519001.5000; val_optim_loss: 519001.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7423; val_auprc_score: 0.7651; val_best_acc_score: 0.6665; val_best_f1_score: 0.7090; train_kl_reg_loss: 4170.9847; train_edge_recon_loss: 322087.9241; train_cond_contrastive_loss: 82463.7612; train_gene_expr_recon_loss: 98879.0402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507601.7143; train_optim_loss: 507601.7143; val_kl_reg_loss: 4844.7109; val_edge_recon_loss: 322069.0938; val_cond_contrastive_loss: 78351.0625; val_gene_expr_recon_loss: 97313.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502577.9688; val_optim_loss: 502577.9688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8141; val_auprc_score: 0.8121; val_best_acc_score: 0.7255; val_best_f1_score: 0.7525; train_kl_reg_loss: 5192.3341; train_edge_recon_loss: 308313.7277; train_cond_contrastive_loss: 79033.3426; train_gene_expr_recon_loss: 98225.9107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490765.3170; train_optim_loss: 490765.3170; val_kl_reg_loss: 5422.9814; val_edge_recon_loss: 297851.2188; val_cond_contrastive_loss: 78365.0469; val_gene_expr_recon_loss: 96523.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478163.0000; val_optim_loss: 478163.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8525; val_auprc_score: 0.8369; val_best_acc_score: 0.7708; val_best_f1_score: 0.7995; train_kl_reg_loss: 5778.2000; train_edge_recon_loss: 288055.9554; train_cond_contrastive_loss: 78809.4542; train_gene_expr_recon_loss: 97467.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470111.2455; train_optim_loss: 470111.2455; val_kl_reg_loss: 5959.2925; val_edge_recon_loss: 283133.4062; val_cond_contrastive_loss: 78374.8203; val_gene_expr_recon_loss: 95714.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463182.1562; val_optim_loss: 463182.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8709; val_auprc_score: 0.8521; val_best_acc_score: 0.7917; val_best_f1_score: 0.8140; train_kl_reg_loss: 6164.0709; train_edge_recon_loss: 281776.8929; train_cond_contrastive_loss: 78869.0335; train_gene_expr_recon_loss: 96773.5246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463583.5134; train_optim_loss: 463583.5134; val_kl_reg_loss: 6096.4902; val_edge_recon_loss: 278086.5938; val_cond_contrastive_loss: 78369.6797; val_gene_expr_recon_loss: 94994.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457546.8750; val_optim_loss: 457546.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8853; val_auprc_score: 0.8621; val_best_acc_score: 0.8141; val_best_f1_score: 0.8297; train_kl_reg_loss: 6184.7875; train_edge_recon_loss: 276739.0848; train_cond_contrastive_loss: 78950.6194; train_gene_expr_recon_loss: 95790.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457664.9286; train_optim_loss: 457664.9286; val_kl_reg_loss: 6149.7061; val_edge_recon_loss: 277361.4375; val_cond_contrastive_loss: 78373.4844; val_gene_expr_recon_loss: 94456.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456340.8750; val_optim_loss: 456340.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8968; val_auprc_score: 0.8703; val_best_acc_score: 0.8326; val_best_f1_score: 0.8472; train_kl_reg_loss: 6315.3964; train_edge_recon_loss: 274545.7277; train_cond_contrastive_loss: 78930.9833; train_gene_expr_recon_loss: 95520.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455312.9062; train_optim_loss: 455312.9062; val_kl_reg_loss: 6270.1680; val_edge_recon_loss: 273103.1250; val_cond_contrastive_loss: 78382.5469; val_gene_expr_recon_loss: 93982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451737.8125; val_optim_loss: 451737.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9173; val_auprc_score: 0.8966; val_best_acc_score: 0.8463; val_best_f1_score: 0.8562; train_kl_reg_loss: 6246.3126; train_edge_recon_loss: 273093.3929; train_cond_contrastive_loss: 78934.2288; train_gene_expr_recon_loss: 94968.1417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453242.0804; train_optim_loss: 453242.0804; val_kl_reg_loss: 5983.4219; val_edge_recon_loss: 273732.0625; val_cond_contrastive_loss: 78398.4766; val_gene_expr_recon_loss: 93584.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451698.2812; val_optim_loss: 451698.2812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9384; val_auprc_score: 0.9279; val_best_acc_score: 0.8687; val_best_f1_score: 0.8766; train_kl_reg_loss: 6010.8610; train_edge_recon_loss: 270395.1964; train_cond_contrastive_loss: 79003.3917; train_gene_expr_recon_loss: 94379.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449789.3929; train_optim_loss: 449789.3929; val_kl_reg_loss: 5918.2202; val_edge_recon_loss: 267176.5938; val_cond_contrastive_loss: 78408.4141; val_gene_expr_recon_loss: 93178.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444681.6562; val_optim_loss: 444681.6562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9471; val_auprc_score: 0.9358; val_best_acc_score: 0.8816; val_best_f1_score: 0.8875; train_kl_reg_loss: 6097.8717; train_edge_recon_loss: 268645.5045; train_cond_contrastive_loss: 78906.5971; train_gene_expr_recon_loss: 94040.5268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447690.5045; train_optim_loss: 447690.5045; val_kl_reg_loss: 6011.3657; val_edge_recon_loss: 269121.3750; val_cond_contrastive_loss: 78407.3906; val_gene_expr_recon_loss: 92792.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446332.8438; val_optim_loss: 446332.8438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9575; val_auprc_score: 0.9491; val_best_acc_score: 0.8988; val_best_f1_score: 0.9027; train_kl_reg_loss: 6091.4065; train_edge_recon_loss: 267458.9509; train_cond_contrastive_loss: 78822.2545; train_gene_expr_recon_loss: 93786.8214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446159.4420; train_optim_loss: 446159.4420; val_kl_reg_loss: 5976.0967; val_edge_recon_loss: 265125.9688; val_cond_contrastive_loss: 78402.7422; val_gene_expr_recon_loss: 92425.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441930.6250; val_optim_loss: 441930.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9629; val_auprc_score: 0.9526; val_best_acc_score: 0.9072; val_best_f1_score: 0.9107; train_kl_reg_loss: 6088.1851; train_edge_recon_loss: 266619.9688; train_cond_contrastive_loss: 78741.8627; train_gene_expr_recon_loss: 93578.6830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445028.7054; train_optim_loss: 445028.7054; val_kl_reg_loss: 5981.3169; val_edge_recon_loss: 265089.8125; val_cond_contrastive_loss: 78400.7500; val_gene_expr_recon_loss: 92060.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441531.8750; val_optim_loss: 441531.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9709; val_auprc_score: 0.9651; val_best_acc_score: 0.9229; val_best_f1_score: 0.9250; train_kl_reg_loss: 5993.8245; train_edge_recon_loss: 265615.9018; train_cond_contrastive_loss: 78702.4487; train_gene_expr_recon_loss: 92966.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443278.4821; train_optim_loss: 443278.4821; val_kl_reg_loss: 5880.6484; val_edge_recon_loss: 264072.9688; val_cond_contrastive_loss: 78402.2891; val_gene_expr_recon_loss: 91706.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440062.3125; val_optim_loss: 440062.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9760; val_auprc_score: 0.9706; val_best_acc_score: 0.9292; val_best_f1_score: 0.9307; train_kl_reg_loss: 5901.7502; train_edge_recon_loss: 264655.7946; train_cond_contrastive_loss: 78697.4074; train_gene_expr_recon_loss: 92700.8225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441955.7768; train_optim_loss: 441955.7768; val_kl_reg_loss: 5790.3682; val_edge_recon_loss: 263175.9062; val_cond_contrastive_loss: 78406.5078; val_gene_expr_recon_loss: 91370.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438743.5312; val_optim_loss: 438743.5312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9790; val_auprc_score: 0.9745; val_best_acc_score: 0.9344; val_best_f1_score: 0.9363; train_kl_reg_loss: 5871.1756; train_edge_recon_loss: 263538.9509; train_cond_contrastive_loss: 78717.8571; train_gene_expr_recon_loss: 91953.2355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440081.2232; train_optim_loss: 440081.2232; val_kl_reg_loss: 5774.3999; val_edge_recon_loss: 261763.1875; val_cond_contrastive_loss: 78405.0781; val_gene_expr_recon_loss: 91079.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437022.4375; val_optim_loss: 437022.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9832; val_auprc_score: 0.9792; val_best_acc_score: 0.9438; val_best_f1_score: 0.9447; train_kl_reg_loss: 5869.2449; train_edge_recon_loss: 262373.9576; train_cond_contrastive_loss: 78732.5223; train_gene_expr_recon_loss: 92222.1518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439197.8795; train_optim_loss: 439197.8795; val_kl_reg_loss: 5795.8311; val_edge_recon_loss: 260768.4375; val_cond_contrastive_loss: 78400.1094; val_gene_expr_recon_loss: 90818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435782.3750; val_optim_loss: 435782.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9844; val_auprc_score: 0.9811; val_best_acc_score: 0.9441; val_best_f1_score: 0.9455; train_kl_reg_loss: 5861.7685; train_edge_recon_loss: 261893.7500; train_cond_contrastive_loss: 78738.0625; train_gene_expr_recon_loss: 91729.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438223.2009; train_optim_loss: 438223.2009; val_kl_reg_loss: 5761.6406; val_edge_recon_loss: 262390.5625; val_cond_contrastive_loss: 78395.5391; val_gene_expr_recon_loss: 90585.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437132.9375; val_optim_loss: 437132.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9849; val_auprc_score: 0.9812; val_best_acc_score: 0.9463; val_best_f1_score: 0.9480; train_kl_reg_loss: 5852.1535; train_edge_recon_loss: 260729.0469; train_cond_contrastive_loss: 78745.3058; train_gene_expr_recon_loss: 91322.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436648.9241; train_optim_loss: 436648.9241; val_kl_reg_loss: 5744.7920; val_edge_recon_loss: 259218.5156; val_cond_contrastive_loss: 78394.4688; val_gene_expr_recon_loss: 90335.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433692.9688; val_optim_loss: 433692.9688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9862; val_auprc_score: 0.9806; val_best_acc_score: 0.9471; val_best_f1_score: 0.9485; train_kl_reg_loss: 5810.0884; train_edge_recon_loss: 260405.5781; train_cond_contrastive_loss: 78757.2411; train_gene_expr_recon_loss: 91094.6629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436067.5893; train_optim_loss: 436067.5893; val_kl_reg_loss: 5737.7314; val_edge_recon_loss: 259673.0312; val_cond_contrastive_loss: 78394.0234; val_gene_expr_recon_loss: 90097.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433902.3125; val_optim_loss: 433902.3125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9855; val_auprc_score: 0.9793; val_best_acc_score: 0.9464; val_best_f1_score: 0.9478; train_kl_reg_loss: 5833.5545; train_edge_recon_loss: 260036.9107; train_cond_contrastive_loss: 78751.4353; train_gene_expr_recon_loss: 90957.1618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435579.0580; train_optim_loss: 435579.0580; val_kl_reg_loss: 5703.2773; val_edge_recon_loss: 260562.8125; val_cond_contrastive_loss: 78393.7656; val_gene_expr_recon_loss: 89876.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434536.3750; val_optim_loss: 434536.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9872; val_auprc_score: 0.9841; val_best_acc_score: 0.9524; val_best_f1_score: 0.9537; train_kl_reg_loss: 5791.7693; train_edge_recon_loss: 259924.4888; train_cond_contrastive_loss: 78753.4353; train_gene_expr_recon_loss: 90588.0926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435057.7812; train_optim_loss: 435057.7812; val_kl_reg_loss: 5736.4497; val_edge_recon_loss: 260054.9219; val_cond_contrastive_loss: 78393.5391; val_gene_expr_recon_loss: 89663.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433847.9375; val_optim_loss: 433847.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9871; val_auprc_score: 0.9812; val_best_acc_score: 0.9537; val_best_f1_score: 0.9550; train_kl_reg_loss: 5823.5386; train_edge_recon_loss: 260264.5379; train_cond_contrastive_loss: 78746.1417; train_gene_expr_recon_loss: 90393.3560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435227.5670; train_optim_loss: 435227.5670; val_kl_reg_loss: 5733.1533; val_edge_recon_loss: 257010.9062; val_cond_contrastive_loss: 78393.9453; val_gene_expr_recon_loss: 89628.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430766.4375; val_optim_loss: 430766.4375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9868; val_auprc_score: 0.9816; val_best_acc_score: 0.9500; val_best_f1_score: 0.9513; train_kl_reg_loss: 5817.9738; train_edge_recon_loss: 259125.2321; train_cond_contrastive_loss: 78745.1908; train_gene_expr_recon_loss: 90340.6295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434029.0268; train_optim_loss: 434029.0268; val_kl_reg_loss: 5720.1777; val_edge_recon_loss: 259969.8594; val_cond_contrastive_loss: 78393.9531; val_gene_expr_recon_loss: 89599.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433683.2500; val_optim_loss: 433683.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9875; val_auprc_score: 0.9832; val_best_acc_score: 0.9527; val_best_f1_score: 0.9539; train_kl_reg_loss: 5807.5574; train_edge_recon_loss: 259168.4107; train_cond_contrastive_loss: 78750.2121; train_gene_expr_recon_loss: 90371.9754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434098.1607; train_optim_loss: 434098.1607; val_kl_reg_loss: 5701.9570; val_edge_recon_loss: 258527.4219; val_cond_contrastive_loss: 78393.7109; val_gene_expr_recon_loss: 89574.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432197.8438; val_optim_loss: 432197.8438
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9884; val_auprc_score: 0.9853; val_best_acc_score: 0.9544; val_best_f1_score: 0.9554; train_kl_reg_loss: 5803.3659; train_edge_recon_loss: 259465.7009; train_cond_contrastive_loss: 78747.4554; train_gene_expr_recon_loss: 90156.9833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434173.5045; train_optim_loss: 434173.5045; val_kl_reg_loss: 5701.7856; val_edge_recon_loss: 259181.4062; val_cond_contrastive_loss: 78393.7344; val_gene_expr_recon_loss: 89549.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432826.1562; val_optim_loss: 432826.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9876; val_auprc_score: 0.9828; val_best_acc_score: 0.9539; val_best_f1_score: 0.9546; train_kl_reg_loss: 5808.2648; train_edge_recon_loss: 259503.1295; train_cond_contrastive_loss: 78748.5848; train_gene_expr_recon_loss: 90680.0502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434740.0268; train_optim_loss: 434740.0268; val_kl_reg_loss: 5700.6406; val_edge_recon_loss: 260086.9844; val_cond_contrastive_loss: 78393.5469; val_gene_expr_recon_loss: 89546.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433727.5625; val_optim_loss: 433727.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9883; val_auprc_score: 0.9861; val_best_acc_score: 0.9528; val_best_f1_score: 0.9535; train_kl_reg_loss: 5800.9692; train_edge_recon_loss: 258919.0112; train_cond_contrastive_loss: 78749.2087; train_gene_expr_recon_loss: 90589.4565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434058.6473; train_optim_loss: 434058.6473; val_kl_reg_loss: 5698.2773; val_edge_recon_loss: 260074.3438; val_cond_contrastive_loss: 78393.7031; val_gene_expr_recon_loss: 89543.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433709.6562; val_optim_loss: 433709.6562
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9873; val_auprc_score: 0.9834; val_best_acc_score: 0.9533; val_best_f1_score: 0.9545; train_kl_reg_loss: 5799.2021; train_edge_recon_loss: 260010.8393; train_cond_contrastive_loss: 78747.3661; train_gene_expr_recon_loss: 90569.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435127.1607; train_optim_loss: 435127.1607; val_kl_reg_loss: 5695.9727; val_edge_recon_loss: 258939.5625; val_cond_contrastive_loss: 78393.8125; val_gene_expr_recon_loss: 89540.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432569.6562; val_optim_loss: 432569.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 3 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9862
Val AUPRC score: 0.9814
Val best accuracy score: 0.9479
Val best F1 score: 0.9487
Val gene expr MSE score: 1.3664
Duration of model training in run 7: 0 hours, 2 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7793; val_auprc_score: 0.8155; val_best_acc_score: 0.7047; val_best_f1_score: 0.7141; train_kl_reg_loss: 5106.5984; train_edge_recon_loss: 357420.9107; train_cond_contrastive_loss: 105119.6897; train_gene_expr_recon_loss: 117981.3192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 585628.5089; train_optim_loss: 585628.5089; val_kl_reg_loss: 10571.0977; val_edge_recon_loss: 398130.8125; val_cond_contrastive_loss: 78337.6094; val_gene_expr_recon_loss: 100333.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 587372.5625; val_optim_loss: 587372.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7354; val_auprc_score: 0.7633; val_best_acc_score: 0.6526; val_best_f1_score: 0.7104; train_kl_reg_loss: 6696.4316; train_edge_recon_loss: 355934.0357; train_cond_contrastive_loss: 87082.0391; train_gene_expr_recon_loss: 100370.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550082.9107; train_optim_loss: 550082.9107; val_kl_reg_loss: 4584.1211; val_edge_recon_loss: 374144.0312; val_cond_contrastive_loss: 78388.1562; val_gene_expr_recon_loss: 98106.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555223.3125; val_optim_loss: 555223.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7303; val_auprc_score: 0.7591; val_best_acc_score: 0.6606; val_best_f1_score: 0.7048; train_kl_reg_loss: 3961.4196; train_edge_recon_loss: 339349.3839; train_cond_contrastive_loss: 89133.5681; train_gene_expr_recon_loss: 99025.8404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531470.2009; train_optim_loss: 531470.2009; val_kl_reg_loss: 3640.1787; val_edge_recon_loss: 330197.4688; val_cond_contrastive_loss: 78371.1172; val_gene_expr_recon_loss: 97345.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509554.1875; val_optim_loss: 509554.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7745; val_auprc_score: 0.7898; val_best_acc_score: 0.6916; val_best_f1_score: 0.7222; train_kl_reg_loss: 4343.2598; train_edge_recon_loss: 317624.5089; train_cond_contrastive_loss: 80908.2779; train_gene_expr_recon_loss: 98089.7467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500965.7991; train_optim_loss: 500965.7991; val_kl_reg_loss: 5110.1665; val_edge_recon_loss: 309345.4688; val_cond_contrastive_loss: 78359.7812; val_gene_expr_recon_loss: 96583.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489398.5000; val_optim_loss: 489398.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8357; val_auprc_score: 0.8305; val_best_acc_score: 0.7512; val_best_f1_score: 0.7797; train_kl_reg_loss: 5659.4742; train_edge_recon_loss: 297397.3170; train_cond_contrastive_loss: 78794.9587; train_gene_expr_recon_loss: 97359.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479210.9107; train_optim_loss: 479210.9107; val_kl_reg_loss: 6252.5723; val_edge_recon_loss: 287185.4062; val_cond_contrastive_loss: 78385.5312; val_gene_expr_recon_loss: 95708.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467531.5625; val_optim_loss: 467531.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8618; val_auprc_score: 0.8429; val_best_acc_score: 0.7801; val_best_f1_score: 0.8061; train_kl_reg_loss: 6548.8949; train_edge_recon_loss: 283166.8973; train_cond_contrastive_loss: 78713.2667; train_gene_expr_recon_loss: 96453.5201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464882.5714; train_optim_loss: 464882.5714; val_kl_reg_loss: 6621.3643; val_edge_recon_loss: 281007.7812; val_cond_contrastive_loss: 78388.6172; val_gene_expr_recon_loss: 94935.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460953.5625; val_optim_loss: 460953.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8790; val_auprc_score: 0.8597; val_best_acc_score: 0.8064; val_best_f1_score: 0.8275; train_kl_reg_loss: 6533.2912; train_edge_recon_loss: 278356.5446; train_cond_contrastive_loss: 78865.9464; train_gene_expr_recon_loss: 95844.0033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459599.7812; train_optim_loss: 459599.7812; val_kl_reg_loss: 6408.0684; val_edge_recon_loss: 276209.9062; val_cond_contrastive_loss: 78390.3359; val_gene_expr_recon_loss: 94284.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455292.5000; val_optim_loss: 455292.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9034; val_auprc_score: 0.8843; val_best_acc_score: 0.8359; val_best_f1_score: 0.8501; train_kl_reg_loss: 6411.5237; train_edge_recon_loss: 275412.8393; train_cond_contrastive_loss: 78961.4531; train_gene_expr_recon_loss: 95160.9208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455946.7366; train_optim_loss: 455946.7366; val_kl_reg_loss: 6350.6514; val_edge_recon_loss: 271346.4062; val_cond_contrastive_loss: 78401.9766; val_gene_expr_recon_loss: 93778.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449877.4688; val_optim_loss: 449877.4688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9214; val_auprc_score: 0.9086; val_best_acc_score: 0.8489; val_best_f1_score: 0.8606; train_kl_reg_loss: 6330.2693; train_edge_recon_loss: 271671.1518; train_cond_contrastive_loss: 79000.9944; train_gene_expr_recon_loss: 94805.5480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451807.9688; train_optim_loss: 451807.9688; val_kl_reg_loss: 6212.9736; val_edge_recon_loss: 270542.6562; val_cond_contrastive_loss: 78420.8906; val_gene_expr_recon_loss: 93342.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448519.4062; val_optim_loss: 448519.4062
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9392; val_auprc_score: 0.9292; val_best_acc_score: 0.8687; val_best_f1_score: 0.8776; train_kl_reg_loss: 6255.0630; train_edge_recon_loss: 270304.0759; train_cond_contrastive_loss: 78969.0089; train_gene_expr_recon_loss: 94272.3884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449800.5312; train_optim_loss: 449800.5312; val_kl_reg_loss: 6197.5972; val_edge_recon_loss: 267597.0938; val_cond_contrastive_loss: 78424.0625; val_gene_expr_recon_loss: 93029.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445248.6875; val_optim_loss: 445248.6875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9515; val_auprc_score: 0.9382; val_best_acc_score: 0.8925; val_best_f1_score: 0.8965; train_kl_reg_loss: 6246.7236; train_edge_recon_loss: 268017.9777; train_cond_contrastive_loss: 78852.4576; train_gene_expr_recon_loss: 94073.4018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447190.5670; train_optim_loss: 447190.5670; val_kl_reg_loss: 6230.9404; val_edge_recon_loss: 266000.7188; val_cond_contrastive_loss: 78416.8125; val_gene_expr_recon_loss: 92758.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443407.2500; val_optim_loss: 443407.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9564; val_auprc_score: 0.9451; val_best_acc_score: 0.8984; val_best_f1_score: 0.9030; train_kl_reg_loss: 6335.2889; train_edge_recon_loss: 267175.7009; train_cond_contrastive_loss: 78748.9833; train_gene_expr_recon_loss: 93736.4944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445996.4688; train_optim_loss: 445996.4688; val_kl_reg_loss: 6202.4473; val_edge_recon_loss: 265461.6562; val_cond_contrastive_loss: 78411.2656; val_gene_expr_recon_loss: 92488.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442563.5938; val_optim_loss: 442563.5938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9598; val_auprc_score: 0.9471; val_best_acc_score: 0.9059; val_best_f1_score: 0.9101; train_kl_reg_loss: 6190.0020; train_edge_recon_loss: 266737.6652; train_cond_contrastive_loss: 78742.0993; train_gene_expr_recon_loss: 93236.9475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444906.7188; train_optim_loss: 444906.7188; val_kl_reg_loss: 5999.9575; val_edge_recon_loss: 266264.5312; val_cond_contrastive_loss: 78410.4688; val_gene_expr_recon_loss: 92174.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442849.5000; val_optim_loss: 442849.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9707; val_auprc_score: 0.9667; val_best_acc_score: 0.9181; val_best_f1_score: 0.9214; train_kl_reg_loss: 5961.5300; train_edge_recon_loss: 266072.5759; train_cond_contrastive_loss: 78754.2243; train_gene_expr_recon_loss: 92785.0636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443573.4018; train_optim_loss: 443573.4018; val_kl_reg_loss: 5884.2793; val_edge_recon_loss: 263852.9688; val_cond_contrastive_loss: 78413.7109; val_gene_expr_recon_loss: 91877.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440028.0625; val_optim_loss: 440028.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9751; val_auprc_score: 0.9693; val_best_acc_score: 0.9274; val_best_f1_score: 0.9301; train_kl_reg_loss: 5917.7554; train_edge_recon_loss: 264749.7902; train_cond_contrastive_loss: 78724.3449; train_gene_expr_recon_loss: 92668.8839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442060.7723; train_optim_loss: 442060.7723; val_kl_reg_loss: 5780.2754; val_edge_recon_loss: 261932.5156; val_cond_contrastive_loss: 78416.3438; val_gene_expr_recon_loss: 91595.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437724.4375; val_optim_loss: 437724.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9800; val_auprc_score: 0.9759; val_best_acc_score: 0.9386; val_best_f1_score: 0.9403; train_kl_reg_loss: 5823.3857; train_edge_recon_loss: 264030.8929; train_cond_contrastive_loss: 78719.5123; train_gene_expr_recon_loss: 92511.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441085.6786; train_optim_loss: 441085.6786; val_kl_reg_loss: 5818.9619; val_edge_recon_loss: 260285.6406; val_cond_contrastive_loss: 78412.4219; val_gene_expr_recon_loss: 91353.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435870.8438; val_optim_loss: 435870.8438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9808; val_auprc_score: 0.9758; val_best_acc_score: 0.9365; val_best_f1_score: 0.9382; train_kl_reg_loss: 5851.5315; train_edge_recon_loss: 262863.1763; train_cond_contrastive_loss: 78710.6083; train_gene_expr_recon_loss: 92329.0022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439754.3125; train_optim_loss: 439754.3125; val_kl_reg_loss: 5771.0454; val_edge_recon_loss: 260819.5781; val_cond_contrastive_loss: 78409.1406; val_gene_expr_recon_loss: 91115.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436115.5000; val_optim_loss: 436115.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9823; val_auprc_score: 0.9781; val_best_acc_score: 0.9420; val_best_f1_score: 0.9432; train_kl_reg_loss: 5824.2150; train_edge_recon_loss: 262570.1518; train_cond_contrastive_loss: 78716.3304; train_gene_expr_recon_loss: 92164.9308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439275.6339; train_optim_loss: 439275.6339; val_kl_reg_loss: 5746.3857; val_edge_recon_loss: 263047.5625; val_cond_contrastive_loss: 78404.4922; val_gene_expr_recon_loss: 90854.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438052.6875; val_optim_loss: 438052.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9858; val_auprc_score: 0.9834; val_best_acc_score: 0.9454; val_best_f1_score: 0.9470; train_kl_reg_loss: 5809.9999; train_edge_recon_loss: 262215.3929; train_cond_contrastive_loss: 78720.5000; train_gene_expr_recon_loss: 91885.0748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438630.9688; train_optim_loss: 438630.9688; val_kl_reg_loss: 5746.0039; val_edge_recon_loss: 257398.4531; val_cond_contrastive_loss: 78403.4297; val_gene_expr_recon_loss: 90614.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432162.7188; val_optim_loss: 432162.7188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9842; val_auprc_score: 0.9796; val_best_acc_score: 0.9469; val_best_f1_score: 0.9483; train_kl_reg_loss: 5780.4942; train_edge_recon_loss: 261229.8996; train_cond_contrastive_loss: 78732.7165; train_gene_expr_recon_loss: 91765.7299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437508.8348; train_optim_loss: 437508.8348; val_kl_reg_loss: 5717.8447; val_edge_recon_loss: 259067.5312; val_cond_contrastive_loss: 78403.5781; val_gene_expr_recon_loss: 90372.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433561.2812; val_optim_loss: 433561.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9875; val_auprc_score: 0.9847; val_best_acc_score: 0.9507; val_best_f1_score: 0.9524; train_kl_reg_loss: 5791.1108; train_edge_recon_loss: 260241.9420; train_cond_contrastive_loss: 78722.7946; train_gene_expr_recon_loss: 91138.6261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435894.4688; train_optim_loss: 435894.4688; val_kl_reg_loss: 5736.7178; val_edge_recon_loss: 256912.7969; val_cond_contrastive_loss: 78405.1250; val_gene_expr_recon_loss: 90160.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431214.8125; val_optim_loss: 431214.8125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9879; val_auprc_score: 0.9836; val_best_acc_score: 0.9529; val_best_f1_score: 0.9543; train_kl_reg_loss: 5766.2141; train_edge_recon_loss: 260559.6920; train_cond_contrastive_loss: 78725.3382; train_gene_expr_recon_loss: 90832.8393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435884.0848; train_optim_loss: 435884.0848; val_kl_reg_loss: 5715.8330; val_edge_recon_loss: 257290.2812; val_cond_contrastive_loss: 78405.1875; val_gene_expr_recon_loss: 89939.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431351.1562; val_optim_loss: 431351.1562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9864; val_auprc_score: 0.9824; val_best_acc_score: 0.9495; val_best_f1_score: 0.9506; train_kl_reg_loss: 5796.4622; train_edge_recon_loss: 258800.5357; train_cond_contrastive_loss: 78721.7400; train_gene_expr_recon_loss: 90948.8817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434267.6161; train_optim_loss: 434267.6161; val_kl_reg_loss: 5684.2900; val_edge_recon_loss: 258037.6250; val_cond_contrastive_loss: 78404.0156; val_gene_expr_recon_loss: 89687.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431813.2500; val_optim_loss: 431813.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9878; val_auprc_score: 0.9849; val_best_acc_score: 0.9522; val_best_f1_score: 0.9536; train_kl_reg_loss: 5745.0735; train_edge_recon_loss: 258865.7924; train_cond_contrastive_loss: 78727.2958; train_gene_expr_recon_loss: 90634.4442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433972.6116; train_optim_loss: 433972.6116; val_kl_reg_loss: 5727.9951; val_edge_recon_loss: 258601.6406; val_cond_contrastive_loss: 78404.6172; val_gene_expr_recon_loss: 89465.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432199.7812; val_optim_loss: 432199.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9888; val_auprc_score: 0.9845; val_best_acc_score: 0.9543; val_best_f1_score: 0.9555; train_kl_reg_loss: 5793.0017; train_edge_recon_loss: 259411.1607; train_cond_contrastive_loss: 78721.7645; train_gene_expr_recon_loss: 90459.6808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434385.6027; train_optim_loss: 434385.6027; val_kl_reg_loss: 5738.1807; val_edge_recon_loss: 255687.7500; val_cond_contrastive_loss: 78405.0078; val_gene_expr_recon_loss: 89433.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429264.3750; val_optim_loss: 429264.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9886; val_auprc_score: 0.9864; val_best_acc_score: 0.9524; val_best_f1_score: 0.9539; train_kl_reg_loss: 5779.4063; train_edge_recon_loss: 258733.8750; train_cond_contrastive_loss: 78720.8337; train_gene_expr_recon_loss: 90235.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433469.2679; train_optim_loss: 433469.2679; val_kl_reg_loss: 5698.1167; val_edge_recon_loss: 257866.4688; val_cond_contrastive_loss: 78404.7578; val_gene_expr_recon_loss: 89404.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431374.0312; val_optim_loss: 431374.0312
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9898; val_auprc_score: 0.9874; val_best_acc_score: 0.9557; val_best_f1_score: 0.9570; train_kl_reg_loss: 5760.5771; train_edge_recon_loss: 259078.2991; train_cond_contrastive_loss: 78726.7098; train_gene_expr_recon_loss: 90386.3560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433951.9420; train_optim_loss: 433951.9420; val_kl_reg_loss: 5687.9678; val_edge_recon_loss: 256297.2031; val_cond_contrastive_loss: 78404.8047; val_gene_expr_recon_loss: 89379.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429769.1875; val_optim_loss: 429769.1875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9884; val_auprc_score: 0.9828; val_best_acc_score: 0.9524; val_best_f1_score: 0.9536; train_kl_reg_loss: 5753.0241; train_edge_recon_loss: 258890.6362; train_cond_contrastive_loss: 78722.2969; train_gene_expr_recon_loss: 90404.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433770.2500; train_optim_loss: 433770.2500; val_kl_reg_loss: 5684.3945; val_edge_recon_loss: 260019.6250; val_cond_contrastive_loss: 78404.5000; val_gene_expr_recon_loss: 89355.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433463.8125; val_optim_loss: 433463.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9880; val_auprc_score: 0.9850; val_best_acc_score: 0.9535; val_best_f1_score: 0.9551; train_kl_reg_loss: 5746.2174; train_edge_recon_loss: 259517.3750; train_cond_contrastive_loss: 78721.6562; train_gene_expr_recon_loss: 90245.9955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434231.2411; train_optim_loss: 434231.2411; val_kl_reg_loss: 5677.0879; val_edge_recon_loss: 256141.2812; val_cond_contrastive_loss: 78404.8906; val_gene_expr_recon_loss: 89352.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429575.6562; val_optim_loss: 429575.6562
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9894; val_auprc_score: 0.9868; val_best_acc_score: 0.9550; val_best_f1_score: 0.9565; train_kl_reg_loss: 5745.5972; train_edge_recon_loss: 259241.3036; train_cond_contrastive_loss: 78724.5446; train_gene_expr_recon_loss: 90436.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434147.4955; train_optim_loss: 434147.4955; val_kl_reg_loss: 5673.9507; val_edge_recon_loss: 253112.2812; val_cond_contrastive_loss: 78404.9062; val_gene_expr_recon_loss: 89349.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426541.0000; val_optim_loss: 426541.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9891; val_auprc_score: 0.9869; val_best_acc_score: 0.9535; val_best_f1_score: 0.9543; train_kl_reg_loss: 5742.5449; train_edge_recon_loss: 258067.4040; train_cond_contrastive_loss: 78726.5569; train_gene_expr_recon_loss: 90373.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432909.7902; train_optim_loss: 432909.7902; val_kl_reg_loss: 5674.0488; val_edge_recon_loss: 257513.5469; val_cond_contrastive_loss: 78404.4531; val_gene_expr_recon_loss: 89347.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430939.4062; val_optim_loss: 430939.4062
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9887; val_auprc_score: 0.9863; val_best_acc_score: 0.9545; val_best_f1_score: 0.9556; train_kl_reg_loss: 5739.4121; train_edge_recon_loss: 259061.0670; train_cond_contrastive_loss: 78726.5257; train_gene_expr_recon_loss: 90268.4308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433795.4286; train_optim_loss: 433795.4286; val_kl_reg_loss: 5674.6943; val_edge_recon_loss: 256297.7656; val_cond_contrastive_loss: 78405.1719; val_gene_expr_recon_loss: 89344.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429722.4375; val_optim_loss: 429722.4375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9900; val_auprc_score: 0.9884; val_best_acc_score: 0.9555; val_best_f1_score: 0.9562; train_kl_reg_loss: 5742.8188; train_edge_recon_loss: 259241.5312; train_cond_contrastive_loss: 78726.2868; train_gene_expr_recon_loss: 90232.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433943.3304; train_optim_loss: 433943.3304; val_kl_reg_loss: 5673.0176; val_edge_recon_loss: 259709.7812; val_cond_contrastive_loss: 78404.6953; val_gene_expr_recon_loss: 89342.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433130.1562; val_optim_loss: 433130.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9886; val_auprc_score: 0.9858; val_best_acc_score: 0.9529; val_best_f1_score: 0.9542; train_kl_reg_loss: 5739.3396; train_edge_recon_loss: 258053.2723; train_cond_contrastive_loss: 78726.6685; train_gene_expr_recon_loss: 90331.1105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432850.3795; train_optim_loss: 432850.3795; val_kl_reg_loss: 5672.5337; val_edge_recon_loss: 258277.5625; val_cond_contrastive_loss: 78404.8281; val_gene_expr_recon_loss: 89342.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431697.3438; val_optim_loss: 431697.3438
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9886; val_auprc_score: 0.9848; val_best_acc_score: 0.9524; val_best_f1_score: 0.9541; train_kl_reg_loss: 5749.3012; train_edge_recon_loss: 259479.3705; train_cond_contrastive_loss: 78725.7154; train_gene_expr_recon_loss: 90239.9699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434194.3661; train_optim_loss: 434194.3661; val_kl_reg_loss: 5673.9009; val_edge_recon_loss: 254891.5469; val_cond_contrastive_loss: 78404.9844; val_gene_expr_recon_loss: 89342.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428312.5938; val_optim_loss: 428312.5938
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9873; val_auprc_score: 0.9835; val_best_acc_score: 0.9505; val_best_f1_score: 0.9519; train_kl_reg_loss: 5739.4018; train_edge_recon_loss: 259938.7567; train_cond_contrastive_loss: 78726.2054; train_gene_expr_recon_loss: 89916.7254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434321.0938; train_optim_loss: 434321.0938; val_kl_reg_loss: 5670.7524; val_edge_recon_loss: 258904.3438; val_cond_contrastive_loss: 78404.3906; val_gene_expr_recon_loss: 89341.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432321.3750; val_optim_loss: 432321.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 31 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9877
Val AUPRC score: 0.9839
Val best accuracy score: 0.9524
Val best F1 score: 0.9537
Val gene expr MSE score: 1.3307
Duration of model training in run 8: 0 hours, 2 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7496; val_auprc_score: 0.7750; val_best_acc_score: 0.6554; val_best_f1_score: 0.7138; train_kl_reg_loss: 5567.4699; train_edge_recon_loss: 358644.2917; train_cond_contrastive_loss: 96519.5885; train_gene_expr_recon_loss: 113438.9601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 574170.3056; train_optim_loss: 574170.3056; val_kl_reg_loss: 3377.9678; val_edge_recon_loss: 393602.8125; val_cond_contrastive_loss: 78339.1406; val_gene_expr_recon_loss: 99735.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575055.1875; val_optim_loss: 575055.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7251; val_auprc_score: 0.7429; val_best_acc_score: 0.6458; val_best_f1_score: 0.7050; train_kl_reg_loss: 3469.3184; train_edge_recon_loss: 348257.5938; train_cond_contrastive_loss: 89264.7682; train_gene_expr_recon_loss: 99383.3481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540375.0417; train_optim_loss: 540375.0417; val_kl_reg_loss: 2589.3054; val_edge_recon_loss: 346793.5625; val_cond_contrastive_loss: 78372.7969; val_gene_expr_recon_loss: 98652.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526408.2500; val_optim_loss: 526408.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7304; val_auprc_score: 0.7560; val_best_acc_score: 0.6569; val_best_f1_score: 0.7064; train_kl_reg_loss: 3150.9999; train_edge_recon_loss: 323773.4028; train_cond_contrastive_loss: 84846.6762; train_gene_expr_recon_loss: 98172.6207; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 509943.7014; train_optim_loss: 509943.7014; val_kl_reg_loss: 4158.4883; val_edge_recon_loss: 326151.3750; val_cond_contrastive_loss: 78336.0312; val_gene_expr_recon_loss: 97674.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 506320.2500; val_optim_loss: 506320.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7975; val_auprc_score: 0.7957; val_best_acc_score: 0.7116; val_best_f1_score: 0.7431; train_kl_reg_loss: 4686.3834; train_edge_recon_loss: 308875.6806; train_cond_contrastive_loss: 78912.8802; train_gene_expr_recon_loss: 97366.5217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489841.4722; train_optim_loss: 489841.4722; val_kl_reg_loss: 4962.2427; val_edge_recon_loss: 301455.7500; val_cond_contrastive_loss: 78342.9531; val_gene_expr_recon_loss: 96828.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481589.8125; val_optim_loss: 481589.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8451; val_auprc_score: 0.8269; val_best_acc_score: 0.7649; val_best_f1_score: 0.7923; train_kl_reg_loss: 5482.3815; train_edge_recon_loss: 288711.3854; train_cond_contrastive_loss: 78707.5764; train_gene_expr_recon_loss: 96405.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469307.1111; train_optim_loss: 469307.1111; val_kl_reg_loss: 5879.9795; val_edge_recon_loss: 285772.7812; val_cond_contrastive_loss: 78351.4141; val_gene_expr_recon_loss: 95840.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465844.5625; val_optim_loss: 465844.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8600; val_auprc_score: 0.8349; val_best_acc_score: 0.7820; val_best_f1_score: 0.8059; train_kl_reg_loss: 6196.1067; train_edge_recon_loss: 280090.1181; train_cond_contrastive_loss: 78810.3064; train_gene_expr_recon_loss: 95527.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460623.5590; train_optim_loss: 460623.5590; val_kl_reg_loss: 6058.2876; val_edge_recon_loss: 282263.7812; val_cond_contrastive_loss: 78351.0703; val_gene_expr_recon_loss: 95087.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461760.5312; val_optim_loss: 461760.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8769; val_auprc_score: 0.8529; val_best_acc_score: 0.8028; val_best_f1_score: 0.8222; train_kl_reg_loss: 6073.9952; train_edge_recon_loss: 277135.3333; train_cond_contrastive_loss: 79015.1207; train_gene_expr_recon_loss: 94858.0399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457082.4896; train_optim_loss: 457082.4896; val_kl_reg_loss: 6077.5693; val_edge_recon_loss: 277780.0312; val_cond_contrastive_loss: 78360.5703; val_gene_expr_recon_loss: 94549.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456768.0625; val_optim_loss: 456768.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8999; val_auprc_score: 0.8748; val_best_acc_score: 0.8310; val_best_f1_score: 0.8453; train_kl_reg_loss: 6287.5578; train_edge_recon_loss: 273451.5174; train_cond_contrastive_loss: 78967.1241; train_gene_expr_recon_loss: 94306.5816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453012.7812; train_optim_loss: 453012.7812; val_kl_reg_loss: 6252.4688; val_edge_recon_loss: 274529.4062; val_cond_contrastive_loss: 78375.5859; val_gene_expr_recon_loss: 94080.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453238.1875; val_optim_loss: 453238.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9266; val_auprc_score: 0.9096; val_best_acc_score: 0.8542; val_best_f1_score: 0.8652; train_kl_reg_loss: 6188.7190; train_edge_recon_loss: 271033.8611; train_cond_contrastive_loss: 78960.0512; train_gene_expr_recon_loss: 93810.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449993.3750; train_optim_loss: 449993.3750; val_kl_reg_loss: 5998.1777; val_edge_recon_loss: 273991.0312; val_cond_contrastive_loss: 78388.6016; val_gene_expr_recon_loss: 93457.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451834.8750; val_optim_loss: 451834.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9464; val_auprc_score: 0.9354; val_best_acc_score: 0.8816; val_best_f1_score: 0.8868; train_kl_reg_loss: 6105.0634; train_edge_recon_loss: 269244.9410; train_cond_contrastive_loss: 78880.8741; train_gene_expr_recon_loss: 93299.5373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447530.4167; train_optim_loss: 447530.4167; val_kl_reg_loss: 6093.2920; val_edge_recon_loss: 270685.9375; val_cond_contrastive_loss: 78392.4141; val_gene_expr_recon_loss: 92976.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448148.1875; val_optim_loss: 448148.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9573; val_auprc_score: 0.9464; val_best_acc_score: 0.9005; val_best_f1_score: 0.9051; train_kl_reg_loss: 6256.5467; train_edge_recon_loss: 266659.6701; train_cond_contrastive_loss: 78759.0885; train_gene_expr_recon_loss: 92789.2023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444464.5069; train_optim_loss: 444464.5069; val_kl_reg_loss: 6230.6338; val_edge_recon_loss: 265994.4062; val_cond_contrastive_loss: 78388.4531; val_gene_expr_recon_loss: 92587.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443200.8750; val_optim_loss: 443200.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9675; val_auprc_score: 0.9584; val_best_acc_score: 0.9166; val_best_f1_score: 0.9189; train_kl_reg_loss: 6202.5163; train_edge_recon_loss: 265162.4132; train_cond_contrastive_loss: 78749.1875; train_gene_expr_recon_loss: 92329.2274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442443.3438; train_optim_loss: 442443.3438; val_kl_reg_loss: 6057.4629; val_edge_recon_loss: 266404.6875; val_cond_contrastive_loss: 78388.8672; val_gene_expr_recon_loss: 92167.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443018.6875; val_optim_loss: 443018.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9754; val_auprc_score: 0.9696; val_best_acc_score: 0.9268; val_best_f1_score: 0.9280; train_kl_reg_loss: 6043.1016; train_edge_recon_loss: 263503.0000; train_cond_contrastive_loss: 78766.1892; train_gene_expr_recon_loss: 91802.1710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440114.4618; train_optim_loss: 440114.4618; val_kl_reg_loss: 5886.7461; val_edge_recon_loss: 265671.0000; val_cond_contrastive_loss: 78391.7266; val_gene_expr_recon_loss: 91739.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441688.6562; val_optim_loss: 441688.6562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9808; val_auprc_score: 0.9763; val_best_acc_score: 0.9358; val_best_f1_score: 0.9368; train_kl_reg_loss: 5942.7712; train_edge_recon_loss: 262626.7240; train_cond_contrastive_loss: 78778.0486; train_gene_expr_recon_loss: 91571.1571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438918.7014; train_optim_loss: 438918.7014; val_kl_reg_loss: 5856.1729; val_edge_recon_loss: 264998.8750; val_cond_contrastive_loss: 78393.0078; val_gene_expr_recon_loss: 91375.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440623.7500; val_optim_loss: 440623.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9828; val_auprc_score: 0.9792; val_best_acc_score: 0.9402; val_best_f1_score: 0.9409; train_kl_reg_loss: 5891.2966; train_edge_recon_loss: 262500.5104; train_cond_contrastive_loss: 78777.3698; train_gene_expr_recon_loss: 91228.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438397.9931; train_optim_loss: 438397.9931; val_kl_reg_loss: 5860.8535; val_edge_recon_loss: 265525.5000; val_cond_contrastive_loss: 78390.7188; val_gene_expr_recon_loss: 91058.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440835.3125; val_optim_loss: 440835.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9846; val_auprc_score: 0.9794; val_best_acc_score: 0.9438; val_best_f1_score: 0.9446; train_kl_reg_loss: 5850.5064; train_edge_recon_loss: 261048.1944; train_cond_contrastive_loss: 78758.1432; train_gene_expr_recon_loss: 90900.0582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436556.9028; train_optim_loss: 436556.9028; val_kl_reg_loss: 5784.3623; val_edge_recon_loss: 262860.3125; val_cond_contrastive_loss: 78389.6484; val_gene_expr_recon_loss: 90721.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437755.4375; val_optim_loss: 437755.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9868; val_auprc_score: 0.9836; val_best_acc_score: 0.9481; val_best_f1_score: 0.9490; train_kl_reg_loss: 5817.9305; train_edge_recon_loss: 260440.1476; train_cond_contrastive_loss: 78754.1354; train_gene_expr_recon_loss: 90535.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435547.2500; train_optim_loss: 435547.2500; val_kl_reg_loss: 5774.2642; val_edge_recon_loss: 261416.0156; val_cond_contrastive_loss: 78388.5000; val_gene_expr_recon_loss: 90394.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435973.3750; val_optim_loss: 435973.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9867; val_auprc_score: 0.9831; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 5784.5295; train_edge_recon_loss: 259611.1701; train_cond_contrastive_loss: 78770.8038; train_gene_expr_recon_loss: 90240.0469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434406.5486; train_optim_loss: 434406.5486; val_kl_reg_loss: 5721.6880; val_edge_recon_loss: 260672.5625; val_cond_contrastive_loss: 78387.4922; val_gene_expr_recon_loss: 90075.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434856.9688; val_optim_loss: 434856.9688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9883; val_auprc_score: 0.9863; val_best_acc_score: 0.9514; val_best_f1_score: 0.9525; train_kl_reg_loss: 5788.7510; train_edge_recon_loss: 259437.2378; train_cond_contrastive_loss: 78759.7734; train_gene_expr_recon_loss: 89892.5825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433878.3507; train_optim_loss: 433878.3507; val_kl_reg_loss: 5757.3057; val_edge_recon_loss: 260143.0469; val_cond_contrastive_loss: 78386.4219; val_gene_expr_recon_loss: 89777.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434063.9062; val_optim_loss: 434063.9062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9875; val_auprc_score: 0.9832; val_best_acc_score: 0.9535; val_best_f1_score: 0.9538; train_kl_reg_loss: 5776.3072; train_edge_recon_loss: 258805.2014; train_cond_contrastive_loss: 78739.5104; train_gene_expr_recon_loss: 89649.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432970.7326; train_optim_loss: 432970.7326; val_kl_reg_loss: 5705.5801; val_edge_recon_loss: 260471.7969; val_cond_contrastive_loss: 78386.7891; val_gene_expr_recon_loss: 89504.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434069.0625; val_optim_loss: 434069.0625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9887; val_auprc_score: 0.9848; val_best_acc_score: 0.9557; val_best_f1_score: 0.9565; train_kl_reg_loss: 5769.8797; train_edge_recon_loss: 258803.0729; train_cond_contrastive_loss: 78732.6623; train_gene_expr_recon_loss: 89382.7665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432688.3750; train_optim_loss: 432688.3750; val_kl_reg_loss: 5726.6558; val_edge_recon_loss: 260299.0625; val_cond_contrastive_loss: 78389.2734; val_gene_expr_recon_loss: 89233.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433648.3750; val_optim_loss: 433648.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9902; val_auprc_score: 0.9864; val_best_acc_score: 0.9603; val_best_f1_score: 0.9609; train_kl_reg_loss: 5741.7669; train_edge_recon_loss: 258546.2431; train_cond_contrastive_loss: 78730.4766; train_gene_expr_recon_loss: 89134.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432153.0972; train_optim_loss: 432153.0972; val_kl_reg_loss: 5694.7002; val_edge_recon_loss: 258482.4531; val_cond_contrastive_loss: 78391.5469; val_gene_expr_recon_loss: 88961.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431530.2500; val_optim_loss: 431530.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9910; val_auprc_score: 0.9883; val_best_acc_score: 0.9601; val_best_f1_score: 0.9611; train_kl_reg_loss: 5728.5218; train_edge_recon_loss: 258245.3073; train_cond_contrastive_loss: 78733.8941; train_gene_expr_recon_loss: 88837.2491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431544.9722; train_optim_loss: 431544.9722; val_kl_reg_loss: 5654.4121; val_edge_recon_loss: 257667.3906; val_cond_contrastive_loss: 78391.7422; val_gene_expr_recon_loss: 88709.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430423.3750; val_optim_loss: 430423.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9897; val_auprc_score: 0.9845; val_best_acc_score: 0.9588; val_best_f1_score: 0.9591; train_kl_reg_loss: 5701.6270; train_edge_recon_loss: 259260.4965; train_cond_contrastive_loss: 78723.7214; train_gene_expr_recon_loss: 88594.1163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432279.9688; train_optim_loss: 432279.9688; val_kl_reg_loss: 5668.4258; val_edge_recon_loss: 263515.4375; val_cond_contrastive_loss: 78392.3828; val_gene_expr_recon_loss: 88479.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436055.6562; val_optim_loss: 436055.6562
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9908; val_auprc_score: 0.9880; val_best_acc_score: 0.9622; val_best_f1_score: 0.9629; train_kl_reg_loss: 5714.5402; train_edge_recon_loss: 257776.1250; train_cond_contrastive_loss: 78720.4653; train_gene_expr_recon_loss: 88466.9905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430678.1181; train_optim_loss: 430678.1181; val_kl_reg_loss: 5660.9316; val_edge_recon_loss: 258712.0781; val_cond_contrastive_loss: 78395.7344; val_gene_expr_recon_loss: 88277.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431046.6562; val_optim_loss: 431046.6562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9918; val_auprc_score: 0.9886; val_best_acc_score: 0.9649; val_best_f1_score: 0.9653; train_kl_reg_loss: 5714.3849; train_edge_recon_loss: 257935.3872; train_cond_contrastive_loss: 78730.7708; train_gene_expr_recon_loss: 88157.6866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430538.2361; train_optim_loss: 430538.2361; val_kl_reg_loss: 5645.7832; val_edge_recon_loss: 257975.6094; val_cond_contrastive_loss: 78398.0312; val_gene_expr_recon_loss: 88082.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430102.0625; val_optim_loss: 430102.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9900; val_best_acc_score: 0.9656; val_best_f1_score: 0.9664; train_kl_reg_loss: 5698.8519; train_edge_recon_loss: 257111.5035; train_cond_contrastive_loss: 78747.8793; train_gene_expr_recon_loss: 87998.2648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429556.5000; train_optim_loss: 429556.5000; val_kl_reg_loss: 5667.8311; val_edge_recon_loss: 257408.3281; val_cond_contrastive_loss: 78400.1484; val_gene_expr_recon_loss: 87902.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429378.8750; val_optim_loss: 429378.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9886; val_best_acc_score: 0.9636; val_best_f1_score: 0.9644; train_kl_reg_loss: 5718.2514; train_edge_recon_loss: 257151.9080; train_cond_contrastive_loss: 78735.2752; train_gene_expr_recon_loss: 87831.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429436.8125; train_optim_loss: 429436.8125; val_kl_reg_loss: 5643.6748; val_edge_recon_loss: 258487.1406; val_cond_contrastive_loss: 78397.4922; val_gene_expr_recon_loss: 87714.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430243.2188; val_optim_loss: 430243.2188
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9914; val_auprc_score: 0.9882; val_best_acc_score: 0.9614; val_best_f1_score: 0.9626; train_kl_reg_loss: 5700.3893; train_edge_recon_loss: 257025.8958; train_cond_contrastive_loss: 78725.1484; train_gene_expr_recon_loss: 87670.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429121.6042; train_optim_loss: 429121.6042; val_kl_reg_loss: 5679.6113; val_edge_recon_loss: 256013.4531; val_cond_contrastive_loss: 78398.5312; val_gene_expr_recon_loss: 87550.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427641.9062; val_optim_loss: 427641.9062
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9925; val_auprc_score: 0.9901; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 5706.1799; train_edge_recon_loss: 257749.8507; train_cond_contrastive_loss: 78735.5981; train_gene_expr_recon_loss: 87444.5634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429636.1979; train_optim_loss: 429636.1979; val_kl_reg_loss: 5637.7202; val_edge_recon_loss: 258195.1562; val_cond_contrastive_loss: 78399.5078; val_gene_expr_recon_loss: 87391.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429623.9375; val_optim_loss: 429623.9375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9645; val_best_f1_score: 0.9654; train_kl_reg_loss: 5693.7684; train_edge_recon_loss: 256967.0486; train_cond_contrastive_loss: 78747.1528; train_gene_expr_recon_loss: 87314.6536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428722.6250; train_optim_loss: 428722.6250; val_kl_reg_loss: 5673.0620; val_edge_recon_loss: 257563.1094; val_cond_contrastive_loss: 78401.7109; val_gene_expr_recon_loss: 87249.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428887.0938; val_optim_loss: 428887.0938
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9922; val_auprc_score: 0.9901; val_best_acc_score: 0.9647; val_best_f1_score: 0.9654; train_kl_reg_loss: 5697.6298; train_edge_recon_loss: 256776.1510; train_cond_contrastive_loss: 78738.0738; train_gene_expr_recon_loss: 87256.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428468.1181; train_optim_loss: 428468.1181; val_kl_reg_loss: 5617.1401; val_edge_recon_loss: 259592.2969; val_cond_contrastive_loss: 78402.2891; val_gene_expr_recon_loss: 87100.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430712.6875; val_optim_loss: 430712.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9927; val_auprc_score: 0.9898; val_best_acc_score: 0.9657; val_best_f1_score: 0.9663; train_kl_reg_loss: 5667.9016; train_edge_recon_loss: 256220.4983; train_cond_contrastive_loss: 78736.3151; train_gene_expr_recon_loss: 87104.1997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427728.9167; train_optim_loss: 427728.9167; val_kl_reg_loss: 5628.0156; val_edge_recon_loss: 258920.0156; val_cond_contrastive_loss: 78402.6250; val_gene_expr_recon_loss: 87062.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430013.2500; val_optim_loss: 430013.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9939; val_auprc_score: 0.9910; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 5685.9696; train_edge_recon_loss: 257003.5035; train_cond_contrastive_loss: 78727.9809; train_gene_expr_recon_loss: 87050.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428468.4375; train_optim_loss: 428468.4375; val_kl_reg_loss: 5629.0059; val_edge_recon_loss: 257722.2812; val_cond_contrastive_loss: 78402.5703; val_gene_expr_recon_loss: 87038.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428792.2812; val_optim_loss: 428792.2812
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9923; val_auprc_score: 0.9894; val_best_acc_score: 0.9664; val_best_f1_score: 0.9671; train_kl_reg_loss: 5671.8370; train_edge_recon_loss: 256617.2708; train_cond_contrastive_loss: 78734.5191; train_gene_expr_recon_loss: 87029.1285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428052.7604; train_optim_loss: 428052.7604; val_kl_reg_loss: 5623.9209; val_edge_recon_loss: 257461.5781; val_cond_contrastive_loss: 78403.1562; val_gene_expr_recon_loss: 87023.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428512.0000; val_optim_loss: 428512.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 10 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9925
Val AUPRC score: 0.9901
Val best accuracy score: 0.9635
Val best F1 score: 0.9642
Val gene expr MSE score: 1.3133
Duration of model training in run 9: 0 hours, 3 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7905; val_auprc_score: 0.8260; val_best_acc_score: 0.7093; val_best_f1_score: 0.7179; train_kl_reg_loss: 6674.7545; train_edge_recon_loss: 356170.1910; train_cond_contrastive_loss: 102419.0434; train_gene_expr_recon_loss: 116109.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 581373.4792; train_optim_loss: 581373.4792; val_kl_reg_loss: 7104.3809; val_edge_recon_loss: 395520.7500; val_cond_contrastive_loss: 78330.9375; val_gene_expr_recon_loss: 99784.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 580740.1250; val_optim_loss: 580740.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7544; val_auprc_score: 0.7752; val_best_acc_score: 0.6658; val_best_f1_score: 0.7219; train_kl_reg_loss: 6160.7239; train_edge_recon_loss: 352756.2743; train_cond_contrastive_loss: 86925.5208; train_gene_expr_recon_loss: 100012.6892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545855.2222; train_optim_loss: 545855.2222; val_kl_reg_loss: 3645.9082; val_edge_recon_loss: 357877.1250; val_cond_contrastive_loss: 78385.8906; val_gene_expr_recon_loss: 97763.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537672.8125; val_optim_loss: 537672.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7640; val_auprc_score: 0.7887; val_best_acc_score: 0.6803; val_best_f1_score: 0.7221; train_kl_reg_loss: 3737.1607; train_edge_recon_loss: 328446.7361; train_cond_contrastive_loss: 86752.9184; train_gene_expr_recon_loss: 98614.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517551.4514; train_optim_loss: 517551.4514; val_kl_reg_loss: 4642.7881; val_edge_recon_loss: 311437.6875; val_cond_contrastive_loss: 78350.9766; val_gene_expr_recon_loss: 96872.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491304.1250; val_optim_loss: 491304.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8393; val_auprc_score: 0.8366; val_best_acc_score: 0.7528; val_best_f1_score: 0.7826; train_kl_reg_loss: 5694.7724; train_edge_recon_loss: 302624.3229; train_cond_contrastive_loss: 79053.6302; train_gene_expr_recon_loss: 97655.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485028.3889; train_optim_loss: 485028.3889; val_kl_reg_loss: 6751.8809; val_edge_recon_loss: 284214.4688; val_cond_contrastive_loss: 78362.4688; val_gene_expr_recon_loss: 95896.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465225.0625; val_optim_loss: 465225.0625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8673; val_auprc_score: 0.8510; val_best_acc_score: 0.7849; val_best_f1_score: 0.8081; train_kl_reg_loss: 6930.0760; train_edge_recon_loss: 282759.8021; train_cond_contrastive_loss: 78654.6024; train_gene_expr_recon_loss: 96741.3967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465085.8715; train_optim_loss: 465085.8715; val_kl_reg_loss: 6632.8203; val_edge_recon_loss: 277849.1875; val_cond_contrastive_loss: 78361.2344; val_gene_expr_recon_loss: 94961.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457805.2500; val_optim_loss: 457805.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8829; val_auprc_score: 0.8624; val_best_acc_score: 0.8142; val_best_f1_score: 0.8338; train_kl_reg_loss: 6313.7329; train_edge_recon_loss: 279058.1111; train_cond_contrastive_loss: 78984.1771; train_gene_expr_recon_loss: 95927.4488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460283.4792; train_optim_loss: 460283.4792; val_kl_reg_loss: 6083.4297; val_edge_recon_loss: 272416.3438; val_cond_contrastive_loss: 78364.8516; val_gene_expr_recon_loss: 94290.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451155.0625; val_optim_loss: 451155.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9097; val_auprc_score: 0.8879; val_best_acc_score: 0.8445; val_best_f1_score: 0.8570; train_kl_reg_loss: 6239.6656; train_edge_recon_loss: 274487.8264; train_cond_contrastive_loss: 79026.4653; train_gene_expr_recon_loss: 95188.5825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454942.5451; train_optim_loss: 454942.5451; val_kl_reg_loss: 6265.8701; val_edge_recon_loss: 272774.0625; val_cond_contrastive_loss: 78379.7422; val_gene_expr_recon_loss: 93644.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451063.9688; val_optim_loss: 451063.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9446; val_auprc_score: 0.9352; val_best_acc_score: 0.8759; val_best_f1_score: 0.8839; train_kl_reg_loss: 6219.0880; train_edge_recon_loss: 270357.3090; train_cond_contrastive_loss: 79009.0365; train_gene_expr_recon_loss: 94692.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450277.8438; train_optim_loss: 450277.8438; val_kl_reg_loss: 6094.0698; val_edge_recon_loss: 264430.5312; val_cond_contrastive_loss: 78399.2344; val_gene_expr_recon_loss: 93093.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442017.4688; val_optim_loss: 442017.4688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9562; val_auprc_score: 0.9433; val_best_acc_score: 0.8981; val_best_f1_score: 0.9037; train_kl_reg_loss: 6130.2495; train_edge_recon_loss: 268318.6215; train_cond_contrastive_loss: 78909.7066; train_gene_expr_recon_loss: 94002.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447361.3611; train_optim_loss: 447361.3611; val_kl_reg_loss: 6118.1724; val_edge_recon_loss: 262028.6719; val_cond_contrastive_loss: 78401.3750; val_gene_expr_recon_loss: 92570.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439118.5938; val_optim_loss: 439118.5938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9651; val_auprc_score: 0.9550; val_best_acc_score: 0.9112; val_best_f1_score: 0.9159; train_kl_reg_loss: 6193.1306; train_edge_recon_loss: 266703.1771; train_cond_contrastive_loss: 78780.2144; train_gene_expr_recon_loss: 93589.9957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445266.5208; train_optim_loss: 445266.5208; val_kl_reg_loss: 6153.0645; val_edge_recon_loss: 262026.0781; val_cond_contrastive_loss: 78396.9297; val_gene_expr_recon_loss: 92024.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438600.5312; val_optim_loss: 438600.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9728; val_auprc_score: 0.9679; val_best_acc_score: 0.9217; val_best_f1_score: 0.9239; train_kl_reg_loss: 6165.1965; train_edge_recon_loss: 265021.6944; train_cond_contrastive_loss: 78753.3108; train_gene_expr_recon_loss: 92972.8845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442913.0799; train_optim_loss: 442913.0799; val_kl_reg_loss: 6020.1562; val_edge_recon_loss: 264039.5000; val_cond_contrastive_loss: 78398.5234; val_gene_expr_recon_loss: 91532.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439990.3125; val_optim_loss: 439990.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9767; val_auprc_score: 0.9712; val_best_acc_score: 0.9293; val_best_f1_score: 0.9313; train_kl_reg_loss: 6022.0300; train_edge_recon_loss: 263514.1094; train_cond_contrastive_loss: 78795.1250; train_gene_expr_recon_loss: 92490.3116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440821.5729; train_optim_loss: 440821.5729; val_kl_reg_loss: 5912.5869; val_edge_recon_loss: 263299.7188; val_cond_contrastive_loss: 78400.2422; val_gene_expr_recon_loss: 91108.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438720.6875; val_optim_loss: 438720.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9805; val_auprc_score: 0.9750; val_best_acc_score: 0.9350; val_best_f1_score: 0.9381; train_kl_reg_loss: 6001.6285; train_edge_recon_loss: 262672.0642; train_cond_contrastive_loss: 78784.1701; train_gene_expr_recon_loss: 92050.6927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439508.5521; train_optim_loss: 439508.5521; val_kl_reg_loss: 5919.8770; val_edge_recon_loss: 257943.9531; val_cond_contrastive_loss: 78398.4297; val_gene_expr_recon_loss: 90737.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432999.4688; val_optim_loss: 432999.4688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9839; val_auprc_score: 0.9790; val_best_acc_score: 0.9425; val_best_f1_score: 0.9445; train_kl_reg_loss: 5938.1004; train_edge_recon_loss: 262488.1059; train_cond_contrastive_loss: 78761.1467; train_gene_expr_recon_loss: 91781.4748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438968.8229; train_optim_loss: 438968.8229; val_kl_reg_loss: 5813.3789; val_edge_recon_loss: 259341.6562; val_cond_contrastive_loss: 78395.3359; val_gene_expr_recon_loss: 90391.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433941.7188; val_optim_loss: 433941.7188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9857; val_auprc_score: 0.9820; val_best_acc_score: 0.9470; val_best_f1_score: 0.9485; train_kl_reg_loss: 5877.6863; train_edge_recon_loss: 261746.0208; train_cond_contrastive_loss: 78737.7057; train_gene_expr_recon_loss: 91493.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437854.9028; train_optim_loss: 437854.9028; val_kl_reg_loss: 5782.5801; val_edge_recon_loss: 258304.9531; val_cond_contrastive_loss: 78394.0859; val_gene_expr_recon_loss: 90066.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432548.5625; val_optim_loss: 432548.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9848; val_auprc_score: 0.9811; val_best_acc_score: 0.9474; val_best_f1_score: 0.9489; train_kl_reg_loss: 5807.6740; train_edge_recon_loss: 260998.6354; train_cond_contrastive_loss: 78725.4392; train_gene_expr_recon_loss: 91094.7205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436626.4618; train_optim_loss: 436626.4618; val_kl_reg_loss: 5752.8843; val_edge_recon_loss: 259618.9688; val_cond_contrastive_loss: 78393.7422; val_gene_expr_recon_loss: 89779.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433544.9375; val_optim_loss: 433544.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9875; val_auprc_score: 0.9832; val_best_acc_score: 0.9512; val_best_f1_score: 0.9525; train_kl_reg_loss: 5801.6882; train_edge_recon_loss: 260566.0434; train_cond_contrastive_loss: 78713.3177; train_gene_expr_recon_loss: 90758.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435839.9583; train_optim_loss: 435839.9583; val_kl_reg_loss: 5720.3818; val_edge_recon_loss: 257429.7812; val_cond_contrastive_loss: 78393.3594; val_gene_expr_recon_loss: 89492.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431035.6562; val_optim_loss: 431035.6562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9882; val_auprc_score: 0.9858; val_best_acc_score: 0.9516; val_best_f1_score: 0.9528; train_kl_reg_loss: 5783.0754; train_edge_recon_loss: 260485.7500; train_cond_contrastive_loss: 78702.3672; train_gene_expr_recon_loss: 90485.5920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435456.7778; train_optim_loss: 435456.7778; val_kl_reg_loss: 5682.5503; val_edge_recon_loss: 257703.1875; val_cond_contrastive_loss: 78390.1328; val_gene_expr_recon_loss: 89167.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430943.0625; val_optim_loss: 430943.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9873; val_auprc_score: 0.9850; val_best_acc_score: 0.9490; val_best_f1_score: 0.9512; train_kl_reg_loss: 5755.5652; train_edge_recon_loss: 259919.1701; train_cond_contrastive_loss: 78705.7995; train_gene_expr_recon_loss: 90157.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434538.4861; train_optim_loss: 434538.4861; val_kl_reg_loss: 5722.5752; val_edge_recon_loss: 257272.7188; val_cond_contrastive_loss: 78388.9219; val_gene_expr_recon_loss: 88847.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430231.9062; val_optim_loss: 430231.9062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9889; val_auprc_score: 0.9859; val_best_acc_score: 0.9538; val_best_f1_score: 0.9554; train_kl_reg_loss: 5767.4127; train_edge_recon_loss: 259393.8316; train_cond_contrastive_loss: 78704.5148; train_gene_expr_recon_loss: 89867.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433732.8472; train_optim_loss: 433732.8472; val_kl_reg_loss: 5658.0908; val_edge_recon_loss: 256403.7188; val_cond_contrastive_loss: 78389.1016; val_gene_expr_recon_loss: 88603.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429054.0000; val_optim_loss: 429054.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9896; val_auprc_score: 0.9871; val_best_acc_score: 0.9567; val_best_f1_score: 0.9580; train_kl_reg_loss: 5743.4117; train_edge_recon_loss: 259379.0625; train_cond_contrastive_loss: 78701.8264; train_gene_expr_recon_loss: 89590.1727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433414.4722; train_optim_loss: 433414.4722; val_kl_reg_loss: 5693.2373; val_edge_recon_loss: 257914.6250; val_cond_contrastive_loss: 78391.0547; val_gene_expr_recon_loss: 88324.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430323.4688; val_optim_loss: 430323.4688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9901; val_auprc_score: 0.9877; val_best_acc_score: 0.9587; val_best_f1_score: 0.9600; train_kl_reg_loss: 5728.9268; train_edge_recon_loss: 259191.4861; train_cond_contrastive_loss: 78698.7839; train_gene_expr_recon_loss: 89353.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432972.6840; train_optim_loss: 432972.6840; val_kl_reg_loss: 5662.3203; val_edge_recon_loss: 256916.0781; val_cond_contrastive_loss: 78393.6016; val_gene_expr_recon_loss: 88073.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429045.8125; val_optim_loss: 429045.8125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9901; val_auprc_score: 0.9861; val_best_acc_score: 0.9581; val_best_f1_score: 0.9595; train_kl_reg_loss: 5730.9479; train_edge_recon_loss: 258836.0382; train_cond_contrastive_loss: 78703.3073; train_gene_expr_recon_loss: 89065.2023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432335.4965; train_optim_loss: 432335.4965; val_kl_reg_loss: 5636.2148; val_edge_recon_loss: 256471.2812; val_cond_contrastive_loss: 78395.5000; val_gene_expr_recon_loss: 87881.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428384.5625; val_optim_loss: 428384.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9912; val_auprc_score: 0.9873; val_best_acc_score: 0.9635; val_best_f1_score: 0.9650; train_kl_reg_loss: 5712.0211; train_edge_recon_loss: 259005.9965; train_cond_contrastive_loss: 78716.0182; train_gene_expr_recon_loss: 88950.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432384.8542; train_optim_loss: 432384.8542; val_kl_reg_loss: 5646.9062; val_edge_recon_loss: 252232.4844; val_cond_contrastive_loss: 78398.4922; val_gene_expr_recon_loss: 87647.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423925.6250; val_optim_loss: 423925.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9909; val_auprc_score: 0.9877; val_best_acc_score: 0.9603; val_best_f1_score: 0.9616; train_kl_reg_loss: 5703.4894; train_edge_recon_loss: 259000.3403; train_cond_contrastive_loss: 78730.3655; train_gene_expr_recon_loss: 88723.1181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432157.3160; train_optim_loss: 432157.3160; val_kl_reg_loss: 5648.3037; val_edge_recon_loss: 257169.9688; val_cond_contrastive_loss: 78398.8438; val_gene_expr_recon_loss: 87437.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428655.0625; val_optim_loss: 428655.0625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9916; val_auprc_score: 0.9855; val_best_acc_score: 0.9653; val_best_f1_score: 0.9664; train_kl_reg_loss: 5694.7210; train_edge_recon_loss: 258032.9757; train_cond_contrastive_loss: 78718.9141; train_gene_expr_recon_loss: 88548.5026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430995.1076; train_optim_loss: 430995.1076; val_kl_reg_loss: 5605.6445; val_edge_recon_loss: 254996.5156; val_cond_contrastive_loss: 78399.9297; val_gene_expr_recon_loss: 87257.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426260.0625; val_optim_loss: 426260.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9925; val_auprc_score: 0.9900; val_best_acc_score: 0.9657; val_best_f1_score: 0.9667; train_kl_reg_loss: 5679.5180; train_edge_recon_loss: 257432.7934; train_cond_contrastive_loss: 78714.2613; train_gene_expr_recon_loss: 88363.0686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430189.6354; train_optim_loss: 430189.6354; val_kl_reg_loss: 5580.6963; val_edge_recon_loss: 255301.4688; val_cond_contrastive_loss: 78400.9219; val_gene_expr_recon_loss: 87074.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426358.0625; val_optim_loss: 426358.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9911; val_auprc_score: 0.9848; val_best_acc_score: 0.9658; val_best_f1_score: 0.9668; train_kl_reg_loss: 5683.1914; train_edge_recon_loss: 257569.4358; train_cond_contrastive_loss: 78717.0243; train_gene_expr_recon_loss: 88209.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430179.4167; train_optim_loss: 430179.4167; val_kl_reg_loss: 5616.3145; val_edge_recon_loss: 254854.2656; val_cond_contrastive_loss: 78401.6250; val_gene_expr_recon_loss: 87047.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425919.6875; val_optim_loss: 425919.6875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9927; val_auprc_score: 0.9913; val_best_acc_score: 0.9674; val_best_f1_score: 0.9685; train_kl_reg_loss: 5676.6618; train_edge_recon_loss: 257391.4184; train_cond_contrastive_loss: 78720.0286; train_gene_expr_recon_loss: 88218.7274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430006.8333; train_optim_loss: 430006.8333; val_kl_reg_loss: 5597.6494; val_edge_recon_loss: 253364.2344; val_cond_contrastive_loss: 78401.2891; val_gene_expr_recon_loss: 87012.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424375.3438; val_optim_loss: 424375.3438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9916; val_auprc_score: 0.9887; val_best_acc_score: 0.9632; val_best_f1_score: 0.9645; train_kl_reg_loss: 5680.9092; train_edge_recon_loss: 256715.4010; train_cond_contrastive_loss: 78715.6406; train_gene_expr_recon_loss: 88087.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429199.6979; train_optim_loss: 429199.6979; val_kl_reg_loss: 5592.1514; val_edge_recon_loss: 254664.2500; val_cond_contrastive_loss: 78401.2422; val_gene_expr_recon_loss: 86997.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425654.7188; val_optim_loss: 425654.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 39 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9910
Val AUPRC score: 0.9875
Val best accuracy score: 0.9641
Val best F1 score: 0.9653
Val gene expr MSE score: 1.4214
Duration of model training in run 10: 0 hours, 2 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
