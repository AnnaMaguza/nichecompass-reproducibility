First script finished. Launching follow up script.
Run timestamp: 12062023_224818.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'nanostring_cosmx_human_nsclc_subsample_20pct', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1577.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 39550
Number of validation edges: 4394
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7537; val_auprc_score: 0.7656; val_best_acc_score: 0.6618; val_best_f1_score: 0.7141; train_kl_reg_loss: 195.6505; train_edge_recon_loss: 343815.0563; train_gene_expr_recon_loss: 119008.4633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463019.1750; train_optim_loss: 463019.1750; val_kl_reg_loss: 366.4570; val_edge_recon_loss: 357402.4844; val_gene_expr_recon_loss: 109939.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467708.5938; val_optim_loss: 467708.5938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7399; val_auprc_score: 0.7425; val_best_acc_score: 0.6660; val_best_f1_score: 0.7141; train_kl_reg_loss: 2395.2610; train_edge_recon_loss: 324353.9062; train_gene_expr_recon_loss: 109718.5766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436467.7438; train_optim_loss: 436467.7438; val_kl_reg_loss: 6013.7988; val_edge_recon_loss: 322372.7500; val_gene_expr_recon_loss: 107729.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436115.7031; val_optim_loss: 436115.7031
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7763; val_auprc_score: 0.7672; val_best_acc_score: 0.6965; val_best_f1_score: 0.7327; train_kl_reg_loss: 8890.3333; train_edge_recon_loss: 301338.9906; train_gene_expr_recon_loss: 107971.7047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418201.0250; train_optim_loss: 418201.0250; val_kl_reg_loss: 10104.8262; val_edge_recon_loss: 304572.9062; val_gene_expr_recon_loss: 106803.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421480.8906; val_optim_loss: 421480.8906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8241; val_auprc_score: 0.8153; val_best_acc_score: 0.7525; val_best_f1_score: 0.7669; train_kl_reg_loss: 10482.2128; train_edge_recon_loss: 285271.9500; train_gene_expr_recon_loss: 107396.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403151.0563; train_optim_loss: 403151.0563; val_kl_reg_loss: 9344.5239; val_edge_recon_loss: 293969.8438; val_gene_expr_recon_loss: 106502.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409817.3438; val_optim_loss: 409817.3438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8478; val_auprc_score: 0.8347; val_best_acc_score: 0.7748; val_best_f1_score: 0.7865; train_kl_reg_loss: 8741.8652; train_edge_recon_loss: 277632.3625; train_gene_expr_recon_loss: 107303.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393678.1437; train_optim_loss: 393678.1437; val_kl_reg_loss: 7426.3894; val_edge_recon_loss: 288893.1719; val_gene_expr_recon_loss: 106293.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402613.4375; val_optim_loss: 402613.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8634; val_auprc_score: 0.8508; val_best_acc_score: 0.7857; val_best_f1_score: 0.7999; train_kl_reg_loss: 7191.5226; train_edge_recon_loss: 276086.0812; train_gene_expr_recon_loss: 106983.9680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390261.5844; train_optim_loss: 390261.5844; val_kl_reg_loss: 6636.8018; val_edge_recon_loss: 288289.8125; val_gene_expr_recon_loss: 106106.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401032.9375; val_optim_loss: 401032.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8731; val_auprc_score: 0.8604; val_best_acc_score: 0.7980; val_best_f1_score: 0.8094; train_kl_reg_loss: 6600.4385; train_edge_recon_loss: 274323.8500; train_gene_expr_recon_loss: 106562.0500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387486.3344; train_optim_loss: 387486.3344; val_kl_reg_loss: 6181.6157; val_edge_recon_loss: 285188.1094; val_gene_expr_recon_loss: 105910.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397280.5312; val_optim_loss: 397280.5312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8764; val_auprc_score: 0.8679; val_best_acc_score: 0.8012; val_best_f1_score: 0.8092; train_kl_reg_loss: 6088.8569; train_edge_recon_loss: 273749.6188; train_gene_expr_recon_loss: 106342.7086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386181.1844; train_optim_loss: 386181.1844; val_kl_reg_loss: 5705.9507; val_edge_recon_loss: 282291.2344; val_gene_expr_recon_loss: 105779.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393776.8438; val_optim_loss: 393776.8438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8824; val_auprc_score: 0.8768; val_best_acc_score: 0.8055; val_best_f1_score: 0.8119; train_kl_reg_loss: 5835.1232; train_edge_recon_loss: 272603.2719; train_gene_expr_recon_loss: 106713.3680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385151.7562; train_optim_loss: 385151.7562; val_kl_reg_loss: 5706.8335; val_edge_recon_loss: 283253.4844; val_gene_expr_recon_loss: 105630.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394590.5312; val_optim_loss: 394590.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8866; val_auprc_score: 0.8799; val_best_acc_score: 0.8110; val_best_f1_score: 0.8164; train_kl_reg_loss: 5818.0671; train_edge_recon_loss: 271343.9156; train_gene_expr_recon_loss: 106193.3055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383355.2875; train_optim_loss: 383355.2875; val_kl_reg_loss: 5716.0166; val_edge_recon_loss: 287613.1094; val_gene_expr_recon_loss: 105500.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398829.3438; val_optim_loss: 398829.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8865; val_auprc_score: 0.8775; val_best_acc_score: 0.8107; val_best_f1_score: 0.8191; train_kl_reg_loss: 5684.1376; train_edge_recon_loss: 271115.8344; train_gene_expr_recon_loss: 105967.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382767.9375; train_optim_loss: 382767.9375; val_kl_reg_loss: 5458.3149; val_edge_recon_loss: 281008.1250; val_gene_expr_recon_loss: 105381.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391847.6875; val_optim_loss: 391847.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8941; val_auprc_score: 0.8805; val_best_acc_score: 0.8200; val_best_f1_score: 0.8270; train_kl_reg_loss: 5573.2034; train_edge_recon_loss: 270168.5812; train_gene_expr_recon_loss: 105757.4125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381499.2000; train_optim_loss: 381499.2000; val_kl_reg_loss: 5422.8755; val_edge_recon_loss: 281177.6875; val_gene_expr_recon_loss: 105303.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391904.1875; val_optim_loss: 391904.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8938; val_auprc_score: 0.8837; val_best_acc_score: 0.8163; val_best_f1_score: 0.8218; train_kl_reg_loss: 5469.3617; train_edge_recon_loss: 270658.3344; train_gene_expr_recon_loss: 106041.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382169.6312; train_optim_loss: 382169.6312; val_kl_reg_loss: 5304.3557; val_edge_recon_loss: 282958.2812; val_gene_expr_recon_loss: 105209.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393472.3594; val_optim_loss: 393472.3594
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8987; val_auprc_score: 0.8874; val_best_acc_score: 0.8242; val_best_f1_score: 0.8298; train_kl_reg_loss: 5404.4877; train_edge_recon_loss: 270263.0312; train_gene_expr_recon_loss: 105980.6273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381648.1500; train_optim_loss: 381648.1500; val_kl_reg_loss: 5174.5757; val_edge_recon_loss: 281611.1406; val_gene_expr_recon_loss: 105073.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391859.2188; val_optim_loss: 391859.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8944; val_auprc_score: 0.8813; val_best_acc_score: 0.8193; val_best_f1_score: 0.8259; train_kl_reg_loss: 5284.4887; train_edge_recon_loss: 269494.1531; train_gene_expr_recon_loss: 105573.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380351.9156; train_optim_loss: 380351.9156; val_kl_reg_loss: 5182.2666; val_edge_recon_loss: 280256.9688; val_gene_expr_recon_loss: 104886.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390325.9219; val_optim_loss: 390325.9219
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8972; val_auprc_score: 0.8835; val_best_acc_score: 0.8216; val_best_f1_score: 0.8272; train_kl_reg_loss: 5323.1993; train_edge_recon_loss: 268994.9813; train_gene_expr_recon_loss: 105574.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379892.6906; train_optim_loss: 379892.6906; val_kl_reg_loss: 5225.7747; val_edge_recon_loss: 280617.4375; val_gene_expr_recon_loss: 104888.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390731.8281; val_optim_loss: 390731.8281
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8998; val_auprc_score: 0.8880; val_best_acc_score: 0.8253; val_best_f1_score: 0.8304; train_kl_reg_loss: 5351.8007; train_edge_recon_loss: 268550.5781; train_gene_expr_recon_loss: 105576.0648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379478.4406; train_optim_loss: 379478.4406; val_kl_reg_loss: 5216.4861; val_edge_recon_loss: 277580.9219; val_gene_expr_recon_loss: 104857.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387655.3125; val_optim_loss: 387655.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8994; val_auprc_score: 0.8887; val_best_acc_score: 0.8234; val_best_f1_score: 0.8289; train_kl_reg_loss: 5356.6619; train_edge_recon_loss: 269301.5250; train_gene_expr_recon_loss: 105437.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380095.8250; train_optim_loss: 380095.8250; val_kl_reg_loss: 5217.1333; val_edge_recon_loss: 279982.3750; val_gene_expr_recon_loss: 104846.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390046.3750; val_optim_loss: 390046.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8997; val_auprc_score: 0.8901; val_best_acc_score: 0.8232; val_best_f1_score: 0.8280; train_kl_reg_loss: 5316.3209; train_edge_recon_loss: 269728.2812; train_gene_expr_recon_loss: 105697.9070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380742.5062; train_optim_loss: 380742.5062; val_kl_reg_loss: 5198.4727; val_edge_recon_loss: 282408.2031; val_gene_expr_recon_loss: 104838.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392444.9531; val_optim_loss: 392444.9531
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9025; val_auprc_score: 0.8933; val_best_acc_score: 0.8287; val_best_f1_score: 0.8337; train_kl_reg_loss: 5328.7372; train_edge_recon_loss: 268684.9875; train_gene_expr_recon_loss: 105374.3992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379388.1281; train_optim_loss: 379388.1281; val_kl_reg_loss: 5178.3296; val_edge_recon_loss: 276299.5469; val_gene_expr_recon_loss: 104824.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386302.3438; val_optim_loss: 386302.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9025; val_auprc_score: 0.8927; val_best_acc_score: 0.8302; val_best_f1_score: 0.8354; train_kl_reg_loss: 5318.6514; train_edge_recon_loss: 268539.8125; train_gene_expr_recon_loss: 105762.3539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379620.8187; train_optim_loss: 379620.8187; val_kl_reg_loss: 5213.1409; val_edge_recon_loss: 281259.4219; val_gene_expr_recon_loss: 104813.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391286.4688; val_optim_loss: 391286.4688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9016; val_auprc_score: 0.8893; val_best_acc_score: 0.8241; val_best_f1_score: 0.8303; train_kl_reg_loss: 5324.2979; train_edge_recon_loss: 268535.9688; train_gene_expr_recon_loss: 105200.8992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379061.1656; train_optim_loss: 379061.1656; val_kl_reg_loss: 5210.3347; val_edge_recon_loss: 277293.7500; val_gene_expr_recon_loss: 104809.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387313.8750; val_optim_loss: 387313.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9003; val_auprc_score: 0.8885; val_best_acc_score: 0.8259; val_best_f1_score: 0.8321; train_kl_reg_loss: 5319.9819; train_edge_recon_loss: 269298.3375; train_gene_expr_recon_loss: 105612.5750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380230.8937; train_optim_loss: 380230.8937; val_kl_reg_loss: 5135.9097; val_edge_recon_loss: 277869.4531; val_gene_expr_recon_loss: 104800.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387805.8281; val_optim_loss: 387805.8281

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9036; val_auprc_score: 0.8934; val_best_acc_score: 0.8261; val_best_f1_score: 0.8320; train_kl_reg_loss: 5276.4996; train_edge_recon_loss: 268698.8969; train_gene_expr_recon_loss: 105562.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379538.2438; train_optim_loss: 379538.2438; val_kl_reg_loss: 5165.6011; val_edge_recon_loss: 279735.1875; val_gene_expr_recon_loss: 104796.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389697.6094; val_optim_loss: 389697.6094
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9027; val_auprc_score: 0.8901; val_best_acc_score: 0.8279; val_best_f1_score: 0.8351; train_kl_reg_loss: 5290.9009; train_edge_recon_loss: 268876.0281; train_gene_expr_recon_loss: 105401.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379568.4219; train_optim_loss: 379568.4219; val_kl_reg_loss: 5175.2676; val_edge_recon_loss: 281796.2656; val_gene_expr_recon_loss: 104792.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391763.7812; val_optim_loss: 391763.7812
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9033; val_auprc_score: 0.8899; val_best_acc_score: 0.8301; val_best_f1_score: 0.8357; train_kl_reg_loss: 5298.3844; train_edge_recon_loss: 269011.2781; train_gene_expr_recon_loss: 105257.8461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379567.5094; train_optim_loss: 379567.5094; val_kl_reg_loss: 5145.7358; val_edge_recon_loss: 278201.9531; val_gene_expr_recon_loss: 104789.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388137.3125; val_optim_loss: 388137.3125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 13 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9034
Val AUPRC score: 0.8953
Val best accuracy score: 0.8254
Val best F1 score: 0.8325
Val gene expr MSE score: 0.2381
Duration of model training in run 1: 0 hours, 1 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 39550
Number of validation edges: 4394
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7538; val_auprc_score: 0.7669; val_best_acc_score: 0.6702; val_best_f1_score: 0.7140; train_kl_reg_loss: 189.0917; train_edge_recon_loss: 344090.4156; train_gene_expr_recon_loss: 118708.8258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462988.3250; train_optim_loss: 462988.3250; val_kl_reg_loss: 331.3040; val_edge_recon_loss: 352515.0781; val_gene_expr_recon_loss: 113014.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465861.0625; val_optim_loss: 465861.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7316; val_auprc_score: 0.7289; val_best_acc_score: 0.6573; val_best_f1_score: 0.7119; train_kl_reg_loss: 2177.9675; train_edge_recon_loss: 325015.6250; train_gene_expr_recon_loss: 108825.6273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436019.2250; train_optim_loss: 436019.2250; val_kl_reg_loss: 6454.1099; val_edge_recon_loss: 317413.2031; val_gene_expr_recon_loss: 111097.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434964.4688; val_optim_loss: 434964.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7670; val_auprc_score: 0.7584; val_best_acc_score: 0.6849; val_best_f1_score: 0.7312; train_kl_reg_loss: 9012.3270; train_edge_recon_loss: 301342.1063; train_gene_expr_recon_loss: 107505.6281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417860.0719; train_optim_loss: 417860.0719; val_kl_reg_loss: 10745.3281; val_edge_recon_loss: 313244.2031; val_gene_expr_recon_loss: 110144.7070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434134.2500; val_optim_loss: 434134.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8197; val_auprc_score: 0.8035; val_best_acc_score: 0.7432; val_best_f1_score: 0.7624; train_kl_reg_loss: 10519.6161; train_edge_recon_loss: 286323.2906; train_gene_expr_recon_loss: 107123.2867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403966.1969; train_optim_loss: 403966.1969; val_kl_reg_loss: 9561.1611; val_edge_recon_loss: 292722.3281; val_gene_expr_recon_loss: 109730.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412014.0938; val_optim_loss: 412014.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8407; val_auprc_score: 0.8361; val_best_acc_score: 0.7621; val_best_f1_score: 0.7742; train_kl_reg_loss: 8597.5525; train_edge_recon_loss: 279729.9313; train_gene_expr_recon_loss: 106766.1187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395093.6031; train_optim_loss: 395093.6031; val_kl_reg_loss: 7693.6587; val_edge_recon_loss: 294484.1094; val_gene_expr_recon_loss: 109483.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411661.5156; val_optim_loss: 411661.5156
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8571; val_auprc_score: 0.8431; val_best_acc_score: 0.7777; val_best_f1_score: 0.7891; train_kl_reg_loss: 7412.2895; train_edge_recon_loss: 277100.9656; train_gene_expr_recon_loss: 106687.0258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391200.2719; train_optim_loss: 391200.2719; val_kl_reg_loss: 7009.3179; val_edge_recon_loss: 286321.4375; val_gene_expr_recon_loss: 109230.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402560.8906; val_optim_loss: 402560.8906
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8618; val_auprc_score: 0.8505; val_best_acc_score: 0.7813; val_best_f1_score: 0.7954; train_kl_reg_loss: 6772.5983; train_edge_recon_loss: 275509.6063; train_gene_expr_recon_loss: 106015.3492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388297.5531; train_optim_loss: 388297.5531; val_kl_reg_loss: 6500.9856; val_edge_recon_loss: 287977.2656; val_gene_expr_recon_loss: 108969.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403448.0312; val_optim_loss: 403448.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8709; val_auprc_score: 0.8573; val_best_acc_score: 0.7921; val_best_f1_score: 0.8002; train_kl_reg_loss: 6334.3446; train_edge_recon_loss: 273674.8563; train_gene_expr_recon_loss: 105908.0281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385917.2344; train_optim_loss: 385917.2344; val_kl_reg_loss: 6032.6177; val_edge_recon_loss: 284209.4844; val_gene_expr_recon_loss: 108779.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399021.2031; val_optim_loss: 399021.2031
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8817; val_auprc_score: 0.8737; val_best_acc_score: 0.8009; val_best_f1_score: 0.8072; train_kl_reg_loss: 5968.7375; train_edge_recon_loss: 272646.3531; train_gene_expr_recon_loss: 105672.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384288.0656; train_optim_loss: 384288.0656; val_kl_reg_loss: 5878.6602; val_edge_recon_loss: 283231.4844; val_gene_expr_recon_loss: 108601.1367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397711.2656; val_optim_loss: 397711.2656
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8811; val_auprc_score: 0.8734; val_best_acc_score: 0.7987; val_best_f1_score: 0.8096; train_kl_reg_loss: 5880.2111; train_edge_recon_loss: 271965.6594; train_gene_expr_recon_loss: 105727.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383573.0406; train_optim_loss: 383573.0406; val_kl_reg_loss: 5681.1741; val_edge_recon_loss: 286026.2969; val_gene_expr_recon_loss: 108458.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400165.5156; val_optim_loss: 400165.5156
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8855; val_auprc_score: 0.8727; val_best_acc_score: 0.8084; val_best_f1_score: 0.8157; train_kl_reg_loss: 5810.3876; train_edge_recon_loss: 271134.9000; train_gene_expr_recon_loss: 105479.2664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382424.5531; train_optim_loss: 382424.5531; val_kl_reg_loss: 5647.3318; val_edge_recon_loss: 284675.2031; val_gene_expr_recon_loss: 108309.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398632.2500; val_optim_loss: 398632.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8916; val_auprc_score: 0.8805; val_best_acc_score: 0.8141; val_best_f1_score: 0.8228; train_kl_reg_loss: 5643.0528; train_edge_recon_loss: 270814.7594; train_gene_expr_recon_loss: 105046.1555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381503.9688; train_optim_loss: 381503.9688; val_kl_reg_loss: 5488.8354; val_edge_recon_loss: 282135.9844; val_gene_expr_recon_loss: 108227.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395852.2812; val_optim_loss: 395852.2812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8884; val_auprc_score: 0.8764; val_best_acc_score: 0.8101; val_best_f1_score: 0.8214; train_kl_reg_loss: 5559.0306; train_edge_recon_loss: 270479.6844; train_gene_expr_recon_loss: 105239.1891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381277.9000; train_optim_loss: 381277.9000; val_kl_reg_loss: 5386.6565; val_edge_recon_loss: 281627.6250; val_gene_expr_recon_loss: 108144.1758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395158.4531; val_optim_loss: 395158.4531
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8998; val_auprc_score: 0.8887; val_best_acc_score: 0.8241; val_best_f1_score: 0.8299; train_kl_reg_loss: 5458.2419; train_edge_recon_loss: 269242.4031; train_gene_expr_recon_loss: 105205.3375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379905.9781; train_optim_loss: 379905.9781; val_kl_reg_loss: 5456.6292; val_edge_recon_loss: 279239.9531; val_gene_expr_recon_loss: 108063.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392760.2656; val_optim_loss: 392760.2656
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8999; val_auprc_score: 0.8904; val_best_acc_score: 0.8204; val_best_f1_score: 0.8285; train_kl_reg_loss: 5404.7870; train_edge_recon_loss: 269517.3719; train_gene_expr_recon_loss: 105167.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380089.3906; train_optim_loss: 380089.3906; val_kl_reg_loss: 5303.2424; val_edge_recon_loss: 278510.0938; val_gene_expr_recon_loss: 107985.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391798.7344; val_optim_loss: 391798.7344
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9040; val_auprc_score: 0.8932; val_best_acc_score: 0.8274; val_best_f1_score: 0.8350; train_kl_reg_loss: 5324.9988; train_edge_recon_loss: 269327.1594; train_gene_expr_recon_loss: 105025.2133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379677.3750; train_optim_loss: 379677.3750; val_kl_reg_loss: 5217.0415; val_edge_recon_loss: 278561.8438; val_gene_expr_recon_loss: 107917.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391696.3125; val_optim_loss: 391696.3125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9070; val_auprc_score: 0.8960; val_best_acc_score: 0.8292; val_best_f1_score: 0.8392; train_kl_reg_loss: 5263.1124; train_edge_recon_loss: 268813.0750; train_gene_expr_recon_loss: 104989.6742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379065.8625; train_optim_loss: 379065.8625; val_kl_reg_loss: 5108.5442; val_edge_recon_loss: 281406.3750; val_gene_expr_recon_loss: 107852.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394367.1094; val_optim_loss: 394367.1094
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9028; val_auprc_score: 0.8910; val_best_acc_score: 0.8258; val_best_f1_score: 0.8349; train_kl_reg_loss: 5225.5719; train_edge_recon_loss: 268245.8187; train_gene_expr_recon_loss: 105136.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378607.5438; train_optim_loss: 378607.5438; val_kl_reg_loss: 5002.0168; val_edge_recon_loss: 281022.5938; val_gene_expr_recon_loss: 107803.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393828.1406; val_optim_loss: 393828.1406
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9113; val_auprc_score: 0.9000; val_best_acc_score: 0.8365; val_best_f1_score: 0.8433; train_kl_reg_loss: 5160.2291; train_edge_recon_loss: 268560.1312; train_gene_expr_recon_loss: 105015.6258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378735.9875; train_optim_loss: 378735.9875; val_kl_reg_loss: 5024.7917; val_edge_recon_loss: 279020.0625; val_gene_expr_recon_loss: 107710.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391755.0625; val_optim_loss: 391755.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9138; val_auprc_score: 0.8986; val_best_acc_score: 0.8396; val_best_f1_score: 0.8464; train_kl_reg_loss: 5116.0373; train_edge_recon_loss: 268079.5781; train_gene_expr_recon_loss: 104460.0414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377655.6594; train_optim_loss: 377655.6594; val_kl_reg_loss: 5050.9043; val_edge_recon_loss: 277809.2500; val_gene_expr_recon_loss: 107470.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390331.0000; val_optim_loss: 390331.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9122; val_auprc_score: 0.9010; val_best_acc_score: 0.8368; val_best_f1_score: 0.8438; train_kl_reg_loss: 5135.5835; train_edge_recon_loss: 267216.3750; train_gene_expr_recon_loss: 104075.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376426.9969; train_optim_loss: 376426.9969; val_kl_reg_loss: 5071.0154; val_edge_recon_loss: 277649.2656; val_gene_expr_recon_loss: 107469.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390189.4844; val_optim_loss: 390189.4844
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9100; val_auprc_score: 0.8960; val_best_acc_score: 0.8336; val_best_f1_score: 0.8435; train_kl_reg_loss: 5146.4786; train_edge_recon_loss: 268456.3531; train_gene_expr_recon_loss: 104494.6844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378097.5125; train_optim_loss: 378097.5125; val_kl_reg_loss: 5044.0576; val_edge_recon_loss: 278564.7188; val_gene_expr_recon_loss: 107453.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391062.5312; val_optim_loss: 391062.5312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9116; val_auprc_score: 0.8988; val_best_acc_score: 0.8377; val_best_f1_score: 0.8455; train_kl_reg_loss: 5114.5534; train_edge_recon_loss: 268004.1937; train_gene_expr_recon_loss: 104768.7117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377887.4594; train_optim_loss: 377887.4594; val_kl_reg_loss: 5034.9187; val_edge_recon_loss: 281814.0156; val_gene_expr_recon_loss: 107444.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394292.9688; val_optim_loss: 394292.9688
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9128; val_auprc_score: 0.9016; val_best_acc_score: 0.8378; val_best_f1_score: 0.8455; train_kl_reg_loss: 5121.2324; train_edge_recon_loss: 267929.8438; train_gene_expr_recon_loss: 104450.7055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377501.7812; train_optim_loss: 377501.7812; val_kl_reg_loss: 5028.9734; val_edge_recon_loss: 277857.9219; val_gene_expr_recon_loss: 107434.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390321.2031; val_optim_loss: 390321.2031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9123; val_auprc_score: 0.9019; val_best_acc_score: 0.8381; val_best_f1_score: 0.8460; train_kl_reg_loss: 5116.0302; train_edge_recon_loss: 267669.9250; train_gene_expr_recon_loss: 104655.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377441.8937; train_optim_loss: 377441.8937; val_kl_reg_loss: 5038.0105; val_edge_recon_loss: 282971.8438; val_gene_expr_recon_loss: 107431.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395441.4688; val_optim_loss: 395441.4688
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9098; val_auprc_score: 0.8977; val_best_acc_score: 0.8345; val_best_f1_score: 0.8430; train_kl_reg_loss: 5115.4520; train_edge_recon_loss: 267593.3750; train_gene_expr_recon_loss: 104738.9000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377447.7250; train_optim_loss: 377447.7250; val_kl_reg_loss: 4965.7388; val_edge_recon_loss: 278020.3438; val_gene_expr_recon_loss: 107428.8086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390414.9062; val_optim_loss: 390414.9062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9080; val_auprc_score: 0.8957; val_best_acc_score: 0.8315; val_best_f1_score: 0.8425; train_kl_reg_loss: 5120.6571; train_edge_recon_loss: 267024.0625; train_gene_expr_recon_loss: 104327.5422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376472.2656; train_optim_loss: 376472.2656; val_kl_reg_loss: 4945.9053; val_edge_recon_loss: 277100.7969; val_gene_expr_recon_loss: 107427.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389474.1875; val_optim_loss: 389474.1875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9142; val_auprc_score: 0.9027; val_best_acc_score: 0.8393; val_best_f1_score: 0.8469; train_kl_reg_loss: 5122.4691; train_edge_recon_loss: 267451.8000; train_gene_expr_recon_loss: 104767.8445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377342.1125; train_optim_loss: 377342.1125; val_kl_reg_loss: 4960.3240; val_edge_recon_loss: 278165.9062; val_gene_expr_recon_loss: 107426.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390553.1562; val_optim_loss: 390553.1562
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9146; val_auprc_score: 0.9050; val_best_acc_score: 0.8392; val_best_f1_score: 0.8469; train_kl_reg_loss: 5121.9696; train_edge_recon_loss: 267722.3125; train_gene_expr_recon_loss: 104825.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377670.2188; train_optim_loss: 377670.2188; val_kl_reg_loss: 4947.8489; val_edge_recon_loss: 281122.3594; val_gene_expr_recon_loss: 107425.7695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393495.9844; val_optim_loss: 393495.9844
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9129; val_auprc_score: 0.8989; val_best_acc_score: 0.8417; val_best_f1_score: 0.8487; train_kl_reg_loss: 5114.0808; train_edge_recon_loss: 267709.5594; train_gene_expr_recon_loss: 104627.7250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377451.3719; train_optim_loss: 377451.3719; val_kl_reg_loss: 4944.3918; val_edge_recon_loss: 278441.2188; val_gene_expr_recon_loss: 107425.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390811.0312; val_optim_loss: 390811.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9139; val_auprc_score: 0.9044; val_best_acc_score: 0.8376; val_best_f1_score: 0.8466; train_kl_reg_loss: 5113.6028; train_edge_recon_loss: 267300.6312; train_gene_expr_recon_loss: 104534.5188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376948.7562; train_optim_loss: 376948.7562; val_kl_reg_loss: 4945.6250; val_edge_recon_loss: 277283.1406; val_gene_expr_recon_loss: 107425.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389654.0938; val_optim_loss: 389654.0938
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9086; val_auprc_score: 0.8980; val_best_acc_score: 0.8325; val_best_f1_score: 0.8424; train_kl_reg_loss: 5115.1746; train_edge_recon_loss: 267098.2594; train_gene_expr_recon_loss: 104490.9312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376704.3656; train_optim_loss: 376704.3656; val_kl_reg_loss: 4946.3452; val_edge_recon_loss: 281974.6719; val_gene_expr_recon_loss: 107425.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394346.2969; val_optim_loss: 394346.2969
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9121; val_auprc_score: 0.9020; val_best_acc_score: 0.8348; val_best_f1_score: 0.8443; train_kl_reg_loss: 5112.1503; train_edge_recon_loss: 267081.0750; train_gene_expr_recon_loss: 104549.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376742.8281; train_optim_loss: 376742.8281; val_kl_reg_loss: 4936.7388; val_edge_recon_loss: 281157.3125; val_gene_expr_recon_loss: 107425.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393519.2812; val_optim_loss: 393519.2812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 36 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9060
Val AUPRC score: 0.8932
Val best accuracy score: 0.8310
Val best F1 score: 0.8388
Val gene expr MSE score: 0.2504
Duration of model training in run 2: 0 hours, 1 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 76397
Number of validation edges: 8488
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8150; val_auprc_score: 0.8060; val_best_acc_score: 0.7213; val_best_f1_score: 0.7560; train_kl_reg_loss: 4187.4085; train_edge_recon_loss: 323099.2401; train_gene_expr_recon_loss: 111721.9611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439008.6127; train_optim_loss: 439008.6127; val_kl_reg_loss: 10254.4215; val_edge_recon_loss: 299413.0250; val_gene_expr_recon_loss: 106932.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416600.3937; val_optim_loss: 416600.3937
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9017; val_auprc_score: 0.8876; val_best_acc_score: 0.8280; val_best_f1_score: 0.8349; train_kl_reg_loss: 8296.8085; train_edge_recon_loss: 281297.5206; train_gene_expr_recon_loss: 107583.5933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397177.9227; train_optim_loss: 397177.9227; val_kl_reg_loss: 6242.2546; val_edge_recon_loss: 278812.0375; val_gene_expr_recon_loss: 106056.0641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391110.3563; val_optim_loss: 391110.3563
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9214; val_auprc_score: 0.9087; val_best_acc_score: 0.8495; val_best_f1_score: 0.8562; train_kl_reg_loss: 5830.3703; train_edge_recon_loss: 272828.1365; train_gene_expr_recon_loss: 106762.5084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 385421.0123; train_optim_loss: 385421.0123; val_kl_reg_loss: 5492.2000; val_edge_recon_loss: 274239.6750; val_gene_expr_recon_loss: 105939.1609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385671.0250; val_optim_loss: 385671.0250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9343; val_auprc_score: 0.9224; val_best_acc_score: 0.8659; val_best_f1_score: 0.8717; train_kl_reg_loss: 5478.6509; train_edge_recon_loss: 269936.7442; train_gene_expr_recon_loss: 106541.2669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381956.6645; train_optim_loss: 381956.6645; val_kl_reg_loss: 5286.9865; val_edge_recon_loss: 272620.7188; val_gene_expr_recon_loss: 105291.0344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383198.7313; val_optim_loss: 383198.7313
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9396; val_auprc_score: 0.9285; val_best_acc_score: 0.8740; val_best_f1_score: 0.8781; train_kl_reg_loss: 5303.6223; train_edge_recon_loss: 268410.4893; train_gene_expr_recon_loss: 106463.2237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380177.3339; train_optim_loss: 380177.3339; val_kl_reg_loss: 5067.9348; val_edge_recon_loss: 271279.1188; val_gene_expr_recon_loss: 105301.8844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381648.9375; val_optim_loss: 381648.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9467; val_auprc_score: 0.9365; val_best_acc_score: 0.8812; val_best_f1_score: 0.8856; train_kl_reg_loss: 5144.7199; train_edge_recon_loss: 267922.6472; train_gene_expr_recon_loss: 106036.7087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379104.0765; train_optim_loss: 379104.0765; val_kl_reg_loss: 5010.6373; val_edge_recon_loss: 270401.1188; val_gene_expr_recon_loss: 105269.5094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380681.2687; val_optim_loss: 380681.2687
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9525; val_auprc_score: 0.9423; val_best_acc_score: 0.8877; val_best_f1_score: 0.8926; train_kl_reg_loss: 5034.7193; train_edge_recon_loss: 267123.7706; train_gene_expr_recon_loss: 105991.4083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378149.9021; train_optim_loss: 378149.9021; val_kl_reg_loss: 4950.5572; val_edge_recon_loss: 268425.8187; val_gene_expr_recon_loss: 104833.3656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378209.7438; val_optim_loss: 378209.7438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9606; val_auprc_score: 0.9512; val_best_acc_score: 0.9026; val_best_f1_score: 0.9052; train_kl_reg_loss: 4969.6375; train_edge_recon_loss: 266534.1127; train_gene_expr_recon_loss: 105996.6086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377500.3610; train_optim_loss: 377500.3610; val_kl_reg_loss: 4896.6186; val_edge_recon_loss: 267953.4625; val_gene_expr_recon_loss: 104718.2484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377568.3375; val_optim_loss: 377568.3375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9619; val_auprc_score: 0.9518; val_best_acc_score: 0.9032; val_best_f1_score: 0.9067; train_kl_reg_loss: 4910.0128; train_edge_recon_loss: 265888.9827; train_gene_expr_recon_loss: 105711.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376510.8972; train_optim_loss: 376510.8972; val_kl_reg_loss: 4892.0812; val_edge_recon_loss: 269143.7812; val_gene_expr_recon_loss: 104720.6203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378756.4875; val_optim_loss: 378756.4875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9673; val_auprc_score: 0.9596; val_best_acc_score: 0.9125; val_best_f1_score: 0.9151; train_kl_reg_loss: 4879.0984; train_edge_recon_loss: 265480.8586; train_gene_expr_recon_loss: 105375.3951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375735.3544; train_optim_loss: 375735.3544; val_kl_reg_loss: 4861.1604; val_edge_recon_loss: 267121.7000; val_gene_expr_recon_loss: 104116.4547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376099.3187; val_optim_loss: 376099.3187
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9711; val_auprc_score: 0.9636; val_best_acc_score: 0.9198; val_best_f1_score: 0.9220; train_kl_reg_loss: 4877.4512; train_edge_recon_loss: 264868.7981; train_gene_expr_recon_loss: 105091.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374837.6044; train_optim_loss: 374837.6044; val_kl_reg_loss: 4881.8701; val_edge_recon_loss: 266782.8375; val_gene_expr_recon_loss: 103632.6781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375297.3875; val_optim_loss: 375297.3875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9705; val_auprc_score: 0.9609; val_best_acc_score: 0.9212; val_best_f1_score: 0.9241; train_kl_reg_loss: 4817.4019; train_edge_recon_loss: 264216.6776; train_gene_expr_recon_loss: 105217.8197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374251.8964; train_optim_loss: 374251.8964; val_kl_reg_loss: 4751.3206; val_edge_recon_loss: 266748.8125; val_gene_expr_recon_loss: 104717.0188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376217.1500; val_optim_loss: 376217.1500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9764; val_auprc_score: 0.9689; val_best_acc_score: 0.9305; val_best_f1_score: 0.9320; train_kl_reg_loss: 4835.6063; train_edge_recon_loss: 263459.9157; train_gene_expr_recon_loss: 105211.2284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373506.7500; train_optim_loss: 373506.7500; val_kl_reg_loss: 4803.0563; val_edge_recon_loss: 266645.4437; val_gene_expr_recon_loss: 104206.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375654.8000; val_optim_loss: 375654.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9774; val_auprc_score: 0.9703; val_best_acc_score: 0.9329; val_best_f1_score: 0.9349; train_kl_reg_loss: 4789.4847; train_edge_recon_loss: 263489.5724; train_gene_expr_recon_loss: 104774.6244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373053.6809; train_optim_loss: 373053.6809; val_kl_reg_loss: 4685.4054; val_edge_recon_loss: 265029.9313; val_gene_expr_recon_loss: 104190.5063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373905.8375; val_optim_loss: 373905.8375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9799; val_auprc_score: 0.9740; val_best_acc_score: 0.9389; val_best_f1_score: 0.9406; train_kl_reg_loss: 4785.3331; train_edge_recon_loss: 263115.5321; train_gene_expr_recon_loss: 104750.9215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372651.7887; train_optim_loss: 372651.7887; val_kl_reg_loss: 4660.5045; val_edge_recon_loss: 264763.8063; val_gene_expr_recon_loss: 104119.4828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373543.7875; val_optim_loss: 373543.7875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9811; val_auprc_score: 0.9736; val_best_acc_score: 0.9410; val_best_f1_score: 0.9422; train_kl_reg_loss: 4757.4073; train_edge_recon_loss: 262735.5646; train_gene_expr_recon_loss: 104943.0150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372435.9893; train_optim_loss: 372435.9893; val_kl_reg_loss: 4677.6169; val_edge_recon_loss: 264080.6437; val_gene_expr_recon_loss: 104091.3656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372849.6188; val_optim_loss: 372849.6188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9813; val_auprc_score: 0.9741; val_best_acc_score: 0.9419; val_best_f1_score: 0.9433; train_kl_reg_loss: 4745.3759; train_edge_recon_loss: 262663.2545; train_gene_expr_recon_loss: 104606.6538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372015.2837; train_optim_loss: 372015.2837; val_kl_reg_loss: 4659.5168; val_edge_recon_loss: 264333.8812; val_gene_expr_recon_loss: 104492.6297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373486.0375; val_optim_loss: 373486.0375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9812; val_auprc_score: 0.9733; val_best_acc_score: 0.9442; val_best_f1_score: 0.9456; train_kl_reg_loss: 4724.1014; train_edge_recon_loss: 262256.9519; train_gene_expr_recon_loss: 104609.6639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371590.7188; train_optim_loss: 371590.7188; val_kl_reg_loss: 4738.2272; val_edge_recon_loss: 265152.7188; val_gene_expr_recon_loss: 103168.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373059.4000; val_optim_loss: 373059.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9848; val_auprc_score: 0.9803; val_best_acc_score: 0.9472; val_best_f1_score: 0.9484; train_kl_reg_loss: 4711.9721; train_edge_recon_loss: 262629.1077; train_gene_expr_recon_loss: 104513.2471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371854.3281; train_optim_loss: 371854.3281; val_kl_reg_loss: 4607.8735; val_edge_recon_loss: 264025.3000; val_gene_expr_recon_loss: 104437.5109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373070.6875; val_optim_loss: 373070.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9854; val_auprc_score: 0.9806; val_best_acc_score: 0.9502; val_best_f1_score: 0.9514; train_kl_reg_loss: 4708.5647; train_edge_recon_loss: 261995.5966; train_gene_expr_recon_loss: 104254.1657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370958.3298; train_optim_loss: 370958.3298; val_kl_reg_loss: 4671.4687; val_edge_recon_loss: 262808.8875; val_gene_expr_recon_loss: 103740.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371221.0563; val_optim_loss: 371221.0563
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9831; val_auprc_score: 0.9767; val_best_acc_score: 0.9500; val_best_f1_score: 0.9513; train_kl_reg_loss: 4707.1145; train_edge_recon_loss: 261560.3705; train_gene_expr_recon_loss: 104108.9231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370376.4046; train_optim_loss: 370376.4046; val_kl_reg_loss: 4653.0630; val_edge_recon_loss: 263846.8281; val_gene_expr_recon_loss: 104009.4281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372509.3187; val_optim_loss: 372509.3187
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9846; val_auprc_score: 0.9785; val_best_acc_score: 0.9492; val_best_f1_score: 0.9504; train_kl_reg_loss: 4715.3405; train_edge_recon_loss: 261453.1369; train_gene_expr_recon_loss: 103999.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370167.6571; train_optim_loss: 370167.6571; val_kl_reg_loss: 4650.3953; val_edge_recon_loss: 263602.1250; val_gene_expr_recon_loss: 102886.2156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371138.7375; val_optim_loss: 371138.7375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9848; val_auprc_score: 0.9790; val_best_acc_score: 0.9500; val_best_f1_score: 0.9510; train_kl_reg_loss: 4706.7313; train_edge_recon_loss: 261464.6003; train_gene_expr_recon_loss: 103956.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370127.8520; train_optim_loss: 370127.8520; val_kl_reg_loss: 4650.0425; val_edge_recon_loss: 263217.8406; val_gene_expr_recon_loss: 103282.8328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371150.7125; val_optim_loss: 371150.7125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9791; val_best_acc_score: 0.9507; val_best_f1_score: 0.9517; train_kl_reg_loss: 4698.8737; train_edge_recon_loss: 261694.4313; train_gene_expr_recon_loss: 103851.6933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370244.9942; train_optim_loss: 370244.9942; val_kl_reg_loss: 4649.9221; val_edge_recon_loss: 263300.5312; val_gene_expr_recon_loss: 103910.3156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371860.7687; val_optim_loss: 371860.7687
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9834; val_auprc_score: 0.9756; val_best_acc_score: 0.9502; val_best_f1_score: 0.9513; train_kl_reg_loss: 4703.1054; train_edge_recon_loss: 261375.2780; train_gene_expr_recon_loss: 103892.2243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369970.6086; train_optim_loss: 369970.6086; val_kl_reg_loss: 4640.7942; val_edge_recon_loss: 264474.5906; val_gene_expr_recon_loss: 102732.7016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371848.0812; val_optim_loss: 371848.0812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9862; val_auprc_score: 0.9814; val_best_acc_score: 0.9526; val_best_f1_score: 0.9534; train_kl_reg_loss: 4678.3427; train_edge_recon_loss: 261833.9930; train_gene_expr_recon_loss: 104071.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370583.9581; train_optim_loss: 370583.9581; val_kl_reg_loss: 4431.1331; val_edge_recon_loss: 263354.4750; val_gene_expr_recon_loss: 103161.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370947.0125; val_optim_loss: 370947.0125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9863; val_auprc_score: 0.9817; val_best_acc_score: 0.9534; val_best_f1_score: 0.9543; train_kl_reg_loss: 4637.6791; train_edge_recon_loss: 261738.4005; train_gene_expr_recon_loss: 104022.2989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370398.3799; train_optim_loss: 370398.3799; val_kl_reg_loss: 4394.9391; val_edge_recon_loss: 262753.1125; val_gene_expr_recon_loss: 102789.9094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369937.9625; val_optim_loss: 369937.9625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9843; val_auprc_score: 0.9773; val_best_acc_score: 0.9501; val_best_f1_score: 0.9510; train_kl_reg_loss: 4595.4231; train_edge_recon_loss: 261423.2751; train_gene_expr_recon_loss: 103950.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369969.5296; train_optim_loss: 369969.5296; val_kl_reg_loss: 4348.4732; val_edge_recon_loss: 262332.3031; val_gene_expr_recon_loss: 103015.0016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369695.7812; val_optim_loss: 369695.7812
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9848; val_auprc_score: 0.9790; val_best_acc_score: 0.9493; val_best_f1_score: 0.9503; train_kl_reg_loss: 4556.6141; train_edge_recon_loss: 261279.7023; train_gene_expr_recon_loss: 104108.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369944.5888; train_optim_loss: 369944.5888; val_kl_reg_loss: 4312.7752; val_edge_recon_loss: 261958.5469; val_gene_expr_recon_loss: 103194.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369465.6312; val_optim_loss: 369465.6312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9843; val_auprc_score: 0.9781; val_best_acc_score: 0.9490; val_best_f1_score: 0.9500; train_kl_reg_loss: 4509.0827; train_edge_recon_loss: 261423.0522; train_gene_expr_recon_loss: 103945.7652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369877.9046; train_optim_loss: 369877.9046; val_kl_reg_loss: 4263.6056; val_edge_recon_loss: 263674.2875; val_gene_expr_recon_loss: 102797.3531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370735.2438; val_optim_loss: 370735.2438
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9836; val_auprc_score: 0.9766; val_best_acc_score: 0.9498; val_best_f1_score: 0.9510; train_kl_reg_loss: 4465.5450; train_edge_recon_loss: 261464.9848; train_gene_expr_recon_loss: 104052.6108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369983.1390; train_optim_loss: 369983.1390; val_kl_reg_loss: 4218.4992; val_edge_recon_loss: 264447.8000; val_gene_expr_recon_loss: 102707.2172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371373.5062; val_optim_loss: 371373.5062
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9850; val_auprc_score: 0.9785; val_best_acc_score: 0.9506; val_best_f1_score: 0.9518; train_kl_reg_loss: 4416.8253; train_edge_recon_loss: 261658.1863; train_gene_expr_recon_loss: 103978.1398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370053.1554; train_optim_loss: 370053.1554; val_kl_reg_loss: 4171.6730; val_edge_recon_loss: 263320.4469; val_gene_expr_recon_loss: 103222.8031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370714.9250; val_optim_loss: 370714.9250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9846; val_auprc_score: 0.9782; val_best_acc_score: 0.9502; val_best_f1_score: 0.9511; train_kl_reg_loss: 4391.9508; train_edge_recon_loss: 261517.5868; train_gene_expr_recon_loss: 104072.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369982.4268; train_optim_loss: 369982.4268; val_kl_reg_loss: 4168.3698; val_edge_recon_loss: 262669.6312; val_gene_expr_recon_loss: 102965.1781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369803.1875; val_optim_loss: 369803.1875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9861; val_auprc_score: 0.9807; val_best_acc_score: 0.9523; val_best_f1_score: 0.9534; train_kl_reg_loss: 4387.8978; train_edge_recon_loss: 261292.1443; train_gene_expr_recon_loss: 104175.4264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369855.4688; train_optim_loss: 369855.4688; val_kl_reg_loss: 4169.8690; val_edge_recon_loss: 262921.8031; val_gene_expr_recon_loss: 102865.7125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369957.3875; val_optim_loss: 369957.3875
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9834; val_auprc_score: 0.9766; val_best_acc_score: 0.9485; val_best_f1_score: 0.9495; train_kl_reg_loss: 4384.3583; train_edge_recon_loss: 261286.9396; train_gene_expr_recon_loss: 104032.0241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369703.3207; train_optim_loss: 369703.3207; val_kl_reg_loss: 4162.6068; val_edge_recon_loss: 263900.8187; val_gene_expr_recon_loss: 103832.5406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371895.9562; val_optim_loss: 371895.9562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 35 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9846
Val AUPRC score: 0.9786
Val best accuracy score: 0.9510
Val best F1 score: 0.9522
Val gene expr MSE score: 0.2257
Duration of model training in run 3: 0 hours, 4 minutes and 39 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 76397
Number of validation edges: 8488
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8210; val_auprc_score: 0.8118; val_best_acc_score: 0.7274; val_best_f1_score: 0.7570; train_kl_reg_loss: 4428.6576; train_edge_recon_loss: 321532.3964; train_gene_expr_recon_loss: 111244.0798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437205.1324; train_optim_loss: 437205.1324; val_kl_reg_loss: 9976.9176; val_edge_recon_loss: 295789.6875; val_gene_expr_recon_loss: 107613.8547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413380.4500; val_optim_loss: 413380.4500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9033; val_auprc_score: 0.8899; val_best_acc_score: 0.8289; val_best_f1_score: 0.8376; train_kl_reg_loss: 7953.4072; train_edge_recon_loss: 279501.4803; train_gene_expr_recon_loss: 107458.4694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394913.3536; train_optim_loss: 394913.3536; val_kl_reg_loss: 6282.5102; val_edge_recon_loss: 277841.1625; val_gene_expr_recon_loss: 107344.4719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391468.1375; val_optim_loss: 391468.1375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9177; val_auprc_score: 0.9045; val_best_acc_score: 0.8438; val_best_f1_score: 0.8514; train_kl_reg_loss: 5790.3654; train_edge_recon_loss: 272364.6299; train_gene_expr_recon_loss: 106623.3106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384778.3109; train_optim_loss: 384778.3109; val_kl_reg_loss: 5456.5247; val_edge_recon_loss: 276062.8688; val_gene_expr_recon_loss: 106908.0094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388427.4062; val_optim_loss: 388427.4062
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9302; val_auprc_score: 0.9207; val_best_acc_score: 0.8557; val_best_f1_score: 0.8616; train_kl_reg_loss: 5354.5224; train_edge_recon_loss: 270554.2549; train_gene_expr_recon_loss: 106329.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382238.4211; train_optim_loss: 382238.4211; val_kl_reg_loss: 5206.9345; val_edge_recon_loss: 273822.6000; val_gene_expr_recon_loss: 106631.4469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385660.9813; val_optim_loss: 385660.9813
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9359; val_auprc_score: 0.9225; val_best_acc_score: 0.8664; val_best_f1_score: 0.8709; train_kl_reg_loss: 5255.5229; train_edge_recon_loss: 268682.4433; train_gene_expr_recon_loss: 106259.2732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380197.2368; train_optim_loss: 380197.2368; val_kl_reg_loss: 5016.5426; val_edge_recon_loss: 273236.2375; val_gene_expr_recon_loss: 105734.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 383987.6250; val_optim_loss: 383987.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9473; val_auprc_score: 0.9373; val_best_acc_score: 0.8790; val_best_f1_score: 0.8834; train_kl_reg_loss: 5117.7257; train_edge_recon_loss: 267847.1053; train_gene_expr_recon_loss: 106009.5086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378974.3396; train_optim_loss: 378974.3396; val_kl_reg_loss: 5034.6160; val_edge_recon_loss: 269545.4688; val_gene_expr_recon_loss: 105658.0297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380238.1125; val_optim_loss: 380238.1125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9542; val_auprc_score: 0.9442; val_best_acc_score: 0.8892; val_best_f1_score: 0.8936; train_kl_reg_loss: 5018.9259; train_edge_recon_loss: 267249.7747; train_gene_expr_recon_loss: 105893.4077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378162.1077; train_optim_loss: 378162.1077; val_kl_reg_loss: 4855.6432; val_edge_recon_loss: 267575.5250; val_gene_expr_recon_loss: 106057.8656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378489.0250; val_optim_loss: 378489.0250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9571; val_auprc_score: 0.9467; val_best_acc_score: 0.8970; val_best_f1_score: 0.9017; train_kl_reg_loss: 4961.6871; train_edge_recon_loss: 266285.3758; train_gene_expr_recon_loss: 105549.8069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376796.8717; train_optim_loss: 376796.8717; val_kl_reg_loss: 4946.8285; val_edge_recon_loss: 269420.4500; val_gene_expr_recon_loss: 105668.0453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380035.3187; val_optim_loss: 380035.3187
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9616; val_auprc_score: 0.9516; val_best_acc_score: 0.9040; val_best_f1_score: 0.9076; train_kl_reg_loss: 4923.6767; train_edge_recon_loss: 266012.7623; train_gene_expr_recon_loss: 105545.4743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376481.9153; train_optim_loss: 376481.9153; val_kl_reg_loss: 4690.6037; val_edge_recon_loss: 269650.2687; val_gene_expr_recon_loss: 105157.9828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379498.8500; val_optim_loss: 379498.8500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9687; val_auprc_score: 0.9594; val_best_acc_score: 0.9173; val_best_f1_score: 0.9197; train_kl_reg_loss: 4884.0181; train_edge_recon_loss: 265212.9293; train_gene_expr_recon_loss: 105358.2165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375455.1661; train_optim_loss: 375455.1661; val_kl_reg_loss: 4808.9799; val_edge_recon_loss: 266966.4375; val_gene_expr_recon_loss: 105414.4656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377189.8937; val_optim_loss: 377189.8937
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9675; val_auprc_score: 0.9585; val_best_acc_score: 0.9153; val_best_f1_score: 0.9174; train_kl_reg_loss: 4868.2348; train_edge_recon_loss: 264481.2278; train_gene_expr_recon_loss: 104939.7985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374289.2599; train_optim_loss: 374289.2599; val_kl_reg_loss: 4827.8180; val_edge_recon_loss: 266673.3937; val_gene_expr_recon_loss: 105593.1109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377094.3187; val_optim_loss: 377094.3187
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9721; val_auprc_score: 0.9636; val_best_acc_score: 0.9253; val_best_f1_score: 0.9271; train_kl_reg_loss: 4828.2338; train_edge_recon_loss: 264538.5835; train_gene_expr_recon_loss: 105291.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374658.1809; train_optim_loss: 374658.1809; val_kl_reg_loss: 4834.6755; val_edge_recon_loss: 266124.6562; val_gene_expr_recon_loss: 104935.8625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375895.1937; val_optim_loss: 375895.1937
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9716; val_auprc_score: 0.9628; val_best_acc_score: 0.9227; val_best_f1_score: 0.9249; train_kl_reg_loss: 4819.7963; train_edge_recon_loss: 263871.2220; train_gene_expr_recon_loss: 104850.0261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373541.0469; train_optim_loss: 373541.0469; val_kl_reg_loss: 4862.8456; val_edge_recon_loss: 266951.4000; val_gene_expr_recon_loss: 105291.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377105.8750; val_optim_loss: 377105.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9748; val_auprc_score: 0.9669; val_best_acc_score: 0.9291; val_best_f1_score: 0.9313; train_kl_reg_loss: 4782.8566; train_edge_recon_loss: 263635.8627; train_gene_expr_recon_loss: 104910.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373328.8791; train_optim_loss: 373328.8791; val_kl_reg_loss: 4766.2331; val_edge_recon_loss: 265458.8500; val_gene_expr_recon_loss: 104790.9578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375016.0500; val_optim_loss: 375016.0500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9788; val_auprc_score: 0.9730; val_best_acc_score: 0.9356; val_best_f1_score: 0.9377; train_kl_reg_loss: 4770.5729; train_edge_recon_loss: 262993.2903; train_gene_expr_recon_loss: 104758.5424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372522.4046; train_optim_loss: 372522.4046; val_kl_reg_loss: 4762.8199; val_edge_recon_loss: 264076.0875; val_gene_expr_recon_loss: 104339.2828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373178.1937; val_optim_loss: 373178.1937
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9795; val_auprc_score: 0.9719; val_best_acc_score: 0.9397; val_best_f1_score: 0.9412; train_kl_reg_loss: 4765.8218; train_edge_recon_loss: 262934.6345; train_gene_expr_recon_loss: 104760.6585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372461.1135; train_optim_loss: 372461.1135; val_kl_reg_loss: 4723.1760; val_edge_recon_loss: 264014.0062; val_gene_expr_recon_loss: 104772.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373509.9125; val_optim_loss: 373509.9125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9798; val_auprc_score: 0.9710; val_best_acc_score: 0.9399; val_best_f1_score: 0.9412; train_kl_reg_loss: 4753.6678; train_edge_recon_loss: 262729.5127; train_gene_expr_recon_loss: 104374.4441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371857.6250; train_optim_loss: 371857.6250; val_kl_reg_loss: 4604.5739; val_edge_recon_loss: 265355.9813; val_gene_expr_recon_loss: 104977.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374937.7000; val_optim_loss: 374937.7000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9839; val_auprc_score: 0.9784; val_best_acc_score: 0.9470; val_best_f1_score: 0.9480; train_kl_reg_loss: 4728.9698; train_edge_recon_loss: 262379.4782; train_gene_expr_recon_loss: 104673.0016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371781.4498; train_optim_loss: 371781.4498; val_kl_reg_loss: 4639.0129; val_edge_recon_loss: 263619.9813; val_gene_expr_recon_loss: 103980.2859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372239.2812; val_optim_loss: 372239.2812
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9840; val_auprc_score: 0.9785; val_best_acc_score: 0.9445; val_best_f1_score: 0.9458; train_kl_reg_loss: 4706.9629; train_edge_recon_loss: 262218.2142; train_gene_expr_recon_loss: 104134.1799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371059.3544; train_optim_loss: 371059.3544; val_kl_reg_loss: 4660.1571; val_edge_recon_loss: 262979.0938; val_gene_expr_recon_loss: 103683.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371323.0062; val_optim_loss: 371323.0062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9840; val_auprc_score: 0.9779; val_best_acc_score: 0.9494; val_best_f1_score: 0.9505; train_kl_reg_loss: 4701.3337; train_edge_recon_loss: 261611.7681; train_gene_expr_recon_loss: 104091.4731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370404.5740; train_optim_loss: 370404.5740; val_kl_reg_loss: 4645.7871; val_edge_recon_loss: 262965.0594; val_gene_expr_recon_loss: 104087.2937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371698.1312; val_optim_loss: 371698.1312
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9847; val_auprc_score: 0.9783; val_best_acc_score: 0.9488; val_best_f1_score: 0.9495; train_kl_reg_loss: 4693.4757; train_edge_recon_loss: 261828.2344; train_gene_expr_recon_loss: 104167.1630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370688.8684; train_optim_loss: 370688.8684; val_kl_reg_loss: 4671.7200; val_edge_recon_loss: 263851.4125; val_gene_expr_recon_loss: 104214.1578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372737.3000; val_optim_loss: 372737.3000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9865; val_auprc_score: 0.9811; val_best_acc_score: 0.9516; val_best_f1_score: 0.9523; train_kl_reg_loss: 4665.4705; train_edge_recon_loss: 261644.1690; train_gene_expr_recon_loss: 104162.6155; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370472.2574; train_optim_loss: 370472.2574; val_kl_reg_loss: 4603.8533; val_edge_recon_loss: 263273.1469; val_gene_expr_recon_loss: 105138.9547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373015.9500; val_optim_loss: 373015.9500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9859; val_auprc_score: 0.9805; val_best_acc_score: 0.9518; val_best_f1_score: 0.9528; train_kl_reg_loss: 4660.1133; train_edge_recon_loss: 261437.4194; train_gene_expr_recon_loss: 103966.5960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370064.1283; train_optim_loss: 370064.1283; val_kl_reg_loss: 4596.1697; val_edge_recon_loss: 262813.5906; val_gene_expr_recon_loss: 103525.7328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370935.4813; val_optim_loss: 370935.4813
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9846; val_auprc_score: 0.9768; val_best_acc_score: 0.9509; val_best_f1_score: 0.9518; train_kl_reg_loss: 4657.9228; train_edge_recon_loss: 261143.7977; train_gene_expr_recon_loss: 103577.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369378.9762; train_optim_loss: 369378.9762; val_kl_reg_loss: 4610.7973; val_edge_recon_loss: 262336.7906; val_gene_expr_recon_loss: 103753.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370700.9938; val_optim_loss: 370700.9938
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9861; val_auprc_score: 0.9810; val_best_acc_score: 0.9535; val_best_f1_score: 0.9546; train_kl_reg_loss: 4661.8581; train_edge_recon_loss: 261054.7200; train_gene_expr_recon_loss: 103579.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369296.1003; train_optim_loss: 369296.1003; val_kl_reg_loss: 4607.8552; val_edge_recon_loss: 262664.2844; val_gene_expr_recon_loss: 103858.0063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371130.1437; val_optim_loss: 371130.1437
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9862; val_auprc_score: 0.9798; val_best_acc_score: 0.9547; val_best_f1_score: 0.9556; train_kl_reg_loss: 4560.5704; train_edge_recon_loss: 260996.4194; train_gene_expr_recon_loss: 103537.8181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369094.8035; train_optim_loss: 369094.8035; val_kl_reg_loss: 4123.2821; val_edge_recon_loss: 261240.1156; val_gene_expr_recon_loss: 103213.1469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368576.5375; val_optim_loss: 368576.5375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9862; val_auprc_score: 0.9805; val_best_acc_score: 0.9529; val_best_f1_score: 0.9537; train_kl_reg_loss: 4190.9157; train_edge_recon_loss: 260769.9494; train_gene_expr_recon_loss: 103748.8583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368709.7245; train_optim_loss: 368709.7245; val_kl_reg_loss: 3838.3750; val_edge_recon_loss: 263112.1625; val_gene_expr_recon_loss: 104094.9500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371045.4875; val_optim_loss: 371045.4875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9867; val_auprc_score: 0.9819; val_best_acc_score: 0.9540; val_best_f1_score: 0.9547; train_kl_reg_loss: 3987.7597; train_edge_recon_loss: 261251.1053; train_gene_expr_recon_loss: 103539.6283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368778.4893; train_optim_loss: 368778.4893; val_kl_reg_loss: 3672.9163; val_edge_recon_loss: 262584.2156; val_gene_expr_recon_loss: 104383.5734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370640.7062; val_optim_loss: 370640.7062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9879; val_auprc_score: 0.9835; val_best_acc_score: 0.9569; val_best_f1_score: 0.9574; train_kl_reg_loss: 3838.2638; train_edge_recon_loss: 260841.6505; train_gene_expr_recon_loss: 103594.1702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368274.0822; train_optim_loss: 368274.0822; val_kl_reg_loss: 3558.5222; val_edge_recon_loss: 261186.3844; val_gene_expr_recon_loss: 104663.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369408.3812; val_optim_loss: 369408.3812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9879; val_auprc_score: 0.9819; val_best_acc_score: 0.9578; val_best_f1_score: 0.9583; train_kl_reg_loss: 3771.6486; train_edge_recon_loss: 260744.7759; train_gene_expr_recon_loss: 103667.9311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368184.3520; train_optim_loss: 368184.3520; val_kl_reg_loss: 3559.1697; val_edge_recon_loss: 261390.4594; val_gene_expr_recon_loss: 103362.5516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368312.1813; val_optim_loss: 368312.1813
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9877; val_auprc_score: 0.9830; val_best_acc_score: 0.9565; val_best_f1_score: 0.9572; train_kl_reg_loss: 3769.2778; train_edge_recon_loss: 260851.2845; train_gene_expr_recon_loss: 103685.4100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368305.9753; train_optim_loss: 368305.9753; val_kl_reg_loss: 3551.9976; val_edge_recon_loss: 261611.5031; val_gene_expr_recon_loss: 103948.9156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369112.4125; val_optim_loss: 369112.4125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9864; val_auprc_score: 0.9813; val_best_acc_score: 0.9551; val_best_f1_score: 0.9558; train_kl_reg_loss: 3760.8535; train_edge_recon_loss: 260706.6246; train_gene_expr_recon_loss: 103637.4190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368104.8980; train_optim_loss: 368104.8980; val_kl_reg_loss: 3545.8212; val_edge_recon_loss: 263585.9844; val_gene_expr_recon_loss: 104103.1812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371234.9875; val_optim_loss: 371234.9875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9883; val_auprc_score: 0.9842; val_best_acc_score: 0.9558; val_best_f1_score: 0.9565; train_kl_reg_loss: 3756.8173; train_edge_recon_loss: 260727.1102; train_gene_expr_recon_loss: 103599.2315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368083.1595; train_optim_loss: 368083.1595; val_kl_reg_loss: 3544.1783; val_edge_recon_loss: 261786.6344; val_gene_expr_recon_loss: 103284.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368615.0438; val_optim_loss: 368615.0438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9860; val_auprc_score: 0.9794; val_best_acc_score: 0.9552; val_best_f1_score: 0.9560; train_kl_reg_loss: 3756.4107; train_edge_recon_loss: 261030.6065; train_gene_expr_recon_loss: 103709.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368496.3273; train_optim_loss: 368496.3273; val_kl_reg_loss: 3543.7597; val_edge_recon_loss: 262980.5406; val_gene_expr_recon_loss: 104039.5734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370563.8875; val_optim_loss: 370563.8875
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9857; val_auprc_score: 0.9809; val_best_acc_score: 0.9530; val_best_f1_score: 0.9539; train_kl_reg_loss: 3756.0152; train_edge_recon_loss: 260851.9449; train_gene_expr_recon_loss: 103518.8914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368126.8528; train_optim_loss: 368126.8528; val_kl_reg_loss: 3543.5874; val_edge_recon_loss: 262449.2438; val_gene_expr_recon_loss: 103043.5797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369036.4062; val_optim_loss: 369036.4062
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9870; val_auprc_score: 0.9818; val_best_acc_score: 0.9561; val_best_f1_score: 0.9567; train_kl_reg_loss: 3754.4808; train_edge_recon_loss: 260888.6600; train_gene_expr_recon_loss: 103621.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368265.0518; train_optim_loss: 368265.0518; val_kl_reg_loss: 3545.0856; val_edge_recon_loss: 262676.0563; val_gene_expr_recon_loss: 103314.8687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369536.0000; val_optim_loss: 369536.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 45 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9861
Val AUPRC score: 0.9800
Val best accuracy score: 0.9535
Val best F1 score: 0.9543
Val gene expr MSE score: 0.2374
Duration of model training in run 4: 0 hours, 4 minutes and 49 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 113008
Number of validation edges: 12556
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9244; val_auprc_score: 0.9114; val_best_acc_score: 0.8547; val_best_f1_score: 0.8613; train_kl_reg_loss: 5883.0233; train_edge_recon_loss: 296872.4958; train_gene_expr_recon_loss: 109129.1249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411884.6441; train_optim_loss: 411884.6441; val_kl_reg_loss: 5532.8632; val_edge_recon_loss: 273906.4495; val_gene_expr_recon_loss: 109052.0409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388491.3486; val_optim_loss: 388491.3486
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9451; val_auprc_score: 0.9334; val_best_acc_score: 0.8789; val_best_f1_score: 0.8845; train_kl_reg_loss: 5273.5366; train_edge_recon_loss: 269896.9589; train_gene_expr_recon_loss: 106856.1586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382026.6560; train_optim_loss: 382026.6560; val_kl_reg_loss: 5145.8777; val_edge_recon_loss: 270894.6466; val_gene_expr_recon_loss: 108217.5457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384258.0625; val_optim_loss: 384258.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9614; val_auprc_score: 0.9510; val_best_acc_score: 0.9032; val_best_f1_score: 0.9071; train_kl_reg_loss: 4985.4162; train_edge_recon_loss: 267530.1289; train_gene_expr_recon_loss: 106293.4352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378808.9811; train_optim_loss: 378808.9811; val_kl_reg_loss: 4879.1839; val_edge_recon_loss: 267710.4832; val_gene_expr_recon_loss: 108526.1070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381115.7716; val_optim_loss: 381115.7716
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9709; val_auprc_score: 0.9640; val_best_acc_score: 0.9192; val_best_f1_score: 0.9220; train_kl_reg_loss: 4813.6424; train_edge_recon_loss: 265726.5414; train_gene_expr_recon_loss: 105883.3708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376423.5535; train_optim_loss: 376423.5535; val_kl_reg_loss: 4698.8512; val_edge_recon_loss: 265212.2308; val_gene_expr_recon_loss: 107151.6959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377062.7740; val_optim_loss: 377062.7740
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9766; val_auprc_score: 0.9687; val_best_acc_score: 0.9329; val_best_f1_score: 0.9348; train_kl_reg_loss: 4720.0716; train_edge_recon_loss: 264811.8577; train_gene_expr_recon_loss: 105745.7506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375277.6793; train_optim_loss: 375277.6793; val_kl_reg_loss: 4669.6105; val_edge_recon_loss: 264967.8594; val_gene_expr_recon_loss: 107000.4044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376637.8750; val_optim_loss: 376637.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9835; val_auprc_score: 0.9785; val_best_acc_score: 0.9454; val_best_f1_score: 0.9464; train_kl_reg_loss: 4673.4598; train_edge_recon_loss: 264187.1425; train_gene_expr_recon_loss: 105388.7495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374249.3519; train_optim_loss: 374249.3519; val_kl_reg_loss: 4541.0493; val_edge_recon_loss: 263474.5601; val_gene_expr_recon_loss: 108092.7746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376108.3846; val_optim_loss: 376108.3846
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9867; val_auprc_score: 0.9816; val_best_acc_score: 0.9525; val_best_f1_score: 0.9531; train_kl_reg_loss: 4650.5765; train_edge_recon_loss: 262621.3730; train_gene_expr_recon_loss: 105315.3036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372587.2545; train_optim_loss: 372587.2545; val_kl_reg_loss: 4685.8867; val_edge_recon_loss: 261683.6130; val_gene_expr_recon_loss: 106926.3221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373295.8221; val_optim_loss: 373295.8221
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9884; val_auprc_score: 0.9852; val_best_acc_score: 0.9577; val_best_f1_score: 0.9583; train_kl_reg_loss: 4623.9128; train_edge_recon_loss: 262241.1737; train_gene_expr_recon_loss: 105023.0995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371888.1855; train_optim_loss: 371888.1855; val_kl_reg_loss: 4518.4449; val_edge_recon_loss: 262369.6923; val_gene_expr_recon_loss: 105710.5847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372598.7188; val_optim_loss: 372598.7188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9876; val_auprc_score: 0.9826; val_best_acc_score: 0.9571; val_best_f1_score: 0.9577; train_kl_reg_loss: 4595.3769; train_edge_recon_loss: 261397.1453; train_gene_expr_recon_loss: 104847.5679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370840.0867; train_optim_loss: 370840.0867; val_kl_reg_loss: 4490.6484; val_edge_recon_loss: 261454.6418; val_gene_expr_recon_loss: 106707.2602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372652.5553; val_optim_loss: 372652.5553
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9896; val_auprc_score: 0.9846; val_best_acc_score: 0.9611; val_best_f1_score: 0.9617; train_kl_reg_loss: 4567.1938; train_edge_recon_loss: 260882.1257; train_gene_expr_recon_loss: 104491.3378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369940.6577; train_optim_loss: 369940.6577; val_kl_reg_loss: 4465.1239; val_edge_recon_loss: 260449.5481; val_gene_expr_recon_loss: 105939.6761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370854.3486; val_optim_loss: 370854.3486
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9899; val_auprc_score: 0.9861; val_best_acc_score: 0.9624; val_best_f1_score: 0.9629; train_kl_reg_loss: 4525.3589; train_edge_recon_loss: 260851.6758; train_gene_expr_recon_loss: 104295.1478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369672.1830; train_optim_loss: 369672.1830; val_kl_reg_loss: 4497.7027; val_edge_recon_loss: 260663.6430; val_gene_expr_recon_loss: 106485.0373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371646.3822; val_optim_loss: 371646.3822
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9918; val_auprc_score: 0.9891; val_best_acc_score: 0.9665; val_best_f1_score: 0.9670; train_kl_reg_loss: 4507.6743; train_edge_recon_loss: 260854.8546; train_gene_expr_recon_loss: 104115.2731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369477.8004; train_optim_loss: 369477.8004; val_kl_reg_loss: 4398.2950; val_edge_recon_loss: 260039.1863; val_gene_expr_recon_loss: 105190.0661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369627.5433; val_optim_loss: 369627.5433
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9925; val_auprc_score: 0.9896; val_best_acc_score: 0.9668; val_best_f1_score: 0.9671; train_kl_reg_loss: 4481.0842; train_edge_recon_loss: 260537.5079; train_gene_expr_recon_loss: 104333.0685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369351.6630; train_optim_loss: 369351.6630; val_kl_reg_loss: 4300.7612; val_edge_recon_loss: 259670.4772; val_gene_expr_recon_loss: 105587.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369558.2716; val_optim_loss: 369558.2716
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9923; val_auprc_score: 0.9887; val_best_acc_score: 0.9667; val_best_f1_score: 0.9671; train_kl_reg_loss: 4463.4269; train_edge_recon_loss: 260333.0256; train_gene_expr_recon_loss: 104030.8055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368827.2573; train_optim_loss: 368827.2573; val_kl_reg_loss: 4390.0759; val_edge_recon_loss: 260643.6863; val_gene_expr_recon_loss: 104748.7524; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369782.5168; val_optim_loss: 369782.5168
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9931; val_auprc_score: 0.9913; val_best_acc_score: 0.9688; val_best_f1_score: 0.9691; train_kl_reg_loss: 4454.1923; train_edge_recon_loss: 260141.8139; train_gene_expr_recon_loss: 104048.8960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368644.9029; train_optim_loss: 368644.9029; val_kl_reg_loss: 4422.7591; val_edge_recon_loss: 259395.6550; val_gene_expr_recon_loss: 105099.0090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368917.4279; val_optim_loss: 368917.4279
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9936; val_auprc_score: 0.9911; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 4442.4729; train_edge_recon_loss: 259866.1394; train_gene_expr_recon_loss: 103393.5013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367702.1135; train_optim_loss: 367702.1135; val_kl_reg_loss: 4338.2999; val_edge_recon_loss: 259624.5589; val_gene_expr_recon_loss: 105138.5024; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369101.3582; val_optim_loss: 369101.3582
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9937; val_auprc_score: 0.9913; val_best_acc_score: 0.9699; val_best_f1_score: 0.9701; train_kl_reg_loss: 4429.8667; train_edge_recon_loss: 259967.5023; train_gene_expr_recon_loss: 103492.1189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367889.4868; train_optim_loss: 367889.4868; val_kl_reg_loss: 4355.0136; val_edge_recon_loss: 259828.0036; val_gene_expr_recon_loss: 103140.1737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367323.1899; val_optim_loss: 367323.1899
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9939; val_auprc_score: 0.9917; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 4424.6049; train_edge_recon_loss: 259729.8770; train_gene_expr_recon_loss: 104032.4170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368186.8981; train_optim_loss: 368186.8981; val_kl_reg_loss: 4381.9431; val_edge_recon_loss: 259383.7500; val_gene_expr_recon_loss: 104623.5288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368389.2236; val_optim_loss: 368389.2236
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9937; val_auprc_score: 0.9908; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 4407.8626; train_edge_recon_loss: 259506.4954; train_gene_expr_recon_loss: 103643.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367557.4105; train_optim_loss: 367557.4105; val_kl_reg_loss: 4416.7983; val_edge_recon_loss: 260193.4976; val_gene_expr_recon_loss: 105054.7091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369665.0048; val_optim_loss: 369665.0048
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9940; val_auprc_score: 0.9917; val_best_acc_score: 0.9732; val_best_f1_score: 0.9733; train_kl_reg_loss: 4418.7841; train_edge_recon_loss: 259367.8080; train_gene_expr_recon_loss: 103103.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366890.4994; train_optim_loss: 366890.4994; val_kl_reg_loss: 4321.3451; val_edge_recon_loss: 259621.7644; val_gene_expr_recon_loss: 103452.2428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367395.3558; val_optim_loss: 367395.3558

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9945; val_auprc_score: 0.9923; val_best_acc_score: 0.9728; val_best_f1_score: 0.9730; train_kl_reg_loss: 4411.6797; train_edge_recon_loss: 258978.2262; train_gene_expr_recon_loss: 103689.5736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367079.4803; train_optim_loss: 367079.4803; val_kl_reg_loss: 4378.5983; val_edge_recon_loss: 259102.4868; val_gene_expr_recon_loss: 104106.3534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367587.4399; val_optim_loss: 367587.4399
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9953; val_auprc_score: 0.9943; val_best_acc_score: 0.9742; val_best_f1_score: 0.9744; train_kl_reg_loss: 4412.9166; train_edge_recon_loss: 259050.8491; train_gene_expr_recon_loss: 102676.4060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366140.1743; train_optim_loss: 366140.1743; val_kl_reg_loss: 4372.8338; val_edge_recon_loss: 259051.7212; val_gene_expr_recon_loss: 104161.8005; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367586.3510; val_optim_loss: 367586.3510
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9947; val_auprc_score: 0.9917; val_best_acc_score: 0.9740; val_best_f1_score: 0.9741; train_kl_reg_loss: 4410.3757; train_edge_recon_loss: 259126.2779; train_gene_expr_recon_loss: 103011.7269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366548.3801; train_optim_loss: 366548.3801; val_kl_reg_loss: 4375.0217; val_edge_recon_loss: 258254.5457; val_gene_expr_recon_loss: 105343.4970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367973.0649; val_optim_loss: 367973.0649

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 51 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9931
Val AUPRC score: 0.9903
Val best accuracy score: 0.9696
Val best F1 score: 0.9698
Val gene expr MSE score: 0.2388
Duration of model training in run 5: 0 hours, 7 minutes and 1 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 113008
Number of validation edges: 12556
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9236; val_auprc_score: 0.9118; val_best_acc_score: 0.8507; val_best_f1_score: 0.8573; train_kl_reg_loss: 6086.4412; train_edge_recon_loss: 298880.0172; train_gene_expr_recon_loss: 108842.8790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413809.3376; train_optim_loss: 413809.3376; val_kl_reg_loss: 5734.7556; val_edge_recon_loss: 273637.9591; val_gene_expr_recon_loss: 107896.9910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387269.6995; val_optim_loss: 387269.6995
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9490; val_auprc_score: 0.9384; val_best_acc_score: 0.8859; val_best_f1_score: 0.8900; train_kl_reg_loss: 5274.8109; train_edge_recon_loss: 270065.7477; train_gene_expr_recon_loss: 107049.2883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382389.8477; train_optim_loss: 382389.8477; val_kl_reg_loss: 5071.9040; val_edge_recon_loss: 268607.1226; val_gene_expr_recon_loss: 107149.4471; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380828.4808; val_optim_loss: 380828.4808
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9599; val_auprc_score: 0.9495; val_best_acc_score: 0.9006; val_best_f1_score: 0.9051; train_kl_reg_loss: 4979.5965; train_edge_recon_loss: 267447.8840; train_gene_expr_recon_loss: 106123.5945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378551.0752; train_optim_loss: 378551.0752; val_kl_reg_loss: 4706.7009; val_edge_recon_loss: 267122.1899; val_gene_expr_recon_loss: 106549.9934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378378.8870; val_optim_loss: 378378.8870
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9735; val_auprc_score: 0.9677; val_best_acc_score: 0.9231; val_best_f1_score: 0.9256; train_kl_reg_loss: 4795.7822; train_edge_recon_loss: 265628.3129; train_gene_expr_recon_loss: 105655.8553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376079.9476; train_optim_loss: 376079.9476; val_kl_reg_loss: 4655.6108; val_edge_recon_loss: 265113.2079; val_gene_expr_recon_loss: 106676.9886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376445.8077; val_optim_loss: 376445.8077
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9800; val_auprc_score: 0.9733; val_best_acc_score: 0.9368; val_best_f1_score: 0.9381; train_kl_reg_loss: 4712.9474; train_edge_recon_loss: 264173.8799; train_gene_expr_recon_loss: 106384.9120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375271.7387; train_optim_loss: 375271.7387; val_kl_reg_loss: 4574.7412; val_edge_recon_loss: 264862.5649; val_gene_expr_recon_loss: 105973.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375411.2212; val_optim_loss: 375411.2212
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9840; val_auprc_score: 0.9784; val_best_acc_score: 0.9463; val_best_f1_score: 0.9474; train_kl_reg_loss: 4686.8319; train_edge_recon_loss: 263184.5724; train_gene_expr_recon_loss: 105287.6981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373159.1036; train_optim_loss: 373159.1036; val_kl_reg_loss: 4617.3169; val_edge_recon_loss: 263583.0337; val_gene_expr_recon_loss: 104789.4772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372989.8341; val_optim_loss: 372989.8341
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9867; val_auprc_score: 0.9814; val_best_acc_score: 0.9560; val_best_f1_score: 0.9569; train_kl_reg_loss: 4654.8357; train_edge_recon_loss: 262386.2957; train_gene_expr_recon_loss: 105181.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372222.3998; train_optim_loss: 372222.3998; val_kl_reg_loss: 4565.0552; val_edge_recon_loss: 262255.3077; val_gene_expr_recon_loss: 106563.0072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373383.3678; val_optim_loss: 373383.3678
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9872; val_auprc_score: 0.9823; val_best_acc_score: 0.9572; val_best_f1_score: 0.9578; train_kl_reg_loss: 4609.9976; train_edge_recon_loss: 261865.7448; train_gene_expr_recon_loss: 105002.2262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371477.9704; train_optim_loss: 371477.9704; val_kl_reg_loss: 4413.8635; val_edge_recon_loss: 261111.7488; val_gene_expr_recon_loss: 104955.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370481.5216; val_optim_loss: 370481.5216
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9893; val_auprc_score: 0.9848; val_best_acc_score: 0.9624; val_best_f1_score: 0.9631; train_kl_reg_loss: 4573.7934; train_edge_recon_loss: 261426.1636; train_gene_expr_recon_loss: 104725.9469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370725.9015; train_optim_loss: 370725.9015; val_kl_reg_loss: 4466.8749; val_edge_recon_loss: 261772.2873; val_gene_expr_recon_loss: 104895.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371134.7933; val_optim_loss: 371134.7933
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9904; val_auprc_score: 0.9862; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 4538.3438; train_edge_recon_loss: 261081.0725; train_gene_expr_recon_loss: 104569.0244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370188.4403; train_optim_loss: 370188.4403; val_kl_reg_loss: 4439.0983; val_edge_recon_loss: 260424.7704; val_gene_expr_recon_loss: 104988.7332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369852.6010; val_optim_loss: 369852.6010
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9911; val_auprc_score: 0.9878; val_best_acc_score: 0.9666; val_best_f1_score: 0.9669; train_kl_reg_loss: 4514.5066; train_edge_recon_loss: 260835.5224; train_gene_expr_recon_loss: 104001.1223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369351.1509; train_optim_loss: 369351.1509; val_kl_reg_loss: 4519.3400; val_edge_recon_loss: 261444.3870; val_gene_expr_recon_loss: 104952.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370915.8077; val_optim_loss: 370915.8077
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9911; val_auprc_score: 0.9874; val_best_acc_score: 0.9670; val_best_f1_score: 0.9675; train_kl_reg_loss: 4496.8147; train_edge_recon_loss: 260506.8195; train_gene_expr_recon_loss: 104157.6432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369161.2756; train_optim_loss: 369161.2756; val_kl_reg_loss: 4432.4897; val_edge_recon_loss: 260444.0493; val_gene_expr_recon_loss: 105185.1538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370061.6923; val_optim_loss: 370061.6923
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9932; val_auprc_score: 0.9907; val_best_acc_score: 0.9703; val_best_f1_score: 0.9706; train_kl_reg_loss: 4478.7942; train_edge_recon_loss: 260198.2867; train_gene_expr_recon_loss: 104248.4388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368925.5197; train_optim_loss: 368925.5197; val_kl_reg_loss: 4476.1359; val_edge_recon_loss: 258659.0060; val_gene_expr_recon_loss: 104802.9603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367938.1010; val_optim_loss: 367938.1010
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9926; val_auprc_score: 0.9893; val_best_acc_score: 0.9695; val_best_f1_score: 0.9699; train_kl_reg_loss: 4456.2818; train_edge_recon_loss: 259842.6838; train_gene_expr_recon_loss: 103768.3285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368067.2928; train_optim_loss: 368067.2928; val_kl_reg_loss: 4425.7740; val_edge_recon_loss: 260038.3534; val_gene_expr_recon_loss: 104347.6581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368811.7837; val_optim_loss: 368811.7837
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9925; val_auprc_score: 0.9894; val_best_acc_score: 0.9700; val_best_f1_score: 0.9704; train_kl_reg_loss: 4443.0051; train_edge_recon_loss: 260004.5694; train_gene_expr_recon_loss: 103992.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368439.8559; train_optim_loss: 368439.8559; val_kl_reg_loss: 4369.3069; val_edge_recon_loss: 260296.1478; val_gene_expr_recon_loss: 105169.6430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369835.1010; val_optim_loss: 369835.1010
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9939; val_auprc_score: 0.9909; val_best_acc_score: 0.9722; val_best_f1_score: 0.9724; train_kl_reg_loss: 4426.0302; train_edge_recon_loss: 260086.9562; train_gene_expr_recon_loss: 103505.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368018.6627; train_optim_loss: 368018.6627; val_kl_reg_loss: 4425.1746; val_edge_recon_loss: 259573.1827; val_gene_expr_recon_loss: 104230.8083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368229.1635; val_optim_loss: 368229.1635

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9941; val_auprc_score: 0.9921; val_best_acc_score: 0.9721; val_best_f1_score: 0.9723; train_kl_reg_loss: 4425.5391; train_edge_recon_loss: 259413.1986; train_gene_expr_recon_loss: 102913.1873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366751.9254; train_optim_loss: 366751.9254; val_kl_reg_loss: 4381.4644; val_edge_recon_loss: 259452.9772; val_gene_expr_recon_loss: 103628.6472; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367463.0793; val_optim_loss: 367463.0793
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 4413.8397; train_edge_recon_loss: 259754.7199; train_gene_expr_recon_loss: 103038.4124; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367206.9682; train_optim_loss: 367206.9682; val_kl_reg_loss: 4356.1680; val_edge_recon_loss: 258002.6010; val_gene_expr_recon_loss: 102691.4892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365050.2620; val_optim_loss: 365050.2620
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9940; val_auprc_score: 0.9912; val_best_acc_score: 0.9720; val_best_f1_score: 0.9722; train_kl_reg_loss: 4405.8647; train_edge_recon_loss: 259514.7962; train_gene_expr_recon_loss: 103095.9849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367016.6464; train_optim_loss: 367016.6464; val_kl_reg_loss: 4379.3271; val_edge_recon_loss: 259309.3017; val_gene_expr_recon_loss: 103383.1244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367071.7500; val_optim_loss: 367071.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9938; val_auprc_score: 0.9912; val_best_acc_score: 0.9727; val_best_f1_score: 0.9729; train_kl_reg_loss: 4414.7263; train_edge_recon_loss: 259553.7062; train_gene_expr_recon_loss: 103058.6579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367027.0918; train_optim_loss: 367027.0918; val_kl_reg_loss: 4347.8091; val_edge_recon_loss: 259562.2656; val_gene_expr_recon_loss: 104199.0126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368109.0841; val_optim_loss: 368109.0841
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9939; val_auprc_score: 0.9915; val_best_acc_score: 0.9724; val_best_f1_score: 0.9727; train_kl_reg_loss: 4408.1851; train_edge_recon_loss: 259433.1760; train_gene_expr_recon_loss: 103277.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367118.6287; train_optim_loss: 367118.6287; val_kl_reg_loss: 4385.6579; val_edge_recon_loss: 260354.6562; val_gene_expr_recon_loss: 104247.1496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368987.4639; val_optim_loss: 368987.4639

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9943; val_auprc_score: 0.9917; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 4412.4880; train_edge_recon_loss: 259481.5336; train_gene_expr_recon_loss: 103491.1520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367385.1720; train_optim_loss: 367385.1720; val_kl_reg_loss: 4370.4861; val_edge_recon_loss: 259289.6923; val_gene_expr_recon_loss: 103737.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367397.2332; val_optim_loss: 367397.2332
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9938; val_auprc_score: 0.9912; val_best_acc_score: 0.9726; val_best_f1_score: 0.9729; train_kl_reg_loss: 4405.5152; train_edge_recon_loss: 259446.6320; train_gene_expr_recon_loss: 103368.7758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367220.9245; train_optim_loss: 367220.9245; val_kl_reg_loss: 4372.6020; val_edge_recon_loss: 260559.6094; val_gene_expr_recon_loss: 102669.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367601.7812; val_optim_loss: 367601.7812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9941; val_auprc_score: 0.9919; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 4409.3741; train_edge_recon_loss: 259066.2216; train_gene_expr_recon_loss: 103166.4932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366642.0878; train_optim_loss: 366642.0878; val_kl_reg_loss: 4366.2687; val_edge_recon_loss: 257710.6214; val_gene_expr_recon_loss: 102722.4886; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364799.3774; val_optim_loss: 364799.3774
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9947; val_auprc_score: 0.9914; val_best_acc_score: 0.9740; val_best_f1_score: 0.9742; train_kl_reg_loss: 4406.3121; train_edge_recon_loss: 259363.3819; train_gene_expr_recon_loss: 102876.8952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366646.5895; train_optim_loss: 366646.5895; val_kl_reg_loss: 4370.2174; val_edge_recon_loss: 258582.3942; val_gene_expr_recon_loss: 103578.2434; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366530.8534; val_optim_loss: 366530.8534
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9943; val_auprc_score: 0.9917; val_best_acc_score: 0.9725; val_best_f1_score: 0.9729; train_kl_reg_loss: 4388.8664; train_edge_recon_loss: 259416.6306; train_gene_expr_recon_loss: 102774.3869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366579.8832; train_optim_loss: 366579.8832; val_kl_reg_loss: 4168.0601; val_edge_recon_loss: 259357.8762; val_gene_expr_recon_loss: 102690.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366216.5216; val_optim_loss: 366216.5216
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9944; val_auprc_score: 0.9918; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 4355.0773; train_edge_recon_loss: 259218.8522; train_gene_expr_recon_loss: 103486.7772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367060.7058; train_optim_loss: 367060.7058; val_kl_reg_loss: 4131.9165; val_edge_recon_loss: 258946.0228; val_gene_expr_recon_loss: 103344.6629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366422.5962; val_optim_loss: 366422.5962

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9933; val_auprc_score: 0.9889; val_best_acc_score: 0.9735; val_best_f1_score: 0.9738; train_kl_reg_loss: 4334.9360; train_edge_recon_loss: 259205.0453; train_gene_expr_recon_loss: 103240.1918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366780.1751; train_optim_loss: 366780.1751; val_kl_reg_loss: 4134.3314; val_edge_recon_loss: 259495.6022; val_gene_expr_recon_loss: 102537.0559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366166.9856; val_optim_loss: 366166.9856
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9946; val_auprc_score: 0.9919; val_best_acc_score: 0.9746; val_best_f1_score: 0.9750; train_kl_reg_loss: 4331.6970; train_edge_recon_loss: 259365.4521; train_gene_expr_recon_loss: 103230.4206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366927.5707; train_optim_loss: 366927.5707; val_kl_reg_loss: 4125.8323; val_edge_recon_loss: 258581.0180; val_gene_expr_recon_loss: 102983.4621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365690.3125; val_optim_loss: 365690.3125
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9940; val_auprc_score: 0.9907; val_best_acc_score: 0.9729; val_best_f1_score: 0.9731; train_kl_reg_loss: 4328.5935; train_edge_recon_loss: 259253.1847; train_gene_expr_recon_loss: 102973.5876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366555.3654; train_optim_loss: 366555.3654; val_kl_reg_loss: 4121.2532; val_edge_recon_loss: 260059.4207; val_gene_expr_recon_loss: 102931.3912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367112.0649; val_optim_loss: 367112.0649

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 26 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9945
Val AUPRC score: 0.9917
Val best accuracy score: 0.9740
Val best F1 score: 0.9743
Val gene expr MSE score: 0.2304
Duration of model training in run 6: 0 hours, 9 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 149579
Number of validation edges: 16619
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9542; val_auprc_score: 0.9421; val_best_acc_score: 0.8945; val_best_f1_score: 0.8983; train_kl_reg_loss: 5472.1329; train_edge_recon_loss: 283641.3612; train_gene_expr_recon_loss: 108478.0587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397591.5519; train_optim_loss: 397591.5519; val_kl_reg_loss: 4810.8100; val_edge_recon_loss: 267474.6151; val_gene_expr_recon_loss: 106195.7585; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378481.1856; val_optim_loss: 378481.1856
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9779; val_auprc_score: 0.9706; val_best_acc_score: 0.9353; val_best_f1_score: 0.9373; train_kl_reg_loss: 4775.6360; train_edge_recon_loss: 266064.1291; train_gene_expr_recon_loss: 106760.0917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377599.8568; train_optim_loss: 377599.8568; val_kl_reg_loss: 4573.3077; val_edge_recon_loss: 263842.1795; val_gene_expr_recon_loss: 105011.5618; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373427.0473; val_optim_loss: 373427.0473
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9855; val_auprc_score: 0.9812; val_best_acc_score: 0.9504; val_best_f1_score: 0.9513; train_kl_reg_loss: 4627.4639; train_edge_recon_loss: 263314.6482; train_gene_expr_recon_loss: 105907.7607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373849.8731; train_optim_loss: 373849.8731; val_kl_reg_loss: 4475.0094; val_edge_recon_loss: 262113.9697; val_gene_expr_recon_loss: 104675.2027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371264.1790; val_optim_loss: 371264.1790
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9887; val_auprc_score: 0.9846; val_best_acc_score: 0.9580; val_best_f1_score: 0.9585; train_kl_reg_loss: 4540.7942; train_edge_recon_loss: 261607.1605; train_gene_expr_recon_loss: 105382.2729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371530.2275; train_optim_loss: 371530.2275; val_kl_reg_loss: 4447.6531; val_edge_recon_loss: 261670.1264; val_gene_expr_recon_loss: 104072.6494; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370190.4299; val_optim_loss: 370190.4299
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9905; val_auprc_score: 0.9870; val_best_acc_score: 0.9625; val_best_f1_score: 0.9631; train_kl_reg_loss: 4472.1238; train_edge_recon_loss: 260977.0490; train_gene_expr_recon_loss: 104826.3605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370275.5333; train_optim_loss: 370275.5333; val_kl_reg_loss: 4367.0767; val_edge_recon_loss: 260947.6463; val_gene_expr_recon_loss: 103450.6428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368765.3684; val_optim_loss: 368765.3684
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9877; val_best_acc_score: 0.9651; val_best_f1_score: 0.9656; train_kl_reg_loss: 4438.5225; train_edge_recon_loss: 260152.7453; train_gene_expr_recon_loss: 104583.8414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369175.1079; train_optim_loss: 369175.1079; val_kl_reg_loss: 4475.8563; val_edge_recon_loss: 260610.8059; val_gene_expr_recon_loss: 102776.0109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367862.6780; val_optim_loss: 367862.6780
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9934; val_auprc_score: 0.9909; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 4413.7570; train_edge_recon_loss: 260024.8204; train_gene_expr_recon_loss: 104456.4816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368895.0584; train_optim_loss: 368895.0584; val_kl_reg_loss: 4338.2738; val_edge_recon_loss: 260268.5336; val_gene_expr_recon_loss: 103407.2959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368014.1051; val_optim_loss: 368014.1051
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9938; val_auprc_score: 0.9910; val_best_acc_score: 0.9702; val_best_f1_score: 0.9705; train_kl_reg_loss: 4399.0019; train_edge_recon_loss: 259733.5916; train_gene_expr_recon_loss: 104057.0031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368189.5980; train_optim_loss: 368189.5980; val_kl_reg_loss: 4334.8861; val_edge_recon_loss: 258890.8461; val_gene_expr_recon_loss: 102702.5336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365928.2699; val_optim_loss: 365928.2699
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9937; val_auprc_score: 0.9900; val_best_acc_score: 0.9713; val_best_f1_score: 0.9715; train_kl_reg_loss: 4388.7990; train_edge_recon_loss: 259604.1214; train_gene_expr_recon_loss: 103853.3666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367846.2863; train_optim_loss: 367846.2863; val_kl_reg_loss: 4421.6742; val_edge_recon_loss: 259868.0175; val_gene_expr_recon_loss: 102621.3459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366911.0350; val_optim_loss: 366911.0350
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9944; val_auprc_score: 0.9916; val_best_acc_score: 0.9742; val_best_f1_score: 0.9745; train_kl_reg_loss: 4384.8851; train_edge_recon_loss: 259470.5980; train_gene_expr_recon_loss: 103606.4013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367461.8848; train_optim_loss: 367461.8848; val_kl_reg_loss: 4413.2326; val_edge_recon_loss: 258753.3726; val_gene_expr_recon_loss: 102361.6127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365528.2206; val_optim_loss: 365528.2206
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 4391.2886; train_edge_recon_loss: 259156.8411; train_gene_expr_recon_loss: 103720.8699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367268.9989; train_optim_loss: 367268.9989; val_kl_reg_loss: 4308.8661; val_edge_recon_loss: 258081.8698; val_gene_expr_recon_loss: 102139.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364530.0445; val_optim_loss: 364530.0445
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9945; val_auprc_score: 0.9922; val_best_acc_score: 0.9740; val_best_f1_score: 0.9743; train_kl_reg_loss: 4385.3579; train_edge_recon_loss: 258834.9826; train_gene_expr_recon_loss: 103393.6428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366613.9835; train_optim_loss: 366613.9835; val_kl_reg_loss: 4490.7195; val_edge_recon_loss: 258737.7064; val_gene_expr_recon_loss: 102203.0611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365431.4886; val_optim_loss: 365431.4886
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9948; val_auprc_score: 0.9905; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 4388.2561; train_edge_recon_loss: 258641.4496; train_gene_expr_recon_loss: 103324.9614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366354.6678; train_optim_loss: 366354.6678; val_kl_reg_loss: 4376.8848; val_edge_recon_loss: 257722.2296; val_gene_expr_recon_loss: 102888.7154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364987.8277; val_optim_loss: 364987.8277
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9947; val_auprc_score: 0.9910; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 4385.7314; train_edge_recon_loss: 258736.5677; train_gene_expr_recon_loss: 103232.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366354.7315; train_optim_loss: 366354.7315; val_kl_reg_loss: 4260.9668; val_edge_recon_loss: 258091.7604; val_gene_expr_recon_loss: 101910.2060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364262.9299; val_optim_loss: 364262.9299
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9955; val_auprc_score: 0.9927; val_best_acc_score: 0.9785; val_best_f1_score: 0.9787; train_kl_reg_loss: 4393.3143; train_edge_recon_loss: 258442.9921; train_gene_expr_recon_loss: 103226.4612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366062.7665; train_optim_loss: 366062.7665; val_kl_reg_loss: 4349.2032; val_edge_recon_loss: 257311.0582; val_gene_expr_recon_loss: 102502.2827; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364162.5445; val_optim_loss: 364162.5445
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9959; val_auprc_score: 0.9932; val_best_acc_score: 0.9792; val_best_f1_score: 0.9795; train_kl_reg_loss: 4395.2674; train_edge_recon_loss: 258177.2377; train_gene_expr_recon_loss: 103250.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365822.7830; train_optim_loss: 365822.7830; val_kl_reg_loss: 4366.9722; val_edge_recon_loss: 257397.3636; val_gene_expr_recon_loss: 101939.3049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363703.6420; val_optim_loss: 363703.6420
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9959; val_auprc_score: 0.9941; val_best_acc_score: 0.9792; val_best_f1_score: 0.9793; train_kl_reg_loss: 4391.9908; train_edge_recon_loss: 258284.0633; train_gene_expr_recon_loss: 103130.7012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365806.7549; train_optim_loss: 365806.7549; val_kl_reg_loss: 4469.4858; val_edge_recon_loss: 258005.6922; val_gene_expr_recon_loss: 101926.9214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364402.1004; val_optim_loss: 364402.1004
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9952; val_auprc_score: 0.9923; val_best_acc_score: 0.9784; val_best_f1_score: 0.9787; train_kl_reg_loss: 4396.5038; train_edge_recon_loss: 258221.3719; train_gene_expr_recon_loss: 103060.4544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365678.3311; train_optim_loss: 365678.3311; val_kl_reg_loss: 4342.2615; val_edge_recon_loss: 257367.8655; val_gene_expr_recon_loss: 101906.7689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363616.8939; val_optim_loss: 363616.8939
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9963; val_auprc_score: 0.9946; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 4397.7717; train_edge_recon_loss: 258064.4081; train_gene_expr_recon_loss: 103079.6609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365541.8412; train_optim_loss: 365541.8412; val_kl_reg_loss: 4314.9491; val_edge_recon_loss: 257330.9702; val_gene_expr_recon_loss: 102835.3554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364481.2794; val_optim_loss: 364481.2794
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9964; val_auprc_score: 0.9946; val_best_acc_score: 0.9808; val_best_f1_score: 0.9809; train_kl_reg_loss: 4400.0728; train_edge_recon_loss: 257903.0806; train_gene_expr_recon_loss: 102833.2069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365136.3591; train_optim_loss: 365136.3591; val_kl_reg_loss: 4449.7949; val_edge_recon_loss: 257175.8428; val_gene_expr_recon_loss: 102282.6326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363908.2699; val_optim_loss: 363908.2699
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9961; val_auprc_score: 0.9937; val_best_acc_score: 0.9806; val_best_f1_score: 0.9808; train_kl_reg_loss: 4402.8252; train_edge_recon_loss: 257947.8810; train_gene_expr_recon_loss: 102697.2596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365047.9661; train_optim_loss: 365047.9661; val_kl_reg_loss: 4433.9594; val_edge_recon_loss: 257034.0848; val_gene_expr_recon_loss: 102598.8857; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364066.9290; val_optim_loss: 364066.9290

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9963; val_auprc_score: 0.9935; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 4420.0237; train_edge_recon_loss: 257534.9360; train_gene_expr_recon_loss: 102483.5261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364438.4873; train_optim_loss: 364438.4873; val_kl_reg_loss: 4418.5246; val_edge_recon_loss: 256877.3537; val_gene_expr_recon_loss: 102188.9228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363484.7973; val_optim_loss: 363484.7973
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9950; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 4408.2685; train_edge_recon_loss: 257360.9544; train_gene_expr_recon_loss: 102426.1193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364195.3417; train_optim_loss: 364195.3417; val_kl_reg_loss: 4382.5229; val_edge_recon_loss: 256469.6742; val_gene_expr_recon_loss: 102188.1032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363040.3011; val_optim_loss: 363040.3011
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9971; val_auprc_score: 0.9959; val_best_acc_score: 0.9832; val_best_f1_score: 0.9833; train_kl_reg_loss: 4400.9216; train_edge_recon_loss: 257536.6885; train_gene_expr_recon_loss: 102468.7240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364406.3346; train_optim_loss: 364406.3346; val_kl_reg_loss: 4400.0154; val_edge_recon_loss: 256815.0511; val_gene_expr_recon_loss: 102277.7247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363492.7869; val_optim_loss: 363492.7869
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9964; val_auprc_score: 0.9932; val_best_acc_score: 0.9833; val_best_f1_score: 0.9835; train_kl_reg_loss: 4391.9860; train_edge_recon_loss: 257649.7762; train_gene_expr_recon_loss: 102395.0814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364436.8444; train_optim_loss: 364436.8444; val_kl_reg_loss: 4379.3465; val_edge_recon_loss: 256716.1222; val_gene_expr_recon_loss: 101962.6716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363058.1383; val_optim_loss: 363058.1383
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9968; val_auprc_score: 0.9948; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 4211.6410; train_edge_recon_loss: 257444.3580; train_gene_expr_recon_loss: 102497.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364153.7738; train_optim_loss: 364153.7738; val_kl_reg_loss: 3857.0924; val_edge_recon_loss: 256527.6752; val_gene_expr_recon_loss: 102159.7251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362544.4962; val_optim_loss: 362544.4962
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9967; val_auprc_score: 0.9947; val_best_acc_score: 0.9826; val_best_f1_score: 0.9828; train_kl_reg_loss: 4005.6279; train_edge_recon_loss: 257235.8523; train_gene_expr_recon_loss: 102455.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363697.4724; train_optim_loss: 363697.4724; val_kl_reg_loss: 3803.2253; val_edge_recon_loss: 257229.8295; val_gene_expr_recon_loss: 102065.0478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363098.1042; val_optim_loss: 363098.1042
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9968; val_auprc_score: 0.9950; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 3973.1266; train_edge_recon_loss: 257102.4150; train_gene_expr_recon_loss: 102428.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363504.4508; train_optim_loss: 363504.4508; val_kl_reg_loss: 3788.7173; val_edge_recon_loss: 256926.8598; val_gene_expr_recon_loss: 102211.9242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362927.5000; val_optim_loss: 362927.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9971; val_auprc_score: 0.9957; val_best_acc_score: 0.9838; val_best_f1_score: 0.9840; train_kl_reg_loss: 3946.8498; train_edge_recon_loss: 257160.4408; train_gene_expr_recon_loss: 102503.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363610.3797; train_optim_loss: 363610.3797; val_kl_reg_loss: 3780.4897; val_edge_recon_loss: 256530.0687; val_gene_expr_recon_loss: 101840.2012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362150.7595; val_optim_loss: 362150.7595
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9972; val_auprc_score: 0.9957; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 3930.4459; train_edge_recon_loss: 257141.9695; train_gene_expr_recon_loss: 102381.6020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363454.0183; train_optim_loss: 363454.0183; val_kl_reg_loss: 3777.6861; val_edge_recon_loss: 256736.3191; val_gene_expr_recon_loss: 102212.7853; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362726.7917; val_optim_loss: 362726.7917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9967; val_auprc_score: 0.9944; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 3914.1023; train_edge_recon_loss: 257175.8829; train_gene_expr_recon_loss: 102414.2736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363504.2596; train_optim_loss: 363504.2596; val_kl_reg_loss: 3759.6396; val_edge_recon_loss: 256936.0701; val_gene_expr_recon_loss: 101692.4470; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362388.1572; val_optim_loss: 362388.1572
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9841; val_best_f1_score: 0.9843; train_kl_reg_loss: 3889.7996; train_edge_recon_loss: 257298.5363; train_gene_expr_recon_loss: 102271.8161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363460.1521; train_optim_loss: 363460.1521; val_kl_reg_loss: 3738.5215; val_edge_recon_loss: 256916.7202; val_gene_expr_recon_loss: 102125.5893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362780.8295; val_optim_loss: 362780.8295

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9971; val_auprc_score: 0.9951; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 3881.3506; train_edge_recon_loss: 257085.6829; train_gene_expr_recon_loss: 102323.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363290.0532; train_optim_loss: 363290.0532; val_kl_reg_loss: 3745.2327; val_edge_recon_loss: 256566.1089; val_gene_expr_recon_loss: 102119.6986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362431.0407; val_optim_loss: 362431.0407
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9964; val_auprc_score: 0.9932; val_best_acc_score: 0.9832; val_best_f1_score: 0.9834; train_kl_reg_loss: 3881.6200; train_edge_recon_loss: 257032.4414; train_gene_expr_recon_loss: 102335.1234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363249.1845; train_optim_loss: 363249.1845; val_kl_reg_loss: 3749.2708; val_edge_recon_loss: 256858.8125; val_gene_expr_recon_loss: 102175.5175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362783.6004; val_optim_loss: 362783.6004
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9965; val_auprc_score: 0.9934; val_best_acc_score: 0.9841; val_best_f1_score: 0.9842; train_kl_reg_loss: 3879.3550; train_edge_recon_loss: 257010.8368; train_gene_expr_recon_loss: 102100.1176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362990.3097; train_optim_loss: 362990.3097; val_kl_reg_loss: 3743.4245; val_edge_recon_loss: 257141.8887; val_gene_expr_recon_loss: 102490.2121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363375.5246; val_optim_loss: 363375.5246

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 16 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9972
Val AUPRC score: 0.9959
Val best accuracy score: 0.9834
Val best F1 score: 0.9835
Val gene expr MSE score: 0.2220
Duration of model training in run 7: 0 hours, 28 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 149579
Number of validation edges: 16619
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9549; val_auprc_score: 0.9445; val_best_acc_score: 0.8935; val_best_f1_score: 0.8986; train_kl_reg_loss: 5379.0160; train_edge_recon_loss: 284642.7794; train_gene_expr_recon_loss: 108719.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398740.8354; train_optim_loss: 398740.8354; val_kl_reg_loss: 4918.4713; val_edge_recon_loss: 268639.4044; val_gene_expr_recon_loss: 106630.9723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380188.8485; val_optim_loss: 380188.8485
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9777; val_auprc_score: 0.9704; val_best_acc_score: 0.9344; val_best_f1_score: 0.9361; train_kl_reg_loss: 4803.6317; train_edge_recon_loss: 265677.0798; train_gene_expr_recon_loss: 106809.6584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377290.3697; train_optim_loss: 377290.3697; val_kl_reg_loss: 4775.3103; val_edge_recon_loss: 263972.8722; val_gene_expr_recon_loss: 105270.2505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374018.4337; val_optim_loss: 374018.4337
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9859; val_auprc_score: 0.9798; val_best_acc_score: 0.9538; val_best_f1_score: 0.9545; train_kl_reg_loss: 4619.5420; train_edge_recon_loss: 263296.8059; train_gene_expr_recon_loss: 106208.7206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374125.0686; train_optim_loss: 374125.0686; val_kl_reg_loss: 4534.2016; val_edge_recon_loss: 261761.2353; val_gene_expr_recon_loss: 104295.4302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370590.8655; val_optim_loss: 370590.8655
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9893; val_auprc_score: 0.9831; val_best_acc_score: 0.9611; val_best_f1_score: 0.9618; train_kl_reg_loss: 4524.9375; train_edge_recon_loss: 262197.1599; train_gene_expr_recon_loss: 105529.9926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372252.0908; train_optim_loss: 372252.0908; val_kl_reg_loss: 4416.4526; val_edge_recon_loss: 260938.2311; val_gene_expr_recon_loss: 104340.6721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369695.3561; val_optim_loss: 369695.3561
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9915; val_auprc_score: 0.9875; val_best_acc_score: 0.9650; val_best_f1_score: 0.9654; train_kl_reg_loss: 4471.6929; train_edge_recon_loss: 260859.1008; train_gene_expr_recon_loss: 105007.7754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370338.5682; train_optim_loss: 370338.5682; val_kl_reg_loss: 4515.4776; val_edge_recon_loss: 260834.6198; val_gene_expr_recon_loss: 103505.6077; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368855.7017; val_optim_loss: 368855.7017
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9920; val_auprc_score: 0.9881; val_best_acc_score: 0.9679; val_best_f1_score: 0.9683; train_kl_reg_loss: 4427.2145; train_edge_recon_loss: 260629.8516; train_gene_expr_recon_loss: 104349.4149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369406.4820; train_optim_loss: 369406.4820; val_kl_reg_loss: 4454.9901; val_edge_recon_loss: 259301.4607; val_gene_expr_recon_loss: 103655.3018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367411.7519; val_optim_loss: 367411.7519
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9935; val_auprc_score: 0.9909; val_best_acc_score: 0.9710; val_best_f1_score: 0.9714; train_kl_reg_loss: 4402.9618; train_edge_recon_loss: 260222.3618; train_gene_expr_recon_loss: 104226.3289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368851.6529; train_optim_loss: 368851.6529; val_kl_reg_loss: 4417.1121; val_edge_recon_loss: 259297.8134; val_gene_expr_recon_loss: 103192.8132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366907.7386; val_optim_loss: 366907.7386
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9939; val_auprc_score: 0.9914; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 4392.6608; train_edge_recon_loss: 259736.2714; train_gene_expr_recon_loss: 104092.0570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368220.9895; train_optim_loss: 368220.9895; val_kl_reg_loss: 4359.0584; val_edge_recon_loss: 258988.1695; val_gene_expr_recon_loss: 103641.3885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366988.6136; val_optim_loss: 366988.6136
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9937; val_auprc_score: 0.9894; val_best_acc_score: 0.9723; val_best_f1_score: 0.9725; train_kl_reg_loss: 4372.1495; train_edge_recon_loss: 259903.8643; train_gene_expr_recon_loss: 103887.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368163.6792; train_optim_loss: 368163.6792; val_kl_reg_loss: 4412.5012; val_edge_recon_loss: 259597.8040; val_gene_expr_recon_loss: 102983.4529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366993.7614; val_optim_loss: 366993.7614
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9902; val_best_acc_score: 0.9730; val_best_f1_score: 0.9733; train_kl_reg_loss: 4382.1471; train_edge_recon_loss: 259310.7894; train_gene_expr_recon_loss: 103753.0652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367446.0016; train_optim_loss: 367446.0016; val_kl_reg_loss: 4419.4879; val_edge_recon_loss: 259278.4929; val_gene_expr_recon_loss: 102809.1361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366507.1165; val_optim_loss: 366507.1165
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9942; val_auprc_score: 0.9903; val_best_acc_score: 0.9755; val_best_f1_score: 0.9759; train_kl_reg_loss: 4380.5614; train_edge_recon_loss: 259273.0250; train_gene_expr_recon_loss: 103548.5431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367202.1286; train_optim_loss: 367202.1286; val_kl_reg_loss: 4298.0842; val_edge_recon_loss: 258505.5175; val_gene_expr_recon_loss: 102633.7199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365437.3191; val_optim_loss: 365437.3191
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9951; val_auprc_score: 0.9923; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 4382.2405; train_edge_recon_loss: 259218.5485; train_gene_expr_recon_loss: 103473.7905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367074.5797; train_optim_loss: 367074.5797; val_kl_reg_loss: 4310.2831; val_edge_recon_loss: 258527.0469; val_gene_expr_recon_loss: 102817.6217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365654.9508; val_optim_loss: 365654.9508
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9955; val_auprc_score: 0.9936; val_best_acc_score: 0.9767; val_best_f1_score: 0.9769; train_kl_reg_loss: 4389.3655; train_edge_recon_loss: 258928.1077; train_gene_expr_recon_loss: 103188.4806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366505.9544; train_optim_loss: 366505.9544; val_kl_reg_loss: 4234.8485; val_edge_recon_loss: 258130.9257; val_gene_expr_recon_loss: 102890.5537; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365256.3305; val_optim_loss: 365256.3305
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9944; val_auprc_score: 0.9912; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 4386.8659; train_edge_recon_loss: 258802.5324; train_gene_expr_recon_loss: 103272.7615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366462.1593; train_optim_loss: 366462.1593; val_kl_reg_loss: 4363.0939; val_edge_recon_loss: 258533.9067; val_gene_expr_recon_loss: 103039.7486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365936.7509; val_optim_loss: 365936.7509
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9955; val_auprc_score: 0.9930; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 4395.3889; train_edge_recon_loss: 258632.8516; train_gene_expr_recon_loss: 103088.9603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366117.2005; train_optim_loss: 366117.2005; val_kl_reg_loss: 4494.1530; val_edge_recon_loss: 257984.0152; val_gene_expr_recon_loss: 102639.4392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365117.6023; val_optim_loss: 365117.6023
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9963; val_auprc_score: 0.9944; val_best_acc_score: 0.9798; val_best_f1_score: 0.9799; train_kl_reg_loss: 4395.7178; train_edge_recon_loss: 258316.9133; train_gene_expr_recon_loss: 103131.9810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365844.6118; train_optim_loss: 365844.6118; val_kl_reg_loss: 4340.8183; val_edge_recon_loss: 257900.5824; val_gene_expr_recon_loss: 102549.5949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364790.9953; val_optim_loss: 364790.9953
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9956; val_auprc_score: 0.9933; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 4391.7698; train_edge_recon_loss: 258279.0532; train_gene_expr_recon_loss: 103200.1109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365870.9332; train_optim_loss: 365870.9332; val_kl_reg_loss: 4416.9910; val_edge_recon_loss: 258071.8674; val_gene_expr_recon_loss: 102266.5831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364755.4441; val_optim_loss: 364755.4441
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9958; val_auprc_score: 0.9932; val_best_acc_score: 0.9806; val_best_f1_score: 0.9807; train_kl_reg_loss: 4402.1694; train_edge_recon_loss: 257950.8403; train_gene_expr_recon_loss: 102839.0154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365192.0251; train_optim_loss: 365192.0251; val_kl_reg_loss: 4436.9316; val_edge_recon_loss: 257536.4598; val_gene_expr_recon_loss: 102900.9858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364874.3797; val_optim_loss: 364874.3797
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9965; val_auprc_score: 0.9949; val_best_acc_score: 0.9801; val_best_f1_score: 0.9802; train_kl_reg_loss: 4399.1169; train_edge_recon_loss: 258116.2696; train_gene_expr_recon_loss: 102937.0371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365452.4235; train_optim_loss: 365452.4235; val_kl_reg_loss: 4288.4716; val_edge_recon_loss: 258308.1141; val_gene_expr_recon_loss: 102763.4851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365360.0710; val_optim_loss: 365360.0710
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9970; val_auprc_score: 0.9952; val_best_acc_score: 0.9829; val_best_f1_score: 0.9830; train_kl_reg_loss: 4404.1170; train_edge_recon_loss: 257917.0695; train_gene_expr_recon_loss: 102834.0991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365155.2869; train_optim_loss: 365155.2869; val_kl_reg_loss: 4336.6390; val_edge_recon_loss: 257009.9659; val_gene_expr_recon_loss: 102862.1631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364208.7689; val_optim_loss: 364208.7689
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9932; val_best_acc_score: 0.9813; val_best_f1_score: 0.9815; train_kl_reg_loss: 4411.0657; train_edge_recon_loss: 257649.3988; train_gene_expr_recon_loss: 102778.5559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364839.0196; train_optim_loss: 364839.0196; val_kl_reg_loss: 4405.0956; val_edge_recon_loss: 257372.1676; val_gene_expr_recon_loss: 102002.7183; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363779.9820; val_optim_loss: 363779.9820
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9970; val_auprc_score: 0.9957; val_best_acc_score: 0.9834; val_best_f1_score: 0.9835; train_kl_reg_loss: 4409.1465; train_edge_recon_loss: 257579.5509; train_gene_expr_recon_loss: 102501.7021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364490.3990; train_optim_loss: 364490.3990; val_kl_reg_loss: 4511.2108; val_edge_recon_loss: 256466.3835; val_gene_expr_recon_loss: 102480.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363457.9650; val_optim_loss: 363457.9650
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9968; val_auprc_score: 0.9951; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 4414.3147; train_edge_recon_loss: 257631.0991; train_gene_expr_recon_loss: 102598.8920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364644.3058; train_optim_loss: 364644.3058; val_kl_reg_loss: 4462.0224; val_edge_recon_loss: 256329.8622; val_gene_expr_recon_loss: 102182.9796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362974.8636; val_optim_loss: 362974.8636
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9968; val_auprc_score: 0.9946; val_best_acc_score: 0.9831; val_best_f1_score: 0.9832; train_kl_reg_loss: 4417.8238; train_edge_recon_loss: 257568.2940; train_gene_expr_recon_loss: 102461.1988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364447.3164; train_optim_loss: 364447.3164; val_kl_reg_loss: 4405.2146; val_edge_recon_loss: 256735.7453; val_gene_expr_recon_loss: 102309.6747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363450.6335; val_optim_loss: 363450.6335
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9971; val_auprc_score: 0.9955; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 4423.6631; train_edge_recon_loss: 257317.7461; train_gene_expr_recon_loss: 102283.6477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364025.0573; train_optim_loss: 364025.0573; val_kl_reg_loss: 4371.5870; val_edge_recon_loss: 256972.8475; val_gene_expr_recon_loss: 102523.4976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363867.9309; val_optim_loss: 363867.9309
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9967; val_auprc_score: 0.9940; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 4193.3600; train_edge_recon_loss: 257225.7699; train_gene_expr_recon_loss: 102476.2217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363895.3509; train_optim_loss: 363895.3509; val_kl_reg_loss: 3982.3346; val_edge_recon_loss: 257059.0308; val_gene_expr_recon_loss: 102419.6832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363461.0483; val_optim_loss: 363461.0483

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9975; val_auprc_score: 0.9963; val_best_acc_score: 0.9843; val_best_f1_score: 0.9845; train_kl_reg_loss: 4123.2061; train_edge_recon_loss: 256860.9251; train_gene_expr_recon_loss: 102119.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363103.2166; train_optim_loss: 363103.2166; val_kl_reg_loss: 4005.8674; val_edge_recon_loss: 256637.6951; val_gene_expr_recon_loss: 102189.4214; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362832.9820; val_optim_loss: 362832.9820
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9974; val_auprc_score: 0.9960; val_best_acc_score: 0.9851; val_best_f1_score: 0.9853; train_kl_reg_loss: 4105.4277; train_edge_recon_loss: 256855.9770; train_gene_expr_recon_loss: 101868.6560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362830.0612; train_optim_loss: 362830.0612; val_kl_reg_loss: 4010.7207; val_edge_recon_loss: 256639.5696; val_gene_expr_recon_loss: 102699.1281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363349.4205; val_optim_loss: 363349.4205
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 4107.2549; train_edge_recon_loss: 256521.2546; train_gene_expr_recon_loss: 101699.9513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362328.4611; train_optim_loss: 362328.4611; val_kl_reg_loss: 4020.0039; val_edge_recon_loss: 255886.7822; val_gene_expr_recon_loss: 102001.2950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361908.0814; val_optim_loss: 361908.0814
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9971; val_auprc_score: 0.9958; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 4098.5612; train_edge_recon_loss: 256748.3968; train_gene_expr_recon_loss: 101947.7792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362794.7357; train_optim_loss: 362794.7357; val_kl_reg_loss: 3985.8669; val_edge_recon_loss: 256048.8371; val_gene_expr_recon_loss: 102374.3182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362409.0208; val_optim_loss: 362409.0208
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9976; val_auprc_score: 0.9956; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 4086.7529; train_edge_recon_loss: 256800.7089; train_gene_expr_recon_loss: 101930.0189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362817.4812; train_optim_loss: 362817.4812; val_kl_reg_loss: 4021.3495; val_edge_recon_loss: 255551.3016; val_gene_expr_recon_loss: 102890.0107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362462.6619; val_optim_loss: 362462.6619
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 4081.9769; train_edge_recon_loss: 256856.1929; train_gene_expr_recon_loss: 101666.4322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362604.6016; train_optim_loss: 362604.6016; val_kl_reg_loss: 3987.0600; val_edge_recon_loss: 256501.3324; val_gene_expr_recon_loss: 102734.0154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363222.4091; val_optim_loss: 363222.4091

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9975; val_auprc_score: 0.9955; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 4074.7670; train_edge_recon_loss: 256577.4157; train_gene_expr_recon_loss: 101830.0287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362482.2118; train_optim_loss: 362482.2118; val_kl_reg_loss: 3991.9930; val_edge_recon_loss: 255647.5568; val_gene_expr_recon_loss: 102477.4392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362116.9858; val_optim_loss: 362116.9858
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9973; val_auprc_score: 0.9952; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 4081.2616; train_edge_recon_loss: 256534.5068; train_gene_expr_recon_loss: 101725.4708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362341.2384; train_optim_loss: 362341.2384; val_kl_reg_loss: 3997.6495; val_edge_recon_loss: 255646.0241; val_gene_expr_recon_loss: 102331.5481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361975.2216; val_optim_loss: 361975.2216
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9976; val_auprc_score: 0.9962; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 4077.1157; train_edge_recon_loss: 256751.8153; train_gene_expr_recon_loss: 101990.5119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362819.4427; train_optim_loss: 362819.4427; val_kl_reg_loss: 3995.7838; val_edge_recon_loss: 255797.8726; val_gene_expr_recon_loss: 102311.5651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362105.2197; val_optim_loss: 362105.2197

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 14 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9950
Val best accuracy score: 0.9854
Val best F1 score: 0.9855
Val gene expr MSE score: 0.2253
Duration of model training in run 8: 0 hours, 28 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 185945
Number of validation edges: 20660
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9777; val_auprc_score: 0.9706; val_best_acc_score: 0.9344; val_best_f1_score: 0.9361; train_kl_reg_loss: 4946.9923; train_edge_recon_loss: 276436.5683; train_gene_expr_recon_loss: 109063.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390447.3696; train_optim_loss: 390447.3696; val_kl_reg_loss: 4564.3458; val_edge_recon_loss: 265327.3837; val_gene_expr_recon_loss: 106166.7560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376058.4865; val_optim_loss: 376058.4865
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9882; val_auprc_score: 0.9832; val_best_acc_score: 0.9583; val_best_f1_score: 0.9593; train_kl_reg_loss: 4531.0729; train_edge_recon_loss: 262678.7065; train_gene_expr_recon_loss: 106424.0129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373633.7920; train_optim_loss: 373633.7920; val_kl_reg_loss: 4231.8329; val_edge_recon_loss: 261022.9319; val_gene_expr_recon_loss: 104999.1682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370253.9325; val_optim_loss: 370253.9325
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9913; val_auprc_score: 0.9875; val_best_acc_score: 0.9668; val_best_f1_score: 0.9672; train_kl_reg_loss: 4421.9616; train_edge_recon_loss: 260958.4895; train_gene_expr_recon_loss: 105228.5581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370609.0096; train_optim_loss: 370609.0096; val_kl_reg_loss: 4345.7876; val_edge_recon_loss: 259441.1101; val_gene_expr_recon_loss: 104022.8815; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367809.7797; val_optim_loss: 367809.7797
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9924; val_auprc_score: 0.9896; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 4386.1128; train_edge_recon_loss: 260254.2405; train_gene_expr_recon_loss: 104537.5325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369177.8851; train_optim_loss: 369177.8851; val_kl_reg_loss: 4352.7936; val_edge_recon_loss: 259993.5233; val_gene_expr_recon_loss: 103699.9634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368046.2809; val_optim_loss: 368046.2809
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9931; val_auprc_score: 0.9897; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 4376.3114; train_edge_recon_loss: 259728.9356; train_gene_expr_recon_loss: 104241.6784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368346.9255; train_optim_loss: 368346.9255; val_kl_reg_loss: 4332.5821; val_edge_recon_loss: 258589.0583; val_gene_expr_recon_loss: 103004.8105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365926.4502; val_optim_loss: 365926.4502
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9942; val_auprc_score: 0.9912; val_best_acc_score: 0.9724; val_best_f1_score: 0.9726; train_kl_reg_loss: 4382.3858; train_edge_recon_loss: 259240.5167; train_gene_expr_recon_loss: 103842.8670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367465.7694; train_optim_loss: 367465.7694; val_kl_reg_loss: 4392.2428; val_edge_recon_loss: 258941.5006; val_gene_expr_recon_loss: 102833.7724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366167.5158; val_optim_loss: 366167.5158
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9943; val_auprc_score: 0.9910; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 4381.9593; train_edge_recon_loss: 259105.2048; train_gene_expr_recon_loss: 103404.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366891.5631; train_optim_loss: 366891.5631; val_kl_reg_loss: 4482.3514; val_edge_recon_loss: 258640.4929; val_gene_expr_recon_loss: 103143.2625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366266.1073; val_optim_loss: 366266.1073
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9939; val_auprc_score: 0.9895; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 4391.1563; train_edge_recon_loss: 258569.6946; train_gene_expr_recon_loss: 103513.4125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366474.2635; train_optim_loss: 366474.2635; val_kl_reg_loss: 4416.5218; val_edge_recon_loss: 257523.2768; val_gene_expr_recon_loss: 102840.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364780.0822; val_optim_loss: 364780.0822
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9944; val_auprc_score: 0.9912; val_best_acc_score: 0.9758; val_best_f1_score: 0.9760; train_kl_reg_loss: 4395.2231; train_edge_recon_loss: 258367.6286; train_gene_expr_recon_loss: 103363.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366126.2329; train_optim_loss: 366126.2329; val_kl_reg_loss: 4430.2034; val_edge_recon_loss: 257905.0083; val_gene_expr_recon_loss: 102868.2339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365203.4456; val_optim_loss: 365203.4456
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9957; val_auprc_score: 0.9927; val_best_acc_score: 0.9785; val_best_f1_score: 0.9786; train_kl_reg_loss: 4403.2206; train_edge_recon_loss: 258190.1378; train_gene_expr_recon_loss: 103213.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365807.2457; train_optim_loss: 365807.2457; val_kl_reg_loss: 4314.1070; val_edge_recon_loss: 256608.0395; val_gene_expr_recon_loss: 102896.1900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363818.3387; val_optim_loss: 363818.3387
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9958; val_auprc_score: 0.9936; val_best_acc_score: 0.9788; val_best_f1_score: 0.9790; train_kl_reg_loss: 4408.3432; train_edge_recon_loss: 258019.6388; train_gene_expr_recon_loss: 103102.9035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365530.8859; train_optim_loss: 365530.8859; val_kl_reg_loss: 4372.4970; val_edge_recon_loss: 256962.0266; val_gene_expr_recon_loss: 103280.0337; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364614.5563; val_optim_loss: 364614.5563
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9936; val_best_acc_score: 0.9805; val_best_f1_score: 0.9806; train_kl_reg_loss: 4419.4862; train_edge_recon_loss: 257442.8152; train_gene_expr_recon_loss: 103110.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364972.9344; train_optim_loss: 364972.9344; val_kl_reg_loss: 4478.8139; val_edge_recon_loss: 256331.8308; val_gene_expr_recon_loss: 102839.1115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363649.7596; val_optim_loss: 363649.7596
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9942; val_best_acc_score: 0.9817; val_best_f1_score: 0.9818; train_kl_reg_loss: 4427.8841; train_edge_recon_loss: 257221.8462; train_gene_expr_recon_loss: 102961.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364611.0078; train_optim_loss: 364611.0078; val_kl_reg_loss: 4334.5797; val_edge_recon_loss: 256435.1109; val_gene_expr_recon_loss: 102734.2097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363503.9005; val_optim_loss: 363503.9005
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9969; val_auprc_score: 0.9952; val_best_acc_score: 0.9833; val_best_f1_score: 0.9834; train_kl_reg_loss: 4435.4362; train_edge_recon_loss: 257153.4683; train_gene_expr_recon_loss: 102968.5697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364557.4734; train_optim_loss: 364557.4734; val_kl_reg_loss: 4378.1963; val_edge_recon_loss: 256231.1275; val_gene_expr_recon_loss: 102725.2057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363334.5305; val_optim_loss: 363334.5305
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9974; val_auprc_score: 0.9959; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 4434.6475; train_edge_recon_loss: 256975.2730; train_gene_expr_recon_loss: 102577.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363987.0114; train_optim_loss: 363987.0114; val_kl_reg_loss: 4425.9505; val_edge_recon_loss: 255958.6071; val_gene_expr_recon_loss: 102930.2127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363314.7708; val_optim_loss: 363314.7708
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9968; val_auprc_score: 0.9939; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 4449.9904; train_edge_recon_loss: 256821.6155; train_gene_expr_recon_loss: 102693.9085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363965.5147; train_optim_loss: 363965.5147; val_kl_reg_loss: 4492.5970; val_edge_recon_loss: 256031.9342; val_gene_expr_recon_loss: 102809.6029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363334.1370; val_optim_loss: 363334.1370
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9968; val_auprc_score: 0.9952; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 4454.7420; train_edge_recon_loss: 256803.7826; train_gene_expr_recon_loss: 102600.7006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363859.2241; train_optim_loss: 363859.2241; val_kl_reg_loss: 4544.4049; val_edge_recon_loss: 256264.9363; val_gene_expr_recon_loss: 102135.9431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362945.2820; val_optim_loss: 362945.2820
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9972; val_auprc_score: 0.9953; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 4457.5578; train_edge_recon_loss: 256689.0310; train_gene_expr_recon_loss: 102432.1811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363578.7700; train_optim_loss: 363578.7700; val_kl_reg_loss: 4377.5658; val_edge_recon_loss: 256578.7728; val_gene_expr_recon_loss: 102662.9875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363619.3252; val_optim_loss: 363619.3252
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9974; val_auprc_score: 0.9954; val_best_acc_score: 0.9863; val_best_f1_score: 0.9864; train_kl_reg_loss: 4468.8118; train_edge_recon_loss: 256489.4576; train_gene_expr_recon_loss: 102316.7118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363274.9812; train_optim_loss: 363274.9812; val_kl_reg_loss: 4592.6598; val_edge_recon_loss: 255817.8463; val_gene_expr_recon_loss: 102911.8206; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363322.3287; val_optim_loss: 363322.3287
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9869; val_best_f1_score: 0.9870; train_kl_reg_loss: 4481.7129; train_edge_recon_loss: 256313.5239; train_gene_expr_recon_loss: 102407.0774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363202.3145; train_optim_loss: 363202.3145; val_kl_reg_loss: 4463.4695; val_edge_recon_loss: 255765.5235; val_gene_expr_recon_loss: 103097.6890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363326.6821; val_optim_loss: 363326.6821

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9976; val_auprc_score: 0.9956; val_best_acc_score: 0.9870; val_best_f1_score: 0.9871; train_kl_reg_loss: 4478.5910; train_edge_recon_loss: 256222.1376; train_gene_expr_recon_loss: 101952.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362653.1314; train_optim_loss: 362653.1314; val_kl_reg_loss: 4479.7745; val_edge_recon_loss: 256092.2243; val_gene_expr_recon_loss: 103179.9555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363751.9541; val_optim_loss: 363751.9541
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9974; val_auprc_score: 0.9959; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 4476.8351; train_edge_recon_loss: 256232.6351; train_gene_expr_recon_loss: 101832.4411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362541.9117; train_optim_loss: 362541.9117; val_kl_reg_loss: 4459.5031; val_edge_recon_loss: 255824.0336; val_gene_expr_recon_loss: 102705.3403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362988.8769; val_optim_loss: 362988.8769
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9981; val_auprc_score: 0.9971; val_best_acc_score: 0.9875; val_best_f1_score: 0.9876; train_kl_reg_loss: 4473.2303; train_edge_recon_loss: 256171.9298; train_gene_expr_recon_loss: 101749.8597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362395.0200; train_optim_loss: 362395.0200; val_kl_reg_loss: 4453.6635; val_edge_recon_loss: 255249.0324; val_gene_expr_recon_loss: 103347.9919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363050.6879; val_optim_loss: 363050.6879

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 22 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9945
Val best accuracy score: 0.9838
Val best F1 score: 0.9839
Val gene expr MSE score: 0.2291
Duration of model training in run 9: 0 hours, 39 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1057, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1057, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1057, n_cond_embed_input: 960, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 17005
Number of validation nodes: 1890
Number of training edges: 185945
Number of validation edges: 20660
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9757; val_auprc_score: 0.9684; val_best_acc_score: 0.9281; val_best_f1_score: 0.9303; train_kl_reg_loss: 4982.8668; train_edge_recon_loss: 275543.1118; train_gene_expr_recon_loss: 108590.5676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389116.5469; train_optim_loss: 389116.5469; val_kl_reg_loss: 4617.5052; val_edge_recon_loss: 264507.6815; val_gene_expr_recon_loss: 107768.1685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376893.3546; val_optim_loss: 376893.3546
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9890; val_auprc_score: 0.9840; val_best_acc_score: 0.9583; val_best_f1_score: 0.9590; train_kl_reg_loss: 4541.7800; train_edge_recon_loss: 262876.9206; train_gene_expr_recon_loss: 106194.8489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373613.5500; train_optim_loss: 373613.5500; val_kl_reg_loss: 4484.0123; val_edge_recon_loss: 260806.3106; val_gene_expr_recon_loss: 106420.0907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371710.4136; val_optim_loss: 371710.4136
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9897; val_auprc_score: 0.9858; val_best_acc_score: 0.9617; val_best_f1_score: 0.9622; train_kl_reg_loss: 4428.9340; train_edge_recon_loss: 260988.4345; train_gene_expr_recon_loss: 105070.0447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370487.4137; train_optim_loss: 370487.4137; val_kl_reg_loss: 4442.8473; val_edge_recon_loss: 260982.9861; val_gene_expr_recon_loss: 105183.1014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370608.9344; val_optim_loss: 370608.9344
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9923; val_auprc_score: 0.9892; val_best_acc_score: 0.9670; val_best_f1_score: 0.9673; train_kl_reg_loss: 4394.3165; train_edge_recon_loss: 260057.7066; train_gene_expr_recon_loss: 104415.6601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368867.6829; train_optim_loss: 368867.6829; val_kl_reg_loss: 4493.8851; val_edge_recon_loss: 259806.9255; val_gene_expr_recon_loss: 104194.0202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368494.8314; val_optim_loss: 368494.8314
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9932; val_auprc_score: 0.9904; val_best_acc_score: 0.9700; val_best_f1_score: 0.9703; train_kl_reg_loss: 4382.1680; train_edge_recon_loss: 259915.7221; train_gene_expr_recon_loss: 103865.5588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368163.4486; train_optim_loss: 368163.4486; val_kl_reg_loss: 4337.8078; val_edge_recon_loss: 258741.8642; val_gene_expr_recon_loss: 103878.9449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366958.6165; val_optim_loss: 366958.6165
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9949; val_auprc_score: 0.9918; val_best_acc_score: 0.9748; val_best_f1_score: 0.9750; train_kl_reg_loss: 4376.8447; train_edge_recon_loss: 259649.2030; train_gene_expr_recon_loss: 103730.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367756.5335; train_optim_loss: 367756.5335; val_kl_reg_loss: 4232.5211; val_edge_recon_loss: 258091.3302; val_gene_expr_recon_loss: 103743.7716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366067.6227; val_optim_loss: 366067.6227
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9948; val_auprc_score: 0.9921; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 4396.4223; train_edge_recon_loss: 258791.9482; train_gene_expr_recon_loss: 103511.0695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366699.4400; train_optim_loss: 366699.4400; val_kl_reg_loss: 4269.9087; val_edge_recon_loss: 258502.9541; val_gene_expr_recon_loss: 103836.3111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366609.1744; val_optim_loss: 366609.1744
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9949; val_auprc_score: 0.9925; val_best_acc_score: 0.9758; val_best_f1_score: 0.9761; train_kl_reg_loss: 4404.5637; train_edge_recon_loss: 258408.1697; train_gene_expr_recon_loss: 103595.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366408.5003; train_optim_loss: 366408.5003; val_kl_reg_loss: 4323.8086; val_edge_recon_loss: 257563.7776; val_gene_expr_recon_loss: 103964.9452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365852.5316; val_optim_loss: 365852.5316
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9954; val_auprc_score: 0.9936; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 4399.1698; train_edge_recon_loss: 258455.2939; train_gene_expr_recon_loss: 103178.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366033.2478; train_optim_loss: 366033.2478; val_kl_reg_loss: 4266.4794; val_edge_recon_loss: 257129.9913; val_gene_expr_recon_loss: 103856.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365252.9132; val_optim_loss: 365252.9132
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9960; val_auprc_score: 0.9939; val_best_acc_score: 0.9807; val_best_f1_score: 0.9810; train_kl_reg_loss: 4405.0784; train_edge_recon_loss: 258046.6206; train_gene_expr_recon_loss: 103333.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365784.7134; train_optim_loss: 365784.7134; val_kl_reg_loss: 4429.3853; val_edge_recon_loss: 256898.8092; val_gene_expr_recon_loss: 103797.9765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365126.1694; val_optim_loss: 365126.1694
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9963; val_auprc_score: 0.9945; val_best_acc_score: 0.9807; val_best_f1_score: 0.9808; train_kl_reg_loss: 4413.8240; train_edge_recon_loss: 257760.6745; train_gene_expr_recon_loss: 103012.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365187.0487; train_optim_loss: 365187.0487; val_kl_reg_loss: 4488.9559; val_edge_recon_loss: 257060.6927; val_gene_expr_recon_loss: 103711.3651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365261.0131; val_optim_loss: 365261.0131
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9962; val_auprc_score: 0.9940; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 4421.6761; train_edge_recon_loss: 257446.2217; train_gene_expr_recon_loss: 103086.8502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364954.7485; train_optim_loss: 364954.7485; val_kl_reg_loss: 4320.4673; val_edge_recon_loss: 256946.9473; val_gene_expr_recon_loss: 103423.3467; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364690.7616; val_optim_loss: 364690.7616
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9963; val_auprc_score: 0.9937; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 4428.0047; train_edge_recon_loss: 257233.9497; train_gene_expr_recon_loss: 102875.2856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364537.2403; train_optim_loss: 364537.2403; val_kl_reg_loss: 4435.4746; val_edge_recon_loss: 256886.1645; val_gene_expr_recon_loss: 103673.8119; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364995.4529; val_optim_loss: 364995.4529
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9964; val_auprc_score: 0.9933; val_best_acc_score: 0.9822; val_best_f1_score: 0.9823; train_kl_reg_loss: 4431.6331; train_edge_recon_loss: 257011.6408; train_gene_expr_recon_loss: 102846.1522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364289.4261; train_optim_loss: 364289.4261; val_kl_reg_loss: 4473.3381; val_edge_recon_loss: 256545.5764; val_gene_expr_recon_loss: 103553.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364572.9090; val_optim_loss: 364572.9090
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9969; val_auprc_score: 0.9943; val_best_acc_score: 0.9839; val_best_f1_score: 0.9841; train_kl_reg_loss: 4442.3839; train_edge_recon_loss: 256915.8955; train_gene_expr_recon_loss: 102724.4114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364082.6909; train_optim_loss: 364082.6909; val_kl_reg_loss: 4531.8261; val_edge_recon_loss: 255565.6788; val_gene_expr_recon_loss: 103725.6493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363823.1543; val_optim_loss: 363823.1543
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9965; val_auprc_score: 0.9943; val_best_acc_score: 0.9818; val_best_f1_score: 0.9820; train_kl_reg_loss: 4445.5384; train_edge_recon_loss: 256843.4720; train_gene_expr_recon_loss: 102721.4702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364010.4809; train_optim_loss: 364010.4809; val_kl_reg_loss: 4452.7158; val_edge_recon_loss: 256051.1935; val_gene_expr_recon_loss: 103954.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364457.9228; val_optim_loss: 364457.9228
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9971; val_auprc_score: 0.9957; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 4450.4809; train_edge_recon_loss: 256766.5683; train_gene_expr_recon_loss: 102476.5806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363693.6290; train_optim_loss: 363693.6290; val_kl_reg_loss: 4416.4901; val_edge_recon_loss: 255467.8677; val_gene_expr_recon_loss: 104093.0575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363977.4155; val_optim_loss: 363977.4155
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9971; val_auprc_score: 0.9951; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 4458.4406; train_edge_recon_loss: 256621.3402; train_gene_expr_recon_loss: 102438.1140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363517.8951; train_optim_loss: 363517.8951; val_kl_reg_loss: 4466.9152; val_edge_recon_loss: 256105.8802; val_gene_expr_recon_loss: 104001.5565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364574.3542; val_optim_loss: 364574.3542

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9973; val_auprc_score: 0.9960; val_best_acc_score: 0.9836; val_best_f1_score: 0.9838; train_kl_reg_loss: 4461.0442; train_edge_recon_loss: 256485.7166; train_gene_expr_recon_loss: 101990.6021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362937.3635; train_optim_loss: 362937.3635; val_kl_reg_loss: 4453.7465; val_edge_recon_loss: 255963.4963; val_gene_expr_recon_loss: 103567.8624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363985.1053; val_optim_loss: 363985.1053
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9973; val_auprc_score: 0.9955; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 4456.6105; train_edge_recon_loss: 256497.4015; train_gene_expr_recon_loss: 102026.0780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362980.0905; train_optim_loss: 362980.0905; val_kl_reg_loss: 4455.5113; val_edge_recon_loss: 256081.4643; val_gene_expr_recon_loss: 103668.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364205.3194; val_optim_loss: 364205.3194
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9974; val_auprc_score: 0.9962; val_best_acc_score: 0.9847; val_best_f1_score: 0.9848; train_kl_reg_loss: 4459.7806; train_edge_recon_loss: 256299.5112; train_gene_expr_recon_loss: 101840.1896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362599.4819; train_optim_loss: 362599.4819; val_kl_reg_loss: 4448.0210; val_edge_recon_loss: 255693.4273; val_gene_expr_recon_loss: 103695.2352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363836.6825; val_optim_loss: 363836.6825

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 39 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9971
Val AUPRC score: 0.9954
Val best accuracy score: 0.9834
Val best F1 score: 0.9836
Val gene expr MSE score: 0.2339
Duration of model training in run 10: 0 hours, 36 minutes and 31 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
