Run timestamp: 16082023_195302_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 11699
Number of validation edges: 1299
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9813; val_auprc_score: 0.9715; val_best_acc_score: 0.9400; val_best_f1_score: 0.9402; train_kl_reg_loss: 77.5252; train_edge_recon_loss: 3464221.7500; train_gene_expr_recon_loss: 2380966.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5845266.0000; train_optim_loss: 5845266.0000; val_kl_reg_loss: 83.5597; val_edge_recon_loss: 3897747.0000; val_gene_expr_recon_loss: 2253505.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6151335.5000; val_optim_loss: 6151335.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9830; val_auprc_score: 0.9700; val_best_acc_score: 0.9438; val_best_f1_score: 0.9457; train_kl_reg_loss: 83.6910; train_edge_recon_loss: 3463803.0000; train_gene_expr_recon_loss: 2321169.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5785056.0000; train_optim_loss: 5785056.0000; val_kl_reg_loss: 115.6008; val_edge_recon_loss: 3942406.7500; val_gene_expr_recon_loss: 2237402.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6179925.0000; val_optim_loss: 6179925.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9787; val_auprc_score: 0.9593; val_best_acc_score: 0.8926; val_best_f1_score: 0.9026; train_kl_reg_loss: 116.9859; train_edge_recon_loss: 3462990.5000; train_gene_expr_recon_loss: 2292809.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5755917.0000; train_optim_loss: 5755917.0000; val_kl_reg_loss: 170.5687; val_edge_recon_loss: 3981828.7500; val_gene_expr_recon_loss: 2218808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6200807.0000; val_optim_loss: 6200807.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9852; val_auprc_score: 0.9777; val_best_acc_score: 0.8768; val_best_f1_score: 0.8616; train_kl_reg_loss: 174.1394; train_edge_recon_loss: 3462291.7500; train_gene_expr_recon_loss: 2272672.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5735138.5000; train_optim_loss: 5735138.5000; val_kl_reg_loss: 251.1471; val_edge_recon_loss: 4005991.7500; val_gene_expr_recon_loss: 2213132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6219375.0000; val_optim_loss: 6219375.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9807; val_auprc_score: 0.9723; val_best_acc_score: 0.9184; val_best_f1_score: 0.9144; train_kl_reg_loss: 255.1793; train_edge_recon_loss: 3463592.0000; train_gene_expr_recon_loss: 2256887.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5720735.0000; train_optim_loss: 5720735.0000; val_kl_reg_loss: 345.8401; val_edge_recon_loss: 4017676.7500; val_gene_expr_recon_loss: 2208870.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6226893.0000; val_optim_loss: 6226893.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9780; val_auprc_score: 0.9674; val_best_acc_score: 0.9261; val_best_f1_score: 0.9251; train_kl_reg_loss: 351.5751; train_edge_recon_loss: 3466398.0000; train_gene_expr_recon_loss: 2245621.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5712371.0000; train_optim_loss: 5712371.0000; val_kl_reg_loss: 439.1688; val_edge_recon_loss: 4024712.5000; val_gene_expr_recon_loss: 2199974.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6225126.0000; val_optim_loss: 6225126.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9808; val_auprc_score: 0.9694; val_best_acc_score: 0.9303; val_best_f1_score: 0.9300; train_kl_reg_loss: 445.4718; train_edge_recon_loss: 3470583.2500; train_gene_expr_recon_loss: 2234212.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5705241.0000; train_optim_loss: 5705241.0000; val_kl_reg_loss: 510.9496; val_edge_recon_loss: 4026554.0000; val_gene_expr_recon_loss: 2182208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6209273.0000; val_optim_loss: 6209273.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9757; val_auprc_score: 0.9558; val_best_acc_score: 0.9319; val_best_f1_score: 0.9319; train_kl_reg_loss: 524.3979; train_edge_recon_loss: 3473694.2500; train_gene_expr_recon_loss: 2223704.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5697923.5000; train_optim_loss: 5697923.5000; val_kl_reg_loss: 584.4333; val_edge_recon_loss: 4027224.0000; val_gene_expr_recon_loss: 2183706.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6211515.0000; val_optim_loss: 6211515.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9785; val_auprc_score: 0.9635; val_best_acc_score: 0.9296; val_best_f1_score: 0.9296; train_kl_reg_loss: 592.4476; train_edge_recon_loss: 3476520.7500; train_gene_expr_recon_loss: 2215058.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5692171.5000; train_optim_loss: 5692171.5000; val_kl_reg_loss: 593.1326; val_edge_recon_loss: 4025696.5000; val_gene_expr_recon_loss: 2188400.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6214690.5000; val_optim_loss: 6214690.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9795
val AUPRC score: 0.9648
val best accuracy score: 0.9384
val best F1 score: 0.9387
val target rna MSE score: 2.5187
val source rna MSE score: 1.5124
Duration of model training in run 8: 0 hours, 0 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 11699
Number of validation edges: 1299
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9842; val_auprc_score: 0.9752; val_best_acc_score: 0.9342; val_best_f1_score: 0.9336; train_kl_reg_loss: 57.1317; train_edge_recon_loss: 3464792.7500; train_gene_expr_recon_loss: 2323958.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5788808.0000; train_optim_loss: 5788808.0000; val_kl_reg_loss: 57.1960; val_edge_recon_loss: 3854680.7500; val_gene_expr_recon_loss: 2246785.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6101523.5000; val_optim_loss: 6101523.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9752; val_auprc_score: 0.9501; val_best_acc_score: 0.9357; val_best_f1_score: 0.9373; train_kl_reg_loss: 57.4172; train_edge_recon_loss: 3463568.0000; train_gene_expr_recon_loss: 2274592.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5738217.5000; train_optim_loss: 5738217.5000; val_kl_reg_loss: 81.6400; val_edge_recon_loss: 3910519.7500; val_gene_expr_recon_loss: 2225929.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6136530.5000; val_optim_loss: 6136530.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9776; val_auprc_score: 0.9571; val_best_acc_score: 0.9226; val_best_f1_score: 0.9275; train_kl_reg_loss: 83.4954; train_edge_recon_loss: 3464096.7500; train_gene_expr_recon_loss: 2248454.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5712634.0000; train_optim_loss: 5712634.0000; val_kl_reg_loss: 131.8151; val_edge_recon_loss: 3962183.2500; val_gene_expr_recon_loss: 2229198.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6191513.0000; val_optim_loss: 6191513.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9769; val_auprc_score: 0.9584; val_best_acc_score: 0.8464; val_best_f1_score: 0.8666; train_kl_reg_loss: 133.1630; train_edge_recon_loss: 3462994.0000; train_gene_expr_recon_loss: 2233382.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5696510.0000; train_optim_loss: 5696510.0000; val_kl_reg_loss: 204.7189; val_edge_recon_loss: 3995353.5000; val_gene_expr_recon_loss: 2216172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6211730.0000; val_optim_loss: 6211730.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9787; val_auprc_score: 0.9683; val_best_acc_score: 0.8995; val_best_f1_score: 0.8921; train_kl_reg_loss: 207.5225; train_edge_recon_loss: 3463521.5000; train_gene_expr_recon_loss: 2222236.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5685965.5000; train_optim_loss: 5685965.5000; val_kl_reg_loss: 294.0503; val_edge_recon_loss: 4011990.2500; val_gene_expr_recon_loss: 2220398.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6232683.0000; val_optim_loss: 6232683.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9783; val_auprc_score: 0.9619; val_best_acc_score: 0.9276; val_best_f1_score: 0.9253; train_kl_reg_loss: 295.7607; train_edge_recon_loss: 3465780.5000; train_gene_expr_recon_loss: 2213487.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5679564.0000; train_optim_loss: 5679564.0000; val_kl_reg_loss: 378.1538; val_edge_recon_loss: 4020739.0000; val_gene_expr_recon_loss: 2205787.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6226905.0000; val_optim_loss: 6226905.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9725; val_auprc_score: 0.9552; val_best_acc_score: 0.9219; val_best_f1_score: 0.9211; train_kl_reg_loss: 381.4763; train_edge_recon_loss: 3467173.2500; train_gene_expr_recon_loss: 2204414.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5671969.0000; train_optim_loss: 5671969.0000; val_kl_reg_loss: 445.9085; val_edge_recon_loss: 4022160.2500; val_gene_expr_recon_loss: 2194768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6217374.0000; val_optim_loss: 6217374.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9763; val_auprc_score: 0.9631; val_best_acc_score: 0.9288; val_best_f1_score: 0.9279; train_kl_reg_loss: 453.7371; train_edge_recon_loss: 3469467.2500; train_gene_expr_recon_loss: 2194838.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5664759.0000; train_optim_loss: 5664759.0000; val_kl_reg_loss: 505.3042; val_edge_recon_loss: 4023399.7500; val_gene_expr_recon_loss: 2193675.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6217580.5000; val_optim_loss: 6217580.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9690; val_auprc_score: 0.9483; val_best_acc_score: 0.9215; val_best_f1_score: 0.9211; train_kl_reg_loss: 511.9887; train_edge_recon_loss: 3470801.0000; train_gene_expr_recon_loss: 2187239.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5658552.5000; train_optim_loss: 5658552.5000; val_kl_reg_loss: 512.7932; val_edge_recon_loss: 4022261.0000; val_gene_expr_recon_loss: 2195514.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6218288.0000; val_optim_loss: 6218288.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9792
val AUPRC score: 0.9660
val best accuracy score: 0.9326
val best F1 score: 0.9360
val target rna MSE score: 2.8135
val source rna MSE score: 1.4316
Duration of model training in run 7: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 8771
Number of validation edges: 974
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9780; val_auprc_score: 0.9597; val_best_acc_score: 0.9322; val_best_f1_score: 0.9353; train_kl_reg_loss: 74.7811; train_edge_recon_loss: 3462941.0000; train_gene_expr_recon_loss: 2300688.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5763704.0000; train_optim_loss: 5763704.0000; val_kl_reg_loss: 87.1411; val_edge_recon_loss: 3868776.5000; val_gene_expr_recon_loss: 2245448.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6114312.5000; val_optim_loss: 6114312.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9779; val_auprc_score: 0.9600; val_best_acc_score: 0.9292; val_best_f1_score: 0.9311; train_kl_reg_loss: 87.1119; train_edge_recon_loss: 3463987.0000; train_gene_expr_recon_loss: 2258933.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5723007.0000; train_optim_loss: 5723007.0000; val_kl_reg_loss: 131.3131; val_edge_recon_loss: 3933642.5000; val_gene_expr_recon_loss: 2234863.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6168637.0000; val_optim_loss: 6168637.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9780; val_auprc_score: 0.9725; val_best_acc_score: 0.8948; val_best_f1_score: 0.9042; train_kl_reg_loss: 131.5170; train_edge_recon_loss: 3462130.2500; train_gene_expr_recon_loss: 2237287.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5699549.0000; train_optim_loss: 5699549.0000; val_kl_reg_loss: 205.9374; val_edge_recon_loss: 3975290.7500; val_gene_expr_recon_loss: 2224069.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6199566.0000; val_optim_loss: 6199566.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9791; val_auprc_score: 0.9685; val_best_acc_score: 0.8167; val_best_f1_score: 0.8394; train_kl_reg_loss: 205.9342; train_edge_recon_loss: 3461948.0000; train_gene_expr_recon_loss: 2224617.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5686771.0000; train_optim_loss: 5686771.0000; val_kl_reg_loss: 307.0213; val_edge_recon_loss: 4001128.0000; val_gene_expr_recon_loss: 2225135.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6226570.5000; val_optim_loss: 6226570.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9759; val_auprc_score: 0.9659; val_best_acc_score: 0.8912; val_best_f1_score: 0.8816; train_kl_reg_loss: 305.9274; train_edge_recon_loss: 3465131.2500; train_gene_expr_recon_loss: 2214430.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5679867.5000; train_optim_loss: 5679867.5000; val_kl_reg_loss: 407.8840; val_edge_recon_loss: 4010925.0000; val_gene_expr_recon_loss: 2216819.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6228152.5000; val_optim_loss: 6228152.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9808; val_auprc_score: 0.9776; val_best_acc_score: 0.9097; val_best_f1_score: 0.9047; train_kl_reg_loss: 408.6584; train_edge_recon_loss: 3465651.7500; train_gene_expr_recon_loss: 2204875.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5670935.5000; train_optim_loss: 5670935.5000; val_kl_reg_loss: 499.5520; val_edge_recon_loss: 4015243.2500; val_gene_expr_recon_loss: 2208056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6223799.0000; val_optim_loss: 6223799.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9744; val_auprc_score: 0.9622; val_best_acc_score: 0.9153; val_best_f1_score: 0.9115; train_kl_reg_loss: 499.2754; train_edge_recon_loss: 3468589.5000; train_gene_expr_recon_loss: 2195493.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5664582.0000; train_optim_loss: 5664582.0000; val_kl_reg_loss: 566.2244; val_edge_recon_loss: 4014106.5000; val_gene_expr_recon_loss: 2192080.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6206753.0000; val_optim_loss: 6206753.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9728; val_auprc_score: 0.9629; val_best_acc_score: 0.9102; val_best_f1_score: 0.9069; train_kl_reg_loss: 569.8397; train_edge_recon_loss: 3469221.2500; train_gene_expr_recon_loss: 2187159.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5656950.0000; train_optim_loss: 5656950.0000; val_kl_reg_loss: 623.4664; val_edge_recon_loss: 4008953.5000; val_gene_expr_recon_loss: 2186811.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6196388.0000; val_optim_loss: 6196388.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9765; val_auprc_score: 0.9732; val_best_acc_score: 0.9158; val_best_f1_score: 0.9122; train_kl_reg_loss: 629.2862; train_edge_recon_loss: 3470223.7500; train_gene_expr_recon_loss: 2179789.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5650642.0000; train_optim_loss: 5650642.0000; val_kl_reg_loss: 629.7545; val_edge_recon_loss: 4008953.2500; val_gene_expr_recon_loss: 2183986.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6193569.5000; val_optim_loss: 6193569.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9828
val AUPRC score: 0.9743
val best accuracy score: 0.9369
val best F1 score: 0.9394
val target rna MSE score: 2.7087
val source rna MSE score: 1.6266
Duration of model training in run 6: 0 hours, 0 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 8771
Number of validation edges: 974
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9724; val_auprc_score: 0.9521; val_best_acc_score: 0.9261; val_best_f1_score: 0.9298; train_kl_reg_loss: 58.9307; train_edge_recon_loss: 3464054.2500; train_gene_expr_recon_loss: 2282506.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5746620.0000; train_optim_loss: 5746620.0000; val_kl_reg_loss: 71.5921; val_edge_recon_loss: 3855957.7500; val_gene_expr_recon_loss: 2209182.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6065211.5000; val_optim_loss: 6065211.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9814; val_auprc_score: 0.9701; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 72.5112; train_edge_recon_loss: 3463794.5000; train_gene_expr_recon_loss: 2246992.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5710860.0000; train_optim_loss: 5710860.0000; val_kl_reg_loss: 110.7217; val_edge_recon_loss: 3910963.7500; val_gene_expr_recon_loss: 2209342.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6120417.0000; val_optim_loss: 6120417.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9833; val_auprc_score: 0.9750; val_best_acc_score: 0.9138; val_best_f1_score: 0.9199; train_kl_reg_loss: 111.6095; train_edge_recon_loss: 3462271.7500; train_gene_expr_recon_loss: 2229006.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5691390.0000; train_optim_loss: 5691390.0000; val_kl_reg_loss: 176.5367; val_edge_recon_loss: 3963566.7500; val_gene_expr_recon_loss: 2199383.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6163126.0000; val_optim_loss: 6163126.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9843; val_auprc_score: 0.9796; val_best_acc_score: 0.8378; val_best_f1_score: 0.8599; train_kl_reg_loss: 177.0344; train_edge_recon_loss: 3462732.5000; train_gene_expr_recon_loss: 2216107.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5679016.5000; train_optim_loss: 5679016.5000; val_kl_reg_loss: 264.4841; val_edge_recon_loss: 3993545.5000; val_gene_expr_recon_loss: 2192586.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6186396.0000; val_optim_loss: 6186396.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9773; val_auprc_score: 0.9598; val_best_acc_score: 0.8819; val_best_f1_score: 0.8703; train_kl_reg_loss: 265.5464; train_edge_recon_loss: 3463906.0000; train_gene_expr_recon_loss: 2206315.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5670487.0000; train_optim_loss: 5670487.0000; val_kl_reg_loss: 359.6271; val_edge_recon_loss: 4008495.5000; val_gene_expr_recon_loss: 2190440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6199295.0000; val_optim_loss: 6199295.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9803; val_auprc_score: 0.9689; val_best_acc_score: 0.9179; val_best_f1_score: 0.9130; train_kl_reg_loss: 358.3727; train_edge_recon_loss: 3465522.5000; train_gene_expr_recon_loss: 2196864.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5662745.0000; train_optim_loss: 5662745.0000; val_kl_reg_loss: 443.6993; val_edge_recon_loss: 4013142.5000; val_gene_expr_recon_loss: 2179663.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6193250.0000; val_optim_loss: 6193250.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9751; val_auprc_score: 0.9688; val_best_acc_score: 0.9112; val_best_f1_score: 0.9079; train_kl_reg_loss: 442.7098; train_edge_recon_loss: 3468180.5000; train_gene_expr_recon_loss: 2188842.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5657465.5000; train_optim_loss: 5657465.5000; val_kl_reg_loss: 513.7153; val_edge_recon_loss: 4016574.0000; val_gene_expr_recon_loss: 2178327.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6195415.0000; val_optim_loss: 6195415.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9753; val_auprc_score: 0.9661; val_best_acc_score: 0.9194; val_best_f1_score: 0.9167; train_kl_reg_loss: 512.2259; train_edge_recon_loss: 3470080.5000; train_gene_expr_recon_loss: 2180190.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5650783.0000; train_optim_loss: 5650783.0000; val_kl_reg_loss: 556.5079; val_edge_recon_loss: 4010154.2500; val_gene_expr_recon_loss: 2155542.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6166253.5000; val_optim_loss: 6166253.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9778; val_auprc_score: 0.9662; val_best_acc_score: 0.9245; val_best_f1_score: 0.9216; train_kl_reg_loss: 565.6818; train_edge_recon_loss: 3469169.2500; train_gene_expr_recon_loss: 2173753.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5643488.0000; train_optim_loss: 5643488.0000; val_kl_reg_loss: 567.0223; val_edge_recon_loss: 4006050.7500; val_gene_expr_recon_loss: 2164505.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6171123.0000; val_optim_loss: 6171123.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9814
val AUPRC score: 0.9629
val best accuracy score: 0.9317
val best F1 score: 0.9294
val target rna MSE score: 2.4660
val source rna MSE score: 1.5489
Duration of model training in run 5: 0 hours, 0 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 5877
Number of validation edges: 653
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9809; val_auprc_score: 0.9708; val_best_acc_score: 0.9349; val_best_f1_score: 0.9370; train_kl_reg_loss: 70.7310; train_edge_recon_loss: 3463444.5000; train_gene_expr_recon_loss: 2289886.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5753401.5000; train_optim_loss: 5753401.5000; val_kl_reg_loss: 83.6983; val_edge_recon_loss: 3882239.2500; val_gene_expr_recon_loss: 2234494.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6116817.5000; val_optim_loss: 6116817.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9783; val_auprc_score: 0.9694; val_best_acc_score: 0.9342; val_best_f1_score: 0.9343; train_kl_reg_loss: 83.7048; train_edge_recon_loss: 3462893.0000; train_gene_expr_recon_loss: 2248965.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5711942.0000; train_optim_loss: 5711942.0000; val_kl_reg_loss: 121.4428; val_edge_recon_loss: 3938010.0000; val_gene_expr_recon_loss: 2223241.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6161373.0000; val_optim_loss: 6161373.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9831; val_auprc_score: 0.9799; val_best_acc_score: 0.9173; val_best_f1_score: 0.9231; train_kl_reg_loss: 121.6682; train_edge_recon_loss: 3461726.2500; train_gene_expr_recon_loss: 2224591.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5686439.0000; train_optim_loss: 5686439.0000; val_kl_reg_loss: 183.7474; val_edge_recon_loss: 3975738.5000; val_gene_expr_recon_loss: 2217988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6193910.0000; val_optim_loss: 6193910.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9825; val_auprc_score: 0.9797; val_best_acc_score: 0.8262; val_best_f1_score: 0.8515; train_kl_reg_loss: 184.7988; train_edge_recon_loss: 3461264.7500; train_gene_expr_recon_loss: 2209211.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5670661.0000; train_optim_loss: 5670661.0000; val_kl_reg_loss: 272.4798; val_edge_recon_loss: 4001723.7500; val_gene_expr_recon_loss: 2207753.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6209750.0000; val_optim_loss: 6209750.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9771; val_auprc_score: 0.9702; val_best_acc_score: 0.7856; val_best_f1_score: 0.7879; train_kl_reg_loss: 273.3615; train_edge_recon_loss: 3463149.7500; train_gene_expr_recon_loss: 2196700.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5660123.0000; train_optim_loss: 5660123.0000; val_kl_reg_loss: 366.4412; val_edge_recon_loss: 4013801.7500; val_gene_expr_recon_loss: 2194099.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6208268.0000; val_optim_loss: 6208268.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9804; val_auprc_score: 0.9796; val_best_acc_score: 0.8522; val_best_f1_score: 0.8300; train_kl_reg_loss: 371.6244; train_edge_recon_loss: 3465427.7500; train_gene_expr_recon_loss: 2185609.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5651409.0000; train_optim_loss: 5651409.0000; val_kl_reg_loss: 467.0086; val_edge_recon_loss: 4021103.7500; val_gene_expr_recon_loss: 2188598.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6210169.0000; val_optim_loss: 6210169.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9779; val_auprc_score: 0.9704; val_best_acc_score: 0.8867; val_best_f1_score: 0.8758; train_kl_reg_loss: 469.4521; train_edge_recon_loss: 3469260.2500; train_gene_expr_recon_loss: 2175118.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5644848.0000; train_optim_loss: 5644848.0000; val_kl_reg_loss: 549.3773; val_edge_recon_loss: 4020441.5000; val_gene_expr_recon_loss: 2179929.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6200920.0000; val_optim_loss: 6200920.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9757; val_auprc_score: 0.9596; val_best_acc_score: 0.8951; val_best_f1_score: 0.8867; train_kl_reg_loss: 553.9636; train_edge_recon_loss: 3470884.0000; train_gene_expr_recon_loss: 2164290.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5635728.0000; train_optim_loss: 5635728.0000; val_kl_reg_loss: 629.0619; val_edge_recon_loss: 4020353.5000; val_gene_expr_recon_loss: 2172035.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6193018.0000; val_optim_loss: 6193018.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9779; val_auprc_score: 0.9755; val_best_acc_score: 0.8982; val_best_f1_score: 0.8900; train_kl_reg_loss: 629.6975; train_edge_recon_loss: 3471958.0000; train_gene_expr_recon_loss: 2156807.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5629395.0000; train_optim_loss: 5629395.0000; val_kl_reg_loss: 631.2602; val_edge_recon_loss: 4022028.2500; val_gene_expr_recon_loss: 2170880.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6193540.0000; val_optim_loss: 6193540.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9781
val AUPRC score: 0.9601
val best accuracy score: 0.9296
val best F1 score: 0.9322
val target rna MSE score: 2.7348
val source rna MSE score: 1.6359
Duration of model training in run 4: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 5877
Number of validation edges: 653
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9681; val_auprc_score: 0.9494; val_best_acc_score: 0.9257; val_best_f1_score: 0.9267; train_kl_reg_loss: 71.7742; train_edge_recon_loss: 3462879.0000; train_gene_expr_recon_loss: 2292965.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5755916.0000; train_optim_loss: 5755916.0000; val_kl_reg_loss: 85.8560; val_edge_recon_loss: 3865850.2500; val_gene_expr_recon_loss: 2217962.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6083898.0000; val_optim_loss: 6083898.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9660; val_auprc_score: 0.9565; val_best_acc_score: 0.9142; val_best_f1_score: 0.9124; train_kl_reg_loss: 86.3186; train_edge_recon_loss: 3462771.0000; train_gene_expr_recon_loss: 2249001.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5711858.5000; train_optim_loss: 5711858.5000; val_kl_reg_loss: 129.0538; val_edge_recon_loss: 3927094.7500; val_gene_expr_recon_loss: 2215632.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6142856.0000; val_optim_loss: 6142856.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9670; val_auprc_score: 0.9497; val_best_acc_score: 0.9081; val_best_f1_score: 0.9125; train_kl_reg_loss: 128.1360; train_edge_recon_loss: 3462081.2500; train_gene_expr_recon_loss: 2228460.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5690670.0000; train_optim_loss: 5690670.0000; val_kl_reg_loss: 194.4407; val_edge_recon_loss: 3972645.7500; val_gene_expr_recon_loss: 2202330.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6175170.0000; val_optim_loss: 6175170.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9732; val_auprc_score: 0.9703; val_best_acc_score: 0.8430; val_best_f1_score: 0.8629; train_kl_reg_loss: 195.1113; train_edge_recon_loss: 3461644.7500; train_gene_expr_recon_loss: 2214189.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5676029.0000; train_optim_loss: 5676029.0000; val_kl_reg_loss: 286.3115; val_edge_recon_loss: 3996965.2500; val_gene_expr_recon_loss: 2194043.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6191294.5000; val_optim_loss: 6191294.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9666; val_auprc_score: 0.9446; val_best_acc_score: 0.7818; val_best_f1_score: 0.7898; train_kl_reg_loss: 287.0206; train_edge_recon_loss: 3463434.0000; train_gene_expr_recon_loss: 2205012.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5668733.5000; train_optim_loss: 5668733.5000; val_kl_reg_loss: 391.4317; val_edge_recon_loss: 4013427.5000; val_gene_expr_recon_loss: 2194336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6208155.0000; val_optim_loss: 6208155.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9648; val_auprc_score: 0.9412; val_best_acc_score: 0.8369; val_best_f1_score: 0.8120; train_kl_reg_loss: 388.1654; train_edge_recon_loss: 3465639.0000; train_gene_expr_recon_loss: 2196707.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5662735.0000; train_optim_loss: 5662735.0000; val_kl_reg_loss: 474.3749; val_edge_recon_loss: 4017718.2500; val_gene_expr_recon_loss: 2182561.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6200754.0000; val_optim_loss: 6200754.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9654; val_auprc_score: 0.9478; val_best_acc_score: 0.8675; val_best_f1_score: 0.8528; train_kl_reg_loss: 475.0872; train_edge_recon_loss: 3467601.0000; train_gene_expr_recon_loss: 2188352.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5656428.0000; train_optim_loss: 5656428.0000; val_kl_reg_loss: 544.1984; val_edge_recon_loss: 4020595.7500; val_gene_expr_recon_loss: 2176101.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6197241.0000; val_optim_loss: 6197241.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9669; val_auprc_score: 0.9536; val_best_acc_score: 0.8790; val_best_f1_score: 0.8677; train_kl_reg_loss: 543.9446; train_edge_recon_loss: 3470768.0000; train_gene_expr_recon_loss: 2179413.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5650725.5000; train_optim_loss: 5650725.5000; val_kl_reg_loss: 598.7419; val_edge_recon_loss: 4020109.0000; val_gene_expr_recon_loss: 2174339.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6195047.5000; val_optim_loss: 6195047.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9669; val_auprc_score: 0.9483; val_best_acc_score: 0.8752; val_best_f1_score: 0.8634; train_kl_reg_loss: 596.8224; train_edge_recon_loss: 3471867.5000; train_gene_expr_recon_loss: 2173352.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5645817.0000; train_optim_loss: 5645817.0000; val_kl_reg_loss: 593.3391; val_edge_recon_loss: 4017340.5000; val_gene_expr_recon_loss: 2159903.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6177837.0000; val_optim_loss: 6177837.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9700
val AUPRC score: 0.9645
val best accuracy score: 0.9150
val best F1 score: 0.9170
val target rna MSE score: 2.7270
val source rna MSE score: 1.5692
Duration of model training in run 3: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 3060
Number of validation edges: 339
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9414; val_auprc_score: 0.9404; val_best_acc_score: 0.8658; val_best_f1_score: 0.8752; train_kl_reg_loss: 84.0335; train_edge_recon_loss: 3459985.7500; train_gene_expr_recon_loss: 2293828.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5753898.0000; train_optim_loss: 5753898.0000; val_kl_reg_loss: 90.8584; val_edge_recon_loss: 3836511.0000; val_gene_expr_recon_loss: 2176872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6013474.0000; val_optim_loss: 6013474.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9379; val_auprc_score: 0.9282; val_best_acc_score: 0.8687; val_best_f1_score: 0.8662; train_kl_reg_loss: 93.6623; train_edge_recon_loss: 3463532.2500; train_gene_expr_recon_loss: 2246897.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5710523.0000; train_optim_loss: 5710523.0000; val_kl_reg_loss: 128.8262; val_edge_recon_loss: 3903407.2500; val_gene_expr_recon_loss: 2168604.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6072140.5000; val_optim_loss: 6072140.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9322; val_auprc_score: 0.9065; val_best_acc_score: 0.8392; val_best_f1_score: 0.8340; train_kl_reg_loss: 134.4780; train_edge_recon_loss: 3461984.7500; train_gene_expr_recon_loss: 2221743.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5683863.0000; train_optim_loss: 5683863.0000; val_kl_reg_loss: 198.7645; val_edge_recon_loss: 3959585.5000; val_gene_expr_recon_loss: 2168274.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6128059.0000; val_optim_loss: 6128059.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9463; val_auprc_score: 0.9472; val_best_acc_score: 0.8614; val_best_f1_score: 0.8705; train_kl_reg_loss: 203.5687; train_edge_recon_loss: 3459452.0000; train_gene_expr_recon_loss: 2209330.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5668985.5000; train_optim_loss: 5668985.5000; val_kl_reg_loss: 284.3350; val_edge_recon_loss: 3986543.7500; val_gene_expr_recon_loss: 2156143.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6142971.0000; val_optim_loss: 6142971.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9264; val_auprc_score: 0.8899; val_best_acc_score: 0.7994; val_best_f1_score: 0.8291; train_kl_reg_loss: 294.7276; train_edge_recon_loss: 3462077.7500; train_gene_expr_recon_loss: 2201300.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5663672.5000; train_optim_loss: 5663672.5000; val_kl_reg_loss: 376.7431; val_edge_recon_loss: 4004074.7500; val_gene_expr_recon_loss: 2155055.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6159507.0000; val_optim_loss: 6159507.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9293; val_auprc_score: 0.9047; val_best_acc_score: 0.7714; val_best_f1_score: 0.8117; train_kl_reg_loss: 386.7954; train_edge_recon_loss: 3462331.0000; train_gene_expr_recon_loss: 2193054.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5655772.0000; train_optim_loss: 5655772.0000; val_kl_reg_loss: 448.4783; val_edge_recon_loss: 4011437.5000; val_gene_expr_recon_loss: 2141604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6153490.0000; val_optim_loss: 6153490.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9406; val_auprc_score: 0.9401; val_best_acc_score: 0.7389; val_best_f1_score: 0.7905; train_kl_reg_loss: 468.5317; train_edge_recon_loss: 3465173.2500; train_gene_expr_recon_loss: 2182361.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5648003.0000; train_optim_loss: 5648003.0000; val_kl_reg_loss: 522.0881; val_edge_recon_loss: 4014060.7500; val_gene_expr_recon_loss: 2138956.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6153539.5000; val_optim_loss: 6153539.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9385; val_auprc_score: 0.9395; val_best_acc_score: 0.7507; val_best_f1_score: 0.7981; train_kl_reg_loss: 532.5769; train_edge_recon_loss: 3465886.0000; train_gene_expr_recon_loss: 2173026.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5639445.0000; train_optim_loss: 5639445.0000; val_kl_reg_loss: 562.8710; val_edge_recon_loss: 4011097.5000; val_gene_expr_recon_loss: 2132313.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6143974.0000; val_optim_loss: 6143974.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9313; val_auprc_score: 0.9295; val_best_acc_score: 0.7360; val_best_f1_score: 0.7887; train_kl_reg_loss: 584.9998; train_edge_recon_loss: 3465924.2500; train_gene_expr_recon_loss: 2166790.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5633299.5000; train_optim_loss: 5633299.5000; val_kl_reg_loss: 563.0333; val_edge_recon_loss: 4012724.7500; val_gene_expr_recon_loss: 2124972.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6138260.0000; val_optim_loss: 6138260.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9520
val AUPRC score: 0.9450
val best accuracy score: 0.8805
val best F1 score: 0.8785
val target rna MSE score: 2.9361
val source rna MSE score: 1.7589
Duration of model training in run 2: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 351, n_cat_covariates_embed_input: 0, n_hidden: 351, n_latent: 1358, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1358, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 351

--- INITIALIZING TRAINER ---
Number of training nodes: 1276
Number of validation nodes: 142
Number of training edges: 3060
Number of validation edges: 339
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9482; val_auprc_score: 0.9430; val_best_acc_score: 0.8732; val_best_f1_score: 0.8694; train_kl_reg_loss: 79.3440; train_edge_recon_loss: 3464354.2500; train_gene_expr_recon_loss: 2322894.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5787328.0000; train_optim_loss: 5787328.0000; val_kl_reg_loss: 78.1558; val_edge_recon_loss: 3814627.7500; val_gene_expr_recon_loss: 2232227.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6046933.5000; val_optim_loss: 6046933.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9323; val_auprc_score: 0.9203; val_best_acc_score: 0.8496; val_best_f1_score: 0.8543; train_kl_reg_loss: 81.5177; train_edge_recon_loss: 3462934.5000; train_gene_expr_recon_loss: 2269096.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5732112.0000; train_optim_loss: 5732112.0000; val_kl_reg_loss: 105.9699; val_edge_recon_loss: 3875087.0000; val_gene_expr_recon_loss: 2225302.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6100495.0000; val_optim_loss: 6100495.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9413; val_auprc_score: 0.9403; val_best_acc_score: 0.8525; val_best_f1_score: 0.8626; train_kl_reg_loss: 109.4080; train_edge_recon_loss: 3460776.5000; train_gene_expr_recon_loss: 2241651.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5702537.0000; train_optim_loss: 5702537.0000; val_kl_reg_loss: 160.9486; val_edge_recon_loss: 3932164.5000; val_gene_expr_recon_loss: 2217675.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6150001.0000; val_optim_loss: 6150001.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9381; val_auprc_score: 0.9351; val_best_acc_score: 0.8687; val_best_f1_score: 0.8681; train_kl_reg_loss: 165.1905; train_edge_recon_loss: 3461503.5000; train_gene_expr_recon_loss: 2228091.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5689760.0000; train_optim_loss: 5689760.0000; val_kl_reg_loss: 237.5861; val_edge_recon_loss: 3971942.0000; val_gene_expr_recon_loss: 2209312.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6181492.0000; val_optim_loss: 6181492.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9413; val_auprc_score: 0.9418; val_best_acc_score: 0.8481; val_best_f1_score: 0.8628; train_kl_reg_loss: 245.7700; train_edge_recon_loss: 3459152.2500; train_gene_expr_recon_loss: 2217895.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5677293.5000; train_optim_loss: 5677293.5000; val_kl_reg_loss: 332.7780; val_edge_recon_loss: 3997261.0000; val_gene_expr_recon_loss: 2199993.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6197587.0000; val_optim_loss: 6197587.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9339; val_auprc_score: 0.9158; val_best_acc_score: 0.7758; val_best_f1_score: 0.8128; train_kl_reg_loss: 345.7908; train_edge_recon_loss: 3462488.7500; train_gene_expr_recon_loss: 2208527.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5671362.0000; train_optim_loss: 5671362.0000; val_kl_reg_loss: 434.9981; val_edge_recon_loss: 4010386.2500; val_gene_expr_recon_loss: 2191943.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6202764.5000; val_optim_loss: 6202764.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9240; val_auprc_score: 0.9079; val_best_acc_score: 0.7212; val_best_f1_score: 0.7800; train_kl_reg_loss: 447.9498; train_edge_recon_loss: 3465400.7500; train_gene_expr_recon_loss: 2198559.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5664408.0000; train_optim_loss: 5664408.0000; val_kl_reg_loss: 525.7522; val_edge_recon_loss: 4019217.2500; val_gene_expr_recon_loss: 2183263.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6203006.0000; val_optim_loss: 6203006.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9341; val_auprc_score: 0.9315; val_best_acc_score: 0.7006; val_best_f1_score: 0.7680; train_kl_reg_loss: 544.1182; train_edge_recon_loss: 3469940.5000; train_gene_expr_recon_loss: 2188258.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5658743.0000; train_optim_loss: 5658743.0000; val_kl_reg_loss: 606.9895; val_edge_recon_loss: 4020270.0000; val_gene_expr_recon_loss: 2178474.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6199351.5000; val_optim_loss: 6199351.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9439; val_auprc_score: 0.9347; val_best_acc_score: 0.7227; val_best_f1_score: 0.7814; train_kl_reg_loss: 624.5839; train_edge_recon_loss: 3469884.7500; train_gene_expr_recon_loss: 2179261.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5649770.0000; train_optim_loss: 5649770.0000; val_kl_reg_loss: 623.9973; val_edge_recon_loss: 4018272.7500; val_gene_expr_recon_loss: 2180820.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6199717.0000; val_optim_loss: 6199717.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9371
val AUPRC score: 0.9185
val best accuracy score: 0.8673
val best F1 score: 0.8707
val target rna MSE score: 2.9817
val source rna MSE score: 1.6721
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
