Run timestamp: 16082023_161950_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'Cell_Type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'vizgen_merfish_mouse_liver', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 347, n_cat_covariates_embed_input: 0, n_hidden: 347, n_latent: 1378, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347

--- INITIALIZING TRAINER ---
Number of training nodes: 330601
Number of validation nodes: 36734
Number of training edges: 2874829
Number of validation edges: 319425
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9139; val_auprc_score: 0.8930; val_best_acc_score: 0.8411; val_best_f1_score: 0.8528; train_kl_reg_loss: 46977.5829; train_edge_recon_loss: 3040327.7995; train_gene_expr_recon_loss: 2684435.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5771740.9003; train_optim_loss: 5771740.9003; val_kl_reg_loss: 45694.4905; val_edge_recon_loss: 2783747.8494; val_gene_expr_recon_loss: 2465428.0769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5294870.4487; val_optim_loss: 5294870.4487
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9343; val_auprc_score: 0.9214; val_best_acc_score: 0.8621; val_best_f1_score: 0.8701; train_kl_reg_loss: 39542.0111; train_edge_recon_loss: 2746073.3312; train_gene_expr_recon_loss: 2401131.2817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5186746.6140; train_optim_loss: 5186746.6140; val_kl_reg_loss: 33682.9515; val_edge_recon_loss: 2754222.5545; val_gene_expr_recon_loss: 2340258.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5128163.8974; val_optim_loss: 5128163.8974
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9575; val_auprc_score: 0.9497; val_best_acc_score: 0.8941; val_best_f1_score: 0.8983; train_kl_reg_loss: 32099.4792; train_edge_recon_loss: 2709091.5470; train_gene_expr_recon_loss: 2300737.3892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5041928.4145; train_optim_loss: 5041928.4145; val_kl_reg_loss: 30248.6507; val_edge_recon_loss: 2714462.5769; val_gene_expr_recon_loss: 2260715.4744; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5005426.6987; val_optim_loss: 5005426.6987
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9618; val_auprc_score: 0.9549; val_best_acc_score: 0.9006; val_best_f1_score: 0.9044; train_kl_reg_loss: 29235.6284; train_edge_recon_loss: 2687442.6595; train_gene_expr_recon_loss: 2234630.8579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4951309.1574; train_optim_loss: 4951309.1574; val_kl_reg_loss: 27460.4481; val_edge_recon_loss: 2698748.7212; val_gene_expr_recon_loss: 2204815.0032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4931024.1859; val_optim_loss: 4931024.1859
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9645; val_auprc_score: 0.9582; val_best_acc_score: 0.9044; val_best_f1_score: 0.9077; train_kl_reg_loss: 26520.3302; train_edge_recon_loss: 2675743.2311; train_gene_expr_recon_loss: 2189321.3561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4891584.9274; train_optim_loss: 4891584.9274; val_kl_reg_loss: 25607.4883; val_edge_recon_loss: 2692259.9295; val_gene_expr_recon_loss: 2166743.9135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4884611.3590; val_optim_loss: 4884611.3590
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9683; val_auprc_score: 0.9630; val_best_acc_score: 0.9099; val_best_f1_score: 0.9130; train_kl_reg_loss: 24811.6291; train_edge_recon_loss: 2667586.1941; train_gene_expr_recon_loss: 2156548.1222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848945.9537; train_optim_loss: 4848945.9537; val_kl_reg_loss: 23445.1869; val_edge_recon_loss: 2685895.8397; val_gene_expr_recon_loss: 2139670.2564; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849011.2628; val_optim_loss: 4849011.2628
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9733; val_auprc_score: 0.9687; val_best_acc_score: 0.9190; val_best_f1_score: 0.9213; train_kl_reg_loss: 23127.9542; train_edge_recon_loss: 2660611.1720; train_gene_expr_recon_loss: 2132469.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4816208.7137; train_optim_loss: 4816208.7137; val_kl_reg_loss: 21850.9520; val_edge_recon_loss: 2676881.8269; val_gene_expr_recon_loss: 2120341.2628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4819074.0513; val_optim_loss: 4819074.0513
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9765; val_auprc_score: 0.9724; val_best_acc_score: 0.9251; val_best_f1_score: 0.9269; train_kl_reg_loss: 21784.8294; train_edge_recon_loss: 2655115.5267; train_gene_expr_recon_loss: 2115811.6741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4792712.0135; train_optim_loss: 4792712.0135; val_kl_reg_loss: 20882.9390; val_edge_recon_loss: 2672131.9583; val_gene_expr_recon_loss: 2104118.6154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4797133.5064; val_optim_loss: 4797133.5064
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9773; val_auprc_score: 0.9734; val_best_acc_score: 0.9269; val_best_f1_score: 0.9286; train_kl_reg_loss: 21006.9793; train_edge_recon_loss: 2650482.3237; train_gene_expr_recon_loss: 2102781.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4774270.8412; train_optim_loss: 4774270.8412; val_kl_reg_loss: 20340.1172; val_edge_recon_loss: 2667616.8173; val_gene_expr_recon_loss: 2092895.7179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4780852.6538; val_optim_loss: 4780852.6538
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9783; val_auprc_score: 0.9747; val_best_acc_score: 0.9285; val_best_f1_score: 0.9302; train_kl_reg_loss: 20317.5548; train_edge_recon_loss: 2646486.6510; train_gene_expr_recon_loss: 2093599.6339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4760403.8625; train_optim_loss: 4760403.8625; val_kl_reg_loss: 19796.1500; val_edge_recon_loss: 2664764.1635; val_gene_expr_recon_loss: 2085662.2051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4770222.5064; val_optim_loss: 4770222.5064
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9795; val_auprc_score: 0.9761; val_best_acc_score: 0.9307; val_best_f1_score: 0.9322; train_kl_reg_loss: 19664.9928; train_edge_recon_loss: 2645142.0402; train_gene_expr_recon_loss: 2087059.6002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4751866.6360; train_optim_loss: 4751866.6360; val_kl_reg_loss: 19077.8984; val_edge_recon_loss: 2660905.6282; val_gene_expr_recon_loss: 2079871.9359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4759855.4679; val_optim_loss: 4759855.4679
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9792; val_auprc_score: 0.9758; val_best_acc_score: 0.9300; val_best_f1_score: 0.9315; train_kl_reg_loss: 19143.9694; train_edge_recon_loss: 2643941.3857; train_gene_expr_recon_loss: 2081192.9541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4744278.3177; train_optim_loss: 4744278.3177; val_kl_reg_loss: 18912.0732; val_edge_recon_loss: 2661443.1891; val_gene_expr_recon_loss: 2076090.5208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4756445.7821; val_optim_loss: 4756445.7821
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9799; val_auprc_score: 0.9768; val_best_acc_score: 0.9313; val_best_f1_score: 0.9327; train_kl_reg_loss: 18535.5794; train_edge_recon_loss: 2642481.7272; train_gene_expr_recon_loss: 2077344.0557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4738361.3533; train_optim_loss: 4738361.3533; val_kl_reg_loss: 18095.9997; val_edge_recon_loss: 2661162.2532; val_gene_expr_recon_loss: 2071410.2147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4750668.4744; val_optim_loss: 4750668.4744
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9805; val_auprc_score: 0.9774; val_best_acc_score: 0.9320; val_best_f1_score: 0.9334; train_kl_reg_loss: 18132.4391; train_edge_recon_loss: 2640547.0253; train_gene_expr_recon_loss: 2074212.5112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4732891.9858; train_optim_loss: 4732891.9858; val_kl_reg_loss: 17748.1262; val_edge_recon_loss: 2659143.9647; val_gene_expr_recon_loss: 2069467.0513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4746359.1154; val_optim_loss: 4746359.1154
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9814; val_auprc_score: 0.9784; val_best_acc_score: 0.9343; val_best_f1_score: 0.9357; train_kl_reg_loss: 17739.7752; train_edge_recon_loss: 2640263.8989; train_gene_expr_recon_loss: 2072478.3024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4730481.9922; train_optim_loss: 4730481.9922; val_kl_reg_loss: 17158.9274; val_edge_recon_loss: 2658271.4455; val_gene_expr_recon_loss: 2067267.6891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4742698.0641; val_optim_loss: 4742698.0641
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9817; val_auprc_score: 0.9788; val_best_acc_score: 0.9343; val_best_f1_score: 0.9357; train_kl_reg_loss: 17381.0558; train_edge_recon_loss: 2639689.1841; train_gene_expr_recon_loss: 2069829.0171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4726899.2564; train_optim_loss: 4726899.2564; val_kl_reg_loss: 17107.5838; val_edge_recon_loss: 2657881.2147; val_gene_expr_recon_loss: 2065497.7901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4740486.6154; val_optim_loss: 4740486.6154
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9826; val_auprc_score: 0.9799; val_best_acc_score: 0.9365; val_best_f1_score: 0.9378; train_kl_reg_loss: 17081.1137; train_edge_recon_loss: 2638733.6581; train_gene_expr_recon_loss: 2068120.8798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4723935.6503; train_optim_loss: 4723935.6503; val_kl_reg_loss: 16666.7505; val_edge_recon_loss: 2654578.7821; val_gene_expr_recon_loss: 2065488.8462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736734.3462; val_optim_loss: 4736734.3462
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9822; val_auprc_score: 0.9793; val_best_acc_score: 0.9360; val_best_f1_score: 0.9371; train_kl_reg_loss: 16817.6569; train_edge_recon_loss: 2637476.3682; train_gene_expr_recon_loss: 2067153.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4721447.5078; train_optim_loss: 4721447.5078; val_kl_reg_loss: 16577.6502; val_edge_recon_loss: 2655511.0321; val_gene_expr_recon_loss: 2064047.3109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4736136.0128; val_optim_loss: 4736136.0128
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9839; val_auprc_score: 0.9815; val_best_acc_score: 0.9397; val_best_f1_score: 0.9408; train_kl_reg_loss: 16640.0466; train_edge_recon_loss: 2635784.8362; train_gene_expr_recon_loss: 2065806.2258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4718231.0940; train_optim_loss: 4718231.0940; val_kl_reg_loss: 16533.9674; val_edge_recon_loss: 2653423.6154; val_gene_expr_recon_loss: 2062237.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4732194.9423; val_optim_loss: 4732194.9423
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9848; val_auprc_score: 0.9825; val_best_acc_score: 0.9411; val_best_f1_score: 0.9422; train_kl_reg_loss: 16466.3196; train_edge_recon_loss: 2634750.1286; train_gene_expr_recon_loss: 2064672.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4715888.9380; train_optim_loss: 4715888.9380; val_kl_reg_loss: 16207.6066; val_edge_recon_loss: 2656449.2115; val_gene_expr_recon_loss: 2059107.2612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4731764.0513; val_optim_loss: 4731764.0513
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9853; val_auprc_score: 0.9831; val_best_acc_score: 0.9420; val_best_f1_score: 0.9429; train_kl_reg_loss: 16363.7901; train_edge_recon_loss: 2635177.2165; train_gene_expr_recon_loss: 2063198.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4714739.7863; train_optim_loss: 4714739.7863; val_kl_reg_loss: 15916.9753; val_edge_recon_loss: 2651503.0545; val_gene_expr_recon_loss: 2058739.5929; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4726159.6282; val_optim_loss: 4726159.6282
