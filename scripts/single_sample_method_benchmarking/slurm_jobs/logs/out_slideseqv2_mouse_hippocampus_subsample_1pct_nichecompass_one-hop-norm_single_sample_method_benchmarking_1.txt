Run timestamp: 15062023_135543.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_1pct', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 797
Number of validation edges: 88
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9184; val_auprc_score: 0.8904; val_best_acc_score: 0.8693; val_best_f1_score: 0.8655; train_kl_reg_loss: 1.6626; train_edge_recon_loss: 346689.5000; train_gene_expr_recon_loss: 96833.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443524.3125; train_optim_loss: 443524.3125; val_kl_reg_loss: 4.2015; val_edge_recon_loss: 381086.9688; val_gene_expr_recon_loss: 85353.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466444.4688; val_optim_loss: 466444.4688
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9194; val_auprc_score: 0.9083; val_best_acc_score: 0.8523; val_best_f1_score: 0.8646; train_kl_reg_loss: 4.3274; train_edge_recon_loss: 346843.1875; train_gene_expr_recon_loss: 82430.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429278.3750; train_optim_loss: 429278.3750; val_kl_reg_loss: 9.7261; val_edge_recon_loss: 388791.0938; val_gene_expr_recon_loss: 77741.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466542.1875; val_optim_loss: 466542.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9082; val_auprc_score: 0.8464; val_best_acc_score: 0.8466; val_best_f1_score: 0.8586; train_kl_reg_loss: 10.1045; train_edge_recon_loss: 346687.4688; train_gene_expr_recon_loss: 74454.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421152.0312; train_optim_loss: 421152.0312; val_kl_reg_loss: 18.9275; val_edge_recon_loss: 392289.6875; val_gene_expr_recon_loss: 74483.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466792.1562; val_optim_loss: 466792.1562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8746; val_auprc_score: 0.8081; val_best_acc_score: 0.8409; val_best_f1_score: 0.8495; train_kl_reg_loss: 19.7609; train_edge_recon_loss: 346394.4062; train_gene_expr_recon_loss: 70857.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417271.5625; train_optim_loss: 417271.5625; val_kl_reg_loss: 33.8506; val_edge_recon_loss: 392284.7188; val_gene_expr_recon_loss: 73404.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465723.3750; val_optim_loss: 465723.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8732; val_auprc_score: 0.8266; val_best_acc_score: 0.8068; val_best_f1_score: 0.8317; train_kl_reg_loss: 34.0465; train_edge_recon_loss: 346307.7188; train_gene_expr_recon_loss: 69564.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415906.6250; train_optim_loss: 415906.6250; val_kl_reg_loss: 58.3673; val_edge_recon_loss: 396654.5625; val_gene_expr_recon_loss: 73298.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470011.8750; val_optim_loss: 470011.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8902; val_auprc_score: 0.8682; val_best_acc_score: 0.7557; val_best_f1_score: 0.8000; train_kl_reg_loss: 59.0890; train_edge_recon_loss: 345764.8438; train_gene_expr_recon_loss: 69297.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415121.2188; train_optim_loss: 415121.2188; val_kl_reg_loss: 95.8241; val_edge_recon_loss: 397230.7812; val_gene_expr_recon_loss: 73499.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470826.4375; val_optim_loss: 470826.4375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9029; val_auprc_score: 0.8888; val_best_acc_score: 0.7670; val_best_f1_score: 0.8075; train_kl_reg_loss: 95.5970; train_edge_recon_loss: 345146.9688; train_gene_expr_recon_loss: 69391.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414634.4688; train_optim_loss: 414634.4688; val_kl_reg_loss: 143.2706; val_edge_recon_loss: 395559.6875; val_gene_expr_recon_loss: 73662.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469365.4375; val_optim_loss: 469365.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9277; val_auprc_score: 0.9253; val_best_acc_score: 0.7670; val_best_f1_score: 0.8075; train_kl_reg_loss: 150.2285; train_edge_recon_loss: 345426.6562; train_gene_expr_recon_loss: 69478.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415055.6250; train_optim_loss: 415055.6250; val_kl_reg_loss: 149.9319; val_edge_recon_loss: 395930.0938; val_gene_expr_recon_loss: 73630.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469710.2500; val_optim_loss: 469710.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8552; val_auprc_score: 0.8101; val_best_acc_score: 0.7330; val_best_f1_score: 0.7854; train_kl_reg_loss: 153.9885; train_edge_recon_loss: 344829.1875; train_gene_expr_recon_loss: 69437.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414420.4062; train_optim_loss: 414420.4062; val_kl_reg_loss: 156.3999; val_edge_recon_loss: 395254.0000; val_gene_expr_recon_loss: 73532.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468942.9688; val_optim_loss: 468942.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8940; val_auprc_score: 0.8848; val_best_acc_score: 0.7330; val_best_f1_score: 0.7854; train_kl_reg_loss: 161.3006; train_edge_recon_loss: 344645.8125; train_gene_expr_recon_loss: 69336.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414143.2188; train_optim_loss: 414143.2188; val_kl_reg_loss: 157.7556; val_edge_recon_loss: 395719.1250; val_gene_expr_recon_loss: 73388.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469265.4375; val_optim_loss: 469265.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.9217
Val AUPRC score: 0.8903
Val best accuracy score: 0.8750
Val best F1 score: 0.8778
Val gene expr MSE score: 0.0122
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 797
Number of validation edges: 88
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8688; val_auprc_score: 0.8680; val_best_acc_score: 0.7955; val_best_f1_score: 0.8000; train_kl_reg_loss: 1.6074; train_edge_recon_loss: 346378.3125; train_gene_expr_recon_loss: 97740.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444120.5625; train_optim_loss: 444120.5625; val_kl_reg_loss: 3.7018; val_edge_recon_loss: 382337.9688; val_gene_expr_recon_loss: 80871.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463213.4375; val_optim_loss: 463213.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8948; val_auprc_score: 0.9050; val_best_acc_score: 0.8011; val_best_f1_score: 0.8000; train_kl_reg_loss: 4.0071; train_edge_recon_loss: 346872.2188; train_gene_expr_recon_loss: 82754.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429631.0000; train_optim_loss: 429631.0000; val_kl_reg_loss: 8.0282; val_edge_recon_loss: 387578.9688; val_gene_expr_recon_loss: 73383.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460971.0000; val_optim_loss: 460971.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8718; val_auprc_score: 0.8542; val_best_acc_score: 0.7784; val_best_f1_score: 0.7944; train_kl_reg_loss: 8.7739; train_edge_recon_loss: 346494.9375; train_gene_expr_recon_loss: 74655.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421159.3750; train_optim_loss: 421159.3750; val_kl_reg_loss: 15.1573; val_edge_recon_loss: 393217.1875; val_gene_expr_recon_loss: 70200.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463432.5000; val_optim_loss: 463432.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8454; val_auprc_score: 0.8153; val_best_acc_score: 0.7443; val_best_f1_score: 0.7887; train_kl_reg_loss: 17.1811; train_edge_recon_loss: 346631.2812; train_gene_expr_recon_loss: 71139.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417788.1250; train_optim_loss: 417788.1250; val_kl_reg_loss: 28.1811; val_edge_recon_loss: 395336.6875; val_gene_expr_recon_loss: 69159.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464524.1875; val_optim_loss: 464524.1875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8482; val_auprc_score: 0.8226; val_best_acc_score: 0.7443; val_best_f1_score: 0.7594; train_kl_reg_loss: 31.5622; train_edge_recon_loss: 346407.4688; train_gene_expr_recon_loss: 69899.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416338.3438; train_optim_loss: 416338.3438; val_kl_reg_loss: 47.9764; val_edge_recon_loss: 395593.0312; val_gene_expr_recon_loss: 69167.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464808.7188; val_optim_loss: 464808.7188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8170; val_auprc_score: 0.8201; val_best_acc_score: 0.7216; val_best_f1_score: 0.7633; train_kl_reg_loss: 55.0981; train_edge_recon_loss: 345659.9375; train_gene_expr_recon_loss: 69789.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415504.8750; train_optim_loss: 415504.8750; val_kl_reg_loss: 82.5458; val_edge_recon_loss: 396913.5000; val_gene_expr_recon_loss: 69483.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466479.2500; val_optim_loss: 466479.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8183; val_auprc_score: 0.8090; val_best_acc_score: 0.7045; val_best_f1_score: 0.7524; train_kl_reg_loss: 93.2017; train_edge_recon_loss: 345624.8750; train_gene_expr_recon_loss: 70045.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415763.5000; train_optim_loss: 415763.5000; val_kl_reg_loss: 84.7760; val_edge_recon_loss: 398916.7812; val_gene_expr_recon_loss: 69465.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468467.3125; val_optim_loss: 468467.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8067; val_auprc_score: 0.7440; val_best_acc_score: 0.7159; val_best_f1_score: 0.7596; train_kl_reg_loss: 97.8076; train_edge_recon_loss: 345402.7812; train_gene_expr_recon_loss: 70013.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415513.9375; train_optim_loss: 415513.9375; val_kl_reg_loss: 84.5175; val_edge_recon_loss: 397649.5312; val_gene_expr_recon_loss: 69375.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467109.9062; val_optim_loss: 467109.9062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 2 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
Val AUROC score: 0.8883
Val AUPRC score: 0.8744
Val best accuracy score: 0.8182
Val best F1 score: 0.8293
Val gene expr MSE score: 0.0127
Duration of model training in run 2: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 1549
Number of validation edges: 172
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9688; val_auprc_score: 0.9580; val_best_acc_score: 0.9244; val_best_f1_score: 0.9257; train_kl_reg_loss: 1.5148; train_edge_recon_loss: 346853.7188; train_gene_expr_recon_loss: 96849.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443704.8750; train_optim_loss: 443704.8750; val_kl_reg_loss: 4.4098; val_edge_recon_loss: 386818.3750; val_gene_expr_recon_loss: 84921.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471744.5625; val_optim_loss: 471744.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9442; val_auprc_score: 0.8813; val_best_acc_score: 0.8866; val_best_f1_score: 0.8836; train_kl_reg_loss: 4.3802; train_edge_recon_loss: 346627.7188; train_gene_expr_recon_loss: 81680.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428312.5000; train_optim_loss: 428312.5000; val_kl_reg_loss: 11.0533; val_edge_recon_loss: 391714.5625; val_gene_expr_recon_loss: 76932.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468657.7812; val_optim_loss: 468657.7812
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9572; val_auprc_score: 0.9237; val_best_acc_score: 0.8983; val_best_f1_score: 0.9041; train_kl_reg_loss: 10.6798; train_edge_recon_loss: 346656.9688; train_gene_expr_recon_loss: 73674.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420342.3750; train_optim_loss: 420342.3750; val_kl_reg_loss: 22.7940; val_edge_recon_loss: 393230.5312; val_gene_expr_recon_loss: 73830.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467083.5938; val_optim_loss: 467083.5938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9318; val_auprc_score: 0.9181; val_best_acc_score: 0.7762; val_best_f1_score: 0.8136; train_kl_reg_loss: 21.8051; train_edge_recon_loss: 346402.1250; train_gene_expr_recon_loss: 70365.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416789.8438; train_optim_loss: 416789.8438; val_kl_reg_loss: 43.3234; val_edge_recon_loss: 396101.4688; val_gene_expr_recon_loss: 73174.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469319.4688; val_optim_loss: 469319.4688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9340; val_auprc_score: 0.9195; val_best_acc_score: 0.7994; val_best_f1_score: 0.8186; train_kl_reg_loss: 41.3942; train_edge_recon_loss: 346573.8750; train_gene_expr_recon_loss: 69434.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416049.4688; train_optim_loss: 416049.4688; val_kl_reg_loss: 73.6967; val_edge_recon_loss: 394034.0000; val_gene_expr_recon_loss: 73477.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467585.4688; val_optim_loss: 467585.4688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9065; val_auprc_score: 0.8889; val_best_acc_score: 0.8023; val_best_f1_score: 0.7806; train_kl_reg_loss: 69.8312; train_edge_recon_loss: 346112.5938; train_gene_expr_recon_loss: 69432.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415614.8125; train_optim_loss: 415614.8125; val_kl_reg_loss: 123.0089; val_edge_recon_loss: 394435.6250; val_gene_expr_recon_loss: 73972.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468531.4688; val_optim_loss: 468531.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9100; val_auprc_score: 0.8929; val_best_acc_score: 0.7965; val_best_f1_score: 0.7886; train_kl_reg_loss: 115.3020; train_edge_recon_loss: 345310.2812; train_gene_expr_recon_loss: 69626.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415051.6562; train_optim_loss: 415051.6562; val_kl_reg_loss: 128.7892; val_edge_recon_loss: 392195.2812; val_gene_expr_recon_loss: 73972.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466296.4688; val_optim_loss: 466296.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8916; val_auprc_score: 0.8675; val_best_acc_score: 0.7936; val_best_f1_score: 0.7774; train_kl_reg_loss: 120.0781; train_edge_recon_loss: 345064.3125; train_gene_expr_recon_loss: 69592.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414777.1875; train_optim_loss: 414777.1875; val_kl_reg_loss: 136.6654; val_edge_recon_loss: 393113.6875; val_gene_expr_recon_loss: 73892.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467143.2500; val_optim_loss: 467143.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8891; val_auprc_score: 0.8849; val_best_acc_score: 0.7994; val_best_f1_score: 0.7850; train_kl_reg_loss: 124.8818; train_edge_recon_loss: 344973.1562; train_gene_expr_recon_loss: 69503.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414601.5000; train_optim_loss: 414601.5000; val_kl_reg_loss: 140.8067; val_edge_recon_loss: 394213.0938; val_gene_expr_recon_loss: 73757.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468111.0312; val_optim_loss: 468111.0312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9145; val_auprc_score: 0.9187; val_best_acc_score: 0.8140; val_best_f1_score: 0.7962; train_kl_reg_loss: 129.8150; train_edge_recon_loss: 345366.6250; train_gene_expr_recon_loss: 69362.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414858.5625; train_optim_loss: 414858.5625; val_kl_reg_loss: 147.3645; val_edge_recon_loss: 389351.9688; val_gene_expr_recon_loss: 73583.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463083.3125; val_optim_loss: 463083.3125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8809; val_auprc_score: 0.8830; val_best_acc_score: 0.7791; val_best_f1_score: 0.7728; train_kl_reg_loss: 134.6956; train_edge_recon_loss: 344800.8125; train_gene_expr_recon_loss: 69170.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414106.1875; train_optim_loss: 414106.1875; val_kl_reg_loss: 155.3794; val_edge_recon_loss: 390714.0000; val_gene_expr_recon_loss: 73389.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464258.3750; val_optim_loss: 464258.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8673; val_auprc_score: 0.8668; val_best_acc_score: 0.7849; val_best_f1_score: 0.7716; train_kl_reg_loss: 140.6891; train_edge_recon_loss: 344913.7188; train_gene_expr_recon_loss: 68968.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414023.3750; train_optim_loss: 414023.3750; val_kl_reg_loss: 161.0156; val_edge_recon_loss: 391712.7188; val_gene_expr_recon_loss: 73185.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465058.7500; val_optim_loss: 465058.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8494; val_auprc_score: 0.7989; val_best_acc_score: 0.7674; val_best_f1_score: 0.7593; train_kl_reg_loss: 143.6652; train_edge_recon_loss: 344737.1875; train_gene_expr_recon_loss: 68767.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413647.9375; train_optim_loss: 413647.9375; val_kl_reg_loss: 166.2436; val_edge_recon_loss: 391525.7188; val_gene_expr_recon_loss: 72982.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464674.1250; val_optim_loss: 464674.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8825; val_auprc_score: 0.8481; val_best_acc_score: 0.7878; val_best_f1_score: 0.7904; train_kl_reg_loss: 148.1653; train_edge_recon_loss: 344267.2500; train_gene_expr_recon_loss: 68561.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412976.7188; train_optim_loss: 412976.7188; val_kl_reg_loss: 162.8142; val_edge_recon_loss: 386582.7812; val_gene_expr_recon_loss: 72961.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459707.2500; val_optim_loss: 459707.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8945; val_auprc_score: 0.8681; val_best_acc_score: 0.8023; val_best_f1_score: 0.7848; train_kl_reg_loss: 148.4194; train_edge_recon_loss: 344433.2500; train_gene_expr_recon_loss: 68546.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413128.0625; train_optim_loss: 413128.0625; val_kl_reg_loss: 164.9050; val_edge_recon_loss: 389503.0000; val_gene_expr_recon_loss: 72940.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462608.0000; val_optim_loss: 462608.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8770; val_auprc_score: 0.8741; val_best_acc_score: 0.7733; val_best_f1_score: 0.7700; train_kl_reg_loss: 150.6506; train_edge_recon_loss: 344792.2812; train_gene_expr_recon_loss: 68514.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413457.2812; train_optim_loss: 413457.2812; val_kl_reg_loss: 166.1564; val_edge_recon_loss: 390360.5312; val_gene_expr_recon_loss: 72917.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463444.3125; val_optim_loss: 463444.3125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8836; val_auprc_score: 0.8498; val_best_acc_score: 0.7849; val_best_f1_score: 0.7773; train_kl_reg_loss: 150.5838; train_edge_recon_loss: 344378.2188; train_gene_expr_recon_loss: 68490.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413019.5000; train_optim_loss: 413019.5000; val_kl_reg_loss: 163.4784; val_edge_recon_loss: 390134.7500; val_gene_expr_recon_loss: 72894.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463192.6250; val_optim_loss: 463192.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9166; val_auprc_score: 0.9260; val_best_acc_score: 0.8140; val_best_f1_score: 0.7922; train_kl_reg_loss: 153.2534; train_edge_recon_loss: 344996.8750; train_gene_expr_recon_loss: 68492.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413642.3125; train_optim_loss: 413642.3125; val_kl_reg_loss: 165.1891; val_edge_recon_loss: 387667.5000; val_gene_expr_recon_loss: 72892.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460724.7188; val_optim_loss: 460724.7188
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9044; val_auprc_score: 0.8789; val_best_acc_score: 0.8140; val_best_f1_score: 0.7981; train_kl_reg_loss: 150.7922; train_edge_recon_loss: 344380.9375; train_gene_expr_recon_loss: 68460.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412992.0312; train_optim_loss: 412992.0312; val_kl_reg_loss: 164.9209; val_edge_recon_loss: 387739.8438; val_gene_expr_recon_loss: 72889.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460794.3125; val_optim_loss: 460794.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8808; val_auprc_score: 0.8392; val_best_acc_score: 0.7820; val_best_f1_score: 0.7791; train_kl_reg_loss: 151.5536; train_edge_recon_loss: 344387.5000; train_gene_expr_recon_loss: 68471.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413010.0625; train_optim_loss: 413010.0625; val_kl_reg_loss: 164.1172; val_edge_recon_loss: 388883.9688; val_gene_expr_recon_loss: 72887.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461935.1250; val_optim_loss: 461935.1250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.8778
Val AUPRC score: 0.8490
Val best accuracy score: 0.7994
Val best F1 score: 0.7837
Val gene expr MSE score: 0.0113
Duration of model training in run 3: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 1549
Number of validation edges: 172
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9686; val_auprc_score: 0.9346; val_best_acc_score: 0.9012; val_best_f1_score: 0.9024; train_kl_reg_loss: 1.5963; train_edge_recon_loss: 346585.2812; train_gene_expr_recon_loss: 97994.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444581.0938; train_optim_loss: 444581.0938; val_kl_reg_loss: 4.1088; val_edge_recon_loss: 385854.4375; val_gene_expr_recon_loss: 77788.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463647.2812; val_optim_loss: 463647.2812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9694; val_auprc_score: 0.9686; val_best_acc_score: 0.8924; val_best_f1_score: 0.8909; train_kl_reg_loss: 4.3996; train_edge_recon_loss: 346835.6562; train_gene_expr_recon_loss: 82767.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429608.0000; train_optim_loss: 429608.0000; val_kl_reg_loss: 10.1503; val_edge_recon_loss: 392522.6562; val_gene_expr_recon_loss: 70504.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463036.9062; val_optim_loss: 463036.9062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9571; val_auprc_score: 0.9346; val_best_acc_score: 0.8983; val_best_f1_score: 0.9057; train_kl_reg_loss: 10.9553; train_edge_recon_loss: 346479.1250; train_gene_expr_recon_loss: 74432.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420922.2812; train_optim_loss: 420922.2812; val_kl_reg_loss: 19.2617; val_edge_recon_loss: 394241.6875; val_gene_expr_recon_loss: 67482.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461743.1250; val_optim_loss: 461743.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9458; val_auprc_score: 0.8964; val_best_acc_score: 0.8372; val_best_f1_score: 0.8593; train_kl_reg_loss: 21.5619; train_edge_recon_loss: 346552.4062; train_gene_expr_recon_loss: 70937.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417511.1250; train_optim_loss: 417511.1250; val_kl_reg_loss: 34.4263; val_edge_recon_loss: 396490.3125; val_gene_expr_recon_loss: 66538.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463063.5000; val_optim_loss: 463063.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9293; val_auprc_score: 0.9127; val_best_acc_score: 0.8023; val_best_f1_score: 0.7862; train_kl_reg_loss: 39.5316; train_edge_recon_loss: 346177.6875; train_gene_expr_recon_loss: 69818.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416036.1562; train_optim_loss: 416036.1562; val_kl_reg_loss: 60.4398; val_edge_recon_loss: 396920.4375; val_gene_expr_recon_loss: 66522.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463503.0312; val_optim_loss: 463503.0312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9275; val_auprc_score: 0.9150; val_best_acc_score: 0.8285; val_best_f1_score: 0.8115; train_kl_reg_loss: 68.5944; train_edge_recon_loss: 346259.7500; train_gene_expr_recon_loss: 69768.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416096.5000; train_optim_loss: 416096.5000; val_kl_reg_loss: 97.3360; val_edge_recon_loss: 397452.2812; val_gene_expr_recon_loss: 66839.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464389.4375; val_optim_loss: 464389.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9166; val_auprc_score: 0.9029; val_best_acc_score: 0.8227; val_best_f1_score: 0.8076; train_kl_reg_loss: 114.5508; train_edge_recon_loss: 345539.4375; train_gene_expr_recon_loss: 70124.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415778.3750; train_optim_loss: 415778.3750; val_kl_reg_loss: 105.6734; val_edge_recon_loss: 395843.9688; val_gene_expr_recon_loss: 66827.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462777.0312; val_optim_loss: 462777.0312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9187; val_auprc_score: 0.8930; val_best_acc_score: 0.8256; val_best_f1_score: 0.8113; train_kl_reg_loss: 119.5667; train_edge_recon_loss: 345330.3750; train_gene_expr_recon_loss: 70102.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415552.7188; train_optim_loss: 415552.7188; val_kl_reg_loss: 107.0930; val_edge_recon_loss: 395828.2500; val_gene_expr_recon_loss: 66741.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462676.8125; val_optim_loss: 462676.8125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9272; val_auprc_score: 0.9247; val_best_acc_score: 0.8343; val_best_f1_score: 0.8190; train_kl_reg_loss: 126.2067; train_edge_recon_loss: 345337.5312; train_gene_expr_recon_loss: 70010.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415474.6250; train_optim_loss: 415474.6250; val_kl_reg_loss: 112.9878; val_edge_recon_loss: 396684.9062; val_gene_expr_recon_loss: 66602.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463400.4375; val_optim_loss: 463400.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 2 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
Val AUROC score: 0.9599
Val AUPRC score: 0.9278
Val best accuracy score: 0.8924
Val best F1 score: 0.9008
Val gene expr MSE score: 0.0121
Duration of model training in run 4: 0 hours, 0 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 2290
Number of validation edges: 254
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9419; val_auprc_score: 0.8889; val_best_acc_score: 0.8425; val_best_f1_score: 0.8630; train_kl_reg_loss: 5.3231; train_edge_recon_loss: 346479.6875; train_gene_expr_recon_loss: 82794.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429279.9896; train_optim_loss: 429279.9896; val_kl_reg_loss: 19.2188; val_edge_recon_loss: 396307.4375; val_gene_expr_recon_loss: 67639.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463966.0312; val_optim_loss: 463966.0312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9251; val_auprc_score: 0.8922; val_best_acc_score: 0.8484; val_best_f1_score: 0.8379; train_kl_reg_loss: 37.1717; train_edge_recon_loss: 346357.2292; train_gene_expr_recon_loss: 77049.9401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423444.3333; train_optim_loss: 423444.3333; val_kl_reg_loss: 80.2792; val_edge_recon_loss: 399189.9688; val_gene_expr_recon_loss: 67149.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466419.8125; val_optim_loss: 466419.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8717; val_auprc_score: 0.8563; val_best_acc_score: 0.8091; val_best_f1_score: 0.8079; train_kl_reg_loss: 143.6476; train_edge_recon_loss: 345246.0625; train_gene_expr_recon_loss: 75856.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421246.2188; train_optim_loss: 421246.2188; val_kl_reg_loss: 225.7846; val_edge_recon_loss: 396146.5625; val_gene_expr_recon_loss: 67769.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464141.4375; val_optim_loss: 464141.4375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8468; val_auprc_score: 0.8318; val_best_acc_score: 0.7382; val_best_f1_score: 0.7537; train_kl_reg_loss: 253.1208; train_edge_recon_loss: 343385.5729; train_gene_expr_recon_loss: 67747.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411385.9792; train_optim_loss: 411385.9792; val_kl_reg_loss: 402.8870; val_edge_recon_loss: 370638.2812; val_gene_expr_recon_loss: 66501.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437542.4375; val_optim_loss: 437542.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8270; val_auprc_score: 0.8176; val_best_acc_score: 0.7244; val_best_f1_score: 0.7682; train_kl_reg_loss: 372.4771; train_edge_recon_loss: 341108.5312; train_gene_expr_recon_loss: 64719.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406200.2708; train_optim_loss: 406200.2708; val_kl_reg_loss: 512.6750; val_edge_recon_loss: 341501.1875; val_gene_expr_recon_loss: 66455.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408469.8750; val_optim_loss: 408469.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8723; val_auprc_score: 0.8832; val_best_acc_score: 0.7953; val_best_f1_score: 0.7759; train_kl_reg_loss: 482.0338; train_edge_recon_loss: 335822.5208; train_gene_expr_recon_loss: 64020.9701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400325.5208; train_optim_loss: 400325.5208; val_kl_reg_loss: 633.3522; val_edge_recon_loss: 303200.3125; val_gene_expr_recon_loss: 66422.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370256.5312; val_optim_loss: 370256.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8738; val_auprc_score: 0.8719; val_best_acc_score: 0.7638; val_best_f1_score: 0.7846; train_kl_reg_loss: 582.6394; train_edge_recon_loss: 329063.9688; train_gene_expr_recon_loss: 63202.9779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392849.5938; train_optim_loss: 392849.5938; val_kl_reg_loss: 833.7505; val_edge_recon_loss: 297346.4688; val_gene_expr_recon_loss: 66109.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364289.6250; val_optim_loss: 364289.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8576; val_auprc_score: 0.8449; val_best_acc_score: 0.7520; val_best_f1_score: 0.7742; train_kl_reg_loss: 952.9428; train_edge_recon_loss: 315924.8646; train_gene_expr_recon_loss: 69361.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386239.7604; train_optim_loss: 386239.7604; val_kl_reg_loss: 1694.7257; val_edge_recon_loss: 301656.9375; val_gene_expr_recon_loss: 65798.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369149.7500; val_optim_loss: 369149.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8608; val_auprc_score: 0.8689; val_best_acc_score: 0.7146; val_best_f1_score: 0.7598; train_kl_reg_loss: 2062.1880; train_edge_recon_loss: 306852.1250; train_gene_expr_recon_loss: 66055.8112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374970.1146; train_optim_loss: 374970.1146; val_kl_reg_loss: 3422.2222; val_edge_recon_loss: 305377.8750; val_gene_expr_recon_loss: 65804.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374604.3438; val_optim_loss: 374604.3438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8423; val_auprc_score: 0.8430; val_best_acc_score: 0.7264; val_best_f1_score: 0.7632; train_kl_reg_loss: 3943.4497; train_edge_recon_loss: 298043.5104; train_gene_expr_recon_loss: 66546.0664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368533.0104; train_optim_loss: 368533.0104; val_kl_reg_loss: 5571.3706; val_edge_recon_loss: 306475.8750; val_gene_expr_recon_loss: 65484.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377531.7812; val_optim_loss: 377531.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8622; val_auprc_score: 0.8414; val_best_acc_score: 0.7421; val_best_f1_score: 0.7772; train_kl_reg_loss: 5809.4224; train_edge_recon_loss: 296101.5521; train_gene_expr_recon_loss: 72164.3620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374075.3333; train_optim_loss: 374075.3333; val_kl_reg_loss: 5690.7373; val_edge_recon_loss: 292060.2188; val_gene_expr_recon_loss: 65340.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363091.1875; val_optim_loss: 363091.1875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8554; val_auprc_score: 0.8321; val_best_acc_score: 0.7539; val_best_f1_score: 0.7805; train_kl_reg_loss: 5577.7510; train_edge_recon_loss: 292679.2396; train_gene_expr_recon_loss: 64668.6862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362925.6771; train_optim_loss: 362925.6771; val_kl_reg_loss: 5746.8838; val_edge_recon_loss: 293174.2500; val_gene_expr_recon_loss: 65081.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364002.8750; val_optim_loss: 364002.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8648; val_auprc_score: 0.8420; val_best_acc_score: 0.7500; val_best_f1_score: 0.7868; train_kl_reg_loss: 6039.7741; train_edge_recon_loss: 288552.8125; train_gene_expr_recon_loss: 72058.2943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366650.8958; train_optim_loss: 366650.8958; val_kl_reg_loss: 5831.7656; val_edge_recon_loss: 287701.9062; val_gene_expr_recon_loss: 64799.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358332.9375; val_optim_loss: 358332.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8658; val_auprc_score: 0.8462; val_best_acc_score: 0.7500; val_best_f1_score: 0.7830; train_kl_reg_loss: 5783.9520; train_edge_recon_loss: 294371.2188; train_gene_expr_recon_loss: 69665.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369820.7188; train_optim_loss: 369820.7188; val_kl_reg_loss: 5859.1973; val_edge_recon_loss: 287273.6250; val_gene_expr_recon_loss: 64537.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357670.7812; val_optim_loss: 357670.7812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8581; val_auprc_score: 0.8528; val_best_acc_score: 0.7461; val_best_f1_score: 0.7650; train_kl_reg_loss: 6129.7350; train_edge_recon_loss: 292699.2708; train_gene_expr_recon_loss: 72104.4036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370933.4167; train_optim_loss: 370933.4167; val_kl_reg_loss: 5787.6279; val_edge_recon_loss: 305926.2188; val_gene_expr_recon_loss: 64319.9023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376033.7500; val_optim_loss: 376033.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8569; val_auprc_score: 0.8322; val_best_acc_score: 0.7402; val_best_f1_score: 0.7744; train_kl_reg_loss: 5676.2842; train_edge_recon_loss: 295835.2812; train_gene_expr_recon_loss: 68886.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370398.1250; train_optim_loss: 370398.1250; val_kl_reg_loss: 5596.8555; val_edge_recon_loss: 295478.2188; val_gene_expr_recon_loss: 64164.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365239.6875; val_optim_loss: 365239.6875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8535; val_auprc_score: 0.8281; val_best_acc_score: 0.7520; val_best_f1_score: 0.7786; train_kl_reg_loss: 5378.4499; train_edge_recon_loss: 293212.5208; train_gene_expr_recon_loss: 64593.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363184.0521; train_optim_loss: 363184.0521; val_kl_reg_loss: 5544.3809; val_edge_recon_loss: 293087.2812; val_gene_expr_recon_loss: 64048.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362680.1250; val_optim_loss: 362680.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8428; val_auprc_score: 0.8119; val_best_acc_score: 0.7402; val_best_f1_score: 0.7719; train_kl_reg_loss: 5370.6413; train_edge_recon_loss: 290058.4792; train_gene_expr_recon_loss: 67843.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363272.2604; train_optim_loss: 363272.2604; val_kl_reg_loss: 5546.9082; val_edge_recon_loss: 297801.0938; val_gene_expr_recon_loss: 64038.3945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367386.4062; val_optim_loss: 367386.4062
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8598; val_auprc_score: 0.8369; val_best_acc_score: 0.7441; val_best_f1_score: 0.7764; train_kl_reg_loss: 5354.0648; train_edge_recon_loss: 297089.0729; train_gene_expr_recon_loss: 69296.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371739.9479; train_optim_loss: 371739.9479; val_kl_reg_loss: 5541.1650; val_edge_recon_loss: 291908.7812; val_gene_expr_recon_loss: 64029.0352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361478.9688; val_optim_loss: 361478.9688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8742; val_auprc_score: 0.8758; val_best_acc_score: 0.7618; val_best_f1_score: 0.7832; train_kl_reg_loss: 5370.1191; train_edge_recon_loss: 294620.9375; train_gene_expr_recon_loss: 65496.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365487.4896; train_optim_loss: 365487.4896; val_kl_reg_loss: 5425.6968; val_edge_recon_loss: 288145.5312; val_gene_expr_recon_loss: 64020.0117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357591.2188; val_optim_loss: 357591.2188
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8624; val_auprc_score: 0.8825; val_best_acc_score: 0.7382; val_best_f1_score: 0.7656; train_kl_reg_loss: 5391.6437; train_edge_recon_loss: 295817.1042; train_gene_expr_recon_loss: 68509.8099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369718.5625; train_optim_loss: 369718.5625; val_kl_reg_loss: 5414.8618; val_edge_recon_loss: 304236.4688; val_gene_expr_recon_loss: 64011.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373662.5000; val_optim_loss: 373662.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8581; val_auprc_score: 0.8508; val_best_acc_score: 0.7402; val_best_f1_score: 0.7658; train_kl_reg_loss: 5555.5003; train_edge_recon_loss: 292396.5625; train_gene_expr_recon_loss: 65879.9427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363832.0208; train_optim_loss: 363832.0208; val_kl_reg_loss: 5419.0903; val_edge_recon_loss: 301450.8125; val_gene_expr_recon_loss: 64002.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370872.4375; val_optim_loss: 370872.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8675; val_auprc_score: 0.8648; val_best_acc_score: 0.7598; val_best_f1_score: 0.7801; train_kl_reg_loss: 5119.0596; train_edge_recon_loss: 289456.5312; train_gene_expr_recon_loss: 68089.1927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362664.7917; train_optim_loss: 362664.7917; val_kl_reg_loss: 5447.0410; val_edge_recon_loss: 290449.6875; val_gene_expr_recon_loss: 63994.4414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359891.1562; val_optim_loss: 359891.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8689; val_auprc_score: 0.8766; val_best_acc_score: 0.7500; val_best_f1_score: 0.7730; train_kl_reg_loss: 4950.3254; train_edge_recon_loss: 292769.9375; train_gene_expr_recon_loss: 64151.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361871.8125; train_optim_loss: 361871.8125; val_kl_reg_loss: 5376.5732; val_edge_recon_loss: 295048.0312; val_gene_expr_recon_loss: 63993.6445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364418.2500; val_optim_loss: 364418.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8666; val_auprc_score: 0.8666; val_best_acc_score: 0.7500; val_best_f1_score: 0.7781; train_kl_reg_loss: 5393.8302; train_edge_recon_loss: 294344.6979; train_gene_expr_recon_loss: 70738.9427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370477.4583; train_optim_loss: 370477.4583; val_kl_reg_loss: 5360.4609; val_edge_recon_loss: 293007.6875; val_gene_expr_recon_loss: 63992.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362360.9375; val_optim_loss: 362360.9375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8662; val_auprc_score: 0.8606; val_best_acc_score: 0.7480; val_best_f1_score: 0.7732; train_kl_reg_loss: 5311.7861; train_edge_recon_loss: 297382.2292; train_gene_expr_recon_loss: 69440.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372134.7708; train_optim_loss: 372134.7708; val_kl_reg_loss: 5249.6304; val_edge_recon_loss: 295420.0312; val_gene_expr_recon_loss: 63992.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364661.6875; val_optim_loss: 364661.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.8587
Val AUPRC score: 0.8533
Val best accuracy score: 0.7461
Val best F1 score: 0.7749
Val gene expr MSE score: 0.0099
Duration of model training in run 5: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 2290
Number of validation edges: 254
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9638; val_auprc_score: 0.9337; val_best_acc_score: 0.8819; val_best_f1_score: 0.8921; train_kl_reg_loss: 5.0422; train_edge_recon_loss: 346506.3958; train_gene_expr_recon_loss: 88465.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434976.8542; train_optim_loss: 434976.8542; val_kl_reg_loss: 17.6108; val_edge_recon_loss: 393239.8750; val_gene_expr_recon_loss: 65697.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458954.9375; val_optim_loss: 458954.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9232; val_auprc_score: 0.8911; val_best_acc_score: 0.8445; val_best_f1_score: 0.8301; train_kl_reg_loss: 33.2109; train_edge_recon_loss: 346451.7604; train_gene_expr_recon_loss: 71727.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418212.9688; train_optim_loss: 418212.9688; val_kl_reg_loss: 70.0950; val_edge_recon_loss: 396771.6250; val_gene_expr_recon_loss: 64559.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461401.1562; val_optim_loss: 461401.1562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8808; val_auprc_score: 0.8509; val_best_acc_score: 0.8150; val_best_f1_score: 0.8082; train_kl_reg_loss: 105.6084; train_edge_recon_loss: 346068.0938; train_gene_expr_recon_loss: 68898.4935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415072.2083; train_optim_loss: 415072.2083; val_kl_reg_loss: 188.9198; val_edge_recon_loss: 388916.7188; val_gene_expr_recon_loss: 65729.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454835.1562; val_optim_loss: 454835.1562
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8540; val_auprc_score: 0.8652; val_best_acc_score: 0.7776; val_best_f1_score: 0.7651; train_kl_reg_loss: 262.5048; train_edge_recon_loss: 344183.8021; train_gene_expr_recon_loss: 72245.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416691.3542; train_optim_loss: 416691.3542; val_kl_reg_loss: 373.8255; val_edge_recon_loss: 360506.2812; val_gene_expr_recon_loss: 64316.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425196.5000; val_optim_loss: 425196.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8463; val_auprc_score: 0.8414; val_best_acc_score: 0.7402; val_best_f1_score: 0.7780; train_kl_reg_loss: 420.7082; train_edge_recon_loss: 340179.9792; train_gene_expr_recon_loss: 66030.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406631.2708; train_optim_loss: 406631.2708; val_kl_reg_loss: 556.5546; val_edge_recon_loss: 325603.3438; val_gene_expr_recon_loss: 64007.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390167.2812; val_optim_loss: 390167.2812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8558; val_auprc_score: 0.8626; val_best_acc_score: 0.7618; val_best_f1_score: 0.7782; train_kl_reg_loss: 655.8429; train_edge_recon_loss: 334288.8542; train_gene_expr_recon_loss: 70658.8464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405603.5312; train_optim_loss: 405603.5312; val_kl_reg_loss: 683.6364; val_edge_recon_loss: 307568.9062; val_gene_expr_recon_loss: 64049.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372302.3125; val_optim_loss: 372302.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8606; val_auprc_score: 0.8475; val_best_acc_score: 0.7480; val_best_f1_score: 0.7846; train_kl_reg_loss: 845.4562; train_edge_recon_loss: 323891.4271; train_gene_expr_recon_loss: 69020.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393757.1458; train_optim_loss: 393757.1458; val_kl_reg_loss: 1040.4950; val_edge_recon_loss: 293442.5625; val_gene_expr_recon_loss: 63475.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357958.0625; val_optim_loss: 357958.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8503; val_auprc_score: 0.8402; val_best_acc_score: 0.7323; val_best_f1_score: 0.7761; train_kl_reg_loss: 1479.6253; train_edge_recon_loss: 311418.9479; train_gene_expr_recon_loss: 73168.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386067.5625; train_optim_loss: 386067.5625; val_kl_reg_loss: 1988.6877; val_edge_recon_loss: 294504.2812; val_gene_expr_recon_loss: 63028.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359520.9688; val_optim_loss: 359520.9688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8634; val_auprc_score: 0.8519; val_best_acc_score: 0.7382; val_best_f1_score: 0.7823; train_kl_reg_loss: 2654.4990; train_edge_recon_loss: 299199.6458; train_gene_expr_recon_loss: 71033.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372887.7292; train_optim_loss: 372887.7292; val_kl_reg_loss: 3759.3462; val_edge_recon_loss: 289959.2500; val_gene_expr_recon_loss: 63088.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356806.8750; val_optim_loss: 356806.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8615; val_auprc_score: 0.8521; val_best_acc_score: 0.7343; val_best_f1_score: 0.7780; train_kl_reg_loss: 4494.8538; train_edge_recon_loss: 297184.8958; train_gene_expr_recon_loss: 69062.4505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370742.1979; train_optim_loss: 370742.1979; val_kl_reg_loss: 5617.8086; val_edge_recon_loss: 296623.1562; val_gene_expr_recon_loss: 63200.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365441.9375; val_optim_loss: 365441.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8565; val_auprc_score: 0.8410; val_best_acc_score: 0.7461; val_best_f1_score: 0.7929; train_kl_reg_loss: 6192.8351; train_edge_recon_loss: 298236.3542; train_gene_expr_recon_loss: 68237.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372667.1667; train_optim_loss: 372667.1667; val_kl_reg_loss: 6605.9761; val_edge_recon_loss: 287227.0938; val_gene_expr_recon_loss: 62969.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356802.5625; val_optim_loss: 356802.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8822; val_auprc_score: 0.8805; val_best_acc_score: 0.7697; val_best_f1_score: 0.8006; train_kl_reg_loss: 6347.7430; train_edge_recon_loss: 297447.7812; train_gene_expr_recon_loss: 65519.5299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369315.0312; train_optim_loss: 369315.0312; val_kl_reg_loss: 6471.1514; val_edge_recon_loss: 280217.3125; val_gene_expr_recon_loss: 62876.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349564.6562; val_optim_loss: 349564.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8515; val_auprc_score: 0.8499; val_best_acc_score: 0.7087; val_best_f1_score: 0.7692; train_kl_reg_loss: 6839.4814; train_edge_recon_loss: 292336.1562; train_gene_expr_recon_loss: 75297.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374472.7708; train_optim_loss: 374472.7708; val_kl_reg_loss: 5965.7480; val_edge_recon_loss: 302877.7500; val_gene_expr_recon_loss: 62680.3633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371523.8750; val_optim_loss: 371523.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8693; val_auprc_score: 0.8652; val_best_acc_score: 0.7539; val_best_f1_score: 0.7864; train_kl_reg_loss: 5611.7975; train_edge_recon_loss: 292747.3438; train_gene_expr_recon_loss: 67714.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366073.9375; train_optim_loss: 366073.9375; val_kl_reg_loss: 5109.4902; val_edge_recon_loss: 285928.1875; val_gene_expr_recon_loss: 62398.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353435.8750; val_optim_loss: 353435.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8883; val_auprc_score: 0.8728; val_best_acc_score: 0.7953; val_best_f1_score: 0.8030; train_kl_reg_loss: 4713.0710; train_edge_recon_loss: 292006.0938; train_gene_expr_recon_loss: 71413.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368132.7708; train_optim_loss: 368132.7708; val_kl_reg_loss: 4044.8247; val_edge_recon_loss: 283834.6250; val_gene_expr_recon_loss: 62315.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350195.2500; val_optim_loss: 350195.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8895; val_auprc_score: 0.8633; val_best_acc_score: 0.7913; val_best_f1_score: 0.8052; train_kl_reg_loss: 3951.5320; train_edge_recon_loss: 290727.6562; train_gene_expr_recon_loss: 65650.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360329.8333; train_optim_loss: 360329.8333; val_kl_reg_loss: 3926.2551; val_edge_recon_loss: 274458.9375; val_gene_expr_recon_loss: 62246.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340631.9375; val_optim_loss: 340631.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8585; val_auprc_score: 0.8352; val_best_acc_score: 0.7598; val_best_f1_score: 0.7757; train_kl_reg_loss: 3744.2071; train_edge_recon_loss: 294419.6458; train_gene_expr_recon_loss: 64170.3971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362334.2500; train_optim_loss: 362334.2500; val_kl_reg_loss: 3909.9380; val_edge_recon_loss: 302164.8125; val_gene_expr_recon_loss: 62092.5664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368167.3125; val_optim_loss: 368167.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8695; val_auprc_score: 0.8535; val_best_acc_score: 0.7815; val_best_f1_score: 0.7917; train_kl_reg_loss: 3815.0052; train_edge_recon_loss: 290601.2708; train_gene_expr_recon_loss: 65474.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359891.0000; train_optim_loss: 359891.0000; val_kl_reg_loss: 3828.5386; val_edge_recon_loss: 299993.8750; val_gene_expr_recon_loss: 61907.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365730.1562; val_optim_loss: 365730.1562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8674; val_auprc_score: 0.8442; val_best_acc_score: 0.7736; val_best_f1_score: 0.7858; train_kl_reg_loss: 3944.1238; train_edge_recon_loss: 292188.5521; train_gene_expr_recon_loss: 64963.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361096.4792; train_optim_loss: 361096.4792; val_kl_reg_loss: 3694.9048; val_edge_recon_loss: 299864.7188; val_gene_expr_recon_loss: 61724.6602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365284.2812; val_optim_loss: 365284.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8716; val_auprc_score: 0.8519; val_best_acc_score: 0.7638; val_best_f1_score: 0.7786; train_kl_reg_loss: 3517.7031; train_edge_recon_loss: 290436.4479; train_gene_expr_recon_loss: 69499.5885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363453.7396; train_optim_loss: 363453.7396; val_kl_reg_loss: 3718.2466; val_edge_recon_loss: 293782.7188; val_gene_expr_recon_loss: 61706.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359207.6562; val_optim_loss: 359207.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8747; val_auprc_score: 0.8482; val_best_acc_score: 0.7677; val_best_f1_score: 0.7815; train_kl_reg_loss: 3625.2009; train_edge_recon_loss: 293786.8854; train_gene_expr_recon_loss: 68066.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365479.0000; train_optim_loss: 365479.0000; val_kl_reg_loss: 3703.8335; val_edge_recon_loss: 291165.1875; val_gene_expr_recon_loss: 61687.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356556.5938; val_optim_loss: 356556.5938
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8702; val_auprc_score: 0.8609; val_best_acc_score: 0.7598; val_best_f1_score: 0.7757; train_kl_reg_loss: 3640.8094; train_edge_recon_loss: 295248.6979; train_gene_expr_recon_loss: 66978.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365867.7812; train_optim_loss: 365867.7812; val_kl_reg_loss: 3749.7832; val_edge_recon_loss: 299057.3438; val_gene_expr_recon_loss: 61667.2852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364474.4062; val_optim_loss: 364474.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.8663
Val AUPRC score: 0.8383
Val best accuracy score: 0.7657
Val best F1 score: 0.7808
Val gene expr MSE score: 0.0099
Duration of model training in run 6: 0 hours, 0 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3020
Number of validation edges: 335
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9408; val_auprc_score: 0.9249; val_best_acc_score: 0.8687; val_best_f1_score: 0.8590; train_kl_reg_loss: 25.2817; train_edge_recon_loss: 346369.8958; train_gene_expr_recon_loss: 78277.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424672.4948; train_optim_loss: 424672.4948; val_kl_reg_loss: 94.4012; val_edge_recon_loss: 397889.2812; val_gene_expr_recon_loss: 73186.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471169.9375; val_optim_loss: 471169.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8612; val_auprc_score: 0.8313; val_best_acc_score: 0.7806; val_best_f1_score: 0.7850; train_kl_reg_loss: 194.1210; train_edge_recon_loss: 344776.9219; train_gene_expr_recon_loss: 70078.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415049.1771; train_optim_loss: 415049.1771; val_kl_reg_loss: 403.2646; val_edge_recon_loss: 370334.9375; val_gene_expr_recon_loss: 73111.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443849.7812; val_optim_loss: 443849.7812
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8298; val_auprc_score: 0.8142; val_best_acc_score: 0.7284; val_best_f1_score: 0.7705; train_kl_reg_loss: 519.2967; train_edge_recon_loss: 338698.9479; train_gene_expr_recon_loss: 68298.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407516.7865; train_optim_loss: 407516.7865; val_kl_reg_loss: 748.7159; val_edge_recon_loss: 309682.2812; val_gene_expr_recon_loss: 72018.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382449.0625; val_optim_loss: 382449.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8241; val_auprc_score: 0.7934; val_best_acc_score: 0.7269; val_best_f1_score: 0.7744; train_kl_reg_loss: 990.0049; train_edge_recon_loss: 319899.2344; train_gene_expr_recon_loss: 68162.3405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389051.5833; train_optim_loss: 389051.5833; val_kl_reg_loss: 1981.2213; val_edge_recon_loss: 293021.2500; val_gene_expr_recon_loss: 71494.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366496.9375; val_optim_loss: 366496.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8207; val_auprc_score: 0.8132; val_best_acc_score: 0.7149; val_best_f1_score: 0.7696; train_kl_reg_loss: 2919.0627; train_edge_recon_loss: 301463.3698; train_gene_expr_recon_loss: 68099.4434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372481.8698; train_optim_loss: 372481.8698; val_kl_reg_loss: 5228.3662; val_edge_recon_loss: 300257.9688; val_gene_expr_recon_loss: 71014.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376500.5000; val_optim_loss: 376500.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8274; val_auprc_score: 0.8141; val_best_acc_score: 0.7224; val_best_f1_score: 0.7681; train_kl_reg_loss: 6417.2734; train_edge_recon_loss: 293077.2604; train_gene_expr_recon_loss: 66480.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365974.9896; train_optim_loss: 365974.9896; val_kl_reg_loss: 8194.9121; val_edge_recon_loss: 299987.5625; val_gene_expr_recon_loss: 70503.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378685.8125; val_optim_loss: 378685.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8571; val_auprc_score: 0.8297; val_best_acc_score: 0.7522; val_best_f1_score: 0.7937; train_kl_reg_loss: 6699.6554; train_edge_recon_loss: 294186.1146; train_gene_expr_recon_loss: 66251.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367137.3073; train_optim_loss: 367137.3073; val_kl_reg_loss: 5950.0796; val_edge_recon_loss: 283310.0625; val_gene_expr_recon_loss: 70346.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359606.3750; val_optim_loss: 359606.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8609; val_auprc_score: 0.8379; val_best_acc_score: 0.7567; val_best_f1_score: 0.7927; train_kl_reg_loss: 5393.4609; train_edge_recon_loss: 291243.8073; train_gene_expr_recon_loss: 65697.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362335.0000; train_optim_loss: 362335.0000; val_kl_reg_loss: 5214.6406; val_edge_recon_loss: 284916.1562; val_gene_expr_recon_loss: 70162.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360293.0625; val_optim_loss: 360293.0625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8727; val_auprc_score: 0.8615; val_best_acc_score: 0.7612; val_best_f1_score: 0.7854; train_kl_reg_loss: 4549.7571; train_edge_recon_loss: 290216.1094; train_gene_expr_recon_loss: 65972.1341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360737.9948; train_optim_loss: 360737.9948; val_kl_reg_loss: 3995.6992; val_edge_recon_loss: 288122.0938; val_gene_expr_recon_loss: 69949.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362067.3125; val_optim_loss: 362067.3125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8495; val_auprc_score: 0.8300; val_best_acc_score: 0.7522; val_best_f1_score: 0.7802; train_kl_reg_loss: 3432.4256; train_edge_recon_loss: 288105.3438; train_gene_expr_recon_loss: 65034.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356571.9219; train_optim_loss: 356571.9219; val_kl_reg_loss: 3191.7686; val_edge_recon_loss: 290859.1562; val_gene_expr_recon_loss: 69951.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364002.8125; val_optim_loss: 364002.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8676; val_auprc_score: 0.8456; val_best_acc_score: 0.7791; val_best_f1_score: 0.7959; train_kl_reg_loss: 3061.9067; train_edge_recon_loss: 285285.5625; train_gene_expr_recon_loss: 65051.8932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353399.3698; train_optim_loss: 353399.3698; val_kl_reg_loss: 3171.5283; val_edge_recon_loss: 279870.6562; val_gene_expr_recon_loss: 69846.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352888.3438; val_optim_loss: 352888.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8623; val_auprc_score: 0.8450; val_best_acc_score: 0.7701; val_best_f1_score: 0.7907; train_kl_reg_loss: 3099.7256; train_edge_recon_loss: 285781.1615; train_gene_expr_recon_loss: 65376.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354257.6510; train_optim_loss: 354257.6510; val_kl_reg_loss: 3200.9785; val_edge_recon_loss: 288755.0312; val_gene_expr_recon_loss: 69679.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361635.8750; val_optim_loss: 361635.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8672; val_auprc_score: 0.8602; val_best_acc_score: 0.7672; val_best_f1_score: 0.7893; train_kl_reg_loss: 3136.8930; train_edge_recon_loss: 283884.7344; train_gene_expr_recon_loss: 65009.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352031.0729; train_optim_loss: 352031.0729; val_kl_reg_loss: 3257.8589; val_edge_recon_loss: 283410.3750; val_gene_expr_recon_loss: 69577.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356245.3125; val_optim_loss: 356245.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8601; val_auprc_score: 0.8560; val_best_acc_score: 0.7687; val_best_f1_score: 0.7947; train_kl_reg_loss: 3185.8271; train_edge_recon_loss: 286067.0052; train_gene_expr_recon_loss: 65265.8548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354518.6823; train_optim_loss: 354518.6823; val_kl_reg_loss: 3277.7615; val_edge_recon_loss: 282779.4375; val_gene_expr_recon_loss: 69550.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355607.8125; val_optim_loss: 355607.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8565; val_auprc_score: 0.8567; val_best_acc_score: 0.7552; val_best_f1_score: 0.7876; train_kl_reg_loss: 3182.0002; train_edge_recon_loss: 282194.9115; train_gene_expr_recon_loss: 64855.2995; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350232.2188; train_optim_loss: 350232.2188; val_kl_reg_loss: 3261.3655; val_edge_recon_loss: 287804.5312; val_gene_expr_recon_loss: 69550.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360615.9375; val_optim_loss: 360615.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8576; val_auprc_score: 0.8153; val_best_acc_score: 0.7731; val_best_f1_score: 0.8026; train_kl_reg_loss: 3208.4668; train_edge_recon_loss: 287114.7760; train_gene_expr_recon_loss: 64890.7174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355213.9583; train_optim_loss: 355213.9583; val_kl_reg_loss: 3304.8428; val_edge_recon_loss: 275233.5625; val_gene_expr_recon_loss: 69547.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348085.6250; val_optim_loss: 348085.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8659; val_auprc_score: 0.8729; val_best_acc_score: 0.7672; val_best_f1_score: 0.7903; train_kl_reg_loss: 3198.0138; train_edge_recon_loss: 281037.4688; train_gene_expr_recon_loss: 64824.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349059.5052; train_optim_loss: 349059.5052; val_kl_reg_loss: 3264.6506; val_edge_recon_loss: 285588.6875; val_gene_expr_recon_loss: 69544.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358398.3125; val_optim_loss: 358398.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8606; val_auprc_score: 0.8461; val_best_acc_score: 0.7627; val_best_f1_score: 0.7850; train_kl_reg_loss: 3191.5391; train_edge_recon_loss: 284645.0417; train_gene_expr_recon_loss: 65351.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353188.1875; train_optim_loss: 353188.1875; val_kl_reg_loss: 3297.6055; val_edge_recon_loss: 287807.6875; val_gene_expr_recon_loss: 69542.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360648.1875; val_optim_loss: 360648.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8517; val_auprc_score: 0.8378; val_best_acc_score: 0.7612; val_best_f1_score: 0.7823; train_kl_reg_loss: 3215.1593; train_edge_recon_loss: 283098.7500; train_gene_expr_recon_loss: 64656.9746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350970.8906; train_optim_loss: 350970.8906; val_kl_reg_loss: 3282.7344; val_edge_recon_loss: 291771.7812; val_gene_expr_recon_loss: 69539.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364594.3125; val_optim_loss: 364594.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8647; val_auprc_score: 0.8509; val_best_acc_score: 0.7657; val_best_f1_score: 0.7943; train_kl_reg_loss: 3197.7392; train_edge_recon_loss: 285202.9375; train_gene_expr_recon_loss: 65178.4232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353579.0885; train_optim_loss: 353579.0885; val_kl_reg_loss: 3288.0054; val_edge_recon_loss: 282547.7500; val_gene_expr_recon_loss: 69539.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355375.6250; val_optim_loss: 355375.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8510; val_auprc_score: 0.8301; val_best_acc_score: 0.7612; val_best_f1_score: 0.7823; train_kl_reg_loss: 3192.9516; train_edge_recon_loss: 283547.1562; train_gene_expr_recon_loss: 64977.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351717.1510; train_optim_loss: 351717.1510; val_kl_reg_loss: 3285.5449; val_edge_recon_loss: 291699.7500; val_gene_expr_recon_loss: 69539.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364524.9688; val_optim_loss: 364524.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8562; val_auprc_score: 0.8346; val_best_acc_score: 0.7642; val_best_f1_score: 0.7895; train_kl_reg_loss: 3219.5365; train_edge_recon_loss: 285643.5365; train_gene_expr_recon_loss: 65034.3353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353897.4062; train_optim_loss: 353897.4062; val_kl_reg_loss: 3263.7224; val_edge_recon_loss: 285018.2500; val_gene_expr_recon_loss: 69539.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357821.6250; val_optim_loss: 357821.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.8678
Val AUPRC score: 0.8665
Val best accuracy score: 0.7716
Val best F1 score: 0.7954
Val gene expr MSE score: 0.0093
Duration of model training in run 7: 0 hours, 0 minutes and 10 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3020
Number of validation edges: 335
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9289; val_auprc_score: 0.9087; val_best_acc_score: 0.8478; val_best_f1_score: 0.8344; train_kl_reg_loss: 18.8411; train_edge_recon_loss: 346417.9635; train_gene_expr_recon_loss: 79636.2018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426073.0000; train_optim_loss: 426073.0000; val_kl_reg_loss: 71.8110; val_edge_recon_loss: 397531.5000; val_gene_expr_recon_loss: 70620.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468223.5938; val_optim_loss: 468223.5938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8605; val_auprc_score: 0.8664; val_best_acc_score: 0.7701; val_best_f1_score: 0.7620; train_kl_reg_loss: 179.8606; train_edge_recon_loss: 344844.6458; train_gene_expr_recon_loss: 71761.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416786.4167; train_optim_loss: 416786.4167; val_kl_reg_loss: 355.4717; val_edge_recon_loss: 371837.7500; val_gene_expr_recon_loss: 70478.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442671.5312; val_optim_loss: 442671.5312
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8429; val_auprc_score: 0.8377; val_best_acc_score: 0.7328; val_best_f1_score: 0.7634; train_kl_reg_loss: 460.1871; train_edge_recon_loss: 340183.2917; train_gene_expr_recon_loss: 69634.1224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410277.6042; train_optim_loss: 410277.6042; val_kl_reg_loss: 539.7812; val_edge_recon_loss: 312464.2812; val_gene_expr_recon_loss: 69714.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382718.3750; val_optim_loss: 382718.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8107; val_auprc_score: 0.7990; val_best_acc_score: 0.7119; val_best_f1_score: 0.7462; train_kl_reg_loss: 774.4007; train_edge_recon_loss: 324989.9531; train_gene_expr_recon_loss: 68707.0990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394471.4479; train_optim_loss: 394471.4479; val_kl_reg_loss: 1241.5347; val_edge_recon_loss: 318098.5000; val_gene_expr_recon_loss: 68864.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388204.0938; val_optim_loss: 388204.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8486; val_auprc_score: 0.8611; val_best_acc_score: 0.7209; val_best_f1_score: 0.7677; train_kl_reg_loss: 2546.5486; train_edge_recon_loss: 303177.5208; train_gene_expr_recon_loss: 67603.9473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373328.0208; train_optim_loss: 373328.0208; val_kl_reg_loss: 4649.6489; val_edge_recon_loss: 296931.0312; val_gene_expr_recon_loss: 68460.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370041.0000; val_optim_loss: 370041.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8120; val_auprc_score: 0.8130; val_best_acc_score: 0.7104; val_best_f1_score: 0.7417; train_kl_reg_loss: 6093.0865; train_edge_recon_loss: 297290.2031; train_gene_expr_recon_loss: 67031.0996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370414.3906; train_optim_loss: 370414.3906; val_kl_reg_loss: 6282.5879; val_edge_recon_loss: 318626.1562; val_gene_expr_recon_loss: 68187.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393096.0000; val_optim_loss: 393096.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8472; val_auprc_score: 0.8554; val_best_acc_score: 0.7373; val_best_f1_score: 0.7739; train_kl_reg_loss: 6369.8063; train_edge_recon_loss: 294818.5469; train_gene_expr_recon_loss: 66826.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368015.3177; train_optim_loss: 368015.3177; val_kl_reg_loss: 5191.9688; val_edge_recon_loss: 294027.1250; val_gene_expr_recon_loss: 68024.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367243.0938; val_optim_loss: 367243.0938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8829; val_auprc_score: 0.8848; val_best_acc_score: 0.7746; val_best_f1_score: 0.8015; train_kl_reg_loss: 5210.7358; train_edge_recon_loss: 288557.5469; train_gene_expr_recon_loss: 66401.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360169.5990; train_optim_loss: 360169.5990; val_kl_reg_loss: 4070.8003; val_edge_recon_loss: 286085.8125; val_gene_expr_recon_loss: 67638.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357795.1250; val_optim_loss: 357795.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8521; val_auprc_score: 0.8288; val_best_acc_score: 0.7821; val_best_f1_score: 0.7882; train_kl_reg_loss: 4226.6687; train_edge_recon_loss: 283603.2917; train_gene_expr_recon_loss: 66623.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354453.1354; train_optim_loss: 354453.1354; val_kl_reg_loss: 3704.0493; val_edge_recon_loss: 294972.7188; val_gene_expr_recon_loss: 67818.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366495.1875; val_optim_loss: 366495.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8928; val_auprc_score: 0.8567; val_best_acc_score: 0.8149; val_best_f1_score: 0.8320; train_kl_reg_loss: 3836.2975; train_edge_recon_loss: 278305.5833; train_gene_expr_recon_loss: 65658.2493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347800.1406; train_optim_loss: 347800.1406; val_kl_reg_loss: 3431.9487; val_edge_recon_loss: 275894.5312; val_gene_expr_recon_loss: 67728.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347054.8125; val_optim_loss: 347054.8125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8912; val_auprc_score: 0.8567; val_best_acc_score: 0.8299; val_best_f1_score: 0.8399; train_kl_reg_loss: 3720.7335; train_edge_recon_loss: 274946.9896; train_gene_expr_recon_loss: 65739.7591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344407.4844; train_optim_loss: 344407.4844; val_kl_reg_loss: 3864.1050; val_edge_recon_loss: 284133.0000; val_gene_expr_recon_loss: 67902.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355899.3125; val_optim_loss: 355899.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9246; val_auprc_score: 0.9158; val_best_acc_score: 0.8627; val_best_f1_score: 0.8701; train_kl_reg_loss: 4341.6870; train_edge_recon_loss: 274548.7448; train_gene_expr_recon_loss: 66342.0872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345232.5104; train_optim_loss: 345232.5104; val_kl_reg_loss: 4711.5527; val_edge_recon_loss: 276674.9375; val_gene_expr_recon_loss: 67645.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349032.3438; val_optim_loss: 349032.3438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9408; val_auprc_score: 0.9161; val_best_acc_score: 0.8776; val_best_f1_score: 0.8858; train_kl_reg_loss: 4794.4104; train_edge_recon_loss: 273557.1406; train_gene_expr_recon_loss: 66189.3268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344540.8802; train_optim_loss: 344540.8802; val_kl_reg_loss: 4823.5435; val_edge_recon_loss: 268962.4688; val_gene_expr_recon_loss: 67783.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341569.3750; val_optim_loss: 341569.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9421; val_auprc_score: 0.9161; val_best_acc_score: 0.8940; val_best_f1_score: 0.8987; train_kl_reg_loss: 4784.9701; train_edge_recon_loss: 269072.6589; train_gene_expr_recon_loss: 65250.3353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339107.9583; train_optim_loss: 339107.9583; val_kl_reg_loss: 4689.9639; val_edge_recon_loss: 261461.8281; val_gene_expr_recon_loss: 67867.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334019.4062; val_optim_loss: 334019.4062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9413; val_auprc_score: 0.9054; val_best_acc_score: 0.8910; val_best_f1_score: 0.8962; train_kl_reg_loss: 4472.3293; train_edge_recon_loss: 269472.1458; train_gene_expr_recon_loss: 65531.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339475.9740; train_optim_loss: 339475.9740; val_kl_reg_loss: 4238.4678; val_edge_recon_loss: 268028.0312; val_gene_expr_recon_loss: 67706.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339972.5625; val_optim_loss: 339972.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9187; val_auprc_score: 0.8563; val_best_acc_score: 0.8806; val_best_f1_score: 0.8886; train_kl_reg_loss: 4117.4197; train_edge_recon_loss: 268768.2708; train_gene_expr_recon_loss: 64887.4577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337773.1510; train_optim_loss: 337773.1510; val_kl_reg_loss: 4003.7029; val_edge_recon_loss: 267498.5625; val_gene_expr_recon_loss: 67421.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338923.7188; val_optim_loss: 338923.7188
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9319; val_auprc_score: 0.8804; val_best_acc_score: 0.8851; val_best_f1_score: 0.8904; train_kl_reg_loss: 3938.0585; train_edge_recon_loss: 266473.5521; train_gene_expr_recon_loss: 65014.4440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335426.0521; train_optim_loss: 335426.0521; val_kl_reg_loss: 3921.9468; val_edge_recon_loss: 273350.0000; val_gene_expr_recon_loss: 67528.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344800.1875; val_optim_loss: 344800.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9456; val_auprc_score: 0.9155; val_best_acc_score: 0.8955; val_best_f1_score: 0.8986; train_kl_reg_loss: 3890.3471; train_edge_recon_loss: 268332.5312; train_gene_expr_recon_loss: 64159.9355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 336382.8229; train_optim_loss: 336382.8229; val_kl_reg_loss: 3899.4402; val_edge_recon_loss: 267714.2188; val_gene_expr_recon_loss: 67412.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339025.9688; val_optim_loss: 339025.9688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9354; val_auprc_score: 0.8980; val_best_acc_score: 0.8791; val_best_f1_score: 0.8854; train_kl_reg_loss: 3891.4369; train_edge_recon_loss: 269082.2708; train_gene_expr_recon_loss: 64542.5905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337516.2969; train_optim_loss: 337516.2969; val_kl_reg_loss: 3897.6250; val_edge_recon_loss: 273316.2500; val_gene_expr_recon_loss: 67231.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344445.3750; val_optim_loss: 344445.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9290; val_auprc_score: 0.8798; val_best_acc_score: 0.8791; val_best_f1_score: 0.8889; train_kl_reg_loss: 3888.7192; train_edge_recon_loss: 268631.1927; train_gene_expr_recon_loss: 64705.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337225.8906; train_optim_loss: 337225.8906; val_kl_reg_loss: 3870.0767; val_edge_recon_loss: 268481.0312; val_gene_expr_recon_loss: 67131.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339482.3750; val_optim_loss: 339482.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 8 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9368
Val AUPRC score: 0.9007
Val best accuracy score: 0.8791
Val best F1 score: 0.8873
Val gene expr MSE score: 0.0089
Duration of model training in run 8: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3780
Number of validation edges: 420
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8294; val_auprc_score: 0.8221; val_best_acc_score: 0.7393; val_best_f1_score: 0.7503; train_kl_reg_loss: 131.1510; train_edge_recon_loss: 345683.2938; train_gene_expr_recon_loss: 76654.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 422468.9750; train_optim_loss: 422468.9750; val_kl_reg_loss: 446.0024; val_edge_recon_loss: 369570.2969; val_gene_expr_recon_loss: 65800.5137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435816.8125; val_optim_loss: 435816.8125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8306; val_auprc_score: 0.8402; val_best_acc_score: 0.7155; val_best_f1_score: 0.7600; train_kl_reg_loss: 841.5116; train_edge_recon_loss: 327402.4813; train_gene_expr_recon_loss: 70952.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399196.1937; train_optim_loss: 399196.1937; val_kl_reg_loss: 2151.4500; val_edge_recon_loss: 301239.1406; val_gene_expr_recon_loss: 61563.7402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364954.3281; val_optim_loss: 364954.3281
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8445; val_auprc_score: 0.8297; val_best_acc_score: 0.7488; val_best_f1_score: 0.7825; train_kl_reg_loss: 5959.5906; train_edge_recon_loss: 295434.6021; train_gene_expr_recon_loss: 69578.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370972.4688; train_optim_loss: 370972.4688; val_kl_reg_loss: 7225.4607; val_edge_recon_loss: 296720.2500; val_gene_expr_recon_loss: 61520.5527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365466.2500; val_optim_loss: 365466.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9092; val_auprc_score: 0.8938; val_best_acc_score: 0.7869; val_best_f1_score: 0.8056; train_kl_reg_loss: 4813.5289; train_edge_recon_loss: 291858.6312; train_gene_expr_recon_loss: 68773.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365446.1562; train_optim_loss: 365446.1562; val_kl_reg_loss: 3232.5797; val_edge_recon_loss: 277671.4375; val_gene_expr_recon_loss: 63815.0820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344719.0938; val_optim_loss: 344719.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8980; val_auprc_score: 0.8710; val_best_acc_score: 0.8202; val_best_f1_score: 0.8165; train_kl_reg_loss: 3017.7628; train_edge_recon_loss: 291065.3583; train_gene_expr_recon_loss: 68526.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362609.6667; train_optim_loss: 362609.6667; val_kl_reg_loss: 2489.2083; val_edge_recon_loss: 288495.8594; val_gene_expr_recon_loss: 62112.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353097.8125; val_optim_loss: 353097.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8872; val_auprc_score: 0.8475; val_best_acc_score: 0.8131; val_best_f1_score: 0.8332; train_kl_reg_loss: 2795.5468; train_edge_recon_loss: 285491.1771; train_gene_expr_recon_loss: 68324.5591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356611.2833; train_optim_loss: 356611.2833; val_kl_reg_loss: 3138.0343; val_edge_recon_loss: 279322.2188; val_gene_expr_recon_loss: 63759.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346219.6406; val_optim_loss: 346219.6406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9212; val_auprc_score: 0.8864; val_best_acc_score: 0.8619; val_best_f1_score: 0.8755; train_kl_reg_loss: 4013.3903; train_edge_recon_loss: 275190.5812; train_gene_expr_recon_loss: 67829.5865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347033.5583; train_optim_loss: 347033.5583; val_kl_reg_loss: 4566.3267; val_edge_recon_loss: 269854.6250; val_gene_expr_recon_loss: 62939.9004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337360.8438; val_optim_loss: 337360.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9172; val_auprc_score: 0.8637; val_best_acc_score: 0.8667; val_best_f1_score: 0.8772; train_kl_reg_loss: 4439.8122; train_edge_recon_loss: 271333.7354; train_gene_expr_recon_loss: 68037.3586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 343810.9062; train_optim_loss: 343810.9062; val_kl_reg_loss: 4032.7349; val_edge_recon_loss: 273549.0156; val_gene_expr_recon_loss: 62494.5527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340076.2969; val_optim_loss: 340076.2969
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9504; val_auprc_score: 0.9097; val_best_acc_score: 0.9298; val_best_f1_score: 0.9329; train_kl_reg_loss: 3891.2594; train_edge_recon_loss: 269528.9792; train_gene_expr_recon_loss: 66754.5721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 340174.8104; train_optim_loss: 340174.8104; val_kl_reg_loss: 3906.8218; val_edge_recon_loss: 264214.9062; val_gene_expr_recon_loss: 64254.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332376.4531; val_optim_loss: 332376.4531
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9495; val_auprc_score: 0.9063; val_best_acc_score: 0.9310; val_best_f1_score: 0.9347; train_kl_reg_loss: 4292.1743; train_edge_recon_loss: 266285.0719; train_gene_expr_recon_loss: 66945.2349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337522.4813; train_optim_loss: 337522.4813; val_kl_reg_loss: 4240.2593; val_edge_recon_loss: 267954.5156; val_gene_expr_recon_loss: 64301.9121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336496.7031; val_optim_loss: 336496.7031
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9626; val_auprc_score: 0.9313; val_best_acc_score: 0.9464; val_best_f1_score: 0.9485; train_kl_reg_loss: 4110.6037; train_edge_recon_loss: 264156.1135; train_gene_expr_recon_loss: 67095.0276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335361.7479; train_optim_loss: 335361.7479; val_kl_reg_loss: 3863.6282; val_edge_recon_loss: 256318.2734; val_gene_expr_recon_loss: 60493.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320675.5312; val_optim_loss: 320675.5312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9620; val_auprc_score: 0.9386; val_best_acc_score: 0.9274; val_best_f1_score: 0.9296; train_kl_reg_loss: 4076.9030; train_edge_recon_loss: 264876.1667; train_gene_expr_recon_loss: 66303.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335256.5375; train_optim_loss: 335256.5375; val_kl_reg_loss: 4180.1270; val_edge_recon_loss: 263067.0156; val_gene_expr_recon_loss: 65112.4395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332359.5781; val_optim_loss: 332359.5781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9634; val_auprc_score: 0.9316; val_best_acc_score: 0.9429; val_best_f1_score: 0.9450; train_kl_reg_loss: 4222.1853; train_edge_recon_loss: 263451.3438; train_gene_expr_recon_loss: 66486.4057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334159.9396; train_optim_loss: 334159.9396; val_kl_reg_loss: 3938.6614; val_edge_recon_loss: 257223.2266; val_gene_expr_recon_loss: 64088.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325250.1250; val_optim_loss: 325250.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9532; val_auprc_score: 0.8962; val_best_acc_score: 0.9298; val_best_f1_score: 0.9329; train_kl_reg_loss: 3978.7853; train_edge_recon_loss: 263607.0406; train_gene_expr_recon_loss: 66044.5797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333630.4042; train_optim_loss: 333630.4042; val_kl_reg_loss: 4019.6038; val_edge_recon_loss: 260122.5547; val_gene_expr_recon_loss: 61128.4004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325270.5781; val_optim_loss: 325270.5781

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9564; val_auprc_score: 0.9147; val_best_acc_score: 0.9369; val_best_f1_score: 0.9386; train_kl_reg_loss: 4056.7492; train_edge_recon_loss: 262152.7635; train_gene_expr_recon_loss: 64881.8146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331091.3271; train_optim_loss: 331091.3271; val_kl_reg_loss: 4017.5338; val_edge_recon_loss: 263513.8125; val_gene_expr_recon_loss: 60891.1504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328422.4844; val_optim_loss: 328422.4844
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9673; val_auprc_score: 0.9361; val_best_acc_score: 0.9357; val_best_f1_score: 0.9378; train_kl_reg_loss: 4086.0512; train_edge_recon_loss: 261715.8417; train_gene_expr_recon_loss: 64651.8805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330453.7792; train_optim_loss: 330453.7792; val_kl_reg_loss: 4036.0552; val_edge_recon_loss: 259311.9453; val_gene_expr_recon_loss: 61743.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325091.7812; val_optim_loss: 325091.7812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9620; val_auprc_score: 0.9184; val_best_acc_score: 0.9310; val_best_f1_score: 0.9333; train_kl_reg_loss: 4108.3816; train_edge_recon_loss: 260545.9333; train_gene_expr_recon_loss: 65010.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329665.0312; train_optim_loss: 329665.0312; val_kl_reg_loss: 4057.8337; val_edge_recon_loss: 265640.2656; val_gene_expr_recon_loss: 60740.3145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330438.4062; val_optim_loss: 330438.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 11 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.9557
Val AUPRC score: 0.9090
Val best accuracy score: 0.9393
Val best F1 score: 0.9420
Val gene expr MSE score: 0.0093
Duration of model training in run 9: 0 hours, 0 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3780
Number of validation edges: 420
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8139; val_auprc_score: 0.7715; val_best_acc_score: 0.7298; val_best_f1_score: 0.7507; train_kl_reg_loss: 125.4720; train_edge_recon_loss: 345620.0396; train_gene_expr_recon_loss: 74866.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420612.2562; train_optim_loss: 420612.2562; val_kl_reg_loss: 437.4879; val_edge_recon_loss: 376379.4531; val_gene_expr_recon_loss: 73806.5039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450623.4531; val_optim_loss: 450623.4531
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7999; val_auprc_score: 0.7734; val_best_acc_score: 0.7095; val_best_f1_score: 0.7584; train_kl_reg_loss: 795.0105; train_edge_recon_loss: 329459.4667; train_gene_expr_recon_loss: 69581.7799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399836.2562; train_optim_loss: 399836.2562; val_kl_reg_loss: 1696.7280; val_edge_recon_loss: 308994.7344; val_gene_expr_recon_loss: 74029.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384721.2344; val_optim_loss: 384721.2344
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8498; val_auprc_score: 0.8063; val_best_acc_score: 0.7286; val_best_f1_score: 0.7800; train_kl_reg_loss: 4965.6601; train_edge_recon_loss: 293023.1729; train_gene_expr_recon_loss: 68434.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366423.2854; train_optim_loss: 366423.2854; val_kl_reg_loss: 6459.2900; val_edge_recon_loss: 297567.8906; val_gene_expr_recon_loss: 70954.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374982.0312; val_optim_loss: 374982.0312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8815; val_auprc_score: 0.8289; val_best_acc_score: 0.7845; val_best_f1_score: 0.8077; train_kl_reg_loss: 4952.0540; train_edge_recon_loss: 289318.1000; train_gene_expr_recon_loss: 67865.7372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362135.8958; train_optim_loss: 362135.8958; val_kl_reg_loss: 3023.1853; val_edge_recon_loss: 281348.9062; val_gene_expr_recon_loss: 68416.0059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352788.0938; val_optim_loss: 352788.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8842; val_auprc_score: 0.8524; val_best_acc_score: 0.8024; val_best_f1_score: 0.8074; train_kl_reg_loss: 2665.1545; train_edge_recon_loss: 288973.7313; train_gene_expr_recon_loss: 67715.4833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359354.3708; train_optim_loss: 359354.3708; val_kl_reg_loss: 2756.6429; val_edge_recon_loss: 292316.9062; val_gene_expr_recon_loss: 69830.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364904.3125; val_optim_loss: 364904.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8856; val_auprc_score: 0.8369; val_best_acc_score: 0.8274; val_best_f1_score: 0.8443; train_kl_reg_loss: 2985.9557; train_edge_recon_loss: 288667.5979; train_gene_expr_recon_loss: 66995.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358648.6896; train_optim_loss: 358648.6896; val_kl_reg_loss: 2918.3136; val_edge_recon_loss: 276679.1094; val_gene_expr_recon_loss: 70200.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349797.5781; val_optim_loss: 349797.5781
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8920; val_auprc_score: 0.8471; val_best_acc_score: 0.8286; val_best_f1_score: 0.8494; train_kl_reg_loss: 3724.8052; train_edge_recon_loss: 276949.9833; train_gene_expr_recon_loss: 66729.9698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347404.7583; train_optim_loss: 347404.7583; val_kl_reg_loss: 4550.5215; val_edge_recon_loss: 278982.3594; val_gene_expr_recon_loss: 71436.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354969.8594; val_optim_loss: 354969.8594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9360; val_auprc_score: 0.9015; val_best_acc_score: 0.8714; val_best_f1_score: 0.8775; train_kl_reg_loss: 4357.5943; train_edge_recon_loss: 271032.9417; train_gene_expr_recon_loss: 66732.2589; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342122.7896; train_optim_loss: 342122.7896; val_kl_reg_loss: 4011.5624; val_edge_recon_loss: 274519.7188; val_gene_expr_recon_loss: 68697.1270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347228.4062; val_optim_loss: 347228.4062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9565; val_auprc_score: 0.9249; val_best_acc_score: 0.9167; val_best_f1_score: 0.9210; train_kl_reg_loss: 3928.4607; train_edge_recon_loss: 269878.4604; train_gene_expr_recon_loss: 66523.4253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 340330.3417; train_optim_loss: 340330.3417; val_kl_reg_loss: 3941.7405; val_edge_recon_loss: 260989.4141; val_gene_expr_recon_loss: 70855.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335786.6562; val_optim_loss: 335786.6562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9578; val_auprc_score: 0.9307; val_best_acc_score: 0.9250; val_best_f1_score: 0.9285; train_kl_reg_loss: 4165.6048; train_edge_recon_loss: 265164.6094; train_gene_expr_recon_loss: 66074.3591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335404.5708; train_optim_loss: 335404.5708; val_kl_reg_loss: 4174.9255; val_edge_recon_loss: 260742.6953; val_gene_expr_recon_loss: 70391.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335309.5000; val_optim_loss: 335309.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9501; val_auprc_score: 0.9022; val_best_acc_score: 0.9298; val_best_f1_score: 0.9324; train_kl_reg_loss: 4173.0629; train_edge_recon_loss: 264374.4625; train_gene_expr_recon_loss: 65962.0594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334509.5854; train_optim_loss: 334509.5854; val_kl_reg_loss: 4111.4915; val_edge_recon_loss: 265861.7969; val_gene_expr_recon_loss: 68553.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338527.2344; val_optim_loss: 338527.2344
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9771; val_auprc_score: 0.9663; val_best_acc_score: 0.9500; val_best_f1_score: 0.9519; train_kl_reg_loss: 4064.8789; train_edge_recon_loss: 264472.4906; train_gene_expr_recon_loss: 65687.2771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334224.6458; train_optim_loss: 334224.6458; val_kl_reg_loss: 4070.0029; val_edge_recon_loss: 254649.3672; val_gene_expr_recon_loss: 69330.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328049.7031; val_optim_loss: 328049.7031
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9545; val_auprc_score: 0.9182; val_best_acc_score: 0.9226; val_best_f1_score: 0.9255; train_kl_reg_loss: 4156.4929; train_edge_recon_loss: 264791.8688; train_gene_expr_recon_loss: 65042.3818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333990.7458; train_optim_loss: 333990.7458; val_kl_reg_loss: 4238.4910; val_edge_recon_loss: 264501.6406; val_gene_expr_recon_loss: 71040.8457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339780.9688; val_optim_loss: 339780.9688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9688; val_auprc_score: 0.9424; val_best_acc_score: 0.9417; val_best_f1_score: 0.9437; train_kl_reg_loss: 4212.1965; train_edge_recon_loss: 261182.1958; train_gene_expr_recon_loss: 64704.0221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330098.4125; train_optim_loss: 330098.4125; val_kl_reg_loss: 4209.4299; val_edge_recon_loss: 259177.0000; val_gene_expr_recon_loss: 70536.3242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333922.7500; val_optim_loss: 333922.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9564; val_auprc_score: 0.9025; val_best_acc_score: 0.9417; val_best_f1_score: 0.9448; train_kl_reg_loss: 4166.2375; train_edge_recon_loss: 262744.7812; train_gene_expr_recon_loss: 64430.3268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331341.3479; train_optim_loss: 331341.3479; val_kl_reg_loss: 4101.7747; val_edge_recon_loss: 259680.2422; val_gene_expr_recon_loss: 67857.8945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331639.9062; val_optim_loss: 331639.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9540; val_auprc_score: 0.8961; val_best_acc_score: 0.9262; val_best_f1_score: 0.9311; train_kl_reg_loss: 4082.3711; train_edge_recon_loss: 261117.9458; train_gene_expr_recon_loss: 64004.9094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329205.2250; train_optim_loss: 329205.2250; val_kl_reg_loss: 4066.3838; val_edge_recon_loss: 264491.2344; val_gene_expr_recon_loss: 68871.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337429.0156; val_optim_loss: 337429.0156
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9631; val_auprc_score: 0.9348; val_best_acc_score: 0.9369; val_best_f1_score: 0.9405; train_kl_reg_loss: 4094.0760; train_edge_recon_loss: 261517.9802; train_gene_expr_recon_loss: 63221.7547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328833.8083; train_optim_loss: 328833.8083; val_kl_reg_loss: 4110.3806; val_edge_recon_loss: 260696.5469; val_gene_expr_recon_loss: 66380.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331187.0469; val_optim_loss: 331187.0469
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9609; val_auprc_score: 0.9291; val_best_acc_score: 0.9357; val_best_f1_score: 0.9391; train_kl_reg_loss: 4111.7630; train_edge_recon_loss: 261974.2427; train_gene_expr_recon_loss: 63351.1258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329437.1312; train_optim_loss: 329437.1312; val_kl_reg_loss: 4117.2034; val_edge_recon_loss: 262106.3672; val_gene_expr_recon_loss: 66773.7949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332997.3594; val_optim_loss: 332997.3594

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 12 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.9464
Val AUPRC score: 0.8856
Val best accuracy score: 0.9250
Val best F1 score: 0.9289
Val gene expr MSE score: 0.0100
Duration of model training in run 10: 0 hours, 0 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
