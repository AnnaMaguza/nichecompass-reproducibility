Run timestamp: 16082023_150303_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'Cell_Type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'vizgen_merfish_mouse_liver', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 347, n_cat_covariates_embed_input: 0, n_hidden: 347, n_latent: 1378, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347

--- INITIALIZING TRAINER ---
Number of training nodes: 330601
Number of validation nodes: 36734
Number of training edges: 2874829
Number of validation edges: 319425
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9158; val_auprc_score: 0.8956; val_best_acc_score: 0.8429; val_best_f1_score: 0.8544; train_kl_reg_loss: 44081.1299; train_edge_recon_loss: 3016557.7821; train_gene_expr_recon_loss: 2707494.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5768133.6467; train_optim_loss: 5768133.6467; val_kl_reg_loss: 42476.5770; val_edge_recon_loss: 2783797.3333; val_gene_expr_recon_loss: 2491758.8365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5318032.7628; val_optim_loss: 5318032.7628
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9422; val_auprc_score: 0.9310; val_best_acc_score: 0.8715; val_best_f1_score: 0.8776; train_kl_reg_loss: 37428.8720; train_edge_recon_loss: 2738514.2667; train_gene_expr_recon_loss: 2418576.3957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5194519.5285; train_optim_loss: 5194519.5285; val_kl_reg_loss: 32672.8485; val_edge_recon_loss: 2743062.1218; val_gene_expr_recon_loss: 2359242.9968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5134977.9936; val_optim_loss: 5134977.9936
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9587; val_auprc_score: 0.9511; val_best_acc_score: 0.8963; val_best_f1_score: 0.9002; train_kl_reg_loss: 30766.9827; train_edge_recon_loss: 2702204.9469; train_gene_expr_recon_loss: 2311110.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5044082.1147; train_optim_loss: 5044082.1147; val_kl_reg_loss: 29068.0785; val_edge_recon_loss: 2712031.2436; val_gene_expr_recon_loss: 2271555.8237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5012655.1474; val_optim_loss: 5012655.1474
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9622; val_auprc_score: 0.9553; val_best_acc_score: 0.9015; val_best_f1_score: 0.9052; train_kl_reg_loss: 28116.5067; train_edge_recon_loss: 2681548.4298; train_gene_expr_recon_loss: 2239776.9459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4949441.8796; train_optim_loss: 4949441.8796; val_kl_reg_loss: 26631.5709; val_edge_recon_loss: 2695764.4295; val_gene_expr_recon_loss: 2213056.2981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4935452.2628; val_optim_loss: 4935452.2628
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9658; val_auprc_score: 0.9598; val_best_acc_score: 0.9064; val_best_f1_score: 0.9096; train_kl_reg_loss: 25931.9320; train_edge_recon_loss: 2671060.0392; train_gene_expr_recon_loss: 2191652.6709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4888644.6389; train_optim_loss: 4888644.6389; val_kl_reg_loss: 24666.7403; val_edge_recon_loss: 2687495.3077; val_gene_expr_recon_loss: 2172886.6218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4885048.6603; val_optim_loss: 4885048.6603
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9708; val_auprc_score: 0.9657; val_best_acc_score: 0.9143; val_best_f1_score: 0.9169; train_kl_reg_loss: 23957.1086; train_edge_recon_loss: 2664789.5324; train_gene_expr_recon_loss: 2157353.4218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4846100.0591; train_optim_loss: 4846100.0591; val_kl_reg_loss: 22578.7942; val_edge_recon_loss: 2681004.0801; val_gene_expr_recon_loss: 2145517.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4849100.8141; val_optim_loss: 4849100.8141
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9756; val_auprc_score: 0.9717; val_best_acc_score: 0.9231; val_best_f1_score: 0.9249; train_kl_reg_loss: 22215.9430; train_edge_recon_loss: 2658389.0153; train_gene_expr_recon_loss: 2133341.6966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4813946.6567; train_optim_loss: 4813946.6567; val_kl_reg_loss: 21157.7387; val_edge_recon_loss: 2672140.6763; val_gene_expr_recon_loss: 2125111.4920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4818409.8974; val_optim_loss: 4818409.8974
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9773; val_auprc_score: 0.9736; val_best_acc_score: 0.9262; val_best_f1_score: 0.9280; train_kl_reg_loss: 21195.7674; train_edge_recon_loss: 2651567.3953; train_gene_expr_recon_loss: 2116129.2696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4788892.4352; train_optim_loss: 4788892.4352; val_kl_reg_loss: 20644.2854; val_edge_recon_loss: 2668345.5288; val_gene_expr_recon_loss: 2111602.7788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4800592.6282; val_optim_loss: 4800592.6282
