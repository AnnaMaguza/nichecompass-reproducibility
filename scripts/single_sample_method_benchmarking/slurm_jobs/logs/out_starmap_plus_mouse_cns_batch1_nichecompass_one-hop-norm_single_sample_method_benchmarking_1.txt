Run timestamp: 15062023_121138.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_batch1', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9357; val_auprc_score: 0.9126; val_best_acc_score: 0.8762; val_best_f1_score: 0.8804; train_kl_reg_loss: 4561.6000; train_edge_recon_loss: 293088.9453; train_gene_expr_recon_loss: 119741.0444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417391.5911; train_optim_loss: 417391.5911; val_kl_reg_loss: 4874.6259; val_edge_recon_loss: 268685.4948; val_gene_expr_recon_loss: 114627.3919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388187.5104; val_optim_loss: 388187.5104
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9626; val_auprc_score: 0.9437; val_best_acc_score: 0.9179; val_best_f1_score: 0.9207; train_kl_reg_loss: 4380.7136; train_edge_recon_loss: 263784.7682; train_gene_expr_recon_loss: 112794.6945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380960.1751; train_optim_loss: 380960.1751; val_kl_reg_loss: 4067.1261; val_edge_recon_loss: 264490.8073; val_gene_expr_recon_loss: 111919.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380477.1354; val_optim_loss: 380477.1354
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9694; val_auprc_score: 0.9521; val_best_acc_score: 0.9314; val_best_f1_score: 0.9331; train_kl_reg_loss: 4063.4483; train_edge_recon_loss: 261536.9593; train_gene_expr_recon_loss: 110425.0062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376025.4160; train_optim_loss: 376025.4160; val_kl_reg_loss: 3920.1109; val_edge_recon_loss: 262607.6641; val_gene_expr_recon_loss: 110270.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376798.1250; val_optim_loss: 376798.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9701; val_auprc_score: 0.9532; val_best_acc_score: 0.9322; val_best_f1_score: 0.9341; train_kl_reg_loss: 3914.6655; train_edge_recon_loss: 260571.8216; train_gene_expr_recon_loss: 109242.6414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373729.1296; train_optim_loss: 373729.1296; val_kl_reg_loss: 3759.1630; val_edge_recon_loss: 262684.9557; val_gene_expr_recon_loss: 108655.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375099.8802; val_optim_loss: 375099.8802
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9717; val_auprc_score: 0.9551; val_best_acc_score: 0.9355; val_best_f1_score: 0.9378; train_kl_reg_loss: 3810.7718; train_edge_recon_loss: 260054.8255; train_gene_expr_recon_loss: 107973.8285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371839.4264; train_optim_loss: 371839.4264; val_kl_reg_loss: 3621.2821; val_edge_recon_loss: 261800.0182; val_gene_expr_recon_loss: 108031.0716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373452.3750; val_optim_loss: 373452.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9720; val_auprc_score: 0.9547; val_best_acc_score: 0.9370; val_best_f1_score: 0.9388; train_kl_reg_loss: 3732.3810; train_edge_recon_loss: 259495.4137; train_gene_expr_recon_loss: 107223.3410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370451.1341; train_optim_loss: 370451.1341; val_kl_reg_loss: 3636.2735; val_edge_recon_loss: 262213.9740; val_gene_expr_recon_loss: 107390.9258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373241.1719; val_optim_loss: 373241.1719
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9758; val_auprc_score: 0.9629; val_best_acc_score: 0.9417; val_best_f1_score: 0.9433; train_kl_reg_loss: 3684.7315; train_edge_recon_loss: 259119.3665; train_gene_expr_recon_loss: 106508.9946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369313.0911; train_optim_loss: 369313.0911; val_kl_reg_loss: 3583.1554; val_edge_recon_loss: 261025.0807; val_gene_expr_recon_loss: 106721.9036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371330.1302; val_optim_loss: 371330.1302
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9757; val_auprc_score: 0.9621; val_best_acc_score: 0.9438; val_best_f1_score: 0.9452; train_kl_reg_loss: 3658.1390; train_edge_recon_loss: 258878.7975; train_gene_expr_recon_loss: 105791.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368328.8184; train_optim_loss: 368328.8184; val_kl_reg_loss: 3571.8405; val_edge_recon_loss: 261226.4714; val_gene_expr_recon_loss: 105955.1289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370753.4375; val_optim_loss: 370753.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9767; val_auprc_score: 0.9639; val_best_acc_score: 0.9446; val_best_f1_score: 0.9461; train_kl_reg_loss: 3639.5942; train_edge_recon_loss: 258514.2376; train_gene_expr_recon_loss: 105297.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367451.2832; train_optim_loss: 367451.2832; val_kl_reg_loss: 3535.2910; val_edge_recon_loss: 261140.1016; val_gene_expr_recon_loss: 105815.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370490.8958; val_optim_loss: 370490.8958
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9785; val_auprc_score: 0.9668; val_best_acc_score: 0.9484; val_best_f1_score: 0.9498; train_kl_reg_loss: 3610.0178; train_edge_recon_loss: 258445.1292; train_gene_expr_recon_loss: 104915.4087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366970.5566; train_optim_loss: 366970.5566; val_kl_reg_loss: 3539.8622; val_edge_recon_loss: 260534.3620; val_gene_expr_recon_loss: 105059.8724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369134.1042; val_optim_loss: 369134.1042
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9774; val_auprc_score: 0.9656; val_best_acc_score: 0.9460; val_best_f1_score: 0.9477; train_kl_reg_loss: 3599.6557; train_edge_recon_loss: 258114.6471; train_gene_expr_recon_loss: 104425.1178; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366139.4225; train_optim_loss: 366139.4225; val_kl_reg_loss: 3532.1373; val_edge_recon_loss: 261151.1979; val_gene_expr_recon_loss: 104704.1589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369387.5052; val_optim_loss: 369387.5052
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9788; val_auprc_score: 0.9670; val_best_acc_score: 0.9499; val_best_f1_score: 0.9511; train_kl_reg_loss: 3580.3472; train_edge_recon_loss: 258075.6901; train_gene_expr_recon_loss: 103929.8221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365585.8587; train_optim_loss: 365585.8587; val_kl_reg_loss: 3464.8027; val_edge_recon_loss: 260309.4323; val_gene_expr_recon_loss: 104459.1523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368233.3854; val_optim_loss: 368233.3854
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9778; val_auprc_score: 0.9655; val_best_acc_score: 0.9499; val_best_f1_score: 0.9511; train_kl_reg_loss: 3570.8253; train_edge_recon_loss: 258013.6602; train_gene_expr_recon_loss: 103595.8353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365180.3216; train_optim_loss: 365180.3216; val_kl_reg_loss: 3486.4615; val_edge_recon_loss: 260809.2344; val_gene_expr_recon_loss: 103950.2799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368245.9844; val_optim_loss: 368245.9844
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9792; val_auprc_score: 0.9677; val_best_acc_score: 0.9513; val_best_f1_score: 0.9527; train_kl_reg_loss: 3564.7243; train_edge_recon_loss: 258128.0059; train_gene_expr_recon_loss: 103244.3765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364937.1035; train_optim_loss: 364937.1035; val_kl_reg_loss: 3437.7278; val_edge_recon_loss: 260672.9271; val_gene_expr_recon_loss: 103709.0534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367819.7135; val_optim_loss: 367819.7135
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9787; val_auprc_score: 0.9665; val_best_acc_score: 0.9517; val_best_f1_score: 0.9531; train_kl_reg_loss: 3556.4356; train_edge_recon_loss: 257920.3102; train_gene_expr_recon_loss: 103034.4173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364511.1608; train_optim_loss: 364511.1608; val_kl_reg_loss: 3480.8808; val_edge_recon_loss: 260286.7422; val_gene_expr_recon_loss: 103392.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367159.9271; val_optim_loss: 367159.9271
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9797; val_auprc_score: 0.9691; val_best_acc_score: 0.9514; val_best_f1_score: 0.9530; train_kl_reg_loss: 3558.8415; train_edge_recon_loss: 257767.9544; train_gene_expr_recon_loss: 102677.5413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364004.3353; train_optim_loss: 364004.3353; val_kl_reg_loss: 3496.8376; val_edge_recon_loss: 260570.5000; val_gene_expr_recon_loss: 103374.3177; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367441.6562; val_optim_loss: 367441.6562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9795; val_auprc_score: 0.9668; val_best_acc_score: 0.9519; val_best_f1_score: 0.9531; train_kl_reg_loss: 3551.8635; train_edge_recon_loss: 257701.8454; train_gene_expr_recon_loss: 102549.5771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363803.2865; train_optim_loss: 363803.2865; val_kl_reg_loss: 3464.7201; val_edge_recon_loss: 260724.2552; val_gene_expr_recon_loss: 102880.3411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367069.3177; val_optim_loss: 367069.3177
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9809; val_auprc_score: 0.9697; val_best_acc_score: 0.9538; val_best_f1_score: 0.9550; train_kl_reg_loss: 3548.9766; train_edge_recon_loss: 257452.8044; train_gene_expr_recon_loss: 102293.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363295.7337; train_optim_loss: 363295.7337; val_kl_reg_loss: 3461.4489; val_edge_recon_loss: 260140.7396; val_gene_expr_recon_loss: 102601.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366203.4375; val_optim_loss: 366203.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9802; val_auprc_score: 0.9699; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 3542.0355; train_edge_recon_loss: 257773.0938; train_gene_expr_recon_loss: 101978.5238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363293.6497; train_optim_loss: 363293.6497; val_kl_reg_loss: 3449.0467; val_edge_recon_loss: 260341.7917; val_gene_expr_recon_loss: 102229.3060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366020.1354; val_optim_loss: 366020.1354
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9816; val_auprc_score: 0.9725; val_best_acc_score: 0.9539; val_best_f1_score: 0.9552; train_kl_reg_loss: 3542.1974; train_edge_recon_loss: 257534.2139; train_gene_expr_recon_loss: 101568.7049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362645.1172; train_optim_loss: 362645.1172; val_kl_reg_loss: 3476.7246; val_edge_recon_loss: 260606.0417; val_gene_expr_recon_loss: 102074.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366157.0104; val_optim_loss: 366157.0104
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9812; val_auprc_score: 0.9708; val_best_acc_score: 0.9561; val_best_f1_score: 0.9573; train_kl_reg_loss: 3538.2699; train_edge_recon_loss: 257258.4102; train_gene_expr_recon_loss: 101288.3628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362085.0475; train_optim_loss: 362085.0475; val_kl_reg_loss: 3457.5185; val_edge_recon_loss: 259847.6849; val_gene_expr_recon_loss: 101909.9036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365215.1146; val_optim_loss: 365215.1146
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9821; val_auprc_score: 0.9731; val_best_acc_score: 0.9556; val_best_f1_score: 0.9567; train_kl_reg_loss: 3536.7964; train_edge_recon_loss: 257546.7285; train_gene_expr_recon_loss: 101020.5161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362104.0423; train_optim_loss: 362104.0423; val_kl_reg_loss: 3473.5659; val_edge_recon_loss: 259794.5911; val_gene_expr_recon_loss: 101686.7448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364954.9010; val_optim_loss: 364954.9010
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9827; val_auprc_score: 0.9739; val_best_acc_score: 0.9568; val_best_f1_score: 0.9580; train_kl_reg_loss: 3532.5359; train_edge_recon_loss: 257478.7041; train_gene_expr_recon_loss: 100958.8060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361970.0456; train_optim_loss: 361970.0456; val_kl_reg_loss: 3438.8027; val_edge_recon_loss: 259895.7604; val_gene_expr_recon_loss: 101525.4466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364860.0104; val_optim_loss: 364860.0104
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9819; val_auprc_score: 0.9720; val_best_acc_score: 0.9562; val_best_f1_score: 0.9574; train_kl_reg_loss: 3535.7291; train_edge_recon_loss: 257347.3392; train_gene_expr_recon_loss: 100787.2939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361670.3613; train_optim_loss: 361670.3613; val_kl_reg_loss: 3482.5059; val_edge_recon_loss: 259779.8411; val_gene_expr_recon_loss: 101196.5638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364458.9062; val_optim_loss: 364458.9062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9829; val_auprc_score: 0.9737; val_best_acc_score: 0.9576; val_best_f1_score: 0.9588; train_kl_reg_loss: 3534.4988; train_edge_recon_loss: 257371.2259; train_gene_expr_recon_loss: 100558.5993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361464.3236; train_optim_loss: 361464.3236; val_kl_reg_loss: 3450.4826; val_edge_recon_loss: 259622.1693; val_gene_expr_recon_loss: 101101.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364173.6823; val_optim_loss: 364173.6823
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9834; val_auprc_score: 0.9752; val_best_acc_score: 0.9585; val_best_f1_score: 0.9597; train_kl_reg_loss: 3148.7209; train_edge_recon_loss: 257169.2188; train_gene_expr_recon_loss: 100323.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360641.6882; train_optim_loss: 360641.6882; val_kl_reg_loss: 2774.4818; val_edge_recon_loss: 259549.3802; val_gene_expr_recon_loss: 100948.5807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363272.4427; val_optim_loss: 363272.4427
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9832; val_auprc_score: 0.9747; val_best_acc_score: 0.9579; val_best_f1_score: 0.9588; train_kl_reg_loss: 2973.3700; train_edge_recon_loss: 256992.6829; train_gene_expr_recon_loss: 100232.4237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360198.4779; train_optim_loss: 360198.4779; val_kl_reg_loss: 2750.3439; val_edge_recon_loss: 259329.5443; val_gene_expr_recon_loss: 100613.2747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362693.1719; val_optim_loss: 362693.1719
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9814; val_auprc_score: 0.9713; val_best_acc_score: 0.9569; val_best_f1_score: 0.9580; train_kl_reg_loss: 2926.0400; train_edge_recon_loss: 256945.9860; train_gene_expr_recon_loss: 100026.6126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359898.6361; train_optim_loss: 359898.6361; val_kl_reg_loss: 2752.2944; val_edge_recon_loss: 260462.9245; val_gene_expr_recon_loss: 100197.0378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363412.2604; val_optim_loss: 363412.2604
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9837; val_auprc_score: 0.9760; val_best_acc_score: 0.9579; val_best_f1_score: 0.9590; train_kl_reg_loss: 2891.7057; train_edge_recon_loss: 257111.7236; train_gene_expr_recon_loss: 99897.0736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359900.5020; train_optim_loss: 359900.5020; val_kl_reg_loss: 2734.7317; val_edge_recon_loss: 260002.1094; val_gene_expr_recon_loss: 100320.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363057.4479; val_optim_loss: 363057.4479
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9830; val_auprc_score: 0.9743; val_best_acc_score: 0.9573; val_best_f1_score: 0.9584; train_kl_reg_loss: 2870.8829; train_edge_recon_loss: 257031.1530; train_gene_expr_recon_loss: 99745.4432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359647.4785; train_optim_loss: 359647.4785; val_kl_reg_loss: 2714.4768; val_edge_recon_loss: 260142.9219; val_gene_expr_recon_loss: 100184.8151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363042.2135; val_optim_loss: 363042.2135

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9821; val_auprc_score: 0.9720; val_best_acc_score: 0.9585; val_best_f1_score: 0.9595; train_kl_reg_loss: 2856.7463; train_edge_recon_loss: 256976.0046; train_gene_expr_recon_loss: 99373.4118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359206.1654; train_optim_loss: 359206.1654; val_kl_reg_loss: 2711.6810; val_edge_recon_loss: 259712.1771; val_gene_expr_recon_loss: 100107.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362531.6979; val_optim_loss: 362531.6979
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9833; val_auprc_score: 0.9752; val_best_acc_score: 0.9587; val_best_f1_score: 0.9598; train_kl_reg_loss: 2851.9326; train_edge_recon_loss: 256924.8835; train_gene_expr_recon_loss: 99235.7669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359012.5827; train_optim_loss: 359012.5827; val_kl_reg_loss: 2709.3919; val_edge_recon_loss: 260207.8281; val_gene_expr_recon_loss: 100094.5586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363011.7865; val_optim_loss: 363011.7865
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9832; val_auprc_score: 0.9752; val_best_acc_score: 0.9581; val_best_f1_score: 0.9592; train_kl_reg_loss: 2852.5821; train_edge_recon_loss: 256693.6087; train_gene_expr_recon_loss: 99316.3454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358862.5352; train_optim_loss: 358862.5352; val_kl_reg_loss: 2708.0181; val_edge_recon_loss: 260239.0208; val_gene_expr_recon_loss: 100055.8229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363002.8646; val_optim_loss: 363002.8646
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9837; val_auprc_score: 0.9754; val_best_acc_score: 0.9592; val_best_f1_score: 0.9603; train_kl_reg_loss: 2850.8947; train_edge_recon_loss: 256886.1465; train_gene_expr_recon_loss: 99304.2521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359041.2943; train_optim_loss: 359041.2943; val_kl_reg_loss: 2712.5204; val_edge_recon_loss: 259640.4062; val_gene_expr_recon_loss: 100077.0560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362429.9792; val_optim_loss: 362429.9792
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9835; val_auprc_score: 0.9756; val_best_acc_score: 0.9597; val_best_f1_score: 0.9607; train_kl_reg_loss: 2844.5495; train_edge_recon_loss: 256904.4730; train_gene_expr_recon_loss: 99218.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358967.3848; train_optim_loss: 358967.3848; val_kl_reg_loss: 2702.4300; val_edge_recon_loss: 260005.6953; val_gene_expr_recon_loss: 99843.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362551.7240; val_optim_loss: 362551.7240
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9830; val_auprc_score: 0.9742; val_best_acc_score: 0.9583; val_best_f1_score: 0.9594; train_kl_reg_loss: 2838.1890; train_edge_recon_loss: 256841.2829; train_gene_expr_recon_loss: 99214.6989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358894.1680; train_optim_loss: 358894.1680; val_kl_reg_loss: 2693.1614; val_edge_recon_loss: 259779.5885; val_gene_expr_recon_loss: 99858.8568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362331.6042; val_optim_loss: 362331.6042
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9841; val_auprc_score: 0.9759; val_best_acc_score: 0.9601; val_best_f1_score: 0.9610; train_kl_reg_loss: 2837.4553; train_edge_recon_loss: 256881.7152; train_gene_expr_recon_loss: 99328.4604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359047.6296; train_optim_loss: 359047.6296; val_kl_reg_loss: 2694.1617; val_edge_recon_loss: 259277.2031; val_gene_expr_recon_loss: 99826.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361797.9531; val_optim_loss: 361797.9531
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9838; val_auprc_score: 0.9752; val_best_acc_score: 0.9603; val_best_f1_score: 0.9613; train_kl_reg_loss: 2832.0542; train_edge_recon_loss: 256823.9938; train_gene_expr_recon_loss: 99142.7212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358798.7695; train_optim_loss: 358798.7695; val_kl_reg_loss: 2693.3198; val_edge_recon_loss: 259823.6693; val_gene_expr_recon_loss: 99630.7018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362147.6875; val_optim_loss: 362147.6875
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9826; val_auprc_score: 0.9736; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 2831.3384; train_edge_recon_loss: 256736.5153; train_gene_expr_recon_loss: 99122.5220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358690.3757; train_optim_loss: 358690.3757; val_kl_reg_loss: 2690.2095; val_edge_recon_loss: 260046.7448; val_gene_expr_recon_loss: 99743.3229; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362480.2812; val_optim_loss: 362480.2812
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9846; val_auprc_score: 0.9768; val_best_acc_score: 0.9603; val_best_f1_score: 0.9612; train_kl_reg_loss: 2829.6839; train_edge_recon_loss: 256619.6781; train_gene_expr_recon_loss: 99185.3154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358634.6771; train_optim_loss: 358634.6771; val_kl_reg_loss: 2682.0845; val_edge_recon_loss: 259557.6302; val_gene_expr_recon_loss: 99642.0964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361881.8125; val_optim_loss: 361881.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9845; val_auprc_score: 0.9770; val_best_acc_score: 0.9591; val_best_f1_score: 0.9601; train_kl_reg_loss: 2823.4607; train_edge_recon_loss: 256869.2881; train_gene_expr_recon_loss: 99147.5697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358840.3164; train_optim_loss: 358840.3164; val_kl_reg_loss: 2684.6993; val_edge_recon_loss: 259872.3516; val_gene_expr_recon_loss: 99679.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362236.2188; val_optim_loss: 362236.2188
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9831; val_auprc_score: 0.9746; val_best_acc_score: 0.9596; val_best_f1_score: 0.9605; train_kl_reg_loss: 2823.8271; train_edge_recon_loss: 256630.4772; train_gene_expr_recon_loss: 99190.0488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358644.3503; train_optim_loss: 358644.3503; val_kl_reg_loss: 2685.2946; val_edge_recon_loss: 260084.1094; val_gene_expr_recon_loss: 99906.4336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362675.8333; val_optim_loss: 362675.8333
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9845; val_auprc_score: 0.9769; val_best_acc_score: 0.9606; val_best_f1_score: 0.9615; train_kl_reg_loss: 2824.1163; train_edge_recon_loss: 256764.5589; train_gene_expr_recon_loss: 99265.3457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358854.0228; train_optim_loss: 358854.0228; val_kl_reg_loss: 2684.9610; val_edge_recon_loss: 259263.8255; val_gene_expr_recon_loss: 99864.3620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361813.1458; val_optim_loss: 361813.1458

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 52 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9840
Val AUPRC score: 0.9759
Val best accuracy score: 0.9593
Val best F1 score: 0.9603
Val gene expr MSE score: 0.5564
Duration of model training in run 1: 0 hours, 12 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9350; val_auprc_score: 0.9116; val_best_acc_score: 0.8755; val_best_f1_score: 0.8809; train_kl_reg_loss: 4576.2612; train_edge_recon_loss: 294075.3861; train_gene_expr_recon_loss: 119137.2280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417788.8757; train_optim_loss: 417788.8757; val_kl_reg_loss: 4796.0750; val_edge_recon_loss: 269396.3594; val_gene_expr_recon_loss: 113274.4362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387466.8698; val_optim_loss: 387466.8698
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9614; val_auprc_score: 0.9424; val_best_acc_score: 0.9158; val_best_f1_score: 0.9185; train_kl_reg_loss: 4412.7592; train_edge_recon_loss: 263707.7425; train_gene_expr_recon_loss: 112083.6611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380204.1654; train_optim_loss: 380204.1654; val_kl_reg_loss: 4086.4252; val_edge_recon_loss: 264436.6536; val_gene_expr_recon_loss: 110426.3099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378949.4010; val_optim_loss: 378949.4010
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9697; val_auprc_score: 0.9518; val_best_acc_score: 0.9295; val_best_f1_score: 0.9317; train_kl_reg_loss: 4072.9406; train_edge_recon_loss: 261548.4938; train_gene_expr_recon_loss: 109751.9367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375373.3685; train_optim_loss: 375373.3685; val_kl_reg_loss: 3873.3526; val_edge_recon_loss: 262681.4036; val_gene_expr_recon_loss: 108816.7161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375371.4792; val_optim_loss: 375371.4792
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9704; val_auprc_score: 0.9539; val_best_acc_score: 0.9313; val_best_f1_score: 0.9335; train_kl_reg_loss: 3928.3509; train_edge_recon_loss: 260596.1175; train_gene_expr_recon_loss: 108562.8014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373087.2734; train_optim_loss: 373087.2734; val_kl_reg_loss: 3768.0380; val_edge_recon_loss: 262736.4349; val_gene_expr_recon_loss: 107623.9076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374128.3906; val_optim_loss: 374128.3906
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9722; val_auprc_score: 0.9567; val_best_acc_score: 0.9337; val_best_f1_score: 0.9356; train_kl_reg_loss: 3831.9440; train_edge_recon_loss: 260063.1374; train_gene_expr_recon_loss: 107308.6392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371203.7194; train_optim_loss: 371203.7194; val_kl_reg_loss: 3637.3042; val_edge_recon_loss: 262461.7630; val_gene_expr_recon_loss: 106677.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372776.9740; val_optim_loss: 372776.9740
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9730; val_auprc_score: 0.9584; val_best_acc_score: 0.9366; val_best_f1_score: 0.9385; train_kl_reg_loss: 3748.3546; train_edge_recon_loss: 259753.5016; train_gene_expr_recon_loss: 106382.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369883.9798; train_optim_loss: 369883.9798; val_kl_reg_loss: 3640.5404; val_edge_recon_loss: 261878.0156; val_gene_expr_recon_loss: 105377.2799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370895.8438; val_optim_loss: 370895.8438
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9748; val_auprc_score: 0.9608; val_best_acc_score: 0.9396; val_best_f1_score: 0.9415; train_kl_reg_loss: 3702.8742; train_edge_recon_loss: 259126.2549; train_gene_expr_recon_loss: 105646.5379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368475.6680; train_optim_loss: 368475.6680; val_kl_reg_loss: 3609.5631; val_edge_recon_loss: 261592.9531; val_gene_expr_recon_loss: 104979.4883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370182.0052; val_optim_loss: 370182.0052
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9750; val_auprc_score: 0.9608; val_best_acc_score: 0.9412; val_best_f1_score: 0.9432; train_kl_reg_loss: 3652.6471; train_edge_recon_loss: 258952.3014; train_gene_expr_recon_loss: 105048.9119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367653.8607; train_optim_loss: 367653.8607; val_kl_reg_loss: 3536.9683; val_edge_recon_loss: 261789.8724; val_gene_expr_recon_loss: 104280.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369607.2188; val_optim_loss: 369607.2188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9762; val_auprc_score: 0.9634; val_best_acc_score: 0.9440; val_best_f1_score: 0.9457; train_kl_reg_loss: 3631.4460; train_edge_recon_loss: 258457.0931; train_gene_expr_recon_loss: 104670.7298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366759.2702; train_optim_loss: 366759.2702; val_kl_reg_loss: 3520.4504; val_edge_recon_loss: 261556.9844; val_gene_expr_recon_loss: 104487.2773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369564.7188; val_optim_loss: 369564.7188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9766; val_auprc_score: 0.9633; val_best_acc_score: 0.9464; val_best_f1_score: 0.9479; train_kl_reg_loss: 3612.3370; train_edge_recon_loss: 258425.5570; train_gene_expr_recon_loss: 104145.5732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366183.4681; train_optim_loss: 366183.4681; val_kl_reg_loss: 3543.6755; val_edge_recon_loss: 261099.6562; val_gene_expr_recon_loss: 103846.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368490.0104; val_optim_loss: 368490.0104
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9785; val_auprc_score: 0.9663; val_best_acc_score: 0.9490; val_best_f1_score: 0.9504; train_kl_reg_loss: 3591.3897; train_edge_recon_loss: 258571.8942; train_gene_expr_recon_loss: 103621.0711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365784.3555; train_optim_loss: 365784.3555; val_kl_reg_loss: 3481.8054; val_edge_recon_loss: 260674.3776; val_gene_expr_recon_loss: 102995.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367151.2240; val_optim_loss: 367151.2240
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9788; val_auprc_score: 0.9669; val_best_acc_score: 0.9510; val_best_f1_score: 0.9524; train_kl_reg_loss: 3586.4488; train_edge_recon_loss: 258202.1348; train_gene_expr_recon_loss: 103484.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365272.7272; train_optim_loss: 365272.7272; val_kl_reg_loss: 3466.6949; val_edge_recon_loss: 260020.2370; val_gene_expr_recon_loss: 103096.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366582.9531; val_optim_loss: 366582.9531
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9794; val_auprc_score: 0.9680; val_best_acc_score: 0.9507; val_best_f1_score: 0.9519; train_kl_reg_loss: 3567.7891; train_edge_recon_loss: 258133.0742; train_gene_expr_recon_loss: 103090.9468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364791.8073; train_optim_loss: 364791.8073; val_kl_reg_loss: 3514.2655; val_edge_recon_loss: 260515.5078; val_gene_expr_recon_loss: 102795.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366825.3333; val_optim_loss: 366825.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9792; val_auprc_score: 0.9671; val_best_acc_score: 0.9504; val_best_f1_score: 0.9517; train_kl_reg_loss: 3562.4699; train_edge_recon_loss: 258046.3617; train_gene_expr_recon_loss: 102696.0090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364304.8411; train_optim_loss: 364304.8411; val_kl_reg_loss: 3499.9780; val_edge_recon_loss: 260856.3255; val_gene_expr_recon_loss: 102357.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366714.0729; val_optim_loss: 366714.0729
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9797; val_auprc_score: 0.9677; val_best_acc_score: 0.9509; val_best_f1_score: 0.9522; train_kl_reg_loss: 3559.2989; train_edge_recon_loss: 257788.0755; train_gene_expr_recon_loss: 102458.8874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363806.2624; train_optim_loss: 363806.2624; val_kl_reg_loss: 3499.9950; val_edge_recon_loss: 260939.4297; val_gene_expr_recon_loss: 101916.8086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366356.2396; val_optim_loss: 366356.2396
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9790; val_auprc_score: 0.9673; val_best_acc_score: 0.9520; val_best_f1_score: 0.9534; train_kl_reg_loss: 3552.9734; train_edge_recon_loss: 257797.3070; train_gene_expr_recon_loss: 102187.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363537.2943; train_optim_loss: 363537.2943; val_kl_reg_loss: 3455.0491; val_edge_recon_loss: 260513.4583; val_gene_expr_recon_loss: 101844.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365813.3385; val_optim_loss: 365813.3385
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9805; val_auprc_score: 0.9703; val_best_acc_score: 0.9540; val_best_f1_score: 0.9553; train_kl_reg_loss: 3556.5861; train_edge_recon_loss: 257768.4437; train_gene_expr_recon_loss: 101925.5024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363250.5339; train_optim_loss: 363250.5339; val_kl_reg_loss: 3449.8065; val_edge_recon_loss: 260189.5859; val_gene_expr_recon_loss: 101318.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364958.2396; val_optim_loss: 364958.2396
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9806; val_auprc_score: 0.9704; val_best_acc_score: 0.9545; val_best_f1_score: 0.9556; train_kl_reg_loss: 3542.0080; train_edge_recon_loss: 257725.6595; train_gene_expr_recon_loss: 101605.6611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362873.3268; train_optim_loss: 362873.3268; val_kl_reg_loss: 3442.7121; val_edge_recon_loss: 260525.4219; val_gene_expr_recon_loss: 101448.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365416.4740; val_optim_loss: 365416.4740
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9813; val_auprc_score: 0.9721; val_best_acc_score: 0.9532; val_best_f1_score: 0.9545; train_kl_reg_loss: 3547.4381; train_edge_recon_loss: 257392.0189; train_gene_expr_recon_loss: 101370.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362309.5143; train_optim_loss: 362309.5143; val_kl_reg_loss: 3466.9995; val_edge_recon_loss: 260475.0156; val_gene_expr_recon_loss: 101157.7943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365099.8021; val_optim_loss: 365099.8021
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9821; val_auprc_score: 0.9729; val_best_acc_score: 0.9555; val_best_f1_score: 0.9567; train_kl_reg_loss: 3541.3410; train_edge_recon_loss: 257426.8701; train_gene_expr_recon_loss: 101208.8138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362177.0221; train_optim_loss: 362177.0221; val_kl_reg_loss: 3445.4646; val_edge_recon_loss: 260387.1458; val_gene_expr_recon_loss: 100929.1602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364761.7656; val_optim_loss: 364761.7656
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9820; val_auprc_score: 0.9725; val_best_acc_score: 0.9563; val_best_f1_score: 0.9574; train_kl_reg_loss: 3537.9801; train_edge_recon_loss: 257529.7174; train_gene_expr_recon_loss: 101036.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362104.5605; train_optim_loss: 362104.5605; val_kl_reg_loss: 3439.1053; val_edge_recon_loss: 259672.0703; val_gene_expr_recon_loss: 100868.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363980.0052; val_optim_loss: 363980.0052
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9821; val_auprc_score: 0.9718; val_best_acc_score: 0.9560; val_best_f1_score: 0.9570; train_kl_reg_loss: 3536.3330; train_edge_recon_loss: 257307.4329; train_gene_expr_recon_loss: 100764.1532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361607.9186; train_optim_loss: 361607.9186; val_kl_reg_loss: 3446.5693; val_edge_recon_loss: 260378.6510; val_gene_expr_recon_loss: 100169.9479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363995.1667; val_optim_loss: 363995.1667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9815; val_auprc_score: 0.9721; val_best_acc_score: 0.9559; val_best_f1_score: 0.9570; train_kl_reg_loss: 3531.6716; train_edge_recon_loss: 257549.8141; train_gene_expr_recon_loss: 100677.8171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361759.3040; train_optim_loss: 361759.3040; val_kl_reg_loss: 3455.4476; val_edge_recon_loss: 260154.3229; val_gene_expr_recon_loss: 100525.2839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364135.0521; val_optim_loss: 364135.0521
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9823; val_auprc_score: 0.9735; val_best_acc_score: 0.9567; val_best_f1_score: 0.9576; train_kl_reg_loss: 3529.4321; train_edge_recon_loss: 257404.2233; train_gene_expr_recon_loss: 100336.3986; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361270.0560; train_optim_loss: 361270.0560; val_kl_reg_loss: 3456.6044; val_edge_recon_loss: 260330.5208; val_gene_expr_recon_loss: 100227.2487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364014.3750; val_optim_loss: 364014.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9821; val_auprc_score: 0.9717; val_best_acc_score: 0.9564; val_best_f1_score: 0.9576; train_kl_reg_loss: 3526.9156; train_edge_recon_loss: 257339.1286; train_gene_expr_recon_loss: 100175.0742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361041.1204; train_optim_loss: 361041.1204; val_kl_reg_loss: 3439.6988; val_edge_recon_loss: 259710.4505; val_gene_expr_recon_loss: 100042.9492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363193.1042; val_optim_loss: 363193.1042
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9820; val_auprc_score: 0.9725; val_best_acc_score: 0.9565; val_best_f1_score: 0.9577; train_kl_reg_loss: 3349.7502; train_edge_recon_loss: 257047.7760; train_gene_expr_recon_loss: 100047.8732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360445.3984; train_optim_loss: 360445.3984; val_kl_reg_loss: 2971.8188; val_edge_recon_loss: 259956.2474; val_gene_expr_recon_loss: 99728.5143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362656.5781; val_optim_loss: 362656.5781
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9811; val_auprc_score: 0.9704; val_best_acc_score: 0.9564; val_best_f1_score: 0.9576; train_kl_reg_loss: 3150.1176; train_edge_recon_loss: 257429.1257; train_gene_expr_recon_loss: 99952.1558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360531.3997; train_optim_loss: 360531.3997; val_kl_reg_loss: 2930.8318; val_edge_recon_loss: 260422.2917; val_gene_expr_recon_loss: 99923.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363276.1771; val_optim_loss: 363276.1771
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9820; val_auprc_score: 0.9723; val_best_acc_score: 0.9573; val_best_f1_score: 0.9584; train_kl_reg_loss: 3115.9385; train_edge_recon_loss: 257030.0059; train_gene_expr_recon_loss: 100049.8042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360195.7474; train_optim_loss: 360195.7474; val_kl_reg_loss: 2898.6828; val_edge_recon_loss: 259924.8411; val_gene_expr_recon_loss: 99908.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362732.4479; val_optim_loss: 362732.4479
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9823; val_auprc_score: 0.9720; val_best_acc_score: 0.9570; val_best_f1_score: 0.9581; train_kl_reg_loss: 3090.6655; train_edge_recon_loss: 257146.3887; train_gene_expr_recon_loss: 99968.9963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360206.0488; train_optim_loss: 360206.0488; val_kl_reg_loss: 2887.0404; val_edge_recon_loss: 259906.1693; val_gene_expr_recon_loss: 100197.7539; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362990.9635; val_optim_loss: 362990.9635

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9815; val_auprc_score: 0.9715; val_best_acc_score: 0.9560; val_best_f1_score: 0.9572; train_kl_reg_loss: 3082.1722; train_edge_recon_loss: 257203.0918; train_gene_expr_recon_loss: 100118.0122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360403.2741; train_optim_loss: 360403.2741; val_kl_reg_loss: 2884.2109; val_edge_recon_loss: 260228.2031; val_gene_expr_recon_loss: 100030.5534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363142.9688; val_optim_loss: 363142.9688
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9815; val_auprc_score: 0.9712; val_best_acc_score: 0.9568; val_best_f1_score: 0.9578; train_kl_reg_loss: 3079.4225; train_edge_recon_loss: 257070.9948; train_gene_expr_recon_loss: 99997.7894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360148.2051; train_optim_loss: 360148.2051; val_kl_reg_loss: 2879.2096; val_edge_recon_loss: 260014.7682; val_gene_expr_recon_loss: 99734.2982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362628.2812; val_optim_loss: 362628.2812
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9808; val_auprc_score: 0.9702; val_best_acc_score: 0.9567; val_best_f1_score: 0.9579; train_kl_reg_loss: 3076.6490; train_edge_recon_loss: 257135.6947; train_gene_expr_recon_loss: 99922.2718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360134.6172; train_optim_loss: 360134.6172; val_kl_reg_loss: 2879.4463; val_edge_recon_loss: 260415.7422; val_gene_expr_recon_loss: 99639.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362934.9479; val_optim_loss: 362934.9479
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9819; val_auprc_score: 0.9724; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 3077.8132; train_edge_recon_loss: 256984.5625; train_gene_expr_recon_loss: 100076.9997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360139.3757; train_optim_loss: 360139.3757; val_kl_reg_loss: 2882.9848; val_edge_recon_loss: 260003.8854; val_gene_expr_recon_loss: 99664.1992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362551.0729; val_optim_loss: 362551.0729
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9824; val_auprc_score: 0.9729; val_best_acc_score: 0.9562; val_best_f1_score: 0.9574; train_kl_reg_loss: 3074.3764; train_edge_recon_loss: 257154.7493; train_gene_expr_recon_loss: 99989.5270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360218.6536; train_optim_loss: 360218.6536; val_kl_reg_loss: 2879.3056; val_edge_recon_loss: 259975.0703; val_gene_expr_recon_loss: 99823.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362677.5833; val_optim_loss: 362677.5833
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9818; val_auprc_score: 0.9723; val_best_acc_score: 0.9563; val_best_f1_score: 0.9575; train_kl_reg_loss: 3075.4146; train_edge_recon_loss: 257108.5739; train_gene_expr_recon_loss: 100033.8740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360217.8600; train_optim_loss: 360217.8600; val_kl_reg_loss: 2877.3324; val_edge_recon_loss: 260336.9219; val_gene_expr_recon_loss: 99815.2904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363029.5417; val_optim_loss: 363029.5417
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9816; val_auprc_score: 0.9713; val_best_acc_score: 0.9568; val_best_f1_score: 0.9579; train_kl_reg_loss: 3070.4847; train_edge_recon_loss: 257051.2962; train_gene_expr_recon_loss: 99916.5601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360038.3418; train_optim_loss: 360038.3418; val_kl_reg_loss: 2878.7284; val_edge_recon_loss: 259661.5521; val_gene_expr_recon_loss: 99726.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362267.2552; val_optim_loss: 362267.2552
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9819; val_auprc_score: 0.9722; val_best_acc_score: 0.9568; val_best_f1_score: 0.9581; train_kl_reg_loss: 3071.3121; train_edge_recon_loss: 257021.0446; train_gene_expr_recon_loss: 100062.2783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360154.6400; train_optim_loss: 360154.6400; val_kl_reg_loss: 2876.3079; val_edge_recon_loss: 259924.8984; val_gene_expr_recon_loss: 99679.3307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362480.5417; val_optim_loss: 362480.5417
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9826; val_auprc_score: 0.9732; val_best_acc_score: 0.9576; val_best_f1_score: 0.9589; train_kl_reg_loss: 3070.5616; train_edge_recon_loss: 257034.4658; train_gene_expr_recon_loss: 99831.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359936.9779; train_optim_loss: 359936.9779; val_kl_reg_loss: 2877.8997; val_edge_recon_loss: 259628.9922; val_gene_expr_recon_loss: 100129.5911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362636.4896; val_optim_loss: 362636.4896
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9819; val_auprc_score: 0.9725; val_best_acc_score: 0.9574; val_best_f1_score: 0.9586; train_kl_reg_loss: 3068.8141; train_edge_recon_loss: 257002.3001; train_gene_expr_recon_loss: 100049.8369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360120.9512; train_optim_loss: 360120.9512; val_kl_reg_loss: 2875.1969; val_edge_recon_loss: 259874.2448; val_gene_expr_recon_loss: 99886.2956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362635.7344; val_optim_loss: 362635.7344

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9824; val_auprc_score: 0.9739; val_best_acc_score: 0.9569; val_best_f1_score: 0.9580; train_kl_reg_loss: 3068.2183; train_edge_recon_loss: 257061.2790; train_gene_expr_recon_loss: 100012.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360141.5332; train_optim_loss: 360141.5332; val_kl_reg_loss: 2874.6566; val_edge_recon_loss: 259973.0833; val_gene_expr_recon_loss: 99986.2904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362834.0260; val_optim_loss: 362834.0260
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9832; val_auprc_score: 0.9746; val_best_acc_score: 0.9595; val_best_f1_score: 0.9605; train_kl_reg_loss: 3067.4301; train_edge_recon_loss: 257168.6279; train_gene_expr_recon_loss: 100066.7274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360302.7832; train_optim_loss: 360302.7832; val_kl_reg_loss: 2874.7831; val_edge_recon_loss: 259252.1146; val_gene_expr_recon_loss: 99847.2826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361974.1771; val_optim_loss: 361974.1771
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9817; val_auprc_score: 0.9714; val_best_acc_score: 0.9572; val_best_f1_score: 0.9584; train_kl_reg_loss: 3066.3701; train_edge_recon_loss: 256980.1624; train_gene_expr_recon_loss: 99922.2342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359968.7650; train_optim_loss: 359968.7650; val_kl_reg_loss: 2874.6340; val_edge_recon_loss: 260073.9010; val_gene_expr_recon_loss: 99755.3893; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362703.9167; val_optim_loss: 362703.9167
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9816; val_auprc_score: 0.9708; val_best_acc_score: 0.9569; val_best_f1_score: 0.9580; train_kl_reg_loss: 3066.8279; train_edge_recon_loss: 257078.4326; train_gene_expr_recon_loss: 99940.8201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360086.0801; train_optim_loss: 360086.0801; val_kl_reg_loss: 2876.0965; val_edge_recon_loss: 260088.7214; val_gene_expr_recon_loss: 99974.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362939.3802; val_optim_loss: 362939.3802
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9820; val_auprc_score: 0.9716; val_best_acc_score: 0.9579; val_best_f1_score: 0.9591; train_kl_reg_loss: 3066.1993; train_edge_recon_loss: 257146.8151; train_gene_expr_recon_loss: 99957.4017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360170.4160; train_optim_loss: 360170.4160; val_kl_reg_loss: 2875.8248; val_edge_recon_loss: 259736.1354; val_gene_expr_recon_loss: 99987.5339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362599.5000; val_optim_loss: 362599.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9819; val_auprc_score: 0.9710; val_best_acc_score: 0.9571; val_best_f1_score: 0.9584; train_kl_reg_loss: 3067.0556; train_edge_recon_loss: 257046.5443; train_gene_expr_recon_loss: 100030.6434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360144.2435; train_optim_loss: 360144.2435; val_kl_reg_loss: 2874.0623; val_edge_recon_loss: 259957.9323; val_gene_expr_recon_loss: 99881.7122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362713.7031; val_optim_loss: 362713.7031
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9818; val_auprc_score: 0.9714; val_best_acc_score: 0.9573; val_best_f1_score: 0.9585; train_kl_reg_loss: 3067.0076; train_edge_recon_loss: 257194.2894; train_gene_expr_recon_loss: 100016.5225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360277.8216; train_optim_loss: 360277.8216; val_kl_reg_loss: 2874.8744; val_edge_recon_loss: 259884.0807; val_gene_expr_recon_loss: 99901.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362660.4375; val_optim_loss: 362660.4375
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9827; val_auprc_score: 0.9736; val_best_acc_score: 0.9585; val_best_f1_score: 0.9596; train_kl_reg_loss: 3065.8051; train_edge_recon_loss: 256895.5199; train_gene_expr_recon_loss: 99892.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359854.0547; train_optim_loss: 359854.0547; val_kl_reg_loss: 2875.3558; val_edge_recon_loss: 259649.2500; val_gene_expr_recon_loss: 99847.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362371.8646; val_optim_loss: 362371.8646

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 1 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9811
Val AUPRC score: 0.9711
Val best accuracy score: 0.9554
Val best F1 score: 0.9568
Val gene expr MSE score: 0.5488
Duration of model training in run 2: 0 hours, 13 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9782; val_auprc_score: 0.9654; val_best_acc_score: 0.9464; val_best_f1_score: 0.9477; train_kl_reg_loss: 4066.4734; train_edge_recon_loss: 271679.5706; train_gene_expr_recon_loss: 114056.9490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389802.9934; train_optim_loss: 389802.9934; val_kl_reg_loss: 3684.0031; val_edge_recon_loss: 260154.2448; val_gene_expr_recon_loss: 108850.1551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372688.4048; val_optim_loss: 372688.4048
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9816; val_auprc_score: 0.9718; val_best_acc_score: 0.9525; val_best_f1_score: 0.9539; train_kl_reg_loss: 3698.0909; train_edge_recon_loss: 259192.2666; train_gene_expr_recon_loss: 108311.6460; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371202.0020; train_optim_loss: 371202.0020; val_kl_reg_loss: 3523.7848; val_edge_recon_loss: 259307.0186; val_gene_expr_recon_loss: 106402.8921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369233.6935; val_optim_loss: 369233.6935
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9834; val_auprc_score: 0.9748; val_best_acc_score: 0.9574; val_best_f1_score: 0.9585; train_kl_reg_loss: 3584.5728; train_edge_recon_loss: 258132.9695; train_gene_expr_recon_loss: 106274.6865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367992.2288; train_optim_loss: 367992.2288; val_kl_reg_loss: 3512.8167; val_edge_recon_loss: 258328.7448; val_gene_expr_recon_loss: 104504.5510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366346.1146; val_optim_loss: 366346.1146
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9852; val_auprc_score: 0.9777; val_best_acc_score: 0.9601; val_best_f1_score: 0.9610; train_kl_reg_loss: 3539.6705; train_edge_recon_loss: 257670.0587; train_gene_expr_recon_loss: 105104.1012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366313.8310; train_optim_loss: 366313.8310; val_kl_reg_loss: 3454.3612; val_edge_recon_loss: 257683.5588; val_gene_expr_recon_loss: 103409.2906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364547.2083; val_optim_loss: 364547.2083
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9869; val_auprc_score: 0.9800; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 3517.1636; train_edge_recon_loss: 257288.6771; train_gene_expr_recon_loss: 104008.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364813.8618; train_optim_loss: 364813.8618; val_kl_reg_loss: 3428.9570; val_edge_recon_loss: 257470.1897; val_gene_expr_recon_loss: 102548.3006; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363447.4464; val_optim_loss: 363447.4464
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9874; val_auprc_score: 0.9812; val_best_acc_score: 0.9658; val_best_f1_score: 0.9665; train_kl_reg_loss: 3503.8353; train_edge_recon_loss: 256996.0739; train_gene_expr_recon_loss: 103294.4669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363794.3764; train_optim_loss: 363794.3764; val_kl_reg_loss: 3445.9122; val_edge_recon_loss: 256901.6458; val_gene_expr_recon_loss: 102044.5424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362392.1042; val_optim_loss: 362392.1042
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9881; val_auprc_score: 0.9826; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 3499.7146; train_edge_recon_loss: 256800.8379; train_gene_expr_recon_loss: 102597.5377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362898.0895; train_optim_loss: 362898.0895; val_kl_reg_loss: 3437.6368; val_edge_recon_loss: 256841.3438; val_gene_expr_recon_loss: 101489.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361768.4554; val_optim_loss: 361768.4554
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9888; val_auprc_score: 0.9837; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 3494.5610; train_edge_recon_loss: 256893.6491; train_gene_expr_recon_loss: 101996.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362384.2634; train_optim_loss: 362384.2634; val_kl_reg_loss: 3421.6381; val_edge_recon_loss: 257413.5379; val_gene_expr_recon_loss: 100898.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361734.0298; val_optim_loss: 361734.0298
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9903; val_auprc_score: 0.9858; val_best_acc_score: 0.9687; val_best_f1_score: 0.9692; train_kl_reg_loss: 3489.4246; train_edge_recon_loss: 256647.9096; train_gene_expr_recon_loss: 101532.4305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361669.7639; train_optim_loss: 361669.7639; val_kl_reg_loss: 3406.0741; val_edge_recon_loss: 256865.2381; val_gene_expr_recon_loss: 100185.0484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360456.3601; val_optim_loss: 360456.3601
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9907; val_auprc_score: 0.9867; val_best_acc_score: 0.9694; val_best_f1_score: 0.9700; train_kl_reg_loss: 3495.8900; train_edge_recon_loss: 256300.3533; train_gene_expr_recon_loss: 101006.7686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360803.0112; train_optim_loss: 360803.0112; val_kl_reg_loss: 3416.6352; val_edge_recon_loss: 256624.6510; val_gene_expr_recon_loss: 99906.0361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359947.3199; val_optim_loss: 359947.3199
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9908; val_auprc_score: 0.9871; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 3493.1418; train_edge_recon_loss: 256392.5591; train_gene_expr_recon_loss: 100623.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360508.8307; train_optim_loss: 360508.8307; val_kl_reg_loss: 3440.8753; val_edge_recon_loss: 256421.7433; val_gene_expr_recon_loss: 99880.7050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359743.3274; val_optim_loss: 359743.3274
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9915; val_auprc_score: 0.9881; val_best_acc_score: 0.9707; val_best_f1_score: 0.9713; train_kl_reg_loss: 3491.7412; train_edge_recon_loss: 256402.9659; train_gene_expr_recon_loss: 100233.7492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360128.4574; train_optim_loss: 360128.4574; val_kl_reg_loss: 3446.4110; val_edge_recon_loss: 256538.2366; val_gene_expr_recon_loss: 99416.8557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359401.5030; val_optim_loss: 359401.5030
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9917; val_auprc_score: 0.9885; val_best_acc_score: 0.9717; val_best_f1_score: 0.9722; train_kl_reg_loss: 3492.6998; train_edge_recon_loss: 256332.4997; train_gene_expr_recon_loss: 99901.1386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359726.3378; train_optim_loss: 359726.3378; val_kl_reg_loss: 3429.2253; val_edge_recon_loss: 256394.2076; val_gene_expr_recon_loss: 98724.5409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358547.9762; val_optim_loss: 358547.9762
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9923; val_auprc_score: 0.9894; val_best_acc_score: 0.9722; val_best_f1_score: 0.9726; train_kl_reg_loss: 3494.8436; train_edge_recon_loss: 256278.4802; train_gene_expr_recon_loss: 99737.0082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359510.3314; train_optim_loss: 359510.3314; val_kl_reg_loss: 3460.5128; val_edge_recon_loss: 256253.3475; val_gene_expr_recon_loss: 99019.7288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358733.5893; val_optim_loss: 358733.5893
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9922; val_auprc_score: 0.9892; val_best_acc_score: 0.9721; val_best_f1_score: 0.9726; train_kl_reg_loss: 3496.0826; train_edge_recon_loss: 256181.0763; train_gene_expr_recon_loss: 99418.8662; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359096.0251; train_optim_loss: 359096.0251; val_kl_reg_loss: 3444.8060; val_edge_recon_loss: 256571.6682; val_gene_expr_recon_loss: 98777.8039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358794.2783; val_optim_loss: 358794.2783
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9927; val_auprc_score: 0.9901; val_best_acc_score: 0.9732; val_best_f1_score: 0.9737; train_kl_reg_loss: 3499.7306; train_edge_recon_loss: 256233.4310; train_gene_expr_recon_loss: 99188.6965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358921.8580; train_optim_loss: 358921.8580; val_kl_reg_loss: 3425.2921; val_edge_recon_loss: 256650.3943; val_gene_expr_recon_loss: 98508.8385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358584.5238; val_optim_loss: 358584.5238

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9923; val_auprc_score: 0.9898; val_best_acc_score: 0.9729; val_best_f1_score: 0.9734; train_kl_reg_loss: 3496.9014; train_edge_recon_loss: 256051.2045; train_gene_expr_recon_loss: 98930.8144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358478.9203; train_optim_loss: 358478.9203; val_kl_reg_loss: 3451.8895; val_edge_recon_loss: 256616.1682; val_gene_expr_recon_loss: 98098.4103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358166.4702; val_optim_loss: 358166.4702
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9930; val_auprc_score: 0.9907; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 3493.8968; train_edge_recon_loss: 256078.3257; train_gene_expr_recon_loss: 98899.0202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358471.2425; train_optim_loss: 358471.2425; val_kl_reg_loss: 3430.3463; val_edge_recon_loss: 256367.9375; val_gene_expr_recon_loss: 98208.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358006.5729; val_optim_loss: 358006.5729
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9931; val_auprc_score: 0.9903; val_best_acc_score: 0.9745; val_best_f1_score: 0.9748; train_kl_reg_loss: 3491.1138; train_edge_recon_loss: 256119.0372; train_gene_expr_recon_loss: 98827.5836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358437.7337; train_optim_loss: 358437.7337; val_kl_reg_loss: 3445.1250; val_edge_recon_loss: 256139.6429; val_gene_expr_recon_loss: 98011.0603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357595.8333; val_optim_loss: 357595.8333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9931; val_auprc_score: 0.9904; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 3491.4322; train_edge_recon_loss: 256066.2246; train_gene_expr_recon_loss: 98797.2729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358354.9297; train_optim_loss: 358354.9297; val_kl_reg_loss: 3445.3674; val_edge_recon_loss: 256317.4323; val_gene_expr_recon_loss: 98257.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358020.6711; val_optim_loss: 358020.6711
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9932; val_auprc_score: 0.9912; val_best_acc_score: 0.9743; val_best_f1_score: 0.9747; train_kl_reg_loss: 3492.6038; train_edge_recon_loss: 256001.2053; train_gene_expr_recon_loss: 98685.6573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358179.4654; train_optim_loss: 358179.4654; val_kl_reg_loss: 3431.1160; val_edge_recon_loss: 256181.9271; val_gene_expr_recon_loss: 98008.9952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357622.0387; val_optim_loss: 357622.0387
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9936; val_auprc_score: 0.9915; val_best_acc_score: 0.9742; val_best_f1_score: 0.9746; train_kl_reg_loss: 3491.9346; train_edge_recon_loss: 255979.1429; train_gene_expr_recon_loss: 98793.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358264.3424; train_optim_loss: 358264.3424; val_kl_reg_loss: 3446.9686; val_edge_recon_loss: 256235.8847; val_gene_expr_recon_loss: 98232.7262; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357915.5789; val_optim_loss: 357915.5789

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9739; val_best_f1_score: 0.9744; train_kl_reg_loss: 3492.1420; train_edge_recon_loss: 255955.1122; train_gene_expr_recon_loss: 98636.8559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358084.1094; train_optim_loss: 358084.1094; val_kl_reg_loss: 3436.2462; val_edge_recon_loss: 256219.6711; val_gene_expr_recon_loss: 97920.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357576.6488; val_optim_loss: 357576.6488
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9930; val_auprc_score: 0.9904; val_best_acc_score: 0.9733; val_best_f1_score: 0.9738; train_kl_reg_loss: 3489.1480; train_edge_recon_loss: 255984.4564; train_gene_expr_recon_loss: 98691.0568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358164.6619; train_optim_loss: 358164.6619; val_kl_reg_loss: 3435.7890; val_edge_recon_loss: 256473.7991; val_gene_expr_recon_loss: 98236.6775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358146.2679; val_optim_loss: 358146.2679
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9933; val_auprc_score: 0.9908; val_best_acc_score: 0.9748; val_best_f1_score: 0.9751; train_kl_reg_loss: 3493.1352; train_edge_recon_loss: 255920.6313; train_gene_expr_recon_loss: 98646.2524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358060.0199; train_optim_loss: 358060.0199; val_kl_reg_loss: 3438.1816; val_edge_recon_loss: 255950.8594; val_gene_expr_recon_loss: 97938.6421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357327.6875; val_optim_loss: 357327.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9928; val_auprc_score: 0.9901; val_best_acc_score: 0.9741; val_best_f1_score: 0.9745; train_kl_reg_loss: 3368.5802; train_edge_recon_loss: 256321.2474; train_gene_expr_recon_loss: 98838.2978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358528.1252; train_optim_loss: 358528.1252; val_kl_reg_loss: 2941.7317; val_edge_recon_loss: 256419.8869; val_gene_expr_recon_loss: 98053.8051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357415.4256; val_optim_loss: 357415.4256
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9929; val_auprc_score: 0.9903; val_best_acc_score: 0.9740; val_best_f1_score: 0.9744; train_kl_reg_loss: 3172.1165; train_edge_recon_loss: 256147.4535; train_gene_expr_recon_loss: 98852.8489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358172.4180; train_optim_loss: 358172.4180; val_kl_reg_loss: 2767.1406; val_edge_recon_loss: 256611.8318; val_gene_expr_recon_loss: 98018.4747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357397.4449; val_optim_loss: 357397.4449
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9888; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 3014.5000; train_edge_recon_loss: 256027.5096; train_gene_expr_recon_loss: 98808.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357850.7240; train_optim_loss: 357850.7240; val_kl_reg_loss: 2631.4584; val_edge_recon_loss: 256821.9539; val_gene_expr_recon_loss: 98163.2753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357616.6890; val_optim_loss: 357616.6890

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9928; val_auprc_score: 0.9903; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 2943.4248; train_edge_recon_loss: 256162.6374; train_gene_expr_recon_loss: 98790.3374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357896.4001; train_optim_loss: 357896.4001; val_kl_reg_loss: 2618.6535; val_edge_recon_loss: 256606.3177; val_gene_expr_recon_loss: 98162.0406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357387.0104; val_optim_loss: 357387.0104
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9922; val_auprc_score: 0.9889; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 2931.5785; train_edge_recon_loss: 256086.0998; train_gene_expr_recon_loss: 98867.8752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357885.5545; train_optim_loss: 357885.5545; val_kl_reg_loss: 2608.6606; val_edge_recon_loss: 256772.3832; val_gene_expr_recon_loss: 98029.1440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357410.1905; val_optim_loss: 357410.1905
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9925; val_auprc_score: 0.9897; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 2921.1441; train_edge_recon_loss: 256043.0877; train_gene_expr_recon_loss: 98834.4501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357798.6827; train_optim_loss: 357798.6827; val_kl_reg_loss: 2597.5656; val_edge_recon_loss: 256513.4003; val_gene_expr_recon_loss: 98192.5621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357303.5268; val_optim_loss: 357303.5268
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9923; val_auprc_score: 0.9892; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 2911.2503; train_edge_recon_loss: 256053.9142; train_gene_expr_recon_loss: 98762.4559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357727.6196; train_optim_loss: 357727.6196; val_kl_reg_loss: 2588.1767; val_edge_recon_loss: 256892.7083; val_gene_expr_recon_loss: 98035.8966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357516.7768; val_optim_loss: 357516.7768
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9927; val_auprc_score: 0.9902; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 2901.5129; train_edge_recon_loss: 256074.7195; train_gene_expr_recon_loss: 98802.2897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357778.5224; train_optim_loss: 357778.5224; val_kl_reg_loss: 2579.1890; val_edge_recon_loss: 256650.9814; val_gene_expr_recon_loss: 98062.6864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357292.8571; val_optim_loss: 357292.8571
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9925; val_auprc_score: 0.9895; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 2892.2811; train_edge_recon_loss: 256005.1490; train_gene_expr_recon_loss: 98810.4398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357707.8697; train_optim_loss: 357707.8697; val_kl_reg_loss: 2571.8929; val_edge_recon_loss: 256640.1391; val_gene_expr_recon_loss: 98399.6931; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357611.7247; val_optim_loss: 357611.7247
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9924; val_auprc_score: 0.9896; val_best_acc_score: 0.9734; val_best_f1_score: 0.9738; train_kl_reg_loss: 2884.4063; train_edge_recon_loss: 256101.9671; train_gene_expr_recon_loss: 98810.5653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357796.9383; train_optim_loss: 357796.9383; val_kl_reg_loss: 2562.2453; val_edge_recon_loss: 256381.5461; val_gene_expr_recon_loss: 98160.4222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357104.2113; val_optim_loss: 357104.2113
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9920; val_auprc_score: 0.9884; val_best_acc_score: 0.9732; val_best_f1_score: 0.9736; train_kl_reg_loss: 2874.8454; train_edge_recon_loss: 256111.1945; train_gene_expr_recon_loss: 98736.5158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357722.5550; train_optim_loss: 357722.5550; val_kl_reg_loss: 2555.0084; val_edge_recon_loss: 256733.2641; val_gene_expr_recon_loss: 98016.9431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357305.2143; val_optim_loss: 357305.2143
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9924; val_auprc_score: 0.9894; val_best_acc_score: 0.9738; val_best_f1_score: 0.9742; train_kl_reg_loss: 2867.1138; train_edge_recon_loss: 256111.0419; train_gene_expr_recon_loss: 98767.8901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357746.0455; train_optim_loss: 357746.0455; val_kl_reg_loss: 2547.3863; val_edge_recon_loss: 256498.9204; val_gene_expr_recon_loss: 98366.4096; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357412.7173; val_optim_loss: 357412.7173
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9931; val_auprc_score: 0.9907; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 2859.9404; train_edge_recon_loss: 256082.3145; train_gene_expr_recon_loss: 98778.3373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357720.5910; train_optim_loss: 357720.5910; val_kl_reg_loss: 2540.6742; val_edge_recon_loss: 256252.7924; val_gene_expr_recon_loss: 98200.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356993.5476; val_optim_loss: 356993.5476
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9925; val_auprc_score: 0.9894; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 2852.4770; train_edge_recon_loss: 256056.0709; train_gene_expr_recon_loss: 98727.3159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357635.8628; train_optim_loss: 357635.8628; val_kl_reg_loss: 2531.8733; val_edge_recon_loss: 256499.0298; val_gene_expr_recon_loss: 98036.8821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357067.7812; val_optim_loss: 357067.7812
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9924; val_auprc_score: 0.9895; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 2844.7336; train_edge_recon_loss: 256102.0582; train_gene_expr_recon_loss: 98862.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357809.2075; train_optim_loss: 357809.2075; val_kl_reg_loss: 2525.9868; val_edge_recon_loss: 256563.3534; val_gene_expr_recon_loss: 98286.4885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357375.8274; val_optim_loss: 357375.8274
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9928; val_auprc_score: 0.9903; val_best_acc_score: 0.9739; val_best_f1_score: 0.9743; train_kl_reg_loss: 2838.9134; train_edge_recon_loss: 256120.3102; train_gene_expr_recon_loss: 98705.9437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357665.1668; train_optim_loss: 357665.1668; val_kl_reg_loss: 2521.1583; val_edge_recon_loss: 256575.3936; val_gene_expr_recon_loss: 98241.7210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357338.2693; val_optim_loss: 357338.2693

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9923; val_auprc_score: 0.9893; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 2835.3695; train_edge_recon_loss: 256112.7976; train_gene_expr_recon_loss: 98842.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357791.0083; train_optim_loss: 357791.0083; val_kl_reg_loss: 2520.2584; val_edge_recon_loss: 256686.4628; val_gene_expr_recon_loss: 98167.2180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357373.9360; val_optim_loss: 357373.9360
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9925; val_auprc_score: 0.9895; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 2834.4182; train_edge_recon_loss: 256057.8603; train_gene_expr_recon_loss: 98772.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357664.3638; train_optim_loss: 357664.3638; val_kl_reg_loss: 2519.3206; val_edge_recon_loss: 256626.8110; val_gene_expr_recon_loss: 98247.5264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357393.6577; val_optim_loss: 357393.6577
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9920; val_auprc_score: 0.9888; val_best_acc_score: 0.9733; val_best_f1_score: 0.9737; train_kl_reg_loss: 2834.0464; train_edge_recon_loss: 256042.5704; train_gene_expr_recon_loss: 98706.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357582.9547; train_optim_loss: 357582.9547; val_kl_reg_loss: 2519.6217; val_edge_recon_loss: 256597.5588; val_gene_expr_recon_loss: 98046.4241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357163.6071; val_optim_loss: 357163.6071

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 51 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9918
Val AUPRC score: 0.9886
Val best accuracy score: 0.9732
Val best F1 score: 0.9736
Val gene expr MSE score: 0.5600
Duration of model training in run 3: 0 hours, 41 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9787; val_auprc_score: 0.9651; val_best_acc_score: 0.9477; val_best_f1_score: 0.9487; train_kl_reg_loss: 4018.8559; train_edge_recon_loss: 271591.7903; train_gene_expr_recon_loss: 113215.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388826.0902; train_optim_loss: 388826.0902; val_kl_reg_loss: 3769.7046; val_edge_recon_loss: 260366.4896; val_gene_expr_recon_loss: 109596.8609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373733.0536; val_optim_loss: 373733.0536
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9811; val_auprc_score: 0.9700; val_best_acc_score: 0.9534; val_best_f1_score: 0.9544; train_kl_reg_loss: 3706.5769; train_edge_recon_loss: 259116.9265; train_gene_expr_recon_loss: 107558.0406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370381.5452; train_optim_loss: 370381.5452; val_kl_reg_loss: 3580.5334; val_edge_recon_loss: 258991.2999; val_gene_expr_recon_loss: 106913.9412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369485.7753; val_optim_loss: 369485.7753
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9832; val_auprc_score: 0.9745; val_best_acc_score: 0.9574; val_best_f1_score: 0.9585; train_kl_reg_loss: 3590.7495; train_edge_recon_loss: 258054.5837; train_gene_expr_recon_loss: 105584.7428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367230.0769; train_optim_loss: 367230.0769; val_kl_reg_loss: 3486.2825; val_edge_recon_loss: 257820.3088; val_gene_expr_recon_loss: 105395.9204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366702.5149; val_optim_loss: 366702.5149
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9856; val_auprc_score: 0.9785; val_best_acc_score: 0.9613; val_best_f1_score: 0.9621; train_kl_reg_loss: 3535.7575; train_edge_recon_loss: 257636.1169; train_gene_expr_recon_loss: 104396.2698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365568.1444; train_optim_loss: 365568.1444; val_kl_reg_loss: 3470.5469; val_edge_recon_loss: 257571.1719; val_gene_expr_recon_loss: 104831.2519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365872.9747; val_optim_loss: 365872.9747
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9865; val_auprc_score: 0.9797; val_best_acc_score: 0.9633; val_best_f1_score: 0.9642; train_kl_reg_loss: 3515.9141; train_edge_recon_loss: 257251.1809; train_gene_expr_recon_loss: 103504.6382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364271.7330; train_optim_loss: 364271.7330; val_kl_reg_loss: 3466.9967; val_edge_recon_loss: 257604.8229; val_gene_expr_recon_loss: 103514.5774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364586.3973; val_optim_loss: 364586.3973
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9873; val_auprc_score: 0.9815; val_best_acc_score: 0.9641; val_best_f1_score: 0.9649; train_kl_reg_loss: 3502.5868; train_edge_recon_loss: 257120.9243; train_gene_expr_recon_loss: 102729.9059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363353.4158; train_optim_loss: 363353.4158; val_kl_reg_loss: 3428.1691; val_edge_recon_loss: 257305.7589; val_gene_expr_recon_loss: 103182.7277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363916.6562; val_optim_loss: 363916.6562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9885; val_auprc_score: 0.9838; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 3494.7200; train_edge_recon_loss: 256957.8292; train_gene_expr_recon_loss: 102084.9508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362537.4992; train_optim_loss: 362537.4992; val_kl_reg_loss: 3441.4150; val_edge_recon_loss: 257248.6473; val_gene_expr_recon_loss: 102292.0863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362982.1443; val_optim_loss: 362982.1443
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9891; val_auprc_score: 0.9849; val_best_acc_score: 0.9660; val_best_f1_score: 0.9667; train_kl_reg_loss: 3491.1773; train_edge_recon_loss: 256799.6508; train_gene_expr_recon_loss: 101529.6920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361820.5194; train_optim_loss: 361820.5194; val_kl_reg_loss: 3439.5282; val_edge_recon_loss: 257078.4323; val_gene_expr_recon_loss: 101933.9535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362451.9107; val_optim_loss: 362451.9107
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9889; val_auprc_score: 0.9840; val_best_acc_score: 0.9668; val_best_f1_score: 0.9674; train_kl_reg_loss: 3490.0623; train_edge_recon_loss: 256655.5189; train_gene_expr_recon_loss: 100991.0150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361136.5965; train_optim_loss: 361136.5965; val_kl_reg_loss: 3432.2093; val_edge_recon_loss: 257233.6354; val_gene_expr_recon_loss: 101625.9263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362291.7723; val_optim_loss: 362291.7723
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9896; val_auprc_score: 0.9851; val_best_acc_score: 0.9688; val_best_f1_score: 0.9694; train_kl_reg_loss: 3487.4061; train_edge_recon_loss: 256572.8901; train_gene_expr_recon_loss: 100669.3877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360729.6853; train_optim_loss: 360729.6853; val_kl_reg_loss: 3426.0402; val_edge_recon_loss: 256831.3884; val_gene_expr_recon_loss: 100909.9684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361167.3973; val_optim_loss: 361167.3973
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9903; val_auprc_score: 0.9866; val_best_acc_score: 0.9689; val_best_f1_score: 0.9694; train_kl_reg_loss: 3487.4474; train_edge_recon_loss: 256350.0819; train_gene_expr_recon_loss: 100289.0665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360126.5949; train_optim_loss: 360126.5949; val_kl_reg_loss: 3445.0603; val_edge_recon_loss: 256907.0722; val_gene_expr_recon_loss: 100625.7065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360977.8393; val_optim_loss: 360977.8393
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9912; val_auprc_score: 0.9877; val_best_acc_score: 0.9706; val_best_f1_score: 0.9710; train_kl_reg_loss: 3488.9646; train_edge_recon_loss: 256386.7574; train_gene_expr_recon_loss: 99972.4854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359848.2079; train_optim_loss: 359848.2079; val_kl_reg_loss: 3465.0567; val_edge_recon_loss: 256547.6920; val_gene_expr_recon_loss: 100639.1481; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360651.9003; val_optim_loss: 360651.9003
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9919; val_auprc_score: 0.9888; val_best_acc_score: 0.9715; val_best_f1_score: 0.9719; train_kl_reg_loss: 3490.8019; train_edge_recon_loss: 256327.0281; train_gene_expr_recon_loss: 99615.8953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359433.7250; train_optim_loss: 359433.7250; val_kl_reg_loss: 3438.5286; val_edge_recon_loss: 256792.8735; val_gene_expr_recon_loss: 100276.5993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360507.9985; val_optim_loss: 360507.9985
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9920; val_auprc_score: 0.9889; val_best_acc_score: 0.9718; val_best_f1_score: 0.9722; train_kl_reg_loss: 3495.7974; train_edge_recon_loss: 256249.2674; train_gene_expr_recon_loss: 99355.9884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359101.0542; train_optim_loss: 359101.0542; val_kl_reg_loss: 3442.5983; val_edge_recon_loss: 256690.3906; val_gene_expr_recon_loss: 99774.6261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359907.6190; val_optim_loss: 359907.6190
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9928; val_auprc_score: 0.9902; val_best_acc_score: 0.9737; val_best_f1_score: 0.9741; train_kl_reg_loss: 3497.8125; train_edge_recon_loss: 256122.7615; train_gene_expr_recon_loss: 99137.9693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358758.5423; train_optim_loss: 358758.5423; val_kl_reg_loss: 3438.7803; val_edge_recon_loss: 256142.7865; val_gene_expr_recon_loss: 99839.2225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359420.7887; val_optim_loss: 359420.7887
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9929; val_auprc_score: 0.9906; val_best_acc_score: 0.9724; val_best_f1_score: 0.9729; train_kl_reg_loss: 3500.3742; train_edge_recon_loss: 256195.9794; train_gene_expr_recon_loss: 98986.7199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358683.0734; train_optim_loss: 358683.0734; val_kl_reg_loss: 3411.9951; val_edge_recon_loss: 256819.9182; val_gene_expr_recon_loss: 99503.9133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359735.8259; val_optim_loss: 359735.8259
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9926; val_auprc_score: 0.9899; val_best_acc_score: 0.9731; val_best_f1_score: 0.9735; train_kl_reg_loss: 3508.7555; train_edge_recon_loss: 255978.3361; train_gene_expr_recon_loss: 98762.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358249.4788; train_optim_loss: 358249.4788; val_kl_reg_loss: 3452.4901; val_edge_recon_loss: 256377.9576; val_gene_expr_recon_loss: 99315.4840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359145.9330; val_optim_loss: 359145.9330
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9928; val_auprc_score: 0.9901; val_best_acc_score: 0.9744; val_best_f1_score: 0.9748; train_kl_reg_loss: 3508.2068; train_edge_recon_loss: 256049.4666; train_gene_expr_recon_loss: 98531.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358089.2079; train_optim_loss: 358089.2079; val_kl_reg_loss: 3471.2930; val_edge_recon_loss: 256159.2850; val_gene_expr_recon_loss: 99469.3430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359099.9182; val_optim_loss: 359099.9182
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9939; val_auprc_score: 0.9918; val_best_acc_score: 0.9750; val_best_f1_score: 0.9754; train_kl_reg_loss: 3513.3174; train_edge_recon_loss: 255885.6022; train_gene_expr_recon_loss: 98416.4254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357815.3444; train_optim_loss: 357815.3444; val_kl_reg_loss: 3470.7746; val_edge_recon_loss: 256068.7068; val_gene_expr_recon_loss: 99088.8475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358628.3304; val_optim_loss: 358628.3304
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9934; val_auprc_score: 0.9910; val_best_acc_score: 0.9747; val_best_f1_score: 0.9750; train_kl_reg_loss: 3516.7794; train_edge_recon_loss: 255950.0724; train_gene_expr_recon_loss: 98224.4760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357691.3274; train_optim_loss: 357691.3274; val_kl_reg_loss: 3473.8974; val_edge_recon_loss: 256617.9427; val_gene_expr_recon_loss: 98881.0301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358972.8676; val_optim_loss: 358972.8676
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9934; val_auprc_score: 0.9909; val_best_acc_score: 0.9749; val_best_f1_score: 0.9752; train_kl_reg_loss: 3521.6944; train_edge_recon_loss: 255903.1699; train_gene_expr_recon_loss: 98202.1251; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357626.9893; train_optim_loss: 357626.9893; val_kl_reg_loss: 3472.9992; val_edge_recon_loss: 256397.2336; val_gene_expr_recon_loss: 98898.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358768.9479; val_optim_loss: 358768.9479
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 3525.7084; train_edge_recon_loss: 255934.7002; train_gene_expr_recon_loss: 98006.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357466.9389; train_optim_loss: 357466.9389; val_kl_reg_loss: 3447.1145; val_edge_recon_loss: 256358.7515; val_gene_expr_recon_loss: 98873.9602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358679.8274; val_optim_loss: 358679.8274

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9939; val_auprc_score: 0.9919; val_best_acc_score: 0.9762; val_best_f1_score: 0.9766; train_kl_reg_loss: 3520.6447; train_edge_recon_loss: 255851.9357; train_gene_expr_recon_loss: 97689.6263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357062.2072; train_optim_loss: 357062.2072; val_kl_reg_loss: 3475.9126; val_edge_recon_loss: 256134.1644; val_gene_expr_recon_loss: 98398.5573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358008.6339; val_optim_loss: 358008.6339
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9943; val_auprc_score: 0.9926; val_best_acc_score: 0.9763; val_best_f1_score: 0.9765; train_kl_reg_loss: 3520.5490; train_edge_recon_loss: 255771.0550; train_gene_expr_recon_loss: 97664.1486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356955.7531; train_optim_loss: 356955.7531; val_kl_reg_loss: 3474.2409; val_edge_recon_loss: 256312.9107; val_gene_expr_recon_loss: 98907.0149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358694.1682; val_optim_loss: 358694.1682
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9940; val_auprc_score: 0.9918; val_best_acc_score: 0.9759; val_best_f1_score: 0.9762; train_kl_reg_loss: 3517.1692; train_edge_recon_loss: 255826.4494; train_gene_expr_recon_loss: 97600.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356944.4358; train_optim_loss: 356944.4358; val_kl_reg_loss: 3474.1727; val_edge_recon_loss: 256240.4189; val_gene_expr_recon_loss: 98649.0930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358363.6875; val_optim_loss: 358363.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9939; val_auprc_score: 0.9916; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 3016.1951; train_edge_recon_loss: 255956.3872; train_gene_expr_recon_loss: 97775.4511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356748.0340; train_optim_loss: 356748.0340; val_kl_reg_loss: 2530.7325; val_edge_recon_loss: 256546.0446; val_gene_expr_recon_loss: 98667.3694; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357744.1503; val_optim_loss: 357744.1503
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9938; val_auprc_score: 0.9913; val_best_acc_score: 0.9761; val_best_f1_score: 0.9764; train_kl_reg_loss: 2843.7083; train_edge_recon_loss: 255716.9468; train_gene_expr_recon_loss: 97765.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356326.2486; train_optim_loss: 356326.2486; val_kl_reg_loss: 2517.8675; val_edge_recon_loss: 256544.9955; val_gene_expr_recon_loss: 98571.8798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357634.7381; val_optim_loss: 357634.7381
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9940; val_auprc_score: 0.9918; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 2812.5483; train_edge_recon_loss: 255827.9595; train_gene_expr_recon_loss: 97587.0196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356227.5294; train_optim_loss: 356227.5294; val_kl_reg_loss: 2501.7953; val_edge_recon_loss: 256635.2597; val_gene_expr_recon_loss: 98459.9416; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357596.9985; val_optim_loss: 357596.9985
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9936; val_auprc_score: 0.9914; val_best_acc_score: 0.9753; val_best_f1_score: 0.9757; train_kl_reg_loss: 2783.2932; train_edge_recon_loss: 255765.2625; train_gene_expr_recon_loss: 97711.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356259.7536; train_optim_loss: 356259.7536; val_kl_reg_loss: 2495.8959; val_edge_recon_loss: 256648.3720; val_gene_expr_recon_loss: 98673.2671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357817.5357; val_optim_loss: 357817.5357
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9940; val_auprc_score: 0.9917; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 2764.2681; train_edge_recon_loss: 255778.2710; train_gene_expr_recon_loss: 97650.8198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356193.3592; train_optim_loss: 356193.3592; val_kl_reg_loss: 2499.1668; val_edge_recon_loss: 256249.1324; val_gene_expr_recon_loss: 98696.8627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357445.1637; val_optim_loss: 357445.1637
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9938; val_auprc_score: 0.9916; val_best_acc_score: 0.9768; val_best_f1_score: 0.9771; train_kl_reg_loss: 2744.2063; train_edge_recon_loss: 255718.0054; train_gene_expr_recon_loss: 97631.5177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356093.7284; train_optim_loss: 356093.7284; val_kl_reg_loss: 2483.7928; val_edge_recon_loss: 256280.4963; val_gene_expr_recon_loss: 98632.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357396.7470; val_optim_loss: 357396.7470
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9940; val_auprc_score: 0.9916; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 2727.5929; train_edge_recon_loss: 255638.1551; train_gene_expr_recon_loss: 97617.5762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355983.3235; train_optim_loss: 355983.3235; val_kl_reg_loss: 2485.5574; val_edge_recon_loss: 256215.0134; val_gene_expr_recon_loss: 98634.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357335.5327; val_optim_loss: 357335.5327
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9943; val_auprc_score: 0.9920; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 2709.3200; train_edge_recon_loss: 255681.0320; train_gene_expr_recon_loss: 97571.9130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355962.2646; train_optim_loss: 355962.2646; val_kl_reg_loss: 2481.1196; val_edge_recon_loss: 256178.4881; val_gene_expr_recon_loss: 98705.4777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357365.0863; val_optim_loss: 357365.0863
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9942; val_auprc_score: 0.9924; val_best_acc_score: 0.9763; val_best_f1_score: 0.9766; train_kl_reg_loss: 2693.6681; train_edge_recon_loss: 255735.9417; train_gene_expr_recon_loss: 97589.0160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356018.6238; train_optim_loss: 356018.6238; val_kl_reg_loss: 2485.9408; val_edge_recon_loss: 256271.6756; val_gene_expr_recon_loss: 98442.5153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357200.1339; val_optim_loss: 357200.1339
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9772; val_best_f1_score: 0.9774; train_kl_reg_loss: 2676.8572; train_edge_recon_loss: 255624.5125; train_gene_expr_recon_loss: 97609.6561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355911.0256; train_optim_loss: 355911.0256; val_kl_reg_loss: 2474.9725; val_edge_recon_loss: 256191.9293; val_gene_expr_recon_loss: 98626.9178; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357293.8199; val_optim_loss: 357293.8199
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9943; val_auprc_score: 0.9923; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 2658.4265; train_edge_recon_loss: 255683.8469; train_gene_expr_recon_loss: 97611.2806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355953.5542; train_optim_loss: 355953.5542; val_kl_reg_loss: 2460.9592; val_edge_recon_loss: 256108.4539; val_gene_expr_recon_loss: 98073.2712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356642.6845; val_optim_loss: 356642.6845
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 2644.1441; train_edge_recon_loss: 255547.6458; train_gene_expr_recon_loss: 97579.4696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355771.2602; train_optim_loss: 355771.2602; val_kl_reg_loss: 2465.2843; val_edge_recon_loss: 256458.3713; val_gene_expr_recon_loss: 98482.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357406.6265; val_optim_loss: 357406.6265
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9772; val_best_f1_score: 0.9775; train_kl_reg_loss: 2627.3627; train_edge_recon_loss: 255612.3244; train_gene_expr_recon_loss: 97494.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355734.3008; train_optim_loss: 355734.3008; val_kl_reg_loss: 2460.8037; val_edge_recon_loss: 256268.5640; val_gene_expr_recon_loss: 98520.0305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357249.3988; val_optim_loss: 357249.3988
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9948; val_auprc_score: 0.9932; val_best_acc_score: 0.9770; val_best_f1_score: 0.9773; train_kl_reg_loss: 2614.2599; train_edge_recon_loss: 255516.1794; train_gene_expr_recon_loss: 97613.3824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355743.8232; train_optim_loss: 355743.8232; val_kl_reg_loss: 2466.3412; val_edge_recon_loss: 256320.7693; val_gene_expr_recon_loss: 98636.2228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357423.3304; val_optim_loss: 357423.3304

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9942; val_auprc_score: 0.9923; val_best_acc_score: 0.9763; val_best_f1_score: 0.9767; train_kl_reg_loss: 2610.2804; train_edge_recon_loss: 255570.2974; train_gene_expr_recon_loss: 97483.5696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355664.1467; train_optim_loss: 355664.1467; val_kl_reg_loss: 2457.4809; val_edge_recon_loss: 256480.1749; val_gene_expr_recon_loss: 98559.2716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357496.9256; val_optim_loss: 357496.9256
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9942; val_auprc_score: 0.9919; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 2605.9832; train_edge_recon_loss: 255586.1989; train_gene_expr_recon_loss: 97476.7169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355668.8991; train_optim_loss: 355668.8991; val_kl_reg_loss: 2457.6129; val_edge_recon_loss: 256345.2240; val_gene_expr_recon_loss: 98278.5074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357081.3467; val_optim_loss: 357081.3467
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9775; val_best_f1_score: 0.9777; train_kl_reg_loss: 2604.1141; train_edge_recon_loss: 255597.7575; train_gene_expr_recon_loss: 97518.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355720.6605; train_optim_loss: 355720.6605; val_kl_reg_loss: 2459.6096; val_edge_recon_loss: 256055.1176; val_gene_expr_recon_loss: 98428.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356943.5967; val_optim_loss: 356943.5967

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 53 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9941
Val AUPRC score: 0.9923
Val best accuracy score: 0.9760
Val best F1 score: 0.9764
Val gene expr MSE score: 0.6008
Duration of model training in run 4: 0 hours, 39 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9847; val_auprc_score: 0.9776; val_best_acc_score: 0.9576; val_best_f1_score: 0.9586; train_kl_reg_loss: 3744.2753; train_edge_recon_loss: 264309.6352; train_gene_expr_recon_loss: 110283.9075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378337.8180; train_optim_loss: 378337.8180; val_kl_reg_loss: 3547.6552; val_edge_recon_loss: 257581.2859; val_gene_expr_recon_loss: 106307.1636; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367436.1045; val_optim_loss: 367436.1045
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9882; val_auprc_score: 0.9830; val_best_acc_score: 0.9643; val_best_f1_score: 0.9650; train_kl_reg_loss: 3520.8026; train_edge_recon_loss: 257366.2290; train_gene_expr_recon_loss: 105140.4210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366027.4527; train_optim_loss: 366027.4527; val_kl_reg_loss: 3457.5967; val_edge_recon_loss: 256809.4787; val_gene_expr_recon_loss: 103453.8835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363720.9606; val_optim_loss: 363720.9606
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9905; val_auprc_score: 0.9864; val_best_acc_score: 0.9690; val_best_f1_score: 0.9695; train_kl_reg_loss: 3485.0795; train_edge_recon_loss: 256760.6996; train_gene_expr_recon_loss: 103169.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363415.5282; train_optim_loss: 363415.5282; val_kl_reg_loss: 3421.8212; val_edge_recon_loss: 256424.5018; val_gene_expr_recon_loss: 102230.5396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362076.8642; val_optim_loss: 362076.8642
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9922; val_auprc_score: 0.9891; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 3476.0823; train_edge_recon_loss: 256408.2535; train_gene_expr_recon_loss: 101732.2418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361616.5787; train_optim_loss: 361616.5787; val_kl_reg_loss: 3468.8072; val_edge_recon_loss: 256350.2044; val_gene_expr_recon_loss: 101189.1164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361008.1281; val_optim_loss: 361008.1281
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9928; val_auprc_score: 0.9899; val_best_acc_score: 0.9729; val_best_f1_score: 0.9732; train_kl_reg_loss: 3476.4157; train_edge_recon_loss: 256149.2084; train_gene_expr_recon_loss: 100865.5611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360491.1851; train_optim_loss: 360491.1851; val_kl_reg_loss: 3399.1257; val_edge_recon_loss: 256178.9442; val_gene_expr_recon_loss: 100471.8166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360049.8868; val_optim_loss: 360049.8868
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9911; val_best_acc_score: 0.9746; val_best_f1_score: 0.9749; train_kl_reg_loss: 3470.2118; train_edge_recon_loss: 256124.5551; train_gene_expr_recon_loss: 100339.4078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359934.1748; train_optim_loss: 359934.1748; val_kl_reg_loss: 3437.0714; val_edge_recon_loss: 255860.8161; val_gene_expr_recon_loss: 99951.1878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359249.0753; val_optim_loss: 359249.0753
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9944; val_auprc_score: 0.9923; val_best_acc_score: 0.9762; val_best_f1_score: 0.9766; train_kl_reg_loss: 3473.4432; train_edge_recon_loss: 255879.6343; train_gene_expr_recon_loss: 99886.3671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359239.4443; train_optim_loss: 359239.4443; val_kl_reg_loss: 3450.3474; val_edge_recon_loss: 255678.3276; val_gene_expr_recon_loss: 99706.9793; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358835.6542; val_optim_loss: 358835.6542
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9949; val_auprc_score: 0.9931; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 3472.1559; train_edge_recon_loss: 255854.7410; train_gene_expr_recon_loss: 99490.4862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358817.3827; train_optim_loss: 358817.3827; val_kl_reg_loss: 3449.9281; val_edge_recon_loss: 255809.2561; val_gene_expr_recon_loss: 99220.6527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358479.8350; val_optim_loss: 358479.8350
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9952; val_auprc_score: 0.9934; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 3477.1440; train_edge_recon_loss: 255734.8979; train_gene_expr_recon_loss: 99218.0590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358430.1014; train_optim_loss: 358430.1014; val_kl_reg_loss: 3485.6216; val_edge_recon_loss: 255626.3043; val_gene_expr_recon_loss: 98892.0589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358003.9857; val_optim_loss: 358003.9857
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9937; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 3480.3981; train_edge_recon_loss: 255719.4705; train_gene_expr_recon_loss: 99027.6674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358227.5364; train_optim_loss: 358227.5364; val_kl_reg_loss: 3457.5337; val_edge_recon_loss: 255428.3135; val_gene_expr_recon_loss: 98879.2962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357765.1434; val_optim_loss: 357765.1434
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9955; val_auprc_score: 0.9936; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 3487.7076; train_edge_recon_loss: 255597.9566; train_gene_expr_recon_loss: 98800.1537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357885.8183; train_optim_loss: 357885.8183; val_kl_reg_loss: 3489.2189; val_edge_recon_loss: 255358.8978; val_gene_expr_recon_loss: 99167.6326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358015.7500; val_optim_loss: 358015.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9959; val_auprc_score: 0.9943; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 3490.3162; train_edge_recon_loss: 255518.1929; train_gene_expr_recon_loss: 98622.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357630.5749; train_optim_loss: 357630.5749; val_kl_reg_loss: 3451.7229; val_edge_recon_loss: 255213.5243; val_gene_expr_recon_loss: 98924.9116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357590.1583; val_optim_loss: 357590.1583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9962; val_auprc_score: 0.9947; val_best_acc_score: 0.9817; val_best_f1_score: 0.9820; train_kl_reg_loss: 3494.6536; train_edge_recon_loss: 255434.1512; train_gene_expr_recon_loss: 98510.7077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357439.5121; train_optim_loss: 357439.5121; val_kl_reg_loss: 3424.5714; val_edge_recon_loss: 255183.9844; val_gene_expr_recon_loss: 98849.2608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357457.8176; val_optim_loss: 357457.8176
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9822; val_best_f1_score: 0.9824; train_kl_reg_loss: 3499.5347; train_edge_recon_loss: 255282.6698; train_gene_expr_recon_loss: 98371.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357154.0757; train_optim_loss: 357154.0757; val_kl_reg_loss: 3462.0369; val_edge_recon_loss: 255047.4593; val_gene_expr_recon_loss: 98568.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357078.4826; val_optim_loss: 357078.4826
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9961; val_auprc_score: 0.9945; val_best_acc_score: 0.9831; val_best_f1_score: 0.9833; train_kl_reg_loss: 3504.0273; train_edge_recon_loss: 255314.5359; train_gene_expr_recon_loss: 98307.4793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357126.0420; train_optim_loss: 357126.0420; val_kl_reg_loss: 3491.9876; val_edge_recon_loss: 255511.3502; val_gene_expr_recon_loss: 98812.5730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357815.9124; val_optim_loss: 357815.9124
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9964; val_auprc_score: 0.9949; val_best_acc_score: 0.9834; val_best_f1_score: 0.9836; train_kl_reg_loss: 3509.5374; train_edge_recon_loss: 255250.1186; train_gene_expr_recon_loss: 98093.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356852.9518; train_optim_loss: 356852.9518; val_kl_reg_loss: 3502.3711; val_edge_recon_loss: 255294.9485; val_gene_expr_recon_loss: 98491.1204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357288.4406; val_optim_loss: 357288.4406
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9967; val_auprc_score: 0.9951; val_best_acc_score: 0.9845; val_best_f1_score: 0.9846; train_kl_reg_loss: 3513.2435; train_edge_recon_loss: 255218.2430; train_gene_expr_recon_loss: 98125.4685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356856.9551; train_optim_loss: 356856.9551; val_kl_reg_loss: 3520.0933; val_edge_recon_loss: 255094.7774; val_gene_expr_recon_loss: 98596.6230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357211.4949; val_optim_loss: 357211.4949

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9842; val_best_f1_score: 0.9844; train_kl_reg_loss: 3513.8288; train_edge_recon_loss: 255140.9503; train_gene_expr_recon_loss: 97831.7821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356486.5599; train_optim_loss: 356486.5599; val_kl_reg_loss: 3476.4136; val_edge_recon_loss: 254923.6711; val_gene_expr_recon_loss: 98218.8156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356618.8991; val_optim_loss: 356618.8991
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9967; val_auprc_score: 0.9956; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 3511.4947; train_edge_recon_loss: 255010.5427; train_gene_expr_recon_loss: 97789.4459; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356311.4832; train_optim_loss: 356311.4832; val_kl_reg_loss: 3480.3521; val_edge_recon_loss: 255084.5256; val_gene_expr_recon_loss: 98578.4554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357143.3335; val_optim_loss: 357143.3335
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 3509.6546; train_edge_recon_loss: 254992.7229; train_gene_expr_recon_loss: 97765.0215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356267.3987; train_optim_loss: 356267.3987; val_kl_reg_loss: 3482.7077; val_edge_recon_loss: 254992.3916; val_gene_expr_recon_loss: 98300.0255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356775.1240; val_optim_loss: 356775.1240
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9966; val_auprc_score: 0.9950; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 3506.7151; train_edge_recon_loss: 255044.4939; train_gene_expr_recon_loss: 97672.8526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356224.0616; train_optim_loss: 356224.0616; val_kl_reg_loss: 3468.4671; val_edge_recon_loss: 255002.1068; val_gene_expr_recon_loss: 98524.5127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356995.0850; val_optim_loss: 356995.0850

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9968; val_auprc_score: 0.9955; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 3508.0146; train_edge_recon_loss: 254962.4977; train_gene_expr_recon_loss: 97651.6610; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356122.1738; train_optim_loss: 356122.1738; val_kl_reg_loss: 3474.8280; val_edge_recon_loss: 254889.5366; val_gene_expr_recon_loss: 98502.3153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356866.6808; val_optim_loss: 356866.6808
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9967; val_auprc_score: 0.9951; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 3506.5385; train_edge_recon_loss: 255031.8993; train_gene_expr_recon_loss: 97646.4824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356184.9208; train_optim_loss: 356184.9208; val_kl_reg_loss: 3475.1649; val_edge_recon_loss: 254881.5346; val_gene_expr_recon_loss: 98305.6402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356662.3381; val_optim_loss: 356662.3381
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9850; val_best_f1_score: 0.9851; train_kl_reg_loss: 3507.6454; train_edge_recon_loss: 254982.3953; train_gene_expr_recon_loss: 97581.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356071.8244; train_optim_loss: 356071.8244; val_kl_reg_loss: 3478.6415; val_edge_recon_loss: 254971.0190; val_gene_expr_recon_loss: 98533.7221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356983.3796; val_optim_loss: 356983.3796

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 22 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9963
Val AUPRC score: 0.9947
Val best accuracy score: 0.9824
Val best F1 score: 0.9826
Val gene expr MSE score: 0.5833
Duration of model training in run 5: 0 hours, 54 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 556218
Number of validation edges: 61801
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9845; val_auprc_score: 0.9769; val_best_acc_score: 0.9577; val_best_f1_score: 0.9588; train_kl_reg_loss: 3742.3779; train_edge_recon_loss: 263973.7721; train_gene_expr_recon_loss: 110015.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377731.6093; train_optim_loss: 377731.6093; val_kl_reg_loss: 3535.2218; val_edge_recon_loss: 257815.6060; val_gene_expr_recon_loss: 106374.1668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367724.9954; val_optim_loss: 367724.9954
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9885; val_auprc_score: 0.9835; val_best_acc_score: 0.9653; val_best_f1_score: 0.9660; train_kl_reg_loss: 3518.4921; train_edge_recon_loss: 257537.0805; train_gene_expr_recon_loss: 104816.4296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365872.0024; train_optim_loss: 365872.0024; val_kl_reg_loss: 3411.6719; val_edge_recon_loss: 256769.5049; val_gene_expr_recon_loss: 103558.9255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363740.0999; val_optim_loss: 363740.0999
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9898; val_auprc_score: 0.9853; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 3486.1675; train_edge_recon_loss: 256825.0515; train_gene_expr_recon_loss: 102961.9182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363273.1377; train_optim_loss: 363273.1377; val_kl_reg_loss: 3424.9372; val_edge_recon_loss: 256567.3069; val_gene_expr_recon_loss: 101766.0278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361758.2725; val_optim_loss: 361758.2725
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9917; val_auprc_score: 0.9879; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 3476.6759; train_edge_recon_loss: 256373.8292; train_gene_expr_recon_loss: 101660.6537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361511.1589; train_optim_loss: 361511.1589; val_kl_reg_loss: 3459.7107; val_edge_recon_loss: 256036.8609; val_gene_expr_recon_loss: 100992.7291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360489.3028; val_optim_loss: 360489.3028
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9926; val_auprc_score: 0.9900; val_best_acc_score: 0.9736; val_best_f1_score: 0.9740; train_kl_reg_loss: 3471.8317; train_edge_recon_loss: 256331.7430; train_gene_expr_recon_loss: 100703.4060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360506.9804; train_optim_loss: 360506.9804; val_kl_reg_loss: 3449.5598; val_edge_recon_loss: 256111.2385; val_gene_expr_recon_loss: 100389.8868; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359950.6865; val_optim_loss: 359950.6865
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9936; val_auprc_score: 0.9913; val_best_acc_score: 0.9751; val_best_f1_score: 0.9755; train_kl_reg_loss: 3468.7047; train_edge_recon_loss: 256159.2157; train_gene_expr_recon_loss: 100078.1981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359706.1189; train_optim_loss: 359706.1189; val_kl_reg_loss: 3359.7543; val_edge_recon_loss: 255905.9157; val_gene_expr_recon_loss: 99984.7225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359250.3955; val_optim_loss: 359250.3955
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9942; val_auprc_score: 0.9920; val_best_acc_score: 0.9766; val_best_f1_score: 0.9769; train_kl_reg_loss: 3471.7011; train_edge_recon_loss: 255891.6482; train_gene_expr_recon_loss: 99654.1934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359017.5416; train_optim_loss: 359017.5416; val_kl_reg_loss: 3406.9797; val_edge_recon_loss: 255766.0220; val_gene_expr_recon_loss: 99425.5225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358598.5256; val_optim_loss: 358598.5256
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9947; val_auprc_score: 0.9926; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 3473.7284; train_edge_recon_loss: 255870.9416; train_gene_expr_recon_loss: 99405.2014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358749.8713; train_optim_loss: 358749.8713; val_kl_reg_loss: 3449.2361; val_edge_recon_loss: 255626.3753; val_gene_expr_recon_loss: 99252.2150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358327.8263; val_optim_loss: 358327.8263
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9950; val_auprc_score: 0.9931; val_best_acc_score: 0.9789; val_best_f1_score: 0.9792; train_kl_reg_loss: 3474.6288; train_edge_recon_loss: 255867.8564; train_gene_expr_recon_loss: 99143.5203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358486.0051; train_optim_loss: 358486.0051; val_kl_reg_loss: 3498.2017; val_edge_recon_loss: 255562.7610; val_gene_expr_recon_loss: 98983.2792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358044.2428; val_optim_loss: 358044.2428
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9954; val_auprc_score: 0.9937; val_best_acc_score: 0.9811; val_best_f1_score: 0.9814; train_kl_reg_loss: 3480.2972; train_edge_recon_loss: 255738.9008; train_gene_expr_recon_loss: 98876.1641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358095.3627; train_optim_loss: 358095.3627; val_kl_reg_loss: 3448.3432; val_edge_recon_loss: 255134.8888; val_gene_expr_recon_loss: 98791.8697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357375.1019; val_optim_loss: 357375.1019
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9956; val_auprc_score: 0.9939; val_best_acc_score: 0.9809; val_best_f1_score: 0.9811; train_kl_reg_loss: 3485.6528; train_edge_recon_loss: 255641.5478; train_gene_expr_recon_loss: 98818.6457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357945.8460; train_optim_loss: 357945.8460; val_kl_reg_loss: 3370.3862; val_edge_recon_loss: 255326.5822; val_gene_expr_recon_loss: 98887.2426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357584.2095; val_optim_loss: 357584.2095
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9956; val_auprc_score: 0.9940; val_best_acc_score: 0.9817; val_best_f1_score: 0.9819; train_kl_reg_loss: 3489.9514; train_edge_recon_loss: 255525.7927; train_gene_expr_recon_loss: 98656.1408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357671.8850; train_optim_loss: 357671.8850; val_kl_reg_loss: 3463.5115; val_edge_recon_loss: 255656.6263; val_gene_expr_recon_loss: 98691.5465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357811.6844; val_optim_loss: 357811.6844
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9958; val_auprc_score: 0.9942; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 3496.3324; train_edge_recon_loss: 255431.4626; train_gene_expr_recon_loss: 98454.8671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357382.6621; train_optim_loss: 357382.6621; val_kl_reg_loss: 3451.8608; val_edge_recon_loss: 255348.6801; val_gene_expr_recon_loss: 98346.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357146.7474; val_optim_loss: 357146.7474
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9962; val_auprc_score: 0.9944; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 3498.9490; train_edge_recon_loss: 255333.9175; train_gene_expr_recon_loss: 98288.9419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357121.8088; train_optim_loss: 357121.8088; val_kl_reg_loss: 3438.0524; val_edge_recon_loss: 255302.3286; val_gene_expr_recon_loss: 98775.0287; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357515.4093; val_optim_loss: 357515.4093
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9963; val_auprc_score: 0.9948; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 3504.2555; train_edge_recon_loss: 255349.4167; train_gene_expr_recon_loss: 98342.6969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357196.3687; train_optim_loss: 357196.3687; val_kl_reg_loss: 3511.9320; val_edge_recon_loss: 255348.9198; val_gene_expr_recon_loss: 98698.4681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357559.3197; val_optim_loss: 357559.3197
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9966; val_auprc_score: 0.9955; val_best_acc_score: 0.9837; val_best_f1_score: 0.9839; train_kl_reg_loss: 3509.6357; train_edge_recon_loss: 255279.6646; train_gene_expr_recon_loss: 98218.5356; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357007.8359; train_optim_loss: 357007.8359; val_kl_reg_loss: 3475.3375; val_edge_recon_loss: 254915.9698; val_gene_expr_recon_loss: 98514.3111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356905.6168; val_optim_loss: 356905.6168
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9963; val_auprc_score: 0.9949; val_best_acc_score: 0.9839; val_best_f1_score: 0.9840; train_kl_reg_loss: 3514.5139; train_edge_recon_loss: 255226.6805; train_gene_expr_recon_loss: 97996.0613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356737.2553; train_optim_loss: 356737.2553; val_kl_reg_loss: 3569.2079; val_edge_recon_loss: 255151.7994; val_gene_expr_recon_loss: 98304.9294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357025.9349; val_optim_loss: 357025.9349
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9965; val_auprc_score: 0.9951; val_best_acc_score: 0.9846; val_best_f1_score: 0.9847; train_kl_reg_loss: 3520.2353; train_edge_recon_loss: 255225.2609; train_gene_expr_recon_loss: 97908.8342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356654.3308; train_optim_loss: 356654.3308; val_kl_reg_loss: 3506.0441; val_edge_recon_loss: 254912.3274; val_gene_expr_recon_loss: 98350.9953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356769.3668; val_optim_loss: 356769.3668
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9855; val_best_f1_score: 0.9856; train_kl_reg_loss: 3524.0585; train_edge_recon_loss: 255102.6639; train_gene_expr_recon_loss: 97862.6844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356489.4067; train_optim_loss: 356489.4067; val_kl_reg_loss: 3546.9827; val_edge_recon_loss: 254722.5169; val_gene_expr_recon_loss: 98423.0081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356692.5077; val_optim_loss: 356692.5077
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9968; val_auprc_score: 0.9958; val_best_acc_score: 0.9844; val_best_f1_score: 0.9845; train_kl_reg_loss: 3530.2679; train_edge_recon_loss: 255075.7292; train_gene_expr_recon_loss: 97749.2024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356355.1996; train_optim_loss: 356355.1996; val_kl_reg_loss: 3506.2163; val_edge_recon_loss: 255153.8192; val_gene_expr_recon_loss: 98593.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357253.6311; val_optim_loss: 357253.6311
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9969; val_auprc_score: 0.9955; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 3532.9768; train_edge_recon_loss: 255160.1890; train_gene_expr_recon_loss: 97838.7785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356531.9450; train_optim_loss: 356531.9450; val_kl_reg_loss: 3556.7387; val_edge_recon_loss: 254801.8445; val_gene_expr_recon_loss: 98467.4182; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356826.0036; val_optim_loss: 356826.0036
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9969; val_auprc_score: 0.9956; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 3539.5597; train_edge_recon_loss: 254986.2412; train_gene_expr_recon_loss: 97704.4741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356230.2760; train_optim_loss: 356230.2760; val_kl_reg_loss: 3519.8985; val_edge_recon_loss: 254769.2846; val_gene_expr_recon_loss: 98431.6606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356720.8448; val_optim_loss: 356720.8448

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 3542.1862; train_edge_recon_loss: 254938.9497; train_gene_expr_recon_loss: 97439.2789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355920.4150; train_optim_loss: 355920.4150; val_kl_reg_loss: 3514.8995; val_edge_recon_loss: 254909.1798; val_gene_expr_recon_loss: 98201.9129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356625.9944; val_optim_loss: 356625.9944
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 3537.1956; train_edge_recon_loss: 254916.2441; train_gene_expr_recon_loss: 97408.7479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355862.1872; train_optim_loss: 355862.1872; val_kl_reg_loss: 3513.6445; val_edge_recon_loss: 254764.4570; val_gene_expr_recon_loss: 98126.0706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356404.1721; val_optim_loss: 356404.1721
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 3536.4574; train_edge_recon_loss: 254880.7415; train_gene_expr_recon_loss: 97361.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355778.2791; train_optim_loss: 355778.2791; val_kl_reg_loss: 3509.0497; val_edge_recon_loss: 254797.1693; val_gene_expr_recon_loss: 98295.6838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356601.9006; val_optim_loss: 356601.9006
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9969; val_auprc_score: 0.9959; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 2827.1812; train_edge_recon_loss: 255326.8792; train_gene_expr_recon_loss: 97842.2928; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355996.3520; train_optim_loss: 355996.3520; val_kl_reg_loss: 2119.1025; val_edge_recon_loss: 255470.8128; val_gene_expr_recon_loss: 98565.6783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356155.5938; val_optim_loss: 356155.5938
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9971; val_auprc_score: 0.9959; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 2595.5083; train_edge_recon_loss: 255081.5926; train_gene_expr_recon_loss: 97675.5764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355352.6771; train_optim_loss: 355352.6771; val_kl_reg_loss: 2113.2406; val_edge_recon_loss: 255510.7582; val_gene_expr_recon_loss: 98594.3587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356218.3596; val_optim_loss: 356218.3596
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 2547.8836; train_edge_recon_loss: 255090.6893; train_gene_expr_recon_loss: 97519.8066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355158.3791; train_optim_loss: 355158.3791; val_kl_reg_loss: 2099.0089; val_edge_recon_loss: 255348.4634; val_gene_expr_recon_loss: 98407.7299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355855.2018; val_optim_loss: 355855.2018
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9970; val_auprc_score: 0.9961; val_best_acc_score: 0.9849; val_best_f1_score: 0.9851; train_kl_reg_loss: 2495.9055; train_edge_recon_loss: 255002.7891; train_gene_expr_recon_loss: 97641.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355140.1178; train_optim_loss: 355140.1178; val_kl_reg_loss: 2078.8918; val_edge_recon_loss: 255325.6337; val_gene_expr_recon_loss: 98613.2241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356017.7474; val_optim_loss: 356017.7474
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9973; val_auprc_score: 0.9963; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 2445.6135; train_edge_recon_loss: 254999.1657; train_gene_expr_recon_loss: 97571.1909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355015.9700; train_optim_loss: 355015.9700; val_kl_reg_loss: 2072.3149; val_edge_recon_loss: 255294.3245; val_gene_expr_recon_loss: 98568.1465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355934.7838; val_optim_loss: 355934.7838
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2390.9715; train_edge_recon_loss: 254952.8754; train_gene_expr_recon_loss: 97561.4229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354905.2699; train_optim_loss: 354905.2699; val_kl_reg_loss: 2053.2636; val_edge_recon_loss: 255155.1831; val_gene_expr_recon_loss: 98354.9242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355563.3709; val_optim_loss: 355563.3709
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9971; val_auprc_score: 0.9963; val_best_acc_score: 0.9854; val_best_f1_score: 0.9855; train_kl_reg_loss: 2333.4615; train_edge_recon_loss: 254943.0782; train_gene_expr_recon_loss: 97512.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354788.5956; train_optim_loss: 354788.5956; val_kl_reg_loss: 2037.3720; val_edge_recon_loss: 255288.4372; val_gene_expr_recon_loss: 98473.2495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355799.0589; val_optim_loss: 355799.0589
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 2281.9486; train_edge_recon_loss: 254794.1910; train_gene_expr_recon_loss: 97484.8089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354560.9492; train_optim_loss: 354560.9492; val_kl_reg_loss: 2041.7913; val_edge_recon_loss: 255338.3581; val_gene_expr_recon_loss: 98149.3617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355529.5102; val_optim_loss: 355529.5102
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9971; val_auprc_score: 0.9962; val_best_acc_score: 0.9852; val_best_f1_score: 0.9853; train_kl_reg_loss: 2231.1032; train_edge_recon_loss: 254865.8570; train_gene_expr_recon_loss: 97446.9435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354543.9045; train_optim_loss: 354543.9045; val_kl_reg_loss: 2033.9429; val_edge_recon_loss: 255276.2877; val_gene_expr_recon_loss: 98575.0907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355885.3197; val_optim_loss: 355885.3197
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2186.2498; train_edge_recon_loss: 254755.5959; train_gene_expr_recon_loss: 97442.0316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354383.8778; train_optim_loss: 354383.8778; val_kl_reg_loss: 2019.4626; val_edge_recon_loss: 255239.7510; val_gene_expr_recon_loss: 98353.2845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355612.4974; val_optim_loss: 355612.4974
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9854; val_best_f1_score: 0.9856; train_kl_reg_loss: 2147.5393; train_edge_recon_loss: 254753.0539; train_gene_expr_recon_loss: 97549.0172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354449.6102; train_optim_loss: 354449.6102; val_kl_reg_loss: 2016.7012; val_edge_recon_loss: 255027.0599; val_gene_expr_recon_loss: 98744.8864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355788.6470; val_optim_loss: 355788.6470

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2130.0788; train_edge_recon_loss: 254715.6882; train_gene_expr_recon_loss: 97486.4912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354332.2589; train_optim_loss: 354332.2589; val_kl_reg_loss: 2016.2531; val_edge_recon_loss: 254928.8655; val_gene_expr_recon_loss: 98431.1205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355376.2362; val_optim_loss: 355376.2362
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9973; val_auprc_score: 0.9964; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2125.6136; train_edge_recon_loss: 254794.9074; train_gene_expr_recon_loss: 97452.0920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354372.6126; train_optim_loss: 354372.6126; val_kl_reg_loss: 2010.2885; val_edge_recon_loss: 255099.0202; val_gene_expr_recon_loss: 98508.9000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355618.2080; val_optim_loss: 355618.2080
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9972; val_auprc_score: 0.9962; val_best_acc_score: 0.9859; val_best_f1_score: 0.9860; train_kl_reg_loss: 2121.2924; train_edge_recon_loss: 254809.6551; train_gene_expr_recon_loss: 97434.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354365.2430; train_optim_loss: 354365.2430; val_kl_reg_loss: 2010.3294; val_edge_recon_loss: 255073.9270; val_gene_expr_recon_loss: 98540.9346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355625.1921; val_optim_loss: 355625.1921
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9853; val_best_f1_score: 0.9854; train_kl_reg_loss: 2116.3721; train_edge_recon_loss: 254767.2573; train_gene_expr_recon_loss: 97405.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354289.0946; train_optim_loss: 354289.0946; val_kl_reg_loss: 2008.9650; val_edge_recon_loss: 255102.4972; val_gene_expr_recon_loss: 98659.0141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355770.4764; val_optim_loss: 355770.4764

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9971; val_auprc_score: 0.9958; val_best_acc_score: 0.9859; val_best_f1_score: 0.9861; train_kl_reg_loss: 2113.9255; train_edge_recon_loss: 254739.6892; train_gene_expr_recon_loss: 97495.0939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354348.7084; train_optim_loss: 354348.7084; val_kl_reg_loss: 2008.4854; val_edge_recon_loss: 255024.7731; val_gene_expr_recon_loss: 98525.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355558.6311; val_optim_loss: 355558.6311
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9971; val_auprc_score: 0.9960; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2113.8048; train_edge_recon_loss: 254820.2405; train_gene_expr_recon_loss: 97498.4773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354432.5224; train_optim_loss: 354432.5224; val_kl_reg_loss: 2008.7132; val_edge_recon_loss: 255113.4477; val_gene_expr_recon_loss: 98541.4419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355663.6019; val_optim_loss: 355663.6019
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9974; val_auprc_score: 0.9967; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 2112.9262; train_edge_recon_loss: 254757.4926; train_gene_expr_recon_loss: 97444.0214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354314.4401; train_optim_loss: 354314.4401; val_kl_reg_loss: 2008.5718; val_edge_recon_loss: 254861.8983; val_gene_expr_recon_loss: 98349.7597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355220.2295; val_optim_loss: 355220.2295
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9970; val_auprc_score: 0.9960; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2112.1239; train_edge_recon_loss: 254741.9812; train_gene_expr_recon_loss: 97470.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354324.2592; train_optim_loss: 354324.2592; val_kl_reg_loss: 2008.8536; val_edge_recon_loss: 255036.9360; val_gene_expr_recon_loss: 98682.9133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355728.7024; val_optim_loss: 355728.7024
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 2111.6993; train_edge_recon_loss: 254809.5822; train_gene_expr_recon_loss: 97436.8265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354358.1083; train_optim_loss: 354358.1083; val_kl_reg_loss: 2008.6901; val_edge_recon_loss: 254732.6194; val_gene_expr_recon_loss: 98436.4730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355177.7818; val_optim_loss: 355177.7818
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9972; val_auprc_score: 0.9963; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2110.7483; train_edge_recon_loss: 254764.8608; train_gene_expr_recon_loss: 97516.8690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354392.4792; train_optim_loss: 354392.4792; val_kl_reg_loss: 2008.7341; val_edge_recon_loss: 255092.5866; val_gene_expr_recon_loss: 98585.9256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355687.2439; val_optim_loss: 355687.2439
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2109.4796; train_edge_recon_loss: 254820.1636; train_gene_expr_recon_loss: 97437.9179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354367.5612; train_optim_loss: 354367.5612; val_kl_reg_loss: 2005.4712; val_edge_recon_loss: 254845.7451; val_gene_expr_recon_loss: 98492.2953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355343.5133; val_optim_loss: 355343.5133
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9856; val_best_f1_score: 0.9857; train_kl_reg_loss: 2108.2218; train_edge_recon_loss: 254731.3450; train_gene_expr_recon_loss: 97368.4925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354208.0600; train_optim_loss: 354208.0600; val_kl_reg_loss: 2006.2508; val_edge_recon_loss: 255073.5881; val_gene_expr_recon_loss: 98585.8099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355665.6496; val_optim_loss: 355665.6496

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9969; val_auprc_score: 0.9958; val_best_acc_score: 0.9857; val_best_f1_score: 0.9859; train_kl_reg_loss: 2107.6782; train_edge_recon_loss: 254818.1802; train_gene_expr_recon_loss: 97491.4338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354417.2922; train_optim_loss: 354417.2922; val_kl_reg_loss: 2005.8576; val_edge_recon_loss: 255065.2298; val_gene_expr_recon_loss: 98664.8571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355735.9431; val_optim_loss: 355735.9431
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9857; val_best_f1_score: 0.9858; train_kl_reg_loss: 2107.5671; train_edge_recon_loss: 254688.7681; train_gene_expr_recon_loss: 97385.4132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354181.7486; train_optim_loss: 354181.7486; val_kl_reg_loss: 2006.0352; val_edge_recon_loss: 255067.6406; val_gene_expr_recon_loss: 98664.6767; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355738.3550; val_optim_loss: 355738.3550
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9858; val_best_f1_score: 0.9859; train_kl_reg_loss: 2107.5245; train_edge_recon_loss: 254753.2061; train_gene_expr_recon_loss: 97357.1712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354217.9011; train_optim_loss: 354217.9011; val_kl_reg_loss: 2006.4961; val_edge_recon_loss: 254988.0461; val_gene_expr_recon_loss: 98543.5441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355538.0850; val_optim_loss: 355538.0850

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 128 min 0 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9972
Val AUPRC score: 0.9964
Val best accuracy score: 0.9853
Val best F1 score: 0.9854
Val gene expr MSE score: 0.6133
Duration of model training in run 6: 2 hours, 8 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9895; val_auprc_score: 0.9854; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 3590.5206; train_edge_recon_loss: 260487.2149; train_gene_expr_recon_loss: 108309.0555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372386.7918; train_optim_loss: 372386.7918; val_kl_reg_loss: 3415.4688; val_edge_recon_loss: 256361.7258; val_gene_expr_recon_loss: 104356.3508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364133.5461; val_optim_loss: 364133.5461
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9923; val_auprc_score: 0.9893; val_best_acc_score: 0.9729; val_best_f1_score: 0.9733; train_kl_reg_loss: 3471.7268; train_edge_recon_loss: 256631.9353; train_gene_expr_recon_loss: 102578.8670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362682.5294; train_optim_loss: 362682.5294; val_kl_reg_loss: 3402.2992; val_edge_recon_loss: 256009.3384; val_gene_expr_recon_loss: 101464.7234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360876.3609; val_optim_loss: 360876.3609
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9945; val_auprc_score: 0.9925; val_best_acc_score: 0.9769; val_best_f1_score: 0.9772; train_kl_reg_loss: 3462.2990; train_edge_recon_loss: 256101.3524; train_gene_expr_recon_loss: 100780.3108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360343.9624; train_optim_loss: 360343.9624; val_kl_reg_loss: 3459.6658; val_edge_recon_loss: 255624.8739; val_gene_expr_recon_loss: 100287.0345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359371.5746; val_optim_loss: 359371.5746
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9950; val_auprc_score: 0.9927; val_best_acc_score: 0.9791; val_best_f1_score: 0.9794; train_kl_reg_loss: 3463.9053; train_edge_recon_loss: 255781.0504; train_gene_expr_recon_loss: 99859.7870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359104.7431; train_optim_loss: 359104.7431; val_kl_reg_loss: 3393.8803; val_edge_recon_loss: 255520.7721; val_gene_expr_recon_loss: 99854.3774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358769.0307; val_optim_loss: 358769.0307
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9958; val_auprc_score: 0.9943; val_best_acc_score: 0.9821; val_best_f1_score: 0.9823; train_kl_reg_loss: 3464.2401; train_edge_recon_loss: 255679.5110; train_gene_expr_recon_loss: 99426.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358569.7657; train_optim_loss: 358569.7657; val_kl_reg_loss: 3482.8936; val_edge_recon_loss: 255001.4404; val_gene_expr_recon_loss: 99780.8975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358265.2311; val_optim_loss: 358265.2311
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9962; val_auprc_score: 0.9948; val_best_acc_score: 0.9830; val_best_f1_score: 0.9831; train_kl_reg_loss: 3468.4905; train_edge_recon_loss: 255407.9358; train_gene_expr_recon_loss: 99148.9895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358025.4159; train_optim_loss: 358025.4159; val_kl_reg_loss: 3446.6721; val_edge_recon_loss: 254954.1714; val_gene_expr_recon_loss: 99509.7640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357910.6066; val_optim_loss: 357910.6066
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9967; val_auprc_score: 0.9955; val_best_acc_score: 0.9837; val_best_f1_score: 0.9838; train_kl_reg_loss: 3470.6403; train_edge_recon_loss: 255228.4438; train_gene_expr_recon_loss: 99021.1967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357720.2811; train_optim_loss: 357720.2811; val_kl_reg_loss: 3474.5507; val_edge_recon_loss: 255082.4864; val_gene_expr_recon_loss: 99525.7105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358082.7467; val_optim_loss: 358082.7467
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9967; val_auprc_score: 0.9953; val_best_acc_score: 0.9847; val_best_f1_score: 0.9849; train_kl_reg_loss: 3476.2657; train_edge_recon_loss: 255177.0076; train_gene_expr_recon_loss: 98801.3992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357454.6721; train_optim_loss: 357454.6721; val_kl_reg_loss: 3481.8816; val_edge_recon_loss: 254653.3848; val_gene_expr_recon_loss: 99192.4709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357327.7373; val_optim_loss: 357327.7373
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9970; val_auprc_score: 0.9957; val_best_acc_score: 0.9861; val_best_f1_score: 0.9862; train_kl_reg_loss: 3480.2570; train_edge_recon_loss: 255108.7018; train_gene_expr_recon_loss: 98720.8962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357309.8554; train_optim_loss: 357309.8554; val_kl_reg_loss: 3460.7549; val_edge_recon_loss: 254649.5447; val_gene_expr_recon_loss: 99296.0622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357406.3629; val_optim_loss: 357406.3629
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9972; val_auprc_score: 0.9961; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 3484.4787; train_edge_recon_loss: 254912.6324; train_gene_expr_recon_loss: 98589.5011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356986.6121; train_optim_loss: 356986.6121; val_kl_reg_loss: 3423.5642; val_edge_recon_loss: 254661.2321; val_gene_expr_recon_loss: 99074.7514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357159.5461; val_optim_loss: 357159.5461
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9976; val_auprc_score: 0.9967; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 3489.8419; train_edge_recon_loss: 254890.1014; train_gene_expr_recon_loss: 98523.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356903.3309; train_optim_loss: 356903.3309; val_kl_reg_loss: 3479.2415; val_edge_recon_loss: 254529.9869; val_gene_expr_recon_loss: 99275.9164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357285.1453; val_optim_loss: 357285.1453
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 3493.4718; train_edge_recon_loss: 254843.8529; train_gene_expr_recon_loss: 98373.3661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356710.6907; train_optim_loss: 356710.6907; val_kl_reg_loss: 3472.7927; val_edge_recon_loss: 254585.4310; val_gene_expr_recon_loss: 99390.4092; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357448.6330; val_optim_loss: 357448.6330
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9881; val_best_f1_score: 0.9882; train_kl_reg_loss: 3500.7299; train_edge_recon_loss: 254720.2210; train_gene_expr_recon_loss: 98455.6329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356676.5840; train_optim_loss: 356676.5840; val_kl_reg_loss: 3499.7471; val_edge_recon_loss: 254484.0559; val_gene_expr_recon_loss: 98977.2259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356961.0283; val_optim_loss: 356961.0283
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9977; val_auprc_score: 0.9969; val_best_acc_score: 0.9878; val_best_f1_score: 0.9878; train_kl_reg_loss: 3504.8672; train_edge_recon_loss: 254737.6738; train_gene_expr_recon_loss: 98330.7677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356573.3086; train_optim_loss: 356573.3086; val_kl_reg_loss: 3514.7821; val_edge_recon_loss: 254397.3548; val_gene_expr_recon_loss: 99140.3978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357052.5348; val_optim_loss: 357052.5348
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 3508.7624; train_edge_recon_loss: 254658.7039; train_gene_expr_recon_loss: 98169.7018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356337.1681; train_optim_loss: 356337.1681; val_kl_reg_loss: 3524.4774; val_edge_recon_loss: 254480.7407; val_gene_expr_recon_loss: 98988.9896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356994.2074; val_optim_loss: 356994.2074
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 3513.6813; train_edge_recon_loss: 254617.5523; train_gene_expr_recon_loss: 98192.3226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356323.5558; train_optim_loss: 356323.5558; val_kl_reg_loss: 3494.8491; val_edge_recon_loss: 254465.0469; val_gene_expr_recon_loss: 99112.8682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357072.7637; val_optim_loss: 357072.7637

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9887; val_best_f1_score: 0.9888; train_kl_reg_loss: 3518.6311; train_edge_recon_loss: 254511.3606; train_gene_expr_recon_loss: 97792.9281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355822.9194; train_optim_loss: 355822.9194; val_kl_reg_loss: 3497.8168; val_edge_recon_loss: 254332.7804; val_gene_expr_recon_loss: 98841.4224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356672.0189; val_optim_loss: 356672.0189
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 3513.4863; train_edge_recon_loss: 254533.2780; train_gene_expr_recon_loss: 97787.9118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355834.6764; train_optim_loss: 355834.6764; val_kl_reg_loss: 3498.4966; val_edge_recon_loss: 254214.9491; val_gene_expr_recon_loss: 99076.9556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356790.4014; val_optim_loss: 356790.4014
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 3511.7003; train_edge_recon_loss: 254523.2271; train_gene_expr_recon_loss: 97778.4038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355813.3313; train_optim_loss: 355813.3313; val_kl_reg_loss: 3499.4742; val_edge_recon_loss: 254159.5476; val_gene_expr_recon_loss: 98939.6139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356598.6369; val_optim_loss: 356598.6369
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9894; val_best_f1_score: 0.9895; train_kl_reg_loss: 3509.0090; train_edge_recon_loss: 254498.3130; train_gene_expr_recon_loss: 97681.0219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355688.3436; train_optim_loss: 355688.3436; val_kl_reg_loss: 3497.3065; val_edge_recon_loss: 254084.2382; val_gene_expr_recon_loss: 99043.6397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356625.1848; val_optim_loss: 356625.1848
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 3510.1678; train_edge_recon_loss: 254436.0585; train_gene_expr_recon_loss: 97725.3191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355671.5453; train_optim_loss: 355671.5453; val_kl_reg_loss: 3496.0231; val_edge_recon_loss: 254175.4517; val_gene_expr_recon_loss: 99043.0375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356714.5141; val_optim_loss: 356714.5141
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9981; val_auprc_score: 0.9975; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 3509.7814; train_edge_recon_loss: 254459.9215; train_gene_expr_recon_loss: 97691.2098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355660.9135; train_optim_loss: 355660.9135; val_kl_reg_loss: 3485.2993; val_edge_recon_loss: 254175.4208; val_gene_expr_recon_loss: 98838.2964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356499.0180; val_optim_loss: 356499.0180
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9895; val_best_f1_score: 0.9896; train_kl_reg_loss: 3507.6649; train_edge_recon_loss: 254442.2621; train_gene_expr_recon_loss: 97703.0524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355652.9792; train_optim_loss: 355652.9792; val_kl_reg_loss: 3506.8345; val_edge_recon_loss: 254300.8912; val_gene_expr_recon_loss: 98982.6555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356790.3812; val_optim_loss: 356790.3812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 3507.9838; train_edge_recon_loss: 254486.1184; train_gene_expr_recon_loss: 97610.2388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355604.3411; train_optim_loss: 355604.3411; val_kl_reg_loss: 3496.0819; val_edge_recon_loss: 254045.8561; val_gene_expr_recon_loss: 99256.2376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356798.1748; val_optim_loss: 356798.1748
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 3508.8788; train_edge_recon_loss: 254461.9853; train_gene_expr_recon_loss: 97661.5669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355632.4313; train_optim_loss: 355632.4313; val_kl_reg_loss: 3501.1680; val_edge_recon_loss: 254375.7539; val_gene_expr_recon_loss: 98870.3478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356747.2687; val_optim_loss: 356747.2687

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9882; val_best_f1_score: 0.9883; train_kl_reg_loss: 3410.6825; train_edge_recon_loss: 255308.1823; train_gene_expr_recon_loss: 98797.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357516.1414; train_optim_loss: 357516.1414; val_kl_reg_loss: 2734.6157; val_edge_recon_loss: 254802.8160; val_gene_expr_recon_loss: 99742.5493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357279.9803; val_optim_loss: 357279.9803
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9979; val_auprc_score: 0.9971; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 3157.9564; train_edge_recon_loss: 255125.2132; train_gene_expr_recon_loss: 98538.4337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356821.6030; train_optim_loss: 356821.6030; val_kl_reg_loss: 2462.1756; val_edge_recon_loss: 254859.5912; val_gene_expr_recon_loss: 99602.6061; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356924.3730; val_optim_loss: 356924.3730
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9979; val_auprc_score: 0.9973; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 2890.7226; train_edge_recon_loss: 255064.4944; train_gene_expr_recon_loss: 98491.5322; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356446.7494; train_optim_loss: 356446.7494; val_kl_reg_loss: 2198.2734; val_edge_recon_loss: 255046.8493; val_gene_expr_recon_loss: 99780.7216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357025.8459; val_optim_loss: 357025.8459

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 150 min 58 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9965
Val best accuracy score: 0.9873
Val best F1 score: 0.9874
Val gene expr MSE score: 0.6470
Duration of model training in run 7: 2 hours, 32 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 735626
Number of validation edges: 81736
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9893; val_auprc_score: 0.9848; val_best_acc_score: 0.9655; val_best_f1_score: 0.9663; train_kl_reg_loss: 3588.2348; train_edge_recon_loss: 260498.4394; train_gene_expr_recon_loss: 107738.2190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371824.8935; train_optim_loss: 371824.8935; val_kl_reg_loss: 3445.9857; val_edge_recon_loss: 256408.3809; val_gene_expr_recon_loss: 102925.2067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362779.5713; val_optim_loss: 362779.5713
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9925; val_auprc_score: 0.9895; val_best_acc_score: 0.9735; val_best_f1_score: 0.9739; train_kl_reg_loss: 3478.3158; train_edge_recon_loss: 256527.9514; train_gene_expr_recon_loss: 102421.5613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362427.8284; train_optim_loss: 362427.8284; val_kl_reg_loss: 3454.6501; val_edge_recon_loss: 255845.5510; val_gene_expr_recon_loss: 100100.6144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359400.8143; val_optim_loss: 359400.8143
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9946; val_auprc_score: 0.9925; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 3464.9135; train_edge_recon_loss: 256089.6919; train_gene_expr_recon_loss: 100721.1677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360275.7731; train_optim_loss: 360275.7731; val_kl_reg_loss: 3393.2652; val_edge_recon_loss: 255415.3914; val_gene_expr_recon_loss: 99305.2959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358113.9512; val_optim_loss: 358113.9512
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9950; val_auprc_score: 0.9930; val_best_acc_score: 0.9793; val_best_f1_score: 0.9796; train_kl_reg_loss: 3464.2304; train_edge_recon_loss: 255819.6421; train_gene_expr_recon_loss: 99923.0202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359206.8924; train_optim_loss: 359206.8924; val_kl_reg_loss: 3425.9781; val_edge_recon_loss: 255624.5937; val_gene_expr_recon_loss: 98490.5643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357541.1365; val_optim_loss: 357541.1365
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9961; val_auprc_score: 0.9947; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 3466.5742; train_edge_recon_loss: 255555.0688; train_gene_expr_recon_loss: 99584.9083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358606.5517; train_optim_loss: 358606.5517; val_kl_reg_loss: 3458.7002; val_edge_recon_loss: 255066.4782; val_gene_expr_recon_loss: 98467.5155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356992.6934; val_optim_loss: 356992.6934
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9963; val_auprc_score: 0.9950; val_best_acc_score: 0.9828; val_best_f1_score: 0.9830; train_kl_reg_loss: 3469.7221; train_edge_recon_loss: 255383.5570; train_gene_expr_recon_loss: 99307.7887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358161.0675; train_optim_loss: 358161.0675; val_kl_reg_loss: 3403.9575; val_edge_recon_loss: 255111.7222; val_gene_expr_recon_loss: 98347.2610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356862.9414; val_optim_loss: 356862.9414
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9965; val_auprc_score: 0.9948; val_best_acc_score: 0.9838; val_best_f1_score: 0.9839; train_kl_reg_loss: 3474.2208; train_edge_recon_loss: 255237.7160; train_gene_expr_recon_loss: 99114.6359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357826.5728; train_optim_loss: 357826.5728; val_kl_reg_loss: 3448.3020; val_edge_recon_loss: 254928.7256; val_gene_expr_recon_loss: 97936.6680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356313.6953; val_optim_loss: 356313.6953
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9969; val_auprc_score: 0.9957; val_best_acc_score: 0.9848; val_best_f1_score: 0.9849; train_kl_reg_loss: 3477.6587; train_edge_recon_loss: 255124.8820; train_gene_expr_recon_loss: 98960.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357563.5204; train_optim_loss: 357563.5204; val_kl_reg_loss: 3512.6486; val_edge_recon_loss: 254652.9836; val_gene_expr_recon_loss: 98088.5832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356254.2156; val_optim_loss: 356254.2156
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9967; val_auprc_score: 0.9953; val_best_acc_score: 0.9849; val_best_f1_score: 0.9850; train_kl_reg_loss: 3479.3696; train_edge_recon_loss: 255057.3906; train_gene_expr_recon_loss: 98914.5743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357451.3350; train_optim_loss: 357451.3350; val_kl_reg_loss: 3491.1308; val_edge_recon_loss: 254884.6517; val_gene_expr_recon_loss: 97835.5538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356211.3359; val_optim_loss: 356211.3359
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9853; val_best_f1_score: 0.9855; train_kl_reg_loss: 3485.0946; train_edge_recon_loss: 255002.5951; train_gene_expr_recon_loss: 98778.7933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357266.4830; train_optim_loss: 357266.4830; val_kl_reg_loss: 3477.1256; val_edge_recon_loss: 254752.7968; val_gene_expr_recon_loss: 97937.3128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356167.2340; val_optim_loss: 356167.2340
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9975; val_auprc_score: 0.9966; val_best_acc_score: 0.9865; val_best_f1_score: 0.9866; train_kl_reg_loss: 3490.0760; train_edge_recon_loss: 254854.8498; train_gene_expr_recon_loss: 98745.1651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357090.0912; train_optim_loss: 357090.0912; val_kl_reg_loss: 3445.4682; val_edge_recon_loss: 254621.2104; val_gene_expr_recon_loss: 98138.2547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356204.9330; val_optim_loss: 356204.9330
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9973; val_auprc_score: 0.9959; val_best_acc_score: 0.9871; val_best_f1_score: 0.9872; train_kl_reg_loss: 3494.1837; train_edge_recon_loss: 254836.4786; train_gene_expr_recon_loss: 98568.9056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356899.5678; train_optim_loss: 356899.5678; val_kl_reg_loss: 3461.4336; val_edge_recon_loss: 254387.3581; val_gene_expr_recon_loss: 97830.1811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355678.9729; val_optim_loss: 355678.9729
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9973; val_auprc_score: 0.9962; val_best_acc_score: 0.9873; val_best_f1_score: 0.9874; train_kl_reg_loss: 3500.0783; train_edge_recon_loss: 254763.6302; train_gene_expr_recon_loss: 98485.9876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356749.6960; train_optim_loss: 356749.6960; val_kl_reg_loss: 3459.1340; val_edge_recon_loss: 254345.9337; val_gene_expr_recon_loss: 97744.7291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355549.7971; val_optim_loss: 355549.7971
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9975; val_auprc_score: 0.9965; val_best_acc_score: 0.9879; val_best_f1_score: 0.9880; train_kl_reg_loss: 3504.1831; train_edge_recon_loss: 254768.9104; train_gene_expr_recon_loss: 98398.6514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356671.7448; train_optim_loss: 356671.7448; val_kl_reg_loss: 3475.6781; val_edge_recon_loss: 254507.0773; val_gene_expr_recon_loss: 97868.1981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355850.9545; val_optim_loss: 355850.9545
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9978; val_auprc_score: 0.9970; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 3509.2093; train_edge_recon_loss: 254730.8188; train_gene_expr_recon_loss: 98239.6907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356479.7191; train_optim_loss: 356479.7191; val_kl_reg_loss: 3546.6861; val_edge_recon_loss: 254361.5253; val_gene_expr_recon_loss: 97848.4225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355756.6352; val_optim_loss: 355756.6352
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9977; val_auprc_score: 0.9968; val_best_acc_score: 0.9884; val_best_f1_score: 0.9885; train_kl_reg_loss: 3516.2002; train_edge_recon_loss: 254643.8612; train_gene_expr_recon_loss: 98370.4033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356530.4648; train_optim_loss: 356530.4648; val_kl_reg_loss: 3570.8260; val_edge_recon_loss: 254354.4449; val_gene_expr_recon_loss: 97943.1926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355868.4625; val_optim_loss: 355868.4625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9888; val_best_f1_score: 0.9889; train_kl_reg_loss: 3519.2917; train_edge_recon_loss: 254507.4662; train_gene_expr_recon_loss: 97977.0013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356003.7592; train_optim_loss: 356003.7592; val_kl_reg_loss: 3501.8108; val_edge_recon_loss: 254229.5636; val_gene_expr_recon_loss: 97476.5732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355207.9480; val_optim_loss: 355207.9480
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 3515.3119; train_edge_recon_loss: 254542.8373; train_gene_expr_recon_loss: 97914.6890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355972.8385; train_optim_loss: 355972.8385; val_kl_reg_loss: 3494.9537; val_edge_recon_loss: 254142.1701; val_gene_expr_recon_loss: 97690.3628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355327.4871; val_optim_loss: 355327.4871
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9980; val_auprc_score: 0.9972; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 3510.9126; train_edge_recon_loss: 254506.9261; train_gene_expr_recon_loss: 97900.4854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355918.3241; train_optim_loss: 355918.3241; val_kl_reg_loss: 3486.5866; val_edge_recon_loss: 254243.4937; val_gene_expr_recon_loss: 97526.8248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355256.9047; val_optim_loss: 355256.9047
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9892; val_best_f1_score: 0.9893; train_kl_reg_loss: 3509.8828; train_edge_recon_loss: 254554.8053; train_gene_expr_recon_loss: 97906.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355971.1147; train_optim_loss: 355971.1147; val_kl_reg_loss: 3491.3448; val_edge_recon_loss: 254061.0703; val_gene_expr_recon_loss: 97557.6304; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355110.0445; val_optim_loss: 355110.0445
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9897; val_best_f1_score: 0.9898; train_kl_reg_loss: 3509.8806; train_edge_recon_loss: 254516.1569; train_gene_expr_recon_loss: 97897.1863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355923.2234; train_optim_loss: 355923.2234; val_kl_reg_loss: 3490.9328; val_edge_recon_loss: 254120.9288; val_gene_expr_recon_loss: 97724.7458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355336.6078; val_optim_loss: 355336.6078
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9891; val_best_f1_score: 0.9892; train_kl_reg_loss: 3509.3246; train_edge_recon_loss: 254458.1725; train_gene_expr_recon_loss: 97843.7496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355811.2463; train_optim_loss: 355811.2463; val_kl_reg_loss: 3490.4028; val_edge_recon_loss: 254393.9851; val_gene_expr_recon_loss: 97618.3787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355502.7670; val_optim_loss: 355502.7670
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9982; val_auprc_score: 0.9976; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 3508.5320; train_edge_recon_loss: 254460.1668; train_gene_expr_recon_loss: 97894.1975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355862.8962; train_optim_loss: 355862.8962; val_kl_reg_loss: 3479.4739; val_edge_recon_loss: 254072.4705; val_gene_expr_recon_loss: 97576.3773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355128.3211; val_optim_loss: 355128.3211

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9980; val_auprc_score: 0.9973; val_best_acc_score: 0.9893; val_best_f1_score: 0.9894; train_kl_reg_loss: 3510.3887; train_edge_recon_loss: 254472.5843; train_gene_expr_recon_loss: 97744.4106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355727.3836; train_optim_loss: 355727.3836; val_kl_reg_loss: 3498.9517; val_edge_recon_loss: 254164.9482; val_gene_expr_recon_loss: 97786.2967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355450.1959; val_optim_loss: 355450.1959
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9981; val_auprc_score: 0.9974; val_best_acc_score: 0.9896; val_best_f1_score: 0.9897; train_kl_reg_loss: 3510.6277; train_edge_recon_loss: 254480.7685; train_gene_expr_recon_loss: 97779.7329; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355771.1294; train_optim_loss: 355771.1294; val_kl_reg_loss: 3490.3558; val_edge_recon_loss: 254170.4307; val_gene_expr_recon_loss: 97606.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355267.3340; val_optim_loss: 355267.3340
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9978; val_auprc_score: 0.9969; val_best_acc_score: 0.9878; val_best_f1_score: 0.9879; train_kl_reg_loss: 3428.9762; train_edge_recon_loss: 255190.6445; train_gene_expr_recon_loss: 98823.7745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357443.3949; train_optim_loss: 357443.3949; val_kl_reg_loss: 2766.8497; val_edge_recon_loss: 254910.6031; val_gene_expr_recon_loss: 98537.0702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356214.5229; val_optim_loss: 356214.5229

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 137 min 25 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9976
Val AUPRC score: 0.9968
Val best accuracy score: 0.9870
Val best F1 score: 0.9871
Val gene expr MSE score: 0.6109
Duration of model training in run 8: 2 hours, 18 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9914; val_auprc_score: 0.9879; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 3530.6944; train_edge_recon_loss: 258724.6965; train_gene_expr_recon_loss: 105524.4903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367779.8813; train_optim_loss: 367779.8813; val_kl_reg_loss: 3423.6673; val_edge_recon_loss: 256059.1115; val_gene_expr_recon_loss: 102103.6758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361586.4532; val_optim_loss: 361586.4532
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9948; val_auprc_score: 0.9930; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 3459.5680; train_edge_recon_loss: 256007.6296; train_gene_expr_recon_loss: 100643.2004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360110.3979; train_optim_loss: 360110.3979; val_kl_reg_loss: 3514.3890; val_edge_recon_loss: 255464.3092; val_gene_expr_recon_loss: 100608.8427; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359587.5408; val_optim_loss: 359587.5408
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9957; val_auprc_score: 0.9941; val_best_acc_score: 0.9814; val_best_f1_score: 0.9816; train_kl_reg_loss: 3458.8685; train_edge_recon_loss: 255534.7932; train_gene_expr_recon_loss: 99817.1691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358810.8309; train_optim_loss: 358810.8309; val_kl_reg_loss: 3488.6192; val_edge_recon_loss: 255114.8731; val_gene_expr_recon_loss: 100209.7330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358813.2256; val_optim_loss: 358813.2256
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9966; val_auprc_score: 0.9953; val_best_acc_score: 0.9843; val_best_f1_score: 0.9844; train_kl_reg_loss: 3460.3079; train_edge_recon_loss: 255268.5617; train_gene_expr_recon_loss: 99462.4278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358191.2972; train_optim_loss: 358191.2972; val_kl_reg_loss: 3478.5089; val_edge_recon_loss: 254766.2105; val_gene_expr_recon_loss: 99928.4326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358173.1523; val_optim_loss: 358173.1523
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9968; val_auprc_score: 0.9955; val_best_acc_score: 0.9855; val_best_f1_score: 0.9857; train_kl_reg_loss: 3460.5172; train_edge_recon_loss: 255068.9567; train_gene_expr_recon_loss: 98485.1588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357014.6328; train_optim_loss: 357014.6328; val_kl_reg_loss: 3510.3482; val_edge_recon_loss: 254436.4105; val_gene_expr_recon_loss: 96566.0527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354512.8106; val_optim_loss: 354512.8106
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9972; val_auprc_score: 0.9960; val_best_acc_score: 0.9868; val_best_f1_score: 0.9869; train_kl_reg_loss: 3465.0232; train_edge_recon_loss: 254935.9065; train_gene_expr_recon_loss: 93609.7361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352010.6658; train_optim_loss: 352010.6658; val_kl_reg_loss: 3444.8172; val_edge_recon_loss: 254205.0256; val_gene_expr_recon_loss: 92575.0495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350224.8918; val_optim_loss: 350224.8918
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9976; val_auprc_score: 0.9966; val_best_acc_score: 0.9874; val_best_f1_score: 0.9875; train_kl_reg_loss: 3469.2127; train_edge_recon_loss: 254847.5869; train_gene_expr_recon_loss: 87880.8875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346197.6876; train_optim_loss: 346197.6876; val_kl_reg_loss: 3447.8812; val_edge_recon_loss: 254409.8440; val_gene_expr_recon_loss: 88576.4949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346434.2202; val_optim_loss: 346434.2202
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9974; val_auprc_score: 0.9964; val_best_acc_score: 0.9880; val_best_f1_score: 0.9881; train_kl_reg_loss: 3473.3940; train_edge_recon_loss: 254705.5119; train_gene_expr_recon_loss: 84834.7541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 343013.6598; train_optim_loss: 343013.6598; val_kl_reg_loss: 3441.7689; val_edge_recon_loss: 254290.8269; val_gene_expr_recon_loss: 77928.7026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335661.2982; val_optim_loss: 335661.2982
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9977; val_auprc_score: 0.9966; val_best_acc_score: 0.9883; val_best_f1_score: 0.9884; train_kl_reg_loss: 3477.2799; train_edge_recon_loss: 254670.2195; train_gene_expr_recon_loss: 84352.6461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342500.1455; train_optim_loss: 342500.1455; val_kl_reg_loss: 3474.7309; val_edge_recon_loss: 254297.7081; val_gene_expr_recon_loss: 85245.7623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 343018.2016; val_optim_loss: 343018.2016
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9979; val_auprc_score: 0.9970; val_best_acc_score: 0.9889; val_best_f1_score: 0.9890; train_kl_reg_loss: 3483.0792; train_edge_recon_loss: 254589.7851; train_gene_expr_recon_loss: 84283.8116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342356.6757; train_optim_loss: 342356.6757; val_kl_reg_loss: 3452.5941; val_edge_recon_loss: 254213.7715; val_gene_expr_recon_loss: 85122.7307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342789.0969; val_optim_loss: 342789.0969
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9980; val_auprc_score: 0.9974; val_best_acc_score: 0.9898; val_best_f1_score: 0.9898; train_kl_reg_loss: 3488.4780; train_edge_recon_loss: 254520.9778; train_gene_expr_recon_loss: 84192.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342201.4702; train_optim_loss: 342201.4702; val_kl_reg_loss: 3419.0616; val_edge_recon_loss: 254072.4401; val_gene_expr_recon_loss: 82332.4498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339823.9508; val_optim_loss: 339823.9508

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9904; val_best_f1_score: 0.9904; train_kl_reg_loss: 3487.1301; train_edge_recon_loss: 254369.8282; train_gene_expr_recon_loss: 84001.3562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341858.3144; train_optim_loss: 341858.3144; val_kl_reg_loss: 3488.0076; val_edge_recon_loss: 253952.1799; val_gene_expr_recon_loss: 84027.7748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341467.9622; val_optim_loss: 341467.9622
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9981; val_auprc_score: 0.9973; val_best_acc_score: 0.9902; val_best_f1_score: 0.9903; train_kl_reg_loss: 3484.1435; train_edge_recon_loss: 254359.0269; train_gene_expr_recon_loss: 83835.1997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341678.3706; train_optim_loss: 341678.3706; val_kl_reg_loss: 3451.7046; val_edge_recon_loss: 253955.9889; val_gene_expr_recon_loss: 87979.5322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345387.2261; val_optim_loss: 345387.2261
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9983; val_auprc_score: 0.9977; val_best_acc_score: 0.9911; val_best_f1_score: 0.9912; train_kl_reg_loss: 3480.2714; train_edge_recon_loss: 254360.2684; train_gene_expr_recon_loss: 83933.0725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341773.6124; train_optim_loss: 341773.6124; val_kl_reg_loss: 3461.3124; val_edge_recon_loss: 253904.7646; val_gene_expr_recon_loss: 92023.8885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349389.9658; val_optim_loss: 349389.9658

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 149 min 27 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9959
Val best accuracy score: 0.9862
Val best F1 score: 0.9863
Val gene expr MSE score: 0.6263
Duration of model training in run 9: 2 hours, 32 minutes and 45 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 915209
Number of validation edges: 101689
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9921; val_auprc_score: 0.9889; val_best_acc_score: 0.9723; val_best_f1_score: 0.9728; train_kl_reg_loss: 3525.6974; train_edge_recon_loss: 258741.2092; train_gene_expr_recon_loss: 105753.8121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368020.7186; train_optim_loss: 368020.7186; val_kl_reg_loss: 3488.6041; val_edge_recon_loss: 256251.1499; val_gene_expr_recon_loss: 101864.2039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361603.9584; val_optim_loss: 361603.9584
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9955; val_auprc_score: 0.9939; val_best_acc_score: 0.9804; val_best_f1_score: 0.9806; train_kl_reg_loss: 3464.5669; train_edge_recon_loss: 256081.0228; train_gene_expr_recon_loss: 100752.4158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360298.0058; train_optim_loss: 360298.0058; val_kl_reg_loss: 3396.9919; val_edge_recon_loss: 255193.8033; val_gene_expr_recon_loss: 100378.1150; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358968.9110; val_optim_loss: 358968.9110
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9960; val_auprc_score: 0.9945; val_best_acc_score: 0.9827; val_best_f1_score: 0.9829; train_kl_reg_loss: 3463.3486; train_edge_recon_loss: 255519.0203; train_gene_expr_recon_loss: 99859.3518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358841.7208; train_optim_loss: 358841.7208; val_kl_reg_loss: 3439.6950; val_edge_recon_loss: 254803.8770; val_gene_expr_recon_loss: 99874.6189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358118.1906; val_optim_loss: 358118.1906
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9965; val_auprc_score: 0.9951; val_best_acc_score: 0.9846; val_best_f1_score: 0.9848; train_kl_reg_loss: 3461.5392; train_edge_recon_loss: 255203.0054; train_gene_expr_recon_loss: 99467.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358132.0104; train_optim_loss: 358132.0104; val_kl_reg_loss: 3434.9494; val_edge_recon_loss: 254543.4328; val_gene_expr_recon_loss: 99535.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357513.7605; val_optim_loss: 357513.7605
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9970; val_auprc_score: 0.9958; val_best_acc_score: 0.9860; val_best_f1_score: 0.9861; train_kl_reg_loss: 3463.3657; train_edge_recon_loss: 255087.2732; train_gene_expr_recon_loss: 98463.3944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357014.0333; train_optim_loss: 357014.0333; val_kl_reg_loss: 3427.9105; val_edge_recon_loss: 254473.8525; val_gene_expr_recon_loss: 99552.5158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357454.2784; val_optim_loss: 357454.2784
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9973; val_auprc_score: 0.9961; val_best_acc_score: 0.9872; val_best_f1_score: 0.9873; train_kl_reg_loss: 3467.4204; train_edge_recon_loss: 254905.5910; train_gene_expr_recon_loss: 93734.7660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352107.7774; train_optim_loss: 352107.7774; val_kl_reg_loss: 3489.8896; val_edge_recon_loss: 254529.9035; val_gene_expr_recon_loss: 89535.1417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347554.9345; val_optim_loss: 347554.9345
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9974; val_auprc_score: 0.9962; val_best_acc_score: 0.9877; val_best_f1_score: 0.9878; train_kl_reg_loss: 3467.7098; train_edge_recon_loss: 254897.7138; train_gene_expr_recon_loss: 87369.9003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345735.3239; train_optim_loss: 345735.3239; val_kl_reg_loss: 3420.6728; val_edge_recon_loss: 254352.2951; val_gene_expr_recon_loss: 74745.4498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332518.4176; val_optim_loss: 332518.4176
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9976; val_auprc_score: 0.9968; val_best_acc_score: 0.9886; val_best_f1_score: 0.9887; train_kl_reg_loss: 3474.2643; train_edge_recon_loss: 254706.7554; train_gene_expr_recon_loss: 84770.7350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342951.7545; train_optim_loss: 342951.7545; val_kl_reg_loss: 3469.6256; val_edge_recon_loss: 254169.0694; val_gene_expr_recon_loss: 84853.4802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342492.1752; val_optim_loss: 342492.1752
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9979; val_auprc_score: 0.9972; val_best_acc_score: 0.9894; val_best_f1_score: 0.9894; train_kl_reg_loss: 3477.2428; train_edge_recon_loss: 254669.1338; train_gene_expr_recon_loss: 84409.4876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342555.8642; train_optim_loss: 342555.8642; val_kl_reg_loss: 3444.9437; val_edge_recon_loss: 254135.7307; val_gene_expr_recon_loss: 85020.9289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342601.6040; val_optim_loss: 342601.6040
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9982; val_auprc_score: 0.9974; val_best_acc_score: 0.9902; val_best_f1_score: 0.9903; train_kl_reg_loss: 3484.5547; train_edge_recon_loss: 254539.8983; train_gene_expr_recon_loss: 84283.3219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342307.7750; train_optim_loss: 342307.7750; val_kl_reg_loss: 3472.9846; val_edge_recon_loss: 254095.1520; val_gene_expr_recon_loss: 84842.3643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342410.5012; val_optim_loss: 342410.5012

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9981; val_auprc_score: 0.9971; val_best_acc_score: 0.9905; val_best_f1_score: 0.9905; train_kl_reg_loss: 3481.4014; train_edge_recon_loss: 254449.9501; train_gene_expr_recon_loss: 83960.8070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341892.1584; train_optim_loss: 341892.1584; val_kl_reg_loss: 3469.9453; val_edge_recon_loss: 254040.9053; val_gene_expr_recon_loss: 84697.3356; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342208.1859; val_optim_loss: 342208.1859
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9980; val_auprc_score: 0.9971; val_best_acc_score: 0.9907; val_best_f1_score: 0.9907; train_kl_reg_loss: 3476.5128; train_edge_recon_loss: 254391.3708; train_gene_expr_recon_loss: 83902.9362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341770.8196; train_optim_loss: 341770.8196; val_kl_reg_loss: 3463.6917; val_edge_recon_loss: 253942.5557; val_gene_expr_recon_loss: 84694.9533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342101.2000; val_optim_loss: 342101.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9982; val_auprc_score: 0.9975; val_best_acc_score: 0.9908; val_best_f1_score: 0.9908; train_kl_reg_loss: 3474.0516; train_edge_recon_loss: 254411.9390; train_gene_expr_recon_loss: 83878.4189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341764.4093; train_optim_loss: 341764.4093; val_kl_reg_loss: 3462.4236; val_edge_recon_loss: 253854.3266; val_gene_expr_recon_loss: 84661.8990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341978.6493; val_optim_loss: 341978.6493

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 137 min 4 sec.
Using best model state, which was in epoch 7.

--- MODEL EVALUATION ---
Val AUROC score: 0.9970
Val AUPRC score: 0.9960
Val best accuracy score: 0.9860
Val best F1 score: 0.9861
Val gene expr MSE score: 0.5915
Duration of model training in run 10: 2 hours, 20 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
