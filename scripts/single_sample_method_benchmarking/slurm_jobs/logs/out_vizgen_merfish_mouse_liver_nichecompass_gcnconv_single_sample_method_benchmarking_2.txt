Run timestamp: 18082023_171011_2.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '8', '4', '4', '--edge_batch_size_list', '4096', '4096', '4096', '--node_batch_size_list', 'None', 'None', 'None', '--seeds', '2', '1', '0', '--run_index', '3', '2', '1', '--cell_type_key', 'Cell_Type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'vizgen_merfish_mouse_liver', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 347, n_cat_covariates_embed_input: 0, n_hidden: 347, n_latent: 1378, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347

--- INITIALIZING TRAINER ---
Number of training nodes: 330601
Number of validation nodes: 36734
Number of training edges: 1470868
Number of validation edges: 163429
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8387; val_auprc_score: 0.8090; val_best_acc_score: 0.7597; val_best_f1_score: 0.7911; train_kl_reg_loss: 45569.5885; train_edge_recon_loss: 3205312.3444; train_gene_expr_recon_loss: 2849983.1083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6100865.0250; train_optim_loss: 6100865.0250; val_kl_reg_loss: 55245.9996; val_edge_recon_loss: 2908454.6313; val_gene_expr_recon_loss: 2582192.4750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5545893.1125; val_optim_loss: 5545893.1125
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9156; val_auprc_score: 0.8941; val_best_acc_score: 0.8432; val_best_f1_score: 0.8551; train_kl_reg_loss: 48006.7517; train_edge_recon_loss: 2802888.6924; train_gene_expr_recon_loss: 2527396.8049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5378292.2458; train_optim_loss: 5378292.2458; val_kl_reg_loss: 42791.1054; val_edge_recon_loss: 2788324.1812; val_gene_expr_recon_loss: 2470696.9562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5301812.2625; val_optim_loss: 5301812.2625
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9276; val_auprc_score: 0.9095; val_best_acc_score: 0.8576; val_best_f1_score: 0.8677; train_kl_reg_loss: 41345.0505; train_edge_recon_loss: 2735757.8174; train_gene_expr_recon_loss: 2433181.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5210284.3097; train_optim_loss: 5210284.3097; val_kl_reg_loss: 38229.0069; val_edge_recon_loss: 2766649.4188; val_gene_expr_recon_loss: 2395406.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5200284.5125; val_optim_loss: 5200284.5125
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9428; val_auprc_score: 0.9296; val_best_acc_score: 0.8753; val_best_f1_score: 0.8822; train_kl_reg_loss: 36543.6665; train_edge_recon_loss: 2715975.0819; train_gene_expr_recon_loss: 2364024.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5116543.5167; train_optim_loss: 5116543.5167; val_kl_reg_loss: 33760.7729; val_edge_recon_loss: 2741642.4250; val_gene_expr_recon_loss: 2338000.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5113404.0125; val_optim_loss: 5113404.0125
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9482; val_auprc_score: 0.9363; val_best_acc_score: 0.8836; val_best_f1_score: 0.8893; train_kl_reg_loss: 33688.4993; train_edge_recon_loss: 2698106.4674; train_gene_expr_recon_loss: 2309658.2111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5041453.1847; train_optim_loss: 5041453.1847; val_kl_reg_loss: 32501.7050; val_edge_recon_loss: 2729118.1313; val_gene_expr_recon_loss: 2287146.8937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5048766.7125; val_optim_loss: 5048766.7125
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9536; val_auprc_score: 0.9432; val_best_acc_score: 0.8907; val_best_f1_score: 0.8957; train_kl_reg_loss: 31756.3808; train_edge_recon_loss: 2689351.8181; train_gene_expr_recon_loss: 2265974.4347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4987082.6361; train_optim_loss: 4987082.6361; val_kl_reg_loss: 29956.4094; val_edge_recon_loss: 2722726.3937; val_gene_expr_recon_loss: 2244676.7313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4997359.5375; val_optim_loss: 4997359.5375
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9559; val_auprc_score: 0.9464; val_best_acc_score: 0.8937; val_best_f1_score: 0.8984; train_kl_reg_loss: 29761.4952; train_edge_recon_loss: 2681454.3306; train_gene_expr_recon_loss: 2230554.0583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4941769.8917; train_optim_loss: 4941769.8917; val_kl_reg_loss: 28674.0774; val_edge_recon_loss: 2711005.6125; val_gene_expr_recon_loss: 2212659.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4952339.5500; val_optim_loss: 4952339.5500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9584; val_auprc_score: 0.9499; val_best_acc_score: 0.8967; val_best_f1_score: 0.9010; train_kl_reg_loss: 27955.8153; train_edge_recon_loss: 2674478.1681; train_gene_expr_recon_loss: 2200702.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4903136.8431; train_optim_loss: 4903136.8431; val_kl_reg_loss: 26926.3649; val_edge_recon_loss: 2709499.2125; val_gene_expr_recon_loss: 2190319.6375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4926745.2250; val_optim_loss: 4926745.2250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9605; val_auprc_score: 0.9521; val_best_acc_score: 0.9005; val_best_f1_score: 0.9043; train_kl_reg_loss: 27015.9953; train_edge_recon_loss: 2669622.0764; train_gene_expr_recon_loss: 2177320.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4873958.8667; train_optim_loss: 4873958.8667; val_kl_reg_loss: 26009.3485; val_edge_recon_loss: 2705855.1125; val_gene_expr_recon_loss: 2164180.2687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4896044.7250; val_optim_loss: 4896044.7250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9601; val_auprc_score: 0.9514; val_best_acc_score: 0.8999; val_best_f1_score: 0.9039; train_kl_reg_loss: 26154.7503; train_edge_recon_loss: 2665804.9514; train_gene_expr_recon_loss: 2156209.9639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4848169.6472; train_optim_loss: 4848169.6472; val_kl_reg_loss: 25382.7741; val_edge_recon_loss: 2699087.2125; val_gene_expr_recon_loss: 2145697.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4870167.5625; val_optim_loss: 4870167.5625
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9605; val_auprc_score: 0.9523; val_best_acc_score: 0.9000; val_best_f1_score: 0.9040; train_kl_reg_loss: 25190.9551; train_edge_recon_loss: 2663197.3285; train_gene_expr_recon_loss: 2140101.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4828489.8819; train_optim_loss: 4828489.8819; val_kl_reg_loss: 24289.2999; val_edge_recon_loss: 2699494.0500; val_gene_expr_recon_loss: 2132313.7938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4856097.1750; val_optim_loss: 4856097.1750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9617; val_auprc_score: 0.9537; val_best_acc_score: 0.9024; val_best_f1_score: 0.9061; train_kl_reg_loss: 24332.6025; train_edge_recon_loss: 2661688.3375; train_gene_expr_recon_loss: 2125463.9337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4811484.8583; train_optim_loss: 4811484.8583; val_kl_reg_loss: 23331.9725; val_edge_recon_loss: 2697395.7375; val_gene_expr_recon_loss: 2119071.0187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4839798.7125; val_optim_loss: 4839798.7125
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9618; val_auprc_score: 0.9540; val_best_acc_score: 0.9023; val_best_f1_score: 0.9061; train_kl_reg_loss: 23536.8867; train_edge_recon_loss: 2658674.8993; train_gene_expr_recon_loss: 2113814.5507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4796026.3444; train_optim_loss: 4796026.3444; val_kl_reg_loss: 22661.2181; val_edge_recon_loss: 2694495.7812; val_gene_expr_recon_loss: 2108205.7281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4825362.7000; val_optim_loss: 4825362.7000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9632; val_auprc_score: 0.9554; val_best_acc_score: 0.9045; val_best_f1_score: 0.9079; train_kl_reg_loss: 22838.1373; train_edge_recon_loss: 2656834.7590; train_gene_expr_recon_loss: 2103156.1215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4782829.0208; train_optim_loss: 4782829.0208; val_kl_reg_loss: 21976.3783; val_edge_recon_loss: 2699610.4312; val_gene_expr_recon_loss: 2102188.9125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4823775.7000; val_optim_loss: 4823775.7000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9639; val_auprc_score: 0.9563; val_best_acc_score: 0.9053; val_best_f1_score: 0.9086; train_kl_reg_loss: 22071.9480; train_edge_recon_loss: 2655720.3882; train_gene_expr_recon_loss: 2095657.2233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4773449.5514; train_optim_loss: 4773449.5514; val_kl_reg_loss: 21663.9282; val_edge_recon_loss: 2690494.0375; val_gene_expr_recon_loss: 2092684.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4804842.5500; val_optim_loss: 4804842.5500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9664; val_auprc_score: 0.9593; val_best_acc_score: 0.9092; val_best_f1_score: 0.9125; train_kl_reg_loss: 21574.4336; train_edge_recon_loss: 2653570.8750; train_gene_expr_recon_loss: 2088537.5701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4763682.8847; train_optim_loss: 4763682.8847; val_kl_reg_loss: 21072.8603; val_edge_recon_loss: 2687683.8125; val_gene_expr_recon_loss: 2085257.0594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4794013.7125; val_optim_loss: 4794013.7125
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9671; val_auprc_score: 0.9605; val_best_acc_score: 0.9104; val_best_f1_score: 0.9134; train_kl_reg_loss: 21096.4734; train_edge_recon_loss: 2652193.7090; train_gene_expr_recon_loss: 2081981.4517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4755271.6375; train_optim_loss: 4755271.6375; val_kl_reg_loss: 20459.5332; val_edge_recon_loss: 2686104.3375; val_gene_expr_recon_loss: 2078100.5750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4784664.5000; val_optim_loss: 4784664.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9688; val_auprc_score: 0.9624; val_best_acc_score: 0.9131; val_best_f1_score: 0.9159; train_kl_reg_loss: 20700.0033; train_edge_recon_loss: 2650481.9438; train_gene_expr_recon_loss: 2077826.3830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4749008.3208; train_optim_loss: 4749008.3208; val_kl_reg_loss: 19934.6933; val_edge_recon_loss: 2689218.1063; val_gene_expr_recon_loss: 2076538.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4785691.0250; val_optim_loss: 4785691.0250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9697; val_auprc_score: 0.9633; val_best_acc_score: 0.9155; val_best_f1_score: 0.9181; train_kl_reg_loss: 20416.2854; train_edge_recon_loss: 2648235.5208; train_gene_expr_recon_loss: 2072997.4972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4741649.3069; train_optim_loss: 4741649.3069; val_kl_reg_loss: 19785.9837; val_edge_recon_loss: 2684600.6688; val_gene_expr_recon_loss: 2072761.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4777148.2625; val_optim_loss: 4777148.2625
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9704; val_auprc_score: 0.9644; val_best_acc_score: 0.9154; val_best_f1_score: 0.9178; train_kl_reg_loss: 20146.2979; train_edge_recon_loss: 2646661.0688; train_gene_expr_recon_loss: 2070032.1809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4736839.5528; train_optim_loss: 4736839.5528; val_kl_reg_loss: 19748.4607; val_edge_recon_loss: 2683315.1500; val_gene_expr_recon_loss: 2071475.2063; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4774538.8375; val_optim_loss: 4774538.8375
