Run timestamp: 21062023_133735.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_5pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6656; val_auprc_score: 0.6991; val_best_acc_score: 0.6386; val_best_f1_score: 0.6511; train_kl_reg_loss: 1161.9360; train_edge_recon_loss: 366819.1250; train_cond_contrastive_loss: 137584.2734; train_gene_expr_recon_loss: 147348.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 652914.2500; train_optim_loss: 652914.2500; val_kl_reg_loss: 2347.6860; val_edge_recon_loss: 417725.6562; val_cond_contrastive_loss: 78442.2109; val_gene_expr_recon_loss: 131396.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 629912.1875; val_optim_loss: 629912.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6602; val_auprc_score: 0.6955; val_best_acc_score: 0.6280; val_best_f1_score: 0.6552; train_kl_reg_loss: 3669.9015; train_edge_recon_loss: 380332.8750; train_cond_contrastive_loss: 94753.0117; train_gene_expr_recon_loss: 129632.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 608388.3438; train_optim_loss: 608388.3438; val_kl_reg_loss: 13607.5645; val_edge_recon_loss: 410673.9062; val_cond_contrastive_loss: 78423.9219; val_gene_expr_recon_loss: 121117.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 623822.9375; val_optim_loss: 623822.9375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6403; val_auprc_score: 0.6703; val_best_acc_score: 0.6226; val_best_f1_score: 0.6480; train_kl_reg_loss: 12588.6221; train_edge_recon_loss: 382373.5625; train_cond_contrastive_loss: 83657.0195; train_gene_expr_recon_loss: 124374.8242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 602994.0312; train_optim_loss: 602994.0312; val_kl_reg_loss: 6990.0137; val_edge_recon_loss: 412826.5938; val_cond_contrastive_loss: 78437.0312; val_gene_expr_recon_loss: 117241.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 615494.7500; val_optim_loss: 615494.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6374; val_auprc_score: 0.6713; val_best_acc_score: 0.6178; val_best_f1_score: 0.6511; train_kl_reg_loss: 7097.2336; train_edge_recon_loss: 379298.2500; train_cond_contrastive_loss: 85220.5000; train_gene_expr_recon_loss: 117954.0508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 589570.0312; train_optim_loss: 589570.0312; val_kl_reg_loss: 5241.6689; val_edge_recon_loss: 403515.7188; val_cond_contrastive_loss: 78469.8984; val_gene_expr_recon_loss: 115596.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602823.3125; val_optim_loss: 602823.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6148; val_auprc_score: 0.6472; val_best_acc_score: 0.5976; val_best_f1_score: 0.6463; train_kl_reg_loss: 5169.9863; train_edge_recon_loss: 374934.5938; train_cond_contrastive_loss: 86223.7305; train_gene_expr_recon_loss: 116302.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 582630.6562; train_optim_loss: 582630.6562; val_kl_reg_loss: 3997.5498; val_edge_recon_loss: 397923.5312; val_cond_contrastive_loss: 78538.4141; val_gene_expr_recon_loss: 114910.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595369.8125; val_optim_loss: 595369.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6309; val_auprc_score: 0.6555; val_best_acc_score: 0.6115; val_best_f1_score: 0.6469; train_kl_reg_loss: 3991.8257; train_edge_recon_loss: 366529.0781; train_cond_contrastive_loss: 87690.6016; train_gene_expr_recon_loss: 115638.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 573849.5000; train_optim_loss: 573849.5000; val_kl_reg_loss: 3314.9272; val_edge_recon_loss: 380740.3750; val_cond_contrastive_loss: 78594.8672; val_gene_expr_recon_loss: 114628.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 577278.1875; val_optim_loss: 577278.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6291; val_auprc_score: 0.6541; val_best_acc_score: 0.6127; val_best_f1_score: 0.6421; train_kl_reg_loss: 3292.1196; train_edge_recon_loss: 357878.5625; train_cond_contrastive_loss: 88419.6016; train_gene_expr_recon_loss: 115373.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564963.3750; train_optim_loss: 564963.3750; val_kl_reg_loss: 2931.3013; val_edge_recon_loss: 377759.4375; val_cond_contrastive_loss: 78529.0156; val_gene_expr_recon_loss: 114516.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 573736.4375; val_optim_loss: 573736.4375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6403; val_auprc_score: 0.6709; val_best_acc_score: 0.6112; val_best_f1_score: 0.6525; train_kl_reg_loss: 3008.7866; train_edge_recon_loss: 349650.5469; train_cond_contrastive_loss: 86489.2305; train_gene_expr_recon_loss: 115176.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554325.2188; train_optim_loss: 554325.2188; val_kl_reg_loss: 3042.4377; val_edge_recon_loss: 365755.8438; val_cond_contrastive_loss: 78464.6641; val_gene_expr_recon_loss: 114283.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561546.8750; val_optim_loss: 561546.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6399; val_auprc_score: 0.6653; val_best_acc_score: 0.6171; val_best_f1_score: 0.6460; train_kl_reg_loss: 3162.2478; train_edge_recon_loss: 347982.3281; train_cond_contrastive_loss: 83207.6133; train_gene_expr_recon_loss: 115110.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 549462.2188; train_optim_loss: 549462.2188; val_kl_reg_loss: 3337.9761; val_edge_recon_loss: 371838.3438; val_cond_contrastive_loss: 78427.1719; val_gene_expr_recon_loss: 113913.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567516.8125; val_optim_loss: 567516.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6487; val_auprc_score: 0.6672; val_best_acc_score: 0.6166; val_best_f1_score: 0.6458; train_kl_reg_loss: 3447.1393; train_edge_recon_loss: 348579.4844; train_cond_contrastive_loss: 81302.5938; train_gene_expr_recon_loss: 114638.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 547967.7188; train_optim_loss: 547967.7188; val_kl_reg_loss: 3547.5234; val_edge_recon_loss: 368637.5625; val_cond_contrastive_loss: 78418.5547; val_gene_expr_recon_loss: 113488.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564092.5000; val_optim_loss: 564092.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6433; val_auprc_score: 0.6703; val_best_acc_score: 0.6069; val_best_f1_score: 0.6552; train_kl_reg_loss: 3605.6700; train_edge_recon_loss: 347966.5781; train_cond_contrastive_loss: 80596.0781; train_gene_expr_recon_loss: 114211.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546380.3125; train_optim_loss: 546380.3125; val_kl_reg_loss: 3567.9141; val_edge_recon_loss: 364090.0938; val_cond_contrastive_loss: 78410.8438; val_gene_expr_recon_loss: 113109.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559178.6250; val_optim_loss: 559178.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6426; val_auprc_score: 0.6758; val_best_acc_score: 0.6145; val_best_f1_score: 0.6530; train_kl_reg_loss: 3606.8652; train_edge_recon_loss: 348254.9531; train_cond_contrastive_loss: 80280.3438; train_gene_expr_recon_loss: 113828.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545971.1875; train_optim_loss: 545971.1875; val_kl_reg_loss: 3474.8452; val_edge_recon_loss: 369212.5625; val_cond_contrastive_loss: 78416.6172; val_gene_expr_recon_loss: 112840.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 563944.3750; val_optim_loss: 563944.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6546; val_auprc_score: 0.6805; val_best_acc_score: 0.6176; val_best_f1_score: 0.6532; train_kl_reg_loss: 3474.4131; train_edge_recon_loss: 345443.7812; train_cond_contrastive_loss: 80393.5820; train_gene_expr_recon_loss: 113737.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543049.0625; train_optim_loss: 543049.0625; val_kl_reg_loss: 3372.4336; val_edge_recon_loss: 367350.2812; val_cond_contrastive_loss: 78411.9609; val_gene_expr_recon_loss: 112655.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561790.1250; val_optim_loss: 561790.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6785; val_auprc_score: 0.7016; val_best_acc_score: 0.6414; val_best_f1_score: 0.6565; train_kl_reg_loss: 3382.4209; train_edge_recon_loss: 343102.8594; train_cond_contrastive_loss: 80795.3906; train_gene_expr_recon_loss: 113464.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540744.7188; train_optim_loss: 540744.7188; val_kl_reg_loss: 3355.2529; val_edge_recon_loss: 358902.9688; val_cond_contrastive_loss: 78418.4688; val_gene_expr_recon_loss: 112470.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553147.5625; val_optim_loss: 553147.5625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6856; val_auprc_score: 0.7115; val_best_acc_score: 0.6494; val_best_f1_score: 0.6629; train_kl_reg_loss: 3377.7904; train_edge_recon_loss: 338013.0000; train_cond_contrastive_loss: 80989.9180; train_gene_expr_recon_loss: 113541.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 535921.8750; train_optim_loss: 535921.8750; val_kl_reg_loss: 3411.6558; val_edge_recon_loss: 355944.6562; val_cond_contrastive_loss: 78425.0781; val_gene_expr_recon_loss: 112247.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550028.6250; val_optim_loss: 550028.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7155; val_auprc_score: 0.7263; val_best_acc_score: 0.6736; val_best_f1_score: 0.6674; train_kl_reg_loss: 3491.5430; train_edge_recon_loss: 335970.8281; train_cond_contrastive_loss: 80851.2500; train_gene_expr_recon_loss: 113171.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533485.0000; train_optim_loss: 533485.0000; val_kl_reg_loss: 3641.6536; val_edge_recon_loss: 346009.5625; val_cond_contrastive_loss: 78439.5156; val_gene_expr_recon_loss: 112003.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540094.4375; val_optim_loss: 540094.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7273; val_auprc_score: 0.7304; val_best_acc_score: 0.6679; val_best_f1_score: 0.6811; train_kl_reg_loss: 3783.4507; train_edge_recon_loss: 329150.9844; train_cond_contrastive_loss: 80277.3789; train_gene_expr_recon_loss: 112766.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525978.2188; train_optim_loss: 525978.2188; val_kl_reg_loss: 4099.6440; val_edge_recon_loss: 333941.1875; val_cond_contrastive_loss: 78455.8438; val_gene_expr_recon_loss: 111748.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528244.7500; val_optim_loss: 528244.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7554; val_auprc_score: 0.7432; val_best_acc_score: 0.6810; val_best_f1_score: 0.6974; train_kl_reg_loss: 4322.0620; train_edge_recon_loss: 324121.3438; train_cond_contrastive_loss: 79649.1289; train_gene_expr_recon_loss: 112608.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 520701.0469; train_optim_loss: 520701.0469; val_kl_reg_loss: 4775.6777; val_edge_recon_loss: 326371.1875; val_cond_contrastive_loss: 78482.4297; val_gene_expr_recon_loss: 111494.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 521123.5625; val_optim_loss: 521123.5625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7817; val_auprc_score: 0.7654; val_best_acc_score: 0.7027; val_best_f1_score: 0.7294; train_kl_reg_loss: 5076.4541; train_edge_recon_loss: 315516.4062; train_cond_contrastive_loss: 79154.0859; train_gene_expr_recon_loss: 112329.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 512076.3594; train_optim_loss: 512076.3594; val_kl_reg_loss: 5554.2422; val_edge_recon_loss: 312205.1250; val_cond_contrastive_loss: 78502.6094; val_gene_expr_recon_loss: 111207.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 507469.8125; val_optim_loss: 507469.8125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7892; val_auprc_score: 0.7670; val_best_acc_score: 0.7148; val_best_f1_score: 0.7449; train_kl_reg_loss: 5912.4780; train_edge_recon_loss: 309326.7500; train_cond_contrastive_loss: 78863.5000; train_gene_expr_recon_loss: 111988.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 506091.0156; train_optim_loss: 506091.0156; val_kl_reg_loss: 6316.2314; val_edge_recon_loss: 304564.9688; val_cond_contrastive_loss: 78490.8281; val_gene_expr_recon_loss: 110924.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500296.3750; val_optim_loss: 500296.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7927; val_auprc_score: 0.7629; val_best_acc_score: 0.7145; val_best_f1_score: 0.7529; train_kl_reg_loss: 6643.2432; train_edge_recon_loss: 306115.7812; train_cond_contrastive_loss: 78747.3867; train_gene_expr_recon_loss: 111664.3086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503170.7188; train_optim_loss: 503170.7188; val_kl_reg_loss: 6981.1191; val_edge_recon_loss: 308020.5312; val_cond_contrastive_loss: 78483.8438; val_gene_expr_recon_loss: 110708.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 504193.7500; val_optim_loss: 504193.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8118; val_auprc_score: 0.7744; val_best_acc_score: 0.7330; val_best_f1_score: 0.7595; train_kl_reg_loss: 7335.5520; train_edge_recon_loss: 302971.5625; train_cond_contrastive_loss: 78668.2734; train_gene_expr_recon_loss: 111498.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500474.1562; train_optim_loss: 500474.1562; val_kl_reg_loss: 7567.0181; val_edge_recon_loss: 305665.7812; val_cond_contrastive_loss: 78462.3359; val_gene_expr_recon_loss: 110512.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502207.9688; val_optim_loss: 502207.9688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8073; val_auprc_score: 0.7660; val_best_acc_score: 0.7329; val_best_f1_score: 0.7661; train_kl_reg_loss: 7856.2434; train_edge_recon_loss: 300741.6562; train_cond_contrastive_loss: 78616.4688; train_gene_expr_recon_loss: 111225.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 498440.1875; train_optim_loss: 498440.1875; val_kl_reg_loss: 7911.9678; val_edge_recon_loss: 302238.0000; val_cond_contrastive_loss: 78451.7969; val_gene_expr_recon_loss: 110318.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498920.1875; val_optim_loss: 498920.1875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8206; val_auprc_score: 0.7729; val_best_acc_score: 0.7453; val_best_f1_score: 0.7724; train_kl_reg_loss: 8161.3564; train_edge_recon_loss: 302566.3906; train_cond_contrastive_loss: 78591.2695; train_gene_expr_recon_loss: 111142.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500461.9844; train_optim_loss: 500461.9844; val_kl_reg_loss: 8042.5459; val_edge_recon_loss: 298191.5312; val_cond_contrastive_loss: 78436.1719; val_gene_expr_recon_loss: 110123.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494793.9375; val_optim_loss: 494793.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8228; val_auprc_score: 0.7886; val_best_acc_score: 0.7445; val_best_f1_score: 0.7753; train_kl_reg_loss: 8273.0205; train_edge_recon_loss: 298985.1250; train_cond_contrastive_loss: 78586.2109; train_gene_expr_recon_loss: 110747.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496591.7031; train_optim_loss: 496591.7031; val_kl_reg_loss: 7987.1011; val_edge_recon_loss: 296880.3438; val_cond_contrastive_loss: 78430.4375; val_gene_expr_recon_loss: 109946.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493244.0938; val_optim_loss: 493244.0938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8342; val_auprc_score: 0.7916; val_best_acc_score: 0.7611; val_best_f1_score: 0.7848; train_kl_reg_loss: 8175.1123; train_edge_recon_loss: 297695.5156; train_cond_contrastive_loss: 78602.6602; train_gene_expr_recon_loss: 110619.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495093.1875; train_optim_loss: 495093.1875; val_kl_reg_loss: 7732.5703; val_edge_recon_loss: 292925.9688; val_cond_contrastive_loss: 78431.8906; val_gene_expr_recon_loss: 109791.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488882.0938; val_optim_loss: 488882.0938
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8378; val_auprc_score: 0.7908; val_best_acc_score: 0.7683; val_best_f1_score: 0.7894; train_kl_reg_loss: 7943.3706; train_edge_recon_loss: 298589.2344; train_cond_contrastive_loss: 78643.9883; train_gene_expr_recon_loss: 110591.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495768.0781; train_optim_loss: 495768.0781; val_kl_reg_loss: 7426.0889; val_edge_recon_loss: 291974.3438; val_cond_contrastive_loss: 78427.0859; val_gene_expr_recon_loss: 109639.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487466.7500; val_optim_loss: 487466.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8304; val_auprc_score: 0.7707; val_best_acc_score: 0.7660; val_best_f1_score: 0.7900; train_kl_reg_loss: 7605.7661; train_edge_recon_loss: 296878.2812; train_cond_contrastive_loss: 78695.9141; train_gene_expr_recon_loss: 110412.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493592.6406; train_optim_loss: 493592.6406; val_kl_reg_loss: 7054.6611; val_edge_recon_loss: 295449.4062; val_cond_contrastive_loss: 78429.6953; val_gene_expr_recon_loss: 109457.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490390.8750; val_optim_loss: 490390.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8454; val_auprc_score: 0.7933; val_best_acc_score: 0.7712; val_best_f1_score: 0.7931; train_kl_reg_loss: 7259.6406; train_edge_recon_loss: 295462.9219; train_cond_contrastive_loss: 78755.0000; train_gene_expr_recon_loss: 110289.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491767.3750; train_optim_loss: 491767.3750; val_kl_reg_loss: 6756.2627; val_edge_recon_loss: 296075.0000; val_cond_contrastive_loss: 78430.2578; val_gene_expr_recon_loss: 109288.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490550.1250; val_optim_loss: 490550.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8456; val_auprc_score: 0.7951; val_best_acc_score: 0.7762; val_best_f1_score: 0.7954; train_kl_reg_loss: 6951.3206; train_edge_recon_loss: 294200.9062; train_cond_contrastive_loss: 78812.4922; train_gene_expr_recon_loss: 109988.4258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489953.1562; train_optim_loss: 489953.1562; val_kl_reg_loss: 6492.2373; val_edge_recon_loss: 295628.7188; val_cond_contrastive_loss: 78434.9688; val_gene_expr_recon_loss: 109118.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489673.9375; val_optim_loss: 489673.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8533; val_auprc_score: 0.7982; val_best_acc_score: 0.7854; val_best_f1_score: 0.8027; train_kl_reg_loss: 6760.9668; train_edge_recon_loss: 292292.9688; train_cond_contrastive_loss: 78847.0156; train_gene_expr_recon_loss: 109857.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487758.8438; train_optim_loss: 487758.8438; val_kl_reg_loss: 6484.5947; val_edge_recon_loss: 291986.4062; val_cond_contrastive_loss: 78439.7969; val_gene_expr_recon_loss: 109097.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486008.7500; val_optim_loss: 486008.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8562; val_auprc_score: 0.8022; val_best_acc_score: 0.7871; val_best_f1_score: 0.8029; train_kl_reg_loss: 6751.7690; train_edge_recon_loss: 293448.3438; train_cond_contrastive_loss: 78847.4766; train_gene_expr_recon_loss: 109847.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488895.1719; train_optim_loss: 488895.1719; val_kl_reg_loss: 6476.3770; val_edge_recon_loss: 292868.2812; val_cond_contrastive_loss: 78434.5234; val_gene_expr_recon_loss: 109074.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486853.4688; val_optim_loss: 486853.4688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8494; val_auprc_score: 0.8002; val_best_acc_score: 0.7783; val_best_f1_score: 0.7981; train_kl_reg_loss: 6729.0544; train_edge_recon_loss: 292584.3594; train_cond_contrastive_loss: 78846.4219; train_gene_expr_recon_loss: 109704.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487863.9375; train_optim_loss: 487863.9375; val_kl_reg_loss: 6469.9316; val_edge_recon_loss: 294235.8750; val_cond_contrastive_loss: 78434.1797; val_gene_expr_recon_loss: 109051.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488191.0625; val_optim_loss: 488191.0625
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8495; val_auprc_score: 0.7941; val_best_acc_score: 0.7836; val_best_f1_score: 0.7999; train_kl_reg_loss: 6741.1868; train_edge_recon_loss: 294017.0000; train_cond_contrastive_loss: 78844.8398; train_gene_expr_recon_loss: 109688.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489291.9219; train_optim_loss: 489291.9219; val_kl_reg_loss: 6475.1143; val_edge_recon_loss: 295029.0000; val_cond_contrastive_loss: 78438.8750; val_gene_expr_recon_loss: 109027.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488970.5312; val_optim_loss: 488970.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8565; val_auprc_score: 0.7964; val_best_acc_score: 0.7872; val_best_f1_score: 0.8013; train_kl_reg_loss: 6719.4487; train_edge_recon_loss: 293977.3594; train_cond_contrastive_loss: 78840.1797; train_gene_expr_recon_loss: 109895.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489432.3125; train_optim_loss: 489432.3125; val_kl_reg_loss: 6453.8384; val_edge_recon_loss: 294680.2500; val_cond_contrastive_loss: 78440.1875; val_gene_expr_recon_loss: 109025.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488599.3750; val_optim_loss: 488599.3750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8524; val_auprc_score: 0.8012; val_best_acc_score: 0.7852; val_best_f1_score: 0.8019; train_kl_reg_loss: 6733.6418; train_edge_recon_loss: 293633.4531; train_cond_contrastive_loss: 78843.4062; train_gene_expr_recon_loss: 109729.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488940.3281; train_optim_loss: 488940.3281; val_kl_reg_loss: 6468.7344; val_edge_recon_loss: 293679.7500; val_cond_contrastive_loss: 78439.6641; val_gene_expr_recon_loss: 109022.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487610.6250; val_optim_loss: 487610.6250
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8526; val_auprc_score: 0.8024; val_best_acc_score: 0.7859; val_best_f1_score: 0.8071; train_kl_reg_loss: 6731.2107; train_edge_recon_loss: 292908.5156; train_cond_contrastive_loss: 78838.3867; train_gene_expr_recon_loss: 109738.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488216.5469; train_optim_loss: 488216.5469; val_kl_reg_loss: 6456.4224; val_edge_recon_loss: 289164.2188; val_cond_contrastive_loss: 78433.9688; val_gene_expr_recon_loss: 109019.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483074.4688; val_optim_loss: 483074.4688
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8418; val_auprc_score: 0.7880; val_best_acc_score: 0.7705; val_best_f1_score: 0.7899; train_kl_reg_loss: 6734.3281; train_edge_recon_loss: 292743.8125; train_cond_contrastive_loss: 78839.1172; train_gene_expr_recon_loss: 109854.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488172.2344; train_optim_loss: 488172.2344; val_kl_reg_loss: 6465.4424; val_edge_recon_loss: 299849.3750; val_cond_contrastive_loss: 78442.8125; val_gene_expr_recon_loss: 109017.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493774.8125; val_optim_loss: 493774.8125
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8633; val_auprc_score: 0.8213; val_best_acc_score: 0.7919; val_best_f1_score: 0.8090; train_kl_reg_loss: 6735.2141; train_edge_recon_loss: 291622.0469; train_cond_contrastive_loss: 78839.9570; train_gene_expr_recon_loss: 109857.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487054.2812; train_optim_loss: 487054.2812; val_kl_reg_loss: 6442.9146; val_edge_recon_loss: 287232.8750; val_cond_contrastive_loss: 78440.5859; val_gene_expr_recon_loss: 109014.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481130.9062; val_optim_loss: 481130.9062
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8605; val_auprc_score: 0.8122; val_best_acc_score: 0.7884; val_best_f1_score: 0.8062; train_kl_reg_loss: 6720.7202; train_edge_recon_loss: 292984.1406; train_cond_contrastive_loss: 78839.1836; train_gene_expr_recon_loss: 109946.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488490.6719; train_optim_loss: 488490.6719; val_kl_reg_loss: 6459.6152; val_edge_recon_loss: 288396.0312; val_cond_contrastive_loss: 78440.4062; val_gene_expr_recon_loss: 109011.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482308.0000; val_optim_loss: 482308.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.8482; val_auprc_score: 0.7934; val_best_acc_score: 0.7790; val_best_f1_score: 0.7975; train_kl_reg_loss: 6739.9707; train_edge_recon_loss: 295105.7188; train_cond_contrastive_loss: 78838.1875; train_gene_expr_recon_loss: 109742.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490426.1562; train_optim_loss: 490426.1562; val_kl_reg_loss: 6469.3003; val_edge_recon_loss: 296451.2188; val_cond_contrastive_loss: 78440.5703; val_gene_expr_recon_loss: 109009.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490370.5000; val_optim_loss: 490370.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.8628; val_auprc_score: 0.8129; val_best_acc_score: 0.7938; val_best_f1_score: 0.8068; train_kl_reg_loss: 6724.6572; train_edge_recon_loss: 293051.8750; train_cond_contrastive_loss: 78837.0586; train_gene_expr_recon_loss: 109857.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488471.1562; train_optim_loss: 488471.1562; val_kl_reg_loss: 6484.3838; val_edge_recon_loss: 293512.0625; val_cond_contrastive_loss: 78438.4375; val_gene_expr_recon_loss: 109006.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487441.7812; val_optim_loss: 487441.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8553; val_auprc_score: 0.8004; val_best_acc_score: 0.7867; val_best_f1_score: 0.8078; train_kl_reg_loss: 6716.6921; train_edge_recon_loss: 294359.8281; train_cond_contrastive_loss: 78836.3281; train_gene_expr_recon_loss: 109852.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489765.1250; train_optim_loss: 489765.1250; val_kl_reg_loss: 6457.4951; val_edge_recon_loss: 289135.9688; val_cond_contrastive_loss: 78438.9609; val_gene_expr_recon_loss: 109006.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483039.0938; val_optim_loss: 483039.0938
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.8526; val_auprc_score: 0.8093; val_best_acc_score: 0.7827; val_best_f1_score: 0.7998; train_kl_reg_loss: 6734.5515; train_edge_recon_loss: 294244.5156; train_cond_contrastive_loss: 78835.7109; train_gene_expr_recon_loss: 109748.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489562.9688; train_optim_loss: 489562.9688; val_kl_reg_loss: 6467.9771; val_edge_recon_loss: 293305.0625; val_cond_contrastive_loss: 78439.9844; val_gene_expr_recon_loss: 109006.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487219.4062; val_optim_loss: 487219.4062
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.8600; val_auprc_score: 0.8091; val_best_acc_score: 0.7918; val_best_f1_score: 0.8071; train_kl_reg_loss: 6733.6514; train_edge_recon_loss: 292243.8750; train_cond_contrastive_loss: 78835.9062; train_gene_expr_recon_loss: 109755.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487569.0625; train_optim_loss: 487569.0625; val_kl_reg_loss: 6461.8867; val_edge_recon_loss: 293935.6875; val_cond_contrastive_loss: 78436.5078; val_gene_expr_recon_loss: 109006.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487840.2188; val_optim_loss: 487840.2188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 20 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
Val AUROC score: 0.8572
Val AUPRC score: 0.8078
Val best accuracy score: 0.7908
Val best F1 score: 0.8059
Val gene expr MSE score: 2.0174
Duration of model training in run 1: 0 hours, 1 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6588; val_auprc_score: 0.6949; val_best_acc_score: 0.6340; val_best_f1_score: 0.6617; train_kl_reg_loss: 1186.3282; train_edge_recon_loss: 366203.1094; train_cond_contrastive_loss: 137964.3711; train_gene_expr_recon_loss: 146280.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 651634.7500; train_optim_loss: 651634.7500; val_kl_reg_loss: 2336.2974; val_edge_recon_loss: 415749.3125; val_cond_contrastive_loss: 78431.2891; val_gene_expr_recon_loss: 131400.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 627917.2500; val_optim_loss: 627917.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6457; val_auprc_score: 0.6797; val_best_acc_score: 0.6173; val_best_f1_score: 0.6668; train_kl_reg_loss: 4043.0649; train_edge_recon_loss: 379563.0312; train_cond_contrastive_loss: 91143.4258; train_gene_expr_recon_loss: 129343.5508; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 604093.0625; train_optim_loss: 604093.0625; val_kl_reg_loss: 10676.9570; val_edge_recon_loss: 408979.8438; val_cond_contrastive_loss: 78421.6797; val_gene_expr_recon_loss: 121743.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 619822.1875; val_optim_loss: 619822.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6404; val_auprc_score: 0.6611; val_best_acc_score: 0.6274; val_best_f1_score: 0.6510; train_kl_reg_loss: 10163.4697; train_edge_recon_loss: 386771.3281; train_cond_contrastive_loss: 81244.8828; train_gene_expr_recon_loss: 123634.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 601814.3125; train_optim_loss: 601814.3125; val_kl_reg_loss: 4595.6562; val_edge_recon_loss: 415648.0312; val_cond_contrastive_loss: 78437.5156; val_gene_expr_recon_loss: 118720.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 617402.0625; val_optim_loss: 617402.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6298; val_auprc_score: 0.6519; val_best_acc_score: 0.6149; val_best_f1_score: 0.6478; train_kl_reg_loss: 4476.1809; train_edge_recon_loss: 378642.2812; train_cond_contrastive_loss: 85956.3125; train_gene_expr_recon_loss: 118510.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 587585.0000; train_optim_loss: 587585.0000; val_kl_reg_loss: 3365.5576; val_edge_recon_loss: 403554.7188; val_cond_contrastive_loss: 78487.3828; val_gene_expr_recon_loss: 116933.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602341.5625; val_optim_loss: 602341.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6296; val_auprc_score: 0.6338; val_best_acc_score: 0.6019; val_best_f1_score: 0.6450; train_kl_reg_loss: 3597.0608; train_edge_recon_loss: 369889.8594; train_cond_contrastive_loss: 88675.4883; train_gene_expr_recon_loss: 116900.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 579062.5938; train_optim_loss: 579062.5938; val_kl_reg_loss: 3613.5259; val_edge_recon_loss: 394138.9688; val_cond_contrastive_loss: 78545.5000; val_gene_expr_recon_loss: 115950.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592248.5000; val_optim_loss: 592248.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6314; val_auprc_score: 0.6528; val_best_acc_score: 0.6100; val_best_f1_score: 0.6514; train_kl_reg_loss: 3705.2510; train_edge_recon_loss: 365262.0156; train_cond_contrastive_loss: 87152.6523; train_gene_expr_recon_loss: 116225.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 572345.7188; train_optim_loss: 572345.7188; val_kl_reg_loss: 2942.3320; val_edge_recon_loss: 375768.3125; val_cond_contrastive_loss: 78528.6875; val_gene_expr_recon_loss: 115550.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572789.3750; val_optim_loss: 572789.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6389; val_auprc_score: 0.6485; val_best_acc_score: 0.6141; val_best_f1_score: 0.6501; train_kl_reg_loss: 2991.1190; train_edge_recon_loss: 359513.7188; train_cond_contrastive_loss: 89376.7930; train_gene_expr_recon_loss: 115634.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567515.8438; train_optim_loss: 567515.8438; val_kl_reg_loss: 2668.0493; val_edge_recon_loss: 371855.2812; val_cond_contrastive_loss: 78466.1875; val_gene_expr_recon_loss: 115320.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568309.6250; val_optim_loss: 568309.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6315; val_auprc_score: 0.6385; val_best_acc_score: 0.6018; val_best_f1_score: 0.6553; train_kl_reg_loss: 2786.2628; train_edge_recon_loss: 349652.5000; train_cond_contrastive_loss: 89497.9766; train_gene_expr_recon_loss: 115337.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557274.5938; train_optim_loss: 557274.5938; val_kl_reg_loss: 2897.5220; val_edge_recon_loss: 372535.5938; val_cond_contrastive_loss: 78415.8594; val_gene_expr_recon_loss: 115086.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568935.4375; val_optim_loss: 568935.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6297; val_auprc_score: 0.6461; val_best_acc_score: 0.6078; val_best_f1_score: 0.6501; train_kl_reg_loss: 3066.1665; train_edge_recon_loss: 347415.1562; train_cond_contrastive_loss: 86048.2305; train_gene_expr_recon_loss: 115074.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551603.9062; train_optim_loss: 551603.9062; val_kl_reg_loss: 3345.5933; val_edge_recon_loss: 377237.2812; val_cond_contrastive_loss: 78393.7656; val_gene_expr_recon_loss: 114813.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 573790.2500; val_optim_loss: 573790.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6358; val_auprc_score: 0.6551; val_best_acc_score: 0.6065; val_best_f1_score: 0.6546; train_kl_reg_loss: 3538.9630; train_edge_recon_loss: 348112.4688; train_cond_contrastive_loss: 82853.5273; train_gene_expr_recon_loss: 114855.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 549360.7500; train_optim_loss: 549360.7500; val_kl_reg_loss: 3819.3237; val_edge_recon_loss: 372174.0312; val_cond_contrastive_loss: 78385.7109; val_gene_expr_recon_loss: 114527.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568906.8125; val_optim_loss: 568906.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6421; val_auprc_score: 0.6589; val_best_acc_score: 0.6069; val_best_f1_score: 0.6574; train_kl_reg_loss: 3891.6238; train_edge_recon_loss: 349898.1094; train_cond_contrastive_loss: 81466.3789; train_gene_expr_recon_loss: 114678.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 549934.7812; train_optim_loss: 549934.7812; val_kl_reg_loss: 3837.8030; val_edge_recon_loss: 367312.7188; val_cond_contrastive_loss: 78380.6016; val_gene_expr_recon_loss: 114489.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564020.8750; val_optim_loss: 564020.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6337; val_auprc_score: 0.6503; val_best_acc_score: 0.6050; val_best_f1_score: 0.6511; train_kl_reg_loss: 3920.8959; train_edge_recon_loss: 349638.6094; train_cond_contrastive_loss: 81443.3477; train_gene_expr_recon_loss: 114489.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 549492.8750; train_optim_loss: 549492.8750; val_kl_reg_loss: 3865.4404; val_edge_recon_loss: 374229.9375; val_cond_contrastive_loss: 78379.6406; val_gene_expr_recon_loss: 114434.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 570909.2500; val_optim_loss: 570909.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6238; val_auprc_score: 0.6397; val_best_acc_score: 0.6025; val_best_f1_score: 0.6460; train_kl_reg_loss: 3922.8868; train_edge_recon_loss: 351893.5156; train_cond_contrastive_loss: 81328.9844; train_gene_expr_recon_loss: 114578.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551724.2188; train_optim_loss: 551724.2188; val_kl_reg_loss: 3862.5977; val_edge_recon_loss: 381874.6250; val_cond_contrastive_loss: 78377.6641; val_gene_expr_recon_loss: 114368.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 578483.1875; val_optim_loss: 578483.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6439; val_auprc_score: 0.6572; val_best_acc_score: 0.6181; val_best_f1_score: 0.6459; train_kl_reg_loss: 3914.6281; train_edge_recon_loss: 346234.8281; train_cond_contrastive_loss: 81277.6797; train_gene_expr_recon_loss: 114488.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545916.0312; train_optim_loss: 545916.0312; val_kl_reg_loss: 3848.4890; val_edge_recon_loss: 378543.8750; val_cond_contrastive_loss: 78378.4062; val_gene_expr_recon_loss: 114297.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575068.7500; val_optim_loss: 575068.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6378; val_auprc_score: 0.6614; val_best_acc_score: 0.6077; val_best_f1_score: 0.6547; train_kl_reg_loss: 3900.9504; train_edge_recon_loss: 347607.2656; train_cond_contrastive_loss: 81254.3750; train_gene_expr_recon_loss: 114452.1602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 547214.7500; train_optim_loss: 547214.7500; val_kl_reg_loss: 3830.8037; val_edge_recon_loss: 370802.5312; val_cond_contrastive_loss: 78379.7734; val_gene_expr_recon_loss: 114290.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567303.6875; val_optim_loss: 567303.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.6376; val_auprc_score: 0.6542; val_best_acc_score: 0.6134; val_best_f1_score: 0.6482; train_kl_reg_loss: 3894.9568; train_edge_recon_loss: 346228.7812; train_cond_contrastive_loss: 81309.4258; train_gene_expr_recon_loss: 114420.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545853.9688; train_optim_loss: 545853.9688; val_kl_reg_loss: 3840.8491; val_edge_recon_loss: 377167.2500; val_cond_contrastive_loss: 78378.9219; val_gene_expr_recon_loss: 114282.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 573669.7500; val_optim_loss: 573669.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.6405; val_auprc_score: 0.6529; val_best_acc_score: 0.6151; val_best_f1_score: 0.6473; train_kl_reg_loss: 3889.0707; train_edge_recon_loss: 346905.4688; train_cond_contrastive_loss: 81294.0586; train_gene_expr_recon_loss: 114351.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546440.5312; train_optim_loss: 546440.5312; val_kl_reg_loss: 3831.8071; val_edge_recon_loss: 376719.4688; val_cond_contrastive_loss: 78375.4141; val_gene_expr_recon_loss: 114274.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 573201.1875; val_optim_loss: 573201.1875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 11.

--- MODEL EVALUATION ---
Val AUROC score: 0.6278
Val AUPRC score: 0.6449
Val best accuracy score: 0.6033
Val best F1 score: 0.6504
Val gene expr MSE score: 2.3463
Duration of model training in run 2: 0 hours, 0 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7415; val_auprc_score: 0.7800; val_best_acc_score: 0.6786; val_best_f1_score: 0.6946; train_kl_reg_loss: 1888.1586; train_edge_recon_loss: 355426.2969; train_cond_contrastive_loss: 118819.3340; train_gene_expr_recon_loss: 135922.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 612056.2656; train_optim_loss: 612056.2656; val_kl_reg_loss: 5459.1689; val_edge_recon_loss: 401744.6250; val_cond_contrastive_loss: 78359.6328; val_gene_expr_recon_loss: 120467.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 606030.6250; val_optim_loss: 606030.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7071; val_auprc_score: 0.7359; val_best_acc_score: 0.6298; val_best_f1_score: 0.6970; train_kl_reg_loss: 10482.1841; train_edge_recon_loss: 358930.1094; train_cond_contrastive_loss: 85244.5195; train_gene_expr_recon_loss: 119908.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 574565.2969; train_optim_loss: 574565.2969; val_kl_reg_loss: 7506.7236; val_edge_recon_loss: 394176.6562; val_cond_contrastive_loss: 78379.3516; val_gene_expr_recon_loss: 115553.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595616.1875; val_optim_loss: 595616.1875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6793; val_auprc_score: 0.7086; val_best_acc_score: 0.6156; val_best_f1_score: 0.6816; train_kl_reg_loss: 6270.4253; train_edge_recon_loss: 355728.6484; train_cond_contrastive_loss: 86700.2676; train_gene_expr_recon_loss: 115684.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564383.5781; train_optim_loss: 564383.5781; val_kl_reg_loss: 4646.3862; val_edge_recon_loss: 386611.0625; val_cond_contrastive_loss: 78437.6875; val_gene_expr_recon_loss: 114639.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 584334.6875; val_optim_loss: 584334.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6829; val_auprc_score: 0.7125; val_best_acc_score: 0.6190; val_best_f1_score: 0.6889; train_kl_reg_loss: 4546.8121; train_edge_recon_loss: 347270.4766; train_cond_contrastive_loss: 88217.7168; train_gene_expr_recon_loss: 114094.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554129.6719; train_optim_loss: 554129.6719; val_kl_reg_loss: 4014.7466; val_edge_recon_loss: 349540.1875; val_cond_contrastive_loss: 78510.5234; val_gene_expr_recon_loss: 114154.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546220.2500; val_optim_loss: 546220.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6841; val_auprc_score: 0.7168; val_best_acc_score: 0.6294; val_best_f1_score: 0.6864; train_kl_reg_loss: 4019.3328; train_edge_recon_loss: 334861.4531; train_cond_contrastive_loss: 87522.8066; train_gene_expr_recon_loss: 113998.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540402.5469; train_optim_loss: 540402.5469; val_kl_reg_loss: 4028.4023; val_edge_recon_loss: 345326.3750; val_cond_contrastive_loss: 78422.4297; val_gene_expr_recon_loss: 113618.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 541395.3125; val_optim_loss: 541395.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6832; val_auprc_score: 0.7164; val_best_acc_score: 0.6394; val_best_f1_score: 0.6811; train_kl_reg_loss: 4309.9897; train_edge_recon_loss: 329249.0469; train_cond_contrastive_loss: 82263.4512; train_gene_expr_recon_loss: 113272.2715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529094.7344; train_optim_loss: 529094.7344; val_kl_reg_loss: 4547.6934; val_edge_recon_loss: 345023.2500; val_cond_contrastive_loss: 78399.8203; val_gene_expr_recon_loss: 112957.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540928.3750; val_optim_loss: 540928.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7225; val_auprc_score: 0.7466; val_best_acc_score: 0.6574; val_best_f1_score: 0.6951; train_kl_reg_loss: 4746.0410; train_edge_recon_loss: 326936.4219; train_cond_contrastive_loss: 79808.1641; train_gene_expr_recon_loss: 113241.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 524731.7969; train_optim_loss: 524731.7969; val_kl_reg_loss: 4694.8726; val_edge_recon_loss: 330561.2188; val_cond_contrastive_loss: 78405.5625; val_gene_expr_recon_loss: 112430.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526091.9375; val_optim_loss: 526091.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7630; val_auprc_score: 0.7713; val_best_acc_score: 0.6831; val_best_f1_score: 0.7226; train_kl_reg_loss: 4789.4111; train_edge_recon_loss: 313959.9375; train_cond_contrastive_loss: 79536.6582; train_gene_expr_recon_loss: 112237.8340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510523.8438; train_optim_loss: 510523.8438; val_kl_reg_loss: 4719.5649; val_edge_recon_loss: 313145.5000; val_cond_contrastive_loss: 78429.7734; val_gene_expr_recon_loss: 112039.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 508334.6562; val_optim_loss: 508334.6562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8067; val_auprc_score: 0.8000; val_best_acc_score: 0.7248; val_best_f1_score: 0.7668; train_kl_reg_loss: 5016.9801; train_edge_recon_loss: 299382.8516; train_cond_contrastive_loss: 79420.4961; train_gene_expr_recon_loss: 112162.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495983.0547; train_optim_loss: 495983.0547; val_kl_reg_loss: 5244.7881; val_edge_recon_loss: 294553.5625; val_cond_contrastive_loss: 78456.5547; val_gene_expr_recon_loss: 111621.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489876.5312; val_optim_loss: 489876.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8343; val_auprc_score: 0.8146; val_best_acc_score: 0.7544; val_best_f1_score: 0.7851; train_kl_reg_loss: 5649.2712; train_edge_recon_loss: 290901.3828; train_cond_contrastive_loss: 79034.0117; train_gene_expr_recon_loss: 111205.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486790.1172; train_optim_loss: 486790.1172; val_kl_reg_loss: 5991.3330; val_edge_recon_loss: 290189.9688; val_cond_contrastive_loss: 78444.3359; val_gene_expr_recon_loss: 111007.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485633.3125; val_optim_loss: 485633.3125
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8478; val_auprc_score: 0.8229; val_best_acc_score: 0.7655; val_best_f1_score: 0.7970; train_kl_reg_loss: 6352.4713; train_edge_recon_loss: 285134.2266; train_cond_contrastive_loss: 78824.6719; train_gene_expr_recon_loss: 111102.5605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481413.9375; train_optim_loss: 481413.9375; val_kl_reg_loss: 6365.5322; val_edge_recon_loss: 285300.5625; val_cond_contrastive_loss: 78431.7031; val_gene_expr_recon_loss: 110577.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480675.0938; val_optim_loss: 480675.0938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8554; val_auprc_score: 0.8264; val_best_acc_score: 0.7813; val_best_f1_score: 0.8048; train_kl_reg_loss: 6536.4110; train_edge_recon_loss: 283043.5547; train_cond_contrastive_loss: 78843.0879; train_gene_expr_recon_loss: 110646.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479069.5781; train_optim_loss: 479069.5781; val_kl_reg_loss: 6298.9883; val_edge_recon_loss: 284403.9688; val_cond_contrastive_loss: 78416.3125; val_gene_expr_recon_loss: 110237.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479356.5625; val_optim_loss: 479356.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8692; val_auprc_score: 0.8390; val_best_acc_score: 0.8016; val_best_f1_score: 0.8188; train_kl_reg_loss: 6440.7998; train_edge_recon_loss: 281298.2969; train_cond_contrastive_loss: 78932.6777; train_gene_expr_recon_loss: 110170.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476842.4453; train_optim_loss: 476842.4453; val_kl_reg_loss: 6183.8267; val_edge_recon_loss: 280692.5625; val_cond_contrastive_loss: 78414.7734; val_gene_expr_recon_loss: 109923.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475214.4062; val_optim_loss: 475214.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8743; val_auprc_score: 0.8352; val_best_acc_score: 0.8122; val_best_f1_score: 0.8291; train_kl_reg_loss: 6390.3044; train_edge_recon_loss: 277951.0703; train_cond_contrastive_loss: 78968.9629; train_gene_expr_recon_loss: 109586.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472896.7969; train_optim_loss: 472896.7969; val_kl_reg_loss: 6247.0986; val_edge_recon_loss: 279555.2812; val_cond_contrastive_loss: 78410.5781; val_gene_expr_recon_loss: 109592.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473805.0000; val_optim_loss: 473805.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8842; val_auprc_score: 0.8495; val_best_acc_score: 0.8210; val_best_f1_score: 0.8359; train_kl_reg_loss: 6488.5891; train_edge_recon_loss: 277069.1875; train_cond_contrastive_loss: 78935.1680; train_gene_expr_recon_loss: 109612.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472105.7891; train_optim_loss: 472105.7891; val_kl_reg_loss: 6349.1958; val_edge_recon_loss: 279771.8750; val_cond_contrastive_loss: 78414.3281; val_gene_expr_recon_loss: 109284.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473819.5312; val_optim_loss: 473819.5312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9011; val_auprc_score: 0.8711; val_best_acc_score: 0.8312; val_best_f1_score: 0.8465; train_kl_reg_loss: 6532.2555; train_edge_recon_loss: 275286.9922; train_cond_contrastive_loss: 78874.8203; train_gene_expr_recon_loss: 108529.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469223.2031; train_optim_loss: 469223.2031; val_kl_reg_loss: 6324.5786; val_edge_recon_loss: 275095.4375; val_cond_contrastive_loss: 78423.1797; val_gene_expr_recon_loss: 109009.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468852.8125; val_optim_loss: 468852.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9090; val_auprc_score: 0.8864; val_best_acc_score: 0.8356; val_best_f1_score: 0.8500; train_kl_reg_loss: 6391.7754; train_edge_recon_loss: 274606.2734; train_cond_contrastive_loss: 78873.6543; train_gene_expr_recon_loss: 109360.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469232.1406; train_optim_loss: 469232.1406; val_kl_reg_loss: 6089.5991; val_edge_recon_loss: 273134.9688; val_cond_contrastive_loss: 78429.4766; val_gene_expr_recon_loss: 108753.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466407.1875; val_optim_loss: 466407.1875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9211; val_auprc_score: 0.9057; val_best_acc_score: 0.8428; val_best_f1_score: 0.8534; train_kl_reg_loss: 6185.2609; train_edge_recon_loss: 273985.3750; train_cond_contrastive_loss: 78835.3652; train_gene_expr_recon_loss: 109194.2246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468200.2344; train_optim_loss: 468200.2344; val_kl_reg_loss: 5966.5742; val_edge_recon_loss: 274874.3438; val_cond_contrastive_loss: 78437.5000; val_gene_expr_recon_loss: 108517.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467795.5312; val_optim_loss: 467795.5312
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9231; val_auprc_score: 0.9059; val_best_acc_score: 0.8482; val_best_f1_score: 0.8564; train_kl_reg_loss: 6016.3795; train_edge_recon_loss: 273830.6328; train_cond_contrastive_loss: 78780.3809; train_gene_expr_recon_loss: 108992.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467619.5234; train_optim_loss: 467619.5234; val_kl_reg_loss: 5833.2861; val_edge_recon_loss: 271078.8438; val_cond_contrastive_loss: 78438.4766; val_gene_expr_recon_loss: 108274.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463625.0938; val_optim_loss: 463625.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9333; val_auprc_score: 0.9197; val_best_acc_score: 0.8579; val_best_f1_score: 0.8640; train_kl_reg_loss: 6002.0026; train_edge_recon_loss: 269688.0781; train_cond_contrastive_loss: 78738.9941; train_gene_expr_recon_loss: 108783.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463212.8438; train_optim_loss: 463212.8438; val_kl_reg_loss: 5976.1338; val_edge_recon_loss: 274071.5000; val_cond_contrastive_loss: 78434.1641; val_gene_expr_recon_loss: 108058.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466540.5625; val_optim_loss: 466540.5625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9407; val_auprc_score: 0.9277; val_best_acc_score: 0.8684; val_best_f1_score: 0.8733; train_kl_reg_loss: 6185.7983; train_edge_recon_loss: 270718.8750; train_cond_contrastive_loss: 78646.8086; train_gene_expr_recon_loss: 107786.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463338.0547; train_optim_loss: 463338.0547; val_kl_reg_loss: 6081.5986; val_edge_recon_loss: 270537.6250; val_cond_contrastive_loss: 78430.4453; val_gene_expr_recon_loss: 107815.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462864.7500; val_optim_loss: 462864.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9452; val_auprc_score: 0.9331; val_best_acc_score: 0.8741; val_best_f1_score: 0.8782; train_kl_reg_loss: 6137.2178; train_edge_recon_loss: 270029.2344; train_cond_contrastive_loss: 78635.6562; train_gene_expr_recon_loss: 107528.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462330.5859; train_optim_loss: 462330.5859; val_kl_reg_loss: 6043.3984; val_edge_recon_loss: 268515.7812; val_cond_contrastive_loss: 78427.2578; val_gene_expr_recon_loss: 107586.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460573.0000; val_optim_loss: 460573.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9457; val_auprc_score: 0.9354; val_best_acc_score: 0.8782; val_best_f1_score: 0.8827; train_kl_reg_loss: 6177.1556; train_edge_recon_loss: 268776.1953; train_cond_contrastive_loss: 78627.2227; train_gene_expr_recon_loss: 108390.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461971.1953; train_optim_loss: 461971.1953; val_kl_reg_loss: 6031.9883; val_edge_recon_loss: 272441.5312; val_cond_contrastive_loss: 78426.9609; val_gene_expr_recon_loss: 107379.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464280.5000; val_optim_loss: 464280.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9509; val_auprc_score: 0.9398; val_best_acc_score: 0.8874; val_best_f1_score: 0.8877; train_kl_reg_loss: 6095.3544; train_edge_recon_loss: 268564.3750; train_cond_contrastive_loss: 78634.5645; train_gene_expr_recon_loss: 107636.3730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460930.6797; train_optim_loss: 460930.6797; val_kl_reg_loss: 5940.9365; val_edge_recon_loss: 276445.0312; val_cond_contrastive_loss: 78429.3359; val_gene_expr_recon_loss: 107167.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467982.5938; val_optim_loss: 467982.5938
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9591; val_auprc_score: 0.9508; val_best_acc_score: 0.9011; val_best_f1_score: 0.9032; train_kl_reg_loss: 6030.9937; train_edge_recon_loss: 269558.8203; train_cond_contrastive_loss: 78641.6797; train_gene_expr_recon_loss: 107656.7715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461888.2656; train_optim_loss: 461888.2656; val_kl_reg_loss: 5864.7139; val_edge_recon_loss: 268646.9062; val_cond_contrastive_loss: 78432.8828; val_gene_expr_recon_loss: 106960.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459904.5312; val_optim_loss: 459904.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9651; val_auprc_score: 0.9583; val_best_acc_score: 0.9080; val_best_f1_score: 0.9095; train_kl_reg_loss: 5961.5223; train_edge_recon_loss: 266717.2344; train_cond_contrastive_loss: 78656.5098; train_gene_expr_recon_loss: 107080.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458415.4922; train_optim_loss: 458415.4922; val_kl_reg_loss: 5750.0361; val_edge_recon_loss: 267509.2500; val_cond_contrastive_loss: 78438.4141; val_gene_expr_recon_loss: 106790.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458488.6875; val_optim_loss: 458488.6875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9642; val_auprc_score: 0.9525; val_best_acc_score: 0.9107; val_best_f1_score: 0.9137; train_kl_reg_loss: 5818.6304; train_edge_recon_loss: 266925.3438; train_cond_contrastive_loss: 78694.8066; train_gene_expr_recon_loss: 106886.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458325.0156; train_optim_loss: 458325.0156; val_kl_reg_loss: 5735.4473; val_edge_recon_loss: 266077.2812; val_cond_contrastive_loss: 78442.7422; val_gene_expr_recon_loss: 106589.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456845.1250; val_optim_loss: 456845.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9707; val_auprc_score: 0.9636; val_best_acc_score: 0.9163; val_best_f1_score: 0.9170; train_kl_reg_loss: 5817.8735; train_edge_recon_loss: 267037.9844; train_cond_contrastive_loss: 78692.0840; train_gene_expr_recon_loss: 106343.0820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457891.0234; train_optim_loss: 457891.0234; val_kl_reg_loss: 5720.1943; val_edge_recon_loss: 270509.0938; val_cond_contrastive_loss: 78444.1719; val_gene_expr_recon_loss: 106406.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461080.3750; val_optim_loss: 461080.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9695; val_auprc_score: 0.9635; val_best_acc_score: 0.9174; val_best_f1_score: 0.9196; train_kl_reg_loss: 5807.5894; train_edge_recon_loss: 264464.2500; train_cond_contrastive_loss: 78708.8438; train_gene_expr_recon_loss: 106681.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455662.2578; train_optim_loss: 455662.2578; val_kl_reg_loss: 5710.3115; val_edge_recon_loss: 264408.4375; val_cond_contrastive_loss: 78445.1172; val_gene_expr_recon_loss: 106228.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454792.0000; val_optim_loss: 454792.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9762; val_auprc_score: 0.9721; val_best_acc_score: 0.9263; val_best_f1_score: 0.9289; train_kl_reg_loss: 5826.9038; train_edge_recon_loss: 264757.7344; train_cond_contrastive_loss: 78717.7266; train_gene_expr_recon_loss: 106514.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455817.2422; train_optim_loss: 455817.2422; val_kl_reg_loss: 5640.5747; val_edge_recon_loss: 261614.1094; val_cond_contrastive_loss: 78445.9297; val_gene_expr_recon_loss: 106056.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451757.5625; val_optim_loss: 451757.5625
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9767; val_auprc_score: 0.9705; val_best_acc_score: 0.9290; val_best_f1_score: 0.9311; train_kl_reg_loss: 5783.7856; train_edge_recon_loss: 263335.4297; train_cond_contrastive_loss: 78761.0527; train_gene_expr_recon_loss: 106228.5137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454108.7812; train_optim_loss: 454108.7812; val_kl_reg_loss: 5732.2603; val_edge_recon_loss: 264628.0312; val_cond_contrastive_loss: 78442.1484; val_gene_expr_recon_loss: 105907.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454710.3125; val_optim_loss: 454710.3125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9786; val_auprc_score: 0.9704; val_best_acc_score: 0.9341; val_best_f1_score: 0.9356; train_kl_reg_loss: 5817.4192; train_edge_recon_loss: 261818.9336; train_cond_contrastive_loss: 78767.2969; train_gene_expr_recon_loss: 105826.0098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452229.6562; train_optim_loss: 452229.6562; val_kl_reg_loss: 5744.4209; val_edge_recon_loss: 263116.3438; val_cond_contrastive_loss: 78442.2656; val_gene_expr_recon_loss: 105749.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453052.0625; val_optim_loss: 453052.0625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9791; val_auprc_score: 0.9716; val_best_acc_score: 0.9371; val_best_f1_score: 0.9380; train_kl_reg_loss: 5884.0117; train_edge_recon_loss: 262347.8633; train_cond_contrastive_loss: 78763.6582; train_gene_expr_recon_loss: 105928.4355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452923.9688; train_optim_loss: 452923.9688; val_kl_reg_loss: 5776.3940; val_edge_recon_loss: 263784.7812; val_cond_contrastive_loss: 78437.4062; val_gene_expr_recon_loss: 105563.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453562.0000; val_optim_loss: 453562.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9799; val_auprc_score: 0.9719; val_best_acc_score: 0.9382; val_best_f1_score: 0.9397; train_kl_reg_loss: 5876.3676; train_edge_recon_loss: 263089.0312; train_cond_contrastive_loss: 78777.1914; train_gene_expr_recon_loss: 105888.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453631.2734; train_optim_loss: 453631.2734; val_kl_reg_loss: 5767.2358; val_edge_recon_loss: 264078.6875; val_cond_contrastive_loss: 78438.3359; val_gene_expr_recon_loss: 105536.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453821.1250; val_optim_loss: 453821.1250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9804; val_auprc_score: 0.9749; val_best_acc_score: 0.9344; val_best_f1_score: 0.9367; train_kl_reg_loss: 5884.8677; train_edge_recon_loss: 263151.7227; train_cond_contrastive_loss: 78775.4668; train_gene_expr_recon_loss: 105568.1270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453380.1797; train_optim_loss: 453380.1797; val_kl_reg_loss: 5771.5806; val_edge_recon_loss: 259652.0156; val_cond_contrastive_loss: 78439.7812; val_gene_expr_recon_loss: 105509.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449372.8750; val_optim_loss: 449372.8750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9771; val_auprc_score: 0.9696; val_best_acc_score: 0.9289; val_best_f1_score: 0.9305; train_kl_reg_loss: 5876.9630; train_edge_recon_loss: 262130.3828; train_cond_contrastive_loss: 78776.1562; train_gene_expr_recon_loss: 105665.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452449.4375; train_optim_loss: 452449.4375; val_kl_reg_loss: 5762.4912; val_edge_recon_loss: 267833.6250; val_cond_contrastive_loss: 78438.2656; val_gene_expr_recon_loss: 105477.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457511.9688; val_optim_loss: 457511.9688
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9811; val_auprc_score: 0.9745; val_best_acc_score: 0.9366; val_best_f1_score: 0.9381; train_kl_reg_loss: 5876.9672; train_edge_recon_loss: 261929.8164; train_cond_contrastive_loss: 78779.5723; train_gene_expr_recon_loss: 105615.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452201.7109; train_optim_loss: 452201.7109; val_kl_reg_loss: 5749.4971; val_edge_recon_loss: 264547.7812; val_cond_contrastive_loss: 78438.6484; val_gene_expr_recon_loss: 105450.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454186.2500; val_optim_loss: 454186.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9796; val_auprc_score: 0.9741; val_best_acc_score: 0.9342; val_best_f1_score: 0.9357; train_kl_reg_loss: 5850.3577; train_edge_recon_loss: 263000.2695; train_cond_contrastive_loss: 78783.9824; train_gene_expr_recon_loss: 105057.6660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452692.2812; train_optim_loss: 452692.2812; val_kl_reg_loss: 5754.0430; val_edge_recon_loss: 262714.7812; val_cond_contrastive_loss: 78438.5625; val_gene_expr_recon_loss: 105427.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452334.4688; val_optim_loss: 452334.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9792; val_auprc_score: 0.9747; val_best_acc_score: 0.9347; val_best_f1_score: 0.9366; train_kl_reg_loss: 5859.6431; train_edge_recon_loss: 262289.6797; train_cond_contrastive_loss: 78784.9023; train_gene_expr_recon_loss: 105292.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452227.2109; train_optim_loss: 452227.2109; val_kl_reg_loss: 5749.0635; val_edge_recon_loss: 263749.8125; val_cond_contrastive_loss: 78438.8984; val_gene_expr_recon_loss: 105424.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453362.6250; val_optim_loss: 453362.6250
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9804; val_auprc_score: 0.9731; val_best_acc_score: 0.9392; val_best_f1_score: 0.9406; train_kl_reg_loss: 5855.0518; train_edge_recon_loss: 261595.6836; train_cond_contrastive_loss: 78785.7500; train_gene_expr_recon_loss: 105538.8887; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451775.3750; train_optim_loss: 451775.3750; val_kl_reg_loss: 5748.1455; val_edge_recon_loss: 261678.2812; val_cond_contrastive_loss: 78439.0469; val_gene_expr_recon_loss: 105422.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451287.9688; val_optim_loss: 451287.9688
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9779; val_auprc_score: 0.9712; val_best_acc_score: 0.9323; val_best_f1_score: 0.9346; train_kl_reg_loss: 5856.3043; train_edge_recon_loss: 262482.8164; train_cond_contrastive_loss: 78784.1484; train_gene_expr_recon_loss: 105471.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452594.7578; train_optim_loss: 452594.7578; val_kl_reg_loss: 5740.0771; val_edge_recon_loss: 263370.5938; val_cond_contrastive_loss: 78438.5625; val_gene_expr_recon_loss: 105420.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452969.2812; val_optim_loss: 452969.2812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 11 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9792
Val AUPRC score: 0.9746
Val best accuracy score: 0.9334
Val best F1 score: 0.9351
Val gene expr MSE score: 1.7462
Duration of model training in run 3: 0 hours, 2 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7104; val_auprc_score: 0.7569; val_best_acc_score: 0.6687; val_best_f1_score: 0.6764; train_kl_reg_loss: 2402.0190; train_edge_recon_loss: 354207.8047; train_cond_contrastive_loss: 114931.9824; train_gene_expr_recon_loss: 140626.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 612168.2500; train_optim_loss: 612168.2500; val_kl_reg_loss: 15330.5801; val_edge_recon_loss: 404064.6562; val_cond_contrastive_loss: 78363.0156; val_gene_expr_recon_loss: 123025.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 620784.1250; val_optim_loss: 620784.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6650; val_auprc_score: 0.7061; val_best_acc_score: 0.6148; val_best_f1_score: 0.6762; train_kl_reg_loss: 8746.1499; train_edge_recon_loss: 367366.3281; train_cond_contrastive_loss: 82279.0488; train_gene_expr_recon_loss: 122472.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 580863.6562; train_optim_loss: 580863.6562; val_kl_reg_loss: 3228.8892; val_edge_recon_loss: 394097.0625; val_cond_contrastive_loss: 78380.4766; val_gene_expr_recon_loss: 117353.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 593059.6875; val_optim_loss: 593059.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6510; val_auprc_score: 0.6921; val_best_acc_score: 0.6001; val_best_f1_score: 0.6740; train_kl_reg_loss: 2868.1575; train_edge_recon_loss: 353991.8672; train_cond_contrastive_loss: 91035.7910; train_gene_expr_recon_loss: 116288.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564184.1406; train_optim_loss: 564184.1406; val_kl_reg_loss: 2323.8792; val_edge_recon_loss: 372032.9062; val_cond_contrastive_loss: 78455.3984; val_gene_expr_recon_loss: 115539.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568351.6250; val_optim_loss: 568351.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6557; val_auprc_score: 0.6892; val_best_acc_score: 0.6108; val_best_f1_score: 0.6807; train_kl_reg_loss: 2293.9944; train_edge_recon_loss: 341432.8984; train_cond_contrastive_loss: 92031.4023; train_gene_expr_recon_loss: 115231.7988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550990.1094; train_optim_loss: 550990.1094; val_kl_reg_loss: 2339.6121; val_edge_recon_loss: 349241.4062; val_cond_contrastive_loss: 78434.7500; val_gene_expr_recon_loss: 114777.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 544793.7500; val_optim_loss: 544793.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6628; val_auprc_score: 0.7031; val_best_acc_score: 0.6200; val_best_f1_score: 0.6845; train_kl_reg_loss: 2618.0480; train_edge_recon_loss: 331389.7422; train_cond_contrastive_loss: 84359.6699; train_gene_expr_recon_loss: 114956.5371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533324.0000; train_optim_loss: 533324.0000; val_kl_reg_loss: 3042.6299; val_edge_recon_loss: 346465.5312; val_cond_contrastive_loss: 78375.7344; val_gene_expr_recon_loss: 114148.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542032.3750; val_optim_loss: 542032.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6681; val_auprc_score: 0.7084; val_best_acc_score: 0.6207; val_best_f1_score: 0.6869; train_kl_reg_loss: 3343.4499; train_edge_recon_loss: 330188.6094; train_cond_contrastive_loss: 80972.5195; train_gene_expr_recon_loss: 113790.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528294.5938; train_optim_loss: 528294.5938; val_kl_reg_loss: 3632.4854; val_edge_recon_loss: 345340.9688; val_cond_contrastive_loss: 78357.4531; val_gene_expr_recon_loss: 113573.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540904.0625; val_optim_loss: 540904.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6905; val_auprc_score: 0.7281; val_best_acc_score: 0.6350; val_best_f1_score: 0.6938; train_kl_reg_loss: 3734.1944; train_edge_recon_loss: 328533.5547; train_cond_contrastive_loss: 79786.7520; train_gene_expr_recon_loss: 113740.5020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525795.0156; train_optim_loss: 525795.0156; val_kl_reg_loss: 3674.4102; val_edge_recon_loss: 337235.4688; val_cond_contrastive_loss: 78359.3438; val_gene_expr_recon_loss: 113228.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 532498.1875; val_optim_loss: 532498.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7084; val_auprc_score: 0.7378; val_best_acc_score: 0.6505; val_best_f1_score: 0.6937; train_kl_reg_loss: 3602.9883; train_edge_recon_loss: 325164.6250; train_cond_contrastive_loss: 79481.8398; train_gene_expr_recon_loss: 112924.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521173.5312; train_optim_loss: 521173.5312; val_kl_reg_loss: 3494.4187; val_edge_recon_loss: 333749.2812; val_cond_contrastive_loss: 78364.2344; val_gene_expr_recon_loss: 112866.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528474.0000; val_optim_loss: 528474.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7565; val_auprc_score: 0.7697; val_best_acc_score: 0.6804; val_best_f1_score: 0.7126; train_kl_reg_loss: 3565.3058; train_edge_recon_loss: 316137.0625; train_cond_contrastive_loss: 79607.9941; train_gene_expr_recon_loss: 112512.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511822.3750; train_optim_loss: 511822.3750; val_kl_reg_loss: 3755.2607; val_edge_recon_loss: 315175.4688; val_cond_contrastive_loss: 78384.8906; val_gene_expr_recon_loss: 112413.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509728.7500; val_optim_loss: 509728.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7937; val_auprc_score: 0.7842; val_best_acc_score: 0.7140; val_best_f1_score: 0.7500; train_kl_reg_loss: 4204.9926; train_edge_recon_loss: 304984.6641; train_cond_contrastive_loss: 79230.2637; train_gene_expr_recon_loss: 111783.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500203.5781; train_optim_loss: 500203.5781; val_kl_reg_loss: 4928.6836; val_edge_recon_loss: 300382.2500; val_cond_contrastive_loss: 78406.2031; val_gene_expr_recon_loss: 111874.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 495591.1875; val_optim_loss: 495591.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8095; val_auprc_score: 0.7904; val_best_acc_score: 0.7409; val_best_f1_score: 0.7811; train_kl_reg_loss: 5567.8384; train_edge_recon_loss: 292439.2109; train_cond_contrastive_loss: 78817.7734; train_gene_expr_recon_loss: 111845.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488670.5156; train_optim_loss: 488670.5156; val_kl_reg_loss: 6449.3135; val_edge_recon_loss: 287523.9688; val_cond_contrastive_loss: 78409.4766; val_gene_expr_recon_loss: 111345.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483727.8750; val_optim_loss: 483727.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8186; val_auprc_score: 0.7927; val_best_acc_score: 0.7435; val_best_f1_score: 0.7793; train_kl_reg_loss: 7022.4634; train_edge_recon_loss: 288561.9453; train_cond_contrastive_loss: 78636.4629; train_gene_expr_recon_loss: 111035.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485256.6406; train_optim_loss: 485256.6406; val_kl_reg_loss: 7531.3447; val_edge_recon_loss: 291710.8125; val_cond_contrastive_loss: 78399.1172; val_gene_expr_recon_loss: 110897.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488539.0312; val_optim_loss: 488539.0312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8318; val_auprc_score: 0.8064; val_best_acc_score: 0.7595; val_best_f1_score: 0.7877; train_kl_reg_loss: 7860.3732; train_edge_recon_loss: 284560.2969; train_cond_contrastive_loss: 78608.3145; train_gene_expr_recon_loss: 110950.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481978.9922; train_optim_loss: 481978.9922; val_kl_reg_loss: 7887.0420; val_edge_recon_loss: 287011.7500; val_cond_contrastive_loss: 78393.0391; val_gene_expr_recon_loss: 110540.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483832.0312; val_optim_loss: 483832.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8432; val_auprc_score: 0.8137; val_best_acc_score: 0.7718; val_best_f1_score: 0.7981; train_kl_reg_loss: 7947.3220; train_edge_recon_loss: 283567.7891; train_cond_contrastive_loss: 78637.8555; train_gene_expr_recon_loss: 110589.2148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480742.1719; train_optim_loss: 480742.1719; val_kl_reg_loss: 7611.2656; val_edge_recon_loss: 282634.8125; val_cond_contrastive_loss: 78390.4922; val_gene_expr_recon_loss: 110187.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478824.1875; val_optim_loss: 478824.1875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8545; val_auprc_score: 0.8214; val_best_acc_score: 0.7871; val_best_f1_score: 0.8123; train_kl_reg_loss: 7514.4918; train_edge_recon_loss: 281013.6797; train_cond_contrastive_loss: 78718.2441; train_gene_expr_recon_loss: 110112.8770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477359.2969; train_optim_loss: 477359.2969; val_kl_reg_loss: 7021.8447; val_edge_recon_loss: 278663.9375; val_cond_contrastive_loss: 78395.2188; val_gene_expr_recon_loss: 109893.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473974.6875; val_optim_loss: 473974.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8611; val_auprc_score: 0.8254; val_best_acc_score: 0.7990; val_best_f1_score: 0.8219; train_kl_reg_loss: 6899.8102; train_edge_recon_loss: 278467.3359; train_cond_contrastive_loss: 78864.5957; train_gene_expr_recon_loss: 110455.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474686.9453; train_optim_loss: 474686.9453; val_kl_reg_loss: 6541.7549; val_edge_recon_loss: 279631.3750; val_cond_contrastive_loss: 78399.0156; val_gene_expr_recon_loss: 109659.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474231.4688; val_optim_loss: 474231.4688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8765; val_auprc_score: 0.8479; val_best_acc_score: 0.8109; val_best_f1_score: 0.8339; train_kl_reg_loss: 6575.0015; train_edge_recon_loss: 277482.8438; train_cond_contrastive_loss: 78933.0117; train_gene_expr_recon_loss: 109458.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472449.2578; train_optim_loss: 472449.2578; val_kl_reg_loss: 6420.4990; val_edge_recon_loss: 277099.4688; val_cond_contrastive_loss: 78408.1562; val_gene_expr_recon_loss: 109384.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471312.2812; val_optim_loss: 471312.2812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8911; val_auprc_score: 0.8687; val_best_acc_score: 0.8240; val_best_f1_score: 0.8437; train_kl_reg_loss: 6527.5878; train_edge_recon_loss: 276130.5859; train_cond_contrastive_loss: 78895.8613; train_gene_expr_recon_loss: 109907.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471461.6641; train_optim_loss: 471461.6641; val_kl_reg_loss: 6453.6406; val_edge_recon_loss: 273556.7500; val_cond_contrastive_loss: 78419.8516; val_gene_expr_recon_loss: 109111.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467541.6875; val_optim_loss: 467541.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9127; val_auprc_score: 0.8938; val_best_acc_score: 0.8435; val_best_f1_score: 0.8561; train_kl_reg_loss: 6559.3352; train_edge_recon_loss: 272838.9844; train_cond_contrastive_loss: 78849.1621; train_gene_expr_recon_loss: 108995.0879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467242.5625; train_optim_loss: 467242.5625; val_kl_reg_loss: 6458.7974; val_edge_recon_loss: 270333.7812; val_cond_contrastive_loss: 78426.7500; val_gene_expr_recon_loss: 108867.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464087.0625; val_optim_loss: 464087.0625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9171; val_auprc_score: 0.9039; val_best_acc_score: 0.8395; val_best_f1_score: 0.8509; train_kl_reg_loss: 6542.3969; train_edge_recon_loss: 272622.7734; train_cond_contrastive_loss: 78797.3086; train_gene_expr_recon_loss: 108885.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466847.5625; train_optim_loss: 466847.5625; val_kl_reg_loss: 6323.2988; val_edge_recon_loss: 275219.2500; val_cond_contrastive_loss: 78430.5000; val_gene_expr_recon_loss: 108626.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468599.8750; val_optim_loss: 468599.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9268; val_auprc_score: 0.9132; val_best_acc_score: 0.8521; val_best_f1_score: 0.8604; train_kl_reg_loss: 6361.5194; train_edge_recon_loss: 272427.5469; train_cond_contrastive_loss: 78788.7656; train_gene_expr_recon_loss: 108019.0605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465596.8750; train_optim_loss: 465596.8750; val_kl_reg_loss: 6163.3438; val_edge_recon_loss: 270811.6562; val_cond_contrastive_loss: 78428.9141; val_gene_expr_recon_loss: 108384.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463788.5625; val_optim_loss: 463788.5625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9388; val_auprc_score: 0.9307; val_best_acc_score: 0.8664; val_best_f1_score: 0.8747; train_kl_reg_loss: 6287.2548; train_edge_recon_loss: 270879.3828; train_cond_contrastive_loss: 78745.4512; train_gene_expr_recon_loss: 108527.9121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464440.0078; train_optim_loss: 464440.0078; val_kl_reg_loss: 6053.2422; val_edge_recon_loss: 267485.4375; val_cond_contrastive_loss: 78425.0547; val_gene_expr_recon_loss: 108161.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460125.0000; val_optim_loss: 460125.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9431; val_auprc_score: 0.9339; val_best_acc_score: 0.8747; val_best_f1_score: 0.8806; train_kl_reg_loss: 6193.8147; train_edge_recon_loss: 269661.7344; train_cond_contrastive_loss: 78722.7480; train_gene_expr_recon_loss: 108086.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462665.0000; train_optim_loss: 462665.0000; val_kl_reg_loss: 6060.9277; val_edge_recon_loss: 267525.3438; val_cond_contrastive_loss: 78420.6406; val_gene_expr_recon_loss: 107945.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459952.3125; val_optim_loss: 459952.3125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9455; val_auprc_score: 0.9333; val_best_acc_score: 0.8771; val_best_f1_score: 0.8822; train_kl_reg_loss: 6224.0802; train_edge_recon_loss: 268739.9531; train_cond_contrastive_loss: 78686.7793; train_gene_expr_recon_loss: 107445.3496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461096.1484; train_optim_loss: 461096.1484; val_kl_reg_loss: 6154.5879; val_edge_recon_loss: 270059.1875; val_cond_contrastive_loss: 78417.9531; val_gene_expr_recon_loss: 107724.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462356.5625; val_optim_loss: 462356.5625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9528; val_auprc_score: 0.9461; val_best_acc_score: 0.8881; val_best_f1_score: 0.8916; train_kl_reg_loss: 6289.9980; train_edge_recon_loss: 269300.5469; train_cond_contrastive_loss: 78655.7266; train_gene_expr_recon_loss: 107812.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462058.6250; train_optim_loss: 462058.6250; val_kl_reg_loss: 6139.4414; val_edge_recon_loss: 267432.4062; val_cond_contrastive_loss: 78417.6562; val_gene_expr_recon_loss: 107503.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459492.5000; val_optim_loss: 459492.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9602; val_auprc_score: 0.9538; val_best_acc_score: 0.9033; val_best_f1_score: 0.9050; train_kl_reg_loss: 6242.2985; train_edge_recon_loss: 268616.2734; train_cond_contrastive_loss: 78662.1270; train_gene_expr_recon_loss: 106993.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460514.5859; train_optim_loss: 460514.5859; val_kl_reg_loss: 6003.1880; val_edge_recon_loss: 268898.0312; val_cond_contrastive_loss: 78418.7109; val_gene_expr_recon_loss: 107277.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460597.9062; val_optim_loss: 460597.9062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9676; val_auprc_score: 0.9634; val_best_acc_score: 0.9147; val_best_f1_score: 0.9154; train_kl_reg_loss: 6101.6519; train_edge_recon_loss: 267995.6719; train_cond_contrastive_loss: 78690.4746; train_gene_expr_recon_loss: 107690.8652; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460478.6641; train_optim_loss: 460478.6641; val_kl_reg_loss: 5860.3564; val_edge_recon_loss: 266619.7188; val_cond_contrastive_loss: 78421.8438; val_gene_expr_recon_loss: 107037.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457938.9375; val_optim_loss: 457938.9375
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9681; val_auprc_score: 0.9626; val_best_acc_score: 0.9153; val_best_f1_score: 0.9171; train_kl_reg_loss: 5964.6191; train_edge_recon_loss: 266168.0938; train_cond_contrastive_loss: 78715.9551; train_gene_expr_recon_loss: 107106.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457955.1328; train_optim_loss: 457955.1328; val_kl_reg_loss: 5794.1182; val_edge_recon_loss: 266311.9062; val_cond_contrastive_loss: 78420.6562; val_gene_expr_recon_loss: 106826.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457353.2500; val_optim_loss: 457353.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9697; val_auprc_score: 0.9640; val_best_acc_score: 0.9193; val_best_f1_score: 0.9215; train_kl_reg_loss: 5950.0825; train_edge_recon_loss: 264534.7109; train_cond_contrastive_loss: 78730.1934; train_gene_expr_recon_loss: 106794.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456009.8750; train_optim_loss: 456009.8750; val_kl_reg_loss: 5827.6123; val_edge_recon_loss: 265390.2812; val_cond_contrastive_loss: 78417.9688; val_gene_expr_recon_loss: 106604.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456240.1250; val_optim_loss: 456240.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9745; val_auprc_score: 0.9710; val_best_acc_score: 0.9241; val_best_f1_score: 0.9258; train_kl_reg_loss: 5930.1404; train_edge_recon_loss: 265214.8984; train_cond_contrastive_loss: 78744.6621; train_gene_expr_recon_loss: 107358.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457248.5078; train_optim_loss: 457248.5078; val_kl_reg_loss: 5763.8091; val_edge_recon_loss: 263348.2500; val_cond_contrastive_loss: 78417.4375; val_gene_expr_recon_loss: 106432.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453962.1250; val_optim_loss: 453962.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9743; val_auprc_score: 0.9678; val_best_acc_score: 0.9272; val_best_f1_score: 0.9286; train_kl_reg_loss: 5890.9539; train_edge_recon_loss: 264711.1797; train_cond_contrastive_loss: 78760.4746; train_gene_expr_recon_loss: 106414.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455777.3281; train_optim_loss: 455777.3281; val_kl_reg_loss: 5772.4600; val_edge_recon_loss: 265359.0312; val_cond_contrastive_loss: 78419.2188; val_gene_expr_recon_loss: 106247.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455798.5625; val_optim_loss: 455798.5625
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9711; val_best_acc_score: 0.9303; val_best_f1_score: 0.9313; train_kl_reg_loss: 5903.9736; train_edge_recon_loss: 263051.1367; train_cond_contrastive_loss: 78763.4121; train_gene_expr_recon_loss: 106271.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453989.7109; train_optim_loss: 453989.7109; val_kl_reg_loss: 5785.7412; val_edge_recon_loss: 264854.2812; val_cond_contrastive_loss: 78424.1641; val_gene_expr_recon_loss: 106084.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455148.9688; val_optim_loss: 455148.9688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9786; val_auprc_score: 0.9749; val_best_acc_score: 0.9353; val_best_f1_score: 0.9368; train_kl_reg_loss: 5907.6283; train_edge_recon_loss: 263707.4883; train_cond_contrastive_loss: 78770.0625; train_gene_expr_recon_loss: 106551.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454937.1562; train_optim_loss: 454937.1562; val_kl_reg_loss: 5780.7402; val_edge_recon_loss: 260543.3750; val_cond_contrastive_loss: 78433.2266; val_gene_expr_recon_loss: 105896.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450653.5625; val_optim_loss: 450653.5625
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9796; val_auprc_score: 0.9728; val_best_acc_score: 0.9363; val_best_f1_score: 0.9377; train_kl_reg_loss: 5910.1584; train_edge_recon_loss: 262649.3672; train_cond_contrastive_loss: 78780.4844; train_gene_expr_recon_loss: 105789.3379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453129.3516; train_optim_loss: 453129.3516; val_kl_reg_loss: 5792.5283; val_edge_recon_loss: 264378.0625; val_cond_contrastive_loss: 78435.7188; val_gene_expr_recon_loss: 105665.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454271.7188; val_optim_loss: 454271.7188
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9797; val_auprc_score: 0.9732; val_best_acc_score: 0.9403; val_best_f1_score: 0.9414; train_kl_reg_loss: 5923.5729; train_edge_recon_loss: 263811.6953; train_cond_contrastive_loss: 78776.9629; train_gene_expr_recon_loss: 105629.9316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454142.1562; train_optim_loss: 454142.1562; val_kl_reg_loss: 5782.5415; val_edge_recon_loss: 263352.3750; val_cond_contrastive_loss: 78438.8672; val_gene_expr_recon_loss: 105426.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453000.4062; val_optim_loss: 453000.4062
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9800; val_auprc_score: 0.9731; val_best_acc_score: 0.9421; val_best_f1_score: 0.9424; train_kl_reg_loss: 5872.2107; train_edge_recon_loss: 262021.3828; train_cond_contrastive_loss: 78799.7324; train_gene_expr_recon_loss: 105089.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451782.9844; train_optim_loss: 451782.9844; val_kl_reg_loss: 5786.0435; val_edge_recon_loss: 263575.0625; val_cond_contrastive_loss: 78442.2344; val_gene_expr_recon_loss: 105235.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453038.8125; val_optim_loss: 453038.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9833; val_auprc_score: 0.9768; val_best_acc_score: 0.9432; val_best_f1_score: 0.9444; train_kl_reg_loss: 5883.9680; train_edge_recon_loss: 261213.9570; train_cond_contrastive_loss: 78795.5977; train_gene_expr_recon_loss: 105067.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450960.8125; train_optim_loss: 450960.8125; val_kl_reg_loss: 5776.6455; val_edge_recon_loss: 259226.7344; val_cond_contrastive_loss: 78444.0547; val_gene_expr_recon_loss: 105195.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448642.6875; val_optim_loss: 448642.6875
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9833; val_auprc_score: 0.9787; val_best_acc_score: 0.9450; val_best_f1_score: 0.9458; train_kl_reg_loss: 5885.6013; train_edge_recon_loss: 261810.2422; train_cond_contrastive_loss: 78806.7324; train_gene_expr_recon_loss: 105551.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452053.8828; train_optim_loss: 452053.8828; val_kl_reg_loss: 5778.9141; val_edge_recon_loss: 259608.9531; val_cond_contrastive_loss: 78444.6484; val_gene_expr_recon_loss: 105169.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449001.6250; val_optim_loss: 449001.6250
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9813; val_auprc_score: 0.9733; val_best_acc_score: 0.9408; val_best_f1_score: 0.9416; train_kl_reg_loss: 5886.8444; train_edge_recon_loss: 262485.9609; train_cond_contrastive_loss: 78803.7227; train_gene_expr_recon_loss: 104978.7246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452155.2578; train_optim_loss: 452155.2578; val_kl_reg_loss: 5783.4590; val_edge_recon_loss: 263262.2188; val_cond_contrastive_loss: 78445.0703; val_gene_expr_recon_loss: 105143.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452634.4688; val_optim_loss: 452634.4688
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9838; val_auprc_score: 0.9790; val_best_acc_score: 0.9466; val_best_f1_score: 0.9485; train_kl_reg_loss: 5912.6425; train_edge_recon_loss: 262311.4414; train_cond_contrastive_loss: 78797.3770; train_gene_expr_recon_loss: 105155.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452176.5156; train_optim_loss: 452176.5156; val_kl_reg_loss: 5804.5635; val_edge_recon_loss: 259718.7812; val_cond_contrastive_loss: 78445.6328; val_gene_expr_recon_loss: 105114.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449083.0312; val_optim_loss: 449083.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9825; val_auprc_score: 0.9768; val_best_acc_score: 0.9438; val_best_f1_score: 0.9441; train_kl_reg_loss: 5912.5084; train_edge_recon_loss: 262252.6680; train_cond_contrastive_loss: 78791.2129; train_gene_expr_recon_loss: 104787.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451744.0078; train_optim_loss: 451744.0078; val_kl_reg_loss: 5809.4219; val_edge_recon_loss: 263595.7500; val_cond_contrastive_loss: 78442.9531; val_gene_expr_recon_loss: 105109.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452958.0000; val_optim_loss: 452958.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9833; val_auprc_score: 0.9787; val_best_acc_score: 0.9420; val_best_f1_score: 0.9428; train_kl_reg_loss: 5907.8303; train_edge_recon_loss: 261662.7812; train_cond_contrastive_loss: 78793.5664; train_gene_expr_recon_loss: 104215.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450580.1484; train_optim_loss: 450580.1484; val_kl_reg_loss: 5807.0674; val_edge_recon_loss: 261809.8906; val_cond_contrastive_loss: 78445.0469; val_gene_expr_recon_loss: 105104.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451166.6875; val_optim_loss: 451166.6875
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9826; val_auprc_score: 0.9776; val_best_acc_score: 0.9427; val_best_f1_score: 0.9447; train_kl_reg_loss: 5918.5420; train_edge_recon_loss: 261818.3750; train_cond_contrastive_loss: 78794.7793; train_gene_expr_recon_loss: 105434.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451966.3750; train_optim_loss: 451966.3750; val_kl_reg_loss: 5810.5132; val_edge_recon_loss: 260095.6562; val_cond_contrastive_loss: 78445.1172; val_gene_expr_recon_loss: 105099.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449451.0000; val_optim_loss: 449451.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 18 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9821
Val AUPRC score: 0.9763
Val best accuracy score: 0.9419
Val best F1 score: 0.9440
Val gene expr MSE score: 1.7687
Duration of model training in run 4: 0 hours, 2 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7382; val_auprc_score: 0.7708; val_best_acc_score: 0.6581; val_best_f1_score: 0.7052; train_kl_reg_loss: 5312.3974; train_edge_recon_loss: 357742.8958; train_cond_contrastive_loss: 103904.4896; train_gene_expr_recon_loss: 135010.5924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 601970.3854; train_optim_loss: 601970.3854; val_kl_reg_loss: 7344.6104; val_edge_recon_loss: 397322.6250; val_cond_contrastive_loss: 78345.6719; val_gene_expr_recon_loss: 120092.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 603104.9375; val_optim_loss: 603104.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7014; val_auprc_score: 0.7204; val_best_acc_score: 0.6326; val_best_f1_score: 0.7017; train_kl_reg_loss: 5814.5731; train_edge_recon_loss: 355010.2604; train_cond_contrastive_loss: 85157.8372; train_gene_expr_recon_loss: 118398.6224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564381.3021; train_optim_loss: 564381.3021; val_kl_reg_loss: 3690.5176; val_edge_recon_loss: 376232.3438; val_cond_contrastive_loss: 78385.7891; val_gene_expr_recon_loss: 116805.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575114.1250; val_optim_loss: 575114.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6930; val_auprc_score: 0.7145; val_best_acc_score: 0.6269; val_best_f1_score: 0.6932; train_kl_reg_loss: 3455.0899; train_edge_recon_loss: 342286.6094; train_cond_contrastive_loss: 88240.0573; train_gene_expr_recon_loss: 116837.5221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550819.2812; train_optim_loss: 550819.2812; val_kl_reg_loss: 3253.3467; val_edge_recon_loss: 346135.4375; val_cond_contrastive_loss: 78384.9062; val_gene_expr_recon_loss: 116029.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 543803.3750; val_optim_loss: 543803.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7027; val_auprc_score: 0.7292; val_best_acc_score: 0.6390; val_best_f1_score: 0.6917; train_kl_reg_loss: 3582.6785; train_edge_recon_loss: 328928.9844; train_cond_contrastive_loss: 84418.9245; train_gene_expr_recon_loss: 115329.6471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532260.2292; train_optim_loss: 532260.2292; val_kl_reg_loss: 4175.5850; val_edge_recon_loss: 338786.2188; val_cond_contrastive_loss: 78354.0391; val_gene_expr_recon_loss: 115100.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536416.6875; val_optim_loss: 536416.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7285; val_auprc_score: 0.7517; val_best_acc_score: 0.6609; val_best_f1_score: 0.6988; train_kl_reg_loss: 4562.8643; train_edge_recon_loss: 322139.6719; train_cond_contrastive_loss: 79833.0781; train_gene_expr_recon_loss: 114766.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521302.0365; train_optim_loss: 521302.0365; val_kl_reg_loss: 4825.1660; val_edge_recon_loss: 327486.7812; val_cond_contrastive_loss: 78356.0078; val_gene_expr_recon_loss: 114508.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 525176.0625; val_optim_loss: 525176.0625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7835; val_auprc_score: 0.7799; val_best_acc_score: 0.7034; val_best_f1_score: 0.7384; train_kl_reg_loss: 4863.8826; train_edge_recon_loss: 310720.2760; train_cond_contrastive_loss: 79298.8880; train_gene_expr_recon_loss: 114145.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 509028.6302; train_optim_loss: 509028.6302; val_kl_reg_loss: 4960.5020; val_edge_recon_loss: 302532.7188; val_cond_contrastive_loss: 78384.0234; val_gene_expr_recon_loss: 113866.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 499744.2500; val_optim_loss: 499744.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8193; val_auprc_score: 0.8005; val_best_acc_score: 0.7410; val_best_f1_score: 0.7750; train_kl_reg_loss: 5258.5394; train_edge_recon_loss: 293827.3073; train_cond_contrastive_loss: 79114.4154; train_gene_expr_recon_loss: 113454.9935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491655.2708; train_optim_loss: 491655.2708; val_kl_reg_loss: 5768.9287; val_edge_recon_loss: 294153.9062; val_cond_contrastive_loss: 78393.7812; val_gene_expr_recon_loss: 113027.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491344.1250; val_optim_loss: 491344.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8342; val_auprc_score: 0.8059; val_best_acc_score: 0.7608; val_best_f1_score: 0.7913; train_kl_reg_loss: 6146.6222; train_edge_recon_loss: 284545.6615; train_cond_contrastive_loss: 78907.3398; train_gene_expr_recon_loss: 112650.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482250.3698; train_optim_loss: 482250.3698; val_kl_reg_loss: 6434.6973; val_edge_recon_loss: 287432.8750; val_cond_contrastive_loss: 78380.6406; val_gene_expr_recon_loss: 112378.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484626.5000; val_optim_loss: 484626.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8486; val_auprc_score: 0.8205; val_best_acc_score: 0.7719; val_best_f1_score: 0.7976; train_kl_reg_loss: 6523.8207; train_edge_recon_loss: 282539.5417; train_cond_contrastive_loss: 78855.2708; train_gene_expr_recon_loss: 112018.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479937.0833; train_optim_loss: 479937.0833; val_kl_reg_loss: 6415.8188; val_edge_recon_loss: 285658.1562; val_cond_contrastive_loss: 78371.2969; val_gene_expr_recon_loss: 111813.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482259.0000; val_optim_loss: 482259.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8653; val_auprc_score: 0.8402; val_best_acc_score: 0.7910; val_best_f1_score: 0.8148; train_kl_reg_loss: 6387.0847; train_edge_recon_loss: 278531.3594; train_cond_contrastive_loss: 78949.7435; train_gene_expr_recon_loss: 111453.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475321.7708; train_optim_loss: 475321.7708; val_kl_reg_loss: 6224.7383; val_edge_recon_loss: 278218.3438; val_cond_contrastive_loss: 78376.5312; val_gene_expr_recon_loss: 111398.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474217.7500; val_optim_loss: 474217.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8789; val_auprc_score: 0.8481; val_best_acc_score: 0.8125; val_best_f1_score: 0.8304; train_kl_reg_loss: 6313.0880; train_edge_recon_loss: 278604.7240; train_cond_contrastive_loss: 78935.9010; train_gene_expr_recon_loss: 111170.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475024.4219; train_optim_loss: 475024.4219; val_kl_reg_loss: 6289.8228; val_edge_recon_loss: 276800.8125; val_cond_contrastive_loss: 78388.2031; val_gene_expr_recon_loss: 111020.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472499.6250; val_optim_loss: 472499.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9021; val_auprc_score: 0.8752; val_best_acc_score: 0.8344; val_best_f1_score: 0.8472; train_kl_reg_loss: 6384.8076; train_edge_recon_loss: 273650.0000; train_cond_contrastive_loss: 78854.3659; train_gene_expr_recon_loss: 110833.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469722.5938; train_optim_loss: 469722.5938; val_kl_reg_loss: 6226.8159; val_edge_recon_loss: 274892.9062; val_cond_contrastive_loss: 78402.6875; val_gene_expr_recon_loss: 110601.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470124.1250; val_optim_loss: 470124.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9202; val_auprc_score: 0.9024; val_best_acc_score: 0.8459; val_best_f1_score: 0.8603; train_kl_reg_loss: 6192.3468; train_edge_recon_loss: 272509.8281; train_cond_contrastive_loss: 78895.0990; train_gene_expr_recon_loss: 110266.6042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467863.8646; train_optim_loss: 467863.8646; val_kl_reg_loss: 5997.5288; val_edge_recon_loss: 269499.0000; val_cond_contrastive_loss: 78418.1406; val_gene_expr_recon_loss: 110189.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464104.5312; val_optim_loss: 464104.5312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9326; val_auprc_score: 0.9190; val_best_acc_score: 0.8588; val_best_f1_score: 0.8656; train_kl_reg_loss: 6067.1152; train_edge_recon_loss: 270921.9115; train_cond_contrastive_loss: 78950.5599; train_gene_expr_recon_loss: 109933.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465872.6302; train_optim_loss: 465872.6302; val_kl_reg_loss: 6022.2305; val_edge_recon_loss: 273022.8750; val_cond_contrastive_loss: 78423.6875; val_gene_expr_recon_loss: 109821.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467290.0000; val_optim_loss: 467290.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9421; val_auprc_score: 0.9293; val_best_acc_score: 0.8764; val_best_f1_score: 0.8819; train_kl_reg_loss: 6140.2480; train_edge_recon_loss: 268956.2135; train_cond_contrastive_loss: 78875.9375; train_gene_expr_recon_loss: 109523.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463495.7344; train_optim_loss: 463495.7344; val_kl_reg_loss: 6079.4824; val_edge_recon_loss: 268181.8438; val_cond_contrastive_loss: 78418.7344; val_gene_expr_recon_loss: 109468.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462148.7188; val_optim_loss: 462148.7188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9504; val_auprc_score: 0.9391; val_best_acc_score: 0.8854; val_best_f1_score: 0.8921; train_kl_reg_loss: 6168.9383; train_edge_recon_loss: 268630.0885; train_cond_contrastive_loss: 78774.7396; train_gene_expr_recon_loss: 109188.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462762.5625; train_optim_loss: 462762.5625; val_kl_reg_loss: 6022.8184; val_edge_recon_loss: 269235.7812; val_cond_contrastive_loss: 78410.0391; val_gene_expr_recon_loss: 109148.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462816.8125; val_optim_loss: 462816.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9540; val_auprc_score: 0.9450; val_best_acc_score: 0.8882; val_best_f1_score: 0.8936; train_kl_reg_loss: 6106.3273; train_edge_recon_loss: 268533.8542; train_cond_contrastive_loss: 78699.8398; train_gene_expr_recon_loss: 109025.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462365.7240; train_optim_loss: 462365.7240; val_kl_reg_loss: 5999.2295; val_edge_recon_loss: 272288.6562; val_cond_contrastive_loss: 78404.0859; val_gene_expr_recon_loss: 108833.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465525.4688; val_optim_loss: 465525.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9600; val_auprc_score: 0.9507; val_best_acc_score: 0.8985; val_best_f1_score: 0.9009; train_kl_reg_loss: 6054.3333; train_edge_recon_loss: 266282.4583; train_cond_contrastive_loss: 78657.1159; train_gene_expr_recon_loss: 108465.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459459.3854; train_optim_loss: 459459.3854; val_kl_reg_loss: 5913.2617; val_edge_recon_loss: 271153.9375; val_cond_contrastive_loss: 78406.5703; val_gene_expr_recon_loss: 108470.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463944.6875; val_optim_loss: 463944.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9641; val_auprc_score: 0.9541; val_best_acc_score: 0.9084; val_best_f1_score: 0.9101; train_kl_reg_loss: 5989.9696; train_edge_recon_loss: 265760.8828; train_cond_contrastive_loss: 78655.7826; train_gene_expr_recon_loss: 108142.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458549.2031; train_optim_loss: 458549.2031; val_kl_reg_loss: 5901.9131; val_edge_recon_loss: 268292.5938; val_cond_contrastive_loss: 78407.7266; val_gene_expr_recon_loss: 108424.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461026.3750; val_optim_loss: 461026.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9640; val_auprc_score: 0.9560; val_best_acc_score: 0.9092; val_best_f1_score: 0.9108; train_kl_reg_loss: 5983.5847; train_edge_recon_loss: 266602.5521; train_cond_contrastive_loss: 78653.3906; train_gene_expr_recon_loss: 108126.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459366.1510; train_optim_loss: 459366.1510; val_kl_reg_loss: 5881.4058; val_edge_recon_loss: 269641.0938; val_cond_contrastive_loss: 78408.6484; val_gene_expr_recon_loss: 108382.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462313.4062; val_optim_loss: 462313.4062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9654; val_auprc_score: 0.9585; val_best_acc_score: 0.9111; val_best_f1_score: 0.9128; train_kl_reg_loss: 5945.0743; train_edge_recon_loss: 268939.8698; train_cond_contrastive_loss: 78660.2513; train_gene_expr_recon_loss: 108019.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461564.5260; train_optim_loss: 461564.5260; val_kl_reg_loss: 5834.9521; val_edge_recon_loss: 266800.2500; val_cond_contrastive_loss: 78409.6562; val_gene_expr_recon_loss: 108346.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459391.7188; val_optim_loss: 459391.7188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9623; val_auprc_score: 0.9519; val_best_acc_score: 0.9058; val_best_f1_score: 0.9083; train_kl_reg_loss: 5914.8218; train_edge_recon_loss: 267171.7188; train_cond_contrastive_loss: 78672.1328; train_gene_expr_recon_loss: 108180.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459939.0469; train_optim_loss: 459939.0469; val_kl_reg_loss: 5809.8975; val_edge_recon_loss: 266819.5312; val_cond_contrastive_loss: 78411.2344; val_gene_expr_recon_loss: 108311.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459351.8750; val_optim_loss: 459351.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9649; val_auprc_score: 0.9575; val_best_acc_score: 0.9119; val_best_f1_score: 0.9141; train_kl_reg_loss: 5884.0579; train_edge_recon_loss: 267365.6667; train_cond_contrastive_loss: 78669.9180; train_gene_expr_recon_loss: 108215.0456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460134.6771; train_optim_loss: 460134.6771; val_kl_reg_loss: 5786.1650; val_edge_recon_loss: 265196.8438; val_cond_contrastive_loss: 78411.9609; val_gene_expr_recon_loss: 108276.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457671.1562; val_optim_loss: 457671.1562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9664; val_auprc_score: 0.9592; val_best_acc_score: 0.9123; val_best_f1_score: 0.9141; train_kl_reg_loss: 5866.7771; train_edge_recon_loss: 265818.1146; train_cond_contrastive_loss: 78682.6354; train_gene_expr_recon_loss: 108096.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458463.9583; train_optim_loss: 458463.9583; val_kl_reg_loss: 5776.2915; val_edge_recon_loss: 267417.6875; val_cond_contrastive_loss: 78413.2344; val_gene_expr_recon_loss: 108238.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459845.7500; val_optim_loss: 459845.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9683; val_auprc_score: 0.9578; val_best_acc_score: 0.9174; val_best_f1_score: 0.9189; train_kl_reg_loss: 5861.6391; train_edge_recon_loss: 267879.7344; train_cond_contrastive_loss: 78678.7057; train_gene_expr_recon_loss: 108095.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460515.4219; train_optim_loss: 460515.4219; val_kl_reg_loss: 5788.2383; val_edge_recon_loss: 266088.7500; val_cond_contrastive_loss: 78413.7266; val_gene_expr_recon_loss: 108201.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458492.0000; val_optim_loss: 458492.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9690; val_auprc_score: 0.9633; val_best_acc_score: 0.9160; val_best_f1_score: 0.9177; train_kl_reg_loss: 5869.4348; train_edge_recon_loss: 265707.2812; train_cond_contrastive_loss: 78681.2474; train_gene_expr_recon_loss: 107889.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458147.1250; train_optim_loss: 458147.1250; val_kl_reg_loss: 5759.7383; val_edge_recon_loss: 265492.4688; val_cond_contrastive_loss: 78415.0000; val_gene_expr_recon_loss: 108167.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457835.1875; val_optim_loss: 457835.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9692; val_auprc_score: 0.9628; val_best_acc_score: 0.9164; val_best_f1_score: 0.9177; train_kl_reg_loss: 5861.4186; train_edge_recon_loss: 266400.2656; train_cond_contrastive_loss: 78682.7760; train_gene_expr_recon_loss: 107995.7096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458940.1615; train_optim_loss: 458940.1615; val_kl_reg_loss: 5764.9365; val_edge_recon_loss: 265150.5312; val_cond_contrastive_loss: 78414.7656; val_gene_expr_recon_loss: 108164.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457494.9375; val_optim_loss: 457494.9375
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9680; val_auprc_score: 0.9617; val_best_acc_score: 0.9146; val_best_f1_score: 0.9156; train_kl_reg_loss: 5860.7599; train_edge_recon_loss: 266090.5052; train_cond_contrastive_loss: 78685.6120; train_gene_expr_recon_loss: 108076.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458713.4792; train_optim_loss: 458713.4792; val_kl_reg_loss: 5759.3071; val_edge_recon_loss: 270115.9062; val_cond_contrastive_loss: 78414.3438; val_gene_expr_recon_loss: 108161.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462450.6562; val_optim_loss: 462450.6562
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9681; val_auprc_score: 0.9626; val_best_acc_score: 0.9159; val_best_f1_score: 0.9177; train_kl_reg_loss: 5859.9495; train_edge_recon_loss: 266002.3073; train_cond_contrastive_loss: 78682.0964; train_gene_expr_recon_loss: 108020.8151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458565.1615; train_optim_loss: 458565.1615; val_kl_reg_loss: 5755.9590; val_edge_recon_loss: 266401.0000; val_cond_contrastive_loss: 78414.5781; val_gene_expr_recon_loss: 108157.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458729.0625; val_optim_loss: 458729.0625
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9666; val_auprc_score: 0.9577; val_best_acc_score: 0.9126; val_best_f1_score: 0.9138; train_kl_reg_loss: 5858.8883; train_edge_recon_loss: 266499.2188; train_cond_contrastive_loss: 78677.5182; train_gene_expr_recon_loss: 107992.0690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459027.6875; train_optim_loss: 459027.6875; val_kl_reg_loss: 5765.6450; val_edge_recon_loss: 269926.3438; val_cond_contrastive_loss: 78414.3828; val_gene_expr_recon_loss: 108153.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462260.1875; val_optim_loss: 462260.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9685; val_auprc_score: 0.9622; val_best_acc_score: 0.9146; val_best_f1_score: 0.9156; train_kl_reg_loss: 5854.6099; train_edge_recon_loss: 266059.6771; train_cond_contrastive_loss: 78685.0234; train_gene_expr_recon_loss: 107976.2565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458575.5573; train_optim_loss: 458575.5573; val_kl_reg_loss: 5760.1108; val_edge_recon_loss: 270191.0000; val_cond_contrastive_loss: 78414.7031; val_gene_expr_recon_loss: 108153.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462519.2500; val_optim_loss: 462519.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9696; val_auprc_score: 0.9625; val_best_acc_score: 0.9185; val_best_f1_score: 0.9191; train_kl_reg_loss: 5859.6204; train_edge_recon_loss: 266083.4323; train_cond_contrastive_loss: 78681.9089; train_gene_expr_recon_loss: 108024.0807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458649.0260; train_optim_loss: 458649.0260; val_kl_reg_loss: 5758.3950; val_edge_recon_loss: 269043.7188; val_cond_contrastive_loss: 78413.9922; val_gene_expr_recon_loss: 108153.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461369.1875; val_optim_loss: 461369.1875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9719; val_auprc_score: 0.9665; val_best_acc_score: 0.9206; val_best_f1_score: 0.9221; train_kl_reg_loss: 5852.0096; train_edge_recon_loss: 266094.3333; train_cond_contrastive_loss: 78682.1068; train_gene_expr_recon_loss: 108034.1380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458662.5885; train_optim_loss: 458662.5885; val_kl_reg_loss: 5758.9263; val_edge_recon_loss: 265916.0938; val_cond_contrastive_loss: 78414.4844; val_gene_expr_recon_loss: 108152.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458242.1875; val_optim_loss: 458242.1875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 33 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9677
Val AUPRC score: 0.9607
Val best accuracy score: 0.9148
Val best F1 score: 0.9165
Val gene expr MSE score: 1.8455
Duration of model training in run 5: 0 hours, 2 minutes and 37 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7544; val_auprc_score: 0.7887; val_best_acc_score: 0.6752; val_best_f1_score: 0.7046; train_kl_reg_loss: 3716.0088; train_edge_recon_loss: 356007.8906; train_cond_contrastive_loss: 110853.0156; train_gene_expr_recon_loss: 133536.4154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 604113.3542; train_optim_loss: 604113.3542; val_kl_reg_loss: 13850.4092; val_edge_recon_loss: 402479.6250; val_cond_contrastive_loss: 78340.8828; val_gene_expr_recon_loss: 119258.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 613928.9375; val_optim_loss: 613928.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7164; val_auprc_score: 0.7412; val_best_acc_score: 0.6337; val_best_f1_score: 0.7022; train_kl_reg_loss: 9793.7410; train_edge_recon_loss: 356500.1979; train_cond_contrastive_loss: 88557.8320; train_gene_expr_recon_loss: 117357.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 572209.1979; train_optim_loss: 572209.1979; val_kl_reg_loss: 6949.3916; val_edge_recon_loss: 390474.7812; val_cond_contrastive_loss: 78370.5625; val_gene_expr_recon_loss: 116040.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 591835.4375; val_optim_loss: 591835.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7092; val_auprc_score: 0.7330; val_best_acc_score: 0.6387; val_best_f1_score: 0.6925; train_kl_reg_loss: 5041.5498; train_edge_recon_loss: 349213.6875; train_cond_contrastive_loss: 86719.9518; train_gene_expr_recon_loss: 114891.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 555866.5521; train_optim_loss: 555866.5521; val_kl_reg_loss: 3433.2695; val_edge_recon_loss: 349912.1875; val_cond_contrastive_loss: 78429.0391; val_gene_expr_recon_loss: 115212.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546986.6875; val_optim_loss: 546986.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7193; val_auprc_score: 0.7462; val_best_acc_score: 0.6563; val_best_f1_score: 0.6949; train_kl_reg_loss: 3455.1706; train_edge_recon_loss: 328521.0781; train_cond_contrastive_loss: 85374.5924; train_gene_expr_recon_loss: 114373.5247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531724.3698; train_optim_loss: 531724.3698; val_kl_reg_loss: 3805.0071; val_edge_recon_loss: 332718.6250; val_cond_contrastive_loss: 78374.2109; val_gene_expr_recon_loss: 114469.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 529367.0000; val_optim_loss: 529367.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7484; val_auprc_score: 0.7701; val_best_acc_score: 0.6712; val_best_f1_score: 0.7089; train_kl_reg_loss: 4293.3923; train_edge_recon_loss: 319104.8802; train_cond_contrastive_loss: 80030.7917; train_gene_expr_recon_loss: 113330.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 516759.7760; train_optim_loss: 516759.7760; val_kl_reg_loss: 4748.2002; val_edge_recon_loss: 318710.9062; val_cond_contrastive_loss: 78371.2344; val_gene_expr_recon_loss: 113649.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 515479.7500; val_optim_loss: 515479.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8142; val_auprc_score: 0.8071; val_best_acc_score: 0.7284; val_best_f1_score: 0.7580; train_kl_reg_loss: 5112.8564; train_edge_recon_loss: 303092.3698; train_cond_contrastive_loss: 79153.7565; train_gene_expr_recon_loss: 112632.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499991.1562; train_optim_loss: 499991.1562; val_kl_reg_loss: 5609.1318; val_edge_recon_loss: 297216.0938; val_cond_contrastive_loss: 78397.9688; val_gene_expr_recon_loss: 112902.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494126.0000; val_optim_loss: 494126.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8415; val_auprc_score: 0.8203; val_best_acc_score: 0.7577; val_best_f1_score: 0.7860; train_kl_reg_loss: 5962.5092; train_edge_recon_loss: 287737.4010; train_cond_contrastive_loss: 78853.0456; train_gene_expr_recon_loss: 111922.8815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484475.8438; train_optim_loss: 484475.8438; val_kl_reg_loss: 6197.1475; val_edge_recon_loss: 289562.8125; val_cond_contrastive_loss: 78397.5312; val_gene_expr_recon_loss: 112151.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486309.3438; val_optim_loss: 486309.3438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8625; val_auprc_score: 0.8393; val_best_acc_score: 0.7868; val_best_f1_score: 0.8116; train_kl_reg_loss: 6384.6123; train_edge_recon_loss: 280552.2656; train_cond_contrastive_loss: 78915.7344; train_gene_expr_recon_loss: 111400.8659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477253.4740; train_optim_loss: 477253.4740; val_kl_reg_loss: 6327.8921; val_edge_recon_loss: 279946.3750; val_cond_contrastive_loss: 78395.4219; val_gene_expr_recon_loss: 111606.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476276.5312; val_optim_loss: 476276.5312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8801; val_auprc_score: 0.8510; val_best_acc_score: 0.8107; val_best_f1_score: 0.8288; train_kl_reg_loss: 6414.2373; train_edge_recon_loss: 277321.8698; train_cond_contrastive_loss: 78969.7161; train_gene_expr_recon_loss: 110635.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473341.0365; train_optim_loss: 473341.0365; val_kl_reg_loss: 6239.5312; val_edge_recon_loss: 278247.0000; val_cond_contrastive_loss: 78394.6172; val_gene_expr_recon_loss: 111134.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474016.0938; val_optim_loss: 474016.0938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8945; val_auprc_score: 0.8650; val_best_acc_score: 0.8273; val_best_f1_score: 0.8438; train_kl_reg_loss: 6330.7275; train_edge_recon_loss: 274182.9635; train_cond_contrastive_loss: 79023.7773; train_gene_expr_recon_loss: 110151.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469688.8802; train_optim_loss: 469688.8802; val_kl_reg_loss: 6154.3213; val_edge_recon_loss: 276539.2500; val_cond_contrastive_loss: 78405.3125; val_gene_expr_recon_loss: 110666.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471765.4375; val_optim_loss: 471765.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9109; val_auprc_score: 0.8922; val_best_acc_score: 0.8378; val_best_f1_score: 0.8519; train_kl_reg_loss: 6301.7291; train_edge_recon_loss: 272340.7240; train_cond_contrastive_loss: 79011.4388; train_gene_expr_recon_loss: 109842.0026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467495.8958; train_optim_loss: 467495.8958; val_kl_reg_loss: 6271.0083; val_edge_recon_loss: 272874.6875; val_cond_contrastive_loss: 78417.4453; val_gene_expr_recon_loss: 110315.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467878.9375; val_optim_loss: 467878.9375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9268; val_auprc_score: 0.9124; val_best_acc_score: 0.8500; val_best_f1_score: 0.8577; train_kl_reg_loss: 6248.0230; train_edge_recon_loss: 271018.6458; train_cond_contrastive_loss: 78858.7669; train_gene_expr_recon_loss: 109467.5716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465593.0156; train_optim_loss: 465593.0156; val_kl_reg_loss: 5980.6182; val_edge_recon_loss: 271953.3438; val_cond_contrastive_loss: 78422.0859; val_gene_expr_recon_loss: 109970.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466326.9375; val_optim_loss: 466326.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9350; val_auprc_score: 0.9255; val_best_acc_score: 0.8624; val_best_f1_score: 0.8696; train_kl_reg_loss: 6091.9009; train_edge_recon_loss: 269915.6094; train_cond_contrastive_loss: 78783.0924; train_gene_expr_recon_loss: 109031.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463822.5104; train_optim_loss: 463822.5104; val_kl_reg_loss: 6147.1260; val_edge_recon_loss: 268974.2500; val_cond_contrastive_loss: 78420.2812; val_gene_expr_recon_loss: 109643.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463185.4062; val_optim_loss: 463185.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9423; val_auprc_score: 0.9286; val_best_acc_score: 0.8719; val_best_f1_score: 0.8771; train_kl_reg_loss: 6245.9016; train_edge_recon_loss: 268078.8802; train_cond_contrastive_loss: 78688.3919; train_gene_expr_recon_loss: 108999.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462012.4948; train_optim_loss: 462012.4948; val_kl_reg_loss: 6314.3994; val_edge_recon_loss: 269891.8750; val_cond_contrastive_loss: 78412.9922; val_gene_expr_recon_loss: 109342.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463961.7500; val_optim_loss: 463961.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9476; val_auprc_score: 0.9362; val_best_acc_score: 0.8817; val_best_f1_score: 0.8865; train_kl_reg_loss: 6313.5575; train_edge_recon_loss: 267368.4635; train_cond_contrastive_loss: 78662.4492; train_gene_expr_recon_loss: 108587.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460932.3073; train_optim_loss: 460932.3073; val_kl_reg_loss: 6166.7700; val_edge_recon_loss: 270323.9062; val_cond_contrastive_loss: 78410.1797; val_gene_expr_recon_loss: 109033.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463934.1250; val_optim_loss: 463934.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9541; val_auprc_score: 0.9403; val_best_acc_score: 0.8900; val_best_f1_score: 0.8942; train_kl_reg_loss: 6176.6326; train_edge_recon_loss: 266920.8672; train_cond_contrastive_loss: 78687.8971; train_gene_expr_recon_loss: 108251.4414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460036.8333; train_optim_loss: 460036.8333; val_kl_reg_loss: 6035.6055; val_edge_recon_loss: 269781.3438; val_cond_contrastive_loss: 78407.7734; val_gene_expr_recon_loss: 108720.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462945.5312; val_optim_loss: 462945.5312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9597; val_auprc_score: 0.9488; val_best_acc_score: 0.9016; val_best_f1_score: 0.9044; train_kl_reg_loss: 6015.6671; train_edge_recon_loss: 268586.5938; train_cond_contrastive_loss: 78702.6406; train_gene_expr_recon_loss: 107887.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461192.1875; train_optim_loss: 461192.1875; val_kl_reg_loss: 5898.8086; val_edge_recon_loss: 265677.4062; val_cond_contrastive_loss: 78409.0781; val_gene_expr_recon_loss: 108404.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458389.4688; val_optim_loss: 458389.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9664; val_auprc_score: 0.9609; val_best_acc_score: 0.9129; val_best_f1_score: 0.9155; train_kl_reg_loss: 5881.6570; train_edge_recon_loss: 268501.2396; train_cond_contrastive_loss: 78686.2786; train_gene_expr_recon_loss: 107599.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460668.7812; train_optim_loss: 460668.7812; val_kl_reg_loss: 5759.0850; val_edge_recon_loss: 267544.0938; val_cond_contrastive_loss: 78413.2031; val_gene_expr_recon_loss: 108081.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459798.1875; val_optim_loss: 459798.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9732; val_auprc_score: 0.9672; val_best_acc_score: 0.9247; val_best_f1_score: 0.9265; train_kl_reg_loss: 5783.7524; train_edge_recon_loss: 266363.3854; train_cond_contrastive_loss: 78673.2773; train_gene_expr_recon_loss: 107187.1771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458007.5938; train_optim_loss: 458007.5938; val_kl_reg_loss: 5726.5586; val_edge_recon_loss: 266670.2812; val_cond_contrastive_loss: 78417.5156; val_gene_expr_recon_loss: 107784.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458598.9375; val_optim_loss: 458598.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9767; val_auprc_score: 0.9694; val_best_acc_score: 0.9308; val_best_f1_score: 0.9319; train_kl_reg_loss: 5758.5405; train_edge_recon_loss: 265773.5833; train_cond_contrastive_loss: 78678.9010; train_gene_expr_recon_loss: 107179.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457391.0156; train_optim_loss: 457391.0156; val_kl_reg_loss: 5697.8774; val_edge_recon_loss: 264192.3125; val_cond_contrastive_loss: 78422.2422; val_gene_expr_recon_loss: 107496.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455808.6875; val_optim_loss: 455808.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9789; val_auprc_score: 0.9717; val_best_acc_score: 0.9364; val_best_f1_score: 0.9379; train_kl_reg_loss: 5745.7673; train_edge_recon_loss: 263213.6094; train_cond_contrastive_loss: 78692.9805; train_gene_expr_recon_loss: 106796.4935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454448.8542; train_optim_loss: 454448.8542; val_kl_reg_loss: 5708.1035; val_edge_recon_loss: 262173.8438; val_cond_contrastive_loss: 78421.4297; val_gene_expr_recon_loss: 107194.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453498.1250; val_optim_loss: 453498.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9832; val_auprc_score: 0.9800; val_best_acc_score: 0.9390; val_best_f1_score: 0.9400; train_kl_reg_loss: 5763.2191; train_edge_recon_loss: 260700.3750; train_cond_contrastive_loss: 78716.5000; train_gene_expr_recon_loss: 106280.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451460.8333; train_optim_loss: 451460.8333; val_kl_reg_loss: 5785.7349; val_edge_recon_loss: 264373.0000; val_cond_contrastive_loss: 78415.1328; val_gene_expr_recon_loss: 106903.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455477.5000; val_optim_loss: 455477.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9838; val_auprc_score: 0.9776; val_best_acc_score: 0.9444; val_best_f1_score: 0.9448; train_kl_reg_loss: 5833.7122; train_edge_recon_loss: 261868.8568; train_cond_contrastive_loss: 78721.6914; train_gene_expr_recon_loss: 105954.0690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452378.3333; train_optim_loss: 452378.3333; val_kl_reg_loss: 5760.2793; val_edge_recon_loss: 263197.8750; val_cond_contrastive_loss: 78409.6016; val_gene_expr_recon_loss: 106649.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454017.3438; val_optim_loss: 454017.3438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9855; val_auprc_score: 0.9807; val_best_acc_score: 0.9482; val_best_f1_score: 0.9487; train_kl_reg_loss: 5851.3711; train_edge_recon_loss: 260285.6458; train_cond_contrastive_loss: 78739.1276; train_gene_expr_recon_loss: 105788.0169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450664.1562; train_optim_loss: 450664.1562; val_kl_reg_loss: 5863.6660; val_edge_recon_loss: 262947.5312; val_cond_contrastive_loss: 78409.7500; val_gene_expr_recon_loss: 106361.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453582.0625; val_optim_loss: 453582.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9852; val_auprc_score: 0.9824; val_best_acc_score: 0.9461; val_best_f1_score: 0.9475; train_kl_reg_loss: 5904.6869; train_edge_recon_loss: 261582.5625; train_cond_contrastive_loss: 78741.3724; train_gene_expr_recon_loss: 105740.2201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451968.8438; train_optim_loss: 451968.8438; val_kl_reg_loss: 5831.8784; val_edge_recon_loss: 258242.6406; val_cond_contrastive_loss: 78409.8594; val_gene_expr_recon_loss: 106308.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448792.5938; val_optim_loss: 448792.5938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9861; val_auprc_score: 0.9830; val_best_acc_score: 0.9476; val_best_f1_score: 0.9477; train_kl_reg_loss: 5883.0835; train_edge_recon_loss: 260216.0755; train_cond_contrastive_loss: 78750.9740; train_gene_expr_recon_loss: 105647.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450497.2031; train_optim_loss: 450497.2031; val_kl_reg_loss: 5819.0420; val_edge_recon_loss: 262379.7500; val_cond_contrastive_loss: 78409.6641; val_gene_expr_recon_loss: 106265.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452873.5625; val_optim_loss: 452873.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9859; val_auprc_score: 0.9817; val_best_acc_score: 0.9481; val_best_f1_score: 0.9489; train_kl_reg_loss: 5878.6813; train_edge_recon_loss: 260737.3229; train_cond_contrastive_loss: 78738.5117; train_gene_expr_recon_loss: 105420.2904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450774.8021; train_optim_loss: 450774.8021; val_kl_reg_loss: 5821.5059; val_edge_recon_loss: 262778.5625; val_cond_contrastive_loss: 78409.8594; val_gene_expr_recon_loss: 106230.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453240.1562; val_optim_loss: 453240.1562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9848; val_auprc_score: 0.9811; val_best_acc_score: 0.9470; val_best_f1_score: 0.9479; train_kl_reg_loss: 5886.2519; train_edge_recon_loss: 260538.7552; train_cond_contrastive_loss: 78731.9115; train_gene_expr_recon_loss: 105584.8294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450741.7448; train_optim_loss: 450741.7448; val_kl_reg_loss: 5805.4258; val_edge_recon_loss: 261447.1250; val_cond_contrastive_loss: 78409.7891; val_gene_expr_recon_loss: 106191.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451854.1250; val_optim_loss: 451854.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9849; val_auprc_score: 0.9805; val_best_acc_score: 0.9478; val_best_f1_score: 0.9485; train_kl_reg_loss: 5871.5585; train_edge_recon_loss: 260778.1484; train_cond_contrastive_loss: 78753.1667; train_gene_expr_recon_loss: 105404.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450807.6823; train_optim_loss: 450807.6823; val_kl_reg_loss: 5804.0991; val_edge_recon_loss: 260363.4062; val_cond_contrastive_loss: 78410.2500; val_gene_expr_recon_loss: 106188.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450765.7812; val_optim_loss: 450765.7812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9864; val_auprc_score: 0.9837; val_best_acc_score: 0.9467; val_best_f1_score: 0.9471; train_kl_reg_loss: 5870.4391; train_edge_recon_loss: 261648.9323; train_cond_contrastive_loss: 78743.5924; train_gene_expr_recon_loss: 105502.5013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451765.4531; train_optim_loss: 451765.4531; val_kl_reg_loss: 5802.2090; val_edge_recon_loss: 263260.7812; val_cond_contrastive_loss: 78410.1250; val_gene_expr_recon_loss: 106184.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453657.1562; val_optim_loss: 453657.1562
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9855; val_auprc_score: 0.9801; val_best_acc_score: 0.9481; val_best_f1_score: 0.9492; train_kl_reg_loss: 5869.6767; train_edge_recon_loss: 261953.4323; train_cond_contrastive_loss: 78744.3516; train_gene_expr_recon_loss: 105375.2826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451942.7448; train_optim_loss: 451942.7448; val_kl_reg_loss: 5806.7461; val_edge_recon_loss: 259803.7969; val_cond_contrastive_loss: 78410.5625; val_gene_expr_recon_loss: 106180.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450201.5625; val_optim_loss: 450201.5625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 22 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9846
Val AUPRC score: 0.9804
Val best accuracy score: 0.9456
Val best F1 score: 0.9458
Val gene expr MSE score: 1.7687
Duration of model training in run 6: 0 hours, 2 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7894; val_auprc_score: 0.8221; val_best_acc_score: 0.7007; val_best_f1_score: 0.7039; train_kl_reg_loss: 6960.7040; train_edge_recon_loss: 356234.8929; train_cond_contrastive_loss: 106088.3393; train_gene_expr_recon_loss: 134127.6920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 603411.6339; train_optim_loss: 603411.6339; val_kl_reg_loss: 8775.2324; val_edge_recon_loss: 402700.3125; val_cond_contrastive_loss: 78329.8984; val_gene_expr_recon_loss: 119802.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 609607.6250; val_optim_loss: 609607.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7418; val_auprc_score: 0.7720; val_best_acc_score: 0.6472; val_best_f1_score: 0.7101; train_kl_reg_loss: 7385.5306; train_edge_recon_loss: 355985.0446; train_cond_contrastive_loss: 89414.0859; train_gene_expr_recon_loss: 117665.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 570449.6607; train_optim_loss: 570449.6607; val_kl_reg_loss: 7175.6221; val_edge_recon_loss: 390011.4688; val_cond_contrastive_loss: 78356.9609; val_gene_expr_recon_loss: 116714.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592258.6875; val_optim_loss: 592258.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7378; val_auprc_score: 0.7627; val_best_acc_score: 0.6597; val_best_f1_score: 0.7072; train_kl_reg_loss: 4908.2154; train_edge_recon_loss: 346491.3170; train_cond_contrastive_loss: 87976.9007; train_gene_expr_recon_loss: 115484.9743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554861.4196; train_optim_loss: 554861.4196; val_kl_reg_loss: 3352.1108; val_edge_recon_loss: 344483.4688; val_cond_contrastive_loss: 78405.6562; val_gene_expr_recon_loss: 115464.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 541705.9375; val_optim_loss: 541705.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7460; val_auprc_score: 0.7709; val_best_acc_score: 0.6717; val_best_f1_score: 0.7060; train_kl_reg_loss: 3807.7485; train_edge_recon_loss: 325276.4821; train_cond_contrastive_loss: 84666.2824; train_gene_expr_recon_loss: 114575.3114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528325.8170; train_optim_loss: 528325.8170; val_kl_reg_loss: 4682.8418; val_edge_recon_loss: 322238.8438; val_cond_contrastive_loss: 78365.9609; val_gene_expr_recon_loss: 114710.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519998.5625; val_optim_loss: 519998.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8055; val_auprc_score: 0.8136; val_best_acc_score: 0.7166; val_best_f1_score: 0.7444; train_kl_reg_loss: 5313.5336; train_edge_recon_loss: 309466.4509; train_cond_contrastive_loss: 79202.2254; train_gene_expr_recon_loss: 113676.7076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507658.9241; train_optim_loss: 507658.9241; val_kl_reg_loss: 5852.1489; val_edge_recon_loss: 300700.1875; val_cond_contrastive_loss: 78377.2734; val_gene_expr_recon_loss: 113786.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498715.6875; val_optim_loss: 498715.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8576; val_auprc_score: 0.8445; val_best_acc_score: 0.7727; val_best_f1_score: 0.7964; train_kl_reg_loss: 6192.7973; train_edge_recon_loss: 289445.0357; train_cond_contrastive_loss: 78782.1763; train_gene_expr_recon_loss: 112788.0335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487208.0536; train_optim_loss: 487208.0536; val_kl_reg_loss: 6293.4883; val_edge_recon_loss: 284798.3125; val_cond_contrastive_loss: 78386.9297; val_gene_expr_recon_loss: 113033.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482512.3750; val_optim_loss: 482512.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8796; val_auprc_score: 0.8597; val_best_acc_score: 0.8005; val_best_f1_score: 0.8178; train_kl_reg_loss: 6282.9077; train_edge_recon_loss: 279844.3259; train_cond_contrastive_loss: 78860.8728; train_gene_expr_recon_loss: 112019.2467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477007.3482; train_optim_loss: 477007.3482; val_kl_reg_loss: 6097.0342; val_edge_recon_loss: 279383.9062; val_cond_contrastive_loss: 78385.1250; val_gene_expr_recon_loss: 112344.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476210.9375; val_optim_loss: 476210.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8877; val_auprc_score: 0.8593; val_best_acc_score: 0.8196; val_best_f1_score: 0.8370; train_kl_reg_loss: 6093.8578; train_edge_recon_loss: 274899.4286; train_cond_contrastive_loss: 78954.0056; train_gene_expr_recon_loss: 111695.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471642.9062; train_optim_loss: 471642.9062; val_kl_reg_loss: 5951.4316; val_edge_recon_loss: 278266.4688; val_cond_contrastive_loss: 78385.7734; val_gene_expr_recon_loss: 111699.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474303.0938; val_optim_loss: 474303.0938
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9099; val_auprc_score: 0.8914; val_best_acc_score: 0.8400; val_best_f1_score: 0.8524; train_kl_reg_loss: 6026.7884; train_edge_recon_loss: 273171.7812; train_cond_contrastive_loss: 78999.7846; train_gene_expr_recon_loss: 110728.6540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468927.0045; train_optim_loss: 468927.0045; val_kl_reg_loss: 5925.2344; val_edge_recon_loss: 272512.3750; val_cond_contrastive_loss: 78395.3438; val_gene_expr_recon_loss: 111209.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468042.2188; val_optim_loss: 468042.2188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9267; val_auprc_score: 0.9124; val_best_acc_score: 0.8527; val_best_f1_score: 0.8634; train_kl_reg_loss: 5966.8189; train_edge_recon_loss: 270733.2455; train_cond_contrastive_loss: 79023.4453; train_gene_expr_recon_loss: 110479.7154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466203.2232; train_optim_loss: 466203.2232; val_kl_reg_loss: 5935.0176; val_edge_recon_loss: 270357.5625; val_cond_contrastive_loss: 78403.5781; val_gene_expr_recon_loss: 110813.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465509.7188; val_optim_loss: 465509.7188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9413; val_auprc_score: 0.9302; val_best_acc_score: 0.8723; val_best_f1_score: 0.8773; train_kl_reg_loss: 6013.7130; train_edge_recon_loss: 270418.4911; train_cond_contrastive_loss: 78906.4866; train_gene_expr_recon_loss: 110410.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465749.3438; train_optim_loss: 465749.3438; val_kl_reg_loss: 5944.7471; val_edge_recon_loss: 268271.3125; val_cond_contrastive_loss: 78404.0625; val_gene_expr_recon_loss: 110467.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463087.3125; val_optim_loss: 463087.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9451; val_auprc_score: 0.9308; val_best_acc_score: 0.8821; val_best_f1_score: 0.8858; train_kl_reg_loss: 5963.9889; train_edge_recon_loss: 269716.3705; train_cond_contrastive_loss: 78820.3783; train_gene_expr_recon_loss: 109590.8996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464091.6339; train_optim_loss: 464091.6339; val_kl_reg_loss: 6034.1328; val_edge_recon_loss: 272049.5312; val_cond_contrastive_loss: 78400.1406; val_gene_expr_recon_loss: 110115.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466599.6875; val_optim_loss: 466599.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9547; val_auprc_score: 0.9459; val_best_acc_score: 0.8941; val_best_f1_score: 0.8982; train_kl_reg_loss: 6135.7102; train_edge_recon_loss: 267806.5134; train_cond_contrastive_loss: 78712.6484; train_gene_expr_recon_loss: 109188.2790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461843.1562; train_optim_loss: 461843.1562; val_kl_reg_loss: 6119.2637; val_edge_recon_loss: 266522.1250; val_cond_contrastive_loss: 78400.5938; val_gene_expr_recon_loss: 109735.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460777.2500; val_optim_loss: 460777.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9605; val_auprc_score: 0.9499; val_best_acc_score: 0.9037; val_best_f1_score: 0.9076; train_kl_reg_loss: 6019.7384; train_edge_recon_loss: 266295.8348; train_cond_contrastive_loss: 78711.0045; train_gene_expr_recon_loss: 108872.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459899.3661; train_optim_loss: 459899.3661; val_kl_reg_loss: 5880.7041; val_edge_recon_loss: 265035.8125; val_cond_contrastive_loss: 78404.2422; val_gene_expr_recon_loss: 109337.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458657.8125; val_optim_loss: 458657.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9688; val_auprc_score: 0.9620; val_best_acc_score: 0.9180; val_best_f1_score: 0.9202; train_kl_reg_loss: 5888.2448; train_edge_recon_loss: 265948.3438; train_cond_contrastive_loss: 78723.5826; train_gene_expr_recon_loss: 108635.3382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459195.5134; train_optim_loss: 459195.5134; val_kl_reg_loss: 5769.4614; val_edge_recon_loss: 264519.5938; val_cond_contrastive_loss: 78409.1016; val_gene_expr_recon_loss: 108929.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457627.9375; val_optim_loss: 457627.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9736; val_auprc_score: 0.9671; val_best_acc_score: 0.9242; val_best_f1_score: 0.9264; train_kl_reg_loss: 5792.2547; train_edge_recon_loss: 265380.8214; train_cond_contrastive_loss: 78738.3114; train_gene_expr_recon_loss: 108170.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458081.8571; train_optim_loss: 458081.8571; val_kl_reg_loss: 5777.1372; val_edge_recon_loss: 264472.0312; val_cond_contrastive_loss: 78413.1172; val_gene_expr_recon_loss: 108557.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457220.1875; val_optim_loss: 457220.1875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9783; val_auprc_score: 0.9742; val_best_acc_score: 0.9304; val_best_f1_score: 0.9314; train_kl_reg_loss: 5813.9149; train_edge_recon_loss: 264189.3795; train_cond_contrastive_loss: 78734.6719; train_gene_expr_recon_loss: 107657.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456395.2857; train_optim_loss: 456395.2857; val_kl_reg_loss: 5810.1338; val_edge_recon_loss: 265774.5000; val_cond_contrastive_loss: 78413.9219; val_gene_expr_recon_loss: 108211.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458210.2500; val_optim_loss: 458210.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9800; val_auprc_score: 0.9756; val_best_acc_score: 0.9345; val_best_f1_score: 0.9354; train_kl_reg_loss: 5843.0945; train_edge_recon_loss: 263265.0089; train_cond_contrastive_loss: 78744.8426; train_gene_expr_recon_loss: 107452.5525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455305.5000; train_optim_loss: 455305.5000; val_kl_reg_loss: 5774.3848; val_edge_recon_loss: 264083.1250; val_cond_contrastive_loss: 78410.0703; val_gene_expr_recon_loss: 107860.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456128.0938; val_optim_loss: 456128.0938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9829; val_auprc_score: 0.9799; val_best_acc_score: 0.9408; val_best_f1_score: 0.9414; train_kl_reg_loss: 5822.8127; train_edge_recon_loss: 261892.1429; train_cond_contrastive_loss: 78770.2500; train_gene_expr_recon_loss: 107222.2321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453707.4330; train_optim_loss: 453707.4330; val_kl_reg_loss: 5812.2393; val_edge_recon_loss: 260310.4688; val_cond_contrastive_loss: 78405.4297; val_gene_expr_recon_loss: 107503.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452032.0938; val_optim_loss: 452032.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9861; val_auprc_score: 0.9833; val_best_acc_score: 0.9435; val_best_f1_score: 0.9448; train_kl_reg_loss: 5875.3748; train_edge_recon_loss: 260768.5513; train_cond_contrastive_loss: 78760.2746; train_gene_expr_recon_loss: 106767.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452172.1696; train_optim_loss: 452172.1696; val_kl_reg_loss: 5811.2446; val_edge_recon_loss: 258547.0938; val_cond_contrastive_loss: 78400.0312; val_gene_expr_recon_loss: 107156.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449914.7812; val_optim_loss: 449914.7812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9843; val_auprc_score: 0.9791; val_best_acc_score: 0.9413; val_best_f1_score: 0.9421; train_kl_reg_loss: 5825.4795; train_edge_recon_loss: 260621.8929; train_cond_contrastive_loss: 78759.5145; train_gene_expr_recon_loss: 106436.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451642.9821; train_optim_loss: 451642.9821; val_kl_reg_loss: 5833.9062; val_edge_recon_loss: 260929.8594; val_cond_contrastive_loss: 78395.4141; val_gene_expr_recon_loss: 106799.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451958.9375; val_optim_loss: 451958.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9868; val_auprc_score: 0.9840; val_best_acc_score: 0.9467; val_best_f1_score: 0.9481; train_kl_reg_loss: 5833.7838; train_edge_recon_loss: 260801.7165; train_cond_contrastive_loss: 78745.5156; train_gene_expr_recon_loss: 106041.0212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451422.0402; train_optim_loss: 451422.0402; val_kl_reg_loss: 5827.6787; val_edge_recon_loss: 258444.8750; val_cond_contrastive_loss: 78393.0391; val_gene_expr_recon_loss: 106451.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449117.2812; val_optim_loss: 449117.2812
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9870; val_auprc_score: 0.9842; val_best_acc_score: 0.9478; val_best_f1_score: 0.9491; train_kl_reg_loss: 5855.7109; train_edge_recon_loss: 259965.4821; train_cond_contrastive_loss: 78735.1607; train_gene_expr_recon_loss: 105863.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450419.9777; train_optim_loss: 450419.9777; val_kl_reg_loss: 5835.2842; val_edge_recon_loss: 257830.4375; val_cond_contrastive_loss: 78390.7422; val_gene_expr_recon_loss: 106114.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448170.8750; val_optim_loss: 448170.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9872; val_auprc_score: 0.9828; val_best_acc_score: 0.9492; val_best_f1_score: 0.9505; train_kl_reg_loss: 5844.1150; train_edge_recon_loss: 260185.3259; train_cond_contrastive_loss: 78736.2188; train_gene_expr_recon_loss: 105149.0089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449914.6652; train_optim_loss: 449914.6652; val_kl_reg_loss: 5800.1826; val_edge_recon_loss: 259037.6406; val_cond_contrastive_loss: 78389.3594; val_gene_expr_recon_loss: 105784.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449011.6562; val_optim_loss: 449011.6562
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9882; val_auprc_score: 0.9856; val_best_acc_score: 0.9477; val_best_f1_score: 0.9491; train_kl_reg_loss: 5858.0712; train_edge_recon_loss: 259051.8862; train_cond_contrastive_loss: 78730.1730; train_gene_expr_recon_loss: 105024.5647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448664.6964; train_optim_loss: 448664.6964; val_kl_reg_loss: 5824.5039; val_edge_recon_loss: 260887.3594; val_cond_contrastive_loss: 78388.8438; val_gene_expr_recon_loss: 105472.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450572.9062; val_optim_loss: 450572.9062
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9891; val_auprc_score: 0.9864; val_best_acc_score: 0.9515; val_best_f1_score: 0.9525; train_kl_reg_loss: 5834.9363; train_edge_recon_loss: 260091.9688; train_cond_contrastive_loss: 78725.8482; train_gene_expr_recon_loss: 104606.0346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449258.7812; train_optim_loss: 449258.7812; val_kl_reg_loss: 5758.0234; val_edge_recon_loss: 258448.0312; val_cond_contrastive_loss: 78389.4453; val_gene_expr_recon_loss: 105181.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447776.9375; val_optim_loss: 447776.9375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9889; val_auprc_score: 0.9838; val_best_acc_score: 0.9540; val_best_f1_score: 0.9552; train_kl_reg_loss: 5799.8804; train_edge_recon_loss: 259317.5067; train_cond_contrastive_loss: 78730.8382; train_gene_expr_recon_loss: 104576.2634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448424.4955; train_optim_loss: 448424.4955; val_kl_reg_loss: 5759.8770; val_edge_recon_loss: 257898.1875; val_cond_contrastive_loss: 78391.4531; val_gene_expr_recon_loss: 104906.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446955.8438; val_optim_loss: 446955.8438
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9890; val_auprc_score: 0.9858; val_best_acc_score: 0.9560; val_best_f1_score: 0.9567; train_kl_reg_loss: 5797.6452; train_edge_recon_loss: 258331.4241; train_cond_contrastive_loss: 78732.1127; train_gene_expr_recon_loss: 104066.3761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446927.5491; train_optim_loss: 446927.5491; val_kl_reg_loss: 5786.9946; val_edge_recon_loss: 258852.5781; val_cond_contrastive_loss: 78393.1875; val_gene_expr_recon_loss: 104634.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447667.3750; val_optim_loss: 447667.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9898; val_auprc_score: 0.9854; val_best_acc_score: 0.9539; val_best_f1_score: 0.9546; train_kl_reg_loss: 5831.2642; train_edge_recon_loss: 259098.1228; train_cond_contrastive_loss: 78729.7645; train_gene_expr_recon_loss: 104099.7846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447758.9464; train_optim_loss: 447758.9464; val_kl_reg_loss: 5745.3286; val_edge_recon_loss: 260553.5312; val_cond_contrastive_loss: 78395.1953; val_gene_expr_recon_loss: 104410.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449104.2812; val_optim_loss: 449104.2812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9893; val_auprc_score: 0.9866; val_best_acc_score: 0.9576; val_best_f1_score: 0.9588; train_kl_reg_loss: 5785.2761; train_edge_recon_loss: 258799.6585; train_cond_contrastive_loss: 78749.6272; train_gene_expr_recon_loss: 103512.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446847.3170; train_optim_loss: 446847.3170; val_kl_reg_loss: 5787.9102; val_edge_recon_loss: 255953.1562; val_cond_contrastive_loss: 78397.7578; val_gene_expr_recon_loss: 104149.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444288.6875; val_optim_loss: 444288.6875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9910; val_auprc_score: 0.9891; val_best_acc_score: 0.9581; val_best_f1_score: 0.9595; train_kl_reg_loss: 5812.6355; train_edge_recon_loss: 258592.9196; train_cond_contrastive_loss: 78744.3917; train_gene_expr_recon_loss: 103378.8069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446528.7455; train_optim_loss: 446528.7455; val_kl_reg_loss: 5739.7383; val_edge_recon_loss: 256284.3906; val_cond_contrastive_loss: 78398.3984; val_gene_expr_recon_loss: 103932.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444354.6875; val_optim_loss: 444354.6875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9901; val_auprc_score: 0.9865; val_best_acc_score: 0.9571; val_best_f1_score: 0.9587; train_kl_reg_loss: 5777.3173; train_edge_recon_loss: 257937.2388; train_cond_contrastive_loss: 78752.8281; train_gene_expr_recon_loss: 103231.7857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445699.1696; train_optim_loss: 445699.1696; val_kl_reg_loss: 5742.6602; val_edge_recon_loss: 256782.7656; val_cond_contrastive_loss: 78399.8438; val_gene_expr_recon_loss: 103731.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444657.2188; val_optim_loss: 444657.2188
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9901; val_auprc_score: 0.9859; val_best_acc_score: 0.9581; val_best_f1_score: 0.9590; train_kl_reg_loss: 5814.2669; train_edge_recon_loss: 257466.3482; train_cond_contrastive_loss: 78744.1094; train_gene_expr_recon_loss: 103025.2902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445050.0268; train_optim_loss: 445050.0268; val_kl_reg_loss: 5759.8428; val_edge_recon_loss: 258540.0312; val_cond_contrastive_loss: 78401.0469; val_gene_expr_recon_loss: 103533.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446234.1250; val_optim_loss: 446234.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9916; val_auprc_score: 0.9884; val_best_acc_score: 0.9602; val_best_f1_score: 0.9609; train_kl_reg_loss: 5792.5338; train_edge_recon_loss: 257410.7879; train_cond_contrastive_loss: 78746.3304; train_gene_expr_recon_loss: 103046.7277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444996.3750; train_optim_loss: 444996.3750; val_kl_reg_loss: 5752.6533; val_edge_recon_loss: 259328.9844; val_cond_contrastive_loss: 78401.4922; val_gene_expr_recon_loss: 103496.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446979.6250; val_optim_loss: 446979.6250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9911; val_auprc_score: 0.9878; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 5787.6339; train_edge_recon_loss: 258005.0156; train_cond_contrastive_loss: 78743.8136; train_gene_expr_recon_loss: 103044.5446; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445581.0045; train_optim_loss: 445581.0045; val_kl_reg_loss: 5734.0371; val_edge_recon_loss: 258349.1875; val_cond_contrastive_loss: 78401.7031; val_gene_expr_recon_loss: 103460.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445945.5938; val_optim_loss: 445945.5938
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9901; val_auprc_score: 0.9860; val_best_acc_score: 0.9584; val_best_f1_score: 0.9591; train_kl_reg_loss: 5763.3825; train_edge_recon_loss: 258216.6496; train_cond_contrastive_loss: 78748.8404; train_gene_expr_recon_loss: 103037.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445766.4375; train_optim_loss: 445766.4375; val_kl_reg_loss: 5723.8965; val_edge_recon_loss: 257894.0938; val_cond_contrastive_loss: 78402.1719; val_gene_expr_recon_loss: 103442.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445462.5000; val_optim_loss: 445462.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 40 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9864
Val best accuracy score: 0.9575
Val best F1 score: 0.9582
Val gene expr MSE score: 1.4965
Duration of model training in run 7: 0 hours, 3 minutes and 43 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7649; val_auprc_score: 0.7956; val_best_acc_score: 0.6825; val_best_f1_score: 0.7123; train_kl_reg_loss: 5621.4513; train_edge_recon_loss: 357006.6071; train_cond_contrastive_loss: 103974.4487; train_gene_expr_recon_loss: 133886.1217; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 600488.6250; train_optim_loss: 600488.6250; val_kl_reg_loss: 8052.7578; val_edge_recon_loss: 399968.8125; val_cond_contrastive_loss: 78332.4375; val_gene_expr_recon_loss: 117298.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 603652.0000; val_optim_loss: 603652.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7258; val_auprc_score: 0.7517; val_best_acc_score: 0.6466; val_best_f1_score: 0.7113; train_kl_reg_loss: 6729.9395; train_edge_recon_loss: 354770.7009; train_cond_contrastive_loss: 88113.2768; train_gene_expr_recon_loss: 118057.8482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567671.7679; train_optim_loss: 567671.7679; val_kl_reg_loss: 4535.8975; val_edge_recon_loss: 374805.3750; val_cond_contrastive_loss: 78365.1641; val_gene_expr_recon_loss: 114873.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572579.7500; val_optim_loss: 572579.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7189; val_auprc_score: 0.7452; val_best_acc_score: 0.6446; val_best_f1_score: 0.7023; train_kl_reg_loss: 3621.1334; train_edge_recon_loss: 340395.5179; train_cond_contrastive_loss: 88270.9732; train_gene_expr_recon_loss: 116102.1741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 548389.7946; train_optim_loss: 548389.7946; val_kl_reg_loss: 3298.8052; val_edge_recon_loss: 335204.1562; val_cond_contrastive_loss: 78366.1562; val_gene_expr_recon_loss: 113829.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 530698.2500; val_optim_loss: 530698.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7404; val_auprc_score: 0.7654; val_best_acc_score: 0.6679; val_best_f1_score: 0.7047; train_kl_reg_loss: 3995.3793; train_edge_recon_loss: 321009.9732; train_cond_contrastive_loss: 81616.5089; train_gene_expr_recon_loss: 114864.0770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521485.9420; train_optim_loss: 521485.9420; val_kl_reg_loss: 4777.7441; val_edge_recon_loss: 323873.8750; val_cond_contrastive_loss: 78348.5391; val_gene_expr_recon_loss: 112892.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519893.0938; val_optim_loss: 519893.0938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8065; val_auprc_score: 0.8068; val_best_acc_score: 0.7204; val_best_f1_score: 0.7506; train_kl_reg_loss: 5119.8188; train_edge_recon_loss: 306109.3482; train_cond_contrastive_loss: 78994.0190; train_gene_expr_recon_loss: 114438.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504661.5000; train_optim_loss: 504661.5000; val_kl_reg_loss: 5518.3359; val_edge_recon_loss: 298223.8438; val_cond_contrastive_loss: 78361.8594; val_gene_expr_recon_loss: 112121.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494226.0000; val_optim_loss: 494226.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8502; val_auprc_score: 0.8343; val_best_acc_score: 0.7649; val_best_f1_score: 0.7987; train_kl_reg_loss: 5831.6818; train_edge_recon_loss: 287026.1250; train_cond_contrastive_loss: 78767.4330; train_gene_expr_recon_loss: 113485.2299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485110.4688; train_optim_loss: 485110.4688; val_kl_reg_loss: 6121.2725; val_edge_recon_loss: 280695.4062; val_cond_contrastive_loss: 78362.6875; val_gene_expr_recon_loss: 111231.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476411.1875; val_optim_loss: 476411.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8633; val_auprc_score: 0.8400; val_best_acc_score: 0.7855; val_best_f1_score: 0.8122; train_kl_reg_loss: 6183.4541; train_edge_recon_loss: 281416.0402; train_cond_contrastive_loss: 78844.3627; train_gene_expr_recon_loss: 112476.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478920.4955; train_optim_loss: 478920.4955; val_kl_reg_loss: 6115.9082; val_edge_recon_loss: 280433.6562; val_cond_contrastive_loss: 78356.6328; val_gene_expr_recon_loss: 110503.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475409.5625; val_optim_loss: 475409.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8780; val_auprc_score: 0.8489; val_best_acc_score: 0.8113; val_best_f1_score: 0.8308; train_kl_reg_loss: 6246.2832; train_edge_recon_loss: 277376.2098; train_cond_contrastive_loss: 78934.9576; train_gene_expr_recon_loss: 111999.2042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474556.6562; train_optim_loss: 474556.6562; val_kl_reg_loss: 6339.3452; val_edge_recon_loss: 276721.3750; val_cond_contrastive_loss: 78361.5469; val_gene_expr_recon_loss: 109967.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471389.2500; val_optim_loss: 471389.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9027; val_auprc_score: 0.8826; val_best_acc_score: 0.8347; val_best_f1_score: 0.8496; train_kl_reg_loss: 6400.8301; train_edge_recon_loss: 275838.5670; train_cond_contrastive_loss: 78924.9040; train_gene_expr_recon_loss: 111335.9163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472500.2143; train_optim_loss: 472500.2143; val_kl_reg_loss: 6237.4346; val_edge_recon_loss: 274519.8750; val_cond_contrastive_loss: 78372.3828; val_gene_expr_recon_loss: 109367.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468497.4375; val_optim_loss: 468497.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9181; val_auprc_score: 0.8997; val_best_acc_score: 0.8507; val_best_f1_score: 0.8636; train_kl_reg_loss: 6202.7598; train_edge_recon_loss: 273268.1875; train_cond_contrastive_loss: 79000.6741; train_gene_expr_recon_loss: 110663.7857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469135.4062; train_optim_loss: 469135.4062; val_kl_reg_loss: 6072.1553; val_edge_recon_loss: 270306.0312; val_cond_contrastive_loss: 78386.9844; val_gene_expr_recon_loss: 108822.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463587.5000; val_optim_loss: 463587.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9364; val_auprc_score: 0.9246; val_best_acc_score: 0.8651; val_best_f1_score: 0.8741; train_kl_reg_loss: 6156.5052; train_edge_recon_loss: 271091.7768; train_cond_contrastive_loss: 78930.8304; train_gene_expr_recon_loss: 110313.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466492.2902; train_optim_loss: 466492.2902; val_kl_reg_loss: 6067.0010; val_edge_recon_loss: 269316.7812; val_cond_contrastive_loss: 78395.7578; val_gene_expr_recon_loss: 108341.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462120.6875; val_optim_loss: 462120.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9476; val_auprc_score: 0.9372; val_best_acc_score: 0.8850; val_best_f1_score: 0.8913; train_kl_reg_loss: 6141.9801; train_edge_recon_loss: 268935.2098; train_cond_contrastive_loss: 78830.3147; train_gene_expr_recon_loss: 109783.1239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463690.6295; train_optim_loss: 463690.6295; val_kl_reg_loss: 6223.0654; val_edge_recon_loss: 265755.5938; val_cond_contrastive_loss: 78396.7344; val_gene_expr_recon_loss: 107929.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458305.3125; val_optim_loss: 458305.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9523; val_auprc_score: 0.9371; val_best_acc_score: 0.8948; val_best_f1_score: 0.8987; train_kl_reg_loss: 6317.4409; train_edge_recon_loss: 267995.6875; train_cond_contrastive_loss: 78740.5714; train_gene_expr_recon_loss: 109188.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462242.0000; train_optim_loss: 462242.0000; val_kl_reg_loss: 6215.6567; val_edge_recon_loss: 267822.0938; val_cond_contrastive_loss: 78396.2734; val_gene_expr_recon_loss: 107536.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459971.0000; val_optim_loss: 459971.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9606; val_auprc_score: 0.9523; val_best_acc_score: 0.9056; val_best_f1_score: 0.9087; train_kl_reg_loss: 6211.4961; train_edge_recon_loss: 267510.2366; train_cond_contrastive_loss: 78769.9074; train_gene_expr_recon_loss: 109023.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461515.2723; train_optim_loss: 461515.2723; val_kl_reg_loss: 6052.5361; val_edge_recon_loss: 266525.3125; val_cond_contrastive_loss: 78398.1641; val_gene_expr_recon_loss: 107166.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458142.2500; val_optim_loss: 458142.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9678; val_auprc_score: 0.9601; val_best_acc_score: 0.9134; val_best_f1_score: 0.9163; train_kl_reg_loss: 6121.7914; train_edge_recon_loss: 264654.3616; train_cond_contrastive_loss: 78796.3862; train_gene_expr_recon_loss: 108719.3214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458291.8705; train_optim_loss: 458291.8705; val_kl_reg_loss: 5967.7407; val_edge_recon_loss: 266277.5938; val_cond_contrastive_loss: 78401.6406; val_gene_expr_recon_loss: 106775.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457422.2188; val_optim_loss: 457422.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9729; val_auprc_score: 0.9648; val_best_acc_score: 0.9251; val_best_f1_score: 0.9278; train_kl_reg_loss: 6002.6007; train_edge_recon_loss: 265484.8259; train_cond_contrastive_loss: 78823.5290; train_gene_expr_recon_loss: 108174.8192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458485.7723; train_optim_loss: 458485.7723; val_kl_reg_loss: 5843.3550; val_edge_recon_loss: 263052.7188; val_cond_contrastive_loss: 78405.4062; val_gene_expr_recon_loss: 106396.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453697.8750; val_optim_loss: 453697.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9773; val_auprc_score: 0.9687; val_best_acc_score: 0.9317; val_best_f1_score: 0.9339; train_kl_reg_loss: 5914.4343; train_edge_recon_loss: 263854.0112; train_cond_contrastive_loss: 78836.1842; train_gene_expr_recon_loss: 107911.3292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456515.9732; train_optim_loss: 456515.9732; val_kl_reg_loss: 5853.1357; val_edge_recon_loss: 264107.0938; val_cond_contrastive_loss: 78406.7734; val_gene_expr_recon_loss: 106058.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454425.5625; val_optim_loss: 454425.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9807; val_auprc_score: 0.9706; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 5921.5552; train_edge_recon_loss: 263519.6830; train_cond_contrastive_loss: 78807.8605; train_gene_expr_recon_loss: 107322.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455571.5268; train_optim_loss: 455571.5268; val_kl_reg_loss: 5833.2539; val_edge_recon_loss: 263223.0938; val_cond_contrastive_loss: 78405.4375; val_gene_expr_recon_loss: 105747.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453209.1875; val_optim_loss: 453209.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9837; val_auprc_score: 0.9778; val_best_acc_score: 0.9440; val_best_f1_score: 0.9450; train_kl_reg_loss: 5882.8446; train_edge_recon_loss: 262053.7634; train_cond_contrastive_loss: 78802.3348; train_gene_expr_recon_loss: 107196.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453935.3125; train_optim_loss: 453935.3125; val_kl_reg_loss: 5856.1240; val_edge_recon_loss: 261556.6250; val_cond_contrastive_loss: 78403.5000; val_gene_expr_recon_loss: 105420.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451236.4375; val_optim_loss: 451236.4375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9851; val_auprc_score: 0.9794; val_best_acc_score: 0.9460; val_best_f1_score: 0.9467; train_kl_reg_loss: 5906.3696; train_edge_recon_loss: 261612.1808; train_cond_contrastive_loss: 78775.8047; train_gene_expr_recon_loss: 106839.5257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453133.8884; train_optim_loss: 453133.8884; val_kl_reg_loss: 5830.3428; val_edge_recon_loss: 261665.1719; val_cond_contrastive_loss: 78400.9375; val_gene_expr_recon_loss: 105082.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450979.3125; val_optim_loss: 450979.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9867; val_auprc_score: 0.9835; val_best_acc_score: 0.9481; val_best_f1_score: 0.9490; train_kl_reg_loss: 5911.1527; train_edge_recon_loss: 260456.5089; train_cond_contrastive_loss: 78753.3025; train_gene_expr_recon_loss: 106528.3136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451649.2812; train_optim_loss: 451649.2812; val_kl_reg_loss: 5794.9790; val_edge_recon_loss: 259160.4062; val_cond_contrastive_loss: 78396.5547; val_gene_expr_recon_loss: 104748.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448100.2812; val_optim_loss: 448100.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9882; val_auprc_score: 0.9854; val_best_acc_score: 0.9521; val_best_f1_score: 0.9534; train_kl_reg_loss: 5868.4673; train_edge_recon_loss: 259829.1004; train_cond_contrastive_loss: 78735.1127; train_gene_expr_recon_loss: 106186.4509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450619.1205; train_optim_loss: 450619.1205; val_kl_reg_loss: 5838.0386; val_edge_recon_loss: 259105.2031; val_cond_contrastive_loss: 78392.6172; val_gene_expr_recon_loss: 104445.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447781.6250; val_optim_loss: 447781.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9875; val_auprc_score: 0.9827; val_best_acc_score: 0.9530; val_best_f1_score: 0.9544; train_kl_reg_loss: 5866.9097; train_edge_recon_loss: 259215.9442; train_cond_contrastive_loss: 78727.1730; train_gene_expr_recon_loss: 105851.1886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449661.2232; train_optim_loss: 449661.2232; val_kl_reg_loss: 5788.6035; val_edge_recon_loss: 258871.4688; val_cond_contrastive_loss: 78390.4844; val_gene_expr_recon_loss: 104129.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447179.6562; val_optim_loss: 447179.6562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9881; val_auprc_score: 0.9833; val_best_acc_score: 0.9539; val_best_f1_score: 0.9553; train_kl_reg_loss: 5839.5751; train_edge_recon_loss: 260708.6518; train_cond_contrastive_loss: 78723.3281; train_gene_expr_recon_loss: 105503.0123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450774.5536; train_optim_loss: 450774.5536; val_kl_reg_loss: 5760.7529; val_edge_recon_loss: 257119.5625; val_cond_contrastive_loss: 78390.9219; val_gene_expr_recon_loss: 103826.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445097.8125; val_optim_loss: 445097.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9887; val_auprc_score: 0.9851; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 5809.1740; train_edge_recon_loss: 259913.7857; train_cond_contrastive_loss: 78715.2065; train_gene_expr_recon_loss: 105475.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449913.6339; train_optim_loss: 449913.6339; val_kl_reg_loss: 5734.6514; val_edge_recon_loss: 259461.3125; val_cond_contrastive_loss: 78389.5547; val_gene_expr_recon_loss: 103526.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447111.5938; val_optim_loss: 447111.5938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9894; val_auprc_score: 0.9846; val_best_acc_score: 0.9570; val_best_f1_score: 0.9580; train_kl_reg_loss: 5786.6539; train_edge_recon_loss: 259810.9688; train_cond_contrastive_loss: 78701.2511; train_gene_expr_recon_loss: 104994.6964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449293.5670; train_optim_loss: 449293.5670; val_kl_reg_loss: 5729.8311; val_edge_recon_loss: 257399.4375; val_cond_contrastive_loss: 78391.4062; val_gene_expr_recon_loss: 103252.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444773.5625; val_optim_loss: 444773.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9907; val_auprc_score: 0.9864; val_best_acc_score: 0.9583; val_best_f1_score: 0.9589; train_kl_reg_loss: 5801.0615; train_edge_recon_loss: 259440.5290; train_cond_contrastive_loss: 78686.2143; train_gene_expr_recon_loss: 105008.6819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448936.4866; train_optim_loss: 448936.4866; val_kl_reg_loss: 5709.4287; val_edge_recon_loss: 259137.7188; val_cond_contrastive_loss: 78392.6875; val_gene_expr_recon_loss: 103011.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446251.6250; val_optim_loss: 446251.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9908; val_auprc_score: 0.9889; val_best_acc_score: 0.9608; val_best_f1_score: 0.9620; train_kl_reg_loss: 5792.7460; train_edge_recon_loss: 258861.3504; train_cond_contrastive_loss: 78684.3103; train_gene_expr_recon_loss: 104355.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447694.3438; train_optim_loss: 447694.3438; val_kl_reg_loss: 5726.1738; val_edge_recon_loss: 256318.2344; val_cond_contrastive_loss: 78396.7188; val_gene_expr_recon_loss: 102793.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443234.7500; val_optim_loss: 443234.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9909; val_auprc_score: 0.9884; val_best_acc_score: 0.9598; val_best_f1_score: 0.9605; train_kl_reg_loss: 5764.2729; train_edge_recon_loss: 259097.8304; train_cond_contrastive_loss: 78699.8125; train_gene_expr_recon_loss: 104253.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447814.9420; train_optim_loss: 447814.9420; val_kl_reg_loss: 5761.1602; val_edge_recon_loss: 258583.0938; val_cond_contrastive_loss: 78397.8516; val_gene_expr_recon_loss: 102582.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445324.5000; val_optim_loss: 445324.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9914; val_auprc_score: 0.9898; val_best_acc_score: 0.9620; val_best_f1_score: 0.9630; train_kl_reg_loss: 5813.3710; train_edge_recon_loss: 258165.6049; train_cond_contrastive_loss: 78696.2946; train_gene_expr_recon_loss: 103989.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446665.1295; train_optim_loss: 446665.1295; val_kl_reg_loss: 5643.8867; val_edge_recon_loss: 255127.7344; val_cond_contrastive_loss: 78400.3281; val_gene_expr_recon_loss: 102360.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441532.1875; val_optim_loss: 441532.1875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9907; val_auprc_score: 0.9869; val_best_acc_score: 0.9595; val_best_f1_score: 0.9603; train_kl_reg_loss: 5760.2079; train_edge_recon_loss: 258644.3080; train_cond_contrastive_loss: 78706.0123; train_gene_expr_recon_loss: 103778.8661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446889.3884; train_optim_loss: 446889.3884; val_kl_reg_loss: 5723.3320; val_edge_recon_loss: 258750.2344; val_cond_contrastive_loss: 78399.7500; val_gene_expr_recon_loss: 102157.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445030.7188; val_optim_loss: 445030.7188
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9924; val_auprc_score: 0.9901; val_best_acc_score: 0.9644; val_best_f1_score: 0.9650; train_kl_reg_loss: 5745.9065; train_edge_recon_loss: 258350.8013; train_cond_contrastive_loss: 78702.3348; train_gene_expr_recon_loss: 103691.0569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446490.1116; train_optim_loss: 446490.1116; val_kl_reg_loss: 5731.7144; val_edge_recon_loss: 257016.2969; val_cond_contrastive_loss: 78401.2969; val_gene_expr_recon_loss: 101963.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443112.8750; val_optim_loss: 443112.8750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9905; val_auprc_score: 0.9868; val_best_acc_score: 0.9610; val_best_f1_score: 0.9615; train_kl_reg_loss: 5769.5552; train_edge_recon_loss: 258477.4821; train_cond_contrastive_loss: 78689.9397; train_gene_expr_recon_loss: 103438.8304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446375.7991; train_optim_loss: 446375.7991; val_kl_reg_loss: 5638.6104; val_edge_recon_loss: 261178.7344; val_cond_contrastive_loss: 78401.3906; val_gene_expr_recon_loss: 101791.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447010.6875; val_optim_loss: 447010.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9908; val_auprc_score: 0.9866; val_best_acc_score: 0.9621; val_best_f1_score: 0.9632; train_kl_reg_loss: 5720.1452; train_edge_recon_loss: 258203.4710; train_cond_contrastive_loss: 78694.0993; train_gene_expr_recon_loss: 103265.2444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445882.9464; train_optim_loss: 445882.9464; val_kl_reg_loss: 5684.3496; val_edge_recon_loss: 257064.7344; val_cond_contrastive_loss: 78402.1875; val_gene_expr_recon_loss: 101755.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442906.5000; val_optim_loss: 442906.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9906; val_auprc_score: 0.9856; val_best_acc_score: 0.9613; val_best_f1_score: 0.9627; train_kl_reg_loss: 5747.6419; train_edge_recon_loss: 257202.8237; train_cond_contrastive_loss: 78685.2600; train_gene_expr_recon_loss: 103242.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444878.0223; train_optim_loss: 444878.0223; val_kl_reg_loss: 5670.0371; val_edge_recon_loss: 253937.8125; val_cond_contrastive_loss: 78403.3203; val_gene_expr_recon_loss: 101725.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439736.4375; val_optim_loss: 439736.4375
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9907; val_auprc_score: 0.9858; val_best_acc_score: 0.9629; val_best_f1_score: 0.9634; train_kl_reg_loss: 5744.4840; train_edge_recon_loss: 257387.1518; train_cond_contrastive_loss: 78685.9085; train_gene_expr_recon_loss: 103184.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445002.2321; train_optim_loss: 445002.2321; val_kl_reg_loss: 5687.2227; val_edge_recon_loss: 260079.6250; val_cond_contrastive_loss: 78401.6875; val_gene_expr_recon_loss: 101704.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445873.4375; val_optim_loss: 445873.4375
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9919; val_auprc_score: 0.9888; val_best_acc_score: 0.9625; val_best_f1_score: 0.9633; train_kl_reg_loss: 5741.7602; train_edge_recon_loss: 257894.2701; train_cond_contrastive_loss: 78681.5413; train_gene_expr_recon_loss: 103148.6049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445466.1875; train_optim_loss: 445466.1875; val_kl_reg_loss: 5667.7788; val_edge_recon_loss: 256692.1406; val_cond_contrastive_loss: 78402.3203; val_gene_expr_recon_loss: 101684.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442447.0000; val_optim_loss: 442447.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9919; val_auprc_score: 0.9887; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 5736.2166; train_edge_recon_loss: 257255.3147; train_cond_contrastive_loss: 78684.0056; train_gene_expr_recon_loss: 103137.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444813.2589; train_optim_loss: 444813.2589; val_kl_reg_loss: 5681.4805; val_edge_recon_loss: 257730.6094; val_cond_contrastive_loss: 78402.4453; val_gene_expr_recon_loss: 101665.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443480.0000; val_optim_loss: 443480.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9910; val_auprc_score: 0.9843; val_best_acc_score: 0.9621; val_best_f1_score: 0.9629; train_kl_reg_loss: 5745.2088; train_edge_recon_loss: 258106.2835; train_cond_contrastive_loss: 78678.3783; train_gene_expr_recon_loss: 102965.8237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445495.6920; train_optim_loss: 445495.6920; val_kl_reg_loss: 5675.6479; val_edge_recon_loss: 255939.0625; val_cond_contrastive_loss: 78402.9609; val_gene_expr_recon_loss: 101663.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441680.9375; val_optim_loss: 441680.9375
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9920; val_auprc_score: 0.9883; val_best_acc_score: 0.9625; val_best_f1_score: 0.9634; train_kl_reg_loss: 5737.8317; train_edge_recon_loss: 258014.6071; train_cond_contrastive_loss: 78679.8728; train_gene_expr_recon_loss: 103009.2277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445441.5312; train_optim_loss: 445441.5312; val_kl_reg_loss: 5676.0391; val_edge_recon_loss: 257810.2344; val_cond_contrastive_loss: 78402.5547; val_gene_expr_recon_loss: 101660.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443549.6250; val_optim_loss: 443549.6250
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9922; val_auprc_score: 0.9896; val_best_acc_score: 0.9653; val_best_f1_score: 0.9658; train_kl_reg_loss: 5738.0691; train_edge_recon_loss: 257854.1362; train_cond_contrastive_loss: 78681.4554; train_gene_expr_recon_loss: 103258.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445532.1741; train_optim_loss: 445532.1741; val_kl_reg_loss: 5675.4131; val_edge_recon_loss: 258145.4219; val_cond_contrastive_loss: 78402.4141; val_gene_expr_recon_loss: 101658.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443881.8125; val_optim_loss: 443881.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 12 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9902
Val AUPRC score: 0.9864
Val best accuracy score: 0.9610
Val best F1 score: 0.9618
Val gene expr MSE score: 1.4588
Duration of model training in run 8: 0 hours, 4 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7847; val_auprc_score: 0.8160; val_best_acc_score: 0.6976; val_best_f1_score: 0.7197; train_kl_reg_loss: 6326.0766; train_edge_recon_loss: 357031.0556; train_cond_contrastive_loss: 100498.9340; train_gene_expr_recon_loss: 128118.5634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 591974.6389; train_optim_loss: 591974.6389; val_kl_reg_loss: 6254.5596; val_edge_recon_loss: 394943.5000; val_cond_contrastive_loss: 78336.3359; val_gene_expr_recon_loss: 117631.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 597165.5625; val_optim_loss: 597165.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7615; val_auprc_score: 0.7847; val_best_acc_score: 0.6734; val_best_f1_score: 0.7199; train_kl_reg_loss: 5005.8870; train_edge_recon_loss: 350473.2083; train_cond_contrastive_loss: 87386.2101; train_gene_expr_recon_loss: 115557.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 558422.9167; train_optim_loss: 558422.9167; val_kl_reg_loss: 3205.0649; val_edge_recon_loss: 341800.5625; val_cond_contrastive_loss: 78396.2969; val_gene_expr_recon_loss: 116147.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539549.5000; val_optim_loss: 539549.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7765; val_auprc_score: 0.7965; val_best_acc_score: 0.6938; val_best_f1_score: 0.7225; train_kl_reg_loss: 3775.1963; train_edge_recon_loss: 321395.3021; train_cond_contrastive_loss: 84223.7969; train_gene_expr_recon_loss: 114282.3524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 523676.6389; train_optim_loss: 523676.6389; val_kl_reg_loss: 4940.0557; val_edge_recon_loss: 309950.6562; val_cond_contrastive_loss: 78353.7578; val_gene_expr_recon_loss: 114997.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 508241.6875; val_optim_loss: 508241.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8404; val_auprc_score: 0.8359; val_best_acc_score: 0.7504; val_best_f1_score: 0.7814; train_kl_reg_loss: 5808.9392; train_edge_recon_loss: 297459.8889; train_cond_contrastive_loss: 78739.1424; train_gene_expr_recon_loss: 113190.1181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495198.0903; train_optim_loss: 495198.0903; val_kl_reg_loss: 6500.2324; val_edge_recon_loss: 288039.7188; val_cond_contrastive_loss: 78370.0000; val_gene_expr_recon_loss: 113959.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486869.3125; val_optim_loss: 486869.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8792; val_auprc_score: 0.8615; val_best_acc_score: 0.8032; val_best_f1_score: 0.8241; train_kl_reg_loss: 6456.2097; train_edge_recon_loss: 281291.7153; train_cond_contrastive_loss: 78721.6094; train_gene_expr_recon_loss: 112164.1675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478633.6979; train_optim_loss: 478633.6979; val_kl_reg_loss: 6132.0029; val_edge_recon_loss: 273092.2500; val_cond_contrastive_loss: 78369.5312; val_gene_expr_recon_loss: 112945.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470539.2188; val_optim_loss: 470539.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8965; val_auprc_score: 0.8742; val_best_acc_score: 0.8302; val_best_f1_score: 0.8469; train_kl_reg_loss: 6057.4634; train_edge_recon_loss: 275079.0694; train_cond_contrastive_loss: 78983.9722; train_gene_expr_recon_loss: 111251.8785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471372.3889; train_optim_loss: 471372.3889; val_kl_reg_loss: 5992.9443; val_edge_recon_loss: 272744.4375; val_cond_contrastive_loss: 78373.8516; val_gene_expr_recon_loss: 112213.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469325.1875; val_optim_loss: 469325.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9220; val_auprc_score: 0.9033; val_best_acc_score: 0.8519; val_best_f1_score: 0.8630; train_kl_reg_loss: 6100.4027; train_edge_recon_loss: 272145.8368; train_cond_contrastive_loss: 78950.4323; train_gene_expr_recon_loss: 110482.1658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467678.8368; train_optim_loss: 467678.8368; val_kl_reg_loss: 5936.4873; val_edge_recon_loss: 271858.9375; val_cond_contrastive_loss: 78386.1328; val_gene_expr_recon_loss: 111475.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467657.1250; val_optim_loss: 467657.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9392; val_auprc_score: 0.9276; val_best_acc_score: 0.8682; val_best_f1_score: 0.8771; train_kl_reg_loss: 5944.4629; train_edge_recon_loss: 269205.4896; train_cond_contrastive_loss: 78847.0521; train_gene_expr_recon_loss: 109884.5634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463881.5729; train_optim_loss: 463881.5729; val_kl_reg_loss: 5975.6299; val_edge_recon_loss: 268943.6562; val_cond_contrastive_loss: 78395.1172; val_gene_expr_recon_loss: 110909.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464223.4375; val_optim_loss: 464223.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9532; val_auprc_score: 0.9434; val_best_acc_score: 0.8896; val_best_f1_score: 0.8955; train_kl_reg_loss: 6221.4900; train_edge_recon_loss: 267534.9653; train_cond_contrastive_loss: 78707.7509; train_gene_expr_recon_loss: 109313.5373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461777.7465; train_optim_loss: 461777.7465; val_kl_reg_loss: 6198.0088; val_edge_recon_loss: 264930.9688; val_cond_contrastive_loss: 78394.2891; val_gene_expr_recon_loss: 110378.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459901.6875; val_optim_loss: 459901.6875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9618; val_auprc_score: 0.9512; val_best_acc_score: 0.9050; val_best_f1_score: 0.9091; train_kl_reg_loss: 6242.7524; train_edge_recon_loss: 266023.3229; train_cond_contrastive_loss: 78721.3307; train_gene_expr_recon_loss: 108681.1979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459668.6007; train_optim_loss: 459668.6007; val_kl_reg_loss: 6135.4155; val_edge_recon_loss: 267356.2812; val_cond_contrastive_loss: 78393.8672; val_gene_expr_recon_loss: 109920.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461806.3438; val_optim_loss: 461806.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9694; val_auprc_score: 0.9617; val_best_acc_score: 0.9185; val_best_f1_score: 0.9213; train_kl_reg_loss: 6126.9859; train_edge_recon_loss: 265645.7986; train_cond_contrastive_loss: 78780.2370; train_gene_expr_recon_loss: 108312.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458865.5417; train_optim_loss: 458865.5417; val_kl_reg_loss: 5920.6514; val_edge_recon_loss: 263685.0938; val_cond_contrastive_loss: 78396.9062; val_gene_expr_recon_loss: 109418.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457421.5000; val_optim_loss: 457421.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9753; val_auprc_score: 0.9688; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 5949.2576; train_edge_recon_loss: 264730.0799; train_cond_contrastive_loss: 78823.8984; train_gene_expr_recon_loss: 107837.1554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457340.3889; train_optim_loss: 457340.3889; val_kl_reg_loss: 5890.8291; val_edge_recon_loss: 263286.3750; val_cond_contrastive_loss: 78401.3906; val_gene_expr_recon_loss: 108924.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456503.5938; val_optim_loss: 456503.5938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9813; val_auprc_score: 0.9775; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 5913.4479; train_edge_recon_loss: 262789.1458; train_cond_contrastive_loss: 78800.0399; train_gene_expr_recon_loss: 107361.8898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454864.5208; train_optim_loss: 454864.5208; val_kl_reg_loss: 5797.8159; val_edge_recon_loss: 262303.3438; val_cond_contrastive_loss: 78400.7422; val_gene_expr_recon_loss: 108474.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454976.0938; val_optim_loss: 454976.0938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9837; val_auprc_score: 0.9788; val_best_acc_score: 0.9416; val_best_f1_score: 0.9433; train_kl_reg_loss: 5891.8178; train_edge_recon_loss: 262456.2569; train_cond_contrastive_loss: 78762.7569; train_gene_expr_recon_loss: 106950.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454061.0938; train_optim_loss: 454061.0938; val_kl_reg_loss: 5783.1475; val_edge_recon_loss: 260803.7031; val_cond_contrastive_loss: 78396.7344; val_gene_expr_recon_loss: 108083.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453066.7812; val_optim_loss: 453066.7812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9877; val_auprc_score: 0.9843; val_best_acc_score: 0.9509; val_best_f1_score: 0.9516; train_kl_reg_loss: 5858.2071; train_edge_recon_loss: 260355.5816; train_cond_contrastive_loss: 78723.3134; train_gene_expr_recon_loss: 106528.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451465.8958; train_optim_loss: 451465.8958; val_kl_reg_loss: 5812.0347; val_edge_recon_loss: 259314.8281; val_cond_contrastive_loss: 78392.1953; val_gene_expr_recon_loss: 107679.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451198.8438; val_optim_loss: 451198.8438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9872; val_auprc_score: 0.9831; val_best_acc_score: 0.9492; val_best_f1_score: 0.9510; train_kl_reg_loss: 5869.4950; train_edge_recon_loss: 259872.3385; train_cond_contrastive_loss: 78697.9002; train_gene_expr_recon_loss: 106101.6710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450541.3958; train_optim_loss: 450541.3958; val_kl_reg_loss: 5773.1855; val_edge_recon_loss: 257212.1875; val_cond_contrastive_loss: 78386.8828; val_gene_expr_recon_loss: 107332.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448705.1875; val_optim_loss: 448705.1875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9875; val_auprc_score: 0.9844; val_best_acc_score: 0.9499; val_best_f1_score: 0.9512; train_kl_reg_loss: 5838.9480; train_edge_recon_loss: 259006.0677; train_cond_contrastive_loss: 78698.7891; train_gene_expr_recon_loss: 105767.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449311.6979; train_optim_loss: 449311.6979; val_kl_reg_loss: 5808.3037; val_edge_recon_loss: 259659.8906; val_cond_contrastive_loss: 78382.8125; val_gene_expr_recon_loss: 106923.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450774.3125; val_optim_loss: 450774.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9883; val_auprc_score: 0.9827; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 5827.2818; train_edge_recon_loss: 259394.0347; train_cond_contrastive_loss: 78698.4010; train_gene_expr_recon_loss: 105362.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449282.6319; train_optim_loss: 449282.6319; val_kl_reg_loss: 5741.5581; val_edge_recon_loss: 258423.8906; val_cond_contrastive_loss: 78380.8047; val_gene_expr_recon_loss: 106537.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449083.3750; val_optim_loss: 449083.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9880; val_auprc_score: 0.9851; val_best_acc_score: 0.9516; val_best_f1_score: 0.9530; train_kl_reg_loss: 5799.4096; train_edge_recon_loss: 259090.3385; train_cond_contrastive_loss: 78690.7795; train_gene_expr_recon_loss: 104948.8507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448529.3785; train_optim_loss: 448529.3785; val_kl_reg_loss: 5741.9746; val_edge_recon_loss: 259048.7031; val_cond_contrastive_loss: 78381.7969; val_gene_expr_recon_loss: 106176.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449348.9375; val_optim_loss: 449348.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9889; val_auprc_score: 0.9867; val_best_acc_score: 0.9537; val_best_f1_score: 0.9547; train_kl_reg_loss: 5794.2376; train_edge_recon_loss: 258619.9566; train_cond_contrastive_loss: 78691.0859; train_gene_expr_recon_loss: 104686.9227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447792.2049; train_optim_loss: 447792.2049; val_kl_reg_loss: 5746.0820; val_edge_recon_loss: 258095.2656; val_cond_contrastive_loss: 78382.3125; val_gene_expr_recon_loss: 106122.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448346.1875; val_optim_loss: 448346.1875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9888; val_auprc_score: 0.9836; val_best_acc_score: 0.9549; val_best_f1_score: 0.9557; train_kl_reg_loss: 5783.1261; train_edge_recon_loss: 258559.8073; train_cond_contrastive_loss: 78687.6224; train_gene_expr_recon_loss: 104664.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447694.7188; train_optim_loss: 447694.7188; val_kl_reg_loss: 5710.6055; val_edge_recon_loss: 259343.5938; val_cond_contrastive_loss: 78382.2578; val_gene_expr_recon_loss: 106083.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449519.9375; val_optim_loss: 449519.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9568; val_best_f1_score: 0.9579; train_kl_reg_loss: 5768.8154; train_edge_recon_loss: 258081.1337; train_cond_contrastive_loss: 78695.1936; train_gene_expr_recon_loss: 104639.0946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447184.2361; train_optim_loss: 447184.2361; val_kl_reg_loss: 5726.5859; val_edge_recon_loss: 257568.6562; val_cond_contrastive_loss: 78382.8359; val_gene_expr_recon_loss: 106052.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447730.9375; val_optim_loss: 447730.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9886; val_auprc_score: 0.9850; val_best_acc_score: 0.9525; val_best_f1_score: 0.9538; train_kl_reg_loss: 5766.4247; train_edge_recon_loss: 259357.3785; train_cond_contrastive_loss: 78693.4809; train_gene_expr_recon_loss: 104501.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448318.9340; train_optim_loss: 448318.9340; val_kl_reg_loss: 5713.1260; val_edge_recon_loss: 258733.3281; val_cond_contrastive_loss: 78382.8047; val_gene_expr_recon_loss: 106018.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448847.5000; val_optim_loss: 448847.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9893; val_auprc_score: 0.9853; val_best_acc_score: 0.9553; val_best_f1_score: 0.9565; train_kl_reg_loss: 5771.3616; train_edge_recon_loss: 258673.0573; train_cond_contrastive_loss: 78687.4800; train_gene_expr_recon_loss: 104551.6050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447683.5035; train_optim_loss: 447683.5035; val_kl_reg_loss: 5714.3838; val_edge_recon_loss: 257799.2031; val_cond_contrastive_loss: 78383.1250; val_gene_expr_recon_loss: 105986.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447883.3125; val_optim_loss: 447883.3125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9897; val_auprc_score: 0.9860; val_best_acc_score: 0.9556; val_best_f1_score: 0.9569; train_kl_reg_loss: 5758.4033; train_edge_recon_loss: 258741.8976; train_cond_contrastive_loss: 78699.4748; train_gene_expr_recon_loss: 104604.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447803.8542; train_optim_loss: 447803.8542; val_kl_reg_loss: 5721.2920; val_edge_recon_loss: 256627.2344; val_cond_contrastive_loss: 78383.3281; val_gene_expr_recon_loss: 105951.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446683.2188; val_optim_loss: 446683.2188
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9896; val_auprc_score: 0.9861; val_best_acc_score: 0.9560; val_best_f1_score: 0.9571; train_kl_reg_loss: 5780.7524; train_edge_recon_loss: 258821.6181; train_cond_contrastive_loss: 78681.4618; train_gene_expr_recon_loss: 104537.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447820.9340; train_optim_loss: 447820.9340; val_kl_reg_loss: 5705.6865; val_edge_recon_loss: 257330.7188; val_cond_contrastive_loss: 78383.2188; val_gene_expr_recon_loss: 105919.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447339.0000; val_optim_loss: 447339.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9903; val_auprc_score: 0.9867; val_best_acc_score: 0.9575; val_best_f1_score: 0.9587; train_kl_reg_loss: 5763.0193; train_edge_recon_loss: 258430.7240; train_cond_contrastive_loss: 78688.3733; train_gene_expr_recon_loss: 104458.1510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447340.2743; train_optim_loss: 447340.2743; val_kl_reg_loss: 5693.2930; val_edge_recon_loss: 255501.3281; val_cond_contrastive_loss: 78383.8672; val_gene_expr_recon_loss: 105892.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445470.8438; val_optim_loss: 445470.8438
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9902; val_auprc_score: 0.9883; val_best_acc_score: 0.9558; val_best_f1_score: 0.9570; train_kl_reg_loss: 5744.5759; train_edge_recon_loss: 259027.3941; train_cond_contrastive_loss: 78690.8741; train_gene_expr_recon_loss: 104525.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447988.2257; train_optim_loss: 447988.2257; val_kl_reg_loss: 5670.1704; val_edge_recon_loss: 257758.1719; val_cond_contrastive_loss: 78383.8672; val_gene_expr_recon_loss: 105859.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447671.9062; val_optim_loss: 447671.9062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9893; val_auprc_score: 0.9869; val_best_acc_score: 0.9562; val_best_f1_score: 0.9575; train_kl_reg_loss: 5740.8262; train_edge_recon_loss: 258083.8316; train_cond_contrastive_loss: 78689.0503; train_gene_expr_recon_loss: 104420.3168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446934.0243; train_optim_loss: 446934.0243; val_kl_reg_loss: 5677.0898; val_edge_recon_loss: 257498.2031; val_cond_contrastive_loss: 78384.1797; val_gene_expr_recon_loss: 105824.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447383.8125; val_optim_loss: 447383.8125
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9896; val_auprc_score: 0.9874; val_best_acc_score: 0.9564; val_best_f1_score: 0.9576; train_kl_reg_loss: 5735.9493; train_edge_recon_loss: 258849.6944; train_cond_contrastive_loss: 78691.3116; train_gene_expr_recon_loss: 104374.6823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447651.6319; train_optim_loss: 447651.6319; val_kl_reg_loss: 5664.0449; val_edge_recon_loss: 257383.9688; val_cond_contrastive_loss: 78384.5469; val_gene_expr_recon_loss: 105794.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447227.3750; val_optim_loss: 447227.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9889; val_auprc_score: 0.9846; val_best_acc_score: 0.9560; val_best_f1_score: 0.9569; train_kl_reg_loss: 5728.6363; train_edge_recon_loss: 258389.5990; train_cond_contrastive_loss: 78693.8082; train_gene_expr_recon_loss: 104324.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447136.8229; train_optim_loss: 447136.8229; val_kl_reg_loss: 5660.3438; val_edge_recon_loss: 259497.4688; val_cond_contrastive_loss: 78384.4141; val_gene_expr_recon_loss: 105791.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449333.8750; val_optim_loss: 449333.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9895; val_auprc_score: 0.9876; val_best_acc_score: 0.9546; val_best_f1_score: 0.9556; train_kl_reg_loss: 5731.3212; train_edge_recon_loss: 258159.4774; train_cond_contrastive_loss: 78693.2448; train_gene_expr_recon_loss: 104412.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446996.9757; train_optim_loss: 446996.9757; val_kl_reg_loss: 5665.9521; val_edge_recon_loss: 259618.4062; val_cond_contrastive_loss: 78384.4375; val_gene_expr_recon_loss: 105788.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449457.6562; val_optim_loss: 449457.6562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9897; val_auprc_score: 0.9863; val_best_acc_score: 0.9585; val_best_f1_score: 0.9596; train_kl_reg_loss: 5729.7075; train_edge_recon_loss: 258816.6076; train_cond_contrastive_loss: 78694.2526; train_gene_expr_recon_loss: 104319.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447560.2778; train_optim_loss: 447560.2778; val_kl_reg_loss: 5662.7754; val_edge_recon_loss: 255648.7969; val_cond_contrastive_loss: 78384.8203; val_gene_expr_recon_loss: 105786.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445482.5000; val_optim_loss: 445482.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 14 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9897
Val AUPRC score: 0.9863
Val best accuracy score: 0.9558
Val best F1 score: 0.9572
Val gene expr MSE score: 1.6540
Duration of model training in run 9: 0 hours, 4 minutes and 19 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7907; val_auprc_score: 0.8165; val_best_acc_score: 0.7013; val_best_f1_score: 0.7245; train_kl_reg_loss: 6115.3020; train_edge_recon_loss: 356773.4062; train_cond_contrastive_loss: 100771.1814; train_gene_expr_recon_loss: 130426.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 594086.0764; train_optim_loss: 594086.0764; val_kl_reg_loss: 6672.3145; val_edge_recon_loss: 397771.3125; val_cond_contrastive_loss: 78337.9453; val_gene_expr_recon_loss: 116362.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 599144.0625; val_optim_loss: 599144.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7572; val_auprc_score: 0.7759; val_best_acc_score: 0.6699; val_best_f1_score: 0.7200; train_kl_reg_loss: 5376.1525; train_edge_recon_loss: 348636.3785; train_cond_contrastive_loss: 87941.7257; train_gene_expr_recon_loss: 116897.0903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 558851.3472; train_optim_loss: 558851.3472; val_kl_reg_loss: 3749.2139; val_edge_recon_loss: 345838.6250; val_cond_contrastive_loss: 78395.1953; val_gene_expr_recon_loss: 114482.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542465.2500; val_optim_loss: 542465.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7884; val_auprc_score: 0.8037; val_best_acc_score: 0.7037; val_best_f1_score: 0.7305; train_kl_reg_loss: 4048.8710; train_edge_recon_loss: 320535.9583; train_cond_contrastive_loss: 83132.3220; train_gene_expr_recon_loss: 115088.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 522805.6146; train_optim_loss: 522805.6146; val_kl_reg_loss: 4971.8735; val_edge_recon_loss: 306400.9375; val_cond_contrastive_loss: 78350.0078; val_gene_expr_recon_loss: 113108.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502831.1250; val_optim_loss: 502831.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8469; val_auprc_score: 0.8389; val_best_acc_score: 0.7611; val_best_f1_score: 0.7891; train_kl_reg_loss: 5755.4859; train_edge_recon_loss: 294580.7535; train_cond_contrastive_loss: 78722.9167; train_gene_expr_recon_loss: 113817.9514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492877.1042; train_optim_loss: 492877.1042; val_kl_reg_loss: 6410.0171; val_edge_recon_loss: 284848.9688; val_cond_contrastive_loss: 78364.9766; val_gene_expr_recon_loss: 112008.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481632.8750; val_optim_loss: 481632.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8698; val_auprc_score: 0.8473; val_best_acc_score: 0.7915; val_best_f1_score: 0.8122; train_kl_reg_loss: 6388.8458; train_edge_recon_loss: 281188.4722; train_cond_contrastive_loss: 78767.2517; train_gene_expr_recon_loss: 112759.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479103.5833; train_optim_loss: 479103.5833; val_kl_reg_loss: 6147.3809; val_edge_recon_loss: 280656.1562; val_cond_contrastive_loss: 78364.5703; val_gene_expr_recon_loss: 111037.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476205.5625; val_optim_loss: 476205.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8872; val_auprc_score: 0.8594; val_best_acc_score: 0.8228; val_best_f1_score: 0.8380; train_kl_reg_loss: 6167.1798; train_edge_recon_loss: 277058.0382; train_cond_contrastive_loss: 79024.9045; train_gene_expr_recon_loss: 111936.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474186.8681; train_optim_loss: 474186.8681; val_kl_reg_loss: 6208.0801; val_edge_recon_loss: 276612.5625; val_cond_contrastive_loss: 78372.5859; val_gene_expr_recon_loss: 110333.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471526.4375; val_optim_loss: 471526.4375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9189; val_auprc_score: 0.9029; val_best_acc_score: 0.8495; val_best_f1_score: 0.8623; train_kl_reg_loss: 6247.7530; train_edge_recon_loss: 272991.5660; train_cond_contrastive_loss: 78987.9488; train_gene_expr_recon_loss: 111219.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469446.8958; train_optim_loss: 469446.8958; val_kl_reg_loss: 6048.9990; val_edge_recon_loss: 272328.5938; val_cond_contrastive_loss: 78391.7578; val_gene_expr_recon_loss: 109727.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466496.7188; val_optim_loss: 466496.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9404; val_auprc_score: 0.9284; val_best_acc_score: 0.8757; val_best_f1_score: 0.8823; train_kl_reg_loss: 6031.9621; train_edge_recon_loss: 269809.7014; train_cond_contrastive_loss: 78880.3420; train_gene_expr_recon_loss: 110666.9835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465388.9896; train_optim_loss: 465388.9896; val_kl_reg_loss: 6051.0796; val_edge_recon_loss: 269075.5000; val_cond_contrastive_loss: 78400.7734; val_gene_expr_recon_loss: 109225.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462752.4062; val_optim_loss: 462752.4062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9550; val_auprc_score: 0.9455; val_best_acc_score: 0.8962; val_best_f1_score: 0.9004; train_kl_reg_loss: 6215.2504; train_edge_recon_loss: 267845.3507; train_cond_contrastive_loss: 78720.5530; train_gene_expr_recon_loss: 110270.8108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463051.9583; train_optim_loss: 463051.9583; val_kl_reg_loss: 6284.6133; val_edge_recon_loss: 267706.6250; val_cond_contrastive_loss: 78398.8516; val_gene_expr_recon_loss: 108779.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461169.4375; val_optim_loss: 461169.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9626; val_auprc_score: 0.9516; val_best_acc_score: 0.9109; val_best_f1_score: 0.9147; train_kl_reg_loss: 6268.2120; train_edge_recon_loss: 266690.9444; train_cond_contrastive_loss: 78709.5443; train_gene_expr_recon_loss: 109815.0686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461483.7639; train_optim_loss: 461483.7639; val_kl_reg_loss: 6107.3906; val_edge_recon_loss: 264906.5312; val_cond_contrastive_loss: 78397.3438; val_gene_expr_recon_loss: 108307.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457719.0000; val_optim_loss: 457719.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9685; val_auprc_score: 0.9604; val_best_acc_score: 0.9204; val_best_f1_score: 0.9234; train_kl_reg_loss: 6106.2052; train_edge_recon_loss: 265556.0139; train_cond_contrastive_loss: 78775.9774; train_gene_expr_recon_loss: 109256.8585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459695.0625; train_optim_loss: 459695.0625; val_kl_reg_loss: 6006.3721; val_edge_recon_loss: 263426.5312; val_cond_contrastive_loss: 78398.8672; val_gene_expr_recon_loss: 107843.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455674.8125; val_optim_loss: 455674.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9758; val_auprc_score: 0.9686; val_best_acc_score: 0.9293; val_best_f1_score: 0.9318; train_kl_reg_loss: 6021.9858; train_edge_recon_loss: 264400.2396; train_cond_contrastive_loss: 78797.6241; train_gene_expr_recon_loss: 108821.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458041.0868; train_optim_loss: 458041.0868; val_kl_reg_loss: 5975.1768; val_edge_recon_loss: 262969.5312; val_cond_contrastive_loss: 78400.1172; val_gene_expr_recon_loss: 107398.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454743.7812; val_optim_loss: 454743.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9813; val_auprc_score: 0.9781; val_best_acc_score: 0.9359; val_best_f1_score: 0.9378; train_kl_reg_loss: 5983.0464; train_edge_recon_loss: 262640.5955; train_cond_contrastive_loss: 78794.4575; train_gene_expr_recon_loss: 108400.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455818.6250; train_optim_loss: 455818.6250; val_kl_reg_loss: 5916.6484; val_edge_recon_loss: 261706.0000; val_cond_contrastive_loss: 78398.2344; val_gene_expr_recon_loss: 106981.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453002.8438; val_optim_loss: 453002.8438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9828; val_auprc_score: 0.9783; val_best_acc_score: 0.9408; val_best_f1_score: 0.9425; train_kl_reg_loss: 5944.5157; train_edge_recon_loss: 262152.5764; train_cond_contrastive_loss: 78780.6623; train_gene_expr_recon_loss: 108087.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454965.3958; train_optim_loss: 454965.3958; val_kl_reg_loss: 5853.0767; val_edge_recon_loss: 261910.2031; val_cond_contrastive_loss: 78393.8359; val_gene_expr_recon_loss: 106530.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452687.4062; val_optim_loss: 452687.4062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9842; val_auprc_score: 0.9780; val_best_acc_score: 0.9451; val_best_f1_score: 0.9466; train_kl_reg_loss: 5891.5036; train_edge_recon_loss: 261793.3542; train_cond_contrastive_loss: 78754.9505; train_gene_expr_recon_loss: 107603.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454043.7326; train_optim_loss: 454043.7326; val_kl_reg_loss: 5787.5342; val_edge_recon_loss: 261106.5781; val_cond_contrastive_loss: 78391.6484; val_gene_expr_recon_loss: 106104.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451390.5000; val_optim_loss: 451390.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9865; val_auprc_score: 0.9819; val_best_acc_score: 0.9486; val_best_f1_score: 0.9502; train_kl_reg_loss: 5872.9236; train_edge_recon_loss: 260439.8142; train_cond_contrastive_loss: 78737.0043; train_gene_expr_recon_loss: 107133.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452182.8576; train_optim_loss: 452182.8576; val_kl_reg_loss: 5815.0107; val_edge_recon_loss: 258029.5156; val_cond_contrastive_loss: 78387.6797; val_gene_expr_recon_loss: 105694.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447927.0312; val_optim_loss: 447927.0312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9866; val_auprc_score: 0.9827; val_best_acc_score: 0.9480; val_best_f1_score: 0.9496; train_kl_reg_loss: 5853.7581; train_edge_recon_loss: 259634.5972; train_cond_contrastive_loss: 78728.9288; train_gene_expr_recon_loss: 106770.7014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450987.9861; train_optim_loss: 450987.9861; val_kl_reg_loss: 5801.1377; val_edge_recon_loss: 261095.9375; val_cond_contrastive_loss: 78382.0859; val_gene_expr_recon_loss: 105285.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450564.4688; val_optim_loss: 450564.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9866; val_auprc_score: 0.9802; val_best_acc_score: 0.9505; val_best_f1_score: 0.9519; train_kl_reg_loss: 5879.2299; train_edge_recon_loss: 259705.1441; train_cond_contrastive_loss: 78721.0000; train_gene_expr_recon_loss: 106461.2752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450766.6597; train_optim_loss: 450766.6597; val_kl_reg_loss: 5753.8447; val_edge_recon_loss: 257576.3438; val_cond_contrastive_loss: 78379.0859; val_gene_expr_recon_loss: 104860.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446569.9375; val_optim_loss: 446569.9375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9885; val_auprc_score: 0.9830; val_best_acc_score: 0.9538; val_best_f1_score: 0.9548; train_kl_reg_loss: 5848.6268; train_edge_recon_loss: 259284.9340; train_cond_contrastive_loss: 78723.5894; train_gene_expr_recon_loss: 105802.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449659.4618; train_optim_loss: 449659.4618; val_kl_reg_loss: 5797.1250; val_edge_recon_loss: 259369.7656; val_cond_contrastive_loss: 78379.5391; val_gene_expr_recon_loss: 104459.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448005.8438; val_optim_loss: 448005.8438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9893; val_auprc_score: 0.9861; val_best_acc_score: 0.9555; val_best_f1_score: 0.9571; train_kl_reg_loss: 5808.3879; train_edge_recon_loss: 259750.8090; train_cond_contrastive_loss: 78712.1111; train_gene_expr_recon_loss: 105499.0095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449770.3194; train_optim_loss: 449770.3194; val_kl_reg_loss: 5730.3330; val_edge_recon_loss: 257132.3438; val_cond_contrastive_loss: 78382.3906; val_gene_expr_recon_loss: 104070.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445315.6562; val_optim_loss: 445315.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9897; val_auprc_score: 0.9873; val_best_acc_score: 0.9586; val_best_f1_score: 0.9601; train_kl_reg_loss: 5794.2265; train_edge_recon_loss: 258953.5885; train_cond_contrastive_loss: 78697.1901; train_gene_expr_recon_loss: 105157.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448602.4444; train_optim_loss: 448602.4444; val_kl_reg_loss: 5727.1963; val_edge_recon_loss: 255762.8125; val_cond_contrastive_loss: 78384.8125; val_gene_expr_recon_loss: 103699.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443574.1562; val_optim_loss: 443574.1562
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9900; val_auprc_score: 0.9848; val_best_acc_score: 0.9606; val_best_f1_score: 0.9618; train_kl_reg_loss: 5761.4880; train_edge_recon_loss: 259118.5608; train_cond_contrastive_loss: 78689.1719; train_gene_expr_recon_loss: 104869.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448439.1979; train_optim_loss: 448439.1979; val_kl_reg_loss: 5702.8604; val_edge_recon_loss: 255950.3594; val_cond_contrastive_loss: 78388.1328; val_gene_expr_recon_loss: 103378.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443419.5625; val_optim_loss: 443419.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9913; val_auprc_score: 0.9890; val_best_acc_score: 0.9635; val_best_f1_score: 0.9642; train_kl_reg_loss: 5739.1508; train_edge_recon_loss: 258729.5642; train_cond_contrastive_loss: 78688.2066; train_gene_expr_recon_loss: 104470.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447627.5312; train_optim_loss: 447627.5312; val_kl_reg_loss: 5735.3750; val_edge_recon_loss: 259562.6406; val_cond_contrastive_loss: 78390.4531; val_gene_expr_recon_loss: 103051.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446739.5625; val_optim_loss: 446739.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9910; val_auprc_score: 0.9868; val_best_acc_score: 0.9630; val_best_f1_score: 0.9640; train_kl_reg_loss: 5727.2316; train_edge_recon_loss: 258823.3906; train_cond_contrastive_loss: 78690.5009; train_gene_expr_recon_loss: 104152.4957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447393.6215; train_optim_loss: 447393.6215; val_kl_reg_loss: 5700.9072; val_edge_recon_loss: 258400.1719; val_cond_contrastive_loss: 78391.4375; val_gene_expr_recon_loss: 102738.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445231.5000; val_optim_loss: 445231.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9920; val_auprc_score: 0.9876; val_best_acc_score: 0.9662; val_best_f1_score: 0.9674; train_kl_reg_loss: 5747.1644; train_edge_recon_loss: 257234.9740; train_cond_contrastive_loss: 78688.5590; train_gene_expr_recon_loss: 103896.4601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445567.1562; train_optim_loss: 445567.1562; val_kl_reg_loss: 5653.2998; val_edge_recon_loss: 253841.9062; val_cond_contrastive_loss: 78393.5391; val_gene_expr_recon_loss: 102470.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440359.0312; val_optim_loss: 440359.0312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9915; val_auprc_score: 0.9891; val_best_acc_score: 0.9649; val_best_f1_score: 0.9658; train_kl_reg_loss: 5736.5318; train_edge_recon_loss: 257498.1059; train_cond_contrastive_loss: 78693.6762; train_gene_expr_recon_loss: 103657.2700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445585.5972; train_optim_loss: 445585.5972; val_kl_reg_loss: 5647.6543; val_edge_recon_loss: 256618.2656; val_cond_contrastive_loss: 78393.9766; val_gene_expr_recon_loss: 102206.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442866.1562; val_optim_loss: 442866.1562
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9920; val_auprc_score: 0.9886; val_best_acc_score: 0.9659; val_best_f1_score: 0.9667; train_kl_reg_loss: 5720.2776; train_edge_recon_loss: 257484.5903; train_cond_contrastive_loss: 78692.8898; train_gene_expr_recon_loss: 103388.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445285.9201; train_optim_loss: 445285.9201; val_kl_reg_loss: 5651.7744; val_edge_recon_loss: 257054.6562; val_cond_contrastive_loss: 78394.5078; val_gene_expr_recon_loss: 101958.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443059.3125; val_optim_loss: 443059.3125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9926; val_auprc_score: 0.9896; val_best_acc_score: 0.9672; val_best_f1_score: 0.9680; train_kl_reg_loss: 5693.7454; train_edge_recon_loss: 257164.2865; train_cond_contrastive_loss: 78691.9306; train_gene_expr_recon_loss: 103113.9410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444663.9062; train_optim_loss: 444663.9062; val_kl_reg_loss: 5630.0674; val_edge_recon_loss: 255854.0469; val_cond_contrastive_loss: 78396.5156; val_gene_expr_recon_loss: 101779.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441659.9688; val_optim_loss: 441659.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9928; val_auprc_score: 0.9903; val_best_acc_score: 0.9676; val_best_f1_score: 0.9683; train_kl_reg_loss: 5712.3250; train_edge_recon_loss: 257205.3108; train_cond_contrastive_loss: 78686.9653; train_gene_expr_recon_loss: 102946.1076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444550.7014; train_optim_loss: 444550.7014; val_kl_reg_loss: 5640.1431; val_edge_recon_loss: 257764.5469; val_cond_contrastive_loss: 78396.8672; val_gene_expr_recon_loss: 101723.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443525.4375; val_optim_loss: 443525.4375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9924; val_auprc_score: 0.9887; val_best_acc_score: 0.9681; val_best_f1_score: 0.9689; train_kl_reg_loss: 5691.3766; train_edge_recon_loss: 257137.1354; train_cond_contrastive_loss: 78689.3950; train_gene_expr_recon_loss: 102985.8142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444503.7188; train_optim_loss: 444503.7188; val_kl_reg_loss: 5606.1758; val_edge_recon_loss: 257060.7031; val_cond_contrastive_loss: 78396.7812; val_gene_expr_recon_loss: 101687.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442751.1250; val_optim_loss: 442751.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9921; val_auprc_score: 0.9898; val_best_acc_score: 0.9685; val_best_f1_score: 0.9691; train_kl_reg_loss: 5677.9160; train_edge_recon_loss: 257076.8681; train_cond_contrastive_loss: 78690.4514; train_gene_expr_recon_loss: 102829.7622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444274.9931; train_optim_loss: 444274.9931; val_kl_reg_loss: 5607.7637; val_edge_recon_loss: 256283.0156; val_cond_contrastive_loss: 78396.8359; val_gene_expr_recon_loss: 101662.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441949.9688; val_optim_loss: 441949.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9923
Val AUPRC score: 0.9885
Val best accuracy score: 0.9666
Val best F1 score: 0.9673
Val gene expr MSE score: 1.4545
Duration of model training in run 10: 0 hours, 4 minutes and 2 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
