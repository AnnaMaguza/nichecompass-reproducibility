Run timestamp: 21062023_134924.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6618; val_auprc_score: 0.6942; val_best_acc_score: 0.6391; val_best_f1_score: 0.6527; train_kl_reg_loss: 1169.9799; train_edge_recon_loss: 367601.8281; train_cond_contrastive_loss: 140043.5859; train_gene_expr_recon_loss: 137344.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 646160.3125; train_optim_loss: 646160.3125; val_kl_reg_loss: 2089.1851; val_edge_recon_loss: 418611.2812; val_cond_contrastive_loss: 78434.0625; val_gene_expr_recon_loss: 116479.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 615613.6250; val_optim_loss: 615613.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6663; val_auprc_score: 0.7012; val_best_acc_score: 0.6264; val_best_f1_score: 0.6579; train_kl_reg_loss: 2814.9219; train_edge_recon_loss: 380006.0000; train_cond_contrastive_loss: 99551.8516; train_gene_expr_recon_loss: 115250.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 597623.6562; train_optim_loss: 597623.6562; val_kl_reg_loss: 5829.6465; val_edge_recon_loss: 412404.0938; val_cond_contrastive_loss: 78406.3828; val_gene_expr_recon_loss: 107778.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 604418.8125; val_optim_loss: 604418.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6611; val_auprc_score: 0.6831; val_best_acc_score: 0.6270; val_best_f1_score: 0.6529; train_kl_reg_loss: 9133.5381; train_edge_recon_loss: 385109.5156; train_cond_contrastive_loss: 85790.9844; train_gene_expr_recon_loss: 109293.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 589327.1875; train_optim_loss: 589327.1875; val_kl_reg_loss: 8735.6289; val_edge_recon_loss: 412946.5625; val_cond_contrastive_loss: 78420.8984; val_gene_expr_recon_loss: 105018.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 605121.1250; val_optim_loss: 605121.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6481; val_auprc_score: 0.6752; val_best_acc_score: 0.6192; val_best_f1_score: 0.6487; train_kl_reg_loss: 8256.8611; train_edge_recon_loss: 380624.4844; train_cond_contrastive_loss: 85677.8320; train_gene_expr_recon_loss: 106610.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 581169.8125; train_optim_loss: 581169.8125; val_kl_reg_loss: 5564.6064; val_edge_recon_loss: 406580.3438; val_cond_contrastive_loss: 78454.5547; val_gene_expr_recon_loss: 103416.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 594016.1250; val_optim_loss: 594016.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6386; val_auprc_score: 0.6610; val_best_acc_score: 0.6114; val_best_f1_score: 0.6471; train_kl_reg_loss: 5433.3594; train_edge_recon_loss: 376669.1562; train_cond_contrastive_loss: 87511.1680; train_gene_expr_recon_loss: 104624.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 574238.4062; train_optim_loss: 574238.4062; val_kl_reg_loss: 4232.7783; val_edge_recon_loss: 396727.5312; val_cond_contrastive_loss: 78508.0859; val_gene_expr_recon_loss: 102747.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 582215.4375; val_optim_loss: 582215.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6443; val_auprc_score: 0.6743; val_best_acc_score: 0.6164; val_best_f1_score: 0.6566; train_kl_reg_loss: 4136.6337; train_edge_recon_loss: 367915.9531; train_cond_contrastive_loss: 88359.2500; train_gene_expr_recon_loss: 103807.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564218.8125; train_optim_loss: 564218.8125; val_kl_reg_loss: 3405.8245; val_edge_recon_loss: 377750.8750; val_cond_contrastive_loss: 78550.7891; val_gene_expr_recon_loss: 102522.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 562229.6250; val_optim_loss: 562229.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6533; val_auprc_score: 0.6743; val_best_acc_score: 0.6208; val_best_f1_score: 0.6548; train_kl_reg_loss: 3339.6942; train_edge_recon_loss: 356230.2969; train_cond_contrastive_loss: 87327.8633; train_gene_expr_recon_loss: 103663.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550561.7500; train_optim_loss: 550561.7500; val_kl_reg_loss: 3044.7173; val_edge_recon_loss: 365141.0312; val_cond_contrastive_loss: 78504.3203; val_gene_expr_recon_loss: 102337.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 549027.2500; val_optim_loss: 549027.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6639; val_auprc_score: 0.6776; val_best_acc_score: 0.6268; val_best_f1_score: 0.6552; train_kl_reg_loss: 3057.4420; train_edge_recon_loss: 347544.7969; train_cond_contrastive_loss: 84613.2773; train_gene_expr_recon_loss: 103455.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 538670.8125; train_optim_loss: 538670.8125; val_kl_reg_loss: 3126.3013; val_edge_recon_loss: 359665.7500; val_cond_contrastive_loss: 78427.6016; val_gene_expr_recon_loss: 102184.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 543404.0625; val_optim_loss: 543404.0625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6634; val_auprc_score: 0.6740; val_best_acc_score: 0.6318; val_best_f1_score: 0.6470; train_kl_reg_loss: 3177.8712; train_edge_recon_loss: 347328.2812; train_cond_contrastive_loss: 82257.2578; train_gene_expr_recon_loss: 103228.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 535992.1250; train_optim_loss: 535992.1250; val_kl_reg_loss: 3386.0852; val_edge_recon_loss: 367184.7812; val_cond_contrastive_loss: 78400.3125; val_gene_expr_recon_loss: 101978.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550950.0000; val_optim_loss: 550950.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6561; val_auprc_score: 0.6717; val_best_acc_score: 0.6323; val_best_f1_score: 0.6445; train_kl_reg_loss: 3426.9487; train_edge_recon_loss: 343733.9688; train_cond_contrastive_loss: 81182.2578; train_gene_expr_recon_loss: 103100.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531444.0625; train_optim_loss: 531444.0625; val_kl_reg_loss: 3594.2534; val_edge_recon_loss: 370921.5312; val_cond_contrastive_loss: 78388.0234; val_gene_expr_recon_loss: 101639.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554543.0000; val_optim_loss: 554543.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6718; val_auprc_score: 0.6860; val_best_acc_score: 0.6312; val_best_f1_score: 0.6564; train_kl_reg_loss: 3589.2523; train_edge_recon_loss: 347932.7969; train_cond_contrastive_loss: 80576.7305; train_gene_expr_recon_loss: 102769.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534868.4688; train_optim_loss: 534868.4688; val_kl_reg_loss: 3645.1494; val_edge_recon_loss: 358798.7500; val_cond_contrastive_loss: 78389.7891; val_gene_expr_recon_loss: 101308.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542142.2500; val_optim_loss: 542142.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6781; val_auprc_score: 0.6901; val_best_acc_score: 0.6427; val_best_f1_score: 0.6508; train_kl_reg_loss: 3598.9934; train_edge_recon_loss: 343382.0312; train_cond_contrastive_loss: 80367.9570; train_gene_expr_recon_loss: 102377.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529726.3125; train_optim_loss: 529726.3125; val_kl_reg_loss: 3616.1885; val_edge_recon_loss: 363335.6562; val_cond_contrastive_loss: 78384.3594; val_gene_expr_recon_loss: 101107.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546443.5625; val_optim_loss: 546443.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6883; val_auprc_score: 0.6969; val_best_acc_score: 0.6438; val_best_f1_score: 0.6621; train_kl_reg_loss: 3588.7261; train_edge_recon_loss: 339951.8750; train_cond_contrastive_loss: 80428.0391; train_gene_expr_recon_loss: 102307.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 526276.1562; train_optim_loss: 526276.1562; val_kl_reg_loss: 3673.1343; val_edge_recon_loss: 353867.2188; val_cond_contrastive_loss: 78392.5938; val_gene_expr_recon_loss: 100959.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536892.3125; val_optim_loss: 536892.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7176; val_auprc_score: 0.7225; val_best_acc_score: 0.6680; val_best_f1_score: 0.6761; train_kl_reg_loss: 3655.5105; train_edge_recon_loss: 337875.5000; train_cond_contrastive_loss: 80252.7656; train_gene_expr_recon_loss: 102084.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 523867.8594; train_optim_loss: 523867.8594; val_kl_reg_loss: 3829.8105; val_edge_recon_loss: 338481.1250; val_cond_contrastive_loss: 78405.2734; val_gene_expr_recon_loss: 100809.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 521526.0312; val_optim_loss: 521526.0312
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7359; val_auprc_score: 0.7290; val_best_acc_score: 0.6844; val_best_f1_score: 0.6737; train_kl_reg_loss: 3804.9216; train_edge_recon_loss: 332533.3594; train_cond_contrastive_loss: 80031.1055; train_gene_expr_recon_loss: 101849.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518218.9375; train_optim_loss: 518218.9375; val_kl_reg_loss: 4108.9580; val_edge_recon_loss: 340605.8125; val_cond_contrastive_loss: 78415.4219; val_gene_expr_recon_loss: 100624.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523754.6875; val_optim_loss: 523754.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7494; val_auprc_score: 0.7312; val_best_acc_score: 0.6837; val_best_f1_score: 0.6925; train_kl_reg_loss: 4177.1061; train_edge_recon_loss: 327663.8906; train_cond_contrastive_loss: 79649.2266; train_gene_expr_recon_loss: 101829.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513319.6094; train_optim_loss: 513319.6094; val_kl_reg_loss: 4629.3916; val_edge_recon_loss: 331070.4375; val_cond_contrastive_loss: 78430.3438; val_gene_expr_recon_loss: 100403.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 514534.1562; val_optim_loss: 514534.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7743; val_auprc_score: 0.7420; val_best_acc_score: 0.7025; val_best_f1_score: 0.7104; train_kl_reg_loss: 4753.8198; train_edge_recon_loss: 319303.3125; train_cond_contrastive_loss: 79254.4609; train_gene_expr_recon_loss: 101490.7227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504802.3125; train_optim_loss: 504802.3125; val_kl_reg_loss: 5265.1855; val_edge_recon_loss: 322892.5938; val_cond_contrastive_loss: 78457.0938; val_gene_expr_recon_loss: 100149.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 506764.2500; val_optim_loss: 506764.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7900; val_auprc_score: 0.7555; val_best_acc_score: 0.7128; val_best_f1_score: 0.7308; train_kl_reg_loss: 5470.5693; train_edge_recon_loss: 313495.8594; train_cond_contrastive_loss: 78972.6602; train_gene_expr_recon_loss: 101163.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499102.3594; train_optim_loss: 499102.3594; val_kl_reg_loss: 6037.7305; val_edge_recon_loss: 315874.6250; val_cond_contrastive_loss: 78453.4297; val_gene_expr_recon_loss: 99877.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500243.6562; val_optim_loss: 500243.6562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7884; val_auprc_score: 0.7441; val_best_acc_score: 0.7109; val_best_f1_score: 0.7432; train_kl_reg_loss: 6254.3965; train_edge_recon_loss: 306935.8750; train_cond_contrastive_loss: 78774.9141; train_gene_expr_recon_loss: 100813.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492778.7656; train_optim_loss: 492778.7656; val_kl_reg_loss: 6722.7222; val_edge_recon_loss: 313029.3438; val_cond_contrastive_loss: 78443.8203; val_gene_expr_recon_loss: 99619.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497815.5000; val_optim_loss: 497815.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7929; val_auprc_score: 0.7545; val_best_acc_score: 0.7145; val_best_f1_score: 0.7489; train_kl_reg_loss: 6993.7805; train_edge_recon_loss: 306216.3906; train_cond_contrastive_loss: 78669.8633; train_gene_expr_recon_loss: 100878.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492758.9688; train_optim_loss: 492758.9688; val_kl_reg_loss: 7369.4111; val_edge_recon_loss: 310717.6562; val_cond_contrastive_loss: 78429.6484; val_gene_expr_recon_loss: 99387.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 495903.8125; val_optim_loss: 495903.8125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8052; val_auprc_score: 0.7611; val_best_acc_score: 0.7273; val_best_f1_score: 0.7615; train_kl_reg_loss: 7649.7664; train_edge_recon_loss: 304525.1250; train_cond_contrastive_loss: 78612.4336; train_gene_expr_recon_loss: 100237.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491025.1094; train_optim_loss: 491025.1094; val_kl_reg_loss: 7812.2144; val_edge_recon_loss: 305087.0000; val_cond_contrastive_loss: 78424.7109; val_gene_expr_recon_loss: 99169.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490493.1250; val_optim_loss: 490493.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8073; val_auprc_score: 0.7568; val_best_acc_score: 0.7308; val_best_f1_score: 0.7630; train_kl_reg_loss: 8035.4187; train_edge_recon_loss: 302234.6875; train_cond_contrastive_loss: 78598.7969; train_gene_expr_recon_loss: 100121.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 488989.9688; train_optim_loss: 488989.9688; val_kl_reg_loss: 7966.1338; val_edge_recon_loss: 305271.3125; val_cond_contrastive_loss: 78414.8281; val_gene_expr_recon_loss: 98983.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490635.6250; val_optim_loss: 490635.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8100; val_auprc_score: 0.7644; val_best_acc_score: 0.7363; val_best_f1_score: 0.7620; train_kl_reg_loss: 8156.7141; train_edge_recon_loss: 299774.7031; train_cond_contrastive_loss: 78633.7578; train_gene_expr_recon_loss: 100017.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486582.3594; train_optim_loss: 486582.3594; val_kl_reg_loss: 7881.1328; val_edge_recon_loss: 305609.1250; val_cond_contrastive_loss: 78406.1250; val_gene_expr_recon_loss: 98818.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490715.1250; val_optim_loss: 490715.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8200; val_auprc_score: 0.7642; val_best_acc_score: 0.7431; val_best_f1_score: 0.7679; train_kl_reg_loss: 8061.2825; train_edge_recon_loss: 300985.5156; train_cond_contrastive_loss: 78689.2930; train_gene_expr_recon_loss: 99787.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487523.2812; train_optim_loss: 487523.2812; val_kl_reg_loss: 7731.4268; val_edge_recon_loss: 301445.5000; val_cond_contrastive_loss: 78404.5000; val_gene_expr_recon_loss: 98635.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486216.9375; val_optim_loss: 486216.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8365; val_auprc_score: 0.7957; val_best_acc_score: 0.7539; val_best_f1_score: 0.7723; train_kl_reg_loss: 7898.0771; train_edge_recon_loss: 298873.3750; train_cond_contrastive_loss: 78740.1719; train_gene_expr_recon_loss: 99685.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485197.0938; train_optim_loss: 485197.0938; val_kl_reg_loss: 7495.4453; val_edge_recon_loss: 300736.5000; val_cond_contrastive_loss: 78404.2422; val_gene_expr_recon_loss: 98475.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485111.8125; val_optim_loss: 485111.8125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8349; val_auprc_score: 0.7875; val_best_acc_score: 0.7599; val_best_f1_score: 0.7785; train_kl_reg_loss: 7641.1968; train_edge_recon_loss: 297938.8594; train_cond_contrastive_loss: 78801.0156; train_gene_expr_recon_loss: 99483.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483864.9688; train_optim_loss: 483864.9688; val_kl_reg_loss: 7165.6670; val_edge_recon_loss: 296813.4375; val_cond_contrastive_loss: 78410.3125; val_gene_expr_recon_loss: 98353.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480742.9375; val_optim_loss: 480742.9375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8308; val_auprc_score: 0.7747; val_best_acc_score: 0.7543; val_best_f1_score: 0.7710; train_kl_reg_loss: 7309.0776; train_edge_recon_loss: 296761.2969; train_cond_contrastive_loss: 78902.0664; train_gene_expr_recon_loss: 99397.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482370.3906; train_optim_loss: 482370.3906; val_kl_reg_loss: 6846.4473; val_edge_recon_loss: 303823.4688; val_cond_contrastive_loss: 78414.5156; val_gene_expr_recon_loss: 98248.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487332.5312; val_optim_loss: 487332.5312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8458; val_auprc_score: 0.7933; val_best_acc_score: 0.7774; val_best_f1_score: 0.7957; train_kl_reg_loss: 6992.5879; train_edge_recon_loss: 298491.9219; train_cond_contrastive_loss: 79001.9492; train_gene_expr_recon_loss: 99221.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483707.4688; train_optim_loss: 483707.4688; val_kl_reg_loss: 6599.7793; val_edge_recon_loss: 287106.0312; val_cond_contrastive_loss: 78421.3359; val_gene_expr_recon_loss: 98142.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470269.3750; val_optim_loss: 470269.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8415; val_auprc_score: 0.7936; val_best_acc_score: 0.7747; val_best_f1_score: 0.7870; train_kl_reg_loss: 6772.5117; train_edge_recon_loss: 296317.5000; train_cond_contrastive_loss: 79057.3672; train_gene_expr_recon_loss: 99208.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481355.4531; train_optim_loss: 481355.4531; val_kl_reg_loss: 6504.0820; val_edge_recon_loss: 298456.0938; val_cond_contrastive_loss: 78426.4297; val_gene_expr_recon_loss: 98025.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481411.8438; val_optim_loss: 481411.8438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8535; val_auprc_score: 0.8050; val_best_acc_score: 0.7840; val_best_f1_score: 0.7945; train_kl_reg_loss: 6717.9324; train_edge_recon_loss: 296458.4219; train_cond_contrastive_loss: 79045.5742; train_gene_expr_recon_loss: 98955.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481177.4844; train_optim_loss: 481177.4844; val_kl_reg_loss: 6530.1309; val_edge_recon_loss: 296402.8750; val_cond_contrastive_loss: 78435.4297; val_gene_expr_recon_loss: 97915.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479283.8750; val_optim_loss: 479283.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8606; val_auprc_score: 0.8070; val_best_acc_score: 0.7931; val_best_f1_score: 0.8027; train_kl_reg_loss: 6742.5540; train_edge_recon_loss: 295519.8281; train_cond_contrastive_loss: 78997.9141; train_gene_expr_recon_loss: 98965.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480225.6875; train_optim_loss: 480225.6875; val_kl_reg_loss: 6571.6831; val_edge_recon_loss: 294598.8750; val_cond_contrastive_loss: 78445.3594; val_gene_expr_recon_loss: 97811.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477427.5000; val_optim_loss: 477427.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8576; val_auprc_score: 0.8037; val_best_acc_score: 0.7861; val_best_f1_score: 0.7981; train_kl_reg_loss: 6778.9956; train_edge_recon_loss: 292852.7344; train_cond_contrastive_loss: 78959.5195; train_gene_expr_recon_loss: 98772.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477363.9062; train_optim_loss: 477363.9062; val_kl_reg_loss: 6583.9434; val_edge_recon_loss: 295386.1562; val_cond_contrastive_loss: 78444.2422; val_gene_expr_recon_loss: 97797.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478211.6250; val_optim_loss: 478211.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8551; val_auprc_score: 0.8024; val_best_acc_score: 0.7911; val_best_f1_score: 0.8049; train_kl_reg_loss: 6776.9248; train_edge_recon_loss: 292498.3594; train_cond_contrastive_loss: 78950.8398; train_gene_expr_recon_loss: 98803.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477030.0938; train_optim_loss: 477030.0938; val_kl_reg_loss: 6577.7432; val_edge_recon_loss: 289240.1875; val_cond_contrastive_loss: 78449.6797; val_gene_expr_recon_loss: 97778.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472046.3438; val_optim_loss: 472046.3438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8681; val_auprc_score: 0.8215; val_best_acc_score: 0.8010; val_best_f1_score: 0.8105; train_kl_reg_loss: 6775.5540; train_edge_recon_loss: 291205.7812; train_cond_contrastive_loss: 78945.5742; train_gene_expr_recon_loss: 98824.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475751.0312; train_optim_loss: 475751.0312; val_kl_reg_loss: 6571.1777; val_edge_recon_loss: 293061.1562; val_cond_contrastive_loss: 78444.7266; val_gene_expr_recon_loss: 97758.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475835.3125; val_optim_loss: 475835.3125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 1 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.8391
Val AUPRC score: 0.7949
Val best accuracy score: 0.7674
Val best F1 score: 0.7894
Val gene expr MSE score: 1.8743
Duration of model training in run 1: 0 hours, 1 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6686; val_auprc_score: 0.6916; val_best_acc_score: 0.6461; val_best_f1_score: 0.6459; train_kl_reg_loss: 1175.8006; train_edge_recon_loss: 368884.6719; train_cond_contrastive_loss: 138332.2891; train_gene_expr_recon_loss: 139421.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 647813.8438; train_optim_loss: 647813.8438; val_kl_reg_loss: 2115.0298; val_edge_recon_loss: 428353.1562; val_cond_contrastive_loss: 78432.3516; val_gene_expr_recon_loss: 119956.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 628857.5000; val_optim_loss: 628857.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6596; val_auprc_score: 0.6746; val_best_acc_score: 0.6342; val_best_f1_score: 0.6471; train_kl_reg_loss: 2922.2375; train_edge_recon_loss: 380532.0625; train_cond_contrastive_loss: 97339.6523; train_gene_expr_recon_loss: 115796.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 596590.6562; train_optim_loss: 596590.6562; val_kl_reg_loss: 7883.6328; val_edge_recon_loss: 428207.5312; val_cond_contrastive_loss: 78410.2500; val_gene_expr_recon_loss: 110259.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 624760.6875; val_optim_loss: 624760.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6451; val_auprc_score: 0.6649; val_best_acc_score: 0.6238; val_best_f1_score: 0.6468; train_kl_reg_loss: 8675.5977; train_edge_recon_loss: 383712.7969; train_cond_contrastive_loss: 83311.4102; train_gene_expr_recon_loss: 109199.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 584899.0938; train_optim_loss: 584899.0938; val_kl_reg_loss: 6520.0342; val_edge_recon_loss: 420553.5000; val_cond_contrastive_loss: 78425.1484; val_gene_expr_recon_loss: 107628.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 613127.5000; val_optim_loss: 613127.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6382; val_auprc_score: 0.6587; val_best_acc_score: 0.6218; val_best_f1_score: 0.6441; train_kl_reg_loss: 6503.9951; train_edge_recon_loss: 379220.9844; train_cond_contrastive_loss: 85503.6133; train_gene_expr_recon_loss: 105927.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577155.5938; train_optim_loss: 577155.5938; val_kl_reg_loss: 5118.1318; val_edge_recon_loss: 411922.7500; val_cond_contrastive_loss: 78455.2734; val_gene_expr_recon_loss: 105743.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 601239.4375; val_optim_loss: 601239.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6224; val_auprc_score: 0.6366; val_best_acc_score: 0.6162; val_best_f1_score: 0.6363; train_kl_reg_loss: 5113.4568; train_edge_recon_loss: 372684.2031; train_cond_contrastive_loss: 86825.6094; train_gene_expr_recon_loss: 104052.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 568676.0312; train_optim_loss: 568676.0312; val_kl_reg_loss: 4002.4358; val_edge_recon_loss: 405461.4062; val_cond_contrastive_loss: 78492.5000; val_gene_expr_recon_loss: 104855.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592811.3750; val_optim_loss: 592811.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6133; val_auprc_score: 0.6266; val_best_acc_score: 0.6012; val_best_f1_score: 0.6367; train_kl_reg_loss: 3876.9888; train_edge_recon_loss: 366338.9531; train_cond_contrastive_loss: 87918.9609; train_gene_expr_recon_loss: 103325.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 561460.4062; train_optim_loss: 561460.4062; val_kl_reg_loss: 3068.4153; val_edge_recon_loss: 394640.4062; val_cond_contrastive_loss: 78520.1016; val_gene_expr_recon_loss: 104623.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 580852.7500; val_optim_loss: 580852.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6214; val_auprc_score: 0.6425; val_best_acc_score: 0.6059; val_best_f1_score: 0.6428; train_kl_reg_loss: 2996.5529; train_edge_recon_loss: 358275.0156; train_cond_contrastive_loss: 88252.6055; train_gene_expr_recon_loss: 103063.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 552587.9688; train_optim_loss: 552587.9688; val_kl_reg_loss: 2685.7681; val_edge_recon_loss: 381435.8438; val_cond_contrastive_loss: 78497.7812; val_gene_expr_recon_loss: 104474.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567094.0625; val_optim_loss: 567094.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6314; val_auprc_score: 0.6549; val_best_acc_score: 0.6094; val_best_f1_score: 0.6475; train_kl_reg_loss: 2707.8888; train_edge_recon_loss: 351232.3125; train_cond_contrastive_loss: 85309.0273; train_gene_expr_recon_loss: 102969.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542218.5625; train_optim_loss: 542218.5625; val_kl_reg_loss: 2742.7168; val_edge_recon_loss: 373449.5625; val_cond_contrastive_loss: 78427.7500; val_gene_expr_recon_loss: 104302.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558922.9375; val_optim_loss: 558922.9375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6315; val_auprc_score: 0.6491; val_best_acc_score: 0.6211; val_best_f1_score: 0.6409; train_kl_reg_loss: 2801.5205; train_edge_recon_loss: 347673.9844; train_cond_contrastive_loss: 83184.9062; train_gene_expr_recon_loss: 102618.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536279.2188; train_optim_loss: 536279.2188; val_kl_reg_loss: 3014.3716; val_edge_recon_loss: 384521.7188; val_cond_contrastive_loss: 78388.6094; val_gene_expr_recon_loss: 104130.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 570055.2500; val_optim_loss: 570055.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6471; val_auprc_score: 0.6649; val_best_acc_score: 0.6127; val_best_f1_score: 0.6454; train_kl_reg_loss: 3089.7224; train_edge_recon_loss: 346997.1719; train_cond_contrastive_loss: 81716.0938; train_gene_expr_recon_loss: 102528.1289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534331.1250; train_optim_loss: 534331.1250; val_kl_reg_loss: 3304.9360; val_edge_recon_loss: 372107.5625; val_cond_contrastive_loss: 78381.5859; val_gene_expr_recon_loss: 103855.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 557649.4375; val_optim_loss: 557649.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6548; val_auprc_score: 0.6542; val_best_acc_score: 0.6283; val_best_f1_score: 0.6386; train_kl_reg_loss: 3339.6008; train_edge_recon_loss: 347904.7500; train_cond_contrastive_loss: 80850.6367; train_gene_expr_recon_loss: 102106.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534201.3750; train_optim_loss: 534201.3750; val_kl_reg_loss: 3469.5132; val_edge_recon_loss: 379280.6250; val_cond_contrastive_loss: 78378.9922; val_gene_expr_recon_loss: 103510.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564639.6875; val_optim_loss: 564639.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6453; val_auprc_score: 0.6563; val_best_acc_score: 0.6180; val_best_f1_score: 0.6441; train_kl_reg_loss: 3459.0343; train_edge_recon_loss: 347267.9062; train_cond_contrastive_loss: 80458.2383; train_gene_expr_recon_loss: 101707.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532893.0938; train_optim_loss: 532893.0938; val_kl_reg_loss: 3492.7864; val_edge_recon_loss: 378063.9062; val_cond_contrastive_loss: 78378.6484; val_gene_expr_recon_loss: 103265.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 563200.5625; val_optim_loss: 563200.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6523; val_auprc_score: 0.6649; val_best_acc_score: 0.6190; val_best_f1_score: 0.6463; train_kl_reg_loss: 3450.4854; train_edge_recon_loss: 348479.0625; train_cond_contrastive_loss: 80484.0859; train_gene_expr_recon_loss: 101770.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534184.5312; train_optim_loss: 534184.5312; val_kl_reg_loss: 3478.8115; val_edge_recon_loss: 375248.2188; val_cond_contrastive_loss: 78377.3906; val_gene_expr_recon_loss: 103125.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560230.0625; val_optim_loss: 560230.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6527; val_auprc_score: 0.6697; val_best_acc_score: 0.6139; val_best_f1_score: 0.6518; train_kl_reg_loss: 3442.5875; train_edge_recon_loss: 344842.3281; train_cond_contrastive_loss: 80520.4922; train_gene_expr_recon_loss: 101608.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 530414.0312; train_optim_loss: 530414.0312; val_kl_reg_loss: 3482.8887; val_edge_recon_loss: 371236.5938; val_cond_contrastive_loss: 78382.2734; val_gene_expr_recon_loss: 103106.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556207.8750; val_optim_loss: 556207.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6671; val_auprc_score: 0.6717; val_best_acc_score: 0.6298; val_best_f1_score: 0.6498; train_kl_reg_loss: 3418.9197; train_edge_recon_loss: 346594.9688; train_cond_contrastive_loss: 80587.5625; train_gene_expr_recon_loss: 101671.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532272.8438; train_optim_loss: 532272.8438; val_kl_reg_loss: 3480.1704; val_edge_recon_loss: 368522.0625; val_cond_contrastive_loss: 78383.1328; val_gene_expr_recon_loss: 103075.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553461.0000; val_optim_loss: 553461.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.6574; val_auprc_score: 0.6688; val_best_acc_score: 0.6217; val_best_f1_score: 0.6445; train_kl_reg_loss: 3425.2671; train_edge_recon_loss: 343644.6094; train_cond_contrastive_loss: 80605.3398; train_gene_expr_recon_loss: 101620.5234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529295.7500; train_optim_loss: 529295.7500; val_kl_reg_loss: 3451.7822; val_edge_recon_loss: 373734.8750; val_cond_contrastive_loss: 78378.7109; val_gene_expr_recon_loss: 103038.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558604.0000; val_optim_loss: 558604.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.6630; val_auprc_score: 0.6778; val_best_acc_score: 0.6238; val_best_f1_score: 0.6544; train_kl_reg_loss: 3409.9983; train_edge_recon_loss: 345843.0781; train_cond_contrastive_loss: 80672.6094; train_gene_expr_recon_loss: 101453.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531379.2188; train_optim_loss: 531379.2188; val_kl_reg_loss: 3456.0615; val_edge_recon_loss: 368650.1875; val_cond_contrastive_loss: 78378.4297; val_gene_expr_recon_loss: 102998.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553483.0625; val_optim_loss: 553483.0625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.6570; val_auprc_score: 0.6578; val_best_acc_score: 0.6328; val_best_f1_score: 0.6392; train_kl_reg_loss: 3389.3159; train_edge_recon_loss: 342679.4219; train_cond_contrastive_loss: 80640.2305; train_gene_expr_recon_loss: 101400.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528109.5312; train_optim_loss: 528109.5312; val_kl_reg_loss: 3430.5908; val_edge_recon_loss: 383297.5312; val_cond_contrastive_loss: 78375.9531; val_gene_expr_recon_loss: 102957.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568061.4375; val_optim_loss: 568061.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.6554; val_auprc_score: 0.6726; val_best_acc_score: 0.6322; val_best_f1_score: 0.6455; train_kl_reg_loss: 3375.1627; train_edge_recon_loss: 342798.3281; train_cond_contrastive_loss: 80668.7734; train_gene_expr_recon_loss: 101496.2383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528338.5000; train_optim_loss: 528338.5000; val_kl_reg_loss: 3427.0225; val_edge_recon_loss: 376625.3125; val_cond_contrastive_loss: 78376.3125; val_gene_expr_recon_loss: 102953.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561381.8750; val_optim_loss: 561381.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.6719; val_auprc_score: 0.6828; val_best_acc_score: 0.6309; val_best_f1_score: 0.6548; train_kl_reg_loss: 3379.6213; train_edge_recon_loss: 343956.6094; train_cond_contrastive_loss: 80605.0664; train_gene_expr_recon_loss: 101549.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529490.4062; train_optim_loss: 529490.4062; val_kl_reg_loss: 3437.6550; val_edge_recon_loss: 366073.1250; val_cond_contrastive_loss: 78376.0312; val_gene_expr_recon_loss: 102948.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550835.5625; val_optim_loss: 550835.5625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.6644; val_auprc_score: 0.6695; val_best_acc_score: 0.6368; val_best_f1_score: 0.6458; train_kl_reg_loss: 3373.5471; train_edge_recon_loss: 344061.5000; train_cond_contrastive_loss: 80690.7422; train_gene_expr_recon_loss: 101488.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529613.8125; train_optim_loss: 529613.8125; val_kl_reg_loss: 3423.1997; val_edge_recon_loss: 376254.0000; val_cond_contrastive_loss: 78375.8125; val_gene_expr_recon_loss: 102944.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560997.1250; val_optim_loss: 560997.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.6560; val_auprc_score: 0.6622; val_best_acc_score: 0.6297; val_best_f1_score: 0.6433; train_kl_reg_loss: 3363.4305; train_edge_recon_loss: 343387.7031; train_cond_contrastive_loss: 80572.4648; train_gene_expr_recon_loss: 101635.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528959.4688; train_optim_loss: 528959.4688; val_kl_reg_loss: 3429.2856; val_edge_recon_loss: 379410.5938; val_cond_contrastive_loss: 78375.8359; val_gene_expr_recon_loss: 102939.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564155.1875; val_optim_loss: 564155.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.6601; val_auprc_score: 0.6681; val_best_acc_score: 0.6265; val_best_f1_score: 0.6486; train_kl_reg_loss: 3365.7528; train_edge_recon_loss: 345858.6250; train_cond_contrastive_loss: 80709.5469; train_gene_expr_recon_loss: 101421.0742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531355.0000; train_optim_loss: 531355.0000; val_kl_reg_loss: 3418.7046; val_edge_recon_loss: 373782.9688; val_cond_contrastive_loss: 78376.0391; val_gene_expr_recon_loss: 102934.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558512.3125; val_optim_loss: 558512.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.6512; val_auprc_score: 0.6583; val_best_acc_score: 0.6218; val_best_f1_score: 0.6490; train_kl_reg_loss: 3362.8481; train_edge_recon_loss: 342308.3281; train_cond_contrastive_loss: 80673.9648; train_gene_expr_recon_loss: 101442.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 527787.7812; train_optim_loss: 527787.7812; val_kl_reg_loss: 3422.7798; val_edge_recon_loss: 377720.0625; val_cond_contrastive_loss: 78377.7266; val_gene_expr_recon_loss: 102934.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 562454.6875; val_optim_loss: 562454.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.6562; val_auprc_score: 0.6688; val_best_acc_score: 0.6329; val_best_f1_score: 0.6418; train_kl_reg_loss: 3368.0791; train_edge_recon_loss: 342892.1562; train_cond_contrastive_loss: 80700.8203; train_gene_expr_recon_loss: 101535.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528496.9375; train_optim_loss: 528496.9375; val_kl_reg_loss: 3426.6904; val_edge_recon_loss: 382121.5312; val_cond_contrastive_loss: 78374.5312; val_gene_expr_recon_loss: 102933.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 566856.3750; val_optim_loss: 566856.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.6552; val_auprc_score: 0.6733; val_best_acc_score: 0.6238; val_best_f1_score: 0.6535; train_kl_reg_loss: 3374.2736; train_edge_recon_loss: 343933.0312; train_cond_contrastive_loss: 80668.2344; train_gene_expr_recon_loss: 101506.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529482.0625; train_optim_loss: 529482.0625; val_kl_reg_loss: 3411.1016; val_edge_recon_loss: 372076.1562; val_cond_contrastive_loss: 78380.1641; val_gene_expr_recon_loss: 102933.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556800.5000; val_optim_loss: 556800.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 45 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.6616
Val AUPRC score: 0.6624
Val best accuracy score: 0.6320
Val best F1 score: 0.6415
Val gene expr MSE score: 2.1464
Duration of model training in run 2: 0 hours, 0 minutes and 47 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7430; val_auprc_score: 0.7913; val_best_acc_score: 0.6965; val_best_f1_score: 0.6885; train_kl_reg_loss: 1786.2632; train_edge_recon_loss: 353963.2266; train_cond_contrastive_loss: 120483.9434; train_gene_expr_recon_loss: 130682.3926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 606915.8594; train_optim_loss: 606915.8594; val_kl_reg_loss: 4555.8491; val_edge_recon_loss: 400963.2812; val_cond_contrastive_loss: 78358.2812; val_gene_expr_recon_loss: 110279.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 594156.8125; val_optim_loss: 594156.8125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7146; val_auprc_score: 0.7610; val_best_acc_score: 0.6539; val_best_f1_score: 0.6865; train_kl_reg_loss: 9760.3918; train_edge_recon_loss: 359471.8672; train_cond_contrastive_loss: 87225.6035; train_gene_expr_recon_loss: 108479.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564937.6875; train_optim_loss: 564937.6875; val_kl_reg_loss: 8248.4990; val_edge_recon_loss: 396167.8750; val_cond_contrastive_loss: 78371.3125; val_gene_expr_recon_loss: 103803.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 586590.7500; val_optim_loss: 586590.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6843; val_auprc_score: 0.7255; val_best_acc_score: 0.6285; val_best_f1_score: 0.6765; train_kl_reg_loss: 6561.1698; train_edge_recon_loss: 356553.5391; train_cond_contrastive_loss: 87183.3359; train_gene_expr_recon_loss: 103175.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 553473.2656; train_optim_loss: 553473.2656; val_kl_reg_loss: 4555.8774; val_edge_recon_loss: 387457.3750; val_cond_contrastive_loss: 78424.8281; val_gene_expr_recon_loss: 102250.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572688.1250; val_optim_loss: 572688.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6871; val_auprc_score: 0.7314; val_best_acc_score: 0.6283; val_best_f1_score: 0.6867; train_kl_reg_loss: 4317.4077; train_edge_recon_loss: 348605.9531; train_cond_contrastive_loss: 88663.8848; train_gene_expr_recon_loss: 102344.0527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543931.2969; train_optim_loss: 543931.2969; val_kl_reg_loss: 3550.0933; val_edge_recon_loss: 352418.6875; val_cond_contrastive_loss: 78538.0938; val_gene_expr_recon_loss: 101753.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536260.1250; val_optim_loss: 536260.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6795; val_auprc_score: 0.7184; val_best_acc_score: 0.6373; val_best_f1_score: 0.6821; train_kl_reg_loss: 3452.6974; train_edge_recon_loss: 334569.5469; train_cond_contrastive_loss: 87883.0957; train_gene_expr_recon_loss: 101718.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 527623.5859; train_optim_loss: 527623.5859; val_kl_reg_loss: 3316.4897; val_edge_recon_loss: 344862.2500; val_cond_contrastive_loss: 78441.7891; val_gene_expr_recon_loss: 101448.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528069.3125; val_optim_loss: 528069.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6970; val_auprc_score: 0.7314; val_best_acc_score: 0.6426; val_best_f1_score: 0.6864; train_kl_reg_loss: 3567.9584; train_edge_recon_loss: 324643.7188; train_cond_contrastive_loss: 81458.6250; train_gene_expr_recon_loss: 101131.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510801.5781; train_optim_loss: 510801.5781; val_kl_reg_loss: 3800.8130; val_edge_recon_loss: 340785.1250; val_cond_contrastive_loss: 78398.1562; val_gene_expr_recon_loss: 100910.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523895.0625; val_optim_loss: 523895.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7265; val_auprc_score: 0.7542; val_best_acc_score: 0.6661; val_best_f1_score: 0.6999; train_kl_reg_loss: 3987.4166; train_edge_recon_loss: 322922.3750; train_cond_contrastive_loss: 79608.1777; train_gene_expr_recon_loss: 100141.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 506659.8828; train_optim_loss: 506659.8828; val_kl_reg_loss: 4000.0220; val_edge_recon_loss: 326576.8125; val_cond_contrastive_loss: 78397.5938; val_gene_expr_recon_loss: 100404.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509379.0625; val_optim_loss: 509379.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7630; val_auprc_score: 0.7702; val_best_acc_score: 0.6843; val_best_f1_score: 0.7261; train_kl_reg_loss: 4122.1592; train_edge_recon_loss: 312775.5156; train_cond_contrastive_loss: 79265.6973; train_gene_expr_recon_loss: 100483.1426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496646.5078; train_optim_loss: 496646.5078; val_kl_reg_loss: 4305.2549; val_edge_recon_loss: 310582.0625; val_cond_contrastive_loss: 78424.0938; val_gene_expr_recon_loss: 100084.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493395.6875; val_optim_loss: 493395.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8061; val_auprc_score: 0.7968; val_best_acc_score: 0.7246; val_best_f1_score: 0.7594; train_kl_reg_loss: 4749.4463; train_edge_recon_loss: 300659.2266; train_cond_contrastive_loss: 78982.7715; train_gene_expr_recon_loss: 99996.3848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484387.8203; train_optim_loss: 484387.8203; val_kl_reg_loss: 5310.9316; val_edge_recon_loss: 298215.2812; val_cond_contrastive_loss: 78436.2500; val_gene_expr_recon_loss: 99681.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481644.1562; val_optim_loss: 481644.1562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8207; val_auprc_score: 0.8016; val_best_acc_score: 0.7493; val_best_f1_score: 0.7796; train_kl_reg_loss: 5854.8040; train_edge_recon_loss: 289804.4219; train_cond_contrastive_loss: 78745.0645; train_gene_expr_recon_loss: 99138.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473542.4609; train_optim_loss: 473542.4609; val_kl_reg_loss: 6468.8989; val_edge_recon_loss: 290247.8438; val_cond_contrastive_loss: 78422.2656; val_gene_expr_recon_loss: 99124.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474263.0625; val_optim_loss: 474263.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8252; val_auprc_score: 0.7988; val_best_acc_score: 0.7567; val_best_f1_score: 0.7888; train_kl_reg_loss: 6927.1456; train_edge_recon_loss: 284521.8359; train_cond_contrastive_loss: 78648.7480; train_gene_expr_recon_loss: 98928.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469026.0703; train_optim_loss: 469026.0703; val_kl_reg_loss: 7175.4468; val_edge_recon_loss: 287050.1875; val_cond_contrastive_loss: 78408.8281; val_gene_expr_recon_loss: 98670.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471304.5625; val_optim_loss: 471304.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8343; val_auprc_score: 0.8047; val_best_acc_score: 0.7651; val_best_f1_score: 0.7930; train_kl_reg_loss: 7307.6475; train_edge_recon_loss: 282984.3359; train_cond_contrastive_loss: 78656.6230; train_gene_expr_recon_loss: 98518.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467466.6094; train_optim_loss: 467466.6094; val_kl_reg_loss: 6977.0127; val_edge_recon_loss: 286231.5625; val_cond_contrastive_loss: 78403.0391; val_gene_expr_recon_loss: 98271.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469883.1875; val_optim_loss: 469883.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8406; val_auprc_score: 0.8022; val_best_acc_score: 0.7755; val_best_f1_score: 0.8024; train_kl_reg_loss: 6982.2319; train_edge_recon_loss: 279374.2031; train_cond_contrastive_loss: 78813.1738; train_gene_expr_recon_loss: 97684.5996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462854.1953; train_optim_loss: 462854.1953; val_kl_reg_loss: 6658.9082; val_edge_recon_loss: 285485.5625; val_cond_contrastive_loss: 78399.8281; val_gene_expr_recon_loss: 97980.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468524.6875; val_optim_loss: 468524.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8582; val_auprc_score: 0.8187; val_best_acc_score: 0.7913; val_best_f1_score: 0.8109; train_kl_reg_loss: 6787.1763; train_edge_recon_loss: 281397.4609; train_cond_contrastive_loss: 78914.4688; train_gene_expr_recon_loss: 97281.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464380.4219; train_optim_loss: 464380.4219; val_kl_reg_loss: 6604.6963; val_edge_recon_loss: 285582.4375; val_cond_contrastive_loss: 78403.5156; val_gene_expr_recon_loss: 97723.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468314.5000; val_optim_loss: 468314.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8798; val_auprc_score: 0.8520; val_best_acc_score: 0.8106; val_best_f1_score: 0.8299; train_kl_reg_loss: 6816.2302; train_edge_recon_loss: 275715.7109; train_cond_contrastive_loss: 78926.1699; train_gene_expr_recon_loss: 96993.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458451.4922; train_optim_loss: 458451.4922; val_kl_reg_loss: 6756.3657; val_edge_recon_loss: 276608.2812; val_cond_contrastive_loss: 78414.1562; val_gene_expr_recon_loss: 97449.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459228.2812; val_optim_loss: 459228.2812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8889; val_auprc_score: 0.8677; val_best_acc_score: 0.8178; val_best_f1_score: 0.8380; train_kl_reg_loss: 6942.7048; train_edge_recon_loss: 275143.0078; train_cond_contrastive_loss: 78831.5391; train_gene_expr_recon_loss: 97273.9863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458191.2422; train_optim_loss: 458191.2422; val_kl_reg_loss: 6763.9219; val_edge_recon_loss: 274072.0000; val_cond_contrastive_loss: 78429.5000; val_gene_expr_recon_loss: 97133.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456398.5625; val_optim_loss: 456398.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8968; val_auprc_score: 0.8724; val_best_acc_score: 0.8223; val_best_f1_score: 0.8387; train_kl_reg_loss: 6800.0476; train_edge_recon_loss: 273772.8516; train_cond_contrastive_loss: 78811.6035; train_gene_expr_recon_loss: 96985.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456369.6953; train_optim_loss: 456369.6953; val_kl_reg_loss: 6389.7334; val_edge_recon_loss: 277639.5000; val_cond_contrastive_loss: 78440.3828; val_gene_expr_recon_loss: 96900.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459370.0000; val_optim_loss: 459370.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9198; val_auprc_score: 0.9051; val_best_acc_score: 0.8432; val_best_f1_score: 0.8551; train_kl_reg_loss: 6408.1283; train_edge_recon_loss: 271720.1719; train_cond_contrastive_loss: 78854.7422; train_gene_expr_recon_loss: 96417.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453400.2969; train_optim_loss: 453400.2969; val_kl_reg_loss: 6146.7588; val_edge_recon_loss: 272502.7812; val_cond_contrastive_loss: 78449.1562; val_gene_expr_recon_loss: 96694.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453792.8438; val_optim_loss: 453792.8438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9239; val_auprc_score: 0.9079; val_best_acc_score: 0.8465; val_best_f1_score: 0.8540; train_kl_reg_loss: 6240.3196; train_edge_recon_loss: 271193.5859; train_cond_contrastive_loss: 78787.4492; train_gene_expr_recon_loss: 96214.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452435.9922; train_optim_loss: 452435.9922; val_kl_reg_loss: 6065.6729; val_edge_recon_loss: 276486.2188; val_cond_contrastive_loss: 78447.4453; val_gene_expr_recon_loss: 96441.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457440.9688; val_optim_loss: 457440.9688
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9393; val_auprc_score: 0.9315; val_best_acc_score: 0.8632; val_best_f1_score: 0.8711; train_kl_reg_loss: 6196.6322; train_edge_recon_loss: 270716.3906; train_cond_contrastive_loss: 78742.5879; train_gene_expr_recon_loss: 96115.4863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451771.1016; train_optim_loss: 451771.1016; val_kl_reg_loss: 6146.8291; val_edge_recon_loss: 269379.7500; val_cond_contrastive_loss: 78441.2734; val_gene_expr_recon_loss: 96241.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450209.3125; val_optim_loss: 450209.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9452; val_auprc_score: 0.9370; val_best_acc_score: 0.8761; val_best_f1_score: 0.8831; train_kl_reg_loss: 6305.1688; train_edge_recon_loss: 269983.5234; train_cond_contrastive_loss: 78669.5059; train_gene_expr_recon_loss: 96405.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451363.5156; train_optim_loss: 451363.5156; val_kl_reg_loss: 6251.2646; val_edge_recon_loss: 267452.3438; val_cond_contrastive_loss: 78433.0234; val_gene_expr_recon_loss: 96056.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448192.7188; val_optim_loss: 448192.7188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9460; val_auprc_score: 0.9369; val_best_acc_score: 0.8790; val_best_f1_score: 0.8836; train_kl_reg_loss: 6384.3822; train_edge_recon_loss: 269635.0859; train_cond_contrastive_loss: 78645.8301; train_gene_expr_recon_loss: 95556.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450221.7266; train_optim_loss: 450221.7266; val_kl_reg_loss: 6239.5796; val_edge_recon_loss: 270196.8125; val_cond_contrastive_loss: 78425.0469; val_gene_expr_recon_loss: 95862.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450723.4688; val_optim_loss: 450723.4688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9513; val_auprc_score: 0.9415; val_best_acc_score: 0.8878; val_best_f1_score: 0.8907; train_kl_reg_loss: 6338.4166; train_edge_recon_loss: 268680.2891; train_cond_contrastive_loss: 78650.0605; train_gene_expr_recon_loss: 95917.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449586.1328; train_optim_loss: 449586.1328; val_kl_reg_loss: 6149.8594; val_edge_recon_loss: 268500.5938; val_cond_contrastive_loss: 78423.0469; val_gene_expr_recon_loss: 95667.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448741.1875; val_optim_loss: 448741.1875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9560; val_auprc_score: 0.9480; val_best_acc_score: 0.8982; val_best_f1_score: 0.8997; train_kl_reg_loss: 6200.3931; train_edge_recon_loss: 269223.5000; train_cond_contrastive_loss: 78674.2988; train_gene_expr_recon_loss: 95432.2539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449530.4453; train_optim_loss: 449530.4453; val_kl_reg_loss: 6017.5791; val_edge_recon_loss: 269142.5938; val_cond_contrastive_loss: 78422.3125; val_gene_expr_recon_loss: 95473.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449056.1562; val_optim_loss: 449056.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9544; val_auprc_score: 0.9454; val_best_acc_score: 0.8935; val_best_f1_score: 0.8932; train_kl_reg_loss: 6128.9164; train_edge_recon_loss: 268299.8203; train_cond_contrastive_loss: 78700.7969; train_gene_expr_recon_loss: 95331.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448460.8594; train_optim_loss: 448460.8594; val_kl_reg_loss: 5999.4927; val_edge_recon_loss: 272418.1250; val_cond_contrastive_loss: 78423.0625; val_gene_expr_recon_loss: 95446.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452287.3125; val_optim_loss: 452287.3125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9573; val_auprc_score: 0.9508; val_best_acc_score: 0.8953; val_best_f1_score: 0.8990; train_kl_reg_loss: 6108.0237; train_edge_recon_loss: 269605.7188; train_cond_contrastive_loss: 78701.3223; train_gene_expr_recon_loss: 95008.4824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449423.5391; train_optim_loss: 449423.5391; val_kl_reg_loss: 5962.8379; val_edge_recon_loss: 267477.5625; val_cond_contrastive_loss: 78424.7031; val_gene_expr_recon_loss: 95414.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447279.1875; val_optim_loss: 447279.1875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9563; val_auprc_score: 0.9460; val_best_acc_score: 0.8974; val_best_f1_score: 0.8991; train_kl_reg_loss: 6071.5707; train_edge_recon_loss: 268218.6094; train_cond_contrastive_loss: 78704.9609; train_gene_expr_recon_loss: 95258.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448253.4297; train_optim_loss: 448253.4297; val_kl_reg_loss: 5948.5210; val_edge_recon_loss: 268961.7188; val_cond_contrastive_loss: 78424.8125; val_gene_expr_recon_loss: 95382.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448717.7812; val_optim_loss: 448717.7812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9563; val_auprc_score: 0.9467; val_best_acc_score: 0.8950; val_best_f1_score: 0.8970; train_kl_reg_loss: 6081.5477; train_edge_recon_loss: 267925.3281; train_cond_contrastive_loss: 78706.2266; train_gene_expr_recon_loss: 95181.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447894.1250; train_optim_loss: 447894.1250; val_kl_reg_loss: 5942.4795; val_edge_recon_loss: 271674.9688; val_cond_contrastive_loss: 78426.1719; val_gene_expr_recon_loss: 95354.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451397.8750; val_optim_loss: 451397.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9583; val_auprc_score: 0.9481; val_best_acc_score: 0.9005; val_best_f1_score: 0.9028; train_kl_reg_loss: 6073.8323; train_edge_recon_loss: 267742.6484; train_cond_contrastive_loss: 78705.5430; train_gene_expr_recon_loss: 95339.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447861.9922; train_optim_loss: 447861.9922; val_kl_reg_loss: 5929.9033; val_edge_recon_loss: 267065.6562; val_cond_contrastive_loss: 78427.2500; val_gene_expr_recon_loss: 95330.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446753.1250; val_optim_loss: 446753.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9581; val_auprc_score: 0.9502; val_best_acc_score: 0.8983; val_best_f1_score: 0.8992; train_kl_reg_loss: 6060.7069; train_edge_recon_loss: 265410.3125; train_cond_contrastive_loss: 78709.2188; train_gene_expr_recon_loss: 95081.6738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445261.9219; train_optim_loss: 445261.9219; val_kl_reg_loss: 5923.0820; val_edge_recon_loss: 269453.6562; val_cond_contrastive_loss: 78427.2734; val_gene_expr_recon_loss: 95308.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449112.1875; val_optim_loss: 449112.1875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9594; val_auprc_score: 0.9530; val_best_acc_score: 0.9013; val_best_f1_score: 0.9049; train_kl_reg_loss: 6040.9027; train_edge_recon_loss: 267495.3125; train_cond_contrastive_loss: 78709.4355; train_gene_expr_recon_loss: 95057.8027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447303.4531; train_optim_loss: 447303.4531; val_kl_reg_loss: 5916.4541; val_edge_recon_loss: 266505.7812; val_cond_contrastive_loss: 78429.4922; val_gene_expr_recon_loss: 95284.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446136.5000; val_optim_loss: 446136.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9601; val_auprc_score: 0.9542; val_best_acc_score: 0.8997; val_best_f1_score: 0.9022; train_kl_reg_loss: 6040.2065; train_edge_recon_loss: 267716.5078; train_cond_contrastive_loss: 78710.0645; train_gene_expr_recon_loss: 95045.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447512.4922; train_optim_loss: 447512.4922; val_kl_reg_loss: 5898.8057; val_edge_recon_loss: 268533.2812; val_cond_contrastive_loss: 78428.9844; val_gene_expr_recon_loss: 95261.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448122.8125; val_optim_loss: 448122.8125
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9609; val_auprc_score: 0.9505; val_best_acc_score: 0.9045; val_best_f1_score: 0.9061; train_kl_reg_loss: 6021.7617; train_edge_recon_loss: 267475.2969; train_cond_contrastive_loss: 78708.6914; train_gene_expr_recon_loss: 94918.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447123.8594; train_optim_loss: 447123.8594; val_kl_reg_loss: 5891.3369; val_edge_recon_loss: 265768.4688; val_cond_contrastive_loss: 78430.5391; val_gene_expr_recon_loss: 95241.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445332.1875; val_optim_loss: 445332.1875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9637; val_auprc_score: 0.9590; val_best_acc_score: 0.9069; val_best_f1_score: 0.9087; train_kl_reg_loss: 6016.0098; train_edge_recon_loss: 267479.7656; train_cond_contrastive_loss: 78709.8633; train_gene_expr_recon_loss: 95577.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447783.3359; train_optim_loss: 447783.3359; val_kl_reg_loss: 5864.4434; val_edge_recon_loss: 264846.0312; val_cond_contrastive_loss: 78431.3281; val_gene_expr_recon_loss: 95223.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444364.9062; val_optim_loss: 444364.9062
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9597; val_auprc_score: 0.9502; val_best_acc_score: 0.9039; val_best_f1_score: 0.9065; train_kl_reg_loss: 5987.2767; train_edge_recon_loss: 268006.3438; train_cond_contrastive_loss: 78716.0586; train_gene_expr_recon_loss: 94746.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447455.7188; train_optim_loss: 447455.7188; val_kl_reg_loss: 5842.8350; val_edge_recon_loss: 269053.7812; val_cond_contrastive_loss: 78431.6484; val_gene_expr_recon_loss: 95204.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448532.5625; val_optim_loss: 448532.5625
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9622; val_auprc_score: 0.9553; val_best_acc_score: 0.9046; val_best_f1_score: 0.9071; train_kl_reg_loss: 5976.7827; train_edge_recon_loss: 267507.1406; train_cond_contrastive_loss: 78721.2324; train_gene_expr_recon_loss: 95619.5254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447824.6953; train_optim_loss: 447824.6953; val_kl_reg_loss: 5835.9307; val_edge_recon_loss: 267383.9375; val_cond_contrastive_loss: 78432.9688; val_gene_expr_recon_loss: 95184.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446837.1875; val_optim_loss: 446837.1875
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9617; val_auprc_score: 0.9524; val_best_acc_score: 0.9060; val_best_f1_score: 0.9079; train_kl_reg_loss: 5963.8219; train_edge_recon_loss: 266155.5312; train_cond_contrastive_loss: 78724.1133; train_gene_expr_recon_loss: 95597.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446441.1484; train_optim_loss: 446441.1484; val_kl_reg_loss: 5817.7295; val_edge_recon_loss: 268187.5938; val_cond_contrastive_loss: 78433.6328; val_gene_expr_recon_loss: 95164.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447603.8125; val_optim_loss: 447603.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9614; val_auprc_score: 0.9546; val_best_acc_score: 0.9025; val_best_f1_score: 0.9052; train_kl_reg_loss: 5928.4628; train_edge_recon_loss: 268077.9531; train_cond_contrastive_loss: 78725.3008; train_gene_expr_recon_loss: 94939.8223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447671.5469; train_optim_loss: 447671.5469; val_kl_reg_loss: 5810.8745; val_edge_recon_loss: 268840.1250; val_cond_contrastive_loss: 78433.6719; val_gene_expr_recon_loss: 95162.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448247.5938; val_optim_loss: 448247.5938
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9607; val_auprc_score: 0.9493; val_best_acc_score: 0.9041; val_best_f1_score: 0.9054; train_kl_reg_loss: 5934.0416; train_edge_recon_loss: 266707.3594; train_cond_contrastive_loss: 78723.1426; train_gene_expr_recon_loss: 95339.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446703.7188; train_optim_loss: 446703.7188; val_kl_reg_loss: 5811.8477; val_edge_recon_loss: 271383.3125; val_cond_contrastive_loss: 78432.7891; val_gene_expr_recon_loss: 95160.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450788.6250; val_optim_loss: 450788.6250
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9617; val_auprc_score: 0.9562; val_best_acc_score: 0.9019; val_best_f1_score: 0.9035; train_kl_reg_loss: 5950.2546; train_edge_recon_loss: 267298.9844; train_cond_contrastive_loss: 78723.6895; train_gene_expr_recon_loss: 95603.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447576.2500; train_optim_loss: 447576.2500; val_kl_reg_loss: 5811.8936; val_edge_recon_loss: 270557.5625; val_cond_contrastive_loss: 78434.0938; val_gene_expr_recon_loss: 95158.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449962.0938; val_optim_loss: 449962.0938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 13 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9578
Val AUPRC score: 0.9468
Val best accuracy score: 0.9010
Val best F1 score: 0.9043
Val gene expr MSE score: 1.5896
Duration of model training in run 3: 0 hours, 2 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7560; val_auprc_score: 0.8009; val_best_acc_score: 0.6884; val_best_f1_score: 0.6950; train_kl_reg_loss: 1982.4289; train_edge_recon_loss: 358177.1797; train_cond_contrastive_loss: 118473.7051; train_gene_expr_recon_loss: 128398.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 607031.6250; train_optim_loss: 607031.6250; val_kl_reg_loss: 4883.6978; val_edge_recon_loss: 401252.6250; val_cond_contrastive_loss: 78350.5078; val_gene_expr_recon_loss: 108994.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 593481.0625; val_optim_loss: 593481.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7134; val_auprc_score: 0.7502; val_best_acc_score: 0.6407; val_best_f1_score: 0.6921; train_kl_reg_loss: 10028.3562; train_edge_recon_loss: 362423.7266; train_cond_contrastive_loss: 85986.0352; train_gene_expr_recon_loss: 105951.4941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564389.6094; train_optim_loss: 564389.6094; val_kl_reg_loss: 7832.2710; val_edge_recon_loss: 398014.9688; val_cond_contrastive_loss: 78367.0234; val_gene_expr_recon_loss: 103039.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 587253.9375; val_optim_loss: 587253.9375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6932; val_auprc_score: 0.7236; val_best_acc_score: 0.6220; val_best_f1_score: 0.6899; train_kl_reg_loss: 6756.9578; train_edge_recon_loss: 354708.2109; train_cond_contrastive_loss: 90717.1484; train_gene_expr_recon_loss: 101541.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 553723.9219; train_optim_loss: 553723.9219; val_kl_reg_loss: 5712.0342; val_edge_recon_loss: 387011.7500; val_cond_contrastive_loss: 78422.4297; val_gene_expr_recon_loss: 101606.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572752.6875; val_optim_loss: 572752.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6884; val_auprc_score: 0.7214; val_best_acc_score: 0.6258; val_best_f1_score: 0.6898; train_kl_reg_loss: 5679.3099; train_edge_recon_loss: 351030.7109; train_cond_contrastive_loss: 87031.1172; train_gene_expr_recon_loss: 100973.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544715.0781; train_optim_loss: 544715.0781; val_kl_reg_loss: 3882.5854; val_edge_recon_loss: 362509.3125; val_cond_contrastive_loss: 78530.7656; val_gene_expr_recon_loss: 101058.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 545980.8125; val_optim_loss: 545980.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6860; val_auprc_score: 0.7254; val_best_acc_score: 0.6340; val_best_f1_score: 0.6922; train_kl_reg_loss: 3522.6588; train_edge_recon_loss: 340506.3672; train_cond_contrastive_loss: 89377.8301; train_gene_expr_recon_loss: 100599.9473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534006.8125; train_optim_loss: 534006.8125; val_kl_reg_loss: 3243.4856; val_edge_recon_loss: 341779.2500; val_cond_contrastive_loss: 78481.6406; val_gene_expr_recon_loss: 100760.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 524265.0938; val_optim_loss: 524265.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7039; val_auprc_score: 0.7355; val_best_acc_score: 0.6473; val_best_f1_score: 0.6881; train_kl_reg_loss: 3675.7571; train_edge_recon_loss: 325933.6953; train_cond_contrastive_loss: 83856.0684; train_gene_expr_recon_loss: 99674.4199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513139.9297; train_optim_loss: 513139.9297; val_kl_reg_loss: 4223.2168; val_edge_recon_loss: 335667.2812; val_cond_contrastive_loss: 78441.2500; val_gene_expr_recon_loss: 100220.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 518552.2500; val_optim_loss: 518552.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7403; val_auprc_score: 0.7545; val_best_acc_score: 0.6687; val_best_f1_score: 0.7032; train_kl_reg_loss: 4660.2391; train_edge_recon_loss: 319906.2578; train_cond_contrastive_loss: 79593.5137; train_gene_expr_recon_loss: 99124.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503284.3594; train_optim_loss: 503284.3594; val_kl_reg_loss: 4988.7056; val_edge_recon_loss: 320810.3438; val_cond_contrastive_loss: 78439.3750; val_gene_expr_recon_loss: 99693.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 503932.0625; val_optim_loss: 503932.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7857; val_auprc_score: 0.7880; val_best_acc_score: 0.7018; val_best_f1_score: 0.7432; train_kl_reg_loss: 5274.6661; train_edge_recon_loss: 308409.1797; train_cond_contrastive_loss: 79121.7832; train_gene_expr_recon_loss: 98952.6680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491758.2969; train_optim_loss: 491758.2969; val_kl_reg_loss: 5420.0039; val_edge_recon_loss: 301641.2500; val_cond_contrastive_loss: 78458.2422; val_gene_expr_recon_loss: 99296.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484815.6875; val_optim_loss: 484815.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8154; val_auprc_score: 0.7969; val_best_acc_score: 0.7355; val_best_f1_score: 0.7714; train_kl_reg_loss: 5703.3811; train_edge_recon_loss: 296394.7031; train_cond_contrastive_loss: 78941.1367; train_gene_expr_recon_loss: 98677.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479717.1484; train_optim_loss: 479717.1484; val_kl_reg_loss: 5731.9199; val_edge_recon_loss: 294529.8750; val_cond_contrastive_loss: 78463.8594; val_gene_expr_recon_loss: 98669.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477395.5000; val_optim_loss: 477395.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8442; val_auprc_score: 0.8245; val_best_acc_score: 0.7614; val_best_f1_score: 0.7895; train_kl_reg_loss: 5942.3668; train_edge_recon_loss: 288875.5000; train_cond_contrastive_loss: 78847.2715; train_gene_expr_recon_loss: 98118.2695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471783.3984; train_optim_loss: 471783.3984; val_kl_reg_loss: 5837.2676; val_edge_recon_loss: 288001.4375; val_cond_contrastive_loss: 78444.9922; val_gene_expr_recon_loss: 98211.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470495.0625; val_optim_loss: 470495.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8599; val_auprc_score: 0.8360; val_best_acc_score: 0.7850; val_best_f1_score: 0.8056; train_kl_reg_loss: 6020.7460; train_edge_recon_loss: 283951.7422; train_cond_contrastive_loss: 78910.5117; train_gene_expr_recon_loss: 97002.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465885.3828; train_optim_loss: 465885.3828; val_kl_reg_loss: 5923.2300; val_edge_recon_loss: 280946.7188; val_cond_contrastive_loss: 78431.6250; val_gene_expr_recon_loss: 97904.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463206.2812; val_optim_loss: 463206.2812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8644; val_auprc_score: 0.8308; val_best_acc_score: 0.7952; val_best_f1_score: 0.8176; train_kl_reg_loss: 6083.8030; train_edge_recon_loss: 281358.1797; train_cond_contrastive_loss: 78950.2168; train_gene_expr_recon_loss: 97600.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463993.1641; train_optim_loss: 463993.1641; val_kl_reg_loss: 5959.1831; val_edge_recon_loss: 281662.6875; val_cond_contrastive_loss: 78424.4531; val_gene_expr_recon_loss: 97571.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463617.5625; val_optim_loss: 463617.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8781; val_auprc_score: 0.8436; val_best_acc_score: 0.8177; val_best_f1_score: 0.8359; train_kl_reg_loss: 6139.6913; train_edge_recon_loss: 279639.9062; train_cond_contrastive_loss: 79025.3125; train_gene_expr_recon_loss: 96479.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461284.0781; train_optim_loss: 461284.0781; val_kl_reg_loss: 6076.9658; val_edge_recon_loss: 275406.4062; val_cond_contrastive_loss: 78426.7344; val_gene_expr_recon_loss: 97145.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457055.3750; val_optim_loss: 457055.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8935; val_auprc_score: 0.8699; val_best_acc_score: 0.8263; val_best_f1_score: 0.8439; train_kl_reg_loss: 6306.4070; train_edge_recon_loss: 276217.8438; train_cond_contrastive_loss: 78961.7578; train_gene_expr_recon_loss: 96256.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457742.5000; train_optim_loss: 457742.5000; val_kl_reg_loss: 6307.5518; val_edge_recon_loss: 273289.3125; val_cond_contrastive_loss: 78428.2656; val_gene_expr_recon_loss: 96803.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454828.7500; val_optim_loss: 454828.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9020; val_auprc_score: 0.8791; val_best_acc_score: 0.8295; val_best_f1_score: 0.8443; train_kl_reg_loss: 6443.8782; train_edge_recon_loss: 275288.3750; train_cond_contrastive_loss: 78812.6348; train_gene_expr_recon_loss: 96670.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457215.7344; train_optim_loss: 457215.7344; val_kl_reg_loss: 6145.5444; val_edge_recon_loss: 275679.5938; val_cond_contrastive_loss: 78426.1250; val_gene_expr_recon_loss: 96436.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456688.0625; val_optim_loss: 456688.0625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9114; val_auprc_score: 0.8922; val_best_acc_score: 0.8376; val_best_f1_score: 0.8498; train_kl_reg_loss: 6202.1183; train_edge_recon_loss: 272600.1406; train_cond_contrastive_loss: 78840.0000; train_gene_expr_recon_loss: 96010.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453652.9922; train_optim_loss: 453652.9922; val_kl_reg_loss: 5979.0103; val_edge_recon_loss: 274447.0938; val_cond_contrastive_loss: 78427.9219; val_gene_expr_recon_loss: 96166.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455020.0938; val_optim_loss: 455020.0938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9241; val_auprc_score: 0.9127; val_best_acc_score: 0.8504; val_best_f1_score: 0.8608; train_kl_reg_loss: 6140.1196; train_edge_recon_loss: 272784.2188; train_cond_contrastive_loss: 78754.3145; train_gene_expr_recon_loss: 95164.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452843.5859; train_optim_loss: 452843.5859; val_kl_reg_loss: 6074.0835; val_edge_recon_loss: 268834.7188; val_cond_contrastive_loss: 78428.8984; val_gene_expr_recon_loss: 95926.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449264.4688; val_optim_loss: 449264.4688
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9238; val_auprc_score: 0.9111; val_best_acc_score: 0.8482; val_best_f1_score: 0.8552; train_kl_reg_loss: 6233.9773; train_edge_recon_loss: 270917.5312; train_cond_contrastive_loss: 78683.8320; train_gene_expr_recon_loss: 95301.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451136.4609; train_optim_loss: 451136.4609; val_kl_reg_loss: 6060.7012; val_edge_recon_loss: 274582.7500; val_cond_contrastive_loss: 78425.8516; val_gene_expr_recon_loss: 95675.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454745.1875; val_optim_loss: 454745.1875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9397; val_auprc_score: 0.9345; val_best_acc_score: 0.8634; val_best_f1_score: 0.8675; train_kl_reg_loss: 6189.6661; train_edge_recon_loss: 270729.7578; train_cond_contrastive_loss: 78680.7129; train_gene_expr_recon_loss: 95177.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450777.2734; train_optim_loss: 450777.2734; val_kl_reg_loss: 6182.9893; val_edge_recon_loss: 268916.3750; val_cond_contrastive_loss: 78420.9609; val_gene_expr_recon_loss: 95461.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448981.5625; val_optim_loss: 448981.5625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9393; val_auprc_score: 0.9276; val_best_acc_score: 0.8677; val_best_f1_score: 0.8729; train_kl_reg_loss: 6374.3546; train_edge_recon_loss: 270359.5938; train_cond_contrastive_loss: 78634.2363; train_gene_expr_recon_loss: 94632.7129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450000.8906; train_optim_loss: 450000.8906; val_kl_reg_loss: 6289.8135; val_edge_recon_loss: 272117.8125; val_cond_contrastive_loss: 78418.1953; val_gene_expr_recon_loss: 95263.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452089.5000; val_optim_loss: 452089.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9438; val_auprc_score: 0.9341; val_best_acc_score: 0.8728; val_best_f1_score: 0.8766; train_kl_reg_loss: 6344.8733; train_edge_recon_loss: 270722.4141; train_cond_contrastive_loss: 78645.0508; train_gene_expr_recon_loss: 94444.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450156.6172; train_optim_loss: 450156.6172; val_kl_reg_loss: 6155.4331; val_edge_recon_loss: 271196.3750; val_cond_contrastive_loss: 78421.5625; val_gene_expr_recon_loss: 95087.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450861.1250; val_optim_loss: 450861.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9505; val_auprc_score: 0.9443; val_best_acc_score: 0.8797; val_best_f1_score: 0.8839; train_kl_reg_loss: 6239.5835; train_edge_recon_loss: 268488.0391; train_cond_contrastive_loss: 78675.5879; train_gene_expr_recon_loss: 94040.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447443.6875; train_optim_loss: 447443.6875; val_kl_reg_loss: 6105.4131; val_edge_recon_loss: 269344.6562; val_cond_contrastive_loss: 78422.2266; val_gene_expr_recon_loss: 94909.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448781.7500; val_optim_loss: 448781.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9545; val_auprc_score: 0.9503; val_best_acc_score: 0.8888; val_best_f1_score: 0.8929; train_kl_reg_loss: 6164.6776; train_edge_recon_loss: 267906.7422; train_cond_contrastive_loss: 78690.1875; train_gene_expr_recon_loss: 94389.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447151.3047; train_optim_loss: 447151.3047; val_kl_reg_loss: 6011.4209; val_edge_recon_loss: 266685.5312; val_cond_contrastive_loss: 78426.8906; val_gene_expr_recon_loss: 94754.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445878.2188; val_optim_loss: 445878.2188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9593; val_auprc_score: 0.9521; val_best_acc_score: 0.8993; val_best_f1_score: 0.9013; train_kl_reg_loss: 6060.9010; train_edge_recon_loss: 268451.8359; train_cond_contrastive_loss: 78710.5977; train_gene_expr_recon_loss: 94701.8926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447925.2344; train_optim_loss: 447925.2344; val_kl_reg_loss: 5889.8535; val_edge_recon_loss: 270138.2188; val_cond_contrastive_loss: 78430.2969; val_gene_expr_recon_loss: 94578.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449036.8438; val_optim_loss: 449036.8438
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9643; val_auprc_score: 0.9597; val_best_acc_score: 0.9070; val_best_f1_score: 0.9105; train_kl_reg_loss: 5956.5814; train_edge_recon_loss: 267980.1484; train_cond_contrastive_loss: 78733.3906; train_gene_expr_recon_loss: 93340.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446010.8281; train_optim_loss: 446010.8281; val_kl_reg_loss: 5818.8779; val_edge_recon_loss: 264259.2500; val_cond_contrastive_loss: 78437.9922; val_gene_expr_recon_loss: 94402.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442919.0000; val_optim_loss: 442919.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9667; val_auprc_score: 0.9599; val_best_acc_score: 0.9125; val_best_f1_score: 0.9140; train_kl_reg_loss: 5848.1373; train_edge_recon_loss: 267215.2422; train_cond_contrastive_loss: 78758.2891; train_gene_expr_recon_loss: 93759.7402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445581.4062; train_optim_loss: 445581.4062; val_kl_reg_loss: 5726.8379; val_edge_recon_loss: 269497.4375; val_cond_contrastive_loss: 78443.4062; val_gene_expr_recon_loss: 94261.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447929.3125; val_optim_loss: 447929.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9721; val_auprc_score: 0.9648; val_best_acc_score: 0.9176; val_best_f1_score: 0.9204; train_kl_reg_loss: 5818.0676; train_edge_recon_loss: 266275.6875; train_cond_contrastive_loss: 78761.0137; train_gene_expr_recon_loss: 93373.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444227.8047; train_optim_loss: 444227.8047; val_kl_reg_loss: 5715.4014; val_edge_recon_loss: 265115.6250; val_cond_contrastive_loss: 78449.3672; val_gene_expr_recon_loss: 94128.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443409.3125; val_optim_loss: 443409.3125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9751; val_auprc_score: 0.9719; val_best_acc_score: 0.9265; val_best_f1_score: 0.9285; train_kl_reg_loss: 5823.6061; train_edge_recon_loss: 263538.6016; train_cond_contrastive_loss: 78761.1875; train_gene_expr_recon_loss: 92941.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441065.1953; train_optim_loss: 441065.1953; val_kl_reg_loss: 5730.0020; val_edge_recon_loss: 267175.3750; val_cond_contrastive_loss: 78448.7422; val_gene_expr_recon_loss: 94039.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445393.1562; val_optim_loss: 445393.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9737; val_auprc_score: 0.9664; val_best_acc_score: 0.9247; val_best_f1_score: 0.9269; train_kl_reg_loss: 5842.7623; train_edge_recon_loss: 264268.0547; train_cond_contrastive_loss: 78781.8086; train_gene_expr_recon_loss: 93678.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442571.5859; train_optim_loss: 442571.5859; val_kl_reg_loss: 5748.8779; val_edge_recon_loss: 265014.0625; val_cond_contrastive_loss: 78450.2578; val_gene_expr_recon_loss: 94004.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443217.2188; val_optim_loss: 443217.2188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9757; val_auprc_score: 0.9722; val_best_acc_score: 0.9237; val_best_f1_score: 0.9259; train_kl_reg_loss: 5842.9954; train_edge_recon_loss: 263642.2695; train_cond_contrastive_loss: 78749.3203; train_gene_expr_recon_loss: 92979.9082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441214.4922; train_optim_loss: 441214.4922; val_kl_reg_loss: 5756.8311; val_edge_recon_loss: 263649.1875; val_cond_contrastive_loss: 78449.9922; val_gene_expr_recon_loss: 93978.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441834.0625; val_optim_loss: 441834.0625
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9754; val_auprc_score: 0.9685; val_best_acc_score: 0.9270; val_best_f1_score: 0.9292; train_kl_reg_loss: 5844.0956; train_edge_recon_loss: 265384.5312; train_cond_contrastive_loss: 78742.5000; train_gene_expr_recon_loss: 93035.8809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443006.9922; train_optim_loss: 443006.9922; val_kl_reg_loss: 5726.2329; val_edge_recon_loss: 262598.0938; val_cond_contrastive_loss: 78449.5391; val_gene_expr_recon_loss: 93944.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440718.7812; val_optim_loss: 440718.7812
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9755; val_auprc_score: 0.9711; val_best_acc_score: 0.9274; val_best_f1_score: 0.9294; train_kl_reg_loss: 5808.5643; train_edge_recon_loss: 264957.9297; train_cond_contrastive_loss: 78769.9570; train_gene_expr_recon_loss: 92746.7402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442283.2109; train_optim_loss: 442283.2109; val_kl_reg_loss: 5710.1675; val_edge_recon_loss: 263884.9375; val_cond_contrastive_loss: 78449.2656; val_gene_expr_recon_loss: 93921.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441965.8125; val_optim_loss: 441965.8125
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9745; val_auprc_score: 0.9667; val_best_acc_score: 0.9269; val_best_f1_score: 0.9284; train_kl_reg_loss: 5818.0566; train_edge_recon_loss: 264393.5156; train_cond_contrastive_loss: 78785.8066; train_gene_expr_recon_loss: 93255.0742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442252.4531; train_optim_loss: 442252.4531; val_kl_reg_loss: 5698.6611; val_edge_recon_loss: 266415.7188; val_cond_contrastive_loss: 78447.7188; val_gene_expr_recon_loss: 93899.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444461.8438; val_optim_loss: 444461.8438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9732; val_auprc_score: 0.9653; val_best_acc_score: 0.9232; val_best_f1_score: 0.9259; train_kl_reg_loss: 5794.2169; train_edge_recon_loss: 264521.9453; train_cond_contrastive_loss: 78777.3320; train_gene_expr_recon_loss: 93368.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442461.5625; train_optim_loss: 442461.5625; val_kl_reg_loss: 5699.1597; val_edge_recon_loss: 262875.9688; val_cond_contrastive_loss: 78448.5312; val_gene_expr_recon_loss: 93881.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440905.1250; val_optim_loss: 440905.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9762; val_auprc_score: 0.9723; val_best_acc_score: 0.9289; val_best_f1_score: 0.9300; train_kl_reg_loss: 5799.6532; train_edge_recon_loss: 263928.9102; train_cond_contrastive_loss: 78765.7520; train_gene_expr_recon_loss: 93228.9824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441723.3125; train_optim_loss: 441723.3125; val_kl_reg_loss: 5690.3662; val_edge_recon_loss: 265097.3125; val_cond_contrastive_loss: 78447.8281; val_gene_expr_recon_loss: 93879.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443114.8438; val_optim_loss: 443114.8438
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9750; val_auprc_score: 0.9703; val_best_acc_score: 0.9280; val_best_f1_score: 0.9293; train_kl_reg_loss: 5780.5730; train_edge_recon_loss: 264198.6797; train_cond_contrastive_loss: 78769.7676; train_gene_expr_recon_loss: 93449.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442198.6484; train_optim_loss: 442198.6484; val_kl_reg_loss: 5693.7695; val_edge_recon_loss: 267958.8750; val_cond_contrastive_loss: 78447.7031; val_gene_expr_recon_loss: 93876.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445977.0625; val_optim_loss: 445977.0625
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9763; val_auprc_score: 0.9715; val_best_acc_score: 0.9261; val_best_f1_score: 0.9279; train_kl_reg_loss: 5778.9280; train_edge_recon_loss: 263598.5039; train_cond_contrastive_loss: 78770.2344; train_gene_expr_recon_loss: 92778.6543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440926.3359; train_optim_loss: 440926.3359; val_kl_reg_loss: 5699.7852; val_edge_recon_loss: 264157.5625; val_cond_contrastive_loss: 78447.0859; val_gene_expr_recon_loss: 93873.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442178.4375; val_optim_loss: 442178.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 2 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9770
Val AUPRC score: 0.9697
Val best accuracy score: 0.9290
Val best F1 score: 0.9301
Val gene expr MSE score: 1.6292
Duration of model training in run 4: 0 hours, 2 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7905; val_auprc_score: 0.8274; val_best_acc_score: 0.7119; val_best_f1_score: 0.7123; train_kl_reg_loss: 3527.8862; train_edge_recon_loss: 358499.9323; train_cond_contrastive_loss: 109404.6706; train_gene_expr_recon_loss: 123840.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 595273.3958; train_optim_loss: 595273.3958; val_kl_reg_loss: 11115.0176; val_edge_recon_loss: 397340.3750; val_cond_contrastive_loss: 78340.0234; val_gene_expr_recon_loss: 103652.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 590447.6250; val_optim_loss: 590447.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7305; val_auprc_score: 0.7643; val_best_acc_score: 0.6464; val_best_f1_score: 0.7071; train_kl_reg_loss: 9144.9105; train_edge_recon_loss: 357236.8073; train_cond_contrastive_loss: 88731.5781; train_gene_expr_recon_loss: 102654.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557767.8958; train_optim_loss: 557767.8958; val_kl_reg_loss: 5364.0928; val_edge_recon_loss: 384992.3125; val_cond_contrastive_loss: 78368.5781; val_gene_expr_recon_loss: 99954.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568679.8750; val_optim_loss: 568679.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7259; val_auprc_score: 0.7542; val_best_acc_score: 0.6490; val_best_f1_score: 0.7052; train_kl_reg_loss: 4936.5148; train_edge_recon_loss: 351796.4896; train_cond_contrastive_loss: 86535.3164; train_gene_expr_recon_loss: 99778.1654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543046.4896; train_optim_loss: 543046.4896; val_kl_reg_loss: 3496.1694; val_edge_recon_loss: 349487.8438; val_cond_contrastive_loss: 78422.3906; val_gene_expr_recon_loss: 98976.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 530382.6875; val_optim_loss: 530382.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7384; val_auprc_score: 0.7596; val_best_acc_score: 0.6686; val_best_f1_score: 0.7068; train_kl_reg_loss: 3479.5462; train_edge_recon_loss: 330133.2344; train_cond_contrastive_loss: 86640.9909; train_gene_expr_recon_loss: 99027.9401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 519281.7135; train_optim_loss: 519281.7135; val_kl_reg_loss: 3931.1577; val_edge_recon_loss: 323966.2188; val_cond_contrastive_loss: 78377.7578; val_gene_expr_recon_loss: 98468.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 504743.8438; val_optim_loss: 504743.8438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7866; val_auprc_score: 0.7890; val_best_acc_score: 0.7043; val_best_f1_score: 0.7329; train_kl_reg_loss: 4650.5292; train_edge_recon_loss: 312190.2604; train_cond_contrastive_loss: 79551.1172; train_gene_expr_recon_loss: 98253.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494645.4844; train_optim_loss: 494645.4844; val_kl_reg_loss: 5428.9653; val_edge_recon_loss: 305819.0312; val_cond_contrastive_loss: 78379.2500; val_gene_expr_recon_loss: 97653.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487280.4062; val_optim_loss: 487280.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8302; val_auprc_score: 0.8174; val_best_acc_score: 0.7461; val_best_f1_score: 0.7810; train_kl_reg_loss: 5984.4008; train_edge_recon_loss: 295490.2865; train_cond_contrastive_loss: 78765.3359; train_gene_expr_recon_loss: 97483.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477723.2240; train_optim_loss: 477723.2240; val_kl_reg_loss: 6398.2939; val_edge_recon_loss: 287713.3125; val_cond_contrastive_loss: 78387.2344; val_gene_expr_recon_loss: 97033.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469531.9688; val_optim_loss: 469531.9688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8451; val_auprc_score: 0.8256; val_best_acc_score: 0.7655; val_best_f1_score: 0.7966; train_kl_reg_loss: 6508.9865; train_edge_recon_loss: 285274.8229; train_cond_contrastive_loss: 78730.3750; train_gene_expr_recon_loss: 96894.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467408.7604; train_optim_loss: 467408.7604; val_kl_reg_loss: 6244.4492; val_edge_recon_loss: 281541.9688; val_cond_contrastive_loss: 78381.8125; val_gene_expr_recon_loss: 96427.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462595.7500; val_optim_loss: 462595.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8544; val_auprc_score: 0.8293; val_best_acc_score: 0.7828; val_best_f1_score: 0.8132; train_kl_reg_loss: 6214.2594; train_edge_recon_loss: 282052.3854; train_cond_contrastive_loss: 79016.7083; train_gene_expr_recon_loss: 96472.4076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463755.7708; train_optim_loss: 463755.7708; val_kl_reg_loss: 6052.5947; val_edge_recon_loss: 275741.1250; val_cond_contrastive_loss: 78382.2969; val_gene_expr_recon_loss: 95935.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456111.7500; val_optim_loss: 456111.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8781; val_auprc_score: 0.8508; val_best_acc_score: 0.8098; val_best_f1_score: 0.8295; train_kl_reg_loss: 6339.8374; train_edge_recon_loss: 278789.2812; train_cond_contrastive_loss: 79066.0260; train_gene_expr_recon_loss: 95956.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460151.1667; train_optim_loss: 460151.1667; val_kl_reg_loss: 6454.8164; val_edge_recon_loss: 275371.4062; val_cond_contrastive_loss: 78386.9766; val_gene_expr_recon_loss: 95542.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455756.1250; val_optim_loss: 455756.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8903; val_auprc_score: 0.8606; val_best_acc_score: 0.8286; val_best_f1_score: 0.8486; train_kl_reg_loss: 6561.6605; train_edge_recon_loss: 275283.9896; train_cond_contrastive_loss: 78949.8555; train_gene_expr_recon_loss: 95577.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456373.2500; train_optim_loss: 456373.2500; val_kl_reg_loss: 6259.4375; val_edge_recon_loss: 269755.9375; val_cond_contrastive_loss: 78405.3750; val_gene_expr_recon_loss: 95200.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449621.3438; val_optim_loss: 449621.3438
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9093; val_auprc_score: 0.8905; val_best_acc_score: 0.8423; val_best_f1_score: 0.8569; train_kl_reg_loss: 6287.9405; train_edge_recon_loss: 272978.7656; train_cond_contrastive_loss: 79007.6263; train_gene_expr_recon_loss: 95244.4349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453518.7656; train_optim_loss: 453518.7656; val_kl_reg_loss: 6099.9194; val_edge_recon_loss: 271864.6875; val_cond_contrastive_loss: 78423.7969; val_gene_expr_recon_loss: 94894.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451282.8750; val_optim_loss: 451282.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9286; val_auprc_score: 0.9146; val_best_acc_score: 0.8607; val_best_f1_score: 0.8690; train_kl_reg_loss: 6077.3110; train_edge_recon_loss: 272105.1458; train_cond_contrastive_loss: 78904.6081; train_gene_expr_recon_loss: 94788.7904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451875.8594; train_optim_loss: 451875.8594; val_kl_reg_loss: 5881.4297; val_edge_recon_loss: 268052.0000; val_cond_contrastive_loss: 78427.4375; val_gene_expr_recon_loss: 94545.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446906.6250; val_optim_loss: 446906.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9414; val_auprc_score: 0.9291; val_best_acc_score: 0.8722; val_best_f1_score: 0.8782; train_kl_reg_loss: 6058.7060; train_edge_recon_loss: 270304.7188; train_cond_contrastive_loss: 78793.7174; train_gene_expr_recon_loss: 94503.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449660.3438; train_optim_loss: 449660.3438; val_kl_reg_loss: 6114.7178; val_edge_recon_loss: 271029.7188; val_cond_contrastive_loss: 78419.2656; val_gene_expr_recon_loss: 94271.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449835.1875; val_optim_loss: 449835.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9505; val_auprc_score: 0.9396; val_best_acc_score: 0.8877; val_best_f1_score: 0.8928; train_kl_reg_loss: 6275.0990; train_edge_recon_loss: 271179.3594; train_cond_contrastive_loss: 78689.0781; train_gene_expr_recon_loss: 94110.5794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450254.1094; train_optim_loss: 450254.1094; val_kl_reg_loss: 6213.9971; val_edge_recon_loss: 268148.4688; val_cond_contrastive_loss: 78411.8438; val_gene_expr_recon_loss: 93964.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446739.2188; val_optim_loss: 446739.2188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9557; val_auprc_score: 0.9468; val_best_acc_score: 0.8943; val_best_f1_score: 0.9000; train_kl_reg_loss: 6329.2395; train_edge_recon_loss: 268851.9010; train_cond_contrastive_loss: 78661.2161; train_gene_expr_recon_loss: 93907.7643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447750.1198; train_optim_loss: 447750.1198; val_kl_reg_loss: 6214.7061; val_edge_recon_loss: 266217.7812; val_cond_contrastive_loss: 78407.2109; val_gene_expr_recon_loss: 93682.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444522.2188; val_optim_loss: 444522.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9608; val_auprc_score: 0.9537; val_best_acc_score: 0.9024; val_best_f1_score: 0.9064; train_kl_reg_loss: 6215.7102; train_edge_recon_loss: 267757.6823; train_cond_contrastive_loss: 78691.4427; train_gene_expr_recon_loss: 93519.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446184.6406; train_optim_loss: 446184.6406; val_kl_reg_loss: 6061.3335; val_edge_recon_loss: 266478.3750; val_cond_contrastive_loss: 78408.6641; val_gene_expr_recon_loss: 93389.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444337.8750; val_optim_loss: 444337.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9702; val_auprc_score: 0.9649; val_best_acc_score: 0.9175; val_best_f1_score: 0.9199; train_kl_reg_loss: 6034.9875; train_edge_recon_loss: 267979.9479; train_cond_contrastive_loss: 78728.0690; train_gene_expr_recon_loss: 93348.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446091.1094; train_optim_loss: 446091.1094; val_kl_reg_loss: 5905.1211; val_edge_recon_loss: 264897.4375; val_cond_contrastive_loss: 78411.2188; val_gene_expr_recon_loss: 93099.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442313.7188; val_optim_loss: 442313.7188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9749; val_auprc_score: 0.9696; val_best_acc_score: 0.9267; val_best_f1_score: 0.9286; train_kl_reg_loss: 5936.1541; train_edge_recon_loss: 264982.7995; train_cond_contrastive_loss: 78732.6302; train_gene_expr_recon_loss: 92964.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442616.5260; train_optim_loss: 442616.5260; val_kl_reg_loss: 5818.7939; val_edge_recon_loss: 264098.4688; val_cond_contrastive_loss: 78415.1016; val_gene_expr_recon_loss: 92829.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441161.7188; val_optim_loss: 441161.7188
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9772; val_auprc_score: 0.9719; val_best_acc_score: 0.9324; val_best_f1_score: 0.9343; train_kl_reg_loss: 5901.1071; train_edge_recon_loss: 262962.9870; train_cond_contrastive_loss: 78725.0495; train_gene_expr_recon_loss: 92790.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440379.4844; train_optim_loss: 440379.4844; val_kl_reg_loss: 5800.5498; val_edge_recon_loss: 262428.5312; val_cond_contrastive_loss: 78413.7578; val_gene_expr_recon_loss: 92583.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439226.8125; val_optim_loss: 439226.8125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9799; val_auprc_score: 0.9757; val_best_acc_score: 0.9367; val_best_f1_score: 0.9387; train_kl_reg_loss: 5848.1780; train_edge_recon_loss: 263782.4870; train_cond_contrastive_loss: 78709.0677; train_gene_expr_recon_loss: 92370.5104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440710.2448; train_optim_loss: 440710.2448; val_kl_reg_loss: 5754.8027; val_edge_recon_loss: 263119.7812; val_cond_contrastive_loss: 78408.5547; val_gene_expr_recon_loss: 92394.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439677.5938; val_optim_loss: 439677.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9823; val_auprc_score: 0.9778; val_best_acc_score: 0.9417; val_best_f1_score: 0.9436; train_kl_reg_loss: 5852.7049; train_edge_recon_loss: 264365.4583; train_cond_contrastive_loss: 78707.2526; train_gene_expr_recon_loss: 92355.4635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441280.8854; train_optim_loss: 441280.8854; val_kl_reg_loss: 5799.4209; val_edge_recon_loss: 261663.4688; val_cond_contrastive_loss: 78404.7891; val_gene_expr_recon_loss: 92174.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438042.1250; val_optim_loss: 438042.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9824; val_auprc_score: 0.9784; val_best_acc_score: 0.9421; val_best_f1_score: 0.9441; train_kl_reg_loss: 5856.1291; train_edge_recon_loss: 263604.7474; train_cond_contrastive_loss: 78720.7630; train_gene_expr_recon_loss: 91819.0560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440000.6927; train_optim_loss: 440000.6927; val_kl_reg_loss: 5778.3960; val_edge_recon_loss: 260766.1719; val_cond_contrastive_loss: 78405.4453; val_gene_expr_recon_loss: 91950.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436900.8125; val_optim_loss: 436900.8125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9842; val_auprc_score: 0.9794; val_best_acc_score: 0.9454; val_best_f1_score: 0.9469; train_kl_reg_loss: 5894.4113; train_edge_recon_loss: 263671.3594; train_cond_contrastive_loss: 78711.8867; train_gene_expr_recon_loss: 91682.7318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439960.3958; train_optim_loss: 439960.3958; val_kl_reg_loss: 5790.4868; val_edge_recon_loss: 259617.3281; val_cond_contrastive_loss: 78407.6328; val_gene_expr_recon_loss: 91737.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435553.2188; val_optim_loss: 435553.2188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9852; val_auprc_score: 0.9814; val_best_acc_score: 0.9492; val_best_f1_score: 0.9507; train_kl_reg_loss: 5826.8342; train_edge_recon_loss: 262794.9115; train_cond_contrastive_loss: 78751.7982; train_gene_expr_recon_loss: 91591.7747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438965.3333; train_optim_loss: 438965.3333; val_kl_reg_loss: 5767.1738; val_edge_recon_loss: 259798.2812; val_cond_contrastive_loss: 78413.4297; val_gene_expr_recon_loss: 91506.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435485.0312; val_optim_loss: 435485.0312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9862; val_auprc_score: 0.9792; val_best_acc_score: 0.9512; val_best_f1_score: 0.9525; train_kl_reg_loss: 5868.9078; train_edge_recon_loss: 261426.0911; train_cond_contrastive_loss: 78767.0964; train_gene_expr_recon_loss: 91387.7643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437449.8542; train_optim_loss: 437449.8542; val_kl_reg_loss: 5792.2627; val_edge_recon_loss: 259888.1094; val_cond_contrastive_loss: 78420.7812; val_gene_expr_recon_loss: 91298.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435399.5312; val_optim_loss: 435399.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9858; val_auprc_score: 0.9787; val_best_acc_score: 0.9525; val_best_f1_score: 0.9536; train_kl_reg_loss: 5868.5809; train_edge_recon_loss: 260381.4505; train_cond_contrastive_loss: 78777.3464; train_gene_expr_recon_loss: 91165.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436192.9531; train_optim_loss: 436192.9531; val_kl_reg_loss: 5793.9702; val_edge_recon_loss: 261274.5156; val_cond_contrastive_loss: 78425.2891; val_gene_expr_recon_loss: 91077.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436571.3750; val_optim_loss: 436571.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9874; val_auprc_score: 0.9845; val_best_acc_score: 0.9548; val_best_f1_score: 0.9568; train_kl_reg_loss: 5866.4259; train_edge_recon_loss: 260877.1667; train_cond_contrastive_loss: 78793.9271; train_gene_expr_recon_loss: 90784.1810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436321.7083; train_optim_loss: 436321.7083; val_kl_reg_loss: 5799.3184; val_edge_recon_loss: 256908.2344; val_cond_contrastive_loss: 78424.9766; val_gene_expr_recon_loss: 90850.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431982.8750; val_optim_loss: 431982.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9882; val_auprc_score: 0.9839; val_best_acc_score: 0.9557; val_best_f1_score: 0.9572; train_kl_reg_loss: 5888.6192; train_edge_recon_loss: 260217.5938; train_cond_contrastive_loss: 78792.8529; train_gene_expr_recon_loss: 90655.6029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435554.6615; train_optim_loss: 435554.6615; val_kl_reg_loss: 5828.2080; val_edge_recon_loss: 259191.4844; val_cond_contrastive_loss: 78421.7266; val_gene_expr_recon_loss: 90624.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434065.6250; val_optim_loss: 434065.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9890; val_auprc_score: 0.9840; val_best_acc_score: 0.9550; val_best_f1_score: 0.9556; train_kl_reg_loss: 5885.7414; train_edge_recon_loss: 259089.8203; train_cond_contrastive_loss: 78783.6810; train_gene_expr_recon_loss: 90502.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434261.9375; train_optim_loss: 434261.9375; val_kl_reg_loss: 5816.3516; val_edge_recon_loss: 260066.6250; val_cond_contrastive_loss: 78418.9531; val_gene_expr_recon_loss: 90434.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434736.2812; val_optim_loss: 434736.2812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9868; val_auprc_score: 0.9818; val_best_acc_score: 0.9552; val_best_f1_score: 0.9561; train_kl_reg_loss: 5872.9318; train_edge_recon_loss: 260319.1953; train_cond_contrastive_loss: 78774.2331; train_gene_expr_recon_loss: 90304.0104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435270.3698; train_optim_loss: 435270.3698; val_kl_reg_loss: 5814.3311; val_edge_recon_loss: 260786.4219; val_cond_contrastive_loss: 78419.6484; val_gene_expr_recon_loss: 90238.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435259.1562; val_optim_loss: 435259.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9889; val_auprc_score: 0.9866; val_best_acc_score: 0.9585; val_best_f1_score: 0.9594; train_kl_reg_loss: 5880.3385; train_edge_recon_loss: 258544.1302; train_cond_contrastive_loss: 78769.7682; train_gene_expr_recon_loss: 90186.1966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433380.4323; train_optim_loss: 433380.4323; val_kl_reg_loss: 5818.6348; val_edge_recon_loss: 255600.0625; val_cond_contrastive_loss: 78420.0156; val_gene_expr_recon_loss: 90214.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430053.1250; val_optim_loss: 430053.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9895; val_auprc_score: 0.9875; val_best_acc_score: 0.9580; val_best_f1_score: 0.9593; train_kl_reg_loss: 5876.9593; train_edge_recon_loss: 260432.0078; train_cond_contrastive_loss: 78766.1510; train_gene_expr_recon_loss: 90051.9557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435127.0781; train_optim_loss: 435127.0781; val_kl_reg_loss: 5798.9385; val_edge_recon_loss: 257058.0000; val_cond_contrastive_loss: 78419.9766; val_gene_expr_recon_loss: 90192.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431469.6875; val_optim_loss: 431469.6875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9893; val_auprc_score: 0.9845; val_best_acc_score: 0.9598; val_best_f1_score: 0.9605; train_kl_reg_loss: 5854.7252; train_edge_recon_loss: 260994.3516; train_cond_contrastive_loss: 78770.9805; train_gene_expr_recon_loss: 89947.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435567.6354; train_optim_loss: 435567.6354; val_kl_reg_loss: 5790.9258; val_edge_recon_loss: 256650.0312; val_cond_contrastive_loss: 78419.5312; val_gene_expr_recon_loss: 90165.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431025.8438; val_optim_loss: 431025.8438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9895; val_auprc_score: 0.9841; val_best_acc_score: 0.9606; val_best_f1_score: 0.9620; train_kl_reg_loss: 5861.9627; train_edge_recon_loss: 259885.2500; train_cond_contrastive_loss: 78768.4128; train_gene_expr_recon_loss: 90144.9388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434660.5625; train_optim_loss: 434660.5625; val_kl_reg_loss: 5795.0879; val_edge_recon_loss: 252339.6562; val_cond_contrastive_loss: 78421.0078; val_gene_expr_recon_loss: 90144.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426700.2500; val_optim_loss: 426700.2500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9900; val_auprc_score: 0.9851; val_best_acc_score: 0.9600; val_best_f1_score: 0.9603; train_kl_reg_loss: 5851.7653; train_edge_recon_loss: 258869.6198; train_cond_contrastive_loss: 78776.6628; train_gene_expr_recon_loss: 90228.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433727.0260; train_optim_loss: 433727.0260; val_kl_reg_loss: 5788.8613; val_edge_recon_loss: 259339.2188; val_cond_contrastive_loss: 78419.6797; val_gene_expr_recon_loss: 90126.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433674.5000; val_optim_loss: 433674.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9900; val_auprc_score: 0.9854; val_best_acc_score: 0.9595; val_best_f1_score: 0.9602; train_kl_reg_loss: 5859.2368; train_edge_recon_loss: 259864.0078; train_cond_contrastive_loss: 78766.3047; train_gene_expr_recon_loss: 90125.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434614.8229; train_optim_loss: 434614.8229; val_kl_reg_loss: 5803.2051; val_edge_recon_loss: 258116.9531; val_cond_contrastive_loss: 78420.1328; val_gene_expr_recon_loss: 90101.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432441.6875; val_optim_loss: 432441.6875
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9902; val_auprc_score: 0.9884; val_best_acc_score: 0.9609; val_best_f1_score: 0.9623; train_kl_reg_loss: 5869.1456; train_edge_recon_loss: 258533.8125; train_cond_contrastive_loss: 78767.3177; train_gene_expr_recon_loss: 90018.9518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433189.2344; train_optim_loss: 433189.2344; val_kl_reg_loss: 5797.5684; val_edge_recon_loss: 252675.1719; val_cond_contrastive_loss: 78421.3047; val_gene_expr_recon_loss: 90080.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426975.0000; val_optim_loss: 426975.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9852; val_best_acc_score: 0.9572; val_best_f1_score: 0.9586; train_kl_reg_loss: 5861.1249; train_edge_recon_loss: 259597.0599; train_cond_contrastive_loss: 78764.5690; train_gene_expr_recon_loss: 90135.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434358.4427; train_optim_loss: 434358.4427; val_kl_reg_loss: 5795.4712; val_edge_recon_loss: 257689.9219; val_cond_contrastive_loss: 78420.9922; val_gene_expr_recon_loss: 90078.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431985.3750; val_optim_loss: 431985.3750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9557; val_best_f1_score: 0.9568; train_kl_reg_loss: 5856.8377; train_edge_recon_loss: 259833.6016; train_cond_contrastive_loss: 78766.5990; train_gene_expr_recon_loss: 90058.2669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434515.3125; train_optim_loss: 434515.3125; val_kl_reg_loss: 5794.2603; val_edge_recon_loss: 258071.5781; val_cond_contrastive_loss: 78420.7656; val_gene_expr_recon_loss: 90076.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432363.6250; val_optim_loss: 432363.6250
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9880; val_auprc_score: 0.9827; val_best_acc_score: 0.9601; val_best_f1_score: 0.9611; train_kl_reg_loss: 5857.4038; train_edge_recon_loss: 259431.4323; train_cond_contrastive_loss: 78768.0430; train_gene_expr_recon_loss: 90011.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434067.9948; train_optim_loss: 434067.9948; val_kl_reg_loss: 5784.5742; val_edge_recon_loss: 255893.2031; val_cond_contrastive_loss: 78420.7031; val_gene_expr_recon_loss: 90075.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430173.9062; val_optim_loss: 430173.9062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 22 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9889
Val AUPRC score: 0.9842
Val best accuracy score: 0.9579
Val best F1 score: 0.9588
Val gene expr MSE score: 1.3773
Duration of model training in run 5: 0 hours, 3 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7538; val_auprc_score: 0.7907; val_best_acc_score: 0.6801; val_best_f1_score: 0.7043; train_kl_reg_loss: 3036.3089; train_edge_recon_loss: 362347.7135; train_cond_contrastive_loss: 108567.2292; train_gene_expr_recon_loss: 121173.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 595124.5417; train_optim_loss: 595124.5417; val_kl_reg_loss: 11137.0078; val_edge_recon_loss: 398206.2812; val_cond_contrastive_loss: 78342.6562; val_gene_expr_recon_loss: 102627.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 590313.0625; val_optim_loss: 590313.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7151; val_auprc_score: 0.7434; val_best_acc_score: 0.6331; val_best_f1_score: 0.7071; train_kl_reg_loss: 8982.7358; train_edge_recon_loss: 354799.7656; train_cond_contrastive_loss: 87877.2682; train_gene_expr_recon_loss: 103294.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554953.8021; train_optim_loss: 554953.8021; val_kl_reg_loss: 4488.6084; val_edge_recon_loss: 378900.2812; val_cond_contrastive_loss: 78381.4609; val_gene_expr_recon_loss: 100069.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561840.3125; val_optim_loss: 561840.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7176; val_auprc_score: 0.7395; val_best_acc_score: 0.6484; val_best_f1_score: 0.6952; train_kl_reg_loss: 4316.4931; train_edge_recon_loss: 343910.4688; train_cond_contrastive_loss: 87545.1667; train_gene_expr_recon_loss: 100937.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536709.8958; train_optim_loss: 536709.8958; val_kl_reg_loss: 3749.7739; val_edge_recon_loss: 342523.7500; val_cond_contrastive_loss: 78420.1953; val_gene_expr_recon_loss: 99298.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523992.0625; val_optim_loss: 523992.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7214; val_auprc_score: 0.7529; val_best_acc_score: 0.6555; val_best_f1_score: 0.7007; train_kl_reg_loss: 3860.8234; train_edge_recon_loss: 326791.0729; train_cond_contrastive_loss: 83891.3971; train_gene_expr_recon_loss: 100102.1654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 514645.4583; train_optim_loss: 514645.4583; val_kl_reg_loss: 4290.9482; val_edge_recon_loss: 326154.1562; val_cond_contrastive_loss: 78371.9688; val_gene_expr_recon_loss: 98523.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 507340.9688; val_optim_loss: 507340.9688
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7699; val_auprc_score: 0.7829; val_best_acc_score: 0.6878; val_best_f1_score: 0.7212; train_kl_reg_loss: 4729.0347; train_edge_recon_loss: 315586.7708; train_cond_contrastive_loss: 79519.2253; train_gene_expr_recon_loss: 99463.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499298.2083; train_optim_loss: 499298.2083; val_kl_reg_loss: 5057.0898; val_edge_recon_loss: 310273.2500; val_cond_contrastive_loss: 78377.1875; val_gene_expr_recon_loss: 97802.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491510.0938; val_optim_loss: 491510.0938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8266; val_auprc_score: 0.8165; val_best_acc_score: 0.7362; val_best_f1_score: 0.7730; train_kl_reg_loss: 5476.2212; train_edge_recon_loss: 296913.6875; train_cond_contrastive_loss: 78994.8542; train_gene_expr_recon_loss: 98639.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480023.9115; train_optim_loss: 480023.9115; val_kl_reg_loss: 5917.8838; val_edge_recon_loss: 291548.2812; val_cond_contrastive_loss: 78399.0703; val_gene_expr_recon_loss: 96842.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472707.6875; val_optim_loss: 472707.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8487; val_auprc_score: 0.8299; val_best_acc_score: 0.7666; val_best_f1_score: 0.7977; train_kl_reg_loss: 6300.7851; train_edge_recon_loss: 284734.7135; train_cond_contrastive_loss: 78762.8997; train_gene_expr_recon_loss: 97793.1276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467591.5260; train_optim_loss: 467591.5260; val_kl_reg_loss: 6315.1055; val_edge_recon_loss: 283154.2500; val_cond_contrastive_loss: 78401.3281; val_gene_expr_recon_loss: 96134.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464004.9688; val_optim_loss: 464004.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8726; val_auprc_score: 0.8511; val_best_acc_score: 0.8004; val_best_f1_score: 0.8200; train_kl_reg_loss: 6354.7658; train_edge_recon_loss: 280755.5312; train_cond_contrastive_loss: 78932.8672; train_gene_expr_recon_loss: 97212.5117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463255.6771; train_optim_loss: 463255.6771; val_kl_reg_loss: 6256.9727; val_edge_recon_loss: 278952.2812; val_cond_contrastive_loss: 78401.7969; val_gene_expr_recon_loss: 95616.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459227.3438; val_optim_loss: 459227.3438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8875; val_auprc_score: 0.8640; val_best_acc_score: 0.8164; val_best_f1_score: 0.8338; train_kl_reg_loss: 6355.2414; train_edge_recon_loss: 276658.8281; train_cond_contrastive_loss: 78985.3464; train_gene_expr_recon_loss: 96754.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458753.5885; train_optim_loss: 458753.5885; val_kl_reg_loss: 6243.5640; val_edge_recon_loss: 277356.9688; val_cond_contrastive_loss: 78407.1641; val_gene_expr_recon_loss: 95124.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457132.1250; val_optim_loss: 457132.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8968; val_auprc_score: 0.8675; val_best_acc_score: 0.8319; val_best_f1_score: 0.8472; train_kl_reg_loss: 6324.5711; train_edge_recon_loss: 274849.6042; train_cond_contrastive_loss: 78993.3307; train_gene_expr_recon_loss: 96334.2487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456501.7500; train_optim_loss: 456501.7500; val_kl_reg_loss: 6129.8325; val_edge_recon_loss: 274451.0000; val_cond_contrastive_loss: 78416.6484; val_gene_expr_recon_loss: 94691.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453689.2500; val_optim_loss: 453689.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9189; val_auprc_score: 0.9024; val_best_acc_score: 0.8458; val_best_f1_score: 0.8598; train_kl_reg_loss: 6147.0990; train_edge_recon_loss: 273561.8438; train_cond_contrastive_loss: 78956.5156; train_gene_expr_recon_loss: 95917.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454582.4896; train_optim_loss: 454582.4896; val_kl_reg_loss: 6029.9097; val_edge_recon_loss: 268723.7500; val_cond_contrastive_loss: 78424.5781; val_gene_expr_recon_loss: 94351.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447529.8125; val_optim_loss: 447529.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9327; val_auprc_score: 0.9184; val_best_acc_score: 0.8610; val_best_f1_score: 0.8673; train_kl_reg_loss: 6083.9365; train_edge_recon_loss: 271381.6458; train_cond_contrastive_loss: 78797.0664; train_gene_expr_recon_loss: 95547.0846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451809.7344; train_optim_loss: 451809.7344; val_kl_reg_loss: 5959.5195; val_edge_recon_loss: 269100.2188; val_cond_contrastive_loss: 78423.8281; val_gene_expr_recon_loss: 94013.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447497.3750; val_optim_loss: 447497.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9417; val_auprc_score: 0.9311; val_best_acc_score: 0.8723; val_best_f1_score: 0.8787; train_kl_reg_loss: 6134.4387; train_edge_recon_loss: 270818.9167; train_cond_contrastive_loss: 78708.9661; train_gene_expr_recon_loss: 95191.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450854.2969; train_optim_loss: 450854.2969; val_kl_reg_loss: 6077.1021; val_edge_recon_loss: 265864.9375; val_cond_contrastive_loss: 78415.9297; val_gene_expr_recon_loss: 93697.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444055.1250; val_optim_loss: 444055.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9450; val_auprc_score: 0.9325; val_best_acc_score: 0.8831; val_best_f1_score: 0.8884; train_kl_reg_loss: 6196.5025; train_edge_recon_loss: 270481.7812; train_cond_contrastive_loss: 78660.8542; train_gene_expr_recon_loss: 94769.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450108.9635; train_optim_loss: 450108.9635; val_kl_reg_loss: 6097.5347; val_edge_recon_loss: 267960.5938; val_cond_contrastive_loss: 78409.6328; val_gene_expr_recon_loss: 93418.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445886.1250; val_optim_loss: 445886.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9527; val_auprc_score: 0.9447; val_best_acc_score: 0.8910; val_best_f1_score: 0.8949; train_kl_reg_loss: 6181.3281; train_edge_recon_loss: 269698.2812; train_cond_contrastive_loss: 78659.5781; train_gene_expr_recon_loss: 94492.5182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449031.7031; train_optim_loss: 449031.7031; val_kl_reg_loss: 5951.7773; val_edge_recon_loss: 268001.9062; val_cond_contrastive_loss: 78409.2031; val_gene_expr_recon_loss: 93145.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445508.6250; val_optim_loss: 445508.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9619; val_auprc_score: 0.9523; val_best_acc_score: 0.9050; val_best_f1_score: 0.9084; train_kl_reg_loss: 5964.2579; train_edge_recon_loss: 268122.6562; train_cond_contrastive_loss: 78687.9948; train_gene_expr_recon_loss: 94197.3841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446972.2969; train_optim_loss: 446972.2969; val_kl_reg_loss: 5785.4424; val_edge_recon_loss: 265744.6875; val_cond_contrastive_loss: 78410.2344; val_gene_expr_recon_loss: 92848.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442788.5625; val_optim_loss: 442788.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9703; val_auprc_score: 0.9658; val_best_acc_score: 0.9160; val_best_f1_score: 0.9187; train_kl_reg_loss: 5896.5968; train_edge_recon_loss: 267101.6771; train_cond_contrastive_loss: 78690.3398; train_gene_expr_recon_loss: 93949.0195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445637.6354; train_optim_loss: 445637.6354; val_kl_reg_loss: 5779.9268; val_edge_recon_loss: 263715.8125; val_cond_contrastive_loss: 78411.9062; val_gene_expr_recon_loss: 92579.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440486.9375; val_optim_loss: 440486.9375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9755; val_auprc_score: 0.9700; val_best_acc_score: 0.9256; val_best_f1_score: 0.9275; train_kl_reg_loss: 5836.1040; train_edge_recon_loss: 266424.6198; train_cond_contrastive_loss: 78698.4388; train_gene_expr_recon_loss: 93738.1393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444697.3021; train_optim_loss: 444697.3021; val_kl_reg_loss: 5675.7471; val_edge_recon_loss: 262799.0312; val_cond_contrastive_loss: 78413.2422; val_gene_expr_recon_loss: 92328.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439216.5938; val_optim_loss: 439216.5938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9780; val_auprc_score: 0.9705; val_best_acc_score: 0.9332; val_best_f1_score: 0.9357; train_kl_reg_loss: 5737.6785; train_edge_recon_loss: 265552.6823; train_cond_contrastive_loss: 78717.9154; train_gene_expr_recon_loss: 93706.3867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443714.6667; train_optim_loss: 443714.6667; val_kl_reg_loss: 5659.9941; val_edge_recon_loss: 261484.3281; val_cond_contrastive_loss: 78410.6719; val_gene_expr_recon_loss: 92114.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437669.1250; val_optim_loss: 437669.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9813; val_auprc_score: 0.9769; val_best_acc_score: 0.9398; val_best_f1_score: 0.9411; train_kl_reg_loss: 5807.7597; train_edge_recon_loss: 262049.4609; train_cond_contrastive_loss: 78731.7357; train_gene_expr_recon_loss: 93317.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439906.2708; train_optim_loss: 439906.2708; val_kl_reg_loss: 5765.1914; val_edge_recon_loss: 262061.0938; val_cond_contrastive_loss: 78407.5625; val_gene_expr_recon_loss: 91886.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438120.3438; val_optim_loss: 438120.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9827; val_auprc_score: 0.9767; val_best_acc_score: 0.9466; val_best_f1_score: 0.9481; train_kl_reg_loss: 5829.0789; train_edge_recon_loss: 262754.9062; train_cond_contrastive_loss: 78744.5339; train_gene_expr_recon_loss: 92977.7982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440306.3073; train_optim_loss: 440306.3073; val_kl_reg_loss: 5702.9829; val_edge_recon_loss: 259401.5312; val_cond_contrastive_loss: 78405.3438; val_gene_expr_recon_loss: 91665.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435175.1250; val_optim_loss: 435175.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9838; val_auprc_score: 0.9803; val_best_acc_score: 0.9471; val_best_f1_score: 0.9484; train_kl_reg_loss: 5818.1339; train_edge_recon_loss: 262245.3750; train_cond_contrastive_loss: 78756.6159; train_gene_expr_recon_loss: 92937.4987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439757.6302; train_optim_loss: 439757.6302; val_kl_reg_loss: 5774.4175; val_edge_recon_loss: 261342.9062; val_cond_contrastive_loss: 78403.4219; val_gene_expr_recon_loss: 91435.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436956.4688; val_optim_loss: 436956.4688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9840; val_auprc_score: 0.9789; val_best_acc_score: 0.9499; val_best_f1_score: 0.9512; train_kl_reg_loss: 5845.8555; train_edge_recon_loss: 262634.6771; train_cond_contrastive_loss: 78764.5208; train_gene_expr_recon_loss: 92411.9674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439657.0208; train_optim_loss: 439657.0208; val_kl_reg_loss: 5730.8848; val_edge_recon_loss: 260184.8594; val_cond_contrastive_loss: 78403.9531; val_gene_expr_recon_loss: 91201.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435520.7812; val_optim_loss: 435520.7812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9865; val_auprc_score: 0.9816; val_best_acc_score: 0.9508; val_best_f1_score: 0.9519; train_kl_reg_loss: 5843.7934; train_edge_recon_loss: 261005.1667; train_cond_contrastive_loss: 78781.2201; train_gene_expr_recon_loss: 92376.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438006.8490; train_optim_loss: 438006.8490; val_kl_reg_loss: 5800.6475; val_edge_recon_loss: 261519.7656; val_cond_contrastive_loss: 78404.6016; val_gene_expr_recon_loss: 90963.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436688.3125; val_optim_loss: 436688.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9861; val_auprc_score: 0.9830; val_best_acc_score: 0.9497; val_best_f1_score: 0.9511; train_kl_reg_loss: 5891.2009; train_edge_recon_loss: 261410.9740; train_cond_contrastive_loss: 78771.6589; train_gene_expr_recon_loss: 92154.9831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438228.8021; train_optim_loss: 438228.8021; val_kl_reg_loss: 5788.0742; val_edge_recon_loss: 258901.3281; val_cond_contrastive_loss: 78405.4219; val_gene_expr_recon_loss: 90928.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434022.9375; val_optim_loss: 434022.9375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9867; val_auprc_score: 0.9838; val_best_acc_score: 0.9513; val_best_f1_score: 0.9528; train_kl_reg_loss: 5881.6773; train_edge_recon_loss: 260837.6042; train_cond_contrastive_loss: 78772.4792; train_gene_expr_recon_loss: 92169.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437660.9062; train_optim_loss: 437660.9062; val_kl_reg_loss: 5759.8281; val_edge_recon_loss: 258592.0469; val_cond_contrastive_loss: 78405.8516; val_gene_expr_recon_loss: 90892.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433650.1875; val_optim_loss: 433650.1875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9877; val_auprc_score: 0.9829; val_best_acc_score: 0.9552; val_best_f1_score: 0.9563; train_kl_reg_loss: 5861.9592; train_edge_recon_loss: 260125.9323; train_cond_contrastive_loss: 78772.1719; train_gene_expr_recon_loss: 91928.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436688.8750; train_optim_loss: 436688.8750; val_kl_reg_loss: 5737.0869; val_edge_recon_loss: 257849.2812; val_cond_contrastive_loss: 78405.2188; val_gene_expr_recon_loss: 90865.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432857.3438; val_optim_loss: 432857.3438
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9860; val_auprc_score: 0.9834; val_best_acc_score: 0.9516; val_best_f1_score: 0.9535; train_kl_reg_loss: 5836.3228; train_edge_recon_loss: 260866.4141; train_cond_contrastive_loss: 78787.1849; train_gene_expr_recon_loss: 92107.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437597.6354; train_optim_loss: 437597.6354; val_kl_reg_loss: 5718.5537; val_edge_recon_loss: 257400.6562; val_cond_contrastive_loss: 78405.8672; val_gene_expr_recon_loss: 90840.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432365.5938; val_optim_loss: 432365.5938
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9865; val_auprc_score: 0.9801; val_best_acc_score: 0.9510; val_best_f1_score: 0.9523; train_kl_reg_loss: 5830.3413; train_edge_recon_loss: 259794.4609; train_cond_contrastive_loss: 78786.9505; train_gene_expr_recon_loss: 92032.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436443.8958; train_optim_loss: 436443.8958; val_kl_reg_loss: 5717.9277; val_edge_recon_loss: 260268.8125; val_cond_contrastive_loss: 78404.9766; val_gene_expr_recon_loss: 90812.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435204.3750; val_optim_loss: 435204.3750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9870; val_auprc_score: 0.9827; val_best_acc_score: 0.9502; val_best_f1_score: 0.9520; train_kl_reg_loss: 5830.7501; train_edge_recon_loss: 260289.4974; train_cond_contrastive_loss: 78771.0651; train_gene_expr_recon_loss: 92034.9193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436926.2292; train_optim_loss: 436926.2292; val_kl_reg_loss: 5710.0674; val_edge_recon_loss: 259770.2500; val_cond_contrastive_loss: 78405.7656; val_gene_expr_recon_loss: 90792.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434678.0625; val_optim_loss: 434678.0625
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9850; val_auprc_score: 0.9773; val_best_acc_score: 0.9520; val_best_f1_score: 0.9536; train_kl_reg_loss: 5821.5322; train_edge_recon_loss: 262115.6302; train_cond_contrastive_loss: 78782.2344; train_gene_expr_recon_loss: 91949.1706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438668.5677; train_optim_loss: 438668.5677; val_kl_reg_loss: 5709.0200; val_edge_recon_loss: 259632.9375; val_cond_contrastive_loss: 78405.3047; val_gene_expr_recon_loss: 90772.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434520.2500; val_optim_loss: 434520.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9851; val_auprc_score: 0.9794; val_best_acc_score: 0.9485; val_best_f1_score: 0.9500; train_kl_reg_loss: 5821.1943; train_edge_recon_loss: 260758.2448; train_cond_contrastive_loss: 78783.5495; train_gene_expr_recon_loss: 91902.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437265.0677; train_optim_loss: 437265.0677; val_kl_reg_loss: 5703.3804; val_edge_recon_loss: 261213.6875; val_cond_contrastive_loss: 78404.8828; val_gene_expr_recon_loss: 90770.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436092.4375; val_optim_loss: 436092.4375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9857; val_auprc_score: 0.9825; val_best_acc_score: 0.9497; val_best_f1_score: 0.9516; train_kl_reg_loss: 5822.8796; train_edge_recon_loss: 260859.0078; train_cond_contrastive_loss: 78784.6562; train_gene_expr_recon_loss: 91966.3490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437432.8906; train_optim_loss: 437432.8906; val_kl_reg_loss: 5711.9961; val_edge_recon_loss: 258418.6562; val_cond_contrastive_loss: 78405.7188; val_gene_expr_recon_loss: 90767.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433303.4688; val_optim_loss: 433303.4688
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9862; val_auprc_score: 0.9816; val_best_acc_score: 0.9507; val_best_f1_score: 0.9522; train_kl_reg_loss: 5826.3328; train_edge_recon_loss: 260204.9219; train_cond_contrastive_loss: 78777.8711; train_gene_expr_recon_loss: 92063.6693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436872.7969; train_optim_loss: 436872.7969; val_kl_reg_loss: 5712.6885; val_edge_recon_loss: 259732.2188; val_cond_contrastive_loss: 78405.5156; val_gene_expr_recon_loss: 90763.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434614.2812; val_optim_loss: 434614.2812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 47 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9870
Val AUPRC score: 0.9829
Val best accuracy score: 0.9507
Val best F1 score: 0.9516
Val gene expr MSE score: 1.4469
Duration of model training in run 6: 0 hours, 2 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7701; val_auprc_score: 0.8043; val_best_acc_score: 0.6866; val_best_f1_score: 0.7158; train_kl_reg_loss: 6655.4516; train_edge_recon_loss: 357816.2857; train_cond_contrastive_loss: 103675.3739; train_gene_expr_recon_loss: 119888.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 588035.1875; train_optim_loss: 588035.1875; val_kl_reg_loss: 9170.5889; val_edge_recon_loss: 398777.6875; val_cond_contrastive_loss: 78335.2812; val_gene_expr_recon_loss: 102792.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 589075.8125; val_optim_loss: 589075.8125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7367; val_auprc_score: 0.7640; val_best_acc_score: 0.6522; val_best_f1_score: 0.7139; train_kl_reg_loss: 6924.4662; train_edge_recon_loss: 355141.1652; train_cond_contrastive_loss: 88223.3895; train_gene_expr_recon_loss: 101306.1629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551595.1875; train_optim_loss: 551595.1875; val_kl_reg_loss: 4964.2520; val_edge_recon_loss: 374423.1875; val_cond_contrastive_loss: 78384.7891; val_gene_expr_recon_loss: 100782.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558554.8125; val_optim_loss: 558554.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7359; val_auprc_score: 0.7636; val_best_acc_score: 0.6577; val_best_f1_score: 0.7058; train_kl_reg_loss: 3941.0449; train_edge_recon_loss: 338793.3393; train_cond_contrastive_loss: 87893.9163; train_gene_expr_recon_loss: 99890.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 530518.9554; train_optim_loss: 530518.9554; val_kl_reg_loss: 3633.7822; val_edge_recon_loss: 327447.9688; val_cond_contrastive_loss: 78379.5156; val_gene_expr_recon_loss: 99942.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509403.9688; val_optim_loss: 509403.9688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7610; val_auprc_score: 0.7776; val_best_acc_score: 0.6842; val_best_f1_score: 0.7149; train_kl_reg_loss: 4351.8795; train_edge_recon_loss: 317579.3973; train_cond_contrastive_loss: 80807.0268; train_gene_expr_recon_loss: 99047.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 501786.0491; train_optim_loss: 501786.0491; val_kl_reg_loss: 5039.6494; val_edge_recon_loss: 315037.3750; val_cond_contrastive_loss: 78359.0781; val_gene_expr_recon_loss: 99197.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497633.2188; val_optim_loss: 497633.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8183; val_auprc_score: 0.8115; val_best_acc_score: 0.7348; val_best_f1_score: 0.7628; train_kl_reg_loss: 5372.2658; train_edge_recon_loss: 302884.7098; train_cond_contrastive_loss: 78919.5112; train_gene_expr_recon_loss: 98485.4498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485661.9330; train_optim_loss: 485661.9330; val_kl_reg_loss: 5661.1230; val_edge_recon_loss: 294823.9688; val_cond_contrastive_loss: 78376.4766; val_gene_expr_recon_loss: 98502.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477364.3750; val_optim_loss: 477364.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8497; val_auprc_score: 0.8342; val_best_acc_score: 0.7688; val_best_f1_score: 0.7989; train_kl_reg_loss: 5893.2622; train_edge_recon_loss: 286736.6250; train_cond_contrastive_loss: 78798.5078; train_gene_expr_recon_loss: 97780.7690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469209.1696; train_optim_loss: 469209.1696; val_kl_reg_loss: 6032.4316; val_edge_recon_loss: 281435.0312; val_cond_contrastive_loss: 78374.5078; val_gene_expr_recon_loss: 97743.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463585.5312; val_optim_loss: 463585.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8607; val_auprc_score: 0.8362; val_best_acc_score: 0.7816; val_best_f1_score: 0.8045; train_kl_reg_loss: 6056.8094; train_edge_recon_loss: 281783.0759; train_cond_contrastive_loss: 78867.1462; train_gene_expr_recon_loss: 97317.5502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464024.5848; train_optim_loss: 464024.5848; val_kl_reg_loss: 5892.2598; val_edge_recon_loss: 281108.6875; val_cond_contrastive_loss: 78368.3281; val_gene_expr_recon_loss: 97074.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462443.8750; val_optim_loss: 462443.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8808; val_auprc_score: 0.8596; val_best_acc_score: 0.8039; val_best_f1_score: 0.8199; train_kl_reg_loss: 5967.6726; train_edge_recon_loss: 278304.2188; train_cond_contrastive_loss: 79025.0056; train_gene_expr_recon_loss: 96542.2478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459839.1562; train_optim_loss: 459839.1562; val_kl_reg_loss: 6042.2490; val_edge_recon_loss: 276981.7812; val_cond_contrastive_loss: 78372.1719; val_gene_expr_recon_loss: 96592.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457988.2812; val_optim_loss: 457988.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8973; val_auprc_score: 0.8730; val_best_acc_score: 0.8302; val_best_f1_score: 0.8467; train_kl_reg_loss: 6187.4847; train_edge_recon_loss: 275539.9821; train_cond_contrastive_loss: 78988.4342; train_gene_expr_recon_loss: 96045.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456761.1027; train_optim_loss: 456761.1027; val_kl_reg_loss: 6174.4512; val_edge_recon_loss: 272383.4062; val_cond_contrastive_loss: 78380.8672; val_gene_expr_recon_loss: 96166.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453105.0625; val_optim_loss: 453105.0625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9246; val_auprc_score: 0.9093; val_best_acc_score: 0.8512; val_best_f1_score: 0.8615; train_kl_reg_loss: 6162.0158; train_edge_recon_loss: 272213.5893; train_cond_contrastive_loss: 78960.0926; train_gene_expr_recon_loss: 95400.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452736.1384; train_optim_loss: 452736.1384; val_kl_reg_loss: 6012.1816; val_edge_recon_loss: 271093.8750; val_cond_contrastive_loss: 78394.1094; val_gene_expr_recon_loss: 95786.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451286.8750; val_optim_loss: 451286.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9387; val_auprc_score: 0.9278; val_best_acc_score: 0.8668; val_best_f1_score: 0.8743; train_kl_reg_loss: 5985.6564; train_edge_recon_loss: 269873.5357; train_cond_contrastive_loss: 78884.8973; train_gene_expr_recon_loss: 95252.3917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449996.4777; train_optim_loss: 449996.4777; val_kl_reg_loss: 5959.5967; val_edge_recon_loss: 270839.4375; val_cond_contrastive_loss: 78396.9141; val_gene_expr_recon_loss: 95419.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450615.9375; val_optim_loss: 450615.9375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9483; val_auprc_score: 0.9358; val_best_acc_score: 0.8838; val_best_f1_score: 0.8873; train_kl_reg_loss: 6073.9855; train_edge_recon_loss: 268259.7812; train_cond_contrastive_loss: 78753.7846; train_gene_expr_recon_loss: 94667.6306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447755.1875; train_optim_loss: 447755.1875; val_kl_reg_loss: 6210.9893; val_edge_recon_loss: 268969.6250; val_cond_contrastive_loss: 78394.9141; val_gene_expr_recon_loss: 95077.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448652.6250; val_optim_loss: 448652.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9562; val_auprc_score: 0.9479; val_best_acc_score: 0.8950; val_best_f1_score: 0.8986; train_kl_reg_loss: 6239.2929; train_edge_recon_loss: 267319.6652; train_cond_contrastive_loss: 78698.3973; train_gene_expr_recon_loss: 94365.6194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446622.9777; train_optim_loss: 446622.9777; val_kl_reg_loss: 6159.8906; val_edge_recon_loss: 268101.4375; val_cond_contrastive_loss: 78395.0703; val_gene_expr_recon_loss: 94734.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447390.6250; val_optim_loss: 447390.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9646; val_auprc_score: 0.9566; val_best_acc_score: 0.9085; val_best_f1_score: 0.9112; train_kl_reg_loss: 6142.6017; train_edge_recon_loss: 266802.2411; train_cond_contrastive_loss: 78739.6529; train_gene_expr_recon_loss: 93882.2310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445566.7277; train_optim_loss: 445566.7277; val_kl_reg_loss: 6044.6494; val_edge_recon_loss: 267029.6250; val_cond_contrastive_loss: 78399.2812; val_gene_expr_recon_loss: 94404.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445877.6875; val_optim_loss: 445877.6875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9700; val_auprc_score: 0.9639; val_best_acc_score: 0.9190; val_best_f1_score: 0.9210; train_kl_reg_loss: 6009.3599; train_edge_recon_loss: 265254.2054; train_cond_contrastive_loss: 78791.8013; train_gene_expr_recon_loss: 93660.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443715.5491; train_optim_loss: 443715.5491; val_kl_reg_loss: 5904.8975; val_edge_recon_loss: 266302.6250; val_cond_contrastive_loss: 78406.4141; val_gene_expr_recon_loss: 94097.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444711.5625; val_optim_loss: 444711.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9732; val_auprc_score: 0.9690; val_best_acc_score: 0.9248; val_best_f1_score: 0.9281; train_kl_reg_loss: 5886.0880; train_edge_recon_loss: 265331.7634; train_cond_contrastive_loss: 78821.1261; train_gene_expr_recon_loss: 93759.8002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443798.7768; train_optim_loss: 443798.7768; val_kl_reg_loss: 5791.1729; val_edge_recon_loss: 263676.6562; val_cond_contrastive_loss: 78412.3203; val_gene_expr_recon_loss: 93804.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441684.5312; val_optim_loss: 441684.5312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9774; val_auprc_score: 0.9710; val_best_acc_score: 0.9299; val_best_f1_score: 0.9322; train_kl_reg_loss: 5801.5202; train_edge_recon_loss: 264526.5982; train_cond_contrastive_loss: 78812.3304; train_gene_expr_recon_loss: 93283.9632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442424.4062; train_optim_loss: 442424.4062; val_kl_reg_loss: 5731.6362; val_edge_recon_loss: 264504.1250; val_cond_contrastive_loss: 78413.3516; val_gene_expr_recon_loss: 93547.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442196.3125; val_optim_loss: 442196.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9819; val_auprc_score: 0.9767; val_best_acc_score: 0.9404; val_best_f1_score: 0.9418; train_kl_reg_loss: 5807.8499; train_edge_recon_loss: 262626.9911; train_cond_contrastive_loss: 78779.4944; train_gene_expr_recon_loss: 92862.5982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440076.9330; train_optim_loss: 440076.9330; val_kl_reg_loss: 5793.2549; val_edge_recon_loss: 261090.2812; val_cond_contrastive_loss: 78410.5625; val_gene_expr_recon_loss: 93301.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438595.8438; val_optim_loss: 438595.8438
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9825; val_auprc_score: 0.9772; val_best_acc_score: 0.9400; val_best_f1_score: 0.9414; train_kl_reg_loss: 5797.0761; train_edge_recon_loss: 261826.9174; train_cond_contrastive_loss: 78764.1574; train_gene_expr_recon_loss: 92571.8705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438960.0134; train_optim_loss: 438960.0134; val_kl_reg_loss: 5765.3984; val_edge_recon_loss: 259753.8594; val_cond_contrastive_loss: 78406.0781; val_gene_expr_recon_loss: 93057.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436982.8438; val_optim_loss: 436982.8438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9829; val_auprc_score: 0.9762; val_best_acc_score: 0.9416; val_best_f1_score: 0.9426; train_kl_reg_loss: 5802.0055; train_edge_recon_loss: 261693.0871; train_cond_contrastive_loss: 78760.8884; train_gene_expr_recon_loss: 92471.7645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438727.7411; train_optim_loss: 438727.7411; val_kl_reg_loss: 5750.9795; val_edge_recon_loss: 261032.6406; val_cond_contrastive_loss: 78402.5859; val_gene_expr_recon_loss: 92806.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437992.4688; val_optim_loss: 437992.4688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9844; val_auprc_score: 0.9803; val_best_acc_score: 0.9443; val_best_f1_score: 0.9458; train_kl_reg_loss: 5810.4375; train_edge_recon_loss: 261146.8080; train_cond_contrastive_loss: 78754.5670; train_gene_expr_recon_loss: 92308.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438020.0045; train_optim_loss: 438020.0045; val_kl_reg_loss: 5759.7627; val_edge_recon_loss: 258822.6719; val_cond_contrastive_loss: 78400.5078; val_gene_expr_recon_loss: 92545.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435528.1875; val_optim_loss: 435528.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9844; val_auprc_score: 0.9795; val_best_acc_score: 0.9443; val_best_f1_score: 0.9456; train_kl_reg_loss: 5798.2049; train_edge_recon_loss: 260503.6138; train_cond_contrastive_loss: 78753.6507; train_gene_expr_recon_loss: 92266.0167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437321.4821; train_optim_loss: 437321.4821; val_kl_reg_loss: 5729.3135; val_edge_recon_loss: 259059.0938; val_cond_contrastive_loss: 78398.0859; val_gene_expr_recon_loss: 92286.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435473.3750; val_optim_loss: 435473.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9871; val_auprc_score: 0.9844; val_best_acc_score: 0.9485; val_best_f1_score: 0.9494; train_kl_reg_loss: 5796.9063; train_edge_recon_loss: 260715.4375; train_cond_contrastive_loss: 78743.7098; train_gene_expr_recon_loss: 91634.7444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436890.7946; train_optim_loss: 436890.7946; val_kl_reg_loss: 5763.9219; val_edge_recon_loss: 258724.5625; val_cond_contrastive_loss: 78395.9531; val_gene_expr_recon_loss: 92034.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434919.3438; val_optim_loss: 434919.3438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9861; val_auprc_score: 0.9812; val_best_acc_score: 0.9447; val_best_f1_score: 0.9464; train_kl_reg_loss: 5780.5509; train_edge_recon_loss: 260271.9531; train_cond_contrastive_loss: 78738.8225; train_gene_expr_recon_loss: 91355.6373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436146.9688; train_optim_loss: 436146.9688; val_kl_reg_loss: 5751.4678; val_edge_recon_loss: 258890.4531; val_cond_contrastive_loss: 78395.0625; val_gene_expr_recon_loss: 91798.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434835.2500; val_optim_loss: 434835.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9877; val_auprc_score: 0.9839; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 5785.4429; train_edge_recon_loss: 259398.0312; train_cond_contrastive_loss: 78733.0826; train_gene_expr_recon_loss: 91258.1674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435174.7232; train_optim_loss: 435174.7232; val_kl_reg_loss: 5770.7188; val_edge_recon_loss: 259767.2031; val_cond_contrastive_loss: 78395.4844; val_gene_expr_recon_loss: 91561.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435495.3125; val_optim_loss: 435495.3125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9536; val_best_f1_score: 0.9542; train_kl_reg_loss: 5762.9429; train_edge_recon_loss: 259598.4286; train_cond_contrastive_loss: 78721.9498; train_gene_expr_recon_loss: 91045.7199; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435129.0357; train_optim_loss: 435129.0357; val_kl_reg_loss: 5677.7041; val_edge_recon_loss: 257580.8438; val_cond_contrastive_loss: 78397.2656; val_gene_expr_recon_loss: 91342.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432998.6250; val_optim_loss: 432998.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9894; val_auprc_score: 0.9871; val_best_acc_score: 0.9535; val_best_f1_score: 0.9542; train_kl_reg_loss: 5748.8751; train_edge_recon_loss: 259309.1853; train_cond_contrastive_loss: 78725.4375; train_gene_expr_recon_loss: 90811.2243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434594.7232; train_optim_loss: 434594.7232; val_kl_reg_loss: 5676.3467; val_edge_recon_loss: 259764.7344; val_cond_contrastive_loss: 78399.8828; val_gene_expr_recon_loss: 91112.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434953.4688; val_optim_loss: 434953.4688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9890; val_auprc_score: 0.9864; val_best_acc_score: 0.9552; val_best_f1_score: 0.9563; train_kl_reg_loss: 5715.8912; train_edge_recon_loss: 258760.4911; train_cond_contrastive_loss: 78729.5446; train_gene_expr_recon_loss: 90568.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433774.5714; train_optim_loss: 433774.5714; val_kl_reg_loss: 5598.4385; val_edge_recon_loss: 256054.3438; val_cond_contrastive_loss: 78401.8828; val_gene_expr_recon_loss: 90912.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430967.3750; val_optim_loss: 430967.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9908; val_auprc_score: 0.9870; val_best_acc_score: 0.9581; val_best_f1_score: 0.9594; train_kl_reg_loss: 5680.8444; train_edge_recon_loss: 259408.8929; train_cond_contrastive_loss: 78738.2902; train_gene_expr_recon_loss: 90412.3259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434240.3571; train_optim_loss: 434240.3571; val_kl_reg_loss: 5654.7646; val_edge_recon_loss: 255927.8281; val_cond_contrastive_loss: 78404.4141; val_gene_expr_recon_loss: 90715.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430702.8750; val_optim_loss: 430702.8750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9902; val_auprc_score: 0.9846; val_best_acc_score: 0.9574; val_best_f1_score: 0.9580; train_kl_reg_loss: 5681.8458; train_edge_recon_loss: 259288.5379; train_cond_contrastive_loss: 78729.0167; train_gene_expr_recon_loss: 90063.3114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433762.7009; train_optim_loss: 433762.7009; val_kl_reg_loss: 5600.3633; val_edge_recon_loss: 261104.6719; val_cond_contrastive_loss: 78405.3828; val_gene_expr_recon_loss: 90517.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435628.0312; val_optim_loss: 435628.0312
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9904; val_auprc_score: 0.9880; val_best_acc_score: 0.9590; val_best_f1_score: 0.9594; train_kl_reg_loss: 5702.4978; train_edge_recon_loss: 258877.2812; train_cond_contrastive_loss: 78732.5391; train_gene_expr_recon_loss: 89864.6752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433176.9911; train_optim_loss: 433176.9911; val_kl_reg_loss: 5622.5576; val_edge_recon_loss: 258471.0469; val_cond_contrastive_loss: 78409.4453; val_gene_expr_recon_loss: 90325.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432828.5312; val_optim_loss: 432828.5312
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9906; val_auprc_score: 0.9857; val_best_acc_score: 0.9616; val_best_f1_score: 0.9627; train_kl_reg_loss: 5691.5710; train_edge_recon_loss: 258687.8594; train_cond_contrastive_loss: 78727.1730; train_gene_expr_recon_loss: 89677.6808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432784.2946; train_optim_loss: 432784.2946; val_kl_reg_loss: 5631.0938; val_edge_recon_loss: 257253.0156; val_cond_contrastive_loss: 78412.6016; val_gene_expr_recon_loss: 90162.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431458.9062; val_optim_loss: 431458.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9913; val_auprc_score: 0.9875; val_best_acc_score: 0.9612; val_best_f1_score: 0.9623; train_kl_reg_loss: 5687.3866; train_edge_recon_loss: 258755.5000; train_cond_contrastive_loss: 78727.2299; train_gene_expr_recon_loss: 89742.9944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432913.1116; train_optim_loss: 432913.1116; val_kl_reg_loss: 5628.0664; val_edge_recon_loss: 259372.2344; val_cond_contrastive_loss: 78412.1562; val_gene_expr_recon_loss: 90136.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433548.6875; val_optim_loss: 433548.6875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9918; val_auprc_score: 0.9888; val_best_acc_score: 0.9620; val_best_f1_score: 0.9625; train_kl_reg_loss: 5693.0831; train_edge_recon_loss: 258215.2879; train_cond_contrastive_loss: 78719.9732; train_gene_expr_recon_loss: 89569.8962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432198.2321; train_optim_loss: 432198.2321; val_kl_reg_loss: 5617.6289; val_edge_recon_loss: 257242.5938; val_cond_contrastive_loss: 78412.2891; val_gene_expr_recon_loss: 90103.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431376.1875; val_optim_loss: 431376.1875
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9910; val_auprc_score: 0.9890; val_best_acc_score: 0.9600; val_best_f1_score: 0.9606; train_kl_reg_loss: 5675.0196; train_edge_recon_loss: 258286.7277; train_cond_contrastive_loss: 78729.7690; train_gene_expr_recon_loss: 89422.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432113.7902; train_optim_loss: 432113.7902; val_kl_reg_loss: 5609.4414; val_edge_recon_loss: 259992.8125; val_cond_contrastive_loss: 78412.3125; val_gene_expr_recon_loss: 90082.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434097.0000; val_optim_loss: 434097.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 46 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9874
Val best accuracy score: 0.9566
Val best F1 score: 0.9573
Val gene expr MSE score: 1.3462
Duration of model training in run 7: 0 hours, 3 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7766; val_auprc_score: 0.8058; val_best_acc_score: 0.6910; val_best_f1_score: 0.7138; train_kl_reg_loss: 5028.9100; train_edge_recon_loss: 355881.6071; train_cond_contrastive_loss: 109243.2913; train_gene_expr_recon_loss: 121917.3092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 592071.1071; train_optim_loss: 592071.1071; val_kl_reg_loss: 14384.4365; val_edge_recon_loss: 399061.9062; val_cond_contrastive_loss: 78333.4453; val_gene_expr_recon_loss: 103285.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595065.3125; val_optim_loss: 595065.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7422; val_auprc_score: 0.7615; val_best_acc_score: 0.6600; val_best_f1_score: 0.7159; train_kl_reg_loss: 8309.4315; train_edge_recon_loss: 355826.9821; train_cond_contrastive_loss: 88512.5871; train_gene_expr_recon_loss: 101756.7645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554405.7679; train_optim_loss: 554405.7679; val_kl_reg_loss: 5359.6162; val_edge_recon_loss: 379431.5312; val_cond_contrastive_loss: 78373.3672; val_gene_expr_recon_loss: 100333.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 563498.4375; val_optim_loss: 563498.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7376; val_auprc_score: 0.7612; val_best_acc_score: 0.6561; val_best_f1_score: 0.7074; train_kl_reg_loss: 4712.8273; train_edge_recon_loss: 342408.5982; train_cond_contrastive_loss: 87068.1652; train_gene_expr_recon_loss: 99548.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533737.9375; train_optim_loss: 533737.9375; val_kl_reg_loss: 3453.2256; val_edge_recon_loss: 333366.5625; val_cond_contrastive_loss: 78381.5391; val_gene_expr_recon_loss: 99523.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 514725.2500; val_optim_loss: 514725.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7604; val_auprc_score: 0.7755; val_best_acc_score: 0.6797; val_best_f1_score: 0.7207; train_kl_reg_loss: 3910.1230; train_edge_recon_loss: 317212.0402; train_cond_contrastive_loss: 82074.5893; train_gene_expr_recon_loss: 98725.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 501921.9330; train_optim_loss: 501921.9330; val_kl_reg_loss: 4755.2534; val_edge_recon_loss: 313625.5312; val_cond_contrastive_loss: 78356.4141; val_gene_expr_recon_loss: 98653.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 495390.6250; val_optim_loss: 495390.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8219; val_auprc_score: 0.8101; val_best_acc_score: 0.7380; val_best_f1_score: 0.7699; train_kl_reg_loss: 5452.6207; train_edge_recon_loss: 300306.6920; train_cond_contrastive_loss: 78863.9062; train_gene_expr_recon_loss: 97263.3025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481886.5134; train_optim_loss: 481886.5134; val_kl_reg_loss: 6223.6763; val_edge_recon_loss: 293244.5938; val_cond_contrastive_loss: 78371.0469; val_gene_expr_recon_loss: 97742.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475581.5625; val_optim_loss: 475581.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8478; val_auprc_score: 0.8320; val_best_acc_score: 0.7644; val_best_f1_score: 0.7913; train_kl_reg_loss: 6500.3973; train_edge_recon_loss: 285427.4196; train_cond_contrastive_loss: 78679.5391; train_gene_expr_recon_loss: 96695.8237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467303.1741; train_optim_loss: 467303.1741; val_kl_reg_loss: 6496.0146; val_edge_recon_loss: 284940.1562; val_cond_contrastive_loss: 78370.5859; val_gene_expr_recon_loss: 96754.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466561.0000; val_optim_loss: 466561.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8631; val_auprc_score: 0.8368; val_best_acc_score: 0.7843; val_best_f1_score: 0.8054; train_kl_reg_loss: 6365.6629; train_edge_recon_loss: 280835.3393; train_cond_contrastive_loss: 78902.4241; train_gene_expr_recon_loss: 95804.8772; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461908.2991; train_optim_loss: 461908.2991; val_kl_reg_loss: 6038.0420; val_edge_recon_loss: 281044.9375; val_cond_contrastive_loss: 78370.7500; val_gene_expr_recon_loss: 96086.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461540.3125; val_optim_loss: 461540.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8806; val_auprc_score: 0.8534; val_best_acc_score: 0.8116; val_best_f1_score: 0.8270; train_kl_reg_loss: 6162.5382; train_edge_recon_loss: 278713.8571; train_cond_contrastive_loss: 79105.0156; train_gene_expr_recon_loss: 95399.5480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459380.9598; train_optim_loss: 459380.9598; val_kl_reg_loss: 6219.4077; val_edge_recon_loss: 276472.1250; val_cond_contrastive_loss: 78381.7969; val_gene_expr_recon_loss: 95614.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456687.4375; val_optim_loss: 456687.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8996; val_auprc_score: 0.8743; val_best_acc_score: 0.8310; val_best_f1_score: 0.8462; train_kl_reg_loss: 6384.5481; train_edge_recon_loss: 274219.9821; train_cond_contrastive_loss: 78998.7612; train_gene_expr_recon_loss: 94568.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454171.6830; train_optim_loss: 454171.6830; val_kl_reg_loss: 6253.9292; val_edge_recon_loss: 275889.5625; val_cond_contrastive_loss: 78400.0547; val_gene_expr_recon_loss: 95204.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455748.5000; val_optim_loss: 455748.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9256; val_auprc_score: 0.9140; val_best_acc_score: 0.8526; val_best_f1_score: 0.8642; train_kl_reg_loss: 6218.7850; train_edge_recon_loss: 271628.9241; train_cond_contrastive_loss: 78897.8337; train_gene_expr_recon_loss: 94390.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451136.1607; train_optim_loss: 451136.1607; val_kl_reg_loss: 6054.7236; val_edge_recon_loss: 270202.1562; val_cond_contrastive_loss: 78417.4844; val_gene_expr_recon_loss: 94822.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449496.9375; val_optim_loss: 449496.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9461; val_auprc_score: 0.9329; val_best_acc_score: 0.8806; val_best_f1_score: 0.8860; train_kl_reg_loss: 6075.9203; train_edge_recon_loss: 269834.5580; train_cond_contrastive_loss: 78795.1228; train_gene_expr_recon_loss: 93972.3371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448677.9375; train_optim_loss: 448677.9375; val_kl_reg_loss: 6120.7778; val_edge_recon_loss: 268780.4375; val_cond_contrastive_loss: 78422.2422; val_gene_expr_recon_loss: 94425.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447748.7188; val_optim_loss: 447748.7188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9537; val_auprc_score: 0.9442; val_best_acc_score: 0.8926; val_best_f1_score: 0.8970; train_kl_reg_loss: 6284.8025; train_edge_recon_loss: 267871.6920; train_cond_contrastive_loss: 78702.8895; train_gene_expr_recon_loss: 93550.2478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446409.6295; train_optim_loss: 446409.6295; val_kl_reg_loss: 6299.3125; val_edge_recon_loss: 268882.1875; val_cond_contrastive_loss: 78419.2891; val_gene_expr_recon_loss: 94017.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447618.4062; val_optim_loss: 447618.4062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9653; val_auprc_score: 0.9567; val_best_acc_score: 0.9127; val_best_f1_score: 0.9147; train_kl_reg_loss: 6348.9368; train_edge_recon_loss: 266655.0580; train_cond_contrastive_loss: 78702.5279; train_gene_expr_recon_loss: 93378.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445084.7455; train_optim_loss: 445084.7455; val_kl_reg_loss: 6152.9180; val_edge_recon_loss: 265937.3438; val_cond_contrastive_loss: 78418.7656; val_gene_expr_recon_loss: 93618.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444127.1562; val_optim_loss: 444127.1562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9713; val_auprc_score: 0.9614; val_best_acc_score: 0.9245; val_best_f1_score: 0.9272; train_kl_reg_loss: 6191.4972; train_edge_recon_loss: 264713.5223; train_cond_contrastive_loss: 78765.0547; train_gene_expr_recon_loss: 92820.9051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442490.9732; train_optim_loss: 442490.9732; val_kl_reg_loss: 6062.5078; val_edge_recon_loss: 264583.9688; val_cond_contrastive_loss: 78418.2266; val_gene_expr_recon_loss: 93275.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442339.7500; val_optim_loss: 442339.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9781; val_auprc_score: 0.9720; val_best_acc_score: 0.9336; val_best_f1_score: 0.9357; train_kl_reg_loss: 6141.1037; train_edge_recon_loss: 263640.0670; train_cond_contrastive_loss: 78792.1462; train_gene_expr_recon_loss: 92540.8973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441114.2188; train_optim_loss: 441114.2188; val_kl_reg_loss: 6022.6479; val_edge_recon_loss: 260072.3750; val_cond_contrastive_loss: 78416.5156; val_gene_expr_recon_loss: 92975.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437487.2188; val_optim_loss: 437487.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9797; val_auprc_score: 0.9743; val_best_acc_score: 0.9359; val_best_f1_score: 0.9377; train_kl_reg_loss: 6082.1392; train_edge_recon_loss: 263189.4196; train_cond_contrastive_loss: 78814.1864; train_gene_expr_recon_loss: 92311.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440397.6295; train_optim_loss: 440397.6295; val_kl_reg_loss: 5969.4717; val_edge_recon_loss: 262591.1250; val_cond_contrastive_loss: 78411.1406; val_gene_expr_recon_loss: 92683.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439655.6875; val_optim_loss: 439655.6875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9832; val_auprc_score: 0.9778; val_best_acc_score: 0.9438; val_best_f1_score: 0.9448; train_kl_reg_loss: 6016.8424; train_edge_recon_loss: 262563.1228; train_cond_contrastive_loss: 78813.6451; train_gene_expr_recon_loss: 91689.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439083.1652; train_optim_loss: 439083.1652; val_kl_reg_loss: 5933.6553; val_edge_recon_loss: 263028.0000; val_cond_contrastive_loss: 78407.1875; val_gene_expr_recon_loss: 92460.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439829.7500; val_optim_loss: 439829.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9824; val_auprc_score: 0.9757; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 5987.3195; train_edge_recon_loss: 262101.2612; train_cond_contrastive_loss: 78786.6004; train_gene_expr_recon_loss: 91677.5580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438552.7500; train_optim_loss: 438552.7500; val_kl_reg_loss: 5873.0078; val_edge_recon_loss: 262090.9531; val_cond_contrastive_loss: 78406.3516; val_gene_expr_recon_loss: 92200.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438570.7500; val_optim_loss: 438570.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9860; val_auprc_score: 0.9832; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 5941.9324; train_edge_recon_loss: 262157.2009; train_cond_contrastive_loss: 78786.5792; train_gene_expr_recon_loss: 91514.7935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438400.5000; train_optim_loss: 438400.5000; val_kl_reg_loss: 5873.2231; val_edge_recon_loss: 260342.7812; val_cond_contrastive_loss: 78406.6641; val_gene_expr_recon_loss: 92159.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436782.2188; val_optim_loss: 436782.2188
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9844; val_auprc_score: 0.9798; val_best_acc_score: 0.9457; val_best_f1_score: 0.9472; train_kl_reg_loss: 5933.1859; train_edge_recon_loss: 261932.8281; train_cond_contrastive_loss: 78781.1574; train_gene_expr_recon_loss: 91601.1830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438248.3571; train_optim_loss: 438248.3571; val_kl_reg_loss: 5855.4072; val_edge_recon_loss: 259861.4688; val_cond_contrastive_loss: 78406.6641; val_gene_expr_recon_loss: 92128.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436251.8125; val_optim_loss: 436251.8125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9837; val_auprc_score: 0.9776; val_best_acc_score: 0.9435; val_best_f1_score: 0.9441; train_kl_reg_loss: 5914.5051; train_edge_recon_loss: 262024.4241; train_cond_contrastive_loss: 78786.6797; train_gene_expr_recon_loss: 91251.8225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437977.4330; train_optim_loss: 437977.4330; val_kl_reg_loss: 5846.6934; val_edge_recon_loss: 263366.6875; val_cond_contrastive_loss: 78405.8203; val_gene_expr_recon_loss: 92093.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439713.0938; val_optim_loss: 439713.0938
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9848; val_auprc_score: 0.9811; val_best_acc_score: 0.9458; val_best_f1_score: 0.9466; train_kl_reg_loss: 5909.1377; train_edge_recon_loss: 261693.9196; train_cond_contrastive_loss: 78783.0000; train_gene_expr_recon_loss: 91514.1194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437900.1830; train_optim_loss: 437900.1830; val_kl_reg_loss: 5833.8135; val_edge_recon_loss: 263753.9375; val_cond_contrastive_loss: 78405.4375; val_gene_expr_recon_loss: 92068.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440061.5938; val_optim_loss: 440061.5938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9850; val_auprc_score: 0.9798; val_best_acc_score: 0.9465; val_best_f1_score: 0.9477; train_kl_reg_loss: 5901.2866; train_edge_recon_loss: 261280.7835; train_cond_contrastive_loss: 78786.9866; train_gene_expr_recon_loss: 91230.9967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437200.0491; train_optim_loss: 437200.0491; val_kl_reg_loss: 5833.0889; val_edge_recon_loss: 263484.7188; val_cond_contrastive_loss: 78404.8828; val_gene_expr_recon_loss: 92036.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439758.8750; val_optim_loss: 439758.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9847; val_auprc_score: 0.9803; val_best_acc_score: 0.9478; val_best_f1_score: 0.9486; train_kl_reg_loss: 5906.3903; train_edge_recon_loss: 261317.1250; train_cond_contrastive_loss: 78782.1217; train_gene_expr_recon_loss: 91220.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437226.1473; train_optim_loss: 437226.1473; val_kl_reg_loss: 5841.5264; val_edge_recon_loss: 261930.2500; val_cond_contrastive_loss: 78404.9141; val_gene_expr_recon_loss: 92033.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438209.9375; val_optim_loss: 438209.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9830; val_auprc_score: 0.9772; val_best_acc_score: 0.9436; val_best_f1_score: 0.9450; train_kl_reg_loss: 5909.7944; train_edge_recon_loss: 261371.6362; train_cond_contrastive_loss: 78781.7801; train_gene_expr_recon_loss: 91539.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437602.9732; train_optim_loss: 437602.9732; val_kl_reg_loss: 5836.5723; val_edge_recon_loss: 262367.6875; val_cond_contrastive_loss: 78404.7656; val_gene_expr_recon_loss: 92030.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438639.7500; val_optim_loss: 438639.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9861; val_auprc_score: 0.9835; val_best_acc_score: 0.9467; val_best_f1_score: 0.9480; train_kl_reg_loss: 5904.5147; train_edge_recon_loss: 261680.2969; train_cond_contrastive_loss: 78782.5257; train_gene_expr_recon_loss: 91275.7243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437643.0625; train_optim_loss: 437643.0625; val_kl_reg_loss: 5831.2583; val_edge_recon_loss: 260486.9375; val_cond_contrastive_loss: 78404.9219; val_gene_expr_recon_loss: 92028.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436751.4688; val_optim_loss: 436751.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 40 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9845
Val AUPRC score: 0.9813
Val best accuracy score: 0.9464
Val best F1 score: 0.9473
Val gene expr MSE score: 1.5650
Duration of model training in run 8: 0 hours, 2 minutes and 45 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7734; val_auprc_score: 0.8033; val_best_acc_score: 0.6843; val_best_f1_score: 0.7207; train_kl_reg_loss: 6231.9008; train_edge_recon_loss: 355783.2465; train_cond_contrastive_loss: 101115.9115; train_gene_expr_recon_loss: 114425.2483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577556.3056; train_optim_loss: 577556.3056; val_kl_reg_loss: 6205.4482; val_edge_recon_loss: 396844.2812; val_cond_contrastive_loss: 78332.3906; val_gene_expr_recon_loss: 99116.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 580498.1875; val_optim_loss: 580498.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7347; val_auprc_score: 0.7554; val_best_acc_score: 0.6547; val_best_f1_score: 0.7165; train_kl_reg_loss: 5582.8734; train_edge_recon_loss: 350438.2674; train_cond_contrastive_loss: 88150.7248; train_gene_expr_recon_loss: 98529.5078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542701.3681; train_optim_loss: 542701.3681; val_kl_reg_loss: 3678.3169; val_edge_recon_loss: 355749.9688; val_cond_contrastive_loss: 78379.8906; val_gene_expr_recon_loss: 97110.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534919.1250; val_optim_loss: 534919.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7549; val_auprc_score: 0.7782; val_best_acc_score: 0.6729; val_best_f1_score: 0.7143; train_kl_reg_loss: 3806.3803; train_edge_recon_loss: 326011.8542; train_cond_contrastive_loss: 84717.3924; train_gene_expr_recon_loss: 97143.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511679.1424; train_optim_loss: 511679.1424; val_kl_reg_loss: 4555.7578; val_edge_recon_loss: 319420.8750; val_cond_contrastive_loss: 78343.3281; val_gene_expr_recon_loss: 96250.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498570.0312; val_optim_loss: 498570.0312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8226; val_auprc_score: 0.8166; val_best_acc_score: 0.7367; val_best_f1_score: 0.7711; train_kl_reg_loss: 5010.6386; train_edge_recon_loss: 305062.0556; train_cond_contrastive_loss: 78899.3802; train_gene_expr_recon_loss: 96219.5686; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485191.6458; train_optim_loss: 485191.6458; val_kl_reg_loss: 5443.4785; val_edge_recon_loss: 291321.6250; val_cond_contrastive_loss: 78353.9766; val_gene_expr_recon_loss: 95441.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470560.1250; val_optim_loss: 470560.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8597; val_auprc_score: 0.8453; val_best_acc_score: 0.7823; val_best_f1_score: 0.8079; train_kl_reg_loss: 5883.9990; train_edge_recon_loss: 285059.5590; train_cond_contrastive_loss: 78731.4314; train_gene_expr_recon_loss: 95472.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465147.5069; train_optim_loss: 465147.5069; val_kl_reg_loss: 6112.4219; val_edge_recon_loss: 276406.8750; val_cond_contrastive_loss: 78355.3594; val_gene_expr_recon_loss: 94581.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455456.1875; val_optim_loss: 455456.1875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8755; val_auprc_score: 0.8579; val_best_acc_score: 0.8005; val_best_f1_score: 0.8212; train_kl_reg_loss: 6063.0954; train_edge_recon_loss: 279680.0208; train_cond_contrastive_loss: 78925.0009; train_gene_expr_recon_loss: 94585.0920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459253.2153; train_optim_loss: 459253.2153; val_kl_reg_loss: 5921.1426; val_edge_recon_loss: 275120.1250; val_cond_contrastive_loss: 78358.6016; val_gene_expr_recon_loss: 93875.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453275.4688; val_optim_loss: 453275.4688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9011; val_auprc_score: 0.8831; val_best_acc_score: 0.8293; val_best_f1_score: 0.8469; train_kl_reg_loss: 6233.0112; train_edge_recon_loss: 275191.5451; train_cond_contrastive_loss: 79007.5764; train_gene_expr_recon_loss: 93969.6311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454401.7639; train_optim_loss: 454401.7639; val_kl_reg_loss: 6336.2002; val_edge_recon_loss: 272276.6875; val_cond_contrastive_loss: 78370.2344; val_gene_expr_recon_loss: 93358.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450341.6875; val_optim_loss: 450341.6875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9282; val_auprc_score: 0.9159; val_best_acc_score: 0.8551; val_best_f1_score: 0.8663; train_kl_reg_loss: 6257.1602; train_edge_recon_loss: 271399.4028; train_cond_contrastive_loss: 78973.1102; train_gene_expr_recon_loss: 93541.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450171.5104; train_optim_loss: 450171.5104; val_kl_reg_loss: 5950.3105; val_edge_recon_loss: 270660.6562; val_cond_contrastive_loss: 78391.4297; val_gene_expr_recon_loss: 92852.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447854.5625; val_optim_loss: 447854.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9485; val_auprc_score: 0.9368; val_best_acc_score: 0.8833; val_best_f1_score: 0.8897; train_kl_reg_loss: 5968.0904; train_edge_recon_loss: 269833.0868; train_cond_contrastive_loss: 78917.8203; train_gene_expr_recon_loss: 93016.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447735.1215; train_optim_loss: 447735.1215; val_kl_reg_loss: 6034.7217; val_edge_recon_loss: 266679.2500; val_cond_contrastive_loss: 78397.5859; val_gene_expr_recon_loss: 92400.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443512.4375; val_optim_loss: 443512.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9571; val_auprc_score: 0.9466; val_best_acc_score: 0.8974; val_best_f1_score: 0.9027; train_kl_reg_loss: 6200.0968; train_edge_recon_loss: 267030.8785; train_cond_contrastive_loss: 78748.1007; train_gene_expr_recon_loss: 92608.8811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444587.9583; train_optim_loss: 444587.9583; val_kl_reg_loss: 6182.1455; val_edge_recon_loss: 265452.3750; val_cond_contrastive_loss: 78392.2656; val_gene_expr_recon_loss: 91949.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441976.1562; val_optim_loss: 441976.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9650; val_auprc_score: 0.9569; val_best_acc_score: 0.9106; val_best_f1_score: 0.9145; train_kl_reg_loss: 6232.4321; train_edge_recon_loss: 266304.9653; train_cond_contrastive_loss: 78749.3550; train_gene_expr_recon_loss: 92133.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443420.5556; train_optim_loss: 443420.5556; val_kl_reg_loss: 6081.6133; val_edge_recon_loss: 265102.0312; val_cond_contrastive_loss: 78389.1797; val_gene_expr_recon_loss: 91534.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441107.4375; val_optim_loss: 441107.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9689; val_auprc_score: 0.9588; val_best_acc_score: 0.9179; val_best_f1_score: 0.9206; train_kl_reg_loss: 6070.8027; train_edge_recon_loss: 265187.2500; train_cond_contrastive_loss: 78817.2127; train_gene_expr_recon_loss: 91811.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441887.2292; train_optim_loss: 441887.2292; val_kl_reg_loss: 5992.1060; val_edge_recon_loss: 265930.6250; val_cond_contrastive_loss: 78391.0078; val_gene_expr_recon_loss: 91162.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441476.0625; val_optim_loss: 441476.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9767; val_auprc_score: 0.9712; val_best_acc_score: 0.9295; val_best_f1_score: 0.9319; train_kl_reg_loss: 5984.5777; train_edge_recon_loss: 264522.6476; train_cond_contrastive_loss: 78832.6380; train_gene_expr_recon_loss: 91402.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440742.7569; train_optim_loss: 440742.7569; val_kl_reg_loss: 5887.6655; val_edge_recon_loss: 263129.7500; val_cond_contrastive_loss: 78394.3438; val_gene_expr_recon_loss: 90826.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438238.0938; val_optim_loss: 438238.0938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9807; val_auprc_score: 0.9768; val_best_acc_score: 0.9391; val_best_f1_score: 0.9403; train_kl_reg_loss: 5895.3400; train_edge_recon_loss: 264339.2188; train_cond_contrastive_loss: 78799.8854; train_gene_expr_recon_loss: 91024.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440058.7604; train_optim_loss: 440058.7604; val_kl_reg_loss: 5796.3486; val_edge_recon_loss: 262681.9375; val_cond_contrastive_loss: 78392.6328; val_gene_expr_recon_loss: 90517.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437388.7500; val_optim_loss: 437388.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9846; val_auprc_score: 0.9803; val_best_acc_score: 0.9445; val_best_f1_score: 0.9458; train_kl_reg_loss: 5844.3258; train_edge_recon_loss: 262247.9045; train_cond_contrastive_loss: 78737.7517; train_gene_expr_recon_loss: 90728.2170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437558.2014; train_optim_loss: 437558.2014; val_kl_reg_loss: 5737.9727; val_edge_recon_loss: 258913.0625; val_cond_contrastive_loss: 78390.4922; val_gene_expr_recon_loss: 90217.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433259.0000; val_optim_loss: 433259.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9869; val_auprc_score: 0.9840; val_best_acc_score: 0.9502; val_best_f1_score: 0.9519; train_kl_reg_loss: 5797.6090; train_edge_recon_loss: 261483.3524; train_cond_contrastive_loss: 78694.4991; train_gene_expr_recon_loss: 90438.8177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436414.2812; train_optim_loss: 436414.2812; val_kl_reg_loss: 5733.2505; val_edge_recon_loss: 259643.2031; val_cond_contrastive_loss: 78389.7266; val_gene_expr_recon_loss: 89893.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433659.5000; val_optim_loss: 433659.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9863; val_auprc_score: 0.9822; val_best_acc_score: 0.9500; val_best_f1_score: 0.9517; train_kl_reg_loss: 5752.4930; train_edge_recon_loss: 260974.9514; train_cond_contrastive_loss: 78683.1918; train_gene_expr_recon_loss: 90216.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435627.4132; train_optim_loss: 435627.4132; val_kl_reg_loss: 5686.7305; val_edge_recon_loss: 259311.5938; val_cond_contrastive_loss: 78386.9609; val_gene_expr_recon_loss: 89616.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433001.3750; val_optim_loss: 433001.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9885; val_auprc_score: 0.9850; val_best_acc_score: 0.9534; val_best_f1_score: 0.9547; train_kl_reg_loss: 5752.3371; train_edge_recon_loss: 259698.0503; train_cond_contrastive_loss: 78679.7326; train_gene_expr_recon_loss: 89869.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433999.1250; train_optim_loss: 433999.1250; val_kl_reg_loss: 5692.6875; val_edge_recon_loss: 256188.5781; val_cond_contrastive_loss: 78382.1484; val_gene_expr_recon_loss: 89364.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429627.7500; val_optim_loss: 429627.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9889; val_auprc_score: 0.9850; val_best_acc_score: 0.9531; val_best_f1_score: 0.9546; train_kl_reg_loss: 5748.7282; train_edge_recon_loss: 259487.4514; train_cond_contrastive_loss: 78683.7682; train_gene_expr_recon_loss: 89640.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433560.2778; train_optim_loss: 433560.2778; val_kl_reg_loss: 5667.5596; val_edge_recon_loss: 257115.4844; val_cond_contrastive_loss: 78378.7969; val_gene_expr_recon_loss: 89096.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430258.3750; val_optim_loss: 430258.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9887; val_auprc_score: 0.9846; val_best_acc_score: 0.9562; val_best_f1_score: 0.9574; train_kl_reg_loss: 5755.2230; train_edge_recon_loss: 260095.4844; train_cond_contrastive_loss: 78676.4184; train_gene_expr_recon_loss: 89356.2509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433883.3785; train_optim_loss: 433883.3785; val_kl_reg_loss: 5656.2046; val_edge_recon_loss: 257372.1406; val_cond_contrastive_loss: 78377.5234; val_gene_expr_recon_loss: 88813.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430218.9375; val_optim_loss: 430218.9375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9858; val_best_acc_score: 0.9556; val_best_f1_score: 0.9576; train_kl_reg_loss: 5739.8919; train_edge_recon_loss: 259525.9392; train_cond_contrastive_loss: 78670.1840; train_gene_expr_recon_loss: 89018.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432954.6458; train_optim_loss: 432954.6458; val_kl_reg_loss: 5668.8506; val_edge_recon_loss: 255218.6562; val_cond_contrastive_loss: 78379.2422; val_gene_expr_recon_loss: 88571.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427838.5625; val_optim_loss: 427838.5625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9897; val_auprc_score: 0.9873; val_best_acc_score: 0.9592; val_best_f1_score: 0.9603; train_kl_reg_loss: 5733.3844; train_edge_recon_loss: 259070.8576; train_cond_contrastive_loss: 78669.8906; train_gene_expr_recon_loss: 88715.6345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432189.7569; train_optim_loss: 432189.7569; val_kl_reg_loss: 5612.2026; val_edge_recon_loss: 256563.7500; val_cond_contrastive_loss: 78379.7266; val_gene_expr_recon_loss: 88327.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428883.6562; val_optim_loss: 428883.6562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9908; val_auprc_score: 0.9872; val_best_acc_score: 0.9636; val_best_f1_score: 0.9647; train_kl_reg_loss: 5741.1864; train_edge_recon_loss: 258055.4722; train_cond_contrastive_loss: 78675.3924; train_gene_expr_recon_loss: 88504.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430976.1944; train_optim_loss: 430976.1944; val_kl_reg_loss: 5596.1133; val_edge_recon_loss: 255487.8906; val_cond_contrastive_loss: 78382.2344; val_gene_expr_recon_loss: 88112.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427578.5625; val_optim_loss: 427578.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9920; val_auprc_score: 0.9900; val_best_acc_score: 0.9633; val_best_f1_score: 0.9644; train_kl_reg_loss: 5708.9421; train_edge_recon_loss: 258107.1788; train_cond_contrastive_loss: 78687.7153; train_gene_expr_recon_loss: 88341.4245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430845.2639; train_optim_loss: 430845.2639; val_kl_reg_loss: 5626.9277; val_edge_recon_loss: 257049.5312; val_cond_contrastive_loss: 78384.2891; val_gene_expr_recon_loss: 87905.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428966.1250; val_optim_loss: 428966.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9914; val_auprc_score: 0.9877; val_best_acc_score: 0.9649; val_best_f1_score: 0.9659; train_kl_reg_loss: 5697.1370; train_edge_recon_loss: 258186.9983; train_cond_contrastive_loss: 78688.2179; train_gene_expr_recon_loss: 88162.1337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430734.4826; train_optim_loss: 430734.4826; val_kl_reg_loss: 5662.5098; val_edge_recon_loss: 256876.7031; val_cond_contrastive_loss: 78386.9688; val_gene_expr_recon_loss: 87690.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428616.8125; val_optim_loss: 428616.8125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9913; val_auprc_score: 0.9871; val_best_acc_score: 0.9660; val_best_f1_score: 0.9668; train_kl_reg_loss: 5707.2364; train_edge_recon_loss: 258832.7066; train_cond_contrastive_loss: 78684.1519; train_gene_expr_recon_loss: 87910.4193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431134.5104; train_optim_loss: 431134.5104; val_kl_reg_loss: 5568.9639; val_edge_recon_loss: 256935.6250; val_cond_contrastive_loss: 78390.0781; val_gene_expr_recon_loss: 87499.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428394.0000; val_optim_loss: 428394.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9923; val_auprc_score: 0.9879; val_best_acc_score: 0.9677; val_best_f1_score: 0.9683; train_kl_reg_loss: 5644.9324; train_edge_recon_loss: 258363.3021; train_cond_contrastive_loss: 78689.9705; train_gene_expr_recon_loss: 87735.8394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430434.0451; train_optim_loss: 430434.0451; val_kl_reg_loss: 5577.7480; val_edge_recon_loss: 257350.9844; val_cond_contrastive_loss: 78390.3047; val_gene_expr_recon_loss: 87443.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428762.2812; val_optim_loss: 428762.2812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9918; val_auprc_score: 0.9885; val_best_acc_score: 0.9648; val_best_f1_score: 0.9655; train_kl_reg_loss: 5671.1275; train_edge_recon_loss: 258264.2726; train_cond_contrastive_loss: 78680.1337; train_gene_expr_recon_loss: 87756.0599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430371.5972; train_optim_loss: 430371.5972; val_kl_reg_loss: 5590.2998; val_edge_recon_loss: 257194.2188; val_cond_contrastive_loss: 78390.5703; val_gene_expr_recon_loss: 87419.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428594.8438; val_optim_loss: 428594.8438
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9661; val_best_f1_score: 0.9669; train_kl_reg_loss: 5671.0336; train_edge_recon_loss: 257932.8351; train_cond_contrastive_loss: 78683.8915; train_gene_expr_recon_loss: 87653.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429940.9688; train_optim_loss: 429940.9688; val_kl_reg_loss: 5588.4668; val_edge_recon_loss: 255562.7500; val_cond_contrastive_loss: 78391.0938; val_gene_expr_recon_loss: 87396.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426939.2188; val_optim_loss: 426939.2188
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9922; val_auprc_score: 0.9894; val_best_acc_score: 0.9659; val_best_f1_score: 0.9669; train_kl_reg_loss: 5667.0090; train_edge_recon_loss: 258295.6059; train_cond_contrastive_loss: 78681.4722; train_gene_expr_recon_loss: 87689.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430333.4062; train_optim_loss: 430333.4062; val_kl_reg_loss: 5579.8125; val_edge_recon_loss: 254397.1562; val_cond_contrastive_loss: 78391.6094; val_gene_expr_recon_loss: 87377.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425745.5938; val_optim_loss: 425745.5938
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9914; val_auprc_score: 0.9874; val_best_acc_score: 0.9630; val_best_f1_score: 0.9639; train_kl_reg_loss: 5658.7325; train_edge_recon_loss: 257791.9271; train_cond_contrastive_loss: 78683.0217; train_gene_expr_recon_loss: 87690.4592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429824.1389; train_optim_loss: 429824.1389; val_kl_reg_loss: 5577.6074; val_edge_recon_loss: 256616.9219; val_cond_contrastive_loss: 78391.5234; val_gene_expr_recon_loss: 87358.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427944.1875; val_optim_loss: 427944.1875
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9922; val_auprc_score: 0.9890; val_best_acc_score: 0.9653; val_best_f1_score: 0.9662; train_kl_reg_loss: 5661.0379; train_edge_recon_loss: 257398.8003; train_cond_contrastive_loss: 78681.8793; train_gene_expr_recon_loss: 87571.5174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429313.2431; train_optim_loss: 429313.2431; val_kl_reg_loss: 5580.2412; val_edge_recon_loss: 255188.9688; val_cond_contrastive_loss: 78391.3125; val_gene_expr_recon_loss: 87337.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426498.2812; val_optim_loss: 426498.2812
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9915; val_auprc_score: 0.9875; val_best_acc_score: 0.9669; val_best_f1_score: 0.9677; train_kl_reg_loss: 5660.6347; train_edge_recon_loss: 257530.4149; train_cond_contrastive_loss: 78681.5486; train_gene_expr_recon_loss: 87584.0477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429456.6562; train_optim_loss: 429456.6562; val_kl_reg_loss: 5582.9277; val_edge_recon_loss: 255653.3438; val_cond_contrastive_loss: 78391.6641; val_gene_expr_recon_loss: 87317.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426945.7812; val_optim_loss: 426945.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9909; val_auprc_score: 0.9850; val_best_acc_score: 0.9644; val_best_f1_score: 0.9649; train_kl_reg_loss: 5660.6839; train_edge_recon_loss: 257698.3733; train_cond_contrastive_loss: 78680.7083; train_gene_expr_recon_loss: 87675.9870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429715.7500; train_optim_loss: 429715.7500; val_kl_reg_loss: 5579.8496; val_edge_recon_loss: 259041.0469; val_cond_contrastive_loss: 78391.2344; val_gene_expr_recon_loss: 87316.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430328.2188; val_optim_loss: 430328.2188
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9920; val_auprc_score: 0.9876; val_best_acc_score: 0.9679; val_best_f1_score: 0.9684; train_kl_reg_loss: 5660.0730; train_edge_recon_loss: 258111.3854; train_cond_contrastive_loss: 78679.7873; train_gene_expr_recon_loss: 87573.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430024.9340; train_optim_loss: 430024.9340; val_kl_reg_loss: 5581.3955; val_edge_recon_loss: 256852.7188; val_cond_contrastive_loss: 78391.4609; val_gene_expr_recon_loss: 87314.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428140.2500; val_optim_loss: 428140.2500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9895; val_best_acc_score: 0.9657; val_best_f1_score: 0.9666; train_kl_reg_loss: 5659.2628; train_edge_recon_loss: 257901.0035; train_cond_contrastive_loss: 78680.9670; train_gene_expr_recon_loss: 87608.3845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429849.6146; train_optim_loss: 429849.6146; val_kl_reg_loss: 5580.0679; val_edge_recon_loss: 255629.8906; val_cond_contrastive_loss: 78391.8672; val_gene_expr_recon_loss: 87312.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426914.5000; val_optim_loss: 426914.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 58 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9907
Val AUPRC score: 0.9843
Val best accuracy score: 0.9639
Val best F1 score: 0.9646
Val gene expr MSE score: 1.2652
Duration of model training in run 9: 0 hours, 5 minutes and 3 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8024; val_auprc_score: 0.8258; val_best_acc_score: 0.7173; val_best_f1_score: 0.7211; train_kl_reg_loss: 7003.6461; train_edge_recon_loss: 357332.5660; train_cond_contrastive_loss: 102008.1458; train_gene_expr_recon_loss: 114745.0208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 581089.3750; train_optim_loss: 581089.3750; val_kl_reg_loss: 8283.9346; val_edge_recon_loss: 403610.5000; val_cond_contrastive_loss: 78334.9062; val_gene_expr_recon_loss: 99700.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 589929.5625; val_optim_loss: 589929.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7676; val_auprc_score: 0.7893; val_best_acc_score: 0.6788; val_best_f1_score: 0.7233; train_kl_reg_loss: 5956.3757; train_edge_recon_loss: 351920.1667; train_cond_contrastive_loss: 87671.4688; train_gene_expr_recon_loss: 98729.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544277.2639; train_optim_loss: 544277.2639; val_kl_reg_loss: 3598.6421; val_edge_recon_loss: 355869.4062; val_cond_contrastive_loss: 78411.6875; val_gene_expr_recon_loss: 97798.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535678.1250; val_optim_loss: 535678.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7714; val_auprc_score: 0.7866; val_best_acc_score: 0.6891; val_best_f1_score: 0.7209; train_kl_reg_loss: 3616.1808; train_edge_recon_loss: 326650.7812; train_cond_contrastive_loss: 85308.2387; train_gene_expr_recon_loss: 97300.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 512876.1111; train_optim_loss: 512876.1111; val_kl_reg_loss: 4566.2715; val_edge_recon_loss: 314459.5312; val_cond_contrastive_loss: 78362.7891; val_gene_expr_recon_loss: 96946.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494335.5625; val_optim_loss: 494335.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8317; val_auprc_score: 0.8259; val_best_acc_score: 0.7436; val_best_f1_score: 0.7735; train_kl_reg_loss: 5589.0909; train_edge_recon_loss: 299122.6354; train_cond_contrastive_loss: 78866.9479; train_gene_expr_recon_loss: 96438.4870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480017.1597; train_optim_loss: 480017.1597; val_kl_reg_loss: 6535.7651; val_edge_recon_loss: 290443.1875; val_cond_contrastive_loss: 78372.0938; val_gene_expr_recon_loss: 96040.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471391.5000; val_optim_loss: 471391.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8712; val_auprc_score: 0.8550; val_best_acc_score: 0.7944; val_best_f1_score: 0.8144; train_kl_reg_loss: 6660.2021; train_edge_recon_loss: 282414.9167; train_cond_contrastive_loss: 78633.1693; train_gene_expr_recon_loss: 95532.3142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463240.5972; train_optim_loss: 463240.5972; val_kl_reg_loss: 6308.0840; val_edge_recon_loss: 278059.4375; val_cond_contrastive_loss: 78374.0234; val_gene_expr_recon_loss: 95190.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457932.4688; val_optim_loss: 457932.4688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8923; val_auprc_score: 0.8726; val_best_acc_score: 0.8221; val_best_f1_score: 0.8403; train_kl_reg_loss: 5974.5224; train_edge_recon_loss: 276547.5868; train_cond_contrastive_loss: 78964.0208; train_gene_expr_recon_loss: 94868.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456354.3368; train_optim_loss: 456354.3368; val_kl_reg_loss: 5748.3374; val_edge_recon_loss: 272913.5000; val_cond_contrastive_loss: 78383.3203; val_gene_expr_recon_loss: 94553.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451598.5625; val_optim_loss: 451598.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9186; val_auprc_score: 0.9018; val_best_acc_score: 0.8501; val_best_f1_score: 0.8622; train_kl_reg_loss: 5814.5953; train_edge_recon_loss: 273510.0382; train_cond_contrastive_loss: 79013.0981; train_gene_expr_recon_loss: 94333.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452671.7014; train_optim_loss: 452671.7014; val_kl_reg_loss: 5776.4585; val_edge_recon_loss: 270170.3438; val_cond_contrastive_loss: 78395.5469; val_gene_expr_recon_loss: 93949.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448291.7500; val_optim_loss: 448291.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9395; val_auprc_score: 0.9269; val_best_acc_score: 0.8710; val_best_f1_score: 0.8769; train_kl_reg_loss: 5755.1927; train_edge_recon_loss: 270651.3611; train_cond_contrastive_loss: 78879.8958; train_gene_expr_recon_loss: 93732.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449018.9931; train_optim_loss: 449018.9931; val_kl_reg_loss: 5694.5068; val_edge_recon_loss: 268918.8750; val_cond_contrastive_loss: 78408.0625; val_gene_expr_recon_loss: 93454.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446475.9062; val_optim_loss: 446475.9062
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9501; val_auprc_score: 0.9384; val_best_acc_score: 0.8842; val_best_f1_score: 0.8892; train_kl_reg_loss: 5917.2751; train_edge_recon_loss: 268407.4549; train_cond_contrastive_loss: 78742.3116; train_gene_expr_recon_loss: 93248.3741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446315.4097; train_optim_loss: 446315.4097; val_kl_reg_loss: 6000.0498; val_edge_recon_loss: 270026.5938; val_cond_contrastive_loss: 78405.7656; val_gene_expr_recon_loss: 92992.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447424.5000; val_optim_loss: 447424.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9566; val_auprc_score: 0.9451; val_best_acc_score: 0.8978; val_best_f1_score: 0.9019; train_kl_reg_loss: 6076.5324; train_edge_recon_loss: 267687.9965; train_cond_contrastive_loss: 78705.6311; train_gene_expr_recon_loss: 92846.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445316.5729; train_optim_loss: 445316.5729; val_kl_reg_loss: 5994.1821; val_edge_recon_loss: 266593.5000; val_cond_contrastive_loss: 78401.3984; val_gene_expr_recon_loss: 92573.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443562.5312; val_optim_loss: 443562.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9610; val_auprc_score: 0.9507; val_best_acc_score: 0.9035; val_best_f1_score: 0.9061; train_kl_reg_loss: 6009.0162; train_edge_recon_loss: 265897.8333; train_cond_contrastive_loss: 78750.1163; train_gene_expr_recon_loss: 92445.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443102.3438; train_optim_loss: 443102.3438; val_kl_reg_loss: 5924.8237; val_edge_recon_loss: 270440.5000; val_cond_contrastive_loss: 78398.7656; val_gene_expr_recon_loss: 92188.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446952.3438; val_optim_loss: 446952.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9671; val_auprc_score: 0.9598; val_best_acc_score: 0.9137; val_best_f1_score: 0.9163; train_kl_reg_loss: 5937.9104; train_edge_recon_loss: 265151.0000; train_cond_contrastive_loss: 78785.8672; train_gene_expr_recon_loss: 92024.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441899.1076; train_optim_loss: 441899.1076; val_kl_reg_loss: 5824.3320; val_edge_recon_loss: 265798.1250; val_cond_contrastive_loss: 78399.3594; val_gene_expr_recon_loss: 91809.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441831.3125; val_optim_loss: 441831.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9724; val_auprc_score: 0.9657; val_best_acc_score: 0.9233; val_best_f1_score: 0.9259; train_kl_reg_loss: 5819.3289; train_edge_recon_loss: 264945.2118; train_cond_contrastive_loss: 78810.0747; train_gene_expr_recon_loss: 91661.6319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 441236.2500; train_optim_loss: 441236.2500; val_kl_reg_loss: 5689.4971; val_edge_recon_loss: 266316.8438; val_cond_contrastive_loss: 78401.0000; val_gene_expr_recon_loss: 91460.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441867.5000; val_optim_loss: 441867.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9780; val_auprc_score: 0.9727; val_best_acc_score: 0.9306; val_best_f1_score: 0.9318; train_kl_reg_loss: 5746.2967; train_edge_recon_loss: 263511.8142; train_cond_contrastive_loss: 78775.1806; train_gene_expr_recon_loss: 91341.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439374.4653; train_optim_loss: 439374.4653; val_kl_reg_loss: 5668.0225; val_edge_recon_loss: 264684.2500; val_cond_contrastive_loss: 78398.1172; val_gene_expr_recon_loss: 91127.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439878.1875; val_optim_loss: 439878.1875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9819; val_auprc_score: 0.9759; val_best_acc_score: 0.9387; val_best_f1_score: 0.9405; train_kl_reg_loss: 5726.5697; train_edge_recon_loss: 263412.5608; train_cond_contrastive_loss: 78739.6753; train_gene_expr_recon_loss: 90968.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438847.0000; train_optim_loss: 438847.0000; val_kl_reg_loss: 5681.9980; val_edge_recon_loss: 262123.4062; val_cond_contrastive_loss: 78391.7188; val_gene_expr_recon_loss: 90814.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437011.4375; val_optim_loss: 437011.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9846; val_auprc_score: 0.9802; val_best_acc_score: 0.9442; val_best_f1_score: 0.9453; train_kl_reg_loss: 5745.9351; train_edge_recon_loss: 260861.8837; train_cond_contrastive_loss: 78713.3342; train_gene_expr_recon_loss: 90665.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435986.2153; train_optim_loss: 435986.2153; val_kl_reg_loss: 5689.5771; val_edge_recon_loss: 261828.1562; val_cond_contrastive_loss: 78387.0234; val_gene_expr_recon_loss: 90478.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436382.9375; val_optim_loss: 436382.9375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9858; val_auprc_score: 0.9806; val_best_acc_score: 0.9479; val_best_f1_score: 0.9490; train_kl_reg_loss: 5721.6922; train_edge_recon_loss: 260996.9688; train_cond_contrastive_loss: 78713.1675; train_gene_expr_recon_loss: 90334.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435766.6111; train_optim_loss: 435766.6111; val_kl_reg_loss: 5690.3535; val_edge_recon_loss: 262430.5312; val_cond_contrastive_loss: 78384.4453; val_gene_expr_recon_loss: 90168.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436673.7500; val_optim_loss: 436673.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9867; val_auprc_score: 0.9831; val_best_acc_score: 0.9488; val_best_f1_score: 0.9498; train_kl_reg_loss: 5739.4328; train_edge_recon_loss: 259550.7639; train_cond_contrastive_loss: 78702.5399; train_gene_expr_recon_loss: 90189.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434181.7986; train_optim_loss: 434181.7986; val_kl_reg_loss: 5658.3691; val_edge_recon_loss: 263149.1875; val_cond_contrastive_loss: 78383.1562; val_gene_expr_recon_loss: 89874.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437064.9688; val_optim_loss: 437064.9688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9877; val_auprc_score: 0.9847; val_best_acc_score: 0.9517; val_best_f1_score: 0.9533; train_kl_reg_loss: 5726.8332; train_edge_recon_loss: 259161.5139; train_cond_contrastive_loss: 78694.7630; train_gene_expr_recon_loss: 89801.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433384.5903; train_optim_loss: 433384.5903; val_kl_reg_loss: 5660.9546; val_edge_recon_loss: 258122.2969; val_cond_contrastive_loss: 78382.3594; val_gene_expr_recon_loss: 89601.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431767.1875; val_optim_loss: 431767.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9887; val_auprc_score: 0.9837; val_best_acc_score: 0.9545; val_best_f1_score: 0.9554; train_kl_reg_loss: 5723.2525; train_edge_recon_loss: 259549.2083; train_cond_contrastive_loss: 78705.3767; train_gene_expr_recon_loss: 89473.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433451.4931; train_optim_loss: 433451.4931; val_kl_reg_loss: 5649.9248; val_edge_recon_loss: 260036.2969; val_cond_contrastive_loss: 78382.4062; val_gene_expr_recon_loss: 89301.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433370.6250; val_optim_loss: 433370.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9882; val_auprc_score: 0.9823; val_best_acc_score: 0.9555; val_best_f1_score: 0.9566; train_kl_reg_loss: 5711.0431; train_edge_recon_loss: 258501.8993; train_cond_contrastive_loss: 78702.7734; train_gene_expr_recon_loss: 89134.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432049.9826; train_optim_loss: 432049.9826; val_kl_reg_loss: 5649.8555; val_edge_recon_loss: 258375.1719; val_cond_contrastive_loss: 78384.0469; val_gene_expr_recon_loss: 89055.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431464.6250; val_optim_loss: 431464.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9898; val_auprc_score: 0.9851; val_best_acc_score: 0.9591; val_best_f1_score: 0.9598; train_kl_reg_loss: 5726.7674; train_edge_recon_loss: 258390.2500; train_cond_contrastive_loss: 78705.9948; train_gene_expr_recon_loss: 88898.2005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431721.2188; train_optim_loss: 431721.2188; val_kl_reg_loss: 5622.3330; val_edge_recon_loss: 260310.4062; val_cond_contrastive_loss: 78385.0781; val_gene_expr_recon_loss: 88798.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433116.5312; val_optim_loss: 433116.5312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9910; val_auprc_score: 0.9864; val_best_acc_score: 0.9612; val_best_f1_score: 0.9617; train_kl_reg_loss: 5691.6720; train_edge_recon_loss: 258023.0295; train_cond_contrastive_loss: 78713.3490; train_gene_expr_recon_loss: 88670.7491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431098.8021; train_optim_loss: 431098.8021; val_kl_reg_loss: 5669.0273; val_edge_recon_loss: 260090.6562; val_cond_contrastive_loss: 78388.3438; val_gene_expr_recon_loss: 88565.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432713.4375; val_optim_loss: 432713.4375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9911; val_auprc_score: 0.9868; val_best_acc_score: 0.9630; val_best_f1_score: 0.9637; train_kl_reg_loss: 5717.1778; train_edge_recon_loss: 258309.6215; train_cond_contrastive_loss: 78707.7465; train_gene_expr_recon_loss: 88400.2257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431134.7708; train_optim_loss: 431134.7708; val_kl_reg_loss: 5611.0522; val_edge_recon_loss: 258520.1562; val_cond_contrastive_loss: 78390.4688; val_gene_expr_recon_loss: 88334.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430856.4375; val_optim_loss: 430856.4375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9904; val_auprc_score: 0.9864; val_best_acc_score: 0.9622; val_best_f1_score: 0.9629; train_kl_reg_loss: 5681.9531; train_edge_recon_loss: 257421.9444; train_cond_contrastive_loss: 78710.1207; train_gene_expr_recon_loss: 88082.5538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429896.5729; train_optim_loss: 429896.5729; val_kl_reg_loss: 5649.6123; val_edge_recon_loss: 258826.2031; val_cond_contrastive_loss: 78391.2578; val_gene_expr_recon_loss: 88117.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430984.1562; val_optim_loss: 430984.1562
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9915; val_auprc_score: 0.9887; val_best_acc_score: 0.9640; val_best_f1_score: 0.9643; train_kl_reg_loss: 5716.2356; train_edge_recon_loss: 258212.7865; train_cond_contrastive_loss: 78698.5608; train_gene_expr_recon_loss: 87962.3481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430589.9271; train_optim_loss: 430589.9271; val_kl_reg_loss: 5597.8423; val_edge_recon_loss: 258887.3281; val_cond_contrastive_loss: 78392.5859; val_gene_expr_recon_loss: 87926.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430804.0000; val_optim_loss: 430804.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9927; val_auprc_score: 0.9906; val_best_acc_score: 0.9650; val_best_f1_score: 0.9657; train_kl_reg_loss: 5680.8783; train_edge_recon_loss: 257572.6163; train_cond_contrastive_loss: 78706.5556; train_gene_expr_recon_loss: 87731.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429691.9236; train_optim_loss: 429691.9236; val_kl_reg_loss: 5625.5996; val_edge_recon_loss: 257814.7969; val_cond_contrastive_loss: 78395.9062; val_gene_expr_recon_loss: 87743.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429579.6875; val_optim_loss: 429579.6875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9922; val_auprc_score: 0.9891; val_best_acc_score: 0.9659; val_best_f1_score: 0.9663; train_kl_reg_loss: 5680.9955; train_edge_recon_loss: 256863.8559; train_cond_contrastive_loss: 78724.6441; train_gene_expr_recon_loss: 87547.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428817.1910; train_optim_loss: 428817.1910; val_kl_reg_loss: 5610.5044; val_edge_recon_loss: 258905.0156; val_cond_contrastive_loss: 78396.5781; val_gene_expr_recon_loss: 87558.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430470.2812; val_optim_loss: 430470.2812
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9925; val_auprc_score: 0.9896; val_best_acc_score: 0.9669; val_best_f1_score: 0.9676; train_kl_reg_loss: 5674.6561; train_edge_recon_loss: 257712.8455; train_cond_contrastive_loss: 78736.7795; train_gene_expr_recon_loss: 87442.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429567.0486; train_optim_loss: 429567.0486; val_kl_reg_loss: 5591.7798; val_edge_recon_loss: 256753.8906; val_cond_contrastive_loss: 78398.1016; val_gene_expr_recon_loss: 87378.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428122.3125; val_optim_loss: 428122.3125
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9928; val_auprc_score: 0.9896; val_best_acc_score: 0.9663; val_best_f1_score: 0.9667; train_kl_reg_loss: 5668.0505; train_edge_recon_loss: 257758.1510; train_cond_contrastive_loss: 78727.5260; train_gene_expr_recon_loss: 87169.9696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429323.6979; train_optim_loss: 429323.6979; val_kl_reg_loss: 5632.3682; val_edge_recon_loss: 259273.7656; val_cond_contrastive_loss: 78398.6953; val_gene_expr_recon_loss: 87210.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430514.9375; val_optim_loss: 430514.9375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9929; val_auprc_score: 0.9893; val_best_acc_score: 0.9667; val_best_f1_score: 0.9674; train_kl_reg_loss: 5666.1380; train_edge_recon_loss: 257399.6892; train_cond_contrastive_loss: 78724.6467; train_gene_expr_recon_loss: 87052.0087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428842.4861; train_optim_loss: 428842.4861; val_kl_reg_loss: 5577.2651; val_edge_recon_loss: 257921.5781; val_cond_contrastive_loss: 78400.0859; val_gene_expr_recon_loss: 87051.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428950.7500; val_optim_loss: 428950.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9929; val_auprc_score: 0.9900; val_best_acc_score: 0.9685; val_best_f1_score: 0.9689; train_kl_reg_loss: 5668.6604; train_edge_recon_loss: 256684.0660; train_cond_contrastive_loss: 78718.9679; train_gene_expr_recon_loss: 86887.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427959.5104; train_optim_loss: 427959.5104; val_kl_reg_loss: 5560.6055; val_edge_recon_loss: 257057.0938; val_cond_contrastive_loss: 78400.6875; val_gene_expr_recon_loss: 86910.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427928.6875; val_optim_loss: 427928.6875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9916; val_auprc_score: 0.9873; val_best_acc_score: 0.9649; val_best_f1_score: 0.9657; train_kl_reg_loss: 5651.7089; train_edge_recon_loss: 256860.0104; train_cond_contrastive_loss: 78715.3759; train_gene_expr_recon_loss: 86736.6814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427963.7812; train_optim_loss: 427963.7812; val_kl_reg_loss: 5573.7402; val_edge_recon_loss: 256788.0781; val_cond_contrastive_loss: 78400.2656; val_gene_expr_recon_loss: 86761.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427523.3750; val_optim_loss: 427523.3750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9923; val_auprc_score: 0.9876; val_best_acc_score: 0.9657; val_best_f1_score: 0.9658; train_kl_reg_loss: 5650.8799; train_edge_recon_loss: 256552.7674; train_cond_contrastive_loss: 78709.3160; train_gene_expr_recon_loss: 86621.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427534.0625; train_optim_loss: 427534.0625; val_kl_reg_loss: 5568.1748; val_edge_recon_loss: 261111.9219; val_cond_contrastive_loss: 78401.2266; val_gene_expr_recon_loss: 86633.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431714.6562; val_optim_loss: 431714.6562
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9930; val_auprc_score: 0.9905; val_best_acc_score: 0.9677; val_best_f1_score: 0.9681; train_kl_reg_loss: 5659.6829; train_edge_recon_loss: 256364.7517; train_cond_contrastive_loss: 78718.7066; train_gene_expr_recon_loss: 86429.3550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427172.5035; train_optim_loss: 427172.5035; val_kl_reg_loss: 5569.3135; val_edge_recon_loss: 257068.2500; val_cond_contrastive_loss: 78402.9141; val_gene_expr_recon_loss: 86497.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427537.5312; val_optim_loss: 427537.5312
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9933; val_auprc_score: 0.9906; val_best_acc_score: 0.9681; val_best_f1_score: 0.9687; train_kl_reg_loss: 5655.5778; train_edge_recon_loss: 257326.3941; train_cond_contrastive_loss: 78719.5243; train_gene_expr_recon_loss: 86236.1762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427937.6667; train_optim_loss: 427937.6667; val_kl_reg_loss: 5558.8159; val_edge_recon_loss: 256559.0156; val_cond_contrastive_loss: 78403.9062; val_gene_expr_recon_loss: 86355.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426877.3125; val_optim_loss: 426877.3125
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9935; val_auprc_score: 0.9909; val_best_acc_score: 0.9701; val_best_f1_score: 0.9705; train_kl_reg_loss: 5635.9489; train_edge_recon_loss: 256795.1892; train_cond_contrastive_loss: 78729.0825; train_gene_expr_recon_loss: 86164.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427324.6389; train_optim_loss: 427324.6389; val_kl_reg_loss: 5603.3975; val_edge_recon_loss: 257099.0000; val_cond_contrastive_loss: 78406.2109; val_gene_expr_recon_loss: 86253.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427361.9375; val_optim_loss: 427361.9375
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9685; val_best_f1_score: 0.9688; train_kl_reg_loss: 5649.6614; train_edge_recon_loss: 256064.7448; train_cond_contrastive_loss: 78709.8854; train_gene_expr_recon_loss: 86067.2587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426491.5521; train_optim_loss: 426491.5521; val_kl_reg_loss: 5516.8823; val_edge_recon_loss: 257844.1562; val_cond_contrastive_loss: 78405.7578; val_gene_expr_recon_loss: 86139.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427905.9062; val_optim_loss: 427905.9062
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9937; val_auprc_score: 0.9909; val_best_acc_score: 0.9696; val_best_f1_score: 0.9697; train_kl_reg_loss: 5633.4346; train_edge_recon_loss: 256415.0087; train_cond_contrastive_loss: 78710.8012; train_gene_expr_recon_loss: 85983.1241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426742.3715; train_optim_loss: 426742.3715; val_kl_reg_loss: 5581.6162; val_edge_recon_loss: 258603.4844; val_cond_contrastive_loss: 78408.9219; val_gene_expr_recon_loss: 86025.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428619.8750; val_optim_loss: 428619.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9929; val_auprc_score: 0.9896; val_best_acc_score: 0.9693; val_best_f1_score: 0.9699; train_kl_reg_loss: 5647.5739; train_edge_recon_loss: 255864.6580; train_cond_contrastive_loss: 78708.6076; train_gene_expr_recon_loss: 85840.0477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426060.8819; train_optim_loss: 426060.8819; val_kl_reg_loss: 5570.5801; val_edge_recon_loss: 255925.8281; val_cond_contrastive_loss: 78409.2656; val_gene_expr_recon_loss: 85998.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425904.5625; val_optim_loss: 425904.5625
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9935; val_auprc_score: 0.9896; val_best_acc_score: 0.9682; val_best_f1_score: 0.9688; train_kl_reg_loss: 5640.7665; train_edge_recon_loss: 256255.2361; train_cond_contrastive_loss: 78710.7552; train_gene_expr_recon_loss: 85847.6858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426454.4444; train_optim_loss: 426454.4444; val_kl_reg_loss: 5563.1191; val_edge_recon_loss: 255899.9375; val_cond_contrastive_loss: 78409.5156; val_gene_expr_recon_loss: 85974.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425847.4688; val_optim_loss: 425847.4688
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9934; val_auprc_score: 0.9884; val_best_acc_score: 0.9719; val_best_f1_score: 0.9721; train_kl_reg_loss: 5644.6284; train_edge_recon_loss: 256326.7378; train_cond_contrastive_loss: 78709.5512; train_gene_expr_recon_loss: 85797.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426478.8299; train_optim_loss: 426478.8299; val_kl_reg_loss: 5572.9658; val_edge_recon_loss: 256801.6094; val_cond_contrastive_loss: 78409.1250; val_gene_expr_recon_loss: 85959.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426743.4688; val_optim_loss: 426743.4688
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9940; val_auprc_score: 0.9919; val_best_acc_score: 0.9715; val_best_f1_score: 0.9722; train_kl_reg_loss: 5642.4648; train_edge_recon_loss: 256091.1545; train_cond_contrastive_loss: 78714.0243; train_gene_expr_recon_loss: 85721.7882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426169.4340; train_optim_loss: 426169.4340; val_kl_reg_loss: 5563.9746; val_edge_recon_loss: 254397.9062; val_cond_contrastive_loss: 78409.3828; val_gene_expr_recon_loss: 85948.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424319.3750; val_optim_loss: 424319.3750
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9937; val_auprc_score: 0.9921; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 5642.3732; train_edge_recon_loss: 256316.7118; train_cond_contrastive_loss: 78710.4427; train_gene_expr_recon_loss: 85855.5590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426525.0868; train_optim_loss: 426525.0868; val_kl_reg_loss: 5570.7168; val_edge_recon_loss: 257237.4062; val_cond_contrastive_loss: 78408.7266; val_gene_expr_recon_loss: 85934.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427151.6875; val_optim_loss: 427151.6875
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9928; val_auprc_score: 0.9892; val_best_acc_score: 0.9691; val_best_f1_score: 0.9695; train_kl_reg_loss: 5632.0692; train_edge_recon_loss: 256168.4549; train_cond_contrastive_loss: 78719.8142; train_gene_expr_recon_loss: 85808.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426329.2951; train_optim_loss: 426329.2951; val_kl_reg_loss: 5569.4023; val_edge_recon_loss: 258148.2188; val_cond_contrastive_loss: 78408.7188; val_gene_expr_recon_loss: 85924.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428050.4688; val_optim_loss: 428050.4688
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9936; val_auprc_score: 0.9899; val_best_acc_score: 0.9704; val_best_f1_score: 0.9712; train_kl_reg_loss: 5645.6176; train_edge_recon_loss: 255574.8056; train_cond_contrastive_loss: 78714.0747; train_gene_expr_recon_loss: 85786.2092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425720.7118; train_optim_loss: 425720.7118; val_kl_reg_loss: 5560.3164; val_edge_recon_loss: 254205.2812; val_cond_contrastive_loss: 78409.9375; val_gene_expr_recon_loss: 85913.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424088.5938; val_optim_loss: 424088.5938
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9934; val_auprc_score: 0.9907; val_best_acc_score: 0.9686; val_best_f1_score: 0.9691; train_kl_reg_loss: 5632.8605; train_edge_recon_loss: 256348.8993; train_cond_contrastive_loss: 78717.7908; train_gene_expr_recon_loss: 85759.5946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426459.1458; train_optim_loss: 426459.1458; val_kl_reg_loss: 5557.3721; val_edge_recon_loss: 257314.7969; val_cond_contrastive_loss: 78409.6797; val_gene_expr_recon_loss: 85904.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427186.1875; val_optim_loss: 427186.1875
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9937; val_auprc_score: 0.9920; val_best_acc_score: 0.9696; val_best_f1_score: 0.9701; train_kl_reg_loss: 5629.9002; train_edge_recon_loss: 255889.1076; train_cond_contrastive_loss: 78716.9983; train_gene_expr_recon_loss: 85708.1293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425944.1354; train_optim_loss: 425944.1354; val_kl_reg_loss: 5560.2817; val_edge_recon_loss: 257677.7969; val_cond_contrastive_loss: 78409.5703; val_gene_expr_recon_loss: 85893.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427540.7812; val_optim_loss: 427540.7812
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9937; val_auprc_score: 0.9904; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 5632.2123; train_edge_recon_loss: 255712.8628; train_cond_contrastive_loss: 78714.4887; train_gene_expr_recon_loss: 85738.9132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425798.4722; train_optim_loss: 425798.4722; val_kl_reg_loss: 5566.4580; val_edge_recon_loss: 255484.9375; val_cond_contrastive_loss: 78409.8906; val_gene_expr_recon_loss: 85879.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425341.0000; val_optim_loss: 425341.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9939; val_auprc_score: 0.9915; val_best_acc_score: 0.9703; val_best_f1_score: 0.9709; train_kl_reg_loss: 5637.6196; train_edge_recon_loss: 256020.6667; train_cond_contrastive_loss: 78712.5286; train_gene_expr_recon_loss: 85639.2257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426010.0451; train_optim_loss: 426010.0451; val_kl_reg_loss: 5561.4697; val_edge_recon_loss: 256892.5625; val_cond_contrastive_loss: 78410.0078; val_gene_expr_recon_loss: 85879.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426743.4062; val_optim_loss: 426743.4062
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9942; val_auprc_score: 0.9908; val_best_acc_score: 0.9715; val_best_f1_score: 0.9722; train_kl_reg_loss: 5634.1897; train_edge_recon_loss: 256197.0747; train_cond_contrastive_loss: 78715.9106; train_gene_expr_recon_loss: 85687.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426234.4410; train_optim_loss: 426234.4410; val_kl_reg_loss: 5560.0830; val_edge_recon_loss: 254992.5156; val_cond_contrastive_loss: 78409.7578; val_gene_expr_recon_loss: 85878.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424841.2500; val_optim_loss: 424841.2500
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9932; val_auprc_score: 0.9899; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 5630.7218; train_edge_recon_loss: 256855.6510; train_cond_contrastive_loss: 78717.2292; train_gene_expr_recon_loss: 85657.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426860.8715; train_optim_loss: 426860.8715; val_kl_reg_loss: 5559.3647; val_edge_recon_loss: 257871.1875; val_cond_contrastive_loss: 78409.7734; val_gene_expr_recon_loss: 85877.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427717.6875; val_optim_loss: 427717.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 22 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
Val AUROC score: 0.9938
Val AUPRC score: 0.9928
Val best accuracy score: 0.9714
Val best F1 score: 0.9724
Val gene expr MSE score: 1.1631
Duration of model training in run 10: 0 hours, 7 minutes and 28 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
