Run timestamp: 21062023_131955.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-attention_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-attention', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_pos_ratio', '0.', '--contrastive_logits_neg_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6644; val_auprc_score: 0.6830; val_best_acc_score: 0.6484; val_best_f1_score: 0.6396; train_kl_reg_loss: 861.2175; train_edge_recon_loss: 364564.7188; train_gene_expr_recon_loss: 145647.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511073.8438; train_optim_loss: 511073.8438; val_kl_reg_loss: 625.4379; val_edge_recon_loss: 407529.8750; val_gene_expr_recon_loss: 119673.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 527829.0000; val_optim_loss: 527829.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6679; val_auprc_score: 0.6928; val_best_acc_score: 0.6430; val_best_f1_score: 0.6503; train_kl_reg_loss: 653.7730; train_edge_recon_loss: 357133.8594; train_gene_expr_recon_loss: 117218.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475006.0000; train_optim_loss: 475006.0000; val_kl_reg_loss: 720.6905; val_edge_recon_loss: 384353.0625; val_gene_expr_recon_loss: 109208.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494282.0938; val_optim_loss: 494282.0938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6807; val_auprc_score: 0.6839; val_best_acc_score: 0.6567; val_best_f1_score: 0.6431; train_kl_reg_loss: 800.1366; train_edge_recon_loss: 354260.8125; train_gene_expr_recon_loss: 108708.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463769.6875; train_optim_loss: 463769.6875; val_kl_reg_loss: 1058.8544; val_edge_recon_loss: 373025.0312; val_gene_expr_recon_loss: 105263.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479346.9375; val_optim_loss: 479346.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6845; val_auprc_score: 0.6952; val_best_acc_score: 0.6476; val_best_f1_score: 0.6529; train_kl_reg_loss: 1249.9363; train_edge_recon_loss: 344138.3906; train_gene_expr_recon_loss: 105375.9102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450764.2344; train_optim_loss: 450764.2344; val_kl_reg_loss: 1855.5247; val_edge_recon_loss: 362748.1562; val_gene_expr_recon_loss: 103695.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468298.8125; val_optim_loss: 468298.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7052; val_auprc_score: 0.7100; val_best_acc_score: 0.6635; val_best_f1_score: 0.6545; train_kl_reg_loss: 2157.5789; train_edge_recon_loss: 338188.4062; train_gene_expr_recon_loss: 104052.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444398.1562; train_optim_loss: 444398.1562; val_kl_reg_loss: 2921.9968; val_edge_recon_loss: 353693.4375; val_gene_expr_recon_loss: 102885.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459500.9062; val_optim_loss: 459500.9062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7308; val_auprc_score: 0.7330; val_best_acc_score: 0.6709; val_best_f1_score: 0.6766; train_kl_reg_loss: 3268.3809; train_edge_recon_loss: 330391.7656; train_gene_expr_recon_loss: 103553.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437213.3438; train_optim_loss: 437213.3438; val_kl_reg_loss: 4058.5725; val_edge_recon_loss: 338312.2188; val_gene_expr_recon_loss: 102463.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444834.6562; val_optim_loss: 444834.6562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7750; val_auprc_score: 0.7441; val_best_acc_score: 0.7020; val_best_f1_score: 0.6994; train_kl_reg_loss: 4436.7388; train_edge_recon_loss: 318496.4062; train_gene_expr_recon_loss: 103028.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425962.0938; train_optim_loss: 425962.0938; val_kl_reg_loss: 5261.5376; val_edge_recon_loss: 332603.8750; val_gene_expr_recon_loss: 102212.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440078.1875; val_optim_loss: 440078.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8177; val_auprc_score: 0.7874; val_best_acc_score: 0.7355; val_best_f1_score: 0.7447; train_kl_reg_loss: 5661.4033; train_edge_recon_loss: 310096.9688; train_gene_expr_recon_loss: 102783.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418541.6562; train_optim_loss: 418541.6562; val_kl_reg_loss: 6299.2275; val_edge_recon_loss: 312950.6250; val_gene_expr_recon_loss: 101830.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421080.2812; val_optim_loss: 421080.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8476; val_auprc_score: 0.8110; val_best_acc_score: 0.7631; val_best_f1_score: 0.7699; train_kl_reg_loss: 6645.9854; train_edge_recon_loss: 302843.1406; train_gene_expr_recon_loss: 102298.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411787.2656; train_optim_loss: 411787.2656; val_kl_reg_loss: 6986.4854; val_edge_recon_loss: 305067.0625; val_gene_expr_recon_loss: 101339.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413393.5000; val_optim_loss: 413393.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8421; val_auprc_score: 0.7988; val_best_acc_score: 0.7588; val_best_f1_score: 0.7749; train_kl_reg_loss: 7251.3066; train_edge_recon_loss: 294675.4062; train_gene_expr_recon_loss: 101837.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403764.0312; train_optim_loss: 403764.0312; val_kl_reg_loss: 7256.1240; val_edge_recon_loss: 307306.5938; val_gene_expr_recon_loss: 100810.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415372.8750; val_optim_loss: 415372.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8629; val_auprc_score: 0.8187; val_best_acc_score: 0.7830; val_best_f1_score: 0.7905; train_kl_reg_loss: 7421.8625; train_edge_recon_loss: 293853.6406; train_gene_expr_recon_loss: 101301.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402577.2188; train_optim_loss: 402577.2188; val_kl_reg_loss: 7107.0508; val_edge_recon_loss: 303296.9688; val_gene_expr_recon_loss: 100381.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410785.7188; val_optim_loss: 410785.7188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8629; val_auprc_score: 0.8077; val_best_acc_score: 0.7915; val_best_f1_score: 0.8006; train_kl_reg_loss: 7187.7710; train_edge_recon_loss: 291526.9688; train_gene_expr_recon_loss: 100754.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399469.6406; train_optim_loss: 399469.6406; val_kl_reg_loss: 6664.0479; val_edge_recon_loss: 301950.5938; val_gene_expr_recon_loss: 99976.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408591.4062; val_optim_loss: 408591.4062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8741; val_auprc_score: 0.8278; val_best_acc_score: 0.7989; val_best_f1_score: 0.8079; train_kl_reg_loss: 6732.8267; train_edge_recon_loss: 293858.8281; train_gene_expr_recon_loss: 100415.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401007.3594; train_optim_loss: 401007.3594; val_kl_reg_loss: 6168.7295; val_edge_recon_loss: 300324.2812; val_gene_expr_recon_loss: 99571.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406064.1250; val_optim_loss: 406064.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8899; val_auprc_score: 0.8530; val_best_acc_score: 0.8188; val_best_f1_score: 0.8269; train_kl_reg_loss: 6232.4507; train_edge_recon_loss: 291336.3750; train_gene_expr_recon_loss: 99957.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397526.4688; train_optim_loss: 397526.4688; val_kl_reg_loss: 5747.3174; val_edge_recon_loss: 293334.5625; val_gene_expr_recon_loss: 99209.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398291.0625; val_optim_loss: 398291.0625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8999; val_auprc_score: 0.8672; val_best_acc_score: 0.8256; val_best_f1_score: 0.8317; train_kl_reg_loss: 5848.2881; train_edge_recon_loss: 288990.4844; train_gene_expr_recon_loss: 99720.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394559.0781; train_optim_loss: 394559.0781; val_kl_reg_loss: 5486.6865; val_edge_recon_loss: 290613.8438; val_gene_expr_recon_loss: 98921.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395021.8438; val_optim_loss: 395021.8438
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9025; val_auprc_score: 0.8661; val_best_acc_score: 0.8247; val_best_f1_score: 0.8281; train_kl_reg_loss: 5621.2141; train_edge_recon_loss: 288794.1875; train_gene_expr_recon_loss: 99508.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393923.6406; train_optim_loss: 393923.6406; val_kl_reg_loss: 5385.4736; val_edge_recon_loss: 292262.9375; val_gene_expr_recon_loss: 98636.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396284.5938; val_optim_loss: 396284.5938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9080; val_auprc_score: 0.8789; val_best_acc_score: 0.8248; val_best_f1_score: 0.8252; train_kl_reg_loss: 5562.9153; train_edge_recon_loss: 285264.7969; train_gene_expr_recon_loss: 99272.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390100.3438; train_optim_loss: 390100.3438; val_kl_reg_loss: 5435.4058; val_edge_recon_loss: 294695.1562; val_gene_expr_recon_loss: 98391.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398522.0000; val_optim_loss: 398522.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9120; val_auprc_score: 0.8814; val_best_acc_score: 0.8319; val_best_f1_score: 0.8355; train_kl_reg_loss: 5614.9163; train_edge_recon_loss: 287617.6562; train_gene_expr_recon_loss: 98915.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392148.2188; train_optim_loss: 392148.2188; val_kl_reg_loss: 5479.4629; val_edge_recon_loss: 291762.8438; val_gene_expr_recon_loss: 98195.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395438.2500; val_optim_loss: 395438.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9221; val_auprc_score: 0.8910; val_best_acc_score: 0.8461; val_best_f1_score: 0.8380; train_kl_reg_loss: 5647.7114; train_edge_recon_loss: 288447.8906; train_gene_expr_recon_loss: 98715.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392810.8281; train_optim_loss: 392810.8281; val_kl_reg_loss: 5477.4570; val_edge_recon_loss: 297611.1562; val_gene_expr_recon_loss: 98169.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401258.4062; val_optim_loss: 401258.4062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9183; val_auprc_score: 0.8920; val_best_acc_score: 0.8378; val_best_f1_score: 0.8379; train_kl_reg_loss: 5646.8088; train_edge_recon_loss: 290551.3906; train_gene_expr_recon_loss: 98715.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394914.0781; train_optim_loss: 394914.0781; val_kl_reg_loss: 5470.3291; val_edge_recon_loss: 290814.0312; val_gene_expr_recon_loss: 98133.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394417.9062; val_optim_loss: 394417.9062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9161; val_auprc_score: 0.8826; val_best_acc_score: 0.8394; val_best_f1_score: 0.8370; train_kl_reg_loss: 5628.9387; train_edge_recon_loss: 287484.8438; train_gene_expr_recon_loss: 98585.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391698.7969; train_optim_loss: 391698.7969; val_kl_reg_loss: 5451.5078; val_edge_recon_loss: 295556.7188; val_gene_expr_recon_loss: 98092.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399100.3750; val_optim_loss: 399100.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9195; val_auprc_score: 0.8940; val_best_acc_score: 0.8400; val_best_f1_score: 0.8414; train_kl_reg_loss: 5613.8008; train_edge_recon_loss: 284544.2656; train_gene_expr_recon_loss: 98634.4883; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388792.5469; train_optim_loss: 388792.5469; val_kl_reg_loss: 5437.3525; val_edge_recon_loss: 285781.7188; val_gene_expr_recon_loss: 98049.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389268.1250; val_optim_loss: 389268.1250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9120; val_auprc_score: 0.8793; val_best_acc_score: 0.8288; val_best_f1_score: 0.8313; train_kl_reg_loss: 5605.5439; train_edge_recon_loss: 289214.0000; train_gene_expr_recon_loss: 98546.2383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393365.7812; train_optim_loss: 393365.7812; val_kl_reg_loss: 5422.7451; val_edge_recon_loss: 292017.8438; val_gene_expr_recon_loss: 98006.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395447.5000; val_optim_loss: 395447.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9172; val_auprc_score: 0.8912; val_best_acc_score: 0.8355; val_best_f1_score: 0.8344; train_kl_reg_loss: 5588.6113; train_edge_recon_loss: 287697.0469; train_gene_expr_recon_loss: 98518.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391804.5312; train_optim_loss: 391804.5312; val_kl_reg_loss: 5410.8965; val_edge_recon_loss: 289919.4375; val_gene_expr_recon_loss: 97967.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393297.7188; val_optim_loss: 393297.7188
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9177; val_auprc_score: 0.8861; val_best_acc_score: 0.8419; val_best_f1_score: 0.8385; train_kl_reg_loss: 5573.8926; train_edge_recon_loss: 287051.0625; train_gene_expr_recon_loss: 98521.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391146.1875; train_optim_loss: 391146.1875; val_kl_reg_loss: 5401.0278; val_edge_recon_loss: 295806.0938; val_gene_expr_recon_loss: 97930.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399138.1250; val_optim_loss: 399138.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9195; val_auprc_score: 0.8948; val_best_acc_score: 0.8386; val_best_f1_score: 0.8384; train_kl_reg_loss: 5573.1270; train_edge_recon_loss: 286582.0625; train_gene_expr_recon_loss: 98431.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390587.0781; train_optim_loss: 390587.0781; val_kl_reg_loss: 5397.5664; val_edge_recon_loss: 292086.1250; val_gene_expr_recon_loss: 97927.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395411.1250; val_optim_loss: 395411.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9219; val_auprc_score: 0.8965; val_best_acc_score: 0.8359; val_best_f1_score: 0.8380; train_kl_reg_loss: 5569.6289; train_edge_recon_loss: 287203.4688; train_gene_expr_recon_loss: 98401.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391174.7031; train_optim_loss: 391174.7031; val_kl_reg_loss: 5396.4248; val_edge_recon_loss: 291663.3125; val_gene_expr_recon_loss: 97923.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394983.5625; val_optim_loss: 394983.5625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9148; val_auprc_score: 0.8868; val_best_acc_score: 0.8320; val_best_f1_score: 0.8313; train_kl_reg_loss: 5573.2134; train_edge_recon_loss: 287832.7344; train_gene_expr_recon_loss: 98440.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391846.5312; train_optim_loss: 391846.5312; val_kl_reg_loss: 5376.1895; val_edge_recon_loss: 295274.9062; val_gene_expr_recon_loss: 97920.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398571.1875; val_optim_loss: 398571.1875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 56 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9207
Val AUPRC score: 0.8896
Val best accuracy score: 0.8393
Val best F1 score: 0.8374
Val gene expr MSE score: 1.8465
Duration of model training in run 1: 0 hours, 1 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6711; val_auprc_score: 0.6931; val_best_acc_score: 0.6393; val_best_f1_score: 0.6457; train_kl_reg_loss: 872.1423; train_edge_recon_loss: 362274.6406; train_gene_expr_recon_loss: 141149.3828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504296.1875; train_optim_loss: 504296.1875; val_kl_reg_loss: 584.6781; val_edge_recon_loss: 397586.5938; val_gene_expr_recon_loss: 120237.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 518409.1250; val_optim_loss: 518409.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6704; val_auprc_score: 0.6957; val_best_acc_score: 0.6434; val_best_f1_score: 0.6485; train_kl_reg_loss: 614.4258; train_edge_recon_loss: 358334.7344; train_gene_expr_recon_loss: 116328.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475277.6250; train_optim_loss: 475277.6250; val_kl_reg_loss: 724.5481; val_edge_recon_loss: 378255.6250; val_gene_expr_recon_loss: 110894.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489874.8438; val_optim_loss: 489874.8438
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6736; val_auprc_score: 0.7001; val_best_acc_score: 0.6488; val_best_f1_score: 0.6519; train_kl_reg_loss: 809.0069; train_edge_recon_loss: 354136.4062; train_gene_expr_recon_loss: 108635.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463581.2656; train_optim_loss: 463581.2656; val_kl_reg_loss: 1127.7278; val_edge_recon_loss: 363878.7812; val_gene_expr_recon_loss: 107213.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472220.1875; val_optim_loss: 472220.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6914; val_auprc_score: 0.7110; val_best_acc_score: 0.6502; val_best_f1_score: 0.6620; train_kl_reg_loss: 1325.3728; train_edge_recon_loss: 346227.7812; train_gene_expr_recon_loss: 105509.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453062.6250; train_optim_loss: 453062.6250; val_kl_reg_loss: 1959.0095; val_edge_recon_loss: 352727.0938; val_gene_expr_recon_loss: 105644.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460331.0000; val_optim_loss: 460331.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7108; val_auprc_score: 0.7200; val_best_acc_score: 0.6659; val_best_f1_score: 0.6634; train_kl_reg_loss: 2236.5360; train_edge_recon_loss: 339347.6250; train_gene_expr_recon_loss: 104106.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445690.9531; train_optim_loss: 445690.9531; val_kl_reg_loss: 2983.6772; val_edge_recon_loss: 347279.5938; val_gene_expr_recon_loss: 104818.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455082.1250; val_optim_loss: 455082.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7422; val_auprc_score: 0.7477; val_best_acc_score: 0.6757; val_best_f1_score: 0.6882; train_kl_reg_loss: 3287.5306; train_edge_recon_loss: 333471.7344; train_gene_expr_recon_loss: 103287.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440047.1094; train_optim_loss: 440047.1094; val_kl_reg_loss: 4068.4766; val_edge_recon_loss: 331927.5312; val_gene_expr_recon_loss: 104304.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440300.3125; val_optim_loss: 440300.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7882; val_auprc_score: 0.7802; val_best_acc_score: 0.7135; val_best_f1_score: 0.7208; train_kl_reg_loss: 4408.2197; train_edge_recon_loss: 320052.2656; train_gene_expr_recon_loss: 102735.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427196.2500; train_optim_loss: 427196.2500; val_kl_reg_loss: 5227.3525; val_edge_recon_loss: 316817.1562; val_gene_expr_recon_loss: 103966.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426011.2500; val_optim_loss: 426011.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8020; val_auprc_score: 0.7867; val_best_acc_score: 0.7202; val_best_f1_score: 0.7427; train_kl_reg_loss: 5579.1304; train_edge_recon_loss: 310336.9688; train_gene_expr_recon_loss: 102569.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418485.7656; train_optim_loss: 418485.7656; val_kl_reg_loss: 6259.5312; val_edge_recon_loss: 311154.4062; val_gene_expr_recon_loss: 103652.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421066.2812; val_optim_loss: 421066.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8369; val_auprc_score: 0.8073; val_best_acc_score: 0.7520; val_best_f1_score: 0.7665; train_kl_reg_loss: 6544.3389; train_edge_recon_loss: 303608.0938; train_gene_expr_recon_loss: 102029.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412182.0938; train_optim_loss: 412182.0938; val_kl_reg_loss: 6940.1157; val_edge_recon_loss: 302729.6562; val_gene_expr_recon_loss: 103179.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412849.5312; val_optim_loss: 412849.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8372; val_auprc_score: 0.8049; val_best_acc_score: 0.7565; val_best_f1_score: 0.7702; train_kl_reg_loss: 7114.8784; train_edge_recon_loss: 299323.8438; train_gene_expr_recon_loss: 101637.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408076.5000; train_optim_loss: 408076.5000; val_kl_reg_loss: 7166.6748; val_edge_recon_loss: 305579.3750; val_gene_expr_recon_loss: 102692.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415438.1250; val_optim_loss: 415438.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8487; val_auprc_score: 0.8030; val_best_acc_score: 0.7736; val_best_f1_score: 0.7867; train_kl_reg_loss: 7259.8394; train_edge_recon_loss: 295551.5000; train_gene_expr_recon_loss: 101068.1133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403879.4375; train_optim_loss: 403879.4375; val_kl_reg_loss: 7026.9414; val_edge_recon_loss: 301032.5938; val_gene_expr_recon_loss: 102272.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410331.7500; val_optim_loss: 410331.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8661; val_auprc_score: 0.8197; val_best_acc_score: 0.7938; val_best_f1_score: 0.8020; train_kl_reg_loss: 7061.1826; train_edge_recon_loss: 293870.0156; train_gene_expr_recon_loss: 100859.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401791.1250; train_optim_loss: 401791.1250; val_kl_reg_loss: 6629.8071; val_edge_recon_loss: 299745.9375; val_gene_expr_recon_loss: 101885.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408260.7812; val_optim_loss: 408260.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8710; val_auprc_score: 0.8183; val_best_acc_score: 0.7965; val_best_f1_score: 0.8066; train_kl_reg_loss: 6640.1743; train_edge_recon_loss: 292297.5938; train_gene_expr_recon_loss: 100604.4102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399542.1719; train_optim_loss: 399542.1719; val_kl_reg_loss: 6183.5234; val_edge_recon_loss: 296889.0000; val_gene_expr_recon_loss: 101520.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404593.4062; val_optim_loss: 404593.4062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8796; val_auprc_score: 0.8343; val_best_acc_score: 0.8086; val_best_f1_score: 0.8223; train_kl_reg_loss: 6187.4941; train_edge_recon_loss: 290629.4062; train_gene_expr_recon_loss: 99985.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396802.3125; train_optim_loss: 396802.3125; val_kl_reg_loss: 5730.1670; val_edge_recon_loss: 288815.3750; val_gene_expr_recon_loss: 101164.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395709.8750; val_optim_loss: 395709.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8885; val_auprc_score: 0.8496; val_best_acc_score: 0.8113; val_best_f1_score: 0.8238; train_kl_reg_loss: 5754.5474; train_edge_recon_loss: 290495.1719; train_gene_expr_recon_loss: 99588.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395838.4375; train_optim_loss: 395838.4375; val_kl_reg_loss: 5441.9814; val_edge_recon_loss: 290293.1562; val_gene_expr_recon_loss: 100853.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396588.4062; val_optim_loss: 396588.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8894; val_auprc_score: 0.8562; val_best_acc_score: 0.8086; val_best_f1_score: 0.8230; train_kl_reg_loss: 5535.7056; train_edge_recon_loss: 289969.4219; train_gene_expr_recon_loss: 99204.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394709.4375; train_optim_loss: 394709.4375; val_kl_reg_loss: 5413.0322; val_edge_recon_loss: 285329.0312; val_gene_expr_recon_loss: 100579.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391321.2812; val_optim_loss: 391321.2812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8940; val_auprc_score: 0.8637; val_best_acc_score: 0.8142; val_best_f1_score: 0.8272; train_kl_reg_loss: 5552.0845; train_edge_recon_loss: 288650.8125; train_gene_expr_recon_loss: 99290.0430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393492.9375; train_optim_loss: 393492.9375; val_kl_reg_loss: 5512.1826; val_edge_recon_loss: 285660.9688; val_gene_expr_recon_loss: 100325.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391498.6875; val_optim_loss: 391498.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9006; val_auprc_score: 0.8734; val_best_acc_score: 0.8184; val_best_f1_score: 0.8213; train_kl_reg_loss: 5639.7166; train_edge_recon_loss: 288818.3125; train_gene_expr_recon_loss: 98988.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393446.7031; train_optim_loss: 393446.7031; val_kl_reg_loss: 5555.0977; val_edge_recon_loss: 292209.2188; val_gene_expr_recon_loss: 100109.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397873.3125; val_optim_loss: 397873.3125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9056; val_auprc_score: 0.8802; val_best_acc_score: 0.8221; val_best_f1_score: 0.8277; train_kl_reg_loss: 5673.2781; train_edge_recon_loss: 288513.4844; train_gene_expr_recon_loss: 98586.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392773.2188; train_optim_loss: 392773.2188; val_kl_reg_loss: 5537.4546; val_edge_recon_loss: 286352.3125; val_gene_expr_recon_loss: 99905.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391795.6875; val_optim_loss: 391795.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9130; val_auprc_score: 0.8898; val_best_acc_score: 0.8315; val_best_f1_score: 0.8291; train_kl_reg_loss: 5650.2317; train_edge_recon_loss: 288008.5156; train_gene_expr_recon_loss: 98558.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392217.2031; train_optim_loss: 392217.2031; val_kl_reg_loss: 5534.1523; val_edge_recon_loss: 288971.9375; val_gene_expr_recon_loss: 99882.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394388.5938; val_optim_loss: 394388.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9142; val_auprc_score: 0.8928; val_best_acc_score: 0.8319; val_best_f1_score: 0.8402; train_kl_reg_loss: 5651.8108; train_edge_recon_loss: 287227.5781; train_gene_expr_recon_loss: 98560.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391440.0000; train_optim_loss: 391440.0000; val_kl_reg_loss: 5543.3975; val_edge_recon_loss: 281293.6250; val_gene_expr_recon_loss: 99853.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386691.0312; val_optim_loss: 386691.0312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9079; val_auprc_score: 0.8853; val_best_acc_score: 0.8207; val_best_f1_score: 0.8212; train_kl_reg_loss: 5659.0820; train_edge_recon_loss: 287235.0312; train_gene_expr_recon_loss: 98469.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391363.2500; train_optim_loss: 391363.2500; val_kl_reg_loss: 5534.9590; val_edge_recon_loss: 292150.2500; val_gene_expr_recon_loss: 99825.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397510.3750; val_optim_loss: 397510.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9116; val_auprc_score: 0.8876; val_best_acc_score: 0.8284; val_best_f1_score: 0.8295; train_kl_reg_loss: 5662.1504; train_edge_recon_loss: 286505.8750; train_gene_expr_recon_loss: 98427.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390595.0156; train_optim_loss: 390595.0156; val_kl_reg_loss: 5548.5693; val_edge_recon_loss: 292680.4688; val_gene_expr_recon_loss: 99796.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398025.8438; val_optim_loss: 398025.8438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9131; val_auprc_score: 0.8868; val_best_acc_score: 0.8283; val_best_f1_score: 0.8295; train_kl_reg_loss: 5671.8394; train_edge_recon_loss: 288719.6094; train_gene_expr_recon_loss: 98533.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392925.1250; train_optim_loss: 392925.1250; val_kl_reg_loss: 5563.1221; val_edge_recon_loss: 289606.5312; val_gene_expr_recon_loss: 99767.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394937.0625; val_optim_loss: 394937.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9110; val_auprc_score: 0.8881; val_best_acc_score: 0.8256; val_best_f1_score: 0.8292; train_kl_reg_loss: 5677.8503; train_edge_recon_loss: 288090.6250; train_gene_expr_recon_loss: 98436.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392204.7812; train_optim_loss: 392204.7812; val_kl_reg_loss: 5561.6797; val_edge_recon_loss: 287854.6562; val_gene_expr_recon_loss: 99764.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393180.5000; val_optim_loss: 393180.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9125; val_auprc_score: 0.8893; val_best_acc_score: 0.8293; val_best_f1_score: 0.8307; train_kl_reg_loss: 5675.4255; train_edge_recon_loss: 286280.0938; train_gene_expr_recon_loss: 98495.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390451.2188; train_optim_loss: 390451.2188; val_kl_reg_loss: 5545.4868; val_edge_recon_loss: 287583.6875; val_gene_expr_recon_loss: 99760.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392889.7500; val_optim_loss: 392889.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9072; val_auprc_score: 0.8819; val_best_acc_score: 0.8229; val_best_f1_score: 0.8265; train_kl_reg_loss: 5674.6343; train_edge_recon_loss: 286751.5469; train_gene_expr_recon_loss: 98507.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 390933.9531; train_optim_loss: 390933.9531; val_kl_reg_loss: 5544.9180; val_edge_recon_loss: 287457.2812; val_gene_expr_recon_loss: 99756.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392758.7500; val_optim_loss: 392758.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 46 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9138
Val AUPRC score: 0.8911
Val best accuracy score: 0.8299
Val best F1 score: 0.8353
Val gene expr MSE score: 1.8465
Duration of model training in run 2: 0 hours, 0 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7244; val_auprc_score: 0.7725; val_best_acc_score: 0.6667; val_best_f1_score: 0.6920; train_kl_reg_loss: 710.4070; train_edge_recon_loss: 343405.0547; train_gene_expr_recon_loss: 132649.0605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476764.5156; train_optim_loss: 476764.5156; val_kl_reg_loss: 577.3452; val_edge_recon_loss: 374721.6875; val_gene_expr_recon_loss: 108337.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483636.8125; val_optim_loss: 483636.8125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7299; val_auprc_score: 0.7636; val_best_acc_score: 0.6669; val_best_f1_score: 0.6937; train_kl_reg_loss: 638.6244; train_edge_recon_loss: 338393.2266; train_gene_expr_recon_loss: 106160.3223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445192.1719; train_optim_loss: 445192.1719; val_kl_reg_loss: 878.1795; val_edge_recon_loss: 339866.6875; val_gene_expr_recon_loss: 101698.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442442.8750; val_optim_loss: 442442.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7772; val_auprc_score: 0.7921; val_best_acc_score: 0.7004; val_best_f1_score: 0.7204; train_kl_reg_loss: 1462.9956; train_edge_recon_loss: 324744.6406; train_gene_expr_recon_loss: 101989.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428196.7656; train_optim_loss: 428196.7656; val_kl_reg_loss: 2815.3638; val_edge_recon_loss: 312974.3438; val_gene_expr_recon_loss: 100349.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416139.6875; val_optim_loss: 416139.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8243; val_auprc_score: 0.8245; val_best_acc_score: 0.7325; val_best_f1_score: 0.7719; train_kl_reg_loss: 4140.4316; train_edge_recon_loss: 300211.3594; train_gene_expr_recon_loss: 100967.2910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405319.0859; train_optim_loss: 405319.0859; val_kl_reg_loss: 6288.7163; val_edge_recon_loss: 290319.8438; val_gene_expr_recon_loss: 99645.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396254.1562; val_optim_loss: 396254.1562
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8608; val_auprc_score: 0.8466; val_best_acc_score: 0.7767; val_best_f1_score: 0.8020; train_kl_reg_loss: 7464.0698; train_edge_recon_loss: 284381.7031; train_gene_expr_recon_loss: 100512.7051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392358.4844; train_optim_loss: 392358.4844; val_kl_reg_loss: 8617.8545; val_edge_recon_loss: 285435.6875; val_gene_expr_recon_loss: 98875.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392929.0312; val_optim_loss: 392929.0312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8773; val_auprc_score: 0.8553; val_best_acc_score: 0.8051; val_best_f1_score: 0.8230; train_kl_reg_loss: 8963.3879; train_edge_recon_loss: 279222.8125; train_gene_expr_recon_loss: 99724.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387910.3750; train_optim_loss: 387910.3750; val_kl_reg_loss: 8771.4111; val_edge_recon_loss: 282690.5625; val_gene_expr_recon_loss: 97955.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389417.7188; val_optim_loss: 389417.7188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9025; val_auprc_score: 0.8843; val_best_acc_score: 0.8341; val_best_f1_score: 0.8502; train_kl_reg_loss: 8493.6038; train_edge_recon_loss: 276386.2188; train_gene_expr_recon_loss: 98580.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383460.1328; train_optim_loss: 383460.1328; val_kl_reg_loss: 7483.1758; val_edge_recon_loss: 271693.5938; val_gene_expr_recon_loss: 97151.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376328.2500; val_optim_loss: 376328.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9138; val_auprc_score: 0.8958; val_best_acc_score: 0.8404; val_best_f1_score: 0.8535; train_kl_reg_loss: 7005.3339; train_edge_recon_loss: 273448.7891; train_gene_expr_recon_loss: 97709.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 378163.3047; train_optim_loss: 378163.3047; val_kl_reg_loss: 6016.9697; val_edge_recon_loss: 271981.9375; val_gene_expr_recon_loss: 96621.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374620.4688; val_optim_loss: 374620.4688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9323; val_auprc_score: 0.9230; val_best_acc_score: 0.8578; val_best_f1_score: 0.8652; train_kl_reg_loss: 5746.8326; train_edge_recon_loss: 272634.2031; train_gene_expr_recon_loss: 97404.4316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375785.4766; train_optim_loss: 375785.4766; val_kl_reg_loss: 5293.5591; val_edge_recon_loss: 274007.2812; val_gene_expr_recon_loss: 96207.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375508.6562; val_optim_loss: 375508.6562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9406; val_auprc_score: 0.9323; val_best_acc_score: 0.8691; val_best_f1_score: 0.8732; train_kl_reg_loss: 5366.7010; train_edge_recon_loss: 272922.3906; train_gene_expr_recon_loss: 97063.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375352.8516; train_optim_loss: 375352.8516; val_kl_reg_loss: 5363.2949; val_edge_recon_loss: 271311.7812; val_gene_expr_recon_loss: 95823.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372498.9688; val_optim_loss: 372498.9688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9430; val_auprc_score: 0.9348; val_best_acc_score: 0.8758; val_best_f1_score: 0.8805; train_kl_reg_loss: 5607.0168; train_edge_recon_loss: 270677.1328; train_gene_expr_recon_loss: 96827.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373111.4766; train_optim_loss: 373111.4766; val_kl_reg_loss: 5709.3569; val_edge_recon_loss: 272241.2188; val_gene_expr_recon_loss: 95506.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373457.5312; val_optim_loss: 373457.5312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9540; val_auprc_score: 0.9480; val_best_acc_score: 0.8910; val_best_f1_score: 0.8937; train_kl_reg_loss: 5901.0779; train_edge_recon_loss: 269986.0781; train_gene_expr_recon_loss: 96408.7656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372295.9219; train_optim_loss: 372295.9219; val_kl_reg_loss: 5775.7651; val_edge_recon_loss: 268825.0938; val_gene_expr_recon_loss: 95177.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369778.0000; val_optim_loss: 369778.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9565; val_auprc_score: 0.9494; val_best_acc_score: 0.8961; val_best_f1_score: 0.8988; train_kl_reg_loss: 5843.1744; train_edge_recon_loss: 269297.9688; train_gene_expr_recon_loss: 96033.5996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371174.7422; train_optim_loss: 371174.7422; val_kl_reg_loss: 5660.5234; val_edge_recon_loss: 266877.9062; val_gene_expr_recon_loss: 94872.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367410.5000; val_optim_loss: 367410.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9660; val_auprc_score: 0.9595; val_best_acc_score: 0.9074; val_best_f1_score: 0.9097; train_kl_reg_loss: 5664.2953; train_edge_recon_loss: 267971.3750; train_gene_expr_recon_loss: 95946.9980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369582.6797; train_optim_loss: 369582.6797; val_kl_reg_loss: 5435.9648; val_edge_recon_loss: 264908.2188; val_gene_expr_recon_loss: 94593.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364937.5000; val_optim_loss: 364937.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9661; val_auprc_score: 0.9593; val_best_acc_score: 0.9156; val_best_f1_score: 0.9191; train_kl_reg_loss: 5475.1464; train_edge_recon_loss: 267423.1406; train_gene_expr_recon_loss: 95985.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368884.1641; train_optim_loss: 368884.1641; val_kl_reg_loss: 5313.4023; val_edge_recon_loss: 263786.0625; val_gene_expr_recon_loss: 94336.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363435.9375; val_optim_loss: 363435.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9727; val_auprc_score: 0.9653; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 5381.6311; train_edge_recon_loss: 266321.3594; train_gene_expr_recon_loss: 95410.8691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367113.8594; train_optim_loss: 367113.8594; val_kl_reg_loss: 5305.7959; val_edge_recon_loss: 264314.7812; val_gene_expr_recon_loss: 94087.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363708.0938; val_optim_loss: 363708.0938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9797; val_auprc_score: 0.9763; val_best_acc_score: 0.9279; val_best_f1_score: 0.9302; train_kl_reg_loss: 5376.5972; train_edge_recon_loss: 264664.1406; train_gene_expr_recon_loss: 95148.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365189.0781; train_optim_loss: 365189.0781; val_kl_reg_loss: 5333.4692; val_edge_recon_loss: 261745.4219; val_gene_expr_recon_loss: 93870.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360949.3125; val_optim_loss: 360949.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9803; val_auprc_score: 0.9743; val_best_acc_score: 0.9338; val_best_f1_score: 0.9361; train_kl_reg_loss: 5435.9171; train_edge_recon_loss: 261954.3516; train_gene_expr_recon_loss: 94722.5059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362112.7734; train_optim_loss: 362112.7734; val_kl_reg_loss: 5377.8618; val_edge_recon_loss: 262022.9062; val_gene_expr_recon_loss: 93672.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361073.3125; val_optim_loss: 361073.3125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9799; val_auprc_score: 0.9744; val_best_acc_score: 0.9365; val_best_f1_score: 0.9391; train_kl_reg_loss: 5440.3622; train_edge_recon_loss: 263679.0078; train_gene_expr_recon_loss: 94558.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363678.0234; train_optim_loss: 363678.0234; val_kl_reg_loss: 5383.1685; val_edge_recon_loss: 260848.2500; val_gene_expr_recon_loss: 93457.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359688.5000; val_optim_loss: 359688.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9826; val_auprc_score: 0.9793; val_best_acc_score: 0.9398; val_best_f1_score: 0.9418; train_kl_reg_loss: 5437.7129; train_edge_recon_loss: 263537.9141; train_gene_expr_recon_loss: 94659.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363635.1016; train_optim_loss: 363635.1016; val_kl_reg_loss: 5362.9805; val_edge_recon_loss: 258943.2031; val_gene_expr_recon_loss: 93235.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357541.3438; val_optim_loss: 357541.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9822; val_auprc_score: 0.9776; val_best_acc_score: 0.9384; val_best_f1_score: 0.9404; train_kl_reg_loss: 5460.8179; train_edge_recon_loss: 261864.7031; train_gene_expr_recon_loss: 94130.6816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361456.2031; train_optim_loss: 361456.2031; val_kl_reg_loss: 5412.2358; val_edge_recon_loss: 260906.1562; val_gene_expr_recon_loss: 92996.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359315.0000; val_optim_loss: 359315.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9859; val_auprc_score: 0.9832; val_best_acc_score: 0.9420; val_best_f1_score: 0.9430; train_kl_reg_loss: 5501.5148; train_edge_recon_loss: 261469.9570; train_gene_expr_recon_loss: 93968.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360939.9141; train_optim_loss: 360939.9141; val_kl_reg_loss: 5378.9648; val_edge_recon_loss: 260903.2656; val_gene_expr_recon_loss: 92756.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359038.5000; val_optim_loss: 359038.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9855; val_auprc_score: 0.9788; val_best_acc_score: 0.9463; val_best_f1_score: 0.9473; train_kl_reg_loss: 5442.5547; train_edge_recon_loss: 260913.2969; train_gene_expr_recon_loss: 93640.5371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359996.3984; train_optim_loss: 359996.3984; val_kl_reg_loss: 5304.1162; val_edge_recon_loss: 262772.3750; val_gene_expr_recon_loss: 92530.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360606.5000; val_optim_loss: 360606.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9831; val_auprc_score: 0.9760; val_best_acc_score: 0.9419; val_best_f1_score: 0.9437; train_kl_reg_loss: 5391.3357; train_edge_recon_loss: 262590.7539; train_gene_expr_recon_loss: 93594.4512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361576.5469; train_optim_loss: 361576.5469; val_kl_reg_loss: 5316.7529; val_edge_recon_loss: 260835.1094; val_gene_expr_recon_loss: 92499.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358651.6562; val_optim_loss: 358651.6562
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9820; val_auprc_score: 0.9758; val_best_acc_score: 0.9420; val_best_f1_score: 0.9439; train_kl_reg_loss: 5396.7618; train_edge_recon_loss: 260696.5547; train_gene_expr_recon_loss: 93168.1992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359261.5078; train_optim_loss: 359261.5078; val_kl_reg_loss: 5335.1694; val_edge_recon_loss: 259622.9688; val_gene_expr_recon_loss: 92464.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357422.2188; val_optim_loss: 357422.2188
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9847; val_auprc_score: 0.9788; val_best_acc_score: 0.9459; val_best_f1_score: 0.9467; train_kl_reg_loss: 5426.2136; train_edge_recon_loss: 261702.4492; train_gene_expr_recon_loss: 93830.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360958.6953; train_optim_loss: 360958.6953; val_kl_reg_loss: 5336.8301; val_edge_recon_loss: 263827.7812; val_gene_expr_recon_loss: 92424.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361589.4062; val_optim_loss: 361589.4062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9862; val_auprc_score: 0.9834; val_best_acc_score: 0.9458; val_best_f1_score: 0.9467; train_kl_reg_loss: 5434.6194; train_edge_recon_loss: 262890.5859; train_gene_expr_recon_loss: 93510.1113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361835.3047; train_optim_loss: 361835.3047; val_kl_reg_loss: 5341.1338; val_edge_recon_loss: 264895.9375; val_gene_expr_recon_loss: 92395.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362633.0000; val_optim_loss: 362633.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9825; val_auprc_score: 0.9774; val_best_acc_score: 0.9413; val_best_f1_score: 0.9430; train_kl_reg_loss: 5429.6012; train_edge_recon_loss: 261978.3711; train_gene_expr_recon_loss: 93097.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360505.2031; train_optim_loss: 360505.2031; val_kl_reg_loss: 5341.2930; val_edge_recon_loss: 261798.7969; val_gene_expr_recon_loss: 92371.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359511.1875; val_optim_loss: 359511.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9845; val_auprc_score: 0.9781; val_best_acc_score: 0.9427; val_best_f1_score: 0.9443; train_kl_reg_loss: 5426.3989; train_edge_recon_loss: 263011.4570; train_gene_expr_recon_loss: 93493.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361931.1719; train_optim_loss: 361931.1719; val_kl_reg_loss: 5337.7441; val_edge_recon_loss: 261825.9844; val_gene_expr_recon_loss: 92368.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359531.9375; val_optim_loss: 359531.9375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9858; val_auprc_score: 0.9815; val_best_acc_score: 0.9472; val_best_f1_score: 0.9484; train_kl_reg_loss: 5435.7640; train_edge_recon_loss: 261618.2695; train_gene_expr_recon_loss: 93399.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360453.6094; train_optim_loss: 360453.6094; val_kl_reg_loss: 5335.5811; val_edge_recon_loss: 261736.2500; val_gene_expr_recon_loss: 92365.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359437.0000; val_optim_loss: 359437.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9855; val_auprc_score: 0.9808; val_best_acc_score: 0.9454; val_best_f1_score: 0.9470; train_kl_reg_loss: 5435.9919; train_edge_recon_loss: 261744.2539; train_gene_expr_recon_loss: 93055.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360236.0938; train_optim_loss: 360236.0938; val_kl_reg_loss: 5340.1953; val_edge_recon_loss: 261912.0781; val_gene_expr_recon_loss: 92362.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359614.4688; val_optim_loss: 359614.4688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 39 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9867
Val AUPRC score: 0.9825
Val best accuracy score: 0.9454
Val best F1 score: 0.9471
Val gene expr MSE score: 1.4073
Duration of model training in run 3: 0 hours, 1 minutes and 41 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7329; val_auprc_score: 0.7841; val_best_acc_score: 0.6830; val_best_f1_score: 0.6934; train_kl_reg_loss: 685.2252; train_edge_recon_loss: 345196.3906; train_gene_expr_recon_loss: 130264.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476146.2812; train_optim_loss: 476146.2812; val_kl_reg_loss: 580.7130; val_edge_recon_loss: 366191.7812; val_gene_expr_recon_loss: 110171.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476944.1875; val_optim_loss: 476944.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7490; val_auprc_score: 0.7788; val_best_acc_score: 0.6778; val_best_f1_score: 0.7049; train_kl_reg_loss: 724.4032; train_edge_recon_loss: 336878.6719; train_gene_expr_recon_loss: 105933.5488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443536.6172; train_optim_loss: 443536.6172; val_kl_reg_loss: 1221.0623; val_edge_recon_loss: 324342.0938; val_gene_expr_recon_loss: 104414.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429977.5938; val_optim_loss: 429977.5938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7878; val_auprc_score: 0.8077; val_best_acc_score: 0.7097; val_best_f1_score: 0.7316; train_kl_reg_loss: 2001.3194; train_edge_recon_loss: 320241.4922; train_gene_expr_recon_loss: 102687.3457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424930.1562; train_optim_loss: 424930.1562; val_kl_reg_loss: 3611.2827; val_edge_recon_loss: 304597.6875; val_gene_expr_recon_loss: 102974.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411183.7500; val_optim_loss: 411183.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8478; val_auprc_score: 0.8486; val_best_acc_score: 0.7584; val_best_f1_score: 0.7805; train_kl_reg_loss: 4970.7783; train_edge_recon_loss: 295651.6719; train_gene_expr_recon_loss: 101808.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402431.0547; train_optim_loss: 402431.0547; val_kl_reg_loss: 7016.3721; val_edge_recon_loss: 287588.2812; val_gene_expr_recon_loss: 102270.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396875.5625; val_optim_loss: 396875.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8732; val_auprc_score: 0.8596; val_best_acc_score: 0.7930; val_best_f1_score: 0.8165; train_kl_reg_loss: 7981.2721; train_edge_recon_loss: 282389.7578; train_gene_expr_recon_loss: 100891.3965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391262.4453; train_optim_loss: 391262.4453; val_kl_reg_loss: 8817.7988; val_edge_recon_loss: 277662.7188; val_gene_expr_recon_loss: 101244.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 387724.5312; val_optim_loss: 387724.5312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8899; val_auprc_score: 0.8683; val_best_acc_score: 0.8180; val_best_f1_score: 0.8367; train_kl_reg_loss: 8989.1177; train_edge_recon_loss: 279124.3203; train_gene_expr_recon_loss: 100113.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 388227.0078; train_optim_loss: 388227.0078; val_kl_reg_loss: 8524.4395; val_edge_recon_loss: 271876.6250; val_gene_expr_recon_loss: 100441.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380842.6875; val_optim_loss: 380842.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9057; val_auprc_score: 0.8888; val_best_acc_score: 0.8340; val_best_f1_score: 0.8497; train_kl_reg_loss: 8149.8141; train_edge_recon_loss: 275510.0547; train_gene_expr_recon_loss: 99424.7363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 383084.6016; train_optim_loss: 383084.6016; val_kl_reg_loss: 7081.5859; val_edge_recon_loss: 273269.8438; val_gene_expr_recon_loss: 99737.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380088.5312; val_optim_loss: 380088.5312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9225; val_auprc_score: 0.9090; val_best_acc_score: 0.8488; val_best_f1_score: 0.8607; train_kl_reg_loss: 6677.5353; train_edge_recon_loss: 273588.6953; train_gene_expr_recon_loss: 98838.1055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379104.3359; train_optim_loss: 379104.3359; val_kl_reg_loss: 5797.7036; val_edge_recon_loss: 271512.7812; val_gene_expr_recon_loss: 99246.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376557.3125; val_optim_loss: 376557.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9319; val_auprc_score: 0.9252; val_best_acc_score: 0.8529; val_best_f1_score: 0.8625; train_kl_reg_loss: 5651.6958; train_edge_recon_loss: 272769.3984; train_gene_expr_recon_loss: 97750.6230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376171.7266; train_optim_loss: 376171.7266; val_kl_reg_loss: 5322.5635; val_edge_recon_loss: 270161.3125; val_gene_expr_recon_loss: 98843.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374327.7500; val_optim_loss: 374327.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9421; val_auprc_score: 0.9349; val_best_acc_score: 0.8709; val_best_f1_score: 0.8758; train_kl_reg_loss: 5448.8583; train_edge_recon_loss: 271051.3672; train_gene_expr_recon_loss: 98095.7168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374595.9375; train_optim_loss: 374595.9375; val_kl_reg_loss: 5531.5146; val_edge_recon_loss: 269023.3438; val_gene_expr_recon_loss: 98522.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373077.2500; val_optim_loss: 373077.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9453; val_auprc_score: 0.9371; val_best_acc_score: 0.8761; val_best_f1_score: 0.8831; train_kl_reg_loss: 5727.9276; train_edge_recon_loss: 271442.3359; train_gene_expr_recon_loss: 97591.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374761.4844; train_optim_loss: 374761.4844; val_kl_reg_loss: 5825.4634; val_edge_recon_loss: 265440.3750; val_gene_expr_recon_loss: 98165.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369431.4375; val_optim_loss: 369431.4375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9519; val_auprc_score: 0.9436; val_best_acc_score: 0.8898; val_best_f1_score: 0.8937; train_kl_reg_loss: 5934.9720; train_edge_recon_loss: 269624.0781; train_gene_expr_recon_loss: 97147.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372706.6953; train_optim_loss: 372706.6953; val_kl_reg_loss: 5863.0625; val_edge_recon_loss: 265482.5000; val_gene_expr_recon_loss: 97834.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369179.8438; val_optim_loss: 369179.8438
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9578; val_auprc_score: 0.9512; val_best_acc_score: 0.8988; val_best_f1_score: 0.9011; train_kl_reg_loss: 5899.5732; train_edge_recon_loss: 269916.8281; train_gene_expr_recon_loss: 96689.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 372506.2422; train_optim_loss: 372506.2422; val_kl_reg_loss: 5703.5200; val_edge_recon_loss: 266738.3750; val_gene_expr_recon_loss: 97541.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369983.3438; val_optim_loss: 369983.3438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9623; val_auprc_score: 0.9576; val_best_acc_score: 0.9040; val_best_f1_score: 0.9067; train_kl_reg_loss: 5715.9954; train_edge_recon_loss: 267868.2031; train_gene_expr_recon_loss: 96592.3418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370176.5391; train_optim_loss: 370176.5391; val_kl_reg_loss: 5488.7949; val_edge_recon_loss: 265511.1562; val_gene_expr_recon_loss: 97223.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368223.3438; val_optim_loss: 368223.3438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9710; val_auprc_score: 0.9669; val_best_acc_score: 0.9204; val_best_f1_score: 0.9228; train_kl_reg_loss: 5505.7429; train_edge_recon_loss: 265709.7109; train_gene_expr_recon_loss: 96543.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367759.4141; train_optim_loss: 367759.4141; val_kl_reg_loss: 5306.4824; val_edge_recon_loss: 260815.5000; val_gene_expr_recon_loss: 96955.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363077.4688; val_optim_loss: 363077.4688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9741; val_auprc_score: 0.9687; val_best_acc_score: 0.9296; val_best_f1_score: 0.9324; train_kl_reg_loss: 5379.0590; train_edge_recon_loss: 265128.8984; train_gene_expr_recon_loss: 95992.1113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366500.0625; train_optim_loss: 366500.0625; val_kl_reg_loss: 5298.8149; val_edge_recon_loss: 257487.3906; val_gene_expr_recon_loss: 96712.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359498.2500; val_optim_loss: 359498.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9766; val_auprc_score: 0.9708; val_best_acc_score: 0.9307; val_best_f1_score: 0.9342; train_kl_reg_loss: 5426.1960; train_edge_recon_loss: 264782.3594; train_gene_expr_recon_loss: 96127.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366335.7969; train_optim_loss: 366335.7969; val_kl_reg_loss: 5355.5293; val_edge_recon_loss: 260029.9688; val_gene_expr_recon_loss: 96495.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361880.7500; val_optim_loss: 361880.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9797; val_auprc_score: 0.9752; val_best_acc_score: 0.9405; val_best_f1_score: 0.9425; train_kl_reg_loss: 5445.5525; train_edge_recon_loss: 264060.1016; train_gene_expr_recon_loss: 95955.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365461.5469; train_optim_loss: 365461.5469; val_kl_reg_loss: 5318.9463; val_edge_recon_loss: 258205.6562; val_gene_expr_recon_loss: 96301.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359826.2500; val_optim_loss: 359826.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9766; val_auprc_score: 0.9681; val_best_acc_score: 0.9349; val_best_f1_score: 0.9371; train_kl_reg_loss: 5409.9961; train_edge_recon_loss: 264379.6328; train_gene_expr_recon_loss: 95109.3730; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364899.0078; train_optim_loss: 364899.0078; val_kl_reg_loss: 5308.9751; val_edge_recon_loss: 262018.4062; val_gene_expr_recon_loss: 96122.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363449.8125; val_optim_loss: 363449.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9802; val_auprc_score: 0.9729; val_best_acc_score: 0.9394; val_best_f1_score: 0.9429; train_kl_reg_loss: 5405.2203; train_edge_recon_loss: 263194.4414; train_gene_expr_recon_loss: 95367.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363966.9922; train_optim_loss: 363966.9922; val_kl_reg_loss: 5319.5273; val_edge_recon_loss: 255586.8594; val_gene_expr_recon_loss: 96086.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356992.7188; val_optim_loss: 356992.7188
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9809; val_auprc_score: 0.9764; val_best_acc_score: 0.9426; val_best_f1_score: 0.9450; train_kl_reg_loss: 5426.4535; train_edge_recon_loss: 262221.8242; train_gene_expr_recon_loss: 95616.9980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363265.2656; train_optim_loss: 363265.2656; val_kl_reg_loss: 5333.0879; val_edge_recon_loss: 256426.7812; val_gene_expr_recon_loss: 96043.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357803.4375; val_optim_loss: 357803.4375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9801; val_auprc_score: 0.9749; val_best_acc_score: 0.9391; val_best_f1_score: 0.9407; train_kl_reg_loss: 5443.0624; train_edge_recon_loss: 262049.9453; train_gene_expr_recon_loss: 95103.7988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362596.8047; train_optim_loss: 362596.8047; val_kl_reg_loss: 5342.9922; val_edge_recon_loss: 259483.8125; val_gene_expr_recon_loss: 95999.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360825.9062; val_optim_loss: 360825.9062
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9798; val_auprc_score: 0.9757; val_best_acc_score: 0.9369; val_best_f1_score: 0.9400; train_kl_reg_loss: 5445.8691; train_edge_recon_loss: 261943.4258; train_gene_expr_recon_loss: 94923.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362312.3125; train_optim_loss: 362312.3125; val_kl_reg_loss: 5352.3877; val_edge_recon_loss: 258829.5000; val_gene_expr_recon_loss: 95964.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360145.9375; val_optim_loss: 360145.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9796; val_auprc_score: 0.9741; val_best_acc_score: 0.9397; val_best_f1_score: 0.9414; train_kl_reg_loss: 5449.9203; train_edge_recon_loss: 263442.2617; train_gene_expr_recon_loss: 95057.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363949.8828; train_optim_loss: 363949.8828; val_kl_reg_loss: 5350.1934; val_edge_recon_loss: 261794.5312; val_gene_expr_recon_loss: 95960.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363105.3750; val_optim_loss: 363105.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9791; val_auprc_score: 0.9741; val_best_acc_score: 0.9363; val_best_f1_score: 0.9388; train_kl_reg_loss: 5446.0784; train_edge_recon_loss: 262525.9141; train_gene_expr_recon_loss: 95073.9316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363045.9141; train_optim_loss: 363045.9141; val_kl_reg_loss: 5348.6309; val_edge_recon_loss: 260789.9531; val_gene_expr_recon_loss: 95956.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362095.5000; val_optim_loss: 362095.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9803; val_auprc_score: 0.9740; val_best_acc_score: 0.9396; val_best_f1_score: 0.9416; train_kl_reg_loss: 5456.2567; train_edge_recon_loss: 263061.0625; train_gene_expr_recon_loss: 95274.1035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363791.4141; train_optim_loss: 363791.4141; val_kl_reg_loss: 5336.7646; val_edge_recon_loss: 259354.3594; val_gene_expr_recon_loss: 95952.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360644.0625; val_optim_loss: 360644.0625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 22 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9800
Val AUPRC score: 0.9716
Val best accuracy score: 0.9387
Val best F1 score: 0.9410
Val gene expr MSE score: 1.7062
Duration of model training in run 4: 0 hours, 1 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7889; val_auprc_score: 0.8158; val_best_acc_score: 0.7058; val_best_f1_score: 0.7194; train_kl_reg_loss: 693.0729; train_edge_recon_loss: 342269.8854; train_gene_expr_recon_loss: 121237.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464200.2969; train_optim_loss: 464200.2969; val_kl_reg_loss: 619.6350; val_edge_recon_loss: 361314.2812; val_gene_expr_recon_loss: 102687.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464621.2500; val_optim_loss: 464621.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8181; val_auprc_score: 0.8254; val_best_acc_score: 0.7325; val_best_f1_score: 0.7525; train_kl_reg_loss: 1075.8532; train_edge_recon_loss: 328961.8906; train_gene_expr_recon_loss: 101806.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431844.0729; train_optim_loss: 431844.0729; val_kl_reg_loss: 2537.5803; val_edge_recon_loss: 301801.5312; val_gene_expr_recon_loss: 99670.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404009.4375; val_optim_loss: 404009.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8563; val_auprc_score: 0.8493; val_best_acc_score: 0.7693; val_best_f1_score: 0.7934; train_kl_reg_loss: 4739.6241; train_edge_recon_loss: 292886.6458; train_gene_expr_recon_loss: 99801.2409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397427.5156; train_optim_loss: 397427.5156; val_kl_reg_loss: 7672.5415; val_edge_recon_loss: 284881.7500; val_gene_expr_recon_loss: 98586.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391140.9375; val_optim_loss: 391140.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8893; val_auprc_score: 0.8736; val_best_acc_score: 0.8159; val_best_f1_score: 0.8317; train_kl_reg_loss: 8795.0109; train_edge_recon_loss: 280080.0521; train_gene_expr_recon_loss: 98708.5599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387583.6302; train_optim_loss: 387583.6302; val_kl_reg_loss: 9254.1768; val_edge_recon_loss: 276007.2812; val_gene_expr_recon_loss: 97587.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382848.5625; val_optim_loss: 382848.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9164; val_auprc_score: 0.9028; val_best_acc_score: 0.8451; val_best_f1_score: 0.8578; train_kl_reg_loss: 8690.8682; train_edge_recon_loss: 274974.0000; train_gene_expr_recon_loss: 97815.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381479.9844; train_optim_loss: 381479.9844; val_kl_reg_loss: 7372.1768; val_edge_recon_loss: 270220.1875; val_gene_expr_recon_loss: 96589.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374181.8125; val_optim_loss: 374181.8125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9291; val_auprc_score: 0.9162; val_best_acc_score: 0.8562; val_best_f1_score: 0.8650; train_kl_reg_loss: 6594.5276; train_edge_recon_loss: 271895.7969; train_gene_expr_recon_loss: 96881.7878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375372.1198; train_optim_loss: 375372.1198; val_kl_reg_loss: 5669.3379; val_edge_recon_loss: 272768.8438; val_gene_expr_recon_loss: 96008.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374446.5000; val_optim_loss: 374446.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9421; val_auprc_score: 0.9312; val_best_acc_score: 0.8728; val_best_f1_score: 0.8809; train_kl_reg_loss: 5556.6020; train_edge_recon_loss: 272919.5052; train_gene_expr_recon_loss: 96619.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 375095.2552; train_optim_loss: 375095.2552; val_kl_reg_loss: 5494.4922; val_edge_recon_loss: 270262.4688; val_gene_expr_recon_loss: 95515.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371272.9375; val_optim_loss: 371272.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9518; val_auprc_score: 0.9410; val_best_acc_score: 0.8877; val_best_f1_score: 0.8922; train_kl_reg_loss: 5696.3652; train_edge_recon_loss: 268842.1354; train_gene_expr_recon_loss: 95890.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370428.6667; train_optim_loss: 370428.6667; val_kl_reg_loss: 5794.3154; val_edge_recon_loss: 269543.2500; val_gene_expr_recon_loss: 95023.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370361.2500; val_optim_loss: 370361.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9601; val_auprc_score: 0.9512; val_best_acc_score: 0.9032; val_best_f1_score: 0.9061; train_kl_reg_loss: 5809.3942; train_edge_recon_loss: 268804.7135; train_gene_expr_recon_loss: 95452.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370066.6510; train_optim_loss: 370066.6510; val_kl_reg_loss: 5669.7139; val_edge_recon_loss: 266244.8125; val_gene_expr_recon_loss: 94609.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366524.0000; val_optim_loss: 366524.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9686; val_auprc_score: 0.9612; val_best_acc_score: 0.9178; val_best_f1_score: 0.9189; train_kl_reg_loss: 5579.2153; train_edge_recon_loss: 266766.1250; train_gene_expr_recon_loss: 95101.9128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367447.2552; train_optim_loss: 367447.2552; val_kl_reg_loss: 5381.8193; val_edge_recon_loss: 266119.0312; val_gene_expr_recon_loss: 94228.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365729.1875; val_optim_loss: 365729.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9770; val_auprc_score: 0.9732; val_best_acc_score: 0.9298; val_best_f1_score: 0.9321; train_kl_reg_loss: 5335.6003; train_edge_recon_loss: 266139.5469; train_gene_expr_recon_loss: 94722.4661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366197.6146; train_optim_loss: 366197.6146; val_kl_reg_loss: 5193.7559; val_edge_recon_loss: 261939.3125; val_gene_expr_recon_loss: 93867.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361000.5938; val_optim_loss: 361000.5938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9806; val_auprc_score: 0.9747; val_best_acc_score: 0.9378; val_best_f1_score: 0.9396; train_kl_reg_loss: 5287.9865; train_edge_recon_loss: 262653.5781; train_gene_expr_recon_loss: 94257.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362199.0573; train_optim_loss: 362199.0573; val_kl_reg_loss: 5247.8975; val_edge_recon_loss: 261777.1562; val_gene_expr_recon_loss: 93517.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360542.6250; val_optim_loss: 360542.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9828; val_auprc_score: 0.9776; val_best_acc_score: 0.9421; val_best_f1_score: 0.9441; train_kl_reg_loss: 5323.5111; train_edge_recon_loss: 263390.7135; train_gene_expr_recon_loss: 93948.7487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362662.9792; train_optim_loss: 362662.9792; val_kl_reg_loss: 5220.6377; val_edge_recon_loss: 261037.1719; val_gene_expr_recon_loss: 93204.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359462.1250; val_optim_loss: 359462.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9859; val_auprc_score: 0.9829; val_best_acc_score: 0.9443; val_best_f1_score: 0.9451; train_kl_reg_loss: 5281.3902; train_edge_recon_loss: 261892.3984; train_gene_expr_recon_loss: 93680.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360853.8854; train_optim_loss: 360853.8854; val_kl_reg_loss: 5225.9473; val_edge_recon_loss: 261154.0625; val_gene_expr_recon_loss: 92957.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359337.8438; val_optim_loss: 359337.8438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9857; val_auprc_score: 0.9797; val_best_acc_score: 0.9445; val_best_f1_score: 0.9460; train_kl_reg_loss: 5315.7275; train_edge_recon_loss: 259623.2839; train_gene_expr_recon_loss: 93299.0794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358238.0938; train_optim_loss: 358238.0938; val_kl_reg_loss: 5308.5303; val_edge_recon_loss: 259246.4375; val_gene_expr_recon_loss: 92696.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357251.7188; val_optim_loss: 357251.7188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9851; val_auprc_score: 0.9798; val_best_acc_score: 0.9453; val_best_f1_score: 0.9464; train_kl_reg_loss: 5401.2133; train_edge_recon_loss: 260187.7396; train_gene_expr_recon_loss: 93144.3216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358733.2708; train_optim_loss: 358733.2708; val_kl_reg_loss: 5347.7388; val_edge_recon_loss: 263372.8750; val_gene_expr_recon_loss: 92358.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361079.1250; val_optim_loss: 361079.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9868; val_auprc_score: 0.9840; val_best_acc_score: 0.9479; val_best_f1_score: 0.9491; train_kl_reg_loss: 5407.7017; train_edge_recon_loss: 260849.8125; train_gene_expr_recon_loss: 92928.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359186.2917; train_optim_loss: 359186.2917; val_kl_reg_loss: 5330.2998; val_edge_recon_loss: 263304.7188; val_gene_expr_recon_loss: 92019.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360654.6562; val_optim_loss: 360654.6562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9867; val_auprc_score: 0.9835; val_best_acc_score: 0.9490; val_best_f1_score: 0.9505; train_kl_reg_loss: 5374.0457; train_edge_recon_loss: 260217.4661; train_gene_expr_recon_loss: 92546.8841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358138.3958; train_optim_loss: 358138.3958; val_kl_reg_loss: 5294.7158; val_edge_recon_loss: 257955.0781; val_gene_expr_recon_loss: 91712.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354962.0000; val_optim_loss: 354962.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9882; val_auprc_score: 0.9860; val_best_acc_score: 0.9514; val_best_f1_score: 0.9529; train_kl_reg_loss: 5377.7682; train_edge_recon_loss: 259969.3333; train_gene_expr_recon_loss: 92071.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357418.8646; train_optim_loss: 357418.8646; val_kl_reg_loss: 5267.1343; val_edge_recon_loss: 256506.4062; val_gene_expr_recon_loss: 91436.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353210.1875; val_optim_loss: 353210.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9895; val_auprc_score: 0.9833; val_best_acc_score: 0.9556; val_best_f1_score: 0.9565; train_kl_reg_loss: 5319.5570; train_edge_recon_loss: 259966.3464; train_gene_expr_recon_loss: 91772.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357058.3958; train_optim_loss: 357058.3958; val_kl_reg_loss: 5267.0493; val_edge_recon_loss: 261046.3125; val_gene_expr_recon_loss: 91217.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357530.8750; val_optim_loss: 357530.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9893; val_auprc_score: 0.9873; val_best_acc_score: 0.9547; val_best_f1_score: 0.9559; train_kl_reg_loss: 5373.4636; train_edge_recon_loss: 258598.7188; train_gene_expr_recon_loss: 91499.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355471.7240; train_optim_loss: 355471.7240; val_kl_reg_loss: 5303.8564; val_edge_recon_loss: 259727.5156; val_gene_expr_recon_loss: 90966.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355998.2812; val_optim_loss: 355998.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9894; val_auprc_score: 0.9867; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 5365.0176; train_edge_recon_loss: 259534.2292; train_gene_expr_recon_loss: 91482.7669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356382.0052; train_optim_loss: 356382.0052; val_kl_reg_loss: 5282.1543; val_edge_recon_loss: 260126.9219; val_gene_expr_recon_loss: 90756.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356165.1250; val_optim_loss: 356165.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9899; val_auprc_score: 0.9862; val_best_acc_score: 0.9579; val_best_f1_score: 0.9593; train_kl_reg_loss: 5351.4403; train_edge_recon_loss: 258487.1719; train_gene_expr_recon_loss: 91224.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355063.1250; train_optim_loss: 355063.1250; val_kl_reg_loss: 5269.8955; val_edge_recon_loss: 255840.6562; val_gene_expr_recon_loss: 90692.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351803.5312; val_optim_loss: 351803.5312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9921; val_auprc_score: 0.9904; val_best_acc_score: 0.9600; val_best_f1_score: 0.9608; train_kl_reg_loss: 5346.1459; train_edge_recon_loss: 259770.9505; train_gene_expr_recon_loss: 91129.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356246.1615; train_optim_loss: 356246.1615; val_kl_reg_loss: 5261.3257; val_edge_recon_loss: 256815.5469; val_gene_expr_recon_loss: 90657.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352734.4062; val_optim_loss: 352734.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9909; val_auprc_score: 0.9883; val_best_acc_score: 0.9594; val_best_f1_score: 0.9600; train_kl_reg_loss: 5332.7709; train_edge_recon_loss: 259521.7891; train_gene_expr_recon_loss: 91140.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355995.1510; train_optim_loss: 355995.1510; val_kl_reg_loss: 5248.0117; val_edge_recon_loss: 259229.8438; val_gene_expr_recon_loss: 90638.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355116.4375; val_optim_loss: 355116.4375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9595; val_best_f1_score: 0.9601; train_kl_reg_loss: 5316.9350; train_edge_recon_loss: 259722.0911; train_gene_expr_recon_loss: 91166.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356205.9792; train_optim_loss: 356205.9792; val_kl_reg_loss: 5235.5430; val_edge_recon_loss: 259489.7812; val_gene_expr_recon_loss: 90614.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355339.9062; val_optim_loss: 355339.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9902; val_auprc_score: 0.9861; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 5318.6339; train_edge_recon_loss: 259876.2656; train_gene_expr_recon_loss: 91096.1654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356291.0573; train_optim_loss: 356291.0573; val_kl_reg_loss: 5234.1562; val_edge_recon_loss: 259752.6875; val_gene_expr_recon_loss: 90611.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355598.7500; val_optim_loss: 355598.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9903; val_auprc_score: 0.9862; val_best_acc_score: 0.9599; val_best_f1_score: 0.9606; train_kl_reg_loss: 5318.1012; train_edge_recon_loss: 259611.3854; train_gene_expr_recon_loss: 91032.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355961.6406; train_optim_loss: 355961.6406; val_kl_reg_loss: 5236.2720; val_edge_recon_loss: 259013.2344; val_gene_expr_recon_loss: 90609.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354858.7500; val_optim_loss: 354858.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9907; val_auprc_score: 0.9885; val_best_acc_score: 0.9597; val_best_f1_score: 0.9602; train_kl_reg_loss: 5318.8822; train_edge_recon_loss: 260409.1042; train_gene_expr_recon_loss: 91146.9401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356874.9219; train_optim_loss: 356874.9219; val_kl_reg_loss: 5236.0122; val_edge_recon_loss: 260018.6094; val_gene_expr_recon_loss: 90606.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355861.5938; val_optim_loss: 355861.5938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 17 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9893
Val AUPRC score: 0.9864
Val best accuracy score: 0.9579
Val best F1 score: 0.9585
Val gene expr MSE score: 1.4528
Duration of model training in run 5: 0 hours, 2 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7824; val_auprc_score: 0.8093; val_best_acc_score: 0.7070; val_best_f1_score: 0.7115; train_kl_reg_loss: 654.8144; train_edge_recon_loss: 342903.3802; train_gene_expr_recon_loss: 121018.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464576.6510; train_optim_loss: 464576.6510; val_kl_reg_loss: 588.7670; val_edge_recon_loss: 362645.9062; val_gene_expr_recon_loss: 104139.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467374.4375; val_optim_loss: 467374.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8203; val_auprc_score: 0.8281; val_best_acc_score: 0.7318; val_best_f1_score: 0.7541; train_kl_reg_loss: 1031.0017; train_edge_recon_loss: 328021.8594; train_gene_expr_recon_loss: 101414.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430467.4271; train_optim_loss: 430467.4271; val_kl_reg_loss: 2538.4062; val_edge_recon_loss: 299141.3125; val_gene_expr_recon_loss: 100893.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402573.5625; val_optim_loss: 402573.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8602; val_auprc_score: 0.8507; val_best_acc_score: 0.7706; val_best_f1_score: 0.7964; train_kl_reg_loss: 4841.3831; train_edge_recon_loss: 292259.7604; train_gene_expr_recon_loss: 99405.9596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396507.1094; train_optim_loss: 396507.1094; val_kl_reg_loss: 7914.7437; val_edge_recon_loss: 285682.2812; val_gene_expr_recon_loss: 99786.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393383.3438; val_optim_loss: 393383.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8868; val_auprc_score: 0.8676; val_best_acc_score: 0.8129; val_best_f1_score: 0.8304; train_kl_reg_loss: 9085.8044; train_edge_recon_loss: 279190.2604; train_gene_expr_recon_loss: 98243.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 386519.9792; train_optim_loss: 386519.9792; val_kl_reg_loss: 9558.7891; val_edge_recon_loss: 277418.0625; val_gene_expr_recon_loss: 98608.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385584.9375; val_optim_loss: 385584.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9055; val_auprc_score: 0.8908; val_best_acc_score: 0.8326; val_best_f1_score: 0.8477; train_kl_reg_loss: 9065.5221; train_edge_recon_loss: 273689.8438; train_gene_expr_recon_loss: 96926.4674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379681.8229; train_optim_loss: 379681.8229; val_kl_reg_loss: 7781.3604; val_edge_recon_loss: 275208.0312; val_gene_expr_recon_loss: 97602.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380592.2188; val_optim_loss: 380592.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9259; val_auprc_score: 0.9128; val_best_acc_score: 0.8539; val_best_f1_score: 0.8633; train_kl_reg_loss: 6944.8453; train_edge_recon_loss: 272752.1406; train_gene_expr_recon_loss: 96387.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 376084.0521; train_optim_loss: 376084.0521; val_kl_reg_loss: 5812.7354; val_edge_recon_loss: 271330.9062; val_gene_expr_recon_loss: 96968.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374111.7500; val_optim_loss: 374111.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9431; val_auprc_score: 0.9335; val_best_acc_score: 0.8755; val_best_f1_score: 0.8794; train_kl_reg_loss: 5568.8870; train_edge_recon_loss: 271799.3854; train_gene_expr_recon_loss: 95672.8464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373041.1146; train_optim_loss: 373041.1146; val_kl_reg_loss: 5419.3638; val_edge_recon_loss: 271346.9375; val_gene_expr_recon_loss: 96441.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373207.8438; val_optim_loss: 373207.8438
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9552; val_auprc_score: 0.9459; val_best_acc_score: 0.8944; val_best_f1_score: 0.8960; train_kl_reg_loss: 5609.1896; train_edge_recon_loss: 268757.0573; train_gene_expr_recon_loss: 95317.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369683.8333; train_optim_loss: 369683.8333; val_kl_reg_loss: 5765.2197; val_edge_recon_loss: 269122.2188; val_gene_expr_recon_loss: 96026.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370914.1562; val_optim_loss: 370914.1562
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9604; val_auprc_score: 0.9500; val_best_acc_score: 0.9023; val_best_f1_score: 0.9055; train_kl_reg_loss: 5843.6779; train_edge_recon_loss: 267932.3750; train_gene_expr_recon_loss: 94927.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368703.7135; train_optim_loss: 368703.7135; val_kl_reg_loss: 5727.3862; val_edge_recon_loss: 266993.3125; val_gene_expr_recon_loss: 95599.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368320.5625; val_optim_loss: 368320.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9670; val_auprc_score: 0.9597; val_best_acc_score: 0.9138; val_best_f1_score: 0.9172; train_kl_reg_loss: 5597.9226; train_edge_recon_loss: 267508.7500; train_gene_expr_recon_loss: 94504.7435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367611.4167; train_optim_loss: 367611.4167; val_kl_reg_loss: 5336.6592; val_edge_recon_loss: 264964.8750; val_gene_expr_recon_loss: 95228.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365530.2500; val_optim_loss: 365530.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9739; val_auprc_score: 0.9682; val_best_acc_score: 0.9281; val_best_f1_score: 0.9300; train_kl_reg_loss: 5258.4405; train_edge_recon_loss: 266762.6510; train_gene_expr_recon_loss: 94114.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366135.5833; train_optim_loss: 366135.5833; val_kl_reg_loss: 5144.1318; val_edge_recon_loss: 265449.5000; val_gene_expr_recon_loss: 94905.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365499.5625; val_optim_loss: 365499.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9799; val_auprc_score: 0.9765; val_best_acc_score: 0.9360; val_best_f1_score: 0.9373; train_kl_reg_loss: 5245.7388; train_edge_recon_loss: 264982.9427; train_gene_expr_recon_loss: 93877.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364105.8646; train_optim_loss: 364105.8646; val_kl_reg_loss: 5267.4072; val_edge_recon_loss: 264310.8750; val_gene_expr_recon_loss: 94583.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364162.0938; val_optim_loss: 364162.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9811; val_auprc_score: 0.9744; val_best_acc_score: 0.9412; val_best_f1_score: 0.9426; train_kl_reg_loss: 5337.7917; train_edge_recon_loss: 262894.4062; train_gene_expr_recon_loss: 93565.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361797.3073; train_optim_loss: 361797.3073; val_kl_reg_loss: 5296.1572; val_edge_recon_loss: 261098.6250; val_gene_expr_recon_loss: 94283.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360677.8750; val_optim_loss: 360677.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9857; val_auprc_score: 0.9825; val_best_acc_score: 0.9477; val_best_f1_score: 0.9484; train_kl_reg_loss: 5345.5826; train_edge_recon_loss: 261697.6901; train_gene_expr_recon_loss: 93258.7826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360302.0573; train_optim_loss: 360302.0573; val_kl_reg_loss: 5304.4023; val_edge_recon_loss: 258975.0000; val_gene_expr_recon_loss: 93996.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358276.2500; val_optim_loss: 358276.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9869; val_auprc_score: 0.9835; val_best_acc_score: 0.9507; val_best_f1_score: 0.9520; train_kl_reg_loss: 5371.4116; train_edge_recon_loss: 261562.1458; train_gene_expr_recon_loss: 92709.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359643.3542; train_optim_loss: 359643.3542; val_kl_reg_loss: 5332.5659; val_edge_recon_loss: 258707.1719; val_gene_expr_recon_loss: 93668.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357707.8750; val_optim_loss: 357707.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9862; val_auprc_score: 0.9787; val_best_acc_score: 0.9525; val_best_f1_score: 0.9530; train_kl_reg_loss: 5376.9220; train_edge_recon_loss: 260928.9896; train_gene_expr_recon_loss: 92565.3099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358871.2240; train_optim_loss: 358871.2240; val_kl_reg_loss: 5307.6553; val_edge_recon_loss: 261737.7656; val_gene_expr_recon_loss: 93340.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360385.7500; val_optim_loss: 360385.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9860; val_auprc_score: 0.9822; val_best_acc_score: 0.9497; val_best_f1_score: 0.9513; train_kl_reg_loss: 5349.9036; train_edge_recon_loss: 260308.6797; train_gene_expr_recon_loss: 92125.6979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357784.2812; train_optim_loss: 357784.2812; val_kl_reg_loss: 5323.4141; val_edge_recon_loss: 261544.7969; val_gene_expr_recon_loss: 93011.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359879.9062; val_optim_loss: 359879.9062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9897; val_auprc_score: 0.9836; val_best_acc_score: 0.9564; val_best_f1_score: 0.9571; train_kl_reg_loss: 5384.2497; train_edge_recon_loss: 258917.0833; train_gene_expr_recon_loss: 92094.4518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356395.7865; train_optim_loss: 356395.7865; val_kl_reg_loss: 5318.0234; val_edge_recon_loss: 260120.4531; val_gene_expr_recon_loss: 92695.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358133.6562; val_optim_loss: 358133.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9887; val_auprc_score: 0.9857; val_best_acc_score: 0.9561; val_best_f1_score: 0.9570; train_kl_reg_loss: 5369.2390; train_edge_recon_loss: 260789.5443; train_gene_expr_recon_loss: 91723.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357882.7083; train_optim_loss: 357882.7083; val_kl_reg_loss: 5304.6592; val_edge_recon_loss: 259904.7969; val_gene_expr_recon_loss: 92659.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357869.1562; val_optim_loss: 357869.1562
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9892; val_auprc_score: 0.9852; val_best_acc_score: 0.9558; val_best_f1_score: 0.9568; train_kl_reg_loss: 5359.8275; train_edge_recon_loss: 259349.3828; train_gene_expr_recon_loss: 91766.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356475.2396; train_optim_loss: 356475.2396; val_kl_reg_loss: 5302.4668; val_edge_recon_loss: 258509.3750; val_gene_expr_recon_loss: 92627.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356439.5938; val_optim_loss: 356439.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9891; val_auprc_score: 0.9864; val_best_acc_score: 0.9553; val_best_f1_score: 0.9557; train_kl_reg_loss: 5359.1536; train_edge_recon_loss: 260524.7448; train_gene_expr_recon_loss: 91579.9010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357463.7969; train_optim_loss: 357463.7969; val_kl_reg_loss: 5296.0400; val_edge_recon_loss: 259896.3906; val_gene_expr_recon_loss: 92600.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357793.3125; val_optim_loss: 357793.3125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9897; val_auprc_score: 0.9869; val_best_acc_score: 0.9574; val_best_f1_score: 0.9586; train_kl_reg_loss: 5352.2868; train_edge_recon_loss: 259232.2500; train_gene_expr_recon_loss: 91685.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356270.3021; train_optim_loss: 356270.3021; val_kl_reg_loss: 5286.1113; val_edge_recon_loss: 257416.9062; val_gene_expr_recon_loss: 92569.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355272.9062; val_optim_loss: 355272.9062
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9898; val_auprc_score: 0.9876; val_best_acc_score: 0.9566; val_best_f1_score: 0.9577; train_kl_reg_loss: 5337.9918; train_edge_recon_loss: 260886.2396; train_gene_expr_recon_loss: 91567.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357791.2396; train_optim_loss: 357791.2396; val_kl_reg_loss: 5280.1089; val_edge_recon_loss: 258292.1719; val_gene_expr_recon_loss: 92545.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356117.3438; val_optim_loss: 356117.3438
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9895; val_auprc_score: 0.9871; val_best_acc_score: 0.9558; val_best_f1_score: 0.9570; train_kl_reg_loss: 5334.0741; train_edge_recon_loss: 259953.0677; train_gene_expr_recon_loss: 91722.6302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357009.7708; train_optim_loss: 357009.7708; val_kl_reg_loss: 5271.5938; val_edge_recon_loss: 257987.9531; val_gene_expr_recon_loss: 92516.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355775.6875; val_optim_loss: 355775.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9873; val_auprc_score: 0.9833; val_best_acc_score: 0.9543; val_best_f1_score: 0.9552; train_kl_reg_loss: 5331.7058; train_edge_recon_loss: 260824.2995; train_gene_expr_recon_loss: 91567.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357723.8958; train_optim_loss: 357723.8958; val_kl_reg_loss: 5274.3154; val_edge_recon_loss: 261617.9844; val_gene_expr_recon_loss: 92488.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359380.6875; val_optim_loss: 359380.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9878; val_auprc_score: 0.9825; val_best_acc_score: 0.9551; val_best_f1_score: 0.9559; train_kl_reg_loss: 5331.1437; train_edge_recon_loss: 259856.4036; train_gene_expr_recon_loss: 91521.9180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356709.4635; train_optim_loss: 356709.4635; val_kl_reg_loss: 5265.9453; val_edge_recon_loss: 260416.2656; val_gene_expr_recon_loss: 92485.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358168.1250; val_optim_loss: 358168.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9887; val_auprc_score: 0.9858; val_best_acc_score: 0.9569; val_best_f1_score: 0.9579; train_kl_reg_loss: 5334.8473; train_edge_recon_loss: 258041.8255; train_gene_expr_recon_loss: 91252.5560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354629.2344; train_optim_loss: 354629.2344; val_kl_reg_loss: 5264.6855; val_edge_recon_loss: 258430.8125; val_gene_expr_recon_loss: 92483.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356179.1562; val_optim_loss: 356179.1562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9881; val_auprc_score: 0.9824; val_best_acc_score: 0.9534; val_best_f1_score: 0.9546; train_kl_reg_loss: 5333.4940; train_edge_recon_loss: 260197.6953; train_gene_expr_recon_loss: 91569.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357100.2760; train_optim_loss: 357100.2760; val_kl_reg_loss: 5264.7725; val_edge_recon_loss: 258839.0156; val_gene_expr_recon_loss: 92480.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356584.6875; val_optim_loss: 356584.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 15 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9892
Val AUPRC score: 0.9845
Val best accuracy score: 0.9561
Val best F1 score: 0.9569
Val gene expr MSE score: 1.5200
Duration of model training in run 6: 0 hours, 2 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8034; val_auprc_score: 0.8194; val_best_acc_score: 0.7216; val_best_f1_score: 0.7284; train_kl_reg_loss: 619.7810; train_edge_recon_loss: 340961.0625; train_gene_expr_recon_loss: 118660.5458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460241.3929; train_optim_loss: 460241.3929; val_kl_reg_loss: 739.7228; val_edge_recon_loss: 339586.8750; val_gene_expr_recon_loss: 102886.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443213.2188; val_optim_loss: 443213.2188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8486; val_auprc_score: 0.8454; val_best_acc_score: 0.7550; val_best_f1_score: 0.7807; train_kl_reg_loss: 2248.6490; train_edge_recon_loss: 313134.5670; train_gene_expr_recon_loss: 101301.7801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416684.9955; train_optim_loss: 416684.9955; val_kl_reg_loss: 5339.9790; val_edge_recon_loss: 288244.7500; val_gene_expr_recon_loss: 100004.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393589.5938; val_optim_loss: 393589.5938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8729; val_auprc_score: 0.8624; val_best_acc_score: 0.7873; val_best_f1_score: 0.8084; train_kl_reg_loss: 7767.2431; train_edge_recon_loss: 282372.6116; train_gene_expr_recon_loss: 99176.8549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389316.7054; train_optim_loss: 389316.7054; val_kl_reg_loss: 9509.7539; val_edge_recon_loss: 282681.6250; val_gene_expr_recon_loss: 98588.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390780.2188; val_optim_loss: 390780.2188
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9105; val_auprc_score: 0.8975; val_best_acc_score: 0.8343; val_best_f1_score: 0.8462; train_kl_reg_loss: 9243.9533; train_edge_recon_loss: 275810.5089; train_gene_expr_recon_loss: 97840.4029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382894.8661; train_optim_loss: 382894.8661; val_kl_reg_loss: 7945.9531; val_edge_recon_loss: 272666.6562; val_gene_expr_recon_loss: 97492.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378104.6875; val_optim_loss: 378104.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9356; val_auprc_score: 0.9251; val_best_acc_score: 0.8643; val_best_f1_score: 0.8704; train_kl_reg_loss: 6832.9995; train_edge_recon_loss: 273594.6830; train_gene_expr_recon_loss: 96998.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377426.4911; train_optim_loss: 377426.4911; val_kl_reg_loss: 5490.5649; val_edge_recon_loss: 272483.7500; val_gene_expr_recon_loss: 96734.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374708.7500; val_optim_loss: 374708.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9549; val_auprc_score: 0.9494; val_best_acc_score: 0.8903; val_best_f1_score: 0.8941; train_kl_reg_loss: 5284.2081; train_edge_recon_loss: 269257.3571; train_gene_expr_recon_loss: 96297.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370839.2321; train_optim_loss: 370839.2321; val_kl_reg_loss: 5295.9844; val_edge_recon_loss: 270033.1250; val_gene_expr_recon_loss: 96072.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371401.4375; val_optim_loss: 371401.4375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9644; val_auprc_score: 0.9551; val_best_acc_score: 0.9087; val_best_f1_score: 0.9109; train_kl_reg_loss: 5606.9433; train_edge_recon_loss: 267518.9286; train_gene_expr_recon_loss: 95581.4587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368707.3304; train_optim_loss: 368707.3304; val_kl_reg_loss: 5783.7197; val_edge_recon_loss: 267266.9062; val_gene_expr_recon_loss: 95520.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368571.5938; val_optim_loss: 368571.5938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9685; val_auprc_score: 0.9589; val_best_acc_score: 0.9172; val_best_f1_score: 0.9203; train_kl_reg_loss: 5750.5685; train_edge_recon_loss: 265151.8080; train_gene_expr_recon_loss: 95015.5212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365917.8973; train_optim_loss: 365917.8973; val_kl_reg_loss: 5471.2422; val_edge_recon_loss: 266843.9375; val_gene_expr_recon_loss: 94959.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367275.0000; val_optim_loss: 367275.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9796; val_auprc_score: 0.9750; val_best_acc_score: 0.9355; val_best_f1_score: 0.9366; train_kl_reg_loss: 5365.9389; train_edge_recon_loss: 264816.6205; train_gene_expr_recon_loss: 94434.7790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364617.3348; train_optim_loss: 364617.3348; val_kl_reg_loss: 5208.7168; val_edge_recon_loss: 263210.5938; val_gene_expr_recon_loss: 94439.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362858.3438; val_optim_loss: 362858.3438
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9796; val_best_acc_score: 0.9411; val_best_f1_score: 0.9427; train_kl_reg_loss: 5312.4016; train_edge_recon_loss: 262574.6964; train_gene_expr_recon_loss: 94065.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361952.6696; train_optim_loss: 361952.6696; val_kl_reg_loss: 5331.5586; val_edge_recon_loss: 260263.0000; val_gene_expr_recon_loss: 93984.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359578.7500; val_optim_loss: 359578.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9852; val_auprc_score: 0.9786; val_best_acc_score: 0.9464; val_best_f1_score: 0.9477; train_kl_reg_loss: 5400.6648; train_edge_recon_loss: 260983.6786; train_gene_expr_recon_loss: 93625.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360010.2232; train_optim_loss: 360010.2232; val_kl_reg_loss: 5323.0771; val_edge_recon_loss: 260142.2969; val_gene_expr_recon_loss: 93585.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359051.3438; val_optim_loss: 359051.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9882; val_auprc_score: 0.9849; val_best_acc_score: 0.9509; val_best_f1_score: 0.9523; train_kl_reg_loss: 5354.3168; train_edge_recon_loss: 260861.8862; train_gene_expr_recon_loss: 93377.8069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359594.0045; train_optim_loss: 359594.0045; val_kl_reg_loss: 5283.7612; val_edge_recon_loss: 259267.8906; val_gene_expr_recon_loss: 93217.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357768.6562; val_optim_loss: 357768.6562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9874; val_auprc_score: 0.9830; val_best_acc_score: 0.9514; val_best_f1_score: 0.9517; train_kl_reg_loss: 5375.1692; train_edge_recon_loss: 259304.6741; train_gene_expr_recon_loss: 93050.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357730.0982; train_optim_loss: 357730.0982; val_kl_reg_loss: 5351.5669; val_edge_recon_loss: 262327.0000; val_gene_expr_recon_loss: 92829.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360507.9062; val_optim_loss: 360507.9062
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9887; val_auprc_score: 0.9847; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 5401.7868; train_edge_recon_loss: 260463.9754; train_gene_expr_recon_loss: 92484.0045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358349.7634; train_optim_loss: 358349.7634; val_kl_reg_loss: 5285.1929; val_edge_recon_loss: 261995.1719; val_gene_expr_recon_loss: 92440.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359720.5625; val_optim_loss: 359720.5625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9886; val_auprc_score: 0.9834; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 5342.1335; train_edge_recon_loss: 260160.9196; train_gene_expr_recon_loss: 91926.0837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357429.1429; train_optim_loss: 357429.1429; val_kl_reg_loss: 5291.2231; val_edge_recon_loss: 260200.4375; val_gene_expr_recon_loss: 92104.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357595.9375; val_optim_loss: 357595.9375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9897; val_auprc_score: 0.9861; val_best_acc_score: 0.9582; val_best_f1_score: 0.9592; train_kl_reg_loss: 5352.4704; train_edge_recon_loss: 259711.2924; train_gene_expr_recon_loss: 91616.2679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356680.0312; train_optim_loss: 356680.0312; val_kl_reg_loss: 5265.2012; val_edge_recon_loss: 258250.6250; val_gene_expr_recon_loss: 91793.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355309.8125; val_optim_loss: 355309.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9899; val_auprc_score: 0.9876; val_best_acc_score: 0.9589; val_best_f1_score: 0.9593; train_kl_reg_loss: 5337.4933; train_edge_recon_loss: 258750.5513; train_gene_expr_recon_loss: 91262.2433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355350.2902; train_optim_loss: 355350.2902; val_kl_reg_loss: 5280.4482; val_edge_recon_loss: 260064.4844; val_gene_expr_recon_loss: 91510.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356855.6250; val_optim_loss: 356855.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9907; val_auprc_score: 0.9876; val_best_acc_score: 0.9593; val_best_f1_score: 0.9603; train_kl_reg_loss: 5334.5153; train_edge_recon_loss: 259448.0759; train_gene_expr_recon_loss: 91103.4040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355886.0000; train_optim_loss: 355886.0000; val_kl_reg_loss: 5263.3750; val_edge_recon_loss: 259018.0625; val_gene_expr_recon_loss: 91213.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355494.5312; val_optim_loss: 355494.5312
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9907; val_auprc_score: 0.9870; val_best_acc_score: 0.9601; val_best_f1_score: 0.9606; train_kl_reg_loss: 5311.8858; train_edge_recon_loss: 258827.7857; train_gene_expr_recon_loss: 90620.8917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354760.5625; train_optim_loss: 354760.5625; val_kl_reg_loss: 5260.0928; val_edge_recon_loss: 260459.3906; val_gene_expr_recon_loss: 90922.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356642.1875; val_optim_loss: 356642.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9901; val_auprc_score: 0.9872; val_best_acc_score: 0.9591; val_best_f1_score: 0.9599; train_kl_reg_loss: 5318.0112; train_edge_recon_loss: 259332.2522; train_gene_expr_recon_loss: 90947.3493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355597.6161; train_optim_loss: 355597.6161; val_kl_reg_loss: 5250.1475; val_edge_recon_loss: 260403.9844; val_gene_expr_recon_loss: 90876.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356531.0625; val_optim_loss: 356531.0625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9908; val_auprc_score: 0.9869; val_best_acc_score: 0.9624; val_best_f1_score: 0.9628; train_kl_reg_loss: 5315.2859; train_edge_recon_loss: 258511.2232; train_gene_expr_recon_loss: 90544.6384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354371.1429; train_optim_loss: 354371.1429; val_kl_reg_loss: 5264.6196; val_edge_recon_loss: 260792.5312; val_gene_expr_recon_loss: 90837.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356894.5000; val_optim_loss: 356894.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9905; val_auprc_score: 0.9877; val_best_acc_score: 0.9608; val_best_f1_score: 0.9614; train_kl_reg_loss: 5323.4223; train_edge_recon_loss: 258370.2545; train_gene_expr_recon_loss: 90932.9676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354626.6473; train_optim_loss: 354626.6473; val_kl_reg_loss: 5253.6777; val_edge_recon_loss: 259812.0938; val_gene_expr_recon_loss: 90809.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355874.8125; val_optim_loss: 355874.8125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 14 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9876
Val best accuracy score: 0.9555
Val best F1 score: 0.9563
Val gene expr MSE score: 1.4625
Duration of model training in run 7: 0 hours, 2 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8023; val_auprc_score: 0.8201; val_best_acc_score: 0.7214; val_best_f1_score: 0.7263; train_kl_reg_loss: 634.3120; train_edge_recon_loss: 341221.8973; train_gene_expr_recon_loss: 118236.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460093.0179; train_optim_loss: 460093.0179; val_kl_reg_loss: 682.4397; val_edge_recon_loss: 343666.0312; val_gene_expr_recon_loss: 100890.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445238.6875; val_optim_loss: 445238.6875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8466; val_auprc_score: 0.8473; val_best_acc_score: 0.7514; val_best_f1_score: 0.7755; train_kl_reg_loss: 1977.4284; train_edge_recon_loss: 314571.7321; train_gene_expr_recon_loss: 99796.4040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416345.5670; train_optim_loss: 416345.5670; val_kl_reg_loss: 4896.7163; val_edge_recon_loss: 290551.0000; val_gene_expr_recon_loss: 98314.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393762.1250; val_optim_loss: 393762.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8805; val_auprc_score: 0.8681; val_best_acc_score: 0.7975; val_best_f1_score: 0.8182; train_kl_reg_loss: 7490.2869; train_edge_recon_loss: 282169.4420; train_gene_expr_recon_loss: 97908.1127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 387567.8393; train_optim_loss: 387567.8393; val_kl_reg_loss: 9500.9512; val_edge_recon_loss: 280296.2812; val_gene_expr_recon_loss: 97058.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386856.0000; val_optim_loss: 386856.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9033; val_auprc_score: 0.8859; val_best_acc_score: 0.8310; val_best_f1_score: 0.8458; train_kl_reg_loss: 9389.9544; train_edge_recon_loss: 274323.7679; train_gene_expr_recon_loss: 96649.3404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380363.0580; train_optim_loss: 380363.0580; val_kl_reg_loss: 8224.5957; val_edge_recon_loss: 277662.6562; val_gene_expr_recon_loss: 95867.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 381754.9375; val_optim_loss: 381754.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9337; val_auprc_score: 0.9227; val_best_acc_score: 0.8585; val_best_f1_score: 0.8674; train_kl_reg_loss: 7111.0202; train_edge_recon_loss: 271338.6562; train_gene_expr_recon_loss: 95781.0647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374230.7500; train_optim_loss: 374230.7500; val_kl_reg_loss: 5657.7417; val_edge_recon_loss: 272453.8438; val_gene_expr_recon_loss: 95077.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373189.2812; val_optim_loss: 373189.2812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9536; val_auprc_score: 0.9429; val_best_acc_score: 0.8897; val_best_f1_score: 0.8942; train_kl_reg_loss: 5398.1399; train_edge_recon_loss: 269120.6518; train_gene_expr_recon_loss: 95123.7154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369642.5089; train_optim_loss: 369642.5089; val_kl_reg_loss: 5302.6846; val_edge_recon_loss: 270191.0000; val_gene_expr_recon_loss: 94490.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369983.8125; val_optim_loss: 369983.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9639; val_auprc_score: 0.9570; val_best_acc_score: 0.9040; val_best_f1_score: 0.9082; train_kl_reg_loss: 5656.5785; train_edge_recon_loss: 267791.9911; train_gene_expr_recon_loss: 94456.3973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367904.9554; train_optim_loss: 367904.9554; val_kl_reg_loss: 5806.6631; val_edge_recon_loss: 267288.5000; val_gene_expr_recon_loss: 93912.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367007.5625; val_optim_loss: 367007.5625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9703; val_auprc_score: 0.9638; val_best_acc_score: 0.9168; val_best_f1_score: 0.9191; train_kl_reg_loss: 5772.2035; train_edge_recon_loss: 265843.5179; train_gene_expr_recon_loss: 93858.7288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365474.4509; train_optim_loss: 365474.4509; val_kl_reg_loss: 5450.9165; val_edge_recon_loss: 267009.1562; val_gene_expr_recon_loss: 93398.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365858.3750; val_optim_loss: 365858.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9783; val_auprc_score: 0.9725; val_best_acc_score: 0.9311; val_best_f1_score: 0.9326; train_kl_reg_loss: 5334.7681; train_edge_recon_loss: 264816.8795; train_gene_expr_recon_loss: 93076.3783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363228.0312; train_optim_loss: 363228.0312; val_kl_reg_loss: 5149.4893; val_edge_recon_loss: 265977.0625; val_gene_expr_recon_loss: 92915.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364042.1875; val_optim_loss: 364042.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9784; val_best_acc_score: 0.9389; val_best_f1_score: 0.9396; train_kl_reg_loss: 5267.3351; train_edge_recon_loss: 263096.3371; train_gene_expr_recon_loss: 93230.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361593.8080; train_optim_loss: 361593.8080; val_kl_reg_loss: 5317.9805; val_edge_recon_loss: 263860.3125; val_gene_expr_recon_loss: 92492.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361670.9688; val_optim_loss: 361670.9688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9854; val_auprc_score: 0.9811; val_best_acc_score: 0.9455; val_best_f1_score: 0.9465; train_kl_reg_loss: 5371.1604; train_edge_recon_loss: 261565.1786; train_gene_expr_recon_loss: 92636.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359572.9866; train_optim_loss: 359572.9866; val_kl_reg_loss: 5274.0967; val_edge_recon_loss: 262844.8438; val_gene_expr_recon_loss: 92106.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360225.5000; val_optim_loss: 360225.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9849; val_auprc_score: 0.9809; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 5316.9775; train_edge_recon_loss: 260602.2879; train_gene_expr_recon_loss: 92046.5558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357965.8170; train_optim_loss: 357965.8170; val_kl_reg_loss: 5278.9097; val_edge_recon_loss: 261769.4062; val_gene_expr_recon_loss: 91725.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358774.0938; val_optim_loss: 358774.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9870; val_auprc_score: 0.9832; val_best_acc_score: 0.9498; val_best_f1_score: 0.9509; train_kl_reg_loss: 5346.2386; train_edge_recon_loss: 260245.2589; train_gene_expr_recon_loss: 91556.4542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357147.9643; train_optim_loss: 357147.9643; val_kl_reg_loss: 5300.7422; val_edge_recon_loss: 261436.5156; val_gene_expr_recon_loss: 91362.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358099.3750; val_optim_loss: 358099.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9883; val_auprc_score: 0.9840; val_best_acc_score: 0.9533; val_best_f1_score: 0.9543; train_kl_reg_loss: 5369.1156; train_edge_recon_loss: 259917.3571; train_gene_expr_recon_loss: 91493.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356780.3616; train_optim_loss: 356780.3616; val_kl_reg_loss: 5295.2090; val_edge_recon_loss: 260647.9844; val_gene_expr_recon_loss: 90993.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356936.8750; val_optim_loss: 356936.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9891; val_auprc_score: 0.9859; val_best_acc_score: 0.9541; val_best_f1_score: 0.9546; train_kl_reg_loss: 5321.9540; train_edge_recon_loss: 259632.1473; train_gene_expr_recon_loss: 90984.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355938.8571; train_optim_loss: 355938.8571; val_kl_reg_loss: 5264.2759; val_edge_recon_loss: 263537.7188; val_gene_expr_recon_loss: 90643.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359445.7812; val_optim_loss: 359445.7812
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9901; val_auprc_score: 0.9878; val_best_acc_score: 0.9572; val_best_f1_score: 0.9580; train_kl_reg_loss: 5348.1092; train_edge_recon_loss: 258459.9107; train_gene_expr_recon_loss: 90828.0513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354636.0714; train_optim_loss: 354636.0714; val_kl_reg_loss: 5275.0762; val_edge_recon_loss: 260068.2969; val_gene_expr_recon_loss: 90311.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355654.6250; val_optim_loss: 355654.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9902; val_auprc_score: 0.9874; val_best_acc_score: 0.9575; val_best_f1_score: 0.9576; train_kl_reg_loss: 5312.1652; train_edge_recon_loss: 259434.6920; train_gene_expr_recon_loss: 90627.2054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355374.0625; train_optim_loss: 355374.0625; val_kl_reg_loss: 5245.0371; val_edge_recon_loss: 263411.9062; val_gene_expr_recon_loss: 89999.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358656.1250; val_optim_loss: 358656.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9914; val_auprc_score: 0.9888; val_best_acc_score: 0.9613; val_best_f1_score: 0.9622; train_kl_reg_loss: 5307.7836; train_edge_recon_loss: 259036.5045; train_gene_expr_recon_loss: 89850.1049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354194.3973; train_optim_loss: 354194.3973; val_kl_reg_loss: 5251.9082; val_edge_recon_loss: 257848.5938; val_gene_expr_recon_loss: 89702.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352802.9688; val_optim_loss: 352802.9688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9900; val_auprc_score: 0.9857; val_best_acc_score: 0.9581; val_best_f1_score: 0.9592; train_kl_reg_loss: 5302.8231; train_edge_recon_loss: 260071.0759; train_gene_expr_recon_loss: 89914.9654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355288.8616; train_optim_loss: 355288.8616; val_kl_reg_loss: 5230.5435; val_edge_recon_loss: 259410.5938; val_gene_expr_recon_loss: 89440.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354081.7812; val_optim_loss: 354081.7812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9914; val_auprc_score: 0.9889; val_best_acc_score: 0.9620; val_best_f1_score: 0.9625; train_kl_reg_loss: 5308.8481; train_edge_recon_loss: 258434.0045; train_gene_expr_recon_loss: 89516.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353259.8438; train_optim_loss: 353259.8438; val_kl_reg_loss: 5249.9175; val_edge_recon_loss: 260896.2656; val_gene_expr_recon_loss: 89170.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355316.8750; val_optim_loss: 355316.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9916; val_auprc_score: 0.9874; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 5294.0294; train_edge_recon_loss: 258543.8326; train_gene_expr_recon_loss: 89176.2511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353014.1161; train_optim_loss: 353014.1161; val_kl_reg_loss: 5206.0791; val_edge_recon_loss: 259278.8906; val_gene_expr_recon_loss: 88929.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353414.0312; val_optim_loss: 353414.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9917; val_auprc_score: 0.9894; val_best_acc_score: 0.9635; val_best_f1_score: 0.9636; train_kl_reg_loss: 5272.8109; train_edge_recon_loss: 258854.1920; train_gene_expr_recon_loss: 89074.4263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353201.4286; train_optim_loss: 353201.4286; val_kl_reg_loss: 5225.6064; val_edge_recon_loss: 261410.4219; val_gene_expr_recon_loss: 88895.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355531.2500; val_optim_loss: 355531.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9913; val_auprc_score: 0.9875; val_best_acc_score: 0.9639; val_best_f1_score: 0.9646; train_kl_reg_loss: 5292.0079; train_edge_recon_loss: 257402.6518; train_gene_expr_recon_loss: 88991.8616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351686.5134; train_optim_loss: 351686.5134; val_kl_reg_loss: 5238.9683; val_edge_recon_loss: 259115.3906; val_gene_expr_recon_loss: 88866.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353220.5625; val_optim_loss: 353220.5625
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9922; val_auprc_score: 0.9891; val_best_acc_score: 0.9637; val_best_f1_score: 0.9643; train_kl_reg_loss: 5303.8371; train_edge_recon_loss: 257533.6741; train_gene_expr_recon_loss: 89124.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351962.4955; train_optim_loss: 351962.4955; val_kl_reg_loss: 5248.6475; val_edge_recon_loss: 259261.3438; val_gene_expr_recon_loss: 88844.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 353354.6562; val_optim_loss: 353354.6562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 27 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9861
Val best accuracy score: 0.9587
Val best F1 score: 0.9593
Val gene expr MSE score: 1.3826
Duration of model training in run 8: 0 hours, 2 minutes and 30 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8209; val_auprc_score: 0.8368; val_best_acc_score: 0.7363; val_best_f1_score: 0.7488; train_kl_reg_loss: 628.1202; train_edge_recon_loss: 339539.8264; train_gene_expr_recon_loss: 114333.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454501.3507; train_optim_loss: 454501.3507; val_kl_reg_loss: 897.2346; val_edge_recon_loss: 322190.7188; val_gene_expr_recon_loss: 99381.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 422469.9688; val_optim_loss: 422469.9688
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8749; val_auprc_score: 0.8676; val_best_acc_score: 0.7877; val_best_f1_score: 0.8097; train_kl_reg_loss: 3684.8606; train_edge_recon_loss: 299605.6042; train_gene_expr_recon_loss: 98527.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401818.1771; train_optim_loss: 401818.1771; val_kl_reg_loss: 8075.9824; val_edge_recon_loss: 281297.0312; val_gene_expr_recon_loss: 97353.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 386726.2188; val_optim_loss: 386726.2188
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9114; val_auprc_score: 0.8996; val_best_acc_score: 0.8342; val_best_f1_score: 0.8507; train_kl_reg_loss: 9393.2676; train_edge_recon_loss: 275648.8958; train_gene_expr_recon_loss: 96744.9635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381787.1285; train_optim_loss: 381787.1285; val_kl_reg_loss: 9051.8086; val_edge_recon_loss: 271167.7812; val_gene_expr_recon_loss: 95650.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375870.0625; val_optim_loss: 375870.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9390; val_auprc_score: 0.9315; val_best_acc_score: 0.8668; val_best_f1_score: 0.8755; train_kl_reg_loss: 7551.5892; train_edge_recon_loss: 271872.6042; train_gene_expr_recon_loss: 95287.3429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374711.5382; train_optim_loss: 374711.5382; val_kl_reg_loss: 5743.9424; val_edge_recon_loss: 267052.5000; val_gene_expr_recon_loss: 94628.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367424.7812; val_optim_loss: 367424.7812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9545; val_auprc_score: 0.9460; val_best_acc_score: 0.8907; val_best_f1_score: 0.8957; train_kl_reg_loss: 5474.6984; train_edge_recon_loss: 268870.3958; train_gene_expr_recon_loss: 94467.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368812.2188; train_optim_loss: 368812.2188; val_kl_reg_loss: 5564.8970; val_edge_recon_loss: 266127.6562; val_gene_expr_recon_loss: 93949.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365641.7500; val_optim_loss: 365641.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9639; val_auprc_score: 0.9571; val_best_acc_score: 0.9083; val_best_f1_score: 0.9117; train_kl_reg_loss: 5775.4426; train_edge_recon_loss: 266254.2639; train_gene_expr_recon_loss: 93781.2726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365810.9826; train_optim_loss: 365810.9826; val_kl_reg_loss: 5670.3926; val_edge_recon_loss: 265419.5938; val_gene_expr_recon_loss: 93271.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364361.5312; val_optim_loss: 364361.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9744; val_auprc_score: 0.9680; val_best_acc_score: 0.9280; val_best_f1_score: 0.9310; train_kl_reg_loss: 5414.3679; train_edge_recon_loss: 265521.2465; train_gene_expr_recon_loss: 93248.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364184.2882; train_optim_loss: 364184.2882; val_kl_reg_loss: 5077.8550; val_edge_recon_loss: 262066.0938; val_gene_expr_recon_loss: 92690.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359834.0000; val_optim_loss: 359834.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9811; val_auprc_score: 0.9750; val_best_acc_score: 0.9392; val_best_f1_score: 0.9416; train_kl_reg_loss: 5179.6152; train_edge_recon_loss: 263480.6649; train_gene_expr_recon_loss: 92744.2144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361404.4931; train_optim_loss: 361404.4931; val_kl_reg_loss: 5289.5498; val_edge_recon_loss: 258416.6250; val_gene_expr_recon_loss: 92221.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355927.3125; val_optim_loss: 355927.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9842; val_auprc_score: 0.9812; val_best_acc_score: 0.9435; val_best_f1_score: 0.9453; train_kl_reg_loss: 5357.3971; train_edge_recon_loss: 261206.0052; train_gene_expr_recon_loss: 92253.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358816.8229; train_optim_loss: 358816.8229; val_kl_reg_loss: 5285.9053; val_edge_recon_loss: 258490.7344; val_gene_expr_recon_loss: 91768.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355544.7500; val_optim_loss: 355544.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9857; val_auprc_score: 0.9815; val_best_acc_score: 0.9476; val_best_f1_score: 0.9490; train_kl_reg_loss: 5340.2241; train_edge_recon_loss: 260192.8524; train_gene_expr_recon_loss: 91708.4488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357241.5243; train_optim_loss: 357241.5243; val_kl_reg_loss: 5319.9961; val_edge_recon_loss: 257831.8438; val_gene_expr_recon_loss: 91269.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354421.2812; val_optim_loss: 354421.2812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9868; val_auprc_score: 0.9828; val_best_acc_score: 0.9487; val_best_f1_score: 0.9506; train_kl_reg_loss: 5355.2378; train_edge_recon_loss: 259625.3611; train_gene_expr_recon_loss: 91303.4253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356284.0312; train_optim_loss: 356284.0312; val_kl_reg_loss: 5318.9600; val_edge_recon_loss: 258473.1250; val_gene_expr_recon_loss: 90835.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354627.5938; val_optim_loss: 354627.5938
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9895; val_auprc_score: 0.9869; val_best_acc_score: 0.9560; val_best_f1_score: 0.9572; train_kl_reg_loss: 5342.2268; train_edge_recon_loss: 259906.3628; train_gene_expr_recon_loss: 90908.0799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356156.6771; train_optim_loss: 356156.6771; val_kl_reg_loss: 5324.5684; val_edge_recon_loss: 256484.0938; val_gene_expr_recon_loss: 90479.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352288.0000; val_optim_loss: 352288.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9906; val_auprc_score: 0.9872; val_best_acc_score: 0.9584; val_best_f1_score: 0.9598; train_kl_reg_loss: 5351.9851; train_edge_recon_loss: 259432.0990; train_gene_expr_recon_loss: 90529.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355313.7396; train_optim_loss: 355313.7396; val_kl_reg_loss: 5269.7168; val_edge_recon_loss: 253457.2812; val_gene_expr_recon_loss: 90119.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348846.7500; val_optim_loss: 348846.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9904; val_auprc_score: 0.9867; val_best_acc_score: 0.9596; val_best_f1_score: 0.9609; train_kl_reg_loss: 5324.2810; train_edge_recon_loss: 258932.3889; train_gene_expr_recon_loss: 90237.2205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354493.8958; train_optim_loss: 354493.8958; val_kl_reg_loss: 5279.8501; val_edge_recon_loss: 256208.5625; val_gene_expr_recon_loss: 89744.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351233.3750; val_optim_loss: 351233.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9912; val_auprc_score: 0.9879; val_best_acc_score: 0.9631; val_best_f1_score: 0.9643; train_kl_reg_loss: 5308.1583; train_edge_recon_loss: 258528.3385; train_gene_expr_recon_loss: 89824.0538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353660.5556; train_optim_loss: 353660.5556; val_kl_reg_loss: 5287.1143; val_edge_recon_loss: 255019.1562; val_gene_expr_recon_loss: 89421.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349727.3125; val_optim_loss: 349727.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9907; val_auprc_score: 0.9861; val_best_acc_score: 0.9629; val_best_f1_score: 0.9640; train_kl_reg_loss: 5318.8578; train_edge_recon_loss: 258220.4497; train_gene_expr_recon_loss: 89465.4974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353004.8090; train_optim_loss: 353004.8090; val_kl_reg_loss: 5235.7935; val_edge_recon_loss: 255153.6250; val_gene_expr_recon_loss: 89116.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349506.2188; val_optim_loss: 349506.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9900; val_auprc_score: 0.9867; val_best_acc_score: 0.9607; val_best_f1_score: 0.9619; train_kl_reg_loss: 5281.6373; train_edge_recon_loss: 259277.7517; train_gene_expr_recon_loss: 89323.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353882.6597; train_optim_loss: 353882.6597; val_kl_reg_loss: 5263.9082; val_edge_recon_loss: 256953.7500; val_gene_expr_recon_loss: 89066.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351283.8750; val_optim_loss: 351283.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9907; val_auprc_score: 0.9875; val_best_acc_score: 0.9618; val_best_f1_score: 0.9635; train_kl_reg_loss: 5299.3805; train_edge_recon_loss: 258526.2222; train_gene_expr_recon_loss: 89281.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353106.6424; train_optim_loss: 353106.6424; val_kl_reg_loss: 5271.5430; val_edge_recon_loss: 254143.7812; val_gene_expr_recon_loss: 89019.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348434.6875; val_optim_loss: 348434.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9906; val_auprc_score: 0.9863; val_best_acc_score: 0.9616; val_best_f1_score: 0.9628; train_kl_reg_loss: 5313.1996; train_edge_recon_loss: 258249.9757; train_gene_expr_recon_loss: 89268.6814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352831.8507; train_optim_loss: 352831.8507; val_kl_reg_loss: 5274.9922; val_edge_recon_loss: 255317.0000; val_gene_expr_recon_loss: 88984.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349576.0938; val_optim_loss: 349576.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9914; val_auprc_score: 0.9873; val_best_acc_score: 0.9643; val_best_f1_score: 0.9656; train_kl_reg_loss: 5308.0649; train_edge_recon_loss: 257485.0191; train_gene_expr_recon_loss: 89187.8394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351980.9306; train_optim_loss: 351980.9306; val_kl_reg_loss: 5275.4058; val_edge_recon_loss: 254186.2656; val_gene_expr_recon_loss: 88949.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348411.3438; val_optim_loss: 348411.3438
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9892; val_best_acc_score: 0.9640; val_best_f1_score: 0.9650; train_kl_reg_loss: 5310.8356; train_edge_recon_loss: 258363.9271; train_gene_expr_recon_loss: 89196.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352871.4826; train_optim_loss: 352871.4826; val_kl_reg_loss: 5276.8096; val_edge_recon_loss: 257035.7031; val_gene_expr_recon_loss: 88919.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351231.7812; val_optim_loss: 351231.7812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9916; val_auprc_score: 0.9878; val_best_acc_score: 0.9642; val_best_f1_score: 0.9652; train_kl_reg_loss: 5315.1446; train_edge_recon_loss: 258478.2969; train_gene_expr_recon_loss: 89075.8707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352869.3125; train_optim_loss: 352869.3125; val_kl_reg_loss: 5279.0967; val_edge_recon_loss: 256180.3750; val_gene_expr_recon_loss: 88884.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350344.1562; val_optim_loss: 350344.1562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9915; val_auprc_score: 0.9879; val_best_acc_score: 0.9633; val_best_f1_score: 0.9642; train_kl_reg_loss: 5312.5229; train_edge_recon_loss: 257879.2292; train_gene_expr_recon_loss: 89070.1519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352261.8958; train_optim_loss: 352261.8958; val_kl_reg_loss: 5274.4277; val_edge_recon_loss: 258088.1094; val_gene_expr_recon_loss: 88854.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352217.4375; val_optim_loss: 352217.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9910; val_auprc_score: 0.9867; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 5310.2306; train_edge_recon_loss: 258265.2760; train_gene_expr_recon_loss: 89039.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352615.3438; train_optim_loss: 352615.3438; val_kl_reg_loss: 5275.0547; val_edge_recon_loss: 255324.8125; val_gene_expr_recon_loss: 88851.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349450.9375; val_optim_loss: 349450.9375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9890; val_best_acc_score: 0.9627; val_best_f1_score: 0.9639; train_kl_reg_loss: 5307.4396; train_edge_recon_loss: 258536.4583; train_gene_expr_recon_loss: 89048.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352892.1458; train_optim_loss: 352892.1458; val_kl_reg_loss: 5271.7744; val_edge_recon_loss: 257360.1562; val_gene_expr_recon_loss: 88847.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351479.3750; val_optim_loss: 351479.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9912; val_auprc_score: 0.9878; val_best_acc_score: 0.9629; val_best_f1_score: 0.9636; train_kl_reg_loss: 5307.1398; train_edge_recon_loss: 257963.5833; train_gene_expr_recon_loss: 89019.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352290.0833; train_optim_loss: 352290.0833; val_kl_reg_loss: 5257.6885; val_edge_recon_loss: 258365.6562; val_gene_expr_recon_loss: 88844.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352467.9375; val_optim_loss: 352467.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 28 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9905
Val AUPRC score: 0.9875
Val best accuracy score: 0.9635
Val best F1 score: 0.9646
Val gene expr MSE score: 1.3316
Duration of model training in run 9: 0 hours, 3 minutes and 32 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP ATTENTION NODE LABEL AGGREGATOR -> n_input: 351, n_heads: 4

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8323; val_auprc_score: 0.8415; val_best_acc_score: 0.7513; val_best_f1_score: 0.7575; train_kl_reg_loss: 658.7233; train_edge_recon_loss: 338790.4549; train_gene_expr_recon_loss: 113663.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453112.2083; train_optim_loss: 453112.2083; val_kl_reg_loss: 1123.0668; val_edge_recon_loss: 316847.8750; val_gene_expr_recon_loss: 99119.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417090.4062; val_optim_loss: 417090.4062
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8795; val_auprc_score: 0.8723; val_best_acc_score: 0.7919; val_best_f1_score: 0.8114; train_kl_reg_loss: 4219.0534; train_edge_recon_loss: 296590.1319; train_gene_expr_recon_loss: 97775.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398584.7361; train_optim_loss: 398584.7361; val_kl_reg_loss: 8500.8027; val_edge_recon_loss: 278523.4062; val_gene_expr_recon_loss: 97265.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 384289.9062; val_optim_loss: 384289.9062
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9122; val_auprc_score: 0.8998; val_best_acc_score: 0.8427; val_best_f1_score: 0.8571; train_kl_reg_loss: 9482.4033; train_edge_recon_loss: 275365.2847; train_gene_expr_recon_loss: 96090.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 380938.5868; train_optim_loss: 380938.5868; val_kl_reg_loss: 8882.9365; val_edge_recon_loss: 270666.3438; val_gene_expr_recon_loss: 95832.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375381.3750; val_optim_loss: 375381.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9418; val_auprc_score: 0.9346; val_best_acc_score: 0.8710; val_best_f1_score: 0.8803; train_kl_reg_loss: 7377.5849; train_edge_recon_loss: 270786.6319; train_gene_expr_recon_loss: 94908.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 373073.1771; train_optim_loss: 373073.1771; val_kl_reg_loss: 5620.9023; val_edge_recon_loss: 265893.8750; val_gene_expr_recon_loss: 94843.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366358.0000; val_optim_loss: 366358.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9623; val_auprc_score: 0.9535; val_best_acc_score: 0.9038; val_best_f1_score: 0.9079; train_kl_reg_loss: 5404.3383; train_edge_recon_loss: 268603.2257; train_gene_expr_recon_loss: 94092.2127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368099.7778; train_optim_loss: 368099.7778; val_kl_reg_loss: 5507.9951; val_edge_recon_loss: 265104.2812; val_gene_expr_recon_loss: 94243.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364856.2188; val_optim_loss: 364856.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9722; val_auprc_score: 0.9638; val_best_acc_score: 0.9229; val_best_f1_score: 0.9253; train_kl_reg_loss: 5755.4967; train_edge_recon_loss: 265246.8611; train_gene_expr_recon_loss: 93539.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364541.6910; train_optim_loss: 364541.6910; val_kl_reg_loss: 5657.1416; val_edge_recon_loss: 263928.2812; val_gene_expr_recon_loss: 93701.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363287.2500; val_optim_loss: 363287.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9809; val_auprc_score: 0.9769; val_best_acc_score: 0.9397; val_best_f1_score: 0.9421; train_kl_reg_loss: 5441.8134; train_edge_recon_loss: 263297.5990; train_gene_expr_recon_loss: 93027.4453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361766.8611; train_optim_loss: 361766.8611; val_kl_reg_loss: 5152.4272; val_edge_recon_loss: 259398.4844; val_gene_expr_recon_loss: 93161.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 357712.6250; val_optim_loss: 357712.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9855; val_auprc_score: 0.9824; val_best_acc_score: 0.9477; val_best_f1_score: 0.9495; train_kl_reg_loss: 5269.2703; train_edge_recon_loss: 262382.8142; train_gene_expr_recon_loss: 92570.8455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360222.9306; train_optim_loss: 360222.9306; val_kl_reg_loss: 5313.7617; val_edge_recon_loss: 256631.8281; val_gene_expr_recon_loss: 92698.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354643.6875; val_optim_loss: 354643.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9863; val_auprc_score: 0.9820; val_best_acc_score: 0.9475; val_best_f1_score: 0.9489; train_kl_reg_loss: 5363.0147; train_edge_recon_loss: 260782.5104; train_gene_expr_recon_loss: 92087.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358232.9236; train_optim_loss: 358232.9236; val_kl_reg_loss: 5255.0547; val_edge_recon_loss: 259106.2500; val_gene_expr_recon_loss: 92317.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356678.8125; val_optim_loss: 356678.8125
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9877; val_auprc_score: 0.9841; val_best_acc_score: 0.9507; val_best_f1_score: 0.9523; train_kl_reg_loss: 5358.9705; train_edge_recon_loss: 260202.7222; train_gene_expr_recon_loss: 91751.1571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357312.8542; train_optim_loss: 357312.8542; val_kl_reg_loss: 5355.9287; val_edge_recon_loss: 259157.3594; val_gene_expr_recon_loss: 91921.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356435.1250; val_optim_loss: 356435.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9886; val_auprc_score: 0.9855; val_best_acc_score: 0.9530; val_best_f1_score: 0.9548; train_kl_reg_loss: 5381.9492; train_edge_recon_loss: 259719.3264; train_gene_expr_recon_loss: 91342.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 356443.3542; train_optim_loss: 356443.3542; val_kl_reg_loss: 5261.6533; val_edge_recon_loss: 255308.8125; val_gene_expr_recon_loss: 91537.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352108.0625; val_optim_loss: 352108.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9893; val_auprc_score: 0.9841; val_best_acc_score: 0.9567; val_best_f1_score: 0.9584; train_kl_reg_loss: 5315.5996; train_edge_recon_loss: 259051.6875; train_gene_expr_recon_loss: 90991.0538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355358.3438; train_optim_loss: 355358.3438; val_kl_reg_loss: 5274.3496; val_edge_recon_loss: 255140.2188; val_gene_expr_recon_loss: 91180.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351595.4375; val_optim_loss: 351595.4375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9895; val_auprc_score: 0.9857; val_best_acc_score: 0.9580; val_best_f1_score: 0.9595; train_kl_reg_loss: 5305.4434; train_edge_recon_loss: 259576.6962; train_gene_expr_recon_loss: 90615.4462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 355497.5868; train_optim_loss: 355497.5868; val_kl_reg_loss: 5224.4238; val_edge_recon_loss: 255893.6719; val_gene_expr_recon_loss: 90860.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351978.8438; val_optim_loss: 351978.8438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9922; val_auprc_score: 0.9900; val_best_acc_score: 0.9625; val_best_f1_score: 0.9638; train_kl_reg_loss: 5261.3900; train_edge_recon_loss: 258985.7656; train_gene_expr_recon_loss: 90282.2092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354529.3646; train_optim_loss: 354529.3646; val_kl_reg_loss: 5223.5654; val_edge_recon_loss: 255028.0156; val_gene_expr_recon_loss: 90539.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350791.3438; val_optim_loss: 350791.3438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9912; val_auprc_score: 0.9890; val_best_acc_score: 0.9639; val_best_f1_score: 0.9649; train_kl_reg_loss: 5241.7198; train_edge_recon_loss: 258276.4062; train_gene_expr_recon_loss: 89971.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353489.1944; train_optim_loss: 353489.1944; val_kl_reg_loss: 5160.0713; val_edge_recon_loss: 255768.0938; val_gene_expr_recon_loss: 90229.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351157.2500; val_optim_loss: 351157.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9930; val_auprc_score: 0.9916; val_best_acc_score: 0.9673; val_best_f1_score: 0.9680; train_kl_reg_loss: 5247.8477; train_edge_recon_loss: 258492.9201; train_gene_expr_recon_loss: 89635.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353376.0312; train_optim_loss: 353376.0312; val_kl_reg_loss: 5234.3828; val_edge_recon_loss: 256175.4531; val_gene_expr_recon_loss: 89947.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351357.8125; val_optim_loss: 351357.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9925; val_auprc_score: 0.9890; val_best_acc_score: 0.9647; val_best_f1_score: 0.9656; train_kl_reg_loss: 5255.0721; train_edge_recon_loss: 258506.2743; train_gene_expr_recon_loss: 89479.0330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 353240.3715; train_optim_loss: 353240.3715; val_kl_reg_loss: 5226.6846; val_edge_recon_loss: 256801.1875; val_gene_expr_recon_loss: 89683.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351711.5000; val_optim_loss: 351711.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9917; val_auprc_score: 0.9886; val_best_acc_score: 0.9651; val_best_f1_score: 0.9661; train_kl_reg_loss: 5273.2602; train_edge_recon_loss: 257821.1528; train_gene_expr_recon_loss: 89179.6233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352274.0417; train_optim_loss: 352274.0417; val_kl_reg_loss: 5226.5791; val_edge_recon_loss: 257171.8750; val_gene_expr_recon_loss: 89629.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 352028.0000; val_optim_loss: 352028.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9652; val_best_f1_score: 0.9662; train_kl_reg_loss: 5276.8819; train_edge_recon_loss: 258006.0434; train_gene_expr_recon_loss: 89181.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352464.2396; train_optim_loss: 352464.2396; val_kl_reg_loss: 5222.8374; val_edge_recon_loss: 254510.1094; val_gene_expr_recon_loss: 89591.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349324.3438; val_optim_loss: 349324.3438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9923; val_auprc_score: 0.9888; val_best_acc_score: 0.9667; val_best_f1_score: 0.9677; train_kl_reg_loss: 5271.2425; train_edge_recon_loss: 258343.6684; train_gene_expr_recon_loss: 89123.3342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352738.2431; train_optim_loss: 352738.2431; val_kl_reg_loss: 5223.2305; val_edge_recon_loss: 255432.0625; val_gene_expr_recon_loss: 89559.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350214.6875; val_optim_loss: 350214.6875
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9919; val_auprc_score: 0.9889; val_best_acc_score: 0.9653; val_best_f1_score: 0.9663; train_kl_reg_loss: 5271.8955; train_edge_recon_loss: 258083.0868; train_gene_expr_recon_loss: 89067.8082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352422.7917; train_optim_loss: 352422.7917; val_kl_reg_loss: 5219.6494; val_edge_recon_loss: 255966.1562; val_gene_expr_recon_loss: 89529.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350715.0000; val_optim_loss: 350715.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9923; val_auprc_score: 0.9894; val_best_acc_score: 0.9655; val_best_f1_score: 0.9667; train_kl_reg_loss: 5265.5601; train_edge_recon_loss: 257849.1042; train_gene_expr_recon_loss: 89141.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352255.9757; train_optim_loss: 352255.9757; val_kl_reg_loss: 5214.9355; val_edge_recon_loss: 255725.8594; val_gene_expr_recon_loss: 89499.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350440.6875; val_optim_loss: 350440.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9930; val_auprc_score: 0.9894; val_best_acc_score: 0.9683; val_best_f1_score: 0.9692; train_kl_reg_loss: 5263.8052; train_edge_recon_loss: 257809.3281; train_gene_expr_recon_loss: 89149.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352222.7222; train_optim_loss: 352222.7222; val_kl_reg_loss: 5213.9658; val_edge_recon_loss: 255241.6875; val_gene_expr_recon_loss: 89496.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349952.5000; val_optim_loss: 349952.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9924; val_auprc_score: 0.9893; val_best_acc_score: 0.9674; val_best_f1_score: 0.9685; train_kl_reg_loss: 5263.4631; train_edge_recon_loss: 258258.0000; train_gene_expr_recon_loss: 89078.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352599.9028; train_optim_loss: 352599.9028; val_kl_reg_loss: 5213.7617; val_edge_recon_loss: 254928.2969; val_gene_expr_recon_loss: 89494.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349636.1250; val_optim_loss: 349636.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9921; val_auprc_score: 0.9900; val_best_acc_score: 0.9663; val_best_f1_score: 0.9674; train_kl_reg_loss: 5263.7465; train_edge_recon_loss: 257459.7552; train_gene_expr_recon_loss: 89041.0399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351764.5451; train_optim_loss: 351764.5451; val_kl_reg_loss: 5216.3506; val_edge_recon_loss: 255715.3125; val_gene_expr_recon_loss: 89491.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350422.6875; val_optim_loss: 350422.6875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 20 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9925
Val AUPRC score: 0.9894
Val best accuracy score: 0.9659
Val best F1 score: 0.9666
Val gene expr MSE score: 1.3783
Duration of model training in run 10: 0 hours, 3 minutes and 24 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
