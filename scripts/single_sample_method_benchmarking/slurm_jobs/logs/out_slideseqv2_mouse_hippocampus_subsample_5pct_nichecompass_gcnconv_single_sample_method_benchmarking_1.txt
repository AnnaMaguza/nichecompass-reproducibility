Run timestamp: 16082023_160141_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_5pct', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gcnconv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 16983
Number of validation edges: 1886
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9426; val_auprc_score: 0.9303; val_best_acc_score: 0.8611; val_best_f1_score: 0.8594; train_kl_reg_loss: 8.2023; train_edge_recon_loss: 3466232.5000; train_gene_expr_recon_loss: 1769194.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5235434.5000; train_optim_loss: 5235434.5000; val_kl_reg_loss: 56.1616; val_edge_recon_loss: 4042886.7500; val_gene_expr_recon_loss: 1840115.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5883058.0000; val_optim_loss: 5883058.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9334; val_auprc_score: 0.9220; val_best_acc_score: 0.5761; val_best_f1_score: 0.7023; train_kl_reg_loss: 106.1812; train_edge_recon_loss: 3463049.2500; train_gene_expr_recon_loss: 1748548.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5211703.5000; train_optim_loss: 5211703.5000; val_kl_reg_loss: 348.9117; val_edge_recon_loss: 4060932.7500; val_gene_expr_recon_loss: 1832881.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5894163.5000; val_optim_loss: 5894163.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9173; val_auprc_score: 0.9068; val_best_acc_score: 0.5647; val_best_f1_score: 0.6967; train_kl_reg_loss: 451.6653; train_edge_recon_loss: 3461510.7500; train_gene_expr_recon_loss: 1740233.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5202196.0000; train_optim_loss: 5202196.0000; val_kl_reg_loss: 802.0258; val_edge_recon_loss: 4061834.5000; val_gene_expr_recon_loss: 1826824.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5889461.5000; val_optim_loss: 5889461.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9025; val_auprc_score: 0.8925; val_best_acc_score: 0.6760; val_best_f1_score: 0.7547; train_kl_reg_loss: 811.1072; train_edge_recon_loss: 3464748.8750; train_gene_expr_recon_loss: 1735668.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5201228.7500; train_optim_loss: 5201228.7500; val_kl_reg_loss: 918.1415; val_edge_recon_loss: 4054686.7500; val_gene_expr_recon_loss: 1821546.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5877152.0000; val_optim_loss: 5877152.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8858; val_auprc_score: 0.8758; val_best_acc_score: 0.7704; val_best_f1_score: 0.8054; train_kl_reg_loss: 883.9641; train_edge_recon_loss: 3457367.6250; train_gene_expr_recon_loss: 1732662.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5190914.2500; train_optim_loss: 5190914.2500; val_kl_reg_loss: 931.2092; val_edge_recon_loss: 4024947.0000; val_gene_expr_recon_loss: 1823608.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5849486.5000; val_optim_loss: 5849486.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8537; val_auprc_score: 0.8443; val_best_acc_score: 0.7646; val_best_f1_score: 0.7805; train_kl_reg_loss: 884.8493; train_edge_recon_loss: 3451231.8750; train_gene_expr_recon_loss: 1730511.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5182628.5000; train_optim_loss: 5182628.5000; val_kl_reg_loss: 928.2592; val_edge_recon_loss: 3936510.0000; val_gene_expr_recon_loss: 1827028.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5764467.0000; val_optim_loss: 5764467.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8218; val_auprc_score: 0.8067; val_best_acc_score: 0.7341; val_best_f1_score: 0.7679; train_kl_reg_loss: 872.0164; train_edge_recon_loss: 3438373.6250; train_gene_expr_recon_loss: 1727234.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5166479.7500; train_optim_loss: 5166479.7500; val_kl_reg_loss: 924.7563; val_edge_recon_loss: 3764319.0000; val_gene_expr_recon_loss: 1814354.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5579598.0000; val_optim_loss: 5579598.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8226; val_auprc_score: 0.8146; val_best_acc_score: 0.7378; val_best_f1_score: 0.7725; train_kl_reg_loss: 880.4695; train_edge_recon_loss: 3415216.6250; train_gene_expr_recon_loss: 1722733.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5138831.0000; train_optim_loss: 5138831.0000; val_kl_reg_loss: 1043.6157; val_edge_recon_loss: 3478091.7500; val_gene_expr_recon_loss: 1810226.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5289362.0000; val_optim_loss: 5289362.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8217; val_auprc_score: 0.8076; val_best_acc_score: 0.7314; val_best_f1_score: 0.7686; train_kl_reg_loss: 1019.1527; train_edge_recon_loss: 3380086.3750; train_gene_expr_recon_loss: 1719249.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5100355.2500; train_optim_loss: 5100355.2500; val_kl_reg_loss: 1223.4766; val_edge_recon_loss: 3230579.2500; val_gene_expr_recon_loss: 1808169.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5039972.0000; val_optim_loss: 5039972.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8413; val_auprc_score: 0.8351; val_best_acc_score: 0.7436; val_best_f1_score: 0.7811; train_kl_reg_loss: 1171.7880; train_edge_recon_loss: 3327811.3750; train_gene_expr_recon_loss: 1716300.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5045283.7500; train_optim_loss: 5045283.7500; val_kl_reg_loss: 1377.5510; val_edge_recon_loss: 3018698.7500; val_gene_expr_recon_loss: 1800674.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4820750.0000; val_optim_loss: 4820750.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8376; val_auprc_score: 0.8317; val_best_acc_score: 0.7410; val_best_f1_score: 0.7740; train_kl_reg_loss: 1368.8662; train_edge_recon_loss: 3272432.1250; train_gene_expr_recon_loss: 1714511.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4988312.0000; train_optim_loss: 4988312.0000; val_kl_reg_loss: 1661.8942; val_edge_recon_loss: 3003500.7500; val_gene_expr_recon_loss: 1804601.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4809764.0000; val_optim_loss: 4809764.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8437; val_auprc_score: 0.8386; val_best_acc_score: 0.7428; val_best_f1_score: 0.7735; train_kl_reg_loss: 1696.6226; train_edge_recon_loss: 3176555.3750; train_gene_expr_recon_loss: 1714284.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4892536.0000; train_optim_loss: 4892536.0000; val_kl_reg_loss: 2388.1660; val_edge_recon_loss: 2963155.7500; val_gene_expr_recon_loss: 1807066.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4772610.0000; val_optim_loss: 4772610.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8395; val_auprc_score: 0.8381; val_best_acc_score: 0.7336; val_best_f1_score: 0.7715; train_kl_reg_loss: 2555.0533; train_edge_recon_loss: 3064424.6250; train_gene_expr_recon_loss: 1711780.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4778760.0000; train_optim_loss: 4778760.0000; val_kl_reg_loss: 3889.4395; val_edge_recon_loss: 2962517.7500; val_gene_expr_recon_loss: 1796836.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4763244.0000; val_optim_loss: 4763244.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8390; val_auprc_score: 0.8408; val_best_acc_score: 0.7375; val_best_f1_score: 0.7665; train_kl_reg_loss: 4129.1240; train_edge_recon_loss: 3000629.7500; train_gene_expr_recon_loss: 1704794.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4709553.5000; train_optim_loss: 4709553.5000; val_kl_reg_loss: 6405.7217; val_edge_recon_loss: 2981834.7500; val_gene_expr_recon_loss: 1788894.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4777135.0000; val_optim_loss: 4777135.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8408; val_auprc_score: 0.8323; val_best_acc_score: 0.7439; val_best_f1_score: 0.7735; train_kl_reg_loss: 7001.4966; train_edge_recon_loss: 2944619.5000; train_gene_expr_recon_loss: 1695962.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4647583.7500; train_optim_loss: 4647583.7500; val_kl_reg_loss: 10029.3066; val_edge_recon_loss: 2951121.7500; val_gene_expr_recon_loss: 1776665.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4737816.0000; val_optim_loss: 4737816.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8355; val_auprc_score: 0.8303; val_best_acc_score: 0.7410; val_best_f1_score: 0.7737; train_kl_reg_loss: 10433.0083; train_edge_recon_loss: 2911366.8750; train_gene_expr_recon_loss: 1685811.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4607611.5000; train_optim_loss: 4607611.5000; val_kl_reg_loss: 13818.2334; val_edge_recon_loss: 2954820.5000; val_gene_expr_recon_loss: 1756371.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4725010.0000; val_optim_loss: 4725010.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8320; val_auprc_score: 0.8245; val_best_acc_score: 0.7436; val_best_f1_score: 0.7699; train_kl_reg_loss: 14042.4829; train_edge_recon_loss: 2905092.7500; train_gene_expr_recon_loss: 1672442.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4591577.5000; train_optim_loss: 4591577.5000; val_kl_reg_loss: 17797.3730; val_edge_recon_loss: 2985698.0000; val_gene_expr_recon_loss: 1747512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4751007.0000; val_optim_loss: 4751007.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8404; val_auprc_score: 0.8302; val_best_acc_score: 0.7511; val_best_f1_score: 0.7785; train_kl_reg_loss: 17865.9375; train_edge_recon_loss: 2940600.8750; train_gene_expr_recon_loss: 1659690.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4618157.5000; train_optim_loss: 4618157.5000; val_kl_reg_loss: 21222.9062; val_edge_recon_loss: 2928090.5000; val_gene_expr_recon_loss: 1732532.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4681846.0000; val_optim_loss: 4681846.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8365; val_auprc_score: 0.8256; val_best_acc_score: 0.7503; val_best_f1_score: 0.7746; train_kl_reg_loss: 21176.0391; train_edge_recon_loss: 2889629.8750; train_gene_expr_recon_loss: 1647448.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4558255.0000; train_optim_loss: 4558255.0000; val_kl_reg_loss: 23187.1113; val_edge_recon_loss: 2952287.0000; val_gene_expr_recon_loss: 1722665.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4698139.5000; val_optim_loss: 4698139.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8366; val_auprc_score: 0.8278; val_best_acc_score: 0.7450; val_best_f1_score: 0.7746; train_kl_reg_loss: 22211.7900; train_edge_recon_loss: 2922119.0000; train_gene_expr_recon_loss: 1636800.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4581131.5000; train_optim_loss: 4581131.5000; val_kl_reg_loss: 23538.2129; val_edge_recon_loss: 2947959.5000; val_gene_expr_recon_loss: 1710890.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4682388.0000; val_optim_loss: 4682388.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8343; val_auprc_score: 0.8193; val_best_acc_score: 0.7442; val_best_f1_score: 0.7737; train_kl_reg_loss: 22919.5303; train_edge_recon_loss: 2892085.1250; train_gene_expr_recon_loss: 1626478.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4541483.5000; train_optim_loss: 4541483.5000; val_kl_reg_loss: 25225.5273; val_edge_recon_loss: 2958253.0000; val_gene_expr_recon_loss: 1695758.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4679236.5000; val_optim_loss: 4679236.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8432; val_auprc_score: 0.8321; val_best_acc_score: 0.7476; val_best_f1_score: 0.7800; train_kl_reg_loss: 24466.2578; train_edge_recon_loss: 2908667.3750; train_gene_expr_recon_loss: 1614238.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4547372.0000; train_optim_loss: 4547372.0000; val_kl_reg_loss: 26922.7793; val_edge_recon_loss: 2907411.5000; val_gene_expr_recon_loss: 1682219.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4616554.0000; val_optim_loss: 4616554.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8463; val_auprc_score: 0.8365; val_best_acc_score: 0.7511; val_best_f1_score: 0.7827; train_kl_reg_loss: 26216.2314; train_edge_recon_loss: 2918252.5000; train_gene_expr_recon_loss: 1602750.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4547219.5000; train_optim_loss: 4547219.5000; val_kl_reg_loss: 28699.2891; val_edge_recon_loss: 2896460.0000; val_gene_expr_recon_loss: 1675574.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4600734.0000; val_optim_loss: 4600734.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8535; val_auprc_score: 0.8444; val_best_acc_score: 0.7611; val_best_f1_score: 0.7847; train_kl_reg_loss: 27919.5195; train_edge_recon_loss: 2897434.0000; train_gene_expr_recon_loss: 1590829.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4516183.0000; train_optim_loss: 4516183.0000; val_kl_reg_loss: 30508.7578; val_edge_recon_loss: 2878568.2500; val_gene_expr_recon_loss: 1660392.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4569469.0000; val_optim_loss: 4569469.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8482; val_auprc_score: 0.8443; val_best_acc_score: 0.7524; val_best_f1_score: 0.7793; train_kl_reg_loss: 29708.6455; train_edge_recon_loss: 2835228.5000; train_gene_expr_recon_loss: 1579698.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4444636.0000; train_optim_loss: 4444636.0000; val_kl_reg_loss: 31383.2148; val_edge_recon_loss: 2917897.5000; val_gene_expr_recon_loss: 1650186.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4599467.0000; val_optim_loss: 4599467.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8552; val_auprc_score: 0.8463; val_best_acc_score: 0.7633; val_best_f1_score: 0.7857; train_kl_reg_loss: 29715.6230; train_edge_recon_loss: 2861456.7500; train_gene_expr_recon_loss: 1570452.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4461625.0000; train_optim_loss: 4461625.0000; val_kl_reg_loss: 31448.1152; val_edge_recon_loss: 2875271.7500; val_gene_expr_recon_loss: 1640495.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4547215.0000; val_optim_loss: 4547215.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8536; val_auprc_score: 0.8468; val_best_acc_score: 0.7611; val_best_f1_score: 0.7814; train_kl_reg_loss: 29617.2676; train_edge_recon_loss: 2873023.7500; train_gene_expr_recon_loss: 1561227.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4463868.0000; train_optim_loss: 4463868.0000; val_kl_reg_loss: 30993.4609; val_edge_recon_loss: 2914777.7500; val_gene_expr_recon_loss: 1626646.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4572418.0000; val_optim_loss: 4572418.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8504; val_auprc_score: 0.8402; val_best_acc_score: 0.7572; val_best_f1_score: 0.7826; train_kl_reg_loss: 29439.7236; train_edge_recon_loss: 2891074.8750; train_gene_expr_recon_loss: 1550677.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4471192.0000; train_optim_loss: 4471192.0000; val_kl_reg_loss: 29301.3438; val_edge_recon_loss: 2912893.2500; val_gene_expr_recon_loss: 1613226.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4555421.0000; val_optim_loss: 4555421.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8463; val_auprc_score: 0.8339; val_best_acc_score: 0.7511; val_best_f1_score: 0.7809; train_kl_reg_loss: 27761.3594; train_edge_recon_loss: 2918873.1250; train_gene_expr_recon_loss: 1541796.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4488430.5000; train_optim_loss: 4488430.5000; val_kl_reg_loss: 27941.2773; val_edge_recon_loss: 2931144.0000; val_gene_expr_recon_loss: 1612338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4571423.0000; val_optim_loss: 4571423.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8598; val_auprc_score: 0.8478; val_best_acc_score: 0.7664; val_best_f1_score: 0.7865; train_kl_reg_loss: 26060.0000; train_edge_recon_loss: 2857214.0000; train_gene_expr_recon_loss: 1534888.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4418162.7500; train_optim_loss: 4418162.7500; val_kl_reg_loss: 27111.7344; val_edge_recon_loss: 2882873.0000; val_gene_expr_recon_loss: 1604620.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4514605.5000; val_optim_loss: 4514605.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8611; val_auprc_score: 0.8507; val_best_acc_score: 0.7664; val_best_f1_score: 0.7856; train_kl_reg_loss: 25749.3564; train_edge_recon_loss: 2860009.3750; train_gene_expr_recon_loss: 1528117.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4413876.0000; train_optim_loss: 4413876.0000; val_kl_reg_loss: 27533.1992; val_edge_recon_loss: 2898783.7500; val_gene_expr_recon_loss: 1592397.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4518715.0000; val_optim_loss: 4518715.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8722; val_auprc_score: 0.8650; val_best_acc_score: 0.7728; val_best_f1_score: 0.7921; train_kl_reg_loss: 26572.9727; train_edge_recon_loss: 2842928.7500; train_gene_expr_recon_loss: 1519945.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4389447.2500; train_optim_loss: 4389447.2500; val_kl_reg_loss: 28706.1543; val_edge_recon_loss: 2861956.0000; val_gene_expr_recon_loss: 1587647.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4478309.5000; val_optim_loss: 4478309.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8685; val_auprc_score: 0.8566; val_best_acc_score: 0.7736; val_best_f1_score: 0.7979; train_kl_reg_loss: 27717.0430; train_edge_recon_loss: 2889883.2500; train_gene_expr_recon_loss: 1511129.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428729.5000; train_optim_loss: 4428729.5000; val_kl_reg_loss: 28440.7930; val_edge_recon_loss: 2828553.0000; val_gene_expr_recon_loss: 1577216.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4434210.0000; val_optim_loss: 4434210.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8688; val_auprc_score: 0.8579; val_best_acc_score: 0.7755; val_best_f1_score: 0.7983; train_kl_reg_loss: 26816.6445; train_edge_recon_loss: 2836770.5000; train_gene_expr_recon_loss: 1502487.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4366074.5000; train_optim_loss: 4366074.5000; val_kl_reg_loss: 26872.8242; val_edge_recon_loss: 2883969.7500; val_gene_expr_recon_loss: 1569957.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4480799.5000; val_optim_loss: 4480799.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8677; val_auprc_score: 0.8527; val_best_acc_score: 0.7667; val_best_f1_score: 0.7974; train_kl_reg_loss: 25072.6895; train_edge_recon_loss: 2873362.2500; train_gene_expr_recon_loss: 1497109.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4395544.2500; train_optim_loss: 4395544.2500; val_kl_reg_loss: 24826.4258; val_edge_recon_loss: 2890757.2500; val_gene_expr_recon_loss: 1563715.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4479299.5000; val_optim_loss: 4479299.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8757; val_auprc_score: 0.8679; val_best_acc_score: 0.7731; val_best_f1_score: 0.7986; train_kl_reg_loss: 23285.5068; train_edge_recon_loss: 2888559.2500; train_gene_expr_recon_loss: 1492980.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4404825.7500; train_optim_loss: 4404825.7500; val_kl_reg_loss: 22368.3633; val_edge_recon_loss: 2886099.0000; val_gene_expr_recon_loss: 1557817.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4466285.0000; val_optim_loss: 4466285.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8834; val_auprc_score: 0.8724; val_best_acc_score: 0.7874; val_best_f1_score: 0.8070; train_kl_reg_loss: 21138.0312; train_edge_recon_loss: 2847650.7500; train_gene_expr_recon_loss: 1489254.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4358043.0000; train_optim_loss: 4358043.0000; val_kl_reg_loss: 21063.0664; val_edge_recon_loss: 2847522.2500; val_gene_expr_recon_loss: 1557434.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4426020.0000; val_optim_loss: 4426020.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8924; val_auprc_score: 0.8828; val_best_acc_score: 0.7985; val_best_f1_score: 0.8173; train_kl_reg_loss: 20027.6973; train_edge_recon_loss: 2835239.8750; train_gene_expr_recon_loss: 1483688.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4338956.2500; train_optim_loss: 4338956.2500; val_kl_reg_loss: 20382.1914; val_edge_recon_loss: 2810227.0000; val_gene_expr_recon_loss: 1551455.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4382065.0000; val_optim_loss: 4382065.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8894; val_auprc_score: 0.8722; val_best_acc_score: 0.7937; val_best_f1_score: 0.8139; train_kl_reg_loss: 19411.9648; train_edge_recon_loss: 2859810.3750; train_gene_expr_recon_loss: 1478426.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4357648.7500; train_optim_loss: 4357648.7500; val_kl_reg_loss: 19912.8516; val_edge_recon_loss: 2859698.7500; val_gene_expr_recon_loss: 1543716.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4423328.0000; val_optim_loss: 4423328.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8962; val_auprc_score: 0.8820; val_best_acc_score: 0.8012; val_best_f1_score: 0.8260; train_kl_reg_loss: 19360.4824; train_edge_recon_loss: 2799574.8750; train_gene_expr_recon_loss: 1473550.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4292486.0000; train_optim_loss: 4292486.0000; val_kl_reg_loss: 20948.2930; val_edge_recon_loss: 2769070.0000; val_gene_expr_recon_loss: 1534315.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4324333.5000; val_optim_loss: 4324333.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8935; val_auprc_score: 0.8786; val_best_acc_score: 0.7953; val_best_f1_score: 0.8191; train_kl_reg_loss: 20037.0332; train_edge_recon_loss: 2802423.2500; train_gene_expr_recon_loss: 1465445.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4287905.2500; train_optim_loss: 4287905.2500; val_kl_reg_loss: 21308.2012; val_edge_recon_loss: 2829091.7500; val_gene_expr_recon_loss: 1527633.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4378033.0000; val_optim_loss: 4378033.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9034; val_auprc_score: 0.8901; val_best_acc_score: 0.8081; val_best_f1_score: 0.8256; train_kl_reg_loss: 20338.2109; train_edge_recon_loss: 2825490.3750; train_gene_expr_recon_loss: 1458682.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4304511.0000; train_optim_loss: 4304511.0000; val_kl_reg_loss: 21182.1328; val_edge_recon_loss: 2795695.0000; val_gene_expr_recon_loss: 1524315.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4341192.5000; val_optim_loss: 4341192.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9019; val_auprc_score: 0.8791; val_best_acc_score: 0.8134; val_best_f1_score: 0.8260; train_kl_reg_loss: 20200.5156; train_edge_recon_loss: 2809082.7500; train_gene_expr_recon_loss: 1453427.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4282710.5000; train_optim_loss: 4282710.5000; val_kl_reg_loss: 21401.6797; val_edge_recon_loss: 2790991.0000; val_gene_expr_recon_loss: 1518969.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4331362.5000; val_optim_loss: 4331362.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9087; val_auprc_score: 0.8866; val_best_acc_score: 0.8271; val_best_f1_score: 0.8371; train_kl_reg_loss: 20370.8672; train_edge_recon_loss: 2787463.6250; train_gene_expr_recon_loss: 1447493.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4255328.0000; train_optim_loss: 4255328.0000; val_kl_reg_loss: 22041.2637; val_edge_recon_loss: 2774614.0000; val_gene_expr_recon_loss: 1515210.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4311866.0000; val_optim_loss: 4311866.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9175; val_auprc_score: 0.8964; val_best_acc_score: 0.8404; val_best_f1_score: 0.8522; train_kl_reg_loss: 20833.3975; train_edge_recon_loss: 2786173.3750; train_gene_expr_recon_loss: 1440309.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4247316.0000; train_optim_loss: 4247316.0000; val_kl_reg_loss: 21492.5078; val_edge_recon_loss: 2694147.5000; val_gene_expr_recon_loss: 1505443.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4221083.0000; val_optim_loss: 4221083.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9120; val_auprc_score: 0.8878; val_best_acc_score: 0.8327; val_best_f1_score: 0.8430; train_kl_reg_loss: 20371.3682; train_edge_recon_loss: 2743411.7500; train_gene_expr_recon_loss: 1436590.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4200373.6250; train_optim_loss: 4200373.6250; val_kl_reg_loss: 20656.7559; val_edge_recon_loss: 2767447.7500; val_gene_expr_recon_loss: 1502248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4290352.5000; val_optim_loss: 4290352.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9278; val_auprc_score: 0.9075; val_best_acc_score: 0.8521; val_best_f1_score: 0.8604; train_kl_reg_loss: 19629.3428; train_edge_recon_loss: 2743796.6250; train_gene_expr_recon_loss: 1434974.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4198400.7500; train_optim_loss: 4198400.7500; val_kl_reg_loss: 19740.5469; val_edge_recon_loss: 2711971.0000; val_gene_expr_recon_loss: 1500040.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4231752.0000; val_optim_loss: 4231752.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9253; val_auprc_score: 0.8951; val_best_acc_score: 0.8539; val_best_f1_score: 0.8622; train_kl_reg_loss: 18890.7734; train_edge_recon_loss: 2763108.0000; train_gene_expr_recon_loss: 1432921.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4214920.0000; train_optim_loss: 4214920.0000; val_kl_reg_loss: 19637.6914; val_edge_recon_loss: 2724880.0000; val_gene_expr_recon_loss: 1496722.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4241240.5000; val_optim_loss: 4241240.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9240; val_auprc_score: 0.9018; val_best_acc_score: 0.8526; val_best_f1_score: 0.8622; train_kl_reg_loss: 18818.6211; train_edge_recon_loss: 2725930.3750; train_gene_expr_recon_loss: 1430950.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4175699.8750; train_optim_loss: 4175699.8750; val_kl_reg_loss: 20252.8438; val_edge_recon_loss: 2726404.2500; val_gene_expr_recon_loss: 1496418.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4243075.0000; val_optim_loss: 4243075.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9299; val_auprc_score: 0.9075; val_best_acc_score: 0.8616; val_best_f1_score: 0.8678; train_kl_reg_loss: 19679.3623; train_edge_recon_loss: 2721156.8750; train_gene_expr_recon_loss: 1426668.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4167505.0000; train_optim_loss: 4167505.0000; val_kl_reg_loss: 20446.5625; val_edge_recon_loss: 2695126.0000; val_gene_expr_recon_loss: 1489802.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4205374.5000; val_optim_loss: 4205374.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9299; val_auprc_score: 0.9055; val_best_acc_score: 0.8568; val_best_f1_score: 0.8675; train_kl_reg_loss: 19731.4766; train_edge_recon_loss: 2723242.3750; train_gene_expr_recon_loss: 1426133.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4169107.6250; train_optim_loss: 4169107.6250; val_kl_reg_loss: 20533.8438; val_edge_recon_loss: 2722331.5000; val_gene_expr_recon_loss: 1489772.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4232638.0000; val_optim_loss: 4232638.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9254; val_auprc_score: 0.9002; val_best_acc_score: 0.8576; val_best_f1_score: 0.8676; train_kl_reg_loss: 19929.5020; train_edge_recon_loss: 2719347.2500; train_gene_expr_recon_loss: 1425170.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4164447.3750; train_optim_loss: 4164447.3750; val_kl_reg_loss: 20648.7598; val_edge_recon_loss: 2726660.7500; val_gene_expr_recon_loss: 1490159.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4237469.0000; val_optim_loss: 4237469.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9290; val_auprc_score: 0.9039; val_best_acc_score: 0.8608; val_best_f1_score: 0.8685; train_kl_reg_loss: 19838.2148; train_edge_recon_loss: 2730264.7500; train_gene_expr_recon_loss: 1424235.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4174338.6250; train_optim_loss: 4174338.6250; val_kl_reg_loss: 20783.2500; val_edge_recon_loss: 2730420.5000; val_gene_expr_recon_loss: 1488913.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4240117.0000; val_optim_loss: 4240117.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9256; val_auprc_score: 0.9065; val_best_acc_score: 0.8552; val_best_f1_score: 0.8645; train_kl_reg_loss: 19850.0742; train_edge_recon_loss: 2708453.8750; train_gene_expr_recon_loss: 1423366.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4151670.7500; train_optim_loss: 4151670.7500; val_kl_reg_loss: 20896.0898; val_edge_recon_loss: 2752437.5000; val_gene_expr_recon_loss: 1489001.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4262335.0000; val_optim_loss: 4262335.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9304; val_auprc_score: 0.9073; val_best_acc_score: 0.8648; val_best_f1_score: 0.8741; train_kl_reg_loss: 20049.0830; train_edge_recon_loss: 2700538.6250; train_gene_expr_recon_loss: 1423108.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4143696.0000; train_optim_loss: 4143696.0000; val_kl_reg_loss: 20935.9160; val_edge_recon_loss: 2716182.5000; val_gene_expr_recon_loss: 1488967.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4226086.0000; val_optim_loss: 4226086.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9246; val_auprc_score: 0.8978; val_best_acc_score: 0.8523; val_best_f1_score: 0.8608; train_kl_reg_loss: 20031.8008; train_edge_recon_loss: 2714085.1250; train_gene_expr_recon_loss: 1423211.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4157328.8750; train_optim_loss: 4157328.8750; val_kl_reg_loss: 21042.7070; val_edge_recon_loss: 2760608.0000; val_gene_expr_recon_loss: 1488667.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4270318.0000; val_optim_loss: 4270318.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9210; val_auprc_score: 0.8922; val_best_acc_score: 0.8518; val_best_f1_score: 0.8604; train_kl_reg_loss: 20052.5039; train_edge_recon_loss: 2715803.5000; train_gene_expr_recon_loss: 1423008.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4158864.3750; train_optim_loss: 4158864.3750; val_kl_reg_loss: 21049.2324; val_edge_recon_loss: 2759575.5000; val_gene_expr_recon_loss: 1490015.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4270640.5000; val_optim_loss: 4270640.5000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9251; val_auprc_score: 0.9004; val_best_acc_score: 0.8566; val_best_f1_score: 0.8636; train_kl_reg_loss: 20080.4258; train_edge_recon_loss: 2747362.2500; train_gene_expr_recon_loss: 1422888.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4190331.1250; train_optim_loss: 4190331.1250; val_kl_reg_loss: 20888.2930; val_edge_recon_loss: 2743489.7500; val_gene_expr_recon_loss: 1490341.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4254720.0000; val_optim_loss: 4254720.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 4 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9244
val AUPRC score: 0.8931
val best accuracy score: 0.8563
val best F1 score: 0.8634
val target rna MSE score: 0.0100
val source rna MSE score: 0.0032
Duration of model training in run 8: 0 hours, 1 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 16983
Number of validation edges: 1886
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9400; val_auprc_score: 0.9296; val_best_acc_score: 0.8484; val_best_f1_score: 0.8438; train_kl_reg_loss: 7.8594; train_edge_recon_loss: 3467341.3750; train_gene_expr_recon_loss: 1784815.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5252164.5000; train_optim_loss: 5252164.5000; val_kl_reg_loss: 53.7268; val_edge_recon_loss: 4042450.2500; val_gene_expr_recon_loss: 1770511.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5813015.0000; val_optim_loss: 5813015.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9191; val_auprc_score: 0.9099; val_best_acc_score: 0.5710; val_best_f1_score: 0.6998; train_kl_reg_loss: 105.5944; train_edge_recon_loss: 3463580.0000; train_gene_expr_recon_loss: 1761898.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225584.2500; train_optim_loss: 5225584.2500; val_kl_reg_loss: 335.4376; val_edge_recon_loss: 4061363.7500; val_gene_expr_recon_loss: 1770178.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5831878.0000; val_optim_loss: 5831878.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9039; val_auprc_score: 0.8956; val_best_acc_score: 0.5551; val_best_f1_score: 0.6921; train_kl_reg_loss: 439.9254; train_edge_recon_loss: 3459788.6250; train_gene_expr_recon_loss: 1753635.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5213863.5000; train_optim_loss: 5213863.5000; val_kl_reg_loss: 753.0521; val_edge_recon_loss: 4062476.5000; val_gene_expr_recon_loss: 1764323.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5827553.0000; val_optim_loss: 5827553.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8907; val_auprc_score: 0.8804; val_best_acc_score: 0.6326; val_best_f1_score: 0.7309; train_kl_reg_loss: 769.6096; train_edge_recon_loss: 3464410.3750; train_gene_expr_recon_loss: 1747745.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5212925.7500; train_optim_loss: 5212925.7500; val_kl_reg_loss: 896.9393; val_edge_recon_loss: 4058070.7500; val_gene_expr_recon_loss: 1767491.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5826459.0000; val_optim_loss: 5826459.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8700; val_auprc_score: 0.8627; val_best_acc_score: 0.7336; val_best_f1_score: 0.7828; train_kl_reg_loss: 855.4956; train_edge_recon_loss: 3462132.0000; train_gene_expr_recon_loss: 1745131.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5208119.2500; train_optim_loss: 5208119.2500; val_kl_reg_loss: 912.7281; val_edge_recon_loss: 4040429.2500; val_gene_expr_recon_loss: 1762131.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5803473.5000; val_optim_loss: 5803473.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8540; val_auprc_score: 0.8403; val_best_acc_score: 0.7667; val_best_f1_score: 0.7894; train_kl_reg_loss: 872.2419; train_edge_recon_loss: 3457100.2500; train_gene_expr_recon_loss: 1741151.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5199124.5000; train_optim_loss: 5199124.5000; val_kl_reg_loss: 900.5217; val_edge_recon_loss: 3984545.5000; val_gene_expr_recon_loss: 1750945.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5736391.0000; val_optim_loss: 5736391.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8337; val_auprc_score: 0.8254; val_best_acc_score: 0.7484; val_best_f1_score: 0.7646; train_kl_reg_loss: 868.9084; train_edge_recon_loss: 3445502.7500; train_gene_expr_recon_loss: 1737425.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5183797.2500; train_optim_loss: 5183797.2500; val_kl_reg_loss: 888.2662; val_edge_recon_loss: 3864968.5000; val_gene_expr_recon_loss: 1746563.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5612420.0000; val_optim_loss: 5612420.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8181; val_auprc_score: 0.8103; val_best_acc_score: 0.7280; val_best_f1_score: 0.7644; train_kl_reg_loss: 858.9275; train_edge_recon_loss: 3434556.8750; train_gene_expr_recon_loss: 1732173.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5167588.7500; train_optim_loss: 5167588.7500; val_kl_reg_loss: 904.2478; val_edge_recon_loss: 3666728.5000; val_gene_expr_recon_loss: 1739464.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5407097.0000; val_optim_loss: 5407097.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8138; val_auprc_score: 0.7984; val_best_acc_score: 0.7306; val_best_f1_score: 0.7638; train_kl_reg_loss: 893.1423; train_edge_recon_loss: 3409620.6250; train_gene_expr_recon_loss: 1726761.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5137275.5000; train_optim_loss: 5137275.5000; val_kl_reg_loss: 984.0001; val_edge_recon_loss: 3400422.0000; val_gene_expr_recon_loss: 1736645.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5138051.0000; val_optim_loss: 5138051.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8422; val_auprc_score: 0.8280; val_best_acc_score: 0.7511; val_best_f1_score: 0.7834; train_kl_reg_loss: 970.6792; train_edge_recon_loss: 3358145.0000; train_gene_expr_recon_loss: 1722905.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5082021.2500; train_optim_loss: 5082021.2500; val_kl_reg_loss: 1141.6511; val_edge_recon_loss: 3086223.0000; val_gene_expr_recon_loss: 1736272.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4823637.0000; val_optim_loss: 4823637.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8441; val_auprc_score: 0.8324; val_best_acc_score: 0.7436; val_best_f1_score: 0.7808; train_kl_reg_loss: 1150.3271; train_edge_recon_loss: 3313775.1250; train_gene_expr_recon_loss: 1718728.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5033653.2500; train_optim_loss: 5033653.2500; val_kl_reg_loss: 1458.1108; val_edge_recon_loss: 3018096.0000; val_gene_expr_recon_loss: 1728066.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4747620.5000; val_optim_loss: 4747620.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8449; val_auprc_score: 0.8407; val_best_acc_score: 0.7452; val_best_f1_score: 0.7844; train_kl_reg_loss: 1503.2762; train_edge_recon_loss: 3211191.0000; train_gene_expr_recon_loss: 1715078.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4927772.7500; train_optim_loss: 4927772.7500; val_kl_reg_loss: 2104.0107; val_edge_recon_loss: 2945377.2500; val_gene_expr_recon_loss: 1720216.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4667698.0000; val_optim_loss: 4667698.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8511; val_auprc_score: 0.8460; val_best_acc_score: 0.7513; val_best_f1_score: 0.7884; train_kl_reg_loss: 2247.0637; train_edge_recon_loss: 3137373.6250; train_gene_expr_recon_loss: 1710739.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4850360.0000; train_optim_loss: 4850360.0000; val_kl_reg_loss: 3202.4873; val_edge_recon_loss: 2878883.0000; val_gene_expr_recon_loss: 1713462.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4595548.0000; val_optim_loss: 4595548.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8384; val_auprc_score: 0.8272; val_best_acc_score: 0.7397; val_best_f1_score: 0.7783; train_kl_reg_loss: 3498.2917; train_edge_recon_loss: 3040287.2500; train_gene_expr_recon_loss: 1704098.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4747884.0000; train_optim_loss: 4747884.0000; val_kl_reg_loss: 4966.3999; val_edge_recon_loss: 2928267.7500; val_gene_expr_recon_loss: 1711401.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4644635.0000; val_optim_loss: 4644635.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8435; val_auprc_score: 0.8355; val_best_acc_score: 0.7428; val_best_f1_score: 0.7813; train_kl_reg_loss: 5430.7717; train_edge_recon_loss: 2938704.6250; train_gene_expr_recon_loss: 1696092.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4640227.5000; train_optim_loss: 4640227.5000; val_kl_reg_loss: 7855.2427; val_edge_recon_loss: 2899024.2500; val_gene_expr_recon_loss: 1701483.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4608363.0000; val_optim_loss: 4608363.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8540; val_auprc_score: 0.8504; val_best_acc_score: 0.7521; val_best_f1_score: 0.7829; train_kl_reg_loss: 8399.6045; train_edge_recon_loss: 2890744.5000; train_gene_expr_recon_loss: 1687286.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4586431.0000; train_optim_loss: 4586431.0000; val_kl_reg_loss: 11779.3809; val_edge_recon_loss: 2885568.2500; val_gene_expr_recon_loss: 1688404.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4585752.0000; val_optim_loss: 4585752.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8453; val_auprc_score: 0.8357; val_best_acc_score: 0.7497; val_best_f1_score: 0.7773; train_kl_reg_loss: 12687.8701; train_edge_recon_loss: 2914825.3750; train_gene_expr_recon_loss: 1673896.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4601410.2500; train_optim_loss: 4601410.2500; val_kl_reg_loss: 15743.4473; val_edge_recon_loss: 2939594.5000; val_gene_expr_recon_loss: 1670037.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4625375.0000; val_optim_loss: 4625375.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8427; val_auprc_score: 0.8352; val_best_acc_score: 0.7410; val_best_f1_score: 0.7823; train_kl_reg_loss: 16036.1001; train_edge_recon_loss: 2901978.1250; train_gene_expr_recon_loss: 1659376.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4577390.5000; train_optim_loss: 4577390.5000; val_kl_reg_loss: 18477.9355; val_edge_recon_loss: 2905412.2500; val_gene_expr_recon_loss: 1658637.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4582528.0000; val_optim_loss: 4582528.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8439; val_auprc_score: 0.8396; val_best_acc_score: 0.7378; val_best_f1_score: 0.7801; train_kl_reg_loss: 18487.4355; train_edge_recon_loss: 2915635.5000; train_gene_expr_recon_loss: 1648499.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4582622.0000; train_optim_loss: 4582622.0000; val_kl_reg_loss: 20137.0527; val_edge_recon_loss: 2916427.5000; val_gene_expr_recon_loss: 1647847.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4584412.0000; val_optim_loss: 4584412.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8346; val_auprc_score: 0.8292; val_best_acc_score: 0.7359; val_best_f1_score: 0.7722; train_kl_reg_loss: 20065.6230; train_edge_recon_loss: 2921759.7500; train_gene_expr_recon_loss: 1637358.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4579183.2500; train_optim_loss: 4579183.2500; val_kl_reg_loss: 21290.1094; val_edge_recon_loss: 2988167.7500; val_gene_expr_recon_loss: 1637663.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4647121.0000; val_optim_loss: 4647121.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8436; val_auprc_score: 0.8312; val_best_acc_score: 0.7420; val_best_f1_score: 0.7820; train_kl_reg_loss: 21078.2832; train_edge_recon_loss: 2881980.0000; train_gene_expr_recon_loss: 1626113.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4529171.7500; train_optim_loss: 4529171.7500; val_kl_reg_loss: 23596.1328; val_edge_recon_loss: 2919671.5000; val_gene_expr_recon_loss: 1621408.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4564676.5000; val_optim_loss: 4564676.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8506; val_auprc_score: 0.8396; val_best_acc_score: 0.7580; val_best_f1_score: 0.7898; train_kl_reg_loss: 23946.9512; train_edge_recon_loss: 2876653.8750; train_gene_expr_recon_loss: 1609730.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4510331.5000; train_optim_loss: 4510331.5000; val_kl_reg_loss: 27682.8652; val_edge_recon_loss: 2858364.0000; val_gene_expr_recon_loss: 1604383.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4490430.0000; val_optim_loss: 4490430.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8480; val_auprc_score: 0.8348; val_best_acc_score: 0.7556; val_best_f1_score: 0.7828; train_kl_reg_loss: 27703.8643; train_edge_recon_loss: 2914259.3750; train_gene_expr_recon_loss: 1593616.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4535579.2500; train_optim_loss: 4535579.2500; val_kl_reg_loss: 30715.5664; val_edge_recon_loss: 2919128.7500; val_gene_expr_recon_loss: 1591132.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4540977.0000; val_optim_loss: 4540977.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8471; val_auprc_score: 0.8335; val_best_acc_score: 0.7561; val_best_f1_score: 0.7795; train_kl_reg_loss: 29761.3623; train_edge_recon_loss: 2870382.5000; train_gene_expr_recon_loss: 1580137.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4480281.2500; train_optim_loss: 4480281.2500; val_kl_reg_loss: 30036.5352; val_edge_recon_loss: 2945769.2500; val_gene_expr_recon_loss: 1576981.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4552787.0000; val_optim_loss: 4552787.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8458; val_auprc_score: 0.8312; val_best_acc_score: 0.7595; val_best_f1_score: 0.7860; train_kl_reg_loss: 28954.2168; train_edge_recon_loss: 2881209.0000; train_gene_expr_recon_loss: 1569474.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4479637.7500; train_optim_loss: 4479637.7500; val_kl_reg_loss: 29130.0352; val_edge_recon_loss: 2908410.2500; val_gene_expr_recon_loss: 1566236.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4503777.0000; val_optim_loss: 4503777.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8557; val_auprc_score: 0.8456; val_best_acc_score: 0.7614; val_best_f1_score: 0.7876; train_kl_reg_loss: 28423.6660; train_edge_recon_loss: 2922680.3750; train_gene_expr_recon_loss: 1560098.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4511203.0000; train_optim_loss: 4511203.0000; val_kl_reg_loss: 30134.5469; val_edge_recon_loss: 2892333.7500; val_gene_expr_recon_loss: 1557585.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4480053.0000; val_optim_loss: 4480053.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8581; val_auprc_score: 0.8491; val_best_acc_score: 0.7609; val_best_f1_score: 0.7899; train_kl_reg_loss: 29192.6084; train_edge_recon_loss: 2934215.7500; train_gene_expr_recon_loss: 1549694.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4513102.7500; train_optim_loss: 4513102.7500; val_kl_reg_loss: 31081.9180; val_edge_recon_loss: 2871452.5000; val_gene_expr_recon_loss: 1547265.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4449800.0000; val_optim_loss: 4449800.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8591; val_auprc_score: 0.8479; val_best_acc_score: 0.7619; val_best_f1_score: 0.7898; train_kl_reg_loss: 30071.2188; train_edge_recon_loss: 2859408.7500; train_gene_expr_recon_loss: 1539422.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428902.0000; train_optim_loss: 4428902.0000; val_kl_reg_loss: 30975.2832; val_edge_recon_loss: 2871546.5000; val_gene_expr_recon_loss: 1535708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4438230.0000; val_optim_loss: 4438230.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8678; val_auprc_score: 0.8476; val_best_acc_score: 0.7736; val_best_f1_score: 0.7962; train_kl_reg_loss: 29938.9219; train_edge_recon_loss: 2879541.7500; train_gene_expr_recon_loss: 1531063.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4440544.5000; train_optim_loss: 4440544.5000; val_kl_reg_loss: 30017.5234; val_edge_recon_loss: 2819585.0000; val_gene_expr_recon_loss: 1532870.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4382473.0000; val_optim_loss: 4382473.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8540; val_auprc_score: 0.8468; val_best_acc_score: 0.7508; val_best_f1_score: 0.7838; train_kl_reg_loss: 28826.5840; train_edge_recon_loss: 2898778.3750; train_gene_expr_recon_loss: 1523917.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4451522.2500; train_optim_loss: 4451522.2500; val_kl_reg_loss: 27512.5020; val_edge_recon_loss: 2921792.0000; val_gene_expr_recon_loss: 1524042.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4473347.0000; val_optim_loss: 4473347.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8610; val_auprc_score: 0.8507; val_best_acc_score: 0.7587; val_best_f1_score: 0.7871; train_kl_reg_loss: 25858.6094; train_edge_recon_loss: 2871655.2500; train_gene_expr_recon_loss: 1518087.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4415601.0000; train_optim_loss: 4415601.0000; val_kl_reg_loss: 25472.3086; val_edge_recon_loss: 2891419.5000; val_gene_expr_recon_loss: 1518912.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4435804.0000; val_optim_loss: 4435804.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8637; val_auprc_score: 0.8580; val_best_acc_score: 0.7585; val_best_f1_score: 0.7876; train_kl_reg_loss: 24707.5674; train_edge_recon_loss: 2860122.7500; train_gene_expr_recon_loss: 1512069.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4396900.0000; train_optim_loss: 4396900.0000; val_kl_reg_loss: 24904.7812; val_edge_recon_loss: 2886566.7500; val_gene_expr_recon_loss: 1507342.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4418814.0000; val_optim_loss: 4418814.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8662; val_auprc_score: 0.8549; val_best_acc_score: 0.7638; val_best_f1_score: 0.7913; train_kl_reg_loss: 24362.6016; train_edge_recon_loss: 2893067.6250; train_gene_expr_recon_loss: 1504535.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4421966.2500; train_optim_loss: 4421966.2500; val_kl_reg_loss: 24809.5273; val_edge_recon_loss: 2874229.2500; val_gene_expr_recon_loss: 1499063.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4398102.5000; val_optim_loss: 4398102.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8710; val_auprc_score: 0.8609; val_best_acc_score: 0.7701; val_best_f1_score: 0.7910; train_kl_reg_loss: 24243.7383; train_edge_recon_loss: 2904926.2500; train_gene_expr_recon_loss: 1499380.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4428550.5000; train_optim_loss: 4428550.5000; val_kl_reg_loss: 24787.0742; val_edge_recon_loss: 2871343.5000; val_gene_expr_recon_loss: 1499445.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4395576.0000; val_optim_loss: 4395576.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8671; val_auprc_score: 0.8525; val_best_acc_score: 0.7694; val_best_f1_score: 0.7922; train_kl_reg_loss: 24035.6094; train_edge_recon_loss: 2877693.2500; train_gene_expr_recon_loss: 1498750.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4400479.0000; train_optim_loss: 4400479.0000; val_kl_reg_loss: 24719.2344; val_edge_recon_loss: 2856971.5000; val_gene_expr_recon_loss: 1502128.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4383819.0000; val_optim_loss: 4383819.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8711; val_auprc_score: 0.8639; val_best_acc_score: 0.7696; val_best_f1_score: 0.7936; train_kl_reg_loss: 23911.8086; train_edge_recon_loss: 2875546.1250; train_gene_expr_recon_loss: 1497958.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4397416.0000; train_optim_loss: 4397416.0000; val_kl_reg_loss: 24717.9668; val_edge_recon_loss: 2863712.0000; val_gene_expr_recon_loss: 1497987.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4386418.0000; val_optim_loss: 4386418.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8661; val_auprc_score: 0.8528; val_best_acc_score: 0.7627; val_best_f1_score: 0.7905; train_kl_reg_loss: 24338.9902; train_edge_recon_loss: 2915377.7500; train_gene_expr_recon_loss: 1497111.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4436828.0000; train_optim_loss: 4436828.0000; val_kl_reg_loss: 24850.4453; val_edge_recon_loss: 2884809.2500; val_gene_expr_recon_loss: 1499806.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4409466.5000; val_optim_loss: 4409466.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 36 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.8562
val AUPRC score: 0.8344
val best accuracy score: 0.7601
val best F1 score: 0.7936
val target rna MSE score: 0.0103
val source rna MSE score: 0.0028
Duration of model training in run 7: 0 hours, 0 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 12735
Number of validation edges: 1415
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9501; val_auprc_score: 0.9319; val_best_acc_score: 0.8869; val_best_f1_score: 0.8920; train_kl_reg_loss: 2.1850; train_edge_recon_loss: 3466854.0000; train_gene_expr_recon_loss: 1802672.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5269529.0000; train_optim_loss: 5269529.0000; val_kl_reg_loss: 12.5166; val_edge_recon_loss: 3980456.5000; val_gene_expr_recon_loss: 1713822.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5694291.0000; val_optim_loss: 5694291.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9165; val_auprc_score: 0.8984; val_best_acc_score: 0.8166; val_best_f1_score: 0.8038; train_kl_reg_loss: 12.7701; train_edge_recon_loss: 3466565.0000; train_gene_expr_recon_loss: 1784871.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5251449.5000; train_optim_loss: 5251449.5000; val_kl_reg_loss: 57.6924; val_edge_recon_loss: 4042502.0000; val_gene_expr_recon_loss: 1708593.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5751153.0000; val_optim_loss: 5751153.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9061; val_auprc_score: 0.8919; val_best_acc_score: 0.6823; val_best_f1_score: 0.7587; train_kl_reg_loss: 59.3980; train_edge_recon_loss: 3463852.7500; train_gene_expr_recon_loss: 1774994.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238907.0000; train_optim_loss: 5238907.0000; val_kl_reg_loss: 170.1849; val_edge_recon_loss: 4057286.5000; val_gene_expr_recon_loss: 1707874.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5765331.5000; val_optim_loss: 5765331.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8969; val_auprc_score: 0.8800; val_best_acc_score: 0.5852; val_best_f1_score: 0.7068; train_kl_reg_loss: 176.1059; train_edge_recon_loss: 3461473.2500; train_gene_expr_recon_loss: 1769430.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231079.5000; train_optim_loss: 5231079.5000; val_kl_reg_loss: 374.7350; val_edge_recon_loss: 4061016.5000; val_gene_expr_recon_loss: 1710091.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5771483.0000; val_optim_loss: 5771483.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8823; val_auprc_score: 0.8604; val_best_acc_score: 0.5869; val_best_f1_score: 0.7077; train_kl_reg_loss: 383.4938; train_edge_recon_loss: 3460278.5000; train_gene_expr_recon_loss: 1764414.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225076.0000; train_optim_loss: 5225076.0000; val_kl_reg_loss: 561.7548; val_edge_recon_loss: 4060967.0000; val_gene_expr_recon_loss: 1705850.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5767379.0000; val_optim_loss: 5767379.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8776; val_auprc_score: 0.8634; val_best_acc_score: 0.6396; val_best_f1_score: 0.7348; train_kl_reg_loss: 576.3972; train_edge_recon_loss: 3462197.2500; train_gene_expr_recon_loss: 1761113.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5223887.0000; train_optim_loss: 5223887.0000; val_kl_reg_loss: 590.6675; val_edge_recon_loss: 4057473.0000; val_gene_expr_recon_loss: 1702712.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5760776.0000; val_optim_loss: 5760776.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8802; val_auprc_score: 0.8674; val_best_acc_score: 0.7124; val_best_f1_score: 0.7730; train_kl_reg_loss: 606.7907; train_edge_recon_loss: 3460462.7500; train_gene_expr_recon_loss: 1759365.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5220435.5000; train_optim_loss: 5220435.5000; val_kl_reg_loss: 524.6196; val_edge_recon_loss: 4048631.2500; val_gene_expr_recon_loss: 1701222.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5750378.0000; val_optim_loss: 5750378.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8601; val_auprc_score: 0.8433; val_best_acc_score: 0.7650; val_best_f1_score: 0.7978; train_kl_reg_loss: 547.6754; train_edge_recon_loss: 3454733.0000; train_gene_expr_recon_loss: 1758165.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5213446.5000; train_optim_loss: 5213446.5000; val_kl_reg_loss: 461.2439; val_edge_recon_loss: 4024482.7500; val_gene_expr_recon_loss: 1703318.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5728262.5000; val_optim_loss: 5728262.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8663; val_auprc_score: 0.8499; val_best_acc_score: 0.7799; val_best_f1_score: 0.8072; train_kl_reg_loss: 475.6242; train_edge_recon_loss: 3448903.7500; train_gene_expr_recon_loss: 1757713.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207092.5000; train_optim_loss: 5207092.5000; val_kl_reg_loss: 453.4699; val_edge_recon_loss: 4017597.5000; val_gene_expr_recon_loss: 1701025.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5719076.0000; val_optim_loss: 5719076.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9474
val AUPRC score: 0.9314
val best accuracy score: 0.8753
val best F1 score: 0.8822
val target rna MSE score: 0.0108
val source rna MSE score: 0.0036
Duration of model training in run 6: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 12735
Number of validation edges: 1415
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9447; val_auprc_score: 0.9260; val_best_acc_score: 0.8650; val_best_f1_score: 0.8769; train_kl_reg_loss: 2.1728; train_edge_recon_loss: 3465981.0000; train_gene_expr_recon_loss: 1781603.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247587.0000; train_optim_loss: 5247587.0000; val_kl_reg_loss: 13.2214; val_edge_recon_loss: 3988694.2500; val_gene_expr_recon_loss: 1806441.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5795149.0000; val_optim_loss: 5795149.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9239; val_auprc_score: 0.9075; val_best_acc_score: 0.8269; val_best_f1_score: 0.8193; train_kl_reg_loss: 12.7050; train_edge_recon_loss: 3465688.2500; train_gene_expr_recon_loss: 1762950.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5228651.0000; train_optim_loss: 5228651.0000; val_kl_reg_loss: 63.4082; val_edge_recon_loss: 4042524.7500; val_gene_expr_recon_loss: 1806092.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5848680.0000; val_optim_loss: 5848680.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9007; val_auprc_score: 0.8837; val_best_acc_score: 0.6756; val_best_f1_score: 0.7551; train_kl_reg_loss: 59.9810; train_edge_recon_loss: 3463668.0000; train_gene_expr_recon_loss: 1751888.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5215616.0000; train_optim_loss: 5215616.0000; val_kl_reg_loss: 193.6839; val_edge_recon_loss: 4057172.0000; val_gene_expr_recon_loss: 1808550.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5865916.0000; val_optim_loss: 5865916.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8989; val_auprc_score: 0.8880; val_best_acc_score: 0.5936; val_best_f1_score: 0.7111; train_kl_reg_loss: 183.1967; train_edge_recon_loss: 3461258.7500; train_gene_expr_recon_loss: 1746182.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207625.0000; train_optim_loss: 5207625.0000; val_kl_reg_loss: 411.0770; val_edge_recon_loss: 4060665.2500; val_gene_expr_recon_loss: 1794939.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5856016.0000; val_optim_loss: 5856016.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8914; val_auprc_score: 0.8744; val_best_acc_score: 0.6092; val_best_f1_score: 0.7190; train_kl_reg_loss: 390.8669; train_edge_recon_loss: 3460510.0000; train_gene_expr_recon_loss: 1741049.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5201950.0000; train_optim_loss: 5201950.0000; val_kl_reg_loss: 594.1956; val_edge_recon_loss: 4059895.0000; val_gene_expr_recon_loss: 1796759.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5857248.5000; val_optim_loss: 5857248.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8811; val_auprc_score: 0.8718; val_best_acc_score: 0.6601; val_best_f1_score: 0.7456; train_kl_reg_loss: 559.9043; train_edge_recon_loss: 3462327.0000; train_gene_expr_recon_loss: 1736997.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5199884.0000; train_optim_loss: 5199884.0000; val_kl_reg_loss: 613.4933; val_edge_recon_loss: 4055349.7500; val_gene_expr_recon_loss: 1799414.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5855378.0000; val_optim_loss: 5855378.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8684; val_auprc_score: 0.8530; val_best_acc_score: 0.7244; val_best_f1_score: 0.7790; train_kl_reg_loss: 577.4014; train_edge_recon_loss: 3459443.2500; train_gene_expr_recon_loss: 1735528.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195549.0000; train_optim_loss: 5195549.0000; val_kl_reg_loss: 550.4081; val_edge_recon_loss: 4044625.7500; val_gene_expr_recon_loss: 1787268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5832444.0000; val_optim_loss: 5832444.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8534; val_auprc_score: 0.8431; val_best_acc_score: 0.7682; val_best_f1_score: 0.7974; train_kl_reg_loss: 518.0494; train_edge_recon_loss: 3452896.7500; train_gene_expr_recon_loss: 1734436.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5187851.0000; train_optim_loss: 5187851.0000; val_kl_reg_loss: 496.3583; val_edge_recon_loss: 4015028.0000; val_gene_expr_recon_loss: 1793313.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5808838.0000; val_optim_loss: 5808838.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8591; val_auprc_score: 0.8497; val_best_acc_score: 0.7735; val_best_f1_score: 0.7998; train_kl_reg_loss: 462.8944; train_edge_recon_loss: 3446748.0000; train_gene_expr_recon_loss: 1732980.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5180191.5000; train_optim_loss: 5180191.5000; val_kl_reg_loss: 494.1926; val_edge_recon_loss: 4009643.7500; val_gene_expr_recon_loss: 1793760.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5803899.0000; val_optim_loss: 5803899.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 6 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9483
val AUPRC score: 0.9362
val best accuracy score: 0.8657
val best F1 score: 0.8775
val target rna MSE score: 0.0108
val source rna MSE score: 0.0036
Duration of model training in run 5: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 8587
Number of validation edges: 954
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9147; val_auprc_score: 0.9019; val_best_acc_score: 0.8092; val_best_f1_score: 0.8200; train_kl_reg_loss: 2.1775; train_edge_recon_loss: 3465701.0000; train_gene_expr_recon_loss: 1786333.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5252037.0000; train_optim_loss: 5252037.0000; val_kl_reg_loss: 12.1550; val_edge_recon_loss: 3970718.5000; val_gene_expr_recon_loss: 1752984.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5723715.0000; val_optim_loss: 5723715.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8766; val_auprc_score: 0.8563; val_best_acc_score: 0.7133; val_best_f1_score: 0.6953; train_kl_reg_loss: 12.1626; train_edge_recon_loss: 3466067.5000; train_gene_expr_recon_loss: 1767890.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5233970.0000; train_optim_loss: 5233970.0000; val_kl_reg_loss: 55.3303; val_edge_recon_loss: 4038351.7500; val_gene_expr_recon_loss: 1751903.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5790311.0000; val_optim_loss: 5790311.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8668; val_auprc_score: 0.8538; val_best_acc_score: 0.7579; val_best_f1_score: 0.7972; train_kl_reg_loss: 55.2860; train_edge_recon_loss: 3465010.2500; train_gene_expr_recon_loss: 1757326.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5222392.0000; train_optim_loss: 5222392.0000; val_kl_reg_loss: 160.5991; val_edge_recon_loss: 4055479.5000; val_gene_expr_recon_loss: 1749705.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5805346.0000; val_optim_loss: 5805346.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8670; val_auprc_score: 0.8571; val_best_acc_score: 0.5943; val_best_f1_score: 0.7114; train_kl_reg_loss: 160.4921; train_edge_recon_loss: 3460390.5000; train_gene_expr_recon_loss: 1751514.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5212065.5000; train_optim_loss: 5212065.5000; val_kl_reg_loss: 346.6288; val_edge_recon_loss: 4060421.0000; val_gene_expr_recon_loss: 1747739.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5808507.5000; val_optim_loss: 5808507.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8654; val_auprc_score: 0.8494; val_best_acc_score: 0.5844; val_best_f1_score: 0.7064; train_kl_reg_loss: 346.3840; train_edge_recon_loss: 3459291.5000; train_gene_expr_recon_loss: 1746862.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5206500.0000; train_optim_loss: 5206500.0000; val_kl_reg_loss: 555.4749; val_edge_recon_loss: 4061295.0000; val_gene_expr_recon_loss: 1746562.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5808413.0000; val_optim_loss: 5808413.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8587; val_auprc_score: 0.8504; val_best_acc_score: 0.6153; val_best_f1_score: 0.7222; train_kl_reg_loss: 557.3722; train_edge_recon_loss: 3460621.0000; train_gene_expr_recon_loss: 1743043.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5204222.0000; train_optim_loss: 5204222.0000; val_kl_reg_loss: 626.3629; val_edge_recon_loss: 4059152.2500; val_gene_expr_recon_loss: 1743049.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5802828.0000; val_optim_loss: 5802828.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8569; val_auprc_score: 0.8442; val_best_acc_score: 0.6798; val_best_f1_score: 0.7545; train_kl_reg_loss: 628.6576; train_edge_recon_loss: 3461453.5000; train_gene_expr_recon_loss: 1740314.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5202397.0000; train_optim_loss: 5202397.0000; val_kl_reg_loss: 581.5850; val_edge_recon_loss: 4053288.0000; val_gene_expr_recon_loss: 1738512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5792381.5000; val_optim_loss: 5792381.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8467; val_auprc_score: 0.8331; val_best_acc_score: 0.7500; val_best_f1_score: 0.7901; train_kl_reg_loss: 592.9363; train_edge_recon_loss: 3456200.2500; train_gene_expr_recon_loss: 1739312.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5196106.0000; train_optim_loss: 5196106.0000; val_kl_reg_loss: 513.5795; val_edge_recon_loss: 4036535.5000; val_gene_expr_recon_loss: 1742686.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5779736.0000; val_optim_loss: 5779736.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8441; val_auprc_score: 0.8279; val_best_acc_score: 0.7552; val_best_f1_score: 0.7920; train_kl_reg_loss: 521.6664; train_edge_recon_loss: 3449430.2500; train_gene_expr_recon_loss: 1738303.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5188255.5000; train_optim_loss: 5188255.5000; val_kl_reg_loss: 514.6602; val_edge_recon_loss: 4034229.7500; val_gene_expr_recon_loss: 1744211.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5778955.5000; val_optim_loss: 5778955.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9245
val AUPRC score: 0.9141
val best accuracy score: 0.8166
val best F1 score: 0.8161
val target rna MSE score: 0.0112
val source rna MSE score: 0.0040
Duration of model training in run 4: 0 hours, 0 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 8587
Number of validation edges: 954
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9221; val_auprc_score: 0.9190; val_best_acc_score: 0.8239; val_best_f1_score: 0.8121; train_kl_reg_loss: 2.2751; train_edge_recon_loss: 3465487.2500; train_gene_expr_recon_loss: 1786024.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5251513.5000; train_optim_loss: 5251513.5000; val_kl_reg_loss: 12.4632; val_edge_recon_loss: 3976015.5000; val_gene_expr_recon_loss: 1745754.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5721782.5000; val_optim_loss: 5721782.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8785; val_auprc_score: 0.8720; val_best_acc_score: 0.7358; val_best_f1_score: 0.6933; train_kl_reg_loss: 12.4916; train_edge_recon_loss: 3465435.0000; train_gene_expr_recon_loss: 1767095.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5232543.0000; train_optim_loss: 5232543.0000; val_kl_reg_loss: 57.1308; val_edge_recon_loss: 4039376.5000; val_gene_expr_recon_loss: 1742455.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5781889.0000; val_optim_loss: 5781889.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8708; val_auprc_score: 0.8667; val_best_acc_score: 0.7201; val_best_f1_score: 0.7747; train_kl_reg_loss: 56.7599; train_edge_recon_loss: 3463934.2500; train_gene_expr_recon_loss: 1756901.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5220893.0000; train_optim_loss: 5220893.0000; val_kl_reg_loss: 173.4904; val_edge_recon_loss: 4055760.0000; val_gene_expr_recon_loss: 1745313.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5801247.5000; val_optim_loss: 5801247.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8644; val_auprc_score: 0.8567; val_best_acc_score: 0.6095; val_best_f1_score: 0.7192; train_kl_reg_loss: 172.7389; train_edge_recon_loss: 3460342.5000; train_gene_expr_recon_loss: 1750746.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5211261.0000; train_optim_loss: 5211261.0000; val_kl_reg_loss: 383.0006; val_edge_recon_loss: 4060018.0000; val_gene_expr_recon_loss: 1743125.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5803526.0000; val_optim_loss: 5803526.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8502; val_auprc_score: 0.8439; val_best_acc_score: 0.5980; val_best_f1_score: 0.7133; train_kl_reg_loss: 379.6239; train_edge_recon_loss: 3459607.2500; train_gene_expr_recon_loss: 1746366.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5206353.0000; train_optim_loss: 5206353.0000; val_kl_reg_loss: 593.7158; val_edge_recon_loss: 4060638.5000; val_gene_expr_recon_loss: 1741828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5803060.0000; val_optim_loss: 5803060.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8410; val_auprc_score: 0.8302; val_best_acc_score: 0.6405; val_best_f1_score: 0.7343; train_kl_reg_loss: 584.9965; train_edge_recon_loss: 3462464.0000; train_gene_expr_recon_loss: 1742567.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205616.0000; train_optim_loss: 5205616.0000; val_kl_reg_loss: 641.2272; val_edge_recon_loss: 4056664.5000; val_gene_expr_recon_loss: 1741617.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5798923.5000; val_optim_loss: 5798923.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8400; val_auprc_score: 0.8221; val_best_acc_score: 0.7086; val_best_f1_score: 0.7695; train_kl_reg_loss: 629.8829; train_edge_recon_loss: 3461973.0000; train_gene_expr_recon_loss: 1740548.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203151.0000; train_optim_loss: 5203151.0000; val_kl_reg_loss: 582.1481; val_edge_recon_loss: 4048773.2500; val_gene_expr_recon_loss: 1734691.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5784046.5000; val_optim_loss: 5784046.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8539; val_auprc_score: 0.8396; val_best_acc_score: 0.7584; val_best_f1_score: 0.7894; train_kl_reg_loss: 573.2817; train_edge_recon_loss: 3452837.7500; train_gene_expr_recon_loss: 1739695.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5193106.0000; train_optim_loss: 5193106.0000; val_kl_reg_loss: 501.4850; val_edge_recon_loss: 4023842.7500; val_gene_expr_recon_loss: 1731721.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5756065.5000; val_optim_loss: 5756065.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8400; val_auprc_score: 0.8213; val_best_acc_score: 0.7568; val_best_f1_score: 0.7860; train_kl_reg_loss: 505.4902; train_edge_recon_loss: 3448786.2500; train_gene_expr_recon_loss: 1738387.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5187679.5000; train_optim_loss: 5187679.5000; val_kl_reg_loss: 500.9682; val_edge_recon_loss: 4019868.0000; val_gene_expr_recon_loss: 1733393.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5753762.0000; val_optim_loss: 5753762.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9205
val AUPRC score: 0.9150
val best accuracy score: 0.8176
val best F1 score: 0.8067
val target rna MSE score: 0.0110
val source rna MSE score: 0.0040
Duration of model training in run 3: 0 hours, 0 minutes and 8 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 4407
Number of validation edges: 489
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8172; val_auprc_score: 0.8135; val_best_acc_score: 0.7372; val_best_f1_score: 0.7447; train_kl_reg_loss: 2.5009; train_edge_recon_loss: 3465655.7500; train_gene_expr_recon_loss: 1774869.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5240528.0000; train_optim_loss: 5240528.0000; val_kl_reg_loss: 12.6407; val_edge_recon_loss: 3936230.7500; val_gene_expr_recon_loss: 1791911.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5728154.5000; val_optim_loss: 5728154.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7713; val_auprc_score: 0.7754; val_best_acc_score: 0.6544; val_best_f1_score: 0.7220; train_kl_reg_loss: 12.4663; train_edge_recon_loss: 3463620.2500; train_gene_expr_recon_loss: 1757398.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5221031.0000; train_optim_loss: 5221031.0000; val_kl_reg_loss: 55.9732; val_edge_recon_loss: 4026743.2500; val_gene_expr_recon_loss: 1792409.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5819209.0000; val_optim_loss: 5819209.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7540; val_auprc_score: 0.7613; val_best_acc_score: 0.6830; val_best_f1_score: 0.6676; train_kl_reg_loss: 54.5966; train_edge_recon_loss: 3464138.2500; train_gene_expr_recon_loss: 1747154.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5211347.0000; train_optim_loss: 5211347.0000; val_kl_reg_loss: 162.8043; val_edge_recon_loss: 4051586.7500; val_gene_expr_recon_loss: 1791835.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5843585.0000; val_optim_loss: 5843585.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7847; val_auprc_score: 0.7720; val_best_acc_score: 0.6820; val_best_f1_score: 0.7453; train_kl_reg_loss: 159.6599; train_edge_recon_loss: 3460867.0000; train_gene_expr_recon_loss: 1741951.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5202978.0000; train_optim_loss: 5202978.0000; val_kl_reg_loss: 352.6272; val_edge_recon_loss: 4058147.0000; val_gene_expr_recon_loss: 1785147.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5843647.5000; val_optim_loss: 5843647.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7850; val_auprc_score: 0.7832; val_best_acc_score: 0.6002; val_best_f1_score: 0.7131; train_kl_reg_loss: 351.7449; train_edge_recon_loss: 3457523.5000; train_gene_expr_recon_loss: 1737684.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195560.0000; train_optim_loss: 5195560.0000; val_kl_reg_loss: 598.5554; val_edge_recon_loss: 4060675.2500; val_gene_expr_recon_loss: 1784530.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5845804.5000; val_optim_loss: 5845804.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8041; val_auprc_score: 0.7980; val_best_acc_score: 0.6472; val_best_f1_score: 0.7380; train_kl_reg_loss: 592.9150; train_edge_recon_loss: 3459242.5000; train_gene_expr_recon_loss: 1733538.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5193374.0000; train_optim_loss: 5193374.0000; val_kl_reg_loss: 727.2000; val_edge_recon_loss: 4058794.5000; val_gene_expr_recon_loss: 1784492.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5844014.0000; val_optim_loss: 5844014.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7954; val_auprc_score: 0.7885; val_best_acc_score: 0.6820; val_best_f1_score: 0.7510; train_kl_reg_loss: 719.0372; train_edge_recon_loss: 3461327.2500; train_gene_expr_recon_loss: 1730728.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5192774.0000; train_optim_loss: 5192774.0000; val_kl_reg_loss: 735.5947; val_edge_recon_loss: 4054406.0000; val_gene_expr_recon_loss: 1783904.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5839046.0000; val_optim_loss: 5839046.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8040; val_auprc_score: 0.7949; val_best_acc_score: 0.7209; val_best_f1_score: 0.7511; train_kl_reg_loss: 719.2369; train_edge_recon_loss: 3459841.5000; train_gene_expr_recon_loss: 1729413.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5189974.5000; train_optim_loss: 5189974.5000; val_kl_reg_loss: 661.4509; val_edge_recon_loss: 4043462.0000; val_gene_expr_recon_loss: 1780901.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5825025.0000; val_optim_loss: 5825025.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8151; val_auprc_score: 0.7942; val_best_acc_score: 0.7260; val_best_f1_score: 0.7500; train_kl_reg_loss: 653.7603; train_edge_recon_loss: 3451052.5000; train_gene_expr_recon_loss: 1728589.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5180296.0000; train_optim_loss: 5180296.0000; val_kl_reg_loss: 649.9659; val_edge_recon_loss: 4038543.7500; val_gene_expr_recon_loss: 1779304.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5818498.0000; val_optim_loss: 5818498.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.7913
val AUPRC score: 0.7896
val best accuracy score: 0.7137
val best F1 score: 0.7306
val target rna MSE score: 0.0114
val source rna MSE score: 0.0046
Duration of model training in run 2: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 4407
Number of validation edges: 489
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8051; val_auprc_score: 0.8259; val_best_acc_score: 0.7290; val_best_f1_score: 0.7474; train_kl_reg_loss: 2.6618; train_edge_recon_loss: 3467449.0000; train_gene_expr_recon_loss: 1781111.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5248563.0000; train_optim_loss: 5248563.0000; val_kl_reg_loss: 12.7541; val_edge_recon_loss: 3936783.0000; val_gene_expr_recon_loss: 1720878.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5657674.5000; val_optim_loss: 5657674.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7422; val_auprc_score: 0.7500; val_best_acc_score: 0.6391; val_best_f1_score: 0.7041; train_kl_reg_loss: 13.3230; train_edge_recon_loss: 3465736.7500; train_gene_expr_recon_loss: 1763708.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5229459.0000; train_optim_loss: 5229459.0000; val_kl_reg_loss: 56.7856; val_edge_recon_loss: 4026028.5000; val_gene_expr_recon_loss: 1727161.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5753247.0000; val_optim_loss: 5753247.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7338; val_auprc_score: 0.7516; val_best_acc_score: 0.6616; val_best_f1_score: 0.6680; train_kl_reg_loss: 57.6198; train_edge_recon_loss: 3463265.5000; train_gene_expr_recon_loss: 1754250.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5217574.0000; train_optim_loss: 5217574.0000; val_kl_reg_loss: 167.8649; val_edge_recon_loss: 4051052.0000; val_gene_expr_recon_loss: 1720629.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5771849.5000; val_optim_loss: 5771849.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7737; val_auprc_score: 0.7639; val_best_acc_score: 0.6636; val_best_f1_score: 0.7247; train_kl_reg_loss: 171.0445; train_edge_recon_loss: 3460099.5000; train_gene_expr_recon_loss: 1748571.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5208841.5000; train_optim_loss: 5208841.5000; val_kl_reg_loss: 364.2079; val_edge_recon_loss: 4057500.2500; val_gene_expr_recon_loss: 1715158.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5773022.5000; val_optim_loss: 5773022.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7765; val_auprc_score: 0.7807; val_best_acc_score: 0.6196; val_best_f1_score: 0.7195; train_kl_reg_loss: 378.4565; train_edge_recon_loss: 3456278.2500; train_gene_expr_recon_loss: 1744309.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5200966.5000; train_optim_loss: 5200966.5000; val_kl_reg_loss: 627.3193; val_edge_recon_loss: 4059527.7500; val_gene_expr_recon_loss: 1713954.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5774109.5000; val_optim_loss: 5774109.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7752; val_auprc_score: 0.7718; val_best_acc_score: 0.6462; val_best_f1_score: 0.7322; train_kl_reg_loss: 654.1889; train_edge_recon_loss: 3461576.0000; train_gene_expr_recon_loss: 1741049.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203279.5000; train_optim_loss: 5203279.5000; val_kl_reg_loss: 769.7974; val_edge_recon_loss: 4057647.2500; val_gene_expr_recon_loss: 1714283.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5772700.5000; val_optim_loss: 5772700.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7813; val_auprc_score: 0.7672; val_best_acc_score: 0.6800; val_best_f1_score: 0.7420; train_kl_reg_loss: 789.6805; train_edge_recon_loss: 3461285.7500; train_gene_expr_recon_loss: 1739070.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5201146.5000; train_optim_loss: 5201146.5000; val_kl_reg_loss: 777.6215; val_edge_recon_loss: 4051507.7500; val_gene_expr_recon_loss: 1713658.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5765944.0000; val_optim_loss: 5765944.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7714; val_auprc_score: 0.7621; val_best_acc_score: 0.6994; val_best_f1_score: 0.7268; train_kl_reg_loss: 787.3879; train_edge_recon_loss: 3457340.2500; train_gene_expr_recon_loss: 1737525.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5195653.0000; train_optim_loss: 5195653.0000; val_kl_reg_loss: 705.8623; val_edge_recon_loss: 4038768.7500; val_gene_expr_recon_loss: 1712614.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5752089.0000; val_optim_loss: 5752089.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7779; val_auprc_score: 0.7582; val_best_acc_score: 0.7025; val_best_f1_score: 0.7231; train_kl_reg_loss: 719.6302; train_edge_recon_loss: 3453421.5000; train_gene_expr_recon_loss: 1736363.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5190505.0000; train_optim_loss: 5190505.0000; val_kl_reg_loss: 690.2231; val_edge_recon_loss: 4034182.2500; val_gene_expr_recon_loss: 1710183.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5745056.0000; val_optim_loss: 5745056.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.7839
val AUPRC score: 0.7981
val best accuracy score: 0.7157
val best F1 score: 0.7320
val target rna MSE score: 0.0109
val source rna MSE score: 0.0046
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
