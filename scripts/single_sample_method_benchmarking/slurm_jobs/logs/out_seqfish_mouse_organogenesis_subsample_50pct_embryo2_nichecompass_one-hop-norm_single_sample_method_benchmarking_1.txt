Run timestamp: 21062023_133722.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_50pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6725; val_auprc_score: 0.7053; val_best_acc_score: 0.6423; val_best_f1_score: 0.6471; train_kl_reg_loss: 1202.7676; train_edge_recon_loss: 367159.3906; train_cond_contrastive_loss: 139394.6250; train_gene_expr_recon_loss: 147684.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 655441.2188; train_optim_loss: 655441.2188; val_kl_reg_loss: 2245.5762; val_edge_recon_loss: 422601.4688; val_cond_contrastive_loss: 78438.2500; val_gene_expr_recon_loss: 131500.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 634785.4375; val_optim_loss: 634785.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6733; val_auprc_score: 0.7044; val_best_acc_score: 0.6426; val_best_f1_score: 0.6490; train_kl_reg_loss: 3045.1025; train_edge_recon_loss: 380923.5000; train_cond_contrastive_loss: 99464.6602; train_gene_expr_recon_loss: 130131.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 613564.5000; train_optim_loss: 613564.5000; val_kl_reg_loss: 6873.9360; val_edge_recon_loss: 421080.5000; val_cond_contrastive_loss: 78410.5703; val_gene_expr_recon_loss: 121402.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 627767.9375; val_optim_loss: 627767.9375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6748; val_auprc_score: 0.6972; val_best_acc_score: 0.6320; val_best_f1_score: 0.6495; train_kl_reg_loss: 10803.1006; train_edge_recon_loss: 382114.3594; train_cond_contrastive_loss: 84999.5273; train_gene_expr_recon_loss: 124608.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 602525.9375; train_optim_loss: 602525.9375; val_kl_reg_loss: 8251.5537; val_edge_recon_loss: 419191.7500; val_cond_contrastive_loss: 78426.7266; val_gene_expr_recon_loss: 118224.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 624094.3750; val_optim_loss: 624094.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6504; val_auprc_score: 0.6695; val_best_acc_score: 0.6269; val_best_f1_score: 0.6432; train_kl_reg_loss: 7923.3882; train_edge_recon_loss: 378041.5000; train_cond_contrastive_loss: 85854.2109; train_gene_expr_recon_loss: 119436.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 591256.0625; train_optim_loss: 591256.0625; val_kl_reg_loss: 5772.4141; val_edge_recon_loss: 415618.4062; val_cond_contrastive_loss: 78465.9688; val_gene_expr_recon_loss: 116257.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 616114.5000; val_optim_loss: 616114.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6481; val_auprc_score: 0.6753; val_best_acc_score: 0.6041; val_best_f1_score: 0.6561; train_kl_reg_loss: 5777.8403; train_edge_recon_loss: 374208.7188; train_cond_contrastive_loss: 85969.0742; train_gene_expr_recon_loss: 117529.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 583485.2500; train_optim_loss: 583485.2500; val_kl_reg_loss: 4627.4111; val_edge_recon_loss: 394063.3750; val_cond_contrastive_loss: 78535.3594; val_gene_expr_recon_loss: 115437.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592663.7500; val_optim_loss: 592663.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6507; val_auprc_score: 0.6706; val_best_acc_score: 0.6101; val_best_f1_score: 0.6597; train_kl_reg_loss: 4585.8096; train_edge_recon_loss: 368815.8906; train_cond_contrastive_loss: 87151.8008; train_gene_expr_recon_loss: 116555.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577108.5000; train_optim_loss: 577108.5000; val_kl_reg_loss: 3653.1128; val_edge_recon_loss: 374731.3750; val_cond_contrastive_loss: 78618.9375; val_gene_expr_recon_loss: 115006.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572010.3125; val_optim_loss: 572010.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6386; val_auprc_score: 0.6586; val_best_acc_score: 0.6191; val_best_f1_score: 0.6510; train_kl_reg_loss: 3604.9310; train_edge_recon_loss: 358575.6406; train_cond_contrastive_loss: 88437.1289; train_gene_expr_recon_loss: 116177.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 566795.0938; train_optim_loss: 566795.0938; val_kl_reg_loss: 3075.4358; val_edge_recon_loss: 373294.9375; val_cond_contrastive_loss: 78565.8203; val_gene_expr_recon_loss: 114748.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 569684.8750; val_optim_loss: 569684.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6473; val_auprc_score: 0.6611; val_best_acc_score: 0.6230; val_best_f1_score: 0.6511; train_kl_reg_loss: 3114.3472; train_edge_recon_loss: 349970.4375; train_cond_contrastive_loss: 87718.4453; train_gene_expr_recon_loss: 115885.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556689.0938; train_optim_loss: 556689.0938; val_kl_reg_loss: 3053.5571; val_edge_recon_loss: 369976.6562; val_cond_contrastive_loss: 78468.7578; val_gene_expr_recon_loss: 114667.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 566166.2500; val_optim_loss: 566166.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6464; val_auprc_score: 0.6713; val_best_acc_score: 0.6160; val_best_f1_score: 0.6565; train_kl_reg_loss: 3183.8060; train_edge_recon_loss: 345383.8906; train_cond_contrastive_loss: 83823.8125; train_gene_expr_recon_loss: 115792.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 548184.3438; train_optim_loss: 548184.3438; val_kl_reg_loss: 3319.2349; val_edge_recon_loss: 365672.7500; val_cond_contrastive_loss: 78427.4531; val_gene_expr_recon_loss: 114430.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561849.5625; val_optim_loss: 561849.5625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6579; val_auprc_score: 0.6749; val_best_acc_score: 0.6348; val_best_f1_score: 0.6522; train_kl_reg_loss: 3448.2533; train_edge_recon_loss: 343382.9375; train_cond_contrastive_loss: 81426.7695; train_gene_expr_recon_loss: 115519.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543777.4688; train_optim_loss: 543777.4688; val_kl_reg_loss: 3547.4233; val_edge_recon_loss: 366459.1250; val_cond_contrastive_loss: 78411.3281; val_gene_expr_recon_loss: 113990.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 562408.5625; val_optim_loss: 562408.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6435; val_auprc_score: 0.6637; val_best_acc_score: 0.6327; val_best_f1_score: 0.6523; train_kl_reg_loss: 3650.3802; train_edge_recon_loss: 346492.3750; train_cond_contrastive_loss: 80493.2891; train_gene_expr_recon_loss: 115039.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545675.2812; train_optim_loss: 545675.2812; val_kl_reg_loss: 3649.2271; val_edge_recon_loss: 373168.7812; val_cond_contrastive_loss: 78406.6172; val_gene_expr_recon_loss: 113586.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568810.8125; val_optim_loss: 568810.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6614; val_auprc_score: 0.6696; val_best_acc_score: 0.6376; val_best_f1_score: 0.6534; train_kl_reg_loss: 3702.6526; train_edge_recon_loss: 345305.5000; train_cond_contrastive_loss: 80135.4492; train_gene_expr_recon_loss: 114568.4141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543712.0000; train_optim_loss: 543712.0000; val_kl_reg_loss: 3607.8179; val_edge_recon_loss: 368698.7812; val_cond_contrastive_loss: 78402.6562; val_gene_expr_recon_loss: 113302.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564012.1875; val_optim_loss: 564012.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6559; val_auprc_score: 0.6684; val_best_acc_score: 0.6353; val_best_f1_score: 0.6534; train_kl_reg_loss: 3656.4462; train_edge_recon_loss: 342269.0781; train_cond_contrastive_loss: 80127.3125; train_gene_expr_recon_loss: 114509.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540562.2188; train_optim_loss: 540562.2188; val_kl_reg_loss: 3595.1301; val_edge_recon_loss: 370792.0938; val_cond_contrastive_loss: 78402.0703; val_gene_expr_recon_loss: 113270.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 566059.5625; val_optim_loss: 566059.5625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6587; val_auprc_score: 0.6748; val_best_acc_score: 0.6422; val_best_f1_score: 0.6539; train_kl_reg_loss: 3645.1636; train_edge_recon_loss: 343557.4219; train_cond_contrastive_loss: 80193.4883; train_gene_expr_recon_loss: 114418.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 541814.3438; train_optim_loss: 541814.3438; val_kl_reg_loss: 3561.4624; val_edge_recon_loss: 370964.7500; val_cond_contrastive_loss: 78398.9688; val_gene_expr_recon_loss: 113223.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 566148.8750; val_optim_loss: 566148.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6657; val_auprc_score: 0.6819; val_best_acc_score: 0.6340; val_best_f1_score: 0.6634; train_kl_reg_loss: 3618.5132; train_edge_recon_loss: 341913.3906; train_cond_contrastive_loss: 80229.3320; train_gene_expr_recon_loss: 114345.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540107.1250; train_optim_loss: 540107.1250; val_kl_reg_loss: 3542.6377; val_edge_recon_loss: 362448.8750; val_cond_contrastive_loss: 78402.2812; val_gene_expr_recon_loss: 113169.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 557562.8125; val_optim_loss: 557562.8125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.6576; val_auprc_score: 0.6773; val_best_acc_score: 0.6342; val_best_f1_score: 0.6617; train_kl_reg_loss: 3585.6622; train_edge_recon_loss: 341232.1719; train_cond_contrastive_loss: 80252.7148; train_gene_expr_recon_loss: 114237.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 539307.7188; train_optim_loss: 539307.7188; val_kl_reg_loss: 3522.9248; val_edge_recon_loss: 363135.2812; val_cond_contrastive_loss: 78399.7500; val_gene_expr_recon_loss: 113110.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558168.5625; val_optim_loss: 558168.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.6639; val_auprc_score: 0.6747; val_best_acc_score: 0.6380; val_best_f1_score: 0.6565; train_kl_reg_loss: 3563.3572; train_edge_recon_loss: 340552.1875; train_cond_contrastive_loss: 80291.3203; train_gene_expr_recon_loss: 114321.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 538728.7500; train_optim_loss: 538728.7500; val_kl_reg_loss: 3493.7244; val_edge_recon_loss: 367731.6562; val_cond_contrastive_loss: 78398.8750; val_gene_expr_recon_loss: 113051.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 562675.9375; val_optim_loss: 562675.9375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.6600; val_auprc_score: 0.6733; val_best_acc_score: 0.6343; val_best_f1_score: 0.6621; train_kl_reg_loss: 3546.7642; train_edge_recon_loss: 339924.3906; train_cond_contrastive_loss: 80209.5391; train_gene_expr_recon_loss: 114252.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537933.6250; train_optim_loss: 537933.6250; val_kl_reg_loss: 3466.4993; val_edge_recon_loss: 366027.2812; val_cond_contrastive_loss: 78400.5234; val_gene_expr_recon_loss: 112993.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560887.9375; val_optim_loss: 560887.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.6637; val_auprc_score: 0.6807; val_best_acc_score: 0.6336; val_best_f1_score: 0.6615; train_kl_reg_loss: 3530.2417; train_edge_recon_loss: 339897.0938; train_cond_contrastive_loss: 80295.2852; train_gene_expr_recon_loss: 114247.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537970.3750; train_optim_loss: 537970.3750; val_kl_reg_loss: 3465.4458; val_edge_recon_loss: 363846.8125; val_cond_contrastive_loss: 78397.4609; val_gene_expr_recon_loss: 112987.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 558697.5625; val_optim_loss: 558697.5625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.6769; val_auprc_score: 0.6847; val_best_acc_score: 0.6447; val_best_f1_score: 0.6608; train_kl_reg_loss: 3527.4617; train_edge_recon_loss: 341203.2500; train_cond_contrastive_loss: 80338.7500; train_gene_expr_recon_loss: 113991.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 539061.4062; train_optim_loss: 539061.4062; val_kl_reg_loss: 3478.9236; val_edge_recon_loss: 361211.6875; val_cond_contrastive_loss: 78397.0312; val_gene_expr_recon_loss: 112981.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556069.4375; val_optim_loss: 556069.4375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.6704; val_auprc_score: 0.6815; val_best_acc_score: 0.6419; val_best_f1_score: 0.6578; train_kl_reg_loss: 3521.0054; train_edge_recon_loss: 339852.1562; train_cond_contrastive_loss: 80369.8984; train_gene_expr_recon_loss: 114162.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537906.0312; train_optim_loss: 537906.0312; val_kl_reg_loss: 3468.6970; val_edge_recon_loss: 365694.1562; val_cond_contrastive_loss: 78395.3125; val_gene_expr_recon_loss: 112975.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 560533.6875; val_optim_loss: 560533.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.6813; val_auprc_score: 0.6926; val_best_acc_score: 0.6453; val_best_f1_score: 0.6642; train_kl_reg_loss: 3529.5039; train_edge_recon_loss: 339065.8281; train_cond_contrastive_loss: 80371.7070; train_gene_expr_recon_loss: 114301.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537268.7812; train_optim_loss: 537268.7812; val_kl_reg_loss: 3464.6641; val_edge_recon_loss: 357224.8750; val_cond_contrastive_loss: 78398.3672; val_gene_expr_recon_loss: 112969.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 552057.1250; val_optim_loss: 552057.1250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.6715; val_auprc_score: 0.6830; val_best_acc_score: 0.6416; val_best_f1_score: 0.6633; train_kl_reg_loss: 3518.2025; train_edge_recon_loss: 339229.2031; train_cond_contrastive_loss: 80369.9219; train_gene_expr_recon_loss: 114202.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537320.2812; train_optim_loss: 537320.2812; val_kl_reg_loss: 3472.5757; val_edge_recon_loss: 365146.6562; val_cond_contrastive_loss: 78398.2031; val_gene_expr_recon_loss: 112962.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559980.1250; val_optim_loss: 559980.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.6763; val_auprc_score: 0.6899; val_best_acc_score: 0.6398; val_best_f1_score: 0.6688; train_kl_reg_loss: 3521.1243; train_edge_recon_loss: 336870.5000; train_cond_contrastive_loss: 80347.2188; train_gene_expr_recon_loss: 114137.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534876.7188; train_optim_loss: 534876.7188; val_kl_reg_loss: 3462.5339; val_edge_recon_loss: 357037.6562; val_cond_contrastive_loss: 78397.4297; val_gene_expr_recon_loss: 112956.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 551853.7500; val_optim_loss: 551853.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.6655; val_auprc_score: 0.6820; val_best_acc_score: 0.6314; val_best_f1_score: 0.6664; train_kl_reg_loss: 3521.2588; train_edge_recon_loss: 339606.5156; train_cond_contrastive_loss: 80324.4258; train_gene_expr_recon_loss: 113978.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537430.5625; train_optim_loss: 537430.5625; val_kl_reg_loss: 3476.1821; val_edge_recon_loss: 360878.7500; val_cond_contrastive_loss: 78397.9609; val_gene_expr_recon_loss: 112949.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555702.4375; val_optim_loss: 555702.4375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.6756; val_auprc_score: 0.6863; val_best_acc_score: 0.6412; val_best_f1_score: 0.6667; train_kl_reg_loss: 3517.6569; train_edge_recon_loss: 338774.5625; train_cond_contrastive_loss: 80338.0352; train_gene_expr_recon_loss: 114128.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536758.4688; train_optim_loss: 536758.4688; val_kl_reg_loss: 3465.2305; val_edge_recon_loss: 359033.9062; val_cond_contrastive_loss: 78395.5078; val_gene_expr_recon_loss: 112942.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553837.5625; val_optim_loss: 553837.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.6749; val_auprc_score: 0.6822; val_best_acc_score: 0.6391; val_best_f1_score: 0.6664; train_kl_reg_loss: 3513.4546; train_edge_recon_loss: 339368.8281; train_cond_contrastive_loss: 80328.3008; train_gene_expr_recon_loss: 114076.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 537287.4375; train_optim_loss: 537287.4375; val_kl_reg_loss: 3453.1079; val_edge_recon_loss: 359652.5625; val_cond_contrastive_loss: 78399.7812; val_gene_expr_recon_loss: 112936.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554441.7500; val_optim_loss: 554441.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.6858; val_auprc_score: 0.6974; val_best_acc_score: 0.6414; val_best_f1_score: 0.6706; train_kl_reg_loss: 3516.3926; train_edge_recon_loss: 338741.5000; train_cond_contrastive_loss: 80383.9844; train_gene_expr_recon_loss: 114139.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536781.8438; train_optim_loss: 536781.8438; val_kl_reg_loss: 3464.7158; val_edge_recon_loss: 353243.7188; val_cond_contrastive_loss: 78396.4844; val_gene_expr_recon_loss: 112935.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 548040.5625; val_optim_loss: 548040.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.6788; val_auprc_score: 0.6887; val_best_acc_score: 0.6516; val_best_f1_score: 0.6641; train_kl_reg_loss: 3523.5198; train_edge_recon_loss: 338130.4531; train_cond_contrastive_loss: 80343.6406; train_gene_expr_recon_loss: 114169.9492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536167.5625; train_optim_loss: 536167.5625; val_kl_reg_loss: 3451.2605; val_edge_recon_loss: 359649.7188; val_cond_contrastive_loss: 78398.2969; val_gene_expr_recon_loss: 112934.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554434.1875; val_optim_loss: 554434.1875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.6749; val_auprc_score: 0.6778; val_best_acc_score: 0.6446; val_best_f1_score: 0.6567; train_kl_reg_loss: 3523.1178; train_edge_recon_loss: 341221.2812; train_cond_contrastive_loss: 80287.9414; train_gene_expr_recon_loss: 113999.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 539031.5312; train_optim_loss: 539031.5312; val_kl_reg_loss: 3477.0596; val_edge_recon_loss: 365055.5312; val_cond_contrastive_loss: 78398.3828; val_gene_expr_recon_loss: 112934.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559865.2500; val_optim_loss: 559865.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.6781; val_auprc_score: 0.6894; val_best_acc_score: 0.6407; val_best_f1_score: 0.6631; train_kl_reg_loss: 3521.8447; train_edge_recon_loss: 338705.7031; train_cond_contrastive_loss: 80305.7539; train_gene_expr_recon_loss: 114129.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536662.3438; train_optim_loss: 536662.3438; val_kl_reg_loss: 3456.2671; val_edge_recon_loss: 360945.0938; val_cond_contrastive_loss: 78399.8516; val_gene_expr_recon_loss: 112933.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555734.8125; val_optim_loss: 555734.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.6689; val_auprc_score: 0.6857; val_best_acc_score: 0.6417; val_best_f1_score: 0.6606; train_kl_reg_loss: 3515.4595; train_edge_recon_loss: 340820.5156; train_cond_contrastive_loss: 80379.7500; train_gene_expr_recon_loss: 114107.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 538823.5938; train_optim_loss: 538823.5938; val_kl_reg_loss: 3464.0728; val_edge_recon_loss: 364307.9688; val_cond_contrastive_loss: 78396.6250; val_gene_expr_recon_loss: 112933.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559102.1875; val_optim_loss: 559102.1875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.6852; val_auprc_score: 0.6910; val_best_acc_score: 0.6472; val_best_f1_score: 0.6638; train_kl_reg_loss: 3512.4077; train_edge_recon_loss: 340270.2969; train_cond_contrastive_loss: 80409.1211; train_gene_expr_recon_loss: 114023.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 538215.1562; train_optim_loss: 538215.1562; val_kl_reg_loss: 3472.9966; val_edge_recon_loss: 358958.3750; val_cond_contrastive_loss: 78396.2109; val_gene_expr_recon_loss: 112933.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553761.0625; val_optim_loss: 553761.0625
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.6688; val_auprc_score: 0.6773; val_best_acc_score: 0.6370; val_best_f1_score: 0.6644; train_kl_reg_loss: 3520.9250; train_edge_recon_loss: 338561.6875; train_cond_contrastive_loss: 80305.7930; train_gene_expr_recon_loss: 114167.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536556.0938; train_optim_loss: 536556.0938; val_kl_reg_loss: 3465.4521; val_edge_recon_loss: 360854.0312; val_cond_contrastive_loss: 78399.7891; val_gene_expr_recon_loss: 112933.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555652.6250; val_optim_loss: 555652.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 0 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.6700
Val AUPRC score: 0.6830
Val best accuracy score: 0.6418
Val best F1 score: 0.6588
Val gene expr MSE score: 2.1425
Duration of model training in run 1: 0 hours, 1 minutes and 4 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6527; val_auprc_score: 0.6860; val_best_acc_score: 0.6426; val_best_f1_score: 0.6471; train_kl_reg_loss: 1151.8133; train_edge_recon_loss: 365703.3438; train_cond_contrastive_loss: 140428.5312; train_gene_expr_recon_loss: 144574.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 651858.2500; train_optim_loss: 651858.2500; val_kl_reg_loss: 2068.1367; val_edge_recon_loss: 424010.2812; val_cond_contrastive_loss: 78428.2422; val_gene_expr_recon_loss: 130891.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 635397.9375; val_optim_loss: 635397.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6517; val_auprc_score: 0.6893; val_best_acc_score: 0.6239; val_best_f1_score: 0.6550; train_kl_reg_loss: 2702.0516; train_edge_recon_loss: 383536.8281; train_cond_contrastive_loss: 100316.0977; train_gene_expr_recon_loss: 128212.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 614767.6875; train_optim_loss: 614767.6875; val_kl_reg_loss: 4629.6875; val_edge_recon_loss: 415117.3125; val_cond_contrastive_loss: 78400.4844; val_gene_expr_recon_loss: 121669.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 619817.0625; val_optim_loss: 619817.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6350; val_auprc_score: 0.6727; val_best_acc_score: 0.6182; val_best_f1_score: 0.6508; train_kl_reg_loss: 7541.1885; train_edge_recon_loss: 385119.6562; train_cond_contrastive_loss: 86894.7109; train_gene_expr_recon_loss: 120917.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 600473.0625; train_optim_loss: 600473.0625; val_kl_reg_loss: 9932.4199; val_edge_recon_loss: 413045.2812; val_cond_contrastive_loss: 78412.0312; val_gene_expr_recon_loss: 118356.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 619746.5000; val_optim_loss: 619746.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6209; val_auprc_score: 0.6496; val_best_acc_score: 0.6104; val_best_f1_score: 0.6455; train_kl_reg_loss: 9735.9067; train_edge_recon_loss: 380168.9844; train_cond_contrastive_loss: 85807.9375; train_gene_expr_recon_loss: 118342.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 594055.4688; train_optim_loss: 594055.4688; val_kl_reg_loss: 6421.7041; val_edge_recon_loss: 411820.7500; val_cond_contrastive_loss: 78439.8438; val_gene_expr_recon_loss: 116698.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 613380.4375; val_optim_loss: 613380.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6215; val_auprc_score: 0.6504; val_best_acc_score: 0.5987; val_best_f1_score: 0.6498; train_kl_reg_loss: 6228.1506; train_edge_recon_loss: 376404.1094; train_cond_contrastive_loss: 86807.7188; train_gene_expr_recon_loss: 116665.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 586105.7500; train_optim_loss: 586105.7500; val_kl_reg_loss: 4429.8608; val_edge_recon_loss: 397506.5625; val_cond_contrastive_loss: 78485.8047; val_gene_expr_recon_loss: 115966.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 596388.2500; val_optim_loss: 596388.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6167; val_auprc_score: 0.6427; val_best_acc_score: 0.5951; val_best_f1_score: 0.6523; train_kl_reg_loss: 4291.4575; train_edge_recon_loss: 368047.6875; train_cond_contrastive_loss: 87616.7383; train_gene_expr_recon_loss: 115889.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 575845.5625; train_optim_loss: 575845.5625; val_kl_reg_loss: 3373.0315; val_edge_recon_loss: 386656.0312; val_cond_contrastive_loss: 78533.3281; val_gene_expr_recon_loss: 115656.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 584218.5000; val_optim_loss: 584218.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6151; val_auprc_score: 0.6383; val_best_acc_score: 0.6039; val_best_f1_score: 0.6539; train_kl_reg_loss: 3285.4126; train_edge_recon_loss: 361511.0781; train_cond_contrastive_loss: 87072.1992; train_gene_expr_recon_loss: 115515.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567384.3125; train_optim_loss: 567384.3125; val_kl_reg_loss: 2898.1865; val_edge_recon_loss: 375537.3750; val_cond_contrastive_loss: 78519.6953; val_gene_expr_recon_loss: 115383.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572338.3750; val_optim_loss: 572338.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6241; val_auprc_score: 0.6457; val_best_acc_score: 0.5979; val_best_f1_score: 0.6566; train_kl_reg_loss: 2888.4110; train_edge_recon_loss: 353724.4844; train_cond_contrastive_loss: 84397.3242; train_gene_expr_recon_loss: 115292.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556302.2500; train_optim_loss: 556302.2500; val_kl_reg_loss: 2879.2290; val_edge_recon_loss: 367819.0312; val_cond_contrastive_loss: 78452.6016; val_gene_expr_recon_loss: 115160.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564311.4375; val_optim_loss: 564311.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6272; val_auprc_score: 0.6405; val_best_acc_score: 0.6017; val_best_f1_score: 0.6536; train_kl_reg_loss: 2935.8202; train_edge_recon_loss: 346044.4844; train_cond_contrastive_loss: 82640.2773; train_gene_expr_recon_loss: 114950.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546571.0625; train_optim_loss: 546571.0625; val_kl_reg_loss: 3143.2612; val_edge_recon_loss: 374996.8750; val_cond_contrastive_loss: 78408.7109; val_gene_expr_recon_loss: 114934.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 571483.7500; val_optim_loss: 571483.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6377; val_auprc_score: 0.6565; val_best_acc_score: 0.6121; val_best_f1_score: 0.6568; train_kl_reg_loss: 3207.6672; train_edge_recon_loss: 346174.9844; train_cond_contrastive_loss: 81510.0703; train_gene_expr_recon_loss: 114943.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545836.5938; train_optim_loss: 545836.5938; val_kl_reg_loss: 3419.2231; val_edge_recon_loss: 368098.1562; val_cond_contrastive_loss: 78398.2344; val_gene_expr_recon_loss: 114650.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564566.5625; val_optim_loss: 564566.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6321; val_auprc_score: 0.6465; val_best_acc_score: 0.6037; val_best_f1_score: 0.6557; train_kl_reg_loss: 3439.8466; train_edge_recon_loss: 346668.5781; train_cond_contrastive_loss: 80790.8008; train_gene_expr_recon_loss: 114503.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545402.7188; train_optim_loss: 545402.7188; val_kl_reg_loss: 3526.4355; val_edge_recon_loss: 371657.2500; val_cond_contrastive_loss: 78395.1641; val_gene_expr_recon_loss: 114361.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567940.5625; val_optim_loss: 567940.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6302; val_auprc_score: 0.6450; val_best_acc_score: 0.6031; val_best_f1_score: 0.6533; train_kl_reg_loss: 3504.4905; train_edge_recon_loss: 346278.2344; train_cond_contrastive_loss: 80599.5625; train_gene_expr_recon_loss: 114218.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544600.5625; train_optim_loss: 544600.5625; val_kl_reg_loss: 3536.4910; val_edge_recon_loss: 375401.7500; val_cond_contrastive_loss: 78393.1406; val_gene_expr_recon_loss: 114323.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 571655.3750; val_optim_loss: 571655.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6388; val_auprc_score: 0.6559; val_best_acc_score: 0.6106; val_best_f1_score: 0.6601; train_kl_reg_loss: 3493.3354; train_edge_recon_loss: 346098.0312; train_cond_contrastive_loss: 80659.6484; train_gene_expr_recon_loss: 114368.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544619.4062; train_optim_loss: 544619.4062; val_kl_reg_loss: 3502.6064; val_edge_recon_loss: 368802.5625; val_cond_contrastive_loss: 78389.8594; val_gene_expr_recon_loss: 114270.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 564965.9375; val_optim_loss: 564965.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6362; val_auprc_score: 0.6543; val_best_acc_score: 0.6089; val_best_f1_score: 0.6557; train_kl_reg_loss: 3475.4951; train_edge_recon_loss: 345746.4375; train_cond_contrastive_loss: 80633.4648; train_gene_expr_recon_loss: 114040.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543895.5000; train_optim_loss: 543895.5000; val_kl_reg_loss: 3468.2241; val_edge_recon_loss: 369509.5625; val_cond_contrastive_loss: 78389.8203; val_gene_expr_recon_loss: 114209.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 565577.5000; val_optim_loss: 565577.5000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 23 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.6244
Val AUPRC score: 0.6429
Val best accuracy score: 0.6050
Val best F1 score: 0.6547
Val gene expr MSE score: 2.4662
Duration of model training in run 2: 0 hours, 0 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7377; val_auprc_score: 0.7793; val_best_acc_score: 0.6673; val_best_f1_score: 0.6954; train_kl_reg_loss: 1962.7958; train_edge_recon_loss: 354382.4688; train_cond_contrastive_loss: 119199.0098; train_gene_expr_recon_loss: 139102.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 614646.7188; train_optim_loss: 614646.7188; val_kl_reg_loss: 4832.9824; val_edge_recon_loss: 399097.3750; val_cond_contrastive_loss: 78354.0938; val_gene_expr_recon_loss: 122948.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 605232.7500; val_optim_loss: 605232.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7020; val_auprc_score: 0.7364; val_best_acc_score: 0.6289; val_best_f1_score: 0.6898; train_kl_reg_loss: 10964.0415; train_edge_recon_loss: 361128.2656; train_cond_contrastive_loss: 88088.9609; train_gene_expr_recon_loss: 120444.9551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 580626.2344; train_optim_loss: 580626.2344; val_kl_reg_loss: 9777.1914; val_edge_recon_loss: 397312.0625; val_cond_contrastive_loss: 78372.1328; val_gene_expr_recon_loss: 117204.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602666.0000; val_optim_loss: 602666.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6825; val_auprc_score: 0.7206; val_best_acc_score: 0.6158; val_best_f1_score: 0.6914; train_kl_reg_loss: 7436.3356; train_edge_recon_loss: 356248.2812; train_cond_contrastive_loss: 88122.3711; train_gene_expr_recon_loss: 116843.4238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 568650.3906; train_optim_loss: 568650.3906; val_kl_reg_loss: 4779.9546; val_edge_recon_loss: 379901.0938; val_cond_contrastive_loss: 78431.8438; val_gene_expr_recon_loss: 116063.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 579176.5000; val_optim_loss: 579176.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6918; val_auprc_score: 0.7251; val_best_acc_score: 0.6239; val_best_f1_score: 0.6924; train_kl_reg_loss: 4536.7544; train_edge_recon_loss: 349769.3359; train_cond_contrastive_loss: 87872.9688; train_gene_expr_recon_loss: 115443.1699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557622.2188; train_optim_loss: 557622.2188; val_kl_reg_loss: 3885.8850; val_edge_recon_loss: 348576.9375; val_cond_contrastive_loss: 78519.4375; val_gene_expr_recon_loss: 115321.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546303.8125; val_optim_loss: 546303.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6910; val_auprc_score: 0.7172; val_best_acc_score: 0.6347; val_best_f1_score: 0.6831; train_kl_reg_loss: 3699.9280; train_edge_recon_loss: 336518.7188; train_cond_contrastive_loss: 87530.3457; train_gene_expr_recon_loss: 114516.2090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542265.1875; train_optim_loss: 542265.1875; val_kl_reg_loss: 3482.5649; val_edge_recon_loss: 342475.5000; val_cond_contrastive_loss: 78418.8672; val_gene_expr_recon_loss: 114671.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539048.4375; val_optim_loss: 539048.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6998; val_auprc_score: 0.7315; val_best_acc_score: 0.6386; val_best_f1_score: 0.6935; train_kl_reg_loss: 3779.7542; train_edge_recon_loss: 326220.4609; train_cond_contrastive_loss: 81895.3887; train_gene_expr_recon_loss: 114758.5898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 526654.1875; train_optim_loss: 526654.1875; val_kl_reg_loss: 4043.8867; val_edge_recon_loss: 330386.0938; val_cond_contrastive_loss: 78392.9453; val_gene_expr_recon_loss: 114001.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526824.1875; val_optim_loss: 526824.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7297; val_auprc_score: 0.7530; val_best_acc_score: 0.6598; val_best_f1_score: 0.7019; train_kl_reg_loss: 4272.9330; train_edge_recon_loss: 320624.7344; train_cond_contrastive_loss: 79474.3633; train_gene_expr_recon_loss: 113453.8008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517825.8281; train_optim_loss: 517825.8281; val_kl_reg_loss: 4401.4258; val_edge_recon_loss: 322686.5625; val_cond_contrastive_loss: 78393.6719; val_gene_expr_recon_loss: 113557.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519039.4688; val_optim_loss: 519039.4688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7863; val_auprc_score: 0.7823; val_best_acc_score: 0.7058; val_best_f1_score: 0.7452; train_kl_reg_loss: 4661.4835; train_edge_recon_loss: 307057.6641; train_cond_contrastive_loss: 79157.9199; train_gene_expr_recon_loss: 113579.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504456.1094; train_optim_loss: 504456.1094; val_kl_reg_loss: 4865.9590; val_edge_recon_loss: 300599.3438; val_cond_contrastive_loss: 78413.1641; val_gene_expr_recon_loss: 113226.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497105.2812; val_optim_loss: 497105.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8108; val_auprc_score: 0.7953; val_best_acc_score: 0.7333; val_best_f1_score: 0.7721; train_kl_reg_loss: 5243.5090; train_edge_recon_loss: 295846.2500; train_cond_contrastive_loss: 78925.4844; train_gene_expr_recon_loss: 112322.9590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492338.2109; train_optim_loss: 492338.2109; val_kl_reg_loss: 5701.6895; val_edge_recon_loss: 292553.7500; val_cond_contrastive_loss: 78420.6484; val_gene_expr_recon_loss: 112696.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489372.9688; val_optim_loss: 489372.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8244; val_auprc_score: 0.7957; val_best_acc_score: 0.7514; val_best_f1_score: 0.7876; train_kl_reg_loss: 6174.9570; train_edge_recon_loss: 288445.8281; train_cond_contrastive_loss: 78715.9570; train_gene_expr_recon_loss: 112454.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485790.8047; train_optim_loss: 485790.8047; val_kl_reg_loss: 6421.0098; val_edge_recon_loss: 289150.2188; val_cond_contrastive_loss: 78410.0547; val_gene_expr_recon_loss: 112163.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486144.7500; val_optim_loss: 486144.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8352; val_auprc_score: 0.8142; val_best_acc_score: 0.7649; val_best_f1_score: 0.7977; train_kl_reg_loss: 6663.2878; train_edge_recon_loss: 287521.8359; train_cond_contrastive_loss: 78709.4980; train_gene_expr_recon_loss: 111396.5977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 484291.2266; train_optim_loss: 484291.2266; val_kl_reg_loss: 6522.8721; val_edge_recon_loss: 280168.5312; val_cond_contrastive_loss: 78401.6719; val_gene_expr_recon_loss: 111741.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476834.1250; val_optim_loss: 476834.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8438; val_auprc_score: 0.8127; val_best_acc_score: 0.7760; val_best_f1_score: 0.8020; train_kl_reg_loss: 6630.6075; train_edge_recon_loss: 284321.0312; train_cond_contrastive_loss: 78837.6973; train_gene_expr_recon_loss: 111239.5801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481028.9062; train_optim_loss: 481028.9062; val_kl_reg_loss: 6386.3525; val_edge_recon_loss: 284249.8750; val_cond_contrastive_loss: 78393.8828; val_gene_expr_recon_loss: 111364.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480395.0625; val_optim_loss: 480395.0625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8637; val_auprc_score: 0.8360; val_best_acc_score: 0.7937; val_best_f1_score: 0.8180; train_kl_reg_loss: 6557.2810; train_edge_recon_loss: 280399.1328; train_cond_contrastive_loss: 78931.6016; train_gene_expr_recon_loss: 110395.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476283.4141; train_optim_loss: 476283.4141; val_kl_reg_loss: 6492.9893; val_edge_recon_loss: 276715.5938; val_cond_contrastive_loss: 78400.9062; val_gene_expr_recon_loss: 111088.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472698.1875; val_optim_loss: 472698.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8778; val_auprc_score: 0.8503; val_best_acc_score: 0.8115; val_best_f1_score: 0.8304; train_kl_reg_loss: 6710.5176; train_edge_recon_loss: 280805.8203; train_cond_contrastive_loss: 78899.9844; train_gene_expr_recon_loss: 110967.8457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477384.1719; train_optim_loss: 477384.1719; val_kl_reg_loss: 6600.8447; val_edge_recon_loss: 274714.1875; val_cond_contrastive_loss: 78409.8203; val_gene_expr_recon_loss: 110751.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470476.3750; val_optim_loss: 470476.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8854; val_auprc_score: 0.8581; val_best_acc_score: 0.8213; val_best_f1_score: 0.8374; train_kl_reg_loss: 6745.3358; train_edge_recon_loss: 277650.8906; train_cond_contrastive_loss: 78888.9121; train_gene_expr_recon_loss: 110822.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474107.2031; train_optim_loss: 474107.2031; val_kl_reg_loss: 6585.6348; val_edge_recon_loss: 278256.5000; val_cond_contrastive_loss: 78419.8984; val_gene_expr_recon_loss: 110406.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473668.7500; val_optim_loss: 473668.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9008; val_auprc_score: 0.8756; val_best_acc_score: 0.8342; val_best_f1_score: 0.8492; train_kl_reg_loss: 6654.8933; train_edge_recon_loss: 274592.9688; train_cond_contrastive_loss: 78851.1797; train_gene_expr_recon_loss: 110179.1680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470278.2109; train_optim_loss: 470278.2109; val_kl_reg_loss: 6301.2080; val_edge_recon_loss: 274283.7500; val_cond_contrastive_loss: 78433.5078; val_gene_expr_recon_loss: 110109.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469127.5625; val_optim_loss: 469127.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9146; val_auprc_score: 0.8980; val_best_acc_score: 0.8450; val_best_f1_score: 0.8602; train_kl_reg_loss: 6338.3551; train_edge_recon_loss: 273646.6641; train_cond_contrastive_loss: 78900.4746; train_gene_expr_recon_loss: 109831.0566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468716.5469; train_optim_loss: 468716.5469; val_kl_reg_loss: 6118.5039; val_edge_recon_loss: 269937.7812; val_cond_contrastive_loss: 78444.9141; val_gene_expr_recon_loss: 109823.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464324.4375; val_optim_loss: 464324.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9270; val_auprc_score: 0.9105; val_best_acc_score: 0.8539; val_best_f1_score: 0.8627; train_kl_reg_loss: 6260.7959; train_edge_recon_loss: 273115.1016; train_cond_contrastive_loss: 78814.8906; train_gene_expr_recon_loss: 109801.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467991.9141; train_optim_loss: 467991.9141; val_kl_reg_loss: 6044.0586; val_edge_recon_loss: 271830.8438; val_cond_contrastive_loss: 78445.4375; val_gene_expr_recon_loss: 109564.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465885.3125; val_optim_loss: 465885.3125
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9334; val_auprc_score: 0.9212; val_best_acc_score: 0.8576; val_best_f1_score: 0.8690; train_kl_reg_loss: 6197.0490; train_edge_recon_loss: 273421.8828; train_cond_contrastive_loss: 78777.9121; train_gene_expr_recon_loss: 109281.9902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467678.8359; train_optim_loss: 467678.8359; val_kl_reg_loss: 6060.8867; val_edge_recon_loss: 268960.0625; val_cond_contrastive_loss: 78443.5234; val_gene_expr_recon_loss: 109315.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462780.1875; val_optim_loss: 462780.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9381; val_auprc_score: 0.9233; val_best_acc_score: 0.8698; val_best_f1_score: 0.8773; train_kl_reg_loss: 6291.1533; train_edge_recon_loss: 271881.4297; train_cond_contrastive_loss: 78702.1602; train_gene_expr_recon_loss: 108883.0996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465757.8281; train_optim_loss: 465757.8281; val_kl_reg_loss: 6225.8564; val_edge_recon_loss: 271586.6875; val_cond_contrastive_loss: 78438.0469; val_gene_expr_recon_loss: 109054.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465304.8750; val_optim_loss: 465304.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9438; val_auprc_score: 0.9350; val_best_acc_score: 0.8760; val_best_f1_score: 0.8815; train_kl_reg_loss: 6415.6785; train_edge_recon_loss: 270119.0859; train_cond_contrastive_loss: 78653.4453; train_gene_expr_recon_loss: 108439.8262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463628.0234; train_optim_loss: 463628.0234; val_kl_reg_loss: 6282.8286; val_edge_recon_loss: 267466.2812; val_cond_contrastive_loss: 78436.6562; val_gene_expr_recon_loss: 108778.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460964.7500; val_optim_loss: 460964.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9517; val_auprc_score: 0.9442; val_best_acc_score: 0.8892; val_best_f1_score: 0.8950; train_kl_reg_loss: 6428.3381; train_edge_recon_loss: 269624.9453; train_cond_contrastive_loss: 78648.5723; train_gene_expr_recon_loss: 109135.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463836.9922; train_optim_loss: 463836.9922; val_kl_reg_loss: 6238.0957; val_edge_recon_loss: 266089.4375; val_cond_contrastive_loss: 78436.1328; val_gene_expr_recon_loss: 108510.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459274.6250; val_optim_loss: 459274.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9558; val_auprc_score: 0.9468; val_best_acc_score: 0.8962; val_best_f1_score: 0.8996; train_kl_reg_loss: 6281.1094; train_edge_recon_loss: 269700.0859; train_cond_contrastive_loss: 78677.9629; train_gene_expr_recon_loss: 108659.0859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463318.2500; train_optim_loss: 463318.2500; val_kl_reg_loss: 5999.5674; val_edge_recon_loss: 267919.8125; val_cond_contrastive_loss: 78436.1484; val_gene_expr_recon_loss: 108288.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460644.2812; val_optim_loss: 460644.2812
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9562; val_auprc_score: 0.9488; val_best_acc_score: 0.8967; val_best_f1_score: 0.9026; train_kl_reg_loss: 6116.5848; train_edge_recon_loss: 269500.8359; train_cond_contrastive_loss: 78722.4688; train_gene_expr_recon_loss: 107918.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462258.7891; train_optim_loss: 462258.7891; val_kl_reg_loss: 5922.9546; val_edge_recon_loss: 267768.7812; val_cond_contrastive_loss: 78438.7188; val_gene_expr_recon_loss: 108019.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460150.1250; val_optim_loss: 460150.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9618; val_auprc_score: 0.9526; val_best_acc_score: 0.9070; val_best_f1_score: 0.9093; train_kl_reg_loss: 6047.9794; train_edge_recon_loss: 267802.3984; train_cond_contrastive_loss: 78721.1270; train_gene_expr_recon_loss: 107776.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460347.7422; train_optim_loss: 460347.7422; val_kl_reg_loss: 5850.3813; val_edge_recon_loss: 270579.4062; val_cond_contrastive_loss: 78438.9922; val_gene_expr_recon_loss: 107755.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462624.6875; val_optim_loss: 462624.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9632; val_auprc_score: 0.9557; val_best_acc_score: 0.9056; val_best_f1_score: 0.9087; train_kl_reg_loss: 5996.0541; train_edge_recon_loss: 265006.4688; train_cond_contrastive_loss: 78740.5977; train_gene_expr_recon_loss: 107759.7930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457502.9219; train_optim_loss: 457502.9219; val_kl_reg_loss: 5841.4365; val_edge_recon_loss: 268667.4375; val_cond_contrastive_loss: 78439.1250; val_gene_expr_recon_loss: 107717.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460665.0312; val_optim_loss: 460665.0312
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9671; val_auprc_score: 0.9604; val_best_acc_score: 0.9141; val_best_f1_score: 0.9178; train_kl_reg_loss: 5989.2839; train_edge_recon_loss: 266695.2266; train_cond_contrastive_loss: 78727.1621; train_gene_expr_recon_loss: 107273.9629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458685.6406; train_optim_loss: 458685.6406; val_kl_reg_loss: 5844.5889; val_edge_recon_loss: 264414.1562; val_cond_contrastive_loss: 78440.1094; val_gene_expr_recon_loss: 107682.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456381.6250; val_optim_loss: 456381.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9628; val_auprc_score: 0.9533; val_best_acc_score: 0.9077; val_best_f1_score: 0.9120; train_kl_reg_loss: 5979.6942; train_edge_recon_loss: 266921.2031; train_cond_contrastive_loss: 78720.3652; train_gene_expr_recon_loss: 107505.1660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459126.4219; train_optim_loss: 459126.4219; val_kl_reg_loss: 5826.5684; val_edge_recon_loss: 266507.2188; val_cond_contrastive_loss: 78439.9375; val_gene_expr_recon_loss: 107650.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458424.5000; val_optim_loss: 458424.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9657; val_auprc_score: 0.9602; val_best_acc_score: 0.9107; val_best_f1_score: 0.9141; train_kl_reg_loss: 5973.6007; train_edge_recon_loss: 267003.7109; train_cond_contrastive_loss: 78729.9707; train_gene_expr_recon_loss: 107472.7910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459180.0859; train_optim_loss: 459180.0859; val_kl_reg_loss: 5812.8135; val_edge_recon_loss: 265085.0938; val_cond_contrastive_loss: 78441.0156; val_gene_expr_recon_loss: 107619.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456958.0938; val_optim_loss: 456958.0938
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9652; val_auprc_score: 0.9595; val_best_acc_score: 0.9118; val_best_f1_score: 0.9143; train_kl_reg_loss: 5966.1934; train_edge_recon_loss: 266285.0312; train_cond_contrastive_loss: 78737.0293; train_gene_expr_recon_loss: 107787.0449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458775.2812; train_optim_loss: 458775.2812; val_kl_reg_loss: 5813.7695; val_edge_recon_loss: 268360.0938; val_cond_contrastive_loss: 78438.9609; val_gene_expr_recon_loss: 107591.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460204.2812; val_optim_loss: 460204.2812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9660; val_auprc_score: 0.9590; val_best_acc_score: 0.9134; val_best_f1_score: 0.9159; train_kl_reg_loss: 5963.8002; train_edge_recon_loss: 266720.0391; train_cond_contrastive_loss: 78730.8828; train_gene_expr_recon_loss: 107003.1738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458417.9062; train_optim_loss: 458417.9062; val_kl_reg_loss: 5822.4946; val_edge_recon_loss: 264717.7812; val_cond_contrastive_loss: 78438.6797; val_gene_expr_recon_loss: 107588.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456567.7812; val_optim_loss: 456567.7812
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9664; val_auprc_score: 0.9582; val_best_acc_score: 0.9125; val_best_f1_score: 0.9155; train_kl_reg_loss: 5952.8812; train_edge_recon_loss: 265895.8984; train_cond_contrastive_loss: 78733.2266; train_gene_expr_recon_loss: 106982.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457564.0312; train_optim_loss: 457564.0312; val_kl_reg_loss: 5814.2905; val_edge_recon_loss: 265108.3438; val_cond_contrastive_loss: 78440.6016; val_gene_expr_recon_loss: 107586.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456949.4688; val_optim_loss: 456949.4688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9658; val_auprc_score: 0.9595; val_best_acc_score: 0.9131; val_best_f1_score: 0.9149; train_kl_reg_loss: 5977.5197; train_edge_recon_loss: 266729.1094; train_cond_contrastive_loss: 78728.6582; train_gene_expr_recon_loss: 107236.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458671.4453; train_optim_loss: 458671.4453; val_kl_reg_loss: 5817.3174; val_edge_recon_loss: 268748.6562; val_cond_contrastive_loss: 78439.8281; val_gene_expr_recon_loss: 107583.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460589.5938; val_optim_loss: 460589.5938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 45 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9639
Val AUPRC score: 0.9552
Val best accuracy score: 0.9095
Val best F1 score: 0.9122
Val gene expr MSE score: 1.8654
Duration of model training in run 3: 0 hours, 1 minutes and 48 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7262; val_auprc_score: 0.7711; val_best_acc_score: 0.6742; val_best_f1_score: 0.6864; train_kl_reg_loss: 1765.4231; train_edge_recon_loss: 355663.3828; train_cond_contrastive_loss: 120068.2910; train_gene_expr_recon_loss: 142727.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 620225.0781; train_optim_loss: 620225.0781; val_kl_reg_loss: 4379.4443; val_edge_recon_loss: 402856.1250; val_cond_contrastive_loss: 78361.0078; val_gene_expr_recon_loss: 125965.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 611562.4375; val_optim_loss: 611562.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6889; val_auprc_score: 0.7272; val_best_acc_score: 0.6257; val_best_f1_score: 0.6809; train_kl_reg_loss: 10072.3479; train_edge_recon_loss: 363325.9297; train_cond_contrastive_loss: 86417.0430; train_gene_expr_recon_loss: 123801.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 583617.2188; train_optim_loss: 583617.2188; val_kl_reg_loss: 8028.8525; val_edge_recon_loss: 398398.5938; val_cond_contrastive_loss: 78380.4141; val_gene_expr_recon_loss: 119964.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 604772.8125; val_optim_loss: 604772.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6879; val_auprc_score: 0.7213; val_best_acc_score: 0.6234; val_best_f1_score: 0.6839; train_kl_reg_loss: 6883.9609; train_edge_recon_loss: 356032.1875; train_cond_contrastive_loss: 88948.9590; train_gene_expr_recon_loss: 118525.3379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 570390.4688; train_optim_loss: 570390.4688; val_kl_reg_loss: 5505.5195; val_edge_recon_loss: 381826.7500; val_cond_contrastive_loss: 78449.6328; val_gene_expr_recon_loss: 117491.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 583272.9375; val_optim_loss: 583272.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6834; val_auprc_score: 0.7125; val_best_acc_score: 0.6295; val_best_f1_score: 0.6750; train_kl_reg_loss: 5368.8123; train_edge_recon_loss: 347999.5625; train_cond_contrastive_loss: 87713.7969; train_gene_expr_recon_loss: 116774.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557856.2969; train_optim_loss: 557856.2969; val_kl_reg_loss: 4243.4893; val_edge_recon_loss: 362733.0625; val_cond_contrastive_loss: 78534.6172; val_gene_expr_recon_loss: 116569.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 562081.0625; val_optim_loss: 562081.0625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6901; val_auprc_score: 0.7199; val_best_acc_score: 0.6394; val_best_f1_score: 0.6779; train_kl_reg_loss: 3866.5134; train_edge_recon_loss: 336407.1406; train_cond_contrastive_loss: 87019.9453; train_gene_expr_recon_loss: 115642.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542936.2031; train_optim_loss: 542936.2031; val_kl_reg_loss: 3533.0913; val_edge_recon_loss: 345991.1562; val_cond_contrastive_loss: 78437.0234; val_gene_expr_recon_loss: 116034.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 543996.1250; val_optim_loss: 543996.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6920; val_auprc_score: 0.7271; val_best_acc_score: 0.6456; val_best_f1_score: 0.6769; train_kl_reg_loss: 3748.1035; train_edge_recon_loss: 328325.2188; train_cond_contrastive_loss: 82616.3516; train_gene_expr_recon_loss: 115081.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529771.1250; train_optim_loss: 529771.1250; val_kl_reg_loss: 4014.0410; val_edge_recon_loss: 344535.8438; val_cond_contrastive_loss: 78408.6250; val_gene_expr_recon_loss: 115562.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542520.6250; val_optim_loss: 542520.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7014; val_auprc_score: 0.7290; val_best_acc_score: 0.6532; val_best_f1_score: 0.6830; train_kl_reg_loss: 4103.7634; train_edge_recon_loss: 326172.3047; train_cond_contrastive_loss: 79866.2266; train_gene_expr_recon_loss: 114268.3105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 524410.5938; train_optim_loss: 524410.5938; val_kl_reg_loss: 4008.5142; val_edge_recon_loss: 338696.8438; val_cond_contrastive_loss: 78397.4062; val_gene_expr_recon_loss: 115101.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536203.8125; val_optim_loss: 536203.8125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7405; val_auprc_score: 0.7577; val_best_acc_score: 0.6714; val_best_f1_score: 0.7036; train_kl_reg_loss: 3953.8346; train_edge_recon_loss: 319427.7422; train_cond_contrastive_loss: 79899.3262; train_gene_expr_recon_loss: 114796.3418; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518077.2500; train_optim_loss: 518077.2500; val_kl_reg_loss: 3883.4766; val_edge_recon_loss: 321571.3750; val_cond_contrastive_loss: 78410.7578; val_gene_expr_recon_loss: 114702.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 518568.5312; val_optim_loss: 518568.5312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7938; val_auprc_score: 0.7922; val_best_acc_score: 0.7125; val_best_f1_score: 0.7367; train_kl_reg_loss: 4054.1597; train_edge_recon_loss: 307860.8594; train_cond_contrastive_loss: 79880.8398; train_gene_expr_recon_loss: 113503.6445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 505299.5078; train_optim_loss: 505299.5078; val_kl_reg_loss: 4447.0576; val_edge_recon_loss: 305235.7812; val_cond_contrastive_loss: 78446.6797; val_gene_expr_recon_loss: 114204.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502333.7188; val_optim_loss: 502333.7188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8187; val_auprc_score: 0.8033; val_best_acc_score: 0.7394; val_best_f1_score: 0.7662; train_kl_reg_loss: 4879.4753; train_edge_recon_loss: 294321.9688; train_cond_contrastive_loss: 79151.6250; train_gene_expr_recon_loss: 113205.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491558.6406; train_optim_loss: 491558.6406; val_kl_reg_loss: 5615.8618; val_edge_recon_loss: 298283.2500; val_cond_contrastive_loss: 78456.0000; val_gene_expr_recon_loss: 113711.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 496066.1562; val_optim_loss: 496066.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8311; val_auprc_score: 0.8019; val_best_acc_score: 0.7550; val_best_f1_score: 0.7809; train_kl_reg_loss: 6048.4922; train_edge_recon_loss: 287082.1250; train_cond_contrastive_loss: 78773.0859; train_gene_expr_recon_loss: 113106.8945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485010.6094; train_optim_loss: 485010.6094; val_kl_reg_loss: 6553.7119; val_edge_recon_loss: 294959.7812; val_cond_contrastive_loss: 78441.0859; val_gene_expr_recon_loss: 113269.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493223.6250; val_optim_loss: 493223.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8422; val_auprc_score: 0.8143; val_best_acc_score: 0.7658; val_best_f1_score: 0.7907; train_kl_reg_loss: 6794.5680; train_edge_recon_loss: 283521.0469; train_cond_contrastive_loss: 78675.7754; train_gene_expr_recon_loss: 112541.4922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481532.8828; train_optim_loss: 481532.8828; val_kl_reg_loss: 6822.7681; val_edge_recon_loss: 288922.0312; val_cond_contrastive_loss: 78426.9375; val_gene_expr_recon_loss: 112873.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487044.8750; val_optim_loss: 487044.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8560; val_auprc_score: 0.8231; val_best_acc_score: 0.7824; val_best_f1_score: 0.8059; train_kl_reg_loss: 6785.3920; train_edge_recon_loss: 280566.2344; train_cond_contrastive_loss: 78704.7012; train_gene_expr_recon_loss: 112626.4355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478682.7734; train_optim_loss: 478682.7734; val_kl_reg_loss: 6428.4082; val_edge_recon_loss: 283196.5625; val_cond_contrastive_loss: 78422.2109; val_gene_expr_recon_loss: 112556.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480603.5000; val_optim_loss: 480603.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8644; val_auprc_score: 0.8338; val_best_acc_score: 0.7948; val_best_f1_score: 0.8135; train_kl_reg_loss: 6324.4713; train_edge_recon_loss: 279739.7344; train_cond_contrastive_loss: 78831.1426; train_gene_expr_recon_loss: 112346.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477241.6875; train_optim_loss: 477241.6875; val_kl_reg_loss: 5953.6519; val_edge_recon_loss: 285480.6250; val_cond_contrastive_loss: 78421.0469; val_gene_expr_recon_loss: 112270.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482126.0000; val_optim_loss: 482126.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8810; val_auprc_score: 0.8486; val_best_acc_score: 0.8111; val_best_f1_score: 0.8285; train_kl_reg_loss: 6002.2910; train_edge_recon_loss: 277573.3984; train_cond_contrastive_loss: 78960.3027; train_gene_expr_recon_loss: 111858.5918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474394.5781; train_optim_loss: 474394.5781; val_kl_reg_loss: 5878.9238; val_edge_recon_loss: 280727.6250; val_cond_contrastive_loss: 78415.3906; val_gene_expr_recon_loss: 111906.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476928.6562; val_optim_loss: 476928.6562
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8898; val_auprc_score: 0.8580; val_best_acc_score: 0.8239; val_best_f1_score: 0.8379; train_kl_reg_loss: 6020.2419; train_edge_recon_loss: 275692.8984; train_cond_contrastive_loss: 78857.4141; train_gene_expr_recon_loss: 111269.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471840.4297; train_optim_loss: 471840.4297; val_kl_reg_loss: 5947.4995; val_edge_recon_loss: 280246.7812; val_cond_contrastive_loss: 78419.5078; val_gene_expr_recon_loss: 111592.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476206.5625; val_optim_loss: 476206.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9082; val_auprc_score: 0.8871; val_best_acc_score: 0.8356; val_best_f1_score: 0.8482; train_kl_reg_loss: 6038.0316; train_edge_recon_loss: 272651.8438; train_cond_contrastive_loss: 78834.5547; train_gene_expr_recon_loss: 110877.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468401.8906; train_optim_loss: 468401.8906; val_kl_reg_loss: 5983.8789; val_edge_recon_loss: 273085.0938; val_cond_contrastive_loss: 78421.9062; val_gene_expr_recon_loss: 111335.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468826.4062; val_optim_loss: 468826.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9163; val_auprc_score: 0.8996; val_best_acc_score: 0.8423; val_best_f1_score: 0.8502; train_kl_reg_loss: 6092.1031; train_edge_recon_loss: 272386.8359; train_cond_contrastive_loss: 78723.2227; train_gene_expr_recon_loss: 110520.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467722.4922; train_optim_loss: 467722.4922; val_kl_reg_loss: 5941.9062; val_edge_recon_loss: 275213.2500; val_cond_contrastive_loss: 78421.0078; val_gene_expr_recon_loss: 111072.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470649.0312; val_optim_loss: 470649.0312
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9284; val_auprc_score: 0.9146; val_best_acc_score: 0.8548; val_best_f1_score: 0.8601; train_kl_reg_loss: 5976.8412; train_edge_recon_loss: 272597.5625; train_cond_contrastive_loss: 78700.7676; train_gene_expr_recon_loss: 110031.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467306.7344; train_optim_loss: 467306.7344; val_kl_reg_loss: 5865.5703; val_edge_recon_loss: 273198.7812; val_cond_contrastive_loss: 78418.2891; val_gene_expr_recon_loss: 110837.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468320.1250; val_optim_loss: 468320.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9344; val_auprc_score: 0.9234; val_best_acc_score: 0.8586; val_best_f1_score: 0.8632; train_kl_reg_loss: 5981.0602; train_edge_recon_loss: 269833.7578; train_cond_contrastive_loss: 78673.0977; train_gene_expr_recon_loss: 110473.1895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464961.0938; train_optim_loss: 464961.0938; val_kl_reg_loss: 5961.8589; val_edge_recon_loss: 273715.7500; val_cond_contrastive_loss: 78417.0312; val_gene_expr_recon_loss: 110585.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468680.5000; val_optim_loss: 468680.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9402; val_auprc_score: 0.9277; val_best_acc_score: 0.8709; val_best_f1_score: 0.8739; train_kl_reg_loss: 6059.8322; train_edge_recon_loss: 270841.3125; train_cond_contrastive_loss: 78650.6406; train_gene_expr_recon_loss: 109177.3027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464729.0938; train_optim_loss: 464729.0938; val_kl_reg_loss: 6059.5791; val_edge_recon_loss: 271804.0000; val_cond_contrastive_loss: 78414.8125; val_gene_expr_recon_loss: 110353.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466631.6875; val_optim_loss: 466631.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9447; val_auprc_score: 0.9336; val_best_acc_score: 0.8778; val_best_f1_score: 0.8813; train_kl_reg_loss: 6164.2709; train_edge_recon_loss: 270919.0391; train_cond_contrastive_loss: 78628.7305; train_gene_expr_recon_loss: 110057.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465769.8984; train_optim_loss: 465769.8984; val_kl_reg_loss: 6110.8340; val_edge_recon_loss: 269203.2188; val_cond_contrastive_loss: 78414.9062; val_gene_expr_recon_loss: 110128.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463857.0938; val_optim_loss: 463857.0938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9520; val_auprc_score: 0.9477; val_best_acc_score: 0.8871; val_best_f1_score: 0.8897; train_kl_reg_loss: 6152.3308; train_edge_recon_loss: 269436.1172; train_cond_contrastive_loss: 78635.0137; train_gene_expr_recon_loss: 109038.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463261.6875; train_optim_loss: 463261.6875; val_kl_reg_loss: 6035.8931; val_edge_recon_loss: 269456.9688; val_cond_contrastive_loss: 78417.6797; val_gene_expr_recon_loss: 109898.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463809.2500; val_optim_loss: 463809.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9519; val_auprc_score: 0.9435; val_best_acc_score: 0.8907; val_best_f1_score: 0.8958; train_kl_reg_loss: 6060.6083; train_edge_recon_loss: 269460.9609; train_cond_contrastive_loss: 78669.0566; train_gene_expr_recon_loss: 109115.0879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463305.7109; train_optim_loss: 463305.7109; val_kl_reg_loss: 5978.1357; val_edge_recon_loss: 267907.0625; val_cond_contrastive_loss: 78421.1016; val_gene_expr_recon_loss: 109669.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461976.0625; val_optim_loss: 461976.0625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9556; val_auprc_score: 0.9477; val_best_acc_score: 0.8978; val_best_f1_score: 0.9008; train_kl_reg_loss: 6072.9525; train_edge_recon_loss: 267775.8984; train_cond_contrastive_loss: 78676.4473; train_gene_expr_recon_loss: 109328.1895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461853.4922; train_optim_loss: 461853.4922; val_kl_reg_loss: 5972.5415; val_edge_recon_loss: 269095.6562; val_cond_contrastive_loss: 78423.7344; val_gene_expr_recon_loss: 109427.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462919.8438; val_optim_loss: 462919.8438
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9594; val_auprc_score: 0.9536; val_best_acc_score: 0.9019; val_best_f1_score: 0.9066; train_kl_reg_loss: 6000.7948; train_edge_recon_loss: 266678.1719; train_cond_contrastive_loss: 78711.2812; train_gene_expr_recon_loss: 108442.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459832.5469; train_optim_loss: 459832.5469; val_kl_reg_loss: 5836.9834; val_edge_recon_loss: 269631.9062; val_cond_contrastive_loss: 78432.3438; val_gene_expr_recon_loss: 109175.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463076.2500; val_optim_loss: 463076.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9628; val_auprc_score: 0.9510; val_best_acc_score: 0.9109; val_best_f1_score: 0.9125; train_kl_reg_loss: 5937.4727; train_edge_recon_loss: 267763.3125; train_cond_contrastive_loss: 78726.9102; train_gene_expr_recon_loss: 108236.6914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460664.3828; train_optim_loss: 460664.3828; val_kl_reg_loss: 5790.9189; val_edge_recon_loss: 269377.6250; val_cond_contrastive_loss: 78434.9219; val_gene_expr_recon_loss: 108941.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462545.0000; val_optim_loss: 462545.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9625; val_auprc_score: 0.9544; val_best_acc_score: 0.9097; val_best_f1_score: 0.9125; train_kl_reg_loss: 5903.0026; train_edge_recon_loss: 266155.7344; train_cond_contrastive_loss: 78741.6133; train_gene_expr_recon_loss: 108867.6426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459667.9922; train_optim_loss: 459667.9922; val_kl_reg_loss: 5768.7095; val_edge_recon_loss: 264930.7812; val_cond_contrastive_loss: 78435.6406; val_gene_expr_recon_loss: 108910.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458045.1562; val_optim_loss: 458045.1562
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9643; val_auprc_score: 0.9576; val_best_acc_score: 0.9105; val_best_f1_score: 0.9126; train_kl_reg_loss: 5871.6493; train_edge_recon_loss: 266211.7188; train_cond_contrastive_loss: 78745.5801; train_gene_expr_recon_loss: 108641.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459470.2891; train_optim_loss: 459470.2891; val_kl_reg_loss: 5752.6338; val_edge_recon_loss: 270268.7500; val_cond_contrastive_loss: 78436.3750; val_gene_expr_recon_loss: 108879.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463336.8125; val_optim_loss: 463336.8125
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9697; val_auprc_score: 0.9635; val_best_acc_score: 0.9194; val_best_f1_score: 0.9206; train_kl_reg_loss: 5848.5530; train_edge_recon_loss: 266888.6719; train_cond_contrastive_loss: 78750.8340; train_gene_expr_recon_loss: 108358.0352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459846.0859; train_optim_loss: 459846.0859; val_kl_reg_loss: 5742.3594; val_edge_recon_loss: 267868.4375; val_cond_contrastive_loss: 78435.9453; val_gene_expr_recon_loss: 108856.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460903.4375; val_optim_loss: 460903.4375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9653; val_auprc_score: 0.9574; val_best_acc_score: 0.9106; val_best_f1_score: 0.9122; train_kl_reg_loss: 5834.4166; train_edge_recon_loss: 265376.4453; train_cond_contrastive_loss: 78755.5527; train_gene_expr_recon_loss: 108155.2383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458121.6328; train_optim_loss: 458121.6328; val_kl_reg_loss: 5731.9858; val_edge_recon_loss: 272555.2188; val_cond_contrastive_loss: 78436.3828; val_gene_expr_recon_loss: 108835.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465559.4062; val_optim_loss: 465559.4062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9695; val_auprc_score: 0.9651; val_best_acc_score: 0.9183; val_best_f1_score: 0.9198; train_kl_reg_loss: 5831.1829; train_edge_recon_loss: 265635.8125; train_cond_contrastive_loss: 78754.4902; train_gene_expr_recon_loss: 107873.7617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458095.2500; train_optim_loss: 458095.2500; val_kl_reg_loss: 5733.2788; val_edge_recon_loss: 267636.0312; val_cond_contrastive_loss: 78435.5234; val_gene_expr_recon_loss: 108833.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460638.3750; val_optim_loss: 460638.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9640; val_auprc_score: 0.9536; val_best_acc_score: 0.9146; val_best_f1_score: 0.9173; train_kl_reg_loss: 5843.3268; train_edge_recon_loss: 265500.8359; train_cond_contrastive_loss: 78754.3301; train_gene_expr_recon_loss: 107730.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457828.9141; train_optim_loss: 457828.9141; val_kl_reg_loss: 5740.5664; val_edge_recon_loss: 266016.4688; val_cond_contrastive_loss: 78438.0156; val_gene_expr_recon_loss: 108830.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459025.8750; val_optim_loss: 459025.8750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9669; val_auprc_score: 0.9610; val_best_acc_score: 0.9150; val_best_f1_score: 0.9167; train_kl_reg_loss: 5829.3037; train_edge_recon_loss: 267053.9141; train_cond_contrastive_loss: 78751.3242; train_gene_expr_recon_loss: 108096.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459730.7812; train_optim_loss: 459730.7812; val_kl_reg_loss: 5734.4004; val_edge_recon_loss: 268763.1250; val_cond_contrastive_loss: 78437.0859; val_gene_expr_recon_loss: 108827.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461762.4375; val_optim_loss: 461762.4375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 48 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9656
Val AUPRC score: 0.9580
Val best accuracy score: 0.9135
Val best F1 score: 0.9159
Val gene expr MSE score: 1.9293
Duration of model training in run 4: 0 hours, 1 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7826; val_auprc_score: 0.8153; val_best_acc_score: 0.7055; val_best_f1_score: 0.7109; train_kl_reg_loss: 3870.7017; train_edge_recon_loss: 357480.2240; train_cond_contrastive_loss: 110272.9076; train_gene_expr_recon_loss: 131632.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 603256.5729; train_optim_loss: 603256.5729; val_kl_reg_loss: 14364.3809; val_edge_recon_loss: 399754.5625; val_cond_contrastive_loss: 78340.5469; val_gene_expr_recon_loss: 117186.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 609646.1250; val_optim_loss: 609646.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7350; val_auprc_score: 0.7626; val_best_acc_score: 0.6477; val_best_f1_score: 0.7073; train_kl_reg_loss: 8730.9541; train_edge_recon_loss: 356279.1146; train_cond_contrastive_loss: 89083.6953; train_gene_expr_recon_loss: 117637.5065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 571731.2708; train_optim_loss: 571731.2708; val_kl_reg_loss: 5641.9580; val_edge_recon_loss: 387996.0625; val_cond_contrastive_loss: 78373.0781; val_gene_expr_recon_loss: 114977.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 586989.0625; val_optim_loss: 586989.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7265; val_auprc_score: 0.7568; val_best_acc_score: 0.6537; val_best_f1_score: 0.7039; train_kl_reg_loss: 5490.6834; train_edge_recon_loss: 347712.4844; train_cond_contrastive_loss: 88467.1875; train_gene_expr_recon_loss: 115275.1029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556945.4583; train_optim_loss: 556945.4583; val_kl_reg_loss: 4091.5664; val_edge_recon_loss: 346871.2812; val_cond_contrastive_loss: 78463.8594; val_gene_expr_recon_loss: 113920.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 543346.8750; val_optim_loss: 543346.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7333; val_auprc_score: 0.7653; val_best_acc_score: 0.6677; val_best_f1_score: 0.7026; train_kl_reg_loss: 3813.8715; train_edge_recon_loss: 329216.7760; train_cond_contrastive_loss: 86151.0078; train_gene_expr_recon_loss: 114148.7174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533330.3750; train_optim_loss: 533330.3750; val_kl_reg_loss: 4043.1926; val_edge_recon_loss: 325146.5000; val_cond_contrastive_loss: 78379.6094; val_gene_expr_recon_loss: 113240.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 520809.4375; val_optim_loss: 520809.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7831; val_auprc_score: 0.7934; val_best_acc_score: 0.6989; val_best_f1_score: 0.7316; train_kl_reg_loss: 4519.4134; train_edge_recon_loss: 313331.9427; train_cond_contrastive_loss: 79582.7721; train_gene_expr_recon_loss: 113492.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510926.2760; train_optim_loss: 510926.2760; val_kl_reg_loss: 5084.2646; val_edge_recon_loss: 304981.4062; val_cond_contrastive_loss: 78376.8047; val_gene_expr_recon_loss: 112435.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500877.7500; val_optim_loss: 500877.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8294; val_auprc_score: 0.8178; val_best_acc_score: 0.7478; val_best_f1_score: 0.7825; train_kl_reg_loss: 5499.5085; train_edge_recon_loss: 296404.4479; train_cond_contrastive_loss: 78875.5065; train_gene_expr_recon_loss: 112710.5104; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493489.9688; train_optim_loss: 493489.9688; val_kl_reg_loss: 5956.6211; val_edge_recon_loss: 285870.3438; val_cond_contrastive_loss: 78388.5312; val_gene_expr_recon_loss: 111709.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481924.5312; val_optim_loss: 481924.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8462; val_auprc_score: 0.8251; val_best_acc_score: 0.7650; val_best_f1_score: 0.7943; train_kl_reg_loss: 6223.2549; train_edge_recon_loss: 283804.5625; train_cond_contrastive_loss: 78726.0013; train_gene_expr_recon_loss: 111915.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480668.8542; train_optim_loss: 480668.8542; val_kl_reg_loss: 6293.8301; val_edge_recon_loss: 285150.3125; val_cond_contrastive_loss: 78378.0859; val_gene_expr_recon_loss: 111012.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480835.0938; val_optim_loss: 480835.0938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8555; val_auprc_score: 0.8269; val_best_acc_score: 0.7858; val_best_f1_score: 0.8098; train_kl_reg_loss: 6234.4449; train_edge_recon_loss: 281187.1823; train_cond_contrastive_loss: 78841.0820; train_gene_expr_recon_loss: 111166.6211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477429.3333; train_optim_loss: 477429.3333; val_kl_reg_loss: 5938.1772; val_edge_recon_loss: 281002.8750; val_cond_contrastive_loss: 78375.1172; val_gene_expr_recon_loss: 110478.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475794.6875; val_optim_loss: 475794.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8730; val_auprc_score: 0.8402; val_best_acc_score: 0.8060; val_best_f1_score: 0.8258; train_kl_reg_loss: 6095.7202; train_edge_recon_loss: 279239.3646; train_cond_contrastive_loss: 79020.3945; train_gene_expr_recon_loss: 110570.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474925.8177; train_optim_loss: 474925.8177; val_kl_reg_loss: 6184.5542; val_edge_recon_loss: 276658.4062; val_cond_contrastive_loss: 78382.9062; val_gene_expr_recon_loss: 110041.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471267.5000; val_optim_loss: 471267.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8909; val_auprc_score: 0.8565; val_best_acc_score: 0.8329; val_best_f1_score: 0.8475; train_kl_reg_loss: 6318.3057; train_edge_recon_loss: 275509.8802; train_cond_contrastive_loss: 78959.1654; train_gene_expr_recon_loss: 110246.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471033.6406; train_optim_loss: 471033.6406; val_kl_reg_loss: 6177.8398; val_edge_recon_loss: 275296.0312; val_cond_contrastive_loss: 78394.8438; val_gene_expr_recon_loss: 109607.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469475.8750; val_optim_loss: 469475.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9130; val_auprc_score: 0.8903; val_best_acc_score: 0.8457; val_best_f1_score: 0.8615; train_kl_reg_loss: 6187.1800; train_edge_recon_loss: 273343.8021; train_cond_contrastive_loss: 78883.4466; train_gene_expr_recon_loss: 109604.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468019.2031; train_optim_loss: 468019.2031; val_kl_reg_loss: 5903.9326; val_edge_recon_loss: 270193.6562; val_cond_contrastive_loss: 78406.8516; val_gene_expr_recon_loss: 109185.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463690.3438; val_optim_loss: 463690.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9303; val_auprc_score: 0.9184; val_best_acc_score: 0.8566; val_best_f1_score: 0.8668; train_kl_reg_loss: 5923.0460; train_edge_recon_loss: 272952.7604; train_cond_contrastive_loss: 78816.7513; train_gene_expr_recon_loss: 109373.3216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467065.8854; train_optim_loss: 467065.8854; val_kl_reg_loss: 5830.5693; val_edge_recon_loss: 271772.2500; val_cond_contrastive_loss: 78412.8750; val_gene_expr_recon_loss: 108845.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464861.2188; val_optim_loss: 464861.2188
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9396; val_auprc_score: 0.9263; val_best_acc_score: 0.8707; val_best_f1_score: 0.8768; train_kl_reg_loss: 6007.3619; train_edge_recon_loss: 269668.1562; train_cond_contrastive_loss: 78719.2565; train_gene_expr_recon_loss: 109055.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463449.9896; train_optim_loss: 463449.9896; val_kl_reg_loss: 6053.8457; val_edge_recon_loss: 270336.2500; val_cond_contrastive_loss: 78414.1641; val_gene_expr_recon_loss: 108447.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463252.0625; val_optim_loss: 463252.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9520; val_auprc_score: 0.9420; val_best_acc_score: 0.8869; val_best_f1_score: 0.8917; train_kl_reg_loss: 6154.1161; train_edge_recon_loss: 269133.0417; train_cond_contrastive_loss: 78671.2161; train_gene_expr_recon_loss: 108600.2643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462558.6458; train_optim_loss: 462558.6458; val_kl_reg_loss: 6075.2256; val_edge_recon_loss: 269725.4375; val_cond_contrastive_loss: 78409.7734; val_gene_expr_recon_loss: 108129.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462340.4375; val_optim_loss: 462340.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9550; val_auprc_score: 0.9423; val_best_acc_score: 0.8959; val_best_f1_score: 0.8990; train_kl_reg_loss: 6226.5254; train_edge_recon_loss: 267652.2292; train_cond_contrastive_loss: 78669.2969; train_gene_expr_recon_loss: 108280.6081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460828.6510; train_optim_loss: 460828.6510; val_kl_reg_loss: 6177.5811; val_edge_recon_loss: 269479.9375; val_cond_contrastive_loss: 78408.2500; val_gene_expr_recon_loss: 107799.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461865.0312; val_optim_loss: 461865.0312
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9606; val_auprc_score: 0.9535; val_best_acc_score: 0.9048; val_best_f1_score: 0.9081; train_kl_reg_loss: 6143.6292; train_edge_recon_loss: 267851.3802; train_cond_contrastive_loss: 78713.3294; train_gene_expr_recon_loss: 108061.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460769.9844; train_optim_loss: 460769.9844; val_kl_reg_loss: 5978.2852; val_edge_recon_loss: 268344.3125; val_cond_contrastive_loss: 78410.5391; val_gene_expr_recon_loss: 107467.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460200.4375; val_optim_loss: 460200.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9663; val_auprc_score: 0.9587; val_best_acc_score: 0.9133; val_best_f1_score: 0.9158; train_kl_reg_loss: 6030.5348; train_edge_recon_loss: 266532.5469; train_cond_contrastive_loss: 78746.1458; train_gene_expr_recon_loss: 107592.3398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458901.5625; train_optim_loss: 458901.5625; val_kl_reg_loss: 5855.9678; val_edge_recon_loss: 266653.7812; val_cond_contrastive_loss: 78416.6641; val_gene_expr_recon_loss: 107139.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458065.6875; val_optim_loss: 458065.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9754; val_auprc_score: 0.9713; val_best_acc_score: 0.9255; val_best_f1_score: 0.9272; train_kl_reg_loss: 5925.7148; train_edge_recon_loss: 266107.1302; train_cond_contrastive_loss: 78779.6862; train_gene_expr_recon_loss: 107295.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458107.8854; train_optim_loss: 458107.8854; val_kl_reg_loss: 5818.9307; val_edge_recon_loss: 265285.3750; val_cond_contrastive_loss: 78421.1094; val_gene_expr_recon_loss: 106819.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456345.0938; val_optim_loss: 456345.0938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9803; val_auprc_score: 0.9766; val_best_acc_score: 0.9345; val_best_f1_score: 0.9361; train_kl_reg_loss: 5910.0507; train_edge_recon_loss: 264914.1927; train_cond_contrastive_loss: 78768.1510; train_gene_expr_recon_loss: 106919.3216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456511.7135; train_optim_loss: 456511.7135; val_kl_reg_loss: 5847.4946; val_edge_recon_loss: 263869.3125; val_cond_contrastive_loss: 78420.9141; val_gene_expr_recon_loss: 106527.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454664.9375; val_optim_loss: 454664.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9826; val_auprc_score: 0.9779; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 5887.3138; train_edge_recon_loss: 262888.2135; train_cond_contrastive_loss: 78752.9948; train_gene_expr_recon_loss: 106708.9388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454237.4531; train_optim_loss: 454237.4531; val_kl_reg_loss: 5757.5273; val_edge_recon_loss: 260464.1562; val_cond_contrastive_loss: 78418.0156; val_gene_expr_recon_loss: 106246.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450886.3750; val_optim_loss: 450886.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9829; val_auprc_score: 0.9798; val_best_acc_score: 0.9406; val_best_f1_score: 0.9427; train_kl_reg_loss: 5862.4065; train_edge_recon_loss: 262942.8021; train_cond_contrastive_loss: 78752.9492; train_gene_expr_recon_loss: 106538.8164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454096.9792; train_optim_loss: 454096.9792; val_kl_reg_loss: 5801.8921; val_edge_recon_loss: 261174.6562; val_cond_contrastive_loss: 78416.2578; val_gene_expr_recon_loss: 105985.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451378.2500; val_optim_loss: 451378.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9845; val_auprc_score: 0.9794; val_best_acc_score: 0.9486; val_best_f1_score: 0.9500; train_kl_reg_loss: 5899.0067; train_edge_recon_loss: 263129.8568; train_cond_contrastive_loss: 78736.2591; train_gene_expr_recon_loss: 106152.3190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453917.4375; train_optim_loss: 453917.4375; val_kl_reg_loss: 5854.8857; val_edge_recon_loss: 259746.0469; val_cond_contrastive_loss: 78413.7734; val_gene_expr_recon_loss: 105725.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449740.5625; val_optim_loss: 449740.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9860; val_auprc_score: 0.9832; val_best_acc_score: 0.9482; val_best_f1_score: 0.9498; train_kl_reg_loss: 5938.1103; train_edge_recon_loss: 261513.1745; train_cond_contrastive_loss: 78723.3698; train_gene_expr_recon_loss: 106018.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452192.8750; train_optim_loss: 452192.8750; val_kl_reg_loss: 5863.8428; val_edge_recon_loss: 257857.7031; val_cond_contrastive_loss: 78415.9375; val_gene_expr_recon_loss: 105510.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447648.3125; val_optim_loss: 447648.3125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9846; val_auprc_score: 0.9779; val_best_acc_score: 0.9478; val_best_f1_score: 0.9494; train_kl_reg_loss: 5982.3490; train_edge_recon_loss: 259927.4245; train_cond_contrastive_loss: 78718.2969; train_gene_expr_recon_loss: 105631.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450259.6302; train_optim_loss: 450259.6302; val_kl_reg_loss: 5951.5352; val_edge_recon_loss: 260658.5938; val_cond_contrastive_loss: 78414.2500; val_gene_expr_recon_loss: 105229.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450253.4062; val_optim_loss: 450253.4062
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9845; val_auprc_score: 0.9773; val_best_acc_score: 0.9472; val_best_f1_score: 0.9485; train_kl_reg_loss: 5982.3692; train_edge_recon_loss: 261330.6094; train_cond_contrastive_loss: 78727.5521; train_gene_expr_recon_loss: 105270.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451311.4427; train_optim_loss: 451311.4427; val_kl_reg_loss: 5894.5420; val_edge_recon_loss: 260614.4219; val_cond_contrastive_loss: 78412.1094; val_gene_expr_recon_loss: 104923.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449844.4688; val_optim_loss: 449844.4688
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9868; val_auprc_score: 0.9832; val_best_acc_score: 0.9511; val_best_f1_score: 0.9520; train_kl_reg_loss: 5968.5658; train_edge_recon_loss: 260462.5130; train_cond_contrastive_loss: 78730.9128; train_gene_expr_recon_loss: 105009.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450171.3177; train_optim_loss: 450171.3177; val_kl_reg_loss: 5884.9702; val_edge_recon_loss: 260576.0938; val_cond_contrastive_loss: 78409.9688; val_gene_expr_recon_loss: 104659.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449530.7188; val_optim_loss: 449530.7188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9851; val_auprc_score: 0.9768; val_best_acc_score: 0.9471; val_best_f1_score: 0.9483; train_kl_reg_loss: 5961.7138; train_edge_recon_loss: 260502.2630; train_cond_contrastive_loss: 78723.8893; train_gene_expr_recon_loss: 104804.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449992.4531; train_optim_loss: 449992.4531; val_kl_reg_loss: 5837.6816; val_edge_recon_loss: 260833.3594; val_cond_contrastive_loss: 78411.2578; val_gene_expr_recon_loss: 104627.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449710.1250; val_optim_loss: 449710.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9865; val_auprc_score: 0.9840; val_best_acc_score: 0.9479; val_best_f1_score: 0.9498; train_kl_reg_loss: 5916.7203; train_edge_recon_loss: 262103.0208; train_cond_contrastive_loss: 78737.0990; train_gene_expr_recon_loss: 104845.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451602.0938; train_optim_loss: 451602.0938; val_kl_reg_loss: 5812.6348; val_edge_recon_loss: 258403.5156; val_cond_contrastive_loss: 78411.6641; val_gene_expr_recon_loss: 104594.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447222.2188; val_optim_loss: 447222.2188
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9862; val_auprc_score: 0.9817; val_best_acc_score: 0.9485; val_best_f1_score: 0.9497; train_kl_reg_loss: 5899.7356; train_edge_recon_loss: 260625.0729; train_cond_contrastive_loss: 78734.2943; train_gene_expr_recon_loss: 104761.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450020.4375; train_optim_loss: 450020.4375; val_kl_reg_loss: 5800.4072; val_edge_recon_loss: 260762.7188; val_cond_contrastive_loss: 78411.0391; val_gene_expr_recon_loss: 104565.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449539.9375; val_optim_loss: 449539.9375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9875; val_auprc_score: 0.9842; val_best_acc_score: 0.9516; val_best_f1_score: 0.9528; train_kl_reg_loss: 5885.7393; train_edge_recon_loss: 260349.5521; train_cond_contrastive_loss: 78734.5026; train_gene_expr_recon_loss: 104660.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449629.9271; train_optim_loss: 449629.9271; val_kl_reg_loss: 5786.0688; val_edge_recon_loss: 259547.8906; val_cond_contrastive_loss: 78410.8438; val_gene_expr_recon_loss: 104546.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448291.4062; val_optim_loss: 448291.4062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9861; val_auprc_score: 0.9817; val_best_acc_score: 0.9504; val_best_f1_score: 0.9516; train_kl_reg_loss: 5887.8116; train_edge_recon_loss: 259816.0885; train_cond_contrastive_loss: 78740.5794; train_gene_expr_recon_loss: 104776.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449221.1146; train_optim_loss: 449221.1146; val_kl_reg_loss: 5801.2778; val_edge_recon_loss: 260196.1250; val_cond_contrastive_loss: 78411.1094; val_gene_expr_recon_loss: 104523.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448931.7500; val_optim_loss: 448931.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9850; val_auprc_score: 0.9810; val_best_acc_score: 0.9468; val_best_f1_score: 0.9483; train_kl_reg_loss: 5896.3136; train_edge_recon_loss: 259715.6979; train_cond_contrastive_loss: 78727.6680; train_gene_expr_recon_loss: 104692.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449032.3385; train_optim_loss: 449032.3385; val_kl_reg_loss: 5803.4229; val_edge_recon_loss: 260540.0625; val_cond_contrastive_loss: 78411.3984; val_gene_expr_recon_loss: 104520.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449275.4688; val_optim_loss: 449275.4688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9871; val_auprc_score: 0.9830; val_best_acc_score: 0.9489; val_best_f1_score: 0.9498; train_kl_reg_loss: 5899.6646; train_edge_recon_loss: 260203.0964; train_cond_contrastive_loss: 78726.6198; train_gene_expr_recon_loss: 104733.4466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449562.8177; train_optim_loss: 449562.8177; val_kl_reg_loss: 5803.0464; val_edge_recon_loss: 261772.3906; val_cond_contrastive_loss: 78410.2812; val_gene_expr_recon_loss: 104517.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450503.1875; val_optim_loss: 450503.1875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9878; val_auprc_score: 0.9831; val_best_acc_score: 0.9487; val_best_f1_score: 0.9500; train_kl_reg_loss: 5895.8794; train_edge_recon_loss: 260188.6354; train_cond_contrastive_loss: 78729.4388; train_gene_expr_recon_loss: 104666.8099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449480.7604; train_optim_loss: 449480.7604; val_kl_reg_loss: 5800.6104; val_edge_recon_loss: 258972.7031; val_cond_contrastive_loss: 78411.3203; val_gene_expr_recon_loss: 104514.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447699.0000; val_optim_loss: 447699.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 41 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9849
Val AUPRC score: 0.9781
Val best accuracy score: 0.9477
Val best F1 score: 0.9484
Val gene expr MSE score: 1.6344
Duration of model training in run 5: 0 hours, 2 minutes and 44 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7632; val_auprc_score: 0.7983; val_best_acc_score: 0.6881; val_best_f1_score: 0.7014; train_kl_reg_loss: 5338.8502; train_edge_recon_loss: 358238.0521; train_cond_contrastive_loss: 108562.4062; train_gene_expr_recon_loss: 136028.8568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 608168.1562; train_optim_loss: 608168.1562; val_kl_reg_loss: 11897.3975; val_edge_recon_loss: 403137.9375; val_cond_contrastive_loss: 78340.4141; val_gene_expr_recon_loss: 121229.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 614605.7500; val_optim_loss: 614605.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7186; val_auprc_score: 0.7434; val_best_acc_score: 0.6402; val_best_f1_score: 0.7013; train_kl_reg_loss: 8224.6305; train_edge_recon_loss: 356396.5469; train_cond_contrastive_loss: 85993.7201; train_gene_expr_recon_loss: 118440.1510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 569055.0521; train_optim_loss: 569055.0521; val_kl_reg_loss: 5644.5557; val_edge_recon_loss: 388697.5625; val_cond_contrastive_loss: 78374.3281; val_gene_expr_recon_loss: 117289.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 590005.5000; val_optim_loss: 590005.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7117; val_auprc_score: 0.7327; val_best_acc_score: 0.6438; val_best_f1_score: 0.6883; train_kl_reg_loss: 4652.6702; train_edge_recon_loss: 347639.6406; train_cond_contrastive_loss: 86735.3320; train_gene_expr_recon_loss: 115704.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554732.4271; train_optim_loss: 554732.4271; val_kl_reg_loss: 3277.1982; val_edge_recon_loss: 351771.1250; val_cond_contrastive_loss: 78428.1406; val_gene_expr_recon_loss: 116333.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 549810.2500; val_optim_loss: 549810.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7096; val_auprc_score: 0.7380; val_best_acc_score: 0.6502; val_best_f1_score: 0.6894; train_kl_reg_loss: 3445.6711; train_edge_recon_loss: 326675.1510; train_cond_contrastive_loss: 85026.7227; train_gene_expr_recon_loss: 114854.1081; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 530001.6406; train_optim_loss: 530001.6406; val_kl_reg_loss: 3979.0581; val_edge_recon_loss: 336261.7500; val_cond_contrastive_loss: 78370.1250; val_gene_expr_recon_loss: 115641.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534252.7500; val_optim_loss: 534252.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7387; val_auprc_score: 0.7589; val_best_acc_score: 0.6677; val_best_f1_score: 0.7031; train_kl_reg_loss: 4362.8604; train_edge_recon_loss: 319288.8906; train_cond_contrastive_loss: 79639.9466; train_gene_expr_recon_loss: 114116.6888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517408.3802; train_optim_loss: 517408.3802; val_kl_reg_loss: 4680.3228; val_edge_recon_loss: 323641.9375; val_cond_contrastive_loss: 78367.4766; val_gene_expr_recon_loss: 114847.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 521537.2188; val_optim_loss: 521537.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7999; val_auprc_score: 0.7915; val_best_acc_score: 0.7185; val_best_f1_score: 0.7490; train_kl_reg_loss: 4818.9377; train_edge_recon_loss: 306249.6458; train_cond_contrastive_loss: 79079.6250; train_gene_expr_recon_loss: 113655.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503803.9531; train_optim_loss: 503803.9531; val_kl_reg_loss: 5065.7207; val_edge_recon_loss: 301031.0938; val_cond_contrastive_loss: 78393.3828; val_gene_expr_recon_loss: 114180.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498670.9688; val_optim_loss: 498670.9688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8338; val_auprc_score: 0.8145; val_best_acc_score: 0.7532; val_best_f1_score: 0.7819; train_kl_reg_loss: 5431.5362; train_edge_recon_loss: 288644.6302; train_cond_contrastive_loss: 78902.8984; train_gene_expr_recon_loss: 112677.0404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485656.1094; train_optim_loss: 485656.1094; val_kl_reg_loss: 5909.0498; val_edge_recon_loss: 289926.5000; val_cond_contrastive_loss: 78396.0859; val_gene_expr_recon_loss: 113385.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487617.6250; val_optim_loss: 487617.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8585; val_auprc_score: 0.8366; val_best_acc_score: 0.7771; val_best_f1_score: 0.8004; train_kl_reg_loss: 6243.7222; train_edge_recon_loss: 283611.3698; train_cond_contrastive_loss: 78782.9023; train_gene_expr_recon_loss: 112029.4193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480667.4167; train_optim_loss: 480667.4167; val_kl_reg_loss: 6391.6279; val_edge_recon_loss: 285538.6250; val_cond_contrastive_loss: 78387.6719; val_gene_expr_recon_loss: 112734.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483052.0000; val_optim_loss: 483052.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8724; val_auprc_score: 0.8479; val_best_acc_score: 0.7977; val_best_f1_score: 0.8124; train_kl_reg_loss: 6443.8377; train_edge_recon_loss: 279411.5469; train_cond_contrastive_loss: 78843.7188; train_gene_expr_recon_loss: 111342.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476041.1354; train_optim_loss: 476041.1354; val_kl_reg_loss: 6256.1377; val_edge_recon_loss: 282726.8438; val_cond_contrastive_loss: 78382.3203; val_gene_expr_recon_loss: 112153.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479519.1250; val_optim_loss: 479519.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8910; val_auprc_score: 0.8664; val_best_acc_score: 0.8232; val_best_f1_score: 0.8388; train_kl_reg_loss: 6275.6682; train_edge_recon_loss: 275458.8750; train_cond_contrastive_loss: 78973.4583; train_gene_expr_recon_loss: 110839.3581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471547.3542; train_optim_loss: 471547.3542; val_kl_reg_loss: 6202.1831; val_edge_recon_loss: 276187.2812; val_cond_contrastive_loss: 78388.2891; val_gene_expr_recon_loss: 111655.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472433.5938; val_optim_loss: 472433.5938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9011; val_auprc_score: 0.8781; val_best_acc_score: 0.8348; val_best_f1_score: 0.8483; train_kl_reg_loss: 6321.0845; train_edge_recon_loss: 274590.3750; train_cond_contrastive_loss: 78912.9115; train_gene_expr_recon_loss: 110235.3971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470059.7760; train_optim_loss: 470059.7760; val_kl_reg_loss: 6133.8960; val_edge_recon_loss: 275778.2500; val_cond_contrastive_loss: 78393.1719; val_gene_expr_recon_loss: 111224.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471529.5312; val_optim_loss: 471529.5312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9218; val_auprc_score: 0.9097; val_best_acc_score: 0.8459; val_best_f1_score: 0.8573; train_kl_reg_loss: 6149.5783; train_edge_recon_loss: 271682.0990; train_cond_contrastive_loss: 78931.8372; train_gene_expr_recon_loss: 109919.2135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466682.7188; train_optim_loss: 466682.7188; val_kl_reg_loss: 6059.1758; val_edge_recon_loss: 272348.5625; val_cond_contrastive_loss: 78398.7578; val_gene_expr_recon_loss: 110838.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467644.6250; val_optim_loss: 467644.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9331; val_auprc_score: 0.9158; val_best_acc_score: 0.8616; val_best_f1_score: 0.8691; train_kl_reg_loss: 6063.9984; train_edge_recon_loss: 270410.6823; train_cond_contrastive_loss: 78795.8385; train_gene_expr_recon_loss: 109552.4857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464823.0104; train_optim_loss: 464823.0104; val_kl_reg_loss: 5949.6060; val_edge_recon_loss: 269059.6250; val_cond_contrastive_loss: 78399.7812; val_gene_expr_recon_loss: 110433.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463842.9375; val_optim_loss: 463842.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9438; val_auprc_score: 0.9342; val_best_acc_score: 0.8722; val_best_f1_score: 0.8749; train_kl_reg_loss: 6017.1200; train_edge_recon_loss: 272288.0000; train_cond_contrastive_loss: 78749.9440; train_gene_expr_recon_loss: 109192.0651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466247.1250; train_optim_loss: 466247.1250; val_kl_reg_loss: 6029.6123; val_edge_recon_loss: 272719.0938; val_cond_contrastive_loss: 78395.8984; val_gene_expr_recon_loss: 110061.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467206.5000; val_optim_loss: 467206.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9500; val_auprc_score: 0.9396; val_best_acc_score: 0.8822; val_best_f1_score: 0.8869; train_kl_reg_loss: 6188.2725; train_edge_recon_loss: 269822.6042; train_cond_contrastive_loss: 78679.2669; train_gene_expr_recon_loss: 108928.6289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463618.7760; train_optim_loss: 463618.7760; val_kl_reg_loss: 6127.7295; val_edge_recon_loss: 268446.8125; val_cond_contrastive_loss: 78395.1719; val_gene_expr_recon_loss: 109739.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462708.8750; val_optim_loss: 462708.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9559; val_auprc_score: 0.9450; val_best_acc_score: 0.8940; val_best_f1_score: 0.8968; train_kl_reg_loss: 6156.5837; train_edge_recon_loss: 268389.6354; train_cond_contrastive_loss: 78687.9974; train_gene_expr_recon_loss: 108579.0339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461813.2500; train_optim_loss: 461813.2500; val_kl_reg_loss: 6029.4272; val_edge_recon_loss: 268776.3125; val_cond_contrastive_loss: 78395.0938; val_gene_expr_recon_loss: 109400.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462600.9062; val_optim_loss: 462600.9062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9603; val_auprc_score: 0.9506; val_best_acc_score: 0.9023; val_best_f1_score: 0.9046; train_kl_reg_loss: 6028.5931; train_edge_recon_loss: 266861.7031; train_cond_contrastive_loss: 78727.7552; train_gene_expr_recon_loss: 108118.3411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459736.3906; train_optim_loss: 459736.3906; val_kl_reg_loss: 5989.0684; val_edge_recon_loss: 268842.4375; val_cond_contrastive_loss: 78395.1250; val_gene_expr_recon_loss: 109065.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462292.5000; val_optim_loss: 462292.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9702; val_auprc_score: 0.9647; val_best_acc_score: 0.9159; val_best_f1_score: 0.9186; train_kl_reg_loss: 6026.1641; train_edge_recon_loss: 266956.7500; train_cond_contrastive_loss: 78723.9688; train_gene_expr_recon_loss: 108035.8320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459742.7240; train_optim_loss: 459742.7240; val_kl_reg_loss: 5880.7764; val_edge_recon_loss: 265910.5312; val_cond_contrastive_loss: 78399.9141; val_gene_expr_recon_loss: 108741.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458932.5625; val_optim_loss: 458932.5625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9754; val_auprc_score: 0.9714; val_best_acc_score: 0.9216; val_best_f1_score: 0.9232; train_kl_reg_loss: 5918.6761; train_edge_recon_loss: 265532.9531; train_cond_contrastive_loss: 78748.7070; train_gene_expr_recon_loss: 107439.6706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457640.0052; train_optim_loss: 457640.0052; val_kl_reg_loss: 5856.2861; val_edge_recon_loss: 266264.3750; val_cond_contrastive_loss: 78402.3125; val_gene_expr_recon_loss: 108428.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458951.0625; val_optim_loss: 458951.0625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9752; val_auprc_score: 0.9712; val_best_acc_score: 0.9242; val_best_f1_score: 0.9251; train_kl_reg_loss: 5924.7605; train_edge_recon_loss: 262493.3724; train_cond_contrastive_loss: 78741.2956; train_gene_expr_recon_loss: 107161.4987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454320.9427; train_optim_loss: 454320.9427; val_kl_reg_loss: 5876.0073; val_edge_recon_loss: 265748.4688; val_cond_contrastive_loss: 78401.5703; val_gene_expr_recon_loss: 108145.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458171.0625; val_optim_loss: 458171.0625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9787; val_auprc_score: 0.9721; val_best_acc_score: 0.9291; val_best_f1_score: 0.9301; train_kl_reg_loss: 5913.6845; train_edge_recon_loss: 263343.7005; train_cond_contrastive_loss: 78747.6576; train_gene_expr_recon_loss: 106932.9323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454937.9792; train_optim_loss: 454937.9792; val_kl_reg_loss: 5789.8867; val_edge_recon_loss: 264858.0625; val_cond_contrastive_loss: 78398.9453; val_gene_expr_recon_loss: 107865.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456912.6875; val_optim_loss: 456912.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9802; val_auprc_score: 0.9763; val_best_acc_score: 0.9343; val_best_f1_score: 0.9358; train_kl_reg_loss: 5889.0495; train_edge_recon_loss: 263956.9401; train_cond_contrastive_loss: 78758.3242; train_gene_expr_recon_loss: 106812.4622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455416.7760; train_optim_loss: 455416.7760; val_kl_reg_loss: 5885.2002; val_edge_recon_loss: 261519.9375; val_cond_contrastive_loss: 78399.6016; val_gene_expr_recon_loss: 107568.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453372.8438; val_optim_loss: 453372.8438
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9796; val_auprc_score: 0.9730; val_best_acc_score: 0.9376; val_best_f1_score: 0.9383; train_kl_reg_loss: 5947.8095; train_edge_recon_loss: 261723.3385; train_cond_contrastive_loss: 78751.4492; train_gene_expr_recon_loss: 106509.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452931.8906; train_optim_loss: 452931.8906; val_kl_reg_loss: 5890.8867; val_edge_recon_loss: 266094.5312; val_cond_contrastive_loss: 78399.5234; val_gene_expr_recon_loss: 107282.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457667.2188; val_optim_loss: 457667.2188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9811; val_auprc_score: 0.9770; val_best_acc_score: 0.9395; val_best_f1_score: 0.9407; train_kl_reg_loss: 5924.8967; train_edge_recon_loss: 264482.4219; train_cond_contrastive_loss: 78761.3659; train_gene_expr_recon_loss: 106319.6615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455488.3490; train_optim_loss: 455488.3490; val_kl_reg_loss: 5829.8906; val_edge_recon_loss: 262646.1875; val_cond_contrastive_loss: 78400.2031; val_gene_expr_recon_loss: 106984.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453860.5000; val_optim_loss: 453860.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9833; val_auprc_score: 0.9769; val_best_acc_score: 0.9400; val_best_f1_score: 0.9412; train_kl_reg_loss: 5911.8212; train_edge_recon_loss: 260752.7943; train_cond_contrastive_loss: 78776.3867; train_gene_expr_recon_loss: 105953.2357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451394.2292; train_optim_loss: 451394.2292; val_kl_reg_loss: 5889.2764; val_edge_recon_loss: 261395.4844; val_cond_contrastive_loss: 78400.7344; val_gene_expr_recon_loss: 106689.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452374.7500; val_optim_loss: 452374.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9858; val_auprc_score: 0.9824; val_best_acc_score: 0.9449; val_best_f1_score: 0.9460; train_kl_reg_loss: 5966.1897; train_edge_recon_loss: 262386.7109; train_cond_contrastive_loss: 78762.7474; train_gene_expr_recon_loss: 105569.7305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452685.3854; train_optim_loss: 452685.3854; val_kl_reg_loss: 5857.3789; val_edge_recon_loss: 262837.0000; val_cond_contrastive_loss: 78399.7188; val_gene_expr_recon_loss: 106374.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453468.2500; val_optim_loss: 453468.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9836; val_auprc_score: 0.9774; val_best_acc_score: 0.9440; val_best_f1_score: 0.9447; train_kl_reg_loss: 5904.1630; train_edge_recon_loss: 260048.0130; train_cond_contrastive_loss: 78781.4427; train_gene_expr_recon_loss: 105322.7174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450056.3385; train_optim_loss: 450056.3385; val_kl_reg_loss: 5809.1709; val_edge_recon_loss: 262972.4375; val_cond_contrastive_loss: 78400.6250; val_gene_expr_recon_loss: 106083.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453265.8750; val_optim_loss: 453265.8750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9853; val_auprc_score: 0.9819; val_best_acc_score: 0.9451; val_best_f1_score: 0.9461; train_kl_reg_loss: 5884.2563; train_edge_recon_loss: 262376.6536; train_cond_contrastive_loss: 78777.4818; train_gene_expr_recon_loss: 104869.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451908.0521; train_optim_loss: 451908.0521; val_kl_reg_loss: 5777.6582; val_edge_recon_loss: 261578.8906; val_cond_contrastive_loss: 78401.5625; val_gene_expr_recon_loss: 105819.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451577.9062; val_optim_loss: 451577.9062
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9858; val_auprc_score: 0.9795; val_best_acc_score: 0.9493; val_best_f1_score: 0.9497; train_kl_reg_loss: 5889.0959; train_edge_recon_loss: 259991.8438; train_cond_contrastive_loss: 78758.8932; train_gene_expr_recon_loss: 104822.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449461.9583; train_optim_loss: 449461.9583; val_kl_reg_loss: 5829.0410; val_edge_recon_loss: 263213.8438; val_cond_contrastive_loss: 78404.3125; val_gene_expr_recon_loss: 105532.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452979.6562; val_optim_loss: 452979.6562
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9859; val_auprc_score: 0.9802; val_best_acc_score: 0.9492; val_best_f1_score: 0.9500; train_kl_reg_loss: 5853.9310; train_edge_recon_loss: 259219.1745; train_cond_contrastive_loss: 78740.6745; train_gene_expr_recon_loss: 104586.8620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448400.6406; train_optim_loss: 448400.6406; val_kl_reg_loss: 5749.1465; val_edge_recon_loss: 263176.4688; val_cond_contrastive_loss: 78405.7656; val_gene_expr_recon_loss: 105258.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452589.9062; val_optim_loss: 452589.9062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9880; val_auprc_score: 0.9848; val_best_acc_score: 0.9504; val_best_f1_score: 0.9511; train_kl_reg_loss: 5832.9810; train_edge_recon_loss: 259955.7318; train_cond_contrastive_loss: 78725.6224; train_gene_expr_recon_loss: 104377.5169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448891.8542; train_optim_loss: 448891.8542; val_kl_reg_loss: 5764.7109; val_edge_recon_loss: 261038.6875; val_cond_contrastive_loss: 78408.1953; val_gene_expr_recon_loss: 104999.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450210.5938; val_optim_loss: 450210.5938
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9870; val_auprc_score: 0.9813; val_best_acc_score: 0.9519; val_best_f1_score: 0.9522; train_kl_reg_loss: 5818.8704; train_edge_recon_loss: 260453.6536; train_cond_contrastive_loss: 78712.2943; train_gene_expr_recon_loss: 104009.0495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448993.8698; train_optim_loss: 448993.8698; val_kl_reg_loss: 5774.4912; val_edge_recon_loss: 262508.1562; val_cond_contrastive_loss: 78407.9688; val_gene_expr_recon_loss: 104740.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451430.8438; val_optim_loss: 451430.8438
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9859; val_auprc_score: 0.9806; val_best_acc_score: 0.9526; val_best_f1_score: 0.9531; train_kl_reg_loss: 5811.7052; train_edge_recon_loss: 259295.0417; train_cond_contrastive_loss: 78697.5612; train_gene_expr_recon_loss: 103643.5664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447447.8802; train_optim_loss: 447447.8802; val_kl_reg_loss: 5752.8218; val_edge_recon_loss: 260317.4688; val_cond_contrastive_loss: 78408.5000; val_gene_expr_recon_loss: 104465.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448944.7500; val_optim_loss: 448944.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9893; val_auprc_score: 0.9868; val_best_acc_score: 0.9562; val_best_f1_score: 0.9566; train_kl_reg_loss: 5770.7330; train_edge_recon_loss: 259677.2240; train_cond_contrastive_loss: 78684.6927; train_gene_expr_recon_loss: 103528.4284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447661.0781; train_optim_loss: 447661.0781; val_kl_reg_loss: 5677.8262; val_edge_recon_loss: 260323.1406; val_cond_contrastive_loss: 78409.8125; val_gene_expr_recon_loss: 104250.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448661.4688; val_optim_loss: 448661.4688
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9885; val_auprc_score: 0.9841; val_best_acc_score: 0.9557; val_best_f1_score: 0.9568; train_kl_reg_loss: 5788.8503; train_edge_recon_loss: 260390.9792; train_cond_contrastive_loss: 78677.6719; train_gene_expr_recon_loss: 103118.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447975.7760; train_optim_loss: 447975.7760; val_kl_reg_loss: 5662.0029; val_edge_recon_loss: 256890.2344; val_cond_contrastive_loss: 78412.8906; val_gene_expr_recon_loss: 104013.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444978.3125; val_optim_loss: 444978.3125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9895; val_auprc_score: 0.9843; val_best_acc_score: 0.9561; val_best_f1_score: 0.9567; train_kl_reg_loss: 5710.0509; train_edge_recon_loss: 260444.6042; train_cond_contrastive_loss: 78675.4245; train_gene_expr_recon_loss: 102976.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447806.9844; train_optim_loss: 447806.9844; val_kl_reg_loss: 5692.4038; val_edge_recon_loss: 260989.3906; val_cond_contrastive_loss: 78416.6875; val_gene_expr_recon_loss: 103825.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448924.4062; val_optim_loss: 448924.4062
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9888; val_auprc_score: 0.9837; val_best_acc_score: 0.9563; val_best_f1_score: 0.9569; train_kl_reg_loss: 5772.2611; train_edge_recon_loss: 259272.4792; train_cond_contrastive_loss: 78661.9805; train_gene_expr_recon_loss: 102941.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446648.0052; train_optim_loss: 446648.0052; val_kl_reg_loss: 5685.0039; val_edge_recon_loss: 260692.7500; val_cond_contrastive_loss: 78422.7109; val_gene_expr_recon_loss: 103657.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448457.6562; val_optim_loss: 448457.6562
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9908; val_auprc_score: 0.9869; val_best_acc_score: 0.9622; val_best_f1_score: 0.9621; train_kl_reg_loss: 5740.0342; train_edge_recon_loss: 259056.2266; train_cond_contrastive_loss: 78662.6354; train_gene_expr_recon_loss: 102587.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446046.3698; train_optim_loss: 446046.3698; val_kl_reg_loss: 5651.8359; val_edge_recon_loss: 259975.0781; val_cond_contrastive_loss: 78421.7266; val_gene_expr_recon_loss: 103434.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447482.9062; val_optim_loss: 447482.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9899; val_auprc_score: 0.9863; val_best_acc_score: 0.9600; val_best_f1_score: 0.9600; train_kl_reg_loss: 5720.3328; train_edge_recon_loss: 259770.2630; train_cond_contrastive_loss: 78663.9453; train_gene_expr_recon_loss: 102615.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446770.4531; train_optim_loss: 446770.4531; val_kl_reg_loss: 5658.8730; val_edge_recon_loss: 262313.6562; val_cond_contrastive_loss: 78421.2422; val_gene_expr_recon_loss: 103410.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449803.8125; val_optim_loss: 449803.8125
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9893; val_auprc_score: 0.9865; val_best_acc_score: 0.9578; val_best_f1_score: 0.9583; train_kl_reg_loss: 5728.5210; train_edge_recon_loss: 258821.2161; train_cond_contrastive_loss: 78662.7734; train_gene_expr_recon_loss: 102601.2721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445813.7760; train_optim_loss: 445813.7760; val_kl_reg_loss: 5656.9814; val_edge_recon_loss: 260809.5781; val_cond_contrastive_loss: 78422.1562; val_gene_expr_recon_loss: 103385.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448274.4688; val_optim_loss: 448274.4688
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9907; val_auprc_score: 0.9866; val_best_acc_score: 0.9606; val_best_f1_score: 0.9608; train_kl_reg_loss: 5725.9147; train_edge_recon_loss: 258620.3542; train_cond_contrastive_loss: 78659.0182; train_gene_expr_recon_loss: 102532.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445538.0885; train_optim_loss: 445538.0885; val_kl_reg_loss: 5667.2598; val_edge_recon_loss: 261051.5625; val_cond_contrastive_loss: 78421.6719; val_gene_expr_recon_loss: 103357.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448498.2812; val_optim_loss: 448498.2812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 18 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9894
Val AUPRC score: 0.9859
Val best accuracy score: 0.9562
Val best F1 score: 0.9569
Val gene expr MSE score: 1.5828
Duration of model training in run 6: 0 hours, 3 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8040; val_auprc_score: 0.8354; val_best_acc_score: 0.7268; val_best_f1_score: 0.7140; train_kl_reg_loss: 5912.6095; train_edge_recon_loss: 358426.5045; train_cond_contrastive_loss: 104988.6685; train_gene_expr_recon_loss: 132430.3516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 601758.1250; train_optim_loss: 601758.1250; val_kl_reg_loss: 12945.9121; val_edge_recon_loss: 400677.2500; val_cond_contrastive_loss: 78333.8359; val_gene_expr_recon_loss: 118002.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 609959.9375; val_optim_loss: 609959.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7521; val_auprc_score: 0.7813; val_best_acc_score: 0.6615; val_best_f1_score: 0.7135; train_kl_reg_loss: 7809.6742; train_edge_recon_loss: 355251.4330; train_cond_contrastive_loss: 88966.6685; train_gene_expr_recon_loss: 117727.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 569755.3929; train_optim_loss: 569755.3929; val_kl_reg_loss: 5828.9385; val_edge_recon_loss: 379269.4062; val_cond_contrastive_loss: 78378.3125; val_gene_expr_recon_loss: 116104.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 579581.3125; val_optim_loss: 579581.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7482; val_auprc_score: 0.7718; val_best_acc_score: 0.6719; val_best_f1_score: 0.7083; train_kl_reg_loss: 4412.0078; train_edge_recon_loss: 342466.9554; train_cond_contrastive_loss: 87795.0446; train_gene_expr_recon_loss: 115739.4007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550413.4107; train_optim_loss: 550413.4107; val_kl_reg_loss: 3330.4878; val_edge_recon_loss: 333243.7812; val_cond_contrastive_loss: 78393.7031; val_gene_expr_recon_loss: 115012.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 529980.8750; val_optim_loss: 529980.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7803; val_auprc_score: 0.7921; val_best_acc_score: 0.6961; val_best_f1_score: 0.7232; train_kl_reg_loss: 4129.1360; train_edge_recon_loss: 316048.9375; train_cond_contrastive_loss: 81791.7243; train_gene_expr_recon_loss: 115230.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517200.2768; train_optim_loss: 517200.2768; val_kl_reg_loss: 5168.6279; val_edge_recon_loss: 310696.9375; val_cond_contrastive_loss: 78366.9609; val_gene_expr_recon_loss: 114054.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 508286.5625; val_optim_loss: 508286.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8337; val_auprc_score: 0.8267; val_best_acc_score: 0.7460; val_best_f1_score: 0.7806; train_kl_reg_loss: 5954.9491; train_edge_recon_loss: 297142.9866; train_cond_contrastive_loss: 78782.6551; train_gene_expr_recon_loss: 114175.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496055.9330; train_optim_loss: 496055.9330; val_kl_reg_loss: 6578.7324; val_edge_recon_loss: 289010.4062; val_cond_contrastive_loss: 78380.2344; val_gene_expr_recon_loss: 113152.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487121.4062; val_optim_loss: 487121.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8538; val_auprc_score: 0.8355; val_best_acc_score: 0.7698; val_best_f1_score: 0.7958; train_kl_reg_loss: 6723.0253; train_edge_recon_loss: 283851.8616; train_cond_contrastive_loss: 78667.6920; train_gene_expr_recon_loss: 113007.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482250.5134; train_optim_loss: 482250.5134; val_kl_reg_loss: 6461.2979; val_edge_recon_loss: 285997.2188; val_cond_contrastive_loss: 78374.7188; val_gene_expr_recon_loss: 112292.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 483125.4688; val_optim_loss: 483125.4688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8748; val_auprc_score: 0.8541; val_best_acc_score: 0.7955; val_best_f1_score: 0.8154; train_kl_reg_loss: 6222.1737; train_edge_recon_loss: 279965.3616; train_cond_contrastive_loss: 78918.6429; train_gene_expr_recon_loss: 112276.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477382.2455; train_optim_loss: 477382.2455; val_kl_reg_loss: 5853.7520; val_edge_recon_loss: 280287.8438; val_cond_contrastive_loss: 78372.9297; val_gene_expr_recon_loss: 111676.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476191.1875; val_optim_loss: 476191.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8920; val_auprc_score: 0.8672; val_best_acc_score: 0.8248; val_best_f1_score: 0.8389; train_kl_reg_loss: 6026.6143; train_edge_recon_loss: 276697.6652; train_cond_contrastive_loss: 79102.7846; train_gene_expr_recon_loss: 111662.1373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473489.2143; train_optim_loss: 473489.2143; val_kl_reg_loss: 6264.9121; val_edge_recon_loss: 275466.5000; val_cond_contrastive_loss: 78379.5234; val_gene_expr_recon_loss: 111070.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471181.2812; val_optim_loss: 471181.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9141; val_auprc_score: 0.8957; val_best_acc_score: 0.8435; val_best_f1_score: 0.8563; train_kl_reg_loss: 6440.8586; train_edge_recon_loss: 273535.7143; train_cond_contrastive_loss: 78944.4397; train_gene_expr_recon_loss: 110938.5223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469859.5268; train_optim_loss: 469859.5268; val_kl_reg_loss: 6290.2944; val_edge_recon_loss: 272384.2812; val_cond_contrastive_loss: 78397.4844; val_gene_expr_recon_loss: 110521.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467594.0000; val_optim_loss: 467594.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9314; val_auprc_score: 0.9181; val_best_acc_score: 0.8626; val_best_f1_score: 0.8725; train_kl_reg_loss: 6106.2234; train_edge_recon_loss: 270911.1384; train_cond_contrastive_loss: 78946.1975; train_gene_expr_recon_loss: 110703.8638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466667.4196; train_optim_loss: 466667.4196; val_kl_reg_loss: 5812.0781; val_edge_recon_loss: 271901.4062; val_cond_contrastive_loss: 78410.0938; val_gene_expr_recon_loss: 110027.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466151.0625; val_optim_loss: 466151.0625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9486; val_auprc_score: 0.9345; val_best_acc_score: 0.8877; val_best_f1_score: 0.8921; train_kl_reg_loss: 5959.5304; train_edge_recon_loss: 269689.4688; train_cond_contrastive_loss: 78852.1674; train_gene_expr_recon_loss: 110488.2623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464989.4330; train_optim_loss: 464989.4330; val_kl_reg_loss: 6123.0303; val_edge_recon_loss: 268604.2812; val_cond_contrastive_loss: 78410.8750; val_gene_expr_recon_loss: 109589.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462728.1250; val_optim_loss: 462728.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9593; val_auprc_score: 0.9501; val_best_acc_score: 0.9016; val_best_f1_score: 0.9053; train_kl_reg_loss: 6285.1399; train_edge_recon_loss: 268492.3527; train_cond_contrastive_loss: 78704.3438; train_gene_expr_recon_loss: 109690.0480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463171.8839; train_optim_loss: 463171.8839; val_kl_reg_loss: 6221.5151; val_edge_recon_loss: 268064.2812; val_cond_contrastive_loss: 78407.6953; val_gene_expr_recon_loss: 109155.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461849.0312; val_optim_loss: 461849.0312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9651; val_auprc_score: 0.9574; val_best_acc_score: 0.9126; val_best_f1_score: 0.9174; train_kl_reg_loss: 6241.8315; train_edge_recon_loss: 266191.0000; train_cond_contrastive_loss: 78723.5134; train_gene_expr_recon_loss: 109343.4096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460499.7545; train_optim_loss: 460499.7545; val_kl_reg_loss: 6083.8633; val_edge_recon_loss: 264412.5625; val_cond_contrastive_loss: 78407.3828; val_gene_expr_recon_loss: 108763.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457667.1875; val_optim_loss: 457667.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9710; val_auprc_score: 0.9614; val_best_acc_score: 0.9233; val_best_f1_score: 0.9262; train_kl_reg_loss: 6122.7618; train_edge_recon_loss: 265718.5446; train_cond_contrastive_loss: 78768.4241; train_gene_expr_recon_loss: 108724.7154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459334.4509; train_optim_loss: 459334.4509; val_kl_reg_loss: 6053.1182; val_edge_recon_loss: 263438.4688; val_cond_contrastive_loss: 78409.7500; val_gene_expr_recon_loss: 108344.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456246.3125; val_optim_loss: 456246.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9764; val_auprc_score: 0.9686; val_best_acc_score: 0.9286; val_best_f1_score: 0.9312; train_kl_reg_loss: 6061.1711; train_edge_recon_loss: 265012.0580; train_cond_contrastive_loss: 78799.0871; train_gene_expr_recon_loss: 108599.8404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458472.1384; train_optim_loss: 458472.1384; val_kl_reg_loss: 5915.5767; val_edge_recon_loss: 264548.0312; val_cond_contrastive_loss: 78410.5938; val_gene_expr_recon_loss: 107970.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456844.2500; val_optim_loss: 456844.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9798; val_auprc_score: 0.9721; val_best_acc_score: 0.9355; val_best_f1_score: 0.9370; train_kl_reg_loss: 6012.7044; train_edge_recon_loss: 263890.0938; train_cond_contrastive_loss: 78819.3438; train_gene_expr_recon_loss: 108217.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456939.2009; train_optim_loss: 456939.2009; val_kl_reg_loss: 6001.5723; val_edge_recon_loss: 263497.7500; val_cond_contrastive_loss: 78410.5625; val_gene_expr_recon_loss: 107589.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455499.6562; val_optim_loss: 455499.6562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9825; val_auprc_score: 0.9740; val_best_acc_score: 0.9424; val_best_f1_score: 0.9431; train_kl_reg_loss: 6026.8395; train_edge_recon_loss: 262046.7656; train_cond_contrastive_loss: 78799.3482; train_gene_expr_recon_loss: 107662.0792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454535.0268; train_optim_loss: 454535.0268; val_kl_reg_loss: 5942.9331; val_edge_recon_loss: 264608.2500; val_cond_contrastive_loss: 78408.7578; val_gene_expr_recon_loss: 107213.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456173.4375; val_optim_loss: 456173.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9864; val_auprc_score: 0.9812; val_best_acc_score: 0.9500; val_best_f1_score: 0.9508; train_kl_reg_loss: 5994.3140; train_edge_recon_loss: 261642.9688; train_cond_contrastive_loss: 78779.8929; train_gene_expr_recon_loss: 107117.1897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453534.3705; train_optim_loss: 453534.3705; val_kl_reg_loss: 5913.2070; val_edge_recon_loss: 261832.9531; val_cond_contrastive_loss: 78407.5078; val_gene_expr_recon_loss: 106868.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453022.0625; val_optim_loss: 453022.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9869; val_auprc_score: 0.9835; val_best_acc_score: 0.9500; val_best_f1_score: 0.9513; train_kl_reg_loss: 5954.9473; train_edge_recon_loss: 261023.6429; train_cond_contrastive_loss: 78761.7467; train_gene_expr_recon_loss: 107068.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452808.6250; train_optim_loss: 452808.6250; val_kl_reg_loss: 5879.3354; val_edge_recon_loss: 259711.7500; val_cond_contrastive_loss: 78404.0156; val_gene_expr_recon_loss: 106539.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450534.6250; val_optim_loss: 450534.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9873; val_auprc_score: 0.9845; val_best_acc_score: 0.9546; val_best_f1_score: 0.9556; train_kl_reg_loss: 5924.5953; train_edge_recon_loss: 260118.3147; train_cond_contrastive_loss: 78734.8504; train_gene_expr_recon_loss: 106685.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451463.0625; train_optim_loss: 451463.0625; val_kl_reg_loss: 5865.7852; val_edge_recon_loss: 259529.5625; val_cond_contrastive_loss: 78400.5781; val_gene_expr_recon_loss: 106198.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449994.6562; val_optim_loss: 449994.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9877; val_auprc_score: 0.9827; val_best_acc_score: 0.9536; val_best_f1_score: 0.9547; train_kl_reg_loss: 5891.9161; train_edge_recon_loss: 260483.9107; train_cond_contrastive_loss: 78717.3304; train_gene_expr_recon_loss: 106230.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451323.3348; train_optim_loss: 451323.3348; val_kl_reg_loss: 5803.9146; val_edge_recon_loss: 258876.3594; val_cond_contrastive_loss: 78398.0469; val_gene_expr_recon_loss: 105875.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448954.1875; val_optim_loss: 448954.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9894; val_auprc_score: 0.9865; val_best_acc_score: 0.9559; val_best_f1_score: 0.9568; train_kl_reg_loss: 5846.9043; train_edge_recon_loss: 259542.3973; train_cond_contrastive_loss: 78705.8549; train_gene_expr_recon_loss: 106062.0179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450157.1696; train_optim_loss: 450157.1696; val_kl_reg_loss: 5807.4961; val_edge_recon_loss: 257575.5156; val_cond_contrastive_loss: 78395.4531; val_gene_expr_recon_loss: 105522.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447301.0000; val_optim_loss: 447301.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9896; val_auprc_score: 0.9863; val_best_acc_score: 0.9575; val_best_f1_score: 0.9582; train_kl_reg_loss: 5829.3421; train_edge_recon_loss: 259027.5357; train_cond_contrastive_loss: 78689.6451; train_gene_expr_recon_loss: 105718.0993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449264.6295; train_optim_loss: 449264.6295; val_kl_reg_loss: 5767.3647; val_edge_recon_loss: 260444.1094; val_cond_contrastive_loss: 78393.7344; val_gene_expr_recon_loss: 105188.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449793.5312; val_optim_loss: 449793.5312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9879; val_auprc_score: 0.9832; val_best_acc_score: 0.9527; val_best_f1_score: 0.9537; train_kl_reg_loss: 5833.4620; train_edge_recon_loss: 259270.9263; train_cond_contrastive_loss: 78679.9788; train_gene_expr_recon_loss: 105304.8661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449089.2188; train_optim_loss: 449089.2188; val_kl_reg_loss: 5774.6768; val_edge_recon_loss: 260890.0938; val_cond_contrastive_loss: 78395.0078; val_gene_expr_recon_loss: 104856.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449916.5625; val_optim_loss: 449916.5625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9901; val_auprc_score: 0.9863; val_best_acc_score: 0.9564; val_best_f1_score: 0.9578; train_kl_reg_loss: 5783.4386; train_edge_recon_loss: 259669.3750; train_cond_contrastive_loss: 78672.9888; train_gene_expr_recon_loss: 105123.9955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449249.8080; train_optim_loss: 449249.8080; val_kl_reg_loss: 5721.5615; val_edge_recon_loss: 256654.2031; val_cond_contrastive_loss: 78397.1641; val_gene_expr_recon_loss: 104552.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445325.5312; val_optim_loss: 445325.5312
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9901; val_auprc_score: 0.9881; val_best_acc_score: 0.9577; val_best_f1_score: 0.9590; train_kl_reg_loss: 5759.2926; train_edge_recon_loss: 259333.0893; train_cond_contrastive_loss: 78659.3092; train_gene_expr_recon_loss: 104930.1741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448681.8661; train_optim_loss: 448681.8661; val_kl_reg_loss: 5710.0986; val_edge_recon_loss: 257119.5625; val_cond_contrastive_loss: 78400.3125; val_gene_expr_recon_loss: 104268.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445498.7812; val_optim_loss: 445498.7812
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9894; val_auprc_score: 0.9862; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 5748.3076; train_edge_recon_loss: 259288.7388; train_cond_contrastive_loss: 78653.3103; train_gene_expr_recon_loss: 104679.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448369.6830; train_optim_loss: 448369.6830; val_kl_reg_loss: 5675.7930; val_edge_recon_loss: 258890.8125; val_cond_contrastive_loss: 78403.1875; val_gene_expr_recon_loss: 103991.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446961.7812; val_optim_loss: 446961.7812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9884; val_best_acc_score: 0.9621; val_best_f1_score: 0.9627; train_kl_reg_loss: 5705.4445; train_edge_recon_loss: 259189.8080; train_cond_contrastive_loss: 78668.5246; train_gene_expr_recon_loss: 104217.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447780.8839; train_optim_loss: 447780.8839; val_kl_reg_loss: 5681.2866; val_edge_recon_loss: 257116.5625; val_cond_contrastive_loss: 78406.7344; val_gene_expr_recon_loss: 103753.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444957.7500; val_optim_loss: 444957.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9894; val_auprc_score: 0.9862; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 5713.5734; train_edge_recon_loss: 259139.5067; train_cond_contrastive_loss: 78676.9754; train_gene_expr_recon_loss: 104238.7467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447768.8036; train_optim_loss: 447768.8036; val_kl_reg_loss: 5625.7578; val_edge_recon_loss: 260565.3750; val_cond_contrastive_loss: 78408.0859; val_gene_expr_recon_loss: 103511.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448110.6875; val_optim_loss: 448110.6875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9907; val_auprc_score: 0.9875; val_best_acc_score: 0.9599; val_best_f1_score: 0.9607; train_kl_reg_loss: 5693.6754; train_edge_recon_loss: 259288.2567; train_cond_contrastive_loss: 78681.3080; train_gene_expr_recon_loss: 103700.4163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447363.6518; train_optim_loss: 447363.6518; val_kl_reg_loss: 5647.9556; val_edge_recon_loss: 258677.6250; val_cond_contrastive_loss: 78409.1953; val_gene_expr_recon_loss: 103303.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446037.9062; val_optim_loss: 446037.9062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9907; val_auprc_score: 0.9882; val_best_acc_score: 0.9600; val_best_f1_score: 0.9609; train_kl_reg_loss: 5676.2355; train_edge_recon_loss: 258393.1719; train_cond_contrastive_loss: 78683.1473; train_gene_expr_recon_loss: 103693.9598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446446.5134; train_optim_loss: 446446.5134; val_kl_reg_loss: 5633.7871; val_edge_recon_loss: 258467.7969; val_cond_contrastive_loss: 78409.8750; val_gene_expr_recon_loss: 103108.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445620.0000; val_optim_loss: 445620.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9914; val_auprc_score: 0.9886; val_best_acc_score: 0.9631; val_best_f1_score: 0.9639; train_kl_reg_loss: 5678.1961; train_edge_recon_loss: 257909.8214; train_cond_contrastive_loss: 78686.7388; train_gene_expr_recon_loss: 103464.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445739.5848; train_optim_loss: 445739.5848; val_kl_reg_loss: 5628.7734; val_edge_recon_loss: 256316.8125; val_cond_contrastive_loss: 78410.6016; val_gene_expr_recon_loss: 103082.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443438.7812; val_optim_loss: 443438.7812
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9912; val_auprc_score: 0.9873; val_best_acc_score: 0.9641; val_best_f1_score: 0.9646; train_kl_reg_loss: 5668.3637; train_edge_recon_loss: 258829.2589; train_cond_contrastive_loss: 78681.3973; train_gene_expr_recon_loss: 103172.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446351.3125; train_optim_loss: 446351.3125; val_kl_reg_loss: 5616.3682; val_edge_recon_loss: 259349.3438; val_cond_contrastive_loss: 78409.7656; val_gene_expr_recon_loss: 103045.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446421.4375; val_optim_loss: 446421.4375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9923; val_auprc_score: 0.9904; val_best_acc_score: 0.9637; val_best_f1_score: 0.9641; train_kl_reg_loss: 5667.6190; train_edge_recon_loss: 257882.1451; train_cond_contrastive_loss: 78684.6920; train_gene_expr_recon_loss: 103276.4129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445510.8661; train_optim_loss: 445510.8661; val_kl_reg_loss: 5632.1201; val_edge_recon_loss: 257618.8125; val_cond_contrastive_loss: 78410.5000; val_gene_expr_recon_loss: 103023.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444684.8125; val_optim_loss: 444684.8125
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9907; val_auprc_score: 0.9876; val_best_acc_score: 0.9617; val_best_f1_score: 0.9623; train_kl_reg_loss: 5677.6080; train_edge_recon_loss: 258260.6138; train_cond_contrastive_loss: 78678.4286; train_gene_expr_recon_loss: 103298.0759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445914.7232; train_optim_loss: 445914.7232; val_kl_reg_loss: 5633.8184; val_edge_recon_loss: 257421.7344; val_cond_contrastive_loss: 78410.7188; val_gene_expr_recon_loss: 103000.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444466.9062; val_optim_loss: 444466.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9894; val_auprc_score: 0.9849; val_best_acc_score: 0.9596; val_best_f1_score: 0.9607; train_kl_reg_loss: 5675.6016; train_edge_recon_loss: 257453.7054; train_cond_contrastive_loss: 78679.7321; train_gene_expr_recon_loss: 103361.4799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445170.5179; train_optim_loss: 445170.5179; val_kl_reg_loss: 5630.0508; val_edge_recon_loss: 257645.4844; val_cond_contrastive_loss: 78410.3203; val_gene_expr_recon_loss: 102998.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444684.0938; val_optim_loss: 444684.0938
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9896; val_auprc_score: 0.9850; val_best_acc_score: 0.9596; val_best_f1_score: 0.9605; train_kl_reg_loss: 5675.8562; train_edge_recon_loss: 257907.5960; train_cond_contrastive_loss: 78679.7210; train_gene_expr_recon_loss: 103390.1161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445653.2946; train_optim_loss: 445653.2946; val_kl_reg_loss: 5629.0127; val_edge_recon_loss: 259456.0312; val_cond_contrastive_loss: 78410.4531; val_gene_expr_recon_loss: 102996.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446491.7188; val_optim_loss: 446491.7188
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9893; val_auprc_score: 0.9853; val_best_acc_score: 0.9581; val_best_f1_score: 0.9592; train_kl_reg_loss: 5667.8456; train_edge_recon_loss: 257806.0223; train_cond_contrastive_loss: 78679.8415; train_gene_expr_recon_loss: 103321.4431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445475.1562; train_optim_loss: 445475.1562; val_kl_reg_loss: 5631.5850; val_edge_recon_loss: 258282.7188; val_cond_contrastive_loss: 78410.7812; val_gene_expr_recon_loss: 102993.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445318.9375; val_optim_loss: 445318.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 56 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9882
Val best accuracy score: 0.9605
Val best F1 score: 0.9609
Val gene expr MSE score: 1.4723
Duration of model training in run 7: 0 hours, 3 minutes and 59 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8000; val_auprc_score: 0.8238; val_best_acc_score: 0.7212; val_best_f1_score: 0.7108; train_kl_reg_loss: 6101.3527; train_edge_recon_loss: 355760.8214; train_cond_contrastive_loss: 105801.8638; train_gene_expr_recon_loss: 134244.5379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 601908.5714; train_optim_loss: 601908.5714; val_kl_reg_loss: 12843.0684; val_edge_recon_loss: 406530.0000; val_cond_contrastive_loss: 78334.5000; val_gene_expr_recon_loss: 119406.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 617114.3750; val_optim_loss: 617114.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7467; val_auprc_score: 0.7700; val_best_acc_score: 0.6599; val_best_f1_score: 0.7062; train_kl_reg_loss: 7255.3987; train_edge_recon_loss: 353958.4152; train_cond_contrastive_loss: 89448.2623; train_gene_expr_recon_loss: 116745.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567407.8036; train_optim_loss: 567407.8036; val_kl_reg_loss: 4657.1768; val_edge_recon_loss: 385729.0000; val_cond_contrastive_loss: 78381.2656; val_gene_expr_recon_loss: 116390.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 585157.8750; val_optim_loss: 585157.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7386; val_auprc_score: 0.7622; val_best_acc_score: 0.6656; val_best_f1_score: 0.7040; train_kl_reg_loss: 4349.3164; train_edge_recon_loss: 342258.6161; train_cond_contrastive_loss: 88667.1953; train_gene_expr_recon_loss: 114943.9029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550219.0268; train_optim_loss: 550219.0268; val_kl_reg_loss: 3637.2732; val_edge_recon_loss: 338618.5312; val_cond_contrastive_loss: 78389.5391; val_gene_expr_recon_loss: 115145.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535790.8125; val_optim_loss: 535790.8125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7600; val_auprc_score: 0.7722; val_best_acc_score: 0.6833; val_best_f1_score: 0.7127; train_kl_reg_loss: 4103.2228; train_edge_recon_loss: 319237.8973; train_cond_contrastive_loss: 81773.1596; train_gene_expr_recon_loss: 113958.4107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 519072.6920; train_optim_loss: 519072.6920; val_kl_reg_loss: 4745.8296; val_edge_recon_loss: 317844.8750; val_cond_contrastive_loss: 78361.8203; val_gene_expr_recon_loss: 114258.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 515211.3438; val_optim_loss: 515211.3438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8263; val_auprc_score: 0.8169; val_best_acc_score: 0.7414; val_best_f1_score: 0.7689; train_kl_reg_loss: 5289.2856; train_edge_recon_loss: 300011.4062; train_cond_contrastive_loss: 78833.3828; train_gene_expr_recon_loss: 112943.4498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497077.5268; train_optim_loss: 497077.5268; val_kl_reg_loss: 5841.5811; val_edge_recon_loss: 293728.0000; val_cond_contrastive_loss: 78376.6797; val_gene_expr_recon_loss: 113351.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491297.4062; val_optim_loss: 491297.4062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8587; val_auprc_score: 0.8401; val_best_acc_score: 0.7795; val_best_f1_score: 0.7982; train_kl_reg_loss: 6152.2520; train_edge_recon_loss: 285109.7768; train_cond_contrastive_loss: 78695.8281; train_gene_expr_recon_loss: 112188.9565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482146.8125; train_optim_loss: 482146.8125; val_kl_reg_loss: 6219.7905; val_edge_recon_loss: 284149.2500; val_cond_contrastive_loss: 78376.3359; val_gene_expr_recon_loss: 112470.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481215.9062; val_optim_loss: 481215.9062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8757; val_auprc_score: 0.8508; val_best_acc_score: 0.8008; val_best_f1_score: 0.8183; train_kl_reg_loss: 6230.9819; train_edge_recon_loss: 278738.1696; train_cond_contrastive_loss: 78872.4576; train_gene_expr_recon_loss: 111114.4252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474956.0312; train_optim_loss: 474956.0312; val_kl_reg_loss: 6040.2842; val_edge_recon_loss: 281416.9375; val_cond_contrastive_loss: 78376.8438; val_gene_expr_recon_loss: 111810.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477644.9688; val_optim_loss: 477644.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8959; val_auprc_score: 0.8694; val_best_acc_score: 0.8265; val_best_f1_score: 0.8408; train_kl_reg_loss: 6192.4616; train_edge_recon_loss: 275416.7723; train_cond_contrastive_loss: 78997.6295; train_gene_expr_recon_loss: 110729.5033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471336.3661; train_optim_loss: 471336.3661; val_kl_reg_loss: 6175.5190; val_edge_recon_loss: 276930.0312; val_cond_contrastive_loss: 78385.5703; val_gene_expr_recon_loss: 111166.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472657.2500; val_optim_loss: 472657.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9127; val_auprc_score: 0.8915; val_best_acc_score: 0.8427; val_best_f1_score: 0.8549; train_kl_reg_loss: 6241.6750; train_edge_recon_loss: 272412.9732; train_cond_contrastive_loss: 78946.0703; train_gene_expr_recon_loss: 109925.2645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467525.9821; train_optim_loss: 467525.9821; val_kl_reg_loss: 6052.6377; val_edge_recon_loss: 274781.3438; val_cond_contrastive_loss: 78397.5156; val_gene_expr_recon_loss: 110572.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469804.3750; val_optim_loss: 469804.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9291; val_auprc_score: 0.9156; val_best_acc_score: 0.8545; val_best_f1_score: 0.8640; train_kl_reg_loss: 6120.1948; train_edge_recon_loss: 270367.6384; train_cond_contrastive_loss: 78861.1674; train_gene_expr_recon_loss: 109481.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464830.5893; train_optim_loss: 464830.5893; val_kl_reg_loss: 6116.3682; val_edge_recon_loss: 274732.7188; val_cond_contrastive_loss: 78403.2109; val_gene_expr_recon_loss: 110121.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469373.9375; val_optim_loss: 469373.9375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9427; val_auprc_score: 0.9321; val_best_acc_score: 0.8721; val_best_f1_score: 0.8764; train_kl_reg_loss: 6168.1552; train_edge_recon_loss: 269669.6920; train_cond_contrastive_loss: 78758.5502; train_gene_expr_recon_loss: 108881.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463477.9509; train_optim_loss: 463477.9509; val_kl_reg_loss: 6207.9751; val_edge_recon_loss: 270905.7812; val_cond_contrastive_loss: 78402.4375; val_gene_expr_recon_loss: 109656.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465172.5625; val_optim_loss: 465172.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9497; val_auprc_score: 0.9371; val_best_acc_score: 0.8862; val_best_f1_score: 0.8907; train_kl_reg_loss: 6328.1150; train_edge_recon_loss: 267606.8304; train_cond_contrastive_loss: 78698.3839; train_gene_expr_recon_loss: 108451.1317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461084.4643; train_optim_loss: 461084.4643; val_kl_reg_loss: 6307.0288; val_edge_recon_loss: 270477.2500; val_cond_contrastive_loss: 78399.6484; val_gene_expr_recon_loss: 109178.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464362.2188; val_optim_loss: 464362.2188
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9597; val_auprc_score: 0.9472; val_best_acc_score: 0.8997; val_best_f1_score: 0.9025; train_kl_reg_loss: 6298.7197; train_edge_recon_loss: 267596.0268; train_cond_contrastive_loss: 78718.7020; train_gene_expr_recon_loss: 108246.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460859.5893; train_optim_loss: 460859.5893; val_kl_reg_loss: 6194.6777; val_edge_recon_loss: 270338.1562; val_cond_contrastive_loss: 78397.0156; val_gene_expr_recon_loss: 108754.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463684.0312; val_optim_loss: 463684.0312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9644; val_auprc_score: 0.9552; val_best_acc_score: 0.9078; val_best_f1_score: 0.9107; train_kl_reg_loss: 6189.9782; train_edge_recon_loss: 266078.9286; train_cond_contrastive_loss: 78752.2667; train_gene_expr_recon_loss: 107829.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458850.8884; train_optim_loss: 458850.8884; val_kl_reg_loss: 6075.7354; val_edge_recon_loss: 270424.9062; val_cond_contrastive_loss: 78397.7422; val_gene_expr_recon_loss: 108316.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463215.0312; val_optim_loss: 463215.0312
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9717; val_auprc_score: 0.9623; val_best_acc_score: 0.9199; val_best_f1_score: 0.9222; train_kl_reg_loss: 6051.6046; train_edge_recon_loss: 264705.1049; train_cond_contrastive_loss: 78775.3795; train_gene_expr_recon_loss: 107539.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457071.3348; train_optim_loss: 457071.3348; val_kl_reg_loss: 5931.4839; val_edge_recon_loss: 266454.5625; val_cond_contrastive_loss: 78401.5781; val_gene_expr_recon_loss: 107922.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458710.3750; val_optim_loss: 458710.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9776; val_auprc_score: 0.9722; val_best_acc_score: 0.9312; val_best_f1_score: 0.9320; train_kl_reg_loss: 5968.1947; train_edge_recon_loss: 264457.9375; train_cond_contrastive_loss: 78754.4308; train_gene_expr_recon_loss: 106618.0703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455798.6339; train_optim_loss: 455798.6339; val_kl_reg_loss: 5887.9146; val_edge_recon_loss: 265665.2188; val_cond_contrastive_loss: 78401.3281; val_gene_expr_recon_loss: 107567.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457521.5938; val_optim_loss: 457521.5938
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9824; val_auprc_score: 0.9773; val_best_acc_score: 0.9388; val_best_f1_score: 0.9405; train_kl_reg_loss: 5895.7875; train_edge_recon_loss: 262886.8415; train_cond_contrastive_loss: 78735.3516; train_gene_expr_recon_loss: 106761.5179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454279.4955; train_optim_loss: 454279.4955; val_kl_reg_loss: 5870.4014; val_edge_recon_loss: 263137.8438; val_cond_contrastive_loss: 78399.7656; val_gene_expr_recon_loss: 107229.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454637.1250; val_optim_loss: 454637.1250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9851; val_auprc_score: 0.9813; val_best_acc_score: 0.9446; val_best_f1_score: 0.9451; train_kl_reg_loss: 5885.8996; train_edge_recon_loss: 262217.0737; train_cond_contrastive_loss: 78724.2958; train_gene_expr_recon_loss: 106154.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452982.2143; train_optim_loss: 452982.2143; val_kl_reg_loss: 5830.3037; val_edge_recon_loss: 264986.0938; val_cond_contrastive_loss: 78395.6484; val_gene_expr_recon_loss: 106920.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456132.7812; val_optim_loss: 456132.7812
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9858; val_auprc_score: 0.9824; val_best_acc_score: 0.9466; val_best_f1_score: 0.9471; train_kl_reg_loss: 5882.8815; train_edge_recon_loss: 261639.1183; train_cond_contrastive_loss: 78721.3862; train_gene_expr_recon_loss: 105655.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451898.7946; train_optim_loss: 451898.7946; val_kl_reg_loss: 5875.6992; val_edge_recon_loss: 263694.1250; val_cond_contrastive_loss: 78394.8438; val_gene_expr_recon_loss: 106606.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454570.7500; val_optim_loss: 454570.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9854; val_auprc_score: 0.9806; val_best_acc_score: 0.9457; val_best_f1_score: 0.9469; train_kl_reg_loss: 5885.1515; train_edge_recon_loss: 260743.7723; train_cond_contrastive_loss: 78716.8359; train_gene_expr_recon_loss: 105788.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451133.9554; train_optim_loss: 451133.9554; val_kl_reg_loss: 5836.9282; val_edge_recon_loss: 261062.0625; val_cond_contrastive_loss: 78392.4609; val_gene_expr_recon_loss: 106308.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451599.5000; val_optim_loss: 451599.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9862; val_auprc_score: 0.9802; val_best_acc_score: 0.9473; val_best_f1_score: 0.9488; train_kl_reg_loss: 5873.7580; train_edge_recon_loss: 260457.8125; train_cond_contrastive_loss: 78727.5368; train_gene_expr_recon_loss: 105127.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450186.3884; train_optim_loss: 450186.3884; val_kl_reg_loss: 5918.1411; val_edge_recon_loss: 260488.2656; val_cond_contrastive_loss: 78390.8047; val_gene_expr_recon_loss: 105978.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450776.0938; val_optim_loss: 450776.0938
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9881; val_auprc_score: 0.9836; val_best_acc_score: 0.9530; val_best_f1_score: 0.9540; train_kl_reg_loss: 5893.9146; train_edge_recon_loss: 260347.7299; train_cond_contrastive_loss: 78729.2065; train_gene_expr_recon_loss: 104722.5190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449693.3616; train_optim_loss: 449693.3616; val_kl_reg_loss: 5809.9351; val_edge_recon_loss: 258395.2812; val_cond_contrastive_loss: 78390.0938; val_gene_expr_recon_loss: 105634.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448229.5938; val_optim_loss: 448229.5938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9880; val_auprc_score: 0.9810; val_best_acc_score: 0.9540; val_best_f1_score: 0.9549; train_kl_reg_loss: 5891.8279; train_edge_recon_loss: 259341.5603; train_cond_contrastive_loss: 78736.6217; train_gene_expr_recon_loss: 104702.3315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448672.3482; train_optim_loss: 448672.3482; val_kl_reg_loss: 5928.5620; val_edge_recon_loss: 259381.4688; val_cond_contrastive_loss: 78392.6719; val_gene_expr_recon_loss: 105299.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449002.4062; val_optim_loss: 449002.4062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9895; val_auprc_score: 0.9876; val_best_acc_score: 0.9522; val_best_f1_score: 0.9529; train_kl_reg_loss: 5911.2220; train_edge_recon_loss: 259807.6987; train_cond_contrastive_loss: 78730.6373; train_gene_expr_recon_loss: 103925.6071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448375.1696; train_optim_loss: 448375.1696; val_kl_reg_loss: 5815.1611; val_edge_recon_loss: 261596.1094; val_cond_contrastive_loss: 78394.3047; val_gene_expr_recon_loss: 104940.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450745.8438; val_optim_loss: 450745.8438
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9896; val_auprc_score: 0.9864; val_best_acc_score: 0.9545; val_best_f1_score: 0.9555; train_kl_reg_loss: 5871.3699; train_edge_recon_loss: 259656.4821; train_cond_contrastive_loss: 78735.8382; train_gene_expr_recon_loss: 103814.7511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448078.4375; train_optim_loss: 448078.4375; val_kl_reg_loss: 5826.9033; val_edge_recon_loss: 259626.0938; val_cond_contrastive_loss: 78396.7500; val_gene_expr_recon_loss: 104637.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448487.3438; val_optim_loss: 448487.3438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9890; val_auprc_score: 0.9854; val_best_acc_score: 0.9545; val_best_f1_score: 0.9556; train_kl_reg_loss: 5854.6129; train_edge_recon_loss: 259915.9375; train_cond_contrastive_loss: 78736.0011; train_gene_expr_recon_loss: 103828.9364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448335.4866; train_optim_loss: 448335.4866; val_kl_reg_loss: 5805.9736; val_edge_recon_loss: 260610.4062; val_cond_contrastive_loss: 78396.7578; val_gene_expr_recon_loss: 104595.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449408.7812; val_optim_loss: 449408.7812
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9898; val_auprc_score: 0.9858; val_best_acc_score: 0.9551; val_best_f1_score: 0.9561; train_kl_reg_loss: 5839.6686; train_edge_recon_loss: 259093.2612; train_cond_contrastive_loss: 78736.2433; train_gene_expr_recon_loss: 103839.4799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447508.6429; train_optim_loss: 447508.6429; val_kl_reg_loss: 5777.9570; val_edge_recon_loss: 261429.4531; val_cond_contrastive_loss: 78396.7578; val_gene_expr_recon_loss: 104548.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450152.5625; val_optim_loss: 450152.5625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9899; val_auprc_score: 0.9866; val_best_acc_score: 0.9558; val_best_f1_score: 0.9561; train_kl_reg_loss: 5824.2375; train_edge_recon_loss: 259328.5045; train_cond_contrastive_loss: 78735.3426; train_gene_expr_recon_loss: 103479.0112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447367.0938; train_optim_loss: 447367.0938; val_kl_reg_loss: 5776.2363; val_edge_recon_loss: 262007.4688; val_cond_contrastive_loss: 78397.1094; val_gene_expr_recon_loss: 104513.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450694.3750; val_optim_loss: 450694.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 47 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9874
Val AUPRC score: 0.9845
Val best accuracy score: 0.9505
Val best F1 score: 0.9516
Val gene expr MSE score: 1.6905
Duration of model training in run 8: 0 hours, 2 minutes and 50 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7488; val_auprc_score: 0.7751; val_best_acc_score: 0.6569; val_best_f1_score: 0.7165; train_kl_reg_loss: 4741.0607; train_edge_recon_loss: 359529.3924; train_cond_contrastive_loss: 95906.2995; train_gene_expr_recon_loss: 129926.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 590103.5625; train_optim_loss: 590103.5625; val_kl_reg_loss: 2972.8091; val_edge_recon_loss: 390779.2188; val_cond_contrastive_loss: 78341.1953; val_gene_expr_recon_loss: 116985.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 589078.5625; val_optim_loss: 589078.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7395; val_auprc_score: 0.7600; val_best_acc_score: 0.6564; val_best_f1_score: 0.7148; train_kl_reg_loss: 2944.6303; train_edge_recon_loss: 348671.1701; train_cond_contrastive_loss: 88384.4358; train_gene_expr_recon_loss: 116400.8351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 556401.0833; train_optim_loss: 556401.0833; val_kl_reg_loss: 2440.5032; val_edge_recon_loss: 341347.2188; val_cond_contrastive_loss: 78369.5078; val_gene_expr_recon_loss: 115580.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537737.6875; val_optim_loss: 537737.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7469; val_auprc_score: 0.7749; val_best_acc_score: 0.6729; val_best_f1_score: 0.7110; train_kl_reg_loss: 2885.4899; train_edge_recon_loss: 326963.2188; train_cond_contrastive_loss: 84817.1892; train_gene_expr_recon_loss: 114859.6632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 529525.5521; train_optim_loss: 529525.5521; val_kl_reg_loss: 3885.5537; val_edge_recon_loss: 321529.3438; val_cond_contrastive_loss: 78335.2656; val_gene_expr_recon_loss: 114376.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 518126.8438; val_optim_loss: 518126.8438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8209; val_auprc_score: 0.8223; val_best_acc_score: 0.7317; val_best_f1_score: 0.7657; train_kl_reg_loss: 4644.1583; train_edge_recon_loss: 308031.8819; train_cond_contrastive_loss: 78975.0677; train_gene_expr_recon_loss: 113725.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 505376.2604; train_optim_loss: 505376.2604; val_kl_reg_loss: 5361.8662; val_edge_recon_loss: 289217.8125; val_cond_contrastive_loss: 78346.8984; val_gene_expr_recon_loss: 113253.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 486180.5000; val_optim_loss: 486180.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8624; val_auprc_score: 0.8501; val_best_acc_score: 0.7812; val_best_f1_score: 0.8073; train_kl_reg_loss: 6009.5007; train_edge_recon_loss: 286141.7083; train_cond_contrastive_loss: 78628.7352; train_gene_expr_recon_loss: 112568.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483348.4549; train_optim_loss: 483348.4549; val_kl_reg_loss: 6371.5010; val_edge_recon_loss: 275890.3125; val_cond_contrastive_loss: 78352.9375; val_gene_expr_recon_loss: 112081.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472696.2500; val_optim_loss: 472696.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8794; val_auprc_score: 0.8564; val_best_acc_score: 0.8077; val_best_f1_score: 0.8273; train_kl_reg_loss: 6355.7080; train_edge_recon_loss: 279156.0417; train_cond_contrastive_loss: 78810.5208; train_gene_expr_recon_loss: 111576.3655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475898.6389; train_optim_loss: 475898.6389; val_kl_reg_loss: 6183.4053; val_edge_recon_loss: 276145.9688; val_cond_contrastive_loss: 78355.2109; val_gene_expr_recon_loss: 111281.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471965.6875; val_optim_loss: 471965.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9012; val_auprc_score: 0.8807; val_best_acc_score: 0.8364; val_best_f1_score: 0.8526; train_kl_reg_loss: 6381.7665; train_edge_recon_loss: 274727.5833; train_cond_contrastive_loss: 78949.0825; train_gene_expr_recon_loss: 110870.7153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470929.1632; train_optim_loss: 470929.1632; val_kl_reg_loss: 6281.4585; val_edge_recon_loss: 269787.5938; val_cond_contrastive_loss: 78369.8828; val_gene_expr_recon_loss: 110659.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465098.5312; val_optim_loss: 465098.5312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9311; val_auprc_score: 0.9177; val_best_acc_score: 0.8644; val_best_f1_score: 0.8744; train_kl_reg_loss: 6251.4616; train_edge_recon_loss: 271750.9028; train_cond_contrastive_loss: 78958.3420; train_gene_expr_recon_loss: 110220.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467180.8403; train_optim_loss: 467180.8403; val_kl_reg_loss: 6051.2622; val_edge_recon_loss: 266979.3438; val_cond_contrastive_loss: 78386.9375; val_gene_expr_recon_loss: 110040.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461457.5625; val_optim_loss: 461457.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9473; val_auprc_score: 0.9363; val_best_acc_score: 0.8844; val_best_f1_score: 0.8909; train_kl_reg_loss: 6275.2433; train_edge_recon_loss: 268224.3785; train_cond_contrastive_loss: 78798.5252; train_gene_expr_recon_loss: 109507.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462805.5174; train_optim_loss: 462805.5174; val_kl_reg_loss: 6290.0479; val_edge_recon_loss: 268332.7812; val_cond_contrastive_loss: 78389.5859; val_gene_expr_recon_loss: 109457.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462470.2500; val_optim_loss: 462470.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9575; val_auprc_score: 0.9480; val_best_acc_score: 0.9019; val_best_f1_score: 0.9076; train_kl_reg_loss: 6448.3895; train_edge_recon_loss: 267313.1910; train_cond_contrastive_loss: 78707.0712; train_gene_expr_recon_loss: 109009.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461477.7951; train_optim_loss: 461477.7951; val_kl_reg_loss: 6285.0190; val_edge_recon_loss: 262263.1562; val_cond_contrastive_loss: 78386.2812; val_gene_expr_recon_loss: 108906.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455840.5312; val_optim_loss: 455840.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9660; val_auprc_score: 0.9578; val_best_acc_score: 0.9126; val_best_f1_score: 0.9157; train_kl_reg_loss: 6260.6308; train_edge_recon_loss: 266574.7083; train_cond_contrastive_loss: 78742.7526; train_gene_expr_recon_loss: 108432.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460010.7083; train_optim_loss: 460010.7083; val_kl_reg_loss: 6033.5332; val_edge_recon_loss: 265702.5938; val_cond_contrastive_loss: 78385.2969; val_gene_expr_recon_loss: 108362.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458484.2812; val_optim_loss: 458484.2812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9709; val_auprc_score: 0.9647; val_best_acc_score: 0.9216; val_best_f1_score: 0.9242; train_kl_reg_loss: 6079.0012; train_edge_recon_loss: 264910.9826; train_cond_contrastive_loss: 78751.3030; train_gene_expr_recon_loss: 107844.0885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457585.3785; train_optim_loss: 457585.3785; val_kl_reg_loss: 5846.8359; val_edge_recon_loss: 264317.5625; val_cond_contrastive_loss: 78389.9219; val_gene_expr_recon_loss: 107876.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456430.5625; val_optim_loss: 456430.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9782; val_auprc_score: 0.9725; val_best_acc_score: 0.9333; val_best_f1_score: 0.9359; train_kl_reg_loss: 5937.1511; train_edge_recon_loss: 263784.3177; train_cond_contrastive_loss: 78761.7812; train_gene_expr_recon_loss: 107451.7509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455934.9965; train_optim_loss: 455934.9965; val_kl_reg_loss: 5822.7256; val_edge_recon_loss: 259402.5781; val_cond_contrastive_loss: 78390.6484; val_gene_expr_recon_loss: 107424.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451040.2500; val_optim_loss: 451040.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9821; val_auprc_score: 0.9756; val_best_acc_score: 0.9412; val_best_f1_score: 0.9430; train_kl_reg_loss: 5895.8080; train_edge_recon_loss: 263155.3750; train_cond_contrastive_loss: 78752.3984; train_gene_expr_recon_loss: 107053.6068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454857.1910; train_optim_loss: 454857.1910; val_kl_reg_loss: 5773.5234; val_edge_recon_loss: 260762.0938; val_cond_contrastive_loss: 78389.9609; val_gene_expr_recon_loss: 106971.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451896.9062; val_optim_loss: 451896.9062
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9829; val_auprc_score: 0.9772; val_best_acc_score: 0.9442; val_best_f1_score: 0.9462; train_kl_reg_loss: 5850.4314; train_edge_recon_loss: 261242.7431; train_cond_contrastive_loss: 78726.0356; train_gene_expr_recon_loss: 106593.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452412.3333; train_optim_loss: 452412.3333; val_kl_reg_loss: 5794.0342; val_edge_recon_loss: 258946.3906; val_cond_contrastive_loss: 78390.3359; val_gene_expr_recon_loss: 106592.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449723.5000; val_optim_loss: 449723.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9862; val_auprc_score: 0.9829; val_best_acc_score: 0.9460; val_best_f1_score: 0.9481; train_kl_reg_loss: 5837.3391; train_edge_recon_loss: 261200.5677; train_cond_contrastive_loss: 78701.2908; train_gene_expr_recon_loss: 106237.9635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451977.1667; train_optim_loss: 451977.1667; val_kl_reg_loss: 5743.7373; val_edge_recon_loss: 256992.8438; val_cond_contrastive_loss: 78389.9688; val_gene_expr_recon_loss: 106238.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447365.1875; val_optim_loss: 447365.1875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9883; val_auprc_score: 0.9848; val_best_acc_score: 0.9520; val_best_f1_score: 0.9529; train_kl_reg_loss: 5816.2696; train_edge_recon_loss: 260613.9965; train_cond_contrastive_loss: 78691.9852; train_gene_expr_recon_loss: 105869.8915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450992.1458; train_optim_loss: 450992.1458; val_kl_reg_loss: 5723.4121; val_edge_recon_loss: 259014.4531; val_cond_contrastive_loss: 78386.8516; val_gene_expr_recon_loss: 105834.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448958.9375; val_optim_loss: 448958.9375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9879; val_auprc_score: 0.9846; val_best_acc_score: 0.9523; val_best_f1_score: 0.9534; train_kl_reg_loss: 5806.3221; train_edge_recon_loss: 259275.2535; train_cond_contrastive_loss: 78703.9418; train_gene_expr_recon_loss: 105458.7561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449244.2743; train_optim_loss: 449244.2743; val_kl_reg_loss: 5757.1279; val_edge_recon_loss: 261327.8281; val_cond_contrastive_loss: 78384.6328; val_gene_expr_recon_loss: 105437.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450907.2812; val_optim_loss: 450907.2812
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9884; val_auprc_score: 0.9849; val_best_acc_score: 0.9520; val_best_f1_score: 0.9535; train_kl_reg_loss: 5816.5747; train_edge_recon_loss: 259090.9948; train_cond_contrastive_loss: 78710.2977; train_gene_expr_recon_loss: 105017.4540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448635.3299; train_optim_loss: 448635.3299; val_kl_reg_loss: 5719.2251; val_edge_recon_loss: 258431.2031; val_cond_contrastive_loss: 78383.8125; val_gene_expr_recon_loss: 105039.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447573.6562; val_optim_loss: 447573.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9878; val_auprc_score: 0.9844; val_best_acc_score: 0.9520; val_best_f1_score: 0.9535; train_kl_reg_loss: 5790.0957; train_edge_recon_loss: 259507.1215; train_cond_contrastive_loss: 78700.8906; train_gene_expr_recon_loss: 104788.2769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448786.3750; train_optim_loss: 448786.3750; val_kl_reg_loss: 5711.6025; val_edge_recon_loss: 258106.1094; val_cond_contrastive_loss: 78384.3750; val_gene_expr_recon_loss: 104976.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447178.1250; val_optim_loss: 447178.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9889; val_auprc_score: 0.9868; val_best_acc_score: 0.9531; val_best_f1_score: 0.9545; train_kl_reg_loss: 5780.8281; train_edge_recon_loss: 259147.2309; train_cond_contrastive_loss: 78708.4983; train_gene_expr_recon_loss: 104785.7691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448422.3299; train_optim_loss: 448422.3299; val_kl_reg_loss: 5721.4648; val_edge_recon_loss: 257672.4219; val_cond_contrastive_loss: 78384.6875; val_gene_expr_recon_loss: 104934.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446713.2500; val_optim_loss: 446713.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9880; val_auprc_score: 0.9829; val_best_acc_score: 0.9531; val_best_f1_score: 0.9548; train_kl_reg_loss: 5789.9615; train_edge_recon_loss: 259209.1649; train_cond_contrastive_loss: 78700.2378; train_gene_expr_recon_loss: 104699.3264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448398.6944; train_optim_loss: 448398.6944; val_kl_reg_loss: 5716.5645; val_edge_recon_loss: 257301.8906; val_cond_contrastive_loss: 78384.6562; val_gene_expr_recon_loss: 104897.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446300.3750; val_optim_loss: 446300.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9885; val_auprc_score: 0.9841; val_best_acc_score: 0.9535; val_best_f1_score: 0.9549; train_kl_reg_loss: 5782.4476; train_edge_recon_loss: 259219.5781; train_cond_contrastive_loss: 78704.1241; train_gene_expr_recon_loss: 104655.3003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448361.4514; train_optim_loss: 448361.4514; val_kl_reg_loss: 5708.1318; val_edge_recon_loss: 257463.8125; val_cond_contrastive_loss: 78385.1406; val_gene_expr_recon_loss: 104859.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446416.7500; val_optim_loss: 446416.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9893; val_auprc_score: 0.9863; val_best_acc_score: 0.9555; val_best_f1_score: 0.9564; train_kl_reg_loss: 5780.5900; train_edge_recon_loss: 258777.4705; train_cond_contrastive_loss: 78701.7387; train_gene_expr_recon_loss: 104612.1467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447871.9479; train_optim_loss: 447871.9479; val_kl_reg_loss: 5700.9092; val_edge_recon_loss: 255545.2812; val_cond_contrastive_loss: 78385.5781; val_gene_expr_recon_loss: 104825.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444457.5625; val_optim_loss: 444457.5625
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9888; val_auprc_score: 0.9856; val_best_acc_score: 0.9546; val_best_f1_score: 0.9565; train_kl_reg_loss: 5768.0722; train_edge_recon_loss: 259286.3056; train_cond_contrastive_loss: 78706.7595; train_gene_expr_recon_loss: 104637.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448398.3646; train_optim_loss: 448398.3646; val_kl_reg_loss: 5705.3555; val_edge_recon_loss: 255075.7188; val_cond_contrastive_loss: 78386.0469; val_gene_expr_recon_loss: 104791.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443958.2812; val_optim_loss: 443958.2812
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9888; val_auprc_score: 0.9857; val_best_acc_score: 0.9575; val_best_f1_score: 0.9585; train_kl_reg_loss: 5783.9063; train_edge_recon_loss: 258291.4757; train_cond_contrastive_loss: 78694.8455; train_gene_expr_recon_loss: 104562.9991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447333.2257; train_optim_loss: 447333.2257; val_kl_reg_loss: 5696.7051; val_edge_recon_loss: 257530.0000; val_cond_contrastive_loss: 78385.6719; val_gene_expr_recon_loss: 104755.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446368.0312; val_optim_loss: 446368.0312
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9891; val_auprc_score: 0.9846; val_best_acc_score: 0.9564; val_best_f1_score: 0.9579; train_kl_reg_loss: 5770.4765; train_edge_recon_loss: 259013.9184; train_cond_contrastive_loss: 78695.1936; train_gene_expr_recon_loss: 104443.3707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447922.9618; train_optim_loss: 447922.9618; val_kl_reg_loss: 5679.4346; val_edge_recon_loss: 254860.6719; val_cond_contrastive_loss: 78386.3828; val_gene_expr_recon_loss: 104717.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443644.4688; val_optim_loss: 443644.4688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9885; val_auprc_score: 0.9836; val_best_acc_score: 0.9554; val_best_f1_score: 0.9569; train_kl_reg_loss: 5755.5329; train_edge_recon_loss: 259205.5347; train_cond_contrastive_loss: 78697.6068; train_gene_expr_recon_loss: 104512.6128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448171.2847; train_optim_loss: 448171.2847; val_kl_reg_loss: 5661.3350; val_edge_recon_loss: 256545.7812; val_cond_contrastive_loss: 78385.8125; val_gene_expr_recon_loss: 104679.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445272.5625; val_optim_loss: 445272.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9876; val_auprc_score: 0.9827; val_best_acc_score: 0.9533; val_best_f1_score: 0.9552; train_kl_reg_loss: 5740.7143; train_edge_recon_loss: 259342.7014; train_cond_contrastive_loss: 78700.7795; train_gene_expr_recon_loss: 104507.4288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448291.6285; train_optim_loss: 448291.6285; val_kl_reg_loss: 5649.7007; val_edge_recon_loss: 255553.2188; val_cond_contrastive_loss: 78386.8906; val_gene_expr_recon_loss: 104641.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444231.1875; val_optim_loss: 444231.1875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9879; val_best_acc_score: 0.9580; val_best_f1_score: 0.9593; train_kl_reg_loss: 5729.9891; train_edge_recon_loss: 258781.8819; train_cond_contrastive_loss: 78698.6840; train_gene_expr_recon_loss: 104449.6918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447660.2465; train_optim_loss: 447660.2465; val_kl_reg_loss: 5644.7100; val_edge_recon_loss: 256514.9375; val_cond_contrastive_loss: 78386.8125; val_gene_expr_recon_loss: 104605.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445151.8438; val_optim_loss: 445151.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9893; val_auprc_score: 0.9847; val_best_acc_score: 0.9553; val_best_f1_score: 0.9565; train_kl_reg_loss: 5723.6275; train_edge_recon_loss: 259099.1406; train_cond_contrastive_loss: 78700.5200; train_gene_expr_recon_loss: 104425.2856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447948.5660; train_optim_loss: 447948.5660; val_kl_reg_loss: 5644.6777; val_edge_recon_loss: 258314.1875; val_cond_contrastive_loss: 78386.5859; val_gene_expr_recon_loss: 104601.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446947.1562; val_optim_loss: 446947.1562
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9881; val_auprc_score: 0.9840; val_best_acc_score: 0.9554; val_best_f1_score: 0.9570; train_kl_reg_loss: 5725.7012; train_edge_recon_loss: 259551.7691; train_cond_contrastive_loss: 78699.2413; train_gene_expr_recon_loss: 104365.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448342.6771; train_optim_loss: 448342.6771; val_kl_reg_loss: 5643.9258; val_edge_recon_loss: 256074.3438; val_cond_contrastive_loss: 78386.8047; val_gene_expr_recon_loss: 104598.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444703.6562; val_optim_loss: 444703.6562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9893; val_auprc_score: 0.9872; val_best_acc_score: 0.9558; val_best_f1_score: 0.9572; train_kl_reg_loss: 5724.0001; train_edge_recon_loss: 258703.6753; train_cond_contrastive_loss: 78700.5911; train_gene_expr_recon_loss: 104360.8967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447489.1597; train_optim_loss: 447489.1597; val_kl_reg_loss: 5644.1553; val_edge_recon_loss: 256266.8281; val_cond_contrastive_loss: 78387.1094; val_gene_expr_recon_loss: 104594.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444893.0000; val_optim_loss: 444893.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 17 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9891
Val AUPRC score: 0.9863
Val best accuracy score: 0.9555
Val best F1 score: 0.9572
Val gene expr MSE score: 1.5964
Duration of model training in run 9: 0 hours, 4 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7922; val_auprc_score: 0.8213; val_best_acc_score: 0.7079; val_best_f1_score: 0.7225; train_kl_reg_loss: 6710.8422; train_edge_recon_loss: 357620.4028; train_cond_contrastive_loss: 101376.0668; train_gene_expr_recon_loss: 129910.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 595618.2222; train_optim_loss: 595618.2222; val_kl_reg_loss: 7940.8594; val_edge_recon_loss: 397705.5625; val_cond_contrastive_loss: 78336.7969; val_gene_expr_recon_loss: 118819.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602802.5000; val_optim_loss: 602802.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7647; val_auprc_score: 0.7837; val_best_acc_score: 0.6737; val_best_f1_score: 0.7196; train_kl_reg_loss: 5957.6831; train_edge_recon_loss: 350577.5486; train_cond_contrastive_loss: 87093.0356; train_gene_expr_recon_loss: 116758.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 560387.2292; train_optim_loss: 560387.2292; val_kl_reg_loss: 3297.7578; val_edge_recon_loss: 352844.7812; val_cond_contrastive_loss: 78407.9688; val_gene_expr_recon_loss: 115939.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 550489.8125; val_optim_loss: 550489.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7676; val_auprc_score: 0.7901; val_best_acc_score: 0.6907; val_best_f1_score: 0.7159; train_kl_reg_loss: 3700.8095; train_edge_recon_loss: 322680.1840; train_cond_contrastive_loss: 84357.5625; train_gene_expr_recon_loss: 114857.4236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 525595.9722; train_optim_loss: 525595.9722; val_kl_reg_loss: 4900.7554; val_edge_recon_loss: 315464.3125; val_cond_contrastive_loss: 78361.6953; val_gene_expr_recon_loss: 114603.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 513330.4375; val_optim_loss: 513330.4375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8355; val_auprc_score: 0.8313; val_best_acc_score: 0.7453; val_best_f1_score: 0.7729; train_kl_reg_loss: 5738.3396; train_edge_recon_loss: 299997.7882; train_cond_contrastive_loss: 78816.0712; train_gene_expr_recon_loss: 113834.5582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 498386.7604; train_optim_loss: 498386.7604; val_kl_reg_loss: 6415.6865; val_edge_recon_loss: 290070.0625; val_cond_contrastive_loss: 78370.8984; val_gene_expr_recon_loss: 113739.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488596.6250; val_optim_loss: 488596.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8680; val_auprc_score: 0.8534; val_best_acc_score: 0.7872; val_best_f1_score: 0.8058; train_kl_reg_loss: 6436.7775; train_edge_recon_loss: 282745.9514; train_cond_contrastive_loss: 78689.8550; train_gene_expr_recon_loss: 112781.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480654.4583; train_optim_loss: 480654.4583; val_kl_reg_loss: 6147.4673; val_edge_recon_loss: 282423.4062; val_cond_contrastive_loss: 78369.6328; val_gene_expr_recon_loss: 112826.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479766.7500; val_optim_loss: 479766.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8917; val_auprc_score: 0.8727; val_best_acc_score: 0.8184; val_best_f1_score: 0.8356; train_kl_reg_loss: 5976.6109; train_edge_recon_loss: 277772.3715; train_cond_contrastive_loss: 78967.1675; train_gene_expr_recon_loss: 111984.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474700.8576; train_optim_loss: 474700.8576; val_kl_reg_loss: 5887.1348; val_edge_recon_loss: 274019.4062; val_cond_contrastive_loss: 78371.3125; val_gene_expr_recon_loss: 112145.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470423.6250; val_optim_loss: 470423.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9069; val_auprc_score: 0.8892; val_best_acc_score: 0.8381; val_best_f1_score: 0.8524; train_kl_reg_loss: 6034.9853; train_edge_recon_loss: 273913.6250; train_cond_contrastive_loss: 78996.7370; train_gene_expr_recon_loss: 111369.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470314.6979; train_optim_loss: 470314.6979; val_kl_reg_loss: 6015.3853; val_edge_recon_loss: 274163.4062; val_cond_contrastive_loss: 78382.4141; val_gene_expr_recon_loss: 111494.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470055.4375; val_optim_loss: 470055.4375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9332; val_auprc_score: 0.9207; val_best_acc_score: 0.8626; val_best_f1_score: 0.8719; train_kl_reg_loss: 5918.5684; train_edge_recon_loss: 270852.2118; train_cond_contrastive_loss: 78933.6467; train_gene_expr_recon_loss: 110704.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466409.3056; train_optim_loss: 466409.3056; val_kl_reg_loss: 5705.6914; val_edge_recon_loss: 268762.4062; val_cond_contrastive_loss: 78396.0000; val_gene_expr_recon_loss: 110925.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463789.3125; val_optim_loss: 463789.3125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9478; val_auprc_score: 0.9403; val_best_acc_score: 0.8799; val_best_f1_score: 0.8853; train_kl_reg_loss: 5833.1092; train_edge_recon_loss: 268984.6042; train_cond_contrastive_loss: 78816.7448; train_gene_expr_recon_loss: 110176.0929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463810.5451; train_optim_loss: 463810.5451; val_kl_reg_loss: 6010.0127; val_edge_recon_loss: 270539.5938; val_cond_contrastive_loss: 78395.9219; val_gene_expr_recon_loss: 110387.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465332.9688; val_optim_loss: 465332.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9574; val_auprc_score: 0.9481; val_best_acc_score: 0.8961; val_best_f1_score: 0.8994; train_kl_reg_loss: 6099.8529; train_edge_recon_loss: 267749.1806; train_cond_contrastive_loss: 78709.7075; train_gene_expr_recon_loss: 109671.5200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462230.2708; train_optim_loss: 462230.2708; val_kl_reg_loss: 6066.9014; val_edge_recon_loss: 267697.1562; val_cond_contrastive_loss: 78389.9141; val_gene_expr_recon_loss: 109869.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462023.1875; val_optim_loss: 462023.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9655; val_auprc_score: 0.9568; val_best_acc_score: 0.9108; val_best_f1_score: 0.9141; train_kl_reg_loss: 6011.6401; train_edge_recon_loss: 266021.8264; train_cond_contrastive_loss: 78752.0616; train_gene_expr_recon_loss: 109266.4054; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460051.9375; train_optim_loss: 460051.9375; val_kl_reg_loss: 5927.6455; val_edge_recon_loss: 264895.7812; val_cond_contrastive_loss: 78389.4375; val_gene_expr_recon_loss: 109359.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458572.3125; val_optim_loss: 458572.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9738; val_auprc_score: 0.9677; val_best_acc_score: 0.9237; val_best_f1_score: 0.9255; train_kl_reg_loss: 5921.6412; train_edge_recon_loss: 264741.3854; train_cond_contrastive_loss: 78787.1094; train_gene_expr_recon_loss: 108631.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458081.4861; train_optim_loss: 458081.4861; val_kl_reg_loss: 5809.1436; val_edge_recon_loss: 264946.2188; val_cond_contrastive_loss: 78392.7578; val_gene_expr_recon_loss: 108860.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458008.8125; val_optim_loss: 458008.8125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9774; val_auprc_score: 0.9701; val_best_acc_score: 0.9308; val_best_f1_score: 0.9323; train_kl_reg_loss: 5886.9121; train_edge_recon_loss: 264025.2604; train_cond_contrastive_loss: 78807.0391; train_gene_expr_recon_loss: 108126.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456845.3819; train_optim_loss: 456845.3819; val_kl_reg_loss: 5797.9111; val_edge_recon_loss: 263312.7812; val_cond_contrastive_loss: 78397.1953; val_gene_expr_recon_loss: 108363.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455871.2188; val_optim_loss: 455871.2188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9827; val_auprc_score: 0.9785; val_best_acc_score: 0.9381; val_best_f1_score: 0.9403; train_kl_reg_loss: 5824.0902; train_edge_recon_loss: 263240.3108; train_cond_contrastive_loss: 78811.5616; train_gene_expr_recon_loss: 107750.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455626.4132; train_optim_loss: 455626.4132; val_kl_reg_loss: 5789.0137; val_edge_recon_loss: 261836.7031; val_cond_contrastive_loss: 78399.2109; val_gene_expr_recon_loss: 107937.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453962.3438; val_optim_loss: 453962.3438
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9851; val_auprc_score: 0.9817; val_best_acc_score: 0.9453; val_best_f1_score: 0.9467; train_kl_reg_loss: 5840.1961; train_edge_recon_loss: 261967.0382; train_cond_contrastive_loss: 78795.4167; train_gene_expr_recon_loss: 107290.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453892.8785; train_optim_loss: 453892.8785; val_kl_reg_loss: 5792.2510; val_edge_recon_loss: 260774.4062; val_cond_contrastive_loss: 78395.4609; val_gene_expr_recon_loss: 107528.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452490.3750; val_optim_loss: 452490.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9865; val_auprc_score: 0.9813; val_best_acc_score: 0.9501; val_best_f1_score: 0.9514; train_kl_reg_loss: 5858.4858; train_edge_recon_loss: 260231.6545; train_cond_contrastive_loss: 78758.7595; train_gene_expr_recon_loss: 106869.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451718.6354; train_optim_loss: 451718.6354; val_kl_reg_loss: 5849.2031; val_edge_recon_loss: 258006.3906; val_cond_contrastive_loss: 78390.2656; val_gene_expr_recon_loss: 107118.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449364.5625; val_optim_loss: 449364.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9867; val_auprc_score: 0.9825; val_best_acc_score: 0.9504; val_best_f1_score: 0.9519; train_kl_reg_loss: 5860.4647; train_edge_recon_loss: 259782.9028; train_cond_contrastive_loss: 78741.2483; train_gene_expr_recon_loss: 106421.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450806.2639; train_optim_loss: 450806.2639; val_kl_reg_loss: 5793.2656; val_edge_recon_loss: 259440.5156; val_cond_contrastive_loss: 78385.8281; val_gene_expr_recon_loss: 106733.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450353.3750; val_optim_loss: 450353.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9882; val_auprc_score: 0.9842; val_best_acc_score: 0.9522; val_best_f1_score: 0.9536; train_kl_reg_loss: 5858.8010; train_edge_recon_loss: 259609.0486; train_cond_contrastive_loss: 78724.3394; train_gene_expr_recon_loss: 106104.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450296.2222; train_optim_loss: 450296.2222; val_kl_reg_loss: 5823.5928; val_edge_recon_loss: 258195.6094; val_cond_contrastive_loss: 78382.2109; val_gene_expr_recon_loss: 106324.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448726.0625; val_optim_loss: 448726.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9894; val_auprc_score: 0.9863; val_best_acc_score: 0.9546; val_best_f1_score: 0.9557; train_kl_reg_loss: 5815.7335; train_edge_recon_loss: 258708.3316; train_cond_contrastive_loss: 78720.5191; train_gene_expr_recon_loss: 105597.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448842.3819; train_optim_loss: 448842.3819; val_kl_reg_loss: 5757.5977; val_edge_recon_loss: 257281.0625; val_cond_contrastive_loss: 78380.3125; val_gene_expr_recon_loss: 105927.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447346.6875; val_optim_loss: 447346.6875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9883; val_auprc_score: 0.9844; val_best_acc_score: 0.9530; val_best_f1_score: 0.9543; train_kl_reg_loss: 5802.7865; train_edge_recon_loss: 259045.7101; train_cond_contrastive_loss: 78709.1207; train_gene_expr_recon_loss: 105221.9323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448779.5486; train_optim_loss: 448779.5486; val_kl_reg_loss: 5711.2822; val_edge_recon_loss: 259724.5625; val_cond_contrastive_loss: 78381.3203; val_gene_expr_recon_loss: 105540.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449357.6562; val_optim_loss: 449357.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9908; val_auprc_score: 0.9873; val_best_acc_score: 0.9585; val_best_f1_score: 0.9598; train_kl_reg_loss: 5790.9854; train_edge_recon_loss: 258379.5712; train_cond_contrastive_loss: 78712.6536; train_gene_expr_recon_loss: 104827.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447710.8958; train_optim_loss: 447710.8958; val_kl_reg_loss: 5758.5410; val_edge_recon_loss: 256457.5938; val_cond_contrastive_loss: 78383.4453; val_gene_expr_recon_loss: 105216.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445816.0000; val_optim_loss: 445816.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9898; val_auprc_score: 0.9866; val_best_acc_score: 0.9574; val_best_f1_score: 0.9589; train_kl_reg_loss: 5780.1859; train_edge_recon_loss: 258291.3420; train_cond_contrastive_loss: 78707.6311; train_gene_expr_recon_loss: 104524.6936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447303.8542; train_optim_loss: 447303.8542; val_kl_reg_loss: 5737.3667; val_edge_recon_loss: 256819.0469; val_cond_contrastive_loss: 78384.3203; val_gene_expr_recon_loss: 104904.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445845.5625; val_optim_loss: 445845.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9895; val_auprc_score: 0.9864; val_best_acc_score: 0.9583; val_best_f1_score: 0.9592; train_kl_reg_loss: 5754.7488; train_edge_recon_loss: 258170.2986; train_cond_contrastive_loss: 78713.5434; train_gene_expr_recon_loss: 104235.6189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446874.2118; train_optim_loss: 446874.2118; val_kl_reg_loss: 5711.4658; val_edge_recon_loss: 259410.9844; val_cond_contrastive_loss: 78386.2891; val_gene_expr_recon_loss: 104627.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448135.9062; val_optim_loss: 448135.9062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9913; val_auprc_score: 0.9885; val_best_acc_score: 0.9623; val_best_f1_score: 0.9630; train_kl_reg_loss: 5772.4428; train_edge_recon_loss: 257971.9618; train_cond_contrastive_loss: 78715.0816; train_gene_expr_recon_loss: 103951.0434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446410.5208; train_optim_loss: 446410.5208; val_kl_reg_loss: 5685.0874; val_edge_recon_loss: 259152.0000; val_cond_contrastive_loss: 78388.1328; val_gene_expr_recon_loss: 104339.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447564.4688; val_optim_loss: 447564.4688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9914; val_auprc_score: 0.9874; val_best_acc_score: 0.9610; val_best_f1_score: 0.9621; train_kl_reg_loss: 5750.8844; train_edge_recon_loss: 258261.4705; train_cond_contrastive_loss: 78724.5486; train_gene_expr_recon_loss: 103693.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446430.6111; train_optim_loss: 446430.6111; val_kl_reg_loss: 5721.6836; val_edge_recon_loss: 257245.3594; val_cond_contrastive_loss: 78388.4531; val_gene_expr_recon_loss: 104285.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445641.3750; val_optim_loss: 445641.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9910; val_auprc_score: 0.9875; val_best_acc_score: 0.9625; val_best_f1_score: 0.9632; train_kl_reg_loss: 5751.6354; train_edge_recon_loss: 258263.4931; train_cond_contrastive_loss: 78718.3516; train_gene_expr_recon_loss: 103716.2786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446449.7569; train_optim_loss: 446449.7569; val_kl_reg_loss: 5667.1943; val_edge_recon_loss: 257812.1719; val_cond_contrastive_loss: 78388.7031; val_gene_expr_recon_loss: 104246.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446114.2188; val_optim_loss: 446114.2188
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9904; val_auprc_score: 0.9866; val_best_acc_score: 0.9593; val_best_f1_score: 0.9602; train_kl_reg_loss: 5737.0258; train_edge_recon_loss: 258229.0747; train_cond_contrastive_loss: 78723.1424; train_gene_expr_recon_loss: 103605.0964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446294.3438; train_optim_loss: 446294.3438; val_kl_reg_loss: 5686.6885; val_edge_recon_loss: 259257.3438; val_cond_contrastive_loss: 78388.8984; val_gene_expr_recon_loss: 104221.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447554.3750; val_optim_loss: 447554.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9907; val_auprc_score: 0.9865; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 5748.5280; train_edge_recon_loss: 257689.9896; train_cond_contrastive_loss: 78714.3733; train_gene_expr_recon_loss: 103568.4905; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445721.3785; train_optim_loss: 445721.3785; val_kl_reg_loss: 5682.9082; val_edge_recon_loss: 258632.0625; val_cond_contrastive_loss: 78389.0469; val_gene_expr_recon_loss: 104192.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446896.1250; val_optim_loss: 446896.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9898; val_auprc_score: 0.9852; val_best_acc_score: 0.9614; val_best_f1_score: 0.9624; train_kl_reg_loss: 5744.6644; train_edge_recon_loss: 257979.0382; train_cond_contrastive_loss: 78718.1667; train_gene_expr_recon_loss: 103589.4019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446031.2674; train_optim_loss: 446031.2674; val_kl_reg_loss: 5684.6377; val_edge_recon_loss: 257784.9375; val_cond_contrastive_loss: 78389.2969; val_gene_expr_recon_loss: 104188.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446047.6875; val_optim_loss: 446047.6875
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9865; val_best_acc_score: 0.9619; val_best_f1_score: 0.9627; train_kl_reg_loss: 5745.0234; train_edge_recon_loss: 258412.6719; train_cond_contrastive_loss: 78716.0425; train_gene_expr_recon_loss: 103641.2769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446515.0174; train_optim_loss: 446515.0174; val_kl_reg_loss: 5680.7070; val_edge_recon_loss: 258052.9375; val_cond_contrastive_loss: 78389.0938; val_gene_expr_recon_loss: 104186.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446308.7812; val_optim_loss: 446308.7812
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9902; val_auprc_score: 0.9863; val_best_acc_score: 0.9609; val_best_f1_score: 0.9615; train_kl_reg_loss: 5744.1348; train_edge_recon_loss: 257938.4323; train_cond_contrastive_loss: 78716.5356; train_gene_expr_recon_loss: 103557.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445957.0278; train_optim_loss: 445957.0278; val_kl_reg_loss: 5681.1929; val_edge_recon_loss: 261016.5156; val_cond_contrastive_loss: 78388.8125; val_gene_expr_recon_loss: 104183.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449269.8438; val_optim_loss: 449269.8438

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 1 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9906
Val AUPRC score: 0.9861
Val best accuracy score: 0.9614
Val best F1 score: 0.9621
Val gene expr MSE score: 1.5591
Duration of model training in run 10: 0 hours, 4 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
