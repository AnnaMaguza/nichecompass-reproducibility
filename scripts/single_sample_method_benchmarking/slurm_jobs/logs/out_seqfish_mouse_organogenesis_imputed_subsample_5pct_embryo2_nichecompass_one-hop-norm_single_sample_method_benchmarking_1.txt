
Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 33 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.8968
val AUPRC score: 0.8784
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 34077.0531
val source rna MSE score: 13.8879
Duration of model training in run 2: 0 hours, 0 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1499, n_latent: 1499, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1499, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1499, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 1496
Number of validation edges: 166
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9197; val_auprc_score: 0.8847; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1508.3193; train_edge_recon_loss: 3472656.5000; train_gene_expr_recon_loss: 31266160.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 34740324.0000; train_optim_loss: 34740324.0000; val_kl_reg_loss: 727281792.0000; val_edge_recon_loss: 4066007.5000; val_gene_expr_recon_loss: 550561408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1281909248.0000; val_optim_loss: 1281909248.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9339; val_auprc_score: 0.9233; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 786345024.0000; train_edge_recon_loss: 3582209.7500; train_gene_expr_recon_loss: 636817792.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1426745088.0000; train_optim_loss: 1426745088.0000; val_kl_reg_loss: 19333210.0000; val_edge_recon_loss: 4066087.5000; val_gene_expr_recon_loss: 570476096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 593875392.0000; val_optim_loss: 593875392.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9222; val_auprc_score: 0.9008; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19981554.0000; train_edge_recon_loss: 3549912.5000; train_gene_expr_recon_loss: 581353984.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 604885440.0000; train_optim_loss: 604885440.0000; val_kl_reg_loss: 86162848.0000; val_edge_recon_loss: 4066226.7500; val_gene_expr_recon_loss: 570000448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 660229504.0000; val_optim_loss: 660229504.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9145; val_auprc_score: 0.8865; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 92305504.0000; train_edge_recon_loss: 3514882.5000; train_gene_expr_recon_loss: 596238912.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 692059264.0000; train_optim_loss: 692059264.0000; val_kl_reg_loss: 19900588.0000; val_edge_recon_loss: 4066251.2500; val_gene_expr_recon_loss: 571683456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595650304.0000; val_optim_loss: 595650304.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9224; val_auprc_score: 0.9128; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20659930.0000; train_edge_recon_loss: 3503295.7500; train_gene_expr_recon_loss: 574697408.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 598860608.0000; train_optim_loss: 598860608.0000; val_kl_reg_loss: 3252365.0000; val_edge_recon_loss: 4066270.0000; val_gene_expr_recon_loss: 571586944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 578905600.0000; val_optim_loss: 578905600.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9112; val_auprc_score: 0.9028; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3231017.0000; train_edge_recon_loss: 3488557.0000; train_gene_expr_recon_loss: 572039424.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 578758976.0000; train_optim_loss: 578758976.0000; val_kl_reg_loss: 29641380.0000; val_edge_recon_loss: 4066276.2500; val_gene_expr_recon_loss: 571395840.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 605103488.0000; val_optim_loss: 605103488.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9055; val_auprc_score: 0.8766; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 32263666.0000; train_edge_recon_loss: 3550238.2500; train_gene_expr_recon_loss: 583724352.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 619538240.0000; train_optim_loss: 619538240.0000; val_kl_reg_loss: 1870846.0000; val_edge_recon_loss: 4066282.5000; val_gene_expr_recon_loss: 571199104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 577136256.0000; val_optim_loss: 577136256.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9155; val_auprc_score: 0.9059; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1899999.0000; train_edge_recon_loss: 3524993.2500; train_gene_expr_recon_loss: 571363072.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 576788096.0000; train_optim_loss: 576788096.0000; val_kl_reg_loss: 2789221.7500; val_edge_recon_loss: 4066284.2500; val_gene_expr_recon_loss: 570975616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 577831104.0000; val_optim_loss: 577831104.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9170; val_auprc_score: 0.9183; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2759323.0000; train_edge_recon_loss: 3622543.5000; train_gene_expr_recon_loss: 571694272.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 578076160.0000; train_optim_loss: 578076160.0000; val_kl_reg_loss: 577574.3125; val_edge_recon_loss: 4066287.5000; val_gene_expr_recon_loss: 570734784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575378624.0000; val_optim_loss: 575378624.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9011; val_auprc_score: 0.8660; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 620673.6875; train_edge_recon_loss: 3668936.0000; train_gene_expr_recon_loss: 573449408.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577739008.0000; train_optim_loss: 577739008.0000; val_kl_reg_loss: 325015.0000; val_edge_recon_loss: 4066288.0000; val_gene_expr_recon_loss: 570484928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 574876224.0000; val_optim_loss: 574876224.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8982; val_auprc_score: 0.8690; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 329871.7812; train_edge_recon_loss: 3774608.7500; train_gene_expr_recon_loss: 570724160.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 574828672.0000; train_optim_loss: 574828672.0000; val_kl_reg_loss: 5577374.0000; val_edge_recon_loss: 4066290.2500; val_gene_expr_recon_loss: 565519616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575163264.0000; val_optim_loss: 575163264.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9200; val_auprc_score: 0.9070; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5521799.0000; train_edge_recon_loss: 3547582.0000; train_gene_expr_recon_loss: 568790016.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577859392.0000; train_optim_loss: 577859392.0000; val_kl_reg_loss: 17847644.0000; val_edge_recon_loss: 4066288.7500; val_gene_expr_recon_loss: 550768512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572682432.0000; val_optim_loss: 572682432.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9040; val_auprc_score: 0.8851; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19192400.0000; train_edge_recon_loss: 3590738.0000; train_gene_expr_recon_loss: 570254528.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 593037696.0000; train_optim_loss: 593037696.0000; val_kl_reg_loss: 1362106.5000; val_edge_recon_loss: 4066291.5000; val_gene_expr_recon_loss: 453020416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458448800.0000; val_optim_loss: 458448800.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9181; val_auprc_score: 0.9258; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1430689.5000; train_edge_recon_loss: 3560787.5000; train_gene_expr_recon_loss: 481764832.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486756320.0000; train_optim_loss: 486756320.0000; val_kl_reg_loss: 3845776.7500; val_edge_recon_loss: 4066294.5000; val_gene_expr_recon_loss: 286647008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294559072.0000; val_optim_loss: 294559072.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8942; val_auprc_score: 0.8711; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3552391.5000; train_edge_recon_loss: 3720975.0000; train_gene_expr_recon_loss: 435281344.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442554720.0000; train_optim_loss: 442554720.0000; val_kl_reg_loss: 2268936.5000; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 80692944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87028176.0000; val_optim_loss: 87028176.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9156; val_auprc_score: 0.8943; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2337745.2500; train_edge_recon_loss: 3746384.5000; train_gene_expr_recon_loss: 342796128.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348880256.0000; train_optim_loss: 348880256.0000; val_kl_reg_loss: 444967.2500; val_edge_recon_loss: 4066294.5000; val_gene_expr_recon_loss: 44046056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 48557320.0000; val_optim_loss: 48557320.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8955; val_auprc_score: 0.8699; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 452292.5625; train_edge_recon_loss: 3897033.7500; train_gene_expr_recon_loss: 74985552.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 79334880.0000; train_optim_loss: 79334880.0000; val_kl_reg_loss: 448546.6875; val_edge_recon_loss: 4066297.0000; val_gene_expr_recon_loss: 37039384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41554228.0000; val_optim_loss: 41554228.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9273; val_auprc_score: 0.9277; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 460717.5938; train_edge_recon_loss: 3894212.7500; train_gene_expr_recon_loss: 40451716.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44806648.0000; train_optim_loss: 44806648.0000; val_kl_reg_loss: 3524376.2500; val_edge_recon_loss: 4066296.5000; val_gene_expr_recon_loss: 38056784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 45647456.0000; val_optim_loss: 45647456.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9076; val_auprc_score: 0.8962; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3623893.5000; train_edge_recon_loss: 3718487.0000; train_gene_expr_recon_loss: 46924320.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 54266700.0000; train_optim_loss: 54266700.0000; val_kl_reg_loss: 611208.8750; val_edge_recon_loss: 4066297.0000; val_gene_expr_recon_loss: 37387348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42064856.0000; val_optim_loss: 42064856.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9102; val_auprc_score: 0.9038; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 608678.8750; train_edge_recon_loss: 3847449.0000; train_gene_expr_recon_loss: 37525288.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41981416.0000; train_optim_loss: 41981416.0000; val_kl_reg_loss: 436226.5312; val_edge_recon_loss: 4066297.5000; val_gene_expr_recon_loss: 54397920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 58900444.0000; val_optim_loss: 58900444.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9041; val_auprc_score: 0.8950; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 446020.0000; train_edge_recon_loss: 4048710.7500; train_gene_expr_recon_loss: 53005536.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 57500268.0000; train_optim_loss: 57500268.0000; val_kl_reg_loss: 613669.1875; val_edge_recon_loss: 4066298.0000; val_gene_expr_recon_loss: 35538264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40218232.0000; val_optim_loss: 40218232.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9234; val_auprc_score: 0.9162; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 659690.2500; train_edge_recon_loss: 3854972.7500; train_gene_expr_recon_loss: 37088052.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41602716.0000; train_optim_loss: 41602716.0000; val_kl_reg_loss: 493885.6875; val_edge_recon_loss: 4066297.0000; val_gene_expr_recon_loss: 77201000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81761184.0000; val_optim_loss: 81761184.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9015; val_auprc_score: 0.8913; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 505335.9375; train_edge_recon_loss: 4030192.2500; train_gene_expr_recon_loss: 74978808.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 79514336.0000; train_optim_loss: 79514336.0000; val_kl_reg_loss: 648894.8125; val_edge_recon_loss: 4066299.5000; val_gene_expr_recon_loss: 50948996.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 55664192.0000; val_optim_loss: 55664192.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8755; val_auprc_score: 0.8290; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 661132.8750; train_edge_recon_loss: 3892711.5000; train_gene_expr_recon_loss: 59685320.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64239164.0000; train_optim_loss: 64239164.0000; val_kl_reg_loss: 1428076.5000; val_edge_recon_loss: 4066299.0000; val_gene_expr_recon_loss: 36279616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41773992.0000; val_optim_loss: 41773992.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8977; val_auprc_score: 0.8776; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1472612.1250; train_edge_recon_loss: 3686195.0000; train_gene_expr_recon_loss: 42709220.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47868028.0000; train_optim_loss: 47868028.0000; val_kl_reg_loss: 569217.9375; val_edge_recon_loss: 4066299.0000; val_gene_expr_recon_loss: 38550864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43186380.0000; val_optim_loss: 43186380.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8986; val_auprc_score: 0.8784; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 580309.9375; train_edge_recon_loss: 4046752.5000; train_gene_expr_recon_loss: 38637292.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43264356.0000; train_optim_loss: 43264356.0000; val_kl_reg_loss: 564150.0000; val_edge_recon_loss: 4066299.7500; val_gene_expr_recon_loss: 38696288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43326736.0000; val_optim_loss: 43326736.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9024; val_auprc_score: 0.8836; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 579378.2500; train_edge_recon_loss: 4052912.2500; train_gene_expr_recon_loss: 38806296.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43438588.0000; train_optim_loss: 43438588.0000; val_kl_reg_loss: 569965.1875; val_edge_recon_loss: 4066300.7500; val_gene_expr_recon_loss: 38931812.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43568080.0000; val_optim_loss: 43568080.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8984; val_auprc_score: 0.8704; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 579585.0000; train_edge_recon_loss: 4057341.7500; train_gene_expr_recon_loss: 38945480.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43582408.0000; train_optim_loss: 43582408.0000; val_kl_reg_loss: 572616.7500; val_edge_recon_loss: 4066299.7500; val_gene_expr_recon_loss: 39064316.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43703232.0000; val_optim_loss: 43703232.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9019; val_auprc_score: 0.8899; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 580336.1250; train_edge_recon_loss: 4059069.7500; train_gene_expr_recon_loss: 39038552.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43677960.0000; train_optim_loss: 43677960.0000; val_kl_reg_loss: 568682.3125; val_edge_recon_loss: 4066300.7500; val_gene_expr_recon_loss: 38963848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 43598832.0000; val_optim_loss: 43598832.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 12 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.8853
val AUPRC score: 0.8522
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 60.0331
val source rna MSE score: 32.7279
Duration of model training in run 1: 0 hours, 0 minutes and 15 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Run timestamp: 16082023_220411_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_5pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1440, n_latent: 1440, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 5881
Number of validation edges: 653
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9597; val_auprc_score: 0.9395; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1942.0007; train_edge_recon_loss: 3477353.7500; train_gene_expr_recon_loss: 23475656.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26954952.0000; train_optim_loss: 26954952.0000; val_kl_reg_loss: 4022169.5000; val_edge_recon_loss: 4065815.5000; val_gene_expr_recon_loss: 503616064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 511704064.0000; val_optim_loss: 511704064.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9595; val_auprc_score: 0.9517; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3680499.2500; train_edge_recon_loss: 3639091.7500; train_gene_expr_recon_loss: 473430144.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480749728.0000; train_optim_loss: 480749728.0000; val_kl_reg_loss: 3073306.2500; val_edge_recon_loss: 4065722.5000; val_gene_expr_recon_loss: 38997068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46136096.0000; val_optim_loss: 46136096.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9580; val_auprc_score: 0.9520; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2866096.0000; train_edge_recon_loss: 3532903.5000; train_gene_expr_recon_loss: 444066912.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450465920.0000; train_optim_loss: 450465920.0000; val_kl_reg_loss: 459175.0625; val_edge_recon_loss: 4065957.7500; val_gene_expr_recon_loss: 24153084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28678216.0000; val_optim_loss: 28678216.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9442; val_auprc_score: 0.9122; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 444087.4688; train_edge_recon_loss: 3510003.5000; train_gene_expr_recon_loss: 142735584.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146689680.0000; train_optim_loss: 146689680.0000; val_kl_reg_loss: 74872.3906; val_edge_recon_loss: 4065993.2500; val_gene_expr_recon_loss: 24004098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28144964.0000; val_optim_loss: 28144964.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9551; val_auprc_score: 0.9311; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 74985.4688; train_edge_recon_loss: 3508599.0000; train_gene_expr_recon_loss: 26047218.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29630802.0000; train_optim_loss: 29630802.0000; val_kl_reg_loss: 83976.3750; val_edge_recon_loss: 4066076.5000; val_gene_expr_recon_loss: 24639902.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28789956.0000; val_optim_loss: 28789956.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9488; val_auprc_score: 0.9211; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 85152.4688; train_edge_recon_loss: 3502167.2500; train_gene_expr_recon_loss: 25651906.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29239226.0000; train_optim_loss: 29239226.0000; val_kl_reg_loss: 88181.1875; val_edge_recon_loss: 4066138.0000; val_gene_expr_recon_loss: 25401562.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29555882.0000; val_optim_loss: 29555882.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9506; val_auprc_score: 0.9254; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 89000.6562; train_edge_recon_loss: 3513014.5000; train_gene_expr_recon_loss: 26205448.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29807464.0000; train_optim_loss: 29807464.0000; val_kl_reg_loss: 81228.6328; val_edge_recon_loss: 4066182.7500; val_gene_expr_recon_loss: 26091086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30238498.0000; val_optim_loss: 30238498.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9461; val_auprc_score: 0.9244; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80901.2344; train_edge_recon_loss: 3529206.7500; train_gene_expr_recon_loss: 26152048.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29762156.0000; train_optim_loss: 29762156.0000; val_kl_reg_loss: 81460.4844; val_edge_recon_loss: 4066209.5000; val_gene_expr_recon_loss: 26441612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30589282.0000; val_optim_loss: 30589282.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9579; val_auprc_score: 0.9496; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80587.3281; train_edge_recon_loss: 3554481.7500; train_gene_expr_recon_loss: 26277964.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29913032.0000; train_optim_loss: 29913032.0000; val_kl_reg_loss: 80944.0938; val_edge_recon_loss: 4066203.2500; val_gene_expr_recon_loss: 26441432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30588580.0000; val_optim_loss: 30588580.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9497; val_auprc_score: 0.9340; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80612.2344; train_edge_recon_loss: 3553691.2500; train_gene_expr_recon_loss: 26277970.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29912274.0000; train_optim_loss: 29912274.0000; val_kl_reg_loss: 79273.7656; val_edge_recon_loss: 4066212.7500; val_gene_expr_recon_loss: 26347868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30493354.0000; val_optim_loss: 30493354.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9563; val_auprc_score: 0.9499; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80836.8594; train_edge_recon_loss: 3562094.7500; train_gene_expr_recon_loss: 26206116.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29849048.0000; train_optim_loss: 29849048.0000; val_kl_reg_loss: 82655.0938; val_edge_recon_loss: 4066212.7500; val_gene_expr_recon_loss: 26366544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30515412.0000; val_optim_loss: 30515412.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9543; val_auprc_score: 0.9367; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 81545.7344; train_edge_recon_loss: 3562032.2500; train_gene_expr_recon_loss: 26172624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29816202.0000; train_optim_loss: 29816202.0000; val_kl_reg_loss: 81987.6250; val_edge_recon_loss: 4066213.7500; val_gene_expr_recon_loss: 26271524.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30419726.0000; val_optim_loss: 30419726.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9446
val AUPRC score: 0.9129
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 100.2364
val source rna MSE score: 60.9176
Duration of model training in run 8: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1440, n_latent: 1440, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 5881
Number of validation edges: 653
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9422; val_auprc_score: 0.9144; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2155.1162; train_edge_recon_loss: 3477528.0000; train_gene_expr_recon_loss: 22532060.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26011744.0000; train_optim_loss: 26011744.0000; val_kl_reg_loss: 2382350.0000; val_edge_recon_loss: 4065839.2500; val_gene_expr_recon_loss: 184973680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 191421872.0000; val_optim_loss: 191421872.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9394; val_auprc_score: 0.9066; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2422605.5000; train_edge_recon_loss: 3547826.5000; train_gene_expr_recon_loss: 342333408.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348303840.0000; train_optim_loss: 348303840.0000; val_kl_reg_loss: 273669.0000; val_edge_recon_loss: 4065765.2500; val_gene_expr_recon_loss: 22294936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26634370.0000; val_optim_loss: 26634370.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9386; val_auprc_score: 0.9117; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 276597.5625; train_edge_recon_loss: 3505862.2500; train_gene_expr_recon_loss: 120335672.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124118128.0000; train_optim_loss: 124118128.0000; val_kl_reg_loss: 103350.8750; val_edge_recon_loss: 4066004.7500; val_gene_expr_recon_loss: 22741132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26910488.0000; val_optim_loss: 26910488.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9386; val_auprc_score: 0.9053; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 106521.8594; train_edge_recon_loss: 3509514.2500; train_gene_expr_recon_loss: 28742158.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32358194.0000; train_optim_loss: 32358194.0000; val_kl_reg_loss: 75081.0703; val_edge_recon_loss: 4066097.7500; val_gene_expr_recon_loss: 23487708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27628886.0000; val_optim_loss: 27628886.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9452; val_auprc_score: 0.9252; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 76679.8516; train_edge_recon_loss: 3507844.2500; train_gene_expr_recon_loss: 24225582.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27810106.0000; train_optim_loss: 27810106.0000; val_kl_reg_loss: 92503.3594; val_edge_recon_loss: 4066146.2500; val_gene_expr_recon_loss: 23840836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27999486.0000; val_optim_loss: 27999486.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9489; val_auprc_score: 0.9366; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 95077.3203; train_edge_recon_loss: 3516986.7500; train_gene_expr_recon_loss: 24753658.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28365722.0000; train_optim_loss: 28365722.0000; val_kl_reg_loss: 94199.4062; val_edge_recon_loss: 4066183.7500; val_gene_expr_recon_loss: 24112712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28273096.0000; val_optim_loss: 28273096.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9461; val_auprc_score: 0.9296; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 96848.8906; train_edge_recon_loss: 3539159.0000; train_gene_expr_recon_loss: 24710078.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28346086.0000; train_optim_loss: 28346086.0000; val_kl_reg_loss: 106857.0703; val_edge_recon_loss: 4066213.0000; val_gene_expr_recon_loss: 24260536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28433606.0000; val_optim_loss: 28433606.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9428; val_auprc_score: 0.9340; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 110972.7266; train_edge_recon_loss: 3585133.5000; train_gene_expr_recon_loss: 24580594.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28276700.0000; train_optim_loss: 28276700.0000; val_kl_reg_loss: 116595.2188; val_edge_recon_loss: 4066231.7500; val_gene_expr_recon_loss: 24235168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28417996.0000; val_optim_loss: 28417996.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9433; val_auprc_score: 0.9244; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 117695.5938; train_edge_recon_loss: 3591598.0000; train_gene_expr_recon_loss: 24437460.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28146754.0000; train_optim_loss: 28146754.0000; val_kl_reg_loss: 117585.3750; val_edge_recon_loss: 4066234.5000; val_gene_expr_recon_loss: 24198656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28382476.0000; val_optim_loss: 28382476.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9440; val_auprc_score: 0.9348; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 121355.5781; train_edge_recon_loss: 3579132.2500; train_gene_expr_recon_loss: 24392966.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28093454.0000; train_optim_loss: 28093454.0000; val_kl_reg_loss: 121275.5781; val_edge_recon_loss: 4066237.5000; val_gene_expr_recon_loss: 24166620.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28354132.0000; val_optim_loss: 28354132.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
val AUROC score: 0.9456
val AUPRC score: 0.9174
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 200.6715
val source rna MSE score: 60.0595
Duration of model training in run 7: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1441, n_latent: 1441, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1441, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1441, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 4419
Number of validation edges: 490
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9414; val_auprc_score: 0.9261; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1794.5405; train_edge_recon_loss: 3476294.2500; train_gene_expr_recon_loss: 22992668.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26470756.0000; train_optim_loss: 26470756.0000; val_kl_reg_loss: 905812.6250; val_edge_recon_loss: 4065831.0000; val_gene_expr_recon_loss: 486103488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491075136.0000; val_optim_loss: 491075136.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9546; val_auprc_score: 0.9456; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 953129.5625; train_edge_recon_loss: 3518417.7500; train_gene_expr_recon_loss: 456511520.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460983072.0000; train_optim_loss: 460983072.0000; val_kl_reg_loss: 1247559296.0000; val_edge_recon_loss: 4065537.5000; val_gene_expr_recon_loss: 79175888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1330800768.0000; val_optim_loss: 1330800768.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9495; val_auprc_score: 0.9451; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1320381440.0000; train_edge_recon_loss: 4002466.0000; train_gene_expr_recon_loss: 507760384.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1832144256.0000; train_optim_loss: 1832144256.0000; val_kl_reg_loss: 2186378.0000; val_edge_recon_loss: 4065867.2500; val_gene_expr_recon_loss: 22973160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29225404.0000; val_optim_loss: 29225404.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9412; val_auprc_score: 0.9278; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2210175.5000; train_edge_recon_loss: 3548179.7500; train_gene_expr_recon_loss: 431285888.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437044256.0000; train_optim_loss: 437044256.0000; val_kl_reg_loss: 6401483.0000; val_edge_recon_loss: 4066025.0000; val_gene_expr_recon_loss: 22862426.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33329934.0000; val_optim_loss: 33329934.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9505; val_auprc_score: 0.9372; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6326730.0000; train_edge_recon_loss: 3559001.0000; train_gene_expr_recon_loss: 480453632.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490339360.0000; train_optim_loss: 490339360.0000; val_kl_reg_loss: 6791164.0000; val_edge_recon_loss: 4066137.7500; val_gene_expr_recon_loss: 24962960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35820264.0000; val_optim_loss: 35820264.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9353; val_auprc_score: 0.9023; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6760632.0000; train_edge_recon_loss: 3514358.0000; train_gene_expr_recon_loss: 484999904.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495274880.0000; train_optim_loss: 495274880.0000; val_kl_reg_loss: 4198554.5000; val_edge_recon_loss: 4066234.0000; val_gene_expr_recon_loss: 28107924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36372712.0000; val_optim_loss: 36372712.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9547; val_auprc_score: 0.9428; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4205735.0000; train_edge_recon_loss: 3492945.2500; train_gene_expr_recon_loss: 431042112.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438740800.0000; train_optim_loss: 438740800.0000; val_kl_reg_loss: 1242235.0000; val_edge_recon_loss: 4066262.2500; val_gene_expr_recon_loss: 31182952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36491448.0000; val_optim_loss: 36491448.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9453; val_auprc_score: 0.9239; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1270316.5000; train_edge_recon_loss: 3493928.0000; train_gene_expr_recon_loss: 168907568.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173671808.0000; train_optim_loss: 173671808.0000; val_kl_reg_loss: 342060.5625; val_edge_recon_loss: 4066278.2500; val_gene_expr_recon_loss: 32450968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36859308.0000; val_optim_loss: 36859308.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9313; val_auprc_score: 0.9108; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 344352.7500; train_edge_recon_loss: 3548463.2500; train_gene_expr_recon_loss: 39921672.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43814488.0000; train_optim_loss: 43814488.0000; val_kl_reg_loss: 308462.7188; val_edge_recon_loss: 4066280.2500; val_gene_expr_recon_loss: 32522406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36897148.0000; val_optim_loss: 36897148.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9477; val_auprc_score: 0.9316; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 310358.0000; train_edge_recon_loss: 3565220.5000; train_gene_expr_recon_loss: 38476656.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42352236.0000; train_optim_loss: 42352236.0000; val_kl_reg_loss: 274690.4062; val_edge_recon_loss: 4066279.7500; val_gene_expr_recon_loss: 32559716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36900688.0000; val_optim_loss: 36900688.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9576; val_auprc_score: 0.9498; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 280581.7500; train_edge_recon_loss: 3579461.5000; train_gene_expr_recon_loss: 36406720.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40266764.0000; train_optim_loss: 40266764.0000; val_kl_reg_loss: 257343.3281; val_edge_recon_loss: 4066278.2500; val_gene_expr_recon_loss: 32618668.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36942288.0000; val_optim_loss: 36942288.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9557
val AUPRC score: 0.9529
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 469.6119
val source rna MSE score: 60.4009
Duration of model training in run 6: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1441, n_latent: 1441, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1441, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1441, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 4419
Number of validation edges: 490
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9546; val_auprc_score: 0.9285; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2048.4521; train_edge_recon_loss: 3476134.2500; train_gene_expr_recon_loss: 23247508.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26725690.0000; train_optim_loss: 26725690.0000; val_kl_reg_loss: 4350394.0000; val_edge_recon_loss: 4065841.2500; val_gene_expr_recon_loss: 493004608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 501420832.0000; val_optim_loss: 501420832.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9518; val_auprc_score: 0.9442; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4484139.0000; train_edge_recon_loss: 3540878.2500; train_gene_expr_recon_loss: 495964960.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503989984.0000; train_optim_loss: 503989984.0000; val_kl_reg_loss: 1056754.8750; val_edge_recon_loss: 4065704.0000; val_gene_expr_recon_loss: 71545896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 76668352.0000; val_optim_loss: 76668352.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9535; val_auprc_score: 0.9462; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1078190.3750; train_edge_recon_loss: 3518698.2500; train_gene_expr_recon_loss: 388982880.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393579776.0000; train_optim_loss: 393579776.0000; val_kl_reg_loss: 209642.5312; val_edge_recon_loss: 4065880.5000; val_gene_expr_recon_loss: 22667340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26942864.0000; val_optim_loss: 26942864.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9552; val_auprc_score: 0.9411; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 225552.5938; train_edge_recon_loss: 3508266.0000; train_gene_expr_recon_loss: 75394176.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 79127992.0000; train_optim_loss: 79127992.0000; val_kl_reg_loss: 77053.1562; val_edge_recon_loss: 4065906.0000; val_gene_expr_recon_loss: 23699172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27842132.0000; val_optim_loss: 27842132.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9575; val_auprc_score: 0.9392; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 80460.6719; train_edge_recon_loss: 3512315.5000; train_gene_expr_recon_loss: 25010950.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28603726.0000; train_optim_loss: 28603726.0000; val_kl_reg_loss: 81029.5312; val_edge_recon_loss: 4066020.0000; val_gene_expr_recon_loss: 24962952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29110002.0000; val_optim_loss: 29110002.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9607; val_auprc_score: 0.9582; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 83233.7500; train_edge_recon_loss: 3514832.2500; train_gene_expr_recon_loss: 25693910.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29291976.0000; train_optim_loss: 29291976.0000; val_kl_reg_loss: 82160.8125; val_edge_recon_loss: 4066089.0000; val_gene_expr_recon_loss: 25966680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30114930.0000; val_optim_loss: 30114930.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9475; val_auprc_score: 0.9337; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 81709.4688; train_edge_recon_loss: 3526299.2500; train_gene_expr_recon_loss: 26655262.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30263270.0000; train_optim_loss: 30263270.0000; val_kl_reg_loss: 76540.3750; val_edge_recon_loss: 4066150.7500; val_gene_expr_recon_loss: 26482432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30625124.0000; val_optim_loss: 30625124.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9440; val_auprc_score: 0.9193; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 79399.0156; train_edge_recon_loss: 3528255.7500; train_gene_expr_recon_loss: 26691016.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30298670.0000; train_optim_loss: 30298670.0000; val_kl_reg_loss: 84324.0781; val_edge_recon_loss: 4066182.7500; val_gene_expr_recon_loss: 26859552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31010058.0000; val_optim_loss: 31010058.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9456; val_auprc_score: 0.9220; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 86761.3438; train_edge_recon_loss: 3544952.2500; train_gene_expr_recon_loss: 26908720.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30540434.0000; train_optim_loss: 30540434.0000; val_kl_reg_loss: 85466.4688; val_edge_recon_loss: 4066186.2500; val_gene_expr_recon_loss: 26884468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31036120.0000; val_optim_loss: 31036120.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9574; val_auprc_score: 0.9490; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 87058.9531; train_edge_recon_loss: 3549963.7500; train_gene_expr_recon_loss: 26916664.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30553686.0000; train_optim_loss: 30553686.0000; val_kl_reg_loss: 85973.6641; val_edge_recon_loss: 4066182.7500; val_gene_expr_recon_loss: 26878292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31030448.0000; val_optim_loss: 31030448.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9508; val_auprc_score: 0.9381; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 87057.5547; train_edge_recon_loss: 3548512.2500; train_gene_expr_recon_loss: 26890280.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30525850.0000; train_optim_loss: 30525850.0000; val_kl_reg_loss: 82805.4375; val_edge_recon_loss: 4066193.5000; val_gene_expr_recon_loss: 26759250.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30908248.0000; val_optim_loss: 30908248.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9487
val AUPRC score: 0.9336
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 92.9794
val source rna MSE score: 62.8348
Duration of model training in run 5: 0 hours, 0 minutes and 7 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1440, n_latent: 1440, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 2952
Number of validation edges: 327
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9425; val_auprc_score: 0.9214; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2305.7729; train_edge_recon_loss: 3473733.7500; train_gene_expr_recon_loss: 22820854.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26296894.0000; train_optim_loss: 26296894.0000; val_kl_reg_loss: 8687787.0000; val_edge_recon_loss: 4065733.5000; val_gene_expr_recon_loss: 408976576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421730112.0000; val_optim_loss: 421730112.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9431; val_auprc_score: 0.9260; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9277851.0000; train_edge_recon_loss: 3599295.2500; train_gene_expr_recon_loss: 498292448.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511169600.0000; train_optim_loss: 511169600.0000; val_kl_reg_loss: 23262040.0000; val_edge_recon_loss: 4065575.2500; val_gene_expr_recon_loss: 43589048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 70916664.0000; val_optim_loss: 70916664.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9496; val_auprc_score: 0.9274; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 25746802.0000; train_edge_recon_loss: 3687974.7500; train_gene_expr_recon_loss: 514014976.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543449728.0000; train_optim_loss: 543449728.0000; val_kl_reg_loss: 911937.7500; val_edge_recon_loss: 4065902.7500; val_gene_expr_recon_loss: 22397650.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27375490.0000; val_optim_loss: 27375490.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9375; val_auprc_score: 0.9124; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 970619.8125; train_edge_recon_loss: 3513572.0000; train_gene_expr_recon_loss: 267732464.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 272216640.0000; train_optim_loss: 272216640.0000; val_kl_reg_loss: 210854.8750; val_edge_recon_loss: 4066006.7500; val_gene_expr_recon_loss: 23562364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27839226.0000; val_optim_loss: 27839226.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9460; val_auprc_score: 0.9353; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 224065.6562; train_edge_recon_loss: 3547741.2500; train_gene_expr_recon_loss: 58334508.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 62106316.0000; train_optim_loss: 62106316.0000; val_kl_reg_loss: 113325.0078; val_edge_recon_loss: 4066057.7500; val_gene_expr_recon_loss: 24816612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28995994.0000; val_optim_loss: 28995994.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9324; val_auprc_score: 0.9180; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 116481.6406; train_edge_recon_loss: 3515231.0000; train_gene_expr_recon_loss: 27224608.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30856320.0000; train_optim_loss: 30856320.0000; val_kl_reg_loss: 160253.5938; val_edge_recon_loss: 4066141.7500; val_gene_expr_recon_loss: 25732704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29959100.0000; val_optim_loss: 29959100.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9316; val_auprc_score: 0.9315; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 168469.2500; train_edge_recon_loss: 3542605.2500; train_gene_expr_recon_loss: 28086928.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31798002.0000; train_optim_loss: 31798002.0000; val_kl_reg_loss: 172334.2656; val_edge_recon_loss: 4066195.0000; val_gene_expr_recon_loss: 26239966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30478496.0000; val_optim_loss: 30478496.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9284; val_auprc_score: 0.9067; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 181711.5938; train_edge_recon_loss: 3570801.5000; train_gene_expr_recon_loss: 26874174.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30626688.0000; train_optim_loss: 30626688.0000; val_kl_reg_loss: 145690.1250; val_edge_recon_loss: 4066204.2500; val_gene_expr_recon_loss: 26336036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30547930.0000; val_optim_loss: 30547930.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9393; val_auprc_score: 0.9064; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 147430.4688; train_edge_recon_loss: 3575670.0000; train_gene_expr_recon_loss: 26276660.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29999760.0000; train_optim_loss: 29999760.0000; val_kl_reg_loss: 134476.1719; val_edge_recon_loss: 4066203.7500; val_gene_expr_recon_loss: 26264622.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30465302.0000; val_optim_loss: 30465302.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9282; val_auprc_score: 0.9097; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 143079.6562; train_edge_recon_loss: 3572921.2500; train_gene_expr_recon_loss: 26243706.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29959708.0000; train_optim_loss: 29959708.0000; val_kl_reg_loss: 132432.6406; val_edge_recon_loss: 4066216.2500; val_gene_expr_recon_loss: 26280998.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30479648.0000; val_optim_loss: 30479648.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9319; val_auprc_score: 0.9307; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 137481.8438; train_edge_recon_loss: 3582037.0000; train_gene_expr_recon_loss: 26294704.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30014222.0000; train_optim_loss: 30014222.0000; val_kl_reg_loss: 122065.5469; val_edge_recon_loss: 4066219.0000; val_gene_expr_recon_loss: 26171912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30360196.0000; val_optim_loss: 30360196.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9469
val AUPRC score: 0.9259
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 90.9509
val source rna MSE score: 61.3101
Duration of model training in run 4: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1440, n_latent: 1440, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1440, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 2952
Number of validation edges: 327
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9468; val_auprc_score: 0.9460; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2398.9939; train_edge_recon_loss: 3478693.0000; train_gene_expr_recon_loss: 22923312.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26404404.0000; train_optim_loss: 26404404.0000; val_kl_reg_loss: 5499335.0000; val_edge_recon_loss: 4065682.5000; val_gene_expr_recon_loss: 45548912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 55113928.0000; val_optim_loss: 55113928.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9411; val_auprc_score: 0.9139; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5310906.0000; train_edge_recon_loss: 3744273.0000; train_gene_expr_recon_loss: 180945296.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 190000480.0000; train_optim_loss: 190000480.0000; val_kl_reg_loss: 6090350.0000; val_edge_recon_loss: 4065498.7500; val_gene_expr_recon_loss: 22553252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32709100.0000; val_optim_loss: 32709100.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9475; val_auprc_score: 0.9488; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5683881.0000; train_edge_recon_loss: 3854751.5000; train_gene_expr_recon_loss: 54600012.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64138644.0000; train_optim_loss: 64138644.0000; val_kl_reg_loss: 145142.1250; val_edge_recon_loss: 4065925.2500; val_gene_expr_recon_loss: 23271442.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27482510.0000; val_optim_loss: 27482510.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9331; val_auprc_score: 0.9159; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 147584.5469; train_edge_recon_loss: 3494467.7500; train_gene_expr_recon_loss: 28876148.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32518200.0000; train_optim_loss: 32518200.0000; val_kl_reg_loss: 105561.3125; val_edge_recon_loss: 4066046.2500; val_gene_expr_recon_loss: 24142076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28313684.0000; val_optim_loss: 28313684.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9303; val_auprc_score: 0.9217; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 103838.1719; train_edge_recon_loss: 3502856.2500; train_gene_expr_recon_loss: 25046262.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28652956.0000; train_optim_loss: 28652956.0000; val_kl_reg_loss: 89822.5938; val_edge_recon_loss: 4066135.5000; val_gene_expr_recon_loss: 24708868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28864826.0000; val_optim_loss: 28864826.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9232; val_auprc_score: 0.9006; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 90607.1016; train_edge_recon_loss: 3515392.5000; train_gene_expr_recon_loss: 25188226.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28794226.0000; train_optim_loss: 28794226.0000; val_kl_reg_loss: 82566.9609; val_edge_recon_loss: 4066175.0000; val_gene_expr_recon_loss: 25036260.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29185002.0000; val_optim_loss: 29185002.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9324; val_auprc_score: 0.9209; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 82554.7969; train_edge_recon_loss: 3548134.5000; train_gene_expr_recon_loss: 25175548.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28806238.0000; train_optim_loss: 28806238.0000; val_kl_reg_loss: 88765.2266; val_edge_recon_loss: 4066206.2500; val_gene_expr_recon_loss: 25193500.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29348472.0000; val_optim_loss: 29348472.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9326; val_auprc_score: 0.9353; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 87663.8281; train_edge_recon_loss: 3585091.7500; train_gene_expr_recon_loss: 25160224.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28832980.0000; train_optim_loss: 28832980.0000; val_kl_reg_loss: 98340.0859; val_edge_recon_loss: 4066227.7500; val_gene_expr_recon_loss: 25067212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29231780.0000; val_optim_loss: 29231780.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9325; val_auprc_score: 0.9225; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 102782.9297; train_edge_recon_loss: 3580061.7500; train_gene_expr_recon_loss: 25016552.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28699396.0000; train_optim_loss: 28699396.0000; val_kl_reg_loss: 103618.5469; val_edge_recon_loss: 4066219.7500; val_gene_expr_recon_loss: 25077006.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29246844.0000; val_optim_loss: 29246844.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9346; val_auprc_score: 0.9303; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 105072.7969; train_edge_recon_loss: 3588870.2500; train_gene_expr_recon_loss: 24984526.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28678468.0000; train_optim_loss: 28678468.0000; val_kl_reg_loss: 104760.0156; val_edge_recon_loss: 4066221.5000; val_gene_expr_recon_loss: 25052986.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29223968.0000; val_optim_loss: 29223968.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9280; val_auprc_score: 0.9051; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 105422.8438; train_edge_recon_loss: 3582707.7500; train_gene_expr_recon_loss: 24950942.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28639072.0000; train_optim_loss: 28639072.0000; val_kl_reg_loss: 103653.2656; val_edge_recon_loss: 4066231.0000; val_gene_expr_recon_loss: 24988390.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29158274.0000; val_optim_loss: 29158274.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9266
val AUPRC score: 0.8946
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 90.9653
val source rna MSE score: 61.3368
Duration of model training in run 3: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1444, n_latent: 1444, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1444, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1444, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 1496
Number of validation edges: 166
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9019; val_auprc_score: 0.8664; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1972.2380; train_edge_recon_loss: 3473457.0000; train_gene_expr_recon_loss: 23096440.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26571870.0000; train_optim_loss: 26571870.0000; val_kl_reg_loss: 725410.0000; val_edge_recon_loss: 4065726.5000; val_gene_expr_recon_loss: 487484896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 492276032.0000; val_optim_loss: 492276032.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9306; val_auprc_score: 0.9180; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 784187.1250; train_edge_recon_loss: 3507956.5000; train_gene_expr_recon_loss: 455472640.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459764768.0000; train_optim_loss: 459764768.0000; val_kl_reg_loss: 81719772315648.0000; val_edge_recon_loss: 4065185.2500; val_gene_expr_recon_loss: 29810016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 81719805870080.0000; val_optim_loss: 81719805870080.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9232; val_auprc_score: 0.9131; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 116942480343040.0000; train_edge_recon_loss: 3886408.7500; train_gene_expr_recon_loss: 552550080.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116943033991168.0000; train_optim_loss: 116943033991168.0000; val_kl_reg_loss: 21016342528.0000; val_edge_recon_loss: 4065680.2500; val_gene_expr_recon_loss: 25483700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21045891072.0000; val_optim_loss: 21045891072.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9339; val_auprc_score: 0.9114; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 27579854848.0000; train_edge_recon_loss: 4072411.7500; train_gene_expr_recon_loss: 512529248.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28096454656.0000; train_optim_loss: 28096454656.0000; val_kl_reg_loss: 167505216.0000; val_edge_recon_loss: 4065919.2500; val_gene_expr_recon_loss: 37585748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 209156880.0000; val_optim_loss: 209156880.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9143; val_auprc_score: 0.8818; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 180609872.0000; train_edge_recon_loss: 3741030.0000; train_gene_expr_recon_loss: 513476224.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 697827136.0000; train_optim_loss: 697827136.0000; val_kl_reg_loss: 252778048.0000; val_edge_recon_loss: 4066123.2500; val_gene_expr_recon_loss: 71076800.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327920960.0000; val_optim_loss: 327920960.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9297; val_auprc_score: 0.9251; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 268782880.0000; train_edge_recon_loss: 3680988.7500; train_gene_expr_recon_loss: 514163456.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 786627328.0000; train_optim_loss: 786627328.0000; val_kl_reg_loss: 815650112.0000; val_edge_recon_loss: 4066195.5000; val_gene_expr_recon_loss: 134513792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 954230080.0000; val_optim_loss: 954230080.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9344; val_auprc_score: 0.9146; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1072390976.0000; train_edge_recon_loss: 3800513.7500; train_gene_expr_recon_loss: 513987584.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1590179072.0000; train_optim_loss: 1590179072.0000; val_kl_reg_loss: 1293370880.0000; val_edge_recon_loss: 4066242.7500; val_gene_expr_recon_loss: 234807808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1532244992.0000; val_optim_loss: 1532244992.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9436; val_auprc_score: 0.9404; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1422718080.0000; train_edge_recon_loss: 3908118.2500; train_gene_expr_recon_loss: 513574624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1940200832.0000; train_optim_loss: 1940200832.0000; val_kl_reg_loss: 346918208.0000; val_edge_recon_loss: 4066260.5000; val_gene_expr_recon_loss: 327117600.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 678102080.0000; val_optim_loss: 678102080.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9007; val_auprc_score: 0.8692; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 405965632.0000; train_edge_recon_loss: 3945000.5000; train_gene_expr_recon_loss: 511671488.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 921582080.0000; train_optim_loss: 921582080.0000; val_kl_reg_loss: 264437520.0000; val_edge_recon_loss: 4066262.5000; val_gene_expr_recon_loss: 324000832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 592504576.0000; val_optim_loss: 592504576.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9060; val_auprc_score: 0.8822; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 339523968.0000; train_edge_recon_loss: 3957835.5000; train_gene_expr_recon_loss: 505638336.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 849120128.0000; train_optim_loss: 849120128.0000; val_kl_reg_loss: 209285792.0000; val_edge_recon_loss: 4066268.5000; val_gene_expr_recon_loss: 296050688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509402752.0000; val_optim_loss: 509402752.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9270; val_auprc_score: 0.9195; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 260125280.0000; train_edge_recon_loss: 3949449.7500; train_gene_expr_recon_loss: 510435552.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 774510272.0000; train_optim_loss: 774510272.0000; val_kl_reg_loss: 187199872.0000; val_edge_recon_loss: 4066263.2500; val_gene_expr_recon_loss: 257629088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448895232.0000; val_optim_loss: 448895232.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9236; val_auprc_score: 0.8923; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 200784800.0000; train_edge_recon_loss: 3928634.0000; train_gene_expr_recon_loss: 504047872.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 708761344.0000; train_optim_loss: 708761344.0000; val_kl_reg_loss: 139830912.0000; val_edge_recon_loss: 4066265.0000; val_gene_expr_recon_loss: 218685072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362582272.0000; val_optim_loss: 362582272.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 4 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
val AUROC score: 0.9095
val AUPRC score: 0.8924
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 20053.9439
val source rna MSE score: 64.2939
Duration of model training in run 2: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1444, n_latent: 1444, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1444, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1444, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 638
Number of validation nodes: 71
Number of training edges: 1496
Number of validation edges: 166
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9201; val_auprc_score: 0.9161; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2121.9402; train_edge_recon_loss: 3478379.0000; train_gene_expr_recon_loss: 23440408.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26920908.0000; train_optim_loss: 26920908.0000; val_kl_reg_loss: 524560832.0000; val_edge_recon_loss: 4065661.2500; val_gene_expr_recon_loss: 396885696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 925512192.0000; val_optim_loss: 925512192.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9241; val_auprc_score: 0.9241; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 469413184.0000; train_edge_recon_loss: 3870702.5000; train_gene_expr_recon_loss: 528957248.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1002241152.0000; train_optim_loss: 1002241152.0000; val_kl_reg_loss: 2927847.0000; val_edge_recon_loss: 4065578.2500; val_gene_expr_recon_loss: 48235384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 55228808.0000; val_optim_loss: 55228808.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9116; val_auprc_score: 0.8986; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3126644.5000; train_edge_recon_loss: 3531000.0000; train_gene_expr_recon_loss: 444208448.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450866080.0000; train_optim_loss: 450866080.0000; val_kl_reg_loss: 10309700.0000; val_edge_recon_loss: 4066037.5000; val_gene_expr_recon_loss: 23171572.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37547312.0000; val_optim_loss: 37547312.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9362; val_auprc_score: 0.9310; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10184994.0000; train_edge_recon_loss: 3527119.7500; train_gene_expr_recon_loss: 498970144.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 512682272.0000; train_optim_loss: 512682272.0000; val_kl_reg_loss: 10028674.0000; val_edge_recon_loss: 4066169.2500; val_gene_expr_recon_loss: 25726132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39820976.0000; val_optim_loss: 39820976.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9332; val_auprc_score: 0.9176; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9433140.0000; train_edge_recon_loss: 3524199.5000; train_gene_expr_recon_loss: 482461344.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495418688.0000; train_optim_loss: 495418688.0000; val_kl_reg_loss: 5760741.0000; val_edge_recon_loss: 4066230.0000; val_gene_expr_recon_loss: 32802342.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42629312.0000; val_optim_loss: 42629312.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9243; val_auprc_score: 0.9101; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5555067.5000; train_edge_recon_loss: 3564270.5000; train_gene_expr_recon_loss: 403232480.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412351808.0000; train_optim_loss: 412351808.0000; val_kl_reg_loss: 995781.9375; val_edge_recon_loss: 4066255.7500; val_gene_expr_recon_loss: 33674216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38736252.0000; val_optim_loss: 38736252.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9318; val_auprc_score: 0.9274; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 957356.5000; train_edge_recon_loss: 3492231.7500; train_gene_expr_recon_loss: 141753024.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 146202608.0000; train_optim_loss: 146202608.0000; val_kl_reg_loss: 207714.8438; val_edge_recon_loss: 4066263.5000; val_gene_expr_recon_loss: 33585212.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37859192.0000; val_optim_loss: 37859192.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9366; val_auprc_score: 0.9414; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 210597.4062; train_edge_recon_loss: 3629796.0000; train_gene_expr_recon_loss: 37741980.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41582372.0000; train_optim_loss: 41582372.0000; val_kl_reg_loss: 167596.8438; val_edge_recon_loss: 4066276.7500; val_gene_expr_recon_loss: 33708892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37942764.0000; val_optim_loss: 37942764.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9315; val_auprc_score: 0.9164; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 170409.4062; train_edge_recon_loss: 3802076.5000; train_gene_expr_recon_loss: 34107544.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38080032.0000; train_optim_loss: 38080032.0000; val_kl_reg_loss: 170576.4375; val_edge_recon_loss: 4066279.5000; val_gene_expr_recon_loss: 33744504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37981360.0000; val_optim_loss: 37981360.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9136; val_auprc_score: 0.8886; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 172427.9531; train_edge_recon_loss: 3811062.7500; train_gene_expr_recon_loss: 34074348.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38057840.0000; train_optim_loss: 38057840.0000; val_kl_reg_loss: 170896.6562; val_edge_recon_loss: 4066278.7500; val_gene_expr_recon_loss: 33733164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37970340.0000; val_optim_loss: 37970340.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9262; val_auprc_score: 0.9327; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 173217.5312; train_edge_recon_loss: 3816978.0000; train_gene_expr_recon_loss: 34019716.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38009912.0000; train_optim_loss: 38009912.0000; val_kl_reg_loss: 170807.7188; val_edge_recon_loss: 4066280.5000; val_gene_expr_recon_loss: 33689016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37926104.0000; val_optim_loss: 37926104.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 3.

--- MODEL EVALUATION ---
val AUROC score: 0.9123
val AUPRC score: 0.9164
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 128.2458
val source rna MSE score: 64.3007
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
